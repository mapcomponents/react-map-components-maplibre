const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index.es-BniBxkcP.js","./iframe-CT0L23n0.js","./preload-helper-D9Z9MdNV.js","./iframe-DG6F43G8.css","./index-BgJaQBhb.js","./index-C8C5xIzt.js"])))=>i.map(i=>d[i]);
import{j as J,P as I1,r as hp}from"./index-BgJaQBhb.js";import{g as Id,V as zS,r as te,R as gt,a as VG,c as cg,b as xx}from"./iframe-CT0L23n0.js";import{_ as nb}from"./preload-helper-D9Z9MdNV.js";var iS={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.16.0/LICENSE.txt
 */var hoe=iS.exports,B8;function foe(){return B8||(B8=1,(function(t,e){(function(r,n){t.exports=n()})(hoe,(function(){var r={},n={};function i(s,o,c){if(n[s]=c,s==="index"){var h="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",d={};return n.shared(d),n.index(r,d),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([h],{type:"text/javascript"}))),r}}i("shared",["exports"],(function(s){function o(p,l,f,v){return new(f||(f=Promise))((function(S,k){function R(Z){try{V(v.next(Z))}catch(ie){k(ie)}}function B(Z){try{V(v.throw(Z))}catch(ie){k(ie)}}function V(Z){var ie;Z.done?S(Z.value):(ie=Z.value,ie instanceof f?ie:new f((function(ce){ce(ie)}))).then(R,B)}V((v=v.apply(p,l||[])).next())}))}function c(p,l){this.x=p,this.y=l}function h(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var d,m;typeof SuppressedError=="function"&&SuppressedError,c.prototype={clone(){return new c(this.x,this.y)},add(p){return this.clone()._add(p)},sub(p){return this.clone()._sub(p)},multByPoint(p){return this.clone()._multByPoint(p)},divByPoint(p){return this.clone()._divByPoint(p)},mult(p){return this.clone()._mult(p)},div(p){return this.clone()._div(p)},rotate(p){return this.clone()._rotate(p)},rotateAround(p,l){return this.clone()._rotateAround(p,l)},matMult(p){return this.clone()._matMult(p)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(p){return this.x===p.x&&this.y===p.y},dist(p){return Math.sqrt(this.distSqr(p))},distSqr(p){const l=p.x-this.x,f=p.y-this.y;return l*l+f*f},angle(){return Math.atan2(this.y,this.x)},angleTo(p){return Math.atan2(this.y-p.y,this.x-p.x)},angleWith(p){return this.angleWithSep(p.x,p.y)},angleWithSep(p,l){return Math.atan2(this.x*l-this.y*p,this.x*p+this.y*l)},_matMult(p){const l=p[2]*this.x+p[3]*this.y;return this.x=p[0]*this.x+p[1]*this.y,this.y=l,this},_add(p){return this.x+=p.x,this.y+=p.y,this},_sub(p){return this.x-=p.x,this.y-=p.y,this},_mult(p){return this.x*=p,this.y*=p,this},_div(p){return this.x/=p,this.y/=p,this},_multByPoint(p){return this.x*=p.x,this.y*=p.y,this},_divByPoint(p){return this.x/=p.x,this.y/=p.y,this},_unit(){return this._div(this.mag()),this},_perp(){const p=this.y;return this.y=this.x,this.x=-p,this},_rotate(p){const l=Math.cos(p),f=Math.sin(p),v=f*this.x+l*this.y;return this.x=l*this.x-f*this.y,this.y=v,this},_rotateAround(p,l){const f=Math.cos(p),v=Math.sin(p),S=l.y+v*(this.x-l.x)+f*(this.y-l.y);return this.x=l.x+f*(this.x-l.x)-v*(this.y-l.y),this.y=S,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:c},c.convert=function(p){if(p instanceof c)return p;if(Array.isArray(p))return new c(+p[0],+p[1]);if(p.x!==void 0&&p.y!==void 0)return new c(+p.x,+p.y);throw new Error("Expected [x, y] or {x, y} point format")};var b=(function(){if(m)return d;function p(l,f,v,S){this.cx=3*l,this.bx=3*(v-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*f,this.by=3*(S-f)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=f,this.p2x=v,this.p2y=S}return m=1,d=p,p.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,f){if(f===void 0&&(f=1e-6),l<0)return 0;if(l>1)return 1;for(var v=l,S=0;S<8;S++){var k=this.sampleCurveX(v)-l;if(Math.abs(k)<f)return v;var R=this.sampleCurveDerivativeX(v);if(Math.abs(R)<1e-6)break;v-=k/R}var B=0,V=1;for(v=l,S=0;S<20&&(k=this.sampleCurveX(v),!(Math.abs(k-l)<f));S++)l>k?B=v:V=v,v=.5*(V-B)+B;return v},solve:function(l,f){return this.sampleCurveY(this.solveCurveX(l,f))}},d})(),x=h(b);let E,T;function A(){return E==null&&(E=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),E}function M(){if(T==null&&(T=!1,A())){const l=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(l){for(let v=0;v<25;v++){const S=4*v;l.fillStyle=`rgb(${S},${S+1},${S+2})`,l.fillRect(v%5,Math.floor(v/5),1,1)}const f=l.getImageData(0,0,5,5).data;for(let v=0;v<100;v++)if(v%4!=3&&f[v]!==v){T=!0;break}}}return T||!1}var F=1e-6,N=typeof Float32Array<"u"?Float32Array:Array;function O(){var p=new N(9);return N!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[5]=0,p[6]=0,p[7]=0),p[0]=1,p[4]=1,p[8]=1,p}function U(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function j(){var p=new N(3);return N!=Float32Array&&(p[0]=0,p[1]=0,p[2]=0),p}function H(p){var l=p[0],f=p[1],v=p[2];return Math.sqrt(l*l+f*f+v*v)}function G(p,l,f){var v=new N(3);return v[0]=p,v[1]=l,v[2]=f,v}function X(p,l,f){return p[0]=l[0]+f[0],p[1]=l[1]+f[1],p[2]=l[2]+f[2],p}function ae(p,l,f){return p[0]=l[0]*f,p[1]=l[1]*f,p[2]=l[2]*f,p}function Q(p,l,f){var v=l[0],S=l[1],k=l[2],R=f[0],B=f[1],V=f[2];return p[0]=S*V-k*B,p[1]=k*R-v*V,p[2]=v*B-S*R,p}var W,oe=H;function se(p,l,f){var v=l[0],S=l[1],k=l[2],R=l[3];return p[0]=f[0]*v+f[4]*S+f[8]*k+f[12]*R,p[1]=f[1]*v+f[5]*S+f[9]*k+f[13]*R,p[2]=f[2]*v+f[6]*S+f[10]*k+f[14]*R,p[3]=f[3]*v+f[7]*S+f[11]*k+f[15]*R,p}function he(){var p=new N(4);return N!=Float32Array&&(p[0]=0,p[1]=0,p[2]=0),p[3]=1,p}function _e(p,l,f,v){var S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",k=Math.PI/360;l*=k,v*=k,f*=k;var R=Math.sin(l),B=Math.cos(l),V=Math.sin(f),Z=Math.cos(f),ie=Math.sin(v),ce=Math.cos(v);switch(S){case"xyz":p[0]=R*Z*ce+B*V*ie,p[1]=B*V*ce-R*Z*ie,p[2]=B*Z*ie+R*V*ce,p[3]=B*Z*ce-R*V*ie;break;case"xzy":p[0]=R*Z*ce-B*V*ie,p[1]=B*V*ce-R*Z*ie,p[2]=B*Z*ie+R*V*ce,p[3]=B*Z*ce+R*V*ie;break;case"yxz":p[0]=R*Z*ce+B*V*ie,p[1]=B*V*ce-R*Z*ie,p[2]=B*Z*ie-R*V*ce,p[3]=B*Z*ce+R*V*ie;break;case"yzx":p[0]=R*Z*ce+B*V*ie,p[1]=B*V*ce+R*Z*ie,p[2]=B*Z*ie-R*V*ce,p[3]=B*Z*ce-R*V*ie;break;case"zxy":p[0]=R*Z*ce-B*V*ie,p[1]=B*V*ce+R*Z*ie,p[2]=B*Z*ie+R*V*ce,p[3]=B*Z*ce-R*V*ie;break;case"zyx":p[0]=R*Z*ce-B*V*ie,p[1]=B*V*ce+R*Z*ie,p[2]=B*Z*ie-R*V*ce,p[3]=B*Z*ce+R*V*ie;break;default:throw new Error("Unknown angle order "+S)}return p}function Ce(){var p=new N(2);return N!=Float32Array&&(p[0]=0,p[1]=0),p}function me(p,l){var f=new N(2);return f[0]=p,f[1]=l,f}j(),W=new N(4),N!=Float32Array&&(W[0]=0,W[1]=0,W[2]=0,W[3]=0),j(),G(1,0,0),G(0,1,0),he(),he(),O(),Ce();const xe=8192;function Ae(p,l,f){return l*(xe/(p.tileSize*Math.pow(2,f-p.tileID.overscaledZ)))}function De(p,l){return(p%l+l)%l}function de(p,l,f){return p*(1-f)+l*f}function Ee(p){if(p<=0)return 0;if(p>=1)return 1;const l=p*p,f=l*p;return 4*(p<.5?f:3*(p-l)+f-.75)}function we(p,l,f,v){const S=new x(p,l,f,v);return k=>S.solve(k)}const Le=we(.25,.1,.25,1);function Fe(p,l,f){return Math.min(f,Math.max(l,p))}function Xe(p,l,f){const v=f-l,S=((p-l)%v+v)%v+l;return S===l?f:S}function Be(p,...l){for(const f of l)for(const v in f)p[v]=f[v];return p}let ot=1;function Qe(p,l,f){const v={};for(const S in p)v[S]=l.call(this,p[S],S,p);return v}function rt(p,l,f){const v={};for(const S in p)l.call(this,p[S],S,p)&&(v[S]=p[S]);return v}function Re(p){return Array.isArray(p)?p.map(Re):typeof p=="object"&&p?Qe(p,Re):p}const zt={};function st(p){zt[p]||(typeof console<"u"&&console.warn(p),zt[p]=!0)}function $e(p,l,f){return(f.y-p.y)*(l.x-p.x)>(l.y-p.y)*(f.x-p.x)}function Jt(p){return typeof WorkerGlobalScope<"u"&&p!==void 0&&p instanceof WorkerGlobalScope}let Ht=null;function pr(p){return typeof ImageBitmap<"u"&&p instanceof ImageBitmap}const _t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function vr(p,l,f,v,S){return o(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const k=new VideoFrame(p,{timestamp:0});try{const R=k?.format;if(!R||!R.startsWith("BGR")&&!R.startsWith("RGB"))throw new Error(`Unrecognized format ${R}`);const B=R.startsWith("BGR"),V=new Uint8ClampedArray(v*S*4);if(yield k.copyTo(V,(function(Z,ie,ce,ve,Se){const Ne=4*Math.max(-ie,0),ze=(Math.max(0,ce)-ce)*ve*4+Ne,Ve=4*ve,et=Math.max(0,ie),Ct=Math.max(0,ce);return{rect:{x:et,y:Ct,width:Math.min(Z.width,ie+ve)-et,height:Math.min(Z.height,ce+Se)-Ct},layout:[{offset:ze,stride:Ve}]}})(p,l,f,v,S)),B)for(let Z=0;Z<V.length;Z+=4){const ie=V[Z];V[Z]=V[Z+2],V[Z+2]=ie}return V}finally{k.close()}}))}let br,lr;function Cr(p,l,f,v){return p.addEventListener(l,f,v),{unsubscribe:()=>{p.removeEventListener(l,f,v)}}}function Tr(p){return p*Math.PI/180}function Qt(p){return p/Math.PI*180}const at={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ke={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},be="AbortError";class je extends Error{constructor(l=be){super(l instanceof Error?l.message:l),this.name=be,l instanceof Error&&l.stack&&(this.stack=l.stack)}}function qe(p){return p.name===be}const We={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Lt(p){return We.REGISTERED_PROTOCOLS[p.substring(0,p.indexOf("://"))]}const Et="global-dispatcher";class mt extends Error{constructor(l,f,v,S){super(`AJAXError: ${f} (${l}): ${v}`),this.status=l,this.statusText=f,this.url=v,this.body=S}}const ct=()=>Jt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Kt=function(p,l){if(/:\/\//.test(p.url)&&!/^https?:|^file:/.test(p.url)){const v=Lt(p.url);if(v)return v(p,l);if(Jt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:p,targetMapId:Et},l)}if(!(/^file:/.test(f=p.url)||/^file:/.test(ct())&&!/^\w+:/.test(f))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(v,S){return o(this,void 0,void 0,(function*(){const k=new Request(v.url,{method:v.method||"GET",body:v.body,credentials:v.credentials,headers:v.headers,cache:v.cache,referrer:ct(),signal:S.signal});let R,B;v.type!=="json"||k.headers.has("Accept")||k.headers.set("Accept","application/json");try{R=yield fetch(k)}catch(Z){throw qe(Z)?Z:new mt(0,Z.message,v.url,new Blob)}if(!R.ok){const Z=yield R.blob();throw new mt(R.status,R.statusText,v.url,Z)}B=v.type==="arrayBuffer"||v.type==="image"?R.arrayBuffer():v.type==="json"?R.json():R.text();const V=yield B;return S.signal.throwIfAborted(),{data:V,cacheControl:R.headers.get("Cache-Control"),expires:R.headers.get("Expires")}}))})(p,l);if(Jt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:p,mustQueue:!0,targetMapId:Et},l)}var f;return(function(v,S){return new Promise(((k,R)=>{var B;const V=new XMLHttpRequest;V.open(v.method||"GET",v.url,!0),v.type!=="arrayBuffer"&&v.type!=="image"||(V.responseType="arraybuffer");for(const Z in v.headers)V.setRequestHeader(Z,v.headers[Z]);v.type==="json"&&(V.responseType="text",!((B=v.headers)===null||B===void 0)&&B.Accept||V.setRequestHeader("Accept","application/json")),V.withCredentials=v.credentials==="include",V.onerror=()=>{R(new Error(V.statusText))},V.onload=()=>{if(!S.signal.aborted)if((V.status>=200&&V.status<300||V.status===0)&&V.response!==null){let Z=V.response;if(v.type==="json")try{Z=JSON.parse(V.response)}catch(ie){return void R(ie)}k({data:Z,cacheControl:V.getResponseHeader("Cache-Control"),expires:V.getResponseHeader("Expires")})}else{const Z=new Blob([V.response],{type:V.getResponseHeader("Content-Type")});R(new mt(V.status,V.statusText,v.url,Z))}},S.signal.addEventListener("abort",(()=>{V.abort(),R(new je(S.signal.reason))})),V.send(v.body)}))})(p,l)};function qt(p){if(!p||p.indexOf("://")<=0||p.indexOf("data:image/")===0||p.indexOf("blob:")===0)return!0;const l=new URL(p),f=window.location;return l.protocol===f.protocol&&l.host===f.host}function Ir(p,l,f){f[p]&&f[p].indexOf(l)!==-1||(f[p]=f[p]||[],f[p].push(l))}function Ar(p,l,f){if(f&&f[p]){const v=f[p].indexOf(l);v!==-1&&f[p].splice(v,1)}}class $r{constructor(l,f={}){Be(this,f),this.type=l}}class hn extends $r{constructor(l,f={}){super("error",Be({error:l},f))}}class zr{on(l,f){return this._listeners=this._listeners||{},Ir(l,f,this._listeners),{unsubscribe:()=>{this.off(l,f)}}}off(l,f){return Ar(l,f,this._listeners),Ar(l,f,this._oneTimeListeners),this}once(l,f){return f?(this._oneTimeListeners=this._oneTimeListeners||{},Ir(l,f,this._oneTimeListeners),this):new Promise((v=>this.once(l,v)))}fire(l,f){typeof l=="string"&&(l=new $r(l,f||{}));const v=l.type;if(this.listens(v)){l.target=this;const S=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];for(const B of S)B.call(this,l);const k=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];for(const B of k)Ar(v,B,this._oneTimeListeners),B.call(this,l);const R=this._eventedParent;R&&(Be(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),R.fire(l))}else l instanceof hn&&console.error(l.error);return this}listens(l){return this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l)}setEventedParent(l,f){return this._eventedParent=l,this._eventedParentData=f,this}}var Mt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const en=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function jn(p,l){const f={};for(const v in p)v!=="ref"&&(f[v]=p[v]);return en.forEach((v=>{v in l&&(f[v]=l[v])})),f}function Qr(p,l){if(Array.isArray(p)){if(!Array.isArray(l)||p.length!==l.length)return!1;for(let f=0;f<p.length;f++)if(!Qr(p[f],l[f]))return!1;return!0}if(typeof p=="object"&&p!==null&&l!==null){if(typeof l!="object"||Object.keys(p).length!==Object.keys(l).length)return!1;for(const f in p)if(!Qr(p[f],l[f]))return!1;return!0}return p===l}function nr(p,l){p.push(l)}function oi(p,l,f){nr(f,{command:"addSource",args:[p,l[p]]})}function un(p,l,f){nr(l,{command:"removeSource",args:[p]}),f[p]=!0}function Kn(p,l,f,v){un(p,f,v),oi(p,l,f)}function Me(p,l,f){let v;for(v in p[f])if(Object.prototype.hasOwnProperty.call(p[f],v)&&v!=="data"&&!Qr(p[f][v],l[f][v]))return!1;for(v in l[f])if(Object.prototype.hasOwnProperty.call(l[f],v)&&v!=="data"&&!Qr(p[f][v],l[f][v]))return!1;return!0}function He(p,l,f,v,S,k){p=p||{},l=l||{};for(const R in p)Object.prototype.hasOwnProperty.call(p,R)&&(Qr(p[R],l[R])||f.push({command:k,args:[v,R,l[R],S]}));for(const R in l)Object.prototype.hasOwnProperty.call(l,R)&&!Object.prototype.hasOwnProperty.call(p,R)&&(Qr(p[R],l[R])||f.push({command:k,args:[v,R,l[R],S]}))}function Tt(p){return p.id}function Wt(p,l){return p[l.id]=l,p}class Ut{constructor(l,f,v,S){this.message=(l?`${l}: `:"")+v,S&&(this.identifier=S),f!=null&&f.__line__&&(this.line=f.__line__)}}function Xr(p,...l){for(const f of l)for(const v in f)p[v]=f[v];return p}class Nn extends Error{constructor(l,f){super(f),this.message=f,this.key=l}}class Bi{constructor(l,f=[]){this.parent=l,this.bindings={};for(const[v,S]of f)this.bindings[v]=S}concat(l){return new Bi(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}const Ci={kind:"null"},Fr={kind:"number"},Mn={kind:"string"},Bn={kind:"boolean"},ei={kind:"color"},ua={kind:"projectionDefinition"},fa={kind:"object"},zn={kind:"value"},La={kind:"collator"},Gi={kind:"formatted"},fs={kind:"padding"},Ca={kind:"colorArray"},Mo={kind:"numberArray"},Ya={kind:"resolvedImage"},ol={kind:"variableAnchorOffsetCollection"};function xi(p,l){return{kind:"array",itemType:p,N:l}}function zi(p){if(p.kind==="array"){const l=zi(p.itemType);return typeof p.N=="number"?`array<${l}, ${p.N}>`:p.itemType.kind==="value"?"array":`array<${l}>`}return p.kind}const Iu=[Ci,Fr,Mn,Bn,ei,ua,Gi,fa,xi(zn),fs,Mo,Ca,Ya,ol];function ga(p,l){if(l.kind==="error")return null;if(p.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!ga(p.itemType,l.itemType))&&(typeof p.N!="number"||p.N===l.N))return null}else{if(p.kind===l.kind)return null;if(p.kind==="value"){for(const f of Iu)if(!ga(f,l))return null}}return`Expected ${zi(p)} but found ${zi(l)} instead.`}function Za(p,l){return l.some((f=>f.kind===p.kind))}function ds(p,l){return l.some((f=>f==="null"?p===null:f==="array"?Array.isArray(p):f==="object"?p&&!Array.isArray(p)&&typeof p=="object":f===typeof p))}function Aa(p,l){return p.kind==="array"&&l.kind==="array"?p.itemType.kind===l.itemType.kind&&typeof p.N=="number":p.kind===l.kind}const ps=.96422,Ul=.82521,Fa=4/29,_a=6/29,xc=3*_a*_a,sl=_a*_a*_a,ts=Math.PI/180,oo=180/Math.PI;function rs(p){return(p%=360)<0&&(p+=360),p}function Ba([p,l,f,v]){let S,k;const R=Uc((.2225045*(p=Us(p))+.7168786*(l=Us(l))+.0606169*(f=Us(f)))/1);p===l&&l===f?S=k=R:(S=Uc((.4360747*p+.3850649*l+.1430804*f)/ps),k=Uc((.0139322*p+.0971045*l+.7141733*f)/Ul));const B=116*R-16;return[B<0?0:B,500*(S-R),200*(R-k),v]}function Us(p){return p<=.04045?p/12.92:Math.pow((p+.055)/1.055,2.4)}function Uc(p){return p>sl?Math.pow(p,1/3):p/xc+Fa}function Pu([p,l,f,v]){let S=(p+16)/116,k=isNaN(l)?S:S+l/500,R=isNaN(f)?S:S-f/200;return S=1*pe(S),k=ps*pe(k),R=Ul*pe(R),[ee(3.1338561*k-1.6168667*S-.4906146*R),ee(-.9787684*k+1.9161415*S+.033454*R),ee(.0719453*k-.2289914*S+1.4052427*R),v]}function ee(p){return(p=p<=.00304?12.92*p:1.055*Math.pow(p,1/2.4)-.055)<0?0:p>1?1:p}function pe(p){return p>_a?p*p*p:xc*(p-Fa)}const Ke=Object.hasOwn||function(p,l){return Object.prototype.hasOwnProperty.call(p,l)};function It(p,l){return Ke(p,l)?p[l]:void 0}function Vt(p){return parseInt(p.padEnd(2,p),16)/255}function $t(p,l){return er(l?p/100:p,0,1)}function er(p,l,f){return Math.min(Math.max(l,p),f)}function Yr(p){return!p.some(Number.isNaN)}const tn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Wr(p,l,f){return p+f*(l-p)}function on(p,l,f){return p.map(((v,S)=>Wr(v,l[S],f)))}class kr{constructor(l,f,v,S=1,k=!0){this.r=l,this.g=f,this.b=v,this.a=S,k||(this.r*=S,this.g*=S,this.b*=S,S||this.overwriteGetter("rgb",[l,f,v,S]))}static parse(l){if(l instanceof kr)return l;if(typeof l!="string")return;const f=(function(v){if((v=v.toLowerCase().trim())==="transparent")return[0,0,0,0];const S=It(tn,v);if(S){const[R,B,V]=S;return[R/255,B/255,V/255,1]}if(v.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(v)){const R=v.length<6?1:2;let B=1;return[Vt(v.slice(B,B+=R)),Vt(v.slice(B,B+=R)),Vt(v.slice(B,B+=R)),Vt(v.slice(B,B+R)||"ff")]}if(v.startsWith("rgb")){const R=v.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(R){const[B,V,Z,ie,ce,ve,Se,Ne,ze,Ve,et,Ct]=R,nt=[ie||" ",Se||" ",Ve].join("");if(nt==="  "||nt==="  /"||nt===",,"||nt===",,,"){const ut=[Z,ve,ze].join(""),Rt=ut==="%%%"?100:ut===""?255:0;if(Rt){const Ft=[er(+V/Rt,0,1),er(+ce/Rt,0,1),er(+Ne/Rt,0,1),et?$t(+et,Ct):1];if(Yr(Ft))return Ft}}return}}const k=v.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(k){const[R,B,V,Z,ie,ce,ve,Se,Ne]=k,ze=[V||" ",ie||" ",ve].join("");if(ze==="  "||ze==="  /"||ze===",,"||ze===",,,"){const Ve=[+B,er(+Z,0,100),er(+ce,0,100),Se?$t(+Se,Ne):1];if(Yr(Ve))return(function([et,Ct,nt,ut]){function Rt(Ft){const fr=(Ft+et/30)%12,Or=Ct*Math.min(nt,1-nt);return nt-Or*Math.max(-1,Math.min(fr-3,9-fr,1))}return et=rs(et),Ct/=100,nt/=100,[Rt(0),Rt(8),Rt(4),ut]})(Ve)}}})(l);return f?new kr(...f,!1):void 0}get rgb(){const{r:l,g:f,b:v,a:S}=this,k=S||1/0;return this.overwriteGetter("rgb",[l/k,f/k,v/k,S])}get hcl(){return this.overwriteGetter("hcl",(function(l){const[f,v,S,k]=Ba(l),R=Math.sqrt(v*v+S*S);return[Math.round(1e4*R)?rs(Math.atan2(S,v)*oo):NaN,R,f,k]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Ba(this.rgb))}overwriteGetter(l,f){return Object.defineProperty(this,l,{value:f}),f}toString(){const[l,f,v,S]=this.rgb;return`rgba(${[l,f,v].map((k=>Math.round(255*k))).join(",")},${S})`}static interpolate(l,f,v,S="rgb"){switch(S){case"rgb":{const[k,R,B,V]=on(l.rgb,f.rgb,v);return new kr(k,R,B,V,!1)}case"hcl":{const[k,R,B,V]=l.hcl,[Z,ie,ce,ve]=f.hcl;let Se,Ne;if(isNaN(k)||isNaN(Z))isNaN(k)?isNaN(Z)?Se=NaN:(Se=Z,B!==1&&B!==0||(Ne=ie)):(Se=k,ce!==1&&ce!==0||(Ne=R));else{let nt=Z-k;Z>k&&nt>180?nt-=360:Z<k&&k-Z>180&&(nt+=360),Se=k+v*nt}const[ze,Ve,et,Ct]=(function([nt,ut,Rt,Ft]){return nt=isNaN(nt)?0:nt*ts,Pu([Rt,Math.cos(nt)*ut,Math.sin(nt)*ut,Ft])})([Se,Ne??Wr(R,ie,v),Wr(B,ce,v),Wr(V,ve,v)]);return new kr(ze,Ve,et,Ct,!1)}case"lab":{const[k,R,B,V]=Pu(on(l.lab,f.lab,v));return new kr(k,R,B,V,!1)}}}}kr.black=new kr(0,0,0,1),kr.white=new kr(1,1,1,1),kr.transparent=new kr(0,0,0,0),kr.red=new kr(1,0,0,1);class ti{constructor(l,f,v){this.sensitivity=l?f?"variant":"case":f?"accent":"base",this.locale=v,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,f){return this.collator.compare(l,f)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ri=["bottom","center","top"];class $n{constructor(l,f,v,S,k,R){this.text=l,this.image=f,this.scale=v,this.fontStack=S,this.textColor=k,this.verticalAlign=R}}class _n{constructor(l){this.sections=l}static fromString(l){return new _n([new $n(l,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((l=>l.text.length!==0||l.image&&l.image.name.length!==0))}static factory(l){return l instanceof _n?l:_n.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map((l=>l.text)).join("")}}class Mr{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Mr)return l;if(typeof l=="number")return new Mr([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const f of l)if(typeof f!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]]}return new Mr(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,f,v){return new Mr(on(l.values,f.values,v))}}class fn{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof fn)return l;if(typeof l=="number")return new fn([l]);if(Array.isArray(l)){for(const f of l)if(typeof f!="number")return;return new fn(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,f,v){return new fn(on(l.values,f.values,v))}}class mn{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof mn)return l;if(typeof l=="string"){const v=kr.parse(l);return v?new mn([v]):void 0}if(!Array.isArray(l))return;const f=[];for(const v of l){if(typeof v!="string")return;const S=kr.parse(v);if(!S)return;f.push(S)}return new mn(f)}toString(){return JSON.stringify(this.values)}static interpolate(l,f,v,S="rgb"){const k=[];if(l.values.length!=f.values.length)throw new Error(`colorArray: Arrays have mismatched length (${l.values.length} vs. ${f.values.length}), cannot interpolate.`);for(let R=0;R<l.values.length;R++)k.push(kr.interpolate(l.values[R],f.values[R],v,S));return new mn(k)}}class hi extends Error{constructor(l){super(l),this.name="RuntimeError"}toJSON(){return this.message}}const $i=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ba{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof ba)return l;if(Array.isArray(l)&&!(l.length<1)&&l.length%2==0){for(let f=0;f<l.length;f+=2){const v=l[f],S=l[f+1];if(typeof v!="string"||!$i.has(v)||!Array.isArray(S)||S.length!==2||typeof S[0]!="number"||typeof S[1]!="number")return}return new ba(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,f,v){const S=l.values,k=f.values;if(S.length!==k.length)throw new hi(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${f.toString()}`);const R=[];for(let B=0;B<S.length;B+=2){if(S[B]!==k[B])throw new hi(`Cannot interpolate values containing mismatched anchors. from[${B}]: ${S[B]}, to[${B}]: ${k[B]}`);R.push(S[B]);const[V,Z]=S[B+1],[ie,ce]=k[B+1];R.push([Wr(V,ie,v),Wr(Z,ce,v)])}return new ba(R)}}class wi{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new wi({name:l,available:!1}):null}}class fi{constructor(l,f,v){this.from=l,this.to=f,this.transition=v}static interpolate(l,f,v){return new fi(l,f,v)}static parse(l){return l instanceof fi?l:Array.isArray(l)&&l.length===3&&typeof l[0]=="string"&&typeof l[1]=="string"&&typeof l[2]=="number"?new fi(l[0],l[1],l[2]):typeof l=="object"&&typeof l.from=="string"&&typeof l.to=="string"&&typeof l.transition=="number"?new fi(l.from,l.to,l.transition):typeof l=="string"?new fi(l,l,1):void 0}}function Ts(p,l,f,v){return typeof p=="number"&&p>=0&&p<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof f=="number"&&f>=0&&f<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:`Invalid rgba value [${[p,l,f,v].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof v=="number"?[p,l,f,v]:[p,l,f]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Vs(p){if(p===null||typeof p=="string"||typeof p=="boolean"||typeof p=="number"||p instanceof fi||p instanceof kr||p instanceof ti||p instanceof _n||p instanceof Mr||p instanceof fn||p instanceof mn||p instanceof ba||p instanceof wi)return!0;if(Array.isArray(p)){for(const l of p)if(!Vs(l))return!1;return!0}if(typeof p=="object"){for(const l in p)if(!Vs(p[l]))return!1;return!0}return!1}function Mi(p){if(p===null)return Ci;if(typeof p=="string")return Mn;if(typeof p=="boolean")return Bn;if(typeof p=="number")return Fr;if(p instanceof kr)return ei;if(p instanceof fi)return ua;if(p instanceof ti)return La;if(p instanceof _n)return Gi;if(p instanceof Mr)return fs;if(p instanceof fn)return Mo;if(p instanceof mn)return Ca;if(p instanceof ba)return ol;if(p instanceof wi)return Ya;if(Array.isArray(p)){const l=p.length;let f;for(const v of p){const S=Mi(v);if(f){if(f===S)continue;f=zn;break}f=S}return xi(f||zn,l)}return fa}function Cs(p){const l=typeof p;return p===null?"":l==="string"||l==="number"||l==="boolean"?String(p):p instanceof kr||p instanceof fi||p instanceof _n||p instanceof Mr||p instanceof fn||p instanceof mn||p instanceof ba||p instanceof wi?p.toString():JSON.stringify(p)}class oa{constructor(l,f){this.type=l,this.value=f}static parse(l,f){if(l.length!==2)return f.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!Vs(l[1]))return f.error("invalid value");const v=l[1];let S=Mi(v);const k=f.expectedType;return S.kind!=="array"||S.N!==0||!k||k.kind!=="array"||typeof k.N=="number"&&k.N!==0||(S=k),new oa(S,v)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ku={string:Mn,number:Fr,boolean:Bn,object:fa};class Ka{constructor(l,f){this.type=l,this.args=f}static parse(l,f){if(l.length<2)return f.error("Expected at least one argument.");let v,S=1;const k=l[0];if(k==="array"){let B,V;if(l.length>2){const Z=l[1];if(typeof Z!="string"||!(Z in ku)||Z==="object")return f.error('The item type argument of "array" must be one of string, number, boolean',1);B=ku[Z],S++}else B=zn;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return f.error('The length argument to "array" must be a positive integer literal',2);V=l[2],S++}v=xi(B,V)}else{if(!ku[k])throw new Error(`Types doesn't contain name = ${k}`);v=ku[k]}const R=[];for(;S<l.length;S++){const B=f.parse(l[S],S,zn);if(!B)return null;R.push(B)}return new Ka(v,R)}evaluate(l){for(let f=0;f<this.args.length;f++){const v=this.args[f].evaluate(l);if(!ga(this.type,Mi(v)))return v;if(f===this.args.length-1)throw new hi(`Expected value to be of type ${zi(this.type)}, but found ${zi(Mi(v))} instead.`)}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every((l=>l.outputDefined()))}}const $s={"to-boolean":Bn,"to-color":ei,"to-number":Fr,"to-string":Mn};class Vo{constructor(l,f){this.type=l,this.args=f}static parse(l,f){if(l.length<2)return f.error("Expected at least one argument.");const v=l[0];if(!$s[v])throw new Error(`Can't parse ${v} as it is not part of the known types`);if((v==="to-boolean"||v==="to-string")&&l.length!==2)return f.error("Expected one argument.");const S=$s[v],k=[];for(let R=1;R<l.length;R++){const B=f.parse(l[R],R,zn);if(!B)return null;k.push(B)}return new Vo(S,k)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let f,v;for(const S of this.args){if(f=S.evaluate(l),v=null,f instanceof kr)return f;if(typeof f=="string"){const k=l.parseColor(f);if(k)return k}else if(Array.isArray(f)&&(v=f.length<3||f.length>4?`Invalid rgba value ${JSON.stringify(f)}: expected an array containing either three or four numeric values.`:Ts(f[0],f[1],f[2],f[3]),!v))return new kr(f[0]/255,f[1]/255,f[2]/255,f[3])}throw new hi(v||`Could not parse color from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"padding":{let f;for(const v of this.args){f=v.evaluate(l);const S=Mr.parse(f);if(S)return S}throw new hi(`Could not parse padding from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"numberArray":{let f;for(const v of this.args){f=v.evaluate(l);const S=fn.parse(f);if(S)return S}throw new hi(`Could not parse numberArray from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"colorArray":{let f;for(const v of this.args){f=v.evaluate(l);const S=mn.parse(f);if(S)return S}throw new hi(`Could not parse colorArray from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"variableAnchorOffsetCollection":{let f;for(const v of this.args){f=v.evaluate(l);const S=ba.parse(f);if(S)return S}throw new hi(`Could not parse variableAnchorOffsetCollection from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"number":{let f=null;for(const v of this.args){if(f=v.evaluate(l),f===null)return 0;const S=Number(f);if(!isNaN(S))return S}throw new hi(`Could not convert ${JSON.stringify(f)} to number.`)}case"formatted":return _n.fromString(Cs(this.args[0].evaluate(l)));case"resolvedImage":return wi.fromString(Cs(this.args[0].evaluate(l)));case"projectionDefinition":return this.args[0].evaluate(l);default:return Cs(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every((l=>l.outputDefined()))}}const Ru=["Unknown","Point","LineString","Polygon"];class Mu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ru[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let f=this._parseColorCache.get(l);return f||(f=kr.parse(l),this._parseColorCache.set(l,f)),f}}class go{constructor(l,f,v=[],S,k=new Bi,R=[]){this.registry=l,this.path=v,this.key=v.map((B=>`[${B}]`)).join(""),this.scope=k,this.errors=R,this.expectedType=S,this._isConstant=f}parse(l,f,v,S,k={}){return f?this.concat(f,v,S)._parse(l,k):this._parse(l,k)}_parse(l,f){function v(S,k,R){return R==="assert"?new Ka(k,[S]):R==="coerce"?new Vo(k,[S]):S}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const S=l[0];if(typeof S!="string")return this.error(`Expression name must be a string, but found ${typeof S} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const k=this.registry[S];if(k){let R=k.parse(l,this);if(!R)return null;if(this.expectedType){const B=this.expectedType,V=R.type;if(B.kind!=="string"&&B.kind!=="number"&&B.kind!=="boolean"&&B.kind!=="object"&&B.kind!=="array"||V.kind!=="value"){if(B.kind==="projectionDefinition"&&["string","array"].includes(V.kind)||["color","formatted","resolvedImage"].includes(B.kind)&&["value","string"].includes(V.kind)||["padding","numberArray"].includes(B.kind)&&["value","number","array"].includes(V.kind)||B.kind==="colorArray"&&["value","string","array"].includes(V.kind)||B.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(V.kind))R=v(R,B,f.typeAnnotation||"coerce");else if(this.checkSubtype(B,V))return null}else R=v(R,B,f.typeAnnotation||"assert")}if(!(R instanceof oa)&&R.type.kind!=="resolvedImage"&&this._isConstant(R)){const B=new Mu;try{R=new oa(R.type,R.evaluate(B))}catch(V){return this.error(V.message),null}}return R}return this.error(`Unknown expression "${S}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,f,v){const S=typeof l=="number"?this.path.concat(l):this.path,k=v?this.scope.concat(v):this.scope;return new go(this.registry,this._isConstant,S,f||null,k,this.errors)}error(l,...f){const v=`${this.key}${f.map((S=>`[${S}]`)).join("")}`;this.errors.push(new Nn(v,l))}checkSubtype(l,f){const v=ga(l,f);return v&&this.error(v),v}}class ji{constructor(l,f){this.type=f.type,this.bindings=[].concat(l),this.result=f}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const f of this.bindings)l(f[1]);l(this.result)}static parse(l,f){if(l.length<4)return f.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const v=[];for(let k=1;k<l.length-1;k+=2){const R=l[k];if(typeof R!="string")return f.error(`Expected string, but found ${typeof R} instead.`,k);if(/[^a-zA-Z0-9_]/.test(R))return f.error("Variable names must contain only alphanumeric characters or '_'.",k);const B=f.parse(l[k+1],k+1);if(!B)return null;v.push([R,B])}const S=f.parse(l[l.length-1],l.length-1,f.expectedType,v);return S?new ji(v,S):null}outputDefined(){return this.result.outputDefined()}}class qs{constructor(l,f){this.type=f.type,this.name=l,this.boundExpression=f}static parse(l,f){if(l.length!==2||typeof l[1]!="string")return f.error("'var' expression requires exactly one string literal argument.");const v=l[1];return f.scope.has(v)?new qs(v,f.scope.get(v)):f.error(`Unknown variable "${v}". Make sure "${v}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class ii{constructor(l,f,v){this.type=l,this.index=f,this.input=v}static parse(l,f){if(l.length!==3)return f.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const v=f.parse(l[1],1,Fr),S=f.parse(l[2],2,xi(f.expectedType||zn));return v&&S?new ii(S.type.itemType,v,S):null}evaluate(l){const f=this.index.evaluate(l),v=this.input.evaluate(l);if(f<0)throw new hi(`Array index out of bounds: ${f} < 0.`);if(f>=v.length)throw new hi(`Array index out of bounds: ${f} > ${v.length-1}.`);if(f!==Math.floor(f))throw new hi(`Array index must be an integer, but found ${f} instead.`);return v[f]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class ri{constructor(l,f){this.type=Bn,this.needle=l,this.haystack=f}static parse(l,f){if(l.length!==3)return f.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const v=f.parse(l[1],1,zn),S=f.parse(l[2],2,zn);return v&&S?Za(v.type,[Bn,Mn,Fr,Ci,zn])?new ri(v,S):f.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(v.type)} instead`):null}evaluate(l){const f=this.needle.evaluate(l),v=this.haystack.evaluate(l);if(!v)return!1;if(!ds(f,["boolean","string","number","null"]))throw new hi(`Expected first argument to be of type boolean, string, number or null, but found ${zi(Mi(f))} instead.`);if(!ds(v,["string","array"]))throw new hi(`Expected second argument to be of type array or string, but found ${zi(Mi(v))} instead.`);return v.indexOf(f)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class Do{constructor(l,f,v){this.type=Fr,this.needle=l,this.haystack=f,this.fromIndex=v}static parse(l,f){if(l.length<=2||l.length>=5)return f.error(`Expected 2 or 3 arguments, but found ${l.length-1} instead.`);const v=f.parse(l[1],1,zn),S=f.parse(l[2],2,zn);if(!v||!S)return null;if(!Za(v.type,[Bn,Mn,Fr,Ci,zn]))return f.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(v.type)} instead`);if(l.length===4){const k=f.parse(l[3],3,Fr);return k?new Do(v,S,k):null}return new Do(v,S)}evaluate(l){const f=this.needle.evaluate(l),v=this.haystack.evaluate(l);if(!ds(f,["boolean","string","number","null"]))throw new hi(`Expected first argument to be of type boolean, string, number or null, but found ${zi(Mi(f))} instead.`);let S;if(this.fromIndex&&(S=this.fromIndex.evaluate(l)),ds(v,["string"])){const k=v.indexOf(f,S);return k===-1?-1:[...v.slice(0,k)].length}if(ds(v,["array"]))return v.indexOf(f,S);throw new hi(`Expected second argument to be of type array or string, but found ${zi(Mi(v))} instead.`)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class ai{constructor(l,f,v,S,k,R){this.inputType=l,this.type=f,this.input=v,this.cases=S,this.outputs=k,this.otherwise=R}static parse(l,f){if(l.length<5)return f.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return f.error("Expected an even number of arguments.");let v,S;f.expectedType&&f.expectedType.kind!=="value"&&(S=f.expectedType);const k={},R=[];for(let Z=2;Z<l.length-1;Z+=2){let ie=l[Z];const ce=l[Z+1];Array.isArray(ie)||(ie=[ie]);const ve=f.concat(Z);if(ie.length===0)return ve.error("Expected at least one branch label.");for(const Ne of ie){if(typeof Ne!="number"&&typeof Ne!="string")return ve.error("Branch labels must be numbers or strings.");if(typeof Ne=="number"&&Math.abs(Ne)>Number.MAX_SAFE_INTEGER)return ve.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Ne=="number"&&Math.floor(Ne)!==Ne)return ve.error("Numeric branch labels must be integer values.");if(v){if(ve.checkSubtype(v,Mi(Ne)))return null}else v=Mi(Ne);if(k[String(Ne)]!==void 0)return ve.error("Branch labels must be unique.");k[String(Ne)]=R.length}const Se=f.parse(ce,Z,S);if(!Se)return null;S=S||Se.type,R.push(Se)}const B=f.parse(l[1],1,zn);if(!B)return null;const V=f.parse(l[l.length-1],l.length-1,S);return V?B.type.kind!=="value"&&f.concat(1).checkSubtype(v,B.type)?null:new ai(v,S,B,k,R,V):null}evaluate(l){const f=this.input.evaluate(l);return(Mi(f)===this.inputType&&this.outputs[this.cases[f]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every((l=>l.outputDefined()))&&this.otherwise.outputDefined()}}class ue{constructor(l,f,v){this.type=l,this.branches=f,this.otherwise=v}static parse(l,f){if(l.length<4)return f.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return f.error("Expected an odd number of arguments.");let v;f.expectedType&&f.expectedType.kind!=="value"&&(v=f.expectedType);const S=[];for(let R=1;R<l.length-1;R+=2){const B=f.parse(l[R],R,Bn);if(!B)return null;const V=f.parse(l[R+1],R+1,v);if(!V)return null;S.push([B,V]),v=v||V.type}const k=f.parse(l[l.length-1],l.length-1,v);if(!k)return null;if(!v)throw new Error("Can't infer output type");return new ue(v,S,k)}evaluate(l){for(const[f,v]of this.branches)if(f.evaluate(l))return v.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[f,v]of this.branches)l(f),l(v);l(this.otherwise)}outputDefined(){return this.branches.every((([l,f])=>f.outputDefined()))&&this.otherwise.outputDefined()}}class Ge{constructor(l,f,v,S){this.type=l,this.input=f,this.beginIndex=v,this.endIndex=S}static parse(l,f){if(l.length<=2||l.length>=5)return f.error(`Expected 2 or 3 arguments, but found ${l.length-1} instead.`);const v=f.parse(l[1],1,zn),S=f.parse(l[2],2,Fr);if(!v||!S)return null;if(!Za(v.type,[xi(zn),Mn,zn]))return f.error(`Expected first argument to be of type array or string, but found ${zi(v.type)} instead`);if(l.length===4){const k=f.parse(l[3],3,Fr);return k?new Ge(v.type,v,S,k):null}return new Ge(v.type,v,S)}evaluate(l){const f=this.input.evaluate(l),v=this.beginIndex.evaluate(l);let S;if(this.endIndex&&(S=this.endIndex.evaluate(l)),ds(f,["string"]))return[...f].slice(v,S).join("");if(ds(f,["array"]))return f.slice(v,S);throw new hi(`Expected first argument to be of type array or string, but found ${zi(Mi(f))} instead.`)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function bt(p,l){const f=p.length-1;let v,S,k=0,R=f,B=0;for(;k<=R;)if(B=Math.floor((k+R)/2),v=p[B],S=p[B+1],v<=l){if(B===f||l<S)return B;k=B+1}else{if(!(v>l))throw new hi("Input is not a number.");R=B-1}return 0}class Bt{constructor(l,f,v){this.type=l,this.input=f,this.labels=[],this.outputs=[];for(const[S,k]of v)this.labels.push(S),this.outputs.push(k)}static parse(l,f){if(l.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return f.error("Expected an even number of arguments.");const v=f.parse(l[1],1,Fr);if(!v)return null;const S=[];let k=null;f.expectedType&&f.expectedType.kind!=="value"&&(k=f.expectedType);for(let R=1;R<l.length;R+=2){const B=R===1?-1/0:l[R],V=l[R+1],Z=R,ie=R+1;if(typeof B!="number")return f.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(S.length&&S[S.length-1][0]>=B)return f.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Z);const ce=f.parse(V,ie,k);if(!ce)return null;k=k||ce.type,S.push([B,ce])}return new Bt(k,v,S)}evaluate(l){const f=this.labels,v=this.outputs;if(f.length===1)return v[0].evaluate(l);const S=this.input.evaluate(l);if(S<=f[0])return v[0].evaluate(l);const k=f.length;return S>=f[k-1]?v[k-1].evaluate(l):v[bt(f,S)].evaluate(l)}eachChild(l){l(this.input);for(const f of this.outputs)l(f)}outputDefined(){return this.outputs.every((l=>l.outputDefined()))}}function sr(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var Nr,Zr,Ln=(function(){if(Zr)return Nr;function p(l,f,v,S){this.cx=3*l,this.bx=3*(v-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*f,this.by=3*(S-f)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=f,this.p2x=v,this.p2y=S}return Zr=1,Nr=p,p.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,f){if(f===void 0&&(f=1e-6),l<0)return 0;if(l>1)return 1;for(var v=l,S=0;S<8;S++){var k=this.sampleCurveX(v)-l;if(Math.abs(k)<f)return v;var R=this.sampleCurveDerivativeX(v);if(Math.abs(R)<1e-6)break;v-=k/R}var B=0,V=1;for(v=l,S=0;S<20&&(k=this.sampleCurveX(v),!(Math.abs(k-l)<f));S++)l>k?B=v:V=v,v=.5*(V-B)+B;return v},solve:function(l,f){return this.sampleCurveY(this.solveCurveX(l,f))}},Nr})(),qn=sr(Ln);class Un{constructor(l,f,v,S,k){this.type=l,this.operator=f,this.interpolation=v,this.input=S,this.labels=[],this.outputs=[];for(const[R,B]of k)this.labels.push(R),this.outputs.push(B)}static interpolationFactor(l,f,v,S){let k=0;if(l.name==="exponential")k=ui(f,l.base,v,S);else if(l.name==="linear")k=ui(f,1,v,S);else if(l.name==="cubic-bezier"){const R=l.controlPoints;k=new qn(R[0],R[1],R[2],R[3]).solve(ui(f,1,v,S))}return k}static parse(l,f){let[v,S,k,...R]=l;if(!Array.isArray(S)||S.length===0)return f.error("Expected an interpolation type expression.",1);if(S[0]==="linear")S={name:"linear"};else if(S[0]==="exponential"){const Z=S[1];if(typeof Z!="number")return f.error("Exponential interpolation requires a numeric base.",1,1);S={name:"exponential",base:Z}}else{if(S[0]!=="cubic-bezier")return f.error(`Unknown interpolation type ${String(S[0])}`,1,0);{const Z=S.slice(1);if(Z.length!==4||Z.some((ie=>typeof ie!="number"||ie<0||ie>1)))return f.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);S={name:"cubic-bezier",controlPoints:Z}}}if(l.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return f.error("Expected an even number of arguments.");if(k=f.parse(k,2,Fr),!k)return null;const B=[];let V=null;v!=="interpolate-hcl"&&v!=="interpolate-lab"||f.expectedType==Ca?f.expectedType&&f.expectedType.kind!=="value"&&(V=f.expectedType):V=ei;for(let Z=0;Z<R.length;Z+=2){const ie=R[Z],ce=R[Z+1],ve=Z+3,Se=Z+4;if(typeof ie!="number")return f.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ve);if(B.length&&B[B.length-1][0]>=ie)return f.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ve);const Ne=f.parse(ce,Se,V);if(!Ne)return null;V=V||Ne.type,B.push([ie,Ne])}return Aa(V,Fr)||Aa(V,ua)||Aa(V,ei)||Aa(V,fs)||Aa(V,Mo)||Aa(V,Ca)||Aa(V,ol)||Aa(V,xi(Fr))?new Un(V,v,S,k,B):f.error(`Type ${zi(V)} is not interpolatable.`)}evaluate(l){const f=this.labels,v=this.outputs;if(f.length===1)return v[0].evaluate(l);const S=this.input.evaluate(l);if(S<=f[0])return v[0].evaluate(l);const k=f.length;if(S>=f[k-1])return v[k-1].evaluate(l);const R=bt(f,S),B=Un.interpolationFactor(this.interpolation,S,f[R],f[R+1]),V=v[R].evaluate(l),Z=v[R+1].evaluate(l);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Wr(V,Z,B);case"color":return kr.interpolate(V,Z,B);case"padding":return Mr.interpolate(V,Z,B);case"colorArray":return mn.interpolate(V,Z,B);case"numberArray":return fn.interpolate(V,Z,B);case"variableAnchorOffsetCollection":return ba.interpolate(V,Z,B);case"array":return on(V,Z,B);case"projectionDefinition":return fi.interpolate(V,Z,B)}case"interpolate-hcl":switch(this.type.kind){case"color":return kr.interpolate(V,Z,B,"hcl");case"colorArray":return mn.interpolate(V,Z,B,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return kr.interpolate(V,Z,B,"lab");case"colorArray":return mn.interpolate(V,Z,B,"lab")}}}eachChild(l){l(this.input);for(const f of this.outputs)l(f)}outputDefined(){return this.outputs.every((l=>l.outputDefined()))}}function ui(p,l,f,v){const S=v-f,k=p-f;return S===0?0:l===1?k/S:(Math.pow(l,k)-1)/(Math.pow(l,S)-1)}const Hn={color:kr.interpolate,number:Wr,padding:Mr.interpolate,numberArray:fn.interpolate,colorArray:mn.interpolate,variableAnchorOffsetCollection:ba.interpolate,array:on};class Ui{constructor(l,f){this.type=l,this.args=f}static parse(l,f){if(l.length<2)return f.error("Expected at least one argument.");let v=null;const S=f.expectedType;S&&S.kind!=="value"&&(v=S);const k=[];for(const B of l.slice(1)){const V=f.parse(B,1+k.length,v,void 0,{typeAnnotation:"omit"});if(!V)return null;v=v||V.type,k.push(V)}if(!v)throw new Error("No output type");const R=S&&k.some((B=>ga(S,B.type)));return new Ui(R?zn:v,k)}evaluate(l){let f,v=null,S=0;for(const k of this.args)if(S++,v=k.evaluate(l),v&&v instanceof wi&&!v.available&&(f||(f=v.name),v=null,S===this.args.length&&(v=f)),v!==null)break;return v}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every((l=>l.outputDefined()))}}function Xi(p,l){return p==="=="||p==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function ra(p,l,f,v){return v.compare(l,f)===0}function Si(p,l,f){const v=p!=="=="&&p!=="!=";return class $G{constructor(k,R,B){this.type=Bn,this.lhs=k,this.rhs=R,this.collator=B,this.hasUntypedArgument=k.type.kind==="value"||R.type.kind==="value"}static parse(k,R){if(k.length!==3&&k.length!==4)return R.error("Expected two or three arguments.");const B=k[0];let V=R.parse(k[1],1,zn);if(!V)return null;if(!Xi(B,V.type))return R.concat(1).error(`"${B}" comparisons are not supported for type '${zi(V.type)}'.`);let Z=R.parse(k[2],2,zn);if(!Z)return null;if(!Xi(B,Z.type))return R.concat(2).error(`"${B}" comparisons are not supported for type '${zi(Z.type)}'.`);if(V.type.kind!==Z.type.kind&&V.type.kind!=="value"&&Z.type.kind!=="value")return R.error(`Cannot compare types '${zi(V.type)}' and '${zi(Z.type)}'.`);v&&(V.type.kind==="value"&&Z.type.kind!=="value"?V=new Ka(Z.type,[V]):V.type.kind!=="value"&&Z.type.kind==="value"&&(Z=new Ka(V.type,[Z])));let ie=null;if(k.length===4){if(V.type.kind!=="string"&&Z.type.kind!=="string"&&V.type.kind!=="value"&&Z.type.kind!=="value")return R.error("Cannot use collator to compare non-string types.");if(ie=R.parse(k[3],3,La),!ie)return null}return new $G(V,Z,ie)}evaluate(k){const R=this.lhs.evaluate(k),B=this.rhs.evaluate(k);if(v&&this.hasUntypedArgument){const V=Mi(R),Z=Mi(B);if(V.kind!==Z.kind||V.kind!=="string"&&V.kind!=="number")throw new hi(`Expected arguments for "${p}" to be (string, string) or (number, number), but found (${V.kind}, ${Z.kind}) instead.`)}if(this.collator&&!v&&this.hasUntypedArgument){const V=Mi(R),Z=Mi(B);if(V.kind!=="string"||Z.kind!=="string")return l(k,R,B)}return this.collator?f(k,R,B,this.collator.evaluate(k)):l(k,R,B)}eachChild(k){k(this.lhs),k(this.rhs),this.collator&&k(this.collator)}outputDefined(){return!0}}}const Ia=Si("==",(function(p,l,f){return l===f}),ra),za=Si("!=",(function(p,l,f){return l!==f}),(function(p,l,f,v){return!ra(0,l,f,v)})),Hs=Si("<",(function(p,l,f){return l<f}),(function(p,l,f,v){return v.compare(l,f)<0})),ll=Si(">",(function(p,l,f){return l>f}),(function(p,l,f,v){return v.compare(l,f)>0})),Ws=Si("<=",(function(p,l,f){return l<=f}),(function(p,l,f,v){return v.compare(l,f)<=0})),$o=Si(">=",(function(p,l,f){return l>=f}),(function(p,l,f,v){return v.compare(l,f)>=0}));class Gs{constructor(l,f,v){this.type=La,this.locale=v,this.caseSensitive=l,this.diacriticSensitive=f}static parse(l,f){if(l.length!==2)return f.error("Expected one argument.");const v=l[1];if(typeof v!="object"||Array.isArray(v))return f.error("Collator options argument must be an object.");const S=f.parse(v["case-sensitive"]!==void 0&&v["case-sensitive"],1,Bn);if(!S)return null;const k=f.parse(v["diacritic-sensitive"]!==void 0&&v["diacritic-sensitive"],1,Bn);if(!k)return null;let R=null;return v.locale&&(R=f.parse(v.locale,1,Mn),!R)?null:new Gs(S,k,R)}evaluate(l){return new ti(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class Pa{constructor(l,f,v,S,k){this.type=Mn,this.number=l,this.locale=f,this.currency=v,this.minFractionDigits=S,this.maxFractionDigits=k}static parse(l,f){if(l.length!==3)return f.error("Expected two arguments.");const v=f.parse(l[1],1,Fr);if(!v)return null;const S=l[2];if(typeof S!="object"||Array.isArray(S))return f.error("NumberFormat options argument must be an object.");let k=null;if(S.locale&&(k=f.parse(S.locale,1,Mn),!k))return null;let R=null;if(S.currency&&(R=f.parse(S.currency,1,Mn),!R))return null;let B=null;if(S["min-fraction-digits"]&&(B=f.parse(S["min-fraction-digits"],1,Fr),!B))return null;let V=null;return S["max-fraction-digits"]&&(V=f.parse(S["max-fraction-digits"],1,Fr),!V)?null:new Pa(v,k,R,B,V)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class Xs{constructor(l){this.type=Gi,this.sections=l}static parse(l,f){if(l.length<2)return f.error("Expected at least one argument.");const v=l[1];if(!Array.isArray(v)&&typeof v=="object")return f.error("First argument must be an image or text section.");const S=[];let k=!1;for(let R=1;R<=l.length-1;++R){const B=l[R];if(k&&typeof B=="object"&&!Array.isArray(B)){k=!1;let V=null;if(B["font-scale"]&&(V=f.parse(B["font-scale"],1,Fr),!V))return null;let Z=null;if(B["text-font"]&&(Z=f.parse(B["text-font"],1,xi(Mn)),!Z))return null;let ie=null;if(B["text-color"]&&(ie=f.parse(B["text-color"],1,ei),!ie))return null;let ce=null;if(B["vertical-align"]){if(typeof B["vertical-align"]=="string"&&!Ri.includes(B["vertical-align"]))return f.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${B["vertical-align"]}' instead.`);if(ce=f.parse(B["vertical-align"],1,Mn),!ce)return null}const ve=S[S.length-1];ve.scale=V,ve.font=Z,ve.textColor=ie,ve.verticalAlign=ce}else{const V=f.parse(l[R],1,zn);if(!V)return null;const Z=V.type.kind;if(Z!=="string"&&Z!=="value"&&Z!=="null"&&Z!=="resolvedImage")return f.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");k=!0,S.push({content:V,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Xs(S)}evaluate(l){return new _n(this.sections.map((f=>{const v=f.content.evaluate(l);return Mi(v)===Ya?new $n("",v,null,null,null,f.verticalAlign?f.verticalAlign.evaluate(l):null):new $n(Cs(v),null,f.scale?f.scale.evaluate(l):null,f.font?f.font.evaluate(l).join(","):null,f.textColor?f.textColor.evaluate(l):null,f.verticalAlign?f.verticalAlign.evaluate(l):null)})))}eachChild(l){for(const f of this.sections)l(f.content),f.scale&&l(f.scale),f.font&&l(f.font),f.textColor&&l(f.textColor),f.verticalAlign&&l(f.verticalAlign)}outputDefined(){return!1}}class Il{constructor(l){this.type=Ya,this.input=l}static parse(l,f){if(l.length!==2)return f.error("Expected two arguments.");const v=f.parse(l[1],1,Mn);return v?new Il(v):f.error("No image name provided.")}evaluate(l){const f=this.input.evaluate(l),v=wi.fromString(f);return v&&l.availableImages&&(v.available=l.availableImages.indexOf(f)>-1),v}eachChild(l){l(this.input)}outputDefined(){return!1}}class gs{constructor(l){this.type=Fr,this.input=l}static parse(l,f){if(l.length!==2)return f.error(`Expected 1 argument, but found ${l.length-1} instead.`);const v=f.parse(l[1],1);return v?v.type.kind!=="array"&&v.type.kind!=="string"&&v.type.kind!=="value"?f.error(`Expected argument of type string or array, but found ${zi(v.type)} instead.`):new gs(v):null}evaluate(l){const f=this.input.evaluate(l);if(typeof f=="string")return[...f].length;if(Array.isArray(f))return f.length;throw new hi(`Expected value to be of type string or array, but found ${zi(Mi(f))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const Di=8192;function qo(p,l){const f=(180+p[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+p[1]*Math.PI/360)))/360,S=Math.pow(2,l.z);return[Math.round(f*S*Di),Math.round(v*S*Di)]}function Da(p,l){const f=Math.pow(2,l.z);return[(S=(p[0]/Di+l.x)/f,360*S-180),(v=(p[1]/Di+l.y)/f,360/Math.PI*Math.atan(Math.exp((180-360*v)*Math.PI/180))-90)];var v,S}function ns(p,l){p[0]=Math.min(p[0],l[0]),p[1]=Math.min(p[1],l[1]),p[2]=Math.max(p[2],l[0]),p[3]=Math.max(p[3],l[1])}function As(p,l){return!(p[0]<=l[0]||p[2]>=l[2]||p[1]<=l[1]||p[3]>=l[3])}function Ja(p,l,f){const v=p[0]-l[0],S=p[1]-l[1],k=p[0]-f[0],R=p[1]-f[1];return v*R-k*S==0&&v*k<=0&&S*R<=0}function rc(p,l,f,v){return(S=[v[0]-f[0],v[1]-f[1]])[0]*(k=[l[0]-p[0],l[1]-p[1]])[1]-S[1]*k[0]!=0&&!(!ic(p,l,f,v)||!ic(f,v,p,l));var S,k}function uu(p,l,f){for(const v of f)for(let S=0;S<v.length-1;++S)if(rc(p,l,v[S],v[S+1]))return!0;return!1}function Ys(p,l,f=!1){let v=!1;for(const B of l)for(let V=0;V<B.length-1;V++){if(Ja(p,B[V],B[V+1]))return f;(k=B[V])[1]>(S=p)[1]!=(R=B[V+1])[1]>S[1]&&S[0]<(R[0]-k[0])*(S[1]-k[1])/(R[1]-k[1])+k[0]&&(v=!v)}var S,k,R;return v}function ja(p,l){for(const f of l)if(Ys(p,f))return!0;return!1}function Is(p,l){for(const f of p)if(!Ys(f,l))return!1;for(let f=0;f<p.length-1;++f)if(uu(p[f],p[f+1],l))return!1;return!0}function nc(p,l){for(const f of l)if(Is(p,f))return!0;return!1}function ic(p,l,f,v){const S=v[0]-f[0],k=v[1]-f[1],R=(p[0]-f[0])*k-S*(p[1]-f[1]),B=(l[0]-f[0])*k-S*(l[1]-f[1]);return R>0&&B<0||R<0&&B>0}function ul(p,l,f){const v=[];for(let S=0;S<p.length;S++){const k=[];for(let R=0;R<p[S].length;R++){const B=qo(p[S][R],f);ns(l,B),k.push(B)}v.push(k)}return v}function cu(p,l,f){const v=[];for(let S=0;S<p.length;S++){const k=ul(p[S],l,f);v.push(k)}return v}function Oo(p,l,f,v){if(p[0]<f[0]||p[0]>f[2]){const S=.5*v;let k=p[0]-f[0]>S?-v:f[0]-p[0]>S?v:0;k===0&&(k=p[0]-f[2]>S?-v:f[2]-p[0]>S?v:0),p[0]+=k}ns(l,p)}function mo(p,l,f,v){const S=Math.pow(2,v.z)*Di,k=[v.x*Di,v.y*Di],R=[];for(const B of p)for(const V of B){const Z=[V.x+k[0],V.y+k[1]];Oo(Z,l,f,S),R.push(Z)}return R}function Du(p,l,f,v){const S=Math.pow(2,v.z)*Di,k=[v.x*Di,v.y*Di],R=[];for(const V of p){const Z=[];for(const ie of V){const ce=[ie.x+k[0],ie.y+k[1]];ns(l,ce),Z.push(ce)}R.push(Z)}if(l[2]-l[0]<=S/2){(B=l)[0]=B[1]=1/0,B[2]=B[3]=-1/0;for(const V of R)for(const Z of V)Oo(Z,l,f,S)}var B;return R}class Ua{constructor(l,f){this.type=Bn,this.geojson=l,this.geometries=f}static parse(l,f){if(l.length!==2)return f.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Vs(l[1])){const v=l[1];if(v.type==="FeatureCollection"){const S=[];for(const k of v.features){const{type:R,coordinates:B}=k.geometry;R==="Polygon"&&S.push(B),R==="MultiPolygon"&&S.push(...B)}if(S.length)return new Ua(v,{type:"MultiPolygon",coordinates:S})}else if(v.type==="Feature"){const S=v.geometry.type;if(S==="Polygon"||S==="MultiPolygon")return new Ua(v,v.geometry)}else if(v.type==="Polygon"||v.type==="MultiPolygon")return new Ua(v,v)}return f.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return(function(f,v){const S=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],R=f.canonicalID();if(v.type==="Polygon"){const B=ul(v.coordinates,k,R),V=mo(f.geometry(),S,k,R);if(!As(S,k))return!1;for(const Z of V)if(!Ys(Z,B))return!1}if(v.type==="MultiPolygon"){const B=cu(v.coordinates,k,R),V=mo(f.geometry(),S,k,R);if(!As(S,k))return!1;for(const Z of V)if(!ja(Z,B))return!1}return!0})(l,this.geometries);if(l.geometryType()==="LineString")return(function(f,v){const S=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],R=f.canonicalID();if(v.type==="Polygon"){const B=ul(v.coordinates,k,R),V=Du(f.geometry(),S,k,R);if(!As(S,k))return!1;for(const Z of V)if(!Is(Z,B))return!1}if(v.type==="MultiPolygon"){const B=cu(v.coordinates,k,R),V=Du(f.geometry(),S,k,R);if(!As(S,k))return!1;for(const Z of V)if(!nc(Z,B))return!1}return!0})(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let hu=class{constructor(p=[],l=(f,v)=>f<v?-1:f>v?1:0){if(this.data=p,this.length=this.data.length,this.compare=l,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(p){this.data.push(p),this._up(this.length++)}pop(){if(this.length===0)return;const p=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),p}peek(){return this.data[0]}_up(p){const{data:l,compare:f}=this,v=l[p];for(;p>0;){const S=p-1>>1,k=l[S];if(f(v,k)>=0)break;l[p]=k,p=S}l[p]=v}_down(p){const{data:l,compare:f}=this,v=this.length>>1,S=l[p];for(;p<v;){let k=1+(p<<1);const R=k+1;if(R<this.length&&f(l[R],l[k])<0&&(k=R),f(l[k],S)>=0)break;l[p]=l[k],p=k}l[p]=S}};function Zs(p,l,f=0,v=p.length-1,S=Va){for(;v>f;){if(v-f>600){const V=v-f+1,Z=l-f+1,ie=Math.log(V),ce=.5*Math.exp(2*ie/3),ve=.5*Math.sqrt(ie*ce*(V-ce)/V)*(Z-V/2<0?-1:1);Zs(p,l,Math.max(f,Math.floor(l-Z*ce/V+ve)),Math.min(v,Math.floor(l+(V-Z)*ce/V+ve)),S)}const k=p[l];let R=f,B=v;for(ms(p,f,l),S(p[v],k)>0&&ms(p,f,v);R<B;){for(ms(p,R,B),R++,B--;S(p[R],k)<0;)R++;for(;S(p[B],k)>0;)B--}S(p[f],k)===0?ms(p,f,B):(B++,ms(p,B,v)),B<=l&&(f=B+1),l<=B&&(v=B-1)}}function ms(p,l,f){const v=p[l];p[l]=p[f],p[f]=v}function Va(p,l){return p<l?-1:p>l?1:0}function Vl(p,l){if(p.length<=1)return[p];const f=[];let v,S;for(const k of p){const R=hl(k);R!==0&&(k.area=Math.abs(R),S===void 0&&(S=R<0),S===R<0?(v&&f.push(v),v=[k]):v.push(k))}if(v&&f.push(v),l>1)for(let k=0;k<f.length;k++)f[k].length<=l||(Zs(f[k],l,1,f[k].length-1,cl),f[k]=f[k].slice(0,l));return f}function cl(p,l){return l.area-p.area}function hl(p){let l=0;for(let f,v,S=0,k=p.length,R=k-1;S<k;R=S++)f=p[S],v=p[R],l+=(v.x-f.x)*(f.y+v.y);return l}const $l=1/298.257223563,ql=$l*(2-$l),fl=Math.PI/180;class Hl{constructor(l){const f=6378.137*fl*1e3,v=Math.cos(l*fl),S=1/(1-ql*(1-v*v)),k=Math.sqrt(S);this.kx=f*k*v,this.ky=f*k*S*(1-ql)}distance(l,f){const v=this.wrap(l[0]-f[0])*this.kx,S=(l[1]-f[1])*this.ky;return Math.sqrt(v*v+S*S)}pointOnLine(l,f){let v,S,k,R,B=1/0;for(let V=0;V<l.length-1;V++){let Z=l[V][0],ie=l[V][1],ce=this.wrap(l[V+1][0]-Z)*this.kx,ve=(l[V+1][1]-ie)*this.ky,Se=0;ce===0&&ve===0||(Se=(this.wrap(f[0]-Z)*this.kx*ce+(f[1]-ie)*this.ky*ve)/(ce*ce+ve*ve),Se>1?(Z=l[V+1][0],ie=l[V+1][1]):Se>0&&(Z+=ce/this.kx*Se,ie+=ve/this.ky*Se)),ce=this.wrap(f[0]-Z)*this.kx,ve=(f[1]-ie)*this.ky;const Ne=ce*ce+ve*ve;Ne<B&&(B=Ne,v=Z,S=ie,k=V,R=Se)}return{point:[v,S],index:k,t:Math.max(0,Math.min(1,R))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}function Ou(p,l){return l[0]-p[0]}function tr(p){return p[1]-p[0]+1}function mr(p,l){return p[1]>=p[0]&&p[1]<l}function dn(p,l){if(p[0]>p[1])return[null,null];const f=tr(p);if(l){if(f===2)return[p,null];const S=Math.floor(f/2);return[[p[0],p[0]+S],[p[0]+S,p[1]]]}if(f===1)return[p,null];const v=Math.floor(f/2)-1;return[[p[0],p[0]+v],[p[0]+v+1,p[1]]]}function In(p,l){if(!mr(l,p.length))return[1/0,1/0,-1/0,-1/0];const f=[1/0,1/0,-1/0,-1/0];for(let v=l[0];v<=l[1];++v)ns(f,p[v]);return f}function vi(p){const l=[1/0,1/0,-1/0,-1/0];for(const f of p)for(const v of f)ns(l,v);return l}function Pn(p){return p[0]!==-1/0&&p[1]!==-1/0&&p[2]!==1/0&&p[3]!==1/0}function I(p,l,f){if(!Pn(p)||!Pn(l))return NaN;let v=0,S=0;return p[2]<l[0]&&(v=l[0]-p[2]),p[0]>l[2]&&(v=p[0]-l[2]),p[1]>l[3]&&(S=p[1]-l[3]),p[3]<l[1]&&(S=l[1]-p[3]),f.distance([0,0],[v,S])}function y(p,l,f){const v=f.pointOnLine(l,p);return f.distance(p,v.point)}function _(p,l,f,v,S){const k=Math.min(y(p,[f,v],S),y(l,[f,v],S)),R=Math.min(y(f,[p,l],S),y(v,[p,l],S));return Math.min(k,R)}function P(p,l,f,v,S){if(!mr(l,p.length)||!mr(v,f.length))return 1/0;let k=1/0;for(let R=l[0];R<l[1];++R){const B=p[R],V=p[R+1];for(let Z=v[0];Z<v[1];++Z){const ie=f[Z],ce=f[Z+1];if(rc(B,V,ie,ce))return 0;k=Math.min(k,_(B,V,ie,ce,S))}}return k}function $(p,l,f,v,S){if(!mr(l,p.length)||!mr(v,f.length))return NaN;let k=1/0;for(let R=l[0];R<=l[1];++R)for(let B=v[0];B<=v[1];++B)if(k=Math.min(k,S.distance(p[R],f[B])),k===0)return k;return k}function ne(p,l,f){if(Ys(p,l,!0))return 0;let v=1/0;for(const S of l){const k=S[0],R=S[S.length-1];if(k!==R&&(v=Math.min(v,y(p,[R,k],f)),v===0))return v;const B=f.pointOnLine(S,p);if(v=Math.min(v,f.distance(p,B.point)),v===0)return v}return v}function ye(p,l,f,v){if(!mr(l,p.length))return NaN;for(let k=l[0];k<=l[1];++k)if(Ys(p[k],f,!0))return 0;let S=1/0;for(let k=l[0];k<l[1];++k){const R=p[k],B=p[k+1];for(const V of f)for(let Z=0,ie=V.length,ce=ie-1;Z<ie;ce=Z++){const ve=V[ce],Se=V[Z];if(rc(R,B,ve,Se))return 0;S=Math.min(S,_(R,B,ve,Se,v))}}return S}function Oe(p,l){for(const f of p)for(const v of f)if(Ys(v,l,!0))return!0;return!1}function tt(p,l,f,v=1/0){const S=vi(p),k=vi(l);if(v!==1/0&&I(S,k,f)>=v)return v;if(As(S,k)){if(Oe(p,l))return 0}else if(Oe(l,p))return 0;let R=1/0;for(const B of p)for(let V=0,Z=B.length,ie=Z-1;V<Z;ie=V++){const ce=B[ie],ve=B[V];for(const Se of l)for(let Ne=0,ze=Se.length,Ve=ze-1;Ne<ze;Ve=Ne++){const et=Se[Ve],Ct=Se[Ne];if(rc(ce,ve,et,Ct))return 0;R=Math.min(R,_(ce,ve,et,Ct,f))}}return R}function ht(p,l,f,v,S,k){if(!k)return;const R=I(In(v,k),S,f);R<l&&p.push([R,k,[0,0]])}function rr(p,l,f,v,S,k,R){if(!k||!R)return;const B=I(In(v,k),In(S,R),f);B<l&&p.push([B,k,R])}function ur(p,l,f,v,S=1/0){let k=Math.min(v.distance(p[0],f[0][0]),S);if(k===0)return k;const R=new hu([[0,[0,p.length-1],[0,0]]],Ou),B=vi(f);for(;R.length>0;){const V=R.pop();if(V[0]>=k)continue;const Z=V[1],ie=l?50:100;if(tr(Z)<=ie){if(!mr(Z,p.length))return NaN;if(l){const ce=ye(p,Z,f,v);if(isNaN(ce)||ce===0)return ce;k=Math.min(k,ce)}else for(let ce=Z[0];ce<=Z[1];++ce){const ve=ne(p[ce],f,v);if(k=Math.min(k,ve),k===0)return 0}}else{const ce=dn(Z,l);ht(R,k,v,p,B,ce[0]),ht(R,k,v,p,B,ce[1])}}return k}function qr(p,l,f,v,S,k=1/0){let R=Math.min(k,S.distance(p[0],f[0]));if(R===0)return R;const B=new hu([[0,[0,p.length-1],[0,f.length-1]]],Ou);for(;B.length>0;){const V=B.pop();if(V[0]>=R)continue;const Z=V[1],ie=V[2],ce=l?50:100,ve=v?50:100;if(tr(Z)<=ce&&tr(ie)<=ve){if(!mr(Z,p.length)&&mr(ie,f.length))return NaN;let Se;if(l&&v)Se=P(p,Z,f,ie,S),R=Math.min(R,Se);else if(l&&!v){const Ne=p.slice(Z[0],Z[1]+1);for(let ze=ie[0];ze<=ie[1];++ze)if(Se=y(f[ze],Ne,S),R=Math.min(R,Se),R===0)return R}else if(!l&&v){const Ne=f.slice(ie[0],ie[1]+1);for(let ze=Z[0];ze<=Z[1];++ze)if(Se=y(p[ze],Ne,S),R=Math.min(R,Se),R===0)return R}else Se=$(p,Z,f,ie,S),R=Math.min(R,Se)}else{const Se=dn(Z,l),Ne=dn(ie,v);rr(B,R,S,p,f,Se[0],Ne[0]),rr(B,R,S,p,f,Se[0],Ne[1]),rr(B,R,S,p,f,Se[1],Ne[0]),rr(B,R,S,p,f,Se[1],Ne[1])}}return R}function bn(p){return p.type==="MultiPolygon"?p.coordinates.map((l=>({type:"Polygon",coordinates:l}))):p.type==="MultiLineString"?p.coordinates.map((l=>({type:"LineString",coordinates:l}))):p.type==="MultiPoint"?p.coordinates.map((l=>({type:"Point",coordinates:l}))):[p]}class Dn{constructor(l,f){this.type=Fr,this.geojson=l,this.geometries=f}static parse(l,f){if(l.length!==2)return f.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Vs(l[1])){const v=l[1];if(v.type==="FeatureCollection")return new Dn(v,v.features.map((S=>bn(S.geometry))).flat());if(v.type==="Feature")return new Dn(v,bn(v.geometry));if("type"in v&&"coordinates"in v)return new Dn(v,bn(v))}return f.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return(function(f,v){const S=f.geometry(),k=S.flat().map((V=>Da([V.x,V.y],f.canonical)));if(S.length===0)return NaN;const R=new Hl(k[0][1]);let B=1/0;for(const V of v){switch(V.type){case"Point":B=Math.min(B,qr(k,!1,[V.coordinates],!1,R,B));break;case"LineString":B=Math.min(B,qr(k,!1,V.coordinates,!0,R,B));break;case"Polygon":B=Math.min(B,ur(k,!1,V.coordinates,R,B))}if(B===0)return B}return B})(l,this.geometries);if(l.geometryType()==="LineString")return(function(f,v){const S=f.geometry(),k=S.flat().map((V=>Da([V.x,V.y],f.canonical)));if(S.length===0)return NaN;const R=new Hl(k[0][1]);let B=1/0;for(const V of v){switch(V.type){case"Point":B=Math.min(B,qr(k,!0,[V.coordinates],!1,R,B));break;case"LineString":B=Math.min(B,qr(k,!0,V.coordinates,!0,R,B));break;case"Polygon":B=Math.min(B,ur(k,!0,V.coordinates,R,B))}if(B===0)return B}return B})(l,this.geometries);if(l.geometryType()==="Polygon")return(function(f,v){const S=f.geometry();if(S.length===0||S[0].length===0)return NaN;const k=Vl(S,0).map((V=>V.map((Z=>Z.map((ie=>Da([ie.x,ie.y],f.canonical))))))),R=new Hl(k[0][0][0][1]);let B=1/0;for(const V of v)for(const Z of k){switch(V.type){case"Point":B=Math.min(B,ur([V.coordinates],!1,Z,R,B));break;case"LineString":B=Math.min(B,ur(V.coordinates,!0,Z,R,B));break;case"Polygon":B=Math.min(B,tt(Z,V.coordinates,R,B))}if(B===0)return B}return B})(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Xn{constructor(l){this.type=zn,this.key=l}static parse(l,f){if(l.length!==2)return f.error(`Expected 1 argument, but found ${l.length-1} instead.`);const v=l[1];return v==null?f.error("Global state property must be defined."):typeof v!="string"?f.error(`Global state property must be string, but found ${typeof l[1]} instead.`):new Xn(v)}evaluate(l){var f;const v=(f=l.globals)===null||f===void 0?void 0:f.globalState;return v&&Object.keys(v).length!==0?It(v,this.key):null}eachChild(){}outputDefined(){return!1}}const Fn={"==":Ia,"!=":za,">":ll,"<":Hs,">=":$o,"<=":Ws,array:Ka,at:ii,boolean:Ka,case:ue,coalesce:Ui,collator:Gs,format:Xs,image:Il,in:ri,"index-of":Do,interpolate:Un,"interpolate-hcl":Un,"interpolate-lab":Un,length:gs,let:ji,literal:oa,match:ai,number:Ka,"number-format":Pa,object:Ka,slice:Ge,step:Bt,string:Ka,"to-boolean":Vo,"to-color":Vo,"to-number":Vo,"to-string":Vo,var:qs,within:Ua,distance:Dn,"global-state":Xn};class En{constructor(l,f,v,S){this.name=l,this.type=f,this._evaluate=v,this.args=S}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,f){const v=l[0],S=En.definitions[v];if(!S)return f.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0);const k=Array.isArray(S)?S[0]:S.type,R=Array.isArray(S)?[[S[1],S[2]]]:S.overloads,B=R.filter((([Z])=>!Array.isArray(Z)||Z.length===l.length-1));let V=null;for(const[Z,ie]of B){V=new go(f.registry,Ho,f.path,null,f.scope);const ce=[];let ve=!1;for(let Se=1;Se<l.length;Se++){const Ne=l[Se],ze=Array.isArray(Z)?Z[Se-1]:Z.type,Ve=V.parse(Ne,1+ce.length,ze);if(!Ve){ve=!0;break}ce.push(Ve)}if(!ve)if(Array.isArray(Z)&&Z.length!==ce.length)V.error(`Expected ${Z.length} arguments, but found ${ce.length} instead.`);else{for(let Se=0;Se<ce.length;Se++){const Ne=Array.isArray(Z)?Z[Se]:Z.type,ze=ce[Se];V.concat(Se+1).checkSubtype(Ne,ze.type)}if(V.errors.length===0)return new En(v,k,ie,ce)}}if(B.length===1)f.errors.push(...V.errors);else{const Z=(B.length?B:R).map((([ce])=>{return ve=ce,Array.isArray(ve)?`(${ve.map(zi).join(", ")})`:`(${zi(ve.type)}...)`;var ve})).join(" | "),ie=[];for(let ce=1;ce<l.length;ce++){const ve=f.parse(l[ce],1+ie.length);if(!ve)return null;ie.push(zi(ve.type))}f.error(`Expected arguments of type ${Z}, but found (${ie.join(", ")}) instead.`)}return null}static register(l,f){En.definitions=f;for(const v in f)l[v]=En}}function na(p,[l,f,v,S]){l=l.evaluate(p),f=f.evaluate(p),v=v.evaluate(p);const k=S?S.evaluate(p):1,R=Ts(l,f,v,k);if(R)throw new hi(R);return new kr(l/255,f/255,v/255,k,!1)}function ca(p,l){return p in l}function so(p,l){const f=l[p];return f===void 0?null:f}function ka(p){return{type:p}}function Ho(p){if(p instanceof qs)return Ho(p.boundExpression);if(p instanceof En&&p.name==="error"||p instanceof Gs||p instanceof Ua||p instanceof Dn||p instanceof Xn)return!1;const l=p instanceof Vo||p instanceof Ka;let f=!0;return p.eachChild((v=>{f=l?f&&Ho(v):f&&v instanceof oa})),!!f&&Ks(p)&&fu(p,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Ks(p){if(p instanceof En&&(p.name==="get"&&p.args.length===1||p.name==="feature-state"||p.name==="has"&&p.args.length===1||p.name==="properties"||p.name==="geometry-type"||p.name==="id"||/^filter-/.test(p.name))||p instanceof Ua||p instanceof Dn)return!1;let l=!0;return p.eachChild((f=>{l&&!Ks(f)&&(l=!1)})),l}function Pl(p){if(p instanceof En&&p.name==="feature-state")return!1;let l=!0;return p.eachChild((f=>{l&&!Pl(f)&&(l=!1)})),l}function fu(p,l){if(p instanceof En&&l.indexOf(p.name)>=0)return!1;let f=!0;return p.eachChild((v=>{f&&!fu(v,l)&&(f=!1)})),f}function du(p){return{result:"success",value:p}}function Ps(p){return{result:"error",value:p}}function Wl(p){return p["property-type"]==="data-driven"||p["property-type"]==="cross-faded-data-driven"}function Gl(p){return!!p.expression&&p.expression.parameters.indexOf("zoom")>-1}function Eo(p){return!!p.expression&&p.expression.interpolated}function ni(p){return p instanceof Number?"number":p instanceof String?"string":p instanceof Boolean?"boolean":Array.isArray(p)?"array":p===null?"null":typeof p}function Nu(p){return typeof p=="object"&&p!==null&&!Array.isArray(p)&&Mi(p)===fa}function Qh(p){return p}function yh(p,l){const f=p.stops&&typeof p.stops[0][0]=="object",v=f||!(f||p.property!==void 0),S=p.type||(Eo(l)?"exponential":"interval"),k=(function(ie){switch(ie.type){case"color":return kr.parse;case"padding":return Mr.parse;case"numberArray":return fn.parse;case"colorArray":return mn.parse;default:return null}})(l);if(k&&((p=Xr({},p)).stops&&(p.stops=p.stops.map((ie=>[ie[0],k(ie[1])]))),p.default=k(p.default?p.default:l.default)),p.colorSpace&&(R=p.colorSpace)!=="rgb"&&R!=="hcl"&&R!=="lab")throw new Error(`Unknown color space: "${p.colorSpace}"`);var R;const B=(function(ie){switch(ie){case"exponential":return $g;case"interval":return Vg;case"categorical":return Op;case"identity":return qg;default:throw new Error(`Unknown function type "${ie}"`)}})(S);let V,Z;if(S==="categorical"){V=Object.create(null);for(const ie of p.stops)V[ie[0]]=ie[1];Z=typeof p.stops[0][0]}if(f){const ie={},ce=[];for(let Ne=0;Ne<p.stops.length;Ne++){const ze=p.stops[Ne],Ve=ze[0].zoom;ie[Ve]===void 0&&(ie[Ve]={zoom:Ve,type:p.type,property:p.property,default:p.default,stops:[]},ce.push(Ve)),ie[Ve].stops.push([ze[0].value,ze[1]])}const ve=[];for(const Ne of ce)ve.push([ie[Ne].zoom,yh(ie[Ne],l)]);const Se={name:"linear"};return{kind:"composite",interpolationType:Se,interpolationFactor:Un.interpolationFactor.bind(void 0,Se),zoomStops:ve.map((Ne=>Ne[0])),evaluate:({zoom:Ne},ze)=>$g({stops:ve,base:p.base},l,Ne).evaluate(Ne,ze)}}if(v){const ie=S==="exponential"?{name:"exponential",base:p.base!==void 0?p.base:1}:null;return{kind:"camera",interpolationType:ie,interpolationFactor:Un.interpolationFactor.bind(void 0,ie),zoomStops:p.stops.map((ce=>ce[0])),evaluate:({zoom:ce})=>B(p,l,ce,V,Z)}}return{kind:"source",evaluate(ie,ce){const ve=ce&&ce.properties?ce.properties[p.property]:void 0;return ve===void 0?pu(p.default,l.default):B(p,l,ve,V,Z)}}}function pu(p,l,f){return p!==void 0?p:l!==void 0?l:f!==void 0?f:void 0}function Op(p,l,f,v,S){return pu(typeof f===S?v[f]:void 0,p.default,l.default)}function Vg(p,l,f){if(ni(f)!=="number")return pu(p.default,l.default);const v=p.stops.length;if(v===1||f<=p.stops[0][0])return p.stops[0][1];if(f>=p.stops[v-1][0])return p.stops[v-1][1];const S=bt(p.stops.map((k=>k[0])),f);return p.stops[S][1]}function $g(p,l,f){const v=p.base!==void 0?p.base:1;if(ni(f)!=="number")return pu(p.default,l.default);const S=p.stops.length;if(S===1||f<=p.stops[0][0])return p.stops[0][1];if(f>=p.stops[S-1][0])return p.stops[S-1][1];const k=bt(p.stops.map((ie=>ie[0])),f),R=(function(ie,ce,ve,Se){const Ne=Se-ve,ze=ie-ve;return Ne===0?0:ce===1?ze/Ne:(Math.pow(ce,ze)-1)/(Math.pow(ce,Ne)-1)})(f,v,p.stops[k][0],p.stops[k+1][0]),B=p.stops[k][1],V=p.stops[k+1][1],Z=Hn[l.type]||Qh;return typeof B.evaluate=="function"?{evaluate(...ie){const ce=B.evaluate.apply(void 0,ie),ve=V.evaluate.apply(void 0,ie);if(ce!==void 0&&ve!==void 0)return Z(ce,ve,R,p.colorSpace)}}:Z(B,V,R,p.colorSpace)}function qg(p,l,f){switch(l.type){case"color":f=kr.parse(f);break;case"formatted":f=_n.fromString(f.toString());break;case"resolvedImage":f=wi.fromString(f.toString());break;case"padding":f=Mr.parse(f);break;case"colorArray":f=mn.parse(f);break;case"numberArray":f=fn.parse(f);break;default:ni(f)===l.type||l.type==="enum"&&l.values[f]||(f=void 0)}return pu(f,p.default,l.default)}En.register(Fn,{error:[{kind:"error"},[Mn],(p,[l])=>{throw new hi(l.evaluate(p))}],typeof:[Mn,[zn],(p,[l])=>zi(Mi(l.evaluate(p)))],"to-rgba":[xi(Fr,4),[ei],(p,[l])=>{const[f,v,S,k]=l.evaluate(p).rgb;return[255*f,255*v,255*S,k]}],rgb:[ei,[Fr,Fr,Fr],na],rgba:[ei,[Fr,Fr,Fr,Fr],na],has:{type:Bn,overloads:[[[Mn],(p,[l])=>ca(l.evaluate(p),p.properties())],[[Mn,fa],(p,[l,f])=>ca(l.evaluate(p),f.evaluate(p))]]},get:{type:zn,overloads:[[[Mn],(p,[l])=>so(l.evaluate(p),p.properties())],[[Mn,fa],(p,[l,f])=>so(l.evaluate(p),f.evaluate(p))]]},"feature-state":[zn,[Mn],(p,[l])=>so(l.evaluate(p),p.featureState||{})],properties:[fa,[],p=>p.properties()],"geometry-type":[Mn,[],p=>p.geometryType()],id:[zn,[],p=>p.id()],zoom:[Fr,[],p=>p.globals.zoom],"heatmap-density":[Fr,[],p=>p.globals.heatmapDensity||0],elevation:[Fr,[],p=>p.globals.elevation||0],"line-progress":[Fr,[],p=>p.globals.lineProgress||0],accumulated:[zn,[],p=>p.globals.accumulated===void 0?null:p.globals.accumulated],"+":[Fr,ka(Fr),(p,l)=>{let f=0;for(const v of l)f+=v.evaluate(p);return f}],"*":[Fr,ka(Fr),(p,l)=>{let f=1;for(const v of l)f*=v.evaluate(p);return f}],"-":{type:Fr,overloads:[[[Fr,Fr],(p,[l,f])=>l.evaluate(p)-f.evaluate(p)],[[Fr],(p,[l])=>-l.evaluate(p)]]},"/":[Fr,[Fr,Fr],(p,[l,f])=>l.evaluate(p)/f.evaluate(p)],"%":[Fr,[Fr,Fr],(p,[l,f])=>l.evaluate(p)%f.evaluate(p)],ln2:[Fr,[],()=>Math.LN2],pi:[Fr,[],()=>Math.PI],e:[Fr,[],()=>Math.E],"^":[Fr,[Fr,Fr],(p,[l,f])=>Math.pow(l.evaluate(p),f.evaluate(p))],sqrt:[Fr,[Fr],(p,[l])=>Math.sqrt(l.evaluate(p))],log10:[Fr,[Fr],(p,[l])=>Math.log(l.evaluate(p))/Math.LN10],ln:[Fr,[Fr],(p,[l])=>Math.log(l.evaluate(p))],log2:[Fr,[Fr],(p,[l])=>Math.log(l.evaluate(p))/Math.LN2],sin:[Fr,[Fr],(p,[l])=>Math.sin(l.evaluate(p))],cos:[Fr,[Fr],(p,[l])=>Math.cos(l.evaluate(p))],tan:[Fr,[Fr],(p,[l])=>Math.tan(l.evaluate(p))],asin:[Fr,[Fr],(p,[l])=>Math.asin(l.evaluate(p))],acos:[Fr,[Fr],(p,[l])=>Math.acos(l.evaluate(p))],atan:[Fr,[Fr],(p,[l])=>Math.atan(l.evaluate(p))],min:[Fr,ka(Fr),(p,l)=>Math.min(...l.map((f=>f.evaluate(p))))],max:[Fr,ka(Fr),(p,l)=>Math.max(...l.map((f=>f.evaluate(p))))],abs:[Fr,[Fr],(p,[l])=>Math.abs(l.evaluate(p))],round:[Fr,[Fr],(p,[l])=>{const f=l.evaluate(p);return f<0?-Math.round(-f):Math.round(f)}],floor:[Fr,[Fr],(p,[l])=>Math.floor(l.evaluate(p))],ceil:[Fr,[Fr],(p,[l])=>Math.ceil(l.evaluate(p))],"filter-==":[Bn,[Mn,zn],(p,[l,f])=>p.properties()[l.value]===f.value],"filter-id-==":[Bn,[zn],(p,[l])=>p.id()===l.value],"filter-type-==":[Bn,[Mn],(p,[l])=>p.geometryType()===l.value],"filter-<":[Bn,[Mn,zn],(p,[l,f])=>{const v=p.properties()[l.value],S=f.value;return typeof v==typeof S&&v<S}],"filter-id-<":[Bn,[zn],(p,[l])=>{const f=p.id(),v=l.value;return typeof f==typeof v&&f<v}],"filter->":[Bn,[Mn,zn],(p,[l,f])=>{const v=p.properties()[l.value],S=f.value;return typeof v==typeof S&&v>S}],"filter-id->":[Bn,[zn],(p,[l])=>{const f=p.id(),v=l.value;return typeof f==typeof v&&f>v}],"filter-<=":[Bn,[Mn,zn],(p,[l,f])=>{const v=p.properties()[l.value],S=f.value;return typeof v==typeof S&&v<=S}],"filter-id-<=":[Bn,[zn],(p,[l])=>{const f=p.id(),v=l.value;return typeof f==typeof v&&f<=v}],"filter->=":[Bn,[Mn,zn],(p,[l,f])=>{const v=p.properties()[l.value],S=f.value;return typeof v==typeof S&&v>=S}],"filter-id->=":[Bn,[zn],(p,[l])=>{const f=p.id(),v=l.value;return typeof f==typeof v&&f>=v}],"filter-has":[Bn,[zn],(p,[l])=>l.value in p.properties()],"filter-has-id":[Bn,[],p=>p.id()!==null&&p.id()!==void 0],"filter-type-in":[Bn,[xi(Mn)],(p,[l])=>l.value.indexOf(p.geometryType())>=0],"filter-id-in":[Bn,[xi(zn)],(p,[l])=>l.value.indexOf(p.id())>=0],"filter-in-small":[Bn,[Mn,xi(zn)],(p,[l,f])=>f.value.indexOf(p.properties()[l.value])>=0],"filter-in-large":[Bn,[Mn,xi(zn)],(p,[l,f])=>(function(v,S,k,R){for(;k<=R;){const B=k+R>>1;if(S[B]===v)return!0;S[B]>v?R=B-1:k=B+1}return!1})(p.properties()[l.value],f.value,0,f.value.length-1)],all:{type:Bn,overloads:[[[Bn,Bn],(p,[l,f])=>l.evaluate(p)&&f.evaluate(p)],[ka(Bn),(p,l)=>{for(const f of l)if(!f.evaluate(p))return!1;return!0}]]},any:{type:Bn,overloads:[[[Bn,Bn],(p,[l,f])=>l.evaluate(p)||f.evaluate(p)],[ka(Bn),(p,l)=>{for(const f of l)if(f.evaluate(p))return!0;return!1}]]},"!":[Bn,[Bn],(p,[l])=>!l.evaluate(p)],"is-supported-script":[Bn,[Mn],(p,[l])=>{const f=p.globals&&p.globals.isSupportedScript;return!f||f(l.evaluate(p))}],upcase:[Mn,[Mn],(p,[l])=>l.evaluate(p).toUpperCase()],downcase:[Mn,[Mn],(p,[l])=>l.evaluate(p).toLowerCase()],concat:[Mn,ka(zn),(p,l)=>l.map((f=>Cs(f.evaluate(p)))).join("")],"resolved-locale":[Mn,[La],(p,[l])=>l.evaluate(p).resolvedLocale()]});class Od{constructor(l,f,v){this.expression=l,this._warningHistory={},this._evaluator=new Mu,this._defaultValue=f?(function(S){if(S.type==="color"&&Nu(S.default))return new kr(0,0,0,0);switch(S.type){case"color":return kr.parse(S.default)||null;case"padding":return Mr.parse(S.default)||null;case"numberArray":return fn.parse(S.default)||null;case"colorArray":return mn.parse(S.default)||null;case"variableAnchorOffsetCollection":return ba.parse(S.default)||null;case"projectionDefinition":return fi.parse(S.default)||null;default:return S.default===void 0?null:S.default}})(f):null,this._enumValues=f&&f.type==="enum"?f.values:null,this._globalState=v}evaluateWithoutErrorHandling(l,f,v,S,k,R){return this._globalState&&(l=tf(l,this._globalState)),this._evaluator.globals=l,this._evaluator.feature=f,this._evaluator.featureState=v,this._evaluator.canonical=S,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=R,this.expression.evaluate(this._evaluator)}evaluate(l,f,v,S,k,R){this._globalState&&(l=tf(l,this._globalState)),this._evaluator.globals=l,this._evaluator.feature=f||null,this._evaluator.featureState=v||null,this._evaluator.canonical=S,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=R||null;try{const B=this.expression.evaluate(this._evaluator);if(B==null||typeof B=="number"&&B!=B)return this._defaultValue;if(this._enumValues&&!(B in this._enumValues))throw new hi(`Expected value to be one of ${Object.keys(this._enumValues).map((V=>JSON.stringify(V))).join(", ")}, but found ${JSON.stringify(B)} instead.`);return B}catch(B){return this._warningHistory[B.message]||(this._warningHistory[B.message]=!0,typeof console<"u"&&console.warn(B.message)),this._defaultValue}}}function Vc(p){return Array.isArray(p)&&p.length>0&&typeof p[0]=="string"&&p[0]in Fn}function ef(p,l,f){const v=new go(Fn,Ho,[],l?(function(k){const R={color:ei,string:Mn,number:Fr,enum:Mn,boolean:Bn,formatted:Gi,padding:fs,numberArray:Mo,colorArray:Ca,projectionDefinition:ua,resolvedImage:Ya,variableAnchorOffsetCollection:ol};return k.type==="array"?xi(R[k.value]||zn,k.length):R[k.type]})(l):void 0),S=v.parse(p,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return S?du(new Od(S,l,f)):Ps(v.errors)}class Np{constructor(l,f,v){this.kind=l,this._styleExpression=f,this.isStateDependent=l!=="constant"&&!Pl(f.expression),this.globalStateRefs=vh(f.expression),this._globalState=v}evaluateWithoutErrorHandling(l,f,v,S,k,R){return this._globalState&&(l=tf(l,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(l,f,v,S,k,R)}evaluate(l,f,v,S,k,R){return this._globalState&&(l=tf(l,this._globalState)),this._styleExpression.evaluate(l,f,v,S,k,R)}}class Hg{constructor(l,f,v,S,k){this.kind=l,this.zoomStops=v,this._styleExpression=f,this.isStateDependent=l!=="camera"&&!Pl(f.expression),this.globalStateRefs=vh(f.expression),this.interpolationType=S,this._globalState=k}evaluateWithoutErrorHandling(l,f,v,S,k,R){return this._globalState&&(l=tf(l,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(l,f,v,S,k,R)}evaluate(l,f,v,S,k,R){return this._globalState&&(l=tf(l,this._globalState)),this._styleExpression.evaluate(l,f,v,S,k,R)}interpolationFactor(l,f,v){return this.interpolationType?Un.interpolationFactor(this.interpolationType,l,f,v):0}}function Lp(p,l,f){const v=ef(p,l,f);if(v.result==="error")return v;const S=v.value.expression,k=Ks(S);if(!k&&!Wl(l))return Ps([new Nn("","data expressions not supported")]);const R=fu(S,["zoom"]);if(!R&&!Gl(l))return Ps([new Nn("","zoom expressions not supported")]);const B=Bp(S);return B||R?B instanceof Nn?Ps([B]):B instanceof Un&&!Eo(l)?Ps([new Nn("",'"interpolate" expressions cannot be used with this property')]):du(B?new Hg(k?"camera":"composite",v.value,B.labels,B instanceof Un?B.interpolation:void 0,f):new Np(k?"constant":"source",v.value,f)):Ps([new Nn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Fp{constructor(l,f){this._parameters=l,this._specification=f,Xr(this,yh(this._parameters,this._specification))}static deserialize(l){return new Fp(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function Bp(p){let l=null;if(p instanceof ji)l=Bp(p.result);else if(p instanceof Ui){for(const f of p.args)if(l=Bp(f),l)break}else(p instanceof Bt||p instanceof Un)&&p.input instanceof En&&p.input.name==="zoom"&&(l=p);return l instanceof Nn||p.eachChild((f=>{const v=Bp(f);v instanceof Nn?l=v:!l&&v?l=new Nn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&v&&l!==v&&(l=new Nn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),l}function vh(p,l=new Set){return p instanceof Xn&&l.add(p.key),p.eachChild((f=>{vh(f,l)})),l}function tf(p,l){const{zoom:f,heatmapDensity:v,elevation:S,lineProgress:k,isSupportedScript:R,accumulated:B}=p??{};return{zoom:f,heatmapDensity:v,elevation:S,lineProgress:k,isSupportedScript:R,accumulated:B,globalState:l}}function Wg(p){if(p===!0||p===!1)return!0;if(!Array.isArray(p)||p.length===0)return!1;switch(p[0]){case"has":return p.length>=2&&p[1]!=="$id"&&p[1]!=="$type";case"in":return p.length>=3&&(typeof p[1]!="string"||Array.isArray(p[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return p.length!==3||Array.isArray(p[1])||Array.isArray(p[2]);case"any":case"all":for(const l of p.slice(1))if(!Wg(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}const Gg={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function rf(p,l){if(p==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Wg(p)||(p=Ld(p));const f=ef(p,Gg,l);if(f.result==="error")throw new Error(f.value.map((v=>`${v.key}: ${v.message}`)).join(", "));return{filter:(v,S,k)=>f.value.evaluate(v,S,{},k),needGeometry:Ny(p),getGlobalStateRefs:()=>vh(f.value.expression)}}function Nd(p,l){return p<l?-1:p>l?1:0}function Ny(p){if(!Array.isArray(p))return!1;if(p[0]==="within"||p[0]==="distance")return!0;for(let l=1;l<p.length;l++)if(Ny(p[l]))return!0;return!1}function Ld(p){if(!p)return!0;const l=p[0];return p.length<=1?l!=="any":l==="=="?Fd(p[1],p[2],"=="):l==="!="?Bd(Fd(p[1],p[2],"==")):l==="<"||l===">"||l==="<="||l===">="?Fd(p[1],p[2],l):l==="any"?(f=p.slice(1),["any"].concat(f.map(Ld))):l==="all"?["all"].concat(p.slice(1).map(Ld)):l==="none"?["all"].concat(p.slice(1).map(Ld).map(Bd)):l==="in"?Ly(p[1],p.slice(2)):l==="!in"?Bd(Ly(p[1],p.slice(2))):l==="has"?Fy(p[1]):l!=="!has"||Bd(Fy(p[1]));var f}function Fd(p,l,f){switch(p){case"$type":return[`filter-type-${f}`,l];case"$id":return[`filter-id-${f}`,l];default:return[`filter-${f}`,p,l]}}function Ly(p,l){if(l.length===0)return!1;switch(p){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some((f=>typeof f!=typeof l[0]))?["filter-in-large",p,["literal",l.sort(Nd)]]:["filter-in-small",p,["literal",l]]}}function Fy(p){switch(p){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",p]}}function Bd(p){return["!",p]}function zp(p){const l=typeof p;if(l==="number"||l==="boolean"||l==="string"||p==null)return JSON.stringify(p);if(Array.isArray(p)){let S="[";for(const k of p)S+=`${zp(k)},`;return`${S}]`}const f=Object.keys(p).sort();let v="{";for(let S=0;S<f.length;S++)v+=`${JSON.stringify(f[S])}:${zp(p[f[S]])},`;return`${v}}`}function $c(p){let l="";for(const f of en)l+=`/${zp(p[f])}`;return l}function Lu(p){const l=p.value;return l?[new Ut(p.key,l,"constants have been deprecated as of v8")]:[]}function xa(p){return p instanceof Number||p instanceof String||p instanceof Boolean?p.valueOf():p}function nf(p){if(Array.isArray(p))return p.map(nf);if(p instanceof Object&&!(p instanceof Number||p instanceof String||p instanceof Boolean)){const l={};for(const f in p)l[f]=nf(p[f]);return l}return xa(p)}function Xl(p){const l=p.key,f=p.value,v=p.valueSpec||{},S=p.objectElementValidators||{},k=p.style,R=p.styleSpec,B=p.validateSpec;let V=[];const Z=ni(f);if(Z!=="object")return[new Ut(l,f,`object expected, ${Z} found`)];for(const ie in f){const ce=ie.split(".")[0],ve=It(v,ce)||v["*"];let Se;if(It(S,ce))Se=S[ce];else if(It(v,ce)){if(f[ie]===void 0)continue;Se=B}else if(S["*"])Se=S["*"];else{if(!v["*"]){V.push(new Ut(l,f[ie],`unknown property "${ie}"`));continue}Se=B}V=V.concat(Se({key:(l&&`${l}.`)+ie,value:f[ie],valueSpec:ve,style:k,styleSpec:R,object:f,objectKey:ie,validateSpec:B},f))}for(const ie in v)S[ie]||v[ie].required&&v[ie].default===void 0&&f[ie]===void 0&&V.push(new Ut(l,f,`missing required property "${ie}"`));return V}function ac(p){const l=p.value,f=p.valueSpec,v=p.style,S=p.styleSpec,k=p.key,R=p.arrayElementValidator||p.validateSpec;if(ni(l)!=="array")return[new Ut(k,l,`array expected, ${ni(l)} found`)];if(f.length&&l.length!==f.length)return[new Ut(k,l,`array length ${f.length} expected, length ${l.length} found`)];let B={type:f.value,values:f.values};S.$version<7&&(B.function=f.function),ni(f.value)==="object"&&(B=f.value);let V=[];for(let Z=0;Z<l.length;Z++)V=V.concat(R({array:l,arrayIndex:Z,value:l[Z],valueSpec:B,validateSpec:p.validateSpec,style:v,styleSpec:S,key:`${k}[${Z}]`}));return V}function dl(p){const l=p.key,f=p.value,v=p.valueSpec;let S=ni(f);return S==="number"&&f!=f&&(S="NaN"),S!=="number"?[new Ut(l,f,`number expected, ${S} found`)]:"minimum"in v&&f<v.minimum?[new Ut(l,f,`${f} is less than the minimum value ${v.minimum}`)]:"maximum"in v&&f>v.maximum?[new Ut(l,f,`${f} is greater than the maximum value ${v.maximum}`)]:[]}function jp(p){const l=p.valueSpec,f=xa(p.value.type);let v,S,k,R={};const B=f!=="categorical"&&p.value.property===void 0,V=!B,Z=ni(p.value.stops)==="array"&&ni(p.value.stops[0])==="array"&&ni(p.value.stops[0][0])==="object",ie=Xl({key:p.key,value:p.value,valueSpec:p.styleSpec.function,validateSpec:p.validateSpec,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(Se){if(f==="identity")return[new Ut(Se.key,Se.value,'identity function may not have a "stops" property')];let Ne=[];const ze=Se.value;return Ne=Ne.concat(ac({key:Se.key,value:ze,valueSpec:Se.valueSpec,validateSpec:Se.validateSpec,style:Se.style,styleSpec:Se.styleSpec,arrayElementValidator:ce})),ni(ze)==="array"&&ze.length===0&&Ne.push(new Ut(Se.key,ze,"array must have at least one stop")),Ne},default:function(Se){return Se.validateSpec({key:Se.key,value:Se.value,valueSpec:l,validateSpec:Se.validateSpec,style:Se.style,styleSpec:Se.styleSpec})}}});return f==="identity"&&B&&ie.push(new Ut(p.key,p.value,'missing required property "property"')),f==="identity"||p.value.stops||ie.push(new Ut(p.key,p.value,'missing required property "stops"')),f==="exponential"&&p.valueSpec.expression&&!Eo(p.valueSpec)&&ie.push(new Ut(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(V&&!Wl(p.valueSpec)?ie.push(new Ut(p.key,p.value,"property functions not supported")):B&&!Gl(p.valueSpec)&&ie.push(new Ut(p.key,p.value,"zoom functions not supported"))),f!=="categorical"&&!Z||p.value.property!==void 0||ie.push(new Ut(p.key,p.value,'"property" property is required')),ie;function ce(Se){let Ne=[];const ze=Se.value,Ve=Se.key;if(ni(ze)!=="array")return[new Ut(Ve,ze,`array expected, ${ni(ze)} found`)];if(ze.length!==2)return[new Ut(Ve,ze,`array length 2 expected, length ${ze.length} found`)];if(Z){if(ni(ze[0])!=="object")return[new Ut(Ve,ze,`object expected, ${ni(ze[0])} found`)];if(ze[0].zoom===void 0)return[new Ut(Ve,ze,"object stop key must have zoom")];if(ze[0].value===void 0)return[new Ut(Ve,ze,"object stop key must have value")];if(k&&k>xa(ze[0].zoom))return[new Ut(Ve,ze[0].zoom,"stop zoom values must appear in ascending order")];xa(ze[0].zoom)!==k&&(k=xa(ze[0].zoom),S=void 0,R={}),Ne=Ne.concat(Xl({key:`${Ve}[0]`,value:ze[0],valueSpec:{zoom:{}},validateSpec:Se.validateSpec,style:Se.style,styleSpec:Se.styleSpec,objectElementValidators:{zoom:dl,value:ve}}))}else Ne=Ne.concat(ve({key:`${Ve}[0]`,value:ze[0],validateSpec:Se.validateSpec,style:Se.style,styleSpec:Se.styleSpec},ze));return Vc(nf(ze[1]))?Ne.concat([new Ut(`${Ve}[1]`,ze[1],"expressions are not allowed in function stops.")]):Ne.concat(Se.validateSpec({key:`${Ve}[1]`,value:ze[1],valueSpec:l,validateSpec:Se.validateSpec,style:Se.style,styleSpec:Se.styleSpec}))}function ve(Se,Ne){const ze=ni(Se.value),Ve=xa(Se.value),et=Se.value!==null?Se.value:Ne;if(v){if(ze!==v)return[new Ut(Se.key,et,`${ze} stop domain type must match previous stop domain type ${v}`)]}else v=ze;if(ze!=="number"&&ze!=="string"&&ze!=="boolean")return[new Ut(Se.key,et,"stop domain value must be a number, string, or boolean")];if(ze!=="number"&&f!=="categorical"){let Ct=`number expected, ${ze} found`;return Wl(l)&&f===void 0&&(Ct+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ut(Se.key,et,Ct)]}return f!=="categorical"||ze!=="number"||isFinite(Ve)&&Math.floor(Ve)===Ve?f!=="categorical"&&ze==="number"&&S!==void 0&&Ve<S?[new Ut(Se.key,et,"stop domain values must appear in ascending order")]:(S=Ve,f==="categorical"&&Ve in R?[new Ut(Se.key,et,"stop domain values must be unique")]:(R[Ve]=!0,[])):[new Ut(Se.key,et,`integer expected, found ${Ve}`)]}}function _h(p){const l=(p.expressionContext==="property"?Lp:ef)(nf(p.value),p.valueSpec);if(l.result==="error")return l.value.map((v=>new Ut(`${p.key}${v.key}`,p.value,v.message)));const f=l.value.expression||l.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!f.outputDefined())return[new Ut(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!Pl(f))return[new Ut(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter"&&!Pl(f))return[new Ut(p.key,p.value,'"feature-state" data expressions are not supported with filters.')];if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!fu(f,["zoom","feature-state"]))return[new Ut(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!Ks(f))return[new Ut(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Bf(p){const l=p.key,f=p.value,v=ni(f);return v!=="string"?[new Ut(l,f,`color expected, ${v} found`)]:kr.parse(String(f))?[]:[new Ut(l,f,`color expected, "${f}" found`)]}function bh(p){const l=p.key,f=p.value,v=p.valueSpec,S=[];return Array.isArray(v.values)?v.values.indexOf(xa(f))===-1&&S.push(new Ut(l,f,`expected one of [${v.values.join(", ")}], ${JSON.stringify(f)} found`)):Object.keys(v.values).indexOf(xa(f))===-1&&S.push(new Ut(l,f,`expected one of [${Object.keys(v.values).join(", ")}], ${JSON.stringify(f)} found`)),S}function af(p){return Wg(nf(p.value))?_h(Xr({},p,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Xg(p)}function Xg(p){const l=p.value,f=p.key;if(ni(l)!=="array")return[new Ut(f,l,`array expected, ${ni(l)} found`)];const v=p.styleSpec;let S,k=[];if(l.length<1)return[new Ut(f,l,"filter array must have at least 1 element")];switch(k=k.concat(bh({key:`${f}[0]`,value:l[0],valueSpec:v.filter_operator,style:p.style,styleSpec:p.styleSpec})),xa(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&xa(l[1])==="$type"&&k.push(new Ut(f,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&k.push(new Ut(f,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(S=ni(l[1]),S!=="string"&&k.push(new Ut(`${f}[1]`,l[1],`string expected, ${S} found`)));for(let R=2;R<l.length;R++)S=ni(l[R]),xa(l[1])==="$type"?k=k.concat(bh({key:`${f}[${R}]`,value:l[R],valueSpec:v.geometry_type,style:p.style,styleSpec:p.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&k.push(new Ut(`${f}[${R}]`,l[R],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let R=1;R<l.length;R++)k=k.concat(Xg({key:`${f}[${R}]`,value:l[R],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":S=ni(l[1]),l.length!==2?k.push(new Ut(f,l,`filter array for "${l[0]}" operator must have 2 elements`)):S!=="string"&&k.push(new Ut(`${f}[1]`,l[1],`string expected, ${S} found`))}return k}function By(p,l){const f=p.key,v=p.validateSpec,S=p.style,k=p.styleSpec,R=p.value,B=p.objectKey,V=k[`${l}_${p.layerType}`];if(!V)return[];const Z=B.match(/^(.*)-transition$/);if(l==="paint"&&Z&&V[Z[1]]&&V[Z[1]].transition)return v({key:f,value:R,valueSpec:k.transition,style:S,styleSpec:k});const ie=p.valueSpec||V[B];if(!ie)return[new Ut(f,R,`unknown property "${B}"`)];let ce;if(ni(R)==="string"&&Wl(ie)&&!ie.tokens&&(ce=/^{([^}]+)}$/.exec(R)))return[new Ut(f,R,`"${B}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(ce[1])} }\`.`)];const ve=[];return p.layerType==="symbol"&&B==="text-font"&&Nu(nf(R))&&xa(R.type)==="identity"&&ve.push(new Ut(f,R,'"text-font" does not support identity functions')),ve.concat(v({key:p.key,value:R,valueSpec:ie,style:S,styleSpec:k,expressionContext:"property",propertyType:l,propertyKey:B}))}function zd(p){return By(p,"paint")}function jd(p){return By(p,"layout")}function zf(p){let l=[];const f=p.value,v=p.key,S=p.style,k=p.styleSpec;if(ni(f)!=="object")return[new Ut(v,f,`object expected, ${ni(f)} found`)];f.type||f.ref||l.push(new Ut(v,f,'either "type" or "ref" is required'));let R=xa(f.type);const B=xa(f.ref);if(f.id){const V=xa(f.id);for(let Z=0;Z<p.arrayIndex;Z++){const ie=S.layers[Z];xa(ie.id)===V&&l.push(new Ut(v,f.id,`duplicate layer id "${f.id}", previously used at line ${ie.id.__line__}`))}}if("ref"in f){let V;["type","source","source-layer","filter","layout"].forEach((Z=>{Z in f&&l.push(new Ut(v,f[Z],`"${Z}" is prohibited for ref layers`))})),S.layers.forEach((Z=>{xa(Z.id)===B&&(V=Z)})),V?V.ref?l.push(new Ut(v,f.ref,"ref cannot reference another ref layer")):R=xa(V.type):l.push(new Ut(v,f.ref,`ref layer "${B}" not found`))}else if(R!=="background")if(f.source){const V=S.sources&&S.sources[f.source],Z=V&&xa(V.type);V?Z==="vector"&&R==="raster"?l.push(new Ut(v,f.source,`layer "${f.id}" requires a raster source`)):Z!=="raster-dem"&&R==="hillshade"||Z!=="raster-dem"&&R==="color-relief"?l.push(new Ut(v,f.source,`layer "${f.id}" requires a raster-dem source`)):Z==="raster"&&R!=="raster"?l.push(new Ut(v,f.source,`layer "${f.id}" requires a vector source`)):Z!=="vector"||f["source-layer"]?Z==="raster-dem"&&R!=="hillshade"&&R!=="color-relief"?l.push(new Ut(v,f.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):R!=="line"||!f.paint||!f.paint["line-gradient"]||Z==="geojson"&&V.lineMetrics||l.push(new Ut(v,f,`layer "${f.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new Ut(v,f,`layer "${f.id}" must specify a "source-layer"`)):l.push(new Ut(v,f.source,`source "${f.source}" not found`))}else l.push(new Ut(v,f,'missing required property "source"'));return l=l.concat(Xl({key:v,value:f,valueSpec:k.layer,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,objectElementValidators:{"*":()=>[],type:()=>p.validateSpec({key:`${v}.type`,value:f.type,valueSpec:k.layer.type,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,object:f,objectKey:"type"}),filter:af,layout:V=>Xl({layer:f,key:V.key,value:V.value,style:V.style,styleSpec:V.styleSpec,validateSpec:V.validateSpec,objectElementValidators:{"*":Z=>jd(Xr({layerType:R},Z))}}),paint:V=>Xl({layer:f,key:V.key,value:V.value,style:V.style,styleSpec:V.styleSpec,validateSpec:V.validateSpec,objectElementValidators:{"*":Z=>zd(Xr({layerType:R},Z))}})}})),l}function wc(p){const l=p.value,f=p.key,v=ni(l);return v!=="string"?[new Ut(f,l,`string expected, ${v} found`)]:[]}const Yg={promoteId:function({key:p,value:l}){if(ni(l)==="string")return wc({key:p,value:l});{const f=[];for(const v in l)f.push(...wc({key:`${p}.${v}`,value:l[v]}));return f}}};function Up(p){const l=p.value,f=p.key,v=p.styleSpec,S=p.style,k=p.validateSpec;if(!l.type)return[new Ut(f,l,'"type" is required')];const R=xa(l.type);let B;switch(R){case"vector":case"raster":return B=Xl({key:f,value:l,valueSpec:v[`source_${R.replace("-","_")}`],style:p.style,styleSpec:v,objectElementValidators:Yg,validateSpec:k}),B;case"raster-dem":return B=(function(V){var Z;const ie=(Z=V.sourceName)!==null&&Z!==void 0?Z:"",ce=V.value,ve=V.styleSpec,Se=ve.source_raster_dem,Ne=V.style;let ze=[];const Ve=ni(ce);if(ce===void 0)return ze;if(Ve!=="object")return ze.push(new Ut("source_raster_dem",ce,`object expected, ${Ve} found`)),ze;const et=xa(ce.encoding)==="custom",Ct=["redFactor","greenFactor","blueFactor","baseShift"],nt=V.value.encoding?`"${V.value.encoding}"`:"Default";for(const ut in ce)!et&&Ct.includes(ut)?ze.push(new Ut(ut,ce[ut],`In "${ie}": "${ut}" is only valid when "encoding" is set to "custom". ${nt} encoding found`)):Se[ut]?ze=ze.concat(V.validateSpec({key:ut,value:ce[ut],valueSpec:Se[ut],validateSpec:V.validateSpec,style:Ne,styleSpec:ve})):ze.push(new Ut(ut,ce[ut],`unknown property "${ut}"`));return ze})({sourceName:f,value:l,style:p.style,styleSpec:v,validateSpec:k}),B;case"geojson":if(B=Xl({key:f,value:l,valueSpec:v.source_geojson,style:S,styleSpec:v,validateSpec:k,objectElementValidators:Yg}),l.cluster)for(const V in l.clusterProperties){const[Z,ie]=l.clusterProperties[V],ce=typeof Z=="string"?[Z,["accumulated"],["get",V]]:Z;B.push(..._h({key:`${f}.${V}.map`,value:ie,expressionContext:"cluster-map"})),B.push(..._h({key:`${f}.${V}.reduce`,value:ce,expressionContext:"cluster-reduce"}))}return B;case"video":return Xl({key:f,value:l,valueSpec:v.source_video,style:S,validateSpec:k,styleSpec:v});case"image":return Xl({key:f,value:l,valueSpec:v.source_image,style:S,validateSpec:k,styleSpec:v});case"canvas":return[new Ut(f,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return bh({key:`${f}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Ud(p){const l=p.value,f=p.styleSpec,v=f.light,S=p.style;let k=[];const R=ni(l);if(l===void 0)return k;if(R!=="object")return k=k.concat([new Ut("light",l,`object expected, ${R} found`)]),k;for(const B in l){const V=B.match(/^(.*)-transition$/);k=k.concat(V&&v[V[1]]&&v[V[1]].transition?p.validateSpec({key:B,value:l[B],valueSpec:f.transition,validateSpec:p.validateSpec,style:S,styleSpec:f}):v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],validateSpec:p.validateSpec,style:S,styleSpec:f}):[new Ut(B,l[B],`unknown property "${B}"`)])}return k}function zy(p){const l=p.value,f=p.styleSpec,v=f.sky,S=p.style,k=ni(l);if(l===void 0)return[];if(k!=="object")return[new Ut("sky",l,`object expected, ${k} found`)];let R=[];for(const B in l)R=R.concat(v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],style:S,styleSpec:f}):[new Ut(B,l[B],`unknown property "${B}"`)]);return R}function Zg(p){const l=p.value,f=p.styleSpec,v=f.terrain,S=p.style;let k=[];const R=ni(l);if(l===void 0)return k;if(R!=="object")return k=k.concat([new Ut("terrain",l,`object expected, ${R} found`)]),k;for(const B in l)k=k.concat(v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],validateSpec:p.validateSpec,style:S,styleSpec:f}):[new Ut(B,l[B],`unknown property "${B}"`)]);return k}function Kg(p){let l=[];const f=p.value,v=p.key;if(Array.isArray(f)){const S=[],k=[];for(const R in f)f[R].id&&S.includes(f[R].id)&&l.push(new Ut(v,f,`all the sprites' ids must be unique, but ${f[R].id} is duplicated`)),S.push(f[R].id),f[R].url&&k.includes(f[R].url)&&l.push(new Ut(v,f,`all the sprites' URLs must be unique, but ${f[R].url} is duplicated`)),k.push(f[R].url),l=l.concat(Xl({key:`${v}[${R}]`,value:f[R],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:p.validateSpec}));return l}return wc({key:v,value:f})}function jy(p){return!!p&&p.constructor===Object}function Jg(p){return jy(p.value)?[]:[new Ut(p.key,p.value,`object expected, ${ni(p.value)} found`)]}const Vp={"*":()=>[],array:ac,boolean:function(p){const l=p.value,f=p.key,v=ni(l);return v!=="boolean"?[new Ut(f,l,`boolean expected, ${v} found`)]:[]},number:dl,color:Bf,constants:Lu,enum:bh,filter:af,function:jp,layer:zf,object:Xl,source:Up,light:Ud,sky:zy,terrain:Zg,projection:function(p){const l=p.value,f=p.styleSpec,v=f.projection,S=p.style,k=ni(l);if(l===void 0)return[];if(k!=="object")return[new Ut("projection",l,`object expected, ${k} found`)];let R=[];for(const B in l)R=R.concat(v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],style:S,styleSpec:f}):[new Ut(B,l[B],`unknown property "${B}"`)]);return R},projectionDefinition:function(p){const l=p.key;let f=p.value;f=f instanceof String?f.valueOf():f;const v=ni(f);return v!=="array"||(function(S){return Array.isArray(S)&&S.length===3&&typeof S[0]=="string"&&typeof S[1]=="string"&&typeof S[2]=="number"})(f)||(function(S){return!!["interpolate","step","literal"].includes(S[0])})(f)?["array","string"].includes(v)?[]:[new Ut(l,f,`projection expected, invalid type "${v}" found`)]:[new Ut(l,f,`projection expected, invalid array ${JSON.stringify(f)} found`)]},string:wc,formatted:function(p){return wc(p).length===0?[]:_h(p)},resolvedImage:function(p){return wc(p).length===0?[]:_h(p)},padding:function(p){const l=p.key,f=p.value;if(ni(f)==="array"){if(f.length<1||f.length>4)return[new Ut(l,f,`padding requires 1 to 4 values; ${f.length} values found`)];const v={type:"number"};let S=[];for(let k=0;k<f.length;k++)S=S.concat(p.validateSpec({key:`${l}[${k}]`,value:f[k],validateSpec:p.validateSpec,valueSpec:v}));return S}return dl({key:l,value:f,valueSpec:{}})},numberArray:function(p){const l=p.key,f=p.value;if(ni(f)==="array"){const v={type:"number"};if(f.length<1)return[new Ut(l,f,"array length at least 1 expected, length 0 found")];let S=[];for(let k=0;k<f.length;k++)S=S.concat(p.validateSpec({key:`${l}[${k}]`,value:f[k],validateSpec:p.validateSpec,valueSpec:v}));return S}return dl({key:l,value:f,valueSpec:{}})},colorArray:function(p){const l=p.key,f=p.value;if(ni(f)==="array"){if(f.length<1)return[new Ut(l,f,"array length at least 1 expected, length 0 found")];let v=[];for(let S=0;S<f.length;S++)v=v.concat(Bf({key:`${l}[${S}]`,value:f[S]}));return v}return Bf({key:l,value:f})},variableAnchorOffsetCollection:function(p){const l=p.key,f=p.value,v=ni(f),S=p.styleSpec;if(v!=="array"||f.length<1||f.length%2!=0)return[new Ut(l,f,"variableAnchorOffsetCollection requires a non-empty array of even length")];let k=[];for(let R=0;R<f.length;R+=2)k=k.concat(bh({key:`${l}[${R}]`,value:f[R],valueSpec:S.layout_symbol["text-anchor"]})),k=k.concat(ac({key:`${l}[${R+1}]`,value:f[R+1],valueSpec:{length:2,value:"number"},validateSpec:p.validateSpec,style:p.style,styleSpec:S}));return k},sprite:Kg,state:Jg,fontFaces:function(p){const l=p.key,f=p.value,v=p.validateSpec,S=p.styleSpec,k=p.style;if(!jy(f))return[new Ut(l,f,`object expected, ${ni(f)} found`)];const R=[];for(const B in f){const V=f[B],Z=ni(V);if(Z==="string")R.push(...wc({key:`${l}.${B}`,value:V}));else if(Z==="array"){const ie={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[ce,ve]of V.entries())R.push(...Xl({key:`${l}.${B}[${ce}]`,value:ve,valueSpec:ie,styleSpec:S,style:k,validateSpec:v}))}else R.push(new Ut(`${l}.${B}`,V,`string or array expected, ${Z} found`))}return R}};function oc(p){const l=p.value,f=p.valueSpec,v=p.styleSpec;return p.validateSpec=oc,f.expression&&Nu(xa(l))?jp(p):f.expression&&Vc(nf(l))?_h(p):f.type&&Vp[f.type]?Vp[f.type](p):Xl(Xr({},p,{valueSpec:f.type?v[f.type]:f}))}function Uy(p){const l=p.value,f=p.key,v=wc(p);return v.length||(l.indexOf("{fontstack}")===-1&&v.push(new Ut(f,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&v.push(new Ut(f,l,'"glyphs" url must include a "{range}" token'))),v}function Fu(p,l=Mt){let f=[];return f=f.concat(oc({key:"",value:p,valueSpec:l.$root,styleSpec:l,style:p,validateSpec:oc,objectElementValidators:{glyphs:Uy,"*":()=>[]}})),p.constants&&(f=f.concat(Lu({key:"constants",value:p.constants}))),q(f)}function Bu(p){return function(l){return p(Object.assign({},l,{validateSpec:oc}))}}function q(p){return[].concat(p).sort(((l,f)=>l.line-f.line))}function K(p){return function(...l){return q(p.apply(this,l))}}Fu.source=K(Bu(Up)),Fu.sprite=K(Bu(Kg)),Fu.glyphs=K(Bu(Uy)),Fu.light=K(Bu(Ud)),Fu.sky=K(Bu(zy)),Fu.terrain=K(Bu(Zg)),Fu.state=K(Bu(Jg)),Fu.layer=K(Bu(zf)),Fu.filter=K(Bu(af)),Fu.paintProperty=K(Bu(zd)),Fu.layoutProperty=K(Bu(jd));const ge={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class Pe{constructor(l,f){this._globalState=f,this.setValue(l)}evaluate(){var l;return(l=this._literalValue)!==null&&l!==void 0?l:this._compiledValue.evaluate({})}setValue(l){if(l==null||l==="visible"||l==="none")return this._literalValue=l==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const f=ef(l,ge,this._globalState);if(f.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(f.value.map((v=>`${v.key}: ${v.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=f.value,this._globalStateRefs=vh(f.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const Ye=Mt,Je=Fu,it=Je.light,lt=Je.sky,yt=Je.paintProperty,At=Je.layoutProperty;function Xt(p,l){let f=!1;if(l&&l.length)for(const v of l)p.fire(new hn(new Error(v.message))),f=!0;return f}class _r{constructor(l,f,v){const S=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;const R=new Int32Array(this.arrayBuffer);l=R[0],this.d=(f=R[1])+2*(v=R[2]);for(let V=0;V<this.d*this.d;V++){const Z=R[3+V],ie=R[3+V+1];S.push(Z===ie?null:R.subarray(Z,ie))}const B=R[3+S.length+1];this.keys=R.subarray(R[3+S.length],B),this.bboxes=R.subarray(B),this.insert=this._insertReadonly}else{this.d=f+2*v;for(let R=0;R<this.d*this.d;R++)S.push([]);this.keys=[],this.bboxes=[]}this.n=f,this.extent=l,this.padding=v,this.scale=f/l,this.uid=0;const k=v/f*l;this.min=-k,this.max=l+k}insert(l,f,v,S,k){this._forEachCell(f,v,S,k,this._insertCell,this.uid++,void 0,void 0),this.keys.push(l),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(S),this.bboxes.push(k)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(l,f,v,S,k,R){this.cells[k].push(R)}query(l,f,v,S,k){const R=this.min,B=this.max;if(l<=R&&f<=R&&B<=v&&B<=S&&!k)return Array.prototype.slice.call(this.keys);{const V=[];return this._forEachCell(l,f,v,S,this._queryCell,V,{},k),V}}_queryCell(l,f,v,S,k,R,B,V){const Z=this.cells[k];if(Z!==null){const ie=this.keys,ce=this.bboxes;for(let ve=0;ve<Z.length;ve++){const Se=Z[ve];if(B[Se]===void 0){const Ne=4*Se;(V?V(ce[Ne+0],ce[Ne+1],ce[Ne+2],ce[Ne+3]):l<=ce[Ne+2]&&f<=ce[Ne+3]&&v>=ce[Ne+0]&&S>=ce[Ne+1])?(B[Se]=!0,R.push(ie[Se])):B[Se]=!1}}}}_forEachCell(l,f,v,S,k,R,B,V){const Z=this._convertToCellCoord(l),ie=this._convertToCellCoord(f),ce=this._convertToCellCoord(v),ve=this._convertToCellCoord(S);for(let Se=Z;Se<=ce;Se++)for(let Ne=ie;Ne<=ve;Ne++){const ze=this.d*Ne+Se;if((!V||V(this._convertFromCellCoord(Se),this._convertFromCellCoord(Ne),this._convertFromCellCoord(Se+1),this._convertFromCellCoord(Ne+1)))&&k.call(this,l,f,v,S,ze,R,B,V))return}}_convertFromCellCoord(l){return(l-this.padding)/this.scale}_convertToCellCoord(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const l=this.cells,f=3+this.cells.length+1+1;let v=0;for(let R=0;R<this.cells.length;R++)v+=this.cells[R].length;const S=new Int32Array(f+v+this.keys.length+this.bboxes.length);S[0]=this.extent,S[1]=this.n,S[2]=this.padding;let k=f;for(let R=0;R<l.length;R++){const B=l[R];S[3+R]=k,S.set(B,k),k+=B.length}return S[3+l.length]=k,S.set(this.keys,k),k+=this.keys.length,S[3+l.length+1]=k,S.set(this.bboxes,k),k+=this.bboxes.length,S.buffer}static serialize(l,f){const v=l.toArrayBuffer();return f&&f.push(v),{buffer:v}}static deserialize(l){return new _r(l.buffer)}}const St={};function Pt(p,l,f={}){if(St[p])throw new Error(`${p} is already registered.`);Object.defineProperty(l,"_classRegistryKey",{value:p,writeable:!1}),St[p]={klass:l,omit:f.omit||[],shallow:f.shallow||[]}}Pt("Object",Object),Pt("Set",Set),Pt("TransferableGridIndex",_r),Pt("Color",kr),Pt("Error",Error),Pt("AJAXError",mt),Pt("ResolvedImage",wi),Pt("StylePropertyFunction",Fp),Pt("StyleExpression",Od,{omit:["_evaluator"]}),Pt("ZoomDependentExpression",Hg),Pt("ZoomConstantExpression",Np),Pt("CompoundExpression",En,{omit:["_evaluate"]});for(const p in Fn)Fn[p]._classRegistryKey||Pt(`Expression_${p}`,Fn[p]);function hr(p){return p&&typeof ArrayBuffer<"u"&&(p instanceof ArrayBuffer||p.constructor&&p.constructor.name==="ArrayBuffer")}function Lr(p){return p.$name||p.constructor._classRegistryKey}function gr(p){return!(function(l){if(l===null||typeof l!="object")return!1;const f=Lr(l);return!(!f||f==="Object")})(p)&&(p==null||typeof p=="boolean"||typeof p=="number"||typeof p=="string"||p instanceof Boolean||p instanceof Number||p instanceof String||p instanceof Date||p instanceof RegExp||p instanceof Blob||p instanceof Error||hr(p)||pr(p)||ArrayBuffer.isView(p)||p instanceof ImageData)}function Br(p,l){if(gr(p))return(hr(p)||pr(p))&&l&&l.push(p),ArrayBuffer.isView(p)&&l&&l.push(p.buffer),p instanceof ImageData&&l&&l.push(p.data.buffer),p;if(Array.isArray(p)){const k=[];for(const R of p)k.push(Br(R,l));return k}if(typeof p!="object")throw new Error("can't serialize object of type "+typeof p);const f=Lr(p);if(!f)throw new Error(`can't serialize object of unregistered class ${p.constructor.name}`);if(!St[f])throw new Error(`${f} is not registered.`);const{klass:v}=St[f],S=v.serialize?v.serialize(p,l):{};if(v.serialize){if(l&&S===l[l.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const k in p){if(!p.hasOwnProperty(k)||St[f].omit.indexOf(k)>=0)continue;const R=p[k];S[k]=St[f].shallow.indexOf(k)>=0?R:Br(R,l)}p instanceof Error&&(S.message=p.message)}if(S.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(S.$name=f),S}function jr(p){if(gr(p))return p;if(Array.isArray(p))return p.map(jr);if(typeof p!="object")throw new Error("can't deserialize object of type "+typeof p);const l=Lr(p)||"Object";if(!St[l])throw new Error(`can't deserialize unregistered class ${l}`);const{klass:f}=St[l];if(!f)throw new Error(`can't deserialize unregistered class ${l}`);if(f.deserialize)return f.deserialize(p);const v=Object.create(f.prototype);for(const S of Object.keys(p)){if(S==="$name")continue;const k=p[S];v[S]=St[l].shallow.indexOf(S)>=0?k:jr(k)}return v}class sn{constructor(){this.first=!0}update(l,f){const v=Math.floor(l);return this.first?(this.first=!1,this.lastIntegerZoom=v,this.lastIntegerZoomTime=0,this.lastZoom=l,this.lastFloorZoom=v,!0):(this.lastFloorZoom>v?(this.lastIntegerZoom=v+1,this.lastIntegerZoomTime=f):this.lastFloorZoom<v&&(this.lastIntegerZoom=v,this.lastIntegerZoomTime=f),l!==this.lastZoom&&(this.lastZoom=l,this.lastFloorZoom=v,!0))}}function Jr(p){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(p))}function Jn(p){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(p))}function Vn(p){return/\s/u.test(String.fromCodePoint(p))}function Ai(p){for(const l of p)if(Jn(l.codePointAt(0)))return!0;return!1}function Zn(p){for(const l of p)if(!Ni(l.codePointAt(0)))return!1;return!0}function Yi(p){const l=p.map((f=>{try{return new RegExp(`\\p{sc=${f}}`,"u").source}catch{return null}})).filter((f=>f));return new RegExp(l.join("|"),"u")}const No=Yi(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ni(p){return!No.test(String.fromCodePoint(p))}function Yn(p){return!(Jn(p)||(l=p,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(l))));var l}const wn=Yi(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function To(p){return wn.test(String.fromCodePoint(p))}function Pi(p,l){return!(!l&&To(p)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(p)))}function aa(p){for(const l of p)if(To(l.codePointAt(0)))return!0;return!1}const da=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(p){this.pluginStatus=p.pluginStatus,this.pluginURL=p.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(p){if(da.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=p.applyArabicShaping,this.processBidirectionalText=p.processBidirectionalText,this.processStyledBidirectionalText=p.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(p,l){return o(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(p.pluginStatus!=="loading")return this.setState(p),p;const f=p.pluginURL,v=new Promise((k=>{this.loadScriptResolve=k}));l(f);const S=new Promise((k=>setTimeout((()=>k()),this.TIMEOUT)));if(yield Promise.race([v,S]),this.isParsed()){const k={pluginStatus:"loaded",pluginURL:f};return this.setState(k),k}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${f}`)}))}};class ki{constructor(l,f){this.isSupportedScript=kl,this.zoom=l,f?(this.now=f.now||0,this.fadeDuration=f.fadeDuration||0,this.zoomHistory=f.zoomHistory||new sn,this.transition=f.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new sn,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const l=this.zoom,f=l-Math.floor(l),v=this.crossFadingFactor();return l>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:f+(1-f)*v}:{fromScale:.5,toScale:1,t:1-(1-v)*f}}}function kl(p){return(function(l,f){for(const v of l)if(!Pi(v.codePointAt(0),f))return!1;return!0})(p,da.getRTLTextPluginStatus()==="loaded")}const Qa="-transition";class ys{constructor(l,f,v){this.property=l,this.value=f,this.expression=(function(S,k,R){if(Nu(S))return new Fp(S,k);if(Vc(S)){const B=Lp(S,k,R);if(B.result==="error")throw new Error(B.value.map((V=>`${V.key}: ${V.message}`)).join(", "));return B.value}{let B=S;return k.type==="color"&&typeof S=="string"?B=kr.parse(S):k.type!=="padding"||typeof S!="number"&&!Array.isArray(S)?k.type!=="numberArray"||typeof S!="number"&&!Array.isArray(S)?k.type!=="colorArray"||typeof S!="string"&&!Array.isArray(S)?k.type==="variableAnchorOffsetCollection"&&Array.isArray(S)?B=ba.parse(S):k.type==="projectionDefinition"&&typeof S=="string"&&(B=fi.parse(S)):B=mn.parse(S):B=fn.parse(S):B=Mr.parse(S),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>B}}})(f===void 0?l.specification.default:f,l.specification,v)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(l,f,v){return this.property.possiblyEvaluate(this,l,f,v)}}class ks{constructor(l,f){this.property=l,this.value=new ys(l,void 0,f)}transitioned(l,f){return new sa(this.property,this.value,f,Be({},l.transition,this.transition),l.now)}untransitioned(){return new sa(this.property,this.value,null,{},0)}}class Wo{constructor(l,f){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues),this._globalState=f}getValue(l){return Re(this._values[l].value.value)}setValue(l,f){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new ks(this._values[l].property,this._globalState)),this._values[l].value=new ys(this._values[l].property,f===null?void 0:Re(f),this._globalState)}getTransition(l){return Re(this._values[l].transition)}setTransition(l,f){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new ks(this._values[l].property,this._globalState)),this._values[l].transition=Re(f)||void 0}serialize(){const l={};for(const f of Object.keys(this._values)){const v=this.getValue(f);v!==void 0&&(l[f]=v);const S=this.getTransition(f);S!==void 0&&(l[`${f}${Qa}`]=S)}return l}transitioned(l,f){const v=new wa(this._properties);for(const S of Object.keys(this._values))v._values[S]=this._values[S].transitioned(l,f._values[S]);return v}untransitioned(){const l=new wa(this._properties);for(const f of Object.keys(this._values))l._values[f]=this._values[f].untransitioned();return l}}class sa{constructor(l,f,v,S,k){this.property=l,this.value=f,this.begin=k+S.delay||0,this.end=this.begin+S.duration||0,l.specification.transition&&(S.delay||S.duration)&&(this.prior=v)}possiblyEvaluate(l,f,v){const S=l.now||0,k=this.value.possiblyEvaluate(l,f,v),R=this.prior;if(R){if(S>this.end)return this.prior=null,k;if(this.value.isDataDriven())return this.prior=null,k;if(S<this.begin)return R.possiblyEvaluate(l,f,v);{const B=(S-this.begin)/(this.end-this.begin);return this.property.interpolate(R.possiblyEvaluate(l,f,v),k,Ee(B))}}return k}}class wa{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,f,v){const S=new Go(this._properties);for(const k of Object.keys(this._values))S._values[k]=this._values[k].possiblyEvaluate(l,f,v);return S}hasTransition(){for(const l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class Co{constructor(l,f){this._properties=l,this._values=Object.create(l.defaultPropertyValues),this._globalState=f}hasValue(l){return this._values[l].value!==void 0}getValue(l){return Re(this._values[l].value)}setValue(l,f){this._values[l]=new ys(this._values[l].property,f===null?void 0:Re(f),this._globalState)}serialize(){const l={};for(const f of Object.keys(this._values)){const v=this.getValue(f);v!==void 0&&(l[f]=v)}return l}possiblyEvaluate(l,f,v){const S=new Go(this._properties);for(const k of Object.keys(this._values))S._values[k]=this._values[k].possiblyEvaluate(l,f,v);return S}}class qi{constructor(l,f,v){this.property=l,this.value=f,this.parameters=v}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,f,v,S){return this.property.evaluate(this.value,this.parameters,l,f,v,S)}}class Go{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class Tn{constructor(l){this.specification=l}possiblyEvaluate(l,f){if(l.isDataDriven())throw new Error("Value should not be data driven");return l.expression.evaluate(f)}interpolate(l,f,v){const S=Hn[this.specification.type];return S?S(l,f,v):l}}class Sn{constructor(l,f){this.specification=l,this.overrides=f}possiblyEvaluate(l,f,v,S){return new qi(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(f,null,{},v,S)}:l.expression,f)}interpolate(l,f,v){if(l.value.kind!=="constant"||f.value.kind!=="constant")return l;if(l.value.value===void 0||f.value.value===void 0)return new qi(this,{kind:"constant",value:void 0},l.parameters);const S=Hn[this.specification.type];if(S){const k=S(l.value.value,f.value.value,v);return new qi(this,{kind:"constant",value:k},l.parameters)}return l}evaluate(l,f,v,S,k,R){return l.kind==="constant"?l.value:l.evaluate(f,v,S,k,R)}}class Rs extends Sn{possiblyEvaluate(l,f,v,S){if(l.value===void 0)return new qi(this,{kind:"constant",value:void 0},f);if(l.expression.kind==="constant"){const k=l.expression.evaluate(f,null,{},v,S),R=l.property.specification.type==="resolvedImage"&&typeof k!="string"?k.name:k,B=this._calculate(R,R,R,f);return new qi(this,{kind:"constant",value:B},f)}if(l.expression.kind==="camera"){const k=this._calculate(l.expression.evaluate({zoom:f.zoom-1}),l.expression.evaluate({zoom:f.zoom}),l.expression.evaluate({zoom:f.zoom+1}),f);return new qi(this,{kind:"constant",value:k},f)}return new qi(this,l.expression,f)}evaluate(l,f,v,S,k,R){if(l.kind==="source"){const B=l.evaluate(f,v,S,k,R);return this._calculate(B,B,B,f)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(f.zoom)-1},v,S),l.evaluate({zoom:Math.floor(f.zoom)},v,S),l.evaluate({zoom:Math.floor(f.zoom)+1},v,S),f):l.value}_calculate(l,f,v,S){return S.zoom>S.zoomHistory.lastIntegerZoom?{from:l,to:f}:{from:v,to:f}}interpolate(l){return l}}class Sa{constructor(l){this.specification=l}possiblyEvaluate(l,f,v,S){if(l.value!==void 0){if(l.expression.kind==="constant"){const k=l.expression.evaluate(f,null,{},v,S);return this._calculate(k,k,k,f)}return this._calculate(l.expression.evaluate(new ki(Math.floor(f.zoom-1),f)),l.expression.evaluate(new ki(Math.floor(f.zoom),f)),l.expression.evaluate(new ki(Math.floor(f.zoom+1),f)),f)}}_calculate(l,f,v,S){return S.zoom>S.zoomHistory.lastIntegerZoom?{from:l,to:f}:{from:v,to:f}}interpolate(l){return l}}class Lo{constructor(l){this.specification=l}possiblyEvaluate(l,f,v,S){return!!l.expression.evaluate(f,null,{},v,S)}interpolate(){return!1}}class $a{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const f in l){const v=l[f];v.specification.overridable&&this.overridableProperties.push(f);const S=this.defaultPropertyValues[f]=new ys(v,void 0,void 0),k=this.defaultTransitionablePropertyValues[f]=new ks(v,void 0);this.defaultTransitioningPropertyValues[f]=k.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=S.possiblyEvaluate({})}}}Pt("DataDrivenProperty",Sn),Pt("DataConstantProperty",Tn),Pt("CrossFadedDataDrivenProperty",Rs),Pt("CrossFadedProperty",Sa),Pt("ColorRampProperty",Lo);class eo extends zr{constructor(l,f,v){if(super(),this.id=l.id,this.type=l.type,this._globalState=v,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=(function(S,k){return new Pe(S,k)})(this.visibility,v),l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter,this._featureFilter=rf(l.filter,v)),f.layout&&(this._unevaluatedLayout=new Co(f.layout,v)),f.paint)){this._transitionablePaint=new Wo(f.paint,v);for(const S in l.paint)this.setPaintProperty(S,l.paint[S],{validate:!1});for(const S in l.layout)this.setLayoutProperty(S,l.layout[S],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Go(f.paint)}}setFilter(l){this.filter=l,this._featureFilter=rf(l,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}getLayoutAffectingGlobalStateRefs(){const l=new Set;for(const f of this._visibilityExpression.getGlobalStateRefs())l.add(f);if(this._unevaluatedLayout)for(const f in this._unevaluatedLayout._values){const v=this._unevaluatedLayout._values[f];for(const S of v.getGlobalStateRefs())l.add(S)}for(const f of this._featureFilter.getGlobalStateRefs())l.add(f);return l}getPaintAffectingGlobalStateRefs(){var l;const f=new globalThis.Map;if(this._transitionablePaint)for(const v in this._transitionablePaint._values){const S=this._transitionablePaint._values[v].value;for(const k of S.getGlobalStateRefs()){const R=(l=f.get(k))!==null&&l!==void 0?l:[];R.push({name:v,value:S.value}),f.set(k,R)}}return f}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(l,f,v={}){if(f==null||!this._validate(At,`layers.${this.id}.layout.${l}`,l,f,v))return l==="visibility"?(this.visibility=f,this._visibilityExpression.setValue(f),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(l,f)}getPaintProperty(l){return l.endsWith(Qa)?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)}setPaintProperty(l,f,v={}){if(f!=null&&this._validate(yt,`layers.${this.id}.paint.${l}`,l,f,v))return!1;if(l.endsWith(Qa))return this._transitionablePaint.setTransition(l.slice(0,-11),f||void 0),!1;{const S=this._transitionablePaint._values[l],k=S.property.specification["property-type"]==="cross-faded-data-driven",R=S.value.isDataDriven(),B=S.value;this._transitionablePaint.setValue(l,f),this._handleSpecialPaintPropertyUpdate(l);const V=this._transitionablePaint._values[l].value;return V.isDataDriven()||R||k||this._handleOverridablePaintPropertyUpdate(l,B,V)}}_handleSpecialPaintPropertyUpdate(l){}_handleOverridablePaintPropertyUpdate(l,f,v){return!1}isHidden(l=this.minzoom,f=!1){return!!(this.minzoom&&l<(f?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&l>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(l,f){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,f)}serialize(){const l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),rt(l,((f,v)=>!(f===void 0||v==="layout"&&!Object.keys(f).length||v==="paint"&&!Object.keys(f).length)))}_validate(l,f,v,S,k={}){return(!k||k.validate!==!1)&&Xt(this,l.call(Je,{key:f,layerType:this.type,objectKey:v,value:S,styleSpec:Mt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const l in this.paint._values){const f=this.paint.get(l);if(f instanceof qi&&Wl(f.property.specification)&&(f.value.kind==="source"||f.value.kind==="composite")&&f.value.isStateDependent)return!0}return!1}}let Rl;var Yl={get paint(){return Rl=Rl||new $a({"raster-opacity":new Tn(Mt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Tn(Mt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Tn(Mt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Tn(Mt.paint_raster["raster-brightness-max"]),"raster-saturation":new Tn(Mt.paint_raster["raster-saturation"]),"raster-contrast":new Tn(Mt.paint_raster["raster-contrast"]),"raster-resampling":new Tn(Mt.paint_raster["raster-resampling"]),"raster-fade-duration":new Tn(Mt.paint_raster["raster-fade-duration"])})}};class Zl extends eo{constructor(l,f){super(l,Yl,f)}}const gu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ea{constructor(l,f){this._structArray=l,this._pos1=f*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ia{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,f){return l._trim(),f&&(l.isTransferred=!0,f.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){const f=Object.create(this.prototype);return f.arrayBuffer=l.arrayBuffer,f.length=l.length,f.capacity=l.arrayBuffer.byteLength/f.bytesPerElement,f._refreshViews(),f}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const f=this.uint8;this._refreshViews(),f&&this.uint8.set(f)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function pa(p,l=1){let f=0,v=0;return{members:p.map((S=>{const k=gu[S.type].BYTES_PER_ELEMENT,R=f=mu(f,Math.max(l,k)),B=S.components||1;return v=Math.max(v,k),f+=k*B,{name:S.name,type:S.type,components:B,offset:R}})),size:mu(f,Math.max(v,l)),alignment:l}}function mu(p,l){return Math.ceil(p/l)*l}class yu extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f){const v=this.length;return this.resize(v+1),this.emplace(v,l,f)}emplace(l,f,v){const S=2*l;return this.int16[S+0]=f,this.int16[S+1]=v,l}}yu.prototype.bytesPerElement=4,Pt("StructArrayLayout2i4",yu);class is extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,f,v)}emplace(l,f,v,S){const k=3*l;return this.int16[k+0]=f,this.int16[k+1]=v,this.int16[k+2]=S,l}}is.prototype.bytesPerElement=6,Pt("StructArrayLayout3i6",is);class jf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,v,S){const k=this.length;return this.resize(k+1),this.emplace(k,l,f,v,S)}emplace(l,f,v,S,k){const R=4*l;return this.int16[R+0]=f,this.int16[R+1]=v,this.int16[R+2]=S,this.int16[R+3]=k,l}}jf.prototype.bytesPerElement=8,Pt("StructArrayLayout4i8",jf);class Uf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,v,S,k,R){const B=this.length;return this.resize(B+1),this.emplace(B,l,f,v,S,k,R)}emplace(l,f,v,S,k,R,B){const V=6*l;return this.int16[V+0]=f,this.int16[V+1]=v,this.int16[V+2]=S,this.int16[V+3]=k,this.int16[V+4]=R,this.int16[V+5]=B,l}}Uf.prototype.bytesPerElement=12,Pt("StructArrayLayout2i4i12",Uf);class Vf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,v,S,k,R){const B=this.length;return this.resize(B+1),this.emplace(B,l,f,v,S,k,R)}emplace(l,f,v,S,k,R,B){const V=4*l,Z=8*l;return this.int16[V+0]=f,this.int16[V+1]=v,this.uint8[Z+4]=S,this.uint8[Z+5]=k,this.uint8[Z+6]=R,this.uint8[Z+7]=B,l}}Vf.prototype.bytesPerElement=8,Pt("StructArrayLayout2i4ub8",Vf);class qc extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f){const v=this.length;return this.resize(v+1),this.emplace(v,l,f)}emplace(l,f,v){const S=2*l;return this.float32[S+0]=f,this.float32[S+1]=v,l}}qc.prototype.bytesPerElement=8,Pt("StructArrayLayout2f8",qc);class Hc extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,v,S,k,R,B,V,Z,ie){const ce=this.length;return this.resize(ce+1),this.emplace(ce,l,f,v,S,k,R,B,V,Z,ie)}emplace(l,f,v,S,k,R,B,V,Z,ie,ce){const ve=10*l;return this.uint16[ve+0]=f,this.uint16[ve+1]=v,this.uint16[ve+2]=S,this.uint16[ve+3]=k,this.uint16[ve+4]=R,this.uint16[ve+5]=B,this.uint16[ve+6]=V,this.uint16[ve+7]=Z,this.uint16[ve+8]=ie,this.uint16[ve+9]=ce,l}}Hc.prototype.bytesPerElement=20,Pt("StructArrayLayout10ui20",Hc);class $p extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,v,S,k,R,B,V){const Z=this.length;return this.resize(Z+1),this.emplace(Z,l,f,v,S,k,R,B,V)}emplace(l,f,v,S,k,R,B,V,Z){const ie=8*l;return this.uint16[ie+0]=f,this.uint16[ie+1]=v,this.uint16[ie+2]=S,this.uint16[ie+3]=k,this.uint16[ie+4]=R,this.uint16[ie+5]=B,this.uint16[ie+6]=V,this.uint16[ie+7]=Z,l}}$p.prototype.bytesPerElement=16,Pt("StructArrayLayout8ui16",$p);class of extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,v,S,k,R,B,V,Z,ie,ce,ve){const Se=this.length;return this.resize(Se+1),this.emplace(Se,l,f,v,S,k,R,B,V,Z,ie,ce,ve)}emplace(l,f,v,S,k,R,B,V,Z,ie,ce,ve,Se){const Ne=12*l;return this.int16[Ne+0]=f,this.int16[Ne+1]=v,this.int16[Ne+2]=S,this.int16[Ne+3]=k,this.uint16[Ne+4]=R,this.uint16[Ne+5]=B,this.uint16[Ne+6]=V,this.uint16[Ne+7]=Z,this.int16[Ne+8]=ie,this.int16[Ne+9]=ce,this.int16[Ne+10]=ve,this.int16[Ne+11]=Se,l}}of.prototype.bytesPerElement=24,Pt("StructArrayLayout4i4ui4i24",of);class sc extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,f,v)}emplace(l,f,v,S){const k=3*l;return this.float32[k+0]=f,this.float32[k+1]=v,this.float32[k+2]=S,l}}sc.prototype.bytesPerElement=12,Pt("StructArrayLayout3f12",sc);class Vd extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){const f=this.length;return this.resize(f+1),this.emplace(f,l)}emplace(l,f){return this.uint32[1*l+0]=f,l}}Vd.prototype.bytesPerElement=4,Pt("StructArrayLayout1ul4",Vd);class Qg extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,v,S,k,R,B,V,Z){const ie=this.length;return this.resize(ie+1),this.emplace(ie,l,f,v,S,k,R,B,V,Z)}emplace(l,f,v,S,k,R,B,V,Z,ie){const ce=10*l,ve=5*l;return this.int16[ce+0]=f,this.int16[ce+1]=v,this.int16[ce+2]=S,this.int16[ce+3]=k,this.int16[ce+4]=R,this.int16[ce+5]=B,this.uint32[ve+3]=V,this.uint16[ce+8]=Z,this.uint16[ce+9]=ie,l}}Qg.prototype.bytesPerElement=20,Pt("StructArrayLayout6i1ul2ui20",Qg);class $f extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,v,S,k,R){const B=this.length;return this.resize(B+1),this.emplace(B,l,f,v,S,k,R)}emplace(l,f,v,S,k,R,B){const V=6*l;return this.int16[V+0]=f,this.int16[V+1]=v,this.int16[V+2]=S,this.int16[V+3]=k,this.int16[V+4]=R,this.int16[V+5]=B,l}}$f.prototype.bytesPerElement=12,Pt("StructArrayLayout2i2i2i12",$f);class xh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,v,S,k){const R=this.length;return this.resize(R+1),this.emplace(R,l,f,v,S,k)}emplace(l,f,v,S,k,R){const B=4*l,V=8*l;return this.float32[B+0]=f,this.float32[B+1]=v,this.float32[B+2]=S,this.int16[V+6]=k,this.int16[V+7]=R,l}}xh.prototype.bytesPerElement=16,Pt("StructArrayLayout2f1f2i16",xh);class qf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,v,S,k,R){const B=this.length;return this.resize(B+1),this.emplace(B,l,f,v,S,k,R)}emplace(l,f,v,S,k,R,B){const V=16*l,Z=4*l,ie=8*l;return this.uint8[V+0]=f,this.uint8[V+1]=v,this.float32[Z+1]=S,this.float32[Z+2]=k,this.int16[ie+6]=R,this.int16[ie+7]=B,l}}qf.prototype.bytesPerElement=16,Pt("StructArrayLayout2ub2f2i16",qf);class Hf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,f,v)}emplace(l,f,v,S){const k=3*l;return this.uint16[k+0]=f,this.uint16[k+1]=v,this.uint16[k+2]=S,l}}Hf.prototype.bytesPerElement=6,Pt("StructArrayLayout3ui6",Hf);class wh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,v,S,k,R,B,V,Z,ie,ce,ve,Se,Ne,ze,Ve,et){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,l,f,v,S,k,R,B,V,Z,ie,ce,ve,Se,Ne,ze,Ve,et)}emplace(l,f,v,S,k,R,B,V,Z,ie,ce,ve,Se,Ne,ze,Ve,et,Ct){const nt=24*l,ut=12*l,Rt=48*l;return this.int16[nt+0]=f,this.int16[nt+1]=v,this.uint16[nt+2]=S,this.uint16[nt+3]=k,this.uint32[ut+2]=R,this.uint32[ut+3]=B,this.uint32[ut+4]=V,this.uint16[nt+10]=Z,this.uint16[nt+11]=ie,this.uint16[nt+12]=ce,this.float32[ut+7]=ve,this.float32[ut+8]=Se,this.uint8[Rt+36]=Ne,this.uint8[Rt+37]=ze,this.uint8[Rt+38]=Ve,this.uint32[ut+10]=et,this.int16[nt+22]=Ct,l}}wh.prototype.bytesPerElement=48,Pt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",wh);class Wf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,v,S,k,R,B,V,Z,ie,ce,ve,Se,Ne,ze,Ve,et,Ct,nt,ut,Rt,Ft,fr,Or,Pr,Vr,pn,Gr){const Rr=this.length;return this.resize(Rr+1),this.emplace(Rr,l,f,v,S,k,R,B,V,Z,ie,ce,ve,Se,Ne,ze,Ve,et,Ct,nt,ut,Rt,Ft,fr,Or,Pr,Vr,pn,Gr)}emplace(l,f,v,S,k,R,B,V,Z,ie,ce,ve,Se,Ne,ze,Ve,et,Ct,nt,ut,Rt,Ft,fr,Or,Pr,Vr,pn,Gr,Rr){const Er=32*l,Cn=16*l;return this.int16[Er+0]=f,this.int16[Er+1]=v,this.int16[Er+2]=S,this.int16[Er+3]=k,this.int16[Er+4]=R,this.int16[Er+5]=B,this.int16[Er+6]=V,this.int16[Er+7]=Z,this.uint16[Er+8]=ie,this.uint16[Er+9]=ce,this.uint16[Er+10]=ve,this.uint16[Er+11]=Se,this.uint16[Er+12]=Ne,this.uint16[Er+13]=ze,this.uint16[Er+14]=Ve,this.uint16[Er+15]=et,this.uint16[Er+16]=Ct,this.uint16[Er+17]=nt,this.uint16[Er+18]=ut,this.uint16[Er+19]=Rt,this.uint16[Er+20]=Ft,this.uint16[Er+21]=fr,this.uint16[Er+22]=Or,this.uint32[Cn+12]=Pr,this.float32[Cn+13]=Vr,this.float32[Cn+14]=pn,this.uint16[Er+30]=Gr,this.uint16[Er+31]=Rr,l}}Wf.prototype.bytesPerElement=64,Pt("StructArrayLayout8i15ui1ul2f2ui64",Wf);class Gf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){const f=this.length;return this.resize(f+1),this.emplace(f,l)}emplace(l,f){return this.float32[1*l+0]=f,l}}Gf.prototype.bytesPerElement=4,Pt("StructArrayLayout1f4",Gf);class Sh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,f,v)}emplace(l,f,v,S){const k=3*l;return this.uint16[6*l+0]=f,this.float32[k+1]=v,this.float32[k+2]=S,l}}Sh.prototype.bytesPerElement=12,Pt("StructArrayLayout1ui2f12",Sh);class qp extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,f,v)}emplace(l,f,v,S){const k=4*l;return this.uint32[2*l+0]=f,this.uint16[k+2]=v,this.uint16[k+3]=S,l}}qp.prototype.bytesPerElement=8,Pt("StructArrayLayout1ul2ui8",qp);class D extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f){const v=this.length;return this.resize(v+1),this.emplace(v,l,f)}emplace(l,f,v){const S=2*l;return this.uint16[S+0]=f,this.uint16[S+1]=v,l}}D.prototype.bytesPerElement=4,Pt("StructArrayLayout2ui4",D);class u extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){const f=this.length;return this.resize(f+1),this.emplace(f,l)}emplace(l,f){return this.uint16[1*l+0]=f,l}}u.prototype.bytesPerElement=2,Pt("StructArrayLayout1ui2",u);class g extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,v,S){const k=this.length;return this.resize(k+1),this.emplace(k,l,f,v,S)}emplace(l,f,v,S,k){const R=4*l;return this.float32[R+0]=f,this.float32[R+1]=v,this.float32[R+2]=S,this.float32[R+3]=k,l}}g.prototype.bytesPerElement=16,Pt("StructArrayLayout4f16",g);class w extends Ea{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new c(this.anchorPointX,this.anchorPointY)}}w.prototype.size=20;class C extends Qg{get(l){return new w(this,l)}}Pt("CollisionBoxArray",C);class L extends Ea{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(l){this._structArray.uint8[this._pos1+37]=l}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(l){this._structArray.uint8[this._pos1+38]=l}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(l){this._structArray.uint32[this._pos4+10]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}L.prototype.size=48;class z extends wh{get(l){return new L(this,l)}}Pt("PlacedSymbolArray",z);class Y extends Ea{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(l){this._structArray.uint32[this._pos4+12]=l}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Y.prototype.size=64;class re extends Wf{get(l){return new Y(this,l)}}Pt("SymbolInstanceArray",re);class le extends Gf{getoffsetX(l){return this.float32[1*l+0]}}Pt("GlyphOffsetArray",le);class fe extends is{getx(l){return this.int16[3*l+0]}gety(l){return this.int16[3*l+1]}gettileUnitDistanceFromAnchor(l){return this.int16[3*l+2]}}Pt("SymbolLineVertexArray",fe);class Ie extends Ea{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ie.prototype.size=12;class Te extends Sh{get(l){return new Ie(this,l)}}Pt("TextAnchorOffsetArray",Te);class Ue extends Ea{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ue.prototype.size=8;class Ze extends qp{get(l){return new Ue(this,l)}}Pt("FeatureIndexArray",Ze);class ft extends yu{}class pt extends yu{}class dt extends yu{}class xt extends Uf{}class Ot extends Vf{}class wt extends qc{}class Nt extends Hc{}class jt extends $p{}class Dt extends of{}class Yt extends sc{}class Sr extends Vd{}class dr extends $f{}class yr extends qf{}class xr extends Hf{}class an extends D{}const ln=pa([{name:"a_pos",components:2,type:"Int16"}],4),{members:Hr}=ln;class gn{constructor(l=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=l}prepareSegment(l,f,v,S){const k=this.segments[this.segments.length-1];return l>gn.MAX_VERTEX_ARRAY_LENGTH&&st(`Max vertices per segment is ${gn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${gn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!k||k.vertexLength+l>gn.MAX_VERTEX_ARRAY_LENGTH||k.sortKey!==S?this.createNewSegment(f,v,S):k}createNewSegment(l,f,v){const S={vertexOffset:l.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0,vaos:{}};return v!==void 0&&(S.sortKey=v),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(S),S}getOrCreateLatestSegment(l,f,v){return this.prepareSegment(0,l,f,v)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const l of this.segments)for(const f in l.vaos)l.vaos[f].destroy()}static simpleSegment(l,f,v,S){return new gn([{vertexOffset:l,primitiveOffset:f,vertexLength:v,primitiveLength:S,vaos:{},sortKey:0}])}}function Ti(p,l){return 256*(p=Fe(Math.floor(p),0,255))+Fe(Math.floor(l),0,255)}gn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pt("SegmentVector",gn);const Ra=pa([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),yo=pa([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var to,Ao,ro,Xo={exports:{}},Io={exports:{}},pl={exports:{}},vs=(function(){if(ro)return Xo.exports;ro=1;var p=(to||(to=1,Io.exports=function(f,v){var S,k,R,B,V,Z,ie,ce;for(k=f.length-(S=3&f.length),R=v,V=3432918353,Z=461845907,ce=0;ce<k;)ie=255&f.charCodeAt(ce)|(255&f.charCodeAt(++ce))<<8|(255&f.charCodeAt(++ce))<<16|(255&f.charCodeAt(++ce))<<24,++ce,R=27492+(65535&(B=5*(65535&(R=(R^=ie=(65535&(ie=(ie=(65535&ie)*V+(((ie>>>16)*V&65535)<<16)&4294967295)<<15|ie>>>17))*Z+(((ie>>>16)*Z&65535)<<16)&4294967295)<<13|R>>>19))+((5*(R>>>16)&65535)<<16)&4294967295))+((58964+(B>>>16)&65535)<<16);switch(ie=0,S){case 3:ie^=(255&f.charCodeAt(ce+2))<<16;case 2:ie^=(255&f.charCodeAt(ce+1))<<8;case 1:R^=ie=(65535&(ie=(ie=(65535&(ie^=255&f.charCodeAt(ce)))*V+(((ie>>>16)*V&65535)<<16)&4294967295)<<15|ie>>>17))*Z+(((ie>>>16)*Z&65535)<<16)&4294967295}return R^=f.length,R=2246822507*(65535&(R^=R>>>16))+((2246822507*(R>>>16)&65535)<<16)&4294967295,R=3266489909*(65535&(R^=R>>>13))+((3266489909*(R>>>16)&65535)<<16)&4294967295,(R^=R>>>16)>>>0}),Io.exports),l=(Ao||(Ao=1,pl.exports=function(f,v){for(var S,k=f.length,R=v^k,B=0;k>=4;)S=1540483477*(65535&(S=255&f.charCodeAt(B)|(255&f.charCodeAt(++B))<<8|(255&f.charCodeAt(++B))<<16|(255&f.charCodeAt(++B))<<24))+((1540483477*(S>>>16)&65535)<<16),R=1540483477*(65535&R)+((1540483477*(R>>>16)&65535)<<16)^(S=1540483477*(65535&(S^=S>>>24))+((1540483477*(S>>>16)&65535)<<16)),k-=4,++B;switch(k){case 3:R^=(255&f.charCodeAt(B+2))<<16;case 2:R^=(255&f.charCodeAt(B+1))<<8;case 1:R=1540483477*(65535&(R^=255&f.charCodeAt(B)))+((1540483477*(R>>>16)&65535)<<16)}return R=1540483477*(65535&(R^=R>>>13))+((1540483477*(R>>>16)&65535)<<16),(R^=R>>>15)>>>0}),pl.exports);return Xo.exports=p,Xo.exports.murmur3=p,Xo.exports.murmur2=l,Xo.exports})(),as=h(vs);class Ml{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,f,v,S){this.ids.push(Xf(l)),this.positions.push(f,v,S)}getPositions(l){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const f=Xf(l);let v=0,S=this.ids.length-1;for(;v<S;){const R=v+S>>1;this.ids[R]>=f?S=R:v=R+1}const k=[];for(;this.ids[v]===f;)k.push({index:this.positions[3*v],start:this.positions[3*v+1],end:this.positions[3*v+2]}),v++;return k}static serialize(l,f){const v=new Float64Array(l.ids),S=new Uint32Array(l.positions);return sf(v,S,0,v.length-1),f&&f.push(v.buffer,S.buffer),{ids:v,positions:S}}static deserialize(l){const f=new Ml;return f.ids=l.ids,f.positions=l.positions,f.indexed=!0,f}}function Xf(p){const l=+p;return!isNaN(l)&&l<=Number.MAX_SAFE_INTEGER?l:as(String(p))}function sf(p,l,f,v){for(;f<v;){const S=p[f+v>>1];let k=f-1,R=v+1;for(;;){do k++;while(p[k]<S);do R--;while(p[R]>S);if(k>=R)break;Eh(p,k,R),Eh(l,3*k,3*R),Eh(l,3*k+1,3*R+1),Eh(l,3*k+2,3*R+2)}R-f<v-R?(sf(p,l,f,R),f=R+1):(sf(p,l,R+1,v),v=R)}}function Eh(p,l,f){const v=p[l];p[l]=p[f],p[f]=v}Pt("FeaturePositionMap",Ml);class zu{constructor(l,f){this.gl=l.gl,this.location=f}}class $d extends zu{constructor(l,f){super(l,f),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class em extends zu{constructor(l,f){super(l,f),this.current=[0,0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))}}class qd extends zu{constructor(l,f){super(l,f),this.current=kr.transparent}set(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))}}const Sc=new Float32Array(16);function Th(p){return[Ti(255*p.r,255*p.g),Ti(255*p.b,255*p.a)]}class Wc{constructor(l,f,v){this.value=l,this.uniformNames=f.map((S=>`u_${S}`)),this.type=v}setUniform(l,f,v){l.set(v.constantOr(this.value))}getBinding(l,f,v){return this.type==="color"?new qd(l,f):new $d(l,f)}}class Gc{constructor(l,f){this.uniformNames=f.map((v=>`u_${v}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(l,f){this.pixelRatioFrom=f.pixelRatio,this.pixelRatioTo=l.pixelRatio,this.patternFrom=f.tlbr,this.patternTo=l.tlbr}setConstantDashPositions(l,f){this.dashTo=[0,l.y,l.height,l.width],this.dashFrom=[0,f.y,f.height,f.width]}setUniform(l,f,v,S){let k=null;S==="u_pattern_to"?k=this.patternTo:S==="u_pattern_from"?k=this.patternFrom:S==="u_dasharray_to"?k=this.dashTo:S==="u_dasharray_from"?k=this.dashFrom:S==="u_pixel_ratio_to"?k=this.pixelRatioTo:S==="u_pixel_ratio_from"&&(k=this.pixelRatioFrom),k!==null&&l.set(k)}getBinding(l,f,v){return v.substr(0,9)==="u_pattern"||v.substr(0,12)==="u_dasharray_"?new em(l,f):new $d(l,f)}}class lo{constructor(l,f,v,S){this.expression=l,this.type=v,this.maxValue=0,this.paintVertexAttributes=f.map((k=>({name:`a_${k}`,type:"Float32",components:v==="color"?2:1,offset:0}))),this.paintVertexArray=new S}populatePaintArray(l,f,v){const S=this.paintVertexArray.length,k=this.expression.evaluate(new ki(0,v),f,{},v.canonical,[],v.formattedSection);this.paintVertexArray.resize(l),this._setPaintValue(S,l,k)}updatePaintArray(l,f,v,S,k){const R=this.expression.evaluate(new ki(0,k),v,S);this._setPaintValue(l,f,R)}_setPaintValue(l,f,v){if(this.type==="color"){const S=Th(v);for(let k=l;k<f;k++)this.paintVertexArray.emplace(k,S[0],S[1])}else{for(let S=l;S<f;S++)this.paintVertexArray.emplace(S,v);this.maxValue=Math.max(this.maxValue,Math.abs(v))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class no{constructor(l,f,v,S,k,R){this.expression=l,this.uniformNames=f.map((B=>`u_${B}_t`)),this.type=v,this.useIntegerZoom=S,this.zoom=k,this.maxValue=0,this.paintVertexAttributes=f.map((B=>({name:`a_${B}`,type:"Float32",components:v==="color"?4:2,offset:0}))),this.paintVertexArray=new R}populatePaintArray(l,f,v){const S=this.expression.evaluate(new ki(this.zoom,v),f,{},v.canonical,[],v.formattedSection),k=this.expression.evaluate(new ki(this.zoom+1,v),f,{},v.canonical,[],v.formattedSection),R=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(R,l,S,k)}updatePaintArray(l,f,v,S,k){const R=this.expression.evaluate(new ki(this.zoom,k),v,S),B=this.expression.evaluate(new ki(this.zoom+1,k),v,S);this._setPaintValue(l,f,R,B)}_setPaintValue(l,f,v,S){if(this.type==="color"){const k=Th(v),R=Th(S);for(let B=l;B<f;B++)this.paintVertexArray.emplace(B,k[0],k[1],R[0],R[1])}else{for(let k=l;k<f;k++)this.paintVertexArray.emplace(k,v,S);this.maxValue=Math.max(this.maxValue,Math.abs(v),Math.abs(S))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,f){const v=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,S=Fe(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);l.set(S)}getBinding(l,f,v){return new $d(l,f)}}class Js{constructor(l,f,v,S,k,R){this.expression=l,this.type=f,this.useIntegerZoom=v,this.zoom=S,this.layerId=R,this.zoomInPaintVertexArray=new k,this.zoomOutPaintVertexArray=new k}populatePaintArray(l,f,v){const S=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(l),this.zoomOutPaintVertexArray.resize(l),this._setPaintValues(S,l,this.getPositionIds(f),v)}updatePaintArray(l,f,v,S,k){this._setPaintValues(l,f,this.getPositionIds(v),k)}_setPaintValues(l,f,v,S){const k=this.getPositions(S);if(!k||!v)return;const R=k[v.min],B=k[v.mid],V=k[v.max];if(R&&B&&V)for(let Z=l;Z<f;Z++)this.emplace(this.zoomInPaintVertexArray,Z,B,R),this.emplace(this.zoomOutPaintVertexArray,Z,B,V)}upload(l){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const f=this.getVertexAttributes();this.zoomInPaintVertexBuffer=l.createVertexBuffer(this.zoomInPaintVertexArray,f,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=l.createVertexBuffer(this.zoomOutPaintVertexArray,f,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Qs extends Js{getPositions(l){return l.imagePositions}getPositionIds(l){return l.patterns&&l.patterns[this.layerId]}getVertexAttributes(){return Ra.members}emplace(l,f,v,S){l.emplace(f,v.tlbr[0],v.tlbr[1],v.tlbr[2],v.tlbr[3],S.tlbr[0],S.tlbr[1],S.tlbr[2],S.tlbr[3],v.pixelRatio,S.pixelRatio)}}class l2 extends Js{getPositions(l){return l.dashPositions}getPositionIds(l){return l.dashes&&l.dashes[this.layerId]}getVertexAttributes(){return yo.members}emplace(l,f,v,S){l.emplace(f,0,v.y,v.height,v.width,0,S.y,S.height,S.width)}}class u2{constructor(l,f,v){this.binders={},this._buffers=[];const S=[];for(const k in l.paint._values){if(!v(k))continue;const R=l.paint.get(k);if(!(R instanceof qi&&Wl(R.property.specification)))continue;const B=tC(k,l.type),V=R.value,Z=R.property.specification.type,ie=R.property.useIntegerZoom,ce=R.property.specification["property-type"],ve=ce==="cross-faded"||ce==="cross-faded-data-driven";if(V.kind==="constant")this.binders[k]=ve?new Gc(V.value,B):new Wc(V.value,B,Z),S.push(`/u_${k}`);else if(V.kind==="source"||ve){const Se=c2(k,Z,"source");this.binders[k]=ve?k==="line-dasharray"?new l2(V,Z,ie,f,Se,l.id):new Qs(V,Z,ie,f,Se,l.id):new lo(V,B,Z,Se),S.push(`/a_${k}`)}else{const Se=c2(k,Z,"composite");this.binders[k]=new no(V,B,Z,ie,f,Se),S.push(`/z_${k}`)}}this.cacheKey=S.sort().join("")}getMaxValue(l){const f=this.binders[l];return f instanceof lo||f instanceof no?f.maxValue:0}populatePaintArrays(l,f,v){for(const S in this.binders){const k=this.binders[S];(k instanceof lo||k instanceof no||k instanceof Js)&&k.populatePaintArray(l,f,v)}}setConstantPatternPositions(l,f){for(const v in this.binders){const S=this.binders[v];S instanceof Gc&&S.setConstantPatternPositions(l,f)}}setConstantDashPositions(l,f){for(const v in this.binders){const S=this.binders[v];S instanceof Gc&&S.setConstantDashPositions(l,f)}}updatePaintArrays(l,f,v,S,k){let R=!1;for(const B in l){const V=f.getPositions(B);for(const Z of V){const ie=v.feature(Z.index);for(const ce in this.binders){const ve=this.binders[ce];if((ve instanceof lo||ve instanceof no||ve instanceof Js)&&ve.expression.isStateDependent===!0){const Se=S.paint.get(ce);ve.expression=Se.value,ve.updatePaintArray(Z.start,Z.end,ie,l[B],k),R=!0}}}}return R}defines(){const l=[];for(const f in this.binders){const v=this.binders[f];(v instanceof Wc||v instanceof Gc)&&l.push(...v.uniformNames.map((S=>`#define HAS_UNIFORM_${S}`)))}return l}getBinderAttributes(){const l=[];for(const f in this.binders){const v=this.binders[f];if(v instanceof lo||v instanceof no)for(let S=0;S<v.paintVertexAttributes.length;S++)l.push(v.paintVertexAttributes[S].name);else if(v instanceof Js){const S=v.getVertexAttributes();for(const k of S)l.push(k.name)}}return l}getBinderUniforms(){const l=[];for(const f in this.binders){const v=this.binders[f];if(v instanceof Wc||v instanceof Gc||v instanceof no)for(const S of v.uniformNames)l.push(S)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l,f){const v=[];for(const S in this.binders){const k=this.binders[S];if(k instanceof Wc||k instanceof Gc||k instanceof no){for(const R of k.uniformNames)if(f[R]){const B=k.getBinding(l,f[R],R);v.push({name:R,property:S,binding:B})}}}return v}setUniforms(l,f,v,S){for(const{name:k,property:R,binding:B}of f)this.binders[R].setUniform(B,S,v.get(R),k)}updatePaintBuffers(l){this._buffers=[];for(const f in this.binders){const v=this.binders[f];if(l&&v instanceof Js){const S=l.fromScale===2?v.zoomInPaintVertexBuffer:v.zoomOutPaintVertexBuffer;S&&this._buffers.push(S)}else(v instanceof lo||v instanceof no)&&v.paintVertexBuffer&&this._buffers.push(v.paintVertexBuffer)}}upload(l){for(const f in this.binders){const v=this.binders[f];(v instanceof lo||v instanceof no||v instanceof Js)&&v.upload(l)}this.updatePaintBuffers()}destroy(){for(const l in this.binders){const f=this.binders[l];(f instanceof lo||f instanceof no||f instanceof Js)&&f.destroy()}}}class Hd{constructor(l,f,v=()=>!0){this.programConfigurations={};for(const S of l)this.programConfigurations[S.id]=new u2(S,f,v);this.needsUpload=!1,this._featureMap=new Ml,this._bufferOffset=0}populatePaintArrays(l,f,v,S){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(l,f,S);f.id!==void 0&&this._featureMap.add(f.id,v,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,f,v,S){for(const k of v)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(l,this._featureMap,f,k,S)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(const f in this.programConfigurations)this.programConfigurations[f].upload(l);this.needsUpload=!1}}destroy(){for(const l in this.programConfigurations)this.programConfigurations[l].destroy()}}function tC(p,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[p]||[p.replace(`${l}-`,"").replace(/-/g,"_")]}function c2(p,l,f){const v={color:{source:qc,composite:g},number:{source:Gf,composite:qc}},S=(function(k){return{"line-pattern":{source:Nt,composite:Nt},"fill-pattern":{source:Nt,composite:Nt},"fill-extrusion-pattern":{source:Nt,composite:Nt},"line-dasharray":{source:jt,composite:jt}}[k]})(p);return S&&S[f]||v[l][f]}Pt("ConstantBinder",Wc),Pt("CrossFadedConstantBinder",Gc),Pt("SourceExpressionBinder",lo),Pt("CrossFadedPatternBinder",Qs),Pt("CrossFadedDasharrayBinder",l2),Pt("CompositeExpressionBinder",no),Pt("ProgramConfiguration",u2,{omit:["_buffers"]}),Pt("ProgramConfigurationSet",Hd);const k_=Math.pow(2,14)-1,Yf=-k_-1;function Zf(p){const l=xe/p.extent,f=p.loadGeometry();for(let v=0;v<f.length;v++){const S=f[v];for(let k=0;k<S.length;k++){const R=S[k],B=Math.round(R.x*l),V=Math.round(R.y*l);R.x=Fe(B,Yf,k_),R.y=Fe(V,Yf,k_),(B<R.x||B>R.x+1||V<R.y||V>R.y+1)&&st("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return f}function Kf(p,l){return{type:p.type,id:p.id,properties:p.properties,geometry:l?Zf(p):[]}}const R_=-32768;function M_(p,l,f,v,S){p.emplaceBack(R_+8*l+v,R_+8*f+S)}class Vy{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((f=>f.id)),this.index=l.index,this.hasDependencies=!1,this.layoutVertexArray=new pt,this.indexArray=new xr,this.segments=new gn,this.programConfigurations=new Hd(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter((f=>f.isStateDependent())).map((f=>f.id))}populate(l,f,v){const S=this.layers[0],k=[];let R=null,B=!1,V=S.type==="heatmap";if(S.type==="circle"){const ie=S;R=ie.layout.get("circle-sort-key"),B=!R.isConstant(),V=V||ie.paint.get("circle-pitch-alignment")==="map"}const Z=V?f.subdivisionGranularity.circle:1;for(const{feature:ie,id:ce,index:ve,sourceLayerIndex:Se}of l){const Ne=this.layers[0]._featureFilter.needGeometry,ze=Kf(ie,Ne);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),ze,v))continue;const Ve=B?R.evaluate(ze,{},v):void 0,et={id:ce,properties:ie.properties,type:ie.type,sourceLayerIndex:Se,index:ve,geometry:Ne?ze.geometry:Zf(ie),patterns:{},sortKey:Ve};k.push(et)}B&&k.sort(((ie,ce)=>ie.sortKey-ce.sortKey));for(const ie of k){const{geometry:ce,index:ve,sourceLayerIndex:Se}=ie,Ne=l[ve].feature;this.addFeature(ie,ce,ve,v,Z),f.featureIndex.insert(Ne,ce,ve,Se,this.index)}}update(l,f,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,{imagePositions:v})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Hr),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,f,v,S,k=1){let R;switch(k){case 1:R=[0,7];break;case 3:R=[0,2,5,7];break;case 5:R=[0,1,3,4,6,7];break;case 7:R=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${k}; valid values are 1, 3, 5, 7.`)}const B=R.length;for(const V of f)for(const Z of V){const ie=Z.x,ce=Z.y;if(ie<0||ie>=xe||ce<0||ce>=xe)continue;const ve=this.segments.prepareSegment(B*B,this.layoutVertexArray,this.indexArray,l.sortKey),Se=ve.vertexLength;for(let Ne=0;Ne<B;Ne++)for(let ze=0;ze<B;ze++)M_(this.layoutVertexArray,ie,ce,R[ze],R[Ne]);for(let Ne=0;Ne<B-1;Ne++)for(let ze=0;ze<B-1;ze++){const Ve=Se+Ne*B+ze,et=Se+(Ne+1)*B+ze;this.indexArray.emplaceBack(Ve,et+1,Ve+1),this.indexArray.emplaceBack(Ve,et,et+1)}ve.vertexLength+=B*B,ve.primitiveLength+=(B-1)*(B-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:{},canonical:S})}}function $y(p,l){for(let f=0;f<p.length;f++)if(qy(l,p[f]))return!0;for(let f=0;f<l.length;f++)if(qy(p,l[f]))return!0;return!!rC(p,l)}function h2(p,l,f){return!!qy(p,l)||!!nC(l,p,f)}function A6(p,l){if(p.length===1)return P6(l,p[0]);for(let f=0;f<l.length;f++){const v=l[f];for(let S=0;S<v.length;S++)if(qy(p,v[S]))return!0}for(let f=0;f<p.length;f++)if(P6(l,p[f]))return!0;for(let f=0;f<l.length;f++)if(rC(p,l[f]))return!0;return!1}function Une(p,l,f){if(p.length>1){if(rC(p,l))return!0;for(let v=0;v<l.length;v++)if(nC(l[v],p,f))return!0}for(let v=0;v<p.length;v++)if(nC(p[v],l,f))return!0;return!1}function rC(p,l){if(p.length===0||l.length===0)return!1;for(let f=0;f<p.length-1;f++){const v=p[f],S=p[f+1];for(let k=0;k<l.length-1;k++)if(Vne(v,S,l[k],l[k+1]))return!0}return!1}function Vne(p,l,f,v){return $e(p,f,v)!==$e(l,f,v)&&$e(p,l,f)!==$e(p,l,v)}function nC(p,l,f){const v=f*f;if(l.length===1)return p.distSqr(l[0])<v;for(let S=1;S<l.length;S++)if(I6(p,l[S-1],l[S])<v)return!0;return!1}function I6(p,l,f){const v=l.distSqr(f);if(v===0)return p.distSqr(l);const S=((p.x-l.x)*(f.x-l.x)+(p.y-l.y)*(f.y-l.y))/v;return p.distSqr(S<0?l:S>1?f:f.sub(l)._mult(S)._add(l))}function P6(p,l){let f,v,S,k=!1;for(let R=0;R<p.length;R++){f=p[R];for(let B=0,V=f.length-1;B<f.length;V=B++)v=f[B],S=f[V],v.y>l.y!=S.y>l.y&&l.x<(S.x-v.x)*(l.y-v.y)/(S.y-v.y)+v.x&&(k=!k)}return k}function qy(p,l){let f=!1;for(let v=0,S=p.length-1;v<p.length;S=v++){const k=p[v],R=p[S];k.y>l.y!=R.y>l.y&&l.x<(R.x-k.x)*(l.y-k.y)/(R.y-k.y)+k.x&&(f=!f)}return f}function $ne(p,l,f){const v=f[0],S=f[2];if(p.x<v.x&&l.x<v.x||p.x>S.x&&l.x>S.x||p.y<v.y&&l.y<v.y||p.y>S.y&&l.y>S.y)return!1;const k=$e(p,l,f[0]);return k!==$e(p,l,f[1])||k!==$e(p,l,f[2])||k!==$e(p,l,f[3])}function Hy(p,l,f){const v=l.paint.get(p).value;return v.kind==="constant"?v.value:f.programConfigurations.get(l.id).getMaxValue(p)}function f2(p){return Math.sqrt(p[0]*p[0]+p[1]*p[1])}function d2(p,l,f,v,S){if(!l[0]&&!l[1])return p;const k=c.convert(l)._mult(S);f==="viewport"&&k._rotate(-v);const R=[];for(let B=0;B<p.length;B++)R.push(p[B].sub(k));return R}function qne(p){const l=[];for(let f=0;f<p.length;f++){const v=p[f],S=l.at(-1);(f===0||S&&!v.equals(S))&&l.push(v)}return l}function Hne({queryGeometry:p,size:l},f){return h2(p,f,l)}function Wne({queryGeometry:p,size:l,transform:f,unwrappedTileID:v,getElevation:S},k){return h2(p,k,l*(f.projectTileCoordinates(k.x,k.y,v,S).signedDistanceFromCamera/f.cameraToCenterDistance))}function Gne({queryGeometry:p,size:l,transform:f,unwrappedTileID:v,getElevation:S},k){const R=f.projectTileCoordinates(k.x,k.y,v,S).signedDistanceFromCamera,B=l*(f.cameraToCenterDistance/R);return h2(p,iC(k,f,v,S),B)}function Xne({queryGeometry:p,size:l,transform:f,unwrappedTileID:v,getElevation:S},k){return h2(p,iC(k,f,v,S),l)}function k6({queryGeometry:p,size:l,transform:f,unwrappedTileID:v,getElevation:S,pitchAlignment:k="map",pitchScale:R="map"},B){const V=k==="map"?R==="map"?Hne:Wne:R==="map"?Gne:Xne,Z={queryGeometry:p,size:l,transform:f,unwrappedTileID:v,getElevation:S};for(const ie of B)for(const ce of ie)if(V(Z,ce))return!0;return!1}function iC(p,l,f,v){const S=l.projectTileCoordinates(p.x,p.y,f,v).point;return new c((.5*S.x+.5)*l.width,(.5*-S.y+.5)*l.height)}let R6,M6;Pt("CircleBucket",Vy,{omit:["layers"]});var Yne={get paint(){return M6=M6||new $a({"circle-radius":new Sn(Mt.paint_circle["circle-radius"]),"circle-color":new Sn(Mt.paint_circle["circle-color"]),"circle-blur":new Sn(Mt.paint_circle["circle-blur"]),"circle-opacity":new Sn(Mt.paint_circle["circle-opacity"]),"circle-translate":new Tn(Mt.paint_circle["circle-translate"]),"circle-translate-anchor":new Tn(Mt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Tn(Mt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Tn(Mt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Sn(Mt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Sn(Mt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Sn(Mt.paint_circle["circle-stroke-opacity"])})},get layout(){return R6=R6||new $a({"circle-sort-key":new Sn(Mt.layout_circle["circle-sort-key"])})}};class Zne extends eo{constructor(l,f){super(l,Yne,f)}createBucket(l){return new Vy(l)}queryRadius(l){const f=l;return Hy("circle-radius",this,f)+Hy("circle-stroke-width",this,f)+f2(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:l,feature:f,featureState:v,geometry:S,transform:k,pixelsToTileUnits:R,unwrappedTileID:B,getElevation:V}){const Z=d2(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-k.bearingInRadians,R),ie=this.paint.get("circle-radius").evaluate(f,v)+this.paint.get("circle-stroke-width").evaluate(f,v),ce=this.paint.get("circle-pitch-scale"),ve=this.paint.get("circle-pitch-alignment");let Se,Ne;return ve==="map"?(Se=Z,Ne=ie*R):(Se=(function(ze,Ve,et,Ct){return ze.map((nt=>iC(nt,Ve,et,Ct)))})(Z,k,B,V),Ne=ie),k6({queryGeometry:Se,size:Ne,transform:k,unwrappedTileID:B,getElevation:V,pitchAlignment:ve,pitchScale:ce},S)}}class D6 extends Vy{}let O6;Pt("HeatmapBucket",D6,{omit:["layers"]});var Kne={get paint(){return O6=O6||new $a({"heatmap-radius":new Sn(Mt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Sn(Mt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Tn(Mt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Lo(Mt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Tn(Mt.paint_heatmap["heatmap-opacity"])})}};function aC(p,{width:l,height:f},v,S){if(S){if(S instanceof Uint8ClampedArray)S=new Uint8Array(S.buffer);else if(S.length!==l*f*v)throw new RangeError(`mismatched image size. expected: ${S.length} but got: ${l*f*v}`)}else S=new Uint8Array(l*f*v);return p.width=l,p.height=f,p.data=S,p}function N6(p,{width:l,height:f},v){if(l===p.width&&f===p.height)return;const S=aC({},{width:l,height:f},v);oC(p,S,{x:0,y:0},{x:0,y:0},{width:Math.min(p.width,l),height:Math.min(p.height,f)},v),p.width=l,p.height=f,p.data=S.data}function oC(p,l,f,v,S,k){if(S.width===0||S.height===0)return l;if(S.width>p.width||S.height>p.height||f.x>p.width-S.width||f.y>p.height-S.height)throw new RangeError("out of range source coordinates for image copy");if(S.width>l.width||S.height>l.height||v.x>l.width-S.width||v.y>l.height-S.height)throw new RangeError("out of range destination coordinates for image copy");const R=p.data,B=l.data;if(R===B)throw new Error("srcData equals dstData, so image is already copied");for(let V=0;V<S.height;V++){const Z=((f.y+V)*p.width+f.x)*k,ie=((v.y+V)*l.width+v.x)*k;for(let ce=0;ce<S.width*k;ce++)B[ie+ce]=R[Z+ce]}return l}class D_{constructor(l,f){aC(this,l,1,f)}resize(l){N6(this,l,1)}clone(){return new D_({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,f,v,S,k){oC(l,f,v,S,k,1)}}class lc{constructor(l,f){aC(this,l,4,f)}resize(l){N6(this,l,4)}replace(l,f){f?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new lc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,f,v,S,k){oC(l,f,v,S,k,4)}setPixel(l,f,v){const S=4*(l*this.width+f);this.data[S+0]=Math.round(255*v.r/v.a),this.data[S+1]=Math.round(255*v.g/v.a),this.data[S+2]=Math.round(255*v.b/v.a),this.data[S+3]=Math.round(255*v.a)}}function L6(p){const l={},f=p.resolution||256,v=p.clips?p.clips.length:1,S=p.image||new lc({width:f,height:v});if(Math.log(f)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${f}`);const k=(R,B,V)=>{l[p.evaluationKey]=V;const Z=p.expression.evaluate(l);S.setPixel(R/4/f,B/4,Z)};if(p.clips)for(let R=0,B=0;R<v;++R,B+=4*f)for(let V=0,Z=0;V<f;V++,Z+=4){const ie=V/(f-1),{start:ce,end:ve}=p.clips[R];k(B,Z,ce*(1-ie)+ve*ie)}else for(let R=0,B=0;R<f;R++,B+=4)k(0,B,R/(f-1));return S}Pt("AlphaImage",D_),Pt("RGBAImage",lc);const sC="big-fb";class Jne extends eo{createBucket(l){return new D6(l)}constructor(l,f){super(l,Kne,f),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=L6({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(sC)&&this.heatmapFbos.delete(sC)}queryRadius(l){return Hy("heatmap-radius",this,l)}queryIntersectsFeature({queryGeometry:l,feature:f,featureState:v,geometry:S,transform:k,pixelsToTileUnits:R,unwrappedTileID:B,getElevation:V}){return k6({queryGeometry:l,size:this.paint.get("heatmap-radius").evaluate(f,v)*R,transform:k,unwrappedTileID:B,getElevation:V},S)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let F6;var Qne={get paint(){return F6=F6||new $a({"hillshade-illumination-direction":new Tn(Mt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Tn(Mt.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Tn(Mt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Tn(Mt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Tn(Mt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Tn(Mt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Tn(Mt.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Tn(Mt.paint_hillshade["hillshade-method"])})}};class eie extends eo{constructor(l,f){super(l,Qne,f),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let l=this.paint.get("hillshade-illumination-direction").values,f=this.paint.get("hillshade-illumination-altitude").values,v=this.paint.get("hillshade-highlight-color").values,S=this.paint.get("hillshade-shadow-color").values;const k=Math.max(l.length,f.length,v.length,S.length);l=l.concat(Array(k-l.length).fill(l.at(-1))),f=f.concat(Array(k-f.length).fill(f.at(-1))),v=v.concat(Array(k-v.length).fill(v.at(-1))),S=S.concat(Array(k-S.length).fill(S.at(-1)));const R=f.map(Tr);return{directionRadians:l.map(Tr),altitudeRadians:R,shadowColor:S,highlightColor:v}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let B6;var tie={get paint(){return B6=B6||new $a({"color-relief-opacity":new Tn(Mt["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Lo(Mt["paint_color-relief"]["color-relief-color"])})}};class lC{constructor(l,f,v,S){this.context=l,this.format=v,this.texture=l.gl.createTexture(),this.update(f,S)}update(l,f,v){const{width:S,height:k}=l,R=!(this.size&&this.size[0]===S&&this.size[1]===k||v),{context:B}=this,{gl:V}=B;if(this.useMipmap=!!(f&&f.useMipmap),V.bindTexture(V.TEXTURE_2D,this.texture),B.pixelStoreUnpackFlipY.set(!1),B.pixelStoreUnpack.set(1),B.pixelStoreUnpackPremultiplyAlpha.set(this.format===V.RGBA&&(!f||f.premultiply!==!1)),R)this.size=[S,k],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||pr(l)?V.texImage2D(V.TEXTURE_2D,0,this.format,this.format,V.UNSIGNED_BYTE,l):V.texImage2D(V.TEXTURE_2D,0,this.format,S,k,0,this.format,V.UNSIGNED_BYTE,l.data);else{const{x:Z,y:ie}=v||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||pr(l)?V.texSubImage2D(V.TEXTURE_2D,0,Z,ie,V.RGBA,V.UNSIGNED_BYTE,l):V.texSubImage2D(V.TEXTURE_2D,0,Z,ie,S,k,V.RGBA,V.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&V.generateMipmap(V.TEXTURE_2D),B.pixelStoreUnpackFlipY.setDefault(),B.pixelStoreUnpack.setDefault(),B.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(l,f,v){const{context:S}=this,{gl:k}=S;k.bindTexture(k.TEXTURE_2D,this.texture),v!==k.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(v=k.LINEAR),l!==this.filter&&(k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,l),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,v||l),this.filter=l),f!==this.wrap&&(k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,f),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,f),this.wrap=f)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}class z6{constructor(l,f,v,S=1,k=1,R=1,B=0){if(this.uid=l,f.height!==f.width)throw new RangeError("DEM tiles must be square");if(v&&!["mapbox","terrarium","custom"].includes(v))return void st(`"${v}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=f.height;const V=this.dim=f.height-2;switch(this.data=new Uint32Array(f.data.buffer),v){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=S,this.greenFactor=k,this.blueFactor=R,this.baseShift=B;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Z=0;Z<V;Z++)this.data[this._idx(-1,Z)]=this.data[this._idx(0,Z)],this.data[this._idx(V,Z)]=this.data[this._idx(V-1,Z)],this.data[this._idx(Z,-1)]=this.data[this._idx(Z,0)],this.data[this._idx(Z,V)]=this.data[this._idx(Z,V-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(V,-1)]=this.data[this._idx(V-1,0)],this.data[this._idx(-1,V)]=this.data[this._idx(0,V-1)],this.data[this._idx(V,V)]=this.data[this._idx(V-1,V-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Z=0;Z<V;Z++)for(let ie=0;ie<V;ie++){const ce=this.get(Z,ie);ce>this.max&&(this.max=ce),ce<this.min&&(this.min=ce)}}get(l,f){const v=new Uint8Array(this.data.buffer),S=4*this._idx(l,f);return this.unpack(v[S],v[S+1],v[S+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(l,f){if(l<-1||l>=this.dim+1||f<-1||f>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${l}, y: ${f}, dim: ${this.dim}`);return(f+1)*this.stride+(l+1)}unpack(l,f,v){return l*this.redFactor+f*this.greenFactor+v*this.blueFactor-this.baseShift}pack(l){return j6(l,this.getUnpackVector())}getPixels(){return new lc({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(l,f,v){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let S=f*this.dim,k=f*this.dim+this.dim,R=v*this.dim,B=v*this.dim+this.dim;switch(f){case-1:S=k-1;break;case 1:k=S+1}switch(v){case-1:R=B-1;break;case 1:B=R+1}const V=-f*this.dim,Z=-v*this.dim;for(let ie=R;ie<B;ie++)for(let ce=S;ce<k;ce++)this.data[this._idx(ce,ie)]=l.data[this._idx(ce+V,ie+Z)]}}function j6(p,l){const f=l[0],v=l[1],S=l[2],k=l[3],R=Math.min(f,v,S),B=Math.round((p+k)/R);return{r:Math.floor(B*R/f)%256,g:Math.floor(B*R/v)%256,b:Math.floor(B*R/S)%256}}Pt("DEMData",z6);class rie extends eo{constructor(l,f){super(l,tie,f)}_createColorRamp(l){const f={elevationStops:[],colorStops:[]},v=this._transitionablePaint._values["color-relief-color"].value.expression;if(v instanceof Np&&v._styleExpression.expression instanceof Un){this.colorRampExpression=v;const R=v._styleExpression.expression;f.elevationStops=R.labels,f.colorStops=[];for(const B of f.elevationStops)f.colorStops.push(R.evaluate({globals:{elevation:B}}))}if(f.elevationStops.length<1&&(f.elevationStops=[0],f.colorStops=[kr.transparent]),f.elevationStops.length<2&&(f.elevationStops.push(f.elevationStops[0]+1),f.colorStops.push(f.colorStops[0])),f.elevationStops.length<=l)return f;const S={elevationStops:[],colorStops:[]},k=(f.elevationStops.length-1)/(l-1);for(let R=0;R<f.elevationStops.length-.5;R+=k)S.elevationStops.push(f.elevationStops[Math.round(R)]),S.colorStops.push(f.colorStops[Math.round(R)]);return st(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${l}, provided: ${f.elevationStops.length}`),S}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(l,f,v){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const S=this._createColorRamp(f),k=new lc({width:S.colorStops.length,height:1}),R=new lc({width:S.colorStops.length,height:1});for(let B=0;B<S.elevationStops.length;B++){const V=j6(S.elevationStops[B],v);R.setPixel(0,B,new kr(V.r/255,V.g/255,V.b/255,1)),k.setPixel(0,B,S.colorStops[B])}return this.colorRampTextures={elevationTexture:new lC(l,R,l.gl.RGBA),colorTexture:new lC(l,k,l.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const nie=pa([{name:"a_pos",components:2,type:"Int16"}],4),{members:iie}=nie;function p2(p,l,f){const v=f.patternDependencies;let S=!1;for(const k of l){const R=k.paint.get(`${p}-pattern`);R.isConstant()||(S=!0);const B=R.constantOr(null);B&&(S=!0,v[B.to]=!0,v[B.from]=!0)}return S}function uC(p,l,f,v,S){const{zoom:k}=v,R=S.patternDependencies;for(const B of l){const V=B.paint.get(`${p}-pattern`).value;if(V.kind!=="constant"){let Z=V.evaluate({zoom:k-1},f,{},S.availableImages),ie=V.evaluate({zoom:k},f,{},S.availableImages),ce=V.evaluate({zoom:k+1},f,{},S.availableImages);Z=Z&&Z.name?Z.name:Z,ie=ie&&ie.name?ie.name:ie,ce=ce&&ce.name?ce.name:ce,R[Z]=!0,R[ie]=!0,R[ce]=!0,f.patterns[B.id]={min:Z,mid:ie,max:ce}}}return f}function U6(p,l,f,v,S){let k;if(S===(function(R,B,V,Z){let ie=0;for(let ce=B,ve=V-Z;ce<V;ce+=Z)ie+=(R[ve]-R[ce])*(R[ce+1]+R[ve+1]),ve=ce;return ie})(p,l,f,v)>0)for(let R=l;R<f;R+=v)k=H6(R/v|0,p[R],p[R+1],k);else for(let R=f-v;R>=l;R-=v)k=H6(R/v|0,p[R],p[R+1],k);return k&&Wy(k,k.next)&&(F_(k),k=k.next),k}function tm(p,l){if(!p)return p;l||(l=p);let f,v=p;do if(f=!1,v.steiner||!Wy(v,v.next)&&_s(v.prev,v,v.next)!==0)v=v.next;else{if(F_(v),v=l=v.prev,v===v.next)break;f=!0}while(f||v!==l);return l}function O_(p,l,f,v,S,k,R){if(!p)return;!R&&k&&(function(V,Z,ie,ce){let ve=V;do ve.z===0&&(ve.z=cC(ve.x,ve.y,Z,ie,ce)),ve.prevZ=ve.prev,ve.nextZ=ve.next,ve=ve.next;while(ve!==V);ve.prevZ.nextZ=null,ve.prevZ=null,(function(Se){let Ne,ze=1;do{let Ve,et=Se;Se=null;let Ct=null;for(Ne=0;et;){Ne++;let nt=et,ut=0;for(let Ft=0;Ft<ze&&(ut++,nt=nt.nextZ,nt);Ft++);let Rt=ze;for(;ut>0||Rt>0&&nt;)ut!==0&&(Rt===0||!nt||et.z<=nt.z)?(Ve=et,et=et.nextZ,ut--):(Ve=nt,nt=nt.nextZ,Rt--),Ct?Ct.nextZ=Ve:Se=Ve,Ve.prevZ=Ct,Ct=Ve;et=nt}Ct.nextZ=null,ze*=2}while(Ne>1)})(ve)})(p,v,S,k);let B=p;for(;p.prev!==p.next;){const V=p.prev,Z=p.next;if(k?oie(p,v,S,k):aie(p))l.push(V.i,p.i,Z.i),F_(p),p=Z.next,B=Z.next;else if((p=Z)===B){R?R===1?O_(p=sie(tm(p),l),l,f,v,S,k,2):R===2&&lie(p,l,f,v,S,k):O_(tm(p),l,f,v,S,k,1);break}}}function aie(p){const l=p.prev,f=p,v=p.next;if(_s(l,f,v)>=0)return!1;const S=l.x,k=f.x,R=v.x,B=l.y,V=f.y,Z=v.y,ie=Math.min(S,k,R),ce=Math.min(B,V,Z),ve=Math.max(S,k,R),Se=Math.max(B,V,Z);let Ne=v.next;for(;Ne!==l;){if(Ne.x>=ie&&Ne.x<=ve&&Ne.y>=ce&&Ne.y<=Se&&N_(S,B,k,V,R,Z,Ne.x,Ne.y)&&_s(Ne.prev,Ne,Ne.next)>=0)return!1;Ne=Ne.next}return!0}function oie(p,l,f,v){const S=p.prev,k=p,R=p.next;if(_s(S,k,R)>=0)return!1;const B=S.x,V=k.x,Z=R.x,ie=S.y,ce=k.y,ve=R.y,Se=Math.min(B,V,Z),Ne=Math.min(ie,ce,ve),ze=Math.max(B,V,Z),Ve=Math.max(ie,ce,ve),et=cC(Se,Ne,l,f,v),Ct=cC(ze,Ve,l,f,v);let nt=p.prevZ,ut=p.nextZ;for(;nt&&nt.z>=et&&ut&&ut.z<=Ct;){if(nt.x>=Se&&nt.x<=ze&&nt.y>=Ne&&nt.y<=Ve&&nt!==S&&nt!==R&&N_(B,ie,V,ce,Z,ve,nt.x,nt.y)&&_s(nt.prev,nt,nt.next)>=0||(nt=nt.prevZ,ut.x>=Se&&ut.x<=ze&&ut.y>=Ne&&ut.y<=Ve&&ut!==S&&ut!==R&&N_(B,ie,V,ce,Z,ve,ut.x,ut.y)&&_s(ut.prev,ut,ut.next)>=0))return!1;ut=ut.nextZ}for(;nt&&nt.z>=et;){if(nt.x>=Se&&nt.x<=ze&&nt.y>=Ne&&nt.y<=Ve&&nt!==S&&nt!==R&&N_(B,ie,V,ce,Z,ve,nt.x,nt.y)&&_s(nt.prev,nt,nt.next)>=0)return!1;nt=nt.prevZ}for(;ut&&ut.z<=Ct;){if(ut.x>=Se&&ut.x<=ze&&ut.y>=Ne&&ut.y<=Ve&&ut!==S&&ut!==R&&N_(B,ie,V,ce,Z,ve,ut.x,ut.y)&&_s(ut.prev,ut,ut.next)>=0)return!1;ut=ut.nextZ}return!0}function sie(p,l){let f=p;do{const v=f.prev,S=f.next.next;!Wy(v,S)&&$6(v,f,f.next,S)&&L_(v,S)&&L_(S,v)&&(l.push(v.i,f.i,S.i),F_(f),F_(f.next),f=p=S),f=f.next}while(f!==p);return tm(f)}function lie(p,l,f,v,S,k){let R=p;do{let B=R.next.next;for(;B!==R.prev;){if(R.i!==B.i&&die(R,B)){let V=q6(R,B);return R=tm(R,R.next),V=tm(V,V.next),O_(R,l,f,v,S,k,0),void O_(V,l,f,v,S,k,0)}B=B.next}R=R.next}while(R!==p)}function uie(p,l){let f=p.x-l.x;return f===0&&(f=p.y-l.y,f===0)&&(f=(p.next.y-p.y)/(p.next.x-p.x)-(l.next.y-l.y)/(l.next.x-l.x)),f}function cie(p,l){const f=(function(S,k){let R=k;const B=S.x,V=S.y;let Z,ie=-1/0;if(Wy(S,R))return R;do{if(Wy(S,R.next))return R.next;if(V<=R.y&&V>=R.next.y&&R.next.y!==R.y){const ze=R.x+(V-R.y)*(R.next.x-R.x)/(R.next.y-R.y);if(ze<=B&&ze>ie&&(ie=ze,Z=R.x<R.next.x?R:R.next,ze===B))return Z}R=R.next}while(R!==k);if(!Z)return null;const ce=Z,ve=Z.x,Se=Z.y;let Ne=1/0;R=Z;do{if(B>=R.x&&R.x>=ve&&B!==R.x&&V6(V<Se?B:ie,V,ve,Se,V<Se?ie:B,V,R.x,R.y)){const ze=Math.abs(V-R.y)/(B-R.x);L_(R,S)&&(ze<Ne||ze===Ne&&(R.x>Z.x||R.x===Z.x&&hie(Z,R)))&&(Z=R,Ne=ze)}R=R.next}while(R!==ce);return Z})(p,l);if(!f)return l;const v=q6(f,p);return tm(v,v.next),tm(f,f.next)}function hie(p,l){return _s(p.prev,p,l.prev)<0&&_s(l.next,p,p.next)<0}function cC(p,l,f,v,S){return(p=1431655765&((p=858993459&((p=252645135&((p=16711935&((p=(p-f)*S|0)|p<<8))|p<<4))|p<<2))|p<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-v)*S|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function fie(p){let l=p,f=p;do(l.x<f.x||l.x===f.x&&l.y<f.y)&&(f=l),l=l.next;while(l!==p);return f}function V6(p,l,f,v,S,k,R,B){return(S-R)*(l-B)>=(p-R)*(k-B)&&(p-R)*(v-B)>=(f-R)*(l-B)&&(f-R)*(k-B)>=(S-R)*(v-B)}function N_(p,l,f,v,S,k,R,B){return!(p===R&&l===B)&&V6(p,l,f,v,S,k,R,B)}function die(p,l){return p.next.i!==l.i&&p.prev.i!==l.i&&!(function(f,v){let S=f;do{if(S.i!==f.i&&S.next.i!==f.i&&S.i!==v.i&&S.next.i!==v.i&&$6(S,S.next,f,v))return!0;S=S.next}while(S!==f);return!1})(p,l)&&(L_(p,l)&&L_(l,p)&&(function(f,v){let S=f,k=!1;const R=(f.x+v.x)/2,B=(f.y+v.y)/2;do S.y>B!=S.next.y>B&&S.next.y!==S.y&&R<(S.next.x-S.x)*(B-S.y)/(S.next.y-S.y)+S.x&&(k=!k),S=S.next;while(S!==f);return k})(p,l)&&(_s(p.prev,p,l.prev)||_s(p,l.prev,l))||Wy(p,l)&&_s(p.prev,p,p.next)>0&&_s(l.prev,l,l.next)>0)}function _s(p,l,f){return(l.y-p.y)*(f.x-l.x)-(l.x-p.x)*(f.y-l.y)}function Wy(p,l){return p.x===l.x&&p.y===l.y}function $6(p,l,f,v){const S=m2(_s(p,l,f)),k=m2(_s(p,l,v)),R=m2(_s(f,v,p)),B=m2(_s(f,v,l));return S!==k&&R!==B||!(S!==0||!g2(p,f,l))||!(k!==0||!g2(p,v,l))||!(R!==0||!g2(f,p,v))||!(B!==0||!g2(f,l,v))}function g2(p,l,f){return l.x<=Math.max(p.x,f.x)&&l.x>=Math.min(p.x,f.x)&&l.y<=Math.max(p.y,f.y)&&l.y>=Math.min(p.y,f.y)}function m2(p){return p>0?1:p<0?-1:0}function L_(p,l){return _s(p.prev,p,p.next)<0?_s(p,l,p.next)>=0&&_s(p,p.prev,l)>=0:_s(p,l,p.prev)<0||_s(p,p.next,l)<0}function q6(p,l){const f=hC(p.i,p.x,p.y),v=hC(l.i,l.x,l.y),S=p.next,k=l.prev;return p.next=l,l.prev=p,f.next=S,S.prev=f,v.next=f,f.prev=v,k.next=v,v.prev=k,v}function H6(p,l,f,v){const S=hC(p,l,f);return v?(S.next=v.next,S.prev=v,v.next.prev=S,v.next=S):(S.prev=S,S.next=S),S}function F_(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function hC(p,l,f){return{i:p,x:l,y:f,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Gy{constructor(l,f){if(f>l)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=l,this._minGranularity=f}getGranularityForZoomLevel(l){return Math.max(Math.floor(this._baseZoomGranularity/(1<<l)),this._minGranularity,1)}}class y2{constructor(l){this.fill=l.fill,this.line=l.line,this.tile=l.tile,this.stencil=l.stencil,this.circle=l.circle}}y2.noSubdivision=new y2({fill:new Gy(0,0),line:new Gy(0,0),tile:new Gy(0,0),stencil:new Gy(0,0),circle:1}),Pt("SubdivisionGranularityExpression",Gy),Pt("SubdivisionGranularitySetting",y2);const Xy=-32768,B_=32767;class pie{constructor(l,f){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=l,this._granularityCellSize=xe/l,this._canonical=f}_getKey(l,f){return(l+=32768)<<16|f+32768}_vertexToIndex(l,f){if(l<-32768||f<-32768||l>32767||f>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const v=0|Math.round(l),S=0|Math.round(f),k=this._getKey(v,S);if(this._vertexDictionary.has(k))return this._vertexDictionary.get(k);const R=this._vertexBuffer.length/2;return this._vertexDictionary.set(k,R),this._vertexBuffer.push(v,S),R}_subdivideTrianglesScanline(l){if(this._granularity<2)return(function(S,k){const R=[];for(let B=0;B<k.length;B+=3){const V=k[B],Z=k[B+1],ie=k[B+2],ce=S[2*V],ve=S[2*V+1];(S[2*Z]-ce)*(S[2*ie+1]-ve)-(S[2*Z+1]-ve)*(S[2*ie]-ce)>0?(R.push(V),R.push(ie),R.push(Z)):(R.push(V),R.push(Z),R.push(ie))}return R})(this._vertexBuffer,l);const f=[],v=l.length;for(let S=0;S<v;S+=3){const k=[l[S+0],l[S+1],l[S+2]],R=[this._vertexBuffer[2*l[S+0]+0],this._vertexBuffer[2*l[S+0]+1],this._vertexBuffer[2*l[S+1]+0],this._vertexBuffer[2*l[S+1]+1],this._vertexBuffer[2*l[S+2]+0],this._vertexBuffer[2*l[S+2]+1]];let B=1/0,V=1/0,Z=-1/0,ie=-1/0;for(let ze=0;ze<3;ze++){const Ve=R[2*ze],et=R[2*ze+1];B=Math.min(B,Ve),Z=Math.max(Z,Ve),V=Math.min(V,et),ie=Math.max(ie,et)}if(B===Z||V===ie)continue;const ce=Math.floor(B/this._granularityCellSize),ve=Math.ceil(Z/this._granularityCellSize),Se=Math.floor(V/this._granularityCellSize),Ne=Math.ceil(ie/this._granularityCellSize);if(ce!==ve||Se!==Ne)for(let ze=Se;ze<Ne;ze++){const Ve=this._scanlineGenerateVertexRingForCellRow(ze,R,k);gie(this._vertexBuffer,Ve,f)}else f.push(...k)}return f}_scanlineGenerateVertexRingForCellRow(l,f,v){const S=l*this._granularityCellSize,k=S+this._granularityCellSize,R=[];for(let B=0;B<3;B++){const V=f[2*B],Z=f[2*B+1],ie=f[2*(B+1)%6],ce=f[(2*(B+1)+1)%6],ve=f[2*(B+2)%6],Se=f[(2*(B+2)+1)%6],Ne=ie-V,ze=ce-Z,Ve=Ne===0,et=ze===0,Ct=(S-Z)/ze,nt=(k-Z)/ze,ut=Math.min(Ct,nt),Rt=Math.max(Ct,nt);if(!et&&(ut>=1||Rt<=0)||et&&(Z<S||Z>k)){ce>=S&&ce<=k&&R.push(v[(B+1)%3]);continue}!et&&ut>0&&R.push(this._vertexToIndex(V+Ne*ut,Z+ze*ut));const Ft=V+Ne*Math.max(ut,0),fr=V+Ne*Math.min(Rt,1);Ve||this._generateIntraEdgeVertices(R,V,Z,ie,ce,Ft,fr),!et&&Rt<1&&R.push(this._vertexToIndex(V+Ne*Rt,Z+ze*Rt)),(et||ce>=S&&ce<=k)&&R.push(v[(B+1)%3]),!et&&(ce<=S||ce>=k)&&this._generateInterEdgeVertices(R,V,Z,ie,ce,ve,Se,fr,S,k)}return R}_generateIntraEdgeVertices(l,f,v,S,k,R,B){const V=S-f,Z=k-v,ie=Z===0,ce=ie?Math.min(f,S):Math.min(R,B),ve=ie?Math.max(f,S):Math.max(R,B),Se=Math.floor(ce/this._granularityCellSize)+1,Ne=Math.ceil(ve/this._granularityCellSize)-1;if(ie?f<S:R<B)for(let ze=Se;ze<=Ne;ze++){const Ve=ze*this._granularityCellSize;l.push(this._vertexToIndex(Ve,v+Z*(Ve-f)/V))}else for(let ze=Ne;ze>=Se;ze--){const Ve=ze*this._granularityCellSize;l.push(this._vertexToIndex(Ve,v+Z*(Ve-f)/V))}}_generateInterEdgeVertices(l,f,v,S,k,R,B,V,Z,ie){const ce=k-v,ve=R-S,Se=B-k,Ne=(Z-k)/Se,ze=(ie-k)/Se,Ve=Math.min(Ne,ze),et=Math.max(Ne,ze),Ct=S+ve*Ve;let nt=Math.floor(Math.min(Ct,V)/this._granularityCellSize)+1,ut=Math.ceil(Math.max(Ct,V)/this._granularityCellSize)-1,Rt=V<Ct;const Ft=Se===0;if(Ft&&(B===Z||B===ie))return;if(Ft||Ve>=1||et<=0){const Or=v-B,Pr=R+(f-R)*Math.min((Z-B)/Or,(ie-B)/Or);nt=Math.floor(Math.min(Pr,V)/this._granularityCellSize)+1,ut=Math.ceil(Math.max(Pr,V)/this._granularityCellSize)-1,Rt=V<Pr}const fr=ce>0?ie:Z;if(Rt)for(let Or=nt;Or<=ut;Or++)l.push(this._vertexToIndex(Or*this._granularityCellSize,fr));else for(let Or=ut;Or>=nt;Or--)l.push(this._vertexToIndex(Or*this._granularityCellSize,fr))}_generateOutline(l){const f=[];for(const v of l){const S=rm(v,this._granularity,!0),k=this._pointArrayToIndices(S),R=[];for(let B=1;B<k.length;B++)R.push(k[B-1]),R.push(k[B]);f.push(R)}return f}_handlePoles(l){let f=!1,v=!1;this._canonical&&(this._canonical.y===0&&(f=!0),this._canonical.y===(1<<this._canonical.z)-1&&(v=!0)),(f||v)&&this._fillPoles(l,f,v)}_ensureNoPoleVertices(){const l=this._vertexBuffer;for(let f=0;f<l.length;f+=2){const v=l[f+1];v===Xy&&(l[f+1]=-32767),v===B_&&(l[f+1]=32766)}}_generatePoleQuad(l,f,v,S,k,R){S>k!=(R===Xy)?(l.push(f),l.push(v),l.push(this._vertexToIndex(S,R)),l.push(v),l.push(this._vertexToIndex(k,R)),l.push(this._vertexToIndex(S,R))):(l.push(v),l.push(f),l.push(this._vertexToIndex(S,R)),l.push(this._vertexToIndex(k,R)),l.push(v),l.push(this._vertexToIndex(S,R)))}_fillPoles(l,f,v){const S=this._vertexBuffer,k=xe,R=l.length;for(let B=2;B<R;B+=3){const V=l[B-2],Z=l[B-1],ie=l[B],ce=S[2*V],ve=S[2*V+1],Se=S[2*Z],Ne=S[2*Z+1],ze=S[2*ie],Ve=S[2*ie+1];f&&(ve===0&&Ne===0&&this._generatePoleQuad(l,V,Z,ce,Se,Xy),Ne===0&&Ve===0&&this._generatePoleQuad(l,Z,ie,Se,ze,Xy),Ve===0&&ve===0&&this._generatePoleQuad(l,ie,V,ze,ce,Xy)),v&&(ve===k&&Ne===k&&this._generatePoleQuad(l,V,Z,ce,Se,B_),Ne===k&&Ve===k&&this._generatePoleQuad(l,Z,ie,Se,ze,B_),Ve===k&&ve===k&&this._generatePoleQuad(l,ie,V,ze,ce,B_))}}_initializeVertices(l){for(let f=0;f<l.length;f+=2)this._vertexToIndex(l[f],l[f+1])}subdividePolygonInternal(l,f){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:v,holeIndices:S}=(function(B){const V=[],Z=[];for(const ie of B)if(ie.length!==0){ie!==B[0]&&V.push(Z.length/2);for(let ce=0;ce<ie.length;ce++)Z.push(ie[ce].x),Z.push(ie[ce].y)}return{flattened:Z,holeIndices:V}})(l);let k;this._initializeVertices(v);try{const B=(function(Z,ie,ce=2){const ve=ie&&ie.length,Se=ve?ie[0]*ce:Z.length;let Ne=U6(Z,0,Se,ce,!0);const ze=[];if(!Ne||Ne.next===Ne.prev)return ze;let Ve,et,Ct;if(ve&&(Ne=(function(nt,ut,Rt,Ft){const fr=[];for(let Or=0,Pr=ut.length;Or<Pr;Or++){const Vr=U6(nt,ut[Or]*Ft,Or<Pr-1?ut[Or+1]*Ft:nt.length,Ft,!1);Vr===Vr.next&&(Vr.steiner=!0),fr.push(fie(Vr))}fr.sort(uie);for(let Or=0;Or<fr.length;Or++)Rt=cie(fr[Or],Rt);return Rt})(Z,ie,Ne,ce)),Z.length>80*ce){Ve=Z[0],et=Z[1];let nt=Ve,ut=et;for(let Rt=ce;Rt<Se;Rt+=ce){const Ft=Z[Rt],fr=Z[Rt+1];Ft<Ve&&(Ve=Ft),fr<et&&(et=fr),Ft>nt&&(nt=Ft),fr>ut&&(ut=fr)}Ct=Math.max(nt-Ve,ut-et),Ct=Ct!==0?32767/Ct:0}return O_(Ne,ze,ce,Ve,et,Ct,0),ze})(v,S),V=this._convertIndices(v,B);k=this._subdivideTrianglesScanline(V)}catch(B){console.error(B)}let R=[];return f&&(R=this._generateOutline(l)),this._ensureNoPoleVertices(),this._handlePoles(k),{verticesFlattened:this._vertexBuffer,indicesTriangles:k,indicesLineList:R}}_convertIndices(l,f){const v=[];for(let S=0;S<f.length;S++)v.push(this._vertexToIndex(l[2*f[S]],l[2*f[S]+1]));return v}_pointArrayToIndices(l){const f=[];for(let v=0;v<l.length;v++){const S=l[v];f.push(this._vertexToIndex(S.x,S.y))}return f}}function W6(p,l,f,v=!0){return new pie(f,l).subdividePolygonInternal(p,v)}function rm(p,l,f=!1){if(!p||p.length<1)return[];if(p.length<2)return[];const v=p[0],S=p[p.length-1],k=f&&(v.x!==S.x||v.y!==S.y);if(l<2)return k?[...p,p[0]]:[...p];const R=Math.floor(xe/l),B=[];B.push(new c(p[0].x,p[0].y));const V=p.length,Z=k?V:V-1;for(let ie=0;ie<Z;ie++){const ce=p[ie],ve=ie<V-1?p[ie+1]:p[0],Se=ce.x,Ne=ce.y,ze=ve.x,Ve=ve.y,et=Se!==ze,Ct=Ne!==Ve;if(!et&&!Ct)continue;const nt=ze-Se,ut=Ve-Ne,Rt=Math.abs(nt),Ft=Math.abs(ut);let fr=Se,Or=Ne;for(;;){const Vr=nt>0?(Math.floor(fr/R)+1)*R:(Math.ceil(fr/R)-1)*R,pn=ut>0?(Math.floor(Or/R)+1)*R:(Math.ceil(Or/R)-1)*R,Gr=Math.abs(fr-Vr),Rr=Math.abs(Or-pn),Er=Math.abs(fr-ze),Cn=Math.abs(Or-Ve),xn=et?Gr/Rt:Number.POSITIVE_INFINITY,kn=Ct?Rr/Ft:Number.POSITIVE_INFINITY;if((Er<=Gr||!et)&&(Cn<=Rr||!Ct))break;if(xn<kn&&et||!Ct){fr=Vr,Or+=ut*xn;const vn=new c(fr,Math.round(Or));B[B.length-1].x===vn.x&&B[B.length-1].y===vn.y||B.push(vn)}else{fr+=nt*kn,Or=pn;const vn=new c(Math.round(fr),Or);B[B.length-1].x===vn.x&&B[B.length-1].y===vn.y||B.push(vn)}}const Pr=new c(ze,Ve);B[B.length-1].x===Pr.x&&B[B.length-1].y===Pr.y||B.push(Pr)}return B}function gie(p,l,f){if(l.length===0)throw new Error("Subdivision vertex ring is empty.");let v=0,S=p[2*l[0]];for(let V=1;V<l.length;V++){const Z=p[2*l[V]];Z<S&&(S=Z,v=V)}const k=l.length;let R=v,B=(R+1)%k;for(;;){const V=R-1>=0?R-1:k-1,Z=(B+1)%k,ie=p[2*l[V]],ce=p[2*l[Z]],ve=p[2*l[R]],Se=p[2*l[R]+1],Ne=p[2*l[B]+1];let ze=!1;if(ie<ce)ze=!0;else if(ie>ce)ze=!1;else{const Ve=Ne-Se,et=-(p[2*l[B]]-ve),Ct=Se<Ne?1:-1;((ie-ve)*Ve+(p[2*l[V]+1]-Se)*et)*Ct>((ce-ve)*Ve+(p[2*l[Z]+1]-Se)*et)*Ct&&(ze=!0)}if(ze){const Ve=l[V],et=l[R],Ct=l[B];Ve!==et&&Ve!==Ct&&et!==Ct&&f.push(Ct,et,Ve),R--,R<0&&(R=k-1)}else{const Ve=l[Z],et=l[R],Ct=l[B];Ve!==et&&Ve!==Ct&&et!==Ct&&f.push(Ct,et,Ve),B++,B>=k&&(B=0)}if(V===Z)break}}function G6(p,l,f,v,S,k,R,B,V){const Z=S.length/2,ie=R&&B&&V;if(Z<gn.MAX_VERTEX_ARRAY_LENGTH){const ce=l.prepareSegment(Z,f,v),ve=ce.vertexLength;for(let ze=0;ze<k.length;ze+=3)v.emplaceBack(ve+k[ze],ve+k[ze+1],ve+k[ze+2]);let Se,Ne;ce.vertexLength+=Z,ce.primitiveLength+=k.length/3,ie&&(Ne=R.prepareSegment(Z,f,B),Se=Ne.vertexLength,Ne.vertexLength+=Z);for(let ze=0;ze<S.length;ze+=2)p(S[ze],S[ze+1]);if(ie)for(let ze=0;ze<V.length;ze++){const Ve=V[ze];for(let et=1;et<Ve.length;et+=2)B.emplaceBack(Se+Ve[et-1],Se+Ve[et]);Ne.primitiveLength+=Ve.length/2}}else(function(ce,ve,Se,Ne,ze,Ve){const et=[];for(let Ft=0;Ft<Ne.length/2;Ft++)et.push(-1);const Ct={count:0};let nt=0,ut=ce.getOrCreateLatestSegment(ve,Se),Rt=ut.vertexLength;for(let Ft=2;Ft<ze.length;Ft+=3){const fr=ze[Ft-2],Or=ze[Ft-1],Pr=ze[Ft];let Vr=et[fr]<nt,pn=et[Or]<nt,Gr=et[Pr]<nt;ut.vertexLength+((Vr?1:0)+(pn?1:0)+(Gr?1:0))>gn.MAX_VERTEX_ARRAY_LENGTH&&(ut=ce.createNewSegment(ve,Se),nt=Ct.count,Vr=!0,pn=!0,Gr=!0,Rt=0);const Rr=z_(et,Ne,Ve,Ct,fr,Vr,ut),Er=z_(et,Ne,Ve,Ct,Or,pn,ut),Cn=z_(et,Ne,Ve,Ct,Pr,Gr,ut);Se.emplaceBack(Rt+Rr-nt,Rt+Er-nt,Rt+Cn-nt),ut.primitiveLength++}})(l,f,v,S,k,p),ie&&(function(ce,ve,Se,Ne,ze,Ve){const et=[];for(let Ft=0;Ft<Ne.length/2;Ft++)et.push(-1);const Ct={count:0};let nt=0,ut=ce.getOrCreateLatestSegment(ve,Se),Rt=ut.vertexLength;for(let Ft=0;Ft<ze.length;Ft++){const fr=ze[Ft];for(let Or=1;Or<ze[Ft].length;Or+=2){const Pr=fr[Or-1],Vr=fr[Or];let pn=et[Pr]<nt,Gr=et[Vr]<nt;ut.vertexLength+((pn?1:0)+(Gr?1:0))>gn.MAX_VERTEX_ARRAY_LENGTH&&(ut=ce.createNewSegment(ve,Se),nt=Ct.count,pn=!0,Gr=!0,Rt=0);const Rr=z_(et,Ne,Ve,Ct,Pr,pn,ut),Er=z_(et,Ne,Ve,Ct,Vr,Gr,ut);Se.emplaceBack(Rt+Rr-nt,Rt+Er-nt),ut.primitiveLength++}}})(R,f,B,S,V,p),l.forceNewSegmentOnNextPrepare(),R?.forceNewSegmentOnNextPrepare()}function z_(p,l,f,v,S,k,R){if(k){const B=v.count;return f(l[2*S],l[2*S+1]),p[S]=v.count,v.count++,R.vertexLength++,B}return p[S]}class fC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((f=>f.id)),this.index=l.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new dt,this.indexArray=new xr,this.indexArray2=new an,this.programConfigurations=new Hd(l.layers,l.zoom),this.segments=new gn,this.segments2=new gn,this.stateDependentLayerIds=this.layers.filter((f=>f.isStateDependent())).map((f=>f.id))}populate(l,f,v){this.hasDependencies=p2("fill",this.layers,f);const S=this.layers[0].layout.get("fill-sort-key"),k=!S.isConstant(),R=[];for(const{feature:B,id:V,index:Z,sourceLayerIndex:ie}of l){const ce=this.layers[0]._featureFilter.needGeometry,ve=Kf(B,ce);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),ve,v))continue;const Se=k?S.evaluate(ve,{},v,f.availableImages):void 0,Ne={id:V,properties:B.properties,type:B.type,sourceLayerIndex:ie,index:Z,geometry:ce?ve.geometry:Zf(B),patterns:{},sortKey:Se};R.push(Ne)}k&&R.sort(((B,V)=>B.sortKey-V.sortKey));for(const B of R){const{geometry:V,index:Z,sourceLayerIndex:ie}=B;if(this.hasDependencies){const ce=uC("fill",this.layers,B,{zoom:this.zoom},f);this.patternFeatures.push(ce)}else this.addFeature(B,V,Z,v,{},f.subdivisionGranularity);f.featureIndex.insert(l[Z].feature,V,Z,ie,this.index)}}update(l,f,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,{imagePositions:v})}addFeatures(l,f,v){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,f,v,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,iie),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,f,v,S,k,R){for(const B of Vl(f,500)){const V=W6(B,S,R.fill.getGranularityForZoomLevel(S.z)),Z=this.layoutVertexArray;G6(((ie,ce)=>{Z.emplaceBack(ie,ce)}),this.segments,this.layoutVertexArray,this.indexArray,V.verticesFlattened,V.indicesTriangles,this.segments2,this.indexArray2,V.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:k,canonical:S})}}let X6,Y6;Pt("FillBucket",fC,{omit:["layers","patternFeatures"]});var mie={get paint(){return Y6=Y6||new $a({"fill-antialias":new Tn(Mt.paint_fill["fill-antialias"]),"fill-opacity":new Sn(Mt.paint_fill["fill-opacity"]),"fill-color":new Sn(Mt.paint_fill["fill-color"]),"fill-outline-color":new Sn(Mt.paint_fill["fill-outline-color"]),"fill-translate":new Tn(Mt.paint_fill["fill-translate"]),"fill-translate-anchor":new Tn(Mt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Rs(Mt.paint_fill["fill-pattern"])})},get layout(){return X6=X6||new $a({"fill-sort-key":new Sn(Mt.layout_fill["fill-sort-key"])})}};class yie extends eo{constructor(l,f){super(l,mie,f)}recalculate(l,f){super.recalculate(l,f);const v=this.paint._values["fill-outline-color"];v.value.kind==="constant"&&v.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new fC(l)}queryRadius(){return f2(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:l,geometry:f,transform:v,pixelsToTileUnits:S}){return A6(d2(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-v.bearingInRadians,S),f)}isTileClipped(){return!0}}const vie=pa([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),_ie=pa([{name:"a_centroid",components:2,type:"Int16"}],4),{members:bie}=vie;class j_{constructor(l,f,v,S,k){this.properties={},this.extent=v,this.type=0,this.id=void 0,this._pbf=l,this._geometry=-1,this._keys=S,this._values=k,l.readFields(xie,this,f)}loadGeometry(){const l=this._pbf;l.pos=this._geometry;const f=l.readVarint()+l.pos,v=[];let S,k=1,R=0,B=0,V=0;for(;l.pos<f;){if(R<=0){const Z=l.readVarint();k=7&Z,R=Z>>3}if(R--,k===1||k===2)B+=l.readSVarint(),V+=l.readSVarint(),k===1&&(S&&v.push(S),S=[]),S&&S.push(new c(B,V));else{if(k!==7)throw new Error(`unknown command ${k}`);S&&S.push(S[0].clone())}}return S&&v.push(S),v}bbox(){const l=this._pbf;l.pos=this._geometry;const f=l.readVarint()+l.pos;let v=1,S=0,k=0,R=0,B=1/0,V=-1/0,Z=1/0,ie=-1/0;for(;l.pos<f;){if(S<=0){const ce=l.readVarint();v=7&ce,S=ce>>3}if(S--,v===1||v===2)k+=l.readSVarint(),R+=l.readSVarint(),k<B&&(B=k),k>V&&(V=k),R<Z&&(Z=R),R>ie&&(ie=R);else if(v!==7)throw new Error(`unknown command ${v}`)}return[B,Z,V,ie]}toGeoJSON(l,f,v){const S=this.extent*Math.pow(2,v),k=this.extent*l,R=this.extent*f,B=this.loadGeometry();function V(ve){return[360*(ve.x+k)/S-180,360/Math.PI*Math.atan(Math.exp((1-2*(ve.y+R)/S)*Math.PI))-90]}function Z(ve){return ve.map(V)}let ie;if(this.type===1){const ve=[];for(const Ne of B)ve.push(Ne[0]);const Se=Z(ve);ie=ve.length===1?{type:"Point",coordinates:Se[0]}:{type:"MultiPoint",coordinates:Se}}else if(this.type===2){const ve=B.map(Z);ie=ve.length===1?{type:"LineString",coordinates:ve[0]}:{type:"MultiLineString",coordinates:ve}}else{if(this.type!==3)throw new Error("unknown feature type");{const ve=Z6(B),Se=[];for(const Ne of ve)Se.push(Ne.map(Z));ie=Se.length===1?{type:"Polygon",coordinates:Se[0]}:{type:"MultiPolygon",coordinates:Se}}}const ce={type:"Feature",geometry:ie,properties:this.properties};return this.id!=null&&(ce.id=this.id),ce}}function xie(p,l,f){p===1?l.id=f.readVarint():p===2?(function(v,S){const k=v.readVarint()+v.pos;for(;v.pos<k;){const R=S._keys[v.readVarint()],B=S._values[v.readVarint()];S.properties[R]=B}})(f,l):p===3?l.type=f.readVarint():p===4&&(l._geometry=f.pos)}function Z6(p){const l=p.length;if(l<=1)return[p];const f=[];let v,S;for(let k=0;k<l;k++){const R=wie(p[k]);R!==0&&(S===void 0&&(S=R<0),S===R<0?(v&&f.push(v),v=[p[k]]):v&&v.push(p[k]))}return v&&f.push(v),f}function wie(p){let l=0;for(let f,v,S=0,k=p.length,R=k-1;S<k;R=S++)f=p[S],v=p[R],l+=(v.x-f.x)*(f.y+v.y);return l}j_.types=["Unknown","Point","LineString","Polygon"];class Sie{constructor(l,f){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(Eie,this,f),this.length=this._features.length}feature(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];const f=this._pbf.readVarint()+this._pbf.pos;return new j_(this._pbf,f,this.extent,this._keys,this._values)}}function Eie(p,l,f){p===15?l.version=f.readVarint():p===1?l.name=f.readString():p===5?l.extent=f.readVarint():p===2?l._features.push(f.pos):p===3?l._keys.push(f.readString()):p===4&&l._values.push((function(v){let S=null;const k=v.readVarint()+v.pos;for(;v.pos<k;){const R=v.readVarint()>>3;S=R===1?v.readString():R===2?v.readFloat():R===3?v.readDouble():R===4?v.readVarint64():R===5?v.readVarint():R===6?v.readSVarint():R===7?v.readBoolean():null}if(S==null)throw new Error("unknown feature value");return S})(f))}class K6{constructor(l,f){this.layers=l.readFields(Tie,{},f)}}function Tie(p,l,f){if(p===3){const v=new Sie(f,f.readVarint()+f.pos);v.length&&(l[v.name]=v)}}const dC=Math.pow(2,13);function U_(p,l,f,v,S,k,R,B){p.emplaceBack(l,f,2*Math.floor(v*dC)+R,S*dC*2,k*dC*2,Math.round(B))}class pC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((f=>f.id)),this.index=l.index,this.hasDependencies=!1,this.layoutVertexArray=new xt,this.centroidVertexArray=new ft,this.indexArray=new xr,this.programConfigurations=new Hd(l.layers,l.zoom),this.segments=new gn,this.stateDependentLayerIds=this.layers.filter((f=>f.isStateDependent())).map((f=>f.id))}populate(l,f,v){this.features=[],this.hasDependencies=p2("fill-extrusion",this.layers,f);for(const{feature:S,id:k,index:R,sourceLayerIndex:B}of l){const V=this.layers[0]._featureFilter.needGeometry,Z=Kf(S,V);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),Z,v))continue;const ie={id:k,sourceLayerIndex:B,index:R,geometry:V?Z.geometry:Zf(S),properties:S.properties,type:S.type,patterns:{}};this.hasDependencies?this.features.push(uC("fill-extrusion",this.layers,ie,{zoom:this.zoom},f)):this.addFeature(ie,ie.geometry,R,v,{},f.subdivisionGranularity),f.featureIndex.insert(S,ie.geometry,R,B,this.index,!0)}}addFeatures(l,f,v){for(const S of this.features){const{geometry:k}=S;this.addFeature(S,k,S.index,f,v,l.subdivisionGranularity)}}update(l,f,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,{imagePositions:v})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,bie),this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,_ie.members,!0),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(l,f,v,S,k,R){for(const B of Vl(f,500)){const V={x:0,y:0,sampleCount:0},Z=this.layoutVertexArray.length;this.processPolygon(V,S,l,B,R);const ie=this.layoutVertexArray.length-Z,ce=Math.floor(V.x/V.sampleCount),ve=Math.floor(V.y/V.sampleCount);for(let Se=0;Se<ie;Se++)this.centroidVertexArray.emplaceBack(ce,ve)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:k,canonical:S})}processPolygon(l,f,v,S,k){if(S.length<1||J6(S[0]))return;for(const ce of S)ce.length!==0&&Cie(l,ce);const R={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},B=k.fill.getGranularityForZoomLevel(f.z),V=j_.types[v.type]==="Polygon";for(const ce of S){if(ce.length===0||J6(ce))continue;const ve=rm(ce,B,V);this._generateSideFaces(ve,R)}if(!V)return;const Z=W6(S,f,B,!1),ie=this.layoutVertexArray;G6(((ce,ve)=>{U_(ie,ce,ve,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,Z.verticesFlattened,Z.indicesTriangles)}_generateSideFaces(l,f){let v=0;for(let S=1;S<l.length;S++){const k=l[S],R=l[S-1];if(Aie(k,R))continue;f.segment.vertexLength+4>gn.MAX_VERTEX_ARRAY_LENGTH&&(f.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const B=k.sub(R)._perp()._unit(),V=R.dist(k);v+V>32768&&(v=0),U_(this.layoutVertexArray,k.x,k.y,B.x,B.y,0,0,v),U_(this.layoutVertexArray,k.x,k.y,B.x,B.y,0,1,v),v+=V,U_(this.layoutVertexArray,R.x,R.y,B.x,B.y,0,0,v),U_(this.layoutVertexArray,R.x,R.y,B.x,B.y,0,1,v);const Z=f.segment.vertexLength;this.indexArray.emplaceBack(Z,Z+2,Z+1),this.indexArray.emplaceBack(Z+1,Z+2,Z+3),f.segment.vertexLength+=4,f.segment.primitiveLength+=2}}}function Cie(p,l){for(let f=0;f<l.length;f++){const v=l[f];f===l.length-1&&l[0].x===v.x&&l[0].y===v.y||(p.x+=v.x,p.y+=v.y,p.sampleCount++)}}function Aie(p,l){return p.x===l.x&&(p.x<0||p.x>xe)||p.y===l.y&&(p.y<0||p.y>xe)}function J6(p){return p.every((l=>l.x<0))||p.every((l=>l.x>xe))||p.every((l=>l.y<0))||p.every((l=>l.y>xe))}let Q6;Pt("FillExtrusionBucket",pC,{omit:["layers","features"]});var Iie={get paint(){return Q6=Q6||new $a({"fill-extrusion-opacity":new Tn(Mt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Sn(Mt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Tn(Mt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Tn(Mt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Rs(Mt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Sn(Mt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Sn(Mt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Tn(Mt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Pie extends eo{constructor(l,f){super(l,Iie,f)}createBucket(l){return new pC(l)}queryRadius(){return f2(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:l,feature:f,featureState:v,geometry:S,transform:k,pixelsToTileUnits:R,pixelPosMatrix:B}){const V=d2(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-k.bearingInRadians,R),Z=this.paint.get("fill-extrusion-height").evaluate(f,v),ie=this.paint.get("fill-extrusion-base").evaluate(f,v),ce=(function(Se,Ne){const ze=[];for(const Ve of Se){const et=[Ve.x,Ve.y,0,1];se(et,et,Ne),ze.push(new c(et[0]/et[3],et[1]/et[3]))}return ze})(V,B),ve=(function(Se,Ne,ze,Ve){const et=[],Ct=[],nt=Ve[8]*Ne,ut=Ve[9]*Ne,Rt=Ve[10]*Ne,Ft=Ve[11]*Ne,fr=Ve[8]*ze,Or=Ve[9]*ze,Pr=Ve[10]*ze,Vr=Ve[11]*ze;for(const pn of Se){const Gr=[],Rr=[];for(const Er of pn){const Cn=Er.x,xn=Er.y,kn=Ve[0]*Cn+Ve[4]*xn+Ve[12],vn=Ve[1]*Cn+Ve[5]*xn+Ve[13],Wn=Ve[2]*Cn+Ve[6]*xn+Ve[14],la=Ve[3]*Cn+Ve[7]*xn+Ve[15],Hi=Wn+Rt,Po=la+Ft,Ql=kn+fr,Ms=vn+Or,ko=Wn+Pr,vo=la+Vr,Ta=new c((kn+nt)/Po,(vn+ut)/Po);Ta.z=Hi/Po,Gr.push(Ta);const Yo=new c(Ql/vo,Ms/vo);Yo.z=ko/vo,Rr.push(Yo)}et.push(Gr),Ct.push(Rr)}return[et,Ct]})(S,ie,Z,B);return(function(Se,Ne,ze){let Ve=1/0;A6(ze,Ne)&&(Ve=eF(ze,Ne[0]));for(let et=0;et<Ne.length;et++){const Ct=Ne[et],nt=Se[et];for(let ut=0;ut<Ct.length-1;ut++){const Rt=Ct[ut],Ft=[Rt,Ct[ut+1],nt[ut+1],nt[ut],Rt];$y(ze,Ft)&&(Ve=Math.min(Ve,eF(ze,Ft)))}}return Ve!==1/0&&Ve})(ve[0],ve[1],ce)}}function V_(p,l){return p.x*l.x+p.y*l.y}function eF(p,l){if(p.length===1){let f=0;const v=l[f++];let S;for(;!S||v.equals(S);)if(S=l[f++],!S)return 1/0;for(;f<l.length;f++){const k=l[f],R=p[0],B=S.sub(v),V=k.sub(v),Z=R.sub(v),ie=V_(B,B),ce=V_(B,V),ve=V_(V,V),Se=V_(Z,B),Ne=V_(Z,V),ze=ie*ve-ce*ce,Ve=(ve*Se-ce*Ne)/ze,et=(ie*Ne-ce*Se)/ze,Ct=v.z*(1-Ve-et)+S.z*Ve+k.z*et;if(isFinite(Ct))return Ct}return 1/0}{let f=1/0;for(const v of l)f=Math.min(f,v.z);return f}}const kie=pa([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Rie}=kie,Mie=pa([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Die}=Mie,Oie=Math.cos(Math.PI/180*37.5),tF=Math.pow(2,14)/.5;class gC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((f=>f.id)),this.index=l.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((f=>{this.gradients[f.id]={}})),this.layoutVertexArray=new Ot,this.layoutVertexArray2=new wt,this.indexArray=new xr,this.programConfigurations=new Hd(l.layers,l.zoom),this.segments=new gn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((f=>f.isStateDependent())).map((f=>f.id))}populate(l,f,v){this.hasDependencies=p2("line",this.layers,f)||this.hasLineDasharray(this.layers);const S=this.layers[0].layout.get("line-sort-key"),k=!S.isConstant(),R=[];for(const{feature:B,id:V,index:Z,sourceLayerIndex:ie}of l){const ce=this.layers[0]._featureFilter.needGeometry,ve=Kf(B,ce);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom),ve,v))continue;const Se=k?S.evaluate(ve,{},v):void 0,Ne={id:V,properties:B.properties,type:B.type,sourceLayerIndex:ie,index:Z,geometry:ce?ve.geometry:Zf(B),patterns:{},dashes:{},sortKey:Se};R.push(Ne)}k&&R.sort(((B,V)=>B.sortKey-V.sortKey));for(const B of R){const{geometry:V,index:Z,sourceLayerIndex:ie}=B;this.hasDependencies?(p2("line",this.layers,f)?uC("line",this.layers,B,{zoom:this.zoom},f):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,B,this.zoom,f),this.patternFeatures.push(B)):this.addFeature(B,V,Z,v,{},{},f.subdivisionGranularity),f.featureIndex.insert(l[Z].feature,V,Z,ie,this.index)}}update(l,f,v,S){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,{imagePositions:v,dashPositions:S})}addFeatures(l,f,v,S){for(const k of this.patternFeatures)this.addFeature(k,k.geometry,k.index,f,v,S,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,Die)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Rie),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,f,v,S,k,R,B){const V=this.layers[0].layout,Z=V.get("line-join").evaluate(l,{}),ie=V.get("line-cap"),ce=V.get("line-miter-limit"),ve=V.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(const Se of f)this.addLine(Se,l,Z,ie,ce,ve,S,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:k,dashPositions:R,canonical:S})}addLine(l,f,v,S,k,R,B,V){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,l=rm(l,B?V.line.getGranularityForZoomLevel(B.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let nt=0;nt<l.length-1;nt++)this.totalDistance+=l[nt].dist(l[nt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const Z=j_.types[f.type]==="Polygon";let ie=l.length;for(;ie>=2&&l[ie-1].equals(l[ie-2]);)ie--;let ce=0;for(;ce<ie-1&&l[ce].equals(l[ce+1]);)ce++;if(ie<(Z?3:2))return;v==="bevel"&&(k=1.05);const ve=this.overscaling<=16?122880/(512*this.overscaling):0,Se=this.segments.prepareSegment(10*ie,this.layoutVertexArray,this.indexArray);let Ne,ze,Ve,et,Ct;this.e1=this.e2=-1,Z&&(Ne=l[ie-2],Ct=l[ce].sub(Ne)._unit()._perp());for(let nt=ce;nt<ie;nt++){if(Ve=nt===ie-1?Z?l[ce+1]:void 0:l[nt+1],Ve&&l[nt].equals(Ve))continue;Ct&&(et=Ct),Ne&&(ze=Ne),Ne=l[nt],Ct=Ve?Ve.sub(Ne)._unit()._perp():et,et=et||Ct;let ut=et.add(Ct);ut.x===0&&ut.y===0||ut._unit();const Rt=et.x*Ct.x+et.y*Ct.y,Ft=ut.x*Ct.x+ut.y*Ct.y,fr=Ft!==0?1/Ft:1/0,Or=2*Math.sqrt(2-2*Ft),Pr=Ft<Oie&&ze&&Ve,Vr=et.x*Ct.y-et.y*Ct.x>0;if(Pr&&nt>ce){const Rr=Ne.dist(ze);if(Rr>2*ve){const Er=Ne.sub(Ne.sub(ze)._mult(ve/Rr)._round());this.updateDistance(ze,Er),this.addCurrentVertex(Er,et,0,0,Se),ze=Er}}const pn=ze&&Ve;let Gr=pn?v:Z?"butt":S;if(pn&&Gr==="round"&&(fr<R?Gr="miter":fr<=2&&(Gr="fakeround")),Gr==="miter"&&fr>k&&(Gr="bevel"),Gr==="bevel"&&(fr>2&&(Gr="flipbevel"),fr<k&&(Gr="miter")),ze&&this.updateDistance(ze,Ne),Gr==="miter")ut._mult(fr),this.addCurrentVertex(Ne,ut,0,0,Se);else if(Gr==="flipbevel"){if(fr>100)ut=Ct.mult(-1);else{const Rr=fr*et.add(Ct).mag()/et.sub(Ct).mag();ut._perp()._mult(Rr*(Vr?-1:1))}this.addCurrentVertex(Ne,ut,0,0,Se),this.addCurrentVertex(Ne,ut.mult(-1),0,0,Se)}else if(Gr==="bevel"||Gr==="fakeround"){const Rr=-Math.sqrt(fr*fr-1),Er=Vr?Rr:0,Cn=Vr?0:Rr;if(ze&&this.addCurrentVertex(Ne,et,Er,Cn,Se),Gr==="fakeround"){const xn=Math.round(180*Or/Math.PI/20);for(let kn=1;kn<xn;kn++){let vn=kn/xn;if(vn!==.5){const la=vn-.5;vn+=vn*la*(vn-1)*((1.0904+Rt*(Rt*(3.55645-1.43519*Rt)-3.2452))*la*la+(.848013+Rt*(.215638*Rt-1.06021)))}const Wn=Ct.sub(et)._mult(vn)._add(et)._unit()._mult(Vr?-1:1);this.addHalfVertex(Ne,Wn.x,Wn.y,!1,Vr,0,Se)}}Ve&&this.addCurrentVertex(Ne,Ct,-Er,-Cn,Se)}else if(Gr==="butt")this.addCurrentVertex(Ne,ut,0,0,Se);else if(Gr==="square"){const Rr=ze?1:-1;this.addCurrentVertex(Ne,ut,Rr,Rr,Se)}else Gr==="round"&&(ze&&(this.addCurrentVertex(Ne,et,0,0,Se),this.addCurrentVertex(Ne,et,1,1,Se,!0)),Ve&&(this.addCurrentVertex(Ne,Ct,-1,-1,Se,!0),this.addCurrentVertex(Ne,Ct,0,0,Se)));if(Pr&&nt<ie-1){const Rr=Ne.dist(Ve);if(Rr>2*ve){const Er=Ne.add(Ve.sub(Ne)._mult(ve/Rr)._round());this.updateDistance(Ne,Er),this.addCurrentVertex(Er,Ct,0,0,Se),Ne=Er}}}}addCurrentVertex(l,f,v,S,k,R=!1){const B=f.y*S-f.x,V=-f.y-f.x*S;this.addHalfVertex(l,f.x+f.y*v,f.y-f.x*v,R,!1,v,k),this.addHalfVertex(l,B,V,R,!0,-S,k),this.distance>tF/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(l,f,v,S,k,R))}addHalfVertex({x:l,y:f},v,S,k,R,B,V){const Z=.5*(this.lineClips?this.scaledDistance*(tF-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((l<<1)+(k?1:0),(f<<1)+(R?1:0),Math.round(63*v)+128,Math.round(63*S)+128,1+(B===0?0:B<0?-1:1)|(63&Z)<<2,Z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const ie=V.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,ie,this.e2),V.primitiveLength++),R?this.e2=ie:this.e1=ie}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(l,f){this.distance+=l.dist(f),this.updateScaledDistance()}hasLineDasharray(l){for(const f of l){const v=f.paint.get("line-dasharray");if(v&&!v.isConstant())return!0}return!1}addLineDashDependencies(l,f,v,S){for(const k of l){const R=k.paint.get("line-dasharray");if(!R||R.value.kind==="constant")continue;const B=k.layout.get("line-cap")==="round",V={dasharray:R.value.evaluate({zoom:v-1},f,{}),round:B},Z={dasharray:R.value.evaluate({zoom:v},f,{}),round:B},ie={dasharray:R.value.evaluate({zoom:v+1},f,{}),round:B},ce=`${V.dasharray.join(",")},${V.round}`,ve=`${Z.dasharray.join(",")},${Z.round}`,Se=`${ie.dasharray.join(",")},${ie.round}`;S.dashDependencies[ce]=V,S.dashDependencies[ve]=Z,S.dashDependencies[Se]=ie,f.dashes[k.id]={min:ce,mid:ve,max:Se}}}}let rF,nF;Pt("LineBucket",gC,{omit:["layers","patternFeatures"]});var iF={get paint(){return nF=nF||new $a({"line-opacity":new Sn(Mt.paint_line["line-opacity"]),"line-color":new Sn(Mt.paint_line["line-color"]),"line-translate":new Tn(Mt.paint_line["line-translate"]),"line-translate-anchor":new Tn(Mt.paint_line["line-translate-anchor"]),"line-width":new Sn(Mt.paint_line["line-width"]),"line-gap-width":new Sn(Mt.paint_line["line-gap-width"]),"line-offset":new Sn(Mt.paint_line["line-offset"]),"line-blur":new Sn(Mt.paint_line["line-blur"]),"line-dasharray":new Rs(Mt.paint_line["line-dasharray"]),"line-pattern":new Rs(Mt.paint_line["line-pattern"]),"line-gradient":new Lo(Mt.paint_line["line-gradient"])})},get layout(){return rF=rF||new $a({"line-cap":new Tn(Mt.layout_line["line-cap"]),"line-join":new Sn(Mt.layout_line["line-join"]),"line-miter-limit":new Tn(Mt.layout_line["line-miter-limit"]),"line-round-limit":new Tn(Mt.layout_line["line-round-limit"]),"line-sort-key":new Sn(Mt.layout_line["line-sort-key"])})}};class Nie extends Sn{possiblyEvaluate(l,f){return f=new ki(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,zoomHistory:f.zoomHistory,transition:f.transition}),super.possiblyEvaluate(l,f)}evaluate(l,f,v,S){return f=Be({},f,{zoom:Math.floor(f.zoom)}),super.evaluate(l,f,v,S)}}let v2;class Lie extends eo{constructor(l,f){super(l,iF,f),this.gradientVersion=0,v2||(v2=new Nie(iF.paint.properties["line-width"].specification),v2.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const f=this.gradientExpression();this.stepInterpolant=!!(function(v){return v._styleExpression!==void 0})(f)&&f._styleExpression.expression instanceof Bt,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,f){super.recalculate(l,f),this.paint._values["line-floorwidth"]=v2.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new gC(l)}queryRadius(l){const f=l,v=aF(Hy("line-width",this,f),Hy("line-gap-width",this,f)),S=Hy("line-offset",this,f);return v/2+Math.abs(S)+f2(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:l,feature:f,featureState:v,geometry:S,transform:k,pixelsToTileUnits:R}){const B=d2(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-k.bearingInRadians,R),V=R/2*aF(this.paint.get("line-width").evaluate(f,v),this.paint.get("line-gap-width").evaluate(f,v)),Z=this.paint.get("line-offset").evaluate(f,v);return Z&&(S=(function(ie,ce){const ve=[];for(let Se=0;Se<ie.length;Se++){const Ne=qne(ie[Se]),ze=[];for(let Ve=0;Ve<Ne.length;Ve++){const et=Ne[Ve],Ct=Ne[Ve-1],nt=Ne[Ve+1],ut=Ve===0?new c(0,0):et.sub(Ct)._unit()._perp(),Rt=Ve===Ne.length-1?new c(0,0):nt.sub(et)._unit()._perp(),Ft=ut._add(Rt)._unit(),fr=Ft.x*Rt.x+Ft.y*Rt.y;fr!==0&&Ft._mult(1/fr),ze.push(Ft._mult(ce)._add(et))}ve.push(ze)}return ve})(S,Z*R)),(function(ie,ce,ve){for(let Se=0;Se<ce.length;Se++){const Ne=ce[Se];if(ie.length>=3){for(let ze=0;ze<Ne.length;ze++)if(qy(ie,Ne[ze]))return!0}if(Une(ie,Ne,ve))return!0}return!1})(B,S,V)}isTileClipped(){return!0}}function aF(p,l){return l>0?l+2*p:p}const Fie=pa([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Bie=pa([{name:"a_projected_pos",components:3,type:"Float32"}],4);pa([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const zie=pa([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);pa([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const oF=pa([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jie=pa([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Uie(p,l,f){return p.sections.forEach((v=>{v.text=(function(S,k,R){const B=k.layout.get("text-transform").evaluate(R,{});return B==="uppercase"?S=S.toLocaleUpperCase():B==="lowercase"&&(S=S.toLocaleLowerCase()),da.applyArabicShaping&&(S=da.applyArabicShaping(S)),S})(v.text,l,f)})),p}pa([{name:"triangle",components:3,type:"Uint16"}]),pa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),pa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),pa([{type:"Float32",name:"offsetX"}]),pa([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),pa([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var gl=24;const $_={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},Vie={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},$ie={40:!0};function sF(p,l,f,v,S,k){if("fontStack"in l){const R=f[l.fontStack],B=R&&R[p];return B?B.metrics.advance*l.scale+S:0}{const R=v[l.imageName];return R?R.displaySize[0]*l.scale*gl/k+S:0}}function lF(p,l,f,v){const S=Math.pow(p-l,2);return v?p<l?S/2:2*S:S+Math.abs(f)*f}function qie(p,l,f){let v=0;return p===10&&(v-=1e4),f&&(v+=150),p!==40&&p!==65288||(v+=50),l!==41&&l!==65289||(v+=50),v}function uF(p,l,f,v,S,k){let R=null,B=lF(l,f,S,k);for(const V of v){const Z=lF(l-V.x,f,S,k)+V.badness;Z<=B&&(R=V,B=Z)}return{index:p,x:l,priorBreak:R,badness:B}}function cF(p){return p?cF(p.priorBreak).concat(p.index):[]}class Yy{constructor(l="",f=[],v=[]){this.text=l,this.sections=f,this.sectionIndex=v,this.imageSectionID=null}static fromFeature(l,f){const v=new Yy;for(let S=0;S<l.sections.length;S++){const k=l.sections[S];k.image?v.addImageSection(k):v.addTextSection(k,f)}return v}length(){return[...this.text].length}getSection(l){return this.sections[this.sectionIndex[l]]}getSectionIndex(l){return this.sectionIndex[l]}verticalizePunctuation(){this.text=(function(l){let f="",v={premature:!0,value:void 0};const S=l[Symbol.iterator]();let k=S.next();const R=l[Symbol.iterator]();R.next();let B=R.next();for(;!k.done;)f+=!B.done&&Yn(B.value.codePointAt(0))&&!$_[B.value]||!v.premature&&Yn(v.value.codePointAt(0))&&!$_[v.value]||!$_[k.value]?k.value:$_[k.value],v={value:k.value,premature:!1},k=S.next(),B=R.next();return f})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const l=this.text.match(/^\s*/),f=l?l[0].length:0,v=this.text.match(/\S\s*$/),S=v?v[0].length-1:0;this.text=this.text.substring(f,this.text.length-S),this.sectionIndex=this.sectionIndex.slice(f,this.sectionIndex.length-S)}substring(l,f){const v=[...this.text].slice(l,f).join(""),S=this.sectionIndex.slice(l,f);return new Yy(v,this.sections,S)}toCodeUnitIndex(l){return[...this.text].slice(0,l).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((l,f)=>Math.max(l,this.sections[f].scale)),0)}getMaxImageSize(l){let f=0,v=0;for(let S=0;S<this.length();S++){const k=this.getSection(S);if("imageName"in k){const R=l[k.imageName];if(!R)continue;const B=R.displaySize;f=Math.max(f,B[0]),v=Math.max(v,B[1])}}return{maxImageWidth:f,maxImageHeight:v}}addTextSection(l,f){this.text+=l.text,this.sections.push({scale:l.scale||1,verticalAlign:l.verticalAlign||"bottom",fontStack:l.fontStack||f});const v=this.sections.length-1;this.sectionIndex.push(...[...l.text].map((()=>v)))}addImageSection(l){const f=l.image?l.image.name:"";if(f.length===0)return void st("Can't add FormattedSection with an empty image.");const v=this.getNextImageSectionCharCode();v?(this.text+=String.fromCharCode(v),this.sections.push({scale:1,verticalAlign:l.verticalAlign||"bottom",imageName:f}),this.sectionIndex.push(this.sections.length-1)):st("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(l,f,v,S,k){const R=[],B=this.determineAverageLineWidth(l,f,v,S,k),V=this.hasZeroWidthSpaces();let Z=0,ie=0;const ce=this.text[Symbol.iterator]();let ve=ce.next();const Se=this.text[Symbol.iterator]();Se.next();let Ne=Se.next();const ze=this.text[Symbol.iterator]();ze.next(),ze.next();let Ve=ze.next();for(;!ve.done;){const et=this.getSection(ie),Ct=ve.value.codePointAt(0);if(Vn(Ct)||(Z+=sF(Ct,et,v,S,l,k)),!Ne.done){const nt=Jr(Ct),ut=Ne.value.codePointAt(0);(Vie[Ct]||nt||"imageName"in et||!Ve.done&&$ie[ut])&&R.push(uF(ie+1,Z,B,R,qie(Ct,ut,nt&&V),!1))}ie++,ve=ce.next(),Ne=Se.next(),Ve=ze.next()}return cF(uF(this.length(),Z,B,R,0,!0))}determineAverageLineWidth(l,f,v,S,k){let R=0,B=0;for(const V of this.text){const Z=this.getSection(B);R+=sF(V.codePointAt(0),Z,v,S,l,k),B++}return R/Math.max(1,Math.ceil(R/f))}}const mC=4294967296,hF=1/mC,fF=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class _2{constructor(l=new Uint8Array(16)){this.buf=ArrayBuffer.isView(l)?l:new Uint8Array(l),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(l,f,v=this.length){for(;this.pos<v;){const S=this.readVarint(),k=S>>3,R=this.pos;this.type=7&S,l(k,f,this),this.pos===R&&this.skip(S)}return f}readMessage(l,f){return this.readFields(l,f,this.readVarint()+this.pos)}readFixed32(){const l=this.dataView.getUint32(this.pos,!0);return this.pos+=4,l}readSFixed32(){const l=this.dataView.getInt32(this.pos,!0);return this.pos+=4,l}readFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*mC;return this.pos+=8,l}readSFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*mC;return this.pos+=8,l}readFloat(){const l=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,l}readDouble(){const l=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,l}readVarint(l){const f=this.buf;let v,S;return S=f[this.pos++],v=127&S,S<128?v:(S=f[this.pos++],v|=(127&S)<<7,S<128?v:(S=f[this.pos++],v|=(127&S)<<14,S<128?v:(S=f[this.pos++],v|=(127&S)<<21,S<128?v:(S=f[this.pos],v|=(15&S)<<28,(function(k,R,B){const V=B.buf;let Z,ie;if(ie=V[B.pos++],Z=(112&ie)>>4,ie<128||(ie=V[B.pos++],Z|=(127&ie)<<3,ie<128)||(ie=V[B.pos++],Z|=(127&ie)<<10,ie<128)||(ie=V[B.pos++],Z|=(127&ie)<<17,ie<128)||(ie=V[B.pos++],Z|=(127&ie)<<24,ie<128)||(ie=V[B.pos++],Z|=(1&ie)<<31,ie<128))return Zy(k,Z,R);throw new Error("Expected varint not more than 10 bytes")})(v,l,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const l=this.readVarint();return l%2==1?(l+1)/-2:l/2}readBoolean(){return!!this.readVarint()}readString(){const l=this.readVarint()+this.pos,f=this.pos;return this.pos=l,l-f>=12&&fF?fF.decode(this.buf.subarray(f,l)):(function(v,S,k){let R="",B=S;for(;B<k;){const V=v[B];let Z,ie,ce,ve=null,Se=V>239?4:V>223?3:V>191?2:1;if(B+Se>k)break;Se===1?V<128&&(ve=V):Se===2?(Z=v[B+1],(192&Z)==128&&(ve=(31&V)<<6|63&Z,ve<=127&&(ve=null))):Se===3?(Z=v[B+1],ie=v[B+2],(192&Z)==128&&(192&ie)==128&&(ve=(15&V)<<12|(63&Z)<<6|63&ie,(ve<=2047||ve>=55296&&ve<=57343)&&(ve=null))):Se===4&&(Z=v[B+1],ie=v[B+2],ce=v[B+3],(192&Z)==128&&(192&ie)==128&&(192&ce)==128&&(ve=(15&V)<<18|(63&Z)<<12|(63&ie)<<6|63&ce,(ve<=65535||ve>=1114112)&&(ve=null))),ve===null?(ve=65533,Se=1):ve>65535&&(ve-=65536,R+=String.fromCharCode(ve>>>10&1023|55296),ve=56320|1023&ve),R+=String.fromCharCode(ve),B+=Se}return R})(this.buf,f,l)}readBytes(){const l=this.readVarint()+this.pos,f=this.buf.subarray(this.pos,l);return this.pos=l,f}readPackedVarint(l=[],f){const v=this.readPackedEnd();for(;this.pos<v;)l.push(this.readVarint(f));return l}readPackedSVarint(l=[]){const f=this.readPackedEnd();for(;this.pos<f;)l.push(this.readSVarint());return l}readPackedBoolean(l=[]){const f=this.readPackedEnd();for(;this.pos<f;)l.push(this.readBoolean());return l}readPackedFloat(l=[]){const f=this.readPackedEnd();for(;this.pos<f;)l.push(this.readFloat());return l}readPackedDouble(l=[]){const f=this.readPackedEnd();for(;this.pos<f;)l.push(this.readDouble());return l}readPackedFixed32(l=[]){const f=this.readPackedEnd();for(;this.pos<f;)l.push(this.readFixed32());return l}readPackedSFixed32(l=[]){const f=this.readPackedEnd();for(;this.pos<f;)l.push(this.readSFixed32());return l}readPackedFixed64(l=[]){const f=this.readPackedEnd();for(;this.pos<f;)l.push(this.readFixed64());return l}readPackedSFixed64(l=[]){const f=this.readPackedEnd();for(;this.pos<f;)l.push(this.readSFixed64());return l}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(l){const f=7&l;if(f===0)for(;this.buf[this.pos++]>127;);else if(f===2)this.pos=this.readVarint()+this.pos;else if(f===5)this.pos+=4;else{if(f!==1)throw new Error(`Unimplemented type: ${f}`);this.pos+=8}}writeTag(l,f){this.writeVarint(l<<3|f)}realloc(l){let f=this.length||16;for(;f<this.pos+l;)f*=2;if(f!==this.length){const v=new Uint8Array(f);v.set(this.buf),this.buf=v,this.dataView=new DataView(v.buffer),this.length=f}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeSFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*hF),!0),this.pos+=8}writeSFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*hF),!0),this.pos+=8}writeVarint(l){(l=+l||0)>268435455||l<0?(function(f,v){let S,k;if(f>=0?(S=f%4294967296|0,k=f/4294967296|0):(S=~(-f%4294967296),k=~(-f/4294967296),4294967295^S?S=S+1|0:(S=0,k=k+1|0)),f>=18446744073709552e3||f<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");v.realloc(10),(function(R,B,V){V.buf[V.pos++]=127&R|128,R>>>=7,V.buf[V.pos++]=127&R|128,R>>>=7,V.buf[V.pos++]=127&R|128,R>>>=7,V.buf[V.pos++]=127&R|128,V.buf[V.pos]=127&(R>>>=7)})(S,0,v),(function(R,B){const V=(7&R)<<4;B.buf[B.pos++]|=V|((R>>>=3)?128:0),R&&(B.buf[B.pos++]=127&R|((R>>>=7)?128:0),R&&(B.buf[B.pos++]=127&R|((R>>>=7)?128:0),R&&(B.buf[B.pos++]=127&R|((R>>>=7)?128:0),R&&(B.buf[B.pos++]=127&R|((R>>>=7)?128:0),R&&(B.buf[B.pos++]=127&R)))))})(k,v)})(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))}writeSVarint(l){this.writeVarint(l<0?2*-l-1:2*l)}writeBoolean(l){this.writeVarint(+l)}writeString(l){l=String(l),this.realloc(4*l.length),this.pos++;const f=this.pos;this.pos=(function(S,k,R){for(let B,V,Z=0;Z<k.length;Z++){if(B=k.charCodeAt(Z),B>55295&&B<57344){if(!V){B>56319||Z+1===k.length?(S[R++]=239,S[R++]=191,S[R++]=189):V=B;continue}if(B<56320){S[R++]=239,S[R++]=191,S[R++]=189,V=B;continue}B=V-55296<<10|B-56320|65536,V=null}else V&&(S[R++]=239,S[R++]=191,S[R++]=189,V=null);B<128?S[R++]=B:(B<2048?S[R++]=B>>6|192:(B<65536?S[R++]=B>>12|224:(S[R++]=B>>18|240,S[R++]=B>>12&63|128),S[R++]=B>>6&63|128),S[R++]=63&B|128)}return R})(this.buf,l,this.pos);const v=this.pos-f;v>=128&&dF(f,v,this),this.pos=f-1,this.writeVarint(v),this.pos+=v}writeFloat(l){this.realloc(4),this.dataView.setFloat32(this.pos,l,!0),this.pos+=4}writeDouble(l){this.realloc(8),this.dataView.setFloat64(this.pos,l,!0),this.pos+=8}writeBytes(l){const f=l.length;this.writeVarint(f),this.realloc(f);for(let v=0;v<f;v++)this.buf[this.pos++]=l[v]}writeRawMessage(l,f){this.pos++;const v=this.pos;l(f,this);const S=this.pos-v;S>=128&&dF(v,S,this),this.pos=v-1,this.writeVarint(S),this.pos+=S}writeMessage(l,f,v){this.writeTag(l,2),this.writeRawMessage(f,v)}writePackedVarint(l,f){f.length&&this.writeMessage(l,Hie,f)}writePackedSVarint(l,f){f.length&&this.writeMessage(l,Wie,f)}writePackedBoolean(l,f){f.length&&this.writeMessage(l,Yie,f)}writePackedFloat(l,f){f.length&&this.writeMessage(l,Gie,f)}writePackedDouble(l,f){f.length&&this.writeMessage(l,Xie,f)}writePackedFixed32(l,f){f.length&&this.writeMessage(l,Zie,f)}writePackedSFixed32(l,f){f.length&&this.writeMessage(l,Kie,f)}writePackedFixed64(l,f){f.length&&this.writeMessage(l,Jie,f)}writePackedSFixed64(l,f){f.length&&this.writeMessage(l,Qie,f)}writeBytesField(l,f){this.writeTag(l,2),this.writeBytes(f)}writeFixed32Field(l,f){this.writeTag(l,5),this.writeFixed32(f)}writeSFixed32Field(l,f){this.writeTag(l,5),this.writeSFixed32(f)}writeFixed64Field(l,f){this.writeTag(l,1),this.writeFixed64(f)}writeSFixed64Field(l,f){this.writeTag(l,1),this.writeSFixed64(f)}writeVarintField(l,f){this.writeTag(l,0),this.writeVarint(f)}writeSVarintField(l,f){this.writeTag(l,0),this.writeSVarint(f)}writeStringField(l,f){this.writeTag(l,2),this.writeString(f)}writeFloatField(l,f){this.writeTag(l,5),this.writeFloat(f)}writeDoubleField(l,f){this.writeTag(l,1),this.writeDouble(f)}writeBooleanField(l,f){this.writeVarintField(l,+f)}}function Zy(p,l,f){return f?4294967296*l+(p>>>0):4294967296*(l>>>0)+(p>>>0)}function dF(p,l,f){const v=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));f.realloc(v);for(let S=f.pos-1;S>=p;S--)f.buf[S+v]=f.buf[S]}function Hie(p,l){for(let f=0;f<p.length;f++)l.writeVarint(p[f])}function Wie(p,l){for(let f=0;f<p.length;f++)l.writeSVarint(p[f])}function Gie(p,l){for(let f=0;f<p.length;f++)l.writeFloat(p[f])}function Xie(p,l){for(let f=0;f<p.length;f++)l.writeDouble(p[f])}function Yie(p,l){for(let f=0;f<p.length;f++)l.writeBoolean(p[f])}function Zie(p,l){for(let f=0;f<p.length;f++)l.writeFixed32(p[f])}function Kie(p,l){for(let f=0;f<p.length;f++)l.writeSFixed32(p[f])}function Jie(p,l){for(let f=0;f<p.length;f++)l.writeFixed64(p[f])}function Qie(p,l){for(let f=0;f<p.length;f++)l.writeSFixed64(p[f])}function eae(p,l,f){p===1&&f.readMessage(tae,l)}function tae(p,l,f){if(p===3){const{id:v,bitmap:S,width:k,height:R,left:B,top:V,advance:Z}=f.readMessage(rae,{});l.push({id:v,bitmap:new D_({width:k+6,height:R+6},S),metrics:{width:k,height:R,left:B,top:V,advance:Z}})}}function rae(p,l,f){p===1?l.id=f.readVarint():p===2?l.bitmap=f.readBytes():p===3?l.width=f.readVarint():p===4?l.height=f.readVarint():p===5?l.left=f.readSVarint():p===6?l.top=f.readSVarint():p===7&&(l.advance=f.readVarint())}function pF(p){let l=0,f=0;for(const R of p)l+=R.w*R.h,f=Math.max(f,R.w);p.sort(((R,B)=>B.h-R.h));const v=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),f),h:1/0}];let S=0,k=0;for(const R of p)for(let B=v.length-1;B>=0;B--){const V=v[B];if(!(R.w>V.w||R.h>V.h)){if(R.x=V.x,R.y=V.y,k=Math.max(k,R.y+R.h),S=Math.max(S,R.x+R.w),R.w===V.w&&R.h===V.h){const Z=v.pop();Z&&B<v.length&&(v[B]=Z)}else R.h===V.h?(V.x+=R.w,V.w-=R.w):R.w===V.w?(V.y+=R.h,V.h-=R.h):(v.push({x:V.x+R.w,y:V.y,w:V.w-R.w,h:R.h}),V.y+=R.h,V.h-=R.h);break}}return{w:S,h:k,fill:l/(S*k)||0}}class yC{constructor(l,{pixelRatio:f,version:v,stretchX:S,stretchY:k,content:R,textFitWidth:B,textFitHeight:V}){this.paddedRect=l,this.pixelRatio=f,this.stretchX=S,this.stretchY=k,this.content=R,this.version=v,this.textFitWidth=B,this.textFitHeight=V}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class gF{constructor(l,f){const v={},S={};this.haveRenderCallbacks=[];const k=[];this.addImages(l,v,k),this.addImages(f,S,k);const{w:R,h:B}=pF(k),V=new lc({width:R||1,height:B||1});for(const Z in l){const ie=l[Z],ce=v[Z].paddedRect;lc.copy(ie.data,V,{x:0,y:0},{x:ce.x+1,y:ce.y+1},ie.data)}for(const Z in f){const ie=f[Z],ce=S[Z].paddedRect,ve=ce.x+1,Se=ce.y+1,Ne=ie.data.width,ze=ie.data.height;lc.copy(ie.data,V,{x:0,y:0},{x:ve,y:Se},ie.data),lc.copy(ie.data,V,{x:0,y:ze-1},{x:ve,y:Se-1},{width:Ne,height:1}),lc.copy(ie.data,V,{x:0,y:0},{x:ve,y:Se+ze},{width:Ne,height:1}),lc.copy(ie.data,V,{x:Ne-1,y:0},{x:ve-1,y:Se},{width:1,height:ze}),lc.copy(ie.data,V,{x:0,y:0},{x:ve+Ne,y:Se},{width:1,height:ze})}this.image=V,this.iconPositions=v,this.patternPositions=S}addImages(l,f,v){for(const S in l){const k=l[S],R={x:0,y:0,w:k.data.width+2,h:k.data.height+2};v.push(R),f[S]=new yC(R,k),k.hasRenderCallback&&this.haveRenderCallbacks.push(S)}}patchUpdatedImages(l,f){l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const v in l.updatedImages)this.patchUpdatedImage(this.iconPositions[v],l.getImage(v),f),this.patchUpdatedImage(this.patternPositions[v],l.getImage(v),f)}patchUpdatedImage(l,f,v){if(!l||!f||l.version===f.version)return;l.version=f.version;const[S,k]=l.tl;v.update(f.data,void 0,{x:S,y:k})}}var Hp;function b2(p,l,f,v,S,k,R,B,V,Z,ie,ce,ve,Se,Ne){const ze=Yy.fromFeature(p,S);let Ve;ce===s.az.vertical&&ze.verticalizePunctuation();let et=ze.determineLineBreaks(Z,k,l,v,Se);const{processBidirectionalText:Ct,processStyledBidirectionalText:nt}=da;if(Ct&&ze.sections.length===1){Ve=[],et=et.map((fr=>ze.toCodeUnitIndex(fr)));const Ft=Ct(ze.toString(),et);for(const fr of Ft){const Or=[...fr].map((()=>0));Ve.push(new Yy(fr,ze.sections,Or))}}else if(nt){Ve=[],et=et.map((Pr=>ze.toCodeUnitIndex(Pr)));let Ft=0;const fr=[];for(const Pr of ze.text)fr.push(...Array(Pr.length).fill(ze.sectionIndex[Ft])),Ft++;const Or=nt(ze.text,fr,et);for(const Pr of Or){const Vr=[];let pn="";for(const Gr of Pr[0])Vr.push(Pr[1][pn.length]),pn+=Gr;Ve.push(new Yy(Pr[0],ze.sections,Vr))}}else Ve=(function(Ft,fr){const Or=[];let Pr=0;for(const Vr of fr)Or.push(Ft.substring(Pr,Vr)),Pr=Vr;return Pr<Ft.length()&&Or.push(Ft.substring(Pr,Ft.length())),Or})(ze,et);const ut=[],Rt={positionedLines:ut,text:ze.toString(),top:ie[1],bottom:ie[1],left:ie[0],right:ie[0],writingMode:ce,iconsInText:!1,verticalizable:!1};return(function(Ft,fr,Or,Pr,Vr,pn,Gr,Rr,Er,Cn,xn,kn){let vn=0,Wn=0,la=0,Hi=0;const Po=Rr==="right"?1:Rr==="left"?0:.5,Ql=gl/kn;let Ms=0;for(const Ta of Vr){Ta.trim();const Yo=Ta.getMaxScale(),os={positionedGlyphs:[],lineOffset:0};Ft.positionedLines[Ms]=os;const uo=os.positionedGlyphs;let uc=0;if(!Ta.length()){Wn+=pn,++Ms;continue}const eu=nae(Pr,Ta,Ql);let cc=0;for(const vl of Ta.text){const Fo=Ta.getSection(cc),Ds=vl.codePointAt(0),Zo=iae(Er,xn,Ds),_l={glyph:Ds,imageName:null,x:vn,y:Wn+-17,vertical:Zo,scale:1,fontStack:"",sectionIndex:Ta.getSectionIndex(cc),metrics:null,rect:null};let Xd;if("fontStack"in Fo){if(Xd=aae(Fo,Ds,Zo,eu,fr,Or),!Xd)continue;_l.fontStack=Fo.fontStack}else{if(Ft.iconsInText=!0,Fo.scale*=Ql,Xd=oae(Fo,Zo,Yo,eu,Pr),!Xd)continue;uc=Math.max(uc,Xd.imageOffset),_l.imageName=Fo.imageName}const{rect:cf,metrics:Z_,baselineOffset:Zp}=Xd;_l.y+=Zp,_l.scale=Fo.scale,_l.metrics=Z_,_l.rect=cf,uo.push(_l),Zo?(Ft.verticalizable=!0,vn+=("imageName"in Fo?Z_.advance:gl)*Fo.scale+Cn):vn+=Z_.advance*Fo.scale+Cn,cc++}uo.length!==0&&(la=Math.max(vn-Cn,la),sae(uo,0,uo.length-1,Po)),vn=0,os.lineOffset=Math.max(uc,(Yo-1)*gl);const Ch=pn*Yo+uc;Wn+=Ch,Hi=Math.max(Ch,Hi),++Ms}const{horizontalAlign:ko,verticalAlign:vo}=vC(Gr);(function(Ta,Yo,os,uo,uc,eu,cc,Ch,vl){const Fo=(Yo-os)*uc;let Ds=0;Ds=eu!==cc?-Ch*uo- -17:-uo*vl*cc+.5*cc;for(const Zo of Ta)for(const _l of Zo.positionedGlyphs)_l.x+=Fo,_l.y+=Ds})(Ft.positionedLines,Po,ko,vo,la,Hi,pn,Wn,Vr.length),Ft.top+=-vo*Wn,Ft.bottom=Ft.top+Wn,Ft.left+=-ko*la,Ft.right=Ft.left+la})(Rt,l,f,v,Ve,R,B,V,ce,Z,ve,Ne),!(function(Ft){for(const fr of Ft)if(fr.positionedGlyphs.length!==0)return!1;return!0})(ut)&&Rt}function vC(p){let l=.5,f=.5;switch(p){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(p){case"bottom":case"bottom-right":case"bottom-left":f=1;break;case"top":case"top-right":case"top-left":f=0}return{horizontalAlign:l,verticalAlign:f}}function nae(p,l,f){const v=l.getMaxScale()*gl,{maxImageWidth:S,maxImageHeight:k}=l.getMaxImageSize(p),R=Math.max(v,k*f);return{verticalLineContentWidth:Math.max(v,S*f),horizontalLineContentHeight:R}}function mF(p){switch(p){case"top":return 0;case"center":return .5;default:return 1}}function iae(p,l,f){return!(p===s.az.horizontal||!l&&!Jn(f)||l&&(Vn(f)||(v=f,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(v)))));var v}function aae(p,l,f,v,S,k){const R=k[p.fontStack],B=(function(Z,ie,ce,ve){if(Z&&Z.rect)return Z;const Se=ie[ce.fontStack],Ne=Se&&Se[ve];return Ne?{rect:null,metrics:Ne.metrics}:null})(R&&R[l],S,p,l);if(B===null)return null;let V;if(f)V=v.verticalLineContentWidth-p.scale*gl;else{const Z=mF(p.verticalAlign);V=(v.horizontalLineContentHeight-p.scale*gl)*Z}return{rect:B.rect,metrics:B.metrics,baselineOffset:V}}function oae(p,l,f,v,S){const k=S[p.imageName];if(!k)return null;const R=k.paddedRect,B=k.displaySize,V={width:B[0],height:B[1],left:1,top:-3,advance:l?B[1]:B[0]};let Z;if(l)Z=v.verticalLineContentWidth-B[1]*p.scale;else{const ie=mF(p.verticalAlign);Z=(v.horizontalLineContentHeight-B[1]*p.scale)*ie}return{rect:R,metrics:V,baselineOffset:Z,imageOffset:(l?B[0]:B[1])*p.scale-gl*f}}function sae(p,l,f,v){if(v===0)return;const S=p[f],k=(p[f].x+S.metrics.advance*S.scale)*v;for(let R=l;R<=f;R++)p[R].x-=k}function lae(p,l,f){const{horizontalAlign:v,verticalAlign:S}=vC(f),k=l[0]-p.displaySize[0]*v,R=l[1]-p.displaySize[1]*S;return{image:p,top:R,bottom:R+p.displaySize[1],left:k,right:k+p.displaySize[0]}}function yF(p){var l,f;let v=p.left,S=p.top,k=p.right-v,R=p.bottom-S;const B=(l=p.image.textFitWidth)!==null&&l!==void 0?l:"stretchOrShrink",V=(f=p.image.textFitHeight)!==null&&f!==void 0?f:"stretchOrShrink",Z=(p.image.content[2]-p.image.content[0])/(p.image.content[3]-p.image.content[1]);if(V==="proportional"){if(B==="stretchOnly"&&k/R<Z||B==="proportional"){const ie=Math.ceil(R*Z);v*=ie/k,k=ie}}else if(B==="proportional"&&V==="stretchOnly"&&Z!==0&&k/R>Z){const ie=Math.ceil(k/Z);S*=ie/R,R=ie}return{x1:v,y1:S,x2:v+k,y2:S+R}}function vF(p,l,f,v,S,k){const R=p.image;let B;if(R.content){const Ve=R.content,et=R.pixelRatio||1;B=[Ve[0]/et,Ve[1]/et,R.displaySize[0]-Ve[2]/et,R.displaySize[1]-Ve[3]/et]}const V=l.left*k,Z=l.right*k;let ie,ce,ve,Se;f==="width"||f==="both"?(Se=S[0]+V-v[3],ce=S[0]+Z+v[1]):(Se=S[0]+(V+Z-R.displaySize[0])/2,ce=Se+R.displaySize[0]);const Ne=l.top*k,ze=l.bottom*k;return f==="height"||f==="both"?(ie=S[1]+Ne-v[0],ve=S[1]+ze+v[2]):(ie=S[1]+(Ne+ze-R.displaySize[1])/2,ve=ie+R.displaySize[1]),{image:R,top:ie,right:ce,bottom:ve,left:Se,collisionPadding:B}}Pt("ImagePosition",yC),Pt("ImageAtlas",gF),s.az=void 0,(Hp=s.az||(s.az={}))[Hp.none=0]="none",Hp[Hp.horizontal=1]="horizontal",Hp[Hp.vertical=2]="vertical",Hp[Hp.horizontalOnly=3]="horizontalOnly";const Wd=128,Wp=32640;function _F(p,l){const{expression:f}=l;if(f.kind==="constant")return{kind:"constant",layoutSize:f.evaluate(new ki(p+1))};if(f.kind==="source")return{kind:"source"};{const{zoomStops:v,interpolationType:S}=f;let k=0;for(;k<v.length&&v[k]<=p;)k++;k=Math.max(0,k-1);let R=k;for(;R<v.length&&v[R]<p+1;)R++;R=Math.min(v.length-1,R);const B=v[k],V=v[R];return f.kind==="composite"?{kind:"composite",minZoom:B,maxZoom:V,interpolationType:S}:{kind:"camera",minZoom:B,maxZoom:V,minSize:f.evaluate(new ki(B)),maxSize:f.evaluate(new ki(V)),interpolationType:S}}}function _C(p,l,f){let v="never";const S=p.get(l);return S?v=S:p.get(f)&&(v="always"),v}const uae=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function x2(p,l,f,v,S,k,R,B,V,Z,ie,ce,ve){const Se=B?Math.min(Wp,Math.round(B[0])):0,Ne=B?Math.min(Wp,Math.round(B[1])):0;p.emplaceBack(l,f,Math.round(32*v),Math.round(32*S),k,R,(Se<<1)+(V?1:0),Ne,16*Z,16*ie,256*ce,256*ve)}function bC(p,l,f){p.emplaceBack(l.x,l.y,f),p.emplaceBack(l.x,l.y,f),p.emplaceBack(l.x,l.y,f),p.emplaceBack(l.x,l.y,f)}function cae(p){for(const l of p.sections)if(aa(l.text))return!0;return!1}class xC{constructor(l){this.layoutVertexArray=new Dt,this.indexArray=new xr,this.programConfigurations=l,this.segments=new gn,this.dynamicLayoutVertexArray=new Yt,this.opacityVertexArray=new Sr,this.hasVisibleVertices=!1,this.placedSymbolArray=new z}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,f,v,S){this.isEmpty()||(v&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Fie.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,f),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,Bie.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,uae,!0),this.opacityVertexBuffer.itemSize=1),(v||S)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Pt("SymbolBuffers",xC);class wC{constructor(l,f,v){this.layoutVertexArray=new l,this.layoutAttributes=f,this.indexArray=new v,this.segments=new gn,this.collisionVertexArray=new yr}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,zie.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Pt("CollisionBuffers",wC);class Ky{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((R=>R.id)),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const f=this.layers[0]._unevaluatedLayout._values;this.textSizeData=_F(this.zoom,f["text-size"]),this.iconSizeData=_F(this.zoom,f["icon-size"]);const v=this.layers[0].layout,S=v.get("symbol-sort-key"),k=v.get("symbol-z-order");this.canOverlap=_C(v,"text-overlap","text-allow-overlap")!=="never"||_C(v,"icon-overlap","icon-allow-overlap")!=="never"||v.get("text-ignore-placement")||v.get("icon-ignore-placement"),this.sortFeaturesByKey=k!=="viewport-y"&&!S.isConstant(),this.sortFeaturesByY=(k==="viewport-y"||k==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,v.get("symbol-placement")==="point"&&(this.writingModes=v.get("text-writing-mode").map((R=>s.az[R]))),this.stateDependentLayerIds=this.layers.filter((R=>R.isStateDependent())).map((R=>R.id)),this.sourceID=l.sourceID}createArrays(){this.text=new xC(new Hd(this.layers,this.zoom,(l=>/^text/.test(l)))),this.icon=new xC(new Hd(this.layers,this.zoom,(l=>/^icon/.test(l)))),this.glyphOffsetArray=new le,this.lineVertexArray=new fe,this.symbolInstances=new re,this.textAnchorOffsets=new Te}calculateGlyphDependencies(l,f,v,S,k){for(const R of l)if(f[R.codePointAt(0)]=!0,(v||S)&&k){const B=$_[R];B&&(f[B.codePointAt(0)]=!0)}}populate(l,f,v){const S=this.layers[0],k=S.layout,R=k.get("text-font"),B=k.get("text-field"),V=k.get("icon-image"),Z=(B.value.kind!=="constant"||B.value.value instanceof _n&&!B.value.value.isEmpty()||B.value.value.toString().length>0)&&(R.value.kind!=="constant"||R.value.value.length>0),ie=V.value.kind!=="constant"||!!V.value.value||Object.keys(V.parameters).length>0,ce=k.get("symbol-sort-key");if(this.features=[],!Z&&!ie)return;const ve=f.iconDependencies,Se=f.glyphDependencies,Ne=f.availableImages,ze=new ki(this.zoom);for(const{feature:Ve,id:et,index:Ct,sourceLayerIndex:nt}of l){const ut=S._featureFilter.needGeometry,Rt=Kf(Ve,ut);if(!S._featureFilter.filter(ze,Rt,v))continue;let Ft,fr;if(ut||(Rt.geometry=Zf(Ve)),Z){const Pr=S.getValueAndResolveTokens("text-field",Rt,v,Ne),Vr=_n.factory(Pr),pn=this.hasRTLText=this.hasRTLText||cae(Vr);(!pn||da.getRTLTextPluginStatus()==="unavailable"||pn&&da.isParsed())&&(Ft=Uie(Vr,S,Rt))}if(ie){const Pr=S.getValueAndResolveTokens("icon-image",Rt,v,Ne);fr=Pr instanceof wi?Pr:wi.fromString(Pr)}if(!Ft&&!fr)continue;const Or=this.sortFeaturesByKey?ce.evaluate(Rt,{},v):void 0;if(this.features.push({id:et,text:Ft,icon:fr,index:Ct,sourceLayerIndex:nt,geometry:Rt.geometry,properties:Ve.properties,type:j_.types[Ve.type],sortKey:Or}),fr&&(ve[fr.name]=!0),Ft){const Pr=R.evaluate(Rt,{},v).join(","),Vr=k.get("text-rotation-alignment")!=="viewport"&&k.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(s.az.vertical)>=0;for(const pn of Ft.sections)if(pn.image)ve[pn.image.name]=!0;else{const Gr=Ai(Ft.toString()),Rr=pn.fontStack||Pr,Er=Se[Rr]=Se[Rr]||{};this.calculateGlyphDependencies(pn.text,Er,Vr,this.allowVerticalPlacement,Gr)}}}k.get("symbol-placement")==="line"&&(this.features=(function(Ve){const et={},Ct={},nt=[];let ut=0;function Rt(Pr){nt.push(Ve[Pr]),ut++}function Ft(Pr,Vr,pn){const Gr=Ct[Pr];return delete Ct[Pr],Ct[Vr]=Gr,nt[Gr].geometry[0].pop(),nt[Gr].geometry[0]=nt[Gr].geometry[0].concat(pn[0]),Gr}function fr(Pr,Vr,pn){const Gr=et[Vr];return delete et[Vr],et[Pr]=Gr,nt[Gr].geometry[0].shift(),nt[Gr].geometry[0]=pn[0].concat(nt[Gr].geometry[0]),Gr}function Or(Pr,Vr,pn){const Gr=pn?Vr[0][Vr[0].length-1]:Vr[0][0];return`${Pr}:${Gr.x}:${Gr.y}`}for(let Pr=0;Pr<Ve.length;Pr++){const Vr=Ve[Pr],pn=Vr.geometry,Gr=Vr.text?Vr.text.toString():null;if(!Gr){Rt(Pr);continue}const Rr=Or(Gr,pn),Er=Or(Gr,pn,!0);if(Rr in Ct&&Er in et&&Ct[Rr]!==et[Er]){const Cn=fr(Rr,Er,pn),xn=Ft(Rr,Er,nt[Cn].geometry);delete et[Rr],delete Ct[Er],Ct[Or(Gr,nt[xn].geometry,!0)]=xn,nt[Cn].geometry=null}else Rr in Ct?Ft(Rr,Er,pn):Er in et?fr(Rr,Er,pn):(Rt(Pr),et[Rr]=ut-1,Ct[Er]=ut-1)}return nt.filter((Pr=>Pr.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Ve,et)=>Ve.sortKey-et.sortKey))}update(l,f,v){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,f,this.layers,{imagePositions:v}),this.icon.programConfigurations.updatePaintArrays(l,f,this.layers,{imagePositions:v}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,f){const v=this.lineVertexArray.length;if(l.segment!==void 0){let S=l.dist(f[l.segment+1]),k=l.dist(f[l.segment]);const R={};for(let B=l.segment+1;B<f.length;B++)R[B]={x:f[B].x,y:f[B].y,tileUnitDistanceFromAnchor:S},B<f.length-1&&(S+=f[B+1].dist(f[B]));for(let B=l.segment||0;B>=0;B--)R[B]={x:f[B].x,y:f[B].y,tileUnitDistanceFromAnchor:k},B>0&&(k+=f[B-1].dist(f[B]));for(let B=0;B<f.length;B++){const V=R[B];this.lineVertexArray.emplaceBack(V.x,V.y,V.tileUnitDistanceFromAnchor)}}return{lineStartIndex:v,lineLength:this.lineVertexArray.length-v}}addSymbols(l,f,v,S,k,R,B,V,Z,ie,ce,ve){const Se=l.indexArray,Ne=l.layoutVertexArray,ze=l.segments.prepareSegment(4*f.length,Ne,Se,this.canOverlap?R.sortKey:void 0),Ve=this.glyphOffsetArray.length,et=ze.vertexLength,Ct=this.allowVerticalPlacement&&B===s.az.vertical?Math.PI/2:0,nt=R.text&&R.text.sections;for(let ut=0;ut<f.length;ut++){const{tl:Rt,tr:Ft,bl:fr,br:Or,tex:Pr,pixelOffsetTL:Vr,pixelOffsetBR:pn,minFontScaleX:Gr,minFontScaleY:Rr,glyphOffset:Er,isSDF:Cn,sectionIndex:xn}=f[ut],kn=ze.vertexLength,vn=Er[1];x2(Ne,V.x,V.y,Rt.x,vn+Rt.y,Pr.x,Pr.y,v,Cn,Vr.x,Vr.y,Gr,Rr),x2(Ne,V.x,V.y,Ft.x,vn+Ft.y,Pr.x+Pr.w,Pr.y,v,Cn,pn.x,Vr.y,Gr,Rr),x2(Ne,V.x,V.y,fr.x,vn+fr.y,Pr.x,Pr.y+Pr.h,v,Cn,Vr.x,pn.y,Gr,Rr),x2(Ne,V.x,V.y,Or.x,vn+Or.y,Pr.x+Pr.w,Pr.y+Pr.h,v,Cn,pn.x,pn.y,Gr,Rr),bC(l.dynamicLayoutVertexArray,V,Ct),Se.emplaceBack(kn,kn+2,kn+1),Se.emplaceBack(kn+1,kn+2,kn+3),ze.vertexLength+=4,ze.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Er[0]),ut!==f.length-1&&xn===f[ut+1].sectionIndex||l.programConfigurations.populatePaintArrays(Ne.length,R,R.index,{imagePositions:{},canonical:ve,formattedSection:nt&&nt[xn]})}l.placedSymbolArray.emplaceBack(V.x,V.y,Ve,this.glyphOffsetArray.length-Ve,et,Z,ie,V.segment,v?v[0]:0,v?v[1]:0,S[0],S[1],B,0,!1,0,ce)}_addCollisionDebugVertex(l,f,v,S,k,R){return f.emplaceBack(0,0),l.emplaceBack(v.x,v.y,S,k,Math.round(R.x),Math.round(R.y))}addCollisionDebugVertices(l,f,v,S,k,R,B){const V=k.segments.prepareSegment(4,k.layoutVertexArray,k.indexArray),Z=V.vertexLength,ie=k.layoutVertexArray,ce=k.collisionVertexArray,ve=B.anchorX,Se=B.anchorY;this._addCollisionDebugVertex(ie,ce,R,ve,Se,new c(l,f)),this._addCollisionDebugVertex(ie,ce,R,ve,Se,new c(v,f)),this._addCollisionDebugVertex(ie,ce,R,ve,Se,new c(v,S)),this._addCollisionDebugVertex(ie,ce,R,ve,Se,new c(l,S)),V.vertexLength+=4;const Ne=k.indexArray;Ne.emplaceBack(Z,Z+1),Ne.emplaceBack(Z+1,Z+2),Ne.emplaceBack(Z+2,Z+3),Ne.emplaceBack(Z+3,Z),V.primitiveLength+=4}addDebugCollisionBoxes(l,f,v,S){for(let k=l;k<f;k++){const R=this.collisionBoxArray.get(k);this.addCollisionDebugVertices(R.x1,R.y1,R.x2,R.y2,S?this.textCollisionBox:this.iconCollisionBox,R.anchorPoint,v)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new wC(dr,oF.members,an),this.iconCollisionBox=new wC(dr,oF.members,an);for(let l=0;l<this.symbolInstances.length;l++){const f=this.symbolInstances.get(l);this.addDebugCollisionBoxes(f.textBoxStartIndex,f.textBoxEndIndex,f,!0),this.addDebugCollisionBoxes(f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f,!0),this.addDebugCollisionBoxes(f.iconBoxStartIndex,f.iconBoxEndIndex,f,!1),this.addDebugCollisionBoxes(f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f,!1)}}_deserializeCollisionBoxesForSymbol(l,f,v,S,k,R,B,V,Z){const ie={};for(let ce=f;ce<v;ce++){const ve=l.get(ce);ie.textBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},ie.textFeatureIndex=ve.featureIndex;break}for(let ce=S;ce<k;ce++){const ve=l.get(ce);ie.verticalTextBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},ie.verticalTextFeatureIndex=ve.featureIndex;break}for(let ce=R;ce<B;ce++){const ve=l.get(ce);ie.iconBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},ie.iconFeatureIndex=ve.featureIndex;break}for(let ce=V;ce<Z;ce++){const ve=l.get(ce);ie.verticalIconBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},ie.verticalIconFeatureIndex=ve.featureIndex;break}return ie}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let f=0;f<this.symbolInstances.length;f++){const v=this.symbolInstances.get(f);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,v.textBoxStartIndex,v.textBoxEndIndex,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v.iconBoxStartIndex,v.iconBoxEndIndex,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,f){const v=l.placedSymbolArray.get(f),S=v.vertexStartIndex+4*v.numGlyphs;for(let k=v.vertexStartIndex;k<S;k+=4)l.indexArray.emplaceBack(k,k+2,k+1),l.indexArray.emplaceBack(k+1,k+2,k+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const f=Math.sin(l),v=Math.cos(l),S=[],k=[],R=[];for(let B=0;B<this.symbolInstances.length;++B){R.push(B);const V=this.symbolInstances.get(B);S.push(0|Math.round(f*V.anchorX+v*V.anchorY)),k.push(V.featureIndex)}return R.sort(((B,V)=>S[B]-S[V]||k[V]-k[B])),R}addToSortKeyRanges(l,f){const v=this.sortKeyRanges[this.sortKeyRanges.length-1];v&&v.sortKey===f?v.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:f,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const f of this.symbolInstanceIndexes){const v=this.symbolInstances.get(f);this.featureSortOrder.push(v.featureIndex),[v.rightJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.leftJustifiedTextSymbolIndex].forEach(((S,k,R)=>{S>=0&&R.indexOf(S)===k&&this.addIndicesForPlacedSymbol(this.text,S)})),v.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,v.verticalPlacedTextSymbolIndex),v.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.placedIconSymbolIndex),v.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let bF,xF;Pt("SymbolBucket",Ky,{omit:["layers","collisionBoxArray","features","compareText"]}),Ky.MAX_GLYPHS=65535,Ky.addDynamicAttributes=bC;var SC={get paint(){return xF=xF||new $a({"icon-opacity":new Sn(Mt.paint_symbol["icon-opacity"]),"icon-color":new Sn(Mt.paint_symbol["icon-color"]),"icon-halo-color":new Sn(Mt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Sn(Mt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Sn(Mt.paint_symbol["icon-halo-blur"]),"icon-translate":new Tn(Mt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Tn(Mt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Sn(Mt.paint_symbol["text-opacity"]),"text-color":new Sn(Mt.paint_symbol["text-color"],{runtimeType:ei,getOverride:p=>p.textColor,hasOverride:p=>!!p.textColor}),"text-halo-color":new Sn(Mt.paint_symbol["text-halo-color"]),"text-halo-width":new Sn(Mt.paint_symbol["text-halo-width"]),"text-halo-blur":new Sn(Mt.paint_symbol["text-halo-blur"]),"text-translate":new Tn(Mt.paint_symbol["text-translate"]),"text-translate-anchor":new Tn(Mt.paint_symbol["text-translate-anchor"])})},get layout(){return bF=bF||new $a({"symbol-placement":new Tn(Mt.layout_symbol["symbol-placement"]),"symbol-spacing":new Tn(Mt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Tn(Mt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Sn(Mt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Tn(Mt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Tn(Mt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Tn(Mt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Tn(Mt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Tn(Mt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Tn(Mt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Sn(Mt.layout_symbol["icon-size"]),"icon-text-fit":new Tn(Mt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Tn(Mt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Sn(Mt.layout_symbol["icon-image"]),"icon-rotate":new Sn(Mt.layout_symbol["icon-rotate"]),"icon-padding":new Sn(Mt.layout_symbol["icon-padding"]),"icon-keep-upright":new Tn(Mt.layout_symbol["icon-keep-upright"]),"icon-offset":new Sn(Mt.layout_symbol["icon-offset"]),"icon-anchor":new Sn(Mt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Tn(Mt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Tn(Mt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Tn(Mt.layout_symbol["text-rotation-alignment"]),"text-field":new Sn(Mt.layout_symbol["text-field"]),"text-font":new Sn(Mt.layout_symbol["text-font"]),"text-size":new Sn(Mt.layout_symbol["text-size"]),"text-max-width":new Sn(Mt.layout_symbol["text-max-width"]),"text-line-height":new Tn(Mt.layout_symbol["text-line-height"]),"text-letter-spacing":new Sn(Mt.layout_symbol["text-letter-spacing"]),"text-justify":new Sn(Mt.layout_symbol["text-justify"]),"text-radial-offset":new Sn(Mt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Tn(Mt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Sn(Mt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Sn(Mt.layout_symbol["text-anchor"]),"text-max-angle":new Tn(Mt.layout_symbol["text-max-angle"]),"text-writing-mode":new Tn(Mt.layout_symbol["text-writing-mode"]),"text-rotate":new Sn(Mt.layout_symbol["text-rotate"]),"text-padding":new Tn(Mt.layout_symbol["text-padding"]),"text-keep-upright":new Tn(Mt.layout_symbol["text-keep-upright"]),"text-transform":new Sn(Mt.layout_symbol["text-transform"]),"text-offset":new Sn(Mt.layout_symbol["text-offset"]),"text-allow-overlap":new Tn(Mt.layout_symbol["text-allow-overlap"]),"text-overlap":new Tn(Mt.layout_symbol["text-overlap"]),"text-ignore-placement":new Tn(Mt.layout_symbol["text-ignore-placement"]),"text-optional":new Tn(Mt.layout_symbol["text-optional"])})}};class wF{constructor(l){if(l.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=l.property.overrides?l.property.overrides.runtimeType:Ci,this.defaultValue=l}evaluate(l){if(l.formattedSection){const f=this.defaultValue.property.overrides;if(f&&f.hasOverride(l.formattedSection))return f.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pt("FormatSectionOverride",wF,{omit:["defaultValue"]});class w2 extends eo{constructor(l,f){super(l,SC,f)}recalculate(l,f){if(super.recalculate(l,f),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const v=this.layout.get("text-writing-mode");if(v){const S=[];for(const k of v)S.indexOf(k)<0&&S.push(k);this.layout._values["text-writing-mode"]=S}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(l,f,v,S){const k=this.layout.get(l).evaluate(f,{},v,S),R=this._unevaluatedLayout._values[l];return R.isDataDriven()||Vc(R.value)||!k?k:(function(B,V){return V.replace(/{([^{}]+)}/g,((Z,ie)=>B&&ie in B?String(B[ie]):""))})(f.properties,k)}createBucket(l){return new Ky(l)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const l of SC.paint.overridableProperties){if(!w2.hasPaintOverride(this.layout,l))continue;const f=this.paint.get(l),v=new wF(f),S=new Od(v,f.property.specification);let k=null;k=f.value.kind==="constant"||f.value.kind==="source"?new Np("source",S):new Hg("composite",S,f.value.zoomStops),this.paint._values[l]=new qi(f.property,k,f.parameters)}}_handleOverridablePaintPropertyUpdate(l,f,v){return!(!this.layout||f.isDataDriven()||v.isDataDriven())&&w2.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,f){const v=l.get("text-field"),S=SC.paint.properties[f];let k=!1;const R=B=>{for(const V of B)if(S.overrides&&S.overrides.hasOverride(V))return void(k=!0)};if(v.value.kind==="constant"&&v.value.value instanceof _n)R(v.value.value.sections);else if(v.value.kind==="source"||v.value.kind==="composite"){const B=Z=>{k||(Z instanceof oa&&Mi(Z.value)===Gi?R(Z.value.sections):Z instanceof Xs?R(Z.sections):Z.eachChild(B))},V=v.value;V._styleExpression&&B(V._styleExpression.expression)}return k}}let SF;var hae={get paint(){return SF=SF||new $a({"background-color":new Tn(Mt.paint_background["background-color"]),"background-pattern":new Sa(Mt.paint_background["background-pattern"]),"background-opacity":new Tn(Mt.paint_background["background-opacity"])})}};class fae extends eo{constructor(l,f){super(l,hae,f)}}class dae extends eo{constructor(l,f){super(l,{},f),this.onAdd=v=>{this.implementation.onAdd&&this.implementation.onAdd(v,v.painter.context.gl)},this.onRemove=v=>{this.implementation.onRemove&&this.implementation.onRemove(v,v.painter.context.gl)},this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class pae{constructor(l){this._methodToThrottle=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const gae={once:!0},EC=63710088e-1;class Gp{constructor(l,f){if(isNaN(l)||isNaN(f))throw new Error(`Invalid LngLat object: (${l}, ${f})`);if(this.lng=+l,this.lat=+f,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Gp(Xe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){const f=Math.PI/180,v=this.lat*f,S=l.lat*f,k=Math.sin(v)*Math.sin(S)+Math.cos(v)*Math.cos(S)*Math.cos((l.lng-this.lng)*f);return EC*Math.acos(Math.min(k,1))}static convert(l){if(l instanceof Gp)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new Gp(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new Gp(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const EF=2*Math.PI*EC;function TF(p){return EF*Math.cos(p*Math.PI/180)}function CF(p){return(180+p)/360}function AF(p){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+p*Math.PI/360)))/360}function IF(p,l){return p/TF(l)}function PF(p){return 360*p-180}function S2(p){return 360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90}function kF(p,l){return p*TF(S2(l))}class q_{constructor(l,f,v=0){this.x=+l,this.y=+f,this.z=+v}static fromLngLat(l,f=0){const v=Gp.convert(l);return new q_(CF(v.lng),AF(v.lat),IF(f,v.lat))}toLngLat(){return new Gp(PF(this.x),S2(this.y))}toAltitude(){return kF(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/EF*(l=S2(this.y),1/Math.cos(l*Math.PI/180));var l}}function RF(p,l,f){var v=2*Math.PI*6378137/256/Math.pow(2,f);return[p*v-2*Math.PI*6378137/2,l*v-2*Math.PI*6378137/2]}class TC{constructor(l,f,v){if(!(function(S,k,R){return!(S<0||S>25||R<0||R>=Math.pow(2,S)||k<0||k>=Math.pow(2,S))})(l,f,v))throw new Error(`x=${f}, y=${v}, z=${l} outside of bounds. 0<=x<${Math.pow(2,l)}, 0<=y<${Math.pow(2,l)} 0<=z<=25 `);this.z=l,this.x=f,this.y=v,this.key=Jy(0,l,l,f,v)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,f,v){const S=(function(R,B,V){var Z=RF(256*R,256*(B=Math.pow(2,V)-B-1),V),ie=RF(256*(R+1),256*(B+1),V);return Z[0]+","+Z[1]+","+ie[0]+","+ie[1]})(this.x,this.y,this.z),k=(function(R,B,V){let Z,ie="";for(let ce=R;ce>0;ce--)Z=1<<ce-1,ie+=(B&Z?1:0)+(V&Z?2:0);return ie})(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(v==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,f>1?"@2x":"").replace(/{quadkey}/g,k).replace(/{bbox-epsg-3857}/g,S)}isChildOf(l){const f=this.z-l.z;return f>0&&l.x===this.x>>f&&l.y===this.y>>f}getTilePoint(l){const f=Math.pow(2,this.z);return new c((l.x*f-this.x)*xe,(l.y*f-this.y)*xe)}toString(){return`${this.z}/${this.x}/${this.y}`}}class MF{constructor(l,f){this.wrap=l,this.canonical=f,this.key=Jy(l,f.z,f.z,f.x,f.y)}}class Xc{constructor(l,f,v,S,k){if(this.terrainRttPosMatrix32f=null,l<v)throw new Error(`overscaledZ should be >= z; overscaledZ = ${l}; z = ${v}`);this.overscaledZ=l,this.wrap=f,this.canonical=new TC(v,+S,+k),this.key=Jy(f,l,v,S,k)}clone(){return new Xc(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-l;return l>this.canonical.z?new Xc(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Xc(l,this.wrap,l,this.canonical.x>>f,this.canonical.y>>f)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(l,f){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const v=this.canonical.z-l;return l>this.canonical.z?Jy(this.wrap*+f,l,this.canonical.z,this.canonical.x,this.canonical.y):Jy(this.wrap*+f,l,l,this.canonical.x>>v,this.canonical.y>>v)}isChildOf(l){if(l.wrap!==this.wrap||this.overscaledZ-l.overscaledZ<=0)return!1;if(l.overscaledZ===0)return this.overscaledZ>0;const f=this.canonical.z-l.canonical.z;return!(f<0)&&l.canonical.x===this.canonical.x>>f&&l.canonical.y===this.canonical.y>>f}children(l){if(this.overscaledZ>=l)return[new Xc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const f=this.canonical.z+1,v=2*this.canonical.x,S=2*this.canonical.y;return[new Xc(f,this.wrap,f,v,S),new Xc(f,this.wrap,f,v+1,S),new Xc(f,this.wrap,f,v,S+1),new Xc(f,this.wrap,f,v+1,S+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new Xc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new Xc(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new MF(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(l){return this.canonical.getTilePoint(new q_(l.x-this.wrap,l.y))}}function Jy(p,l,f,v,S){(p*=2)<0&&(p=-1*p-1);const k=1<<f;return(k*k*p+k*S+v).toString(36)+f.toString(36)+l.toString(36)}function CC(p,l){return l?p.properties[l]:p.id}function mae(p,l){const f={id:p.id};if(l.removeAllProperties&&(delete p.removeProperties,delete p.addOrUpdateProperties,delete l.removeProperties),l.removeProperties)for(const v of l.removeProperties){const S=p.addOrUpdateProperties.findIndex((k=>k.key===v));S>-1&&p.addOrUpdateProperties.splice(S,1)}return(p.removeAllProperties||l.removeAllProperties)&&(f.removeAllProperties=!0),(p.removeProperties||l.removeProperties)&&(f.removeProperties=[...p.removeProperties||[],...l.removeProperties||[]]),(p.addOrUpdateProperties||l.addOrUpdateProperties)&&(f.addOrUpdateProperties=[...p.addOrUpdateProperties||[],...l.addOrUpdateProperties||[]]),(p.newGeometry||l.newGeometry)&&(f.newGeometry=l.newGeometry||p.newGeometry),f}function DF(p){var l,f;if(!p)return{};const v={};return v.removeAll=p.removeAll,v.remove=new Set(p.remove||[]),v.add=new Map((l=p.add)===null||l===void 0?void 0:l.map((S=>[S.id,S]))),v.update=new Map((f=p.update)===null||f===void 0?void 0:f.map((S=>[S.id,S]))),v}Pt("CanonicalTileID",TC),Pt("OverscaledTileID",Xc,{omit:["terrainRttPosMatrix32f"]});class nm{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(l){return this.minX=Math.min(this.minX,l.x),this.minY=Math.min(this.minY,l.y),this.maxX=Math.max(this.maxX,l.x),this.maxY=Math.max(this.maxY,l.y),this}expandBy(l){return this.minX-=l,this.minY-=l,this.maxX+=l,this.maxY+=l,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(l){return this.expandBy(-l)}map(l){const f=new nm;return f.extend(l(new c(this.minX,this.minY))),f.extend(l(new c(this.maxX,this.minY))),f.extend(l(new c(this.minX,this.maxY))),f.extend(l(new c(this.maxX,this.maxY))),f}static fromPoints(l){const f=new nm;for(const v of l)f.extend(v);return f}contains(l){return l.x>=this.minX&&l.x<=this.maxX&&l.y>=this.minY&&l.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(l){return!this.empty()&&!l.empty()&&l.minX>=this.minX&&l.maxX<=this.maxX&&l.minY>=this.minY&&l.maxY<=this.maxY}intersects(l){return!this.empty()&&!l.empty()&&l.minX<=this.maxX&&l.maxX>=this.minX&&l.minY<=this.maxY&&l.maxY>=this.minY}}class OF{constructor(l){this._stringToNumber={},this._numberToString=[];for(let f=0;f<l.length;f++){const v=l[f];this._stringToNumber[v]=f,this._numberToString[f]=v}}encode(l){return this._stringToNumber[l]}decode(l){if(l>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${l} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[l]}}class NF{constructor(l,f,v,S,k){this.type="Feature",this._vectorTileFeature=l,this._x=v,this._y=S,this._z=f,this.properties=l.properties,this.id=k}projectPoint(l,f,v,S){return[360*(l.x+f)/S-180,360/Math.PI*Math.atan(Math.exp((1-2*(l.y+v)/S)*Math.PI))-90]}projectLine(l,f,v,S){return l.map((k=>this.projectPoint(k,f,v,S)))}get geometry(){if(this._geometry)return this._geometry;const l=this._vectorTileFeature,f=l.extent*Math.pow(2,this._z),v=l.extent*this._x,S=l.extent*this._y,k=l.loadGeometry();switch(l.type){case 1:{const R=[];for(const V of k)R.push(V[0]);const B=this.projectLine(R,v,S,f);this._geometry=R.length===1?{type:"Point",coordinates:B[0]}:{type:"MultiPoint",coordinates:B};break}case 2:{const R=k.map((B=>this.projectLine(B,v,S,f)));this._geometry=R.length===1?{type:"LineString",coordinates:R[0]}:{type:"MultiLineString",coordinates:R};break}case 3:{const R=Z6(k),B=[];for(const V of R)B.push(V.map((Z=>this.projectLine(Z,v,S,f))));this._geometry=B.length===1?{type:"Polygon",coordinates:B[0]}:{type:"MultiPolygon",coordinates:B};break}default:throw new Error(`unknown feature type: ${l.type}`)}return this._geometry}set geometry(l){this._geometry=l}toJSON(){const l={geometry:this.geometry};for(const f in this)f!=="_geometry"&&f!=="_vectorTileFeature"&&f!=="_x"&&f!=="_y"&&f!=="_z"&&(l[f]=this[f]);return l}}class Qy{_name;dataBuffer;nullabilityBuffer;_size;constructor(l,f,v){this._name=l,this.dataBuffer=f,typeof v=="number"?this._size=v:(this.nullabilityBuffer=v,this._size=v.size())}getValue(l){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(l)?null:this.getValueFromBuffer(l)}has(l){return this.nullabilityBuffer&&this.nullabilityBuffer.get(l)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class E2 extends Qy{}class AC extends E2{getValueFromBuffer(l){return this.dataBuffer[l]}}class IC extends E2{getValueFromBuffer(l){return this.dataBuffer[l]}}class LF extends Qy{delta;constructor(l,f,v,S){super(l,f,S),this.delta=v}}class PC extends LF{constructor(l,f,v,S){super(l,Int32Array.of(f),v,S)}getValueFromBuffer(l){return this.dataBuffer[0]+l*this.delta}}class kC extends Qy{constructor(l,f,v){super(l,Int32Array.of(f),v)}getValueFromBuffer(l){return this.dataBuffer[0]}}class yae{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(l,f,v,S,k=4096){this._name=l,this._geometryVector=f,this._idVector=v,this._propertyVectors=S,this._extent=k}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(l){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((f=>[f.name,f])))),this.propertyVectorsMap.get(l)}*[Symbol.iterator](){const l=this.geometryVector[Symbol.iterator]();let f=0;for(;f<this.numFeatures;){let v;this.idVector&&(v=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(f)):this.idVector.getValue(f));const S=l?.next().value,k={};for(const R of this.propertyVectors){if(!R)continue;const B=R.name,V=R.getValue(f);V!==null&&(k[B]=V)}f++,yield{id:v,geometry:S,properties:k}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const l=[],f=this.geometryVector.getGeometries();for(let v=0;v<this.numFeatures;v++){let S;this.idVector&&(S=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(v)):this.idVector.getValue(v));const k={coordinates:f[v],type:this.geometryVector.geometryType(v)},R={};for(const B of this.propertyVectors){if(!B)continue;const V=B.name,Z=B.getValue(v);Z!==null&&(R[V]=Z)}l.push({id:S,geometry:k,properties:R})}return l}containsMaxSaveIntegerValues(l){return l instanceof AC||l instanceof kC&&l instanceof PC||l instanceof IC}}class vae{value;constructor(l){this.value=l}get(){return this.value}set(l){this.value=l}increment(){return this.value++}add(l){this.value+=l}}var Zi,Gd,Kl,lf,im,Ec,ml,yl,FF,Yc;function Dl(p,l,f){const v=new Int32Array(f);let S=0,k=l.get();for(let R=0;R<v.length;R++){let B=p[k++],V=127&B;B<128||(B=p[k++],V|=(127&B)<<7,B<128||(B=p[k++],V|=(127&B)<<14,B<128||(B=p[k++],V|=(127&B)<<21,B<128||(B=p[k++],V|=(15&B)<<28)))),v[S++]=V}return l.set(k),v}function T2(p,l,f){const v=new BigInt64Array(f);for(let S=0;S<v.length;S++)v[S]=bae(p,l);return v}function _ae(p,l){let f,v;return v=p[l.get()],l.increment(),f=127&v,v<128?f:(v=p[l.get()],l.increment(),f|=(127&v)<<7,v<128?f:(v=p[l.get()],l.increment(),f|=(127&v)<<14,v<128?f:(v=p[l.get()],l.increment(),f|=(127&v)<<21,v<128?f:(v=p[l.get()],f|=(15&v)<<28,(function(S,k,R){let B,V;if(V=k[R.get()],R.increment(),B=(112&V)>>4,V<128||(V=k[R.get()],R.increment(),B|=(127&V)<<3,V<128)||(V=k[R.get()],R.increment(),B|=(127&V)<<10,V<128)||(V=k[R.get()],R.increment(),B|=(127&V)<<17,V<128)||(V=k[R.get()],R.increment(),B|=(127&V)<<24,V<128)||(V=k[R.get()],R.increment(),B|=(1&V)<<31,V<128))return 4294967296*B+(S>>>0);throw new Error("Expected varint not more than 10 bytes")})(f,p,l)))))}function BF(p,l,f,v){throw new Error("FastPFor is not implemented yet.")}function am(p){return p>>>1^-(1&p)}function ev(p){return p>>1n^-(1n&p)}function bae(p,l){let f=0n,v=0,S=l.get();for(;S<p.length;){const k=p[S++];if(f|=BigInt(127&k)<<BigInt(v),!(128&k))break;if(v+=7,v>=64)throw new Error("Varint too long")}return l.set(S),f}function zF(p,l,f){const v=new Int32Array(f);let S=0;for(let k=0;k<l;k++){const R=p[k];v.fill(p[k+l],S,S+R),S+=R}return v}function jF(p,l,f){const v=new BigInt64Array(f);let S=0;for(let k=0;k<l;k++){const R=Number(p[k]);v.fill(p[k+l],S,S+R),S+=R}return v}function UF(p,l,f){const v=new Float64Array(f);let S=0;for(let k=0;k<l;k++){const R=p[k];v.fill(p[k+l],S,S+R),S+=R}return v}function RC(p){const l=p.length/4*4;let f=1;if(l>=4)for(let v=p[0];f<l-4;f+=4)v=p[f]+=v,v=p[f+1]+=v,v=p[f+2]+=v,v=p[f+3]+=v;for(;f!=p.length;)p[f]+=p[f-1],++f}function VF(p){p[0]=p[0]>>>1^-(1&p[0]),p[1]=p[1]>>>1^-(1&p[1]);const l=p.length/4*4;let f=2;if(l>=4)for(;f<l-4;f+=4){const v=p[f],S=p[f+1],k=p[f+2],R=p[f+3];p[f]=(v>>>1^-(1&v))+p[f-2],p[f+1]=(S>>>1^-(1&S))+p[f-1],p[f+2]=(k>>>1^-(1&k))+p[f],p[f+3]=(R>>>1^-(1&R))+p[f+1]}for(;f!=p.length;f+=2)p[f]=(p[f]>>>1^-(1&p[f]))+p[f-2],p[f+1]=(p[f+1]>>>1^-(1&p[f+1]))+p[f-1]}(function(p){p.NONE="NONE",p.DELTA="DELTA",p.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",p.RLE="RLE",p.MORTON="MORTON",p.PDE="PDE"})(Zi||(Zi={})),(function(p){p.NONE="NONE",p.FAST_PFOR="FAST_PFOR",p.VARINT="VARINT",p.ALP="ALP"})(Gd||(Gd={})),(function(p){p.PRESENT="PRESENT",p.DATA="DATA",p.OFFSET="OFFSET",p.LENGTH="LENGTH"})(Kl||(Kl={}));class MC{_dictionaryType;_offsetType;_lengthType;constructor(l,f,v){this._dictionaryType=l,this._offsetType=f,this._lengthType=v}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function ju(p,l){const f=(function(v,S){const k=v[S.get()],R=Object.values(Kl)[k>>4];let B=null;switch(R){case Kl.DATA:B=new MC(Object.values(lf)[15&k]);break;case Kl.OFFSET:B=new MC(null,Object.values(im)[15&k]);break;case Kl.LENGTH:B=new MC(null,null,Object.values(Ec)[15&k])}S.increment();const V=v[S.get()],Z=Object.values(Zi)[V>>5],ie=Object.values(Zi)[V>>2&7],ce=Object.values(Gd)[3&V];S.increment();const ve=Dl(v,S,2),Se=ve[0];return{physicalStreamType:R,logicalStreamType:B,logicalLevelTechnique1:Z,logicalLevelTechnique2:ie,physicalLevelTechnique:ce,numValues:Se,byteLength:ve[1],decompressedCount:Se}})(p,l);return f.logicalLevelTechnique1===Zi.MORTON?(function(v,S,k){const R=Dl(S,k,2);return{physicalStreamType:v.physicalStreamType,logicalStreamType:v.logicalStreamType,logicalLevelTechnique1:v.logicalLevelTechnique1,logicalLevelTechnique2:v.logicalLevelTechnique2,physicalLevelTechnique:v.physicalLevelTechnique,numValues:v.numValues,byteLength:v.byteLength,decompressedCount:v.decompressedCount,numBits:R[0],coordinateShift:R[1]}})(f,p,l):Zi.RLE!==f.logicalLevelTechnique1&&Zi.RLE!==f.logicalLevelTechnique2||Gd.NONE===f.physicalLevelTechnique?f:(function(v,S,k){const R=Dl(S,k,2);return{physicalStreamType:v.physicalStreamType,logicalStreamType:v.logicalStreamType,logicalLevelTechnique1:v.logicalLevelTechnique1,logicalLevelTechnique2:v.logicalLevelTechnique2,physicalLevelTechnique:v.physicalLevelTechnique,numValues:v.numValues,byteLength:v.byteLength,decompressedCount:R[1],runs:R[0],numRleValues:R[1]}})(f,p,l)}(function(p){p.NONE="NONE",p.SINGLE="SINGLE",p.SHARED="SHARED",p.VERTEX="VERTEX",p.MORTON="MORTON",p.FSST="FSST"})(lf||(lf={})),(function(p){p.VERTEX="VERTEX",p.INDEX="INDEX",p.STRING="STRING",p.KEY="KEY"})(im||(im={})),(function(p){p.VAR_BINARY="VAR_BINARY",p.GEOMETRIES="GEOMETRIES",p.PARTS="PARTS",p.RINGS="RINGS",p.TRIANGLES="TRIANGLES",p.SYMBOL="SYMBOL",p.DICTIONARY="DICTIONARY"})(Ec||(Ec={})),(function(p){p[p.FLAT=0]="FLAT",p[p.CONST=1]="CONST",p[p.SEQUENCE=2]="SEQUENCE",p[p.DICTIONARY=3]="DICTIONARY",p[p.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(ml||(ml={}));class uf{values;_size;constructor(l,f){this.values=l,this._size=f}get(l){const f=Math.floor(l/8);return(this.values[f]>>l%8&1)==1}set(l,f){const v=Math.floor(l/8);this.values[v]=this.values[v]|(f?1:0)<<l%8}getInt(l){const f=Math.floor(l/8);return this.values[f]>>l%8&1}size(){return this._size}getBuffer(){return this.values}}function Uu(p,l,f,v,S){return(function(k,R,B){switch(R.logicalLevelTechnique1){case Zi.DELTA:return R.logicalLevelTechnique2===Zi.RLE?(function(V,Z,ie){const ce=new Int32Array(ie);let ve=0,Se=0;for(let Ne=0;Ne<Z;Ne++){const ze=V[Ne],Ve=am(V[Ne+Z]);for(let et=0;et<ze;et++)Se+=Ve,ce[ve++]=Se}return ce})(k,R.runs,R.numRleValues):((function(V){V[0]=V[0]>>>1^-(1&V[0]);const Z=V.length/4*4;let ie=1;if(Z>=4)for(;ie<Z-4;ie+=4){const ce=V[ie],ve=V[ie+1],Se=V[ie+2],Ne=V[ie+3];V[ie]=(ce>>>1^-(1&ce))+V[ie-1],V[ie+1]=(ve>>>1^-(1&ve))+V[ie],V[ie+2]=(Se>>>1^-(1&Se))+V[ie+1],V[ie+3]=(Ne>>>1^-(1&Ne))+V[ie+2]}for(;ie!=V.length;++ie)V[ie]=(V[ie]>>>1^-(1&V[ie]))+V[ie-1]})(k),k);case Zi.RLE:return(function(V,Z,ie){return ie?(function(ce,ve,Se){const Ne=new Int32Array(Se);let ze=0;for(let Ve=0;Ve<ve;Ve++){const et=ce[Ve];let Ct=ce[Ve+ve];Ct=Ct>>>1^-(1&Ct),Ne.fill(Ct,ze,ze+et),ze+=et}return Ne})(V,Z.runs,Z.numRleValues):zF(V,Z.runs,Z.numRleValues)})(k,R,B);case Zi.MORTON:return RC(k),k;case Zi.COMPONENTWISE_DELTA:return VF(k),k;case Zi.NONE:return B&&(function(V){for(let Z=0;Z<V.length;Z++){const ie=V[Z];V[Z]=ie>>>1^-(1&ie)}})(k),k;default:throw new Error(`The specified Logical level technique is not supported: ${R.logicalLevelTechnique1}`)}})(C2(p,l,f),f,v)}function Xp(p,l,f){return(function(v,S){if(S.logicalLevelTechnique1===Zi.DELTA&&S.logicalLevelTechnique2===Zi.NONE)return(function(R){const B=new Int32Array(R.length+1);B[0]=0,B[1]=am(R[0]);let V=B[1],Z=2;for(;Z!=B.length;++Z){const ie=R[Z-1];V+=ie>>>1^-(1&ie),B[Z]=B[Z-1]+V}return B})(v);if(S.logicalLevelTechnique1===Zi.RLE&&S.logicalLevelTechnique2===Zi.NONE)return(function(R,B,V){const Z=new Int32Array(V+1);Z[0]=0;let ie=1,ce=Z[0];for(let ve=0;ve<B;ve++){const Se=R[ve],Ne=R[ve+B];for(let ze=ie;ze<ie+Se;ze++)Z[ze]=Ne+ce,ce=Z[ze];ie+=Se}return Z})(v,S.runs,S.numRleValues);if(S.logicalLevelTechnique1===Zi.NONE&&S.logicalLevelTechnique2===Zi.NONE){(function(R){let B=0;for(let V=0;V<R.length;V++)R[V]+=B,B=R[V]})(v);const k=new Int32Array(S.numValues+1);return k[0]=0,k.set(v,1),k}if(S.logicalLevelTechnique1===Zi.DELTA&&S.logicalLevelTechnique2===Zi.RLE){const k=(function(R,B,V){const Z=new Int32Array(V+1);Z[0]=0;let ie=1,ce=Z[0];for(let ve=0;ve<B;ve++){const Se=R[ve];let Ne=R[ve+B];Ne=Ne>>>1^-(1&Ne);for(let ze=ie;ze<ie+Se;ze++)Z[ze]=Ne+ce,ce=Z[ze];ie+=Se}return Z})(v,S.runs,S.numRleValues);return RC(k),k}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(C2(p,l,f),f)}function C2(p,l,f){const v=f.physicalLevelTechnique;if(v===Gd.FAST_PFOR)return BF();if(v===Gd.VARINT)return Dl(p,l,f.numValues);if(v===Gd.NONE){const S=l.get();l.add(f.byteLength);const k=p.subarray(S,l.get());return new Int32Array(k)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function DC(p,l,f,v){const S=C2(p,l,f);if(S.length===1){const k=S[0];return v?am(k):k}return v?(function(k){return am(k[1])})(S):(function(k){return k[1]})(S)}function $F(p,l,f){return(function(v){if(v.length==2){const S=am(v[1]);return[S,S]}return[am(v[2]),am(v[3])]})(C2(p,l,f))}function qF(p,l,f){return(function(v){if(v.length==2){const S=ev(v[1]);return[S,S]}return[ev(v[2]),ev(v[3])]})(T2(p,l,f.numValues))}function HF(p,l,f,v){return(function(S,k,R){switch(k.logicalLevelTechnique1){case Zi.DELTA:return k.logicalLevelTechnique2===Zi.RLE?(function(B,V,Z){const ie=new BigInt64Array(Z);let ce=0,ve=0n;for(let Se=0;Se<V;Se++){const Ne=Number(B[Se]),ze=ev(B[Se+V]);for(let Ve=0;Ve<Ne;Ve++)ve+=ze,ie[ce++]=ve}return ie})(S,k.runs,k.numRleValues):((function(B){B[0]=B[0]>>1n^-(1n&B[0]);const V=B.length/4*4;let Z=1;if(V>=4)for(;Z<V-4;Z+=4){const ie=B[Z],ce=B[Z+1],ve=B[Z+2],Se=B[Z+3];B[Z]=(ie>>1n^-(1n&ie))+B[Z-1],B[Z+1]=(ce>>1n^-(1n&ce))+B[Z],B[Z+2]=(ve>>1n^-(1n&ve))+B[Z+1],B[Z+3]=(Se>>1n^-(1n&Se))+B[Z+2]}for(;Z!=B.length;++Z)B[Z]=(B[Z]>>1n^-(1n&B[Z]))+B[Z-1]})(S),S);case Zi.RLE:return(function(B,V,Z){return Z?(function(ie,ce,ve){const Se=new BigInt64Array(ve);let Ne=0;for(let ze=0;ze<ce;ze++){const Ve=Number(ie[ze]);let et=ie[ze+ce];et=et>>1n^-(1n&et),Se.fill(et,Ne,Ne+Ve),Ne+=Ve}return Se})(B,V.runs,V.numRleValues):jF(B,V.runs,V.numRleValues)})(S,k,R);case Zi.NONE:return R&&(function(B){for(let V=0;V<B.length;V++){const Z=B[V];B[V]=Z>>1n^-(1n&Z)}})(S),S;default:throw new Error(`The specified Logical level technique is not supported: ${k.logicalLevelTechnique1}`)}})(T2(p,l,f.numValues),f,v)}function WF(p,l,f,v){const S=T2(p,l,f.numValues);if(S.length===1){const k=S[0];return v?ev(k):k}return v?(function(k){return ev(k[1])})(S):(function(k){return k[1]})(S)}function OC(p,l,f,v,S){return(function(k,R,B,V){switch(R.logicalLevelTechnique1){case Zi.DELTA:return R.logicalLevelTechnique2===Zi.RLE&&(k=zF(k,R.runs,R.numRleValues)),(function(Z,ie){const ce=new Int32Array(Z.size());let ve=0;Z.get(0)?(ce[0]=Z.get(0)?ie[0]>>>1^-(1&ie[0]):0,ve=1):ce[0]=0;let Se=1;for(;Se!=ce.length;++Se)ce[Se]=Z.get(Se)?ce[Se-1]+(ie[ve]>>>1^-(1&ie[ve++])):ce[Se-1];return ce})(V,k);case Zi.RLE:return(function(Z,ie,ce,ve){const Se=ie;return ce?(function(Ne,ze,Ve){const et=new Int32Array(Ne.size());let Ct=0;for(let nt=0;nt<Ve;nt++){const ut=ze[nt];let Rt=ze[nt+Ve];Rt=Rt>>>1^-(1&Rt);for(let Ft=Ct;Ft<Ct+ut;Ft++)Ne.get(Ft)?et[Ft]=Rt:(et[Ft]=0,Ct++);Ct+=ut}return et})(ve,Z,Se.runs):(function(Ne,ze,Ve){const et=new Int32Array(Ne.size());let Ct=0;for(let nt=0;nt<Ve;nt++){const ut=ze[nt],Rt=ze[nt+Ve];for(let Ft=Ct;Ft<Ct+ut;Ft++)Ne.get(Ft)?et[Ft]=Rt:(et[Ft]=0,Ct++);Ct+=ut}return et})(ve,Z,Se.runs)})(k,R,B,V);case Zi.MORTON:return RC(k),k;case Zi.COMPONENTWISE_DELTA:return VF(k),k;case Zi.NONE:return k=B?(function(Z,ie){const ce=new Int32Array(Z.size());let ve=0,Se=0;for(;Se!=ce.length;++Se)if(Z.get(Se)){const Ne=ie[ve++];ce[Se]=Ne>>>1^-(1&Ne)}else ce[Se]=0;return ce})(V,k):(function(Z,ie){const ce=new Int32Array(Z.size());let ve=0,Se=0;for(;Se!=ce.length;++Se)ce[Se]=Z.get(Se)?ie[ve++]:0;return ce})(V,k),k;default:throw new Error("The specified Logical level technique is not supported")}})(f.physicalLevelTechnique===Gd.FAST_PFOR?BF():Dl(p,l,f.numValues),f,v,S)}function A2(p,l,f,v){const S=p.logicalLevelTechnique1;if(S===Zi.RLE)return p.runs===1?ml.CONST:ml.FLAT;const k=l instanceof uf?l.size():l;if(S===Zi.DELTA&&p.logicalLevelTechnique2===Zi.RLE){const R=p.runs,B=2;if(p.numRleValues!==k)return ml.FLAT;if(R===1)return ml.SEQUENCE;if(R===2){const V=v.get();let Z;if(p.physicalLevelTechnique===Gd.VARINT)Z=Dl(f,v,4);else{const ie=v.get();Z=new Int32Array(f.buffer,f.byteOffset+ie,4)}if(v.set(V),Z[2]===B&&Z[3]===B)return ml.SEQUENCE}}return p.numValues===1?ml.CONST:ml.FLAT}class GF extends E2{getValueFromBuffer(l){return this.dataBuffer[l]}}class XF extends LF{constructor(l,f,v,S){super(l,BigInt64Array.of(f),v,S)}getValueFromBuffer(l){return this.dataBuffer[0]+BigInt(l)*this.delta}}class tv{_geometryOffsets;_partOffsets;_ringOffsets;constructor(l,f,v){this._geometryOffsets=l,this._partOffsets=f,this._ringOffsets=v}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function NC(p,l,f){return{x:YF(p,l)-f,y:YF(p>>1,l)-f}}function YF(p,l){let f=0;for(let v=0;v<l;v++)f|=(p&1<<2*v)>>v;return f}(function(p){p[p.POINT=0]="POINT",p[p.LINESTRING=1]="LINESTRING",p[p.POLYGON=2]="POLYGON",p[p.MULTIPOINT=3]="MULTIPOINT",p[p.MULTILINESTRING=4]="MULTILINESTRING",p[p.MULTIPOLYGON=5]="MULTIPOLYGON"})(yl||(yl={})),(function(p){p[p.POINT=0]="POINT",p[p.LINESTRING=1]="LINESTRING",p[p.POLYGON=2]="POLYGON"})(FF||(FF={})),(function(p){p[p.MORTON=0]="MORTON",p[p.VEC_2=1]="VEC_2",p[p.VEC_3=2]="VEC_3"})(Yc||(Yc={}));class xae{createPoint(l){return[[l]]}createMultiPoint(l){return l.map((f=>[f]))}createLineString(l){return[l]}createMultiLineString(l){return l}createPolygon(l,f){return[l].concat(f)}createMultiPolygon(l){return l.flat()}}function ZF(p){const l=new Array(p.numGeometries);let f=1,v=1,S=1,k=0;const R=new xae;let B=0,V=0;const Z=p.mortonSettings,ie=p.topologyVector,ce=ie.geometryOffsets,ve=ie.partOffsets,Se=ie.ringOffsets,Ne=p.vertexOffsets,ze=p.containsPolygonGeometry(),Ve=p.vertexBuffer;for(let et=0;et<p.numGeometries;et++){const Ct=p.geometryType(et);if(Ct===yl.POINT){if(Ne&&Ne.length!==0)if(p.vertexBufferType===Yc.VEC_2){const nt=2*Ne[V++],ut=new c(Ve[nt],Ve[nt+1]);l[k++]=R.createPoint(ut)}else{const nt=NC(Ve[Ne[V++]],Z.numBits,Z.coordinateShift),ut=new c(nt.x,nt.y);l[k++]=R.createPoint(ut)}else{const nt=new c(Ve[B++],Ve[B++]);l[k++]=R.createPoint(nt)}ce&&S++,ve&&f++,Se&&v++}else if(Ct===yl.MULTIPOINT){const nt=ce[S]-ce[S-1];S++;const ut=new Array(nt);if(Ne&&Ne.length!==0){for(let Rt=0;Rt<nt;Rt++){const Ft=2*Ne[V++];ut[Rt]=new c(Ve[Ft],Ve[Ft+1])}l[k++]=R.createMultiPoint(ut)}else{for(let Rt=0;Rt<nt;Rt++){const Ft=Ve[B++],fr=Ve[B++];ut[Rt]=new c(Ft,fr)}l[k++]=R.createMultiPoint(ut)}}else if(Ct===yl.LINESTRING){let nt,ut=0;ze?(ut=Se[v]-Se[v-1],v++):ut=ve[f]-ve[f-1],f++,Ne&&Ne.length!==0?(nt=p.vertexBufferType===Yc.VEC_2?FC(Ve,Ne,V,ut,!1):BC(Ve,Ne,V,ut,!1,Z),V+=ut):(nt=LC(Ve,B,ut,!1),B+=2*ut),l[k++]=R.createLineString(nt),ce&&S++}else if(Ct===yl.POLYGON){const nt=ve[f]-ve[f-1];f++;const ut=new Array(nt-1);let Rt=Se[v]-Se[v-1];if(v++,Ne&&Ne.length!==0){const Ft=p.vertexBufferType===Yc.VEC_2?P2(Ve,Ne,V,Rt):k2(Ve,Ne,V,Rt,0,Z);V+=Rt;for(let fr=0;fr<ut.length;fr++)Rt=Se[v]-Se[v-1],v++,ut[fr]=p.vertexBufferType===Yc.VEC_2?P2(Ve,Ne,V,Rt):k2(Ve,Ne,V,Rt,0,Z),V+=Rt;l[k++]=R.createPolygon(Ft,ut)}else{const Ft=I2(Ve,B,Rt);B+=2*Rt;for(let fr=0;fr<ut.length;fr++)Rt=Se[v]-Se[v-1],v++,ut[fr]=I2(Ve,B,Rt),B+=2*Rt;l[k++]=R.createPolygon(Ft,ut)}ce&&S++}else if(Ct===yl.MULTILINESTRING){const nt=ce[S]-ce[S-1];S++;const ut=new Array(nt);if(Ne&&Ne.length!==0){for(let Rt=0;Rt<nt;Rt++){let Ft=0;ze?(Ft=Se[v]-Se[v-1],v++):Ft=ve[f]-ve[f-1],f++;const fr=p.vertexBufferType===Yc.VEC_2?FC(Ve,Ne,V,Ft,!1):BC(Ve,Ne,V,Ft,!1,Z);ut[Rt]=fr,V+=Ft}l[k++]=R.createMultiLineString(ut)}else{for(let Rt=0;Rt<nt;Rt++){let Ft=0;ze?(Ft=Se[v]-Se[v-1],v++):Ft=ve[f]-ve[f-1],f++,ut[Rt]=LC(Ve,B,Ft,!1),B+=2*Ft}l[k++]=R.createMultiLineString(ut)}}else{if(Ct!==yl.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const nt=ce[S]-ce[S-1];S++;const ut=new Array(nt);let Rt=0;if(Ne&&Ne.length!==0){for(let Ft=0;Ft<nt;Ft++){const fr=ve[f]-ve[f-1];f++;const Or=new Array(fr-1);Rt=Se[v]-Se[v-1],v++;const Pr=p.vertexBufferType===Yc.VEC_2?P2(Ve,Ne,V,Rt):k2(Ve,Ne,V,Rt,0,Z);V+=Rt;for(let Vr=0;Vr<Or.length;Vr++)Rt=Se[v]-Se[v-1],v++,Or[Vr]=p.vertexBufferType===Yc.VEC_2?P2(Ve,Ne,V,Rt):k2(Ve,Ne,V,Rt,0,Z),V+=Rt;ut[Ft]=R.createPolygon(Pr,Or)}l[k++]=R.createMultiPolygon(ut)}else{for(let Ft=0;Ft<nt;Ft++){const fr=ve[f]-ve[f-1];f++;const Or=new Array(fr-1);Rt=Se[v]-Se[v-1],v++;const Pr=I2(Ve,B,Rt);B+=2*Rt;for(let Vr=0;Vr<Or.length;Vr++){const pn=Se[v]-Se[v-1];v++,Or[Vr]=I2(Ve,B,pn),B+=2*pn}ut[Ft]=R.createPolygon(Pr,Or)}l[k++]=R.createMultiPolygon(ut)}}}}return l}function I2(p,l,f){return LC(p,l,f,!0)}function P2(p,l,f,v){return FC(p,l,f,v,!0)}function k2(p,l,f,v,S,k){return BC(p,l,f,v,!0,k)}function LC(p,l,f,v){const S=new Array(v?f+1:f);for(let k=0;k<2*f;k+=2)S[k/2]=new c(p[l+k],p[l+k+1]);return v&&(S[S.length-1]=S[0]),S}function FC(p,l,f,v,S){const k=new Array(S?v+1:v);for(let R=0;R<2*v;R+=2){const B=2*l[f+R/2];k[R/2]=new c(p[B],p[B+1])}return S&&(k[k.length-1]=k[0]),k}function BC(p,l,f,v,S,k){const R=new Array(S?v+1:v);for(let B=0;B<v;B++){const V=NC(p[l[f+B]],k.numBits,k.coordinateShift);R[B]=new c(V.x,V.y)}return S&&(R[R.length-1]=R[0]),R}class KF{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(l,f,v,S,k){this._vertexBufferType=l,this._topologyVector=f,this._vertexOffsets=v,this._vertexBuffer=S,this._mortonSettings=k}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const l=ZF(this);let f=0;for(;f<this.numGeometries;)yield{coordinates:l[f],type:this.geometryType(f)},f++}getSimpleEncodedVertex(l){const f=this.vertexOffsets?2*this.vertexOffsets[l]:2*l;return[this.vertexBuffer[f],this.vertexBuffer[f+1]]}getVertex(l){if(this.vertexOffsets&&this.mortonSettings){const v=NC(this.vertexBuffer[this.vertexOffsets[l]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[v.x,v.y]}const f=this.vertexOffsets?2*this.vertexOffsets[l]:2*l;return[this.vertexBuffer[f],this.vertexBuffer[f+1]]}getGeometries(){return ZF(this)}get mortonSettings(){return this._mortonSettings}}class JF extends KF{_numGeometries;_geometryType;constructor(l,f,v,S,k,R,B){super(v,S,k,R,B),this._numGeometries=l,this._geometryType=f}geometryType(l){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===yl.POLYGON||this._geometryType===yl.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class QF extends KF{_geometryTypes;constructor(l,f,v,S,k,R){super(l,v,S,k,R),this._geometryTypes=f}geometryType(l){return this._geometryTypes[l]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let l=0;l<this.numGeometries;l++)if(this.geometryType(l)===yl.POLYGON||this.geometryType(l)===yl.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class e8{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(l,f,v,S){this._triangleOffsets=l,this._indexBuffer=f,this._vertexBuffer=v,this._topologyVector=S}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const l=new Array(this.numGeometries),f=this._topologyVector,v=f.partOffsets,S=f.ringOffsets,k=f.geometryOffsets;let R=0,B=1,V=1,Z=1;for(let ie=0;ie<this.numGeometries;ie++)switch(this.geometryType(ie)){case yl.POLYGON:{const ce=v[B]-v[B-1];B++;const ve=[];for(let Se=0;Se<ce;Se++){const Ne=S[V]-S[V-1];V++;const ze=[];for(let Ve=0;Ve<Ne;Ve++){const et=this._vertexBuffer[R++],Ct=this._vertexBuffer[R++];ze.push(new c(et,Ct))}ze.length>0&&ze.push(ze[0]),ve.push(ze)}l[ie]=ve,k&&Z++}break;case yl.MULTIPOLYGON:{const ce=k[Z]-k[Z-1];Z++;const ve=[];for(let Se=0;Se<ce;Se++){const Ne=v[B]-v[B-1];B++;for(let ze=0;ze<Ne;ze++){const Ve=S[V]-S[V-1];V++;const et=[];for(let Ct=0;Ct<Ve;Ct++){const nt=this._vertexBuffer[R++],ut=this._vertexBuffer[R++];et.push(new c(nt,ut))}et.length>0&&et.push(et[0]),ve.push(et)}}l[ie]=ve}}return l}[Symbol.iterator](){return null}}function t8(p,l,f,v,S,k){return new wae(p,l,f,v,S,k)}class wae extends e8{_numGeometries;_geometryType;constructor(l,f,v,S,k,R){super(v,S,k,R),this._numGeometries=l,this._geometryType=f}geometryType(l){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function r8(p,l,f,v,S){return new Sae(p,l,f,v,S)}class Sae extends e8{_geometryTypes;constructor(l,f,v,S,k){super(f,v,S,k),this._geometryTypes=l}geometryType(l){return this._geometryTypes[l]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function Eae(p,l,f,v,S){const k=ju(p,f);let R=null,B=null,V=null,Z=null,ie=null,ce=null,ve=null,Se=null;if(A2(k,v,p,f)===ml.CONST){const ze=DC(p,f,k,!1);for(let Ve=0;Ve<l-1;Ve++){const et=ju(p,f);switch(et.physicalStreamType){case Kl.LENGTH:switch(et.logicalStreamType.lengthType){case Ec.GEOMETRIES:R=Xp(p,f,et);break;case Ec.PARTS:B=Xp(p,f,et);break;case Ec.RINGS:V=Xp(p,f,et);break;case Ec.TRIANGLES:ve=Xp(p,f,et)}break;case Kl.OFFSET:switch(et.logicalStreamType.offsetType){case im.VERTEX:Z=Uu(p,f,et,!1);break;case im.INDEX:Se=Uu(p,f,et,!1)}break;case Kl.DATA:lf.VERTEX===et.logicalStreamType.dictionaryType?ie=Uu(p,f,et,!0):(ce={numBits:et.numBits,coordinateShift:et.coordinateShift},ie=Uu(p,f,et,!1))}}return Se!==null?R!=null||B!=null?t8(v,ze,ve,Se,ie,new tv(R,B,V)):t8(v,ze,ve,Se,ie):ce===null?(function(Ve,et,Ct,nt,ut){return new JF(Ve,et,Yc.VEC_2,Ct,nt,ut)})(v,ze,new tv(R,B,V),Z,ie):(function(Ve,et,Ct,nt,ut,Rt){return new JF(Ve,et,Yc.MORTON,Ct,nt,ut,Rt)})(v,ze,new tv(R,B,V),Z,ie,ce)}const Ne=Uu(p,f,k,!1);for(let ze=0;ze<l-1;ze++){const Ve=ju(p,f);switch(Ve.physicalStreamType){case Kl.LENGTH:switch(Ve.logicalStreamType.lengthType){case Ec.GEOMETRIES:R=Uu(p,f,Ve,!1);break;case Ec.PARTS:B=Uu(p,f,Ve,!1);break;case Ec.RINGS:V=Uu(p,f,Ve,!1);break;case Ec.TRIANGLES:ve=Xp(p,f,Ve)}break;case Kl.OFFSET:switch(Ve.logicalStreamType.offsetType){case im.VERTEX:Z=Uu(p,f,Ve,!1);break;case im.INDEX:Se=Uu(p,f,Ve,!1)}break;case Kl.DATA:lf.VERTEX===Ve.logicalStreamType.dictionaryType?ie=Uu(p,f,Ve,!0):(ce={numBits:Ve.numBits,coordinateShift:Ve.coordinateShift},ie=Uu(p,f,Ve,!1))}}return Se!==null&&B===null?r8(Ne,ve,Se,ie):(R!==null?(R=zC(Ne,R,2),B!==null&&V!==null?(B=n8(Ne,R,B,!1),V=(function(ze,Ve,et,Ct){const nt=new Int32Array(et[et.length-1]+1);let ut=0;nt[0]=ut;let Rt=1,Ft=1,fr=0;for(let Or=0;Or<ze.length;Or++){const Pr=ze[Or],Vr=Ve[Or+1]-Ve[Or];if(Pr!==0&&Pr!==3)for(let pn=0;pn<Vr;pn++){const Gr=et[Rt]-et[Rt-1];Rt++;for(let Rr=0;Rr<Gr;Rr++)ut=nt[Ft++]=ut+Ct[fr++]}else for(let pn=0;pn<Vr;pn++)nt[Ft++]=++ut,Rt++}return nt})(Ne,R,B,V)):B!==null&&(B=(function(ze,Ve,et){const Ct=new Int32Array(Ve[Ve.length-1]+1);let nt=0;Ct[0]=nt;let ut=1,Rt=0;for(let Ft=0;Ft<ze.length;Ft++){const fr=ze[Ft],Or=Ve[Ft+1]-Ve[Ft];if(fr===4||fr===1)for(let Pr=0;Pr<Or;Pr++)nt=Ct[ut++]=nt+et[Rt++];else for(let Pr=0;Pr<Or;Pr++)Ct[ut++]=++nt}return Ct})(Ne,R,B))):B!==null&&V!==null?(B=zC(Ne,B,1),V=n8(Ne,B,V,!0)):B!==null&&(B=zC(Ne,B,0)),Se!==null?r8(Ne,ve,Se,ie,new tv(R,B,V)):ce===null?(function(ze,Ve,et,Ct){return new QF(Yc.VEC_2,ze,Ve,et,Ct)})(Ne,new tv(R,B,V),Z,ie):(function(ze,Ve,et,Ct,nt){return new QF(Yc.MORTON,ze,Ve,et,Ct,nt)})(Ne,new tv(R,B,V),Z,ie,ce))}function zC(p,l,f){const v=new Int32Array(p.length+1);let S=0;v[0]=S;let k=0;for(let R=0;R<p.length;R++)S=v[R+1]=S+(p[R]>f?l[k++]:1);return v}function n8(p,l,f,v){const S=new Int32Array(l[l.length-1]+1);let k=0;S[0]=k;let R=1,B=0;for(let V=0;V<p.length;V++){const Z=p[V],ie=l[V+1]-l[V];if(Z===5||Z===2||v&&(Z===4||Z===1))for(let ce=0;ce<ie;ce++)k=S[R++]=k+f[B++];else for(let ce=0;ce<ie;ce++)S[R++]=++k}return S}class Tae extends Qy{dataVector;constructor(l,f,v){super(l,f.getBuffer(),v),this.dataVector=f}getValueFromBuffer(l){return this.dataVector.get(l)}}class Cae extends E2{getValueFromBuffer(l){return this.dataBuffer[l]}}class i8 extends Qy{constructor(l,f,v){super(l,BigInt64Array.of(f),v)}getValueFromBuffer(l){return this.dataBuffer[0]}}function H_(p,l,f){return a8(p,Math.ceil(l/8),f)}function a8(p,l,f){const v=new Uint8Array(l);let S=0;for(;S<l;){const k=p[f.increment()];if(k<=127){const R=k+3,B=p[f.increment()],V=S+R;v.fill(B,S,V),S=V}else{const R=256-k;for(let B=0;B<R;B++)v[S++]=p[f.increment()]}}return v}const Aae=new TextDecoder;function jC(p,l,f){return f-l>=12?Aae.decode(p.subarray(l,f)):(function(v,S,k){let R="",B=S;for(;B<k;){const V=v[B];let Z,ie,ce,ve=null,Se=V>239?4:V>223?3:V>191?2:1;if(B+Se>k)break;Se===1?V<128&&(ve=V):Se===2?(Z=v[B+1],(192&Z)==128&&(ve=(31&V)<<6|63&Z,ve<=127&&(ve=null))):Se===3?(Z=v[B+1],ie=v[B+2],(192&Z)==128&&(192&ie)==128&&(ve=(15&V)<<12|(63&Z)<<6|63&ie,(ve<=2047||ve>=55296&&ve<=57343)&&(ve=null))):Se===4&&(Z=v[B+1],ie=v[B+2],ce=v[B+3],(192&Z)==128&&(192&ie)==128&&(192&ce)==128&&(ve=(15&V)<<18|(63&Z)<<12|(63&ie)<<6|63&ce,(ve<=65535||ve>=1114112)&&(ve=null))),ve===null?(ve=65533,Se=1):ve>65535&&(ve-=65536,R+=String.fromCharCode(ve>>>10&1023|55296),ve=56320|1023&ve),R+=String.fromCharCode(ve),B+=Se}return R})(p,l,f)}class UC extends Qy{offsetBuffer;constructor(l,f,v,S){super(l,v,S),this.offsetBuffer=f}}class o8 extends UC{textEncoder;constructor(l,f,v,S){super(l,f,v,S??f.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(l){return jC(this.dataBuffer,this.offsetBuffer[l],this.offsetBuffer[l+1])}}class rv extends UC{indexBuffer;textEncoder;constructor(l,f,v,S,k){super(l,v,S,k??f.length),this.indexBuffer=f,this.indexBuffer=f,this.textEncoder=new TextEncoder}getValueFromBuffer(l){const f=this.indexBuffer[l];return jC(this.dataBuffer,this.offsetBuffer[f],this.offsetBuffer[f+1])}}class s8 extends UC{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(l,f,v,S,k,R,B){super(l,v,S,B),this.indexBuffer=f,this.symbolOffsetBuffer=k,this.symbolTableBuffer=R,this.textEncoder=new TextEncoder}getValueFromBuffer(l){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(v,S,k){const R=[],B=new Array(S.length).fill(0);for(let V=1;V<S.length;V++)B[V]=B[V-1]+S[V-1];for(let V=0;V<k.length;V++)if(k[V]===255)R.push(k[++V]);else{const Z=S[k[V]],ie=B[k[V]];for(let ce=0;ce<Z;ce++)R.push(v[ie+ce])}return new Uint8Array(R)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const f=this.indexBuffer[l];return jC(this.decodedDictionary,this.offsetBuffer[f],this.offsetBuffer[f+1])}offsetToLengthBuffer(l){const f=new Uint32Array(l.length-1);let v=l[0];for(let S=1;S<l.length;S++){const k=l[S];f[S-1]=k-v,v=k}return f}}function Iae(p,l,f,v,S,k){return f.type==="scalarType"?(function(R,B,V,Z,ie,ce){let ve=null,Se=0;if(R===0)return null;if(ce.nullable){const ze=ju(B,V);Se=ze.numValues;const Ve=V.get(),et=H_(B,Se,V);V.set(Ve+ze.byteLength),ve=new uf(et,ze.numValues)}const Ne=ve??Z;switch(ie.physicalType){case 4:case 3:return(function(ze,Ve,et,Ct,nt){const ut=ju(ze,Ve),Rt=A2(ut,nt,ze,Ve),Ft=Ct.physicalType===3;if(Rt===ml.FLAT){const fr=W_(nt)?OC(ze,Ve,ut,Ft,nt):Uu(ze,Ve,ut,Ft);return new AC(et.name,fr,nt)}if(Rt===ml.SEQUENCE){const fr=$F(ze,Ve,ut);return new PC(et.name,fr[0],fr[1],ut.numRleValues)}{const fr=DC(ze,Ve,ut,Ft);return new kC(et.name,fr,nt)}})(B,V,ce,ie,Ne);case 9:return(function(ze,Ve,et,Ct,nt){let ut=null,Rt=null,Ft=null,fr=null,Or=null,Pr=null,Vr=null,pn=null;for(let Gr=0;Gr<Ct;Gr++){const Rr=ju(Ve,et);if(Rr.byteLength!==0)switch(Rr.physicalStreamType){case Kl.PRESENT:{const Er=H_(Ve,Rr.numValues,et);Pr=new uf(Er,Rr.numValues);break}case Kl.OFFSET:Rt=nt!=null||Pr!=null?OC(Ve,et,Rr,!1,nt??Pr):Uu(Ve,et,Rr,!1);break;case Kl.LENGTH:{const Er=Xp(Ve,et,Rr);Ec.DICTIONARY===Rr.logicalStreamType.lengthType?ut=Er:Ec.SYMBOL===Rr.logicalStreamType.lengthType?fr=Er:Vr=Er;break}case Kl.DATA:{const Er=Ve.subarray(et.get(),et.get()+Rr.byteLength);et.add(Rr.byteLength);const Cn=Rr.logicalStreamType.dictionaryType;lf.FSST===Cn?Or=Er:lf.SINGLE===Cn||lf.SHARED===Cn?Ft=Er:lf.NONE===Cn&&(pn=Er);break}}}return(function(Gr,Rr,Er,Cn,xn,kn,vn){return Rr?new s8(Gr,Er,Cn,xn,kn,Rr,vn):null})(ze,Or,Rt,ut,Ft,fr,nt??Pr)??(function(Gr,Rr,Er,Cn,xn){return Rr?xn?new rv(Gr,Er,Cn,Rr,xn):new rv(Gr,Er,Cn,Rr):null})(ze,Ft,Rt,ut,nt??Pr)??(function(Gr,Rr,Er,Cn,xn){if(!Rr||!Er)return null;if(Cn)return xn?new rv(Gr,Cn,Rr,Er,xn):new rv(Gr,Cn,Rr,Er);if(xn&&xn.size()!==Rr.length-1){const kn=new Int32Array(xn.size());let vn=0;for(let Wn=0;Wn<xn.size();Wn++)kn[Wn]=xn.get(Wn)?vn++:0;return new rv(Gr,kn,Rr,Er,xn)}return xn?new o8(Gr,Rr,Er,xn):new o8(Gr,Rr,Er)})(ze,Vr,pn,Rt,nt??Pr)})(ce.name,B,V,ce.nullable?R-1:R,ve);case 0:return(function(ze,Ve,et,Ct,nt){const ut=ju(ze,Ve),Rt=ut.numValues,Ft=Ve.get(),fr=W_(nt)?(function(Pr,Vr,pn,Gr){const Rr=a8(Pr,Math.ceil(Vr/8),pn),Er=new uf(Rr,Vr),Cn=Gr.size(),xn=new uf(new Uint8Array(Cn),Cn);let kn=0;for(let vn=0;vn<Gr.size();vn++){const Wn=!!Gr.get(vn)&&Er.get(kn++);xn.set(vn,Wn)}return xn.getBuffer()})(ze,Rt,Ve,nt):H_(ze,Rt,Ve);Ve.set(Ft+ut.byteLength);const Or=new uf(fr,Rt);return new Tae(et.name,Or,nt)})(B,V,ce,0,Ne);case 6:case 5:return(function(ze,Ve,et,Ct,nt){const ut=ju(ze,Ve),Rt=A2(ut,Ct,ze,Ve),Ft=nt.physicalType===5;if(Rt===ml.FLAT){const fr=W_(Ct)?(function(Or,Pr,Vr,pn,Gr){return(function(Rr,Er,Cn,xn){switch(Er.logicalLevelTechnique1){case Zi.DELTA:return Er.logicalLevelTechnique2===Zi.RLE&&(Rr=jF(Rr,Er.runs,Er.numRleValues)),(function(kn,vn){const Wn=new BigInt64Array(kn.size());let la=0;kn.get(0)?(Wn[0]=kn.get(0)?vn[0]>>1n^-(1n&vn[0]):0n,la=1):Wn[0]=0n;let Hi=1;for(;Hi!=Wn.length;++Hi)Wn[Hi]=kn.get(Hi)?Wn[Hi-1]+(vn[la]>>1n^-(1n&vn[la++])):Wn[Hi-1];return Wn})(xn,Rr);case Zi.RLE:return(function(kn,vn,Wn,la){const Hi=vn;return Wn?(function(Po,Ql,Ms){const ko=new BigInt64Array(Po.size());let vo=0;for(let Ta=0;Ta<Ms;Ta++){const Yo=Number(Ql[Ta]);let os=Ql[Ta+Ms];os=os>>1n^-(1n&os);for(let uo=vo;uo<vo+Yo;uo++)Po.get(uo)?ko[uo]=os:(ko[uo]=0n,vo++);vo+=Yo}return ko})(la,kn,Hi.runs):(function(Po,Ql,Ms){const ko=new BigInt64Array(Po.size());let vo=0;for(let Ta=0;Ta<Ms;Ta++){const Yo=Number(Ql[Ta]),os=Ql[Ta+Ms];for(let uo=vo;uo<vo+Yo;uo++)Po.get(uo)?ko[uo]=os:(ko[uo]=0n,vo++);vo+=Yo}return ko})(la,kn,Hi.runs)})(Rr,Er,Cn,xn);case Zi.NONE:return Rr=Cn?(function(kn,vn){const Wn=new BigInt64Array(kn.size());let la=0,Hi=0;for(;Hi!=Wn.length;++Hi)if(kn.get(Hi)){const Po=vn[la++];Wn[Hi]=Po>>1n^-(1n&Po)}else Wn[Hi]=0n;return Wn})(xn,Rr):(function(kn,vn){const Wn=new BigInt64Array(kn.size());let la=0,Hi=0;for(;Hi!=Wn.length;++Hi)Wn[Hi]=kn.get(Hi)?vn[la++]:0n;return Wn})(xn,Rr),Rr;default:throw new Error("The specified Logical level technique is not supported")}})(T2(Or,Pr,Vr.numValues),Vr,pn,Gr)})(ze,Ve,ut,Ft,Ct):HF(ze,Ve,ut,Ft);return new GF(et.name,fr,Ct)}if(Rt===ml.SEQUENCE){const fr=qF(ze,Ve,ut);return new XF(et.name,fr[0],fr[1],ut.numRleValues)}{const fr=WF(ze,Ve,ut,Ft);return new i8(et.name,fr,Ct)}})(B,V,ce,Ne,ie);case 7:return(function(ze,Ve,et,Ct){const nt=ju(ze,Ve),ut=W_(Ct)?(function(Rt,Ft,fr,Or){const Pr=Ft.get(),Vr=Pr+Or*Float32Array.BYTES_PER_ELEMENT,pn=new Uint8Array(Rt.subarray(Pr,Vr)).buffer,Gr=new Float32Array(pn);Ft.set(Vr);const Rr=fr.size(),Er=new Float32Array(Rr);let Cn=0;for(let xn=0;xn<Rr;xn++)Er[xn]=fr.get(xn)?Gr[Cn++]:0;return Er})(ze,Ve,Ct,nt.numValues):(function(Rt,Ft,fr){const Or=Ft.get(),Pr=Or+fr*Float32Array.BYTES_PER_ELEMENT,Vr=new Uint8Array(Rt.subarray(Or,Pr)).buffer,pn=new Float32Array(Vr);return Ft.set(Pr),pn})(ze,Ve,nt.numValues);return new Cae(et.name,ut,Ct)})(B,V,ce,Ne);case 8:return(function(ze,Ve,et,Ct){const nt=ju(ze,Ve),ut=W_(Ct)?(function(Rt,Ft,fr,Or){const Pr=Ft.get(),Vr=Pr+Or*Float64Array.BYTES_PER_ELEMENT,pn=new Uint8Array(Rt.subarray(Pr,Vr)).buffer,Gr=new Float64Array(pn);Ft.set(Vr);const Rr=fr.size(),Er=new Float64Array(Rr);let Cn=0;for(let xn=0;xn<Rr;xn++)Er[xn]=fr.get(xn)?Gr[Cn++]:0;return Er})(ze,Ve,Ct,nt.numValues):(function(Rt,Ft,fr){const Or=Ft.get(),Pr=Or+fr*Float64Array.BYTES_PER_ELEMENT,Vr=new Uint8Array(Rt.subarray(Or,Pr)).buffer,pn=new Float64Array(Vr);return Ft.set(Pr),pn})(ze,Ve,nt.numValues);return new IC(et.name,ut,Ct)})(B,V,ce,Ne);default:throw new Error(`The specified data type for the field is currently not supported: ${ie}`)}})(v,p,l,S,f.scalarType,f):v!=1?null:(function(R,B,V,Z){let ie=null,ce=null,ve=null,Se=null,Ne=!1;for(;!Ne;){const Ct=ju(R,B);switch(Ct.physicalStreamType){case Kl.LENGTH:Ec.DICTIONARY===Ct.logicalStreamType.lengthType?ie=Xp(R,B,Ct):ve=Xp(R,B,Ct);break;case Kl.DATA:lf.SINGLE===Ct.logicalStreamType.dictionaryType||lf.SHARED===Ct.logicalStreamType.dictionaryType?(ce=R.subarray(B.get(),B.get()+Ct.byteLength),Ne=!0):Se=R.subarray(B.get(),B.get()+Ct.byteLength),B.add(Ct.byteLength)}}const ze=V.complexType.children,Ve=[];let et=0;for(const Ct of ze){const nt=Dl(R,B,1)[0];if(nt==0)continue;const ut=`${V.name}${Ct.name==="default"?"":":"+Ct.name}`;if(nt!==2||Ct.type!=="scalarField"||Ct.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const Rt=ju(R,B),Ft=H_(R,Rt.numValues,B),fr=ju(R,B),Or=fr.decompressedCount!==Z?OC(R,B,fr,!1,new uf(Ft,Rt.numValues)):Uu(R,B,fr,!1);Ve[et++]=Se?new s8(ut,Or,ie,ce,ve,Se,new uf(Ft,Rt.numValues)):new rv(ut,Or,ie,ce,new uf(Ft,Rt.numValues))}return Ve})(p,l,f,S)}function W_(p){return p instanceof uf}function Pae(p){if(p.name==="id")return!1;if(p.type==="scalarType"){const l=p.scalarType;if(l.type==="physicalType")switch(l.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(l.type==="logicalType")return!1}else if(p.type==="complexType"){const l=p.complexType;if(l.type==="physicalType")switch(l.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",p),!1}const kae=new TextDecoder;function l8(p,l){const f=Dl(p,l,1)[0];if(f===0)return"";const v=l.get(),S=p.subarray(v,v+f);return l.add(f),kae.decode(S)}function u8(p,l){const f=Dl(p,l,1)[0]>>>0,v=!!(4&f),S=!!(2&f),k=Dl(p,l,1)[0]>>>0,R={};if(1&f&&(R.nullable=!0),S){const B={};if(v?(B.type="logicalType",B.logicalType=k):(B.type="physicalType",B.physicalType=k),8&f){const V=Dl(p,l,1)[0]>>>0;B.children=new Array(V);for(let Z=0;Z<V;Z++)B.children[Z]=u8(p,l)}R.type="complexField",R.complexField=B}else{const B={};v?(B.type="logicalType",B.logicalType=k):(B.type="physicalType",B.physicalType=k),R.type="scalarField",R.scalarField=B}return R}function Rae(p,l){const f=Dl(p,l,1)[0]>>>0,v=(function(S){switch(S){case 0:case 1:case 2:case 3:{const k={};k.nullable=!!(1&S),k.columnScope=0;const R={};return R.physicalType=S>1?6:4,R.type="physicalType",k.scalarType=R,k.type="scalarType",k}case 4:{const k={nullable:!1,columnScope:0},R={type:"physicalType",physicalType:0};return k.type="complexType",k.complexType=R,k}case 30:{const k={nullable:!1,columnScope:0},R={type:"physicalType",physicalType:1};return k.type="complexType",k.complexType=R,k}default:return(function(k){let R=null;switch(k){case 10:case 11:R=0;break;case 12:case 13:R=1;break;case 14:case 15:R=2;break;case 16:case 17:R=3;break;case 18:case 19:R=4;break;case 20:case 21:R=5;break;case 22:case 23:R=6;break;case 24:case 25:R=7;break;case 26:case 27:R=8;break;case 28:case 29:R=9;break;default:return null}const B={};B.nullable=!!(1&k),B.columnScope=0;const V={type:"physicalType"};return V.physicalType=R,B.type="scalarType",B.scalarType=V,B})(S)}})(f);if(!v)throw new Error(`Unsupported column type code: ${f}`);if((function(S){return S>=10})(f)?v.name=l8(p,l):f>=0&&f<=3?v.name="id":f===4&&(v.name="geometry"),(function(S){return S===30})(f)){const S=Dl(p,l,1)[0]>>>0,k=v.complexType;k.children=new Array(S);for(let R=0;R<S;R++)k.children[R]=u8(p,l)}return v}function Mae(p,l){const f={featureTables:[]},v={};v.name=l8(p,l);const S=Dl(p,l,1)[0]>>>0,k=Dl(p,l,1)[0]>>>0;v.columns=new Array(k);for(let R=0;R<k;R++)v.columns[R]=Rae(p,l);return f.featureTables.push(v),[f,S]}function Dae(p,l,f,v,S,k,R=!1){const B=l.scalarType.physicalType,V=A2(S,k,p,f);if(B===4)switch(V){case ml.FLAT:{const Z=Uu(p,f,S,!1);return new AC(v,Z,k)}case ml.SEQUENCE:{const Z=$F(p,f,S);return new PC(v,Z[0],Z[1],S.numRleValues)}case ml.CONST:{const Z=DC(p,f,S,!1);return new kC(v,Z,k)}}else switch(V){case ml.FLAT:{if(R){const ie=(function(ce,ve,Se,Ne){const ze=(function(Ve,et,Ct){const nt=new Float64Array(et);for(let ut=0;ut<et;ut++)nt[ut]=_ae(Ve,Ct);return nt})(ce,Se.numValues,ve);return(function(Ve,et,Ct){switch(et.logicalLevelTechnique1){case Zi.DELTA:return et.logicalLevelTechnique2===Zi.RLE&&(Ve=UF(Ve,et.runs,et.numRleValues)),(function(nt){nt[0]=nt[0]%2==1?(nt[0]+1)/-2:nt[0]/2;const ut=nt.length/4*4;let Rt=1;if(ut>=4)for(;Rt<ut-4;Rt+=4){const Ft=nt[Rt],fr=nt[Rt+1],Or=nt[Rt+2],Pr=nt[Rt+3];nt[Rt]=(Ft%2==1?(Ft+1)/-2:Ft/2)+nt[Rt-1],nt[Rt+1]=(fr%2==1?(fr+1)/-2:fr/2)+nt[Rt],nt[Rt+2]=(Or%2==1?(Or+1)/-2:Or/2)+nt[Rt+1],nt[Rt+3]=(Pr%2==1?(Pr+1)/-2:Pr/2)+nt[Rt+2]}for(;Rt!=nt.length;++Rt)nt[Rt]=(nt[Rt]%2==1?(nt[Rt]+1)/-2:nt[Rt]/2)+nt[Rt-1]})(Ve),Ve;case Zi.RLE:return(function(nt,ut,Rt){return UF(nt,ut.runs,ut.numRleValues)})(Ve,et);case Zi.NONE:return Ve;default:throw new Error(`The specified Logical level technique is not supported: ${et.logicalLevelTechnique1}`)}})(ze,Se)})(p,f,S);return new IC(v,ie,k)}const Z=HF(p,f,S,!1);return new GF(v,Z,k)}case ml.SEQUENCE:{const Z=qF(p,f,S);return new XF(v,Z[0],Z[1],S.numRleValues)}case ml.CONST:{const Z=WF(p,f,S,!1);return new i8(v,Z,k)}}throw new Error("Vector type not supported for id column.")}class Oae{constructor(l,f){var v;switch(this._featureData=l,this.properties=this._featureData.properties||{},(v=this._featureData.geometry)===null||v===void 0?void 0:v.type){case yl.POINT:case yl.MULTIPOINT:this.type=1;break;case yl.LINESTRING:case yl.MULTILINESTRING:this.type=2;break;case yl.POLYGON:case yl.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=f,this.id=Number(this._featureData.id)}loadGeometry(){const l=[];for(const f of this._featureData.geometry.coordinates){const v=[];for(const S of f)v.push(new c(S.x,S.y));l.push(v)}return l}}class Nae{constructor(l){this.features=[],this.featureTable=l,this.name=l.name,this.extent=l.extent,this.version=2,this.features=l.getFeatures(),this.length=this.features.length}feature(l){return new Oae(this.features[l],this.extent)}}class c8{constructor(l){this.layers={};const f=(function(v,S,k=!0){const R=new vae(0),B=[];for(;R.get()<v.length;){const V=Dl(v,R,1)[0]>>>0,Z=R.get()+V;if(Z>v.length)throw new Error(`Block overruns tile: ${Z} > ${v.length}`);if(Dl(v,R,1)[0]>>>0!=1){R.set(Z);continue}const ie=Mae(v,R),ce=ie[1],ve=ie[0].featureTables[0];let Se=null,Ne=null;const ze=[];let Ve=0;for(const Ct of ve.columns){const nt=Ct.name;if(nt==="id"){let ut=null;if(Ct.nullable){const Ft=ju(v,R),fr=R.get(),Or=H_(v,Ft.numValues,R);R.set(fr+Ft.byteLength),ut=new uf(Or,Ft.numValues)}const Rt=ju(v,R);Ve=Rt.decompressedCount,Se=Dae(v,Ct,R,nt,Rt,ut??Ve,k)}else if(nt==="geometry"){const ut=Dl(v,R,1)[0];if(Ve===0){const Rt=R.get();Ve=ju(v,R).decompressedCount,R.set(Rt)}Ne=Eae(v,ut,R,Ve)}else{const ut=Pae(Ct)?Dl(v,R,1)[0]:1;if(ut===0&&Ct.type==="scalarType")continue;const Rt=Iae(v,R,Ct,ut,Ve);if(Rt)if(Array.isArray(Rt))for(const Ft of Rt)ze.push(Ft);else ze.push(Rt)}}const et=new yae(ve.name,Ne,Se,ze,ce);B.push(et),R.set(Z)}return B})(new Uint8Array(l));this.layers=f.reduce(((v,S)=>Object.assign(Object.assign({},v),{[S.name]:new Nae(S)})),{})}}class Lae{constructor(l,f){this.feature=l,this.type=l.type,this.properties=l.tags?l.tags:{},this.extent=f,"id"in l&&(typeof l.id=="string"?this.id=parseInt(l.id,10):typeof l.id!="number"||isNaN(l.id)||(this.id=l.id))}loadGeometry(){const l=[],f=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const v of f){const S=[];for(const k of v)S.push(new c(k[0],k[1]));l.push(S)}return l}}const G_="_geojsonTileLayer";function Fae(p,l){l.writeVarintField(15,p.version||1),l.writeStringField(1,p.name||""),l.writeVarintField(5,p.extent||4096);const f={keys:[],values:[],keycache:{},valuecache:{}};for(let k=0;k<p.length;k++)f.feature=p.feature(k),l.writeMessage(2,Bae,f);const v=f.keys;for(const k of v)l.writeStringField(3,k);const S=f.values;for(const k of S)l.writeMessage(4,Uae,k)}function Bae(p,l){if(!p.feature)return;const f=p.feature;f.id!==void 0&&l.writeVarintField(1,f.id),l.writeMessage(2,zae,p),l.writeVarintField(3,f.type),l.writeMessage(4,jae,f)}function zae(p,l){for(const f in p.feature?.properties){let v=p.feature.properties[f],S=p.keycache[f];if(v==null)continue;S===void 0&&(p.keys.push(f),S=p.keys.length-1,p.keycache[f]=S),l.writeVarint(S),typeof v!="string"&&typeof v!="boolean"&&typeof v!="number"&&(v=JSON.stringify(v));const k=typeof v+":"+v;let R=p.valuecache[k];R===void 0&&(p.values.push(v),R=p.values.length-1,p.valuecache[k]=R),l.writeVarint(R)}}function VC(p,l){return(l<<3)+(7&p)}function h8(p){return p<<1^p>>31}function jae(p,l){const f=p.loadGeometry(),v=p.type;let S=0,k=0;for(const R of f){let B=1;v===1&&(B=R.length),l.writeVarint(VC(1,B));const V=v===3?R.length-1:R.length;for(let Z=0;Z<V;Z++){Z===1&&v!==1&&l.writeVarint(VC(2,V-1));const ie=R[Z].x-S,ce=R[Z].y-k;l.writeVarint(h8(ie)),l.writeVarint(h8(ce)),S+=ie,k+=ce}p.type===3&&l.writeVarint(VC(7,1))}}function Uae(p,l){const f=typeof p;f==="string"?l.writeStringField(1,p):f==="boolean"?l.writeBooleanField(7,p):f==="number"&&(p%1!=0?l.writeDoubleField(3,p):p<0?l.writeSVarintField(6,p):l.writeVarintField(5,p))}class f8{constructor(l,f){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new _r(xe,16,0),this.grid3D=new _r(xe,16,0),this.featureIndexArray=new Ze,this.promoteId=f}insert(l,f,v,S,k,R){const B=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(v,S,k);const V=R?this.grid3D:this.grid;for(let Z=0;Z<f.length;Z++){const ie=f[Z],ce=[1/0,1/0,-1/0,-1/0];for(let ve=0;ve<ie.length;ve++){const Se=ie[ve];ce[0]=Math.min(ce[0],Se.x),ce[1]=Math.min(ce[1],Se.y),ce[2]=Math.max(ce[2],Se.x),ce[3]=Math.max(ce[3],Se.y)}ce[0]<xe&&ce[1]<xe&&ce[2]>=0&&ce[3]>=0&&V.insert(B,ce[0],ce[1],ce[2],ce[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new K6(new _2(this.rawTileData)).layers:new c8(this.rawTileData).layers,this.sourceLayerCoder=new OF(this.vtLayers?Object.keys(this.vtLayers).sort():[G_])),this.vtLayers}query(l,f,v,S){this.loadVTLayers();const k=l.params,R=xe/l.tileSize/l.scale,B=rf(k.filter,k.globalState),V=l.queryGeometry,Z=l.queryPadding*R,ie=nm.fromPoints(V),ce=this.grid.query(ie.minX-Z,ie.minY-Z,ie.maxX+Z,ie.maxY+Z),ve=nm.fromPoints(l.cameraQueryGeometry).expandBy(Z),Se=this.grid3D.query(ve.minX,ve.minY,ve.maxX,ve.maxY,((Ve,et,Ct,nt)=>(function(ut,Rt,Ft,fr,Or){for(const Vr of ut)if(Rt<=Vr.x&&Ft<=Vr.y&&fr>=Vr.x&&Or>=Vr.y)return!0;const Pr=[new c(Rt,Ft),new c(Rt,Or),new c(fr,Or),new c(fr,Ft)];if(ut.length>2){for(const Vr of Pr)if(qy(ut,Vr))return!0}for(let Vr=0;Vr<ut.length-1;Vr++)if($ne(ut[Vr],ut[Vr+1],Pr))return!0;return!1})(l.cameraQueryGeometry,Ve-Z,et-Z,Ct+Z,nt+Z)));for(const Ve of Se)ce.push(Ve);ce.sort(Vae);const Ne={};let ze;for(let Ve=0;Ve<ce.length;Ve++){const et=ce[Ve];if(et===ze)continue;ze=et;const Ct=this.featureIndexArray.get(et);let nt=null;this.loadMatchingFeature(Ne,Ct.bucketIndex,Ct.sourceLayerIndex,Ct.featureIndex,B,k.layers,k.availableImages,f,v,S,((ut,Rt,Ft)=>(nt||(nt=Zf(ut)),Rt.queryIntersectsFeature({queryGeometry:V,feature:ut,featureState:Ft,geometry:nt,zoom:this.z,transform:l.transform,pixelsToTileUnits:R,pixelPosMatrix:l.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:l.getElevation}))))}return Ne}loadMatchingFeature(l,f,v,S,k,R,B,V,Z,ie,ce){const ve=this.bucketLayerIDs[f];if(R&&!ve.some((Ve=>R.has(Ve))))return;const Se=this.sourceLayerCoder.decode(v),Ne=this.vtLayers[Se].feature(S);if(k.needGeometry){const Ve=Kf(Ne,!0);if(!k.filter(new ki(this.tileID.overscaledZ),Ve,this.tileID.canonical))return}else if(!k.filter(new ki(this.tileID.overscaledZ),Ne))return;const ze=this.getId(Ne,Se);for(let Ve=0;Ve<ve.length;Ve++){const et=ve[Ve];if(R&&!R.has(et))continue;const Ct=V[et];if(!Ct)continue;let nt={};ze&&ie&&(nt=ie.getState(Ct.sourceLayer||G_,ze));const ut=Be({},Z[et]);ut.paint=d8(ut.paint,Ct.paint,Ne,nt,B),ut.layout=d8(ut.layout,Ct.layout,Ne,nt,B);const Rt=!ce||ce(Ne,Ct,nt);if(!Rt)continue;const Ft=new NF(Ne,this.z,this.x,this.y,ze);Ft.layer=ut;let fr=l[et];fr===void 0&&(fr=l[et]=[]),fr.push({featureIndex:S,feature:Ft,intersectionZ:Rt})}}lookupSymbolFeatures(l,f,v,S,k,R,B,V){const Z={};this.loadVTLayers();const ie=rf(k.filterSpec,k.globalState);for(const ce of l)this.loadMatchingFeature(Z,v,S,ce,ie,R,B,V,f);return Z}hasLayer(l){for(const f of this.bucketLayerIDs)for(const v of f)if(l===v)return!0;return!1}getId(l,f){var v;let S=l.id;return this.promoteId&&(S=l.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[f]],typeof S=="boolean"&&(S=Number(S)),S===void 0&&(!((v=l.properties)===null||v===void 0)&&v.cluster)&&this.promoteId&&(S=Number(l.properties.cluster_id))),S}}function d8(p,l,f,v,S){return Qe(p,((k,R)=>{const B=l instanceof Go?l.get(R):null;return B&&B.evaluate?B.evaluate(f,v,S):B}))}function Vae(p,l){return l-p}function p8(p,l,f,v,S){const k=[];for(let R=0;R<p.length;R++){const B=p[R];let V;for(let Z=0;Z<B.length-1;Z++){let ie=B[Z],ce=B[Z+1];ie.x<l&&ce.x<l||(ie.x<l?ie=new c(l,ie.y+(l-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round():ce.x<l&&(ce=new c(l,ie.y+(l-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round()),ie.y<f&&ce.y<f||(ie.y<f?ie=new c(ie.x+(f-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),f)._round():ce.y<f&&(ce=new c(ie.x+(f-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),f)._round()),ie.x>=v&&ce.x>=v||(ie.x>=v?ie=new c(v,ie.y+(v-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round():ce.x>=v&&(ce=new c(v,ie.y+(v-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round()),ie.y>=S&&ce.y>=S||(ie.y>=S?ie=new c(ie.x+(S-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),S)._round():ce.y>=S&&(ce=new c(ie.x+(S-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),S)._round()),V&&ie.equals(V[V.length-1])||(V=[ie],k.push(V)),V.push(ce)))))}}return k}function g8(p,l,f,v,S){switch(l){case 1:return(function(k,R,B,V){const Z=[];for(const ie of k)for(const ce of ie){const ve=V===0?ce.x:ce.y;ve>=R&&ve<=B&&Z.push([ce])}return Z})(p,f,v,S);case 2:return m8(p,f,v,S,!1);case 3:return m8(p,f,v,S,!0)}return[]}function $ae(p,l,f,v,S){const k=v===0?qae:Hae;let R=[];const B=[];for(let ie=0;ie<p.length-1;ie++){const ce=p[ie],ve=p[ie+1],Se=v===0?ce.x:ce.y,Ne=v===0?ve.x:ve.y;let ze=!1;Se<l?Ne>l&&R.push(k(ce,ve,l)):Se>f?Ne<f&&R.push(k(ce,ve,f)):R.push(ce),Ne<l&&Se>=l&&(R.push(k(ce,ve,l)),ze=!0),Ne>f&&Se<=f&&(R.push(k(ce,ve,f)),ze=!0),!S&&ze&&(B.push(R),R=[])}const V=p.length-1,Z=v===0?p[V].x:p[V].y;return Z>=l&&Z<=f&&R.push(p[V]),S&&R.length>0&&!R[0].equals(R[R.length-1])&&R.push(new c(R[0].x,R[0].y)),R.length>0&&B.push(R),B}function m8(p,l,f,v,S){const k=[];for(const R of p){const B=$ae(R,l,f,v,S);B.length>0&&k.push(...B)}return k}function qae(p,l,f){return new c(f,p.y+(f-p.x)/(l.x-p.x)*(l.y-p.y))}function Hae(p,l,f){return new c(p.x+(f-p.y)/(l.y-p.y)*(l.x-p.x),f)}Pt("FeatureIndex",f8,{omit:["rawTileData","sourceLayerCoder"]});class Yp extends c{constructor(l,f,v,S){super(l,f),this.angle=v,S!==void 0&&(this.segment=S)}clone(){return new Yp(this.x,this.y,this.angle,this.segment)}}function y8(p,l,f,v,S){if(l.segment===void 0||f===0)return!0;let k=l,R=l.segment+1,B=0;for(;B>-f/2;){if(R--,R<0)return!1;B-=p[R].dist(k),k=p[R]}B+=p[R].dist(p[R+1]),R++;const V=[];let Z=0;for(;B<f/2;){const ie=p[R],ce=p[R+1];if(!ce)return!1;let ve=p[R-1].angleTo(ie)-ie.angleTo(ce);for(ve=Math.abs((ve+3*Math.PI)%(2*Math.PI)-Math.PI),V.push({distance:B,angleDelta:ve}),Z+=ve;B-V[0].distance>v;)Z-=V.shift().angleDelta;if(Z>S)return!1;R++,B+=ie.dist(ce)}return!0}function v8(p){let l=0;for(let f=0;f<p.length-1;f++)l+=p[f].dist(p[f+1]);return l}function _8(p,l,f){return p?.6*l*f:0}function b8(p,l){return Math.max(p?p.right-p.left:0,l?l.right-l.left:0)}function Wae(p,l,f,v,S,k){const R=_8(f,S,k),B=b8(f,v)*k;let V=0;const Z=v8(p)/2;for(let ie=0;ie<p.length-1;ie++){const ce=p[ie],ve=p[ie+1],Se=ce.dist(ve);if(V+Se>Z){const Ne=(Z-V)/Se,ze=Hn.number(ce.x,ve.x,Ne),Ve=Hn.number(ce.y,ve.y,Ne),et=new Yp(ze,Ve,ve.angleTo(ce),ie);return et._round(),!R||y8(p,et,B,R,l)?et:void 0}V+=Se}}function Gae(p,l,f,v,S,k,R,B,V){const Z=_8(v,k,R),ie=b8(v,S),ce=ie*R,ve=p[0].x===0||p[0].x===V||p[0].y===0||p[0].y===V;return l-ce<l/4&&(l=ce+l/4),x8(p,ve?l/2*B%l:(ie/2+2*k)*R*B%l,l,Z,f,ce,ve,!1,V)}function x8(p,l,f,v,S,k,R,B,V){const Z=k/2,ie=v8(p);let ce=0,ve=l-f,Se=[];for(let Ne=0;Ne<p.length-1;Ne++){const ze=p[Ne],Ve=p[Ne+1],et=ze.dist(Ve),Ct=Ve.angleTo(ze);for(;ve+f<ce+et;){ve+=f;const nt=(ve-ce)/et,ut=Hn.number(ze.x,Ve.x,nt),Rt=Hn.number(ze.y,Ve.y,nt);if(ut>=0&&ut<V&&Rt>=0&&Rt<V&&ve-Z>=0&&ve+Z<=ie){const Ft=new Yp(ut,Rt,Ct,Ne);Ft._round(),v&&!y8(p,Ft,k,v,S)||Se.push(Ft)}}ce+=et}return B||Se.length||R||(Se=x8(p,ce/2,f,v,S,k,R,!0,V)),Se}function w8(p,l,f,v){const S=[],k=p.image,R=k.pixelRatio,B=k.paddedRect.w-2,V=k.paddedRect.h-2;let Z={x1:p.left,y1:p.top,x2:p.right,y2:p.bottom};const ie=k.stretchX||[[0,B]],ce=k.stretchY||[[0,V]],ve=(Er,Cn)=>Er+Cn[1]-Cn[0],Se=ie.reduce(ve,0),Ne=ce.reduce(ve,0),ze=B-Se,Ve=V-Ne;let et=0,Ct=Se,nt=0,ut=Ne,Rt=0,Ft=ze,fr=0,Or=Ve;if(k.content&&v){const Er=k.content,Cn=Er[2]-Er[0],xn=Er[3]-Er[1];(k.textFitWidth||k.textFitHeight)&&(Z=yF(p)),et=R2(ie,0,Er[0]),nt=R2(ce,0,Er[1]),Ct=R2(ie,Er[0],Er[2]),ut=R2(ce,Er[1],Er[3]),Rt=Er[0]-et,fr=Er[1]-nt,Ft=Cn-Ct,Or=xn-ut}const Pr=Z.x1,Vr=Z.y1,pn=Z.x2-Pr,Gr=Z.y2-Vr,Rr=(Er,Cn,xn,kn)=>{const vn=M2(Er.stretch-et,Ct,pn,Pr),Wn=D2(Er.fixed-Rt,Ft,Er.stretch,Se),la=M2(Cn.stretch-nt,ut,Gr,Vr),Hi=D2(Cn.fixed-fr,Or,Cn.stretch,Ne),Po=M2(xn.stretch-et,Ct,pn,Pr),Ql=D2(xn.fixed-Rt,Ft,xn.stretch,Se),Ms=M2(kn.stretch-nt,ut,Gr,Vr),ko=D2(kn.fixed-fr,Or,kn.stretch,Ne),vo=new c(vn,la),Ta=new c(Po,la),Yo=new c(Po,Ms),os=new c(vn,Ms),uo=new c(Wn/R,Hi/R),uc=new c(Ql/R,ko/R),eu=l*Math.PI/180;if(eu){const vl=Math.sin(eu),Fo=Math.cos(eu),Ds=[Fo,-vl,vl,Fo];vo._matMult(Ds),Ta._matMult(Ds),os._matMult(Ds),Yo._matMult(Ds)}const cc=Er.stretch+Er.fixed,Ch=Cn.stretch+Cn.fixed;return{tl:vo,tr:Ta,bl:os,br:Yo,tex:{x:k.paddedRect.x+1+cc,y:k.paddedRect.y+1+Ch,w:xn.stretch+xn.fixed-cc,h:kn.stretch+kn.fixed-Ch},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:uo,pixelOffsetBR:uc,minFontScaleX:Ft/R/pn,minFontScaleY:Or/R/Gr,isSDF:f}};if(v&&(k.stretchX||k.stretchY)){const Er=S8(ie,ze,Se),Cn=S8(ce,Ve,Ne);for(let xn=0;xn<Er.length-1;xn++){const kn=Er[xn],vn=Er[xn+1];for(let Wn=0;Wn<Cn.length-1;Wn++)S.push(Rr(kn,Cn[Wn],vn,Cn[Wn+1]))}}else S.push(Rr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:B+1},{fixed:0,stretch:V+1}));return S}function R2(p,l,f){let v=0;for(const S of p)v+=Math.max(l,Math.min(f,S[1]))-Math.max(l,Math.min(f,S[0]));return v}function S8(p,l,f){const v=[{fixed:-1,stretch:0}];for(const[S,k]of p){const R=v[v.length-1];v.push({fixed:S-R.stretch,stretch:R.stretch}),v.push({fixed:S-R.stretch,stretch:R.stretch+(k-S)})}return v.push({fixed:l+1,stretch:f}),v}function M2(p,l,f,v){return p/l*f+v}function D2(p,l,f,v){return p-l*f/v}Pt("Anchor",Yp);class O2{constructor(l,f,v,S,k,R,B,V,Z,ie){var ce;if(this.boxStartIndex=l.length,Z){let ve=R.top,Se=R.bottom;const Ne=R.collisionPadding;Ne&&(ve-=Ne[1],Se+=Ne[3]);let ze=Se-ve;ze>0&&(ze=Math.max(10,ze),this.circleDiameter=ze)}else{const ve=!((ce=R.image)===null||ce===void 0)&&ce.content&&(R.image.textFitWidth||R.image.textFitHeight)?yF(R):{x1:R.left,y1:R.top,x2:R.right,y2:R.bottom};ve.y1=ve.y1*B-V[0],ve.y2=ve.y2*B+V[2],ve.x1=ve.x1*B-V[3],ve.x2=ve.x2*B+V[1];const Se=R.collisionPadding;if(Se&&(ve.x1-=Se[0]*B,ve.y1-=Se[1]*B,ve.x2+=Se[2]*B,ve.y2+=Se[3]*B),ie){const Ne=new c(ve.x1,ve.y1),ze=new c(ve.x2,ve.y1),Ve=new c(ve.x1,ve.y2),et=new c(ve.x2,ve.y2),Ct=ie*Math.PI/180;Ne._rotate(Ct),ze._rotate(Ct),Ve._rotate(Ct),et._rotate(Ct),ve.x1=Math.min(Ne.x,ze.x,Ve.x,et.x),ve.x2=Math.max(Ne.x,ze.x,Ve.x,et.x),ve.y1=Math.min(Ne.y,ze.y,Ve.y,et.y),ve.y2=Math.max(Ne.y,ze.y,Ve.y,et.y)}l.emplaceBack(f.x,f.y,ve.x1,ve.y1,ve.x2,ve.y2,v,S,k)}this.boxEndIndex=l.length}}class Xae{constructor(l=[],f=(v,S)=>v<S?-1:v>S?1:0){if(this.data=l,this.length=this.data.length,this.compare=f,this.length>0)for(let v=(this.length>>1)-1;v>=0;v--)this._down(v)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],f=this.data.pop();return--this.length>0&&(this.data[0]=f,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:f,compare:v}=this,S=f[l];for(;l>0;){const k=l-1>>1,R=f[k];if(v(S,R)>=0)break;f[l]=R,l=k}f[l]=S}_down(l){const{data:f,compare:v}=this,S=this.length>>1,k=f[l];for(;l<S;){let R=1+(l<<1);const B=R+1;if(B<this.length&&v(f[B],f[R])<0&&(R=B),v(f[R],k)>=0)break;f[l]=f[R],l=R}f[l]=k}}function Yae(p,l=1,f=!1){const v=nm.fromPoints(p[0]),S=Math.min(v.width(),v.height());let k=S/2;const R=new Xae([],Zae),{minX:B,minY:V,maxX:Z,maxY:ie}=v;if(S===0)return new c(B,V);for(let Se=B;Se<Z;Se+=S)for(let Ne=V;Ne<ie;Ne+=S)R.push(new nv(Se+k,Ne+k,k,p));let ce=(function(Se){let Ne=0,ze=0,Ve=0;const et=Se[0];for(let Ct=0,nt=et.length,ut=nt-1;Ct<nt;ut=Ct++){const Rt=et[Ct],Ft=et[ut],fr=Rt.x*Ft.y-Ft.x*Rt.y;ze+=(Rt.x+Ft.x)*fr,Ve+=(Rt.y+Ft.y)*fr,Ne+=3*fr}return new nv(ze/Ne,Ve/Ne,0,Se)})(p),ve=R.length;for(;R.length;){const Se=R.pop();(Se.d>ce.d||!ce.d)&&(ce=Se,f&&console.log("found best %d after %d probes",Math.round(1e4*Se.d)/1e4,ve)),Se.max-ce.d<=l||(k=Se.h/2,R.push(new nv(Se.p.x-k,Se.p.y-k,k,p)),R.push(new nv(Se.p.x+k,Se.p.y-k,k,p)),R.push(new nv(Se.p.x-k,Se.p.y+k,k,p)),R.push(new nv(Se.p.x+k,Se.p.y+k,k,p)),ve+=4)}return f&&(console.log(`num probes: ${ve}`),console.log(`best distance: ${ce.d}`)),ce.p}function Zae(p,l){return l.max-p.max}function nv(p,l,f,v){this.p=new c(p,l),this.h=f,this.d=(function(S,k){let R=!1,B=1/0;for(let V=0;V<k.length;V++){const Z=k[V];for(let ie=0,ce=Z.length,ve=ce-1;ie<ce;ve=ie++){const Se=Z[ie],Ne=Z[ve];Se.y>S.y!=Ne.y>S.y&&S.x<(Ne.x-Se.x)*(S.y-Se.y)/(Ne.y-Se.y)+Se.x&&(R=!R),B=Math.min(B,I6(S,Se,Ne))}}return(R?1:-1)*Math.sqrt(B)})(this.p,v),this.max=this.d+this.h*Math.SQRT2}var Jl;s.aP=void 0,(Jl=s.aP||(s.aP={}))[Jl.center=1]="center",Jl[Jl.left=2]="left",Jl[Jl.right=3]="right",Jl[Jl.top=4]="top",Jl[Jl.bottom=5]="bottom",Jl[Jl["top-left"]=6]="top-left",Jl[Jl["top-right"]=7]="top-right",Jl[Jl["bottom-left"]=8]="bottom-left",Jl[Jl["bottom-right"]=9]="bottom-right";const $C=Number.POSITIVE_INFINITY;function E8(p,l){return l[1]!==$C?(function(f,v,S){let k=0,R=0;switch(v=Math.abs(v),S=Math.abs(S),f){case"top-right":case"top-left":case"top":R=S-7;break;case"bottom-right":case"bottom-left":case"bottom":R=7-S}switch(f){case"top-right":case"bottom-right":case"right":k=-v;break;case"top-left":case"bottom-left":case"left":k=v}return[k,R]})(p,l[0],l[1]):(function(f,v){let S=0,k=0;v<0&&(v=0);const R=v/Math.SQRT2;switch(f){case"top-right":case"top-left":k=R-7;break;case"bottom-right":case"bottom-left":k=7-R;break;case"bottom":k=7-v;break;case"top":k=v-7}switch(f){case"top-right":case"bottom-right":S=-R;break;case"top-left":case"bottom-left":S=R;break;case"left":S=v;break;case"right":S=-v}return[S,k]})(p,l[0])}function T8(p,l,f){var v;const S=p.layout,k=(v=S.get("text-variable-anchor-offset"))===null||v===void 0?void 0:v.evaluate(l,{},f);if(k){const B=k.values,V=[];for(let Z=0;Z<B.length;Z+=2){const ie=V[Z]=B[Z],ce=B[Z+1].map((ve=>ve*gl));ie.startsWith("top")?ce[1]-=7:ie.startsWith("bottom")&&(ce[1]+=7),V[Z+1]=ce}return new ba(V)}const R=S.get("text-variable-anchor");if(R){let B;B=p._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[S.get("text-radial-offset").evaluate(l,{},f)*gl,$C]:S.get("text-offset").evaluate(l,{},f).map((Z=>Z*gl));const V=[];for(const Z of R)V.push(Z,E8(Z,B));return new ba(V)}return null}function qC(p){switch(p){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Kae(p,l,f,v,S,k,R,B,V,Z,ie,ce){let ve=k.textMaxSize.evaluate(l,{});ve===void 0&&(ve=R);const Se=p.layers[0].layout,Ne=Se.get("icon-offset").evaluate(l,{},ie),ze=A8(f.horizontal),Ve=R/24,et=p.tilePixelRatio*Ve,Ct=p.tilePixelRatio*ve/24,nt=p.tilePixelRatio*B,ut=p.tilePixelRatio*Se.get("symbol-spacing"),Rt=Se.get("text-padding")*p.tilePixelRatio,Ft=(function(xn,kn,vn,Wn=1){const la=xn.get("icon-padding").evaluate(kn,{},vn),Hi=la&&la.values;return[Hi[0]*Wn,Hi[1]*Wn,Hi[2]*Wn,Hi[3]*Wn]})(Se,l,ie,p.tilePixelRatio),fr=Se.get("text-max-angle")/180*Math.PI,Or=Se.get("text-rotation-alignment")!=="viewport"&&Se.get("symbol-placement")!=="point",Pr=Se.get("icon-rotation-alignment")==="map"&&Se.get("symbol-placement")!=="point",Vr=Se.get("symbol-placement"),pn=ut/2,Gr=Se.get("icon-text-fit");let Rr;v&&Gr!=="none"&&(p.allowVerticalPlacement&&f.vertical&&(Rr=vF(v,f.vertical,Gr,Se.get("icon-text-fit-padding"),Ne,Ve)),ze&&(v=vF(v,ze,Gr,Se.get("icon-text-fit-padding"),Ne,Ve)));const Er=ie?ce.line.getGranularityForZoomLevel(ie.z):1,Cn=(xn,kn)=>{kn.x<0||kn.x>=xe||kn.y<0||kn.y>=xe||(function(vn,Wn,la,Hi,Po,Ql,Ms,ko,vo,Ta,Yo,os,uo,uc,eu,cc,Ch,vl,Fo,Ds,Zo,_l,Xd,cf,Z_){const Zp=vn.addToLineVertexArray(Wn,la);let om,iv,av,ov,R8=0,M8=0,D8=0,O8=0,JC=-1,QC=-1;const Yd={};let N8=as("");if(vn.allowVerticalPlacement&&Hi.vertical){const vu=ko.layout.get("text-rotate").evaluate(Zo,{},cf)+90;av=new O2(vo,Wn,Ta,Yo,os,Hi.vertical,uo,uc,eu,vu),Ms&&(ov=new O2(vo,Wn,Ta,Yo,os,Ms,Ch,vl,eu,vu))}if(Po){const vu=ko.layout.get("icon-rotate").evaluate(Zo,{}),Zc=ko.layout.get("icon-text-fit")!=="none",sm=w8(Po,vu,Xd,Zc),ff=Ms?w8(Ms,vu,Xd,Zc):void 0;iv=new O2(vo,Wn,Ta,Yo,os,Po,Ch,vl,!1,vu),R8=4*sm.length;const lm=vn.iconSizeData;let Jf=null;lm.kind==="source"?(Jf=[Wd*ko.layout.get("icon-size").evaluate(Zo,{})],Jf[0]>Wp&&st(`${vn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):lm.kind==="composite"&&(Jf=[Wd*_l.compositeIconSizes[0].evaluate(Zo,{},cf),Wd*_l.compositeIconSizes[1].evaluate(Zo,{},cf)],(Jf[0]>Wp||Jf[1]>Wp)&&st(`${vn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),vn.addSymbols(vn.icon,sm,Jf,Ds,Fo,Zo,s.az.none,Wn,Zp.lineStartIndex,Zp.lineLength,-1,cf),JC=vn.icon.placedSymbolArray.length-1,ff&&(M8=4*ff.length,vn.addSymbols(vn.icon,ff,Jf,Ds,Fo,Zo,s.az.vertical,Wn,Zp.lineStartIndex,Zp.lineLength,-1,cf),QC=vn.icon.placedSymbolArray.length-1)}const L8=Object.keys(Hi.horizontal);for(const vu of L8){const Zc=Hi.horizontal[vu];if(!om){N8=as(Zc.text);const ff=ko.layout.get("text-rotate").evaluate(Zo,{},cf);om=new O2(vo,Wn,Ta,Yo,os,Zc,uo,uc,eu,ff)}const sm=Zc.positionedLines.length===1;if(D8+=C8(vn,Wn,Zc,Ql,ko,eu,Zo,cc,Zp,Hi.vertical?s.az.horizontal:s.az.horizontalOnly,sm?L8:[vu],Yd,JC,_l,cf),sm)break}Hi.vertical&&(O8+=C8(vn,Wn,Hi.vertical,Ql,ko,eu,Zo,cc,Zp,s.az.vertical,["vertical"],Yd,QC,_l,cf));const eoe=om?om.boxStartIndex:vn.collisionBoxArray.length,toe=om?om.boxEndIndex:vn.collisionBoxArray.length,roe=av?av.boxStartIndex:vn.collisionBoxArray.length,noe=av?av.boxEndIndex:vn.collisionBoxArray.length,ioe=iv?iv.boxStartIndex:vn.collisionBoxArray.length,aoe=iv?iv.boxEndIndex:vn.collisionBoxArray.length,ooe=ov?ov.boxStartIndex:vn.collisionBoxArray.length,soe=ov?ov.boxEndIndex:vn.collisionBoxArray.length;let hf=-1;const L2=(vu,Zc)=>vu&&vu.circleDiameter?Math.max(vu.circleDiameter,Zc):Zc;hf=L2(om,hf),hf=L2(av,hf),hf=L2(iv,hf),hf=L2(ov,hf);const F8=hf>-1?1:0;F8&&(hf*=Z_/gl),vn.glyphOffsetArray.length>=Ky.MAX_GLYPHS&&st("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Zo.sortKey!==void 0&&vn.addToSortKeyRanges(vn.symbolInstances.length,Zo.sortKey);const loe=T8(ko,Zo,cf),[uoe,coe]=(function(vu,Zc){const sm=vu.length,ff=Zc?.values;if(ff?.length>0)for(let lm=0;lm<ff.length;lm+=2){const Jf=ff[lm+1];vu.emplaceBack(s.aP[ff[lm]],Jf[0],Jf[1])}return[sm,vu.length]})(vn.textAnchorOffsets,loe);vn.symbolInstances.emplaceBack(Wn.x,Wn.y,Yd.right>=0?Yd.right:-1,Yd.center>=0?Yd.center:-1,Yd.left>=0?Yd.left:-1,Yd.vertical||-1,JC,QC,N8,eoe,toe,roe,noe,ioe,aoe,ooe,soe,Ta,D8,O8,R8,M8,F8,0,uo,hf,uoe,coe)})(p,kn,xn,f,v,S,Rr,p.layers[0],p.collisionBoxArray,l.index,l.sourceLayerIndex,p.index,et,[Rt,Rt,Rt,Rt],Or,V,nt,Ft,Pr,Ne,l,k,Z,ie,R)};if(Vr==="line")for(const xn of p8(l.geometry,0,0,xe,xe)){const kn=rm(xn,Er),vn=Gae(kn,ut,fr,f.vertical||ze,v,24,Ct,p.overscaling,xe);for(const Wn of vn)ze&&Jae(p,ze.text,pn,Wn)||Cn(kn,Wn)}else if(Vr==="line-center"){for(const xn of l.geometry)if(xn.length>1){const kn=rm(xn,Er),vn=Wae(kn,fr,f.vertical||ze,v,24,Ct);vn&&Cn(kn,vn)}}else if(l.type==="Polygon")for(const xn of Vl(l.geometry,0)){const kn=Yae(xn,16);Cn(rm(xn[0],Er,!0),new Yp(kn.x,kn.y,0))}else if(l.type==="LineString")for(const xn of l.geometry){const kn=rm(xn,Er);Cn(kn,new Yp(kn[0].x,kn[0].y,0))}else if(l.type==="Point")for(const xn of l.geometry)for(const kn of xn)Cn([kn],new Yp(kn.x,kn.y,0))}function C8(p,l,f,v,S,k,R,B,V,Z,ie,ce,ve,Se,Ne){const ze=(function(Ct,nt,ut,Rt,Ft,fr,Or,Pr){const Vr=Rt.layout.get("text-rotate").evaluate(fr,{})*Math.PI/180,pn=[];for(const Gr of nt.positionedLines)for(const Rr of Gr.positionedGlyphs){if(!Rr.rect)continue;const Er=Rr.rect||{};let Cn=4,xn=!0,kn=1,vn=0;const Wn=(Ft||Pr)&&Rr.vertical,la=Rr.metrics.advance*Rr.scale/2;if(Pr&&nt.verticalizable&&(vn=Gr.lineOffset/2-(Rr.imageName?-(gl-Rr.metrics.width*Rr.scale)/2:(Rr.scale-1)*gl)),Rr.imageName){const vl=Or[Rr.imageName];xn=vl.sdf,kn=vl.pixelRatio,Cn=1/kn}const Hi=Ft?[Rr.x+la,Rr.y]:[0,0];let Po=Ft?[0,0]:[Rr.x+la+ut[0],Rr.y+ut[1]-vn],Ql=[0,0];Wn&&(Ql=Po,Po=[0,0]);const Ms=Rr.metrics.isDoubleResolution?2:1,ko=(Rr.metrics.left-Cn)*Rr.scale-la+Po[0],vo=(-Rr.metrics.top-Cn)*Rr.scale+Po[1],Ta=ko+Er.w/Ms*Rr.scale/kn,Yo=vo+Er.h/Ms*Rr.scale/kn,os=new c(ko,vo),uo=new c(Ta,vo),uc=new c(ko,Yo),eu=new c(Ta,Yo);if(Wn){const vl=new c(-la,la- -17),Fo=-Math.PI/2,Ds=12-la,Zo=new c(22-Ds,-(Rr.imageName?Ds:0)),_l=new c(...Ql);os._rotateAround(Fo,vl)._add(Zo)._add(_l),uo._rotateAround(Fo,vl)._add(Zo)._add(_l),uc._rotateAround(Fo,vl)._add(Zo)._add(_l),eu._rotateAround(Fo,vl)._add(Zo)._add(_l)}if(Vr){const vl=Math.sin(Vr),Fo=Math.cos(Vr),Ds=[Fo,-vl,vl,Fo];os._matMult(Ds),uo._matMult(Ds),uc._matMult(Ds),eu._matMult(Ds)}const cc=new c(0,0),Ch=new c(0,0);pn.push({tl:os,tr:uo,bl:uc,br:eu,tex:Er,writingMode:nt.writingMode,glyphOffset:Hi,sectionIndex:Rr.sectionIndex,isSDF:xn,pixelOffsetTL:cc,pixelOffsetBR:Ch,minFontScaleX:0,minFontScaleY:0})}return pn})(0,f,B,S,k,R,v,p.allowVerticalPlacement),Ve=p.textSizeData;let et=null;Ve.kind==="source"?(et=[Wd*S.layout.get("text-size").evaluate(R,{})],et[0]>Wp&&st(`${p.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Ve.kind==="composite"&&(et=[Wd*Se.compositeTextSizes[0].evaluate(R,{},Ne),Wd*Se.compositeTextSizes[1].evaluate(R,{},Ne)],(et[0]>Wp||et[1]>Wp)&&st(`${p.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),p.addSymbols(p.text,ze,et,B,k,R,Z,l,V.lineStartIndex,V.lineLength,ve,Ne);for(const Ct of ie)ce[Ct]=p.text.placedSymbolArray.length-1;return 4*ze.length}function A8(p){for(const l in p)return p[l];return null}function Jae(p,l,f,v){const S=p.compareText;if(l in S){const k=S[l];for(let R=k.length-1;R>=0;R--)if(v.dist(k[R])<f)return!0}else S[l]=[];return S[l].push(v),!1}const I8=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class HC{static from(l){if(!(l instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[f,v]=new Uint8Array(l,0,2);if(f!==219)throw new Error("Data does not appear to be in a KDBush format.");const S=v>>4;if(S!==1)throw new Error(`Got v${S} data when expected v1.`);const k=I8[15&v];if(!k)throw new Error("Unrecognized array type.");const[R]=new Uint16Array(l,2,1),[B]=new Uint32Array(l,4,1);return new HC(B,R,k,l)}constructor(l,f=64,v=Float64Array,S){if(isNaN(l)||l<0)throw new Error(`Unpexpected numItems value: ${l}.`);this.numItems=+l,this.nodeSize=Math.min(Math.max(+f,2),65535),this.ArrayType=v,this.IndexArrayType=l<65536?Uint16Array:Uint32Array;const k=I8.indexOf(this.ArrayType),R=2*l*this.ArrayType.BYTES_PER_ELEMENT,B=l*this.IndexArrayType.BYTES_PER_ELEMENT,V=(8-B%8)%8;if(k<0)throw new Error(`Unexpected typed array class: ${v}.`);S&&S instanceof ArrayBuffer?(this.data=S,this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+B+V,2*l),this._pos=2*l,this._finished=!0):(this.data=new ArrayBuffer(8+R+B+V),this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+B+V,2*l),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+k]),new Uint16Array(this.data,2,1)[0]=f,new Uint32Array(this.data,4,1)[0]=l)}add(l,f){const v=this._pos>>1;return this.ids[v]=v,this.coords[this._pos++]=l,this.coords[this._pos++]=f,v}finish(){const l=this._pos>>1;if(l!==this.numItems)throw new Error(`Added ${l} items when expected ${this.numItems}.`);return WC(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(l,f,v,S){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:k,coords:R,nodeSize:B}=this,V=[0,k.length-1,0],Z=[];for(;V.length;){const ie=V.pop()||0,ce=V.pop()||0,ve=V.pop()||0;if(ce-ve<=B){for(let Ve=ve;Ve<=ce;Ve++){const et=R[2*Ve],Ct=R[2*Ve+1];et>=l&&et<=v&&Ct>=f&&Ct<=S&&Z.push(k[Ve])}continue}const Se=ve+ce>>1,Ne=R[2*Se],ze=R[2*Se+1];Ne>=l&&Ne<=v&&ze>=f&&ze<=S&&Z.push(k[Se]),(ie===0?l<=Ne:f<=ze)&&(V.push(ve),V.push(Se-1),V.push(1-ie)),(ie===0?v>=Ne:S>=ze)&&(V.push(Se+1),V.push(ce),V.push(1-ie))}return Z}within(l,f,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:S,coords:k,nodeSize:R}=this,B=[0,S.length-1,0],V=[],Z=v*v;for(;B.length;){const ie=B.pop()||0,ce=B.pop()||0,ve=B.pop()||0;if(ce-ve<=R){for(let Ve=ve;Ve<=ce;Ve++)k8(k[2*Ve],k[2*Ve+1],l,f)<=Z&&V.push(S[Ve]);continue}const Se=ve+ce>>1,Ne=k[2*Se],ze=k[2*Se+1];k8(Ne,ze,l,f)<=Z&&V.push(S[Se]),(ie===0?l-v<=Ne:f-v<=ze)&&(B.push(ve),B.push(Se-1),B.push(1-ie)),(ie===0?l+v>=Ne:f+v>=ze)&&(B.push(Se+1),B.push(ce),B.push(1-ie))}return V}}function WC(p,l,f,v,S,k){if(S-v<=f)return;const R=v+S>>1;P8(p,l,R,v,S,k),WC(p,l,f,v,R-1,1-k),WC(p,l,f,R+1,S,1-k)}function P8(p,l,f,v,S,k){for(;S>v;){if(S-v>600){const Z=S-v+1,ie=f-v+1,ce=Math.log(Z),ve=.5*Math.exp(2*ce/3),Se=.5*Math.sqrt(ce*ve*(Z-ve)/Z)*(ie-Z/2<0?-1:1);P8(p,l,f,Math.max(v,Math.floor(f-ie*ve/Z+Se)),Math.min(S,Math.floor(f+(Z-ie)*ve/Z+Se)),k)}const R=l[2*f+k];let B=v,V=S;for(X_(p,l,v,f),l[2*S+k]>R&&X_(p,l,v,S);B<V;){for(X_(p,l,B,V),B++,V--;l[2*B+k]<R;)B++;for(;l[2*V+k]>R;)V--}l[2*v+k]===R?X_(p,l,v,V):(V++,X_(p,l,V,S)),V<=f&&(v=V+1),f<=V&&(S=V-1)}}function X_(p,l,f,v){GC(p,f,v),GC(l,2*f,2*v),GC(l,2*f+1,2*v+1)}function GC(p,l,f){const v=p[l];p[l]=p[f],p[f]=v}function k8(p,l,f,v){const S=p-f,k=l-v;return S*S+k*k}var XC;s.cH=void 0,(XC=s.cH||(s.cH={})).create="create",XC.load="load",XC.fullLoad="fullLoad";let N2=null,Y_=[];const YC=1e3/60,ZC="loadTime",KC="fullLoadTime",Qae={mark(p){performance.mark(p)},frame(p){const l=p;N2!=null&&Y_.push(l-N2),N2=l},clearMetrics(){N2=null,Y_=[],performance.clearMeasures(ZC),performance.clearMeasures(KC);for(const p in s.cH)performance.clearMarks(s.cH[p])},getPerformanceMetrics(){performance.measure(ZC,s.cH.create,s.cH.load),performance.measure(KC,s.cH.create,s.cH.fullLoad);const p=performance.getEntriesByName(ZC)[0].duration,l=performance.getEntriesByName(KC)[0].duration,f=Y_.length,v=1/(Y_.reduce(((k,R)=>k+R),0)/f/1e3),S=Y_.filter((k=>k>YC)).reduce(((k,R)=>k+(R-YC)/YC),0);return{loadTime:p,fullLoadTime:l,fps:v,percentDroppedFrames:S/(f+S)*100,totalFrames:f}}};s.$=A,s.A=N,s.B=Xt,s.C=Je,s.D=Tn,s.E=zr,s.F=function([p,l,f]){return l+=90,l*=Math.PI/180,f*=Math.PI/180,{x:p*Math.cos(l)*Math.sin(f),y:p*Math.sin(l)*Math.sin(f),z:p*Math.cos(f)}},s.G=Hn,s.H=ki,s.I=yC,s.J=lt,s.K=function(p){if(Ht==null){const l=p.navigator?p.navigator.userAgent:null;Ht=!!p.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return Ht},s.L=class{constructor(p,l){this.target=p,this.mapId=l,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new pae((()=>this.process())),this.subscription=Cr(this.target,"message",(f=>this.receive(f)),!1),this.globalScope=Jt(self)?p:window}registerMessageHandler(p,l){this.messageHandlers[p]=l}unregisterMessageHandler(p){delete this.messageHandlers[p]}sendAsync(p,l){return new Promise(((f,v)=>{const S=Math.round(1e18*Math.random()).toString(36).substring(0,10),k=l?Cr(l.signal,"abort",(()=>{k?.unsubscribe(),delete this.resolveRejects[S];const V={id:S,type:"<cancel>",origin:location.origin,targetMapId:p.targetMapId,sourceMapId:this.mapId};this.target.postMessage(V)}),gae):null;this.resolveRejects[S]={resolve:V=>{k?.unsubscribe(),f(V)},reject:V=>{k?.unsubscribe(),v(V)}};const R=[],B=Object.assign(Object.assign({},p),{id:S,sourceMapId:this.mapId,origin:location.origin,data:Br(p.data,R)});this.target.postMessage(B,{transfer:R})}))}receive(p){const l=p.data,f=l.id;if(!(l.origin!=="file://"&&location.origin!=="file://"&&l.origin!=="resource://android"&&location.origin!=="resource://android"&&l.origin!==location.origin||l.targetMapId&&this.mapId!==l.targetMapId)){if(l.type==="<cancel>"){delete this.tasks[f];const v=this.abortControllers[f];return delete this.abortControllers[f],void(v&&v.abort())}if(Jt(self)||l.mustQueue)return this.tasks[f]=l,this.taskQueue.push(f),void this.invoker.trigger();this.processTask(f,l)}}process(){if(this.taskQueue.length===0)return;const p=this.taskQueue.shift(),l=this.tasks[p];delete this.tasks[p],this.taskQueue.length>0&&this.invoker.trigger(),l&&this.processTask(p,l)}processTask(p,l){return o(this,void 0,void 0,(function*(){if(l.type==="<response>"){const S=this.resolveRejects[p];return delete this.resolveRejects[p],S?void(l.error?S.reject(jr(l.error)):S.resolve(jr(l.data))):void 0}if(!this.messageHandlers[l.type])return void this.completeTask(p,new Error(`Could not find a registered handler for ${l.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const f=jr(l.data),v=new AbortController;this.abortControllers[p]=v;try{const S=yield this.messageHandlers[l.type](l.sourceMapId,f,v);this.completeTask(p,null,S)}catch(S){this.completeTask(p,S)}}))}completeTask(p,l,f){const v=[];delete this.abortControllers[p];const S={id:p,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:l?Br(l):null,data:Br(f,v)};this.target.postMessage(S,{transfer:v})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},s.M=Et,s.N=function(){var p=new N(16);return N!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=0,p[12]=0,p[13]=0,p[14]=0),p[0]=1,p[5]=1,p[10]=1,p[15]=1,p},s.O=function(p,l,f){var v,S,k,R,B,V,Z,ie,ce,ve,Se,Ne,ze=f[0],Ve=f[1],et=f[2];return l===p?(p[12]=l[0]*ze+l[4]*Ve+l[8]*et+l[12],p[13]=l[1]*ze+l[5]*Ve+l[9]*et+l[13],p[14]=l[2]*ze+l[6]*Ve+l[10]*et+l[14],p[15]=l[3]*ze+l[7]*Ve+l[11]*et+l[15]):(S=l[1],k=l[2],R=l[3],B=l[4],V=l[5],Z=l[6],ie=l[7],ce=l[8],ve=l[9],Se=l[10],Ne=l[11],p[0]=v=l[0],p[1]=S,p[2]=k,p[3]=R,p[4]=B,p[5]=V,p[6]=Z,p[7]=ie,p[8]=ce,p[9]=ve,p[10]=Se,p[11]=Ne,p[12]=v*ze+B*Ve+ce*et+l[12],p[13]=S*ze+V*Ve+ve*et+l[13],p[14]=k*ze+Z*Ve+Se*et+l[14],p[15]=R*ze+ie*Ve+Ne*et+l[15]),p},s.P=c,s.Q=function(p,l,f){var v=f[0],S=f[1],k=f[2];return p[0]=l[0]*v,p[1]=l[1]*v,p[2]=l[2]*v,p[3]=l[3]*v,p[4]=l[4]*S,p[5]=l[5]*S,p[6]=l[6]*S,p[7]=l[7]*S,p[8]=l[8]*k,p[9]=l[9]*k,p[10]=l[10]*k,p[11]=l[11]*k,p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15],p},s.R=lc,s.S=function(p,l,f){var v=l[0],S=l[1],k=l[2],R=l[3],B=l[4],V=l[5],Z=l[6],ie=l[7],ce=l[8],ve=l[9],Se=l[10],Ne=l[11],ze=l[12],Ve=l[13],et=l[14],Ct=l[15],nt=f[0],ut=f[1],Rt=f[2],Ft=f[3];return p[0]=nt*v+ut*B+Rt*ce+Ft*ze,p[1]=nt*S+ut*V+Rt*ve+Ft*Ve,p[2]=nt*k+ut*Z+Rt*Se+Ft*et,p[3]=nt*R+ut*ie+Rt*Ne+Ft*Ct,p[4]=(nt=f[4])*v+(ut=f[5])*B+(Rt=f[6])*ce+(Ft=f[7])*ze,p[5]=nt*S+ut*V+Rt*ve+Ft*Ve,p[6]=nt*k+ut*Z+Rt*Se+Ft*et,p[7]=nt*R+ut*ie+Rt*Ne+Ft*Ct,p[8]=(nt=f[8])*v+(ut=f[9])*B+(Rt=f[10])*ce+(Ft=f[11])*ze,p[9]=nt*S+ut*V+Rt*ve+Ft*Ve,p[10]=nt*k+ut*Z+Rt*Se+Ft*et,p[11]=nt*R+ut*ie+Rt*Ne+Ft*Ct,p[12]=(nt=f[12])*v+(ut=f[13])*B+(Rt=f[14])*ce+(Ft=f[15])*ze,p[13]=nt*S+ut*V+Rt*ve+Ft*Ve,p[14]=nt*k+ut*Z+Rt*Se+Ft*et,p[15]=nt*R+ut*ie+Rt*Ne+Ft*Ct,p},s.T=lC,s.U=function(p,l){const f={};for(let v=0;v<l.length;v++){const S=l[v];S in p&&(f[S]=p[S])}return f},s.V=Gp,s.W=Xe,s.X=AF,s.Y=CF,s.Z=qe,s._=o,s.a=je,s.a$=ae,s.a0=M,s.a1=vr,s.a2=Xc,s.a3=PF,s.a4=S2,s.a5=xe,s.a6=function(p,l,f){if(!p)return l||{};if(!l)return p||{};const v=DF(p),S=DF(l);(function(R,B){B.removeAll&&(R.add.clear(),R.update.clear(),R.remove.clear(),B.remove.clear());for(const V of B.remove)R.add.delete(V),R.update.delete(V);for(const[V,Z]of B.update){const ie=R.update.get(V);ie&&(B.update.set(V,mae(ie,Z)),R.update.delete(V))}})(v,S);const k={};if((v.removeAll||S.removeAll)&&(k.removeAll=!0),k.remove=new Set([...v.remove,...S.remove]),k.add=new Map([...v.add,...S.add]),k.update=new Map([...v.update,...S.update]),k.remove.size&&k.add.size)for(const R of k.add.keys())k.remove.delete(R);return(function(R){const B={};return R.removeAll&&(B.removeAll=R.removeAll),R.remove&&(B.remove=Array.from(R.remove)),R.add&&(B.add=Array.from(R.add.values())),R.update&&(B.update=Array.from(R.update.values())),B})(k)},s.a7=function(p,l){const f=new Map;if(p==null||p.type==null)return f;if(p.type==="Feature"){const v=CC(p,l);return v==null?void 0:(f.set(v,p),f)}if(p.type==="FeatureCollection"){const v=new Set;for(const S of p.features){const k=CC(S,l);if(k==null||v.has(k))return;v.add(k),f.set(k,S)}return f}},s.a8=function(p,l,f){var v,S;const k=[];if(l.removeAll)p.clear();else if(l.remove)for(const R of l.remove){const B=p.get(R);B&&(k.push(B.geometry),p.delete(R))}if(l.add)for(const R of l.add){const B=CC(R,f);if(B==null)continue;const V=p.get(B);V&&k.push(V.geometry),k.push(R.geometry),p.set(B,R)}if(l.update)for(const R of l.update){const B=p.get(R.id);if(!B)continue;const V=!!R.newGeometry,Z=R.removeAllProperties||((v=R.removeProperties)===null||v===void 0?void 0:v.length)>0||((S=R.addOrUpdateProperties)===null||S===void 0?void 0:S.length)>0;if(!V&&!Z)continue;k.push(B.geometry);const ie=Object.assign({},B);if(p.set(R.id,ie),V&&(k.push(R.newGeometry),ie.geometry=R.newGeometry),Z){if(ie.properties=R.removeAllProperties?{}:Object.assign({},ie.properties||{}),R.removeProperties)for(const ce of R.removeProperties)delete ie.properties[ce];if(R.addOrUpdateProperties)for(const{key:ce,value:ve}of R.addOrUpdateProperties)ie.properties[ce]=ve}}return k},s.a9=q_,s.aA=function(p,{uSize:l,uSizeT:f},{lowerSize:v,upperSize:S}){return p.kind==="source"?v/Wd:p.kind==="composite"?Hn.number(v/Wd,S/Wd,f):l},s.aB=function(p,l){var f=l[0],v=l[1],S=l[2],k=l[3],R=l[4],B=l[5],V=l[6],Z=l[7],ie=l[8],ce=l[9],ve=l[10],Se=l[11],Ne=l[12],ze=l[13],Ve=l[14],et=l[15],Ct=f*B-v*R,nt=f*V-S*R,ut=f*Z-k*R,Rt=v*V-S*B,Ft=v*Z-k*B,fr=S*Z-k*V,Or=ie*ze-ce*Ne,Pr=ie*Ve-ve*Ne,Vr=ie*et-Se*Ne,pn=ce*Ve-ve*ze,Gr=ce*et-Se*ze,Rr=ve*et-Se*Ve,Er=Ct*Rr-nt*Gr+ut*pn+Rt*Vr-Ft*Pr+fr*Or;return Er?(p[0]=(B*Rr-V*Gr+Z*pn)*(Er=1/Er),p[1]=(S*Gr-v*Rr-k*pn)*Er,p[2]=(ze*fr-Ve*Ft+et*Rt)*Er,p[3]=(ve*Ft-ce*fr-Se*Rt)*Er,p[4]=(V*Vr-R*Rr-Z*Pr)*Er,p[5]=(f*Rr-S*Vr+k*Pr)*Er,p[6]=(Ve*ut-Ne*fr-et*nt)*Er,p[7]=(ie*fr-ve*ut+Se*nt)*Er,p[8]=(R*Gr-B*Vr+Z*Or)*Er,p[9]=(v*Vr-f*Gr-k*Or)*Er,p[10]=(Ne*Ft-ze*ut+et*Ct)*Er,p[11]=(ce*ut-ie*Ft-Se*Ct)*Er,p[12]=(B*Pr-R*pn-V*Or)*Er,p[13]=(f*pn-v*Pr+S*Or)*Er,p[14]=(ze*nt-Ne*Rt-Ve*Ct)*Er,p[15]=(ie*Rt-ce*nt+ve*Ct)*Er,p):null},s.aC=Ce,s.aD=function(p){var l=p[0],f=p[1];return Math.sqrt(l*l+f*f)},s.aE=function(p){return p[0]=0,p[1]=0,p},s.aF=function(p,l,f){return p[0]=l[0]*f,p[1]=l[1]*f,p},s.aG=bC,s.aH=se,s.aI=function(p,l,f,v){const S=l.y-p.y,k=l.x-p.x,R=v.y-f.y,B=v.x-f.x,V=R*k-B*S;if(V===0)return null;const Z=(B*(p.y-f.y)-R*(p.x-f.x))/V;return new c(p.x+Z*k,p.y+Z*S)},s.aJ=p8,s.aK=$y,s.aL=function(p){let l=1/0,f=1/0,v=-1/0,S=-1/0;for(const k of p)l=Math.min(l,k.x),f=Math.min(f,k.y),v=Math.max(v,k.x),S=Math.max(S,k.y);return[l,f,v,S]},s.aM=gl,s.aN=Ae,s.aO=function(p,l,f,v,S=!1){if(!f[0]&&!f[1])return[0,0];const k=S?v==="map"?-p.bearingInRadians:0:v==="viewport"?p.bearingInRadians:0;if(k){const R=Math.sin(k),B=Math.cos(k);f=[f[0]*B-f[1]*R,f[0]*R+f[1]*B]}return[S?f[0]:Ae(l,f[0],p.zoom),S?f[1]:Ae(l,f[1],p.zoom)]},s.aQ=_C,s.aR=qC,s.aS=vC,s.aT=HC,s.aU=pa,s.aV=y2,s.aW=ft,s.aX=gn,s.aY=xr,s.aZ=Qt,s.a_=kF,s.aa=nm,s.ab=25,s.ac=TC,s.ad=p=>{const l=window.document.createElement("video");return l.muted=!0,new Promise((f=>{l.onloadstart=()=>{f(l)};for(const v of p){const S=window.document.createElement("source");qt(v)||(l.crossOrigin="Anonymous"),S.src=v,l.appendChild(S)}}))},s.ae=Ut,s.af=function(){return ot++},s.ag=C,s.ah=Ky,s.ai=G_,s.aj=rf,s.ak=Kf,s.al=NF,s.am=function(p){const l={};if(p.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((f,v,S,k)=>{const R=S||k;return l[v]=!R||R.toLowerCase(),""})),l["max-age"]){const f=parseInt(l["max-age"],10);isNaN(f)?delete l["max-age"]:l["max-age"]=f}return l},s.an=Fe,s.ao=85.051129,s.ap=Tr,s.aq=function(p){return Math.pow(2,p)},s.ar=U,s.as=IF,s.at=function(p){return Math.log(p)/Math.LN2},s.au=function(p){var l=p[0],f=p[1];return l*l+f*f},s.av=function(p){if(!p.length)return new Set;const l=Math.max(...p.map((V=>V.canonical.z)));let f=1/0,v=-1/0,S=1/0,k=-1/0;const R=[];for(const V of p){const{x:Z,y:ie,z:ce}=V.canonical,ve=Math.pow(2,l-ce),Se=Z*ve,Ne=ie*ve;R.push({id:V,x:Se,y:Ne}),Se<f&&(f=Se),Se>v&&(v=Se),Ne<S&&(S=Ne),Ne>k&&(k=Ne)}const B=new Set;for(const V of R)V.x!==f&&V.x!==v&&V.y!==S&&V.y!==k||B.add(V.id);return B},s.aw=function(p,l){const f=Math.abs(2*p.wrap)-+(p.wrap<0),v=Math.abs(2*l.wrap)-+(l.wrap<0);return p.overscaledZ-l.overscaledZ||v-f||l.canonical.y-p.canonical.y||l.canonical.x-p.canonical.x},s.ax=class{constructor(p,l){this.max=p,this.onRemove=l,this.reset()}reset(){for(const p in this.data)for(const l of this.data[p])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(p,l,f){const v=p.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const S={value:l,timeout:void 0};if(f!==void 0&&(S.timeout=setTimeout((()=>{this.remove(p,S)}),f)),this.data[v].push(S),this.order.push(v),this.order.length>this.max){const k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this}has(p){return p.wrapped().key in this.data}getAndRemove(p){return this.has(p)?this._getAndRemoveByKey(p.wrapped().key):null}_getAndRemoveByKey(p){const l=this.data[p].shift();return l.timeout&&clearTimeout(l.timeout),this.data[p].length===0&&delete this.data[p],this.order.splice(this.order.indexOf(p),1),l.value}getByKey(p){const l=this.data[p];return l?l[0].value:null}get(p){return this.has(p)?this.data[p.wrapped().key][0].value:null}remove(p,l){if(!this.has(p))return this;const f=p.wrapped().key,v=l===void 0?0:this.data[f].indexOf(l),S=this.data[f][v];return this.data[f].splice(v,1),S.timeout&&clearTimeout(S.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(S.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(p){for(this.max=p;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(p){const l=[];for(const f in this.data)for(const v of this.data[f])p(v.value)||l.push(v);for(const f of l)this.remove(f.value.tileID,f)}},s.ay=function(p,l){let f=0,v=0;if(p.kind==="constant")v=p.layoutSize;else if(p.kind!=="source"){const{interpolationType:S,minZoom:k,maxZoom:R}=p,B=S?Fe(Un.interpolationFactor(S,l,k,R),0,1):0;p.kind==="camera"?v=Hn.number(p.minSize,p.maxSize,B):f=B}return{uSizeT:f,uSize:v}},s.b=pr,s.b$=qd,s.b0=X,s.b1=function(p){var l=new N(3);return l[0]=p[0],l[1]=p[1],l[2]=p[2],l},s.b2=function(p,l,f){return p[0]=l[0]-f[0],p[1]=l[1]-f[1],p[2]=l[2]-f[2],p},s.b3=function(p,l){var f=l[0],v=l[1],S=l[2],k=f*f+v*v+S*S;return k>0&&(k=1/Math.sqrt(k)),p[0]=l[0]*k,p[1]=l[1]*k,p[2]=l[2]*k,p},s.b4=Q,s.b5=function(p,l){return p[0]*l[0]+p[1]*l[1]+p[2]*l[2]},s.b6=function(p,l,f){return p[0]=l[0]*f[0],p[1]=l[1]*f[1],p[2]=l[2]*f[2],p[3]=l[3]*f[3],p},s.b7=H,s.b8=function(p,l,f){const v=l[0]*f[0]+l[1]*f[1]+l[2]*f[2];return v===0?null:(-(p[0]*f[0]+p[1]*f[1]+p[2]*f[2])-f[3])/v},s.b9=oe,s.bA=function(p,l,f,v){return p[0]=l[0]+f[0]*v,p[1]=l[1]+f[1]*v,p[2]=l[2]+f[2]*v,p},s.bB=_e,s.bC=function(p,l,f){var v=f[0],S=f[1],k=f[2],R=f[3],B=l[0],V=l[1],Z=l[2],ie=S*Z-k*V,ce=k*B-v*Z,ve=v*V-S*B;return p[0]=B+R*(ie+=ie)+S*(ve+=ve)-k*(ce+=ce),p[1]=V+R*ce+k*ie-v*ve,p[2]=Z+R*ve+v*ce-S*ie,p},s.bD=function(p,l,f){const v=(function(V){var Z=V[3],ie=V[4],ce=V[5],ve=V[6],Se=V[7],Ne=V[8];return V[0]*(Ne*ie-ce*Se)+V[1]*(-Ne*Z+ce*ve)+V[2]*(Se*Z-ie*ve)})([p[0],p[1],p[2],l[0],l[1],l[2],f[0],f[1],f[2]]);if(v===0)return null;const S=Q([],[l[0],l[1],l[2]],[f[0],f[1],f[2]]),k=Q([],[f[0],f[1],f[2]],[p[0],p[1],p[2]]),R=Q([],[p[0],p[1],p[2]],[l[0],l[1],l[2]]),B=ae([],S,-p[3]);return X(B,B,ae([],k,-l[3])),X(B,B,ae([],R,-f[3])),ae(B,B,1/v),B},s.bE=EC,s.bF=function(){return new Float64Array(4)},s.bG=function(p,l,f,v){var S=[],k=[];return S[0]=l[0]-f[0],S[1]=l[1]-f[1],S[2]=l[2]-f[2],k[0]=S[0]*Math.cos(v)-S[1]*Math.sin(v),k[1]=S[0]*Math.sin(v)+S[1]*Math.cos(v),k[2]=S[2],p[0]=k[0]+f[0],p[1]=k[1]+f[1],p[2]=k[2]+f[2],p},s.bH=function(p,l,f,v){var S=[],k=[];return S[0]=l[0]-f[0],S[1]=l[1]-f[1],S[2]=l[2]-f[2],k[0]=S[0],k[1]=S[1]*Math.cos(v)-S[2]*Math.sin(v),k[2]=S[1]*Math.sin(v)+S[2]*Math.cos(v),p[0]=k[0]+f[0],p[1]=k[1]+f[1],p[2]=k[2]+f[2],p},s.bI=function(p,l,f,v){var S=[],k=[];return S[0]=l[0]-f[0],S[1]=l[1]-f[1],S[2]=l[2]-f[2],k[0]=S[2]*Math.sin(v)+S[0]*Math.cos(v),k[1]=S[1],k[2]=S[2]*Math.cos(v)-S[0]*Math.sin(v),p[0]=k[0]+f[0],p[1]=k[1]+f[1],p[2]=k[2]+f[2],p},s.bJ=function(p,l,f){var v=Math.sin(f),S=Math.cos(f),k=l[0],R=l[1],B=l[2],V=l[3],Z=l[8],ie=l[9],ce=l[10],ve=l[11];return l!==p&&(p[4]=l[4],p[5]=l[5],p[6]=l[6],p[7]=l[7],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15]),p[0]=k*S-Z*v,p[1]=R*S-ie*v,p[2]=B*S-ce*v,p[3]=V*S-ve*v,p[8]=k*v+Z*S,p[9]=R*v+ie*S,p[10]=B*v+ce*S,p[11]=V*v+ve*S,p},s.bK=function(p,l){const f=De(p,360),v=De(l,360),S=v-f,k=v>f?S-360:S+360;return Math.abs(S)<Math.abs(k)?S:k},s.bL=function(p){return p[0]=0,p[1]=0,p[2]=0,p},s.bM=function(p,l,f,v){const S=Math.sqrt(p*p+l*l),k=Math.sqrt(f*f+v*v);p/=S,l/=S,f/=k,v/=k;const R=Math.acos(p*f+l*v);return-l*f+p*v>0?R:-R},s.bN=function(p,l){const f=De(p,2*Math.PI),v=De(l,2*Math.PI);return Math.min(Math.abs(f-v),Math.abs(f-v+2*Math.PI),Math.abs(f-v-2*Math.PI))},s.bO=function(){const p={},l=Mt.$version;for(const f in Mt.$root){const v=Mt.$root[f];if(v.required){let S=null;S=f==="version"?l:v.type==="array"?[]:{},S!=null&&(p[f]=S)}}return p},s.bP=ct,s.bQ=sn,s.bR=function p(l,f){if(Array.isArray(l)){if(!Array.isArray(f)||l.length!==f.length)return!1;for(let v=0;v<l.length;v++)if(!p(l[v],f[v]))return!1;return!0}if(typeof l=="object"&&l!==null&&f!==null){if(typeof f!="object"||Object.keys(l).length!==Object.keys(f).length)return!1;for(const v in l)if(!p(l[v],f[v]))return!1;return!0}return l===f},s.bS=function(p){p=p.slice();const l=Object.create(null);for(let f=0;f<p.length;f++)l[p[f].id]=p[f];for(let f=0;f<p.length;f++)"ref"in p[f]&&(p[f]=jn(p[f],l[p[f].ref]));return p},s.bT=function(p,l){if(p.type==="custom")return new dae(p,l);switch(p.type){case"background":return new fae(p,l);case"circle":return new Zne(p,l);case"color-relief":return new rie(p,l);case"fill":return new yie(p,l);case"fill-extrusion":return new Pie(p,l);case"heatmap":return new Jne(p,l);case"hillshade":return new eie(p,l);case"line":return new Lie(p,l);case"raster":return new Zl(p,l);case"symbol":return new w2(p,l)}},s.bU=p=>p.type==="raster",s.bV=Re,s.bW=function(p,l){if(!p)return[{command:"setStyle",args:[l]}];let f=[];try{if(!Qr(p.version,l.version))return[{command:"setStyle",args:[l]}];Qr(p.center,l.center)||f.push({command:"setCenter",args:[l.center]}),Qr(p.state,l.state)||f.push({command:"setGlobalState",args:[l.state]}),Qr(p.centerAltitude,l.centerAltitude)||f.push({command:"setCenterAltitude",args:[l.centerAltitude]}),Qr(p.zoom,l.zoom)||f.push({command:"setZoom",args:[l.zoom]}),Qr(p.bearing,l.bearing)||f.push({command:"setBearing",args:[l.bearing]}),Qr(p.pitch,l.pitch)||f.push({command:"setPitch",args:[l.pitch]}),Qr(p.roll,l.roll)||f.push({command:"setRoll",args:[l.roll]}),Qr(p.sprite,l.sprite)||f.push({command:"setSprite",args:[l.sprite]}),Qr(p.glyphs,l.glyphs)||f.push({command:"setGlyphs",args:[l.glyphs]}),Qr(p.transition,l.transition)||f.push({command:"setTransition",args:[l.transition]}),Qr(p.light,l.light)||f.push({command:"setLight",args:[l.light]}),Qr(p.terrain,l.terrain)||f.push({command:"setTerrain",args:[l.terrain]}),Qr(p.sky,l.sky)||f.push({command:"setSky",args:[l.sky]}),Qr(p.projection,l.projection)||f.push({command:"setProjection",args:[l.projection]});const v={},S=[];(function(R,B,V,Z){let ie;for(ie in B=B||{},R=R||{})Object.prototype.hasOwnProperty.call(R,ie)&&(Object.prototype.hasOwnProperty.call(B,ie)||un(ie,V,Z));for(ie in B)Object.prototype.hasOwnProperty.call(B,ie)&&(Object.prototype.hasOwnProperty.call(R,ie)?Qr(R[ie],B[ie])||(R[ie].type==="geojson"&&B[ie].type==="geojson"&&Me(R,B,ie)?nr(V,{command:"setGeoJSONSourceData",args:[ie,B[ie].data]}):Kn(ie,B,V,Z)):oi(ie,B,V))})(p.sources,l.sources,S,v);const k=[];p.layers&&p.layers.forEach((R=>{"source"in R&&v[R.source]?f.push({command:"removeLayer",args:[R.id]}):k.push(R)})),f=f.concat(S),(function(R,B,V){B=B||[];const Z=(R=R||[]).map(Tt),ie=B.map(Tt),ce=R.reduce(Wt,{}),ve=B.reduce(Wt,{}),Se=Z.slice(),Ne=Object.create(null);let ze,Ve,et,Ct,nt;for(let ut=0,Rt=0;ut<Z.length;ut++)ze=Z[ut],Object.prototype.hasOwnProperty.call(ve,ze)?Rt++:(nr(V,{command:"removeLayer",args:[ze]}),Se.splice(Se.indexOf(ze,Rt),1));for(let ut=0,Rt=0;ut<ie.length;ut++)ze=ie[ie.length-1-ut],Se[Se.length-1-ut]!==ze&&(Object.prototype.hasOwnProperty.call(ce,ze)?(nr(V,{command:"removeLayer",args:[ze]}),Se.splice(Se.lastIndexOf(ze,Se.length-Rt),1)):Rt++,Ct=Se[Se.length-ut],nr(V,{command:"addLayer",args:[ve[ze],Ct]}),Se.splice(Se.length-ut,0,ze),Ne[ze]=!0);for(let ut=0;ut<ie.length;ut++)if(ze=ie[ut],Ve=ce[ze],et=ve[ze],!Ne[ze]&&!Qr(Ve,et))if(Qr(Ve.source,et.source)&&Qr(Ve["source-layer"],et["source-layer"])&&Qr(Ve.type,et.type)){for(nt in He(Ve.layout,et.layout,V,ze,null,"setLayoutProperty"),He(Ve.paint,et.paint,V,ze,null,"setPaintProperty"),Qr(Ve.filter,et.filter)||nr(V,{command:"setFilter",args:[ze,et.filter]}),Qr(Ve.minzoom,et.minzoom)&&Qr(Ve.maxzoom,et.maxzoom)||nr(V,{command:"setLayerZoomRange",args:[ze,et.minzoom,et.maxzoom]}),Ve)Object.prototype.hasOwnProperty.call(Ve,nt)&&nt!=="layout"&&nt!=="paint"&&nt!=="filter"&&nt!=="metadata"&&nt!=="minzoom"&&nt!=="maxzoom"&&(nt.indexOf("paint.")===0?He(Ve[nt],et[nt],V,ze,nt.slice(6),"setPaintProperty"):Qr(Ve[nt],et[nt])||nr(V,{command:"setLayerProperty",args:[ze,nt,et[nt]]}));for(nt in et)Object.prototype.hasOwnProperty.call(et,nt)&&!Object.prototype.hasOwnProperty.call(Ve,nt)&&nt!=="layout"&&nt!=="paint"&&nt!=="filter"&&nt!=="metadata"&&nt!=="minzoom"&&nt!=="maxzoom"&&(nt.indexOf("paint.")===0?He(Ve[nt],et[nt],V,ze,nt.slice(6),"setPaintProperty"):Qr(Ve[nt],et[nt])||nr(V,{command:"setLayerProperty",args:[ze,nt,et[nt]]}))}else nr(V,{command:"removeLayer",args:[ze]}),Ct=Se[Se.lastIndexOf(ze)+1],nr(V,{command:"addLayer",args:[et,Ct]})})(k,l.layers,f)}catch(v){console.warn("Unable to compute style diff:",v),f=[{command:"setStyle",args:[l]}]}return f},s.bX=function(p){const l=[],f=p.id;return f===void 0&&l.push({message:`layers.${f}: missing required property "id"`}),p.render===void 0&&l.push({message:`layers.${f}: missing required method "render"`}),p.renderingMode&&p.renderingMode!=="2d"&&p.renderingMode!=="3d"&&l.push({message:`layers.${f}: property "renderingMode" must be either "2d" or "3d"`}),l},s.bY=Qe,s.bZ=rt,s.b_=class extends zu{constructor(p,l){super(p,l),this.current=0}set(p){this.current!==p&&(this.current=p,this.gl.uniform1i(this.location,p))}},s.ba=function(p,l,f){return p[0]=l[0]*f,p[1]=l[1]*f,p[2]=l[2]*f,p[3]=l[3]*f,p},s.bb=function(p,l){return p[0]*l[0]+p[1]*l[1]+p[2]*l[2]+p[3]},s.bc=MF,s.bd=Jy,s.be=function(p,l,f,v,S){var k=1/Math.tan(l/2);if(p[0]=k/f,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=k,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=-1,p[12]=0,p[13]=0,p[15]=0,S!=null&&S!==1/0){var R=1/(v-S);p[10]=(S+v)*R,p[14]=2*S*v*R}else p[10]=-1,p[14]=-2*v;return p},s.bf=function(p){var l=new N(16);return l[0]=p[0],l[1]=p[1],l[2]=p[2],l[3]=p[3],l[4]=p[4],l[5]=p[5],l[6]=p[6],l[7]=p[7],l[8]=p[8],l[9]=p[9],l[10]=p[10],l[11]=p[11],l[12]=p[12],l[13]=p[13],l[14]=p[14],l[15]=p[15],l},s.bg=function(p,l,f){var v=Math.sin(f),S=Math.cos(f),k=l[0],R=l[1],B=l[2],V=l[3],Z=l[4],ie=l[5],ce=l[6],ve=l[7];return l!==p&&(p[8]=l[8],p[9]=l[9],p[10]=l[10],p[11]=l[11],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15]),p[0]=k*S+Z*v,p[1]=R*S+ie*v,p[2]=B*S+ce*v,p[3]=V*S+ve*v,p[4]=Z*S-k*v,p[5]=ie*S-R*v,p[6]=ce*S-B*v,p[7]=ve*S-V*v,p},s.bh=function(p,l,f){var v=Math.sin(f),S=Math.cos(f),k=l[4],R=l[5],B=l[6],V=l[7],Z=l[8],ie=l[9],ce=l[10],ve=l[11];return l!==p&&(p[0]=l[0],p[1]=l[1],p[2]=l[2],p[3]=l[3],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15]),p[4]=k*S+Z*v,p[5]=R*S+ie*v,p[6]=B*S+ce*v,p[7]=V*S+ve*v,p[8]=Z*S-k*v,p[9]=ie*S-R*v,p[10]=ce*S-B*v,p[11]=ve*S-V*v,p},s.bi=function(){const p=new Float32Array(16);return U(p),p},s.bj=function(){const p=new Float64Array(16);return U(p),p},s.bk=function(){return new Float64Array(16)},s.bl=function(p,l,f){const v=new Float64Array(4);return _e(v,p,l-90,f),v},s.bm=function(p,l,f,v){var S,k,R,B,V,Z=l[0],ie=l[1],ce=l[2],ve=l[3],Se=f[0],Ne=f[1],ze=f[2],Ve=f[3];return(k=Z*Se+ie*Ne+ce*ze+ve*Ve)<0&&(k=-k,Se=-Se,Ne=-Ne,ze=-ze,Ve=-Ve),1-k>F?(S=Math.acos(k),R=Math.sin(S),B=Math.sin((1-v)*S)/R,V=Math.sin(v*S)/R):(B=1-v,V=v),p[0]=B*Z+V*Se,p[1]=B*ie+V*Ne,p[2]=B*ce+V*ze,p[3]=B*ve+V*Ve,p},s.bn=function(p){const l=new Float64Array(9);(function(k,R){var B=R[0],V=R[1],Z=R[2],ie=R[3],ce=B+B,ve=V+V,Se=Z+Z,Ne=B*ce,ze=V*ce,Ve=V*ve,et=Z*ce,Ct=Z*ve,nt=Z*Se,ut=ie*ce,Rt=ie*ve,Ft=ie*Se;k[0]=1-Ve-nt,k[3]=ze-Ft,k[6]=et+Rt,k[1]=ze+Ft,k[4]=1-Ne-nt,k[7]=Ct-ut,k[2]=et-Rt,k[5]=Ct+ut,k[8]=1-Ne-Ve})(l,p);const f=Qt(-Math.asin(Fe(l[2],-1,1)));let v,S;return Math.hypot(l[5],l[8])<.001?(v=0,S=-Qt(Math.atan2(l[3],l[4]))):(v=Qt(l[5]===0&&l[8]===0?0:Math.atan2(l[5],l[8])),S=Qt(l[1]===0&&l[0]===0?0:Math.atan2(l[1],l[0]))),{roll:v,pitch:f+90,bearing:S}},s.bo=function(p,l){return p.roll==l.roll&&p.pitch==l.pitch&&p.bearing==l.bearing},s.bp=kr,s.bq=$d,s.br=Xy,s.bs=B_,s.bt=Gy,s.bu=de,s.bv=Ee,s.bw=fi,s.bx=function(p,l,f,v,S){return de(v,S,Fe((p-l)/(f-l),0,1))},s.by=De,s.bz=function(){return new Float64Array(3)},s.c=We,s.c$=function(p,l,f,v,S){return o(this,void 0,void 0,(function*(){if(M())try{return yield vr(p,l,f,v,S)}catch{}return(function(k,R,B,V,Z){const ie=k.width,ce=k.height;br&&lr||(br=new OffscreenCanvas(ie,ce),lr=br.getContext("2d",{willReadFrequently:!0})),br.width=ie,br.height=ce,lr.drawImage(k,0,0,ie,ce);const ve=lr.getImageData(R,B,V,Z);return lr.clearRect(0,0,ie,ce),ve.data})(p,l,f,v,S)}))},s.c0=class extends zu{constructor(p,l){super(p,l),this.current=Sc}set(p){if(p[12]!==this.current[12]||p[0]!==this.current[0])return this.current=p,void this.gl.uniformMatrix4fv(this.location,!1,p);for(let l=1;l<16;l++)if(p[l]!==this.current[l]){this.current=p,this.gl.uniformMatrix4fv(this.location,!1,p);break}}},s.c1=em,s.c2=class extends zu{constructor(p,l){super(p,l),this.current=[0,0,0]}set(p){p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]||(this.current=p,this.gl.uniform3f(this.location,p[0],p[1],p[2]))}},s.c3=class extends zu{constructor(p,l){super(p,l),this.current=[0,0]}set(p){p[0]===this.current[0]&&p[1]===this.current[1]||(this.current=p,this.gl.uniform2f(this.location,p[0],p[1]))}},s.c4=O,s.c5=function(p,l){var f=Math.sin(l),v=Math.cos(l);return p[0]=v,p[1]=f,p[2]=0,p[3]=-f,p[4]=v,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},s.c6=function(p,l,f){var v=l[0],S=l[1],k=l[2];return p[0]=v*f[0]+S*f[3]+k*f[6],p[1]=v*f[1]+S*f[4]+k*f[7],p[2]=v*f[2]+S*f[5]+k*f[8],p},s.c7=function(p,l,f,v,S,k,R){var B=1/(l-f),V=1/(v-S),Z=1/(k-R);return p[0]=-2*B,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=-2*V,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=2*Z,p[11]=0,p[12]=(l+f)*B,p[13]=(S+v)*V,p[14]=(R+k)*Z,p[15]=1,p},s.c8=class extends zu{constructor(p,l){super(p,l),this.current=new Array}set(p){if(p!=this.current){this.current=p;const l=new Float32Array(4*p.length);for(let f=0;f<p.length;f++)l[4*f]=p[f].r,l[4*f+1]=p[f].g,l[4*f+2]=p[f].b,l[4*f+3]=p[f].a;this.gl.uniform4fv(this.location,l)}}},s.c9=class extends zu{constructor(p,l){super(p,l),this.current=new Array}set(p){if(p!=this.current){this.current=p;const l=new Float32Array(p);this.gl.uniform1fv(this.location,l)}}},s.cA=function(p,l){return at[l]&&"touches"in p},s.cB=function(p){return at[p]||ke[p]},s.cC=function(p,l,f){var v=l[0],S=l[1];return p[0]=f[0]*v+f[4]*S+f[12],p[1]=f[1]*v+f[5]*S+f[13],p},s.cD=function(p,l){const{x:f,y:v}=q_.fromLngLat(l);return!(p<0||p>25||v<0||v>=1||f<0||f>=1)},s.cE=function(p,l){return p[0]=l[0],p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=l[1],p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=l[2],p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},s.cF=class extends is{},s.cG=Qae,s.cI=mt,s.cJ=function(p,l){We.REGISTERED_PROTOCOLS[p]=l},s.cK=function(p){delete We.REGISTERED_PROTOCOLS[p]},s.cL=function(p,l){const f={};for(let S=0;S<p.length;S++){const k=l&&l[p[S].id]||$c(p[S]);l&&(l[p[S].id]=k);let R=f[k];R||(R=f[k]=[]),R.push(p[S])}const v=[];for(const S in f)v.push(f[S]);return v},s.cM=Pt,s.cN=OF,s.cO=f8,s.cP=gF,s.cQ=function(p){p.bucket.createArrays(),p.bucket.tilePixelRatio=xe/(512*p.bucket.overscaling),p.bucket.compareText={},p.bucket.iconsNeedLinear=!1;const l=p.bucket.layers[0],f=l.layout,v=l._unevaluatedLayout._values,S={layoutIconSize:v["icon-size"].possiblyEvaluate(new ki(p.bucket.zoom+1),p.canonical),layoutTextSize:v["text-size"].possiblyEvaluate(new ki(p.bucket.zoom+1),p.canonical),textMaxSize:v["text-size"].possiblyEvaluate(new ki(18))};if(p.bucket.textSizeData.kind==="composite"){const{minZoom:Z,maxZoom:ie}=p.bucket.textSizeData;S.compositeTextSizes=[v["text-size"].possiblyEvaluate(new ki(Z),p.canonical),v["text-size"].possiblyEvaluate(new ki(ie),p.canonical)]}if(p.bucket.iconSizeData.kind==="composite"){const{minZoom:Z,maxZoom:ie}=p.bucket.iconSizeData;S.compositeIconSizes=[v["icon-size"].possiblyEvaluate(new ki(Z),p.canonical),v["icon-size"].possiblyEvaluate(new ki(ie),p.canonical)]}const k=f.get("text-line-height")*gl,R=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point",B=f.get("text-keep-upright"),V=f.get("text-size");for(const Z of p.bucket.features){const ie=f.get("text-font").evaluate(Z,{},p.canonical).join(","),ce=V.evaluate(Z,{},p.canonical),ve=S.layoutTextSize.evaluate(Z,{},p.canonical),Se=S.layoutIconSize.evaluate(Z,{},p.canonical),Ne={horizontal:{},vertical:void 0},ze=Z.text;let Ve,et=[0,0];if(ze){const ut=ze.toString(),Rt=f.get("text-letter-spacing").evaluate(Z,{},p.canonical)*gl,Ft=Zn(ut)?Rt:0,fr=f.get("text-anchor").evaluate(Z,{},p.canonical),Or=T8(l,Z,p.canonical);if(!Or){const Gr=f.get("text-radial-offset").evaluate(Z,{},p.canonical);et=Gr?E8(fr,[Gr*gl,$C]):f.get("text-offset").evaluate(Z,{},p.canonical).map((Rr=>Rr*gl))}let Pr=R?"center":f.get("text-justify").evaluate(Z,{},p.canonical);const Vr=f.get("symbol-placement")==="point"?f.get("text-max-width").evaluate(Z,{},p.canonical)*gl:1/0,pn=()=>{p.bucket.allowVerticalPlacement&&Ai(ut)&&(Ne.vertical=b2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,k,fr,"left",Ft,et,s.az.vertical,!0,ve,ce))};if(!R&&Or){const Gr=new Set;if(Pr==="auto")for(let Er=0;Er<Or.values.length;Er+=2)Gr.add(qC(Or.values[Er]));else Gr.add(Pr);let Rr=!1;for(const Er of Gr)if(!Ne.horizontal[Er])if(Rr)Ne.horizontal[Er]=Ne.horizontal[0];else{const Cn=b2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,k,"center",Er,Ft,et,s.az.horizontal,!1,ve,ce);Cn&&(Ne.horizontal[Er]=Cn,Rr=Cn.positionedLines.length===1)}pn()}else{Pr==="auto"&&(Pr=qC(fr));const Gr=b2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,k,fr,Pr,Ft,et,s.az.horizontal,!1,ve,ce);Gr&&(Ne.horizontal[Pr]=Gr),pn(),Ai(ut)&&R&&B&&(Ne.vertical=b2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,k,fr,Pr,Ft,et,s.az.vertical,!1,ve,ce))}}let Ct=!1;if(Z.icon&&Z.icon.name){const ut=p.imageMap[Z.icon.name];ut&&(Ve=lae(p.imagePositions[Z.icon.name],f.get("icon-offset").evaluate(Z,{},p.canonical),f.get("icon-anchor").evaluate(Z,{},p.canonical)),Ct=!!ut.sdf,p.bucket.sdfIcons===void 0?p.bucket.sdfIcons=Ct:p.bucket.sdfIcons!==Ct&&st("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ut.pixelRatio!==p.bucket.pixelRatio||f.get("icon-rotate").constantOr(1)!==0)&&(p.bucket.iconsNeedLinear=!0))}const nt=A8(Ne.horizontal)||Ne.vertical;p.bucket.iconsInText=!!nt&&nt.iconsInText,(nt||Ve)&&Kae(p.bucket,Z,Ne,Ve,p.imageMap,S,ve,Se,et,Ct,p.canonical,p.subdivisionGranularity)}p.showCollisionBoxes&&p.bucket.generateCollisionDebugBuffers()},s.cR=fC,s.cS=pC,s.cT=gC,s.cU=function(p){const l=new _2;return(function(f,v){for(const S in f.layers)v.writeMessage(3,Fae,f.layers[S])})(p,l),l.finish()},s.cV=function(p,l,f,v,S,k){let R=g8(p,l,f,S,0);return R=g8(R,l,v,k,1),R},s.cW=class{constructor(p){this.maxEntries=p,this.map=new Map}get(p){const l=this.map.get(p);return l!==void 0&&(this.map.delete(p),this.map.set(p,l)),l}set(p,l){if(this.map.has(p))this.map.delete(p);else if(this.map.size>=this.maxEntries){const f=this.map.keys().next().value;this.map.delete(f)}this.map.set(p,l)}clear(){this.map.clear()}},s.cX=K6,s.cY=_2,s.cZ=c8,s.c_=class{constructor(p){this._marks={start:[p.url,"start"].join("#"),end:[p.url,"end"].join("#"),measure:p.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let p=performance.getEntriesByName(this._marks.measure);return p.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),p=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),p}},s.ca=class extends xh{},s.cb=jie,s.cc=class extends Hf{},s.cd=sC,s.ce=function(p){return p<=1?1:Math.pow(2,Math.ceil(Math.log(p)/Math.LN2))},s.cf=L6,s.cg=function(p,l,f){var v=l[0],S=l[1],k=l[2],R=f[3]*v+f[7]*S+f[11]*k+f[15];return p[0]=(f[0]*v+f[4]*S+f[8]*k+f[12])/(R=R||1),p[1]=(f[1]*v+f[5]*S+f[9]*k+f[13])/R,p[2]=(f[2]*v+f[6]*S+f[10]*k+f[14])/R,p},s.ch=class extends jf{},s.ci=class extends u{},s.cj=function(p,l){return p[0]===l[0]&&p[1]===l[1]&&p[2]===l[2]&&p[3]===l[3]&&p[4]===l[4]&&p[5]===l[5]&&p[6]===l[6]&&p[7]===l[7]&&p[8]===l[8]&&p[9]===l[9]&&p[10]===l[10]&&p[11]===l[11]&&p[12]===l[12]&&p[13]===l[13]&&p[14]===l[14]&&p[15]===l[15]},s.ck=function(p,l){var f=p[0],v=p[1],S=p[2],k=p[3],R=p[4],B=p[5],V=p[6],Z=p[7],ie=p[8],ce=p[9],ve=p[10],Se=p[11],Ne=p[12],ze=p[13],Ve=p[14],et=p[15],Ct=l[0],nt=l[1],ut=l[2],Rt=l[3],Ft=l[4],fr=l[5],Or=l[6],Pr=l[7],Vr=l[8],pn=l[9],Gr=l[10],Rr=l[11],Er=l[12],Cn=l[13],xn=l[14],kn=l[15];return Math.abs(f-Ct)<=F*Math.max(1,Math.abs(f),Math.abs(Ct))&&Math.abs(v-nt)<=F*Math.max(1,Math.abs(v),Math.abs(nt))&&Math.abs(S-ut)<=F*Math.max(1,Math.abs(S),Math.abs(ut))&&Math.abs(k-Rt)<=F*Math.max(1,Math.abs(k),Math.abs(Rt))&&Math.abs(R-Ft)<=F*Math.max(1,Math.abs(R),Math.abs(Ft))&&Math.abs(B-fr)<=F*Math.max(1,Math.abs(B),Math.abs(fr))&&Math.abs(V-Or)<=F*Math.max(1,Math.abs(V),Math.abs(Or))&&Math.abs(Z-Pr)<=F*Math.max(1,Math.abs(Z),Math.abs(Pr))&&Math.abs(ie-Vr)<=F*Math.max(1,Math.abs(ie),Math.abs(Vr))&&Math.abs(ce-pn)<=F*Math.max(1,Math.abs(ce),Math.abs(pn))&&Math.abs(ve-Gr)<=F*Math.max(1,Math.abs(ve),Math.abs(Gr))&&Math.abs(Se-Rr)<=F*Math.max(1,Math.abs(Se),Math.abs(Rr))&&Math.abs(Ne-Er)<=F*Math.max(1,Math.abs(Ne),Math.abs(Er))&&Math.abs(ze-Cn)<=F*Math.max(1,Math.abs(ze),Math.abs(Cn))&&Math.abs(Ve-xn)<=F*Math.max(1,Math.abs(Ve),Math.abs(xn))&&Math.abs(et-kn)<=F*Math.max(1,Math.abs(et),Math.abs(kn))},s.cl=function(p,l){return p[0]=l[0],p[1]=l[1],p[2]=l[2],p[3]=l[3],p[4]=l[4],p[5]=l[5],p[6]=l[6],p[7]=l[7],p[8]=l[8],p[9]=l[9],p[10]=l[10],p[11]=l[11],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15],p},s.cm=p=>p.type==="symbol",s.cn=p=>p.type==="circle",s.co=p=>p.type==="heatmap",s.cp=p=>p.type==="line",s.cq=p=>p.type==="fill",s.cr=p=>p.type==="fill-extrusion",s.cs=p=>p.type==="hillshade",s.ct=p=>p.type==="color-relief",s.cu=p=>p.type==="background",s.cv=p=>p.type==="custom",s.cw=we,s.cx=function(p,l,f){const v=me(l.x-f.x,l.y-f.y),S=me(p.x-f.x,p.y-f.y),k=Math.atan2(v[0]*S[1]-v[1]*S[0],(function(R,B){return R[0]*B[0]+R[1]*B[1]})(v,S));return Qt(k)},s.cy=Le,s.cz=function(p,l){return ke[l]&&(p instanceof MouseEvent||p instanceof WheelEvent)},s.d=qt,s.d0=z6,s.d1=h,s.d2=class{constructor(p,l){this.layers={[G_]:this},this.name=G_,this.version=l?l.version:1,this.extent=l?l.extent:4096,this.length=p.length,this.features=p}feature(p){return new Lae(this.features[p],this.extent)}},s.d3=ef,s.d4=da,s.e=Be,s.f=p=>o(void 0,void 0,void 0,(function*(){if(p.byteLength===0)return createImageBitmap(new ImageData(1,1));const l=new Blob([new Uint8Array(p)],{type:"image/png"});try{return createImageBitmap(l)}catch(f){throw new Error(`Could not load image because of ${f.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),s.g=Lt,s.h=p=>new Promise(((l,f)=>{const v=new Image;v.onload=()=>{l(v),URL.revokeObjectURL(v.src),v.onload=null,window.requestAnimationFrame((()=>{v.src=_t}))},v.onerror=()=>f(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const S=new Blob([new Uint8Array(p)],{type:"image/png"});v.src=p.byteLength?URL.createObjectURL(S):_t})),s.i=Jt,s.j=(p,l)=>Kt(Be(p,{type:"json"}),l),s.k=hn,s.l=$r,s.m=Kt,s.n=(p,l)=>Kt(Be(p,{type:"arrayBuffer"}),l),s.o=function(p){return new _2(p).readFields(eae,[])},s.p=pF,s.q=function(p){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(p))},s.r=D_,s.s=Cr,s.t=$a,s.u=Mt,s.v=Ye,s.w=st,s.x=Wo,s.y=it,s.z=Qa})),i("worker",["./shared"],(function(s){class o{constructor(ke,be){this.keyCache={},ke&&this.replace(ke,be)}replace(ke,be){this._layerConfigs={},this._layers={},this.update(ke,[],be)}update(ke,be,je){for(const We of ke){this._layerConfigs[We.id]=We;const Lt=this._layers[We.id]=s.bT(We,je);Lt._featureFilter=s.aj(Lt.filter,je),this.keyCache[We.id]&&delete this.keyCache[We.id]}for(const We of be)delete this.keyCache[We],delete this._layerConfigs[We],delete this._layers[We];this.familiesBySource={};const qe=s.cL(Object.values(this._layerConfigs),this.keyCache);for(const We of qe){const Lt=We.map((Ir=>this._layers[Ir.id])),Et=Lt[0];if(Et.isHidden())continue;const mt=Et.source||"";let ct=this.familiesBySource[mt];ct||(ct=this.familiesBySource[mt]={});const Kt=Et.sourceLayer||s.ai;let qt=ct[Kt];qt||(qt=ct[Kt]=[]),qt.push(Lt)}}}class c{constructor(ke){const be={},je=[];for(const Et in ke){const mt=ke[Et],ct=be[Et]={};for(const Kt in mt){const qt=mt[+Kt];if(!qt||qt.bitmap.width===0||qt.bitmap.height===0)continue;const Ir={x:0,y:0,w:qt.bitmap.width+2,h:qt.bitmap.height+2};je.push(Ir),ct[Kt]={rect:Ir,metrics:qt.metrics}}}const{w:qe,h:We}=s.p(je),Lt=new s.r({width:qe||1,height:We||1});for(const Et in ke){const mt=ke[Et];for(const ct in mt){const Kt=mt[+ct];if(!Kt||Kt.bitmap.width===0||Kt.bitmap.height===0)continue;const qt=be[Et][ct].rect;s.r.copy(Kt.bitmap,Lt,{x:0,y:0},{x:qt.x+1,y:qt.y+1},Kt.bitmap)}}this.image=Lt,this.positions=be}}s.cM("GlyphAtlas",c);class h{constructor(ke){this.tileID=new s.a2(ke.tileID.overscaledZ,ke.tileID.wrap,ke.tileID.canonical.z,ke.tileID.canonical.x,ke.tileID.canonical.y),this.uid=ke.uid,this.zoom=ke.zoom,this.pixelRatio=ke.pixelRatio,this.tileSize=ke.tileSize,this.source=ke.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ke.showCollisionBoxes,this.collectResourceTiming=!!ke.collectResourceTiming,this.returnDependencies=!!ke.returnDependencies,this.promoteId=ke.promoteId,this.inFlightDependencies=[]}parse(ke,be,je,qe,We){return s._(this,void 0,void 0,(function*(){this.status="parsing",this.data=ke,this.collisionBoxArray=new s.ag;const Lt=new s.cN(Object.keys(ke.layers).sort()),Et=new s.cO(this.tileID,this.promoteId);Et.bucketLayerIDs=[];const mt={},ct={featureIndex:Et,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:je,subdivisionGranularity:We},Kt=be.familiesBySource[this.source];for(const Me in Kt){const He=ke.layers[Me];if(!He)continue;He.version===1&&s.w(`Vector tile source "${this.source}" layer "${Me}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Tt=Lt.encode(Me),Wt=[];for(let Ut=0;Ut<He.length;Ut++){const Xr=He.feature(Ut),Nn=Et.getId(Xr,Me);Wt.push({feature:Xr,id:Nn,index:Ut,sourceLayerIndex:Tt})}for(const Ut of Kt[Me]){const Xr=Ut[0];Xr.source!==this.source&&s.w(`layer.source = ${Xr.source} does not equal this.source = ${this.source}`),Xr.isHidden(this.zoom,!0)||(d(Ut,this.zoom,je),(mt[Xr.id]=Xr.createBucket({index:Et.bucketLayerIDs.length,layers:Ut,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Tt,sourceID:this.source})).populate(Wt,ct,this.tileID.canonical),Et.bucketLayerIDs.push(Ut.map((Nn=>Nn.id))))}}const qt=s.bY(ct.glyphDependencies,(Me=>Object.keys(Me).map(Number)));this.inFlightDependencies.forEach((Me=>Me?.abort())),this.inFlightDependencies=[];let Ir=Promise.resolve({});if(Object.keys(qt).length){const Me=new AbortController;this.inFlightDependencies.push(Me),Ir=qe.sendAsync({type:"GG",data:{stacks:qt,source:this.source,tileID:this.tileID,type:"glyphs"}},Me)}const Ar=Object.keys(ct.iconDependencies);let $r=Promise.resolve({});if(Ar.length){const Me=new AbortController;this.inFlightDependencies.push(Me),$r=qe.sendAsync({type:"GI",data:{icons:Ar,source:this.source,tileID:this.tileID,type:"icons"}},Me)}const hn=Object.keys(ct.patternDependencies);let zr=Promise.resolve({});if(hn.length){const Me=new AbortController;this.inFlightDependencies.push(Me),zr=qe.sendAsync({type:"GI",data:{icons:hn,source:this.source,tileID:this.tileID,type:"patterns"}},Me)}const Mt=ct.dashDependencies;let en=Promise.resolve({});if(Object.keys(Mt).length){const Me=new AbortController;this.inFlightDependencies.push(Me),en=qe.sendAsync({type:"GDA",data:{dashes:Mt}},Me)}const[jn,Qr,nr,oi]=yield Promise.all([Ir,$r,zr,en]),un=new c(jn),Kn=new s.cP(Qr,nr);for(const Me in mt){const He=mt[Me];He instanceof s.ah?(d(He.layers,this.zoom,je),s.cQ({bucket:He,glyphMap:jn,glyphPositions:un.positions,imageMap:Qr,imagePositions:Kn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ct.subdivisionGranularity})):He.hasDependencies&&(He instanceof s.cR||He instanceof s.cS||He instanceof s.cT)&&(d(He.layers,this.zoom,je),He.addFeatures(ct,this.tileID.canonical,Kn.patternPositions,oi))}return this.status="done",{buckets:Object.values(mt).filter((Me=>!Me.isEmpty())),featureIndex:Et,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:un.image,imageAtlas:Kn,dashPositions:oi,glyphMap:this.returnDependencies?jn:null,iconMap:this.returnDependencies?Qr:null,glyphPositions:this.returnDependencies?un.positions:null}}))}}function d(at,ke,be){const je=new s.H(ke);for(const qe of at)qe.recalculate(je,be)}class m{constructor(ke,be,je,qe,We){this.type=ke,this.properties=je||{},this.extent=We,this.pointsArray=be,this.id=qe}loadGeometry(){return this.pointsArray.map((ke=>ke.map((be=>new s.P(be.x,be.y)))))}}class b{constructor(ke,be,je){this.version=2,this._myFeatures=ke,this.name=be,this.length=ke.length,this.extent=je}feature(ke){return this._myFeatures[ke]}}class x{constructor(){this.layers={}}addLayer(ke){this.layers[ke.name]=ke}}function E(at){let ke=s.cU(at);return ke.byteOffset===0&&ke.byteLength===ke.buffer.byteLength||(ke=new Uint8Array(ke)),{vectorTile:at,rawData:ke.buffer}}function T(at,ke,be){const{extent:je}=at,qe=Math.pow(2,be.z-ke.z),We=(be.x-ke.x*qe)*je,Lt=(be.y-ke.y*qe)*je,Et=[];for(let mt=0;mt<at.length;mt++){const ct=at.feature(mt);let Kt=ct.loadGeometry();for(const Ir of Kt)for(const Ar of Ir)Ar.x=Ar.x*qe-We,Ar.y=Ar.y*qe-Lt;const qt=128;Kt=s.cV(Kt,ct.type,-qt,-qt,je+qt,je+qt),Kt.length!==0&&Et.push(new m(ct.type,Kt,ct.properties,ct.id,je))}return new b(Et,at.name,je)}class A{constructor(ke,be,je){this.actor=ke,this.layerIndex=be,this.availableImages=je,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new s.cW(1e3)}loadVectorTile(ke,be){return s._(this,void 0,void 0,(function*(){const je=yield s.n(ke.request,be);try{return{vectorTile:ke.encoding!=="mlt"?new s.cX(new s.cY(je.data)):new s.cZ(je.data),rawData:je.data,cacheControl:je.cacheControl,expires:je.expires}}catch(qe){const We=new Uint8Array(je.data);let Lt=`Unable to parse the tile at ${ke.request.url}, `;throw Lt+=We[0]===31&&We[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${qe.message}`,new Error(Lt)}}))}loadTile(ke){return s._(this,void 0,void 0,(function*(){const{uid:be,overzoomParameters:je}=ke;je&&(ke.request=je.overzoomRequest);const qe=!!(ke&&ke.request&&ke.request.collectResourceTiming)&&new s.c_(ke.request),We=new h(ke);this.loading[be]=We;const Lt=new AbortController;We.abort=Lt;try{const Et=yield this.loadVectorTile(ke,Lt);if(delete this.loading[be],!Et)return null;if(je){const Ir=this._getOverzoomTile(ke,Et.vectorTile);Et.rawData=Ir.rawData,Et.vectorTile=Ir.vectorTile}const mt=Et.rawData,ct={};Et.expires&&(ct.expires=Et.expires),Et.cacheControl&&(ct.cacheControl=Et.cacheControl);const Kt={};if(qe){const Ir=qe.finish();Ir&&(Kt.resourceTiming=JSON.parse(JSON.stringify(Ir)))}We.vectorTile=Et.vectorTile;const qt=We.parse(Et.vectorTile,this.layerIndex,this.availableImages,this.actor,ke.subdivisionGranularity);this.loaded[be]=We,this.fetching[be]={rawTileData:mt,cacheControl:ct,resourceTiming:Kt};try{const Ir=yield qt;return s.e({rawTileData:mt.slice(0),encoding:ke.encoding},Ir,ct,Kt)}finally{delete this.fetching[be]}}catch(Et){throw delete this.loading[be],We.status="done",this.loaded[be]=We,Et}}))}_getOverzoomTile(ke,be){const{tileID:je,source:qe,overzoomParameters:We}=ke,{maxZoomTileID:Lt}=We,Et=`${Lt.key}_${je.key}`,mt=this.overzoomedTileResultCache.get(Et);if(mt)return mt;const ct=new x,Kt=this.layerIndex.familiesBySource[qe];for(const Ir in Kt){const Ar=be.layers[Ir];if(!Ar)continue;const $r=T(Ar,Lt,je.canonical);$r.length>0&&ct.addLayer($r)}const qt=E(ct);return this.overzoomedTileResultCache.set(Et,qt),qt}reloadTile(ke){return s._(this,void 0,void 0,(function*(){const be=ke.uid;if(!this.loaded||!this.loaded[be])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const je=this.loaded[be];if(je.showCollisionBoxes=ke.showCollisionBoxes,je.status==="parsing"){const qe=yield je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,ke.subdivisionGranularity);let We;if(this.fetching[be]){const{rawTileData:Lt,cacheControl:Et,resourceTiming:mt}=this.fetching[be];delete this.fetching[be],We=s.e({rawTileData:Lt.slice(0),encoding:ke.encoding},qe,Et,mt)}else We=qe;return We}if(je.status==="done"&&je.vectorTile)return je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,ke.subdivisionGranularity)}))}abortTile(ke){return s._(this,void 0,void 0,(function*(){const be=this.loading,je=ke.uid;be&&be[je]&&be[je].abort&&(be[je].abort.abort(),delete be[je])}))}removeTile(ke){return s._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[ke.uid]&&delete this.loaded[ke.uid]}))}}class M{constructor(){this.loaded={}}loadTile(ke){return s._(this,void 0,void 0,(function*(){const{uid:be,encoding:je,rawImageData:qe,redFactor:We,greenFactor:Lt,blueFactor:Et,baseShift:mt}=ke,ct=qe.width+2,Kt=qe.height+2,qt=s.b(qe)?new s.R({width:ct,height:Kt},yield s.c$(qe,-1,-1,ct,Kt)):qe,Ir=new s.d0(be,qt,je,We,Lt,Et,mt);return this.loaded=this.loaded||{},this.loaded[be]=Ir,Ir}))}removeTile(ke){const be=this.loaded,je=ke.uid;be&&be[je]&&delete be[je]}}var F,N,O=(function(){if(N)return F;function at(be,je){if(be.length!==0){ke(be[0],je);for(var qe=1;qe<be.length;qe++)ke(be[qe],!je)}}function ke(be,je){for(var qe=0,We=0,Lt=0,Et=be.length,mt=Et-1;Lt<Et;mt=Lt++){var ct=(be[Lt][0]-be[mt][0])*(be[mt][1]+be[Lt][1]),Kt=qe+ct;We+=Math.abs(qe)>=Math.abs(ct)?qe-Kt+ct:ct-Kt+qe,qe=Kt}qe+We>=0!=!!je&&be.reverse()}return N=1,F=function be(je,qe){var We,Lt=je&&je.type;if(Lt==="FeatureCollection")for(We=0;We<je.features.length;We++)be(je.features[We],qe);else if(Lt==="GeometryCollection")for(We=0;We<je.geometries.length;We++)be(je.geometries[We],qe);else if(Lt==="Feature")be(je.geometry,qe);else if(Lt==="Polygon")at(je.coordinates,qe);else if(Lt==="MultiPolygon")for(We=0;We<je.coordinates.length;We++)at(je.coordinates[We],qe);return je}})(),U=s.d1(O);const j={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:at=>at},H=Math.fround||(G=new Float32Array(1),at=>(G[0]=+at,G[0]));var G;class X{constructor(ke){this.options=Object.assign(Object.create(j),ke),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ke){const{log:be,minZoom:je,maxZoom:qe}=this.options;be&&console.time("total time");const We=`prepare ${ke.length} points`;be&&console.time(We),this.points=ke;const Lt=[];for(let mt=0;mt<ke.length;mt++){const ct=ke[mt];if(!ct.geometry)continue;const[Kt,qt]=ct.geometry.coordinates,Ir=H(W(Kt)),Ar=H(oe(qt));Lt.push(Ir,Ar,1/0,mt,-1,1),this.options.reduce&&Lt.push(0)}let Et=this.trees[qe+1]=this._createTree(Lt);be&&console.timeEnd(We);for(let mt=qe;mt>=je;mt--){const ct=+Date.now();Et=this.trees[mt]=this._createTree(this._cluster(Et,mt)),be&&console.log("z%d: %d clusters in %dms",mt,Et.numItems,+Date.now()-ct)}return be&&console.timeEnd("total time"),this}getClusters(ke,be){let je=((ke[0]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,ke[1]));let We=ke[2]===180?180:((ke[2]+180)%360+360)%360-180;const Lt=Math.max(-90,Math.min(90,ke[3]));if(ke[2]-ke[0]>=360)je=-180,We=180;else if(je>We){const qt=this.getClusters([je,qe,180,Lt],be),Ir=this.getClusters([-180,qe,We,Lt],be);return qt.concat(Ir)}const Et=this.trees[this._limitZoom(be)],mt=Et.range(W(je),oe(Lt),W(We),oe(qe)),ct=Et.data,Kt=[];for(const qt of mt){const Ir=this.stride*qt;Kt.push(ct[Ir+5]>1?ae(ct,Ir,this.clusterProps):this.points[ct[Ir+3]])}return Kt}getChildren(ke){const be=this._getOriginId(ke),je=this._getOriginZoom(ke),qe="No cluster with the specified id.",We=this.trees[je];if(!We)throw new Error(qe);const Lt=We.data;if(be*this.stride>=Lt.length)throw new Error(qe);const Et=this.options.radius/(this.options.extent*Math.pow(2,je-1)),mt=We.within(Lt[be*this.stride],Lt[be*this.stride+1],Et),ct=[];for(const Kt of mt){const qt=Kt*this.stride;Lt[qt+4]===ke&&ct.push(Lt[qt+5]>1?ae(Lt,qt,this.clusterProps):this.points[Lt[qt+3]])}if(ct.length===0)throw new Error(qe);return ct}getLeaves(ke,be,je){const qe=[];return this._appendLeaves(qe,ke,be=be||10,je=je||0,0),qe}getTile(ke,be,je){const qe=this.trees[this._limitZoom(ke)],We=Math.pow(2,ke),{extent:Lt,radius:Et}=this.options,mt=Et/Lt,ct=(je-mt)/We,Kt=(je+1+mt)/We,qt={features:[]};return this._addTileFeatures(qe.range((be-mt)/We,ct,(be+1+mt)/We,Kt),qe.data,be,je,We,qt),be===0&&this._addTileFeatures(qe.range(1-mt/We,ct,1,Kt),qe.data,We,je,We,qt),be===We-1&&this._addTileFeatures(qe.range(0,ct,mt/We,Kt),qe.data,-1,je,We,qt),qt.features.length?qt:null}getClusterExpansionZoom(ke){let be=this._getOriginZoom(ke)-1;for(;be<=this.options.maxZoom;){const je=this.getChildren(ke);if(be++,je.length!==1)break;ke=je[0].properties.cluster_id}return be}_appendLeaves(ke,be,je,qe,We){const Lt=this.getChildren(be);for(const Et of Lt){const mt=Et.properties;if(mt&&mt.cluster?We+mt.point_count<=qe?We+=mt.point_count:We=this._appendLeaves(ke,mt.cluster_id,je,qe,We):We<qe?We++:ke.push(Et),ke.length===je)break}return We}_createTree(ke){const be=new s.aT(ke.length/this.stride|0,this.options.nodeSize,Float32Array);for(let je=0;je<ke.length;je+=this.stride)be.add(ke[je],ke[je+1]);return be.finish(),be.data=ke,be}_addTileFeatures(ke,be,je,qe,We,Lt){for(const Et of ke){const mt=Et*this.stride,ct=be[mt+5]>1;let Kt,qt,Ir;if(ct)Kt=Q(be,mt,this.clusterProps),qt=be[mt],Ir=be[mt+1];else{const hn=this.points[be[mt+3]];Kt=hn.properties;const[zr,Mt]=hn.geometry.coordinates;qt=W(zr),Ir=oe(Mt)}const Ar={type:1,geometry:[[Math.round(this.options.extent*(qt*We-je)),Math.round(this.options.extent*(Ir*We-qe))]],tags:Kt};let $r;$r=ct||this.options.generateId?be[mt+3]:this.points[be[mt+3]].id,$r!==void 0&&(Ar.id=$r),Lt.features.push(Ar)}}_limitZoom(ke){return Math.max(this.options.minZoom,Math.min(Math.floor(+ke),this.options.maxZoom+1))}_cluster(ke,be){const{radius:je,extent:qe,reduce:We,minPoints:Lt}=this.options,Et=je/(qe*Math.pow(2,be)),mt=ke.data,ct=[],Kt=this.stride;for(let qt=0;qt<mt.length;qt+=Kt){if(mt[qt+2]<=be)continue;mt[qt+2]=be;const Ir=mt[qt],Ar=mt[qt+1],$r=ke.within(mt[qt],mt[qt+1],Et),hn=mt[qt+5];let zr=hn;for(const Mt of $r){const en=Mt*Kt;mt[en+2]>be&&(zr+=mt[en+5])}if(zr>hn&&zr>=Lt){let Mt,en=Ir*hn,jn=Ar*hn,Qr=-1;const nr=(qt/Kt<<5)+(be+1)+this.points.length;for(const oi of $r){const un=oi*Kt;if(mt[un+2]<=be)continue;mt[un+2]=be;const Kn=mt[un+5];en+=mt[un]*Kn,jn+=mt[un+1]*Kn,mt[un+4]=nr,We&&(Mt||(Mt=this._map(mt,qt,!0),Qr=this.clusterProps.length,this.clusterProps.push(Mt)),We(Mt,this._map(mt,un)))}mt[qt+4]=nr,ct.push(en/zr,jn/zr,1/0,nr,-1,zr),We&&ct.push(Qr)}else{for(let Mt=0;Mt<Kt;Mt++)ct.push(mt[qt+Mt]);if(zr>1)for(const Mt of $r){const en=Mt*Kt;if(!(mt[en+2]<=be)){mt[en+2]=be;for(let jn=0;jn<Kt;jn++)ct.push(mt[en+jn])}}}}return ct}_getOriginId(ke){return ke-this.points.length>>5}_getOriginZoom(ke){return(ke-this.points.length)%32}_map(ke,be,je){if(ke[be+5]>1){const Lt=this.clusterProps[ke[be+6]];return je?Object.assign({},Lt):Lt}const qe=this.points[ke[be+3]].properties,We=this.options.map(qe);return je&&We===qe?Object.assign({},We):We}}function ae(at,ke,be){return{type:"Feature",id:at[ke+3],properties:Q(at,ke,be),geometry:{type:"Point",coordinates:[(je=at[ke],360*(je-.5)),se(at[ke+1])]}};var je}function Q(at,ke,be){const je=at[ke+5],qe=je>=1e4?`${Math.round(je/1e3)}k`:je>=1e3?Math.round(je/100)/10+"k":je,We=at[ke+6],Lt=We===-1?{}:Object.assign({},be[We]);return Object.assign(Lt,{cluster:!0,cluster_id:at[ke+3],point_count:je,point_count_abbreviated:qe})}function W(at){return at/360+.5}function oe(at){const ke=Math.sin(at*Math.PI/180),be=.5-.25*Math.log((1+ke)/(1-ke))/Math.PI;return be<0?0:be>1?1:be}function se(at){const ke=(180-360*at)*Math.PI/180;return 360*Math.atan(Math.exp(ke))/Math.PI-90}function he(at,ke,be,je){let qe=je;const We=ke+(be-ke>>1);let Lt,Et=be-ke;const mt=at[ke],ct=at[ke+1],Kt=at[be],qt=at[be+1];for(let Ir=ke+3;Ir<be;Ir+=3){const Ar=_e(at[Ir],at[Ir+1],mt,ct,Kt,qt);if(Ar>qe)Lt=Ir,qe=Ar;else if(Ar===qe){const $r=Math.abs(Ir-We);$r<Et&&(Lt=Ir,Et=$r)}}qe>je&&(Lt-ke>3&&he(at,ke,Lt,je),at[Lt+2]=qe,be-Lt>3&&he(at,Lt,be,je))}function _e(at,ke,be,je,qe,We){let Lt=qe-be,Et=We-je;if(Lt!==0||Et!==0){const mt=((at-be)*Lt+(ke-je)*Et)/(Lt*Lt+Et*Et);mt>1?(be=qe,je=We):mt>0&&(be+=Lt*mt,je+=Et*mt)}return Lt=at-be,Et=ke-je,Lt*Lt+Et*Et}function Ce(at,ke,be,je){const qe={id:at??null,type:ke,geometry:be,tags:je,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ke==="Point"||ke==="MultiPoint"||ke==="LineString")me(qe,be);else if(ke==="Polygon")me(qe,be[0]);else if(ke==="MultiLineString")for(const We of be)me(qe,We);else if(ke==="MultiPolygon")for(const We of be)me(qe,We[0]);return qe}function me(at,ke){for(let be=0;be<ke.length;be+=3)at.minX=Math.min(at.minX,ke[be]),at.minY=Math.min(at.minY,ke[be+1]),at.maxX=Math.max(at.maxX,ke[be]),at.maxY=Math.max(at.maxY,ke[be+1])}function xe(at,ke,be,je){if(!ke.geometry)return;const qe=ke.geometry.coordinates;if(qe&&qe.length===0)return;const We=ke.geometry.type,Lt=Math.pow(be.tolerance/((1<<be.maxZoom)*be.extent),2);let Et=[],mt=ke.id;if(be.promoteId?mt=ke.properties[be.promoteId]:be.generateId&&(mt=je||0),We==="Point")Ae(qe,Et);else if(We==="MultiPoint")for(const ct of qe)Ae(ct,Et);else if(We==="LineString")De(qe,Et,Lt,!1);else if(We==="MultiLineString"){if(be.lineMetrics){for(const ct of qe)Et=[],De(ct,Et,Lt,!1),at.push(Ce(mt,"LineString",Et,ke.properties));return}de(qe,Et,Lt,!1)}else if(We==="Polygon")de(qe,Et,Lt,!0);else{if(We!=="MultiPolygon"){if(We==="GeometryCollection"){for(const ct of ke.geometry.geometries)xe(at,{id:mt,geometry:ct,properties:ke.properties},be,je);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ct of qe){const Kt=[];de(ct,Kt,Lt,!0),Et.push(Kt)}}at.push(Ce(mt,We,Et,ke.properties))}function Ae(at,ke){ke.push(Ee(at[0]),we(at[1]),0)}function De(at,ke,be,je){let qe,We,Lt=0;for(let mt=0;mt<at.length;mt++){const ct=Ee(at[mt][0]),Kt=we(at[mt][1]);ke.push(ct,Kt,0),mt>0&&(Lt+=je?(qe*Kt-ct*We)/2:Math.sqrt(Math.pow(ct-qe,2)+Math.pow(Kt-We,2))),qe=ct,We=Kt}const Et=ke.length-3;ke[2]=1,he(ke,0,Et,be),ke[Et+2]=1,ke.size=Math.abs(Lt),ke.start=0,ke.end=ke.size}function de(at,ke,be,je){for(let qe=0;qe<at.length;qe++){const We=[];De(at[qe],We,be,je),ke.push(We)}}function Ee(at){return at/360+.5}function we(at){const ke=Math.sin(at*Math.PI/180),be=.5-.25*Math.log((1+ke)/(1-ke))/Math.PI;return be<0?0:be>1?1:be}function Le(at,ke,be,je,qe,We,Lt,Et){if(je/=ke,We>=(be/=ke)&&Lt<je)return at;if(Lt<be||We>=je)return null;const mt=[];for(const ct of at){const Kt=ct.geometry;let qt=ct.type;const Ir=qe===0?ct.minX:ct.minY,Ar=qe===0?ct.maxX:ct.maxY;if(Ir>=be&&Ar<je){mt.push(ct);continue}if(Ar<be||Ir>=je)continue;let $r=[];if(qt==="Point"||qt==="MultiPoint")Fe(Kt,$r,be,je,qe);else if(qt==="LineString")Xe(Kt,$r,be,je,qe,!1,Et.lineMetrics);else if(qt==="MultiLineString")ot(Kt,$r,be,je,qe,!1);else if(qt==="Polygon")ot(Kt,$r,be,je,qe,!0);else if(qt==="MultiPolygon")for(const hn of Kt){const zr=[];ot(hn,zr,be,je,qe,!0),zr.length&&$r.push(zr)}if($r.length){if(Et.lineMetrics&&qt==="LineString"){for(const hn of $r)mt.push(Ce(ct.id,qt,hn,ct.tags));continue}qt!=="LineString"&&qt!=="MultiLineString"||($r.length===1?(qt="LineString",$r=$r[0]):qt="MultiLineString"),qt!=="Point"&&qt!=="MultiPoint"||(qt=$r.length===3?"Point":"MultiPoint"),mt.push(Ce(ct.id,qt,$r,ct.tags))}}return mt.length?mt:null}function Fe(at,ke,be,je,qe){for(let We=0;We<at.length;We+=3){const Lt=at[We+qe];Lt>=be&&Lt<=je&&Qe(ke,at[We],at[We+1],at[We+2])}}function Xe(at,ke,be,je,qe,We,Lt){let Et=Be(at);const mt=qe===0?rt:Re;let ct,Kt,qt=at.start;for(let zr=0;zr<at.length-3;zr+=3){const Mt=at[zr],en=at[zr+1],jn=at[zr+2],Qr=at[zr+3],nr=at[zr+4],oi=qe===0?Mt:en,un=qe===0?Qr:nr;let Kn=!1;Lt&&(ct=Math.sqrt(Math.pow(Mt-Qr,2)+Math.pow(en-nr,2))),oi<be?un>be&&(Kt=mt(Et,Mt,en,Qr,nr,be),Lt&&(Et.start=qt+ct*Kt)):oi>je?un<je&&(Kt=mt(Et,Mt,en,Qr,nr,je),Lt&&(Et.start=qt+ct*Kt)):Qe(Et,Mt,en,jn),un<be&&oi>=be&&(Kt=mt(Et,Mt,en,Qr,nr,be),Kn=!0),un>je&&oi<=je&&(Kt=mt(Et,Mt,en,Qr,nr,je),Kn=!0),!We&&Kn&&(Lt&&(Et.end=qt+ct*Kt),ke.push(Et),Et=Be(at)),Lt&&(qt+=ct)}let Ir=at.length-3;const Ar=at[Ir],$r=at[Ir+1],hn=qe===0?Ar:$r;hn>=be&&hn<=je&&Qe(Et,Ar,$r,at[Ir+2]),Ir=Et.length-3,We&&Ir>=3&&(Et[Ir]!==Et[0]||Et[Ir+1]!==Et[1])&&Qe(Et,Et[0],Et[1],Et[2]),Et.length&&ke.push(Et)}function Be(at){const ke=[];return ke.size=at.size,ke.start=at.start,ke.end=at.end,ke}function ot(at,ke,be,je,qe,We){for(const Lt of at)Xe(Lt,ke,be,je,qe,We,!1)}function Qe(at,ke,be,je){at.push(ke,be,je)}function rt(at,ke,be,je,qe,We){const Lt=(We-ke)/(je-ke);return Qe(at,We,be+(qe-be)*Lt,1),Lt}function Re(at,ke,be,je,qe,We){const Lt=(We-be)/(qe-be);return Qe(at,ke+(je-ke)*Lt,We,1),Lt}function zt(at,ke){const be=[];for(let je=0;je<at.length;je++){const qe=at[je],We=qe.type;let Lt;if(We==="Point"||We==="MultiPoint"||We==="LineString")Lt=st(qe.geometry,ke);else if(We==="MultiLineString"||We==="Polygon"){Lt=[];for(const Et of qe.geometry)Lt.push(st(Et,ke))}else if(We==="MultiPolygon"){Lt=[];for(const Et of qe.geometry){const mt=[];for(const ct of Et)mt.push(st(ct,ke));Lt.push(mt)}}be.push(Ce(qe.id,We,Lt,qe.tags))}return be}function st(at,ke){const be=[];be.size=at.size,at.start!==void 0&&(be.start=at.start,be.end=at.end);for(let je=0;je<at.length;je+=3)be.push(at[je]+ke,at[je+1],at[je+2]);return be}function $e(at,ke){if(at.transformed)return at;const be=1<<at.z,je=at.x,qe=at.y;for(const We of at.features){const Lt=We.geometry,Et=We.type;if(We.geometry=[],Et===1)for(let mt=0;mt<Lt.length;mt+=2)We.geometry.push(Jt(Lt[mt],Lt[mt+1],ke,be,je,qe));else for(let mt=0;mt<Lt.length;mt++){const ct=[];for(let Kt=0;Kt<Lt[mt].length;Kt+=2)ct.push(Jt(Lt[mt][Kt],Lt[mt][Kt+1],ke,be,je,qe));We.geometry.push(ct)}}return at.transformed=!0,at}function Jt(at,ke,be,je,qe,We){return[Math.round(be*(at*je-qe)),Math.round(be*(ke*je-We))]}function Ht(at,ke,be,je,qe){const We=ke===qe.maxZoom?0:qe.tolerance/((1<<ke)*qe.extent),Lt={features:[],numPoints:0,numSimplified:0,numFeatures:at.length,source:null,x:be,y:je,z:ke,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Et of at)pr(Lt,Et,We,qe);return Lt}function pr(at,ke,be,je){const qe=ke.geometry,We=ke.type,Lt=[];if(at.minX=Math.min(at.minX,ke.minX),at.minY=Math.min(at.minY,ke.minY),at.maxX=Math.max(at.maxX,ke.maxX),at.maxY=Math.max(at.maxY,ke.maxY),We==="Point"||We==="MultiPoint")for(let Et=0;Et<qe.length;Et+=3)Lt.push(qe[Et],qe[Et+1]),at.numPoints++,at.numSimplified++;else if(We==="LineString")_t(Lt,qe,at,be,!1,!1);else if(We==="MultiLineString"||We==="Polygon")for(let Et=0;Et<qe.length;Et++)_t(Lt,qe[Et],at,be,We==="Polygon",Et===0);else if(We==="MultiPolygon")for(let Et=0;Et<qe.length;Et++){const mt=qe[Et];for(let ct=0;ct<mt.length;ct++)_t(Lt,mt[ct],at,be,!0,ct===0)}if(Lt.length){let Et=ke.tags||null;if(We==="LineString"&&je.lineMetrics){Et={};for(const ct in ke.tags)Et[ct]=ke.tags[ct];Et.mapbox_clip_start=qe.start/qe.size,Et.mapbox_clip_end=qe.end/qe.size}const mt={geometry:Lt,type:We==="Polygon"||We==="MultiPolygon"?3:We==="LineString"||We==="MultiLineString"?2:1,tags:Et};ke.id!==null&&(mt.id=ke.id),at.features.push(mt)}}function _t(at,ke,be,je,qe,We){const Lt=je*je;if(je>0&&ke.size<(qe?Lt:je))return void(be.numPoints+=ke.length/3);const Et=[];for(let mt=0;mt<ke.length;mt+=3)(je===0||ke[mt+2]>Lt)&&(be.numSimplified++,Et.push(ke[mt],ke[mt+1])),be.numPoints++;qe&&(function(mt,ct){let Kt=0;for(let qt=0,Ir=mt.length,Ar=Ir-2;qt<Ir;Ar=qt,qt+=2)Kt+=(mt[qt]-mt[Ar])*(mt[qt+1]+mt[Ar+1]);if(Kt>0===ct)for(let qt=0,Ir=mt.length;qt<Ir/2;qt+=2){const Ar=mt[qt],$r=mt[qt+1];mt[qt]=mt[Ir-2-qt],mt[qt+1]=mt[Ir-1-qt],mt[Ir-2-qt]=Ar,mt[Ir-1-qt]=$r}})(Et,We),at.push(Et)}const vr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class br{constructor(ke,be){const je=(be=this.options=(function(We,Lt){for(const Et in Lt)We[Et]=Lt[Et];return We})(Object.create(vr),be)).debug;if(je&&console.time("preprocess data"),be.maxZoom<0||be.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(be.promoteId&&be.generateId)throw new Error("promoteId and generateId cannot be used together.");let qe=(function(We,Lt){const Et=[];if(We.type==="FeatureCollection")for(let mt=0;mt<We.features.length;mt++)xe(Et,We.features[mt],Lt,mt);else xe(Et,We.type==="Feature"?We:{geometry:We},Lt);return Et})(ke,be);this.tiles={},this.tileCoords=[],je&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",be.indexMaxZoom,be.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),qe=(function(We,Lt){const Et=Lt.buffer/Lt.extent;let mt=We;const ct=Le(We,1,-1-Et,Et,0,-1,2,Lt),Kt=Le(We,1,1-Et,2+Et,0,-1,2,Lt);return(ct||Kt)&&(mt=Le(We,1,-Et,1+Et,0,-1,2,Lt)||[],ct&&(mt=zt(ct,1).concat(mt)),Kt&&(mt=mt.concat(zt(Kt,-1)))),mt})(qe,be),qe.length&&this.splitTile(qe,0,0,0),je&&(qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ke,be,je,qe,We,Lt,Et){const mt=[ke,be,je,qe],ct=this.options,Kt=ct.debug;for(;mt.length;){qe=mt.pop(),je=mt.pop(),be=mt.pop(),ke=mt.pop();const qt=1<<be,Ir=lr(be,je,qe);let Ar=this.tiles[Ir];if(!Ar&&(Kt>1&&console.time("creation"),Ar=this.tiles[Ir]=Ht(ke,be,je,qe,ct),this.tileCoords.push({z:be,x:je,y:qe}),Kt)){Kt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",be,je,qe,Ar.numFeatures,Ar.numPoints,Ar.numSimplified),console.timeEnd("creation"));const Kn=`z${be}`;this.stats[Kn]=(this.stats[Kn]||0)+1,this.total++}if(Ar.source=ke,We==null){if(be===ct.indexMaxZoom||Ar.numPoints<=ct.indexMaxPoints)continue}else{if(be===ct.maxZoom||be===We)continue;if(We!=null){const Kn=We-be;if(je!==Lt>>Kn||qe!==Et>>Kn)continue}}if(Ar.source=null,ke.length===0)continue;Kt>1&&console.time("clipping");const $r=.5*ct.buffer/ct.extent,hn=.5-$r,zr=.5+$r,Mt=1+$r;let en=null,jn=null,Qr=null,nr=null,oi=Le(ke,qt,je-$r,je+zr,0,Ar.minX,Ar.maxX,ct),un=Le(ke,qt,je+hn,je+Mt,0,Ar.minX,Ar.maxX,ct);ke=null,oi&&(en=Le(oi,qt,qe-$r,qe+zr,1,Ar.minY,Ar.maxY,ct),jn=Le(oi,qt,qe+hn,qe+Mt,1,Ar.minY,Ar.maxY,ct),oi=null),un&&(Qr=Le(un,qt,qe-$r,qe+zr,1,Ar.minY,Ar.maxY,ct),nr=Le(un,qt,qe+hn,qe+Mt,1,Ar.minY,Ar.maxY,ct),un=null),Kt>1&&console.timeEnd("clipping"),mt.push(en||[],be+1,2*je,2*qe),mt.push(jn||[],be+1,2*je,2*qe+1),mt.push(Qr||[],be+1,2*je+1,2*qe),mt.push(nr||[],be+1,2*je+1,2*qe+1)}}getTile(ke,be,je){ke=+ke,be=+be,je=+je;const qe=this.options,{extent:We,debug:Lt}=qe;if(ke<0||ke>24)return null;const Et=1<<ke,mt=lr(ke,be=be+Et&Et-1,je);if(this.tiles[mt])return $e(this.tiles[mt],We);Lt>1&&console.log("drilling down to z%d-%d-%d",ke,be,je);let ct,Kt=ke,qt=be,Ir=je;for(;!ct&&Kt>0;)Kt--,qt>>=1,Ir>>=1,ct=this.tiles[lr(Kt,qt,Ir)];return ct&&ct.source?(Lt>1&&(console.log("found parent tile z%d-%d-%d",Kt,qt,Ir),console.time("drilling down")),this.splitTile(ct.source,Kt,qt,Ir,ke,be,je),Lt>1&&console.timeEnd("drilling down"),this.tiles[mt]?$e(this.tiles[mt],We):null):null}}function lr(at,ke,be){return 32*((1<<at)*be+ke)+at}class Cr extends A{constructor(ke,be,je,qe=Tr){super(ke,be,je),this._dataUpdateable=new Map,this._createGeoJSONIndex=qe}loadVectorTile(ke,be){return s._(this,void 0,void 0,(function*(){const je=ke.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const qe=this._geoJSONIndex.getTile(je.z,je.x,je.y);return qe?E(new s.d2(qe.features,{version:2,extent:s.a5})):null}))}loadData(ke){return s._(this,void 0,void 0,(function*(){var be;(be=this._pendingRequest)===null||be===void 0||be.abort();const je=this._startPerformance(ke);this._pendingRequest=new AbortController;try{(!this._pendingData||ke.request||ke.data||ke.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(ke,this._pendingRequest));const qe=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(qe,ke),this.loaded={};const We={};return ke.request&&(We.data=qe),this._finishPerformance(je,ke,We),We}catch(qe){if(delete this._pendingRequest,s.Z(qe))return{abandoned:!0};throw qe}}))}_startPerformance(ke){var be;if(!((be=ke?.request)===null||be===void 0)&&be.collectResourceTiming)return new s.c_(ke.request)}_finishPerformance(ke,be,je){if(!ke)return;const qe=ke.finish();qe&&(je.resourceTiming={},je.resourceTiming[be.source]=JSON.parse(JSON.stringify(qe)))}getData(){return s._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(ke){const be=this.loaded;return be&&be[ke.uid]?super.reloadTile(ke):this.loadTile(ke)}loadAndProcessGeoJSON(ke,be){return s._(this,void 0,void 0,(function*(){let je;if(ke.request?je=yield this.loadGeoJSONFromUrl(ke.request,ke.promoteId,be):ke.data?je=this._loadGeoJSONFromObject(ke.data,ke.promoteId):ke.dataDiff&&(je=this._loadGeoJSONFromDiff(ke.dataDiff,ke.promoteId,ke.source)),delete this._pendingRequest,typeof je!="object")throw new Error(`Input data given to '${ke.source}' is not a valid GeoJSON object.`);return U(je,!0),ke.filter&&(je=this._filterGeoJSON(je,ke.filter)),je}))}loadGeoJSONFromUrl(ke,be,je){return s._(this,void 0,void 0,(function*(){const qe=yield s.j(ke,je);return this._dataUpdateable=s.a7(qe.data,be),qe.data}))}_loadGeoJSONFromObject(ke,be){return this._dataUpdateable=s.a7(ke,be),ke}_loadGeoJSONFromDiff(ke,be,je){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${je}`);s.a8(this._dataUpdateable,ke,be);const qe=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(qe)}_filterGeoJSON(ke,be){const je=s.d3(be,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(je.result==="error")throw new Error(je.value.map((We=>`${We.key}: ${We.message}`)).join(", "));const qe=ke.features.filter((We=>je.value.evaluate({zoom:0},We)));return this._toFeatureCollection(qe)}_toFeatureCollection(ke){return{type:"FeatureCollection",features:ke}}removeSource(ke){return s._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(ke){return this._geoJSONIndex.getClusterExpansionZoom(ke.clusterId)}getClusterChildren(ke){return this._geoJSONIndex.getChildren(ke.clusterId)}getClusterLeaves(ke){return this._geoJSONIndex.getLeaves(ke.clusterId,ke.limit,ke.offset)}}function Tr(at,ke){return ke.cluster?new X((function({superclusterOptions:be,clusterProperties:je}){if(!je||!be)return be;const qe={},We={},Lt={accumulated:null,zoom:0},Et={properties:null},mt=Object.keys(je);for(const ct of mt){const[Kt,qt]=je[ct],Ir=s.d3(qt),Ar=s.d3(typeof Kt=="string"?[Kt,["accumulated"],["get",ct]]:Kt);qe[ct]=Ir.value,We[ct]=Ar.value}return be.map=ct=>{Et.properties=ct;const Kt={};for(const qt of mt)Kt[qt]=qe[qt].evaluate(Lt,Et);return Kt},be.reduce=(ct,Kt)=>{Et.properties=Kt;for(const qt of mt)Lt.accumulated=ct[qt],ct[qt]=We[qt].evaluate(Lt,Et)},be})(ke)).load(at.features):(function(be,je){return new br(be,je)})(at,ke.geojsonVtOptions)}class Qt{constructor(ke){this.self=ke,this.actor=new s.L(ke),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(be,je)=>{if(this.externalWorkerSourceTypes[be])throw new Error(`Worker source with name "${be}" already registered.`);this.externalWorkerSourceTypes[be]=je},this.self.addProtocol=s.cJ,this.self.removeProtocol=s.cK,this.self.registerRTLTextPlugin=be=>{s.d4.setMethods(be)},this.actor.registerMessageHandler("LDT",((be,je)=>this._getDEMWorkerSource(be,je.source).loadTile(je))),this.actor.registerMessageHandler("RDT",((be,je)=>s._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(be,je.source).removeTile(je)})))),this.actor.registerMessageHandler("GCEZ",((be,je)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(be,je.type,je.source).getClusterExpansionZoom(je)})))),this.actor.registerMessageHandler("GCC",((be,je)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(be,je.type,je.source).getClusterChildren(je)})))),this.actor.registerMessageHandler("GCL",((be,je)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(be,je.type,je.source).getClusterLeaves(je)})))),this.actor.registerMessageHandler("LD",((be,je)=>this._getWorkerSource(be,je.type,je.source).loadData(je))),this.actor.registerMessageHandler("GD",((be,je)=>this._getWorkerSource(be,je.type,je.source).getData())),this.actor.registerMessageHandler("LT",((be,je)=>this._getWorkerSource(be,je.type,je.source).loadTile(je))),this.actor.registerMessageHandler("RT",((be,je)=>this._getWorkerSource(be,je.type,je.source).reloadTile(je))),this.actor.registerMessageHandler("AT",((be,je)=>this._getWorkerSource(be,je.type,je.source).abortTile(je))),this.actor.registerMessageHandler("RMT",((be,je)=>this._getWorkerSource(be,je.type,je.source).removeTile(je))),this.actor.registerMessageHandler("RS",((be,je)=>s._(this,void 0,void 0,(function*(){if(!this.workerSources[be]||!this.workerSources[be][je.type]||!this.workerSources[be][je.type][je.source])return;const qe=this.workerSources[be][je.type][je.source];delete this.workerSources[be][je.type][je.source],qe.removeSource!==void 0&&qe.removeSource(je)})))),this.actor.registerMessageHandler("RM",(be=>s._(this,void 0,void 0,(function*(){delete this.layerIndexes[be],delete this.availableImages[be],delete this.workerSources[be],delete this.demWorkerSources[be],this.globalStates.delete(be)})))),this.actor.registerMessageHandler("SR",((be,je)=>s._(this,void 0,void 0,(function*(){this.referrer=je})))),this.actor.registerMessageHandler("SRPS",((be,je)=>this._syncRTLPluginState(be,je))),this.actor.registerMessageHandler("IS",((be,je)=>s._(this,void 0,void 0,(function*(){this.self.importScripts(je)})))),this.actor.registerMessageHandler("SI",((be,je)=>this._setImages(be,je))),this.actor.registerMessageHandler("UL",((be,je)=>s._(this,void 0,void 0,(function*(){this._getLayerIndex(be).update(je.layers,je.removedIds,this._getGlobalState(be))})))),this.actor.registerMessageHandler("UGS",((be,je)=>s._(this,void 0,void 0,(function*(){const qe=this._getGlobalState(be);for(const We in je)qe[We]=je[We]})))),this.actor.registerMessageHandler("SL",((be,je)=>s._(this,void 0,void 0,(function*(){this._getLayerIndex(be).replace(je,this._getGlobalState(be))}))))}_getGlobalState(ke){let be=this.globalStates.get(ke);return be||(be={},this.globalStates.set(ke,be)),be}_setImages(ke,be){return s._(this,void 0,void 0,(function*(){this.availableImages[ke]=be;for(const je in this.workerSources[ke]){const qe=this.workerSources[ke][je];for(const We in qe)qe[We].availableImages=be}}))}_syncRTLPluginState(ke,be){return s._(this,void 0,void 0,(function*(){return yield s.d4.syncState(be,this.self.importScripts)}))}_getAvailableImages(ke){let be=this.availableImages[ke];return be||(be=[]),be}_getLayerIndex(ke){let be=this.layerIndexes[ke];return be||(be=this.layerIndexes[ke]=new o),be}_getWorkerSource(ke,be,je){if(this.workerSources[ke]||(this.workerSources[ke]={}),this.workerSources[ke][be]||(this.workerSources[ke][be]={}),!this.workerSources[ke][be][je]){const qe={sendAsync:(We,Lt)=>(We.targetMapId=ke,this.actor.sendAsync(We,Lt))};switch(be){case"vector":this.workerSources[ke][be][je]=new A(qe,this._getLayerIndex(ke),this._getAvailableImages(ke));break;case"geojson":this.workerSources[ke][be][je]=new Cr(qe,this._getLayerIndex(ke),this._getAvailableImages(ke));break;default:this.workerSources[ke][be][je]=new this.externalWorkerSourceTypes[be](qe,this._getLayerIndex(ke),this._getAvailableImages(ke))}}return this.workerSources[ke][be][je]}_getDEMWorkerSource(ke,be){return this.demWorkerSources[ke]||(this.demWorkerSources[ke]={}),this.demWorkerSources[ke][be]||(this.demWorkerSources[ke][be]=new M),this.demWorkerSources[ke][be]}}return s.i(self)&&(self.worker=new Qt(self)),Qt})),i("index",["exports","./shared"],(function(s,o){var c="5.16.0";function h(){var D=new o.A(4);return o.A!=Float32Array&&(D[1]=0,D[2]=0),D[0]=1,D[3]=1,D}let d,m,b;const x={frame(D,u,g){const w=requestAnimationFrame((L=>{C(),u(L)})),{unsubscribe:C}=o.s(D.signal,"abort",(()=>{C(),cancelAnimationFrame(w),g(new o.a(D.signal.reason))}),!1)},frameAsync(D){return new Promise(((u,g)=>{this.frame(D,u,g)}))},getImageData(D,u=0){return this.getImageCanvasContext(D).getImageData(-u,-u,D.width+2*u,D.height+2*u)},getImageCanvasContext(D){const u=window.document.createElement("canvas"),g=u.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return u.width=D.width,u.height=D.height,g.drawImage(D,0,0,D.width,D.height),g},resolveURL:D=>(d||(d=document.createElement("a")),d.href=D,d.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return b!==void 0?b:!!matchMedia&&(m==null&&(m=matchMedia("(prefers-reduced-motion: reduce)")),m.matches)},set prefersReducedMotion(D){b=D}},E=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(D){this._frozenAt=D}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function T(){return E.getCurrentTime()}class A{static testProp(u){if(!A.docStyle)return u[0];for(let g=0;g<u.length;g++)if(u[g]in A.docStyle)return u[g];return u[0]}static create(u,g,w){const C=window.document.createElement(u);return g!==void 0&&(C.className=g),w&&w.appendChild(C),C}static createNS(u,g){return window.document.createElementNS(u,g)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(u,g){u.style[A.transformProp]=g}static addEventListener(u,g,w,C={}){u.addEventListener(g,w,"passive"in C?C:C.capture)}static removeEventListener(u,g,w,C={}){u.removeEventListener(g,w,"passive"in C?C:C.capture)}static suppressClickInternal(u){u.preventDefault(),u.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",A.suppressClickInternal,!0)}),0)}static getScale(u){const g=u.getBoundingClientRect();return{x:g.width/u.offsetWidth||1,y:g.height/u.offsetHeight||1,boundingClientRect:g}}static getPoint(u,g,w){const C=g.boundingClientRect;return new o.P((w.clientX-C.left)/g.x-u.clientLeft,(w.clientY-C.top)/g.y-u.clientTop)}static mousePos(u,g){const w=A.getScale(u);return A.getPoint(u,w,g)}static touchPos(u,g){const w=[],C=A.getScale(u);for(let L=0;L<g.length;L++)w.push(A.getPoint(u,C,g[L]));return w}static mouseButton(u){return u.button}static remove(u){u.parentNode&&u.parentNode.removeChild(u)}static sanitize(u){const g=new DOMParser().parseFromString(u,"text/html").body||document.createElement("body"),w=g.querySelectorAll("script");for(const C of w)C.remove();return A.clean(g),g.innerHTML}static isPossiblyDangerous(u,g){const w=g.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(u)||!w.includes("javascript:")&&!w.includes("data:"))||!!u.startsWith("on")||void 0}static clean(u){const g=u.children;for(const w of g)A.removeAttributes(w),A.clean(w)}static removeAttributes(u){for(const{name:g,value:w}of u.attributes)A.isPossiblyDangerous(g,w)&&u.removeAttribute(g)}}A.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);const M={supported:!1,testSupport:function(D){!O&&N&&(U?j(D):F=D)}};let F,N,O=!1,U=!1;function j(D){const u=D.createTexture();D.bindTexture(D.TEXTURE_2D,u);try{if(D.texImage2D(D.TEXTURE_2D,0,D.RGBA,D.RGBA,D.UNSIGNED_BYTE,N),D.isContextLost())return;M.supported=!0}catch{}D.deleteTexture(u),O=!0}var H;typeof document<"u"&&(N=document.createElement("img"),N.onload=()=>{F&&j(F),F=null,U=!0},N.onerror=()=>{O=!0,F=null},N.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(D){let u,g,w,C;D.resetRequestQueue=()=>{u=[],g=0,w=0,C={}},D.addThrottleControl=re=>{const le=w++;return C[le]=re,le},D.removeThrottleControl=re=>{delete C[re],z()},D.getImage=(re,le,fe=!0)=>new Promise(((Ie,Te)=>{M.supported&&(re.headers||(re.headers={}),re.headers.accept="image/webp,*/*"),o.e(re,{type:"image"}),u.push({abortController:le,requestParameters:re,supportImageRefresh:fe,state:"queued",onError:Ue=>{Te(Ue)},onSuccess:Ue=>{Ie(Ue)}}),z()}));const L=re=>o._(this,void 0,void 0,(function*(){re.state="running";const{requestParameters:le,supportImageRefresh:fe,onError:Ie,onSuccess:Te,abortController:Ue}=re,Ze=fe===!1&&!o.i(self)&&!o.g(le.url)&&(!le.headers||Object.keys(le.headers).reduce(((dt,xt)=>dt&&xt==="accept"),!0));g++;const ft=Ze?Y(le,Ue):o.m(le,Ue);try{const dt=yield ft;delete re.abortController,re.state="completed",dt.data instanceof HTMLImageElement||o.b(dt.data)?Te(dt):dt.data&&Te({data:yield(pt=dt.data,typeof createImageBitmap=="function"?o.f(pt):o.h(pt)),cacheControl:dt.cacheControl,expires:dt.expires})}catch(dt){delete re.abortController,Ie(dt)}finally{g--,z()}var pt})),z=()=>{const re=(()=>{for(const le of Object.keys(C))if(C[le]())return!0;return!1})()?o.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let le=g;le<re&&u.length>0;le++){const fe=u.shift();fe.abortController.signal.aborted?le--:L(fe)}},Y=(re,le)=>new Promise(((fe,Ie)=>{const Te=new Image,Ue=re.url,Ze=re.credentials;Ze&&Ze==="include"?Te.crossOrigin="use-credentials":(Ze&&Ze==="same-origin"||!o.d(Ue))&&(Te.crossOrigin="anonymous"),le.signal.addEventListener("abort",(()=>{Te.src="",Ie(new o.a(le.signal.reason))})),Te.fetchPriority="high",Te.onload=()=>{Te.onerror=Te.onload=null,fe({data:Te})},Te.onerror=()=>{Te.onerror=Te.onload=null,le.signal.aborted||Ie(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Te.src=Ue}))})(H||(H={})),H.resetRequestQueue();class G{constructor(u){this._transformRequestFn=u??null}transformRequest(u,g){return this._transformRequestFn&&this._transformRequestFn(u,g)||{url:u}}setTransformRequest(u){this._transformRequestFn=u}}function X(D){const u=[];if(typeof D=="string")u.push({id:"default",url:D});else if(D&&D.length>0){const g=[];for(const{id:w,url:C}of D){const L=`${w}${C}`;g.indexOf(L)===-1&&(g.push(L),u.push({id:w,url:C}))}}return u}function ae(D,u,g){try{const w=new URL(D);return w.pathname+=`${u}${g}`,w.toString()}catch{throw new Error(`Invalid sprite URL "${D}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Q(D){const{userImage:u}=D;return!!(u&&u.render&&u.render())&&(D.data.replace(new Uint8Array(u.data.buffer)),!0)}class W extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const u of Object.keys(this.images))this.removeImage(u);this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(u){if(this.loaded!==u&&(this.loaded=u,u)){for(const{ids:g,promiseResolve:w}of this.requestors)w(this._getImagesForIds(g));this.requestors=[]}}getImage(u){const g=this.images[u];if(g&&!g.data&&g.spriteData){const w=g.spriteData;g.data=new o.R({width:w.width,height:w.height},w.context.getImageData(w.x,w.y,w.width,w.height).data),g.spriteData=null}return g}addImage(u,g){if(this.images[u])throw new Error(`Image id ${u} already exist, use updateImage instead`);this._validate(u,g)&&(this.images[u]=g)}_validate(u,g){let w=!0;const C=g.data||g.spriteData;return this._validateStretch(g.stretchX,C&&C.width)||(this.fire(new o.k(new Error(`Image "${u}" has invalid "stretchX" value`))),w=!1),this._validateStretch(g.stretchY,C&&C.height)||(this.fire(new o.k(new Error(`Image "${u}" has invalid "stretchY" value`))),w=!1),this._validateContent(g.content,g)||(this.fire(new o.k(new Error(`Image "${u}" has invalid "content" value`))),w=!1),w}_validateStretch(u,g){if(!u)return!0;let w=0;for(const C of u){if(C[0]<w||C[1]<C[0]||g<C[1])return!1;w=C[1]}return!0}_validateContent(u,g){if(!u)return!0;if(u.length!==4)return!1;const w=g.spriteData,C=w&&w.width||g.data.width,L=w&&w.height||g.data.height;return!(u[0]<0||C<u[0]||u[1]<0||L<u[1]||u[2]<0||C<u[2]||u[3]<0||L<u[3]||u[2]<u[0]||u[3]<u[1])}updateImage(u,g,w=!0){const C=this.getImage(u);if(w&&(C.data.width!==g.data.width||C.data.height!==g.data.height))throw new Error(`size mismatch between old image (${C.data.width}x${C.data.height}) and new image (${g.data.width}x${g.data.height}).`);g.version=C.version+1,this.images[u]=g,this.updatedImages[u]=!0}removeImage(u){const g=this.images[u];delete this.images[u],delete this.patterns[u],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(u){return new Promise(((g,w)=>{let C=!0;if(!this.isLoaded())for(const L of u)this.images[L]||(C=!1);this.isLoaded()||C?g(this._getImagesForIds(u)):this.requestors.push({ids:u,promiseResolve:g})}))}_getImagesForIds(u){const g={};for(const w of u){let C=this.getImage(w);C||(this.fire(new o.l("styleimagemissing",{id:w})),C=this.getImage(w)),C?g[w]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,textFitWidth:C.textFitWidth,textFitHeight:C.textFitHeight,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:o.w(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return g}getPixelSize(){const{width:u,height:g}=this.atlasImage;return{width:u,height:g}}getPattern(u){const g=this.patterns[u],w=this.getImage(u);if(!w)return null;if(g&&g.position.version===w.version)return g.position;if(g)g.position.version=w.version;else{const C={w:w.data.width+2,h:w.data.height+2,x:0,y:0},L=new o.I(C,w);this.patterns[u]={bin:C,position:L}}return this._updatePatternAtlas(),this.patterns[u].position}bind(u){const g=u.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(u,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(){const u=[];for(const L in this.patterns)u.push(this.patterns[L].bin);const{w:g,h:w}=o.p(u),C=this.atlasImage;C.resize({width:g||1,height:w||1});for(const L in this.patterns){const{bin:z}=this.patterns[L],Y=z.x+1,re=z.y+1,le=this.getImage(L).data,fe=le.width,Ie=le.height;o.R.copy(le,C,{x:0,y:0},{x:Y,y:re},{width:fe,height:Ie}),o.R.copy(le,C,{x:0,y:Ie-1},{x:Y,y:re-1},{width:fe,height:1}),o.R.copy(le,C,{x:0,y:0},{x:Y,y:re+Ie},{width:fe,height:1}),o.R.copy(le,C,{x:fe-1,y:0},{x:Y-1,y:re},{width:1,height:Ie}),o.R.copy(le,C,{x:0,y:0},{x:Y+fe,y:re},{width:1,height:Ie})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(u){for(const g of u){if(this.callbackDispatchedThisFrame[g])continue;this.callbackDispatchedThisFrame[g]=!0;const w=this.getImage(g);w||o.w(`Image with ID: "${g}" was not found`),Q(w)&&this.updateImage(g,w)}}cloneImages(){const u={};for(const g in this.images){const w=this.images[g];u[g]=Object.assign(Object.assign({},w),{data:w.data?w.data.clone():null})}return u}}const oe=1e20;function se(D,u,g,w,C,L,z,Y,re){for(let le=u;le<u+w;le++)he(D,g*L+le,L,C,z,Y,re);for(let le=g;le<g+C;le++)he(D,le*L+u,1,w,z,Y,re)}function he(D,u,g,w,C,L,z){L[0]=0,z[0]=-oe,z[1]=oe,C[0]=D[u];for(let Y=1,re=0,le=0;Y<w;Y++){C[Y]=D[u+Y*g];const fe=Y*Y;do{const Ie=L[re];le=(C[Y]-C[Ie]+fe-Ie*Ie)/(Y-Ie)/2}while(le<=z[re]&&--re>-1);re++,L[re]=Y,z[re]=le,z[re+1]=oe}for(let Y=0,re=0;Y<w;Y++){for(;z[re+1]<Y;)re++;const le=L[re],fe=Y-le;D[u+Y*g]=C[le]+fe*fe}}const _e=o.v.layout_symbol["text-font"].default.join(",");class Ce{constructor(u,g,w){this.requestManager=u,this.localIdeographFontFamily=g,this.entries={},this.lang=w}setURL(u){this.url=u}getGlyphs(u){return o._(this,void 0,void 0,(function*(){const g=[];for(const L in u)for(const z of u[L])g.push(this._getAndCacheGlyphsPromise(L,z));const w=yield Promise.all(g),C={};for(const{stack:L,id:z,glyph:Y}of w)C[L]||(C[L]={}),C[L][z]=Y&&{id:Y.id,bitmap:Y.bitmap.clone(),metrics:Y.metrics};return C}))}_getAndCacheGlyphsPromise(u,g){return o._(this,void 0,void 0,(function*(){let w=this.entries[u];w||(w=this.entries[u]={glyphs:{},requests:{},ranges:{}});let C=w.glyphs[g];return C!==void 0?{stack:u,id:g,glyph:C}:!this.url||this._charUsesLocalIdeographFontFamily(g)?(C=w.glyphs[g]=this._drawGlyph(w,u,g),{stack:u,id:g,glyph:C}):yield this._downloadAndCacheRangePromise(u,g)}))}_downloadAndCacheRangePromise(u,g){return o._(this,void 0,void 0,(function*(){const w=this.entries[u],C=Math.floor(g/256);if(w.ranges[C])return{stack:u,id:g,glyph:null};if(!w.requests[C]){const L=Ce.loadGlyphRange(u,C,this.url,this.requestManager);w.requests[C]=L}try{const L=yield w.requests[C];for(const z in L)w.glyphs[+z]=L[+z];return w.ranges[C]=!0,{stack:u,id:g,glyph:L[g]||null}}catch(L){const z=w.glyphs[g]=this._drawGlyph(w,u,g);return this._warnOnMissingGlyphRange(z,C,g,L),{stack:u,id:g,glyph:z}}}))}_warnOnMissingGlyphRange(u,g,w,C){const L=256*g,z=L+255,Y=w.toString(16).padStart(4,"0").toUpperCase();o.w(`Unable to load glyph range ${g}, ${L}-${z}. Rendering codepoint U+${Y} locally instead. ${C}`)}_charUsesLocalIdeographFontFamily(u){return!!this.localIdeographFontFamily&&o.q(u)}_drawGlyph(u,g,w){const C=g===_e&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(w),L=C?"ideographTinySDF":"tinySDF";u[L]||(u[L]=this._createTinySDF(C?this.localIdeographFontFamily:g));const z=u[L].draw(String.fromCodePoint(w)),Y=new RegExp("^\\p{gc=Cf}+$","u").test(String.fromCodePoint(w));return{id:w,bitmap:new o.r({width:z.width||60,height:z.height||60},z.data),metrics:{width:Y?0:z.glyphWidth/2||24,height:z.glyphHeight/2||24,left:z.glyphLeft/2+.5||0,top:z.glyphTop/2-27.5||-8,advance:Y?0:z.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(u){const g=u?u.split(","):[];g.push("sans-serif");const w=g.map((C=>/[-\w]+/.test(C)?C:`'${CSS.escape(C)}'`)).join(",");return new Ce.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:w,fontWeight:this._fontWeight(g[0]),fontStyle:this._fontStyle(g[0]),lang:this.lang})}_fontStyle(u){return/italic/i.test(u)?"italic":/oblique/i.test(u)?"oblique":"normal"}_fontWeight(u){const g={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let w;for(const[C,L]of Object.entries(g))new RegExp(`\\b${C}\\b`,"i").test(u)&&(w=`${L}`);return w}destroy(){for(const u in this.entries){const g=this.entries[u];g.tinySDF&&(g.tinySDF=null),g.ideographTinySDF&&(g.ideographTinySDF=null),g.glyphs={},g.requests={},g.ranges={}}this.entries={}}}Ce.loadGlyphRange=function(D,u,g,w){return o._(this,void 0,void 0,(function*(){const C=256*u,L=C+255,z=w.transformRequest(g.replace("{fontstack}",D).replace("{range}",`${C}-${L}`),"Glyphs"),Y=yield o.n(z,new AbortController);if(!Y||!Y.data)throw new Error(`Could not load glyph range. range: ${u}, ${C}-${L}`);const re={};for(const le of o.o(Y.data))re[le.id]=le;return re}))},Ce.TinySDF=class{constructor({fontSize:D=24,buffer:u=3,radius:g=8,cutoff:w=.25,fontFamily:C="sans-serif",fontWeight:L="normal",fontStyle:z="normal",lang:Y=null}={}){this.buffer=u,this.cutoff=w,this.radius=g,this.lang=Y;const re=this.size=D+4*u,le=this._createCanvas(re),fe=this.ctx=le.getContext("2d",{willReadFrequently:!0});fe.font=`${z} ${L} ${D}px ${C}`,fe.textBaseline="alphabetic",fe.textAlign="left",fe.fillStyle="black",this.gridOuter=new Float64Array(re*re),this.gridInner=new Float64Array(re*re),this.f=new Float64Array(re),this.z=new Float64Array(re+1),this.v=new Uint16Array(re)}_createCanvas(D){const u=document.createElement("canvas");return u.width=u.height=D,u}draw(D){const{width:u,actualBoundingBoxAscent:g,actualBoundingBoxDescent:w,actualBoundingBoxLeft:C,actualBoundingBoxRight:L}=this.ctx.measureText(D),z=Math.ceil(g),Y=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(L-C))),re=Math.min(this.size-this.buffer,z+Math.ceil(w)),le=Y+2*this.buffer,fe=re+2*this.buffer,Ie=Math.max(le*fe,0),Te=new Uint8ClampedArray(Ie),Ue={data:Te,width:le,height:fe,glyphWidth:Y,glyphHeight:re,glyphTop:z,glyphLeft:0,glyphAdvance:u};if(Y===0||re===0)return Ue;const{ctx:Ze,buffer:ft,gridInner:pt,gridOuter:dt}=this;this.lang&&(Ze.lang=this.lang),Ze.clearRect(ft,ft,Y,re),Ze.fillText(D,ft,ft+z);const xt=Ze.getImageData(ft,ft,Y,re);dt.fill(oe,0,Ie),pt.fill(0,0,Ie);for(let Ot=0;Ot<re;Ot++)for(let wt=0;wt<Y;wt++){const Nt=xt.data[4*(Ot*Y+wt)+3]/255;if(Nt===0)continue;const jt=(Ot+ft)*le+wt+ft;if(Nt===1)dt[jt]=0,pt[jt]=oe;else{const Dt=.5-Nt;dt[jt]=Dt>0?Dt*Dt:0,pt[jt]=Dt<0?Dt*Dt:0}}se(dt,0,0,le,fe,le,this.f,this.v,this.z),se(pt,ft,ft,Y,re,le,this.f,this.v,this.z);for(let Ot=0;Ot<Ie;Ot++){const wt=Math.sqrt(dt[Ot])-Math.sqrt(pt[Ot]);Te[Ot]=Math.round(255-255*(wt/this.radius+this.cutoff))}return Ue}};class me{constructor(){this.specification=o.u.light.position}possiblyEvaluate(u,g){return o.F(u.expression.evaluate(g))}interpolate(u,g,w){return{x:o.G.number(u.x,g.x,w),y:o.G.number(u.y,g.y,w),z:o.G.number(u.z,g.z,w)}}}let xe;class Ae extends o.E{constructor(u){super(),xe=xe||new o.t({anchor:new o.D(o.u.light.anchor),position:new me,color:new o.D(o.u.light.color),intensity:new o.D(o.u.light.intensity)}),this._transitionable=new o.x(xe,void 0),this.setLight(u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(u,g={}){if(!this._validate(o.y,u,g))for(const w in u){const C=u[w];w.endsWith(o.z)?this._transitionable.setTransition(w.slice(0,-o.z.length),C):this._transitionable.setValue(w,C)}}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,g,w){return(!w||w.validate!==!1)&&o.B(this,u.call(o.C,{value:g,style:{glyphs:!0,sprite:!0},styleSpec:o.u}))}}const De=new o.t({"sky-color":new o.D(o.u.sky["sky-color"]),"horizon-color":new o.D(o.u.sky["horizon-color"]),"fog-color":new o.D(o.u.sky["fog-color"]),"fog-ground-blend":new o.D(o.u.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.u.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.u.sky["atmosphere-blend"])});class de extends o.E{constructor(u){super(),this._transitionable=new o.x(De,void 0),this.setSky(u),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0))}setSky(u,g={}){if(!this._validate(o.J,u,g)){u||(u={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const w in u){const C=u[w];w.endsWith(o.z)?this._transitionable.setTransition(w.slice(0,-o.z.length),C):this._transitionable.setValue(w,C)}}}getSky(){return this._transitionable.serialize()}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,g,w={}){return w?.validate!==!1&&o.B(this,u.call(o.C,o.e({value:g,style:{glyphs:!0,sprite:!0},styleSpec:o.u})))}calculateFogBlendOpacity(u){return u<60?0:u<70?(u-60)/10:1}}class Ee{constructor(u,g){this.width=u,this.height=g,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(u,g){const w=u.join(",")+String(g);return this.dashEntry[w]||(this.dashEntry[w]=this.addDash(u,g)),this.dashEntry[w]}getDashRanges(u,g,w){const C=[];let L=u.length%2==1?-u[u.length-1]*w:0,z=u[0]*w,Y=!0;C.push({left:L,right:z,isDash:Y,zeroLength:u[0]===0});let re=u[0];for(let le=1;le<u.length;le++){Y=!Y;const fe=u[le];L=re*w,re+=fe,z=re*w,C.push({left:L,right:z,isDash:Y,zeroLength:fe===0})}return C}addRoundDash(u,g,w){const C=g/2;for(let L=-w;L<=w;L++){const z=this.width*(this.nextRow+w+L);let Y=0,re=u[Y];for(let le=0;le<this.width;le++){le/re.right>1&&(re=u[++Y]);const fe=Math.abs(le-re.left),Ie=Math.abs(le-re.right),Te=Math.min(fe,Ie);let Ue;const Ze=L/w*(C+1);if(re.isDash){const ft=C-Math.abs(Ze);Ue=Math.sqrt(Te*Te+ft*ft)}else Ue=C-Math.sqrt(Te*Te+Ze*Ze);this.data[z+le]=Math.max(0,Math.min(255,Ue+128))}}}addRegularDash(u){for(let Y=u.length-1;Y>=0;--Y){const re=u[Y],le=u[Y+1];re.zeroLength?u.splice(Y,1):le&&le.isDash===re.isDash&&(le.left=re.left,u.splice(Y,1))}const g=u[0],w=u[u.length-1];g.isDash===w.isDash&&(g.left=w.left-this.width,w.right=g.right+this.width);const C=this.width*this.nextRow;let L=0,z=u[L];for(let Y=0;Y<this.width;Y++){Y/z.right>1&&(z=u[++L]);const re=Math.abs(Y-z.left),le=Math.abs(Y-z.right),fe=Math.min(re,le);this.data[C+Y]=Math.max(0,Math.min(255,(z.isDash?fe:-fe)+128))}}addDash(u,g){const w=g?7:0,C=2*w+1;if(this.nextRow+C>this.height)return o.w("LineAtlas out of space"),null;let L=0;for(let Y=0;Y<u.length;Y++)L+=u[Y];if(L!==0){const Y=this.width/L,re=this.getDashRanges(u,this.width,Y);g?this.addRoundDash(re,Y,w):this.addRegularDash(re)}const z={y:this.nextRow+w,height:2*w,width:L};return this.nextRow+=C,this.dirty=!0,z}bind(u){const g=u.gl;this.texture?(g.bindTexture(g.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,g.texSubImage2D(g.TEXTURE_2D,0,0,0,this.width,this.height,g.ALPHA,g.UNSIGNED_BYTE,this.data))):(this.texture=g.createTexture(),g.bindTexture(g.TEXTURE_2D,this.texture),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texImage2D(g.TEXTURE_2D,0,g.ALPHA,this.width,this.height,0,g.ALPHA,g.UNSIGNED_BYTE,this.data))}}const we="maplibre_preloaded_worker_pool";class Le{constructor(){this.active={}}acquire(u){if(!this.workers)for(this.workers=[];this.workers.length<Le.workerCount;)this.workers.push(new Worker(o.c.WORKER_URL));return this.active[u]=!0,this.workers.slice()}release(u){delete this.active[u],this.numActive()===0&&(this.workers.forEach((g=>{g.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[we]}numActive(){return Object.keys(this.active).length}}const Fe=Math.floor(x.hardwareConcurrency/2);let Xe,Be;function ot(){return Xe||(Xe=new Le),Xe}Le.workerCount=o.K(globalThis)?Math.max(Math.min(Fe,3),1):1;class Qe{constructor(u,g){this.workerPool=u,this.actors=[],this.currentActor=0,this.id=g;const w=this.workerPool.acquire(g);for(let C=0;C<w.length;C++){const L=new o.L(w[C],g);L.name=`Worker ${C}`,this.actors.push(L)}if(!this.actors.length)throw new Error("No actors found")}broadcast(u,g){const w=[];for(const C of this.actors)w.push(C.sendAsync({type:u,data:g}));return Promise.all(w)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(u=!0){this.actors.forEach((g=>{g.remove()})),this.actors=[],u&&this.workerPool.release(this.id)}registerMessageHandler(u,g){for(const w of this.actors)w.registerMessageHandler(u,g)}unregisterMessageHandler(u){for(const g of this.actors)g.unregisterMessageHandler(u)}}function rt(){return Be||(Be=new Qe(ot(),o.M),Be.registerMessageHandler("GR",((D,u,g)=>o.m(u,g)))),Be}function Re(D,u){const g=o.N();return o.O(g,g,[1,1,0]),o.Q(g,g,[.5*D.width,.5*D.height,1]),D.calculatePosMatrix?o.S(g,g,D.calculatePosMatrix(u.toUnwrapped())):g}function zt(D,u,g,w,C,L,z){var Y;const re=(function(Te,Ue,Ze){if(Te)for(const ft of Te){const pt=Ue[ft];if(pt&&pt.source===Ze&&pt.type==="fill-extrusion")return!0}else for(const ft in Ue){const pt=Ue[ft];if(pt.source===Ze&&pt.type==="fill-extrusion")return!0}return!1})((Y=C?.layers)!==null&&Y!==void 0?Y:null,u,D.id),le=L.maxPitchScaleFactor(),fe=D.tilesIn(w,le,re);fe.sort(st);const Ie=[];for(const Te of fe)Ie.push({wrappedTileID:Te.tileID.wrapped().key,queryResults:Te.tile.queryRenderedFeatures(u,g,D.getState(),Te.queryGeometry,Te.cameraQueryGeometry,Te.scale,C,L,le,Re(L,Te.tileID),z?(Ue,Ze)=>z(Te.tileID,Ue,Ze):void 0)});return(function(Te,Ue){for(const Ze in Te)for(const ft of Te[Ze])$e(ft,Ue);return Te})((function(Te){const Ue={},Ze={};for(const ft of Te){const pt=ft.queryResults,dt=ft.wrappedTileID,xt=Ze[dt]=Ze[dt]||{};for(const Ot in pt){const wt=pt[Ot],Nt=xt[Ot]=xt[Ot]||{},jt=Ue[Ot]=Ue[Ot]||[];for(const Dt of wt)Nt[Dt.featureIndex]||(Nt[Dt.featureIndex]=!0,jt.push(Dt))}}return Ue})(Ie),D)}function st(D,u){const g=D.tileID,w=u.tileID;return g.overscaledZ-w.overscaledZ||g.canonical.y-w.canonical.y||g.wrap-w.wrap||g.canonical.x-w.canonical.x}function $e(D,u){const g=D.feature,w=u.getFeatureState(g.layer["source-layer"],g.id);g.source=g.layer.source,g.layer["source-layer"]&&(g.sourceLayer=g.layer["source-layer"]),g.state=w}function Jt(D,u,g){return o._(this,void 0,void 0,(function*(){let w=D;if(D.url?w=(yield o.j(u.transformRequest(D.url,"Source"),g)).data:yield x.frameAsync(g),!w)return null;const C=o.U(o.e(w,D),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in w&&w.vector_layers&&(C.vectorLayerIds=w.vector_layers.map((L=>L.id))),C}))}class Ht{constructor(u,g){u&&(g?this.setSouthWest(u).setNorthEast(g):Array.isArray(u)&&(u.length===4?this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]]):this.setSouthWest(u[0]).setNorthEast(u[1])))}setNorthEast(u){return this._ne=u instanceof o.V?new o.V(u.lng,u.lat):o.V.convert(u),this}setSouthWest(u){return this._sw=u instanceof o.V?new o.V(u.lng,u.lat):o.V.convert(u),this}extend(u){const g=this._sw,w=this._ne;let C,L;if(u instanceof o.V)C=u,L=u;else{if(!(u instanceof Ht))return Array.isArray(u)?u.length===4||u.every(Array.isArray)?this.extend(Ht.convert(u)):this.extend(o.V.convert(u)):u&&("lng"in u||"lon"in u)&&"lat"in u?this.extend(o.V.convert(u)):this;if(C=u._sw,L=u._ne,!C||!L)return this}return g||w?(g.lng=Math.min(C.lng,g.lng),g.lat=Math.min(C.lat,g.lat),w.lng=Math.max(L.lng,w.lng),w.lat=Math.max(L.lat,w.lat)):(this._sw=new o.V(C.lng,C.lat),this._ne=new o.V(L.lng,L.lat)),this}getCenter(){return new o.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.V(this.getWest(),this.getNorth())}getSouthEast(){return new o.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(u){const{lng:g,lat:w}=o.V.convert(u);let C=this._sw.lng<=g&&g<=this._ne.lng;return this._sw.lng>this._ne.lng&&(C=this._sw.lng>=g&&g>=this._ne.lng),this._sw.lat<=w&&w<=this._ne.lat&&C}intersects(u){if(!((u=Ht.convert(u)).getNorth()>=this.getSouth()&&u.getSouth()<=this.getNorth()))return!1;const g=Math.abs(this.getEast()-this.getWest()),w=Math.abs(u.getEast()-u.getWest());if(g>=360||w>=360)return!0;const C=o.W(this.getWest(),-180,180),L=o.W(this.getEast(),-180,180),z=o.W(u.getWest(),-180,180),Y=o.W(u.getEast(),-180,180),re=C>=L,le=z>=Y;return!(!re||!le)||(re?Y>=C||z<=L:le?L>=z||C<=Y:z<=L&&Y>=C)}static convert(u){return u instanceof Ht?u:u&&new Ht(u)}static fromLngLat(u,g=0){const w=360*g/40075017,C=w/Math.cos(Math.PI/180*u.lat);return new Ht(new o.V(u.lng-C,u.lat-w),new o.V(u.lng+C,u.lat+w))}adjustAntiMeridian(){const u=new o.V(this._sw.lng,this._sw.lat),g=new o.V(this._ne.lng,this._ne.lat);return new Ht(u,u.lng>g.lng?new o.V(g.lng+360,g.lat):g)}}class pr{constructor(u,g,w){this.bounds=Ht.convert(this.validateBounds(u)),this.minzoom=g||0,this.maxzoom=w||24}validateBounds(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]}contains(u){const g=Math.pow(2,u.z),w=Math.floor(o.Y(this.bounds.getWest())*g),C=Math.floor(o.X(this.bounds.getNorth())*g),L=Math.ceil(o.Y(this.bounds.getEast())*g),z=Math.ceil(o.X(this.bounds.getSouth())*g);return u.x>=w&&u.x<L&&u.y>=C&&u.y<z}}class _t extends o.E{constructor(u,g,w,C){if(super(),this.id=u,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.U(g,["url","scheme","tileSize","promoteId","encoding"])),this._options=o.e({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield Jt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),u&&(o.e(this,u),u.bounds&&(this.tileBounds=new pr(u.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(u){this._tileJSONRequest=null,this._loaded=!0,o.Z(u)||this.fire(new o.k(u))}}))}loaded(){return this._loaded}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}onAdd(u){this.map=u,this.load()}setSourceProperty(u){this._tileJSONRequest&&this._tileJSONRequest.abort(),u(),this.load()}setTiles(u){return this.setSourceProperty((()=>{this._options.tiles=u})),this}setUrl(u){return this.setSourceProperty((()=>{this.url=u,this._options.url=u})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w={request:this.map._requestManager.transformRequest(g,"Tile"),uid:u.uid,tileID:u.tileID,zoom:u.tileID.overscaledZ,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(u)};w.request.collectResourceTiming=this._collectResourceTiming;let C="RT";if(u.actor&&u.state!=="expired"){if(u.state==="loading")return new Promise(((L,z)=>{u.reloadPromise={resolve:L,reject:z}}))}else u.actor=this.dispatcher.getActor(),C="LT";u.abortController=new AbortController;try{const L=yield u.actor.sendAsync({type:C,data:w},u.abortController);if(delete u.abortController,u.aborted)return;this._afterTileLoadWorkerResponse(u,L)}catch(L){if(delete u.abortController,u.aborted)return;if(L&&L.status!==404)throw L;this._afterTileLoadWorkerResponse(u,null)}}))}_getOverzoomParameters(u){if(u.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const g=u.tileID.scaledTo(this.maxzoom).canonical,w=g.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:g,overzoomRequest:this.map._requestManager.transformRequest(w,"Tile")}}_afterTileLoadWorkerResponse(u,g){if(g&&g.resourceTiming&&(u.resourceTiming=g.resourceTiming),g&&this.map._refreshExpiredTiles&&u.setExpiryData(g),u.loadVectorData(g,this.map.painter),u.reloadPromise){const w=u.reloadPromise;u.reloadPromise=null,this.loadTile(u).then(w.resolve).catch(w.reject)}}abortTile(u){return o._(this,void 0,void 0,(function*(){u.abortController&&(u.abortController.abort(),delete u.abortController),u.actor&&(yield u.actor.sendAsync({type:"AT",data:{uid:u.uid,type:this.type,source:this.id}}))}))}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.unloadVectorData(),u.actor&&(yield u.actor.sendAsync({type:"RMT",data:{uid:u.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class vr extends o.E{constructor(u,g,w,C){super(),this.id=u,this.dispatcher=w,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},g),o.e(this,o.U(g,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,(function*(u=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const g=yield Jt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,g&&(o.e(this,g),g.bounds&&(this.tileBounds=new pr(g.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:u})))}catch(g){this._tileJSONRequest=null,this._loaded=!0,o.Z(g)||this.fire(new o.k(g))}}))}loaded(){return this._loaded}onAdd(u){this.map=u,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(u){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),u(),this.load(!0)}setTiles(u){return this.setSourceProperty((()=>{this._options.tiles=u})),this}setUrl(u){return this.setSourceProperty((()=>{this.url=u,this._options.url=u})),this}serialize(){return o.e({},this._options)}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);u.abortController=new AbortController;try{const w=yield H.getImage(this.map._requestManager.transformRequest(g,"Tile"),u.abortController,this.map._refreshExpiredTiles);if(delete u.abortController,u.aborted)return void(u.state="unloaded");if(w&&w.data){this.map._refreshExpiredTiles&&(w.cacheControl||w.expires)&&u.setExpiryData({cacheControl:w.cacheControl,expires:w.expires});const C=this.map.painter.context,L=C.gl,z=w.data;u.texture=this.map.painter.getTileTexture(z.width),u.texture?u.texture.update(z,{useMipmap:!0}):(u.texture=new o.T(C,z,L.RGBA,{useMipmap:!0}),u.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST)),u.state="loaded"}}catch(w){if(delete u.abortController,u.aborted)u.state="unloaded";else if(w)throw u.state="errored",w}}))}abortTile(u){return o._(this,void 0,void 0,(function*(){u.abortController&&(u.abortController.abort(),delete u.abortController)}))}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.texture&&this.map.painter.saveTileTexture(u.texture)}))}hasTransition(){return!1}}class br extends vr{constructor(u,g,w,C){super(u,g,w,C),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},g),this.encoding=g.encoding||"mapbox",this.redFactor=g.redFactor,this.greenFactor=g.greenFactor,this.blueFactor=g.blueFactor,this.baseShift=g.baseShift}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w=this.map._requestManager.transformRequest(g,"Tile");u.neighboringTiles=this._getNeighboringTiles(u.tileID),u.abortController=new AbortController;try{const C=yield H.getImage(w,u.abortController,this.map._refreshExpiredTiles);if(delete u.abortController,u.aborted)return void(u.state="unloaded");if(C&&C.data){const L=C.data;this.map._refreshExpiredTiles&&(C.cacheControl||C.expires)&&u.setExpiryData({cacheControl:C.cacheControl,expires:C.expires});const z=o.b(L)&&o.$()?L:yield this.readImageNow(L),Y={type:this.type,uid:u.uid,source:this.id,rawImageData:z,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!u.actor||u.state==="expired"){u.actor=this.dispatcher.getActor();const re=yield u.actor.sendAsync({type:"LDT",data:Y});u.dem=re,u.needsHillshadePrepare=!0,u.needsTerrainPrepare=!0,u.state="loaded"}}}catch(C){if(delete u.abortController,u.aborted)u.state="unloaded";else if(C)throw u.state="errored",C}}))}readImageNow(u){return o._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&o.a0()){const g=u.width+2,w=u.height+2;try{return new o.R({width:g,height:w},yield o.a1(u,-1,-1,g,w))}catch{}}return x.getImageData(u,1)}))}_getNeighboringTiles(u){const g=u.canonical,w=Math.pow(2,g.z),C=(g.x-1+w)%w,L=g.x===0?u.wrap-1:u.wrap,z=(g.x+1+w)%w,Y=g.x+1===w?u.wrap+1:u.wrap,re={};return re[new o.a2(u.overscaledZ,L,g.z,C,g.y).key]={backfilled:!1},re[new o.a2(u.overscaledZ,Y,g.z,z,g.y).key]={backfilled:!1},g.y>0&&(re[new o.a2(u.overscaledZ,L,g.z,C,g.y-1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,u.wrap,g.z,g.x,g.y-1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,Y,g.z,z,g.y-1).key]={backfilled:!1}),g.y+1<w&&(re[new o.a2(u.overscaledZ,L,g.z,C,g.y+1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,u.wrap,g.z,g.x,g.y+1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,Y,g.z,z,g.y+1).key]={backfilled:!1}),re}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.demTexture&&this.map.painter.saveTileTexture(u.demTexture),u.fbo&&(u.fbo.destroy(),delete u.fbo),u.dem&&delete u.dem,delete u.neighboringTiles,u.state="unloaded",u.actor&&(yield u.actor.sendAsync({type:"RDT",data:{type:this.type,uid:u.uid,source:this.id}}))}))}}function lr(D){return D.type==="GeometryCollection"?D.geometries.map((u=>u.coordinates)).flat(1/0):D.coordinates.flat(1/0)}function Cr(D){const u=new Ht;let g;switch(D.type){case"FeatureCollection":g=D.features.map((w=>lr(w.geometry))).flat(1/0);break;case"Feature":g=lr(D.geometry);break;default:g=lr(D)}if(g.length==0)return u;for(let w=0;w<g.length-1;w+=2)u.extend([g[w],g[w+1]]);return u}class Tr extends o.E{constructor(u,g,w,C){super(),this.id=u,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:g.data},this.actor=w.getActor(),this.setEventedParent(C),this._data=typeof g.data=="string"?{url:g.data}:{geojson:g.data},this._options=o.e({},g),this._collectResourceTiming=g.collectResourceTiming,g.maxzoom!==void 0&&(this.maxzoom=g.maxzoom),g.type&&(this.type=g.type),g.attribution&&(this.attribution=g.attribution),this.promoteId=g.promoteId,g.clusterMaxZoom!==void 0&&this.maxzoom<=g.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${g.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:g.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(g.buffer!==void 0?g.buffer:128),tolerance:this._pixelsToTileUnits(g.tolerance!==void 0?g.tolerance:.375),extent:o.a5,maxZoom:this.maxzoom,lineMetrics:g.lineMetrics||!1,generateId:g.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(g.clusterMaxZoom),minPoints:Math.max(2,g.clusterMinPoints||2),extent:o.a5,radius:this._pixelsToTileUnits(g.clusterRadius||50),log:!1,generateId:g.generateId||!1},clusterProperties:g.clusterProperties,filter:g.filter},g.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(u){return u*(o.a5/this.tileSize)}_getClusterMaxZoom(u){const g=u?Math.round(u):this.maxzoom-1;return Number.isInteger(u)||u===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${u}" rounded to "${g}"`),g}load(){return o._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(u){this.map=u,this.load()}setData(u,g){this._data=typeof u=="string"?{url:u}:{geojson:u},this._pendingWorkerUpdate={data:u};const w=this._updateWorkerData();return g?w:this}updateData(u,g){this._pendingWorkerUpdate.diff=o.a6(this._pendingWorkerUpdate.diff,u);const w=this._updateWorkerData();return g?w:this}getData(){return o._(this,void 0,void 0,(function*(){const u=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:u})}))}getBounds(){return o._(this,void 0,void 0,(function*(){return Cr(yield this.getData())}))}setClusterOptions(u){return this.workerOptions.cluster=u.cluster,u.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(u.clusterRadius)),u.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(u.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(u){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:u,source:this.id}})}getClusterChildren(u){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:u,source:this.id}})}getClusterLeaves(u,g,w){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:u,limit:g,offset:w}})}_updateWorkerData(){return o._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void o.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:u,diff:g}=this._pendingWorkerUpdate,w=o.e({type:this.type},this.workerOptions);u!==void 0?(typeof u=="string"?(w.request=this.map._requestManager.transformRequest(x.resolveURL(u),"Source"),w.request.collectResourceTiming=this._collectResourceTiming):w.data=u,this._pendingWorkerUpdate.data=void 0):g&&(w.dataDiff=g,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new o.l("dataloading",{dataType:"source"}));try{const C=yield this.actor.sendAsync({type:"LD",data:w});if(this._isUpdatingWorker=!1,this._removed||C.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));C.data&&(this._data={geojson:C.data});const L=this._applyDiffToSource(g),z=this._getShouldReloadTileOptions(L);let Y=null;C.resourceTiming&&C.resourceTiming[this.id]&&(Y=C.resourceTiming[this.id].slice(0));const re={dataType:"source"};this._collectResourceTiming&&Y&&Y.length>0&&o.e(re,{resourceTiming:Y}),this.fire(new o.l("data",Object.assign(Object.assign({},re),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},re),{sourceDataType:"content",shouldReloadTileOptions:z})))}catch(C){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(C))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyDiffToSource(u){if(!u)return;const g=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const C=o.a7(this._data.geojson,g);if(!C)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:C}}if(!this._data.updateable)return;const w=o.a8(this._data.updateable,u,g);return u.removeAll||this._options.cluster?void 0:w}_getShouldReloadTileOptions(u){if(u)return{affectedBounds:u.filter(Boolean).map((g=>Cr(g)))}}shouldReloadTile(u,{affectedBounds:g}){if(u.state==="loading")return!0;if(u.state==="unloaded")return!1;const{buffer:w,extent:C}=this.workerOptions.geojsonVtOptions,L=(function({x:z,y:Y,z:re},le=0){const fe=o.a3((z-le)/Math.pow(2,re)),Ie=o.a4((Y+1+le)/Math.pow(2,re)),Te=o.a3((z+1+le)/Math.pow(2,re)),Ue=o.a4((Y-le)/Math.pow(2,re));return new Ht([fe,Ie],[Te,Ue])})(u.tileID.canonical,w/C);for(const z of g)if(L.intersects(z))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.actor?"RT":"LT";u.actor=this.actor;const w={type:this.type,uid:u.uid,tileID:u.tileID,zoom:u.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};u.abortController=new AbortController;const C=yield this.actor.sendAsync({type:g,data:w},u.abortController);delete u.abortController,u.unloadVectorData(),u.aborted||u.loadVectorData(C,this.map.painter,g==="RT")}))}abortTile(u){return o._(this,void 0,void 0,(function*(){u.abortController&&(u.abortController.abort(),delete u.abortController),u.aborted=!0}))}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:u.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class Qt extends o.E{constructor(u,g,w,C){super(),this.flippedWindingOrder=!1,this.id=u,this.dispatcher=w,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=g}load(u){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const g=yield H.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,g&&g.data&&(this.image=g.data,u&&(this.coordinates=u),this._finishLoading())}catch(g){this._request=null,this._loaded=!0,o.Z(g)||this.fire(new o.k(g))}}))}loaded(){return this._loaded}updateImage(u){return u.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=u.url,this.load(u.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(u){this.map=u,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(u){this.coordinates=u;const g=u.map(o.a9.fromLngLat);var w;return this.tileID=(function(C){const L=o.aa.fromPoints(C),z=L.width(),Y=L.height(),re=Math.max(z,Y),le=Math.max(0,Math.floor(-Math.log(re)/Math.LN2)),fe=Math.pow(2,le);return new o.ac(le,Math.floor((L.minX+L.maxX)/2*fe),Math.floor((L.minY+L.maxY)/2*fe))})(g),this.terrainTileRanges=this._getOverlappingTileRanges(g),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=g.map((C=>this.tileID.getTilePoint(C)._round())),this.flippedWindingOrder=((w=this.tileCoords)[1].x-w[0].x)*(w[2].y-w[0].y)-(w[1].y-w[0].y)*(w[2].x-w[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const u=this.map.painter.context,g=u.gl;this.texture||(this.texture=new o.T(u,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE));let w=!1;for(const C in this.tiles){const L=this.tiles[C];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture,w=!0)}w&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(u){return o._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(u.tileID.canonical)?(this.tiles[String(u.tileID.wrap)]=u,u.buckets={}):u.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(u){const{minX:g,minY:w,maxX:C,maxY:L}=o.aa.fromPoints(u),z={};for(let Y=0;Y<=o.ab;Y++){const re=Math.pow(2,Y),le=Math.floor(g*re),fe=Math.floor(w*re),Ie=Math.floor(C*re),Te=Math.floor(L*re),Ue=(le%re+re)%re,Ze=Ie%re,ft=Math.floor(le/re),pt=Math.floor(Ie/re);z[Y]={minWrap:ft,maxWrap:pt,minTileXWrapped:Ue,maxTileXWrapped:Ze,minTileY:fe,maxTileY:Te}}return z}}class at extends Qt{constructor(u,g,w,C){super(u,g,w,C),this.roundZoom=!0,this.type="video",this.options=g}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1;const u=this.options;this.urls=[];for(const g of u.urls)this.urls.push(this.map._requestManager.transformRequest(g,"Source").url);try{const g=yield o.ad(this.urls);if(this._loaded=!0,!g)return;this.video=g,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(g){this.fire(new o.k(g))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(u){if(this.video){const g=this.video.seekable;u<g.start(0)||u>g.end(0)?this.fire(new o.k(new o.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${g.start(0)} and ${g.end(0)}-second mark.`))):this.video.currentTime=u}}getVideo(){return this.video}onAdd(u){this.map||(this.map=u,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const u=this.map.painter.context,g=u.gl;this.texture?this.video.paused||(this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(u,this.video,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE));let w=!1;for(const C in this.tiles){const L=this.tiles[C];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture,w=!0)}w&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ke extends Qt{constructor(u,g,w,C){super(u,g,w,C),g.coordinates?Array.isArray(g.coordinates)&&g.coordinates.length===4&&!g.coordinates.some((L=>!Array.isArray(L)||L.length!==2||L.some((z=>typeof z!="number"))))||this.fire(new o.k(new o.ae(`sources.${u}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.ae(`sources.${u}`,null,'missing required property "coordinates"'))),g.animate&&typeof g.animate!="boolean"&&this.fire(new o.k(new o.ae(`sources.${u}`,null,'optional "animate" property must be a boolean value'))),g.canvas?typeof g.canvas=="string"||g.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.ae(`sources.${u}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.ae(`sources.${u}`,null,'missing required property "canvas"'))),this.options=g,this.animate=g.animate===void 0||g.animate}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(u){this.map=u,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let u=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,u=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,u=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const g=this.map.painter.context,w=g.gl;this.texture?(u||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new o.T(g,this.canvas,w.RGBA,{premultiply:!0}),this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE));let C=!1;for(const L in this.tiles){const z=this.tiles[L];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture,C=!0)}C&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const u of[this.canvas.width,this.canvas.height])if(isNaN(u)||u<=0)return!0;return!1}}const be={},je=D=>{switch(D){case"geojson":return Tr;case"image":return Qt;case"raster":return vr;case"raster-dem":return br;case"vector":return _t;case"video":return at;case"canvas":return ke}return be[D]},qe="RTLPluginLoaded";class We extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=rt()}_syncState(u){return this.status=u,this.dispatcher.broadcast("SRPS",{pluginStatus:u,pluginURL:this.url}).catch((g=>{throw this.status="error",g}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(u){return o._(this,arguments,void 0,(function*(g,w=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=x.resolveURL(g),!this.url)throw new Error(`requested url ${g} is invalid`);if(this.status==="unavailable"){if(!w)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return o._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(qe))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Lt=null;function Et(){return Lt||(Lt=new We),Lt}var mt,ct;(function(D){D[D.Base=0]="Base",D[D.Parent=1]="Parent"})(mt||(mt={})),(function(D){D[D.Departing=0]="Departing",D[D.Incoming=1]="Incoming"})(ct||(ct={}));class Kt{constructor(u,g){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=u,this.uid=o.af(),this.uses=0,this.tileSize=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(u){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(u||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:u,fadingDirection:g,fadingParentID:w,fadeEndTime:C}){this.resetFadeLogic(),this.fadingRole=u,this.fadingDirection=g,this.fadingParentID=w,this.fadeEndTime=C}setSelfFadeLogic(u){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=u}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=T(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(u){this.demTexture&&u.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(u,g,w){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",u){u.featureIndex&&(this.latestFeatureIndex=u.featureIndex,u.rawTileData?(this.latestRawTileData=u.rawTileData,this.latestFeatureIndex.rawTileData=u.rawTileData,this.latestFeatureIndex.encoding=u.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=u.collisionBoxArray,this.buckets=(function(C,L){const z={};if(!L)return z;for(const Y of C){const re=Y.layerIds.map((le=>L.getLayer(le))).filter(Boolean);if(re.length!==0){Y.layers=re,Y.stateDependentLayerIds&&(Y.stateDependentLayers=Y.stateDependentLayerIds.map((le=>re.filter((fe=>fe.id===le))[0])));for(const le of re)z[le.id]=Y}}return z})(u.buckets,g?.style),this.hasSymbolBuckets=!1;for(const C in this.buckets){const L=this.buckets[C];if(L instanceof o.ah){if(this.hasSymbolBuckets=!0,!w)break;L.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const C in this.buckets){const L=this.buckets[C];if(L instanceof o.ah&&L.hasRTLText){this.hasRTLText=!0,Et().lazyLoad();break}}this.queryPadding=0;for(const C in this.buckets){const L=this.buckets[C];this.queryPadding=Math.max(this.queryPadding,g.style.getLayer(C).queryRadius(L))}u.imageAtlas&&(this.imageAtlas=u.imageAtlas),u.glyphAtlasImage&&(this.glyphAtlasImage=u.glyphAtlasImage),this.dashPositions=u.dashPositions}else this.collisionBoxArray=new o.ag}unloadVectorData(){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(u){return this.buckets[u.id]}upload(u){for(const w in this.buckets){const C=this.buckets[w];C.uploadPending()&&C.upload(u)}const g=u.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(u,this.imageAtlas.image,g.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(u,this.glyphAtlasImage,g.ALPHA),this.glyphAtlasImage=null)}prepare(u){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(u,this.imageAtlasTexture)}queryRenderedFeatures(u,g,w,C,L,z,Y,re,le,fe,Ie){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:C,cameraQueryGeometry:L,scale:z,tileSize:this.tileSize,pixelPosMatrix:fe,transform:re,params:Y,queryPadding:this.queryPadding*le,getElevation:Ie},u,g,w):{}}querySourceFeatures(u,g){const w=this.latestFeatureIndex;if(!w||!w.rawTileData)return;const C=w.loadVTLayers(),L=g&&g.sourceLayer?g.sourceLayer:"",z=C[o.ai]||C[L];if(!z)return;const Y=o.aj(g?.filter,g?.globalState),{z:re,x:le,y:fe}=this.tileID.canonical,Ie={z:re,x:le,y:fe};for(let Te=0;Te<z.length;Te++){const Ue=z.feature(Te);if(Y.needGeometry){const pt=o.ak(Ue,!0);if(!Y.filter(new o.H(this.tileID.overscaledZ),pt,this.tileID.canonical))continue}else if(!Y.filter(new o.H(this.tileID.overscaledZ),Ue))continue;const Ze=w.getId(Ue,L),ft=new o.al(Ue,re,le,fe,Ze);ft.tile=Ie,u.push(ft)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(u){const g=this.expirationTime;if(u.cacheControl){const w=o.am(u.cacheControl);w["max-age"]&&(this.expirationTime=Date.now()+1e3*w["max-age"])}else u.expires&&(this.expirationTime=new Date(u.expires).getTime());if(this.expirationTime){const w=Date.now();let C=!1;if(this.expirationTime>w)C=!1;else if(g)if(this.expirationTime<g)C=!0;else{const L=this.expirationTime-g;L?this.expirationTime=w+Math.max(L,3e4):C=!0}else C=!0;C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(u,g){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(u).length===0)return;const w=this.latestFeatureIndex.loadVTLayers();for(const C in this.buckets){if(!g.style.hasLayer(C))continue;const L=this.buckets[C],z=L.layers[0].sourceLayer||o.ai,Y=w[z],re=u[z];if(!Y||!re||Object.keys(re).length===0)continue;L.update(re,Y,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const le=g&&g.style&&g.style.getLayer(C);le&&(this.queryPadding=Math.max(this.queryPadding,le.queryRadius(L)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<T()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(u){this.symbolFadeHoldUntil=T()+u}setDependencies(u,g){const w={};for(const C of g)w[C]=!0;this.dependencies[u]=w}hasDependency(u,g){for(const w of u){const C=this.dependencies[w];if(C){for(const L of g)if(C[L])return!0}}return!1}}class qt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(u,g,w){const C=String(g);if(this.stateChanges[u]=this.stateChanges[u]||{},this.stateChanges[u][C]=this.stateChanges[u][C]||{},o.e(this.stateChanges[u][C],w),this.deletedStates[u]===null){this.deletedStates[u]={};for(const L in this.state[u])L!==C&&(this.deletedStates[u][L]=null)}else if(this.deletedStates[u]&&this.deletedStates[u][C]===null){this.deletedStates[u][C]={};for(const L in this.state[u][C])w[L]||(this.deletedStates[u][C][L]=null)}else for(const L in w)this.deletedStates[u]&&this.deletedStates[u][C]&&this.deletedStates[u][C][L]===null&&delete this.deletedStates[u][C][L]}removeFeatureState(u,g,w){if(this.deletedStates[u]===null)return;const C=String(g);if(this.deletedStates[u]=this.deletedStates[u]||{},w&&g!==void 0)this.deletedStates[u][C]!==null&&(this.deletedStates[u][C]=this.deletedStates[u][C]||{},this.deletedStates[u][C][w]=null);else if(g!==void 0)if(this.stateChanges[u]&&this.stateChanges[u][C])for(w in this.deletedStates[u][C]={},this.stateChanges[u][C])this.deletedStates[u][C][w]=null;else this.deletedStates[u][C]=null;else this.deletedStates[u]=null}getState(u,g){const w=String(g),C=o.e({},(this.state[u]||{})[w],(this.stateChanges[u]||{})[w]);if(this.deletedStates[u]===null)return{};if(this.deletedStates[u]){const L=this.deletedStates[u][g];if(L===null)return{};for(const z in L)delete C[z]}return C}initializeTileState(u,g){u.setFeatureState(this.state,g)}coalesceChanges(u,g){const w={};for(const C in this.stateChanges){this.state[C]=this.state[C]||{};const L={};for(const z in this.stateChanges[C])this.state[C][z]||(this.state[C][z]={}),o.e(this.state[C][z],this.stateChanges[C][z]),L[z]=this.state[C][z];w[C]=L}for(const C in this.deletedStates){this.state[C]=this.state[C]||{};const L={};if(this.deletedStates[C]===null)for(const z in this.state[C])L[z]={},this.state[C][z]={};else for(const z in this.deletedStates[C]){if(this.deletedStates[C][z]===null)this.state[C][z]={};else for(const Y of Object.keys(this.deletedStates[C][z]))delete this.state[C][z][Y];L[z]=this.state[C][z]}w[C]=w[C]||{},o.e(w[C],L)}this.stateChanges={},this.deletedStates={},Object.keys(w).length!==0&&u.setFeatureState(w,g)}}const Ir=89.25;function Ar(D,u){const g=o.an(u.lat,-o.ao,o.ao);return new o.P(o.Y(u.lng)*D,o.X(g)*D)}function $r(D,u){return new o.a9(u.x/D,u.y/D).toLngLat()}function hn(D){return D.cameraToCenterDistance*Math.min(.85*Math.tan(o.ap(90-D.pitch)),Math.tan(o.ap(Ir-D.pitch)))}function zr(D,u){const g=D.canonical,w=u/o.aq(g.z),C=g.x+Math.pow(2,g.z)*D.wrap,L=o.ar(new Float64Array(16));return o.O(L,L,[C*w,g.y*w,0]),o.Q(L,L,[w/o.a5,w/o.a5,1]),L}function Mt(D,u,g,w,C){const L=o.a9.fromLngLat(D,u),z=C*o.as(1,D.lat),{x:Y,y:re,z:le}=en(g,w);return new o.a9(L.x+z*-Y,L.y+z*-re,L.z+z*-le)}function en(D,u){const g=o.ap(D),w=o.ap(u),C=Math.cos(-g),L=Math.sin(g);return{x:L*Math.sin(w),y:-L*Math.cos(w),z:C}}function jn(D,u,g){const w=u.intersectsFrustum(D);if(!g||w===0)return w;const C=u.intersectsPlane(g);return C===0?0:w===2&&C===2?2:1}function Qr(D,u,g){let w=0;const C=(g-u)/10;for(let L=0;L<10;L++)w+=C*Math.pow(Math.cos(u+(L+.5)/10*(g-u)),D);return w}function nr(D,u){return function(g,w,C,L,z){const Y=2*((D-1)/o.at(Math.cos(o.ap(Ir-z))/Math.cos(o.ap(Ir)))-1),re=Math.acos(C/L),le=2*Qr(Y-1,0,o.ap(z/2)),fe=Math.min(o.ap(Ir),re+o.ap(z/2)),Ie=Qr(Y-1,Math.min(fe,re-o.ap(z/2)),fe),Te=Math.atan(w/C),Ue=Math.hypot(w,C);let Ze=g;return Ze+=o.at(L/Ue/Math.max(.5,Math.cos(o.ap(z/2)))),Ze+=Y*o.at(Math.cos(Te))/2,Ze-=o.at(Math.max(1,Ie/le/u))/2,Ze}}const oi=nr(9.314,3);function un(D,u){const g=(u.roundZoom?Math.round:Math.floor)(D.zoom+o.at(D.tileSize/u.tileSize));return Math.max(0,g)}function Kn(D,u){const g=D.getCameraFrustum(),w=D.getClippingPlane(),C=D.screenPointToMercatorCoordinate(D.getCameraPoint()),L=o.a9.fromLngLat(D.center,D.elevation);C.z=L.z+Math.cos(D.pitchInRadians)*D.cameraToCenterDistance/D.worldSize;const z=D.getCoveringTilesDetailsProvider(),Y=z.allowVariableZoom(D,u),re=un(D,u),le=u.minzoom||0,fe=u.maxzoom!==void 0?u.maxzoom:D.maxZoom,Ie=Math.min(Math.max(0,re),fe),Te=Math.pow(2,Ie),Ue=[Te*C.x,Te*C.y,0],Ze=[Te*L.x,Te*L.y,0],ft=Math.hypot(L.x-C.x,L.y-C.y),pt=Math.abs(L.z-C.z),dt=Math.hypot(ft,pt),xt=Nt=>({zoom:0,x:0,y:0,wrap:Nt,fullyVisible:!1}),Ot=[],wt=[];if(D.renderWorldCopies&&z.allowWorldCopies())for(let Nt=1;Nt<=3;Nt++)Ot.push(xt(-Nt)),Ot.push(xt(Nt));for(Ot.push(xt(0));Ot.length>0;){const Nt=Ot.pop(),jt=Nt.x,Dt=Nt.y;let Yt=Nt.fullyVisible;const Sr={x:jt,y:Dt,z:Nt.zoom},dr=z.getTileBoundingVolume(Sr,Nt.wrap,D.elevation,u);if(!Yt){const ln=jn(g,dr,w);if(ln===0)continue;Yt=ln===2}const yr=z.distanceToTile2d(C.x,C.y,Sr,dr);let xr=re;Y&&(xr=(u.calculateTileZoom||oi)(D.zoom+o.at(D.tileSize/u.tileSize),yr,pt,dt,D.fov)),xr=(u.roundZoom?Math.round:Math.floor)(xr),xr=Math.max(0,xr);const an=Math.min(xr,fe);if(Nt.wrap=z.getWrap(L,Sr,Nt.wrap),Nt.zoom>=an){if(Nt.zoom<le)continue;const ln=Ie-Nt.zoom,Hr=Ue[0]-.5-(jt<<ln),gn=Ue[1]-.5-(Dt<<ln),Ti=u.reparseOverscaled?Math.max(Nt.zoom,xr):Nt.zoom;wt.push({tileID:new o.a2(Nt.zoom===fe?Ti:Nt.zoom,Nt.wrap,Nt.zoom,jt,Dt),distanceSq:o.au([Ze[0]-.5-jt,Ze[1]-.5-Dt]),tileDistanceToCamera:Math.sqrt(Hr*Hr+gn*gn)})}else for(let ln=0;ln<4;ln++)Ot.push({zoom:Nt.zoom+1,x:(jt<<1)+ln%2,y:(Dt<<1)+(ln>>1),wrap:Nt.wrap,fullyVisible:Yt})}return wt.sort(((Nt,jt)=>Nt.distanceSq-jt.distanceSq)).map((Nt=>Nt.tileID))}const Me=o.aa.fromPoints([new o.P(0,0),new o.P(o.a5,o.a5)]);function He(D){return D==="raster"||D==="image"||D==="video"}function Tt(D,u,g,w,C,L,z){if(!u.hasData())return!1;const{tileID:Y,fadingRole:re,fadingDirection:le,fadingParentID:fe}=u;if(re===mt.Base&&le===ct.Incoming&&fe)return g[fe.key]=fe,!0;const Ie=Math.max(Y.overscaledZ-C,L);for(let Te=Y.overscaledZ-1;Te>=Ie;Te--){const Ue=Y.scaledTo(Te),Ze=D.getLoadedTile(Ue);if(Ze)return u.setCrossFadeLogic({fadingRole:mt.Base,fadingDirection:ct.Incoming,fadingParentID:Ze.tileID,fadeEndTime:w+z}),Ze.setCrossFadeLogic({fadingRole:mt.Parent,fadingDirection:ct.Departing,fadeEndTime:w+z}),g[Ue.key]=Ue,!0}return!1}function Wt(D,u,g,w,C,L){if(!u.hasData())return!1;const z=u.tileID.children(C);let Y=Ut(D,u,z,g,w,C,L);if(Y)return!0;for(const re of z)Ut(D,u,re.children(C),g,w,C,L)&&(Y=!0);return Y}function Ut(D,u,g,w,C,L,z){if(g[0].overscaledZ>=L)return!1;let Y=!1;for(const re of g){const le=D.getLoadedTile(re);if(!le)continue;const{fadingRole:fe,fadingDirection:Ie,fadingParentID:Te}=le;fe===mt.Base&&Ie===ct.Departing&&Te||(le.setCrossFadeLogic({fadingRole:mt.Base,fadingDirection:ct.Departing,fadingParentID:u.tileID,fadeEndTime:C+z}),u.setCrossFadeLogic({fadingRole:mt.Parent,fadingDirection:ct.Incoming,fadeEndTime:C+z})),w[re.key]=re,Y=!0}return Y}function Xr(D,u,g,w){const C=D.tileID;return!!D.selfFading||!D.hasData()&&!!u.has(C)&&(D.setSelfFadeLogic(g+w),!0)}function Nn(D,u){var g;D.needsHillshadePrepare=!0,D.needsTerrainPrepare=!0;let w=u.tileID.canonical.x-D.tileID.canonical.x;const C=u.tileID.canonical.y-D.tileID.canonical.y,L=Math.pow(2,D.tileID.canonical.z),z=u.tileID.key;w===0&&C===0||Math.abs(C)>1||(Math.abs(w)>1&&(Math.abs(w+L)===1?w+=L:Math.abs(w-L)===1&&(w-=L)),u.dem&&D.dem&&(D.dem.backfillBorder(u.dem,w,C),!((g=D.neighboringTiles)===null||g===void 0)&&g[z]&&(D.neighboringTiles[z].backfilled=!0)))}class Bi{constructor(){this._tiles={}}handleWrapJump(u){const g={};for(const w in this._tiles){const C=this._tiles[w];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+u),g[C.tileID.key]=C}this._tiles=g}setFeatureState(u,g){for(const w in this._tiles)this._tiles[w].setFeatureState(u,g)}getAllTiles(){return Object.values(this._tiles)}getAllIds(u=!1){return u?Object.values(this._tiles).map((g=>g.tileID)).sort(o.aw).map((g=>g.key)):Object.keys(this._tiles)}getTileById(u){return this._tiles[u]}setTile(u,g){this._tiles[u]=g}deleteTileById(u){delete this._tiles[u]}getLoadedTile(u){const g=this.getTileById(u.key);return g?.hasData()?g:null}isIdRenderable(u,g=!1){var w;return(w=this.getTileById(u))===null||w===void 0?void 0:w.isRenderable(g)}getRenderableIds(u=0,g){const w=[];for(const C of this.getAllIds())this.isIdRenderable(C,g)&&w.push(this.getTileById(C));return g?w.sort(((C,L)=>{const z=C.tileID,Y=L.tileID,re=new o.P(z.canonical.x,z.canonical.y)._rotate(-u),le=new o.P(Y.canonical.x,Y.canonical.y)._rotate(-u);return z.overscaledZ-Y.overscaledZ||le.y-re.y||le.x-re.x})).map((C=>C.tileID.key)):w.map((C=>C.tileID)).sort(o.aw).map((C=>C.key))}}class Ci extends o.E{constructor(u,g,w){super(),this.id=u,this.dispatcher=w,this.on("data",(C=>this._dataHandler(C))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((C,L,z,Y)=>{const re=new(je(L.type))(C,L,z,Y);if(re.id!==C)throw new Error(`Expected Source id to be ${C} instead of ${re.id}`);return re})(u,g,w,this),this._inViewTiles=new Bi,this._outOfViewCache=new o.ax(0,(C=>this._unloadTile(C))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new qt,this._didEmitContent=!1,this._updated=!1}onAdd(u){this.map=u,this._maxTileCacheSize=u?u._maxTileCacheSize:null,this._maxTileCacheZoomLevels=u?u._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(u)}onRemove(u){for(const g of this._inViewTiles.getAllTiles())g.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(u),this._inViewTiles=new Bi}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const u of this._inViewTiles.getAllTiles())if(u.state!=="loaded"&&u.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const u=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,u&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(u,g,w){return o._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(u),this._tileLoaded(u,g,w)}catch(C){u.state="errored",C.status!==404?this._source.fire(new o.k(C,{tile:u})):this.update(this.transform,this.terrain)}}))}_unloadTile(u){this._source.unloadTile&&this._source.unloadTile(u)}_abortTile(u){this._source.abortTile&&this._source.abortTile(u),this._source.fire(new o.l("dataabort",{tile:u,coord:u.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(u){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const g of this._inViewTiles.getAllTiles())g.upload(u),g.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(u){var g;return this._inViewTiles.getRenderableIds((g=this.transform)===null||g===void 0?void 0:g.bearingInRadians,u)}hasRenderableParent(u){const g=u.overscaledZ-1;if(g>=this._source.minzoom){const w=this.getLoadedTile(u.scaledTo(g));if(w)return this._inViewTiles.isIdRenderable(w.tileID.key)}return!1}reload(u,g=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const w of this._inViewTiles.getAllIds()){const C=this._inViewTiles.getTileById(w);g&&!this._source.shouldReloadTile(C,g)||(u?this._reloadTile(w,"expired"):C.state!=="errored"&&this._reloadTile(w,"reloading"))}}}_reloadTile(u,g){return o._(this,void 0,void 0,(function*(){const w=this._inViewTiles.getTileById(u);w&&(w.state!=="loading"&&(w.state=g),yield this._loadTile(w,u,g))}))}_tileLoaded(u,g,w){u.timeAdded=T(),u.selfFading&&(u.fadeEndTime=u.timeAdded+this._rasterFadeDuration),w==="expired"&&(u.refreshedUponExpiration=!0),this._setTileReloadTimer(g,u),this.getSource().type==="raster-dem"&&u.dem&&(function(C,L){var z,Y;const re=L.getRenderableIds();for(const le of re){if(!C.neighboringTiles||!C.neighboringTiles[le])continue;const fe=L.getTileById(le);C.neighboringTiles[le].backfilled||Nn(C,fe),!((Y=(z=fe.neighboringTiles)===null||z===void 0?void 0:z[C.tileID.key])===null||Y===void 0)&&Y.backfilled||Nn(fe,C)}})(u,this._inViewTiles),this._state.initializeTileState(u,this.map?this.map.painter:null),u.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:u,coord:u.tileID}))}getTile(u){return this.getTileByID(u.key)}getTileByID(u){return this._inViewTiles.getTileById(u)}_retainLoadedChildren(u,g){const w=this._getLoadedDescendents(g),C=new Set;for(const L of g){const z=w[L.key];if(!z?.length){C.add(L);continue}const Y=L.overscaledZ+Ci.maxOverzooming,re=z.filter((Ie=>Ie.tileID.overscaledZ<=Y));if(!re.length){C.add(L);continue}const le=Math.min(...re.map((Ie=>Ie.tileID.overscaledZ))),fe=re.filter((Ie=>Ie.tileID.overscaledZ===le)).map((Ie=>Ie.tileID));for(const Ie of fe)u[Ie.key]=Ie;this._areDescendentsComplete(fe,le,L.overscaledZ)||C.add(L)}return C}_getLoadedDescendents(u){var g;const w={};for(const C of this._inViewTiles.getAllTiles().filter((L=>L.hasData())))for(const L of u)C.tileID.isChildOf(L)&&(w[g=L.key]||(w[g]=[])).push(C);return w}_areDescendentsComplete(u,g,w){return u.length===1&&u[0].isOverscaled()?u[0].overscaledZ===g:Math.pow(4,g-w)===u.length}getLoadedTile(u){return this._inViewTiles.getLoadedTile(u)}updateCacheSize(u){const g=Math.ceil(u.width/this._source.tileSize)+1,w=Math.ceil(u.height/this._source.tileSize)+1,C=Math.floor(g*w*(this._maxTileCacheZoomLevels===null?o.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._outOfViewCache.setMaxSize(L)}handleWrapJump(u){const g=Math.round((u-(this._prevLng===void 0?u:this._prevLng))/360);this._prevLng=u,g&&(this._inViewTiles.handleWrapJump(g),this._resetTileReloadTimers())}update(u,g){if(!this._sourceLoaded||this._paused)return;let w;this.transform=u,this.terrain=g,this.updateCacheSize(u),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?w=u.getVisibleUnwrappedCoordinates(this._source.tileID).map((re=>new o.a2(re.canonical.z,re.wrap,re.canonical.z,re.canonical.x,re.canonical.y))):(w=Kn(u,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?u.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:g,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(w=w.filter((re=>this._source.hasTile(re))))):w=[],this.usedForTerrain&&(w=this._addTerrainIdealTiles(w));const C=w.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const L=un(u,this._source),z=this._updateRetainedTiles(w,L),Y=He(this._source.type);Y&&this._rasterFadeDuration>0&&!g&&(function(re,le,fe,Ie,Te,Ue,Ze){const ft=T(),pt=o.av(le);for(const dt of le){const xt=re.getTileById(dt.key);xt.fadingDirection!==ct.Departing&&xt.fadeOpacity!==0||xt.resetFadeLogic(),Tt(re,xt,fe,ft,Ie,Te,Ze)||Wt(re,xt,fe,ft,Ue,Ze)||Xr(xt,pt,ft,Ze)||xt.resetFadeLogic()}})(this._inViewTiles,w,z,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),Y?this._cleanUpRasterTiles(z):this._cleanUpVectorTiles(z)}_cleanUpRasterTiles(u){for(const g of this._inViewTiles.getAllIds())u[g]||this._removeTile(g)}_cleanUpVectorTiles(u){for(const g of this._inViewTiles.getAllIds()){const w=this._inViewTiles.getTileById(g);u[g]?w.clearSymbolFadeHold():w.hasSymbolBuckets?w.holdingForSymbolFade()?w.symbolFadeFinished()&&this._removeTile(g):w.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(g)}}_addTerrainIdealTiles(u){const g=[];for(const w of u)if(w.canonical.z>this._source.minzoom){const C=w.scaledTo(w.canonical.z-1);g.push(C);const L=w.scaledTo(Math.max(this._source.minzoom,Math.min(w.canonical.z,5)));g.push(L)}return u.concat(g)}releaseSymbolFadeTiles(){for(const u of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(u).holdingForSymbolFade()&&this._removeTile(u)}_updateRetainedTiles(u,g){var w;const C=new Set;for(const le of u)this._addTile(le).hasData()||C.add(le);const L=u.reduce(((le,fe)=>(le[fe.key]=fe,le)),{}),z=this._retainLoadedChildren(L,C),Y={},re=Math.max(g-Ci.maxUnderzooming,this._source.minzoom);for(const le of z){let fe=this._inViewTiles.getTileById(le.key),Ie=fe?.wasRequested();for(let Te=le.overscaledZ-1;Te>=re;--Te){const Ue=le.scaledTo(Te);if(Y[Ue.key])break;if(Y[Ue.key]=!0,fe=this.getTile(Ue),!fe&&Ie&&(fe=this._addTile(Ue)),fe){const Ze=fe.hasData();if((Ze||!(!((w=this.map)===null||w===void 0)&&w.cancelPendingTileRequestsWhileZooming)||Ie)&&(L[Ue.key]=Ue),Ie=fe.wasRequested(),Ze)break}}}return L}_addTile(u){let g=this._inViewTiles.getTileById(u.key);if(g)return g;g=this._outOfViewCache.getAndRemove(u),g&&(g.resetFadeLogic(),this._setTileReloadTimer(u.key,g),g.tileID=u,this._state.initializeTileState(g,this.map?this.map.painter:null));const w=g;return g||(g=new Kt(u,this._source.tileSize*u.overscaleFactor()),this._loadTile(g,u.key,g.state)),g.uses++,this._inViewTiles.setTile(u.key,g),w||this._source.fire(new o.l("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g}_setTileReloadTimer(u,g){this._clearTileReloadTimer(u);const w=g.getExpiryTimeout();w&&(this._timers[u]=setTimeout((()=>{this._reloadTile(u,"expired"),delete this._timers[u]}),w))}_clearTileReloadTimer(u){const g=this._timers[u];g&&(clearTimeout(g),delete this._timers[u])}_resetTileReloadTimers(){for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u of this._inViewTiles.getAllIds()){const g=this._inViewTiles.getTileById(u);this._setTileReloadTimer(u,g)}}refreshTiles(u){for(const g of this._inViewTiles.getAllIds()){const w=this._inViewTiles.getTileById(g);(this._inViewTiles.isIdRenderable(g)||w.state=="errored")&&u.some((C=>C.equals(w.tileID.canonical)))&&this._reloadTile(g,"expired")}}_removeTile(u){const g=this._inViewTiles.getTileById(u);g&&(g.uses--,this._inViewTiles.deleteTileById(u),this._clearTileReloadTimer(u),g.uses>0||(g.hasData()&&g.state!=="reloading"?this._outOfViewCache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))}_dataHandler(u){u.dataType==="source"&&(u.sourceDataType!=="metadata"?u.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(u.sourceDataChanged,u.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const u of this._inViewTiles.getAllIds())this._removeTile(u);this._outOfViewCache.reset()}tilesIn(u,g,w){const C=[],L=this.transform;if(!L)return C;const z=L.getCoveringTilesDetailsProvider().allowWorldCopies(),Y=w?L.getCameraQueryGeometry(u):u,re=Ue=>L.screenPointToMercatorCoordinate(Ue,this.terrain),le=this.transformBbox(u,re,!z),fe=this.transformBbox(Y,re,!z),Ie=this.getIds(),Te=o.aa.fromPoints(fe);for(let Ue=0;Ue<Ie.length;Ue++){const Ze=this._inViewTiles.getTileById(Ie[Ue]);if(Ze.holdingForSymbolFade())continue;const ft=z?[Ze.tileID]:[Ze.tileID.unwrapTo(-1),Ze.tileID.unwrapTo(0)],pt=Math.pow(2,L.zoom-Ze.tileID.overscaledZ),dt=g*Ze.queryPadding*o.a5/Ze.tileSize/pt;for(const xt of ft){const Ot=Te.map((wt=>xt.getTilePoint(new o.a9(wt.x,wt.y))));if(Ot.expandBy(dt),Ot.intersects(Me)){const wt=le.map((jt=>xt.getTilePoint(jt))),Nt=fe.map((jt=>xt.getTilePoint(jt)));C.push({tile:Ze,tileID:z?xt:xt.unwrapTo(0),queryGeometry:wt,cameraQueryGeometry:Nt,scale:pt})}}}return C}transformBbox(u,g,w){let C=u.map(g);if(w){const L=o.aa.fromPoints(u);L.shrinkBy(.001*Math.min(L.width(),L.height()));const z=L.map(g);o.aa.fromPoints(C).covers(z)||(C=C.map((Y=>Y.x>.5?new o.a9(Y.x-1,Y.y,Y.z):Y)))}return C}getVisibleCoordinates(u){const g=this.getRenderableIds(u).map((w=>this._inViewTiles.getTileById(w).tileID));return this.transform&&this.transform.populateCache(g),g}hasTransition(){return!!this._source.hasTransition()||!(!He(this._source.type)||!(function(u,g){if(g<=0)return!1;const w=T();for(const C of u.getAllTiles())if(C.fadeEndTime>=w)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(u){this._rasterFadeDuration=u}setFeatureState(u,g,w){this._state.updateState(u=u||o.ai,g,w)}removeFeatureState(u,g,w){this._state.removeFeatureState(u=u||o.ai,g,w)}getFeatureState(u,g){return this._state.getState(u=u||o.ai,g)}setDependencies(u,g,w){const C=this._inViewTiles.getTileById(u);C&&C.setDependencies(g,w)}reloadTilesForDependencies(u,g){for(const w of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(w).hasDependency(u,g)&&this._reloadTile(w,"reloading");this._outOfViewCache.filter((w=>!w.hasDependency(u,g)))}areTilesLoaded(){for(const u of this._inViewTiles.getAllTiles())if(u.state!=="loaded"&&u.state!=="errored")return!1;return!0}}Ci.maxUnderzooming=10,Ci.maxOverzooming=3;class Fr{constructor(u,g){this.reset(u,g)}reset(u,g){this.points=u||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(g||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(u){if(this.points.length===1)return this.points[0];u=o.an(u,0,1);let g=1,w=this._distances[g];const C=u*this.paddedLength+this.padding;for(;w<C&&g<this._distances.length;)w=this._distances[++g];const L=g-1,z=this._distances[L],Y=w-z,re=Y>0?(C-z)/Y:0;return this.points[L].mult(1-re).add(this.points[g].mult(re))}}function Mn(D,u){let g=!0;return D==="always"||D!=="never"&&u!=="never"||(g=!1),g}class Bn{constructor(u,g,w){const C=this.boxCells=[],L=this.circleCells=[];this.xCellCount=Math.ceil(u/w),this.yCellCount=Math.ceil(g/w);for(let z=0;z<this.xCellCount*this.yCellCount;z++)C.push([]),L.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=g,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/g,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(u,g,w,C,L){this._forEachCell(g,w,C,L,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(g),this.bboxes.push(w),this.bboxes.push(C),this.bboxes.push(L)}insertCircle(u,g,w,C){this._forEachCell(g-C,w-C,g+C,w+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(g),this.circles.push(w),this.circles.push(C)}_insertBoxCell(u,g,w,C,L,z){this.boxCells[L].push(z)}_insertCircleCell(u,g,w,C,L,z){this.circleCells[L].push(z)}_query(u,g,w,C,L,z,Y){if(w<0||u>this.width||C<0||g>this.height)return[];const re=[];if(u<=0&&g<=0&&this.width<=w&&this.height<=C){if(L)return[{key:null,x1:u,y1:g,x2:w,y2:C}];for(let le=0;le<this.boxKeys.length;le++)re.push({key:this.boxKeys[le],x1:this.bboxes[4*le],y1:this.bboxes[4*le+1],x2:this.bboxes[4*le+2],y2:this.bboxes[4*le+3]});for(let le=0;le<this.circleKeys.length;le++){const fe=this.circles[3*le],Ie=this.circles[3*le+1],Te=this.circles[3*le+2];re.push({key:this.circleKeys[le],x1:fe-Te,y1:Ie-Te,x2:fe+Te,y2:Ie+Te})}}else this._forEachCell(u,g,w,C,this._queryCell,re,{hitTest:L,overlapMode:z,seenUids:{box:{},circle:{}}},Y);return re}query(u,g,w,C){return this._query(u,g,w,C,!1,null)}hitTest(u,g,w,C,L,z){return this._query(u,g,w,C,!0,L,z).length>0}hitTestCircle(u,g,w,C,L){const z=u-w,Y=u+w,re=g-w,le=g+w;if(Y<0||z>this.width||le<0||re>this.height)return!1;const fe=[];return this._forEachCell(z,re,Y,le,this._queryCellCircle,fe,{hitTest:!0,overlapMode:C,circle:{x:u,y:g,radius:w},seenUids:{box:{},circle:{}}},L),fe.length>0}_queryCell(u,g,w,C,L,z,Y,re){const{seenUids:le,hitTest:fe,overlapMode:Ie}=Y,Te=this.boxCells[L];if(Te!==null){const Ze=this.bboxes;for(const ft of Te)if(!le.box[ft]){le.box[ft]=!0;const pt=4*ft,dt=this.boxKeys[ft];if(u<=Ze[pt+2]&&g<=Ze[pt+3]&&w>=Ze[pt+0]&&C>=Ze[pt+1]&&(!re||re(dt))&&(!fe||!Mn(Ie,dt.overlapMode))&&(z.push({key:dt,x1:Ze[pt],y1:Ze[pt+1],x2:Ze[pt+2],y2:Ze[pt+3]}),fe))return!0}}const Ue=this.circleCells[L];if(Ue!==null){const Ze=this.circles;for(const ft of Ue)if(!le.circle[ft]){le.circle[ft]=!0;const pt=3*ft,dt=this.circleKeys[ft];if(this._circleAndRectCollide(Ze[pt],Ze[pt+1],Ze[pt+2],u,g,w,C)&&(!re||re(dt))&&(!fe||!Mn(Ie,dt.overlapMode))){const xt=Ze[pt],Ot=Ze[pt+1],wt=Ze[pt+2];if(z.push({key:dt,x1:xt-wt,y1:Ot-wt,x2:xt+wt,y2:Ot+wt}),fe)return!0}}}return!1}_queryCellCircle(u,g,w,C,L,z,Y,re){const{circle:le,seenUids:fe,overlapMode:Ie}=Y,Te=this.boxCells[L];if(Te!==null){const Ze=this.bboxes;for(const ft of Te)if(!fe.box[ft]){fe.box[ft]=!0;const pt=4*ft,dt=this.boxKeys[ft];if(this._circleAndRectCollide(le.x,le.y,le.radius,Ze[pt+0],Ze[pt+1],Ze[pt+2],Ze[pt+3])&&(!re||re(dt))&&!Mn(Ie,dt.overlapMode))return z.push(!0),!0}}const Ue=this.circleCells[L];if(Ue!==null){const Ze=this.circles;for(const ft of Ue)if(!fe.circle[ft]){fe.circle[ft]=!0;const pt=3*ft,dt=this.circleKeys[ft];if(this._circlesCollide(Ze[pt],Ze[pt+1],Ze[pt+2],le.x,le.y,le.radius)&&(!re||re(dt))&&!Mn(Ie,dt.overlapMode))return z.push(!0),!0}}}_forEachCell(u,g,w,C,L,z,Y,re){const le=this._convertToXCellCoord(u),fe=this._convertToYCellCoord(g),Ie=this._convertToXCellCoord(w),Te=this._convertToYCellCoord(C);for(let Ue=le;Ue<=Ie;Ue++)for(let Ze=fe;Ze<=Te;Ze++)if(L.call(this,u,g,w,C,this.xCellCount*Ze+Ue,z,Y,re))return}_convertToXCellCoord(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))}_convertToYCellCoord(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))}_circlesCollide(u,g,w,C,L,z){const Y=C-u,re=L-g,le=w+z;return le*le>Y*Y+re*re}_circleAndRectCollide(u,g,w,C,L,z,Y){const re=(z-C)/2,le=Math.abs(u-(C+re));if(le>re+w)return!1;const fe=(Y-L)/2,Ie=Math.abs(g-(L+fe));if(Ie>fe+w)return!1;if(le<=re||Ie<=fe)return!0;const Te=le-re,Ue=Ie-fe;return Te*Te+Ue*Ue<=w*w}}function ei(D,u,g){const w=o.N();if(!D){const{vecSouth:Ie,vecEast:Te}=fa(u),Ue=h();Ue[0]=Te[0],Ue[1]=Te[1],Ue[2]=Ie[0],Ue[3]=Ie[1],C=Ue,(fe=(z=(L=Ue)[0])*(le=L[3])-(re=L[2])*(Y=L[1]))&&(C[0]=le*(fe=1/fe),C[1]=-Y*fe,C[2]=-re*fe,C[3]=z*fe),w[0]=Ue[0],w[1]=Ue[1],w[4]=Ue[2],w[5]=Ue[3]}var C,L,z,Y,re,le,fe;return o.Q(w,w,[1/g,1/g,1]),w}function ua(D,u,g,w){if(D){const C=o.N();if(!u){const{vecSouth:L,vecEast:z}=fa(g);C[0]=z[0],C[1]=z[1],C[4]=L[0],C[5]=L[1]}return o.Q(C,C,[w,w,1]),C}return g.pixelsToClipSpaceMatrix}function fa(D){const u=Math.cos(D.rollInRadians),g=Math.sin(D.rollInRadians),w=Math.cos(D.pitchInRadians),C=Math.cos(D.bearingInRadians),L=Math.sin(D.bearingInRadians),z=o.aC();z[0]=-C*w*g-L*u,z[1]=-L*w*g+C*u;const Y=o.aD(z);Y<1e-9?o.aE(z):o.aF(z,z,1/Y);const re=o.aC();re[0]=C*w*u-L*g,re[1]=L*w*u+C*g;const le=o.aD(re);return le<1e-9?o.aE(re):o.aF(re,re,1/le),{vecEast:re,vecSouth:z}}function zn(D,u,g,w){let C;w?(C=[D,u,w(D,u),1],o.aH(C,C,g)):(C=[D,u,0,1],Fa(C,C,g));const L=C[3];return{point:new o.P(C[0]/L,C[1]/L),signedDistanceFromCamera:L,isOccluded:!1}}function La(D,u){return .5+D/u*.5}function Gi(D,u){return D.x>=-u[0]&&D.x<=u[0]&&D.y>=-u[1]&&D.y<=u[1]}function fs(D,u,g,w,C,L,z,Y,re,le,fe,Ie,Te){const Ue=g?D.textSizeData:D.iconSizeData,Ze=o.ay(Ue,u.transform.zoom),ft=[256/u.width*2+1,256/u.height*2+1],pt=g?D.text.dynamicLayoutVertexArray:D.icon.dynamicLayoutVertexArray;pt.clear();const dt=D.lineVertexArray,xt=g?D.text.placedSymbolArray:D.icon.placedSymbolArray,Ot=u.transform.width/u.transform.height;let wt=!1;for(let Nt=0;Nt<xt.length;Nt++){const jt=xt.get(Nt);if(jt.hidden||jt.writingMode===o.az.vertical&&!wt){Ul(jt.numGlyphs,pt);continue}wt=!1;const Dt=new o.P(jt.anchorX,jt.anchorY),Yt={getElevation:Te,pitchedLabelPlaneMatrix:w,lineVertexArray:dt,pitchWithMap:L,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:u.transform,tileAnchorPoint:Dt,unwrappedTileID:re,width:le,height:fe,translation:Ie},Sr=ga(jt.anchorX,jt.anchorY,Yt);if(!Gi(Sr.point,ft)){Ul(jt.numGlyphs,pt);continue}const dr=La(u.transform.cameraToCenterDistance,Sr.signedDistanceFromCamera),yr=o.aA(Ue,Ze,jt),xr=L?yr*u.transform.getPitchedTextCorrection(jt.anchorX,jt.anchorY,re)/dr:yr*dr,an=Ya({projectionContext:Yt,pitchedLabelPlaneMatrixInverse:C,symbol:jt,fontSize:xr,flip:!1,keepUpright:z,glyphOffsetArray:D.glyphOffsetArray,dynamicLayoutVertexArray:pt,aspectRatio:Ot,rotateToLine:Y});wt=an.useVertical,(an.notEnoughRoom||wt||an.needsFlipping&&Ya({projectionContext:Yt,pitchedLabelPlaneMatrixInverse:C,symbol:jt,fontSize:xr,flip:!0,keepUpright:z,glyphOffsetArray:D.glyphOffsetArray,dynamicLayoutVertexArray:pt,aspectRatio:Ot,rotateToLine:Y}).notEnoughRoom)&&Ul(jt.numGlyphs,pt)}g?D.text.dynamicLayoutVertexBuffer.updateData(pt):D.icon.dynamicLayoutVertexBuffer.updateData(pt)}function Ca(D,u,g,w,C,L,z,Y){const re=L.glyphStartIndex+L.numGlyphs,le=L.lineStartIndex,fe=L.lineStartIndex+L.lineLength,Ie=u.getoffsetX(L.glyphStartIndex),Te=u.getoffsetX(re-1),Ue=Aa(D*Ie,g,w,C,L.segment,le,fe,Y,z);if(!Ue)return null;const Ze=Aa(D*Te,g,w,C,L.segment,le,fe,Y,z);return Ze?Y.projectionCache.anyProjectionOccluded?null:{first:Ue,last:Ze}:null}function Mo(D,u,g,w){return D===o.az.horizontal&&Math.abs(g.y-u.y)>Math.abs(g.x-u.x)*w?{useVertical:!0}:(D===o.az.vertical?u.y<g.y:u.x>g.x)?{needsFlipping:!0}:null}function Ya(D){const{projectionContext:u,pitchedLabelPlaneMatrixInverse:g,symbol:w,fontSize:C,flip:L,keepUpright:z,glyphOffsetArray:Y,dynamicLayoutVertexArray:re,aspectRatio:le,rotateToLine:fe}=D,Ie=C/24,Te=w.lineOffsetX*Ie,Ue=w.lineOffsetY*Ie;let Ze;if(w.numGlyphs>1){const ft=w.glyphStartIndex+w.numGlyphs,pt=w.lineStartIndex,dt=w.lineStartIndex+w.lineLength,xt=Ca(Ie,Y,Te,Ue,L,w,fe,u);if(!xt)return{notEnoughRoom:!0};const Ot=Iu(xt.first.point.x,xt.first.point.y,u,g),wt=Iu(xt.last.point.x,xt.last.point.y,u,g);if(z&&!L){const Nt=Mo(w.writingMode,Ot,wt,le);if(Nt)return Nt}Ze=[xt.first];for(let Nt=w.glyphStartIndex+1;Nt<ft-1;Nt++){const jt=Aa(Ie*Y.getoffsetX(Nt),Te,Ue,L,w.segment,pt,dt,u,fe);if(!jt)return{notEnoughRoom:!0};Ze.push(jt)}Ze.push(xt.last)}else{if(z&&!L){const pt=zi(u.tileAnchorPoint.x,u.tileAnchorPoint.y,u).point,dt=w.lineStartIndex+w.segment+1,xt=new o.P(u.lineVertexArray.getx(dt),u.lineVertexArray.gety(dt)),Ot=zi(xt.x,xt.y,u),wt=Ot.signedDistanceFromCamera>0?Ot.point:ol(u.tileAnchorPoint,xt,pt,1,u),Nt=Iu(pt.x,pt.y,u,g),jt=Iu(wt.x,wt.y,u,g),Dt=Mo(w.writingMode,Nt,jt,le);if(Dt)return Dt}const ft=Aa(Ie*Y.getoffsetX(w.glyphStartIndex),Te,Ue,L,w.segment,w.lineStartIndex,w.lineStartIndex+w.lineLength,u,fe);if(!ft||u.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Ze=[ft]}for(const ft of Ze)o.aG(re,ft.point,ft.angle);return{}}function ol(D,u,g,w,C){const L=D.add(D.sub(u)._unit()),z=zi(L.x,L.y,C).point,Y=g.sub(z);return g.add(Y._mult(w/Y.mag()))}function xi(D,u,g){const w=u.projectionCache;if(w.projections[D])return w.projections[D];const C=new o.P(u.lineVertexArray.getx(D),u.lineVertexArray.gety(D)),L=zi(C.x,C.y,u);if(L.signedDistanceFromCamera>0)return w.projections[D]=L.point,w.anyProjectionOccluded=w.anyProjectionOccluded||L.isOccluded,L.point;const z=D-g.direction;return ol(g.distanceFromAnchor===0?u.tileAnchorPoint:new o.P(u.lineVertexArray.getx(z),u.lineVertexArray.gety(z)),C,g.previousVertex,g.absOffsetX-g.distanceFromAnchor+1,u)}function zi(D,u,g){const w=D+g.translation[0],C=u+g.translation[1];let L;return g.pitchWithMap?(L=zn(w,C,g.pitchedLabelPlaneMatrix,g.getElevation),L.isOccluded=!1):(L=g.transform.projectTileCoordinates(w,C,g.unwrappedTileID,g.getElevation),L.point.x=(.5*L.point.x+.5)*g.width,L.point.y=(.5*-L.point.y+.5)*g.height),L}function Iu(D,u,g,w){if(g.pitchWithMap){const C=[D,u,0,1];return o.aH(C,C,w),g.transform.projectTileCoordinates(C[0]/C[3],C[1]/C[3],g.unwrappedTileID,g.getElevation).point}return{x:D/g.width*2-1,y:1-u/g.height*2}}function ga(D,u,g){return g.transform.projectTileCoordinates(D,u,g.unwrappedTileID,g.getElevation)}function Za(D,u,g){return D._unit()._perp()._mult(u*g)}function ds(D,u,g,w,C,L,z,Y,re){if(Y.projectionCache.offsets[D])return Y.projectionCache.offsets[D];const le=g.add(u);if(D+re.direction<w||D+re.direction>=C)return Y.projectionCache.offsets[D]=le,le;const fe=xi(D+re.direction,Y,re),Ie=Za(fe.sub(g),z,re.direction),Te=g.add(Ie),Ue=fe.add(Ie);return Y.projectionCache.offsets[D]=o.aI(L,le,Te,Ue)||le,Y.projectionCache.offsets[D]}function Aa(D,u,g,w,C,L,z,Y,re){const le=w?D-u:D+u;let fe=le>0?1:-1,Ie=0;w&&(fe*=-1,Ie=Math.PI),fe<0&&(Ie+=Math.PI);let Te,Ue=fe>0?L+C:L+C+1;Y.projectionCache.cachedAnchorPoint?Te=Y.projectionCache.cachedAnchorPoint:(Te=zi(Y.tileAnchorPoint.x,Y.tileAnchorPoint.y,Y).point,Y.projectionCache.cachedAnchorPoint=Te);let Ze,ft,pt=Te,dt=Te,xt=0,Ot=0;const wt=Math.abs(le),Nt=[];let jt;for(;xt+Ot<=wt;){if(Ue+=fe,Ue<L||Ue>=z)return null;xt+=Ot,dt=pt,ft=Ze;const Sr={absOffsetX:wt,direction:fe,distanceFromAnchor:xt,previousVertex:dt};if(pt=xi(Ue,Y,Sr),g===0)Nt.push(dt),jt=pt.sub(dt);else{let dr;const yr=pt.sub(dt);dr=yr.mag()===0?Za(xi(Ue+fe,Y,Sr).sub(pt),g,fe):Za(yr,g,fe),ft||(ft=dt.add(dr)),Ze=ds(Ue,dr,pt,L,z,ft,g,Y,Sr),Nt.push(ft),jt=Ze.sub(ft)}Ot=jt.mag()}const Dt=jt._mult((wt-xt)/Ot)._add(ft||dt),Yt=Ie+Math.atan2(pt.y-dt.y,pt.x-dt.x);return Nt.push(Dt),{point:Dt,angle:re?Yt:0,path:Nt}}const ps=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ul(D,u){for(let g=0;g<D;g++){const w=u.length;u.resize(w+4),u.float32.set(ps,3*w)}}function Fa(D,u,g){const w=u[0],C=u[1];return D[0]=g[0]*w+g[4]*C+g[12],D[1]=g[1]*w+g[5]*C+g[13],D[3]=g[3]*w+g[7]*C+g[15],D}const _a=100;class xc{constructor(u,g=new Bn(u.width+200,u.height+200,25),w=new Bn(u.width+200,u.height+200,25)){this.transform=u,this.grid=g,this.ignoredGrid=w,this.pitchFactor=Math.cos(u.pitch*Math.PI/180)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+_a,this.screenBottomBoundary=u.height+_a,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(u,g,w,C,L,z,Y,re,le,fe,Ie,Te){const Ue=this.projectAndGetPerspectiveRatio(u.anchorPointX+re[0],u.anchorPointY+re[1],L,fe,Te),Ze=w*Ue.perspectiveRatio;let ft;if(z||Y)ft=this._projectCollisionBox(u,Ze,C,L,z,Y,re,Ue,fe,Ie,Te);else{const jt=Ue.x+(Ie?Ie.x*Ze:0),Dt=Ue.y+(Ie?Ie.y*Ze:0);ft={allPointsOccluded:!1,box:[jt+u.x1*Ze,Dt+u.y1*Ze,jt+u.x2*Ze,Dt+u.y2*Ze]}}const[pt,dt,xt,Ot]=ft.box,wt=z?ft.allPointsOccluded:Ue.isOccluded;let Nt=wt;return Nt||(Nt=Ue.perspectiveRatio<this.perspectiveRatioCutoff),Nt||(Nt=!this.isInsideGrid(pt,dt,xt,Ot)),Nt||g!=="always"&&this.grid.hitTest(pt,dt,xt,Ot,g,le)?{box:[pt,dt,xt,Ot],placeable:!1,offscreen:!1,occluded:wt}:{box:[pt,dt,xt,Ot],placeable:!0,offscreen:this.isOffscreen(pt,dt,xt,Ot),occluded:wt}}placeCollisionCircles(u,g,w,C,L,z,Y,re,le,fe,Ie,Te,Ue,Ze){const ft=[],pt=new o.P(g.anchorX,g.anchorY),dt=this.getPerspectiveRatio(pt.x,pt.y,z,Ze),xt=(le?L*this.transform.getPitchedTextCorrection(g.anchorX,g.anchorY,z)/dt:L*dt)/o.aM,Ot={getElevation:Ze,pitchedLabelPlaneMatrix:Y,lineVertexArray:w,pitchWithMap:le,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:pt,unwrappedTileID:z,width:this.transform.width,height:this.transform.height,translation:Ue},wt=Ca(xt,C,g.lineOffsetX*xt,g.lineOffsetY*xt,!1,g,!1,Ot);let Nt=!1,jt=!1,Dt=!0;if(wt){const Yt=.5*Ie*dt+Te,Sr=new o.P(-100,-100),dr=new o.P(this.screenRightBoundary,this.screenBottomBoundary),yr=new Fr,xr=wt.first,an=wt.last;let ln=[];for(let Ti=xr.path.length-1;Ti>=1;Ti--)ln.push(xr.path[Ti]);for(let Ti=1;Ti<an.path.length;Ti++)ln.push(an.path[Ti]);const Hr=2.5*Yt;if(le){const Ti=this.projectPathToScreenSpace(ln,Ot);ln=Ti.some((Ra=>Ra.signedDistanceFromCamera<=0))?[]:Ti.map((Ra=>Ra.point))}let gn=[];if(ln.length>0){const Ti=ln[0].clone(),Ra=ln[0].clone();for(let yo=1;yo<ln.length;yo++)Ti.x=Math.min(Ti.x,ln[yo].x),Ti.y=Math.min(Ti.y,ln[yo].y),Ra.x=Math.max(Ra.x,ln[yo].x),Ra.y=Math.max(Ra.y,ln[yo].y);gn=Ti.x>=Sr.x&&Ra.x<=dr.x&&Ti.y>=Sr.y&&Ra.y<=dr.y?[ln]:Ra.x<Sr.x||Ti.x>dr.x||Ra.y<Sr.y||Ti.y>dr.y?[]:o.aJ([ln],Sr.x,Sr.y,dr.x,dr.y)}for(const Ti of gn){yr.reset(Ti,.25*Yt);let Ra=0;Ra=yr.length<=.5*Yt?1:Math.ceil(yr.paddedLength/Hr)+1;for(let yo=0;yo<Ra;yo++){const to=yo/Math.max(Ra-1,1),Ao=yr.lerp(to),ro=Ao.x+_a,Xo=Ao.y+_a;ft.push(ro,Xo,Yt,0);const Io=ro-Yt,pl=Xo-Yt,vs=ro+Yt,as=Xo+Yt;if(Dt=Dt&&this.isOffscreen(Io,pl,vs,as),jt=jt||this.isInsideGrid(Io,pl,vs,as),u!=="always"&&this.grid.hitTestCircle(ro,Xo,Yt,u,fe)&&(Nt=!0,!re))return{circles:[],offscreen:!1,collisionDetected:Nt}}}}return{circles:!re&&Nt||!jt||dt<this.perspectiveRatioCutoff?[]:ft,offscreen:Dt,collisionDetected:Nt}}projectPathToScreenSpace(u,g){const w=(function(C,L){const z=o.N();return o.aB(z,L.pitchedLabelPlaneMatrix),C.map((Y=>{const re=zn(Y.x,Y.y,z,L.getElevation),le=L.transform.projectTileCoordinates(re.point.x,re.point.y,L.unwrappedTileID,L.getElevation);return le.point.x=(.5*le.point.x+.5)*L.width,le.point.y=(.5*-le.point.y+.5)*L.height,le}))})(u,g);return(function(C){let L=0,z=0,Y=0,re=0;for(let le=0;le<C.length;le++)C[le].isOccluded?(Y=le+1,re=0):(re++,re>z&&(z=re,L=Y));return C.slice(L,L+z)})(w)}queryRenderedSymbols(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const g=[],w=new o.aa;for(const Ie of u){const Te=new o.P(Ie.x+_a,Ie.y+_a);w.extend(Te),g.push(Te)}const{minX:C,minY:L,maxX:z,maxY:Y}=w,re=this.grid.query(C,L,z,Y).concat(this.ignoredGrid.query(C,L,z,Y)),le={},fe={};for(const Ie of re){const Te=Ie.key;if(le[Te.bucketInstanceId]===void 0&&(le[Te.bucketInstanceId]={}),le[Te.bucketInstanceId][Te.featureIndex])continue;const Ue=[new o.P(Ie.x1,Ie.y1),new o.P(Ie.x2,Ie.y1),new o.P(Ie.x2,Ie.y2),new o.P(Ie.x1,Ie.y2)];o.aK(g,Ue)&&(le[Te.bucketInstanceId][Te.featureIndex]=!0,fe[Te.bucketInstanceId]===void 0&&(fe[Te.bucketInstanceId]=[]),fe[Te.bucketInstanceId].push(Te.featureIndex))}return fe}insertCollisionBox(u,g,w,C,L,z){(w?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:L,collisionGroupID:z,overlapMode:g},u[0],u[1],u[2],u[3])}insertCollisionCircles(u,g,w,C,L,z){const Y=w?this.ignoredGrid:this.grid,re={bucketInstanceId:C,featureIndex:L,collisionGroupID:z,overlapMode:g};for(let le=0;le<u.length;le+=4)Y.insertCircle(re,u[le],u[le+1],u[le+2])}projectAndGetPerspectiveRatio(u,g,w,C,L){if(L){let z;C?(z=[u,g,C(u,g),1],o.aH(z,z,L)):(z=[u,g,0,1],Fa(z,z,L));const Y=z[3];return{x:(z[0]/Y+1)/2*this.transform.width+_a,y:(-z[1]/Y+1)/2*this.transform.height+_a,perspectiveRatio:.5+this.transform.cameraToCenterDistance/Y*.5,isOccluded:!1,signedDistanceFromCamera:Y}}{const z=this.transform.projectTileCoordinates(u,g,w,C);return{x:(z.point.x+1)/2*this.transform.width+_a,y:(1-z.point.y)/2*this.transform.height+_a,perspectiveRatio:.5+this.transform.cameraToCenterDistance/z.signedDistanceFromCamera*.5,isOccluded:z.isOccluded,signedDistanceFromCamera:z.signedDistanceFromCamera}}}getPerspectiveRatio(u,g,w,C){const L=this.transform.projectTileCoordinates(u,g,w,C);return .5+this.transform.cameraToCenterDistance/L.signedDistanceFromCamera*.5}isOffscreen(u,g,w,C){return w<_a||u>=this.screenRightBoundary||C<_a||g>this.screenBottomBoundary}isInsideGrid(u,g,w,C){return w>=0&&u<this.gridRightBoundary&&C>=0&&g<this.gridBottomBoundary}getViewportMatrix(){const u=o.ar([]);return o.O(u,u,[-100,-100,0]),u}_projectCollisionBox(u,g,w,C,L,z,Y,re,le,fe,Ie){let Te=1,Ue=0,Ze=0,ft=1;const pt=u.anchorPointX+Y[0],dt=u.anchorPointY+Y[1];if(z&&!L){const ln=this.projectAndGetPerspectiveRatio(pt+1,dt,C,le,Ie),Hr=ln.x-re.x,gn=Math.atan((ln.y-re.y)/Hr)+(Hr<0?Math.PI:0),Ti=Math.sin(gn),Ra=Math.cos(gn);Te=Ra,Ue=Ti,Ze=-Ti,ft=Ra}else if(!z&&L){const ln=fa(this.transform);Te=ln.vecEast[0],Ue=ln.vecEast[1],Ze=ln.vecSouth[0],ft=ln.vecSouth[1]}let xt=re.x,Ot=re.y,wt=g;L&&(xt=pt,Ot=dt,wt=Math.pow(2,-(this.transform.zoom-w.overscaledZ)),wt*=this.transform.getPitchedTextCorrection(pt,dt,C),fe||(wt*=o.an(.5+re.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),fe&&(xt+=Te*fe.x*wt+Ze*fe.y*wt,Ot+=Ue*fe.x*wt+ft*fe.y*wt);const Nt=u.x1*wt,jt=u.x2*wt,Dt=(Nt+jt)/2,Yt=u.y1*wt,Sr=u.y2*wt,dr=(Yt+Sr)/2,yr=[{offsetX:Nt,offsetY:Yt},{offsetX:Dt,offsetY:Yt},{offsetX:jt,offsetY:Yt},{offsetX:jt,offsetY:dr},{offsetX:jt,offsetY:Sr},{offsetX:Dt,offsetY:Sr},{offsetX:Nt,offsetY:Sr},{offsetX:Nt,offsetY:dr}];let xr=[];for(const{offsetX:ln,offsetY:Hr}of yr)xr.push(new o.P(xt+Te*ln+Ze*Hr,Ot+Ue*ln+ft*Hr));let an=!1;if(L){const ln=xr.map((Hr=>this.projectAndGetPerspectiveRatio(Hr.x,Hr.y,C,le,Ie)));an=ln.some((Hr=>!Hr.isOccluded)),xr=ln.map((Hr=>new o.P(Hr.x,Hr.y)))}else an=!0;return{box:o.aL(xr),allPointsOccluded:!an}}}class sl{constructor(u,g,w,C){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?g:-g))):C&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class ts{constructor(u,g,w,C,L){this.text=new sl(u?u.text:null,g,w,L),this.icon=new sl(u?u.icon:null,g,C,L)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class oo{constructor(u,g,w){this.text=u,this.icon=g,this.skipFade=w}}class rs{constructor(u,g,w,C,L){this.bucketInstanceId=u,this.featureIndex=g,this.sourceLayerIndex=w,this.bucketIndex=C,this.tileID=L}}class Ba{constructor(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}}get(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){const g=++this.maxGroupID;this.collisionGroups[u]={ID:g,predicate:w=>w.collisionGroupID===g}}return this.collisionGroups[u]}}function Us(D,u,g,w,C){const{horizontalAlign:L,verticalAlign:z}=o.aS(D);return new o.P(-(L-.5)*u+w[0]*C,-(z-.5)*g+w[1]*C)}class Uc{constructor(u,g,w,C,L){this.transform=u.clone(),this.terrain=g,this.collisionIndex=new xc(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=w,this.retainedQueryData={},this.collisionGroups=new Ba(C),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=L,L&&(L.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(u){const g=this.terrain;return g?(w,C)=>g.getElevation(u,w,C):null}getBucketParts(u,g,w,C){const L=w.getBucket(g),z=w.latestFeatureIndex;if(!L||!z||g.id!==L.layerIds[0])return;const Y=w.collisionBoxArray,re=L.layers[0].layout,le=L.layers[0].paint,fe=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),Ie=w.tileSize/o.a5,Te=w.tileID.toUnwrapped(),Ue=re.get("text-rotation-alignment")==="map",Ze=o.aN(w,1,this.transform.zoom),ft=o.aO(this.collisionIndex.transform,w,le.get("text-translate"),le.get("text-translate-anchor")),pt=o.aO(this.collisionIndex.transform,w,le.get("icon-translate"),le.get("icon-translate-anchor")),dt=ei(Ue,this.transform,Ze);this.retainedQueryData[L.bucketInstanceId]=new rs(L.bucketInstanceId,z,L.sourceLayerIndex,L.index,w.tileID);const xt={bucket:L,layout:re,translationText:ft,translationIcon:pt,unwrappedTileID:Te,pitchedLabelPlaneMatrix:dt,scale:fe,textPixelRatio:Ie,holdingForFade:w.holdingForSymbolFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:o.ay(L.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(L.sourceID)};if(C)for(const Ot of L.sortKeyRanges){const{sortKey:wt,symbolInstanceStart:Nt,symbolInstanceEnd:jt}=Ot;u.push({sortKey:wt,symbolInstanceStart:Nt,symbolInstanceEnd:jt,parameters:xt})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:L.symbolInstances.length,parameters:xt})}attemptAnchorPlacement(u,g,w,C,L,z,Y,re,le,fe,Ie,Te,Ue,Ze,ft,pt,dt,xt,Ot,wt){const Nt=o.aP[u.textAnchor],jt=[u.textOffset0,u.textOffset1],Dt=Us(Nt,w,C,jt,L),Yt=this.collisionIndex.placeCollisionBox(g,Te,re,le,fe,Y,z,pt,Ie.predicate,Ot,Dt,wt);if((!xt||this.collisionIndex.placeCollisionBox(xt,Te,re,le,fe,Y,z,dt,Ie.predicate,Ot,Dt,wt).placeable)&&Yt.placeable){let Sr;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ue.crossTileID]&&this.prevPlacement.placements[Ue.crossTileID]&&this.prevPlacement.placements[Ue.crossTileID].text&&(Sr=this.prevPlacement.variableOffsets[Ue.crossTileID].anchor),Ue.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Ue.crossTileID]={textOffset:jt,width:w,height:C,anchor:Nt,textBoxScale:L,prevAnchor:Sr},this.markUsedJustification(Ze,Nt,Ue,ft),Ze.allowVerticalPlacement&&(this.markUsedOrientation(Ze,ft,Ue),this.placedOrientations[Ue.crossTileID]=ft),{shift:Dt,placedGlyphBoxes:Yt}}}placeLayerBucketPart(u,g,w){const{bucket:C,layout:L,translationText:z,translationIcon:Y,unwrappedTileID:re,pitchedLabelPlaneMatrix:le,textPixelRatio:fe,holdingForFade:Ie,collisionBoxArray:Te,partiallyEvaluatedTextSize:Ue,collisionGroup:Ze}=u.parameters,ft=L.get("text-optional"),pt=L.get("icon-optional"),dt=o.aQ(L,"text-overlap","text-allow-overlap"),xt=dt==="always",Ot=o.aQ(L,"icon-overlap","icon-allow-overlap"),wt=Ot==="always",Nt=L.get("text-rotation-alignment")==="map",jt=L.get("text-pitch-alignment")==="map",Dt=L.get("icon-text-fit")!=="none",Yt=L.get("symbol-z-order")==="viewport-y",Sr=xt&&(wt||!C.hasIconData()||pt),dr=wt&&(xt||!C.hasTextData()||ft);!C.collisionArrays&&Te&&C.deserializeCollisionBoxes(Te);const yr=this.retainedQueryData[C.bucketInstanceId].tileID,xr=this._getTerrainElevationFunc(yr),an=this.transform.getFastPathSimpleProjectionMatrix(yr),ln=(Hr,gn,Ti)=>{var Ra,yo;if(g[Hr.crossTileID])return;if(Ie)return void(this.placements[Hr.crossTileID]=new oo(!1,!1,!1));let to=!1,Ao=!1,ro=!0,Xo=null,Io={box:null,placeable:!1,offscreen:null,occluded:!1},pl={placeable:!1},vs=null,as=null,Ml=null,Xf=0,sf=0,Eh=0;gn.textFeatureIndex?Xf=gn.textFeatureIndex:Hr.useRuntimeCollisionCircles&&(Xf=Hr.featureIndex),gn.verticalTextFeatureIndex&&(sf=gn.verticalTextFeatureIndex);const zu=gn.textBox;if(zu){const Sc=lo=>{let no=o.az.horizontal;if(C.allowVerticalPlacement&&!lo&&this.prevPlacement){const Js=this.prevPlacement.placedOrientations[Hr.crossTileID];Js&&(this.placedOrientations[Hr.crossTileID]=Js,no=Js,this.markUsedOrientation(C,no,Hr))}return no},Th=(lo,no)=>{if(C.allowVerticalPlacement&&Hr.numVerticalGlyphVertices>0&&gn.verticalTextBox){for(const Js of C.writingModes)if(Js===o.az.vertical?(Io=no(),pl=Io):Io=lo(),Io&&Io.placeable)break}else Io=lo()},Wc=Hr.textAnchorOffsetStartIndex,Gc=Hr.textAnchorOffsetEndIndex;if(Gc===Wc){const lo=(no,Js)=>{const Qs=this.collisionIndex.placeCollisionBox(no,dt,fe,yr,re,jt,Nt,z,Ze.predicate,xr,void 0,an);return Qs&&Qs.placeable&&(this.markUsedOrientation(C,Js,Hr),this.placedOrientations[Hr.crossTileID]=Js),Qs};Th((()=>lo(zu,o.az.horizontal)),(()=>{const no=gn.verticalTextBox;return C.allowVerticalPlacement&&Hr.numVerticalGlyphVertices>0&&no?lo(no,o.az.vertical):{box:null,offscreen:null}})),Sc(Io&&Io.placeable)}else{let lo=o.aP[(yo=(Ra=this.prevPlacement)===null||Ra===void 0?void 0:Ra.variableOffsets[Hr.crossTileID])===null||yo===void 0?void 0:yo.anchor];const no=(Qs,l2,u2)=>{const Hd=Qs.x2-Qs.x1,tC=Qs.y2-Qs.y1,c2=Hr.textBoxScale,k_=Dt&&Ot==="never"?l2:null;let Yf=null,Zf=dt==="never"?1:2,Kf="never";lo&&Zf++;for(let R_=0;R_<Zf;R_++){for(let M_=Wc;M_<Gc;M_++){const Vy=C.textAnchorOffsets.get(M_);if(lo&&Vy.textAnchor!==lo)continue;const $y=this.attemptAnchorPlacement(Vy,Qs,Hd,tC,c2,Nt,jt,fe,yr,re,Ze,Kf,Hr,C,u2,z,Y,k_,xr);if($y&&(Yf=$y.placedGlyphBoxes,Yf&&Yf.placeable))return to=!0,Xo=$y.shift,Yf}lo?lo=null:Kf=dt}return w&&!Yf&&(Yf={box:this.collisionIndex.placeCollisionBox(zu,"always",fe,yr,re,jt,Nt,z,Ze.predicate,xr,void 0,an).box,offscreen:!1,placeable:!1,occluded:!1}),Yf};Th((()=>no(zu,gn.iconBox,o.az.horizontal)),(()=>{const Qs=gn.verticalTextBox;return C.allowVerticalPlacement&&(!Io||!Io.placeable)&&Hr.numVerticalGlyphVertices>0&&Qs?no(Qs,gn.verticalIconBox,o.az.vertical):{box:null,occluded:!0,offscreen:null}})),Io&&(to=Io.placeable,ro=Io.offscreen);const Js=Sc(Io&&Io.placeable);if(!to&&this.prevPlacement){const Qs=this.prevPlacement.variableOffsets[Hr.crossTileID];Qs&&(this.variableOffsets[Hr.crossTileID]=Qs,this.markUsedJustification(C,Qs.anchor,Hr,Js))}}}if(vs=Io,to=vs&&vs.placeable,ro=vs&&vs.offscreen,Hr.useRuntimeCollisionCircles&&Hr.centerJustifiedTextSymbolIndex>=0){const Sc=C.text.placedSymbolArray.get(Hr.centerJustifiedTextSymbolIndex),Th=o.aA(C.textSizeData,Ue,Sc),Wc=L.get("text-padding");as=this.collisionIndex.placeCollisionCircles(dt,Sc,C.lineVertexArray,C.glyphOffsetArray,Th,re,le,w,jt,Ze.predicate,Hr.collisionCircleDiameter,Wc,z,xr),as.circles.length&&as.collisionDetected&&!w&&o.w("Collisions detected, but collision boxes are not shown"),to=xt||as.circles.length>0&&!as.collisionDetected,ro=ro&&as.offscreen}if(gn.iconFeatureIndex&&(Eh=gn.iconFeatureIndex),gn.iconBox){const Sc=Th=>this.collisionIndex.placeCollisionBox(Th,Ot,fe,yr,re,jt,Nt,Y,Ze.predicate,xr,Dt&&Xo?Xo:void 0,an);pl&&pl.placeable&&gn.verticalIconBox?(Ml=Sc(gn.verticalIconBox),Ao=Ml.placeable):(Ml=Sc(gn.iconBox),Ao=Ml.placeable),ro=ro&&Ml.offscreen}const $d=ft||Hr.numHorizontalGlyphVertices===0&&Hr.numVerticalGlyphVertices===0,em=pt||Hr.numIconVertices===0;$d||em?em?$d||(Ao=Ao&&to):to=Ao&&to:Ao=to=Ao&&to;const qd=Ao&&Ml.placeable;if(to&&vs.placeable&&this.collisionIndex.insertCollisionBox(vs.box,dt,L.get("text-ignore-placement"),C.bucketInstanceId,pl&&pl.placeable&&sf?sf:Xf,Ze.ID),qd&&this.collisionIndex.insertCollisionBox(Ml.box,Ot,L.get("icon-ignore-placement"),C.bucketInstanceId,Eh,Ze.ID),as&&to&&this.collisionIndex.insertCollisionCircles(as.circles,dt,L.get("text-ignore-placement"),C.bucketInstanceId,Xf,Ze.ID),w&&this.storeCollisionData(C.bucketInstanceId,Ti,gn,vs,Ml,as),Hr.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(C.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Hr.crossTileID]=new oo((to||Sr)&&!vs?.occluded,(Ao||dr)&&!Ml?.occluded,ro||C.justReloaded),g[Hr.crossTileID]=!0};if(Yt){if(u.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Hr=C.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let gn=Hr.length-1;gn>=0;--gn){const Ti=Hr[gn];ln(C.symbolInstances.get(Ti),C.collisionArrays[Ti],Ti)}}else for(let Hr=u.symbolInstanceStart;Hr<u.symbolInstanceEnd;Hr++)ln(C.symbolInstances.get(Hr),C.collisionArrays[Hr],Hr);C.justReloaded=!1}storeCollisionData(u,g,w,C,L,z){if(w.textBox||w.iconBox){let Y,re;this.collisionBoxArrays.has(u)?Y=this.collisionBoxArrays.get(u):(Y=new Map,this.collisionBoxArrays.set(u,Y)),Y.has(g)?re=Y.get(g):(re={text:null,icon:null},Y.set(g,re)),w.textBox&&(re.text=C.box),w.iconBox&&(re.icon=L.box)}if(z){let Y=this.collisionCircleArrays[u];Y===void 0&&(Y=this.collisionCircleArrays[u]=[]);for(let re=0;re<z.circles.length;re+=4)Y.push(z.circles[re+0]-_a),Y.push(z.circles[re+1]-_a),Y.push(z.circles[re+2]),Y.push(z.collisionDetected?1:0)}}markUsedJustification(u,g,w,C){let L;L=C===o.az.vertical?w.verticalPlacedTextSymbolIndex:{left:w.leftJustifiedTextSymbolIndex,center:w.centerJustifiedTextSymbolIndex,right:w.rightJustifiedTextSymbolIndex}[o.aR(g)];const z=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex,w.verticalPlacedTextSymbolIndex];for(const Y of z)Y>=0&&(u.text.placedSymbolArray.get(Y).crossTileID=L>=0&&Y!==L?0:w.crossTileID)}markUsedOrientation(u,g,w){const C=g===o.az.horizontal||g===o.az.horizontalOnly?g:0,L=g===o.az.vertical?g:0,z=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex];for(const Y of z)u.text.placedSymbolArray.get(Y).placedOrientation=C;w.verticalPlacedTextSymbolIndex&&(u.text.placedSymbolArray.get(w.verticalPlacedTextSymbolIndex).placedOrientation=L)}commit(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;const g=this.prevPlacement;let w=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):0;const C=g?g.symbolFadeChange(u):1,L=g?g.opacities:{},z=g?g.variableOffsets:{},Y=g?g.placedOrientations:{};for(const re in this.placements){const le=this.placements[re],fe=L[re];fe?(this.opacities[re]=new ts(fe,C,le.text,le.icon),w=w||le.text!==fe.text.placed||le.icon!==fe.icon.placed):(this.opacities[re]=new ts(null,C,le.text,le.icon,le.skipFade),w=w||le.text||le.icon)}for(const re in L){const le=L[re];if(!this.opacities[re]){const fe=new ts(le,C,!1,!1);fe.isHidden()||(this.opacities[re]=fe,w=w||le.text.placed||le.icon.placed)}}for(const re in z)this.variableOffsets[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.variableOffsets[re]=z[re]);for(const re in Y)this.placedOrientations[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.placedOrientations[re]=Y[re]);if(g&&g.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");w?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:u)}updateLayerOpacities(u,g){const w={};for(const C of g){const L=C.getBucket(u);L&&C.latestFeatureIndex&&u.id===L.layerIds[0]&&this.updateBucketOpacities(L,C.tileID,w,C.collisionBoxArray)}}updateBucketOpacities(u,g,w,C){u.hasTextData()&&(u.text.opacityVertexArray.clear(),u.text.hasVisibleVertices=!1),u.hasIconData()&&(u.icon.opacityVertexArray.clear(),u.icon.hasVisibleVertices=!1),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();const L=u.layers[0],z=L.layout,Y=new ts(null,0,!1,!1,!0),re=z.get("text-allow-overlap"),le=z.get("icon-allow-overlap"),fe=L._unevaluatedLayout.hasValue("text-variable-anchor")||L._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ie=z.get("text-rotation-alignment")==="map",Te=z.get("text-pitch-alignment")==="map",Ue=z.get("icon-text-fit")!=="none",Ze=new ts(null,0,re&&(le||!u.hasIconData()||z.get("icon-optional")),le&&(re||!u.hasTextData()||z.get("text-optional")),!0);!u.collisionArrays&&C&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(C);const ft=(dt,xt,Ot)=>{for(let wt=0;wt<xt/4;wt++)dt.opacityVertexArray.emplaceBack(Ot);dt.hasVisibleVertices=dt.hasVisibleVertices||Ot!==tn},pt=this.collisionBoxArrays.get(u.bucketInstanceId);for(let dt=0;dt<u.symbolInstances.length;dt++){const xt=u.symbolInstances.get(dt),{numHorizontalGlyphVertices:Ot,numVerticalGlyphVertices:wt,crossTileID:Nt}=xt;let jt=this.opacities[Nt];w[Nt]?jt=Y:jt||(jt=Ze,this.opacities[Nt]=jt),w[Nt]=!0;const Dt=xt.numIconVertices>0,Yt=this.placedOrientations[xt.crossTileID],Sr=Yt===o.az.vertical,dr=Yt===o.az.horizontal||Yt===o.az.horizontalOnly;if(Ot>0||wt>0){const xr=Yr(jt.text);ft(u.text,Ot,Sr?tn:xr),ft(u.text,wt,dr?tn:xr);const an=jt.text.isHidden();[xt.rightJustifiedTextSymbolIndex,xt.centerJustifiedTextSymbolIndex,xt.leftJustifiedTextSymbolIndex].forEach((gn=>{gn>=0&&(u.text.placedSymbolArray.get(gn).hidden=an||Sr?1:0)})),xt.verticalPlacedTextSymbolIndex>=0&&(u.text.placedSymbolArray.get(xt.verticalPlacedTextSymbolIndex).hidden=an||dr?1:0);const ln=this.variableOffsets[xt.crossTileID];ln&&this.markUsedJustification(u,ln.anchor,xt,Yt);const Hr=this.placedOrientations[xt.crossTileID];Hr&&(this.markUsedJustification(u,"left",xt,Hr),this.markUsedOrientation(u,Hr,xt))}if(Dt){const xr=Yr(jt.icon),an=!(Ue&&xt.verticalPlacedIconSymbolIndex&&Sr);xt.placedIconSymbolIndex>=0&&(ft(u.icon,xt.numIconVertices,an?xr:tn),u.icon.placedSymbolArray.get(xt.placedIconSymbolIndex).hidden=jt.icon.isHidden()),xt.verticalPlacedIconSymbolIndex>=0&&(ft(u.icon,xt.numVerticalIconVertices,an?tn:xr),u.icon.placedSymbolArray.get(xt.verticalPlacedIconSymbolIndex).hidden=jt.icon.isHidden())}const yr=pt&&pt.has(dt)?pt.get(dt):{text:null,icon:null};if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){const xr=u.collisionArrays[dt];if(xr){let an=new o.P(0,0);if(xr.textBox||xr.verticalTextBox){let ln=!0;if(fe){const Hr=this.variableOffsets[Nt];Hr?(an=Us(Hr.anchor,Hr.width,Hr.height,Hr.textOffset,Hr.textBoxScale),Ie&&an._rotate(Te?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ln=!1}if(xr.textBox||xr.verticalTextBox){let Hr;xr.textBox&&(Hr=Sr),xr.verticalTextBox&&(Hr=dr),Pu(u.textCollisionBox.collisionVertexArray,jt.text.placed,!ln||Hr,yr.text,an.x,an.y)}}if(xr.iconBox||xr.verticalIconBox){const ln=!!(!dr&&xr.verticalIconBox);let Hr;xr.iconBox&&(Hr=ln),xr.verticalIconBox&&(Hr=!ln),Pu(u.iconCollisionBox.collisionVertexArray,jt.icon.placed,Hr,yr.icon,Ue?an.x:0,Ue?an.y:0)}}}}if(u.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.text.opacityVertexArray.length!==u.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${u.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${u.text.layoutVertexArray.length}) / 4`);if(u.icon.opacityVertexArray.length!==u.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${u.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${u.icon.layoutVertexArray.length}) / 4`);u.bucketInstanceId in this.collisionCircleArrays&&(u.collisionCircleArray=this.collisionCircleArrays[u.bucketInstanceId],delete this.collisionCircleArrays[u.bucketInstanceId])}symbolFadeChange(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(u){return Math.max(0,(this.transform.zoom-u)/1.5)}hasTransitions(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(u,g){const w=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*w>u}setStale(){this.stale=!0}}function Pu(D,u,g,w,C,L){w&&w.length!==0||(w=[0,0,0,0]);const z=w[0]-_a,Y=w[1]-_a,re=w[2]-_a,le=w[3]-_a;D.emplaceBack(u?1:0,g?1:0,C||0,L||0,z,Y),D.emplaceBack(u?1:0,g?1:0,C||0,L||0,re,Y),D.emplaceBack(u?1:0,g?1:0,C||0,L||0,re,le),D.emplaceBack(u?1:0,g?1:0,C||0,L||0,z,le)}const ee=Math.pow(2,25),pe=Math.pow(2,24),Ke=Math.pow(2,17),It=Math.pow(2,16),Vt=Math.pow(2,9),$t=Math.pow(2,8),er=Math.pow(2,1);function Yr(D){if(D.opacity===0&&!D.placed)return 0;if(D.opacity===1&&D.placed)return 4294967295;const u=D.placed?1:0,g=Math.floor(127*D.opacity);return g*ee+u*pe+g*Ke+u*It+g*Vt+u*$t+g*er+u}const tn=0;class Wr{constructor(u){this._sortAcrossTiles=u.layout.get("symbol-z-order")!=="viewport-y"&&!u.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(u,g,w,C,L){const z=this._bucketParts;for(;this._currentTileIndex<u.length;)if(g.getBucketParts(z,C,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,L())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort(((Y,re)=>Y.sortKey-re.sortKey)));this._currentPartIndex<z.length;)if(g.placeLayerBucketPart(z[this._currentPartIndex],this._seenCrossTileIDs,w),this._currentPartIndex++,L())return!0;return!1}}class on{constructor(u,g,w,C,L,z,Y,re){this.placement=new Uc(u,g,z,Y,re),this._currentPlacementIndex=w.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=L,this._done=!1}isDone(){return this._done}continuePlacement(u,g,w){const C=T(),L=()=>!this._forceFullPlacement&&T()-C>2;for(;this._currentPlacementIndex>=0;){const z=g[u[this._currentPlacementIndex]],Y=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=Y)&&(!z.maxzoom||z.maxzoom>Y)){if(this._inProgressLayer||(this._inProgressLayer=new Wr(z)),this._inProgressLayer.continuePlacement(w[z.source],this.placement,this._showCollisionBoxes,z,L))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(u){return this.placement.commit(u),this.placement}}const kr=512/o.a5/2;class ti{constructor(u,g,w){this.tileID=u,this.bucketInstanceId=w,this._symbolsByKey={};const C=new Map;for(let L=0;L<g.length;L++){const z=g.get(L),Y=z.key,re=C.get(Y);re?re.push(z):C.set(Y,[z])}for(const[L,z]of C){const Y={positions:z.map((re=>({x:Math.floor(re.anchorX*kr),y:Math.floor(re.anchorY*kr)}))),crossTileIDs:z.map((re=>re.crossTileID))};if(Y.positions.length>128){const re=new o.aT(Y.positions.length,16,Uint16Array);for(const{x:le,y:fe}of Y.positions)re.add(le,fe);re.finish(),delete Y.positions,Y.index=re}this._symbolsByKey[L]=Y}}getScaledCoordinates(u,g){const{x:w,y:C,z:L}=this.tileID.canonical,{x:z,y:Y,z:re}=g.canonical,le=kr/Math.pow(2,re-L),fe=(Y*o.a5+u.anchorY)*le,Ie=C*o.a5*kr;return{x:Math.floor((z*o.a5+u.anchorX)*le-w*o.a5*kr),y:Math.floor(fe-Ie)}}findMatches(u,g,w){const C=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-g.canonical.z);for(let L=0;L<u.length;L++){const z=u.get(L);if(z.crossTileID)continue;const Y=this._symbolsByKey[z.key];if(!Y)continue;const re=this.getScaledCoordinates(z,g);if(Y.index){const le=Y.index.range(re.x-C,re.y-C,re.x+C,re.y+C).sort();for(const fe of le){const Ie=Y.crossTileIDs[fe];if(!w[Ie]){w[Ie]=!0,z.crossTileID=Ie;break}}}else if(Y.positions)for(let le=0;le<Y.positions.length;le++){const fe=Y.positions[le],Ie=Y.crossTileIDs[le];if(Math.abs(fe.x-re.x)<=C&&Math.abs(fe.y-re.y)<=C&&!w[Ie]){w[Ie]=!0,z.crossTileID=Ie;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:u})=>u))}}class Ri{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $n{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(u){const g=Math.round((u-this.lng)/360);if(g!==0)for(const w in this.indexes){const C=this.indexes[w],L={};for(const z in C){const Y=C[z];Y.tileID=Y.tileID.unwrapTo(Y.tileID.wrap+g),L[Y.tileID.key]=Y}this.indexes[w]=L}this.lng=u}addBucket(u,g,w){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(let L=0;L<g.symbolInstances.length;L++)g.symbolInstances.get(L).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]={});const C=this.usedCrossTileIDs[u.overscaledZ];for(const L in this.indexes){const z=this.indexes[L];if(Number(L)>u.overscaledZ)for(const Y in z){const re=z[Y];re.tileID.isChildOf(u)&&re.findMatches(g.symbolInstances,u,C)}else{const Y=z[u.scaledTo(Number(L)).key];Y&&Y.findMatches(g.symbolInstances,u,C)}}for(let L=0;L<g.symbolInstances.length;L++){const z=g.symbolInstances.get(L);z.crossTileID||(z.crossTileID=w.generate(),C[z.crossTileID]=!0)}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new ti(u,g.symbolInstances,g.bucketInstanceId),!0}removeBucketCrossTileIDs(u,g){for(const w of g.getCrossTileIDsLists())for(const C of w)delete this.usedCrossTileIDs[u][C]}removeStaleBuckets(u){let g=!1;for(const w in this.indexes){const C=this.indexes[w];for(const L in C)u[C[L].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,C[L]),delete C[L],g=!0)}return g}}class _n{constructor(){this.layerIndexes={},this.crossTileIDs=new Ri,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(u,g,w){let C=this.layerIndexes[u.id];C===void 0&&(C=this.layerIndexes[u.id]=new $n);let L=!1;const z={};C.handleWrapJump(w);for(const Y of g){const re=Y.getBucket(u);re&&u.id===re.layerIds[0]&&(re.bucketInstanceId||(re.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(Y.tileID,re,this.crossTileIDs)&&(L=!0),z[re.bucketInstanceId]=!0)}return C.removeStaleBuckets(z)&&(L=!0),L}pruneUnusedLayers(u){const g={};u.forEach((w=>{g[w]=!0}));for(const w in this.layerIndexes)g[w]||delete this.layerIndexes[w]}}var Mr="void main() {fragColor=vec4(1.0);}";const fn={prelude:mn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:mn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:mn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:mn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:mn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:mn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:mn(Mr,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:mn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:mn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:mn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:mn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:mn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:mn(Mr,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:mn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:mn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:mn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:mn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:mn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:mn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:mn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:mn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:mn(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:mn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:mn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:mn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:mn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:mn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:mn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:mn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:mn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:mn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:mn(`#ifdef GL_ES
precision highp float;
#endif
in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:mn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function mn(D,u){const g=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=u.match(/in ([\w]+) ([\w]+)/g),C=D.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=u.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),z=L?L.concat(C):C,Y={};return{fragmentSource:D=D.replace(g,((re,le,fe,Ie,Te)=>(Y[Te]=!0,le==="define"?`
#ifndef HAS_UNIFORM_u_${Te}
in ${fe} ${Ie} ${Te};
#else
uniform ${fe} ${Ie} u_${Te};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Te}
    ${fe} ${Ie} ${Te} = u_${Te};
#endif
`))),vertexSource:u=u.replace(g,((re,le,fe,Ie,Te)=>{const Ue=Ie==="float"?"vec2":"vec4",Ze=Te.match(/color/)?"color":Ue;return Y[Te]?le==="define"?`
#ifndef HAS_UNIFORM_u_${Te}
uniform lowp float u_${Te}_t;
in ${fe} ${Ue} a_${Te};
out ${fe} ${Ie} ${Te};
#else
uniform ${fe} ${Ie} u_${Te};
#endif
`:Ze==="vec4"?`
#ifndef HAS_UNIFORM_u_${Te}
    ${Te} = a_${Te};
#else
    ${fe} ${Ie} ${Te} = u_${Te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Te}
    ${Te} = unpack_mix_${Ze}(a_${Te}, u_${Te}_t);
#else
    ${fe} ${Ie} ${Te} = u_${Te};
#endif
`:le==="define"?`
#ifndef HAS_UNIFORM_u_${Te}
uniform lowp float u_${Te}_t;
in ${fe} ${Ue} a_${Te};
#else
uniform ${fe} ${Ie} u_${Te};
#endif
`:Ze==="vec4"?`
#ifndef HAS_UNIFORM_u_${Te}
    ${fe} ${Ie} ${Te} = a_${Te};
#else
    ${fe} ${Ie} ${Te} = u_${Te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Te}
    ${fe} ${Ie} ${Te} = unpack_mix_${Ze}(a_${Te}, u_${Te}_t);
#else
    ${fe} ${Ie} ${Te} = u_${Te};
#endif
`})),staticAttributes:w,staticUniforms:z}}class hi{constructor(u,g,w){this.vertexBuffer=u,this.indexBuffer=g,this.segments=w}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var $i=o.aU([{name:"a_pos",type:"Int16",components:2}]);const ba="#define PROJECTION_MERCATOR",wi="mercator";class fi{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return wi}get shaderDefine(){return ba}get shaderPreludeCode(){return fn.projectionMercator}get vertexShaderPreludeCode(){return fn.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(u){}getMeshFromTileID(u,g,w,C,L){if(this._cachedMesh)return this._cachedMesh;const z=new o.aW;z.emplaceBack(0,0),z.emplaceBack(o.a5,0),z.emplaceBack(0,o.a5),z.emplaceBack(o.a5,o.a5);const Y=u.createVertexBuffer(z,$i.members),re=o.aX.simpleSegment(0,0,4,2),le=new o.aY;le.emplaceBack(1,0,2),le.emplaceBack(1,2,3);const fe=u.createIndexBuffer(le);return this._cachedMesh=new hi(Y,fe,re),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(u){}}class Ts{constructor(u=0,g=0,w=0,C=0){if(isNaN(u)||u<0||isNaN(g)||g<0||isNaN(w)||w<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=g,this.left=w,this.right=C}interpolate(u,g,w){return g.top!=null&&u.top!=null&&(this.top=o.G.number(u.top,g.top,w)),g.bottom!=null&&u.bottom!=null&&(this.bottom=o.G.number(u.bottom,g.bottom,w)),g.left!=null&&u.left!=null&&(this.left=o.G.number(u.left,g.left,w)),g.right!=null&&u.right!=null&&(this.right=o.G.number(u.right,g.right,w)),this}getCenter(u,g){const w=o.an((this.left+u-this.right)/2,0,u),C=o.an((this.top+g-this.bottom)/2,0,g);return new o.P(w,C)}equals(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}clone(){return new Ts(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Vs(D,u){if(!D.renderWorldCopies||D.lngRange)return;const g=u.lng-D.center.lng;u.lng+=g>180?-360:g<-180?360:0}function Mi(D){return Math.max(0,Math.floor(D))}class Cs{constructor(u,g){var w;this.applyConstrain=(C,L)=>this._constrainOverride!==null?this._constrainOverride(C,L):this._callbacks.defaultConstrain(C,L),this._callbacks=u,this._tileSize=512,this._renderWorldCopies=g?.renderWorldCopies===void 0||!!g?.renderWorldCopies,this._minZoom=g?.minZoom||0,this._maxZoom=g?.maxZoom||22,this._minPitch=g?.minPitch==null?0:g?.minPitch,this._maxPitch=g?.maxPitch==null?60:g?.maxPitch,this._constrainOverride=(w=g?.constrainOverride)!==null&&w!==void 0?w:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Mi(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Ts,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(u,g,w){this._constrainOverride=u.constrainOverride,this._latRange=u.latRange,this._lngRange=u.lngRange,this._width=u.width,this._height=u.height,this._center=u.center,this._elevation=u.elevation,this._minElevationForCurrentTile=u.minElevationForCurrentTile,this._zoom=u.zoom,this._tileZoom=Mi(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=u.bearingInRadians,this._fovInRadians=u.fovInRadians,this._pitchInRadians=u.pitchInRadians,this._rollInRadians=u.rollInRadians,this._unmodified=u.unmodified,this._edgeInsets=new Ts(u.padding.top,u.padding.bottom,u.padding.left,u.padding.right),this._minZoom=u.minZoom,this._maxZoom=u.maxZoom,this._minPitch=u.minPitch,this._maxPitch=u.maxPitch,this._renderWorldCopies=u.renderWorldCopies,this._cameraToCenterDistance=u.cameraToCenterDistance,this._nearZ=u.nearZ,this._farZ=u.farZ,this._autoCalculateNearFarZ=!w&&u.autoCalculateNearFarZ,g&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(u){this._minElevationForCurrentTile=u}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(u){this._minZoom!==u&&(this._minZoom=u,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(u){this._maxZoom!==u&&(this._maxZoom=u,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(u){this._minPitch!==u&&(this._minPitch=u,this.setPitch(Math.max(this.pitch,u)))}get maxPitch(){return this._maxPitch}setMaxPitch(u){this._maxPitch!==u&&(this._maxPitch=u,this.setPitch(Math.min(this.pitch,u)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u}get constrainOverride(){return this._constrainOverride}setConstrainOverride(u){u===void 0&&(u=null),this._constrainOverride!==u&&(this._constrainOverride=u,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(u){const g=o.W(u,-180,180)*Math.PI/180;var w,C,L,z,Y,re,le,fe,Ie;this._bearingInRadians!==g&&(this._unmodified=!1,this._bearingInRadians=g,this._calcMatrices(),this._rotationMatrix=h(),w=this._rotationMatrix,L=-this._bearingInRadians,z=(C=this._rotationMatrix)[0],Y=C[1],re=C[2],le=C[3],fe=Math.sin(L),Ie=Math.cos(L),w[0]=z*Ie+re*fe,w[1]=Y*Ie+le*fe,w[2]=z*-fe+re*Ie,w[3]=Y*-fe+le*Ie)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(u){const g=o.an(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==g&&(this._unmodified=!1,this._pitchInRadians=g,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(u){const g=u/180*Math.PI;this._rollInRadians!==g&&(this._unmodified=!1,this._rollInRadians=g,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aZ(this._fovInRadians)}setFov(u){u=o.an(u,.1,150),this.fov!==u&&(this._unmodified=!1,this._fovInRadians=o.ap(u),this._calcMatrices())}get zoom(){return this._zoom}setZoom(u){const g=this.applyConstrain(this._center,u).zoom;this._zoom!==g&&(this._unmodified=!1,this._zoom=g,this._tileZoom=Math.max(0,Math.floor(g)),this._scale=o.aq(g),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(u){u!==this._elevation&&(this._elevation=u,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(u,g){this._autoCalculateNearFarZ=!1,this._nearZ=u,this._farZ=g,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(u){return this._edgeInsets.equals(u)}interpolatePadding(u,g,w){this._unmodified=!1,this._edgeInsets.interpolate(u,g,w),this.constrainInternal(),this._calcMatrices()}resize(u,g,w=!0){this._width=u,this._height=g,w&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ht([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(u){u?(this._lngRange=[u.getWest(),u.getEast()],this._latRange=[u.getSouth(),u.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-o.ao,o.ao])}getCameraQueryGeometry(u,g){if(g.length===1)return[g[0],u];{const{minX:w,minY:C,maxX:L,maxY:z}=o.aa.fromPoints(g).extend(u);return[new o.P(w,C),new o.P(L,C),new o.P(L,z),new o.P(w,z),new o.P(w,C)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const u=this._unmodified,{center:g,zoom:w}=this.applyConstrain(this.center,this.zoom);this.setCenter(g),this.setZoom(w),this._unmodified=u,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let u=o.ar(new Float64Array(16));o.Q(u,u,[this._width/2,-this._height/2,1]),o.O(u,u,[1,-1,0]),this._clipSpaceToPixelsMatrix=u,u=o.ar(new Float64Array(16)),o.Q(u,u,[1,-1,1]),o.O(u,u,[-1,-1,0]),o.Q(u,u,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=u,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(u,g,w,C){const L=w!==void 0?w:this.bearing,z=C=C!==void 0?C:this.pitch,{distanceToCenter:Y,clampedElevation:re}=this._distanceToCenterFromAltElevationPitch(g,this.elevation,z),{x:le,y:fe}=en(z,L),Ie=o.a9.fromLngLat(u,g);let Te,Ue,Ze=o.a_(1,Ie.y),ft=0;do{if(ft+=1,ft>10)break;Ue=Y/Ze,Te=new o.a9(Ie.x+le*Ue,Ie.y+fe*Ue),Ze=1/Te.meterInMercatorCoordinateUnits()}while(Math.abs(Y-Ue*Ze)>1e-12);return{center:Te.toLngLat(),elevation:re,zoom:o.at(this.height/2/Math.tan(this.fovInRadians/2)/Ue/this.tileSize)}}recalculateZoomAndCenter(u){if(this.elevation-u==0)return;const g=1/this.worldSize,w=o.as(1,this.center.lat)*this.worldSize,C=o.a9.fromLngLat(this.center,this.elevation),L=C.x/g,z=C.y/g,Y=C.z/g,re=this.pitch,le=this.bearing,{x:fe,y:Ie,z:Te}=en(re,le),Ue=this.cameraToCenterDistance,Ze=L+Ue*-fe,ft=z+Ue*-Ie,pt=Y+Ue*Te,{distanceToCenter:dt,clampedElevation:xt}=this._distanceToCenterFromAltElevationPitch(pt/w,u,re),Ot=dt*w,wt=new o.a9((Ze+fe*Ot)*g,(ft+Ie*Ot)*g,0).toLngLat(),Nt=o.as(1,wt.lat),jt=o.at(this.height/2/Math.tan(this.fovInRadians/2)/dt/Nt/this.tileSize);this._elevation=xt,this._center=wt,this.setZoom(jt)}_distanceToCenterFromAltElevationPitch(u,g,w){const C=-Math.cos(o.ap(w)),L=u-g;let z,Y=g;return C*L>=0||Math.abs(C)<.1?(z=1e4,Y=u+z*C):z=-L/C,{distanceToCenter:z,clampedElevation:Y}}getCameraPoint(){const u=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(u*Math.sin(this.rollInRadians),u*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const u=o.as(1,this.center.lat)*this.worldSize;return Mt(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/u).toLngLat()}getMercatorTileCoordinates(u){if(!u)return[0,0,1,1];const g=u.canonical.z>=0?1<<u.canonical.z:Math.pow(2,u.canonical.z);return[u.canonical.x/g,u.canonical.y/g,1/g/o.a5,1/g/o.a5]}}class oa{constructor(u,g){this.min=u,this.max=g,this.center=o.a$([],o.b0([],this.min,this.max),.5)}quadrant(u){const g=[u%2==0,u<2],w=o.b1(this.min),C=o.b1(this.max);for(let L=0;L<g.length;L++)w[L]=g[L]?this.min[L]:this.center[L],C[L]=g[L]?this.center[L]:this.max[L];return C[2]=this.max[2],new oa(w,C)}distanceX(u){return Math.max(Math.min(this.max[0],u[0]),this.min[0])-u[0]}distanceY(u){return Math.max(Math.min(this.max[1],u[1]),this.min[1])-u[1]}intersectsFrustum(u){let g=!0;for(let w=0;w<u.planes.length;w++){const C=this.intersectsPlane(u.planes[w]);if(C===0)return 0;C===1&&(g=!1)}return g?2:u.aabb.min[0]>this.max[0]||u.aabb.min[1]>this.max[1]||u.aabb.min[2]>this.max[2]||u.aabb.max[0]<this.min[0]||u.aabb.max[1]<this.min[1]||u.aabb.max[2]<this.min[2]?0:1}intersectsPlane(u){let g=u[3],w=u[3];for(let C=0;C<3;C++)u[C]>0?(g+=u[C]*this.min[C],w+=u[C]*this.max[C]):(w+=u[C]*this.min[C],g+=u[C]*this.max[C]);return g>=0?2:w<0?0:1}}class ku{distanceToTile2d(u,g,w,C){const L=C.distanceX([u,g]),z=C.distanceY([u,g]);return Math.hypot(L,z)}getWrap(u,g,w){return w}getTileBoundingVolume(u,g,w,C){var L,z;let Y=0,re=0;if(C?.terrain){const fe=new o.a2(u.z,g,u.z,u.x,u.y),Ie=C.terrain.getMinMaxElevation(fe);Y=(L=Ie.minElevation)!==null&&L!==void 0?L:Math.min(0,w),re=(z=Ie.maxElevation)!==null&&z!==void 0?z:Math.max(0,w)}const le=1<<u.z;return new oa([g+u.x/le,u.y/le,Y],[g+(u.x+1)/le,(u.y+1)/le,re])}allowVariableZoom(u,g){const w=u.fov*(Math.abs(Math.cos(u.rollInRadians))*u.height+Math.abs(Math.sin(u.rollInRadians))*u.width)/u.height,C=o.an(78.5-w/2,0,60);return!!g.terrain||u.pitch>C}allowWorldCopies(){return!0}prepareNextFrame(){}}class Ka{constructor(u,g,w){this.points=u,this.planes=g,this.aabb=w}static fromInvProjectionMatrix(u,g=1,w=0,C,L){const z=L?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],Y=Math.pow(2,w),re=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((Te=>(function(Ue,Ze,ft,pt){const dt=o.aH([],Ue,Ze),xt=1/dt[3]/ft*pt;return o.b6(dt,dt,[xt,xt,1/dt[3],xt])})(Te,u,g,Y)));C&&(function(Te,Ue,Ze,ft){const pt=ft?4:0,dt=ft?0:4;let xt=0;const Ot=[],wt=[];for(let Dt=0;Dt<4;Dt++){const Yt=o.b2([],Te[Dt+dt],Te[Dt+pt]),Sr=o.b7(Yt);o.a$(Yt,Yt,1/Sr),Ot.push(Sr),wt.push(Yt)}for(let Dt=0;Dt<4;Dt++){const Yt=o.b8(Te[Dt+pt],wt[Dt],Ze);xt=Yt!==null&&Yt>=0?Math.max(xt,Yt):Math.max(xt,Ot[Dt])}const Nt=(function(Dt,Yt){const Sr=o.b2([],Dt[Yt[0]],Dt[Yt[1]]),dr=o.b2([],Dt[Yt[2]],Dt[Yt[1]]),yr=[0,0,0,0];return o.b3(yr,o.b4([],Sr,dr)),yr[3]=-o.b5(yr,Dt[Yt[0]]),yr})(Te,Ue),jt=(function(Dt,Yt){const Sr=o.b9(Dt),dr=o.ba([],Dt,1/Sr),yr=o.b2([],Yt,o.a$([],dr,o.b5(Yt,dr))),xr=o.b9(yr);if(xr>0){const an=Math.sqrt(1-dr[3]*dr[3]),ln=o.a$([],dr,-dr[3]),Hr=o.b0([],ln,o.a$([],yr,an/xr));return o.bb(Yt,Hr)}return null})(Ze,Nt);if(jt!==null){const Dt=jt/o.b5(wt[0],Nt);xt=Math.min(xt,Dt)}for(let Dt=0;Dt<4;Dt++){const Yt=Math.min(xt,Ot[Dt]);Te[Dt+dt]=[Te[Dt+pt][0]+wt[Dt][0]*Yt,Te[Dt+pt][1]+wt[Dt][1]*Yt,Te[Dt+pt][2]+wt[Dt][2]*Yt,1]}})(re,z[0],C,L);const le=z.map((Te=>{const Ue=o.b2([],re[Te[0]],re[Te[1]]),Ze=o.b2([],re[Te[2]],re[Te[1]]),ft=o.b3([],o.b4([],Ue,Ze)),pt=-o.b5(ft,re[Te[1]]);return ft.concat(pt)})),fe=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Ie=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const Te of re)for(let Ue=0;Ue<3;Ue++)fe[Ue]=Math.min(fe[Ue],Te[Ue]),Ie[Ue]=Math.max(Ie[Ue],Te[Ue]);return new Ka(re,le,new oa(fe,Ie))}}class $s{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(u){this._helper.setMinZoom(u)}setMaxZoom(u){this._helper.setMaxZoom(u)}setMinPitch(u){this._helper.setMinPitch(u)}setMaxPitch(u){this._helper.setMaxPitch(u)}setRenderWorldCopies(u){this._helper.setRenderWorldCopies(u)}setBearing(u){this._helper.setBearing(u)}setPitch(u){this._helper.setPitch(u)}setRoll(u){this._helper.setRoll(u)}setFov(u){this._helper.setFov(u)}setZoom(u){this._helper.setZoom(u)}setCenter(u){this._helper.setCenter(u)}setElevation(u){this._helper.setElevation(u)}setMinElevationForCurrentTile(u){this._helper.setMinElevationForCurrentTile(u)}setPadding(u){this._helper.setPadding(u)}interpolatePadding(u,g,w){return this._helper.interpolatePadding(u,g,w)}isPaddingEqual(u){return this._helper.isPaddingEqual(u)}resize(u,g,w=!0){this._helper.resize(u,g,w)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(u){this._helper.setMaxBounds(u)}setConstrainOverride(u){this._helper.setConstrainOverride(u)}overrideNearFarZ(u,g){this._helper.overrideNearFarZ(u,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(u){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),u)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(u,g){}constructor(u){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(g,w)=>{w=o.an(+w,this.minZoom,this.maxZoom);const C={center:new o.V(g.lng,g.lat),zoom:w};let L=this._helper._lngRange;if(!this._helper._renderWorldCopies&&L===null){const wt=179.9999999999;L=[-wt,wt]}const z=this.tileSize*o.aq(C.zoom);let Y=0,re=z,le=0,fe=z,Ie=0,Te=0;const{x:Ue,y:Ze}=this.size;if(this._helper._latRange){const wt=this._helper._latRange;Y=o.X(wt[1])*z,re=o.X(wt[0])*z,re-Y<Ze&&(Ie=Ze/(re-Y))}L&&(le=o.W(o.Y(L[0])*z,0,z),fe=o.W(o.Y(L[1])*z,0,z),fe<le&&(fe+=z),fe-le<Ue&&(Te=Ue/(fe-le)));const{x:ft,y:pt}=Ar(z,g);let dt,xt;const Ot=Math.max(Te||0,Ie||0);if(Ot){const wt=new o.P(Te?(fe+le)/2:ft,Ie?(re+Y)/2:pt);return C.center=$r(z,wt).wrap(),C.zoom+=o.at(Ot),C}if(this._helper._latRange){const wt=Ze/2;pt-wt<Y&&(xt=Y+wt),pt+wt>re&&(xt=re-wt)}if(L){const wt=(le+fe)/2;let Nt=ft;this._helper._renderWorldCopies&&(Nt=o.W(ft,wt-z/2,wt+z/2));const jt=Ue/2;Nt-jt<le&&(dt=le+jt),Nt+jt>fe&&(dt=fe-jt)}if(dt!==void 0||xt!==void 0){const wt=new o.P(dt??ft,xt??pt);C.center=$r(z,wt).wrap()}return C},this.applyConstrain=(g,w)=>this._helper.applyConstrain(g,w),this._helper=new Cs({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(g,w)=>this.defaultConstrain(g,w)},u),this._coveringTilesDetailsProvider=new ku}clone(){const u=new $s;return u.apply(this,!1),u}apply(u,g,w){this._helper.apply(u,g,w)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(u){const g=[new o.bc(0,u)];if(this._helper._renderWorldCopies){const w=this.screenPointToMercatorCoordinate(new o.P(0,0)),C=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),L=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),z=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),Y=Math.floor(Math.min(w.x,C.x,L.x,z.x)),re=Math.floor(Math.max(w.x,C.x,L.x,z.x)),le=1;for(let fe=Y-le;fe<=re+le;fe++)fe!==0&&g.push(new o.bc(fe,u))}return g}getCameraFrustum(){return Ka.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(u){const g=this.screenPointToLocation(this.centerPoint,u),w=u?u.getElevationForLngLatZoom(g,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(w)}setLocationAtPoint(u,g){const w=o.as(this.elevation,this.center.lat),C=this.screenPointToMercatorCoordinateAtZ(g,w),L=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,w),z=o.a9.fromLngLat(u),Y=new o.a9(z.x-(C.x-L.x),z.y-(C.y-L.y));this.setCenter(Y?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(u,g){return g?this.coordinatePoint(o.a9.fromLngLat(u),g.getElevationForLngLat(u,this),this._pixelMatrix3D):this.coordinatePoint(o.a9.fromLngLat(u))}screenPointToLocation(u,g){var w;return(w=this.screenPointToMercatorCoordinate(u,g))===null||w===void 0?void 0:w.toLngLat()}screenPointToMercatorCoordinate(u,g){if(g){const w=g.pointCoordinate(u);if(w!=null)return w}return this.screenPointToMercatorCoordinateAtZ(u)}screenPointToMercatorCoordinateAtZ(u,g){const w=g||0,C=[u.x,u.y,0,1],L=[u.x,u.y,1,1];o.aH(C,C,this._pixelMatrixInverse),o.aH(L,L,this._pixelMatrixInverse);const z=C[3],Y=L[3],re=C[1]/z,le=L[1]/Y,fe=C[2]/z,Ie=L[2]/Y,Te=fe===Ie?0:(w-fe)/(Ie-fe);return new o.a9(o.G.number(C[0]/z,L[0]/Y,Te)/this.worldSize,o.G.number(re,le,Te)/this.worldSize,w)}coordinatePoint(u,g=0,w=this._pixelMatrix){const C=[u.x*this.worldSize,u.y*this.worldSize,g,1];return o.aH(C,C,w),new o.P(C[0]/C[3],C[1]/C[3])}getBounds(){const u=Math.max(0,this._helper._height/2-hn(this));return new Ht().extend(this.screenPointToLocation(new o.P(0,u))).extend(this.screenPointToLocation(new o.P(this._helper._width,u))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(u,g){return g?g.pointCoordinate(u)!=null:u.y>this.height/2-hn(this)}calculatePosMatrix(u,g=!1,w){var C;const L=(C=u.key)!==null&&C!==void 0?C:o.bd(u.wrap,u.canonical.z,u.canonical.z,u.canonical.x,u.canonical.y),z=g?this._alignedPosMatrixCache:this._posMatrixCache;if(z.has(L)){const le=z.get(L);return w?le.f32:le.f64}const Y=zr(u,this.worldSize);o.S(Y,g?this._alignedProjMatrix:this._viewProjMatrix,Y);const re={f64:Y,f32:new Float32Array(Y)};return z.set(L,re),w?re.f32:re.f64}calculateFogMatrix(u){const g=u.key,w=this._fogMatrixCacheF32;if(w.has(g))return w.get(g);const C=zr(u,this.worldSize);return o.S(C,this._fogMatrix,C),w.set(g,new Float32Array(C)),w.get(g)}calculateCenterFromCameraLngLatAlt(u,g,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(u,g,w,C)}_calculateNearFarZIfNeeded(u,g,w){if(!this._helper.autoCalculateNearFarZ)return;const C=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),L=u-C*this._helper._pixelPerMeter/Math.cos(g),z=C<0?L:u,Y=Math.PI/2+this.pitchInRadians,re=o.ap(this.fov)*(Math.abs(Math.cos(o.ap(this.roll)))*this.height+Math.abs(Math.sin(o.ap(this.roll)))*this.width)/this.height*(.5+w.y/this.height),le=Math.sin(re)*z/Math.sin(o.an(Math.PI-Y-re,.01,Math.PI-.01)),fe=hn(this),Ie=Math.atan(fe/this._helper.cameraToCenterDistance),Te=o.ap(.75),Ue=Ie>Te?2*Ie*(.5+w.y/(2*fe)):Te,Ze=Math.sin(Ue)*z/Math.sin(o.an(Math.PI-Y-Ue,.01,Math.PI-.01)),ft=Math.min(le,Ze);this._helper._farZ=1.01*(Math.cos(Math.PI/2-g)*ft+z),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const u=this.centerOffset,g=Ar(this.worldSize,this.center),w=g.x,C=g.y;this._helper._pixelPerMeter=o.as(1,this.center.lat)*this.worldSize;const L=o.ap(Math.min(this.pitch,Ir)),z=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(L));let Y;this._calculateNearFarZIfNeeded(z,L,u),Y=new Float64Array(16),o.be(Y,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.aB(this._invProjMatrix,Y),Y[8]=2*-u.x/this._helper._width,Y[9]=2*u.y/this._helper._height,this._projectionMatrix=o.bf(Y),o.Q(Y,Y,[1,-1,1]),o.O(Y,Y,[0,0,-this._helper.cameraToCenterDistance]),o.bg(Y,Y,-this.rollInRadians),o.bh(Y,Y,this.pitchInRadians),o.bg(Y,Y,-this.bearingInRadians),o.O(Y,Y,[-w,-C,0]),this._mercatorMatrix=o.Q([],Y,[this.worldSize,this.worldSize,this.worldSize]),o.Q(Y,Y,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,Y),o.O(Y,Y,[0,0,-this.elevation]),this._viewProjMatrix=Y,this._invViewProjMatrix=o.aB([],Y);const re=[0,0,-1,1];o.aH(re,re,this._invViewProjMatrix),this._cameraPosition=[re[0]/re[3],re[1]/re[3],re[2]/re[3]],this._fogMatrix=new Float64Array(16),o.be(this._fogMatrix,this.fovInRadians,this.width/this.height,z,this._helper._farZ),this._fogMatrix[8]=2*-u.x/this.width,this._fogMatrix[9]=2*u.y/this.height,o.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.O(this._fogMatrix,this._fogMatrix,[-w,-C,0]),o.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,Y);const le=this._helper._width%2/2,fe=this._helper._height%2/2,Ie=Math.cos(this.bearingInRadians),Te=Math.sin(-this.bearingInRadians),Ue=w-Math.round(w)+Ie*le+Te*fe,Ze=C-Math.round(C)+Ie*fe+Te*le,ft=new Float64Array(Y);if(o.O(ft,ft,[Ue>.5?Ue-1:Ue,Ze>.5?Ze-1:Ze,0]),this._alignedProjMatrix=ft,Y=o.aB(new Float64Array(16),this._pixelMatrix),!Y)throw new Error("failed to invert matrix");this._pixelMatrixInverse=Y,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const u=this.screenPointToMercatorCoordinate(new o.P(0,0)),g=[u.x*this.worldSize,u.y*this.worldSize,0,1];return o.aH(g,g,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const u=o.as(1,this.center.lat)*this.worldSize;return Mt(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/u).toLngLat()}lngLatToCameraDepth(u,g){const w=o.a9.fromLngLat(u),C=[w.x*this.worldSize,w.y*this.worldSize,g,1];return o.aH(C,C,this._viewProjMatrix),C[2]/C[3]}getProjectionData(u){const{overscaledTileID:g,aligned:w,applyTerrainMatrix:C}=u,L=this._helper.getMercatorTileCoordinates(g),z=g?this.calculatePosMatrix(g,w,!0):null;let Y;return Y=g&&g.terrainRttPosMatrix32f&&C?g.terrainRttPosMatrix32f:z||o.bi(),{mainMatrix:Y,tileMercatorCoords:L,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:Y}}isLocationOccluded(u){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(u,g,w){return 1}transformLightDirection(u){return o.b1(u)}getRayDirectionFromPixel(u){throw new Error("Not implemented.")}projectTileCoordinates(u,g,w,C){const L=this.calculatePosMatrix(w);let z;C?(z=[u,g,C(u,g),1],o.aH(z,z,L)):(z=[u,g,0,1],Fa(z,z,L));const Y=z[3];return{point:new o.P(z[0]/Y,z[1]/Y),signedDistanceFromCamera:Y,isOccluded:!1}}populateCache(u){for(const g of u)this.calculatePosMatrix(g)}getMatrixForModel(u,g){const w=o.a9.fromLngLat(u,g),C=w.meterInMercatorCoordinateUnits(),L=o.bj();return o.O(L,L,[w.x,w.y,w.z]),o.bg(L,L,Math.PI),o.bh(L,L,Math.PI/2),o.Q(L,L,[-C,C,C]),L}getProjectionDataForCustomLayer(u=!0){const g=new o.a2(0,0,0,0,0),w=this.getProjectionData({overscaledTileID:g,applyGlobeMatrix:u}),C=zr(g,this.worldSize);o.S(C,this._viewProjMatrix,C),w.tileMercatorCoords=[0,0,1,1];const L=[o.a5,o.a5,this.worldSize/this._helper.pixelsPerMeter],z=o.bk();return o.Q(z,C,L),w.fallbackMatrix=z,w.mainMatrix=z,w}getFastPathSimpleProjectionMatrix(u){return this.calculatePosMatrix(u)}}function Vo(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ru(D){if(D.useSlerp)if(D.k<1){const u=o.bl(D.startEulerAngles.roll,D.startEulerAngles.pitch,D.startEulerAngles.bearing),g=o.bl(D.endEulerAngles.roll,D.endEulerAngles.pitch,D.endEulerAngles.bearing),w=new Float64Array(4);o.bm(w,u,g,D.k);const C=o.bn(w);D.tr.setRoll(C.roll),D.tr.setPitch(C.pitch),D.tr.setBearing(C.bearing)}else D.tr.setRoll(D.endEulerAngles.roll),D.tr.setPitch(D.endEulerAngles.pitch),D.tr.setBearing(D.endEulerAngles.bearing);else D.tr.setRoll(o.G.number(D.startEulerAngles.roll,D.endEulerAngles.roll,D.k)),D.tr.setPitch(o.G.number(D.startEulerAngles.pitch,D.endEulerAngles.pitch,D.k)),D.tr.setBearing(o.G.number(D.startEulerAngles.bearing,D.endEulerAngles.bearing,D.k))}function Mu(D,u,g,w,C){const L=C.padding,z=Ar(C.worldSize,g.getNorthWest()),Y=Ar(C.worldSize,g.getNorthEast()),re=Ar(C.worldSize,g.getSouthEast()),le=Ar(C.worldSize,g.getSouthWest()),fe=o.ap(-w),Ie=z.rotate(fe),Te=Y.rotate(fe),Ue=re.rotate(fe),Ze=le.rotate(fe),ft=new o.P(Math.max(Ie.x,Te.x,Ze.x,Ue.x),Math.max(Ie.y,Te.y,Ze.y,Ue.y)),pt=new o.P(Math.min(Ie.x,Te.x,Ze.x,Ue.x),Math.min(Ie.y,Te.y,Ze.y,Ue.y)),dt=ft.sub(pt),xt=(C.width-(L.left+L.right+u.left+u.right))/dt.x,Ot=(C.height-(L.top+L.bottom+u.top+u.bottom))/dt.y;if(Ot<0||xt<0)return void Vo();const wt=Math.min(o.at(C.scale*Math.min(xt,Ot)),D.maxZoom),Nt=o.P.convert(D.offset),jt=new o.P((u.left-u.right)/2,(u.top-u.bottom)/2).rotate(o.ap(w)),Dt=Nt.add(jt).mult(C.scale/o.aq(wt));return{center:$r(C.worldSize,z.add(re).div(2).sub(Dt)),zoom:wt,bearing:w}}class go{get useGlobeControls(){return!1}handlePanInertia(u,g){const w=u.mag(),C=Math.abs(hn(g));return{easingOffset:u.mult(Math.min(.75*C/w,1)),easingCenter:g.center}}handleMapControlsRollPitchBearingZoom(u,g){u.bearingDelta&&g.setBearing(g.bearing+u.bearingDelta),u.pitchDelta&&g.setPitch(g.pitch+u.pitchDelta),u.rollDelta&&g.setRoll(g.roll+u.rollDelta),u.zoomDelta&&g.setZoom(g.zoom+u.zoomDelta)}handleMapControlsPan(u,g,w){u.around.distSqr(g.centerPoint)<.01||g.setLocationAtPoint(w,u.around)}cameraForBoxAndBearing(u,g,w,C,L){return Mu(u,g,w,C,L)}handleJumpToCenterZoom(u,g){u.zoom!==(g.zoom!==void 0?+g.zoom:u.zoom)&&u.setZoom(+g.zoom),g.center!==void 0&&u.setCenter(o.V.convert(g.center))}handleEaseTo(u,g){const w=u.zoom,C=u.padding,L={roll:u.roll,pitch:u.pitch,bearing:u.bearing},z={roll:g.roll===void 0?u.roll:g.roll,pitch:g.pitch===void 0?u.pitch:g.pitch,bearing:g.bearing===void 0?u.bearing:g.bearing},Y=g.zoom!==void 0,re=!u.isPaddingEqual(g.padding);let le=!1;const fe=Y?+g.zoom:u.zoom;let Ie=u.centerPoint.add(g.offsetAsPoint);const Te=u.screenPointToLocation(Ie),{center:Ue,zoom:Ze}=u.applyConstrain(o.V.convert(g.center||Te),fe??w);Vs(u,Ue);const ft=Ar(u.worldSize,Te),pt=Ar(u.worldSize,Ue).sub(ft),dt=o.aq(Ze-w);return le=Ze!==w,{easeFunc:xt=>{if(le&&u.setZoom(o.G.number(w,Ze,xt)),o.bo(L,z)||Ru({startEulerAngles:L,endEulerAngles:z,tr:u,k:xt,useSlerp:L.roll!=z.roll}),re&&(u.interpolatePadding(C,g.padding,xt),Ie=u.centerPoint.add(g.offsetAsPoint)),g.around)u.setLocationAtPoint(g.around,g.aroundPoint);else{const Ot=o.aq(u.zoom-w),wt=Ze>w?Math.min(2,dt):Math.max(.5,dt),Nt=Math.pow(wt,1-xt),jt=$r(u.worldSize,ft.add(pt.mult(xt*Nt)).mult(Ot));u.setLocationAtPoint(u.renderWorldCopies?jt.wrap():jt,Ie)}},isZooming:le,elevationCenter:Ue}}handleFlyTo(u,g){const w=g.zoom!==void 0,C=u.zoom,L=u.applyConstrain(o.V.convert(g.center||g.locationAtOffset),w?+g.zoom:C),z=L.center,Y=L.zoom;Vs(u,z);const re=Ar(u.worldSize,g.locationAtOffset),le=Ar(u.worldSize,z).sub(re),fe=le.mag(),Ie=o.aq(Y-C);let Te;if(g.minZoom!==void 0){const Ue=Math.min(+g.minZoom,C,Y),Ze=u.applyConstrain(z,Ue).zoom;Te=o.aq(Ze-C)}return{easeFunc:(Ue,Ze,ft,pt)=>{u.setZoom(Ue===1?Y:C+o.at(Ze));const dt=Ue===1?z:$r(u.worldSize,re.add(le.mult(ft)).mult(Ze));u.setLocationAtPoint(u.renderWorldCopies?dt.wrap():dt,pt)},scaleOfZoom:Ie,targetCenter:z,scaleOfMinZoom:Te,pixelPathLength:fe}}}class ji{constructor(u,g,w){this.blendFunction=u,this.blendColor=g,this.mask=w}}ji.Replace=[1,0],ji.disabled=new ji(ji.Replace,o.bp.transparent,[!1,!1,!1,!1]),ji.unblended=new ji(ji.Replace,o.bp.transparent,[!0,!0,!0,!0]),ji.alphaBlended=new ji([1,771],o.bp.transparent,[!0,!0,!0,!0]);const qs=2305;class ii{constructor(u,g,w){this.enable=u,this.mode=g,this.frontFace=w}}ii.disabled=new ii(!1,1029,qs),ii.backCCW=new ii(!0,1029,qs),ii.frontCCW=new ii(!0,1028,qs);class ri{constructor(u,g,w){this.func=u,this.mask=g,this.range=w}}ri.ReadOnly=!1,ri.ReadWrite=!0,ri.disabled=new ri(519,ri.ReadOnly,[0,1]);const Do=7680;class ai{constructor(u,g,w,C,L,z){this.test=u,this.ref=g,this.mask=w,this.fail=C,this.depthFail=L,this.pass=z}}ai.disabled=new ai({func:519,mask:0},0,0,Do,Do,Do);const ue=new WeakMap;function Ge(D){var u;if(ue.has(D))return ue.get(D);{const g=(u=D.getParameter(D.VERSION))===null||u===void 0?void 0:u.startsWith("WebGL 2.0");return ue.set(D,g),g}}class bt{get awaitingQuery(){return!!this._readbackQueue}constructor(u){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=u;const g=u.context,w=g.gl;this._texFormat=w.RGBA,this._texType=w.UNSIGNED_BYTE;const C=new o.aW;C.emplaceBack(-1,-1),C.emplaceBack(2,-1),C.emplaceBack(-1,2);const L=new o.aY;L.emplaceBack(0,1,2),this._fullscreenTriangle=new hi(g.createVertexBuffer(C,$i.members),g.createIndexBuffer(L),o.aX.simpleSegment(0,0,C.length,L.length)),this._resultBuffer=new Uint8Array(4),g.activeTexture.set(w.TEXTURE1);const z=w.createTexture();w.bindTexture(w.TEXTURE_2D,z),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.NEAREST),w.texImage2D(w.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=g.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(z),Ge(w)&&(this._pbo=w.createBuffer(),w.bindBuffer(w.PIXEL_PACK_BUFFER,this._pbo),w.bufferData(w.PIXEL_PACK_BUFFER,4,w.STREAM_READ),w.bindBuffer(w.PIXEL_PACK_BUFFER,null))}destroy(){const u=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),u.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(u,g){const w=this._updateCount;return this._readbackQueue?w>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():w>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(u,g),this._updateCount++,this._measuredError}_bindFramebuffer(){const u=this._cachedRenderContext.context,g=u.gl;u.activeTexture.set(g.TEXTURE1),g.bindTexture(g.TEXTURE_2D,this._fbo.colorAttachment.get()),u.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(u,g){const w=this._cachedRenderContext.context,C=w.gl;if(this._bindFramebuffer(),w.viewport.set([0,0,this._texWidth,this._texHeight]),w.clear({color:o.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(w,C.TRIANGLES,ri.disabled,ai.disabled,ji.unblended,ii.disabled,((L,z)=>({u_input:L,u_output_expected:z}))(u,g),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Ge(C)){C.bindBuffer(C.PIXEL_PACK_BUFFER,this._pbo),C.readBuffer(C.COLOR_ATTACHMENT0),C.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),C.bindBuffer(C.PIXEL_PACK_BUFFER,null);const L=C.fenceSync(C.SYNC_GPU_COMMANDS_COMPLETE,0);C.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:L}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const u=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Ge(u)){const g=u.clientWaitSync(this._readbackQueue.sync,0,0);if(g===u.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(g===u.TIMEOUT_EXPIRED)return;u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),u.bindBuffer(u.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),u.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=bt._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(u){let g=0;return g+=u[0]/256,g+=u[1]/65536,g+=u[2]/16777216,u[3]<127&&(g=-g),g/128}}const Bt=o.a5/128;function sr(D,u){const g=D.granularity!==void 0?Math.max(D.granularity,1):1,w=g+(D.generateBorders?2:0),C=g+(D.extendToNorthPole||D.generateBorders?1:0)+(D.extendToSouthPole||D.generateBorders?1:0),L=w+1,z=C+1,Y=D.generateBorders?-1:0,re=D.generateBorders||D.extendToNorthPole?-1:0,le=g+(D.generateBorders?1:0),fe=g+(D.generateBorders||D.extendToSouthPole?1:0),Ie=L*z,Te=w*C*6,Ue=L*z>65536;if(Ue&&u==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Ze=Ue||u==="32bit",ft=new Int16Array(2*Ie);let pt=0;for(let Ot=re;Ot<=fe;Ot++)for(let wt=Y;wt<=le;wt++){let Nt=wt/g*o.a5;wt===-1&&(Nt=-Bt),wt===g+1&&(Nt=o.a5+Bt);let jt=Ot/g*o.a5;Ot===-1&&(jt=D.extendToNorthPole?o.br:-Bt),Ot===g+1&&(jt=D.extendToSouthPole?o.bs:o.a5+Bt),ft[pt++]=Nt,ft[pt++]=jt}const dt=Ze?new Uint32Array(Te):new Uint16Array(Te);let xt=0;for(let Ot=0;Ot<C;Ot++)for(let wt=0;wt<w;wt++){const Nt=wt+1+Ot*L,jt=wt+(Ot+1)*L,Dt=wt+1+(Ot+1)*L;dt[xt++]=wt+Ot*L,dt[xt++]=jt,dt[xt++]=Nt,dt[xt++]=Nt,dt[xt++]=jt,dt[xt++]=Dt}return{vertices:ft.buffer.slice(0),indices:dt.buffer.slice(0),uses32bitIndices:Ze}}const Nr=new o.aV({fill:new o.bt(128,2),line:new o.bt(512,0),tile:new o.bt(128,32),stencil:new o.bt(128,1),circle:3});class Zr{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return fn.projectionGlobe}get vertexShaderPreludeCode(){return fn.projectionMercator.vertexSource}get subdivisionGranularity(){return Nr}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(u){this._errorMeasurement||(this._errorMeasurement=new bt(u));const g=o.X(this._errorQueryLatitudeDegrees),w=2*Math.atan(Math.exp(Math.PI-g*Math.PI*2))-.5*Math.PI,C=this._errorMeasurement.updateErrorLoop(g,w),L=T();C!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=C,this._errorMeasurementLastChangeTime=L);const z=Math.min(Math.max((L-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bv(z))}_getMeshKey(u){return`${u.granularity.toString(36)}_${u.generateBorders?"b":""}${u.extendToNorthPole?"n":""}${u.extendToSouthPole?"s":""}`}getMeshFromTileID(u,g,w,C,L){const z=(L==="stencil"?Nr.stencil:Nr.tile).getGranularityForZoomLevel(g.z);return this._getMesh(u,{granularity:z,generateBorders:w,extendToNorthPole:g.y===0&&C,extendToSouthPole:g.y===(1<<g.z)-1&&C})}_getMesh(u,g){const w=this._getMeshKey(g);if(w in this._tileMeshCache)return this._tileMeshCache[w];const C=(function(L,z){const Y=sr(z,"16bit"),re=o.aW.deserialize({arrayBuffer:Y.vertices,length:Y.vertices.byteLength/2/2}),le=o.aY.deserialize({arrayBuffer:Y.indices,length:Y.indices.byteLength/2/3});return new hi(L.createVertexBuffer(re,$i.members),L.createIndexBuffer(le),o.aX.simpleSegment(0,0,re.length,le.length))})(u,g);return this._tileMeshCache[w]=C,C}recalculate(u){}hasTransition(){const u=T();let g=!1;return g=g||(u-this._errorMeasurementLastChangeTime)/1e3<.7,g=g||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,g}setErrorQueryLatitudeDegrees(u){this._errorQueryLatitudeDegrees=u}}const Ln=new o.t({type:new o.D(o.u.projection.type)});class qn extends o.E{constructor(u){super(),this._transitionable=new o.x(Ln,void 0),this.setProjection(u),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0)),this._mercatorProjection=new fi,this._verticalPerspectiveProjection=new Zr}get transitionState(){const u=this.properties.get("type");if(typeof u=="string"&&u==="mercator")return 0;if(typeof u=="string"&&u==="vertical-perspective")return 1;if(u instanceof o.bw){if(u.from==="vertical-perspective"&&u.to==="mercator")return 1-u.transition;if(u.from==="mercator"&&u.to==="vertical-perspective")return u.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(u){this._mercatorProjection.updateGPUdependent(u),this._verticalPerspectiveProjection.updateGPUdependent(u)}getMeshFromTileID(u,g,w,C,L){return this.currentProjection.getMeshFromTileID(u,g,w,C,L)}setProjection(u){this._transitionable.setValue("type",u?.type||"mercator")}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}setErrorQueryLatitudeDegrees(u){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(u),this._mercatorProjection.setErrorQueryLatitudeDegrees(u)}}function Un(D){const u=Ui(D.worldSize,D.center.lat);return 2*Math.PI*u}function ui(D,u,g,w,C){const L=1/(1<<C),z=u/o.a5*L+w*L,Y=o.by((D/o.a5*L+g*L)*Math.PI*2+Math.PI,2*Math.PI),re=2*Math.atan(Math.exp(Math.PI-z*Math.PI*2))-.5*Math.PI,le=Math.cos(re),fe=new Float64Array(3);return fe[0]=Math.sin(Y)*le,fe[1]=Math.sin(re),fe[2]=Math.cos(Y)*le,fe}function Hn(D){return(function(u,g){const w=Math.cos(g),C=new Float64Array(3);return C[0]=Math.sin(u)*w,C[1]=Math.sin(g),C[2]=Math.cos(u)*w,C})(D.lng*Math.PI/180,D.lat*Math.PI/180)}function Ui(D,u){return D/(2*Math.PI)/Math.cos(u*Math.PI/180)}function Xi(D){const u=Math.asin(D[1])/Math.PI*180,g=Math.sqrt(D[0]*D[0]+D[2]*D[2]);if(g>1e-6){const w=D[0]/g,C=Math.acos(D[2]/g),L=(w>0?C:-C)/Math.PI*180;return new o.V(o.W(L,-180,180),u)}return new o.V(0,u)}function ra(D){return Math.cos(D*Math.PI/180)}function Si(D,u){const g=ra(D),w=ra(u);return o.at(w/g)}function Ia(D,u){const g=D.rotate(u.bearingInRadians),w=u.zoom+Si(u.center.lat,0),C=o.bu(1/ra(u.center.lat),1/ra(Math.min(Math.abs(u.center.lat),60)),o.bx(w,7,3,0,1)),L=360/Un({worldSize:u.worldSize,center:{lat:u.center.lat}});return new o.V(u.center.lng-g.x*L*C,o.an(u.center.lat+g.y*L,-o.ao,o.ao))}function za(D){const u=.5*D,g=Math.sin(u),w=Math.cos(u);return Math.log(g+w)-Math.log(w-g)}function Hs(D,u,g,w){const C=D.lat+g*w;if(Math.abs(g)>1){const L=(Math.sign(D.lat+g)!==Math.sign(D.lat)?-Math.abs(D.lat):Math.abs(D.lat))*Math.PI/180,z=Math.abs(D.lat+g)*Math.PI/180,Y=za(L+w*(z-L)),re=za(L),le=za(z);return new o.V(D.lng+u*((Y-re)/(le-re)),C)}return new o.V(D.lng+u*w,C)}class ll{constructor(u){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=u}swapBuffers(){if(!this._hadAnyChanges)return;const u=this._cachePrevious;this._cachePrevious=this._cache,this._cache=u,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(u,g,w,C){const L=`${u.z}_${u.x}_${u.y}_${C?.terrain?"t":""}`,z=this._cache.get(L);if(z)return z;const Y=this._cachePrevious.get(L);if(Y)return this._cache.set(L,Y),Y;const re=this._boundingVolumeFactory(u,g,w,C);return this._cache.set(L,re),this._hadAnyChanges=!0,re}}class Ws{constructor(u,g,w,C){this.min=w,this.max=C,this.points=u,this.planes=g}static fromAabb(u,g){const w=[];for(let C=0;C<8;C++)w.push([1&~C?u[0]:g[0],(C>>1&1)==1?g[1]:u[1],(C>>2&1)==1?g[2]:u[2]]);return new Ws(w,[[-1,0,0,g[0]],[1,0,0,-u[0]],[0,-1,0,g[1]],[0,1,0,-u[1]],[0,0,-1,g[2]],[0,0,1,-u[2]]],u,g)}static fromCenterSizeAngles(u,g,w){const C=o.bB([],w[0],w[1],w[2]),L=o.bC([],[g[0],0,0],C),z=o.bC([],[0,g[1],0],C),Y=o.bC([],[0,0,g[2]],C),re=[...u],le=[...u];for(let Ie=0;Ie<8;Ie++)for(let Te=0;Te<3;Te++){const Ue=u[Te]+L[Te]*(1&~Ie?-1:1)+z[Te]*((Ie>>1&1)==1?1:-1)+Y[Te]*((Ie>>2&1)==1?1:-1);re[Te]=Math.min(re[Te],Ue),le[Te]=Math.max(le[Te],Ue)}const fe=[];for(let Ie=0;Ie<8;Ie++){const Te=[...u];o.b0(Te,Te,o.a$([],L,1&~Ie?-1:1)),o.b0(Te,Te,o.a$([],z,(Ie>>1&1)==1?1:-1)),o.b0(Te,Te,o.a$([],Y,(Ie>>2&1)==1?1:-1)),fe.push(Te)}return new Ws(fe,[[...L,-o.b5(L,fe[0])],[...z,-o.b5(z,fe[0])],[...Y,-o.b5(Y,fe[0])],[-L[0],-L[1],-L[2],-o.b5(L,fe[7])],[-z[0],-z[1],-z[2],-o.b5(z,fe[7])],[-Y[0],-Y[1],-Y[2],-o.b5(Y,fe[7])]],re,le)}intersectsFrustum(u){let g=!0;const w=this.points.length,C=this.planes.length,L=u.planes.length,z=u.points.length;for(let Y=0;Y<L;Y++){const re=u.planes[Y];let le=0;for(let fe=0;fe<w;fe++){const Ie=this.points[fe];re[0]*Ie[0]+re[1]*Ie[1]+re[2]*Ie[2]+re[3]>=0&&le++}if(le===0)return 0;le<w&&(g=!1)}if(g)return 2;for(let Y=0;Y<C;Y++){const re=this.planes[Y];let le=0;for(let fe=0;fe<z;fe++){const Ie=u.points[fe];re[0]*Ie[0]+re[1]*Ie[1]+re[2]*Ie[2]+re[3]>=0&&le++}if(le===0)return 0}return 1}intersectsPlane(u){const g=this.points.length;let w=0;for(let C=0;C<g;C++){const L=this.points[C];u[0]*L[0]+u[1]*L[1]+u[2]*L[2]+u[3]>=0&&w++}return w===g?2:w===0?0:1}}function $o(D,u,g){const w=D-u;return w<0?-w:Math.max(0,w-g)}function Gs(D,u,g,w,C){const L=D-g;let z;return z=L<0?Math.min(-L,1+L-C):L>1?Math.min(Math.max(L-C,0),1-L):0,Math.max(z,$o(u,w,C))}class Pa{constructor(){this._boundingVolumeCache=new ll(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(u,g,w,C){const L=1<<w.z,z=1/L,Y=w.x/L,re=w.y/L;let le=2;return le=Math.min(le,Gs(u,g,Y,re,z)),le=Math.min(le,Gs(u,g,Y+.5,-re-z,z)),le=Math.min(le,Gs(u,g,Y+.5,2-re-z,z)),le}getWrap(u,g,w){const C=1<<g.z,L=1/C,z=g.x/C,Y=$o(u.x,z,L),re=$o(u.x,z-1,L),le=$o(u.x,z+1,L),fe=Math.min(Y,re,le);return fe===le?1:fe===re?-1:0}allowVariableZoom(u,g){return un(u,g)>4}allowWorldCopies(){return!1}getTileBoundingVolume(u,g,w,C){return this._boundingVolumeCache.getTileBoundingVolume(u,g,w,C)}_computeTileBoundingVolume(u,g,w,C){var L,z;let Y=0,re=0;if(C?.terrain){const le=new o.a2(u.z,g,u.z,u.x,u.y),fe=C.terrain.getMinMaxElevation(le);Y=(L=fe.minElevation)!==null&&L!==void 0?L:Math.min(0,w),re=(z=fe.maxElevation)!==null&&z!==void 0?z:Math.max(0,w)}if(Y/=o.bE,re/=o.bE,Y+=1,re+=1,u.z<=0)return Ws.fromAabb([-re,-re,-re],[re,re,re]);if(u.z===1)return Ws.fromAabb([u.x===0?-re:0,u.y===0?0:-re,-re],[u.x===0?0:re,u.y===0?re:0,re]);{const le=[ui(0,0,u.x,u.y,u.z),ui(o.a5,0,u.x,u.y,u.z),ui(o.a5,o.a5,u.x,u.y,u.z),ui(0,o.a5,u.x,u.y,u.z)],fe=[];for(const yr of le)fe.push(o.a$([],yr,re));if(re!==Y)for(const yr of le)fe.push(o.a$([],yr,Y));u.y===0&&fe.push([0,1,0]),u.y===(1<<u.z)-1&&fe.push([0,-1,0]);const Ie=[1,1,1],Te=[-1,-1,-1];for(const yr of fe)for(let xr=0;xr<3;xr++)Ie[xr]=Math.min(Ie[xr],yr[xr]),Te[xr]=Math.max(Te[xr],yr[xr]);const Ue=ui(o.a5/2,o.a5/2,u.x,u.y,u.z),Ze=o.b4([],[0,1,0],Ue);o.b3(Ze,Ze);const ft=o.b4([],Ue,Ze);o.b3(ft,ft);const pt=o.b4([],le[2],le[1]);o.b3(pt,pt);const dt=o.b4([],le[0],le[3]);o.b3(dt,dt),fe.push(o.a$([],Ue,re)),u.y>=(1<<u.z)/2&&fe.push(o.a$([],ui(o.a5/2,0,u.x,u.y,u.z),re)),u.y<(1<<u.z)/2&&fe.push(o.a$([],ui(o.a5/2,o.a5,u.x,u.y,u.z),re));const xt=Xs(Ue,fe),Ot=Xs(ft,fe),wt=[-Ue[0],-Ue[1],-Ue[2],xt.max],Nt=[Ue[0],Ue[1],Ue[2],-xt.min],jt=[-ft[0],-ft[1],-ft[2],Ot.max],Dt=[ft[0],ft[1],ft[2],-Ot.min],Yt=[...pt,0],Sr=[...dt,0],dr=[];return u.y===0?dr.push(o.bD(Sr,Yt,wt),o.bD(Sr,Yt,Nt)):dr.push(o.bD(jt,Yt,wt),o.bD(jt,Yt,Nt),o.bD(jt,Sr,wt),o.bD(jt,Sr,Nt)),u.y===(1<<u.z)-1?dr.push(o.bD(Sr,Yt,wt),o.bD(Sr,Yt,Nt)):dr.push(o.bD(Dt,Yt,wt),o.bD(Dt,Yt,Nt),o.bD(Dt,Sr,wt),o.bD(Dt,Sr,Nt)),new Ws(dr,[wt,Nt,jt,Dt,Yt,Sr],Ie,Te)}}}function Xs(D,u){let g=1/0,w=-1/0;for(const C of u){const L=o.b5(D,C);g=Math.min(g,L),w=Math.max(w,L)}return{min:g,max:w}}class Il{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(u){this._helper.setMinZoom(u)}setMaxZoom(u){this._helper.setMaxZoom(u)}setMinPitch(u){this._helper.setMinPitch(u)}setMaxPitch(u){this._helper.setMaxPitch(u)}setRenderWorldCopies(u){this._helper.setRenderWorldCopies(u)}setBearing(u){this._helper.setBearing(u)}setPitch(u){this._helper.setPitch(u)}setRoll(u){this._helper.setRoll(u)}setFov(u){this._helper.setFov(u)}setZoom(u){this._helper.setZoom(u)}setCenter(u){this._helper.setCenter(u)}setElevation(u){this._helper.setElevation(u)}setMinElevationForCurrentTile(u){this._helper.setMinElevationForCurrentTile(u)}setPadding(u){this._helper.setPadding(u)}interpolatePadding(u,g,w){return this._helper.interpolatePadding(u,g,w)}isPaddingEqual(u){return this._helper.isPaddingEqual(u)}resize(u,g){this._helper.resize(u,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(u){this._helper.setMaxBounds(u)}setConstrainOverride(u){this._helper.setConstrainOverride(u)}overrideNearFarZ(u,g){this._helper.overrideNearFarZ(u,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(u){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),u)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(u){}constructor(u){this._cachedClippingPlane=o.bF(),this._projectionMatrix=o.bj(),this._globeViewProjMatrix32f=o.bi(),this._globeViewProjMatrixNoCorrection=o.bj(),this._globeViewProjMatrixNoCorrectionInverted=o.bj(),this._globeProjMatrixInverted=o.bj(),this._cameraPosition=o.bz(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(g,w)=>{const C=o.an(g.lat,-o.ao,o.ao),L=o.an(+w,this.minZoom+Si(0,C),this.maxZoom);return{center:new o.V(g.lng,C),zoom:L}},this.applyConstrain=(g,w)=>this._helper.applyConstrain(g,w),this._helper=new Cs({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(g,w)=>this.defaultConstrain(g,w)},u),this._coveringTilesDetailsProvider=new Pa}clone(){const u=new Il;return u.apply(this,!1),u}apply(u,g,w){this._globeLatitudeErrorCorrectionRadians=w||0,this._helper.apply(u,g)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const u=o.bz();return u[0]=this._cameraPosition[0],u[1]=this._cameraPosition[1],u[2]=this._cameraPosition[2],u}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(u){const{overscaledTileID:g,applyGlobeMatrix:w}=u,C=this._helper.getMercatorTileCoordinates(g);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:C,clippingPlane:this._cachedClippingPlane,projectionTransition:w?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(u){const g=this.pitchInRadians,w=this.cameraToCenterDistance/u,C=Math.sin(g)*w,L=Math.cos(g)*w+1,z=1/Math.sqrt(C*C+L*L)*1;let Y=-C,re=L;const le=Math.sqrt(Y*Y+re*re);Y/=le,re/=le;const fe=[0,Y,re];o.bG(fe,fe,[0,0,0],-this.bearingInRadians),o.bH(fe,fe,[0,0,0],-1*this.center.lat*Math.PI/180),o.bI(fe,fe,[0,0,0],this.center.lng*Math.PI/180);const Ie=1/o.b7(fe);return o.a$(fe,fe,Ie),[...fe,-z*Ie]}isLocationOccluded(u){return!this.isSurfacePointVisible(Hn(u))}transformLightDirection(u){const g=this._helper._center.lng*Math.PI/180,w=this._helper._center.lat*Math.PI/180,C=Math.cos(w),L=[Math.sin(g)*C,Math.sin(w),Math.cos(g)*C],z=[L[2],0,-L[0]],Y=[0,0,0];o.b4(Y,z,L),o.b3(z,z),o.b3(Y,Y);const re=[0,0,0];return o.b3(re,[z[0]*u[0]+Y[0]*u[1]+L[0]*u[2],z[1]*u[0]+Y[1]*u[1]+L[1]*u[2],z[2]*u[0]+Y[2]*u[1]+L[2]*u[2]]),re}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(u,g,w){const C=(function(Y,re,le){const fe=1/(1<<le.z);return new o.a9(Y/o.a5*fe+le.x*fe,re/o.a5*fe+le.y*fe)})(u,g,w.canonical),L=(z=C.y,[o.by(C.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-z*Math.PI*2))-.5*Math.PI]);var z;return this.getCircleRadiusCorrection()/Math.cos(L[1])}projectTileCoordinates(u,g,w,C){const L=w.canonical,z=ui(u,g,L.x,L.y,L.z),Y=1+(C?C(u,g):0)/o.bE,re=[z[0]*Y,z[1]*Y,z[2]*Y,1];o.aH(re,re,this._globeViewProjMatrixNoCorrection);const le=this._cachedClippingPlane,fe=le[0]*z[0]+le[1]*z[1]+le[2]*z[2]+le[3]<0;return{point:new o.P(re[0]/re[3],re[1]/re[3]),signedDistanceFromCamera:re[3],isOccluded:fe}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const u=Ui(this.worldSize,this.center.lat),g=o.bk(),w=o.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*u),o.be(g,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const C=this.centerOffset;g[8]=2*-C.x/this._helper._width,g[9]=2*C.y/this._helper._height,this._projectionMatrix=o.bf(g),this._globeProjMatrixInverted=o.bk(),o.aB(this._globeProjMatrixInverted,g),o.O(g,g,[0,0,-this.cameraToCenterDistance]),o.bg(g,g,this.rollInRadians),o.bh(g,g,-this.pitchInRadians),o.bg(g,g,this.bearingInRadians),o.O(g,g,[0,0,-u]);const L=o.bz();L[0]=u,L[1]=u,L[2]=u,o.bh(w,g,this.center.lat*Math.PI/180),o.bJ(w,w,-this.center.lng*Math.PI/180),o.Q(w,w,L),this._globeViewProjMatrixNoCorrection=w,o.bh(g,g,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bJ(g,g,-this.center.lng*Math.PI/180),o.Q(g,g,L),this._globeViewProjMatrix32f=new Float32Array(g),this._globeViewProjMatrixNoCorrectionInverted=o.bk(),o.aB(this._globeViewProjMatrixNoCorrectionInverted,w);const z=o.bz();this._cameraPosition=o.bz(),this._cameraPosition[2]=this.cameraToCenterDistance/u,o.bG(this._cameraPosition,this._cameraPosition,z,-this.rollInRadians),o.bH(this._cameraPosition,this._cameraPosition,z,this.pitchInRadians),o.bG(this._cameraPosition,this._cameraPosition,z,-this.bearingInRadians),o.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bH(this._cameraPosition,this._cameraPosition,z,-this.center.lat*Math.PI/180),o.bI(this._cameraPosition,this._cameraPosition,z,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(u);const Y=o.bf(this._globeViewProjMatrixNoCorrectionInverted);o.Q(Y,Y,[1,1,-1]),this._cachedFrustum=Ka.fromInvProjectionMatrix(Y,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(u){o.w("calculateFogMatrix is not supported on globe projection.");const g=o.bk();return o.ar(g),g}getVisibleUnwrappedCoordinates(u){return[new o.bc(0,u)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(u){u&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(u,g){if(!this._globeViewProjMatrixNoCorrection)return 1;const w=Hn(u);o.a$(w,w,1+g/o.bE);const C=o.bF();return o.aH(C,[w[0],w[1],w[2],1],this._globeViewProjMatrixNoCorrection),C[2]/C[3]}populateCache(u){}getBounds(){const u=.5*this.width,g=.5*this.height,w=[new o.P(0,0),new o.P(u,0),new o.P(this.width,0),new o.P(this.width,g),new o.P(this.width,this.height),new o.P(u,this.height),new o.P(0,this.height),new o.P(0,g)],C=[];for(const Ie of w)C.push(this.unprojectScreenPoint(Ie));let L=0,z=0,Y=0,re=0;const le=this.center;for(const Ie of C){const Te=o.bK(le.lng,Ie.lng),Ue=o.bK(le.lat,Ie.lat);Te<z&&(z=Te),Te>L&&(L=Te),Ue<re&&(re=Ue),Ue>Y&&(Y=Ue)}const fe=[le.lng+z,le.lat+re,le.lng+L,le.lat+Y];return this.isSurfacePointOnScreen([0,1,0])&&(fe[3]=90,fe[0]=-180,fe[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(fe[1]=-90,fe[0]=-180,fe[2]=180),new Ht(fe)}calculateCenterFromCameraLngLatAlt(u,g,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(u,g,w,C)}setLocationAtPoint(u,g){const w=Hn(this.unprojectScreenPoint(g)),C=Hn(u),L=o.bz();o.bL(L);const z=o.bz();o.bI(z,w,L,-this.center.lng*Math.PI/180),o.bH(z,z,L,this.center.lat*Math.PI/180);const Y=C[0]*C[0]+C[2]*C[2],re=z[0]*z[0];if(Y<re)return;const le=Math.sqrt(Y-re),fe=-le,Ie=o.bM(C[0],C[2],z[0],le),Te=o.bM(C[0],C[2],z[0],fe),Ue=o.bz();o.bI(Ue,C,L,-Ie);const Ze=o.bM(Ue[1],Ue[2],z[1],z[2]),ft=o.bz();o.bI(ft,C,L,-Te);const pt=o.bM(ft[1],ft[2],z[1],z[2]),dt=.5*Math.PI,xt=Ze>=-dt&&Ze<=dt,Ot=pt>=-dt&&pt<=dt;let wt,Nt;if(xt&&Ot){const Sr=this.center.lng*Math.PI/180,dr=this.center.lat*Math.PI/180;o.bN(Ie,Sr)+o.bN(Ze,dr)<o.bN(Te,Sr)+o.bN(pt,dr)?(wt=Ie,Nt=Ze):(wt=Te,Nt=pt)}else if(xt)wt=Ie,Nt=Ze;else{if(!Ot)return;wt=Te,Nt=pt}const jt=wt/Math.PI*180,Dt=Nt/Math.PI*180,Yt=this.center.lat;this.setCenter(new o.V(jt,o.an(Dt,-90,90))),this.setZoom(this.zoom+Si(Yt,this.center.lat))}locationToScreenPoint(u,g){const w=Hn(u);if(g){const C=g.getElevationForLngLatZoom(u,this._helper._tileZoom);o.a$(w,w,1+C/o.bE)}return this._projectSurfacePointToScreen(w)}_projectSurfacePointToScreen(u){const g=o.bF();return o.aH(g,[...u,1],this._globeViewProjMatrixNoCorrection),g[0]/=g[3],g[1]/=g[3],new o.P((.5*g[0]+.5)*this.width,(.5*-g[1]+.5)*this.height)}screenPointToMercatorCoordinate(u,g){if(g){const w=g.pointCoordinate(u);if(w)return w}return o.a9.fromLngLat(this.unprojectScreenPoint(u))}screenPointToLocation(u,g){var w;return(w=this.screenPointToMercatorCoordinate(u,g))===null||w===void 0?void 0:w.toLngLat()}isPointOnMapSurface(u,g){const w=this._cameraPosition,C=this.getRayDirectionFromPixel(u);return!!this.rayPlanetIntersection(w,C)}getRayDirectionFromPixel(u){const g=o.bF();g[0]=u.x/this.width*2-1,g[1]=-1*(u.y/this.height*2-1),g[2]=1,g[3]=1,o.aH(g,g,this._globeViewProjMatrixNoCorrectionInverted),g[0]/=g[3],g[1]/=g[3],g[2]/=g[3];const w=o.bz();w[0]=g[0]-this._cameraPosition[0],w[1]=g[1]-this._cameraPosition[1],w[2]=g[2]-this._cameraPosition[2];const C=o.bz();return o.b3(C,w),C}isSurfacePointVisible(u){const g=this._cachedClippingPlane;return g[0]*u[0]+g[1]*u[1]+g[2]*u[2]+g[3]>=0}isSurfacePointOnScreen(u){if(!this.isSurfacePointVisible(u))return!1;const g=o.bF();return o.aH(g,[...u,1],this._globeViewProjMatrixNoCorrection),g[0]/=g[3],g[1]/=g[3],g[2]/=g[3],g[0]>-1&&g[0]<1&&g[1]>-1&&g[1]<1&&g[2]>-1&&g[2]<1}rayPlanetIntersection(u,g){const w=o.b5(u,g),C=o.bz(),L=o.bz();o.a$(L,g,w),o.b2(C,u,L);const z=1-o.b5(C,C);if(z<0)return null;const Y=o.b5(u,u)-1,re=-w+(w<0?1:-1)*Math.sqrt(z),le=Y/re,fe=re;return{tMin:Math.min(le,fe),tMax:Math.max(le,fe)}}unprojectScreenPoint(u){const g=this._cameraPosition,w=this.getRayDirectionFromPixel(u),C=this.rayPlanetIntersection(g,w);if(C){const fe=o.bz();o.b0(fe,g,[w[0]*C.tMin,w[1]*C.tMin,w[2]*C.tMin]);const Ie=o.bz();return o.b3(Ie,fe),Xi(Ie)}const L=this._cachedClippingPlane,z=L[0]*w[0]+L[1]*w[1]+L[2]*w[2],Y=-o.bb(L,g)/z,re=o.bz();if(Y>0)o.b0(re,g,[w[0]*Y,w[1]*Y,w[2]*Y]);else{const fe=o.bz();o.b0(fe,g,[2*w[0],2*w[1],2*w[2]]);const Ie=o.bb(this._cachedClippingPlane,fe);o.b2(re,fe,[this._cachedClippingPlane[0]*Ie,this._cachedClippingPlane[1]*Ie,this._cachedClippingPlane[2]*Ie])}const le=(function(fe){const Ie=o.bz();return Ie[0]=fe[0]*-fe[3],Ie[1]=fe[1]*-fe[3],Ie[2]=fe[2]*-fe[3],{center:Ie,radius:Math.sqrt(1-fe[3]*fe[3])}})(L);return Xi((function(fe,Ie,Te){const Ue=o.bz();o.b2(Ue,Te,fe);const Ze=o.bz();return o.bA(Ze,fe,Ue,Ie/o.b9(Ue)),Ze})(le.center,le.radius,re))}getMatrixForModel(u,g){const w=o.V.convert(u),C=1/o.bE,L=o.bj();return o.bJ(L,L,w.lng/180*Math.PI),o.bh(L,L,-w.lat/180*Math.PI),o.O(L,L,[0,0,1+g/o.bE]),o.bh(L,L,.5*Math.PI),o.Q(L,L,[C,C,C]),L}getProjectionDataForCustomLayer(u=!0){const g=this.getProjectionData({overscaledTileID:new o.a2(0,0,0,0,0),applyGlobeMatrix:u});return g.tileMercatorCoords=[0,0,1,1],g}getFastPathSimpleProjectionMatrix(u){}}class gs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(u){this._helper.setMinZoom(u)}setMaxZoom(u){this._helper.setMaxZoom(u)}setMinPitch(u){this._helper.setMinPitch(u)}setMaxPitch(u){this._helper.setMaxPitch(u)}setRenderWorldCopies(u){this._helper.setRenderWorldCopies(u)}setBearing(u){this._helper.setBearing(u)}setPitch(u){this._helper.setPitch(u)}setRoll(u){this._helper.setRoll(u)}setFov(u){this._helper.setFov(u)}setZoom(u){this._helper.setZoom(u)}setCenter(u){this._helper.setCenter(u)}setElevation(u){this._helper.setElevation(u)}setMinElevationForCurrentTile(u){this._helper.setMinElevationForCurrentTile(u)}setPadding(u){this._helper.setPadding(u)}interpolatePadding(u,g,w){return this._helper.interpolatePadding(u,g,w)}isPaddingEqual(u){return this._helper.isPaddingEqual(u)}resize(u,g,w=!0){this._helper.resize(u,g,w)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(u){this._helper.setMaxBounds(u)}setConstrainOverride(u){this._helper.setConstrainOverride(u)}overrideNearFarZ(u,g){this._helper.overrideNearFarZ(u,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(u){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),u)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(u,g){this._globeness=u,this._globeLatitudeErrorCorrectionRadians=g,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(u){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(g,w)=>this.currentTransform.defaultConstrain(g,w),this.applyConstrain=(g,w)=>this._helper.applyConstrain(g,w),this._helper=new Cs({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(g,w)=>this.defaultConstrain(g,w)},u),this._globeness=1,this._mercatorTransform=new $s,this._verticalPerspectiveTransform=new Il}clone(){const u=new gs;return u._globeness=this._globeness,u._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,u.apply(this,!1),u}apply(u,g){this._helper.apply(u,g),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(u){const g=this._mercatorTransform.getProjectionData(u),w=this._verticalPerspectiveTransform.getProjectionData(u);return{mainMatrix:this.isGlobeRendering?w.mainMatrix:g.mainMatrix,clippingPlane:w.clippingPlane,tileMercatorCoords:w.tileMercatorCoords,projectionTransition:u.applyGlobeMatrix?this._globeness:0,fallbackMatrix:g.fallbackMatrix}}isLocationOccluded(u){return this.currentTransform.isLocationOccluded(u)}transformLightDirection(u){return this.currentTransform.transformLightDirection(u)}getPixelScale(){return o.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(u,g,w){const C=this._mercatorTransform.getPitchedTextCorrection(u,g,w),L=this._verticalPerspectiveTransform.getPitchedTextCorrection(u,g,w);return o.bu(C,L,this._globeness)}projectTileCoordinates(u,g,w,C){return this.currentTransform.projectTileCoordinates(u,g,w,C)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(u){return this.currentTransform.calculateFogMatrix(u)}getVisibleUnwrappedCoordinates(u){return this.currentTransform.getVisibleUnwrappedCoordinates(u)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(u){this._mercatorTransform.recalculateZoomAndCenter(u),this._verticalPerspectiveTransform.recalculateZoomAndCenter(u)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(u,g){return this.currentTransform.lngLatToCameraDepth(u,g)}populateCache(u){this._mercatorTransform.populateCache(u),this._verticalPerspectiveTransform.populateCache(u)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(u,g,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(u,g,w,C)}setLocationAtPoint(u,g){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(u,g),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(u,g),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(u,g){return this.currentTransform.locationToScreenPoint(u,g)}screenPointToMercatorCoordinate(u,g){return this.currentTransform.screenPointToMercatorCoordinate(u,g)}screenPointToLocation(u,g){return this.currentTransform.screenPointToLocation(u,g)}isPointOnMapSurface(u,g){return this.currentTransform.isPointOnMapSurface(u,g)}getRayDirectionFromPixel(u){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(u)}getMatrixForModel(u,g){return this.currentTransform.getMatrixForModel(u,g)}getProjectionDataForCustomLayer(u=!0){const g=this._mercatorTransform.getProjectionDataForCustomLayer(u);if(!this.isGlobeRendering)return g;const w=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(u);return w.fallbackMatrix=g.mainMatrix,w}getFastPathSimpleProjectionMatrix(u){return this.currentTransform.getFastPathSimpleProjectionMatrix(u)}}class Di{get useGlobeControls(){return!0}handlePanInertia(u,g){const w=Ia(u,g);return Math.abs(w.lng-g.center.lng)>180&&(w.lng=g.center.lng+179.5*Math.sign(w.lng-g.center.lng)),{easingCenter:w,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(u,g){const w=u.around,C=g.screenPointToLocation(w);u.bearingDelta&&g.setBearing(g.bearing+u.bearingDelta),u.pitchDelta&&g.setPitch(g.pitch+u.pitchDelta),u.rollDelta&&g.setRoll(g.roll+u.rollDelta);const L=g.zoom;u.zoomDelta&&g.setZoom(g.zoom+u.zoomDelta);const z=g.zoom-L;if(z===0)return;const Y=o.bK(g.center.lng,C.lng),re=Y/(Math.abs(Y/180)+1),le=o.bK(g.center.lat,C.lat),fe=g.getRayDirectionFromPixel(w),Ie=g.cameraPosition,Te=-1*o.b5(Ie,fe),Ue=o.bz();o.b0(Ue,Ie,[fe[0]*Te,fe[1]*Te,fe[2]*Te]);const Ze=o.b7(Ue)-1,ft=Math.exp(.5*-Math.max(Ze-.3,0)),pt=Ui(g.worldSize,g.center.lat)/Math.min(g.width,g.height),dt=o.bx(pt,.9,.5,1,.25),xt=(1-o.aq(-z))*Math.min(ft,dt),Ot=g.center.lat,wt=g.zoom,Nt=new o.V(g.center.lng+re*xt,o.an(g.center.lat+le*xt,-o.ao,o.ao));g.setLocationAtPoint(C,w);const jt=g.center,Dt=o.bx(Math.abs(Y),45,85,0,1),Yt=o.bx(pt,.75,.35,0,1),Sr=Math.pow(Math.max(Dt,Yt),.25),dr=o.bK(jt.lng,Nt.lng),yr=o.bK(jt.lat,Nt.lat);g.setCenter(new o.V(jt.lng+dr*Sr,jt.lat+yr*Sr).wrap()),g.setZoom(wt+Si(Ot,g.center.lat))}handleMapControlsPan(u,g,w){if(!u.panDelta)return;const C=g.center.lat,L=g.zoom;g.setCenter(Ia(u.panDelta,g).wrap()),g.setZoom(L+Si(C,g.center.lat))}cameraForBoxAndBearing(u,g,w,C,L){const z=Mu(u,g,w,C,L),Y=g.left/L.width*2-1,re=(L.width-g.right)/L.width*2-1,le=g.top/L.height*-2+1,fe=(L.height-g.bottom)/L.height*-2+1,Ie=o.bK(w.getWest(),w.getEast())<0,Te=Ie?w.getEast():w.getWest(),Ue=Ie?w.getWest():w.getEast(),Ze=Math.max(w.getNorth(),w.getSouth()),ft=Math.min(w.getNorth(),w.getSouth()),pt=Te+.5*o.bK(Te,Ue),dt=Ze+.5*o.bK(Ze,ft),xt=L.clone();xt.setCenter(z.center),xt.setBearing(z.bearing),xt.setPitch(0),xt.setRoll(0),xt.setZoom(z.zoom);const Ot=xt.modelViewProjectionMatrix,wt=[Hn(w.getNorthWest()),Hn(w.getNorthEast()),Hn(w.getSouthWest()),Hn(w.getSouthEast()),Hn(new o.V(Ue,dt)),Hn(new o.V(Te,dt)),Hn(new o.V(pt,Ze)),Hn(new o.V(pt,ft))],Nt=Hn(z.center);let jt=Number.POSITIVE_INFINITY;for(const Dt of wt)Y<0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Nt,Ot,"x",Y))),re>0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Nt,Ot,"x",re))),le>0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Nt,Ot,"y",le))),fe<0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Nt,Ot,"y",fe)));if(Number.isFinite(jt)&&jt!==0)return z.zoom=xt.zoom+o.at(jt),z;Vo()}handleJumpToCenterZoom(u,g){const w=u.center.lat,C=u.applyConstrain(g.center?o.V.convert(g.center):u.center,u.zoom).center;u.setCenter(C.wrap());const L=g.zoom!==void 0?+g.zoom:u.zoom+Si(w,C.lat);u.zoom!==L&&u.setZoom(L)}handleEaseTo(u,g){const w=u.zoom,C=u.center,L=u.padding,z={roll:u.roll,pitch:u.pitch,bearing:u.bearing},Y={roll:g.roll===void 0?u.roll:g.roll,pitch:g.pitch===void 0?u.pitch:g.pitch,bearing:g.bearing===void 0?u.bearing:g.bearing},re=g.zoom!==void 0,le=!u.isPaddingEqual(g.padding);let fe=!1;const Ie=g.center?o.V.convert(g.center):C,Te=u.applyConstrain(Ie,w).center;Vs(u,Te);const Ue=u.clone();Ue.setCenter(Te),Ue.setZoom(re?+g.zoom:w+Si(C.lat,Ie.lat)),Ue.setBearing(g.bearing);const Ze=new o.P(o.an(u.centerPoint.x+g.offsetAsPoint.x,0,u.width),o.an(u.centerPoint.y+g.offsetAsPoint.y,0,u.height));Ue.setLocationAtPoint(Te,Ze);const ft=(g.offset&&g.offsetAsPoint.mag())>0?Ue.center:Te,pt=re?+g.zoom:w+Si(C.lat,ft.lat),dt=w+Si(C.lat,0),xt=pt+Si(ft.lat,0),Ot=o.bK(C.lng,ft.lng),wt=o.bK(C.lat,ft.lat),Nt=o.aq(xt-dt);return fe=pt!==w,{easeFunc:jt=>{if(o.bo(z,Y)||Ru({startEulerAngles:z,endEulerAngles:Y,tr:u,k:jt,useSlerp:z.roll!=Y.roll}),le&&u.interpolatePadding(L,g.padding,jt),g.around)o.w("Easing around a point is not supported under globe projection."),u.setLocationAtPoint(g.around,g.aroundPoint);else{const Dt=xt>dt?Math.min(2,Nt):Math.max(.5,Nt),Yt=Math.pow(Dt,1-jt),Sr=Hs(C,Ot,wt,jt*Yt);u.setCenter(Sr.wrap())}if(fe){const Dt=o.G.number(dt,xt,jt)+Si(0,u.center.lat);u.setZoom(Dt)}},isZooming:fe,elevationCenter:ft}}handleFlyTo(u,g){const w=g.zoom!==void 0,C=u.center,L=u.zoom,z=u.padding,Y=!u.isPaddingEqual(g.padding),re=u.applyConstrain(o.V.convert(g.center||g.locationAtOffset),L).center,le=w?+g.zoom:u.zoom+Si(u.center.lat,re.lat),fe=u.clone();fe.setCenter(re),fe.setZoom(le),fe.setBearing(g.bearing);const Ie=new o.P(o.an(u.centerPoint.x+g.offsetAsPoint.x,0,u.width),o.an(u.centerPoint.y+g.offsetAsPoint.y,0,u.height));fe.setLocationAtPoint(re,Ie);const Te=fe.center;Vs(u,Te);const Ue=(function(wt,Nt,jt){const Dt=Hn(Nt),Yt=Hn(jt),Sr=o.b5(Dt,Yt),dr=Math.acos(Sr),yr=Un(wt);return dr/(2*Math.PI)*yr})(u,C,Te),Ze=L+Si(C.lat,0),ft=le+Si(Te.lat,0),pt=o.aq(ft-Ze);let dt;if(typeof g.minZoom=="number"){const wt=+g.minZoom+Si(Te.lat,0),Nt=Math.min(wt,Ze,ft)+Si(0,Te.lat),jt=u.applyConstrain(Te,Nt).zoom+Si(Te.lat,0);dt=o.aq(jt-Ze)}const xt=o.bK(C.lng,Te.lng),Ot=o.bK(C.lat,Te.lat);return{easeFunc:(wt,Nt,jt,Dt)=>{const Yt=Hs(C,xt,Ot,jt);Y&&u.interpolatePadding(z,g.padding,wt);const Sr=wt===1?Te:Yt;u.setCenter(Sr.wrap());const dr=Ze+o.at(Nt);u.setZoom(wt===1?le:dr+Si(0,Sr.lat))},scaleOfZoom:pt,targetCenter:Te,scaleOfMinZoom:dt,pixelPathLength:Ue}}static solveVectorScale(u,g,w,C,L){const z=C==="x"?[w[0],w[4],w[8],w[12]]:[w[1],w[5],w[9],w[13]],Y=[w[3],w[7],w[11],w[15]],re=u[0]*z[0]+u[1]*z[1]+u[2]*z[2],le=u[0]*Y[0]+u[1]*Y[1]+u[2]*Y[2],fe=g[0]*z[0]+g[1]*z[1]+g[2]*z[2],Ie=g[0]*Y[0]+g[1]*Y[1]+g[2]*Y[2];return fe+L*le===re+L*Ie||Y[3]*(re-fe)+z[3]*(Ie-le)+re*Ie==fe*le?null:(fe+z[3]-L*Ie-L*Y[3])/(fe-re-L*Ie+L*le)}static getLesserNonNegativeNonNull(u,g){return g!==null&&g>=0&&g<u?g:u}}class qo{constructor(u){this._globe=u,this._mercatorCameraHelper=new go,this._verticalPerspectiveCameraHelper=new Di}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(u,g){return this.currentHelper.handlePanInertia(u,g)}handleMapControlsRollPitchBearingZoom(u,g){return this.currentHelper.handleMapControlsRollPitchBearingZoom(u,g)}handleMapControlsPan(u,g,w){this.currentHelper.handleMapControlsPan(u,g,w)}cameraForBoxAndBearing(u,g,w,C,L){return this.currentHelper.cameraForBoxAndBearing(u,g,w,C,L)}handleJumpToCenterZoom(u,g){this.currentHelper.handleJumpToCenterZoom(u,g)}handleEaseTo(u,g){return this.currentHelper.handleEaseTo(u,g)}handleFlyTo(u,g){return this.currentHelper.handleFlyTo(u,g)}}const Da=(D,u)=>o.B(D,u&&u.filter((g=>g.identifier!=="source.canvas"))),ns=o.bO();class As extends o.E{constructor(u,g={}){var w,C;super(),this._rtlPluginLoaded=()=>{for(const z in this.tileManagers){const Y=this.tileManagers[z].getSource().type;Y!=="vector"&&Y!=="geojson"||this.tileManagers[z].reload()}},this.map=u,this.dispatcher=new Qe(ot(),u._getMapId()),this.dispatcher.registerMessageHandler("GG",((z,Y)=>this.getGlyphs(z,Y))),this.dispatcher.registerMessageHandler("GI",((z,Y)=>this.getImages(z,Y))),this.dispatcher.registerMessageHandler("GDA",((z,Y)=>this.getDashes(z,Y))),this.imageManager=new W,this.imageManager.setEventedParent(this);const L=((w=u._container)===null||w===void 0?void 0:w.lang)||typeof document<"u"&&((C=document.documentElement)===null||C===void 0?void 0:C.lang)||void 0;this.glyphManager=new Ce(u._requestManager,g.localIdeographFontFamily,L),this.lineAtlas=new Ee(256,512),this.crossTileSymbolIndex=new _n,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",o.bP()),Et().on(qe,this._rtlPluginLoaded),this.on("data",(z=>{if(z.dataType!=="source"||z.sourceDataType!=="metadata")return;const Y=this.tileManagers[z.sourceId];if(!Y)return;const re=Y.getSource();if(re&&re.vectorLayerIds)for(const le in this._layers){const fe=this._layers[le];fe.source===re.id&&this._validateLayer(fe)}}))}_setInitialValues(){var u;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new o.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((u=this.crossTileSymbolIndex)===null||u===void 0?void 0:u.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(u,g){var w,C,L;this._checkLoaded();const z=g===null?(L=(C=(w=this.stylesheet.state)===null||w===void 0?void 0:w[u])===null||C===void 0?void 0:C.default)!==null&&L!==void 0?L:null:g;if(o.bR(z,this._globalState[u]))return this;this._globalState[u]=z,this._applyGlobalStateChanges([u])}getGlobalState(){return this._globalState}setGlobalState(u){this._checkLoaded();const g=[];for(const w in u)!o.bR(this._globalState[w],u[w].default)&&(g.push(w),this._globalState[w]=u[w].default);this._applyGlobalStateChanges(g)}_applyGlobalStateChanges(u){if(u.length===0)return;const g=new Set,w={};for(const C of u){w[C]=this._globalState[C];for(const L in this._layers){const z=this._layers[L],Y=z.getLayoutAffectingGlobalStateRefs(),re=z.getPaintAffectingGlobalStateRefs(),le=z.getVisibilityAffectingGlobalStateRefs();if(Y.has(C)&&g.add(z.source),re.has(C))for(const{name:fe,value:Ie}of re.get(C))this._updatePaintProperty(z,fe,Ie);le?.has(C)&&(z.recalculateVisibility(),this._updateLayer(z))}}this.dispatcher.broadcast("UGS",w);for(const C in this.tileManagers)g.has(C)&&(this._reloadSource(C),this._changed=!0)}loadURL(u,g={},w){this.fire(new o.l("dataloading",{dataType:"style"})),g.validate=typeof g.validate!="boolean"||g.validate;const C=this.map._requestManager.transformRequest(u,"Style");this._loadStyleRequest=new AbortController;const L=this._loadStyleRequest;o.j(C,this._loadStyleRequest).then((z=>{this._loadStyleRequest=null,this._load(z.data,g,w)})).catch((z=>{this._loadStyleRequest=null,z&&!L.signal.aborted&&this.fire(new o.k(z))}))}loadJSON(u,g={},w){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,x.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,g.validate=g.validate!==!1,this._load(u,g,w)})).catch((()=>{}))}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(ns,{validate:!1})}_load(u,g,w){var C,L;let z=g.transformStyle?g.transformStyle(w,u):u;if(!g.validate||!Da(this,o.C(z))){z=Object.assign({},z),this._loaded=!0,this.stylesheet=z;for(const Y in z.sources)this.addSource(Y,z.sources[Y],{validate:!1});z.sprite?this._loadSprite(z.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(z.glyphs),this._createLayers(),this.light=new Ae(this.stylesheet.light),this._setProjectionInternal(((C=this.stylesheet.projection)===null||C===void 0?void 0:C.type)||"mercator"),this.sky=new de(this.stylesheet.sky),this.map.setTerrain((L=this.stylesheet.terrain)!==null&&L!==void 0?L:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){var u,g,w;const C=o.bS(this.stylesheet.layers);this.setGlobalState((u=this.stylesheet.state)!==null&&u!==void 0?u:null),this.dispatcher.broadcast("SL",C),this._order=C.map((L=>L.id)),this._layers={},this._serializedLayers=null;for(const L of C){const z=o.bT(L,this._globalState);if(z.setEventedParent(this,{layer:{id:L.id}}),this._layers[L.id]=z,o.bU(z)&&this.tileManagers[z.source]){const Y=(w=(g=L.paint)===null||g===void 0?void 0:g["raster-fade-duration"])!==null&&w!==void 0?w:z.paint.get("raster-fade-duration");this.tileManagers[z.source].setRasterFadeDuration(Y)}}}_loadSprite(u,g=!1,w=void 0){this.imageManager.setLoaded(!1);const C=new AbortController;let L;this._spriteRequest=C,(function(z,Y,re,le){return o._(this,void 0,void 0,(function*(){const fe=X(z),Ie=re>1?"@2x":"",Te={},Ue={};for(const{id:Ze,url:ft}of fe){const pt=Y.transformRequest(ae(ft,Ie,".json"),"SpriteJSON");Te[Ze]=o.j(pt,le);const dt=Y.transformRequest(ae(ft,Ie,".png"),"SpriteImage");Ue[Ze]=H.getImage(dt,le)}return yield Promise.all([...Object.values(Te),...Object.values(Ue)]),(function(Ze,ft){return o._(this,void 0,void 0,(function*(){const pt={};for(const dt in Ze){pt[dt]={};const xt=x.getImageCanvasContext((yield ft[dt]).data),Ot=(yield Ze[dt]).data;for(const wt in Ot){const{width:Nt,height:jt,x:Dt,y:Yt,sdf:Sr,pixelRatio:dr,stretchX:yr,stretchY:xr,content:an,textFitWidth:ln,textFitHeight:Hr}=Ot[wt];pt[dt][wt]={data:null,pixelRatio:dr,sdf:Sr,stretchX:yr,stretchY:xr,content:an,textFitWidth:ln,textFitHeight:Hr,spriteData:{width:Nt,height:jt,x:Dt,y:Yt,context:xt}}}}return pt}))})(Te,Ue)}))})(u,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((z=>{if(this._spriteRequest=null,z)for(const Y in z){this._spritesImagesIds[Y]=[];const re=this._spritesImagesIds[Y]?this._spritesImagesIds[Y].filter((le=>!(le in z))):[];for(const le of re)this.imageManager.removeImage(le),this._changedImages[le]=!0;for(const le in z[Y]){const fe=Y==="default"?le:`${Y}:${le}`;this._spritesImagesIds[Y].push(fe),fe in this.imageManager.images?this.imageManager.updateImage(fe,z[Y][le],!1):this.imageManager.addImage(fe,z[Y][le]),g&&(this._changedImages[fe]=!0)}}})).catch((z=>{this._spriteRequest=null,L=z,C.signal.aborted||this.fire(new o.k(L))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),g&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),w&&w(L)}))}_unloadSprite(){for(const u of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(u),this._changedImages[u]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(u){const g=this.tileManagers[u.source];if(!g)return;const w=u.sourceLayer;if(!w)return;const C=g.getSource();(C.type==="geojson"||C.vectorLayerIds&&C.vectorLayerIds.indexOf(w)===-1)&&this.fire(new o.k(new Error(`Source layer "${w}" does not exist on source "${C.id}" as specified by style layer "${u.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const u in this.tileManagers)if(!this.tileManagers[u].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(u,g=!1){const w=this._serializedAllLayers();if(!u||u.length===0)return Object.values(g?o.bV(w):w);const C=[];for(const L of u)if(w[L]){const z=g?o.bV(w[L]):w[L];C.push(z)}return C}_serializedAllLayers(){let u=this._serializedLayers;if(u)return u;u=this._serializedLayers={};const g=Object.keys(this._layers);for(const w of g){const C=this._layers[w];C.type!=="custom"&&(u[w]=C.serialize())}return u}hasTransitions(){var u,g,w;if(!((u=this.light)===null||u===void 0)&&u.hasTransition()||!((g=this.sky)===null||g===void 0)&&g.hasTransition()||!((w=this.projection)===null||w===void 0)&&w.hasTransition())return!0;for(const C in this.tileManagers)if(this.tileManagers[C].hasTransition())return!0;for(const C in this._layers)if(this._layers[C].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(u){if(!this._loaded)return;const g=this._changed;if(g){const C=Object.keys(this._updatedLayers),L=Object.keys(this._removedLayers);(C.length||L.length)&&this._updateWorkerLayers(C,L);for(const z in this._updatedSources){const Y=this._updatedSources[z];if(Y==="reload")this._reloadSource(z);else{if(Y!=="clear")throw new Error(`Invalid action ${Y}`);this._clearSource(z)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const z in this._updatedPaintProps)this._layers[z].updateTransitions(u);this.light.updateTransitions(u),this.sky.updateTransitions(u),this._resetUpdates()}const w={};for(const C in this.tileManagers){const L=this.tileManagers[C];w[C]=L.used,L.used=!1}for(const C of this._order){const L=this._layers[C];L.recalculate(u,this._availableImages),!L.isHidden(u.zoom)&&L.source&&(this.tileManagers[L.source].used=!0)}for(const C in w){const L=this.tileManagers[C];!!w[C]!=!!L.used&&L.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:C}))}this.light.recalculate(u),this.sky.recalculate(u),this.projection.recalculate(u),this.z=u.zoom,g&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const u=Object.keys(this._changedImages);if(u.length){for(const g in this.tileManagers)this.tileManagers[g].reloadTilesForDependencies(["icons","patterns"],u);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const u in this.tileManagers)this.tileManagers[u].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(u,g){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(u,!1),removedIds:g})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(u,g={}){var w;this._checkLoaded();const C=this.serialize();if(u=g.transformStyle?g.transformStyle(C,u):u,((w=g.validate)===null||w===void 0||w)&&Da(this,o.C(u)))return!1;(u=o.bV(u)).layers=o.bS(u.layers);const L=o.bW(C,u),z=this._getOperationsToPerform(L);if(z.unimplemented.length>0)throw new Error(`Unimplemented: ${z.unimplemented.join(", ")}.`);if(z.operations.length===0)return!1;for(const Y of z.operations)Y();return this.stylesheet=u,this._serializedLayers=null,this.fire(new o.l("style.load",{style:this})),!0}_getOperationsToPerform(u){const g=[],w=[];for(const C of u)switch(C.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":g.push((()=>this.addLayer.apply(this,C.args)));break;case"removeLayer":g.push((()=>this.removeLayer.apply(this,C.args)));break;case"setPaintProperty":g.push((()=>this.setPaintProperty.apply(this,C.args)));break;case"setLayoutProperty":g.push((()=>this.setLayoutProperty.apply(this,C.args)));break;case"setFilter":g.push((()=>this.setFilter.apply(this,C.args)));break;case"addSource":g.push((()=>this.addSource.apply(this,C.args)));break;case"removeSource":g.push((()=>this.removeSource.apply(this,C.args)));break;case"setLayerZoomRange":g.push((()=>this.setLayerZoomRange.apply(this,C.args)));break;case"setLight":g.push((()=>this.setLight.apply(this,C.args)));break;case"setGeoJSONSourceData":g.push((()=>this.setGeoJSONSourceData.apply(this,C.args)));break;case"setGlyphs":g.push((()=>this.setGlyphs.apply(this,C.args)));break;case"setSprite":g.push((()=>this.setSprite.apply(this,C.args)));break;case"setTerrain":g.push((()=>this.map.setTerrain.apply(this,C.args)));break;case"setSky":g.push((()=>this.setSky.apply(this,C.args)));break;case"setProjection":this.setProjection.apply(this,C.args);break;case"setGlobalState":g.push((()=>this.setGlobalState.apply(this,C.args)));break;case"setTransition":g.push((()=>{}));break;default:w.push(C.command)}return{operations:g,unimplemented:w}}addImage(u,g){if(this.getImage(u))return this.fire(new o.k(new Error(`An image named "${u}" already exists.`)));this.imageManager.addImage(u,g),this._afterImageUpdated(u)}updateImage(u,g){this.imageManager.updateImage(u,g)}getImage(u){return this.imageManager.getImage(u)}removeImage(u){if(!this.getImage(u))return this.fire(new o.k(new Error(`An image named "${u}" does not exist.`)));this.imageManager.removeImage(u),this._afterImageUpdated(u)}_afterImageUpdated(u){this._availableImages=this.imageManager.listImages(),this._changedImages[u]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(u,g,w={}){if(this._checkLoaded(),this.tileManagers[u]!==void 0)throw new Error(`Source "${u}" already exists.`);if(!g.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(g).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(o.C.source,`sources.${u}`,g,null,w))return;this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);const C=this.tileManagers[u]=new Ci(u,g,this.dispatcher);C.style=this,C.setEventedParent(this,(()=>({isSourceLoaded:C.loaded(),source:C.serialize(),sourceId:u}))),C.onAdd(this.map),this._changed=!0}removeSource(u){if(this._checkLoaded(),this.tileManagers[u]===void 0)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===u)return this.fire(new o.k(new Error(`Source "${u}" cannot be removed while layer "${w}" is using it.`)));const g=this.tileManagers[u];delete this.tileManagers[u],delete this._updatedSources[u],g.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:u})),g.setEventedParent(null),g.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(u,g){if(this._checkLoaded(),this.tileManagers[u]===void 0)throw new Error(`There is no source with this ID=${u}`);const w=this.tileManagers[u].getSource();if(w.type!=="geojson")throw new Error(`geojsonSource.type is ${w.type}, which is !== 'geojson`);w.setData(g),this._changed=!0}getSource(u){return this.tileManagers[u]&&this.tileManagers[u].getSource()}addLayer(u,g,w={}){this._checkLoaded();const C=u.id;if(this.getLayer(C))return void this.fire(new o.k(new Error(`Layer "${C}" already exists on this map.`)));let L;if(u.type==="custom"){if(Da(this,o.bX(u)))return;L=o.bT(u,this._globalState)}else{if("source"in u&&typeof u.source=="object"&&(this.addSource(C,u.source),u=o.bV(u),u=o.e(u,{source:C})),this._validate(o.C.layer,`layers.${C}`,u,{arrayIndex:-1},w))return;L=o.bT(u,this._globalState),this._validateLayer(L),L.setEventedParent(this,{layer:{id:C}})}const z=g?this._order.indexOf(g):this._order.length;if(g&&z===-1)this.fire(new o.k(new Error(`Cannot add layer "${C}" before non-existing layer "${g}".`)));else{if(this._order.splice(z,0,C),this._layerOrderChanged=!0,this._layers[C]=L,this._removedLayers[C]&&L.source&&L.type!=="custom"){const Y=this._removedLayers[C];delete this._removedLayers[C],Y.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",this.tileManagers[L.source].pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map)}}moveLayer(u,g){if(this._checkLoaded(),this._changed=!0,!this._layers[u])return void this.fire(new o.k(new Error(`The layer '${u}' does not exist in the map's style and cannot be moved.`)));if(u===g)return;const w=this._order.indexOf(u);this._order.splice(w,1);const C=g?this._order.indexOf(g):this._order.length;g&&C===-1?this.fire(new o.k(new Error(`Cannot move layer "${u}" before non-existing layer "${g}".`))):(this._order.splice(C,0,u),this._layerOrderChanged=!0)}removeLayer(u){this._checkLoaded();const g=this._layers[u];if(!g)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${u}".`)));g.setEventedParent(null);const w=this._order.indexOf(u);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[u]=g,delete this._layers[u],this._serializedLayers&&delete this._serializedLayers[u],delete this._updatedLayers[u],delete this._updatedPaintProps[u],g.onRemove&&g.onRemove(this.map)}getLayer(u){return this._layers[u]}getLayersOrder(){return[...this._order]}hasLayer(u){return u in this._layers}setLayerZoomRange(u,g,w){this._checkLoaded();const C=this.getLayer(u);C?C.minzoom===g&&C.maxzoom===w||(g!=null&&(C.minzoom=g),w!=null&&(C.maxzoom=w),this._updateLayer(C)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${u}".`)))}setFilter(u,g,w={}){this._checkLoaded();const C=this.getLayer(u);if(C){if(!o.bR(C.filter,g))return g==null?(C.setFilter(void 0),void this._updateLayer(C)):void(this._validate(o.C.filter,`layers.${C.id}.filter`,g,null,w)||(C.setFilter(o.bV(g)),this._updateLayer(C)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${u}".`)))}getFilter(u){return o.bV(this.getLayer(u).filter)}setLayoutProperty(u,g,w,C={}){this._checkLoaded();const L=this.getLayer(u);L?o.bR(L.getLayoutProperty(g),w)||(L.setLayoutProperty(g,w,C),this._updateLayer(L)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${u}".`)))}getLayoutProperty(u,g){const w=this.getLayer(u);if(w)return w.getLayoutProperty(g);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${u}".`)))}setPaintProperty(u,g,w,C={}){this._checkLoaded();const L=this.getLayer(u);L?o.bR(L.getPaintProperty(g),w)||this._updatePaintProperty(L,g,w,C):this.fire(new o.k(new Error(`Cannot style non-existing layer "${u}".`)))}_updatePaintProperty(u,g,w,C={}){u.setPaintProperty(g,w,C)&&this._updateLayer(u),o.bU(u)&&g==="raster-fade-duration"&&this.tileManagers[u.source].setRasterFadeDuration(w),this._changed=!0,this._updatedPaintProps[u.id]=!0,this._serializedLayers=null}getPaintProperty(u,g){return this.getLayer(u).getPaintProperty(g)}setFeatureState(u,g){this._checkLoaded();const w=u.source,C=u.sourceLayer,L=this.tileManagers[w];if(L===void 0)return void this.fire(new o.k(new Error(`The source '${w}' does not exist in the map's style.`)));const z=L.getSource().type;z==="geojson"&&C?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):z!=="vector"||C?(u.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),L.setFeatureState(C,u.id,g)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(u,g){this._checkLoaded();const w=u.source,C=this.tileManagers[w];if(C===void 0)return void this.fire(new o.k(new Error(`The source '${w}' does not exist in the map's style.`)));const L=C.getSource().type,z=L==="vector"?u.sourceLayer:void 0;L!=="vector"||z?g&&typeof u.id!="string"&&typeof u.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):C.removeFeatureState(z,u.id,g):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(u){this._checkLoaded();const g=u.source,w=u.sourceLayer,C=this.tileManagers[g];if(C!==void 0)return C.getSource().type!=="vector"||w?(u.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),C.getFeatureState(w,u.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${g}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const u=o.bY(this.tileManagers,(L=>L.serialize())),g=this._serializeByIds(this._order,!0),w=this.map.getTerrain()||void 0,C=this.stylesheet;return o.bZ({version:C.version,name:C.name,metadata:C.metadata,light:C.light,sky:C.sky,center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch,sprite:C.sprite,glyphs:C.glyphs,transition:C.transition,projection:C.projection,sources:u,layers:g,terrain:w},(L=>L!==void 0))}_updateLayer(u){this._updatedLayers[u.id]=!0,u.source&&!this._updatedSources[u.source]&&this.tileManagers[u.source].getSource().type!=="raster"&&(this._updatedSources[u.source]="reload",this.tileManagers[u.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(u){const g=z=>this._layers[z].type==="fill-extrusion",w={},C=[];for(let z=this._order.length-1;z>=0;z--){const Y=this._order[z];if(g(Y)){w[Y]=z;for(const re of u){const le=re[Y];if(le)for(const fe of le)C.push(fe)}}}C.sort(((z,Y)=>Y.intersectionZ-z.intersectionZ));const L=[];for(let z=this._order.length-1;z>=0;z--){const Y=this._order[z];if(g(Y))for(let re=C.length-1;re>=0;re--){const le=C[re].feature;if(w[le.layer.id]<z)break;L.push(le),C.pop()}else for(const re of u){const le=re[Y];if(le)for(const fe of le)L.push(fe.feature)}}return L}queryRenderedFeatures(u,g,w){g&&g.filter&&this._validate(o.C.filter,"queryRenderedFeatures.filter",g.filter,null,g);const C={};if(g&&g.layers){if(!(Array.isArray(g.layers)||g.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const le of g.layers){const fe=this._layers[le];if(!fe)return this.fire(new o.k(new Error(`The layer '${le}' does not exist in the map's style and cannot be queried for features.`))),[];C[fe.source]=!0}}const L=[];g.availableImages=this._availableImages;const z=this._serializedAllLayers(),Y=g.layers instanceof Set?g.layers:Array.isArray(g.layers)?new Set(g.layers):null,re=Object.assign(Object.assign({},g),{layers:Y,globalState:this._globalState});for(const le in this.tileManagers)g.layers&&!C[le]||L.push(zt(this.tileManagers[le],this._layers,z,u,re,w,this.map.terrain?(fe,Ie,Te)=>this.map.terrain.getElevation(fe,Ie,Te):void 0));return this.placement&&L.push((function(le,fe,Ie,Te,Ue,Ze,ft){const pt={},dt=Ze.queryRenderedSymbols(Te),xt=[];for(const Ot of Object.keys(dt).map(Number))xt.push(ft[Ot]);xt.sort(st);for(const Ot of xt){const wt=Ot.featureIndex.lookupSymbolFeatures(dt[Ot.bucketInstanceId],fe,Ot.bucketIndex,Ot.sourceLayerIndex,{filterSpec:Ue.filter,globalState:Ue.globalState},Ue.layers,Ue.availableImages,le);for(const Nt in wt){const jt=pt[Nt]=pt[Nt]||[],Dt=wt[Nt];Dt.sort(((Yt,Sr)=>{const dr=Ot.featureSortOrder;if(dr){const yr=dr.indexOf(Yt.featureIndex);return dr.indexOf(Sr.featureIndex)-yr}return Sr.featureIndex-Yt.featureIndex}));for(const Yt of Dt)jt.push(Yt)}}return(function(Ot,wt,Nt){for(const jt in Ot)for(const Dt of Ot[jt])$e(Dt,Nt[wt[jt].source]);return Ot})(pt,le,Ie)})(this._layers,z,this.tileManagers,u,re,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(L)}querySourceFeatures(u,g){g?.filter&&this._validate(o.C.filter,"querySourceFeatures.filter",g.filter,null,g);const w=this.tileManagers[u];return w?(function(C,L){const z=C.getRenderableIds().map((le=>C.getTileByID(le))),Y=[],re={};for(let le=0;le<z.length;le++){const fe=z[le],Ie=fe.tileID.canonical.key;re[Ie]||(re[Ie]=!0,fe.querySourceFeatures(Y,L))}return Y})(w,g?Object.assign(Object.assign({},g),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(u,g={}){this._checkLoaded();const w=this.light.getLight();let C=!1;for(const z in u)if(!o.bR(u[z],w[z])){C=!0;break}if(!C)return;const L={now:T(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(u,g),this.light.updateTransitions(L)}getProjection(){var u;return(u=this.stylesheet)===null||u===void 0?void 0:u.projection}setProjection(u){if(this._checkLoaded(),this.projection){if(this.projection.name===u.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=u,this._setProjectionInternal(u.type)}getSky(){var u;return(u=this.stylesheet)===null||u===void 0?void 0:u.sky}setSky(u,g={}){this._checkLoaded();const w=this.getSky();let C=!1;if(!u&&!w)return;if(u&&!w)C=!0;else if(!u&&w)C=!0;else for(const z in u)if(!o.bR(u[z],w[z])){C=!0;break}if(!C)return;const L={now:T(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=u,this.sky.setSky(u,g),this.sky.updateTransitions(L)}_setProjectionInternal(u){const g=(function(w,C){const L={constrainOverride:C};if(Array.isArray(w)){const z=new qn({type:w});return{projection:z,transform:new gs(L),cameraHelper:new qo(z)}}switch(w){case"mercator":return{projection:new fi,transform:new $s(L),cameraHelper:new go};case"globe":{const z=new qn({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:z,transform:new gs(L),cameraHelper:new qo(z)}}case"vertical-perspective":return{projection:new Zr,transform:new Il(L),cameraHelper:new Di};default:return o.w(`Unknown projection name: ${w}. Falling back to mercator projection.`),{projection:new fi,transform:new $s(L),cameraHelper:new go}}})(u,this.map.transformConstrain);this.projection=g.projection,this.map.migrateProjection(g.transform,g.cameraHelper);for(const w in this.tileManagers)this.tileManagers[w].reload()}_validate(u,g,w,C,L={}){return(!L||L.validate!==!1)&&Da(this,u.call(o.C,o.e({key:g,style:this.serialize(),value:w,styleSpec:o.u},C)))}_remove(u=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Et().off(qe,this._rtlPluginLoaded);for(const g in this._layers)this._layers[g].setEventedParent(null);for(const g in this.tileManagers){const w=this.tileManagers[g];w.setEventedParent(null),w.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),u&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(u)}_clearSource(u){this.tileManagers[u].clearTiles()}_reloadSource(u){this.tileManagers[u].resume(),this.tileManagers[u].reload()}_updateSources(u){for(const g in this.tileManagers)this.tileManagers[g].update(u,this.map.terrain)}_generateCollisionBoxes(){for(const u in this.tileManagers)this._reloadSource(u)}_updatePlacement(u,g,w,C,L=!1){let z=!1,Y=!1;const re={};for(const le of this._order){const fe=this._layers[le];if(fe.type!=="symbol")continue;if(!re[fe.source]){const Te=this.tileManagers[fe.source];re[fe.source]=Te.getRenderableIds(!0).map((Ue=>Te.getTileByID(Ue))).sort(((Ue,Ze)=>Ze.tileID.overscaledZ-Ue.tileID.overscaledZ||(Ue.tileID.isLessThan(Ze.tileID)?-1:1)))}const Ie=this.crossTileSymbolIndex.addLayer(fe,re[fe.source],u.center.lng);z=z||Ie}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((L=L||this._layerOrderChanged||w===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(T(),u.zoom))&&(this.pauseablePlacement=new on(u,this.map.terrain,this._order,L,g,w,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,re),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(T()),Y=!0),z&&this.pauseablePlacement.placement.setStale()),Y||z)for(const le of this._order){const fe=this._layers[le];fe.type==="symbol"&&this.placement.updateLayerOpacities(fe,re[fe.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(T())}_releaseSymbolFadeTiles(){for(const u in this.tileManagers)this.tileManagers[u].releaseSymbolFadeTiles()}getImages(u,g){return o._(this,void 0,void 0,(function*(){const w=yield this.imageManager.getImages(g.icons);this._updateTilesForChangedImages();const C=this.tileManagers[g.source];return C&&C.setDependencies(g.tileID.key,g.type,g.icons),w}))}getGlyphs(u,g){return o._(this,void 0,void 0,(function*(){const w=yield this.glyphManager.getGlyphs(g.stacks),C=this.tileManagers[g.source];return C&&C.setDependencies(g.tileID.key,g.type,[""]),w}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(u,g={}){this._checkLoaded(),u&&this._validate(o.C.glyphs,"glyphs",u,null,g)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=u,this.glyphManager.entries={},this.glyphManager.setURL(u))}getDashes(u,g){return o._(this,void 0,void 0,(function*(){const w={};for(const[C,L]of Object.entries(g.dashes))w[C]=this.lineAtlas.getDash(L.dasharray,L.round);return w}))}addSprite(u,g,w={},C){this._checkLoaded();const L=[{id:u,url:g}],z=[...X(this.stylesheet.sprite),...L];this._validate(o.C.sprite,"sprite",z,null,w)||(this.stylesheet.sprite=z,this._loadSprite(L,!0,C))}removeSprite(u){this._checkLoaded();const g=X(this.stylesheet.sprite);if(g.find((w=>w.id===u))){if(this._spritesImagesIds[u])for(const w of this._spritesImagesIds[u])this.imageManager.removeImage(w),this._changedImages[w]=!0;g.splice(g.findIndex((w=>w.id===u)),1),this.stylesheet.sprite=g.length>0?g:void 0,delete this._spritesImagesIds[u],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${u}" doesn't exists on this map.`)))}getSprite(){return X(this.stylesheet.sprite)}setSprite(u,g={},w){this._checkLoaded(),u&&this._validate(o.C.sprite,"sprite",u,null,g)||(this.stylesheet.sprite=u,u?this._loadSprite(u,!0,w):(this._unloadSprite(),w&&w(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const u in this.tileManagers){const g=this.tileManagers[u];g.setEventedParent(null),g.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const u in this._layers){const g=this._layers[u];g.setEventedParent(null),g.onRemove&&g.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var Ja=o.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class rc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(u,g,w,C,L,z,Y,re,le){this.context=u;let fe=this.boundPaintVertexBuffers.length!==C.length;for(let Ie=0;!fe&&Ie<C.length;Ie++)this.boundPaintVertexBuffers[Ie]!==C[Ie]&&(fe=!0);!this.vao||this.boundProgram!==g||this.boundLayoutVertexBuffer!==w||fe||this.boundIndexBuffer!==L||this.boundVertexOffset!==z||this.boundDynamicVertexBuffer!==Y||this.boundDynamicVertexBuffer2!==re||this.boundDynamicVertexBuffer3!==le?this.freshBind(g,w,C,L,z,Y,re,le):(u.bindVertexArray.set(this.vao),Y&&Y.bind(),L&&L.dynamicDraw&&L.bind(),re&&re.bind(),le&&le.bind())}freshBind(u,g,w,C,L,z,Y,re){const le=u.numAttributes,fe=this.context,Ie=fe.gl;this.vao&&this.destroy(),this.vao=fe.createVertexArray(),fe.bindVertexArray.set(this.vao),this.boundProgram=u,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=C,this.boundVertexOffset=L,this.boundDynamicVertexBuffer=z,this.boundDynamicVertexBuffer2=Y,this.boundDynamicVertexBuffer3=re,g.enableAttributes(Ie,u);for(const Te of w)Te.enableAttributes(Ie,u);z&&z.enableAttributes(Ie,u),Y&&Y.enableAttributes(Ie,u),re&&re.enableAttributes(Ie,u),g.bind(),g.setVertexAttribPointers(Ie,u,L);for(const Te of w)Te.bind(),Te.setVertexAttribPointers(Ie,u,L);z&&(z.bind(),z.setVertexAttribPointers(Ie,u,L)),C&&C.bind(),Y&&(Y.bind(),Y.setVertexAttribPointers(Ie,u,L)),re&&(re.bind(),re.setVertexAttribPointers(Ie,u,L)),fe.currentNumAttributes=le}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const uu=(D,u,g,w,C)=>({u_texture:0,u_ele_delta:D,u_fog_matrix:u,u_fog_color:g?g.properties.get("fog-color"):o.bp.white,u_fog_ground_blend:g?g.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:C?0:g?g.calculateFogBlendOpacity(w):0,u_horizon_color:g?g.properties.get("horizon-color"):o.bp.white,u_horizon_fog_blend:g?g.properties.get("horizon-fog-blend"):1,u_is_globe_mode:C?1:0}),Ys={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ja(D){const u=[];for(let g=0;g<D.length;g++){if(D[g]===null)continue;const w=D[g].split(" ");u.push(w.pop())}return u}class Is{constructor(u,g,w,C,L,z,Y,re,le=[]){const fe=u.gl;this.program=fe.createProgram();const Ie=ja(g.staticAttributes),Te=w?w.getBinderAttributes():[],Ue=Ie.concat(Te),Ze=fn.prelude.staticUniforms?ja(fn.prelude.staticUniforms):[],ft=Y.staticUniforms?ja(Y.staticUniforms):[],pt=g.staticUniforms?ja(g.staticUniforms):[],dt=w?w.getBinderUniforms():[],xt=Ze.concat(ft).concat(pt).concat(dt),Ot=[];for(const dr of xt)Ot.indexOf(dr)<0&&Ot.push(dr);const wt=w?w.defines():[];Ge(fe)&&wt.unshift("#version 300 es"),L&&wt.push("#define OVERDRAW_INSPECTOR;"),z&&wt.push("#define TERRAIN3D;"),re&&wt.push(re),le&&wt.push(...le);let Nt=wt.concat(fn.prelude.fragmentSource,Y.fragmentSource,g.fragmentSource).join(`
`),jt=wt.concat(fn.prelude.vertexSource,Y.vertexSource,g.vertexSource).join(`
`);Ge(fe)||(Nt=(function(dr){return dr.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(Nt),jt=(function(dr){return dr.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(jt));const Dt=fe.createShader(fe.FRAGMENT_SHADER);if(fe.isContextLost())return void(this.failedToCreate=!0);if(fe.shaderSource(Dt,Nt),fe.compileShader(Dt),!fe.getShaderParameter(Dt,fe.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${fe.getShaderInfoLog(Dt)}`);fe.attachShader(this.program,Dt);const Yt=fe.createShader(fe.VERTEX_SHADER);if(fe.isContextLost())return void(this.failedToCreate=!0);if(fe.shaderSource(Yt,jt),fe.compileShader(Yt),!fe.getShaderParameter(Yt,fe.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${fe.getShaderInfoLog(Yt)}`);fe.attachShader(this.program,Yt),this.attributes={};const Sr={};this.numAttributes=Ue.length;for(let dr=0;dr<this.numAttributes;dr++)Ue[dr]&&(fe.bindAttribLocation(this.program,dr,Ue[dr]),this.attributes[Ue[dr]]=dr);if(fe.linkProgram(this.program),!fe.getProgramParameter(this.program,fe.LINK_STATUS))throw new Error(`Program failed to link: ${fe.getProgramInfoLog(this.program)}`);fe.deleteShader(Yt),fe.deleteShader(Dt);for(let dr=0;dr<Ot.length;dr++){const yr=Ot[dr];if(yr&&!Sr[yr]){const xr=fe.getUniformLocation(this.program,yr);xr&&(Sr[yr]=xr)}}this.fixedUniforms=C(u,Sr),this.terrainUniforms=((dr,yr)=>({u_depth:new o.b_(dr,yr.u_depth),u_terrain:new o.b_(dr,yr.u_terrain),u_terrain_dim:new o.bq(dr,yr.u_terrain_dim),u_terrain_matrix:new o.c0(dr,yr.u_terrain_matrix),u_terrain_unpack:new o.c1(dr,yr.u_terrain_unpack),u_terrain_exaggeration:new o.bq(dr,yr.u_terrain_exaggeration)}))(u,Sr),this.projectionUniforms=((dr,yr)=>({u_projection_matrix:new o.c0(dr,yr.u_projection_matrix),u_projection_tile_mercator_coords:new o.c1(dr,yr.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.c1(dr,yr.u_projection_clipping_plane),u_projection_transition:new o.bq(dr,yr.u_projection_transition),u_projection_fallback_matrix:new o.c0(dr,yr.u_projection_fallback_matrix)}))(u,Sr),this.binderUniforms=w?w.getUniforms(u,Sr):[]}draw(u,g,w,C,L,z,Y,re,le,fe,Ie,Te,Ue,Ze,ft,pt,dt,xt,Ot){const wt=u.gl;if(this.failedToCreate)return;if(u.program.set(this.program),u.setDepthMode(w),u.setStencilMode(C),u.setColorMode(L),u.setCullFace(z),re){u.activeTexture.set(wt.TEXTURE2),wt.bindTexture(wt.TEXTURE_2D,re.depthTexture),u.activeTexture.set(wt.TEXTURE3),wt.bindTexture(wt.TEXTURE_2D,re.texture);for(const jt in this.terrainUniforms)this.terrainUniforms[jt].set(re[jt])}if(le)for(const jt in le)this.projectionUniforms[Ys[jt]].set(le[jt]);if(Y)for(const jt in this.fixedUniforms)this.fixedUniforms[jt].set(Y[jt]);pt&&pt.setUniforms(u,this.binderUniforms,Ze,{zoom:ft});let Nt=0;switch(g){case wt.LINES:Nt=2;break;case wt.TRIANGLES:Nt=3;break;case wt.LINE_STRIP:Nt=1}for(const jt of Ue.get()){const Dt=jt.vaos||(jt.vaos={});(Dt[fe]||(Dt[fe]=new rc)).bind(u,this,Ie,pt?pt.getPaintVertexBuffers():[],Te,jt.vertexOffset,dt,xt,Ot),wt.drawElements(g,jt.primitiveLength*Nt,wt.UNSIGNED_SHORT,jt.primitiveOffset*Nt*2)}}}function nc(D,u,g){const w=1/o.aN(g,1,u.transform.tileZoom),C=Math.pow(2,g.tileID.overscaledZ),L=g.tileSize*Math.pow(2,u.transform.tileZoom)/C,z=L*(g.tileID.canonical.x+g.tileID.wrap*C),Y=L*g.tileID.canonical.y;return{u_image:0,u_texsize:g.imageAtlasTexture.size,u_scale:[w,D.fromScale,D.toScale],u_fade:D.t,u_pixel_coord_upper:[z>>16,Y>>16],u_pixel_coord_lower:[65535&z,65535&Y]}}const ic=(D,u,g,w)=>{const C=D.style.light,L=C.properties.get("position"),z=[L.x,L.y,L.z],Y=o.c4();C.properties.get("anchor")==="viewport"&&o.c5(Y,D.transform.bearingInRadians),o.c6(z,z,Y);const re=D.transform.transformLightDirection(z),le=C.properties.get("color");return{u_lightpos:z,u_lightpos_globe:re,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[le.r,le.g,le.b],u_vertical_gradient:+u,u_opacity:g,u_fill_translate:w}},ul=(D,u,g,w,C,L,z)=>o.e(ic(D,u,g,w),nc(L,D,z),{u_height_factor:-Math.pow(2,C.overscaledZ)/z.tileSize/8}),cu=(D,u,g,w)=>o.e(nc(u,D,g),{u_fill_translate:w}),Oo=(D,u)=>({u_world:D,u_fill_translate:u}),mo=(D,u,g,w,C)=>o.e(cu(D,u,g,C),{u_world:w}),Du=(D,u,g,w,C)=>{const L=D.transform;let z,Y,re=0;if(g.paint.get("circle-pitch-alignment")==="map"){const le=o.aN(u,1,L.zoom);z=!0,Y=[le,le],re=le/(o.a5*Math.pow(2,u.tileID.overscaledZ))*2*Math.PI*C}else z=!1,Y=L.pixelsToGLUnits;return{u_camera_to_center_distance:L.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+z,u_device_pixel_ratio:D.pixelRatio,u_extrude_scale:Y,u_globe_extrude_scale:re,u_translate:w}},Ua=D=>({u_pixel_extrude_scale:[1/D.width,1/D.height]}),hu=D=>({u_viewport_size:[D.width,D.height]}),Zs=(D,u=1)=>({u_color:D,u_overlay:0,u_overlay_scale:u}),ms=(D,u,g,w)=>{const C=o.aN(D,1,u)/(o.a5*Math.pow(2,D.tileID.overscaledZ))*2*Math.PI*w;return{u_extrude_scale:o.aN(D,1,u),u_intensity:g,u_globe_extrude_scale:C}},Va=(D,u,g,w)=>{const C=o.N();o.c7(C,0,D.width,D.height,0,0,1);const L=D.context.gl;return{u_matrix:C,u_world:[L.drawingBufferWidth,L.drawingBufferHeight],u_image:g,u_color_ramp:w,u_opacity:u.paint.get("heatmap-opacity")}},Vl=(D,u,g)=>{const w=g.paint.get("hillshade-accent-color");let C;switch(g.paint.get("hillshade-method")){case"basic":C=4;break;case"combined":C=1;break;case"igor":C=2;break;case"multidirectional":C=3;break;default:C=0}const L=g.getIlluminationProperties();for(let z=0;z<L.directionRadians.length;z++)g.paint.get("hillshade-illumination-anchor")==="viewport"&&(L.directionRadians[z]+=D.transform.bearingInRadians);return{u_image:0,u_latrange:hl(0,u.tileID),u_exaggeration:g.paint.get("hillshade-exaggeration"),u_altitudes:L.altitudeRadians,u_azimuths:L.directionRadians,u_accent:w,u_method:C,u_highlights:L.highlightColor,u_shadows:L.shadowColor}},cl=(D,u)=>{const g=u.stride,w=o.N();return o.c7(w,0,o.a5,-o.a5,0,0,1),o.O(w,w,[0,-o.a5,0]),{u_matrix:w,u_image:1,u_dimension:[g,g],u_zoom:D.overscaledZ,u_unpack:u.getUnpackVector()}};function hl(D,u){const g=Math.pow(2,u.canonical.z),w=u.canonical.y;return[new o.a9(0,w/g).toLngLat().lat,new o.a9(0,(w+1)/g).toLngLat().lat]}const $l=(D,u,g=0)=>({u_image:0,u_unpack:u.getUnpackVector(),u_dimension:[u.stride,u.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:g,u_opacity:D.paint.get("color-relief-opacity")}),ql=(D,u,g,w)=>{const C=D.transform;return{u_translation:dn(D,u,g),u_ratio:w/o.aN(u,1,C.zoom),u_device_pixel_ratio:D.pixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},fl=(D,u,g,w,C)=>o.e(ql(D,u,g,w),{u_image:0,u_image_height:C}),Hl=(D,u,g,w,C)=>{const L=D.transform,z=mr(u,L);return{u_translation:dn(D,u,g),u_texsize:u.imageAtlasTexture.size,u_ratio:w/o.aN(u,1,L.zoom),u_device_pixel_ratio:D.pixelRatio,u_image:0,u_scale:[z,C.fromScale,C.toScale],u_fade:C.t,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]]}},Ou=(D,u,g,w,C)=>{const L=mr(u,D.transform);return o.e(ql(D,u,g,w),{u_tileratio:L,u_crossfade_from:C.fromScale,u_crossfade_to:C.toScale,u_image:0,u_mix:C.t,u_lineatlas_width:D.lineAtlas.width,u_lineatlas_height:D.lineAtlas.height})},tr=(D,u,g,w,C,L)=>{const z=mr(u,D.transform);return o.e(ql(D,u,g,w),{u_image:0,u_image_height:L,u_tileratio:z,u_crossfade_from:C.fromScale,u_crossfade_to:C.toScale,u_image_dash:1,u_mix:C.t,u_lineatlas_width:D.lineAtlas.width,u_lineatlas_height:D.lineAtlas.height})};function mr(D,u){return 1/o.aN(D,1,u.tileZoom)}function dn(D,u,g){return o.aO(D.transform,u,g.paint.get("line-translate"),g.paint.get("line-translate-anchor"))}const In=(D,u,g,w,C)=>{return{u_tl_parent:D,u_scale_parent:u,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(z=w.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(L=w.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:vi(w.paint.get("raster-hue-rotate")),u_coords_top:[C[0].x,C[0].y,C[1].x,C[1].y],u_coords_bottom:[C[3].x,C[3].y,C[2].x,C[2].y]};var L,z};function vi(D){D*=Math.PI/180;const u=Math.sin(D),g=Math.cos(D);return[(2*g+1)/3,(-Math.sqrt(3)*u-g+1)/3,(Math.sqrt(3)*u-g+1)/3]}const Pn=(D,u,g,w,C,L,z,Y,re,le,fe,Ie,Te)=>{const Ue=z.transform;return{u_is_size_zoom_constant:+(D==="constant"||D==="source"),u_is_size_feature_constant:+(D==="constant"||D==="camera"),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:Ue.cameraToCenterDistance,u_pitch:Ue.pitch/360*2*Math.PI,u_rotate_symbol:+g,u_aspect_ratio:Ue.width/Ue.height,u_fade_change:z.options.fadeDuration?z.symbolFadeChange:1,u_label_plane_matrix:Y,u_coord_matrix:re,u_is_text:+fe,u_pitch_with_map:+w,u_is_along_line:C,u_is_variable_anchor:L,u_texsize:Ie,u_texture:0,u_translation:le,u_pitched_scale:Te}},I=(D,u,g,w,C,L,z,Y,re,le,fe,Ie,Te,Ue)=>{const Ze=z.transform;return o.e(Pn(D,u,g,w,C,L,z,Y,re,le,fe,Ie,Ue),{u_gamma_scale:w?Math.cos(Ze.pitch*Math.PI/180)*Ze.cameraToCenterDistance:1,u_device_pixel_ratio:z.pixelRatio,u_is_halo:1})},y=(D,u,g,w,C,L,z,Y,re,le,fe,Ie,Te)=>o.e(I(D,u,g,w,C,L,z,Y,re,le,!0,fe,0,Te),{u_texsize_icon:Ie,u_texture_icon:1}),_=(D,u)=>({u_opacity:D,u_color:u}),P=(D,u,g,w,C)=>o.e((function(L,z,Y,re){const le=Y.imageManager.getPattern(L.from.toString()),fe=Y.imageManager.getPattern(L.to.toString()),{width:Ie,height:Te}=Y.imageManager.getPixelSize(),Ue=Math.pow(2,re.tileID.overscaledZ),Ze=re.tileSize*Math.pow(2,Y.transform.tileZoom)/Ue,ft=Ze*(re.tileID.canonical.x+re.tileID.wrap*Ue),pt=Ze*re.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:le.tl,u_pattern_br_a:le.br,u_pattern_tl_b:fe.tl,u_pattern_br_b:fe.br,u_texsize:[Ie,Te],u_mix:z.t,u_pattern_size_a:le.displaySize,u_pattern_size_b:fe.displaySize,u_scale_a:z.fromScale,u_scale_b:z.toScale,u_tile_units_to_pixels:1/o.aN(re,1,Y.transform.tileZoom),u_pixel_coord_upper:[ft>>16,pt>>16],u_pixel_coord_lower:[65535&ft,65535&pt]}})(g,C,u,w),{u_opacity:D}),$=(D,u)=>{},ne={fillExtrusion:(D,u)=>({u_lightpos:new o.c2(D,u.u_lightpos),u_lightpos_globe:new o.c2(D,u.u_lightpos_globe),u_lightintensity:new o.bq(D,u.u_lightintensity),u_lightcolor:new o.c2(D,u.u_lightcolor),u_vertical_gradient:new o.bq(D,u.u_vertical_gradient),u_opacity:new o.bq(D,u.u_opacity),u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillExtrusionPattern:(D,u)=>({u_lightpos:new o.c2(D,u.u_lightpos),u_lightpos_globe:new o.c2(D,u.u_lightpos_globe),u_lightintensity:new o.bq(D,u.u_lightintensity),u_lightcolor:new o.c2(D,u.u_lightcolor),u_vertical_gradient:new o.bq(D,u.u_vertical_gradient),u_height_factor:new o.bq(D,u.u_height_factor),u_opacity:new o.bq(D,u.u_opacity),u_fill_translate:new o.c3(D,u.u_fill_translate),u_image:new o.b_(D,u.u_image),u_texsize:new o.c3(D,u.u_texsize),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade)}),fill:(D,u)=>({u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillPattern:(D,u)=>({u_image:new o.b_(D,u.u_image),u_texsize:new o.c3(D,u.u_texsize),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade),u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillOutline:(D,u)=>({u_world:new o.c3(D,u.u_world),u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillOutlinePattern:(D,u)=>({u_world:new o.c3(D,u.u_world),u_image:new o.b_(D,u.u_image),u_texsize:new o.c3(D,u.u_texsize),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade),u_fill_translate:new o.c3(D,u.u_fill_translate)}),circle:(D,u)=>({u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_scale_with_map:new o.b_(D,u.u_scale_with_map),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_extrude_scale:new o.c3(D,u.u_extrude_scale),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_globe_extrude_scale:new o.bq(D,u.u_globe_extrude_scale),u_translate:new o.c3(D,u.u_translate)}),collisionBox:(D,u)=>({u_pixel_extrude_scale:new o.c3(D,u.u_pixel_extrude_scale)}),collisionCircle:(D,u)=>({u_viewport_size:new o.c3(D,u.u_viewport_size)}),debug:(D,u)=>({u_color:new o.b$(D,u.u_color),u_overlay:new o.b_(D,u.u_overlay),u_overlay_scale:new o.bq(D,u.u_overlay_scale)}),depth:$,clippingMask:$,heatmap:(D,u)=>({u_extrude_scale:new o.bq(D,u.u_extrude_scale),u_intensity:new o.bq(D,u.u_intensity),u_globe_extrude_scale:new o.bq(D,u.u_globe_extrude_scale)}),heatmapTexture:(D,u)=>({u_matrix:new o.c0(D,u.u_matrix),u_world:new o.c3(D,u.u_world),u_image:new o.b_(D,u.u_image),u_color_ramp:new o.b_(D,u.u_color_ramp),u_opacity:new o.bq(D,u.u_opacity)}),hillshade:(D,u)=>({u_image:new o.b_(D,u.u_image),u_latrange:new o.c3(D,u.u_latrange),u_exaggeration:new o.bq(D,u.u_exaggeration),u_altitudes:new o.c9(D,u.u_altitudes),u_azimuths:new o.c9(D,u.u_azimuths),u_accent:new o.b$(D,u.u_accent),u_method:new o.b_(D,u.u_method),u_shadows:new o.c8(D,u.u_shadows),u_highlights:new o.c8(D,u.u_highlights)}),hillshadePrepare:(D,u)=>({u_matrix:new o.c0(D,u.u_matrix),u_image:new o.b_(D,u.u_image),u_dimension:new o.c3(D,u.u_dimension),u_zoom:new o.bq(D,u.u_zoom),u_unpack:new o.c1(D,u.u_unpack)}),colorRelief:(D,u)=>({u_image:new o.b_(D,u.u_image),u_unpack:new o.c1(D,u.u_unpack),u_dimension:new o.c3(D,u.u_dimension),u_elevation_stops:new o.b_(D,u.u_elevation_stops),u_color_stops:new o.b_(D,u.u_color_stops),u_color_ramp_size:new o.b_(D,u.u_color_ramp_size),u_opacity:new o.bq(D,u.u_opacity)}),line:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels)}),lineGradient:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_image:new o.b_(D,u.u_image),u_image_height:new o.bq(D,u.u_image_height)}),linePattern:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_texsize:new o.c3(D,u.u_texsize),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_image:new o.b_(D,u.u_image),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade)}),lineSDF:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_image:new o.b_(D,u.u_image),u_mix:new o.bq(D,u.u_mix),u_tileratio:new o.bq(D,u.u_tileratio),u_crossfade_from:new o.bq(D,u.u_crossfade_from),u_crossfade_to:new o.bq(D,u.u_crossfade_to),u_lineatlas_width:new o.bq(D,u.u_lineatlas_width),u_lineatlas_height:new o.bq(D,u.u_lineatlas_height)}),lineGradientSDF:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_image:new o.b_(D,u.u_image),u_image_height:new o.bq(D,u.u_image_height),u_tileratio:new o.bq(D,u.u_tileratio),u_crossfade_from:new o.bq(D,u.u_crossfade_from),u_crossfade_to:new o.bq(D,u.u_crossfade_to),u_image_dash:new o.b_(D,u.u_image_dash),u_mix:new o.bq(D,u.u_mix),u_lineatlas_width:new o.bq(D,u.u_lineatlas_width),u_lineatlas_height:new o.bq(D,u.u_lineatlas_height)}),raster:(D,u)=>({u_tl_parent:new o.c3(D,u.u_tl_parent),u_scale_parent:new o.bq(D,u.u_scale_parent),u_buffer_scale:new o.bq(D,u.u_buffer_scale),u_fade_t:new o.bq(D,u.u_fade_t),u_opacity:new o.bq(D,u.u_opacity),u_image0:new o.b_(D,u.u_image0),u_image1:new o.b_(D,u.u_image1),u_brightness_low:new o.bq(D,u.u_brightness_low),u_brightness_high:new o.bq(D,u.u_brightness_high),u_saturation_factor:new o.bq(D,u.u_saturation_factor),u_contrast_factor:new o.bq(D,u.u_contrast_factor),u_spin_weights:new o.c2(D,u.u_spin_weights),u_coords_top:new o.c1(D,u.u_coords_top),u_coords_bottom:new o.c1(D,u.u_coords_bottom)}),symbolIcon:(D,u)=>({u_is_size_zoom_constant:new o.b_(D,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(D,u.u_is_size_feature_constant),u_size_t:new o.bq(D,u.u_size_t),u_size:new o.bq(D,u.u_size),u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_pitch:new o.bq(D,u.u_pitch),u_rotate_symbol:new o.b_(D,u.u_rotate_symbol),u_aspect_ratio:new o.bq(D,u.u_aspect_ratio),u_fade_change:new o.bq(D,u.u_fade_change),u_label_plane_matrix:new o.c0(D,u.u_label_plane_matrix),u_coord_matrix:new o.c0(D,u.u_coord_matrix),u_is_text:new o.b_(D,u.u_is_text),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_is_along_line:new o.b_(D,u.u_is_along_line),u_is_variable_anchor:new o.b_(D,u.u_is_variable_anchor),u_texsize:new o.c3(D,u.u_texsize),u_texture:new o.b_(D,u.u_texture),u_translation:new o.c3(D,u.u_translation),u_pitched_scale:new o.bq(D,u.u_pitched_scale)}),symbolSDF:(D,u)=>({u_is_size_zoom_constant:new o.b_(D,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(D,u.u_is_size_feature_constant),u_size_t:new o.bq(D,u.u_size_t),u_size:new o.bq(D,u.u_size),u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_pitch:new o.bq(D,u.u_pitch),u_rotate_symbol:new o.b_(D,u.u_rotate_symbol),u_aspect_ratio:new o.bq(D,u.u_aspect_ratio),u_fade_change:new o.bq(D,u.u_fade_change),u_label_plane_matrix:new o.c0(D,u.u_label_plane_matrix),u_coord_matrix:new o.c0(D,u.u_coord_matrix),u_is_text:new o.b_(D,u.u_is_text),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_is_along_line:new o.b_(D,u.u_is_along_line),u_is_variable_anchor:new o.b_(D,u.u_is_variable_anchor),u_texsize:new o.c3(D,u.u_texsize),u_texture:new o.b_(D,u.u_texture),u_gamma_scale:new o.bq(D,u.u_gamma_scale),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_is_halo:new o.b_(D,u.u_is_halo),u_translation:new o.c3(D,u.u_translation),u_pitched_scale:new o.bq(D,u.u_pitched_scale)}),symbolTextAndIcon:(D,u)=>({u_is_size_zoom_constant:new o.b_(D,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(D,u.u_is_size_feature_constant),u_size_t:new o.bq(D,u.u_size_t),u_size:new o.bq(D,u.u_size),u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_pitch:new o.bq(D,u.u_pitch),u_rotate_symbol:new o.b_(D,u.u_rotate_symbol),u_aspect_ratio:new o.bq(D,u.u_aspect_ratio),u_fade_change:new o.bq(D,u.u_fade_change),u_label_plane_matrix:new o.c0(D,u.u_label_plane_matrix),u_coord_matrix:new o.c0(D,u.u_coord_matrix),u_is_text:new o.b_(D,u.u_is_text),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_is_along_line:new o.b_(D,u.u_is_along_line),u_is_variable_anchor:new o.b_(D,u.u_is_variable_anchor),u_texsize:new o.c3(D,u.u_texsize),u_texsize_icon:new o.c3(D,u.u_texsize_icon),u_texture:new o.b_(D,u.u_texture),u_texture_icon:new o.b_(D,u.u_texture_icon),u_gamma_scale:new o.bq(D,u.u_gamma_scale),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_is_halo:new o.b_(D,u.u_is_halo),u_translation:new o.c3(D,u.u_translation),u_pitched_scale:new o.bq(D,u.u_pitched_scale)}),background:(D,u)=>({u_opacity:new o.bq(D,u.u_opacity),u_color:new o.b$(D,u.u_color)}),backgroundPattern:(D,u)=>({u_opacity:new o.bq(D,u.u_opacity),u_image:new o.b_(D,u.u_image),u_pattern_tl_a:new o.c3(D,u.u_pattern_tl_a),u_pattern_br_a:new o.c3(D,u.u_pattern_br_a),u_pattern_tl_b:new o.c3(D,u.u_pattern_tl_b),u_pattern_br_b:new o.c3(D,u.u_pattern_br_b),u_texsize:new o.c3(D,u.u_texsize),u_mix:new o.bq(D,u.u_mix),u_pattern_size_a:new o.c3(D,u.u_pattern_size_a),u_pattern_size_b:new o.c3(D,u.u_pattern_size_b),u_scale_a:new o.bq(D,u.u_scale_a),u_scale_b:new o.bq(D,u.u_scale_b),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bq(D,u.u_tile_units_to_pixels)}),terrain:(D,u)=>({u_texture:new o.b_(D,u.u_texture),u_ele_delta:new o.bq(D,u.u_ele_delta),u_fog_matrix:new o.c0(D,u.u_fog_matrix),u_fog_color:new o.b$(D,u.u_fog_color),u_fog_ground_blend:new o.bq(D,u.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bq(D,u.u_fog_ground_blend_opacity),u_horizon_color:new o.b$(D,u.u_horizon_color),u_horizon_fog_blend:new o.bq(D,u.u_horizon_fog_blend),u_is_globe_mode:new o.bq(D,u.u_is_globe_mode)}),terrainDepth:(D,u)=>({u_ele_delta:new o.bq(D,u.u_ele_delta)}),terrainCoords:(D,u)=>({u_texture:new o.b_(D,u.u_texture),u_terrain_coords_id:new o.bq(D,u.u_terrain_coords_id),u_ele_delta:new o.bq(D,u.u_ele_delta)}),projectionErrorMeasurement:(D,u)=>({u_input:new o.bq(D,u.u_input),u_output_expected:new o.bq(D,u.u_output_expected)}),atmosphere:(D,u)=>({u_sun_pos:new o.c2(D,u.u_sun_pos),u_atmosphere_blend:new o.bq(D,u.u_atmosphere_blend),u_globe_position:new o.c2(D,u.u_globe_position),u_globe_radius:new o.bq(D,u.u_globe_radius),u_inv_proj_matrix:new o.c0(D,u.u_inv_proj_matrix)}),sky:(D,u)=>({u_sky_color:new o.b$(D,u.u_sky_color),u_horizon_color:new o.b$(D,u.u_horizon_color),u_horizon:new o.c3(D,u.u_horizon),u_horizon_normal:new o.c3(D,u.u_horizon_normal),u_sky_horizon_blend:new o.bq(D,u.u_sky_horizon_blend),u_sky_blend:new o.bq(D,u.u_sky_blend)})};class ye{constructor(u,g,w){this.context=u;const C=u.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete g.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(u){const g=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Oe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class tt{constructor(u,g,w,C){this.length=g.length,this.attributes=w,this.itemSize=g.bytesPerElement,this.dynamicDraw=C,this.context=u;const L=u.gl;this.buffer=L.createBuffer(),u.bindVertexBuffer.set(this.buffer),L.bufferData(L.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?L.DYNAMIC_DRAW:L.STATIC_DRAW),this.dynamicDraw||delete g.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(u){if(u.length!==this.length)throw new Error(`Length of new data is ${u.length}, which doesn't match current length of ${this.length}`);const g=this.context.gl;this.bind(),g.bufferSubData(g.ARRAY_BUFFER,0,u.arrayBuffer)}enableAttributes(u,g){for(let w=0;w<this.attributes.length;w++){const C=g.attributes[this.attributes[w].name];C!==void 0&&u.enableVertexAttribArray(C)}}setVertexAttribPointers(u,g,w){for(let C=0;C<this.attributes.length;C++){const L=this.attributes[C],z=g.attributes[L.name];z!==void 0&&u.vertexAttribPointer(z,L.components,u[Oe[L.type]],!1,this.itemSize,L.offset+this.itemSize*(w||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ht{constructor(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(u){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class rr extends ht{getDefault(){return o.bp.transparent}set(u){const g=this.current;(u.r!==g.r||u.g!==g.g||u.b!==g.b||u.a!==g.a||this.dirty)&&(this.gl.clearColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class ur extends ht{getDefault(){return 1}set(u){(u!==this.current||this.dirty)&&(this.gl.clearDepth(u),this.current=u,this.dirty=!1)}}class qr extends ht{getDefault(){return 0}set(u){(u!==this.current||this.dirty)&&(this.gl.clearStencil(u),this.current=u,this.dirty=!1)}}class bn extends ht{getDefault(){return[!0,!0,!0,!0]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||u[3]!==g[3]||this.dirty)&&(this.gl.colorMask(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Dn extends ht{getDefault(){return!0}set(u){(u!==this.current||this.dirty)&&(this.gl.depthMask(u),this.current=u,this.dirty=!1)}}class Xn extends ht{getDefault(){return 255}set(u){(u!==this.current||this.dirty)&&(this.gl.stencilMask(u),this.current=u,this.dirty=!1)}}class Fn extends ht{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(u){const g=this.current;(u.func!==g.func||u.ref!==g.ref||u.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(u.func,u.ref,u.mask),this.current=u,this.dirty=!1)}}class En extends ht{getDefault(){const u=this.gl;return[u.KEEP,u.KEEP,u.KEEP]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(u[0],u[1],u[2]),this.current=u,this.dirty=!1)}}class na extends ht{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=u,this.dirty=!1}}class ca extends ht{getDefault(){return[0,1]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||this.dirty)&&(this.gl.depthRange(u[0],u[1]),this.current=u,this.dirty=!1)}}class so extends ht{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=u,this.dirty=!1}}class ka extends ht{getDefault(){return this.gl.LESS}set(u){(u!==this.current||this.dirty)&&(this.gl.depthFunc(u),this.current=u,this.dirty=!1)}}class Ho extends ht{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.BLEND):g.disable(g.BLEND),this.current=u,this.dirty=!1}}class Ks extends ht{getDefault(){const u=this.gl;return[u.ONE,u.ZERO]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(u[0],u[1]),this.current=u,this.dirty=!1)}}class Pl extends ht{getDefault(){return o.bp.transparent}set(u){const g=this.current;(u.r!==g.r||u.g!==g.g||u.b!==g.b||u.a!==g.a||this.dirty)&&(this.gl.blendColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class fu extends ht{getDefault(){return this.gl.FUNC_ADD}set(u){(u!==this.current||this.dirty)&&(this.gl.blendEquation(u),this.current=u,this.dirty=!1)}}class du extends ht{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=u,this.dirty=!1}}class Ps extends ht{getDefault(){return this.gl.BACK}set(u){(u!==this.current||this.dirty)&&(this.gl.cullFace(u),this.current=u,this.dirty=!1)}}class Wl extends ht{getDefault(){return this.gl.CCW}set(u){(u!==this.current||this.dirty)&&(this.gl.frontFace(u),this.current=u,this.dirty=!1)}}class Gl extends ht{getDefault(){return null}set(u){(u!==this.current||this.dirty)&&(this.gl.useProgram(u),this.current=u,this.dirty=!1)}}class Eo extends ht{getDefault(){return this.gl.TEXTURE0}set(u){(u!==this.current||this.dirty)&&(this.gl.activeTexture(u),this.current=u,this.dirty=!1)}}class ni extends ht{getDefault(){const u=this.gl;return[0,0,u.drawingBufferWidth,u.drawingBufferHeight]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||u[3]!==g[3]||this.dirty)&&(this.gl.viewport(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Nu extends ht{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,u),this.current=u,this.dirty=!1}}class Qh extends ht{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class yh extends ht{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindTexture(g.TEXTURE_2D,u),this.current=u,this.dirty=!1}}class pu extends ht{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Op extends ht{getDefault(){return null}set(u){const g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Vg extends ht{getDefault(){return null}set(u){var g;if(u===this.current&&!this.dirty)return;const w=this.gl;Ge(w)?w.bindVertexArray(u):(g=w.getExtension("OES_vertex_array_object"))===null||g===void 0||g.bindVertexArrayOES(u),this.current=u,this.dirty=!1}}class $g extends ht{getDefault(){return 4}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,u),this.current=u,this.dirty=!1}}class qg extends ht{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),this.current=u,this.dirty=!1}}class Od extends ht{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,u),this.current=u,this.dirty=!1}}class Vc extends ht{constructor(u,g){super(u),this.context=u,this.parent=g}getDefault(){return null}}class ef extends Vc{setDirty(){this.dirty=!0}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class Np extends Vc{set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Hg extends Vc{set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_STENCIL_ATTACHMENT,g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}const Lp="Framebuffer is not complete";class Fp{constructor(u,g,w,C,L){this.context=u,this.width=g,this.height=w;const z=u.gl,Y=this.framebuffer=z.createFramebuffer();if(this.colorAttachment=new ef(u,Y),C)this.depthAttachment=L?new Hg(u,Y):new Np(u,Y);else if(L)throw new Error("Stencil cannot be set without depth");if(z.checkFramebufferStatus(z.FRAMEBUFFER)!==z.FRAMEBUFFER_COMPLETE)throw new Error(Lp)}destroy(){const u=this.context.gl,g=this.colorAttachment.get();if(g&&u.deleteTexture(g),this.depthAttachment){const w=this.depthAttachment.get();w&&u.deleteRenderbuffer(w)}u.deleteFramebuffer(this.framebuffer)}}class Bp{constructor(u){var g,w;if(this.gl=u,this.clearColor=new rr(this),this.clearDepth=new ur(this),this.clearStencil=new qr(this),this.colorMask=new bn(this),this.depthMask=new Dn(this),this.stencilMask=new Xn(this),this.stencilFunc=new Fn(this),this.stencilOp=new En(this),this.stencilTest=new na(this),this.depthRange=new ca(this),this.depthTest=new so(this),this.depthFunc=new ka(this),this.blend=new Ho(this),this.blendFunc=new Ks(this),this.blendColor=new Pl(this),this.blendEquation=new fu(this),this.cullFace=new du(this),this.cullFaceSide=new Ps(this),this.frontFace=new Wl(this),this.program=new Gl(this),this.activeTexture=new Eo(this),this.viewport=new ni(this),this.bindFramebuffer=new Nu(this),this.bindRenderbuffer=new Qh(this),this.bindTexture=new yh(this),this.bindVertexBuffer=new pu(this),this.bindElementBuffer=new Op(this),this.bindVertexArray=new Vg(this),this.pixelStoreUnpack=new $g(this),this.pixelStoreUnpackPremultiplyAlpha=new qg(this),this.pixelStoreUnpackFlipY=new Od(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE),Ge(u)){this.HALF_FLOAT=u.HALF_FLOAT;const C=u.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(g=u.RGBA16F)!==null&&g!==void 0?g:C?.RGBA16F_EXT,this.RGB16F=(w=u.RGB16F)!==null&&w!==void 0?w:C?.RGB16F_EXT,u.getExtension("EXT_color_buffer_float")}else{u.getExtension("EXT_color_buffer_half_float"),u.getExtension("OES_texture_half_float_linear");const C=u.getExtension("OES_texture_half_float");this.HALF_FLOAT=C?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(u,g){return new ye(this,u,g)}createVertexBuffer(u,g,w){return new tt(this,u,g,w)}createRenderbuffer(u,g,w){const C=this.gl,L=C.createRenderbuffer();return this.bindRenderbuffer.set(L),C.renderbufferStorage(C.RENDERBUFFER,u,g,w),this.bindRenderbuffer.set(null),L}createFramebuffer(u,g,w,C){return new Fp(this,u,g,w,C)}clear({color:u,depth:g,stencil:w}){const C=this.gl;let L=0;u&&(L|=C.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set([!0,!0,!0,!0])),g!==void 0&&(L|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(g),this.depthMask.set(!0)),w!==void 0&&(L|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),C.clear(L)}setCullFace(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))}setDepthMode(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)}setStencilMode(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)}setColorMode(u){o.bR(u.blendFunction,ji.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)}createVertexArray(){var u;return Ge(this.gl)?this.gl.createVertexArray():(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.createVertexArrayOES()}deleteVertexArray(u){var g;return Ge(this.gl)?this.gl.deleteVertexArray(u):(g=this.gl.getExtension("OES_vertex_array_object"))===null||g===void 0?void 0:g.deleteVertexArrayOES(u)}unbindVAO(){this.bindVertexArray.set(null)}}let vh;function tf(D,u,g,w,C){const L=D.context,z=D.transform,Y=L.gl,re=D.useProgram("collisionBox"),le=[];let fe=0,Ie=0;for(let dt=0;dt<w.length;dt++){const xt=w[dt],Ot=u.getTile(xt).getBucket(g);if(!Ot)continue;const wt=C?Ot.textCollisionBox:Ot.iconCollisionBox,Nt=Ot.collisionCircleArray;Nt.length>0&&(le.push({circleArray:Nt,circleOffset:Ie,coord:xt}),fe+=Nt.length/4,Ie=fe),wt&&re.draw(L,Y.LINES,ri.disabled,ai.disabled,D.colorModeForRenderPass(),ii.disabled,Ua(D.transform),D.style.map.terrain&&D.style.map.terrain.getTerrainData(xt),z.getProjectionData({overscaledTileID:xt,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),g.id,wt.layoutVertexBuffer,wt.indexBuffer,wt.segments,null,D.transform.zoom,null,null,wt.collisionVertexBuffer)}if(!C||!le.length)return;const Te=D.useProgram("collisionCircle"),Ue=new o.ca;Ue.resize(4*fe),Ue._trim();let Ze=0;for(const dt of le)for(let xt=0;xt<dt.circleArray.length/4;xt++){const Ot=4*xt,wt=dt.circleArray[Ot+0],Nt=dt.circleArray[Ot+1],jt=dt.circleArray[Ot+2],Dt=dt.circleArray[Ot+3];Ue.emplace(Ze++,wt,Nt,jt,Dt,0),Ue.emplace(Ze++,wt,Nt,jt,Dt,1),Ue.emplace(Ze++,wt,Nt,jt,Dt,2),Ue.emplace(Ze++,wt,Nt,jt,Dt,3)}(!vh||vh.length<2*fe)&&(vh=(function(dt){const xt=2*dt,Ot=new o.cc;Ot.resize(xt),Ot._trim();for(let wt=0;wt<xt;wt++){const Nt=6*wt;Ot.uint16[Nt+0]=4*wt+0,Ot.uint16[Nt+1]=4*wt+1,Ot.uint16[Nt+2]=4*wt+2,Ot.uint16[Nt+3]=4*wt+2,Ot.uint16[Nt+4]=4*wt+3,Ot.uint16[Nt+5]=4*wt+0}return Ot})(fe));const ft=L.createIndexBuffer(vh,!0),pt=L.createVertexBuffer(Ue,o.cb.members,!0);for(const dt of le){const xt=hu(D.transform);Te.draw(L,Y.TRIANGLES,ri.disabled,ai.disabled,D.colorModeForRenderPass(),ii.disabled,xt,D.style.map.terrain&&D.style.map.terrain.getTerrainData(dt.coord),null,g.id,pt,ft,o.aX.simpleSegment(0,2*dt.circleOffset,dt.circleArray.length,dt.circleArray.length/2),null,D.transform.zoom,null,null,null)}pt.destroy(),ft.destroy()}const Wg=o.ar(new Float32Array(16));function Gg(D,u,g,w,C,L){const{horizontalAlign:z,verticalAlign:Y}=o.aS(D);return new o.P((-(z-.5)*u/C+w[0])*L,(-(Y-.5)*g/C+w[1])*L)}function rf(D,u,g,w,C,L){const z=u.tileAnchorPoint.add(new o.P(u.translation[0],u.translation[1]));if(u.pitchWithMap){let Y=w.mult(L);g||(Y=Y.rotate(-C));const re=z.add(Y);return zn(re.x,re.y,u.pitchedLabelPlaneMatrix,u.getElevation).point}if(g){const Y=zi(u.tileAnchorPoint.x+1,u.tileAnchorPoint.y,u).point.sub(D),re=Math.atan(Y.y/Y.x)+(Y.x<0?Math.PI:0);return D.add(w.rotate(re))}return D.add(w)}function Nd(D,u,g,w,C,L,z,Y,re,le,fe,Ie){const Te=D.text.placedSymbolArray,Ue=D.text.dynamicLayoutVertexArray,Ze=D.icon.dynamicLayoutVertexArray,ft={};Ue.clear();for(let pt=0;pt<Te.length;pt++){const dt=Te.get(pt),xt=dt.hidden||!dt.crossTileID||D.allowVerticalPlacement&&!dt.placedOrientation?null:w[dt.crossTileID];if(xt){const Ot=new o.P(dt.anchorX,dt.anchorY),wt={getElevation:Ie,width:C.width,height:C.height,pitchedLabelPlaneMatrix:L,pitchWithMap:g,transform:C,tileAnchorPoint:Ot,translation:le,unwrappedTileID:fe},Nt=g?ga(Ot.x,Ot.y,wt):zi(Ot.x,Ot.y,wt),jt=La(C.cameraToCenterDistance,Nt.signedDistanceFromCamera);let Dt=o.aA(D.textSizeData,Y,dt)*jt/o.aM;g&&(Dt*=D.tilePixelRatio/z);const{width:Yt,height:Sr,anchor:dr,textOffset:yr,textBoxScale:xr}=xt,an=Gg(dr,Yt,Sr,yr,xr,Dt),ln=C.getPitchedTextCorrection(Ot.x+le[0],Ot.y+le[1],fe),Hr=rf(Nt.point,wt,u,an,-C.bearingInRadians,ln),gn=D.allowVerticalPlacement&&dt.placedOrientation===o.az.vertical?Math.PI/2:0;for(let Ti=0;Ti<dt.numGlyphs;Ti++)o.aG(Ue,Hr,gn);re&&dt.associatedIconIndex>=0&&(ft[dt.associatedIconIndex]={shiftedAnchor:Hr,angle:gn})}else Ul(dt.numGlyphs,Ue)}if(re){Ze.clear();const pt=D.icon.placedSymbolArray;for(let dt=0;dt<pt.length;dt++){const xt=pt.get(dt);if(xt.hidden)Ul(xt.numGlyphs,Ze);else{const Ot=ft[dt];if(Ot)for(let wt=0;wt<xt.numGlyphs;wt++)o.aG(Ze,Ot.shiftedAnchor,Ot.angle);else Ul(xt.numGlyphs,Ze)}}D.icon.dynamicLayoutVertexBuffer.updateData(Ze)}D.text.dynamicLayoutVertexBuffer.updateData(Ue)}function Ny(D,u,g){return g.iconsInText&&u?"symbolTextAndIcon":D?"symbolSDF":"symbolIcon"}function Ld(D,u,g,w,C,L,z,Y,re,le,fe,Ie,Te){const Ue=D.context,Ze=Ue.gl,ft=D.transform,pt=Y==="map",dt=re==="map",xt=Y!=="viewport"&&g.layout.get("symbol-placement")!=="point",Ot=pt&&!dt&&!xt,wt=!g.layout.get("symbol-sort-key").isConstant();let Nt=!1;const jt=D.getDepthModeForSublayer(0,ri.ReadOnly),Dt=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Yt=[],Sr=ft.getCircleRadiusCorrection();for(const dr of w){const yr=u.getTile(dr),xr=yr.getBucket(g);if(!xr)continue;const an=C?xr.text:xr.icon;if(!an||!an.segments.get().length||!an.hasVisibleVertices)continue;const ln=an.programConfigurations.get(g.id),Hr=C||xr.sdfIcons,gn=C?xr.textSizeData:xr.iconSizeData,Ti=dt||ft.pitch!==0,Ra=D.useProgram(Ny(Hr,C,xr),ln),yo=o.ay(gn,ft.zoom),to=D.style.map.terrain&&D.style.map.terrain.getTerrainData(dr);let Ao,ro,Xo,Io,pl=[0,0],vs=null;if(C)ro=yr.glyphAtlasTexture,Xo=Ze.LINEAR,Ao=yr.glyphAtlasTexture.size,xr.iconsInText&&(pl=yr.imageAtlasTexture.size,vs=yr.imageAtlasTexture,Io=Ti||D.options.rotating||D.options.zooming||gn.kind==="composite"||gn.kind==="camera"?Ze.LINEAR:Ze.NEAREST);else{const lo=g.layout.get("icon-size").constantOr(0)!==1||xr.iconsNeedLinear;ro=yr.imageAtlasTexture,Xo=Hr||D.options.rotating||D.options.zooming||lo||Ti?Ze.LINEAR:Ze.NEAREST,Ao=yr.imageAtlasTexture.size}const as=o.aN(yr,1,D.transform.zoom),Ml=ei(pt,D.transform,as),Xf=o.N();o.aB(Xf,Ml);const sf=ua(dt,pt,D.transform,as),Eh=o.aO(ft,yr,L,z),zu=ft.getProjectionData({overscaledTileID:dr,applyGlobeMatrix:!Te,applyTerrainMatrix:!0}),$d=Dt&&xr.hasTextData(),em=g.layout.get("icon-text-fit")!=="none"&&$d&&xr.hasIconData();if(xt){const lo=D.style.map.terrain?(Js,Qs)=>D.style.map.terrain.getElevation(dr,Js,Qs):null,no=g.layout.get("text-rotation-alignment")==="map";fs(xr,D,C,Ml,Xf,dt,le,no,dr.toUnwrapped(),ft.width,ft.height,Eh,lo)}const qd=C&&Dt||em,Sc=xt||qd?Wg:dt?Ml:D.transform.clipSpaceToPixelsMatrix,Th=Hr&&g.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Wc;Wc=Hr?xr.iconsInText?y(gn.kind,yo,Ot,dt,xt,qd,D,Sc,sf,Eh,Ao,pl,Sr):I(gn.kind,yo,Ot,dt,xt,qd,D,Sc,sf,Eh,C,Ao,0,Sr):Pn(gn.kind,yo,Ot,dt,xt,qd,D,Sc,sf,Eh,C,Ao,Sr);const Gc={program:Ra,buffers:an,uniformValues:Wc,projectionData:zu,atlasTexture:ro,atlasTextureIcon:vs,atlasInterpolation:Xo,atlasInterpolationIcon:Io,isSDF:Hr,hasHalo:Th};if(wt&&xr.canOverlap){Nt=!0;const lo=an.segments.get();for(const no of lo)Yt.push({segments:new o.aX([no]),sortKey:no.sortKey,state:Gc,terrainData:to})}else Yt.push({segments:an.segments,sortKey:0,state:Gc,terrainData:to})}Nt&&Yt.sort(((dr,yr)=>dr.sortKey-yr.sortKey));for(const dr of Yt){const yr=dr.state;if(Ue.activeTexture.set(Ze.TEXTURE0),yr.atlasTexture.bind(yr.atlasInterpolation,Ze.CLAMP_TO_EDGE),yr.atlasTextureIcon&&(Ue.activeTexture.set(Ze.TEXTURE1),yr.atlasTextureIcon&&yr.atlasTextureIcon.bind(yr.atlasInterpolationIcon,Ze.CLAMP_TO_EDGE)),yr.isSDF){const xr=yr.uniformValues;yr.hasHalo&&(xr.u_is_halo=1,Fd(yr.buffers,dr.segments,g,D,yr.program,jt,fe,Ie,xr,yr.projectionData,dr.terrainData)),xr.u_is_halo=0}Fd(yr.buffers,dr.segments,g,D,yr.program,jt,fe,Ie,yr.uniformValues,yr.projectionData,dr.terrainData)}}function Fd(D,u,g,w,C,L,z,Y,re,le,fe){const Ie=w.context;C.draw(Ie,Ie.gl.TRIANGLES,L,z,Y,ii.backCCW,re,fe,le,g.id,D.layoutVertexBuffer,D.indexBuffer,u,g.paint,w.transform.zoom,D.programConfigurations.get(g.id),D.dynamicLayoutVertexBuffer,D.opacityVertexBuffer)}function Ly(D,u,g,w,C){const L=D.context,z=L.gl,Y=ai.disabled,re=new ji([z.ONE,z.ONE],o.bp.transparent,[!0,!0,!0,!0]),le=u.getBucket(g);if(!le)return;const fe=w.key;let Ie=g.heatmapFbos.get(fe);Ie||(Ie=Bd(L,u.tileSize,u.tileSize),g.heatmapFbos.set(fe,Ie)),L.bindFramebuffer.set(Ie.framebuffer),L.viewport.set([0,0,u.tileSize,u.tileSize]),L.clear({color:o.bp.transparent});const Te=le.programConfigurations.get(g.id),Ue=D.useProgram("heatmap",Te,!C),Ze=D.transform.getProjectionData({overscaledTileID:u.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ft=D.style.map.terrain.getTerrainData(w);Ue.draw(L,z.TRIANGLES,ri.disabled,Y,re,ii.disabled,ms(u,D.transform.zoom,g.paint.get("heatmap-intensity"),1),ft,Ze,g.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,g.paint,D.transform.zoom,Te)}function Fy(D,u,g,w,C){const L=D.context,z=L.gl,Y=D.transform;L.setColorMode(D.colorModeForRenderPass());const re=zp(L,u),le=g.key,fe=u.heatmapFbos.get(le);if(!fe)return;L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,fe.colorAttachment.get()),L.activeTexture.set(z.TEXTURE1),re.bind(z.LINEAR,z.CLAMP_TO_EDGE);const Ie=Y.getProjectionData({overscaledTileID:g,applyTerrainMatrix:C,applyGlobeMatrix:!w});D.useProgram("heatmapTexture").draw(L,z.TRIANGLES,ri.disabled,ai.disabled,D.colorModeForRenderPass(),ii.disabled,Va(D,u,0,1),null,Ie,u.id,D.rasterBoundsBuffer,D.quadTriangleIndexBuffer,D.rasterBoundsSegments,u.paint,Y.zoom),fe.destroy(),u.heatmapFbos.delete(le)}function Bd(D,u,g){var w,C;const L=D.gl,z=L.createTexture();L.bindTexture(L.TEXTURE_2D,z),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MIN_FILTER,L.LINEAR),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MAG_FILTER,L.LINEAR);const Y=(w=D.HALF_FLOAT)!==null&&w!==void 0?w:L.UNSIGNED_BYTE,re=(C=D.RGBA16F)!==null&&C!==void 0?C:L.RGBA;L.texImage2D(L.TEXTURE_2D,0,re,u,g,0,L.RGBA,Y,null);const le=D.createFramebuffer(u,g,!1,!1);return le.colorAttachment.set(z),le}function zp(D,u){return u.colorRampTexture||(u.colorRampTexture=new o.T(D,u.colorRamp,D.gl.RGBA)),u.colorRampTexture}function $c(D,u,g,w,C,L,z,Y){let re=256;if(C.stepInterpolant){const le=u.getSource().maxzoom,fe=z.canonical.z===le?Math.ceil(1<<D.transform.maxZoom-z.canonical.z):1;re=o.an(o.ce(L.maxLineLength/o.a5*1024*fe),256,g.maxTextureSize)}return Y.gradient=o.cf({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:re,image:Y.gradient||void 0,clips:L.lineClipsArray}),Y.texture?Y.texture.update(Y.gradient):Y.texture=new o.T(g,Y.gradient,w.RGBA),Y.version=C.gradientVersion,Y.texture}function Lu(D,u,g,w,C){D.activeTexture.set(u.TEXTURE0),g.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),w.updatePaintBuffers(C)}function xa(D,u,g,w,C,L){(C||D.lineAtlas.dirty)&&(u.activeTexture.set(g.TEXTURE0),D.lineAtlas.bind(u)),w.updatePaintBuffers(L)}function nf(D,u,g,w,C,L,z){const Y=L.gradients[C.id];let re=Y.texture;C.gradientVersion!==Y.version&&(re=$c(D,u,g,w,C,L,z,Y)),g.activeTexture.set(w.TEXTURE0),re.bind(C.stepInterpolant?w.NEAREST:w.LINEAR,w.CLAMP_TO_EDGE)}function Xl(D,u,g,w,C,L,z,Y,re){const le=L.gradients[C.id];let fe=le.texture;C.gradientVersion!==le.version&&(fe=$c(D,u,g,w,C,L,z,le)),g.activeTexture.set(w.TEXTURE0),fe.bind(C.stepInterpolant?w.NEAREST:w.LINEAR,w.CLAMP_TO_EDGE),g.activeTexture.set(w.TEXTURE1),D.lineAtlas.bind(g),Y.updatePaintBuffers(re)}function ac(D,u,g,w,C){if(!g||!w||!w.imageAtlas)return;const L=w.imageAtlas.patternPositions;let z=L[g.to.toString()],Y=L[g.from.toString()];if(!z&&Y&&(z=Y),!Y&&z&&(Y=z),!z||!Y){const re=C.getPaintProperty(u);z=L[re],Y=L[re]}z&&Y&&D.setConstantPatternPositions(z,Y)}function dl(D,u,g,w,C,L,z,Y){const re=D.context.gl,le="fill-pattern",fe=g.paint.get(le),Ie=fe&&fe.constantOr(1),Te=g.getCrossfadeParameters();let Ue,Ze,ft,pt,dt;const xt=D.transform,Ot=g.paint.get("fill-translate"),wt=g.paint.get("fill-translate-anchor");z?(Ze=Ie&&!g.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Ue=re.LINES):(Ze=Ie?"fillPattern":"fill",Ue=re.TRIANGLES);const Nt=fe.constantOr(null);for(const jt of w){const Dt=u.getTile(jt);if(Ie&&!Dt.patternsLoaded())continue;const Yt=Dt.getBucket(g);if(!Yt)continue;const Sr=Yt.programConfigurations.get(g.id),dr=D.useProgram(Ze,Sr),yr=D.style.map.terrain&&D.style.map.terrain.getTerrainData(jt);Ie&&(D.context.activeTexture.set(re.TEXTURE0),Dt.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),Sr.updatePaintBuffers(Te)),ac(Sr,le,Nt,Dt,g);const xr=xt.getProjectionData({overscaledTileID:jt,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),an=o.aO(xt,Dt,Ot,wt);if(z){pt=Yt.indexBuffer2,dt=Yt.segments2;const Hr=[re.drawingBufferWidth,re.drawingBufferHeight];ft=Ze==="fillOutlinePattern"&&Ie?mo(D,Te,Dt,Hr,an):Oo(Hr,an)}else pt=Yt.indexBuffer,dt=Yt.segments,ft=Ie?cu(D,Te,Dt,an):{u_fill_translate:an};const ln=D.stencilModeForClipping(jt);dr.draw(D.context,Ue,C,ln,L,ii.backCCW,ft,yr,xr,g.id,Yt.layoutVertexBuffer,pt,dt,g.paint,D.transform.zoom,Sr)}}function jp(D,u,g,w,C,L,z,Y){const re=D.context,le=re.gl,fe="fill-extrusion-pattern",Ie=g.paint.get(fe),Te=Ie.constantOr(1),Ue=g.getCrossfadeParameters(),Ze=g.paint.get("fill-extrusion-opacity"),ft=Ie.constantOr(null),pt=D.transform;for(const dt of w){const xt=u.getTile(dt),Ot=xt.getBucket(g);if(!Ot)continue;const wt=D.style.map.terrain&&D.style.map.terrain.getTerrainData(dt),Nt=Ot.programConfigurations.get(g.id),jt=D.useProgram(Te?"fillExtrusionPattern":"fillExtrusion",Nt);Te&&(D.context.activeTexture.set(le.TEXTURE0),xt.imageAtlasTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),Nt.updatePaintBuffers(Ue));const Dt=pt.getProjectionData({overscaledTileID:dt,applyGlobeMatrix:!Y,applyTerrainMatrix:!0});ac(Nt,fe,ft,xt,g);const Yt=o.aO(pt,xt,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),Sr=g.paint.get("fill-extrusion-vertical-gradient"),dr=Te?ul(D,Sr,Ze,Yt,dt,Ue,xt):ic(D,Sr,Ze,Yt);jt.draw(re,re.gl.TRIANGLES,C,L,z,ii.backCCW,dr,wt,Dt,g.id,Ot.layoutVertexBuffer,Ot.indexBuffer,Ot.segments,g.paint,D.transform.zoom,Nt,D.style.map.terrain&&Ot.centroidVertexBuffer)}}function _h(D,u,g,w,C,L,z,Y,re){var le;const fe=D.style.projection,Ie=D.context,Te=D.transform,Ue=Ie.gl,Ze=[`#define NUM_ILLUMINATION_SOURCES ${g.paint.get("hillshade-highlight-color").values.length}`],ft=D.useProgram("hillshade",null,!1,Ze),pt=!D.options.moving;for(const dt of w){const xt=u.getTile(dt),Ot=xt.fbo;if(!Ot)continue;const wt=fe.getMeshFromTileID(Ie,dt.canonical,Y,!0,"raster"),Nt=(le=D.style.map.terrain)===null||le===void 0?void 0:le.getTerrainData(dt);Ie.activeTexture.set(Ue.TEXTURE0),Ue.bindTexture(Ue.TEXTURE_2D,Ot.colorAttachment.get());const jt=Te.getProjectionData({overscaledTileID:dt,aligned:pt,applyGlobeMatrix:!re,applyTerrainMatrix:!0});ft.draw(Ie,Ue.TRIANGLES,L,C[dt.overscaledZ],z,ii.backCCW,Vl(D,xt,g),Nt,jt,g.id,wt.vertexBuffer,wt.indexBuffer,wt.segments)}}function Bf(D,u,g,w,C,L,z,Y,re){var le;const fe=D.style.projection,Ie=D.context,Te=D.transform,Ue=Ie.gl,Ze=D.useProgram("colorRelief"),ft=!D.options.moving;let pt=!0,dt=0;for(const xt of w){const Ot=u.getTile(xt),wt=Ot.dem;if(pt){const dr=Ue.getParameter(Ue.MAX_TEXTURE_SIZE),{elevationTexture:yr,colorTexture:xr}=g.getColorRampTextures(Ie,dr,wt.getUnpackVector());Ie.activeTexture.set(Ue.TEXTURE1),yr.bind(Ue.NEAREST,Ue.CLAMP_TO_EDGE),Ie.activeTexture.set(Ue.TEXTURE4),xr.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),pt=!1,dt=yr.size[0]}if(!wt||!wt.data)continue;const Nt=wt.stride,jt=wt.getPixels();if(Ie.activeTexture.set(Ue.TEXTURE0),Ie.pixelStoreUnpackPremultiplyAlpha.set(!1),Ot.demTexture=Ot.demTexture||D.getTileTexture(Nt),Ot.demTexture){const dr=Ot.demTexture;dr.update(jt,{premultiply:!1}),dr.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE)}else Ot.demTexture=new o.T(Ie,jt,Ue.RGBA,{premultiply:!1}),Ot.demTexture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE);const Dt=fe.getMeshFromTileID(Ie,xt.canonical,Y,!0,"raster"),Yt=(le=D.style.map.terrain)===null||le===void 0?void 0:le.getTerrainData(xt),Sr=Te.getProjectionData({overscaledTileID:xt,aligned:ft,applyGlobeMatrix:!re,applyTerrainMatrix:!0});Ze.draw(Ie,Ue.TRIANGLES,L,C[xt.overscaledZ],z,ii.backCCW,$l(g,Ot.dem,dt),Yt,Sr,g.id,Dt.vertexBuffer,Dt.indexBuffer,Dt.segments)}}const bh=[new o.P(0,0),new o.P(o.a5,0),new o.P(o.a5,o.a5),new o.P(0,o.a5)];function af(D,u,g,w,C,L,z,Y,re=!1,le=!1){const fe=w[w.length-1].overscaledZ,Ie=D.context,Te=Ie.gl,Ue=D.useProgram("raster"),Ze=D.transform,ft=D.style.projection,pt=D.colorModeForRenderPass(),dt=!D.options.moving,xt=g.paint.get("raster-opacity"),Ot=g.paint.get("raster-resampling"),wt=g.paint.get("raster-fade-duration"),Nt=!!D.style.map.terrain;for(const jt of w){const Dt=D.getDepthModeForSublayer(jt.overscaledZ-fe,xt===1?ri.ReadWrite:ri.ReadOnly,Te.LESS),Yt=u.getTile(jt),Sr=Ot==="nearest"?Te.NEAREST:Te.LINEAR;Ie.activeTexture.set(Te.TEXTURE0),Yt.texture.bind(Sr,Te.CLAMP_TO_EDGE,Te.LINEAR_MIPMAP_NEAREST),Ie.activeTexture.set(Te.TEXTURE1);const{parentTile:dr,parentScaleBy:yr,parentTopLeft:xr,fadeValues:an}=Xg(Yt,u,wt,Nt);Yt.fadeOpacity=an.tileOpacity,dr?(dr.fadeOpacity=an.parentTileOpacity,dr.texture.bind(Sr,Te.CLAMP_TO_EDGE,Te.LINEAR_MIPMAP_NEAREST)):Yt.texture.bind(Sr,Te.CLAMP_TO_EDGE,Te.LINEAR_MIPMAP_NEAREST),Yt.texture.useMipmap&&Ie.extTextureFilterAnisotropic&&D.transform.pitch>20&&Te.texParameterf(Te.TEXTURE_2D,Ie.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ie.extTextureFilterAnisotropicMax);const ln=D.style.map.terrain&&D.style.map.terrain.getTerrainData(jt),Hr=Ze.getProjectionData({overscaledTileID:jt,aligned:dt,applyGlobeMatrix:!le,applyTerrainMatrix:!0}),gn=In(xr,yr,an.fadeMix,g,Y),Ti=ft.getMeshFromTileID(Ie,jt.canonical,L,z,"raster");Ue.draw(Ie,Te.TRIANGLES,Dt,C?C[jt.overscaledZ]:ai.disabled,pt,re?ii.frontCCW:ii.backCCW,gn,ln,Hr,g.id,Ti.vertexBuffer,Ti.indexBuffer,Ti.segments)}}function Xg(D,u,g,w){const C={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(g===0||w)return C;if(D.fadingParentID){const L=u.getLoadedTile(D.fadingParentID);if(!L)return C;const z=Math.pow(2,L.tileID.overscaledZ-D.tileID.overscaledZ),Y=[D.tileID.canonical.x*z%1,D.tileID.canonical.y*z%1],re=(function(le,fe,Ie){const Te=T(),Ue=(Te-fe.timeAdded)/Ie,Ze=le.fadingDirection===ct.Incoming,ft=o.an((Te-le.timeAdded)/Ie,0,1),pt=o.an(1-Ue,0,1),dt=Ze?ft:pt;return{tileOpacity:dt,parentTileOpacity:Ze?pt:ft,fadeMix:{opacity:1,mix:1-dt}}})(D,L,g);return{parentTile:L,parentScaleBy:z,parentTopLeft:Y,fadeValues:re}}if(D.selfFading){const L=(function(z,Y){const re=(T()-z.timeAdded)/Y,le=o.an(re,0,1);return{tileOpacity:le,fadeMix:{opacity:le,mix:0}}})(D,g);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:L}}return C}const By=new o.bp(1,0,0,1),zd=new o.bp(0,1,0,1),jd=new o.bp(0,0,1,1),zf=new o.bp(1,0,1,1),wc=new o.bp(0,1,1,1);function Yg(D,u,g,w){Ud(D,0,u+g/2,D.transform.width,g,w)}function Up(D,u,g,w){Ud(D,u-g/2,0,g,D.transform.height,w)}function Ud(D,u,g,w,C,L){const z=D.context,Y=z.gl;Y.enable(Y.SCISSOR_TEST),Y.scissor(u*D.pixelRatio,g*D.pixelRatio,w*D.pixelRatio,C*D.pixelRatio),z.clear({color:L}),Y.disable(Y.SCISSOR_TEST)}function zy(D,u,g){const w=D.context,C=w.gl,L=D.useProgram("debug"),z=ri.disabled,Y=ai.disabled,re=D.colorModeForRenderPass(),le="$debug",fe=D.style.map.terrain&&D.style.map.terrain.getTerrainData(g);w.activeTexture.set(C.TEXTURE0);const Ie=u.getTileByID(g.key).latestRawTileData,Te=Math.floor((Ie&&Ie.byteLength||0)/1024),Ue=u.getTile(g).tileSize,Ze=512/Math.min(Ue,512)*(g.overscaledZ/D.transform.zoom)*.5;let ft=g.canonical.toString();g.overscaledZ!==g.canonical.z&&(ft+=` => ${g.overscaledZ}`),(function(dt,xt){dt.initDebugOverlayCanvas();const Ot=dt.debugOverlayCanvas,wt=dt.context.gl,Nt=dt.debugOverlayCanvas.getContext("2d");Nt.clearRect(0,0,Ot.width,Ot.height),Nt.shadowColor="white",Nt.shadowBlur=2,Nt.lineWidth=1.5,Nt.strokeStyle="white",Nt.textBaseline="top",Nt.font="bold 36px Open Sans, sans-serif",Nt.fillText(xt,5,5),Nt.strokeText(xt,5,5),dt.debugOverlayTexture.update(Ot),dt.debugOverlayTexture.bind(wt.LINEAR,wt.CLAMP_TO_EDGE)})(D,`${ft} ${Te}kB`);const pt=D.transform.getProjectionData({overscaledTileID:g,applyGlobeMatrix:!0,applyTerrainMatrix:!0});L.draw(w,C.TRIANGLES,z,Y,ji.alphaBlended,ii.disabled,Zs(o.bp.transparent,Ze),null,pt,le,D.debugBuffer,D.quadTriangleIndexBuffer,D.debugSegments),L.draw(w,C.LINE_STRIP,z,Y,re,ii.disabled,Zs(o.bp.red),fe,pt,le,D.debugBuffer,D.tileBorderIndexBuffer,D.debugSegments)}function Zg(D,u,g,w){const{isRenderingGlobe:C}=w,L=D.context,z=L.gl,Y=D.transform,re=D.colorModeForRenderPass(),le=D.getDepthModeFor3D(),fe=D.useProgram("terrain");L.bindFramebuffer.set(null),L.viewport.set([0,0,D.width,D.height]);for(const Ie of g){const Te=u.getTerrainMesh(Ie.tileID),Ue=D.renderToTexture.getTexture(Ie),Ze=u.getTerrainData(Ie.tileID);L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,Ue.texture);const ft=u.getMeshFrameDelta(Y.zoom),pt=Y.calculateFogMatrix(Ie.tileID.toUnwrapped()),dt=uu(ft,pt,D.style.sky,Y.pitch,C),xt=Y.getProjectionData({overscaledTileID:Ie.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});fe.draw(L,z.TRIANGLES,le,ai.disabled,re,ii.backCCW,dt,Ze,xt,"terrain",Te.vertexBuffer,Te.indexBuffer,Te.segments)}}function Kg(D,u){if(!u.mesh){const g=new o.aW;g.emplaceBack(-1,-1),g.emplaceBack(1,-1),g.emplaceBack(1,1),g.emplaceBack(-1,1);const w=new o.aY;w.emplaceBack(0,1,2),w.emplaceBack(0,2,3),u.mesh=new hi(D.createVertexBuffer(g,$i.members),D.createIndexBuffer(w),o.aX.simpleSegment(0,0,g.length,w.length))}return u.mesh}class jy{constructor(u,g){this.context=new Bp(u),this.transform=g,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ci.maxOverzooming+Ci.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _n}resize(u,g,w){if(this.width=Math.floor(u*w),this.height=Math.floor(g*w),this.pixelRatio=w,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style._order)this.style._layers[C].resize()}setup(){const u=this.context,g=new o.aW;g.emplaceBack(0,0),g.emplaceBack(o.a5,0),g.emplaceBack(0,o.a5),g.emplaceBack(o.a5,o.a5),this.tileExtentBuffer=u.createVertexBuffer(g,$i.members),this.tileExtentSegments=o.aX.simpleSegment(0,0,4,2);const w=new o.aW;w.emplaceBack(0,0),w.emplaceBack(o.a5,0),w.emplaceBack(0,o.a5),w.emplaceBack(o.a5,o.a5),this.debugBuffer=u.createVertexBuffer(w,$i.members),this.debugSegments=o.aX.simpleSegment(0,0,4,5);const C=new o.ch;C.emplaceBack(0,0,0,0),C.emplaceBack(o.a5,0,o.a5,0),C.emplaceBack(0,o.a5,0,o.a5),C.emplaceBack(o.a5,o.a5,o.a5,o.a5),this.rasterBoundsBuffer=u.createVertexBuffer(C,Ja.members),this.rasterBoundsSegments=o.aX.simpleSegment(0,0,4,2);const L=new o.aW;L.emplaceBack(0,0),L.emplaceBack(o.a5,0),L.emplaceBack(0,o.a5),L.emplaceBack(o.a5,o.a5),this.rasterBoundsBufferPosOnly=u.createVertexBuffer(L,$i.members),this.rasterBoundsSegmentsPosOnly=o.aX.simpleSegment(0,0,4,5);const z=new o.aW;z.emplaceBack(0,0),z.emplaceBack(1,0),z.emplaceBack(0,1),z.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(z,$i.members),this.viewportSegments=o.aX.simpleSegment(0,0,4,2);const Y=new o.ci;Y.emplaceBack(0),Y.emplaceBack(1),Y.emplaceBack(3),Y.emplaceBack(2),Y.emplaceBack(0),this.tileBorderIndexBuffer=u.createIndexBuffer(Y);const re=new o.aY;re.emplaceBack(1,0,2),re.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(re);const le=this.context.gl;this.stencilClearMode=new ai({func:le.ALWAYS,mask:0},0,255,le.ZERO,le.ZERO,le.ZERO),this.tileExtentMesh=new hi(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const u=this.context,g=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const w=o.N();o.c7(w,0,this.width,this.height,0,0,1),o.Q(w,w,[g.drawingBufferWidth,g.drawingBufferHeight,0]);const C={mainMatrix:w,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w};this.useProgram("clippingMask",null,!0).draw(u,g.TRIANGLES,ri.disabled,this.stencilClearMode,ji.disabled,ii.disabled,null,null,C,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(u,g,w){if(this.currentStencilSource===u.source||!u.isTileClipped()||!g||!g.length)return;this.currentStencilSource=u.source,this.nextStencilID+g.length>256&&this.clearStencil();const C=this.context;C.setColorMode(ji.disabled),C.setDepthMode(ri.disabled);const L={};for(const z of g)L[z.key]=this.nextStencilID++;this._renderTileMasks(L,g,w,!0),this._renderTileMasks(L,g,w,!1),this._tileClippingMaskIDs=L}_renderTileMasks(u,g,w,C){const L=this.context,z=L.gl,Y=this.style.projection,re=this.transform,le=this.useProgram("clippingMask");for(const fe of g){const Ie=u[fe.key],Te=this.style.map.terrain&&this.style.map.terrain.getTerrainData(fe),Ue=Y.getMeshFromTileID(this.context,fe.canonical,C,!0,"stencil"),Ze=re.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!w,applyTerrainMatrix:!0});le.draw(L,z.TRIANGLES,ri.disabled,new ai({func:z.ALWAYS,mask:0},Ie,255,z.KEEP,z.KEEP,z.REPLACE),ji.disabled,w?ii.disabled:ii.backCCW,null,Te,Ze,"$clipping",Ue.vertexBuffer,Ue.indexBuffer,Ue.segments)}}_renderTilesDepthBuffer(){const u=this.context,g=u.gl,w=this.style.projection,C=this.transform,L=this.useProgram("depth"),z=this.getDepthModeFor3D(),Y=Kn(C,{tileSize:C.tileSize});for(const re of Y){const le=this.style.map.terrain&&this.style.map.terrain.getTerrainData(re),fe=w.getMeshFromTileID(this.context,re.canonical,!0,!0,"raster"),Ie=C.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!0,applyTerrainMatrix:!0});L.draw(u,g.TRIANGLES,z,ai.disabled,ji.disabled,ii.backCCW,null,le,Ie,"$clipping",fe.vertexBuffer,fe.indexBuffer,fe.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const u=this.nextStencilID++,g=this.context.gl;return new ai({func:g.NOTEQUAL,mask:255},u,255,g.KEEP,g.KEEP,g.REPLACE)}stencilModeForClipping(u){const g=this.context.gl;return new ai({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,g.KEEP,g.KEEP,g.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(u){const g=this.context.gl,w=u.sort(((z,Y)=>Y.overscaledZ-z.overscaledZ)),C=w[w.length-1].overscaledZ,L=w[0].overscaledZ-C+1;if(L>1){this.currentStencilSource=void 0,this.nextStencilID+L>256&&this.clearStencil();const z={};for(let Y=0;Y<L;Y++)z[Y+C]=new ai({func:g.GEQUAL,mask:255},Y+this.nextStencilID,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID+=L,[z,w]}return[{[C]:ai.disabled},w]}stencilConfigForOverlapTwoPass(u){const g=this.context.gl,w=u.sort(((z,Y)=>Y.overscaledZ-z.overscaledZ)),C=w[w.length-1].overscaledZ,L=w[0].overscaledZ-C+1;if(this.clearStencil(),L>1){const z={},Y={};for(let re=0;re<L;re++)z[re+C]=new ai({func:g.GREATER,mask:255},L+1+re,255,g.KEEP,g.KEEP,g.REPLACE),Y[re+C]=new ai({func:g.GREATER,mask:255},1+re,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID=2*L+1,[z,Y,w]}return this.nextStencilID=3,[{[C]:new ai({func:g.GREATER,mask:255},2,255,g.KEEP,g.KEEP,g.REPLACE)},{[C]:new ai({func:g.GREATER,mask:255},1,255,g.KEEP,g.KEEP,g.REPLACE)},w]}colorModeForRenderPass(){const u=this.context.gl;return this._showOverdrawInspector?new ji([u.CONSTANT_COLOR,u.ONE],new o.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ji.unblended:ji.alphaBlended}getDepthModeForSublayer(u,g,w){if(!this.opaquePassEnabledForLayer())return ri.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new ri(w||this.context.gl.LEQUAL,g,[C,C])}getDepthModeFor3D(){return new ri(this.context.gl.LEQUAL,ri.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(u,g){var w,C;this.style=u,this.options=g,this.lineAtlas=u.lineAtlas,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(T()),this.imageManager.beginFrame();const L=this.style._order,z=this.style.tileManagers,Y={},re={},le={},fe={isRenderingToTexture:!1,isRenderingGlobe:((w=u.projection)===null||w===void 0?void 0:w.transitionState)>0};for(const Te in z){const Ue=z[Te];Ue.used&&Ue.prepare(this.context),Y[Te]=Ue.getVisibleCoordinates(!1),re[Te]=Y[Te].slice().reverse(),le[Te]=Ue.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Te=0;Te<L.length;Te++)if(this.style._layers[L[Te]].is3D()){this.opaquePassCutoff=Te;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Te of L){const Ue=this.style._layers[Te];if(!Ue.hasOffscreenPass()||Ue.isHidden(this.transform.zoom))continue;const Ze=re[Ue.source];(Ue.type==="custom"||Ze.length)&&this.renderLayer(this,z[Ue.source],Ue,Ze,fe)}if((C=this.style.projection)===null||C===void 0||C.updateGPUdependent({context:this.context,useProgram:Te=>this.useProgram(Te)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:g.showOverdrawInspector?o.bp.black:o.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(Te,Ue){const Ze=Te.context,ft=Ze.gl,pt=((jt,Dt,Yt)=>{const Sr=Math.cos(Dt.rollInRadians),dr=Math.sin(Dt.rollInRadians),yr=hn(Dt),xr=Dt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:jt.properties.get("sky-color"),u_horizon_color:jt.properties.get("horizon-color"),u_horizon:[(Dt.width/2-yr*dr)*Yt,(Dt.height/2+yr*Sr)*Yt],u_horizon_normal:[-dr,Sr],u_sky_horizon_blend:jt.properties.get("sky-horizon-blend")*Dt.height/2*Yt,u_sky_blend:xr}})(Ue,Te.style.map.transform,Te.pixelRatio),dt=new ri(ft.LEQUAL,ri.ReadWrite,[0,1]),xt=ai.disabled,Ot=Te.colorModeForRenderPass(),wt=Te.useProgram("sky"),Nt=Kg(Ze,Ue);wt.draw(Ze,ft.TRIANGLES,dt,xt,Ot,ii.disabled,pt,null,void 0,"sky",Nt.vertexBuffer,Nt.indexBuffer,Nt.segments)})(this,this.style.sky),this._showOverdrawInspector=g.showOverdrawInspector,this.depthRangeFor3D=[0,1-(u._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=L.length-1;this.currentLayer>=0;this.currentLayer--){const Te=this.style._layers[L[this.currentLayer]],Ue=z[Te.source],Ze=Y[Te.source];this._renderTileClippingMasks(Te,Ze,!1),this.renderLayer(this,Ue,Te,Ze,fe)}this.renderPass="translucent";let Ie=!1;for(this.currentLayer=0;this.currentLayer<L.length;this.currentLayer++){const Te=this.style._layers[L[this.currentLayer]],Ue=z[Te.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Te,fe))continue;this.opaquePassEnabledForLayer()||Ie||(Ie=!0,fe.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Ze=(Te.type==="symbol"?le:re)[Te.source];this._renderTileClippingMasks(Te,Y[Te.source],!!this.renderToTexture),this.renderLayer(this,Ue,Te,Ze,fe)}if(fe.isRenderingGlobe&&(function(Te,Ue,Ze){const ft=Te.context,pt=ft.gl,dt=Te.useProgram("atmosphere"),xt=new ri(pt.LEQUAL,ri.ReadOnly,[0,1]),Ot=Te.transform,wt=(function(xr,an){const ln=xr.properties.get("position"),Hr=[-ln.x,-ln.y,-ln.z],gn=o.ar(new Float64Array(16));return xr.properties.get("anchor")==="map"&&(o.bg(gn,gn,an.rollInRadians),o.bh(gn,gn,-an.pitchInRadians),o.bg(gn,gn,an.bearingInRadians),o.bh(gn,gn,an.center.lat*Math.PI/180),o.bJ(gn,gn,-an.center.lng*Math.PI/180)),o.cg(Hr,Hr,gn),Hr})(Ze,Te.transform),Nt=Ot.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),jt=Ue.properties.get("atmosphere-blend")*Nt.projectionTransition;if(jt===0)return;const Dt=Ui(Ot.worldSize,Ot.center.lat),Yt=Ot.inverseProjectionMatrix,Sr=new Float64Array(4);Sr[3]=1,o.aH(Sr,Sr,Ot.modelViewProjectionMatrix),Sr[0]/=Sr[3],Sr[1]/=Sr[3],Sr[2]/=Sr[3],Sr[3]=1,o.aH(Sr,Sr,Yt),Sr[0]/=Sr[3],Sr[1]/=Sr[3],Sr[2]/=Sr[3],Sr[3]=1;const dr=((xr,an,ln,Hr,gn)=>({u_sun_pos:xr,u_atmosphere_blend:an,u_globe_position:ln,u_globe_radius:Hr,u_inv_proj_matrix:gn}))(wt,jt,[Sr[0],Sr[1],Sr[2]],Dt,Yt),yr=Kg(ft,Ue);dt.draw(ft,pt.TRIANGLES,xt,ai.disabled,ji.alphaBlended,ii.disabled,dr,null,null,"atmosphere",yr.vertexBuffer,yr.indexBuffer,yr.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Te=(function(Ue,Ze){let ft=null;const pt=Object.values(Ue._layers).flatMap((wt=>wt.source&&!wt.isHidden(Ze)?[Ue.tileManagers[wt.source]]:[])),dt=pt.filter((wt=>wt.getSource().type==="vector")),xt=pt.filter((wt=>wt.getSource().type!=="vector")),Ot=wt=>{(!ft||ft.getSource().maxzoom<wt.getSource().maxzoom)&&(ft=wt)};return dt.forEach((wt=>Ot(wt))),ft||xt.forEach((wt=>Ot(wt))),ft})(this.style,this.transform.zoom);Te&&(function(Ue,Ze,ft){for(let pt=0;pt<ft.length;pt++)zy(Ue,Ze,ft[pt])})(this,Te,Te.getVisibleCoordinates())}this.options.showPadding&&(function(Te){const Ue=Te.transform.padding;Yg(Te,Te.transform.height-(Ue.top||0),3,By),Yg(Te,Ue.bottom||0,3,zd),Up(Te,Ue.left||0,3,jd),Up(Te,Te.transform.width-(Ue.right||0),3,zf);const Ze=Te.transform.centerPoint;(function(ft,pt,dt,xt){Ud(ft,pt-1,dt-10,2,20,xt),Ud(ft,pt-10,dt-1,20,2,xt)})(Te,Ze.x,Te.transform.height-Ze.y,wc)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(u){if(!this.style||!this.style.map||!this.style.map.terrain)return;const g=this.terrainFacilitator.matrix,w=this.transform.modelViewProjectionMatrix;let C=this.terrainFacilitator.dirty;C||(C=u?!o.cj(g,w):!o.ck(g,w)),C||(C=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),C&&(o.cl(g,w),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(L,z){const Y=L.context,re=Y.gl,le=L.transform,fe=ji.unblended,Ie=new ri(re.LEQUAL,ri.ReadWrite,[0,1]),Te=z.tileManager.getRenderableTiles(),Ue=L.useProgram("terrainDepth");Y.bindFramebuffer.set(z.getFramebuffer("depth").framebuffer),Y.viewport.set([0,0,L.width/devicePixelRatio,L.height/devicePixelRatio]),Y.clear({color:o.bp.transparent,depth:1});for(const Ze of Te){const ft=z.getTerrainMesh(Ze.tileID),pt=z.getTerrainData(Ze.tileID),dt=le.getProjectionData({overscaledTileID:Ze.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),xt={u_ele_delta:z.getMeshFrameDelta(le.zoom)};Ue.draw(Y,re.TRIANGLES,Ie,ai.disabled,fe,ii.backCCW,xt,pt,dt,"terrain",ft.vertexBuffer,ft.indexBuffer,ft.segments)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,L.width,L.height])})(this,this.style.map.terrain),(function(L,z){const Y=L.context,re=Y.gl,le=L.transform,fe=ji.unblended,Ie=new ri(re.LEQUAL,ri.ReadWrite,[0,1]),Te=z.getCoordsTexture(),Ue=z.tileManager.getRenderableTiles(),Ze=L.useProgram("terrainCoords");Y.bindFramebuffer.set(z.getFramebuffer("coords").framebuffer),Y.viewport.set([0,0,L.width/devicePixelRatio,L.height/devicePixelRatio]),Y.clear({color:o.bp.transparent,depth:1}),z.coordsIndex=[];for(const ft of Ue){const pt=z.getTerrainMesh(ft.tileID),dt=z.getTerrainData(ft.tileID);Y.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_2D,Te.texture);const xt={u_terrain_coords_id:(255-z.coordsIndex.length)/255,u_texture:0,u_ele_delta:z.getMeshFrameDelta(le.zoom)},Ot=le.getProjectionData({overscaledTileID:ft.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Ze.draw(Y,re.TRIANGLES,Ie,ai.disabled,fe,ii.backCCW,xt,dt,Ot,"terrain",pt.vertexBuffer,pt.indexBuffer,pt.segments),z.coordsIndex.push(ft.tileID.key)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,L.width,L.height])})(this,this.style.map.terrain))}renderLayer(u,g,w,C,L){w.isHidden(this.transform.zoom)||(w.type==="background"||w.type==="custom"||(C||[]).length)&&(this.id=w.id,o.cm(w)?(function(z,Y,re,le,fe,Ie){if(z.renderPass!=="translucent")return;const{isRenderingToTexture:Te}=Ie,Ue=ai.disabled,Ze=z.colorModeForRenderPass();(re._unevaluatedLayout.hasValue("text-variable-anchor")||re._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(ft,pt,dt,xt,Ot,wt,Nt,jt,Dt){const Yt=pt.transform,Sr=pt.style.map.terrain,dr=Ot==="map",yr=wt==="map";for(const xr of ft){const an=xt.getTile(xr),ln=an.getBucket(dt);if(!ln||!ln.text||!ln.text.segments.get().length)continue;const Hr=o.ay(ln.textSizeData,Yt.zoom),gn=o.aN(an,1,pt.transform.zoom),Ti=ei(dr,pt.transform,gn),Ra=dt.layout.get("icon-text-fit")!=="none"&&ln.hasIconData();if(Hr){const yo=Math.pow(2,Yt.zoom-an.tileID.overscaledZ),to=Sr?(Ao,ro)=>Sr.getElevation(xr,Ao,ro):null;Nd(ln,dr,yr,Dt,Yt,Ti,yo,Hr,Ra,o.aO(Yt,an,Nt,jt),xr.toUnwrapped(),to)}}})(le,z,re,Y,re.layout.get("text-rotation-alignment"),re.layout.get("text-pitch-alignment"),re.paint.get("text-translate"),re.paint.get("text-translate-anchor"),fe),re.paint.get("icon-opacity").constantOr(1)!==0&&Ld(z,Y,re,le,!1,re.paint.get("icon-translate"),re.paint.get("icon-translate-anchor"),re.layout.get("icon-rotation-alignment"),re.layout.get("icon-pitch-alignment"),re.layout.get("icon-keep-upright"),Ue,Ze,Te),re.paint.get("text-opacity").constantOr(1)!==0&&Ld(z,Y,re,le,!0,re.paint.get("text-translate"),re.paint.get("text-translate-anchor"),re.layout.get("text-rotation-alignment"),re.layout.get("text-pitch-alignment"),re.layout.get("text-keep-upright"),Ue,Ze,Te),Y.map.showCollisionBoxes&&(tf(z,Y,re,le,!0),tf(z,Y,re,le,!1))})(u,g,w,C,this.style.placement.variableOffsets,L):o.cn(w)?(function(z,Y,re,le,fe){if(z.renderPass!=="translucent")return;const{isRenderingToTexture:Ie}=fe,Te=re.paint.get("circle-opacity"),Ue=re.paint.get("circle-stroke-width"),Ze=re.paint.get("circle-stroke-opacity"),ft=!re.layout.get("circle-sort-key").isConstant();if(Te.constantOr(1)===0&&(Ue.constantOr(1)===0||Ze.constantOr(1)===0))return;const pt=z.context,dt=pt.gl,xt=z.transform,Ot=z.getDepthModeForSublayer(0,ri.ReadOnly),wt=ai.disabled,Nt=z.colorModeForRenderPass(),jt=[],Dt=xt.getCircleRadiusCorrection();for(let Yt=0;Yt<le.length;Yt++){const Sr=le[Yt],dr=Y.getTile(Sr),yr=dr.getBucket(re);if(!yr)continue;const xr=re.paint.get("circle-translate"),an=re.paint.get("circle-translate-anchor"),ln=o.aO(xt,dr,xr,an),Hr=yr.programConfigurations.get(re.id),gn=z.useProgram("circle",Hr),Ti=yr.layoutVertexBuffer,Ra=yr.indexBuffer,yo=z.style.map.terrain&&z.style.map.terrain.getTerrainData(Sr),to={programConfiguration:Hr,program:gn,layoutVertexBuffer:Ti,indexBuffer:Ra,uniformValues:Du(z,dr,re,ln,Dt),terrainData:yo,projectionData:xt.getProjectionData({overscaledTileID:Sr,applyGlobeMatrix:!Ie,applyTerrainMatrix:!0})};if(ft){const Ao=yr.segments.get();for(const ro of Ao)jt.push({segments:new o.aX([ro]),sortKey:ro.sortKey,state:to})}else jt.push({segments:yr.segments,sortKey:0,state:to})}ft&&jt.sort(((Yt,Sr)=>Yt.sortKey-Sr.sortKey));for(const Yt of jt){const{programConfiguration:Sr,program:dr,layoutVertexBuffer:yr,indexBuffer:xr,uniformValues:an,terrainData:ln,projectionData:Hr}=Yt.state;dr.draw(pt,dt.TRIANGLES,Ot,wt,Nt,ii.backCCW,an,ln,Hr,re.id,yr,xr,Yt.segments,re.paint,z.transform.zoom,Sr)}})(u,g,w,C,L):o.co(w)?(function(z,Y,re,le,fe){if(re.paint.get("heatmap-opacity")===0)return;const Ie=z.context,{isRenderingToTexture:Te,isRenderingGlobe:Ue}=fe;if(z.style.map.terrain){for(const Ze of le){const ft=Y.getTile(Ze);Y.hasRenderableParent(Ze)||(z.renderPass==="offscreen"?Ly(z,ft,re,Ze,Ue):z.renderPass==="translucent"&&Fy(z,re,Ze,Te,Ue))}Ie.viewport.set([0,0,z.width,z.height])}else z.renderPass==="offscreen"?(function(Ze,ft,pt,dt){const xt=Ze.context,Ot=xt.gl,wt=Ze.transform,Nt=ai.disabled,jt=new ji([Ot.ONE,Ot.ONE],o.bp.transparent,[!0,!0,!0,!0]);(function(Dt,Yt,Sr){const dr=Dt.gl;Dt.activeTexture.set(dr.TEXTURE1),Dt.viewport.set([0,0,Yt.width/4,Yt.height/4]);let yr=Sr.heatmapFbos.get(o.cd);yr?(dr.bindTexture(dr.TEXTURE_2D,yr.colorAttachment.get()),Dt.bindFramebuffer.set(yr.framebuffer)):(yr=Bd(Dt,Yt.width/4,Yt.height/4),Sr.heatmapFbos.set(o.cd,yr))})(xt,Ze,pt),xt.clear({color:o.bp.transparent});for(let Dt=0;Dt<dt.length;Dt++){const Yt=dt[Dt];if(ft.hasRenderableParent(Yt))continue;const Sr=ft.getTile(Yt),dr=Sr.getBucket(pt);if(!dr)continue;const yr=dr.programConfigurations.get(pt.id),xr=Ze.useProgram("heatmap",yr),an=wt.getProjectionData({overscaledTileID:Yt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ln=wt.getCircleRadiusCorrection();xr.draw(xt,Ot.TRIANGLES,ri.disabled,Nt,jt,ii.backCCW,ms(Sr,wt.zoom,pt.paint.get("heatmap-intensity"),ln),null,an,pt.id,dr.layoutVertexBuffer,dr.indexBuffer,dr.segments,pt.paint,wt.zoom,yr)}xt.viewport.set([0,0,Ze.width,Ze.height])})(z,Y,re,le):z.renderPass==="translucent"&&(function(Ze,ft){const pt=Ze.context,dt=pt.gl;pt.setColorMode(Ze.colorModeForRenderPass());const xt=ft.heatmapFbos.get(o.cd);xt&&(pt.activeTexture.set(dt.TEXTURE0),dt.bindTexture(dt.TEXTURE_2D,xt.colorAttachment.get()),pt.activeTexture.set(dt.TEXTURE1),zp(pt,ft).bind(dt.LINEAR,dt.CLAMP_TO_EDGE),Ze.useProgram("heatmapTexture").draw(pt,dt.TRIANGLES,ri.disabled,ai.disabled,Ze.colorModeForRenderPass(),ii.disabled,Va(Ze,ft,0,1),null,null,ft.id,Ze.viewportBuffer,Ze.quadTriangleIndexBuffer,Ze.viewportSegments,ft.paint,Ze.transform.zoom))})(z,re)})(u,g,w,C,L):o.cp(w)?(function(z,Y,re,le,fe){if(z.renderPass!=="translucent")return;const{isRenderingToTexture:Ie}=fe,Te=re.paint.get("line-opacity"),Ue=re.paint.get("line-width");if(Te.constantOr(1)===0||Ue.constantOr(1)===0)return;const Ze=z.getDepthModeForSublayer(0,ri.ReadOnly),ft=z.colorModeForRenderPass(),pt=re.paint.get("line-dasharray"),dt=pt.constantOr(1),xt=re.paint.get("line-pattern"),Ot=xt.constantOr(1),wt=re.paint.get("line-gradient"),Nt=re.getCrossfadeParameters();let jt;jt=Ot?"linePattern":dt&&wt?"lineGradientSDF":dt?"lineSDF":wt?"lineGradient":"line";const Dt=z.context,Yt=Dt.gl,Sr=z.transform;let dr=!0;for(const yr of le){const xr=Y.getTile(yr);if(Ot&&!xr.patternsLoaded())continue;const an=xr.getBucket(re);if(!an)continue;const ln=an.programConfigurations.get(re.id),Hr=z.context.program.get(),gn=z.useProgram(jt,ln),Ti=dr||gn.program!==Hr,Ra=z.style.map.terrain&&z.style.map.terrain.getTerrainData(yr),yo=xt.constantOr(null),to=pt&&pt.constantOr(null);if(yo&&xr.imageAtlas){const pl=xr.imageAtlas,vs=pl.patternPositions[yo.to.toString()],as=pl.patternPositions[yo.from.toString()];vs&&as&&ln.setConstantPatternPositions(vs,as)}else if(to){const pl=re.layout.get("line-cap")==="round",vs=z.lineAtlas.getDash(to.to,pl),as=z.lineAtlas.getDash(to.from,pl);ln.setConstantDashPositions(vs,as)}const Ao=Sr.getProjectionData({overscaledTileID:yr,applyGlobeMatrix:!Ie,applyTerrainMatrix:!0}),ro=Sr.getPixelScale();let Xo;Ot?(Xo=Hl(z,xr,re,ro,Nt),Lu(Dt,Yt,xr,ln,Nt)):dt&&wt?(Xo=tr(z,xr,re,ro,Nt,an.lineClipsArray.length),Xl(z,Y,Dt,Yt,re,an,yr,ln,Nt)):dt?(Xo=Ou(z,xr,re,ro,Nt),xa(z,Dt,Yt,ln,Ti,Nt)):wt?(Xo=fl(z,xr,re,ro,an.lineClipsArray.length),nf(z,Y,Dt,Yt,re,an,yr)):Xo=ql(z,xr,re,ro);const Io=z.stencilModeForClipping(yr);gn.draw(Dt,Yt.TRIANGLES,Ze,Io,ft,ii.disabled,Xo,Ra,Ao,re.id,an.layoutVertexBuffer,an.indexBuffer,an.segments,re.paint,z.transform.zoom,ln,an.layoutVertexBuffer2),dr=!1}})(u,g,w,C,L):o.cq(w)?(function(z,Y,re,le,fe){const Ie=re.paint.get("fill-color"),Te=re.paint.get("fill-opacity");if(Te.constantOr(1)===0)return;const{isRenderingToTexture:Ue}=fe,Ze=z.colorModeForRenderPass(),ft=re.paint.get("fill-pattern"),pt=z.opaquePassEnabledForLayer()&&!ft.constantOr(1)&&Ie.constantOr(o.bp.transparent).a===1&&Te.constantOr(0)===1?"opaque":"translucent";if(z.renderPass===pt){const dt=z.getDepthModeForSublayer(1,z.renderPass==="opaque"?ri.ReadWrite:ri.ReadOnly);dl(z,Y,re,le,dt,Ze,!1,Ue)}if(z.renderPass==="translucent"&&re.paint.get("fill-antialias")){const dt=z.getDepthModeForSublayer(re.getPaintProperty("fill-outline-color")?2:0,ri.ReadOnly);dl(z,Y,re,le,dt,Ze,!0,Ue)}})(u,g,w,C,L):o.cr(w)?(function(z,Y,re,le,fe){const Ie=re.paint.get("fill-extrusion-opacity");if(Ie===0)return;const{isRenderingToTexture:Te}=fe;if(z.renderPass==="translucent"){const Ue=new ri(z.context.gl.LEQUAL,ri.ReadWrite,z.depthRangeFor3D);if(Ie!==1||re.paint.get("fill-extrusion-pattern").constantOr(1))jp(z,Y,re,le,Ue,ai.disabled,ji.disabled,Te),jp(z,Y,re,le,Ue,z.stencilModeFor3D(),z.colorModeForRenderPass(),Te);else{const Ze=z.colorModeForRenderPass();jp(z,Y,re,le,Ue,ai.disabled,Ze,Te)}}})(u,g,w,C,L):o.cs(w)?(function(z,Y,re,le,fe){if(z.renderPass!=="offscreen"&&z.renderPass!=="translucent")return;const{isRenderingToTexture:Ie}=fe,Te=z.context,Ue=z.style.projection.useSubdivision,Ze=z.getDepthModeForSublayer(0,ri.ReadOnly),ft=z.colorModeForRenderPass();if(z.renderPass==="offscreen")(function(pt,dt,xt,Ot,wt,Nt,jt){const Dt=pt.context,Yt=Dt.gl;for(const Sr of xt){const dr=dt.getTile(Sr),yr=dr.dem;if(!yr||!yr.data||!dr.needsHillshadePrepare)continue;const xr=yr.dim,an=yr.stride,ln=yr.getPixels();if(Dt.activeTexture.set(Yt.TEXTURE1),Dt.pixelStoreUnpackPremultiplyAlpha.set(!1),dr.demTexture=dr.demTexture||pt.getTileTexture(an),dr.demTexture){const gn=dr.demTexture;gn.update(ln,{premultiply:!1}),gn.bind(Yt.NEAREST,Yt.CLAMP_TO_EDGE)}else dr.demTexture=new o.T(Dt,ln,Yt.RGBA,{premultiply:!1}),dr.demTexture.bind(Yt.NEAREST,Yt.CLAMP_TO_EDGE);Dt.activeTexture.set(Yt.TEXTURE0);let Hr=dr.fbo;if(!Hr){const gn=new o.T(Dt,{width:xr,height:xr,data:null},Yt.RGBA);gn.bind(Yt.LINEAR,Yt.CLAMP_TO_EDGE),Hr=dr.fbo=Dt.createFramebuffer(xr,xr,!0,!1),Hr.colorAttachment.set(gn.texture)}Dt.bindFramebuffer.set(Hr.framebuffer),Dt.viewport.set([0,0,xr,xr]),pt.useProgram("hillshadePrepare").draw(Dt,Yt.TRIANGLES,wt,Nt,jt,ii.disabled,cl(dr.tileID,yr),null,null,Ot.id,pt.rasterBoundsBuffer,pt.quadTriangleIndexBuffer,pt.rasterBoundsSegments),dr.needsHillshadePrepare=!1}})(z,Y,le,re,Ze,ai.disabled,ft),Te.viewport.set([0,0,z.width,z.height]);else if(z.renderPass==="translucent")if(Ue){const[pt,dt,xt]=z.stencilConfigForOverlapTwoPass(le);_h(z,Y,re,xt,pt,Ze,ft,!1,Ie),_h(z,Y,re,xt,dt,Ze,ft,!0,Ie)}else{const[pt,dt]=z.getStencilConfigForOverlapAndUpdateStencilID(le);_h(z,Y,re,dt,pt,Ze,ft,!1,Ie)}})(u,g,w,C,L):o.ct(w)?(function(z,Y,re,le,fe){if(z.renderPass!=="translucent"||!le.length)return;const{isRenderingToTexture:Ie}=fe,Te=z.style.projection.useSubdivision,Ue=z.getDepthModeForSublayer(0,ri.ReadOnly),Ze=z.colorModeForRenderPass();if(Te){const[ft,pt,dt]=z.stencilConfigForOverlapTwoPass(le);Bf(z,Y,re,dt,ft,Ue,Ze,!1,Ie),Bf(z,Y,re,dt,pt,Ue,Ze,!0,Ie)}else{const[ft,pt]=z.getStencilConfigForOverlapAndUpdateStencilID(le);Bf(z,Y,re,pt,ft,Ue,Ze,!1,Ie)}})(u,g,w,C,L):o.bU(w)?(function(z,Y,re,le,fe){if(z.renderPass!=="translucent"||re.paint.get("raster-opacity")===0||!le.length)return;const{isRenderingToTexture:Ie}=fe,Te=Y.getSource(),Ue=z.style.projection.useSubdivision;if(Te instanceof Qt)af(z,Y,re,le,null,!1,!1,Te.tileCoords,Te.flippedWindingOrder,Ie);else if(Ue){const[Ze,ft,pt]=z.stencilConfigForOverlapTwoPass(le);af(z,Y,re,pt,Ze,!1,!0,bh,!1,Ie),af(z,Y,re,pt,ft,!0,!0,bh,!1,Ie)}else{const[Ze,ft]=z.getStencilConfigForOverlapAndUpdateStencilID(le);af(z,Y,re,ft,Ze,!1,!0,bh,!1,Ie)}})(u,g,w,C,L):o.cu(w)?(function(z,Y,re,le,fe){const Ie=re.paint.get("background-color"),Te=re.paint.get("background-opacity");if(Te===0)return;const{isRenderingToTexture:Ue}=fe,Ze=z.context,ft=Ze.gl,pt=z.style.projection,dt=z.transform,xt=dt.tileSize,Ot=re.paint.get("background-pattern");if(z.isPatternMissing(Ot))return;const wt=!Ot&&Ie.a===1&&Te===1&&z.opaquePassEnabledForLayer()?"opaque":"translucent";if(z.renderPass!==wt)return;const Nt=ai.disabled,jt=z.getDepthModeForSublayer(0,wt==="opaque"?ri.ReadWrite:ri.ReadOnly),Dt=z.colorModeForRenderPass(),Yt=z.useProgram(Ot?"backgroundPattern":"background"),Sr=le||Kn(dt,{tileSize:xt,terrain:z.style.map.terrain});Ot&&(Ze.activeTexture.set(ft.TEXTURE0),z.imageManager.bind(z.context));const dr=re.getCrossfadeParameters();for(const yr of Sr){const xr=dt.getProjectionData({overscaledTileID:yr,applyGlobeMatrix:!Ue,applyTerrainMatrix:!0}),an=Ot?P(Te,z,Ot,{tileID:yr,tileSize:xt},dr):_(Te,Ie),ln=z.style.map.terrain&&z.style.map.terrain.getTerrainData(yr),Hr=pt.getMeshFromTileID(Ze,yr.canonical,!1,!0,"raster");Yt.draw(Ze,ft.TRIANGLES,jt,Nt,Dt,ii.backCCW,an,ln,xr,re.id,Hr.vertexBuffer,Hr.indexBuffer,Hr.segments)}})(u,0,w,C,L):o.cv(w)&&(function(z,Y,re,le){const{isRenderingGlobe:fe}=le,Ie=z.context,Te=re.implementation,Ue=z.style.projection,Ze=z.transform,ft=Ze.getProjectionDataForCustomLayer(fe),pt={farZ:Ze.farZ,nearZ:Ze.nearZ,fov:Ze.fov*Math.PI/180,modelViewProjectionMatrix:Ze.modelViewProjectionMatrix,projectionMatrix:Ze.projectionMatrix,shaderData:{variantName:Ue.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Ue.shaderPreludeCode.vertexSource}`,define:Ue.shaderDefine},defaultProjectionData:ft},dt=Te.renderingMode?Te.renderingMode:"2d";if(z.renderPass==="offscreen"){const xt=Te.prerender;xt&&(z.setCustomLayerDefaults(),Ie.setColorMode(z.colorModeForRenderPass()),xt.call(Te,Ie.gl,pt),Ie.setDirty(),z.setBaseState())}else if(z.renderPass==="translucent"){z.setCustomLayerDefaults(),Ie.setColorMode(z.colorModeForRenderPass()),Ie.setStencilMode(ai.disabled);const xt=dt==="3d"?z.getDepthModeFor3D():z.getDepthModeForSublayer(0,ri.ReadOnly);Ie.setDepthMode(xt),Te.render(Ie.gl,pt),Ie.setDirty(),z.setBaseState(),Ie.bindFramebuffer.set(null)}})(u,0,w,L))}saveTileTexture(u){const g=this._tileTextures[u.size[0]];g?g.push(u):this._tileTextures[u.size[0]]=[u]}getTileTexture(u){const g=this._tileTextures[u];return g&&g.length>0?g.pop():null}isPatternMissing(u){if(!u)return!1;if(!u.from||!u.to)return!0;const g=this.imageManager.getPattern(u.from.toString()),w=this.imageManager.getPattern(u.to.toString());return!g||!w}useProgram(u,g,w=!1,C=[]){this.cache=this.cache||{};const L=!!this.style.map.terrain,z=this.style.projection,Y=w?fn.projectionMercator:z.shaderPreludeCode,re=w?ba:z.shaderDefine,le=u+(g?g.cacheKey:"")+`/${w?wi:z.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(L?"/terrain":"")+(C?`/${C.join("/")}`:"");return this.cache[le]||(this.cache[le]=new Is(this.context,fn[u],g,ne[u],this._showOverdrawInspector,L,Y,re,C)),this.cache[le]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var u,g;if(this._tileTextures){for(const w in this._tileTextures){const C=this._tileTextures[w];if(C)for(const L of C)L.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((u=this.tileExtentMesh.vertexBuffer)===null||u===void 0||u.destroy()),this.tileExtentMesh&&((g=this.tileExtentMesh.indexBuffer)===null||g===void 0||g.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const w in this.cache){const C=this.cache[w];C&&C.program&&this.context.gl.deleteProgram(C.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:u,drawingBufferHeight:g}=this.context.gl;return this.width!==u||this.height!==g}}function Jg(D,u){let g,w=!1,C=null,L=null;const z=()=>{C=null,w&&(D.apply(L,g),C=setTimeout(z,u),w=!1)};return(...Y)=>(w=!0,L=this,g=Y,C||z(),C)}class Vp{constructor(u){this._getCurrentHash=()=>{const g=window.location.hash.replace("#","");if(this._hashName){let w;return g.split("&").map((C=>C.split("="))).forEach((C=>{C[0]===this._hashName&&(w=C)})),(w&&w[1]||"").split("/")}return g.split("/")},this._onHashChange=()=>{const g=this._getCurrentHash();if(!this._isValidHash(g))return!1;const w=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(g[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+g[2],+g[1]],zoom:+g[0],bearing:w,pitch:+(g[4]||0)}),!0},this._updateHashUnthrottled=()=>{const g=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,g)},this._removeHash=()=>{const g=this._getCurrentHash();if(g.length===0)return;const w=g.join("/");let C=w;C.split("&").length>0&&(C=C.split("&")[0]),this._hashName&&(C=`${this._hashName}=${w}`);let L=window.location.hash.replace(C,"");L.startsWith("#&")?L=L.slice(0,1)+L.slice(2):L==="#"&&(L="");let z=window.location.href.replace(/(#.+)?$/,L);z=z.replace("&&","&"),window.history.replaceState(window.history.state,null,z)},this._updateHash=Jg(this._updateHashUnthrottled,300),this._hashName=u&&encodeURIComponent(u)}addTo(u){return this._map=u,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(u){const g=this._map.getCenter(),w=Math.round(100*this._map.getZoom())/100,C=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),L=Math.pow(10,C),z=Math.round(g.lng*L)/L,Y=Math.round(g.lat*L)/L,re=this._map.getBearing(),le=this._map.getPitch();let fe="";if(fe+=u?`/${z}/${Y}/${w}`:`${w}/${Y}/${z}`,(re||le)&&(fe+="/"+Math.round(10*re)/10),le&&(fe+=`/${Math.round(le)}`),this._hashName){const Ie=this._hashName;let Te=!1;const Ue=window.location.hash.slice(1).split("&").map((Ze=>{const ft=Ze.split("=")[0];return ft===Ie?(Te=!0,`${ft}=${fe}`):Ze})).filter((Ze=>Ze));return Te||Ue.push(`${Ie}=${fe}`),`#${Ue.join("&")}`}return`#${fe}`}_isValidHash(u){if(u.length<3||u.some(isNaN))return!1;try{new o.V(+u[2],+u[1])}catch{return!1}const g=+u[0],w=+(u[3]||0),C=+(u[4]||0);return g>=this._map.getMinZoom()&&g<=this._map.getMaxZoom()&&w>=-180&&w<=180&&C>=this._map.getMinPitch()&&C<=this._map.getMaxPitch()}}const oc={linearity:.3,easing:o.cw(0,0,.3,1)},Uy=o.e({deceleration:2500,maxSpeed:1400},oc),Fu=o.e({deceleration:20,maxSpeed:1400},oc),Bu=o.e({deceleration:1e3,maxSpeed:360},oc),q=o.e({deceleration:1e3,maxSpeed:90},oc),K=o.e({deceleration:1e3,maxSpeed:360},oc);class ge{constructor(u){this._map=u,this.clear()}clear(){this._inertiaBuffer=[]}record(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:T(),settings:u})}_drainInertiaBuffer(){const u=this._inertiaBuffer,g=T();for(;u.length>0&&g-u[0].time>160;)u.shift()}_onMoveEnd(u){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const g={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:L}of this._inertiaBuffer)g.zoom+=L.zoomDelta||0,g.bearing+=L.bearingDelta||0,g.pitch+=L.pitchDelta||0,g.roll+=L.rollDelta||0,L.panDelta&&g.pan._add(L.panDelta),L.around&&(g.around=L.around),L.pinchAround&&(g.pinchAround=L.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(g.pan.mag()){const L=Ye(g.pan.mag(),w,o.e({},Uy,u||{})),z=g.pan.mult(L.amount/g.pan.mag()),Y=this._map.cameraHelper.handlePanInertia(z,this._map.transform);C.center=Y.easingCenter,C.offset=Y.easingOffset,Pe(C,L)}if(g.zoom){const L=Ye(g.zoom,w,Fu);C.zoom=this._map.transform.zoom+L.amount,Pe(C,L)}if(g.bearing){const L=Ye(g.bearing,w,Bu);C.bearing=this._map.transform.bearing+o.an(L.amount,-179,179),Pe(C,L)}if(g.pitch){const L=Ye(g.pitch,w,q);C.pitch=this._map.transform.pitch+L.amount,Pe(C,L)}if(g.roll){const L=Ye(g.roll,w,K);C.roll=this._map.transform.roll+o.an(L.amount,-179,179),Pe(C,L)}if(C.zoom||C.bearing){const L=g.pinchAround===void 0?g.around:g.pinchAround;C.around=L?this._map.unproject(L):this._map.getCenter()}return this.clear(),o.e(C,{noMoveStart:!0})}}function Pe(D,u){(!D.duration||D.duration<u.duration)&&(D.duration=u.duration,D.easing=u.easing)}function Ye(D,u,g){const{maxSpeed:w,linearity:C,deceleration:L}=g,z=o.an(D*C/(u/1e3),-w,w),Y=Math.abs(z)/(L*C);return{easing:g.easing,duration:1e3*Y,amount:z*(Y/2)}}class Je extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w,C={}){w=w instanceof MouseEvent?w:new MouseEvent(u,w);const L=A.mousePos(g.getCanvas(),w),z=g.unproject(L);super(u,o.e({point:L,lngLat:z,originalEvent:w},C)),this._defaultPrevented=!1,this.target=g}}class it extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w){const C=u==="touchend"?w.changedTouches:w.touches,L=A.touchPos(g.getCanvasContainer(),C),z=L.map((re=>g.unproject(re))),Y=L.reduce(((re,le,fe,Ie)=>re.add(le.div(Ie.length))),new o.P(0,0));super(u,{points:L,point:Y,lngLats:z,lngLat:g.unproject(Y),originalEvent:w}),this._defaultPrevented=!1}}class lt extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w){super(u,{originalEvent:w}),this._defaultPrevented=!1}}class yt{constructor(u,g){this._map=u,this._clickTolerance=g.clickTolerance}reset(){delete this._mousedownPos}wheel(u){return this._firePreventable(new lt(u.type,this._map,u))}mousedown(u,g){return this._mousedownPos=g,this._firePreventable(new Je(u.type,this._map,u))}mouseup(u){this._map.fire(new Je(u.type,this._map,u))}click(u,g){this._mousedownPos&&this._mousedownPos.dist(g)>=this._clickTolerance||this._map.fire(new Je(u.type,this._map,u))}dblclick(u){return this._firePreventable(new Je(u.type,this._map,u))}mouseover(u){this._map.fire(new Je(u.type,this._map,u))}mouseout(u){this._map.fire(new Je(u.type,this._map,u))}touchstart(u){return this._firePreventable(new it(u.type,this._map,u))}touchmove(u){this._map.fire(new it(u.type,this._map,u))}touchend(u){this._map.fire(new it(u.type,this._map,u))}touchcancel(u){this._map.fire(new it(u.type,this._map,u))}_firePreventable(u){if(this._map.fire(u),u.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class At{constructor(u){this._map=u}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(u){this._map.fire(new Je(u.type,this._map,u))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Je("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(u){this._delayContextMenu?this._contextMenuEvent=u:this._ignoreContextMenu||this._map.fire(new Je(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xt{constructor(u){this._map=u}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(u){return this.transform.screenPointToLocation(o.P.convert(u),this._map.terrain)}}class _r{constructor(u,g){this._map=u,this._tr=new Xt(u),this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=g.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(u,g){this.isEnabled()&&u.shiftKey&&u.button===0&&(A.disableDrag(),this._startPos=this._lastPos=g,this._active=!0)}mousemoveWindow(u,g){if(!this._active)return;const w=g;if(this._lastPos.equals(w)||!this._box&&w.dist(this._startPos)<this._clickTolerance)return;const C=this._startPos;this._lastPos=w,this._box||(this._box=A.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",u));const L=Math.min(C.x,w.x),z=Math.max(C.x,w.x),Y=Math.min(C.y,w.y),re=Math.max(C.y,w.y);A.setTransform(this._box,`translate(${L}px,${Y}px)`),this._box.style.width=z-L+"px",this._box.style.height=re-Y+"px"}mouseupWindow(u,g){if(!this._active||u.button!==0)return;const w=this._startPos,C=g;if(this.reset(),A.suppressClick(),w.x!==C.x||w.y!==C.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:u})),{cameraAnimation:L=>L.fitScreenCoordinates(w,C,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",u)}keydown(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(u,g){return this._map.fire(new o.l(u,{originalEvent:g}))}}function St(D,u){if(D.length!==u.length)throw new Error(`The number of touches and points are not equal - touches ${D.length}, points ${u.length}`);const g={};for(let w=0;w<D.length;w++)g[D[w].identifier]=u[w];return g}class Pt{constructor(u){this.reset(),this.numTouches=u.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(u,g,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=u.timeStamp),w.length===this.numTouches&&(this.centroid=(function(C){const L=new o.P(0,0);for(const z of C)L._add(z);return L.div(C.length)})(g),this.touches=St(w,g)))}touchmove(u,g,w){if(this.aborted||!this.centroid)return;const C=St(w,g);for(const L in this.touches){const z=C[L];(!z||z.dist(this.touches[L])>30)&&(this.aborted=!0)}}touchend(u,g,w){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class hr{constructor(u){this.singleTap=new Pt(u),this.numTaps=u.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(u,g,w){this.singleTap.touchstart(u,g,w)}touchmove(u,g,w){this.singleTap.touchmove(u,g,w)}touchend(u,g,w){const C=this.singleTap.touchend(u,g,w);if(C){const L=u.timeStamp-this.lastTime<500,z=!this.lastTap||this.lastTap.dist(C)<30;if(L&&z||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class Lr{constructor(u){this._tr=new Xt(u),this._zoomIn=new hr({numTouches:1,numTaps:2}),this._zoomOut=new hr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(u,g,w){this._zoomIn.touchstart(u,g,w),this._zoomOut.touchstart(u,g,w)}touchmove(u,g,w){this._zoomIn.touchmove(u,g,w),this._zoomOut.touchmove(u,g,w)}touchend(u,g,w){const C=this._zoomIn.touchend(u,g,w),L=this._zoomOut.touchend(u,g,w),z=this._tr;return C?(this._active=!0,u.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:Y=>Y.easeTo({duration:300,zoom:z.zoom+1,around:z.unproject(C)},{originalEvent:u})}):L?(this._active=!0,u.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:Y=>Y.easeTo({duration:300,zoom:z.zoom-1,around:z.unproject(L)},{originalEvent:u})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gr{constructor(u){this._enabled=!!u.enable,this._moveStateManager=u.moveStateManager,this._clickTolerance=u.clickTolerance||1,this._moveFunction=u.move,this._activateOnStart=!!u.activateOnStart,u.assignEvents(this),this.reset()}reset(u){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(u)}_move(...u){const g=this._moveFunction(...u);if(g.bearingDelta||g.pitchDelta||g.rollDelta||g.around||g.panDelta)return this._active=!0,g}dragStart(u,g){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(u)&&(this._moveStateManager.startMove(u),this._lastPoint=Array.isArray(g)?g[0]:g,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(u,g){if(!this.isEnabled())return;const w=this._lastPoint;if(!w)return;if(u.preventDefault(),!this._moveStateManager.isValidMoveEvent(u))return void this.reset(u);const C=Array.isArray(g)?g[0]:g;return!this._moved&&C.dist(w)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=C,this._move(w,C))}dragEnd(u){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(u)&&(this._moved&&A.suppressClick(),this.reset(u))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Br=0,jr=2,sn={[Br]:1,[jr]:2};class Jr{constructor(u){this._correctEvent=u.checkCorrectEvent}startMove(u){const g=A.mouseButton(u);this._eventButton=g}endMove(u){delete this._eventButton}isValidStartEvent(u){return this._correctEvent(u)}isValidMoveEvent(u){return!(function(g,w){const C=sn[w];return g.buttons===void 0||(g.buttons&C)!==C})(u,this._eventButton)}isValidEndEvent(u){return A.mouseButton(u)===this._eventButton}}class Jn{constructor(){this._firstTouch=void 0}_isOneFingerTouch(u){return u.targetTouches.length===1}_isSameTouchEvent(u){return u.targetTouches[0].identifier===this._firstTouch}startMove(u){this._firstTouch=u.targetTouches[0].identifier}endMove(u){delete this._firstTouch}isValidStartEvent(u){return this._isOneFingerTouch(u)}isValidMoveEvent(u){return this._isOneFingerTouch(u)&&this._isSameTouchEvent(u)}isValidEndEvent(u){return this._isOneFingerTouch(u)&&this._isSameTouchEvent(u)}}class Vn{constructor(u=new Jr({checkCorrectEvent:()=>!0}),g=new Jn){this.mouseMoveStateManager=u,this.oneFingerTouchMoveStateManager=g}_executeRelevantHandler(u,g,w){return u instanceof MouseEvent?g(u):typeof TouchEvent<"u"&&u instanceof TouchEvent?w(u):void 0}startMove(u){this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.startMove(g)),(g=>this.oneFingerTouchMoveStateManager.startMove(g)))}endMove(u){this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.endMove(g)),(g=>this.oneFingerTouchMoveStateManager.endMove(g)))}isValidStartEvent(u){return this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.isValidStartEvent(g)),(g=>this.oneFingerTouchMoveStateManager.isValidStartEvent(g)))}isValidMoveEvent(u){return this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.isValidMoveEvent(g)),(g=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(g)))}isValidEndEvent(u){return this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.isValidEndEvent(g)),(g=>this.oneFingerTouchMoveStateManager.isValidEndEvent(g)))}}const Ai=D=>{D.mousedown=D.dragStart,D.mousemoveWindow=D.dragMove,D.mouseup=D.dragEnd,D.contextmenu=u=>{u.preventDefault()}};class Zn{constructor(u,g){this._clickTolerance=u.clickTolerance||1,this._map=g,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(u){return u<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(u,g,w){return this._calculateTransform(u,g,w)}touchmove(u,g,w){if(this._active){if(!this._shouldBePrevented(w.length))return u.preventDefault(),this._calculateTransform(u,g,w);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",u)}}touchend(u,g,w){this._calculateTransform(u,g,w),this._active&&this._shouldBePrevented(w.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(u,g,w){w.length>0&&(this._active=!0);const C=St(w,g),L=new o.P(0,0),z=new o.P(0,0);let Y=0;for(const le in C){const fe=C[le],Ie=this._touches[le];Ie&&(L._add(fe),z._add(fe.sub(Ie)),Y++,C[le]=fe)}if(this._touches=C,this._shouldBePrevented(Y)||!z.mag())return;const re=z.div(Y);return this._sum._add(re),this._sum.mag()<this._clickTolerance?void 0:{around:L.div(Y),panDelta:re}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yi{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(u,g,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([g[0],g[1]]))}touchmove(u,g,w){if(!this._firstTwoTouches)return;u.preventDefault();const[C,L]=this._firstTwoTouches,z=No(w,g,C),Y=No(w,g,L);if(!z||!Y)return;const re=this._aroundCenter?null:z.add(Y).div(2);return this._move([z,Y],re,u)}touchend(u,g,w){if(!this._firstTwoTouches)return;const[C,L]=this._firstTwoTouches,z=No(w,g,C),Y=No(w,g,L);z&&Y||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function No(D,u,g){for(let w=0;w<D.length;w++)if(D[w].identifier===g)return u[w]}function Ni(D,u){return Math.log(D/u)/Math.LN2}class Yn extends Yi{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(u){this._startDistance=this._distance=u[0].dist(u[1])}_move(u,g){const w=this._distance;if(this._distance=u[0].dist(u[1]),this._active||!(Math.abs(Ni(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ni(this._distance,w),pinchAround:g}}}function wn(D,u){return 180*D.angleWith(u)/Math.PI}class To extends Yi{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(u){this._startVector=this._vector=u[0].sub(u[1]),this._minDiameter=u[0].dist(u[1])}_move(u,g,w){const C=this._vector;if(this._vector=u[0].sub(u[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:wn(this._vector,C),pinchAround:g}}_isBelowThreshold(u){this._minDiameter=Math.min(this._minDiameter,u.mag());const g=25/(Math.PI*this._minDiameter)*360,w=wn(u,this._startVector);return Math.abs(w)<g}}function Pi(D){return Math.abs(D.y)>Math.abs(D.x)}class aa extends Yi{constructor(u){super(),this._currentTouchCount=0,this._map=u}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(u,g,w){super.touchstart(u,g,w),this._currentTouchCount=w.length}_start(u){this._lastPoints=u,Pi(u[0].sub(u[1]))&&(this._valid=!1)}_move(u,g,w){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const C=u[0].sub(this._lastPoints[0]),L=u[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(C,L,w.timeStamp),this._valid?(this._lastPoints=u,this._active=!0,{pitchDelta:(C.y+L.y)/2*-.5}):void 0}gestureBeginsVertically(u,g,w){if(this._valid!==void 0)return this._valid;const C=u.mag()>=2,L=g.mag()>=2;if(!C&&!L)return;if(!C||!L)return this._firstMove===void 0&&(this._firstMove=w),w-this._firstMove<100&&void 0;const z=u.y>0==g.y>0;return Pi(u)&&Pi(g)&&z}}const da={panStep:100,bearingStep:15,pitchStep:10};class ki{constructor(u){this._tr=new Xt(u);const g=da;this._panStep=g.panStep,this._bearingStep=g.bearingStep,this._pitchStep=g.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(u){if(u.altKey||u.ctrlKey||u.metaKey)return;let g=0,w=0,C=0,L=0,z=0;switch(u.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:u.shiftKey?w=-1:(u.preventDefault(),L=-1);break;case 39:u.shiftKey?w=1:(u.preventDefault(),L=1);break;case 38:u.shiftKey?C=1:(u.preventDefault(),z=-1);break;case 40:u.shiftKey?C=-1:(u.preventDefault(),z=1);break;default:return}return this._rotationDisabled&&(w=0,C=0),{cameraAnimation:Y=>{const re=this._tr;Y.easeTo({duration:300,easeId:"keyboardHandler",easing:kl,zoom:g?Math.round(re.zoom)+g*(u.shiftKey?2:1):re.zoom,bearing:re.bearing+w*this._bearingStep,pitch:re.pitch+C*this._pitchStep,offset:[-L*this._panStep,-z*this._panStep],center:re.center},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function kl(D){return D*(2-D)}const Qa=4.000244140625,ys=1/450;class ks{constructor(u,g){this._onTimeout=w=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(w)},this._map=u,this._tr=new Xt(u),this._triggerRenderFrame=g,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=ys}setZoomRate(u){this._defaultZoomRate=u}setWheelZoomRate(u){this._wheelZoomRate=u}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!u&&u.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(u){return!!this._map.cooperativeGestures.isEnabled()&&!(u.ctrlKey||this._map.cooperativeGestures.isBypassed(u))}wheel(u){if(!this.isEnabled())return;if(this._shouldBePrevented(u))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",u);let g=u.deltaMode===WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY;const w=T(),C=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,g!==0&&g%Qa==0?this._type="wheel":g!==0&&Math.abs(g)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=g,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(C*g)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue)),u.shiftKey&&g&&(g/=4),this._type&&(this._lastWheelEvent=u,this._delta-=g,this._active||this._start(u)),u.preventDefault()}_start(u){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const g=A.mousePos(this._map.getCanvas(),u),w=this._tr;this._aroundPoint=this._aroundCenter?w.transform.locationToScreenPoint(o.V.convert(w.center)):g,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const u=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const Y=u.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=Y),typeof this._targetZoom=="number"&&(this._targetZoom+=Y)}if(this._delta!==0){const Y=this._type==="wheel"&&Math.abs(this._delta)>Qa?this._wheelZoomRate:this._defaultZoomRate;let re=2/(1+Math.exp(-Math.abs(this._delta*Y)));this._delta<0&&re!==0&&(re=1/re);const le=typeof this._targetZoom!="number"?u.scale:o.aq(this._targetZoom);this._targetZoom=u.applyConstrain(u.getCameraLngLat(),o.at(le*re)).zoom,this._type==="wheel"&&(this._startZoom=u.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom!="number"?u.zoom:this._targetZoom,w=this._startZoom,C=this._easing;let L,z=!1;if(this._type==="wheel"&&w&&C){const Y=T()-this._lastWheelEventTime,re=Math.min((Y+5)/200,1),le=C(re);L=o.G.number(w,g,le),re<1?this._frameId||(this._frameId=!0):z=!0}else L=g,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=L,{noInertia:!0,needsRenderFrame:!z,zoomDelta:L-u.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(u){let g=o.cy;if(this._prevEase){const w=this._prevEase,C=(T()-w.start)/w.duration,L=w.easing(C+.01)-w.easing(C),z=.27/Math.sqrt(L*L+1e-4)*.01,Y=Math.sqrt(.0729-z*z);g=o.cw(z,Y,.25,1)}return this._prevEase={start:T(),duration:u,easing:g},g}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Wo{constructor(u,g){this._clickZoom=u,this._tapZoom=g}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class sa{constructor(u){this._tr=new Xt(u),this.reset()}reset(){this._active=!1}dblclick(u,g){return u.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:this._tr.zoom+(u.shiftKey?-1:1),around:this._tr.unproject(g)},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wa{constructor(){this._tap=new hr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(u,g,w){if(!this._swipePoint)if(this._tapTime){const C=g[0],L=u.timeStamp-this._tapTime<500,z=this._tapPoint.dist(C)<30;L&&z?w.length>0&&(this._swipePoint=C,this._swipeTouch=w[0].identifier):this.reset()}else this._tap.touchstart(u,g,w)}touchmove(u,g,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const C=g[0],L=C.y-this._swipePoint.y;return this._swipePoint=C,u.preventDefault(),this._active=!0,{zoomDelta:L/128}}}else this._tap.touchmove(u,g,w)}touchend(u,g,w){if(this._tapTime)this._swipePoint&&w.length===0&&this.reset();else{const C=this._tap.touchend(u,g,w);C&&(this._tapTime=u.timeStamp,this._tapPoint=C)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Co{constructor(u,g,w){this._el=u,this._mousePan=g,this._touchPan=w}enable(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qi{constructor(u,g,w,C){this._pitchWithRotate=u.pitchWithRotate,this._rollEnabled=u.rollEnabled,this._mouseRotate=g,this._mousePitch=w,this._mouseRoll=C}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Go{constructor(u,g,w,C){this._el=u,this._touchZoom=g,this._touchRotate=w,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Tn{constructor(u,g){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=u,this._options=g,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const u=this._map.getCanvasContainer();u.classList.add("maplibregl-cooperative-gestures"),this._container=A.create("div","maplibregl-cooperative-gesture-screen",u);let g=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(g=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const w=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),C=document.createElement("div");C.className="maplibregl-desktop-message",C.textContent=g,this._container.appendChild(C);const L=document.createElement("div");L.className="maplibregl-mobile-message",L.textContent=w,this._container.appendChild(L),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(A.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(u){return u[this._bypassKey]}notifyGestureBlocked(u,g){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:u,originalEvent:g})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Sn=D=>D.zoom||D.drag||D.roll||D.pitch||D.rotate;class Rs extends o.l{}function Sa(D){return D.panDelta&&D.panDelta.mag()||D.zoomDelta||D.bearingDelta||D.pitchDelta||D.rollDelta}class Lo{constructor(u,g){this.handleWindowEvent=C=>{this.handleEvent(C,`${C.type}Window`)},this.handleEvent=(C,L)=>{if(C.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const z=C.type==="renderFrame"?void 0:C,Y={needsRenderFrame:!1},re={},le={};for(const{handlerName:Te,handler:Ue,allowed:Ze}of this._handlers){if(!Ue.isEnabled())continue;let ft;if(this._blockedByActive(le,Ze,Te))Ue.reset();else if(Ue[L||C.type]){if(o.cz(C,L||C.type)){const pt=A.mousePos(this._map.getCanvas(),C);ft=Ue[L||C.type](C,pt)}else if(o.cA(C,L||C.type)){const pt=this._getMapTouches(C.touches),dt=A.touchPos(this._map.getCanvas(),pt);ft=Ue[L||C.type](C,dt,pt)}else o.cB(L||C.type)||(ft=Ue[L||C.type](C));this.mergeHandlerResult(Y,re,ft,Te,z),ft&&ft.needsRenderFrame&&this._triggerRenderFrame()}(ft||Ue.isActive())&&(le[Te]=Ue)}const fe={};for(const Te in this._previousActiveHandlers)le[Te]||(fe[Te]=z);this._previousActiveHandlers=le,(Object.keys(fe).length||Sa(Y))&&(this._changes.push([Y,re,fe]),this._triggerRenderFrame()),(Object.keys(le).length||Sa(Y))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Ie}=Y;Ie&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ie(this._map))},this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ge(u),this._bearingSnap=g.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(g);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[window,"blur",void 0]];for(const[C,L,z]of this._listeners)A.addEventListener(C,L,C===document?this.handleWindowEvent:this.handleEvent,z)}destroy(){for(const[u,g,w]of this._listeners)A.removeEventListener(u,g,u===document?this.handleWindowEvent:this.handleEvent,w)}_addDefaultHandlers(u){const g=this._map,w=g.getCanvasContainer();this._add("mapEvent",new yt(g,u));const C=g.boxZoom=new _r(g,u);this._add("boxZoom",C),u.interactive&&u.boxZoom&&C.enable();const L=g.cooperativeGestures=new Tn(g,u.cooperativeGestures);this._add("cooperativeGestures",L),u.cooperativeGestures&&L.enable();const z=new Lr(g),Y=new sa(g);g.doubleClickZoom=new Wo(Y,z),this._add("tapZoom",z),this._add("clickZoom",Y),u.interactive&&u.doubleClickZoom&&g.doubleClickZoom.enable();const re=new wa;this._add("tapDragZoom",re);const le=g.touchPitch=new aa(g);this._add("touchPitch",le),u.interactive&&u.touchPitch&&g.touchPitch.enable(u.touchPitch);const fe=()=>g.project(g.getCenter()),Ie=(function({enable:wt,clickTolerance:Nt,aroundCenter:jt=!0,minPixelCenterThreshold:Dt=100,rotateDegreesPerPixelMoved:Yt=.8},Sr){const dr=new Jr({checkCorrectEvent:yr=>A.mouseButton(yr)===0&&yr.ctrlKey||A.mouseButton(yr)===2&&!yr.ctrlKey});return new gr({clickTolerance:Nt,move:(yr,xr)=>{const an=Sr();if(jt&&Math.abs(an.y-yr.y)>Dt)return{bearingDelta:o.cx(new o.P(yr.x,xr.y),xr,an)};let ln=(xr.x-yr.x)*Yt;return jt&&xr.y<an.y&&(ln=-ln),{bearingDelta:ln}},moveStateManager:dr,enable:wt,assignEvents:Ai})})(u,fe),Te=(function({enable:wt,clickTolerance:Nt,pitchDegreesPerPixelMoved:jt=-.5}){const Dt=new Jr({checkCorrectEvent:Yt=>A.mouseButton(Yt)===0&&Yt.ctrlKey||A.mouseButton(Yt)===2});return new gr({clickTolerance:Nt,move:(Yt,Sr)=>({pitchDelta:(Sr.y-Yt.y)*jt}),moveStateManager:Dt,enable:wt,assignEvents:Ai})})(u),Ue=(function({enable:wt,clickTolerance:Nt,rollDegreesPerPixelMoved:jt=.3},Dt){const Yt=new Jr({checkCorrectEvent:Sr=>A.mouseButton(Sr)===2&&Sr.ctrlKey});return new gr({clickTolerance:Nt,move:(Sr,dr)=>{const yr=Dt();let xr=(dr.x-Sr.x)*jt;return dr.y<yr.y&&(xr=-xr),{rollDelta:xr}},moveStateManager:Yt,enable:wt,assignEvents:Ai})})(u,fe);g.dragRotate=new qi(u,Ie,Te,Ue),this._add("mouseRotate",Ie,["mousePitch"]),this._add("mousePitch",Te,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Ue,["mousePitch"]),u.interactive&&u.dragRotate&&g.dragRotate.enable();const Ze=(function({enable:wt,clickTolerance:Nt}){const jt=new Jr({checkCorrectEvent:Dt=>A.mouseButton(Dt)===0&&!Dt.ctrlKey});return new gr({clickTolerance:Nt,move:(Dt,Yt)=>({around:Yt,panDelta:Yt.sub(Dt)}),activateOnStart:!0,moveStateManager:jt,enable:wt,assignEvents:Ai})})(u),ft=new Zn(u,g);g.dragPan=new Co(w,Ze,ft),this._add("mousePan",Ze),this._add("touchPan",ft,["touchZoom","touchRotate"]),u.interactive&&u.dragPan&&g.dragPan.enable(u.dragPan);const pt=new To,dt=new Yn;g.touchZoomRotate=new Go(w,dt,pt,re),this._add("touchRotate",pt,["touchPan","touchZoom"]),this._add("touchZoom",dt,["touchPan","touchRotate"]),u.interactive&&u.touchZoomRotate&&g.touchZoomRotate.enable(u.touchZoomRotate),this._add("blockableMapEvent",new At(g));const xt=g.scrollZoom=new ks(g,(()=>this._triggerRenderFrame()));this._add("scrollZoom",xt,["mousePan"]),u.interactive&&u.scrollZoom&&g.scrollZoom.enable(u.scrollZoom);const Ot=g.keyboard=new ki(g);this._add("keyboard",Ot),u.interactive&&u.keyboard&&g.keyboard.enable()}_add(u,g,w){this._handlers.push({handlerName:u,handler:g,allowed:w}),this._handlersById[u]=g}stop(u){if(!this._updatingCamera){for(const{handler:g}of this._handlers)g.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}}isActive(){for(const{handler:u}of this._handlers)if(u.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Sn(this._eventsInProgress)||this.isZooming()}_blockedByActive(u,g,w){for(const C in u)if(C!==w&&(!g||g.indexOf(C)<0))return!0;return!1}_getMapTouches(u){const g=[];for(const w of u)this._el.contains(w.target)&&g.push(w);return g}mergeHandlerResult(u,g,w,C,L){if(!w)return;o.e(u,w);const z={handlerName:C,originalEvent:w.originalEvent||L};w.zoomDelta!==void 0&&(g.zoom=z),w.panDelta!==void 0&&(g.drag=z),w.rollDelta!==void 0&&(g.roll=z),w.pitchDelta!==void 0&&(g.pitch=z),w.bearingDelta!==void 0&&(g.rotate=z)}_applyChanges(){const u={},g={},w={};for(const[C,L,z]of this._changes)C.panDelta&&(u.panDelta=(u.panDelta||new o.P(0,0))._add(C.panDelta)),C.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+C.pitchDelta),C.rollDelta&&(u.rollDelta=(u.rollDelta||0)+C.rollDelta),C.around!==void 0&&(u.around=C.around),C.pinchAround!==void 0&&(u.pinchAround=C.pinchAround),C.noInertia&&(u.noInertia=C.noInertia),o.e(g,L),o.e(w,z);this._updateMapTransform(u,g,w),this._changes=[]}_updateMapTransform(u,g,w){const C=this._map,L=C._getTransformForUpdate(),z=C.terrain;if(!(Sa(u)||z&&this._terrainMovement))return this._fireEvents(g,w,!0);C._stop(!0);let{panDelta:Y,zoomDelta:re,bearingDelta:le,pitchDelta:fe,rollDelta:Ie,around:Te,pinchAround:Ue}=u;Ue!==void 0&&(Te=Ue),Te=Te||C.transform.centerPoint,z&&!L.isPointOnMapSurface(Te)&&(Te=L.centerPoint);const Ze={panDelta:Y,zoomDelta:re,rollDelta:Ie,pitchDelta:fe,bearingDelta:le,around:Te};this._map.cameraHelper.useGlobeControls&&!L.isPointOnMapSurface(Te)&&(Te=L.centerPoint);const ft=Te.distSqr(L.centerPoint)<.01?L.center:L.screenPointToLocation(Y?Te.sub(Y):Te);this._handleMapControls({terrain:z,tr:L,deltasForHelper:Ze,preZoomAroundLoc:ft,combinedEventsInProgress:g,panDelta:Y}),C._applyUpdatedTransform(L),this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(g,w,!0)}_handleMapControls({terrain:u,tr:g,deltasForHelper:w,preZoomAroundLoc:C,combinedEventsInProgress:L,panDelta:z}){const Y=this._map.cameraHelper;if(Y.handleMapControlsRollPitchBearingZoom(w,g),u)return Y.useGlobeControls?(this._terrainMovement||!L.drag&&!L.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void Y.handleMapControlsPan(w,g,C)):this._terrainMovement||!L.drag&&!L.zoom?void(L.drag&&this._terrainMovement&&z?g.setCenter(g.screenPointToLocation(g.centerPoint.sub(z))):Y.handleMapControlsPan(w,g,C)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void Y.handleMapControlsPan(w,g,C));Y.handleMapControlsPan(w,g,C)}_fireEvents(u,g,w){const C=Sn(this._eventsInProgress),L=Sn(u),z={};for(const Ie in u){const{originalEvent:Te}=u[Ie];this._eventsInProgress[Ie]||(z[`${Ie}start`]=Te),this._eventsInProgress[Ie]=u[Ie]}!C&&L&&this._fireEvent("movestart",L.originalEvent);for(const Ie in z)this._fireEvent(Ie,z[Ie]);L&&this._fireEvent("move",L.originalEvent);for(const Ie in u){const{originalEvent:Te}=u[Ie];this._fireEvent(Ie,Te)}const Y={};let re;for(const Ie in this._eventsInProgress){const{handlerName:Te,originalEvent:Ue}=this._eventsInProgress[Ie];this._handlersById[Te].isActive()||(delete this._eventsInProgress[Ie],re=g[Te]||Ue,Y[`${Ie}end`]=re)}for(const Ie in Y)this._fireEvent(Ie,Y[Ie]);const le=Sn(this._eventsInProgress),fe=(C||L)&&!le;if(fe&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Ie=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Ie.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Ie)}if(w&&fe){this._updatingCamera=!0;const Ie=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Te=Ue=>Ue!==0&&-this._bearingSnap<Ue&&Ue<this._bearingSnap;!Ie||!Ie.essential&&x.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:re})),Te(this._map.getBearing())&&this._map.resetNorth()):(Te(Ie.bearing||this._map.getBearing())&&(Ie.bearing=0),Ie.freezeElevation=!0,this._map.easeTo(Ie,{originalEvent:re})),this._updatingCamera=!1}}_fireEvent(u,g){this._map.fire(new o.l(u,g?{originalEvent:g}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((u=>{delete this._frameId,this.handleEvent(new Rs("renderFrame",{timeStamp:u})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class $a extends o.E{constructor(u,g,w){super(),this._renderFrameCallback=()=>{const C=Math.min((T()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(C)),C<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=u,this._bearingSnap=w.bearingSnap,this.cameraHelper=g,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(u,g){u.apply(this.transform,!0),this.transform=u,this.cameraHelper=g}getCenter(){return new o.V(this.transform.center.lng,this.transform.center.lat)}setCenter(u,g){return this.jumpTo({center:u},g)}getCenterElevation(){return this.transform.elevation}setCenterElevation(u,g){return this.jumpTo({elevation:u},g),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(u){this._centerClampedToGround=u}panBy(u,g,w){return u=o.P.convert(u).mult(-1),this.panTo(this.transform.center,o.e({offset:u},g),w)}panTo(u,g,w){return this.easeTo(o.e({center:u},g),w)}getZoom(){return this.transform.zoom}setZoom(u,g){return this.jumpTo({zoom:u},g),this}zoomTo(u,g,w){return this.easeTo(o.e({zoom:u},g),w)}zoomIn(u,g){return this.zoomTo(this.getZoom()+1,u,g),this}zoomOut(u,g){return this.zoomTo(this.getZoom()-1,u,g),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(u,g){return u!=this.transform.fov&&(this.transform.setFov(u),this.fire(new o.l("movestart",g)).fire(new o.l("move",g)).fire(new o.l("moveend",g))),this}getBearing(){return this.transform.bearing}setBearing(u,g){return this.jumpTo({bearing:u},g),this}getPadding(){return this.transform.padding}setPadding(u,g){return this.jumpTo({padding:u},g),this}rotateTo(u,g,w){return this.easeTo(o.e({bearing:u},g),w)}resetNorth(u,g){return this.rotateTo(0,o.e({duration:1e3},u),g),this}resetNorthPitch(u,g){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},u),g),this}snapToNorth(u,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(u,g):this}getPitch(){return this.transform.pitch}setPitch(u,g){return this.jumpTo({pitch:u},g),this}getRoll(){return this.transform.roll}setRoll(u,g){return this.jumpTo({roll:u},g),this}cameraForBounds(u,g){u=Ht.convert(u).adjustAntiMeridian();const w=g&&g.bearing||0;return this._cameraForBoxAndBearing(u.getNorthWest(),u.getSouthEast(),w,g)}_cameraForBoxAndBearing(u,g,w,C){const L={top:0,bottom:0,right:0,left:0};if(typeof(C=o.e({padding:L,offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding=="number"){const le=C.padding;C.padding={top:le,bottom:le,right:le,left:le}}const z=o.e(L,C.padding);C.padding=z;const Y=this.transform,re=new Ht(u,g);return this.cameraHelper.cameraForBoxAndBearing(C,z,re,w,Y)}fitBounds(u,g,w){return this._fitInternal(this.cameraForBounds(u,g),g,w)}fitScreenCoordinates(u,g,w,C,L){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(u)),this.transform.screenPointToLocation(o.P.convert(g)),w,C),C,L)}_fitInternal(u,g,w){return u?(delete(g=o.e(u,g)).padding,g.linear?this.easeTo(g,w):this.flyTo(g,w)):this}jumpTo(u,g){this.stop();const w=this._getTransformForUpdate();let C=!1,L=!1,z=!1;const Y=w.zoom;this.cameraHelper.handleJumpToCenterZoom(w,u);const re=w.zoom!==Y;return"elevation"in u&&w.elevation!==+u.elevation&&w.setElevation(+u.elevation),"bearing"in u&&w.bearing!==+u.bearing&&(C=!0,w.setBearing(+u.bearing)),"pitch"in u&&w.pitch!==+u.pitch&&(L=!0,w.setPitch(+u.pitch)),"roll"in u&&w.roll!==+u.roll&&(z=!0,w.setRoll(+u.roll)),u.padding==null||w.isPaddingEqual(u.padding)||w.setPadding(u.padding),this._applyUpdatedTransform(w),this.fire(new o.l("movestart",g)).fire(new o.l("move",g)),re&&this.fire(new o.l("zoomstart",g)).fire(new o.l("zoom",g)).fire(new o.l("zoomend",g)),C&&this.fire(new o.l("rotatestart",g)).fire(new o.l("rotate",g)).fire(new o.l("rotateend",g)),L&&this.fire(new o.l("pitchstart",g)).fire(new o.l("pitch",g)).fire(new o.l("pitchend",g)),z&&this.fire(new o.l("rollstart",g)).fire(new o.l("roll",g)).fire(new o.l("rollend",g)),this.fire(new o.l("moveend",g))}calculateCameraOptionsFromTo(u,g,w,C=0){const L=o.a9.fromLngLat(u,g),z=o.a9.fromLngLat(w,C),Y=z.x-L.x,re=z.y-L.y,le=z.z-L.z,fe=Math.hypot(Y,re,le);if(fe===0)throw new Error("Can't calculate camera options with same From and To");const Ie=Math.hypot(Y,re),Te=o.at(this.transform.cameraToCenterDistance/fe/this.transform.tileSize),Ue=180*Math.atan2(Y,-re)/Math.PI;let Ze=180*Math.acos(Ie/fe)/Math.PI;return Ze=le<0?90-Ze:90+Ze,{center:z.toLngLat(),elevation:C,zoom:Te,pitch:Ze,bearing:Ue}}calculateCameraOptionsFromCameraLngLatAltRotation(u,g,w,C,L){const z=this.transform.calculateCenterFromCameraLngLatAlt(u,g,w,C);return{center:z.center,elevation:z.elevation,zoom:z.zoom,bearing:w,pitch:C,roll:L}}easeTo(u,g){this._stop(!1,u.easeId),((u=o.e({offset:[0,0],duration:500,easing:o.cy},u)).animate===!1||!u.essential&&x.prefersReducedMotion)&&(u.duration=0);const w=this._getTransformForUpdate(),C=this.getBearing(),L=w.pitch,z=w.roll,Y="bearing"in u?this._normalizeBearing(u.bearing,C):C,re="pitch"in u?+u.pitch:L,le="roll"in u?this._normalizeBearing(u.roll,z):z,fe="padding"in u?u.padding:w.padding,Ie=o.P.convert(u.offset);let Te,Ue;u.around&&(Te=o.V.convert(u.around),Ue=w.locationToScreenPoint(Te));const Ze={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ft=this.cameraHelper.handleEaseTo(w,{bearing:Y,pitch:re,roll:le,padding:fe,around:Te,aroundPoint:Ue,offsetAsPoint:Ie,offset:u.offset,zoom:u.zoom,center:u.center});return this._rotating=this._rotating||C!==Y,this._pitching=this._pitching||re!==L,this._rolling=this._rolling||le!==z,this._padding=!w.isPaddingEqual(fe),this._zooming=this._zooming||ft.isZooming,this._easeId=u.easeId,this._prepareEase(g,u.noMoveStart,Ze),this.terrain&&this._prepareElevation(ft.elevationCenter),this._ease((pt=>{ft.easeFunc(pt),this.terrain&&!u.freezeElevation&&this._updateElevation(pt),this._applyUpdatedTransform(w),this._fireMoveEvents(g)}),(pt=>{this.terrain&&u.freezeElevation&&this._finalizeElevation(),this._afterEase(g,pt)}),u),this}_prepareEase(u,g,w={}){this._moving=!0,g||w.moving||this.fire(new o.l("movestart",u)),this._zooming&&!w.zooming&&this.fire(new o.l("zoomstart",u)),this._rotating&&!w.rotating&&this.fire(new o.l("rotatestart",u)),this._pitching&&!w.pitching&&this.fire(new o.l("pitchstart",u)),this._rolling&&!w.rolling&&this.fire(new o.l("rollstart",u))}_prepareElevation(u){this._elevationCenter=u,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(u){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const g=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(u<1&&g!==this._elevationTarget){const w=this._elevationTarget-this._elevationStart;this._elevationStart+=u*(w-(g-(w*u+this._elevationStart))/(1-u)),this._elevationTarget=g}this.transform.setElevation(o.G.number(this._elevationStart,this._elevationTarget,u))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(u){if(!this.terrain&&u.elevation>=0&&u.pitch<=90)return{};const g=u.getCameraLngLat(),w=u.getCameraAltitude(),C=this.terrain?this.terrain.getElevationForLngLatZoom(g,u.zoom):0;if(w<C){const L=this.calculateCameraOptionsFromTo(g,C,u.center,u.elevation);return{pitch:L.pitch,zoom:L.zoom}}return{}}_applyUpdatedTransform(u){const g=[];if(g.push((C=>this._elevateCameraIfInsideTerrain(C))),this.transformCameraUpdate&&g.push((C=>this.transformCameraUpdate(C))),!g.length)return;const w=u.clone();for(const C of g){const L=w.clone(),{center:z,zoom:Y,roll:re,pitch:le,bearing:fe,elevation:Ie}=C(L);z&&L.setCenter(z),Ie!==void 0&&L.setElevation(Ie),Y!==void 0&&L.setZoom(Y),re!==void 0&&L.setRoll(re),le!==void 0&&L.setPitch(le),fe!==void 0&&L.setBearing(fe),w.apply(L,!1)}this.transform.apply(w,!1)}_fireMoveEvents(u){this.fire(new o.l("move",u)),this._zooming&&this.fire(new o.l("zoom",u)),this._rotating&&this.fire(new o.l("rotate",u)),this._pitching&&this.fire(new o.l("pitch",u)),this._rolling&&this.fire(new o.l("roll",u))}_afterEase(u,g){if(this._easeId&&g&&this._easeId===g)return;delete this._easeId;const w=this._zooming,C=this._rotating,L=this._pitching,z=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,w&&this.fire(new o.l("zoomend",u)),C&&this.fire(new o.l("rotateend",u)),L&&this.fire(new o.l("pitchend",u)),z&&this.fire(new o.l("rollend",u)),this.fire(new o.l("moveend",u))}flyTo(u,g){if(!u.essential&&x.prefersReducedMotion){const xr=o.U(u,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(xr,g)}this.stop(),u=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.cy},u);const w=this._getTransformForUpdate(),C=w.bearing,L=w.pitch,z=w.roll,Y=w.padding,re="bearing"in u?this._normalizeBearing(u.bearing,C):C,le="pitch"in u?+u.pitch:L,fe="roll"in u?this._normalizeBearing(u.roll,z):z,Ie="padding"in u?u.padding:w.padding,Te=o.P.convert(u.offset);let Ue=w.centerPoint.add(Te);const Ze=w.screenPointToLocation(Ue),ft=this.cameraHelper.handleFlyTo(w,{bearing:re,pitch:le,roll:fe,padding:Ie,locationAtOffset:Ze,offsetAsPoint:Te,center:u.center,minZoom:u.minZoom,zoom:u.zoom});let pt=u.curve;const dt=Math.max(w.width,w.height),xt=dt/ft.scaleOfZoom,Ot=ft.pixelPathLength;typeof ft.scaleOfMinZoom=="number"&&(pt=Math.sqrt(dt/ft.scaleOfMinZoom/Ot*2));const wt=pt*pt;function Nt(xr){const an=(xt*xt-dt*dt+(xr?-1:1)*wt*wt*Ot*Ot)/(2*(xr?xt:dt)*wt*Ot);return Math.log(Math.sqrt(an*an+1)-an)}function jt(xr){return(Math.exp(xr)-Math.exp(-xr))/2}function Dt(xr){return(Math.exp(xr)+Math.exp(-xr))/2}const Yt=Nt(!1);let Sr=function(xr){return Dt(Yt)/Dt(Yt+pt*xr)},dr=function(xr){return dt*((Dt(Yt)*(jt(an=Yt+pt*xr)/Dt(an))-jt(Yt))/wt)/Ot;var an},yr=(Nt(!0)-Yt)/pt;if(Math.abs(Ot)<2e-6||!isFinite(yr)){if(Math.abs(dt-xt)<1e-6)return this.easeTo(u,g);const xr=xt<dt?-1:1;yr=Math.abs(Math.log(xt/dt))/pt,dr=()=>0,Sr=an=>Math.exp(xr*pt*an)}return u.duration="duration"in u?+u.duration:1e3*yr/("screenSpeed"in u?+u.screenSpeed/pt:+u.speed),u.maxDuration&&u.duration>u.maxDuration&&(u.duration=0),this._zooming=!0,this._rotating=C!==re,this._pitching=le!==L,this._rolling=fe!==z,this._padding=!w.isPaddingEqual(Ie),this._prepareEase(g,!1),this.terrain&&this._prepareElevation(ft.targetCenter),this._ease((xr=>{const an=xr*yr,ln=1/Sr(an),Hr=dr(an);this._rotating&&w.setBearing(o.G.number(C,re,xr)),this._pitching&&w.setPitch(o.G.number(L,le,xr)),this._rolling&&w.setRoll(o.G.number(z,fe,xr)),this._padding&&(w.interpolatePadding(Y,Ie,xr),Ue=w.centerPoint.add(Te)),ft.easeFunc(xr,ln,Hr,Ue),this.terrain&&!u.freezeElevation&&this._updateElevation(xr),this._applyUpdatedTransform(w),this._fireMoveEvents(g)}),(()=>{this.terrain&&u.freezeElevation&&this._finalizeElevation(),this._afterEase(g)}),u),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(u,g){var w;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const C=this._onEaseEnd;delete this._onEaseEnd,C.call(this,g)}return u||(w=this.handlers)===null||w===void 0||w.stop(!1),this}_ease(u,g,w){w.animate===!1||w.duration===0?(u(1),g()):(this._easeStart=T(),this._easeOptions=w,this._onEaseFrame=u,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(u,g){u=o.W(u,-180,180);const w=Math.abs(u-g);return Math.abs(u-360-g)<w&&(u-=360),Math.abs(u+360-g)<w&&(u+=360),u}queryTerrainElevation(u){return this.terrain?this.terrain.getElevationForLngLat(o.V.convert(u),this.transform):null}}const eo={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Rl{constructor(u=eo){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=g=>{!g||g.sourceDataType!=="metadata"&&g.sourceDataType!=="visibility"&&g.dataType!=="style"&&g.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=u}getDefaultPosition(){return"bottom-right"}onAdd(u){return this._map=u,this._compact=this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(u,g){const w=this._map._getUIString(`AttributionControl.${g}`);u.title=w,u.setAttribute("aria-label",w)}_updateAttributions(){if(!this._map.style)return;let u=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=u.concat(this.options.customAttribution.map((C=>typeof C!="string"?"":C))):typeof this.options.customAttribution=="string"&&u.push(this.options.customAttribution)),this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const g=this._map.style.tileManagers;for(const C in g){const L=g[C];if(L.used||L.usedForTerrain){const z=L.getSource();z.attribution&&u.indexOf(z.attribution)<0&&u.push(z.attribution)}}u=u.filter((C=>String(C).trim())),u.sort(((C,L)=>C.length-L.length)),u=u.filter(((C,L)=>{for(let z=L+1;z<u.length;z++)if(u[z].indexOf(C)>=0)return!1;return!0}));const w=u.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,u.length?(this._innerContainer.innerHTML=A.sanitize(w),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Yl{constructor(u={}){this._updateCompact=()=>{const g=this._container.children;if(g.length){const w=g[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&w.classList.add("maplibregl-compact"):w.classList.remove("maplibregl-compact")}},this.options=u}getDefaultPosition(){return"bottom-left"}onAdd(u){this._map=u,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl");const g=A.create("a","maplibregl-ctrl-logo");return g.target="_blank",g.rel="noopener nofollow",g.href="https://maplibre.org/",g.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),g.setAttribute("rel","noopener nofollow"),this._container.appendChild(g),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Zl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(u){const g=++this._id;return this._queue.push({callback:u,id:g,cancelled:!1}),g}remove(u){const g=this._currentlyRunning,w=g?this._queue.concat(g):this._queue;for(const C of w)if(C.id===u)return void(C.cancelled=!0)}run(u=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const g=this._currentlyRunning=this._queue;this._queue=[];for(const w of g)if(!w.cancelled&&(w.callback(u),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var gu=o.aU([{name:"a_pos3d",type:"Int16",components:3}]);class Ea extends o.E{constructor(u){super(),this._lastTilesetChange=T(),this.tileManager=u,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=u._source.tileSize*2**this.deltaZoom,u.usedForTerrain=!0,u.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(u,g){this.tileManager.update(u,g),this._renderableTilesKeys=[];const w={};for(const C of Kn(u,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:g,calculateTileZoom:this.tileManager._source.calculateTileZoom}))w[C.key]=!0,this._renderableTilesKeys.push(C.key),this._tiles[C.key]||(C.terrainRttPosMatrix32f=new Float64Array(16),o.c7(C.terrainRttPosMatrix32f,0,o.a5,o.a5,0,0,1),this._tiles[C.key]=new Kt(C,this.tileSize),this._lastTilesetChange=T());for(const C in this._tiles)w[C]||delete this._tiles[C]}freeRtt(u){for(const g in this._tiles){const w=this._tiles[g];(!u||w.tileID.equals(u)||w.tileID.isChildOf(u)||u.isChildOf(w.tileID))&&(w.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((u=>this.getTileByID(u)))}getTileByID(u){return this._tiles[u]}getTerrainCoords(u,g){return g?this._getTerrainCoordsForTileRanges(u,g):this._getTerrainCoordsForRegularTile(u)}_getTerrainCoordsForRegularTile(u){const g={};for(const w of this._renderableTilesKeys){const C=this._tiles[w].tileID,L=u.clone(),z=o.bk();if(C.canonical.equals(u.canonical))o.c7(z,0,o.a5,o.a5,0,0,1);else if(C.canonical.isChildOf(u.canonical)){const Y=C.canonical.z-u.canonical.z,re=C.canonical.x-(C.canonical.x>>Y<<Y),le=C.canonical.y-(C.canonical.y>>Y<<Y),fe=o.a5>>Y;o.c7(z,0,fe,fe,0,0,1),o.O(z,z,[-re*fe,-le*fe,0])}else{if(!u.canonical.isChildOf(C.canonical))continue;{const Y=u.canonical.z-C.canonical.z,re=u.canonical.x-(u.canonical.x>>Y<<Y),le=u.canonical.y-(u.canonical.y>>Y<<Y),fe=o.a5>>Y;o.c7(z,0,o.a5,o.a5,0,0,1),o.O(z,z,[re*fe,le*fe,0]),o.Q(z,z,[1/2**Y,1/2**Y,0])}}L.terrainRttPosMatrix32f=new Float32Array(z),g[w]=L}return g}_getTerrainCoordsForTileRanges(u,g){const w={};for(const C of this._renderableTilesKeys){const L=this._tiles[C].tileID;if(!this._isWithinTileRanges(L,g))continue;const z=u.clone(),Y=o.bk();if(L.canonical.z===u.canonical.z){const re=u.canonical.x-L.canonical.x+u.wrap*(1<<u.canonical.z),le=u.canonical.y-L.canonical.y;o.c7(Y,0,o.a5,o.a5,0,0,1),o.O(Y,Y,[re*o.a5,le*o.a5,0])}else if(L.canonical.z>u.canonical.z){const re=L.canonical.z-u.canonical.z,le=L.canonical.x-(L.canonical.x>>re<<re)+u.wrap*(1<<L.canonical.z),fe=L.canonical.y-(L.canonical.y>>re<<re),Ie=u.canonical.x-(L.canonical.x>>re),Te=u.canonical.y-(L.canonical.y>>re),Ue=o.a5>>re;o.c7(Y,0,Ue,Ue,0,0,1),o.O(Y,Y,[-le*Ue+Ie*o.a5,-fe*Ue+Te*o.a5,0])}else{const re=u.canonical.z-L.canonical.z,le=u.canonical.x-(u.canonical.x>>re<<re)+u.wrap*(1<<u.canonical.z),fe=u.canonical.y-(u.canonical.y>>re<<re),Ie=(u.canonical.x>>re)-L.canonical.x,Te=(u.canonical.y>>re)-L.canonical.y,Ue=o.a5<<re;o.c7(Y,0,Ue,Ue,0,0,1),o.O(Y,Y,[le*o.a5+Ie*Ue,fe*o.a5+Te*Ue,0])}z.terrainRttPosMatrix32f=new Float32Array(Y),w[C]=z}return w}getSourceTile(u,g){const w=this.tileManager._source;let C=u.overscaledZ-this.deltaZoom;if(C>w.maxzoom&&(C=w.maxzoom),C<w.minzoom)return;this._sourceTileCache[u.key]||(this._sourceTileCache[u.key]=u.scaledTo(C).key);let L=this.findTileInCaches(this._sourceTileCache[u.key]);if(!L?.dem&&g)for(;C>=w.minzoom&&!L?.dem;)L=this.findTileInCaches(u.scaledTo(C--).key);return L}findTileInCaches(u){let g=this.tileManager.getTileByID(u);return g||(g=this.tileManager._outOfViewCache.getByKey(u),g)}anyTilesAfterTime(u=Date.now()){return this._lastTilesetChange>=u}_isWithinTileRanges(u,g){const w=g[u.canonical.z];return!!w&&(u.wrap>w.minWrap||u.wrap<w.maxWrap||u.canonical.x>=w.minTileXWrapped&&u.canonical.x<=w.maxTileXWrapped&&u.canonical.y>=w.minTileY&&u.canonical.y<=w.maxTileY)}}class ia{constructor(u,g,w){this._meshCache={},this.painter=u,this.tileManager=new Ea(g),this.options=w,this.exaggeration=typeof w.exaggeration=="number"?w.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(u,g,w,C=o.a5){var L;if(!(g>=0&&g<C&&w>=0&&w<C))return 0;const z=this.getTerrainData(u),Y=(L=z.tile)===null||L===void 0?void 0:L.dem;if(!Y)return 0;const re=o.cC([],[g/C*o.a5,w/C*o.a5],z.u_terrain_matrix),le=[re[0]*Y.dim,re[1]*Y.dim],fe=Math.floor(le[0]),Ie=Math.floor(le[1]),Te=le[0]-fe,Ue=le[1]-Ie;return Y.get(fe,Ie)*(1-Te)*(1-Ue)+Y.get(fe+1,Ie)*Te*(1-Ue)+Y.get(fe,Ie+1)*(1-Te)*Ue+Y.get(fe+1,Ie+1)*Te*Ue}getElevationForLngLatZoom(u,g){if(!o.cD(g,u.wrap()))return 0;const{tileID:w,mercatorX:C,mercatorY:L}=this._getOverscaledTileIDFromLngLatZoom(u,g);return this.getElevation(w,C%o.a5,L%o.a5,o.a5)}getElevationForLngLat(u,g){const w=Kn(g,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let C=0;for(const L of w)L.canonical.z>C&&(C=Math.min(L.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(u,C)}getElevation(u,g,w,C=o.a5){return this.getDEMElevation(u,g,w,C)*this.exaggeration}getTerrainData(u){if(!this._emptyDemTexture){const C=this.painter.context,L=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(C,L,C.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(C,new o.R({width:1,height:1}),C.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ar([])}const g=this.tileManager.getSourceTile(u,!0);if(g&&g.dem&&(!g.demTexture||g.needsTerrainPrepare)){const C=this.painter.context;g.demTexture=this.painter.getTileTexture(g.dem.stride),g.demTexture?g.demTexture.update(g.dem.getPixels(),{premultiply:!1}):g.demTexture=new o.T(C,g.dem.getPixels(),C.gl.RGBA,{premultiply:!1}),g.demTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),g.needsTerrainPrepare=!1}const w=g&&g.toString()+g.tileID.key+u.key;if(w&&!this._demMatrixCache[w]){const C=this.tileManager.getSource().maxzoom;let L=u.canonical.z-g.tileID.canonical.z;u.overscaledZ>u.canonical.z&&(u.canonical.z>=C?L=u.canonical.z-C:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const z=u.canonical.x-(u.canonical.x>>L<<L),Y=u.canonical.y-(u.canonical.y>>L<<L),re=o.cE(new Float64Array(16),[1/(o.a5<<L),1/(o.a5<<L),0]);o.O(re,re,[z*o.a5,Y*o.a5,0]),this._demMatrixCache[u.key]={matrix:re,coord:u}}return{u_depth:2,u_terrain:3,u_terrain_dim:g&&g.dem&&g.dem.dim||1,u_terrain_matrix:w?this._demMatrixCache[u.key].matrix:this._emptyDemMatrix,u_terrain_unpack:g&&g.dem&&g.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(g&&g.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:g}}getFramebuffer(u){const g=this.painter,w=g.width/devicePixelRatio,C=g.height/devicePixelRatio;return!this._fbo||this._fbo.width===w&&this._fbo.height===C||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(g.context,{width:w,height:C,data:null},g.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(g.context.gl.NEAREST,g.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(g.context,{width:w,height:C,data:null},g.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(g.context.gl.NEAREST,g.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=g.context.createFramebuffer(w,C,!0,!1),this._fbo.depthAttachment.set(g.context.createRenderbuffer(g.context.gl.DEPTH_COMPONENT16,w,C))),this._fbo.colorAttachment.set(u==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const u=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const g=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let L=0,z=0;L<this._coordsTextureSize;L++)for(let Y=0;Y<this._coordsTextureSize;Y++,z+=4)g[z+0]=255&Y,g[z+1]=255&L,g[z+2]=Y>>8<<4|L>>8,g[z+3]=0;const w=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(g.buffer)),C=new o.T(u,w,u.gl.RGBA,{premultiply:!1});return C.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),this._coordsTexture=C,C}pointCoordinate(u){this.painter.maybeDrawDepthAndCoords(!0);const g=new Uint8Array(4),w=this.painter.context,C=w.gl,L=Math.round(u.x*this.painter.pixelRatio/devicePixelRatio),z=Math.round(u.y*this.painter.pixelRatio/devicePixelRatio),Y=Math.round(this.painter.height/devicePixelRatio);w.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),C.readPixels(L,Y-z-1,1,1,C.RGBA,C.UNSIGNED_BYTE,g),w.bindFramebuffer.set(null);const re=g[0]+(g[2]>>4<<8),le=g[1]+((15&g[2])<<8),fe=this.coordsIndex[255-g[3]],Ie=fe&&this.tileManager.getTileByID(fe);if(!Ie)return null;const Te=this._coordsTextureSize,Ue=(1<<Ie.tileID.canonical.z)*Te;return new o.a9((Ie.tileID.canonical.x*Te+re)/Ue+Ie.tileID.wrap,(Ie.tileID.canonical.y*Te+le)/Ue,this.getElevation(Ie.tileID,re,le,Te))}depthAtPoint(u){const g=new Uint8Array(4),w=this.painter.context,C=w.gl;return w.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),C.readPixels(u.x,this.painter.height/devicePixelRatio-u.y-1,1,1,C.RGBA,C.UNSIGNED_BYTE,g),w.bindFramebuffer.set(null),(g[0]/16777216+g[1]/65536+g[2]/256+g[3])/256}getTerrainMesh(u){var g;const w=((g=this.painter.style.projection)===null||g===void 0?void 0:g.transitionState)>0,C=w&&u.canonical.y===0,L=w&&u.canonical.y===(1<<u.canonical.z)-1,z=`m_${C?"n":""}_${L?"s":""}`;if(this._meshCache[z])return this._meshCache[z];const Y=this.painter.context,re=new o.cF,le=new o.aY,fe=this.meshSize,Ie=o.a5/fe,Te=fe*fe;for(let Dt=0;Dt<=fe;Dt++)for(let Yt=0;Yt<=fe;Yt++)re.emplaceBack(Yt*Ie,Dt*Ie,0);for(let Dt=0;Dt<Te;Dt+=fe+1)for(let Yt=0;Yt<fe;Yt++)le.emplaceBack(Yt+Dt,fe+Yt+Dt+1,fe+Yt+Dt+2),le.emplaceBack(Yt+Dt,fe+Yt+Dt+2,Yt+Dt+1);const Ue=re.length,Ze=Ue+(fe+1),ft=(fe+1)*fe,pt=C?o.br:0,dt=C?0:1,xt=L?o.bs:o.a5,Ot=L?0:1;for(let Dt=0;Dt<=fe;Dt++)re.emplaceBack(Dt*Ie,pt,dt);for(let Dt=0;Dt<=fe;Dt++)re.emplaceBack(Dt*Ie,xt,Ot);for(let Dt=0;Dt<fe;Dt++)le.emplaceBack(ft+Dt,Ze+Dt,Ze+Dt+1),le.emplaceBack(ft+Dt,Ze+Dt+1,ft+Dt+1),le.emplaceBack(0+Dt,Ue+Dt+1,Ue+Dt),le.emplaceBack(0+Dt,0+Dt+1,Ue+Dt+1);const wt=re.length,Nt=wt+2*(fe+1);for(const Dt of[0,1])for(let Yt=0;Yt<=fe;Yt++)for(const Sr of[0,1])re.emplaceBack(Dt*o.a5,Yt*Ie,Sr);for(let Dt=0;Dt<2*fe;Dt+=2)le.emplaceBack(wt+Dt,wt+Dt+1,wt+Dt+3),le.emplaceBack(wt+Dt,wt+Dt+3,wt+Dt+2),le.emplaceBack(Nt+Dt,Nt+Dt+3,Nt+Dt+1),le.emplaceBack(Nt+Dt,Nt+Dt+2,Nt+Dt+3);const jt=new hi(Y.createVertexBuffer(re,gu.members),Y.createIndexBuffer(le),o.aX.simpleSegment(0,0,re.length,le.length));return this._meshCache[z]=jt,jt}getMeshFrameDelta(u){return 2*Math.PI*o.bE/Math.pow(2,Math.max(u,0))/5}getMinTileElevationForLngLatZoom(u,g){var w;if(!o.cD(g,u.wrap()))return 0;const{tileID:C}=this._getOverscaledTileIDFromLngLatZoom(u,g);return(w=this.getMinMaxElevation(C).minElevation)!==null&&w!==void 0?w:0}getMinMaxElevation(u){const g=this.getTerrainData(u).tile,w={minElevation:null,maxElevation:null};return g&&g.dem&&(w.minElevation=g.dem.min*this.exaggeration,w.maxElevation=g.dem.max*this.exaggeration),w}_getOverscaledTileIDFromLngLatZoom(u,g){const w=o.a9.fromLngLat(u.wrap()),C=(1<<g)*o.a5,L=w.x*C,z=w.y*C,Y=Math.floor(L/o.a5),re=Math.floor(z/o.a5);return{tileID:new o.a2(g,0,g,Y,re),mercatorX:L,mercatorY:z}}}class pa{constructor(u,g,w){this._context=u,this._size=g,this._tileSize=w,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const u of this._objects)u.texture.destroy(),u.fbo.destroy()}_createObject(u){const g=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),w=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return w.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),g.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),g.colorAttachment.set(w.texture),{id:u,fbo:g,texture:w,stamp:-1,inUse:!1}}getObjectForId(u){return this._objects[u]}useObject(u){u.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((g=>u.id!==g)),this._recentlyUsed.push(u.id)}stampObject(u){u.stamp=++this._stamp}getOrCreateFreeObject(){for(const g of this._recentlyUsed)if(!this._objects[g].inUse)return this._objects[g];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const u=this._createObject(this._objects.length);return this._objects.push(u),u}freeObject(u){u.inUse=!1}freeAllObjects(){for(const u of this._objects)this.freeObject(u)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((u=>!u.inUse))===!1}}const mu={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class yu{constructor(u,g){this.painter=u,this.terrain=g,this.pool=new pa(u.context,30,g.tileManager.tileSize*g.qualityFactor)}destruct(){this.pool.destruct()}getTexture(u){return this.pool.getObjectForId(u.rtt[this._stacks.length-1].id).texture}prepareForRender(u,g){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=u._order.filter((w=>!u._layers[w].isHidden(g))),this._coordsAscending={};for(const w in u.tileManagers){this._coordsAscending[w]={};const C=u.tileManagers[w].getVisibleCoordinates(),L=u.tileManagers[w].getSource(),z=L instanceof Qt?L.terrainTileRanges:null;for(const Y of C){const re=this.terrain.tileManager.getTerrainCoords(Y,z);for(const le in re)this._coordsAscending[w][le]||(this._coordsAscending[w][le]=[]),this._coordsAscending[w][le].push(re[le])}}this._coordsAscendingStr={};for(const w of u._order){const C=u._layers[w],L=C.source;if(mu[C.type]&&!this._coordsAscendingStr[L]){this._coordsAscendingStr[L]={};for(const z in this._coordsAscending[L])this._coordsAscendingStr[L][z]=this._coordsAscending[L][z].map((Y=>Y.key)).sort().join()}}for(const w of this._renderableTiles)for(const C in this._coordsAscendingStr){const L=this._coordsAscendingStr[C][w.tileID.key];L&&L!==w.rttCoords[C]&&(w.rtt=[])}}renderLayer(u,g){if(u.isHidden(this.painter.transform.zoom))return!1;const w=Object.assign(Object.assign({},g),{isRenderingToTexture:!0}),C=u.type,L=this.painter,z=this._renderableLayerIds[this._renderableLayerIds.length-1]===u.id;if(mu[C]&&(this._prevType&&mu[this._prevType]||this._stacks.push([]),this._prevType=C,this._stacks[this._stacks.length-1].push(u.id),!z))return!0;if(mu[this._prevType]||mu[C]&&z){this._prevType=C;const Y=this._stacks.length-1,re=this._stacks[Y]||[];for(const le of this._renderableTiles){if(this.pool.isFull()&&(Zg(this.painter,this.terrain,this._rttTiles,w),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(le),le.rtt[Y]){const Ie=this.pool.getObjectForId(le.rtt[Y].id);if(Ie.stamp===le.rtt[Y].stamp){this.pool.useObject(Ie);continue}}const fe=this.pool.getOrCreateFreeObject();this.pool.useObject(fe),this.pool.stampObject(fe),le.rtt[Y]={id:fe.id,stamp:fe.stamp},L.context.bindFramebuffer.set(fe.fbo.framebuffer),L.context.clear({color:o.bp.transparent,stencil:0}),L.currentStencilSource=void 0;for(let Ie=0;Ie<re.length;Ie++){const Te=L.style._layers[re[Ie]],Ue=Te.source?this._coordsAscending[Te.source][le.tileID.key]:[le.tileID];L.context.viewport.set([0,0,fe.fbo.width,fe.fbo.height]),L._renderTileClippingMasks(Te,Ue,!0),L.renderLayer(L,L.style.tileManagers[Te.source],Te,Ue,w),Te.source&&(le.rttCoords[Te.source]=this._coordsAscendingStr[Te.source][le.tileID.key])}}return Zg(this.painter,this.terrain,this._rttTiles,w),this._rttTiles=[],this.pool.freeAllObjects(),mu[C]}return!1}}const is={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},jf=c,Uf={hash:!1,interactive:!0,bearingSnap:7,attributionControl:eo,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},Vf={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class qc{constructor(u,g,w=!1){this.mousedown=L=>{this.startMove(L,A.mousePos(this.element,L)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=L=>{this.move(L,A.mousePos(this.element,L))},this.mouseup=L=>{this._rotatePitchHandler.dragEnd(L),this.offTemp()},this.touchstart=L=>{L.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,L.targetTouches)[0],this.startMove(L,this._startPos),A.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.addEventListener(window,"touchend",this.touchend))},this.touchmove=L=>{L.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,L.targetTouches)[0],this.move(L,this._lastPos))},this.touchend=L=>{L.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=g;const C=new Vn;this._rotatePitchHandler=new gr({clickTolerance:3,move:(L,z)=>{const Y=g.getBoundingClientRect(),re=new o.P((Y.bottom-Y.top)/2,(Y.right-Y.left)/2);return{bearingDelta:o.cx(new o.P(L.x,z.y),z,re),pitchDelta:w?-.5*(z.y-L.y):void 0}},moveStateManager:C,enable:!0,assignEvents:()=>{}}),this.map=u,A.addEventListener(g,"mousedown",this.mousedown),A.addEventListener(g,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(g,"touchcancel",this.reset)}startMove(u,g){this._rotatePitchHandler.dragStart(u,g),A.disableDrag()}move(u,g){const w=this.map,{bearingDelta:C,pitchDelta:L}=this._rotatePitchHandler.dragMove(u,g)||{};C&&w.setBearing(w.getBearing()+C),L&&w.setPitch(w.getPitch()+L)}off(){const u=this.element;A.removeEventListener(u,"mousedown",this.mousedown),A.removeEventListener(u,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend),A.removeEventListener(u,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend)}}let Hc;function $p(D,u,g,w=!1){if(w||!g.getCoveringTilesDetailsProvider().allowWorldCopies())return D?.wrap();const C=new o.V(D.lng,D.lat);if(D=new o.V(D.lng,D.lat),u){const L=new o.V(D.lng-360,D.lat),z=new o.V(D.lng+360,D.lat),Y=g.locationToScreenPoint(D).distSqr(u);g.locationToScreenPoint(L).distSqr(u)<Y?D=L:g.locationToScreenPoint(z).distSqr(u)<Y&&(D=z)}for(;Math.abs(D.lng-g.center.lng)>180;){const L=g.locationToScreenPoint(D);if(L.x>=0&&L.y>=0&&L.x<=g.width&&L.y<=g.height)break;D.lng>g.center.lng?D.lng-=360:D.lng+=360}return D.lng!==C.lng&&g.isPointOnMapSurface(g.locationToScreenPoint(D))?D:C}const of={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function sc(D,u,g){const w=D.classList;for(const C in of)w.remove(`maplibregl-${g}-anchor-${C}`);w.add(`maplibregl-${g}-anchor-${u}`)}class Vd extends o.E{constructor(u){if(super(),this._onKeyPress=g=>{const w=g.code,C=g.charCode||g.keyCode;w!=="Space"&&w!=="Enter"&&C!==32&&C!==13||this.togglePopup()},this._onMapClick=g=>{const w=g.originalEvent.target,C=this._element;this._popup&&(w===C||C.contains(w))&&this.togglePopup()},this._update=g=>{if(!this._map)return;const w=this._map.loaded()&&!this._map.isMoving();(g?.type==="terrain"||g?.type==="render"&&!w)&&this._map.once("render",this._update),this._lngLat=$p(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let C="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?C=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(C=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let L="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?L="rotateX(0deg)":this._pitchAlignment==="map"&&(L=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||g&&g.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,`${of[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${L} ${C}`),x.frameAsync(new AbortController).then((()=>{this._updateOpacity(g&&g.type==="moveend")})).catch((()=>{}))},this._onMove=g=>{if(!this._isDragging){const w=this._clickTolerance||this._map._clickTolerance;this._isDragging=g.point.dist(this._pointerdownPos)>=w}this._isDragging&&(this._pos=g.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=g=>{this._element.contains(g.originalEvent.target)&&(g.preventDefault(),this._positionDelta=g.point.sub(this._pos).add(this._offset),this._pointerdownPos=g.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=u&&u.anchor||"center",this._color=u&&u.color||"#3FB1CE",this._scale=u&&u.scale||1,this._draggable=u&&u.draggable||!1,this._clickTolerance=u&&u.clickTolerance||0,this._subpixelPositioning=u&&u.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=u&&u.rotation||0,this._rotationAlignment=u&&u.rotationAlignment||"auto",this._pitchAlignment=u&&u.pitchAlignment&&u.pitchAlignment!=="auto"?u.pitchAlignment:this._rotationAlignment,this.setOpacity(u?.opacity,u?.opacityWhenCovered),u&&u.element)this._element=u.element,this._offset=o.P.convert(u&&u.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div");const g=A.createNS("http://www.w3.org/2000/svg","svg"),w=41,C=27;g.setAttributeNS(null,"display","block"),g.setAttributeNS(null,"height",`${w}px`),g.setAttributeNS(null,"width",`${C}px`),g.setAttributeNS(null,"viewBox",`0 0 ${C} ${w}`);const L=A.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"stroke","none"),L.setAttributeNS(null,"stroke-width","1"),L.setAttributeNS(null,"fill","none"),L.setAttributeNS(null,"fill-rule","evenodd");const z=A.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill-rule","nonzero");const Y=A.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Y.setAttributeNS(null,"fill","#000000");const re=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const dt of re){const xt=A.createNS("http://www.w3.org/2000/svg","ellipse");xt.setAttributeNS(null,"opacity","0.04"),xt.setAttributeNS(null,"cx","10.5"),xt.setAttributeNS(null,"cy","5.80029008"),xt.setAttributeNS(null,"rx",dt.rx),xt.setAttributeNS(null,"ry",dt.ry),Y.appendChild(xt)}const le=A.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"fill",this._color);const fe=A.createNS("http://www.w3.org/2000/svg","path");fe.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),le.appendChild(fe);const Ie=A.createNS("http://www.w3.org/2000/svg","g");Ie.setAttributeNS(null,"opacity","0.25"),Ie.setAttributeNS(null,"fill","#000000");const Te=A.createNS("http://www.w3.org/2000/svg","path");Te.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ie.appendChild(Te);const Ue=A.createNS("http://www.w3.org/2000/svg","g");Ue.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ue.setAttributeNS(null,"fill","#FFFFFF");const Ze=A.createNS("http://www.w3.org/2000/svg","g");Ze.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ft=A.createNS("http://www.w3.org/2000/svg","circle");ft.setAttributeNS(null,"fill","#000000"),ft.setAttributeNS(null,"opacity","0.25"),ft.setAttributeNS(null,"cx","5.5"),ft.setAttributeNS(null,"cy","5.5"),ft.setAttributeNS(null,"r","5.4999962");const pt=A.createNS("http://www.w3.org/2000/svg","circle");pt.setAttributeNS(null,"fill","#FFFFFF"),pt.setAttributeNS(null,"cx","5.5"),pt.setAttributeNS(null,"cy","5.5"),pt.setAttributeNS(null,"r","5.4999962"),Ze.appendChild(ft),Ze.appendChild(pt),z.appendChild(Y),z.appendChild(le),z.appendChild(Ie),z.appendChild(Ue),z.appendChild(Ze),g.appendChild(z),g.setAttributeNS(null,"height",w*this._scale+"px"),g.setAttributeNS(null,"width",C*this._scale+"px"),this._element.appendChild(g),this._offset=o.P.convert(u&&u.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(g=>{g.preventDefault()})),this._element.addEventListener("mousedown",(g=>{g.preventDefault()})),sc(this._element,this._anchor,"marker"),u&&u.className)for(const g of u.className.split(" "))this._element.classList.add(g);this._popup=null}addTo(u){return this.remove(),this._map=u,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",u._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),u.getCanvasContainer().appendChild(this._element),u.on("move",this._update),u.on("moveend",this._update),u.on("terrain",this._update),u.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(u){return this._lngLat=o.V.convert(u),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(u){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),u){if(!("offset"in u.options)){const C=Math.abs(13.5)/Math.SQRT2;u.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(38.1-13.5+C)],"bottom-right":[-C,-1*(38.1-13.5+C)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=u,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(u){return this._subpixelPositioning=u,this}getPopup(){return this._popup}togglePopup(){const u=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:u?(u.isOpen()?u.remove():(u.setLngLat(this._lngLat),u.addTo(this._map)),this):this}_updateOpacity(u=!1){var g,w;const C=(g=this._map)===null||g===void 0?void 0:g.terrain,L=this._map.transform.isLocationOccluded(this._lngLat);if(!C||L){const Ue=L?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Ue&&(this._element.style.opacity=Ue))}if(u)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const z=this._map,Y=z.terrain.depthAtPoint(this._pos),re=z.terrain.getElevationForLngLat(this._lngLat,z.transform);if(z.transform.lngLatToCameraDepth(this._lngLat,re)-Y<.006)return void(this._element.style.opacity=this._opacity);const le=-this._offset.y/z.transform.pixelsPerMeter,fe=Math.sin(z.getPitch()*Math.PI/180)*le,Ie=z.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),Te=z.transform.lngLatToCameraDepth(this._lngLat,re+fe)-Ie>.006;!((w=this._popup)===null||w===void 0)&&w.isOpen()&&Te&&this._popup.remove(),this._element.style.opacity=Te?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(u){return this._offset=o.P.convert(u),this._update(),this}addClassName(u){this._element.classList.add(u)}removeClassName(u){this._element.classList.remove(u)}toggleClassName(u){return this._element.classList.toggle(u)}setDraggable(u){return this._draggable=!!u,this._map&&(u?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(u){return this._rotation=u||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(u){return this._rotationAlignment=u||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(u){return this._pitchAlignment=u&&u!=="auto"?u:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(u,g){return(this._opacity===void 0||u===void 0&&g===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),u!==void 0&&(this._opacity=u),g!==void 0&&(this._opacityWhenCovered=g),this._map&&this._updateOpacity(!0),this}}const Qg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let $f=0,xh=!1;const qf={maxWidth:100,unit:"metric"};function Hf(D,u,g){const w=g&&g.maxWidth||100,C=D._container.clientHeight/2,L=D._container.clientWidth/2,z=D.unproject([L-w/2,C]),Y=D.unproject([L+w/2,C]),re=Math.round(D.project(Y).x-D.project(z).x),le=Math.min(w,re,D._container.clientWidth),fe=z.distanceTo(Y);if(g&&g.unit==="imperial"){const Ie=3.2808*fe;Ie>5280?wh(u,le,Ie/5280,D._getUIString("ScaleControl.Miles")):wh(u,le,Ie,D._getUIString("ScaleControl.Feet"))}else g&&g.unit==="nautical"?wh(u,le,fe/1852,D._getUIString("ScaleControl.NauticalMiles")):fe>=1e3?wh(u,le,fe/1e3,D._getUIString("ScaleControl.Kilometers")):wh(u,le,fe,D._getUIString("ScaleControl.Meters"))}function wh(D,u,g,w){const C=(function(L){const z=Math.pow(10,`${Math.floor(L)}`.length-1);let Y=L/z;return Y=Y>=10?10:Y>=5?5:Y>=3?3:Y>=2?2:Y>=1?1:(function(re){const le=Math.pow(10,Math.ceil(-Math.log(re)/Math.LN10));return Math.round(re*le)/le})(Y),z*Y})(g);D.style.width=u*(C/g)+"px",D.innerHTML=`${C}&nbsp;${w}`}const Wf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},Gf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Sh(D){if(D){if(typeof D=="number"){const u=Math.round(Math.abs(D)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,D),"top-left":new o.P(u,u),"top-right":new o.P(-u,u),bottom:new o.P(0,-D),"bottom-left":new o.P(u,-u),"bottom-right":new o.P(-u,-u),left:new o.P(D,0),right:new o.P(-D,0)}}if(D instanceof o.P||Array.isArray(D)){const u=o.P.convert(D);return{center:u,top:u,"top-left":u,"top-right":u,bottom:u,"bottom-left":u,"bottom-right":u,left:u,right:u}}return{center:o.P.convert(D.center||[0,0]),top:o.P.convert(D.top||[0,0]),"top-left":o.P.convert(D["top-left"]||[0,0]),"top-right":o.P.convert(D["top-right"]||[0,0]),bottom:o.P.convert(D.bottom||[0,0]),"bottom-left":o.P.convert(D["bottom-left"]||[0,0]),"bottom-right":o.P.convert(D["bottom-right"]||[0,0]),left:o.P.convert(D.left||[0,0]),right:o.P.convert(D.right||[0,0])}}return Sh(new o.P(0,0))}const qp=c;s.AJAXError=o.cI,s.Event=o.l,s.Evented=o.E,s.LngLat=o.V,s.MercatorCoordinate=o.a9,s.Point=o.P,s.addProtocol=o.cJ,s.config=o.c,s.removeProtocol=o.cK,s.AttributionControl=Rl,s.BoxZoomHandler=_r,s.CanvasSource=ke,s.CooperativeGesturesHandler=Tn,s.DoubleClickZoomHandler=Wo,s.DragPanHandler=Co,s.DragRotateHandler=qi,s.EdgeInsets=Ts,s.FullscreenControl=class extends o.E{constructor(D={}){super(),this._onFullscreenChange=()=>{var u;let g=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((u=g?.shadowRoot)===null||u===void 0)&&u.fullscreenElement;)g=g.shadowRoot.fullscreenElement;g===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,D&&D.container&&(D.container instanceof HTMLElement?this._container=D.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(D){return this._map=D,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const D=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon",D).setAttribute("aria-hidden","true"),D.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const D=this._getTitle();this._fullscreenButton.setAttribute("aria-label",D),this._fullscreenButton.title=D}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},s.GeoJSONSource=Tr,s.GeolocateControl=class extends o.E{constructor(D){super(),this._onSuccess=u=>{if(this._map){if(this._isOutOfMapMaxBounds(u))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",u)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=u,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(u),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(u),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",u)),this._finish()}},this._updateCamera=u=>{const g=new o.V(u.coords.longitude,u.coords.latitude),w=u.coords.accuracy,C=this._map.getBearing(),L=o.e({bearing:C},this.options.fitBoundsOptions),z=Ht.fromLngLat(g,w);this._map.fitBounds(z,L,{geolocateSource:!0})},this._updateMarker=u=>{if(u){const g=new o.V(u.coords.longitude,u.coords.latitude);this._accuracyCircleMarker.setLngLat(g).addTo(this._map),this._userLocationDotMarker.setLngLat(g).addTo(this._map),this._accuracy=u.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=u=>{if(this._map){if(u.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(u.code===3&&xh)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",u)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(u=>u.preventDefault())),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=u=>{if(this._map){if(u===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g)}else{const g=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Vd({element:this._dotElement}),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Vd({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(g=>{const w=g?.[0]instanceof ResizeObserverEntry;g.geolocateSource||this._watchState!=="ACTIVE_LOCK"||w||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))}))}},this.options=o.e({},Qg,D)}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return o._(this,arguments,void 0,(function*(u=!1){if(Hc!==void 0&&!u)return Hc;if(window.navigator.permissions===void 0)return Hc=!!window.navigator.geolocation,Hc;try{Hc=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Hc=!!window.navigator.geolocation}return Hc}))})().then((u=>this._finishSetupUI(u))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,$f=0,xh=!1}_isOutOfMapMaxBounds(D){const u=this._map.getMaxBounds(),g=D.coords;return u&&(g.longitude<u.getWest()||g.longitude>u.getEast()||g.latitude<u.getSouth()||g.latitude>u.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const D=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&D))return;const u=this._map.project(D),g=this._map.unproject([u.x+100,u.y]),w=D.distanceTo(g)/100,C=2*this._accuracy/w;this._circleElement.style.width=`${C.toFixed(2)}px`,this._circleElement.style.height=`${C.toFixed(2)}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":$f--,xh=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let D;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),$f++,$f>1?(D={maximumAge:6e5,timeout:0},xh=!0):(D=this.options.positionOptions,xh=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,D)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},s.GlobeControl=class{constructor(){this._toggleProjection=()=>{var D;const u=(D=this._map.getProjection())===null||D===void 0?void 0:D.type;this._map.setProjection(u!=="mercator"&&u?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var D;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((D=this._map.getProjection())===null||D===void 0?void 0:D.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=A.create("button","maplibregl-ctrl-globe",this._container),A.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},s.Hash=Vp,s.ImageSource=Qt,s.KeyboardHandler=ki,s.LngLatBounds=Ht,s.LogoControl=Yl,s.Map=class extends $a{constructor(D){var u,g;o.cG.mark(o.cH.create);const w=Object.assign(Object.assign(Object.assign({},Uf),D),{canvasContextAttributes:Object.assign(Object.assign({},Uf.canvasContextAttributes),D.canvasContextAttributes)});if(w.minZoom!=null&&w.maxZoom!=null&&w.minZoom>w.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(w.minPitch!=null&&w.maxPitch!=null&&w.minPitch>w.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(w.minPitch!=null&&w.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(w.maxPitch!=null&&w.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const C=new $s,L=new go;if(w.minZoom!==void 0&&C.setMinZoom(w.minZoom),w.maxZoom!==void 0&&C.setMaxZoom(w.maxZoom),w.minPitch!==void 0&&C.setMinPitch(w.minPitch),w.maxPitch!==void 0&&C.setMaxPitch(w.maxPitch),w.renderWorldCopies!==void 0&&C.setRenderWorldCopies(w.renderWorldCopies),w.transformConstrain!==null&&C.setConstrainOverride(w.transformConstrain),super(C,L,{bearingSnap:w.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Zl,this._controls=[],this._mapId=o.af(),this._lostContextStyle={style:null,images:null},this._contextLost=Y=>{Y.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const re of Object.values(this.style._layers))if(re.type==="custom"&&console.warn(`Custom layer with id '${re.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),re._listeners)for(const[le]of Object.entries(re._listeners))console.warn(`Custom layer with id '${re.id}' had event listeners for event '${le}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new o.l("webglcontextlost",{originalEvent:Y}))},this._contextRestored=Y=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new o.l("webglcontextrestored",{originalEvent:Y}))},this._onMapScroll=Y=>{if(Y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=w.interactive,this._maxTileCacheSize=w.maxTileCacheSize,this._maxTileCacheZoomLevels=w.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},w.canvasContextAttributes),this._trackResize=w.trackResize===!0,this._bearingSnap=w.bearingSnap,this._centerClampedToGround=w.centerClampedToGround,this._refreshExpiredTiles=w.refreshExpiredTiles===!0,this._fadeDuration=w.fadeDuration,this._crossSourceCollisions=w.crossSourceCollisions===!0,this._collectResourceTiming=w.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},is),w.locale),this._clickTolerance=w.clickTolerance,this._overridePixelRatio=w.pixelRatio,this._maxCanvasSize=w.maxCanvasSize,this._zoomLevelsToOverscale=w.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=w.transformCameraUpdate,this.transformConstrain=w.transformConstrain,this.cancelPendingTileRequestsWhileZooming=w.cancelPendingTileRequestsWhileZooming===!0,w.reduceMotion!==void 0&&(x.prefersReducedMotion=w.reduceMotion),this._imageQueueHandle=H.addThrottleControl((()=>this.isMoving())),this._requestManager=new G(w.transformRequest),typeof w.container=="string"){if(this._container=document.getElementById(w.container),!this._container)throw new Error(`Container '${w.container}' not found.`)}else{if(!(w.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=w.container}if(w.maxBounds&&this.setMaxBounds(w.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let Y=!1;const re=Jg((le=>{this._trackResize&&!this._removed&&(this.resize(le),this.redraw())}),50);this._resizeObserver=new ResizeObserver((le=>{Y?re(le):Y=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Lo(this,w),this._hash=w.hash&&new Vp(typeof w.hash=="string"&&w.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:w.center,elevation:w.elevation,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch,roll:w.roll}),w.bounds&&(this.resize(),this.fitBounds(w.bounds,o.e({},w.fitBoundsOptions,{duration:0}))));const z=typeof w.style=="string"||((g=(u=w.style)===null||u===void 0?void 0:u.projection)===null||g===void 0?void 0:g.type)!=="globe";this.resize(null,z),this._localIdeographFontFamily=w.localIdeographFontFamily,this._validateStyle=w.validateStyle,w.style&&this.setStyle(w.style,{localIdeographFontFamily:w.localIdeographFontFamily}),w.attributionControl&&this.addControl(new Rl(typeof w.attributionControl=="boolean"?void 0:w.attributionControl)),w.maplibreLogo&&this.addControl(new Yl,w.logoPosition),this.on("style.load",(()=>{if(z||this._resizeTransform(),this.transform.unmodified){const Y=o.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(Y)}})),this.on("data",(Y=>{this._update(Y.dataType==="style"),this.fire(new o.l(`${Y.dataType}data`,Y))})),this.on("dataloading",(Y=>{this.fire(new o.l(`${Y.dataType}dataloading`,Y))})),this.on("dataabort",(Y=>{this.fire(new o.l("sourcedataabort",Y))}))}_getMapId(){return this._mapId}setGlobalStateProperty(D,u){return this.style.setGlobalStateProperty(D,u),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(D,u){if(u===void 0&&(u=D.getDefaultPosition?D.getDefaultPosition():"top-right"),!D||!D.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const g=D.onAdd(this);this._controls.push(D);const w=this._controlPositions[u];return u.indexOf("bottom")!==-1?w.insertBefore(g,w.firstChild):w.appendChild(g),this}removeControl(D){if(!D||!D.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const u=this._controls.indexOf(D);return u>-1&&this._controls.splice(u,1),D.onRemove(this),this}hasControl(D){return this._controls.indexOf(D)>-1}coveringTiles(D){return Kn(this.transform,D)}calculateCameraOptionsFromTo(D,u,g,w){return w==null&&this.terrain&&(w=this.terrain.getElevationForLngLat(g,this.transform)),super.calculateCameraOptionsFromTo(D,u,g,w)}resize(D,u=!0){if(this._lostContextStyle.style!==null)return this;this._resizeInternal(u);const g=!this._moving;return g&&(this.stop(),this.fire(new o.l("movestart",D)).fire(new o.l("move",D))),this.fire(new o.l("resize",D)),g&&this.fire(new o.l("moveend",D)),this}_resizeInternal(D=!0){const[u,g]=this._containerDimensions(),w=this._getClampedPixelRatio(u,g);if(this._resizeCanvas(u,g,w),this.painter.resize(u,g,w),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const L=this._getClampedPixelRatio(u,g);this._resizeCanvas(u,g,L),this.painter.resize(u,g,L)}this._resizeTransform(D)}_resizeTransform(D=!0){var u;const[g,w]=this._containerDimensions();this.transform.resize(g,w,D),(u=this._requestedCameraState)===null||u===void 0||u.resize(g,w,D)}_getClampedPixelRatio(D,u){const{0:g,1:w}=this._maxCanvasSize,C=this.getPixelRatio(),L=D*C,z=u*C;return Math.min(L>g?g/L:1,z>w?w/z:1)*C}getPixelRatio(){var D;return(D=this._overridePixelRatio)!==null&&D!==void 0?D:devicePixelRatio}setPixelRatio(D){this._overridePixelRatio=D,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(D){return this.transform.setMaxBounds(Ht.convert(D)),this._update()}setMinZoom(D){if((D=D??-2)>=-2&&D<=this.transform.maxZoom){const u=this._getTransformForUpdate();return u.setMinZoom(D),this._applyUpdatedTransform(u),this._update(),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(D){if((D=D??22)>=this.transform.minZoom){const u=this._getTransformForUpdate();return u.setMaxZoom(D),this._applyUpdatedTransform(u),this._update(),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(D){if((D=D??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(D>=0&&D<=this.transform.maxPitch)return this.transform.setMinPitch(D),this._update(),this.getPitch()<D&&this.setPitch(D),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(D){if((D=D??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(D>=this.transform.minPitch)return this.transform.setMaxPitch(D),this._update(),this.getPitch()>D&&this.setPitch(D),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(D){return this.transform.setRenderWorldCopies(D),this._update()}setTransformConstrain(D){return this.transform.setConstrainOverride(D),this._update()}project(D){return this.transform.locationToScreenPoint(o.V.convert(D),this.style&&this.terrain)}unproject(D){return this.transform.screenPointToLocation(o.P.convert(D),this.terrain)}isMoving(){var D;return this._moving||((D=this.handlers)===null||D===void 0?void 0:D.isMoving())}isZooming(){var D;return this._zooming||((D=this.handlers)===null||D===void 0?void 0:D.isZooming())}isRotating(){var D;return this._rotating||((D=this.handlers)===null||D===void 0?void 0:D.isRotating())}_createDelegatedListener(D,u,g){if(D==="mouseenter"||D==="mouseover"){let w=!1;return{layers:u,listener:g,delegates:{mousemove:L=>{const z=u.filter((re=>this.getLayer(re))),Y=z.length!==0?this.queryRenderedFeatures(L.point,{layers:z}):[];Y.length?w||(w=!0,g.call(this,new Je(D,this,L.originalEvent,{features:Y}))):w=!1},mouseout:()=>{w=!1}}}}if(D==="mouseleave"||D==="mouseout"){let w=!1;return{layers:u,listener:g,delegates:{mousemove:z=>{const Y=u.filter((re=>this.getLayer(re)));(Y.length!==0?this.queryRenderedFeatures(z.point,{layers:Y}):[]).length?w=!0:w&&(w=!1,g.call(this,new Je(D,this,z.originalEvent)))},mouseout:z=>{w&&(w=!1,g.call(this,new Je(D,this,z.originalEvent)))}}}}{const w=C=>{const L=u.filter((Y=>this.getLayer(Y))),z=L.length!==0?this.queryRenderedFeatures(C.point,{layers:L}):[];z.length&&(C.features=z,g.call(this,C),delete C.features)};return{layers:u,listener:g,delegates:{[D]:w}}}}_saveDelegatedListener(D,u){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[D]=this._delegatedListeners[D]||[],this._delegatedListeners[D].push(u)}_removeDelegatedListener(D,u,g){if(!this._delegatedListeners||!this._delegatedListeners[D])return;const w=this._delegatedListeners[D];for(let C=0;C<w.length;C++){const L=w[C];if(L.listener===g&&L.layers.length===u.length&&L.layers.every((z=>u.includes(z)))){for(const z in L.delegates)this.off(z,L.delegates[z]);return void w.splice(C,1)}}}on(D,u,g){if(g===void 0)return super.on(D,u);const w=typeof u=="string"?[u]:u,C=this._createDelegatedListener(D,w,g);this._saveDelegatedListener(D,C);for(const L in C.delegates)this.on(L,C.delegates[L]);return{unsubscribe:()=>{this._removeDelegatedListener(D,w,g)}}}once(D,u,g){if(g===void 0)return super.once(D,u);const w=typeof u=="string"?[u]:u,C=this._createDelegatedListener(D,w,g);for(const L in C.delegates){const z=C.delegates[L];C.delegates[L]=(...Y)=>{this._removeDelegatedListener(D,w,g),z(...Y)}}this._saveDelegatedListener(D,C);for(const L in C.delegates)this.once(L,C.delegates[L]);return this}off(D,u,g){return g===void 0?super.off(D,u):(this._removeDelegatedListener(D,typeof u=="string"?[u]:u,g),this)}queryRenderedFeatures(D,u){if(!this.style)return[];let g;const w=D instanceof o.P||Array.isArray(D),C=w?D:[[0,0],[this.transform.width,this.transform.height]];if(u=u||(w?{}:D)||{},C instanceof o.P||typeof C[0]=="number")g=[o.P.convert(C)];else{const L=o.P.convert(C[0]),z=o.P.convert(C[1]);g=[L,new o.P(z.x,L.y),z,new o.P(L.x,z.y),L]}return this.style.queryRenderedFeatures(g,u,this.transform)}querySourceFeatures(D,u){return this.style.querySourceFeatures(D,u)}setStyle(D,u){return(u=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},u)).diff!==!1&&u.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&D?(this._diffStyle(D,u),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._updateStyle(D,u))}setTransformRequest(D){return this._requestManager.setTransformRequest(D),this}_getUIString(D){const u=this._locale[D];if(u==null)throw new Error(`Missing UI string '${D}'`);return u}_updateStyle(D,u){var g,w;if(u.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(D,u)));const C=this.style&&u.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!D)),D?(this.style=new As(this,u||{}),this.style.setEventedParent(this,{style:this.style}),typeof D=="string"?this.style.loadURL(D,u,C):this.style.loadJSON(D,u,C),this):((w=(g=this.style)===null||g===void 0?void 0:g.projection)===null||w===void 0||w.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new As(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(D,u){if(typeof D=="string"){const g=this._requestManager.transformRequest(D,"Style");o.j(g,new AbortController).then((w=>{this._updateDiff(w.data,u)})).catch((w=>{w&&this.fire(new o.k(w))}))}else typeof D=="object"&&this._updateDiff(D,u)}_updateDiff(D,u){try{this.style.setState(D,u)&&this._update(!0)}catch(g){o.w(`Unable to perform style diff: ${g.message||g.error||g}.  Rebuilding the style from scratch.`),this._updateStyle(D,u)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(D,u){return this._lazyInitEmptyStyle(),this.style.addSource(D,u),this._update(!0)}isSourceLoaded(D){const u=this.style&&this.style.tileManagers[D];if(u!==void 0)return u.loaded();this.fire(new o.k(new Error(`There is no tile manager with ID '${D}'`)))}setTerrain(D){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),D){const u=this.style.tileManagers[D.source];if(!u)throw new Error(`cannot load terrain, because there exists no source with ID: ${D.source}`);this.terrain===null&&u.reload();for(const g in this.style._layers){const w=this.style._layers[g];w.type==="hillshade"&&w.source===D.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),w.type==="color-relief"&&w.source===D.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ia(this.painter,u,D),this.painter.renderToTexture=new yu(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=g=>{var w;g.dataType==="style"?this.terrain.tileManager.freeRtt():g.dataType==="source"&&g.tile&&(g.sourceId!==D.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((w=g.source)===null||w===void 0?void 0:w.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(g.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:D})),this}getTerrain(){var D,u;return(u=(D=this.terrain)===null||D===void 0?void 0:D.options)!==null&&u!==void 0?u:null}areTilesLoaded(){const D=this.style&&this.style.tileManagers;for(const u of Object.values(D))if(!u.areTilesLoaded())return!1;return!0}removeSource(D){return this.style.removeSource(D),this._update(!0)}getSource(D){return this.style.getSource(D)}setSourceTileLodParams(D,u,g){if(g){const w=this.getSource(g);if(!w)throw new Error(`There is no source with ID "${g}", cannot set LOD parameters`);w.calculateTileZoom=nr(Math.max(1,D),Math.max(1,u))}else for(const w in this.style.tileManagers)this.style.tileManagers[w].getSource().calculateTileZoom=nr(Math.max(1,D),Math.max(1,u));return this._update(!0),this}refreshTiles(D,u){const g=this.style.tileManagers[D];if(!g)throw new Error(`There is no tile manager with ID "${D}", cannot refresh tile`);u===void 0?g.reload(!0):g.refreshTiles(u.map((w=>new o.ac(w.z,w.x,w.y))))}addImage(D,u,g={}){const{pixelRatio:w=1,sdf:C=!1,stretchX:L,stretchY:z,content:Y,textFitWidth:re,textFitHeight:le}=g;if(this._lazyInitEmptyStyle(),!(u instanceof HTMLImageElement||o.b(u))){if(u.width===void 0||u.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:fe,height:Ie,data:Te}=u,Ue=u;return this.style.addImage(D,{data:new o.R({width:fe,height:Ie},new Uint8Array(Te)),pixelRatio:w,stretchX:L,stretchY:z,content:Y,textFitWidth:re,textFitHeight:le,sdf:C,version:0,userImage:Ue}),Ue.onAdd&&Ue.onAdd(this,D),this}}{const{width:fe,height:Ie,data:Te}=x.getImageData(u);this.style.addImage(D,{data:new o.R({width:fe,height:Ie},Te),pixelRatio:w,stretchX:L,stretchY:z,content:Y,textFitWidth:re,textFitHeight:le,sdf:C,version:0})}}updateImage(D,u){const g=this.style.getImage(D);if(!g)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=u instanceof HTMLImageElement||o.b(u)?x.getImageData(u):u,{width:C,height:L,data:z}=w;if(C===void 0||L===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(C!==g.data.width||L!==g.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const Y=!(u instanceof HTMLImageElement||o.b(u));return g.data.replace(z,Y),this.style.updateImage(D,g),this}getImage(D){return this.style.getImage(D)}hasImage(D){return D?!!this.style.getImage(D):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(D){this.style.removeImage(D)}loadImage(D){return H.getImage(this._requestManager.transformRequest(D,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(D,u){return this._lazyInitEmptyStyle(),this.style.addLayer(D,u),this._update(!0)}moveLayer(D,u){return this.style.moveLayer(D,u),this._update(!0)}removeLayer(D){return this.style.removeLayer(D),this._update(!0)}getLayer(D){return this.style.getLayer(D)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(D,u,g){return this.style.setLayerZoomRange(D,u,g),this._update(!0)}setFilter(D,u,g={}){return this.style.setFilter(D,u,g),this._update(!0)}getFilter(D){return this.style.getFilter(D)}setPaintProperty(D,u,g,w={}){return this.style.setPaintProperty(D,u,g,w),this._update(!0)}getPaintProperty(D,u){return this.style.getPaintProperty(D,u)}setLayoutProperty(D,u,g,w={}){return this.style.setLayoutProperty(D,u,g,w),this._update(!0)}getLayoutProperty(D,u){return this.style.getLayoutProperty(D,u)}setGlyphs(D,u={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(D,u),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(D,u,g={}){return this._lazyInitEmptyStyle(),this.style.addSprite(D,u,g,(w=>{w||this._update(!0)})),this}removeSprite(D){return this._lazyInitEmptyStyle(),this.style.removeSprite(D),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(D,u={}){return this._lazyInitEmptyStyle(),this.style.setSprite(D,u,(g=>{g||this._update(!0)})),this}setLight(D,u={}){return this._lazyInitEmptyStyle(),this.style.setLight(D,u),this._update(!0)}getLight(){return this.style.getLight()}setSky(D,u={}){return this._lazyInitEmptyStyle(),this.style.setSky(D,u),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(D,u){return this.style.setFeatureState(D,u),this._update()}removeFeatureState(D,u){return this.style.removeFeatureState(D,u),this._update()}getFeatureState(D){return this.style.getFeatureState(D)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let D=0,u=0;return this._container&&(D=this._container.clientWidth||400,u=this._container.clientHeight||300),[D,u]}_setupContainer(){const D=this._container;D.classList.add("maplibregl-map");const u=this._canvasContainer=A.create("div","maplibregl-canvas-container",D);this._interactive&&u.classList.add("maplibregl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas",u),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const g=this._containerDimensions(),w=this._getClampedPixelRatio(g[0],g[1]);this._resizeCanvas(g[0],g[1],w);const C=this._controlContainer=A.create("div","maplibregl-control-container",D),L=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((z=>{L[z]=A.create("div",`maplibregl-ctrl-${z} `,C)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(D,u,g){this._canvas.width=Math.floor(g*D),this._canvas.height=Math.floor(g*u),this._canvas.style.width=`${D}px`,this._canvas.style.height=`${u}px`}_setupPainter(){const D=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let u=null;this._canvas.addEventListener("webglcontextcreationerror",(w=>{u={requestedAttributes:D},w&&(u.statusMessage=w.statusMessage,u.type=w.type)}),{once:!0});let g=null;if(g=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,D):this._canvas.getContext("webgl2",D)||this._canvas.getContext("webgl",D),!g){const w="Failed to initialize WebGL";throw u?(u.message=w,new Error(JSON.stringify(u))):new Error(w)}this.painter=new jy(g,this.transform),M.testSupport(g)}migrateProjection(D,u){super.migrateProjection(D,u),this.painter.transform=D,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(D){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||D,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(D){return this._update(),this._renderTaskQueue.add(D)}_cancelRenderFrame(D){this._renderTaskQueue.remove(D)}_render(D){var u,g,w,C,L;const z=this._idleTriggered?this._fadeDuration:0,Y=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(D),this._removed)return;let re=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Ie=this.transform.zoom,Te=T();this.style.zoomHistory.update(Ie,Te);const Ue=new o.H(Ie,{now:Te,fadeDuration:z,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Ze=Ue.crossFadingFactor();Ze===1&&Ze===this._crossFadingFactor||(re=!0,this._crossFadingFactor=Ze),this.style.update(Ue)}const le=((g=this.style.projection)===null||g===void 0?void 0:g.transitionState)>0!==Y;(w=this.style.projection)===null||w===void 0||w.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((C=this.style.projection)===null||C===void 0?void 0:C.transitionState,(L=this.style.projection)===null||L===void 0?void 0:L.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||le)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,z,this._crossSourceCollisions,le),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:z,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cG.mark(o.cH.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||re)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const fe=this._sourcesDirty||this._styleDirty||this._placementDirty;return fe||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||fe||(this._fullyLoaded=!0,o.cG.mark(o.cH.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var D;this._hash&&this._hash.remove();for(const g of this._controls)g.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),H.removeThrottleControl(this._imageQueueHandle),(D=this._resizeObserver)===null||D===void 0||D.disconnect();const u=this.painter.context.gl.getExtension("WEBGL_lose_context");u?.loseContext&&u.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cG.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,x.frame(this._frameRequest,(D=>{o.cG.frame(D),this._frameRequest=null;try{this._render(D)}catch(u){if(!o.Z(u)&&!(function(g){return g.message===Lp})(u))throw u}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(D){this._showTileBoundaries!==D&&(this._showTileBoundaries=D,this._update())}get showPadding(){return!!this._showPadding}set showPadding(D){this._showPadding!==D&&(this._showPadding=D,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(D){this._showCollisionBoxes!==D&&(this._showCollisionBoxes=D,D?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(D){this._showOverdrawInspector!==D&&(this._showOverdrawInspector=D,this._update())}get repaint(){return!!this._repaint}set repaint(D){this._repaint!==D&&(this._repaint=D,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(D){this._vertices=D,this._update()}get version(){return jf}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(D){return this._lazyInitEmptyStyle(),this.style.setProjection(D),this._update(!0)}},s.MapMouseEvent=Je,s.MapTouchEvent=it,s.MapWheelEvent=lt,s.Marker=Vd,s.NavigationControl=class{constructor(D){this._updateZoomButtons=()=>{const u=this._map.getZoom(),g=u===this._map.getMaxZoom(),w=u===this._map.getMinZoom();this._zoomInButton.disabled=g,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",g.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(u,g)=>{const w=this._map._getUIString(`NavigationControl.${g}`);u.title=w,u.setAttribute("aria-label",w)},this.options=o.e({},Vf,D),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(u=>u.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(u=>this._map.zoomIn({},{originalEvent:u}))),A.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(u=>this._map.zoomOut({},{originalEvent:u}))),A.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(u=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:u}):this._map.resetNorth({},{originalEvent:u})})),this._compassIcon=A.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(D){return this._map=D,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(D,u){const g=A.create("button",D,this._container);return g.type="button",g.addEventListener("click",u),g}},s.Popup=class extends o.E{constructor(D){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=u=>{this._update(u.point)},this._onMouseMove=u=>{this._update(u.point)},this._onDrag=u=>{this._update(u.point)},this._update=u=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=A.create("div","maplibregl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const z of this.options.className.split(" "))this._container.classList.add(z);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=$p(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!u)return;const g=this._flatPos=this._pos=this._trackPointer&&u?u:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&u?u:this._map.transform.locationToScreenPoint(this._lngLat));let w=this.options.anchor;const C=Sh(this.options.offset);if(!w){const z=this._container.offsetWidth,Y=this._container.offsetHeight,re=(function(fe){var Ie,Te,Ue,Ze;return fe?{top:(Ie=fe.top)!==null&&Ie!==void 0?Ie:0,right:(Te=fe.right)!==null&&Te!==void 0?Te:0,bottom:(Ue=fe.bottom)!==null&&Ue!==void 0?Ue:0,left:(Ze=fe.left)!==null&&Ze!==void 0?Ze:0}:{top:0,right:0,bottom:0,left:0}})(this.options.padding);let le;le=g.y+C.bottom.y<Y+re.top?["top"]:g.y>this._map.transform.height-Y-re.bottom?["bottom"]:[],g.x<z/2+re.left?le.push("left"):g.x>this._map.transform.width-z/2-re.right&&le.push("right"),w=le.length===0?"bottom":le.join("-")}let L=g.add(C[w]);this.options.subpixelPositioning||(L=L.round()),A.setTransform(this._container,`${of[w]} translate(${L.x}px,${L.y}px)`),sc(this._container,w,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Wf),D)}addTo(D){return this._map&&this.remove(),this._map=D,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(D){return this._lngLat=o.V.convert(D),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(D){return this.setDOMContent(document.createTextNode(D))}setHTML(D){const u=document.createDocumentFragment(),g=document.createElement("body");let w;for(g.innerHTML=D;w=g.firstChild,w;)u.appendChild(w);return this.setDOMContent(u)}getMaxWidth(){var D;return(D=this._container)===null||D===void 0?void 0:D.style.maxWidth}setMaxWidth(D){return this.options.maxWidth=D,this._update(),this}setDOMContent(D){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(D),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(D){return this._container&&this._container.classList.add(D),this}removeClassName(D){return this._container&&this._container.classList.remove(D),this}setOffset(D){return this.options.offset=D,this._update(),this}toggleClassName(D){if(this._container)return this._container.classList.toggle(D)}setSubpixelPositioning(D){this.options.subpixelPositioning=D}setPadding(D){this.options.padding=D,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const D=this._container.querySelector(Gf);D&&D.focus()}},s.RasterDEMTileSource=br,s.RasterTileSource=vr,s.ScaleControl=class{constructor(D){this._onMove=()=>{Hf(this._map,this._container,this.options)},this.setUnit=u=>{this.options.unit=u,Hf(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},qf),D)}getDefaultPosition(){return"bottom-left"}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale",D.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},s.ScrollZoomHandler=ks,s.Style=As,s.TerrainControl=class{constructor(D){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=D}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},s.TwoFingersTouchPitchHandler=aa,s.TwoFingersTouchRotateHandler=To,s.TwoFingersTouchZoomHandler=Yn,s.TwoFingersTouchZoomRotateHandler=Go,s.VectorTileSource=_t,s.VideoSource=at,s.addSourceType=(D,u)=>o._(void 0,void 0,void 0,(function*(){if(je(D))throw new Error(`A source type called "${D}" already exists.`);((g,w)=>{be[g]=w})(D,u)})),s.clearPrewarmedResources=function(){const D=Xe;D&&(D.isPreloaded()&&D.numActive()===1?(D.release(we),Xe=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.createTileMesh=sr,s.getMaxParallelImageRequests=function(){return o.c.MAX_PARALLEL_IMAGE_REQUESTS},s.getRTLTextPluginStatus=function(){return Et().getRTLTextPluginStatus()},s.getVersion=function(){return qp},s.getWorkerCount=function(){return Le.workerCount},s.getWorkerUrl=function(){return o.c.WORKER_URL},s.importScriptInWorkers=function(D){return rt().broadcast("IS",D)},s.isTimeFrozen=function(){return E.isFrozen()},s.now=T,s.prewarm=function(){ot().acquire(we)},s.restoreNow=function(){E.restoreNow()},s.setMaxParallelImageRequests=function(D){o.c.MAX_PARALLEL_IMAGE_REQUESTS=D},s.setNow=function(D){E.setNow(D)},s.setRTLTextPlugin=function(D,u){return Et().setRTLTextPlugin(D,u)},s.setWorkerCount=function(D){Le.workerCount=D},s.setWorkerUrl=function(D){o.c.WORKER_URL=D}}));var a=r;return a}))})(iS)),iS.exports}var CT=foe();const mk=Id(CT);class doe{registeredElements;baseLayers;firstSymbolLayer;eventHandlers;wrapper;initRegisteredElements;addNativeMaplibreFunctionsAndProps;map;style;styleJson;addSource;addControl;on;cleanup;constructor(e){const r=this;this.registeredElements={},this.baseLayers=[],this.firstSymbolLayer=void 0,this.eventHandlers={layerchange:[],viewportchange:[],addsource:[],addlayer:[]},this.wrapper={on:(o,c,h,d)=>{if(!r.eventHandlers[o])return;typeof h=="string"&&(d=h,h={}),r.eventHandlers[o].push({handler:c,options:h});const m=[o,c];d&&typeof d=="string"&&(r.initRegisteredElements(d),r.registeredElements[d].wrapperEvents.push(m))},off:(o,c)=>{r.eventHandlers[o]&&(r.eventHandlers[o]=r.eventHandlers[o].filter(h=>Object.is(h.handler,c)?!1:h))},fire:(o,c)=>{if(!r.eventHandlers[o])return;const h=c||window,d=new Event(o);r.eventHandlers[o].forEach(function(m){m.handler.call(h,d,r,c)})},layerState:[],layerStateString:"",oldLayerStateStrings:{},buildLayerObject:o=>{if(o)return{id:o.id,type:o.type,visible:o.visibility!=="none",baseLayer:r.baseLayers.indexOf(o.id)!==-1}},buildLayerObjects:()=>r.map.style._order.map(o=>r.wrapper.buildLayerObject(r.map.style._layers[o])).filter(o=>typeof o<"u"),refreshLayerState:()=>{r.wrapper.layerState=r.wrapper.buildLayerObjects(),JSON.stringify(r.wrapper.layerState)!==r.wrapper.layerStateString&&(r.wrapper.fire("layerchange"),r.wrapper.layerStateString=JSON.stringify(r.wrapper.layerState))},viewportState:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0},viewportStateString:"{}",oldViewportStateString:"{}",getViewport:()=>typeof r.map.getCenter=="function"?{center:(({lng:o,lat:c})=>({lng:o,lat:c}))(r.map.getCenter()),zoom:r.map.getZoom(),bearing:r.map.getBearing(),pitch:r.map.getPitch()}:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0},refreshViewport:()=>{r.wrapper.viewportState=r.wrapper.getViewport()}},this.cancelled=!1,this.initRegisteredElements=(o,c)=>{(typeof r.registeredElements[o]>"u"||typeof c<"u"&&c)&&(r.registeredElements[o]={layers:[],sources:[],images:[],events:[],controls:[],wrapperEvents:[]})},this.addLayer=(o,c,h)=>r.map.style?(h&&typeof h=="string"&&typeof o.id<"u"&&(r.initRegisteredElements(h),r.registeredElements[h].layers.push(o.id),o?.source&&typeof o?.source!="string"&&r.registeredElements[h].sources.push(o.id)),r.map.addLayer(o,c),r.wrapper.fire("addlayer",{layer_id:o.id}),this):this,this.addSource=(o,c,h)=>r.map.style?(h&&typeof h=="string"&&typeof o<"u"&&(r.initRegisteredElements(h),r.registeredElements[h].sources.push(o)),r.map.addSource(o,c),r.wrapper.fire("addsource",{source_id:o}),this):this,this.addImage=(o,c,h,d)=>r.map.style?typeof h=="string"&&typeof d>"u"?r.addImage(o,c,void 0,h):(d&&typeof d=="string"&&typeof o<"u"&&(r.initRegisteredElements(d),r.registeredElements[d].images.push(o)),r.map.addImage(o,c,h),this):this,this.on=(o,c,h,d)=>{if(typeof h=="string"&&typeof c=="function")return r.on.call(r,o,void 0,c,h);let m=[o,c,h];return c||(m=[o,h]),d&&typeof d=="string"&&(r.initRegisteredElements(d),r.registeredElements[d].events.push(m)),r.map.on(...m),this},this.addControl=(o,c,h)=>(h&&typeof h=="string"&&(r.initRegisteredElements(h),r.registeredElements[h].controls.push(o)),r.map.addControl(o,c),this),this.cleanup=o=>{r.map.style&&typeof r.registeredElements[o]<"u"&&(r.registeredElements[o].layers.forEach(c=>{r.map.style.getLayer(c)&&r.map.style.removeLayer(c)}),r.registeredElements[o].sources.forEach(c=>{r.map.style.getSource(c)&&r.map.style.removeSource(c)}),r.registeredElements[o].images.forEach(c=>{r.map.hasImage(c)&&r.map.style.removeImage(c)}),r.registeredElements[o].events.forEach(c=>{r.map.off(...c)}),r.registeredElements[o].controls.forEach(c=>{r.map.removeControl(c)}),r.registeredElements[o].wrapperEvents.forEach(c=>{r.wrapper.off(...c)}),r.initRegisteredElements(o,!0))},["moveLayer","removeLayer","removeSource","setPaintProperty","setLayoutProperty"].forEach(o=>{this[o]=(...c)=>(r.map&&r.map.style&&typeof r.map.style[o]=="function"&&r.map.style[o](...c),r.map._update?r.map._update(!0):void 0)}),["getLayer","getSource","listImages","getPaintProperty","getLayoutProperty","removeImage"].forEach(o=>{this[o]=(...c)=>r.map&&r.map.style?r.map.style[o](...c):!1}),this.addNativeMaplibreFunctionsAndProps=()=>{Object.getOwnPropertyNames(Object.getPrototypeOf(this.map)).forEach(o=>{typeof this[o]>"u"&&(this[o]=(...c)=>r.map[o](...c))}),Object.keys(this.map).forEach(o=>{typeof this[o]>"u"&&(this[o]=r.map[o])})},["getZoom","setZoom","getCenter","setCenter","getBearing","setBearing","getPitch","setPitch","jumpTo","flyTo","panTo","panBy","panBy","zoomTo","zoomIn","zoomOut","getPadding","setPadding","rotateTo","resetNorth","resetNorthPitch","snapToNorth","cameraForBounds","fitBounds","fitScreenCoordinates","getFreeCameraOptions","setFreeCameraOptions","easeTo","stop"].forEach(o=>{this[o]=(...c)=>{if(typeof r.map[o]=="function")return r.map[o].call(r.map,...c)}}),(async()=>{typeof e.mapOptions.style=="string"&&e.mapOptions.style.indexOf("mapbox://")===-1&&await fetch(e.mapOptions.style).then(o=>{if(o.ok)return o.json();throw new Error("error loading map style.json")}).then(o=>{o.layers.forEach(c=>{r.baseLayers.push(c.id),!r.firstSymbolLayer&&c.type==="symbol"&&(r.firstSymbolLayer=c.id)}),r.styleJson=o,e.mapOptions.style=o}).catch(o=>{console.log(o)}),r.map=new CT.Map(e.mapOptions),r.addNativeMaplibreFunctionsAndProps(),r.wrapper.refreshViewport(),r.wrapper.fire("viewportchange"),r.map.on("load",()=>{r.addNativeMaplibreFunctionsAndProps()}),r.map.on("move",()=>{r.wrapper.viewportState=r.wrapper.getViewport(),r.wrapper.fire("viewportchange")}),r.map.on("idle",()=>{r.wrapper.refreshLayerState()}),r.map.on("data",()=>{r.wrapper.refreshLayerState()}),typeof e.onReady=="function"&&e.onReady(r.map,r)})()}}function _p(t,...e){const r=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(n=>r.searchParams.append("args[]",n)),`Minified MUI error #${t}; visit ${r} for the full message.`}const Sf="$$material";function jS(){return jS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jS.apply(null,arguments)}function poe(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function goe(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var moe=(function(){function t(r){var n=this;this._insertTag=function(i){var a;n.tags.length===0?n.insertionPoint?a=n.insertionPoint.nextSibling:n.prepend?a=n.container.firstChild:a=n.before:a=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,a),n.tags.push(i)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(goe(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=poe(i);try{a.insertRule(n,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var i;return(i=n.parentNode)==null?void 0:i.removeChild(n)}),this.tags=[],this.ctr=0},t})(),Zu="-ms-",US="-moz-",Ha="-webkit-",qG="comm",TD="rule",CD="decl",yoe="@import",HG="@keyframes",voe="@layer",_oe=Math.abs,AT=String.fromCharCode,boe=Object.assign;function xoe(t,e){return wu(t,0)^45?(((e<<2^wu(t,0))<<2^wu(t,1))<<2^wu(t,2))<<2^wu(t,3):0}function WG(t){return t.trim()}function woe(t,e){return(t=e.exec(t))?t[0]:t}function Wa(t,e,r){return t.replace(e,r)}function yk(t,e){return t.indexOf(e)}function wu(t,e){return t.charCodeAt(e)|0}function Rb(t,e,r){return t.slice(e,r)}function sd(t){return t.length}function AD(t){return t.length}function F2(t,e){return e.push(t),t}function Soe(t,e){return t.map(e).join("")}var IT=1,O0=1,GG=0,Oc=0,Sl=0,l_="";function PT(t,e,r,n,i,a,s){return{value:t,root:e,parent:r,type:n,props:i,children:a,line:IT,column:O0,length:s,return:""}}function K_(t,e){return boe(PT("",null,null,"",null,null,0),t,{length:-t.length},e)}function Eoe(){return Sl}function Toe(){return Sl=Oc>0?wu(l_,--Oc):0,O0--,Sl===10&&(O0=1,IT--),Sl}function lh(){return Sl=Oc<GG?wu(l_,Oc++):0,O0++,Sl===10&&(O0=1,IT++),Sl}function yd(){return wu(l_,Oc)}function aS(){return Oc}function wx(t,e){return Rb(l_,t,e)}function Mb(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function XG(t){return IT=O0=1,GG=sd(l_=t),Oc=0,[]}function YG(t){return l_="",t}function oS(t){return WG(wx(Oc-1,vk(t===91?t+2:t===40?t+1:t)))}function Coe(t){for(;(Sl=yd())&&Sl<33;)lh();return Mb(t)>2||Mb(Sl)>3?"":" "}function Aoe(t,e){for(;--e&&lh()&&!(Sl<48||Sl>102||Sl>57&&Sl<65||Sl>70&&Sl<97););return wx(t,aS()+(e<6&&yd()==32&&lh()==32))}function vk(t){for(;lh();)switch(Sl){case t:return Oc;case 34:case 39:t!==34&&t!==39&&vk(Sl);break;case 40:t===41&&vk(t);break;case 92:lh();break}return Oc}function Ioe(t,e){for(;lh()&&t+Sl!==57;)if(t+Sl===84&&yd()===47)break;return"/*"+wx(e,Oc-1)+"*"+AT(t===47?t:lh())}function Poe(t){for(;!Mb(yd());)lh();return wx(t,Oc)}function koe(t){return YG(sS("",null,null,null,[""],t=XG(t),0,[0],t))}function sS(t,e,r,n,i,a,s,o,c){for(var h=0,d=0,m=s,b=0,x=0,E=0,T=1,A=1,M=1,F=0,N="",O=i,U=a,j=n,H=N;A;)switch(E=F,F=lh()){case 40:if(E!=108&&wu(H,m-1)==58){yk(H+=Wa(oS(F),"&","&\f"),"&\f")!=-1&&(M=-1);break}case 34:case 39:case 91:H+=oS(F);break;case 9:case 10:case 13:case 32:H+=Coe(E);break;case 92:H+=Aoe(aS()-1,7);continue;case 47:switch(yd()){case 42:case 47:F2(Roe(Ioe(lh(),aS()),e,r),c);break;default:H+="/"}break;case 123*T:o[h++]=sd(H)*M;case 125*T:case 59:case 0:switch(F){case 0:case 125:A=0;case 59+d:M==-1&&(H=Wa(H,/\f/g,"")),x>0&&sd(H)-m&&F2(x>32?j8(H+";",n,r,m-1):j8(Wa(H," ","")+";",n,r,m-2),c);break;case 59:H+=";";default:if(F2(j=z8(H,e,r,h,d,i,o,N,O=[],U=[],m),a),F===123)if(d===0)sS(H,e,j,j,O,a,m,o,U);else switch(b===99&&wu(H,3)===110?100:b){case 100:case 108:case 109:case 115:sS(t,j,j,n&&F2(z8(t,j,j,0,0,i,o,N,i,O=[],m),U),i,U,m,o,n?O:U);break;default:sS(H,j,j,j,[""],U,0,o,U)}}h=d=x=0,T=M=1,N=H="",m=s;break;case 58:m=1+sd(H),x=E;default:if(T<1){if(F==123)--T;else if(F==125&&T++==0&&Toe()==125)continue}switch(H+=AT(F),F*T){case 38:M=d>0?1:(H+="\f",-1);break;case 44:o[h++]=(sd(H)-1)*M,M=1;break;case 64:yd()===45&&(H+=oS(lh())),b=yd(),d=m=sd(N=H+=Poe(aS())),F++;break;case 45:E===45&&sd(H)==2&&(T=0)}}return a}function z8(t,e,r,n,i,a,s,o,c,h,d){for(var m=i-1,b=i===0?a:[""],x=AD(b),E=0,T=0,A=0;E<n;++E)for(var M=0,F=Rb(t,m+1,m=_oe(T=s[E])),N=t;M<x;++M)(N=WG(T>0?b[M]+" "+F:Wa(F,/&\f/g,b[M])))&&(c[A++]=N);return PT(t,e,r,i===0?TD:o,c,h,d)}function Roe(t,e,r){return PT(t,e,r,qG,AT(Eoe()),Rb(t,2,-2),0)}function j8(t,e,r,n){return PT(t,e,r,CD,Rb(t,0,n),Rb(t,n+1,-1),n)}function b0(t,e){for(var r="",n=AD(t),i=0;i<n;i++)r+=e(t[i],i,t,e)||"";return r}function Moe(t,e,r,n){switch(t.type){case voe:if(t.children.length)break;case yoe:case CD:return t.return=t.return||t.value;case qG:return"";case HG:return t.return=t.value+"{"+b0(t.children,n)+"}";case TD:t.value=t.props.join(",")}return sd(r=b0(t.children,n))?t.return=t.value+"{"+r+"}":""}function Doe(t){var e=AD(t);return function(r,n,i,a){for(var s="",o=0;o<e;o++)s+=t[o](r,n,i,a)||"";return s}}function Ooe(t){return function(e){e.root||(e=e.return)&&t(e)}}function ZG(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var Noe=function(e,r,n){for(var i=0,a=0;i=a,a=yd(),i===38&&a===12&&(r[n]=1),!Mb(a);)lh();return wx(e,Oc)},Loe=function(e,r){var n=-1,i=44;do switch(Mb(i)){case 0:i===38&&yd()===12&&(r[n]=1),e[n]+=Noe(Oc-1,r,n);break;case 2:e[n]+=oS(i);break;case 4:if(i===44){e[++n]=yd()===58?"&\f":"",r[n]=e[n].length;break}default:e[n]+=AT(i)}while(i=lh());return e},Foe=function(e,r){return YG(Loe(XG(e),r))},U8=new WeakMap,Boe=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!U8.get(n))&&!i){U8.set(e,!0);for(var a=[],s=Foe(r,a),o=n.props,c=0,h=0;c<s.length;c++)for(var d=0;d<o.length;d++,h++)e.props[h]=a[c]?s[c].replace(/&\f/g,o[d]):o[d]+" "+s[c]}}},zoe=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function KG(t,e){switch(xoe(t,e)){case 5103:return Ha+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ha+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Ha+t+US+t+Zu+t+t;case 6828:case 4268:return Ha+t+Zu+t+t;case 6165:return Ha+t+Zu+"flex-"+t+t;case 5187:return Ha+t+Wa(t,/(\w+).+(:[^]+)/,Ha+"box-$1$2"+Zu+"flex-$1$2")+t;case 5443:return Ha+t+Zu+"flex-item-"+Wa(t,/flex-|-self/,"")+t;case 4675:return Ha+t+Zu+"flex-line-pack"+Wa(t,/align-content|flex-|-self/,"")+t;case 5548:return Ha+t+Zu+Wa(t,"shrink","negative")+t;case 5292:return Ha+t+Zu+Wa(t,"basis","preferred-size")+t;case 6060:return Ha+"box-"+Wa(t,"-grow","")+Ha+t+Zu+Wa(t,"grow","positive")+t;case 4554:return Ha+Wa(t,/([^-])(transform)/g,"$1"+Ha+"$2")+t;case 6187:return Wa(Wa(Wa(t,/(zoom-|grab)/,Ha+"$1"),/(image-set)/,Ha+"$1"),t,"")+t;case 5495:case 3959:return Wa(t,/(image-set\([^]*)/,Ha+"$1$`$1");case 4968:return Wa(Wa(t,/(.+:)(flex-)?(.*)/,Ha+"box-pack:$3"+Zu+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ha+t+t;case 4095:case 3583:case 4068:case 2532:return Wa(t,/(.+)-inline(.+)/,Ha+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(sd(t)-1-e>6)switch(wu(t,e+1)){case 109:if(wu(t,e+4)!==45)break;case 102:return Wa(t,/(.+:)(.+)-([^]+)/,"$1"+Ha+"$2-$3$1"+US+(wu(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~yk(t,"stretch")?KG(Wa(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(wu(t,e+1)!==115)break;case 6444:switch(wu(t,sd(t)-3-(~yk(t,"!important")&&10))){case 107:return Wa(t,":",":"+Ha)+t;case 101:return Wa(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ha+(wu(t,14)===45?"inline-":"")+"box$3$1"+Ha+"$2$3$1"+Zu+"$2box$3")+t}break;case 5936:switch(wu(t,e+11)){case 114:return Ha+t+Zu+Wa(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Ha+t+Zu+Wa(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Ha+t+Zu+Wa(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Ha+t+Zu+t+t}return t}var joe=function(e,r,n,i){if(e.length>-1&&!e.return)switch(e.type){case CD:e.return=KG(e.value,e.length);break;case HG:return b0([K_(e,{value:Wa(e.value,"@","@"+Ha)})],i);case TD:if(e.length)return Soe(e.props,function(a){switch(woe(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return b0([K_(e,{props:[Wa(a,/:(read-\w+)/,":"+US+"$1")]})],i);case"::placeholder":return b0([K_(e,{props:[Wa(a,/:(plac\w+)/,":"+Ha+"input-$1")]}),K_(e,{props:[Wa(a,/:(plac\w+)/,":"+US+"$1")]}),K_(e,{props:[Wa(a,/:(plac\w+)/,Zu+"input-$1")]})],i)}return""})}},Uoe=[joe],Voe=function(e){var r=e.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(T){var A=T.getAttribute("data-emotion");A.indexOf(" ")!==-1&&(document.head.appendChild(T),T.setAttribute("data-s",""))})}var i=e.stylisPlugins||Uoe,a={},s,o=[];s=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(T){for(var A=T.getAttribute("data-emotion").split(" "),M=1;M<A.length;M++)a[A[M]]=!0;o.push(T)});var c,h=[Boe,zoe];{var d,m=[Moe,Ooe(function(T){d.insert(T)})],b=Doe(h.concat(i,m)),x=function(A){return b0(koe(A),b)};c=function(A,M,F,N){d=F,x(A?A+"{"+M.styles+"}":M.styles),N&&(E.inserted[M.name]=!0)}}var E={key:r,sheet:new moe({key:r,container:s,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:c};return E.sheet.hydrate(o),E},eA={exports:{}},io={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V8;function $oe(){if(V8)return io;V8=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,n=t?Symbol.for("react.fragment"):60107,i=t?Symbol.for("react.strict_mode"):60108,a=t?Symbol.for("react.profiler"):60114,s=t?Symbol.for("react.provider"):60109,o=t?Symbol.for("react.context"):60110,c=t?Symbol.for("react.async_mode"):60111,h=t?Symbol.for("react.concurrent_mode"):60111,d=t?Symbol.for("react.forward_ref"):60112,m=t?Symbol.for("react.suspense"):60113,b=t?Symbol.for("react.suspense_list"):60120,x=t?Symbol.for("react.memo"):60115,E=t?Symbol.for("react.lazy"):60116,T=t?Symbol.for("react.block"):60121,A=t?Symbol.for("react.fundamental"):60117,M=t?Symbol.for("react.responder"):60118,F=t?Symbol.for("react.scope"):60119;function N(U){if(typeof U=="object"&&U!==null){var j=U.$$typeof;switch(j){case e:switch(U=U.type,U){case c:case h:case n:case a:case i:case m:return U;default:switch(U=U&&U.$$typeof,U){case o:case d:case E:case x:case s:return U;default:return j}}case r:return j}}}function O(U){return N(U)===h}return io.AsyncMode=c,io.ConcurrentMode=h,io.ContextConsumer=o,io.ContextProvider=s,io.Element=e,io.ForwardRef=d,io.Fragment=n,io.Lazy=E,io.Memo=x,io.Portal=r,io.Profiler=a,io.StrictMode=i,io.Suspense=m,io.isAsyncMode=function(U){return O(U)||N(U)===c},io.isConcurrentMode=O,io.isContextConsumer=function(U){return N(U)===o},io.isContextProvider=function(U){return N(U)===s},io.isElement=function(U){return typeof U=="object"&&U!==null&&U.$$typeof===e},io.isForwardRef=function(U){return N(U)===d},io.isFragment=function(U){return N(U)===n},io.isLazy=function(U){return N(U)===E},io.isMemo=function(U){return N(U)===x},io.isPortal=function(U){return N(U)===r},io.isProfiler=function(U){return N(U)===a},io.isStrictMode=function(U){return N(U)===i},io.isSuspense=function(U){return N(U)===m},io.isValidElementType=function(U){return typeof U=="string"||typeof U=="function"||U===n||U===h||U===a||U===i||U===m||U===b||typeof U=="object"&&U!==null&&(U.$$typeof===E||U.$$typeof===x||U.$$typeof===s||U.$$typeof===o||U.$$typeof===d||U.$$typeof===A||U.$$typeof===M||U.$$typeof===F||U.$$typeof===T)},io.typeOf=N,io}var $8;function qoe(){return $8||($8=1,eA.exports=$oe()),eA.exports}var tA,q8;function Hoe(){if(q8)return tA;q8=1;var t=qoe(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};a[t.ForwardRef]=n,a[t.Memo]=i;function s(E){return t.isMemo(E)?i:a[E.$$typeof]||e}var o=Object.defineProperty,c=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,m=Object.getPrototypeOf,b=Object.prototype;function x(E,T,A){if(typeof T!="string"){if(b){var M=m(T);M&&M!==b&&x(E,M,A)}var F=c(T);h&&(F=F.concat(h(T)));for(var N=s(E),O=s(T),U=0;U<F.length;++U){var j=F[U];if(!r[j]&&!(A&&A[j])&&!(O&&O[j])&&!(N&&N[j])){var H=d(T,j);try{o(E,j,H)}catch{}}}}return E}return tA=x,tA}Hoe();var Woe=!0;function JG(t,e,r){var n="";return r.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(n+=i+" ")}),n}var ID=function(e,r,n){var i=e.key+"-"+r.name;(n===!1||Woe===!1)&&e.registered[i]===void 0&&(e.registered[i]=r.styles)},PD=function(e,r,n){ID(e,r,n);var i=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var a=r;do e.insert(r===a?"."+i:"",a,e.sheet,!0),a=a.next;while(a!==void 0)}};function Goe(t){for(var e=0,r,n=0,i=t.length;i>=4;++n,i-=4)r=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(n+2)&255)<<16;case 2:e^=(t.charCodeAt(n+1)&255)<<8;case 1:e^=t.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var Xoe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Yoe=/[A-Z]|^ms/g,Zoe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,QG=function(e){return e.charCodeAt(1)===45},H8=function(e){return e!=null&&typeof e!="boolean"},rA=ZG(function(t){return QG(t)?t:t.replace(Yoe,"-$&").toLowerCase()}),W8=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(Zoe,function(n,i,a){return ld={name:i,styles:a,next:ld},i})}return Xoe[e]!==1&&!QG(e)&&typeof r=="number"&&r!==0?r+"px":r};function Db(t,e,r){if(r==null)return"";var n=r;if(n.__emotion_styles!==void 0)return n;switch(typeof r){case"boolean":return"";case"object":{var i=r;if(i.anim===1)return ld={name:i.name,styles:i.styles,next:ld},i.name;var a=r;if(a.styles!==void 0){var s=a.next;if(s!==void 0)for(;s!==void 0;)ld={name:s.name,styles:s.styles,next:ld},s=s.next;var o=a.styles+";";return o}return Koe(t,e,r)}case"function":{if(t!==void 0){var c=ld,h=r(t);return ld=c,Db(t,e,h)}break}}var d=r;if(e==null)return d;var m=e[d];return m!==void 0?m:d}function Koe(t,e,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=Db(t,e,r[i])+";";else for(var a in r){var s=r[a];if(typeof s!="object"){var o=s;e!=null&&e[o]!==void 0?n+=a+"{"+e[o]+"}":H8(o)&&(n+=rA(a)+":"+W8(a,o)+";")}else if(Array.isArray(s)&&typeof s[0]=="string"&&(e==null||e[s[0]]===void 0))for(var c=0;c<s.length;c++)H8(s[c])&&(n+=rA(a)+":"+W8(a,s[c])+";");else{var h=Db(t,e,s);switch(a){case"animation":case"animationName":{n+=rA(a)+":"+h+";";break}default:n+=a+"{"+h+"}"}}}return n}var G8=/label:\s*([^\s;{]+)\s*(;|$)/g,ld;function Sx(t,e,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,i="";ld=void 0;var a=t[0];if(a==null||a.raw===void 0)n=!1,i+=Db(r,e,a);else{var s=a;i+=s[0]}for(var o=1;o<t.length;o++)if(i+=Db(r,e,t[o]),n){var c=a;i+=c[o]}G8.lastIndex=0;for(var h="",d;(d=G8.exec(i))!==null;)h+="-"+d[1];var m=Goe(i)+h;return{name:m,styles:i,next:ld}}var Joe=function(e){return e()},eX=zS.useInsertionEffect?zS.useInsertionEffect:!1,tX=eX||Joe,X8=eX||te.useLayoutEffect,rX=te.createContext(typeof HTMLElement<"u"?Voe({key:"css"}):null);rX.Provider;var kD=function(e){return te.forwardRef(function(r,n){var i=te.useContext(rX);return e(r,i,n)})},Ex=te.createContext({}),RD={}.hasOwnProperty,_k="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Qoe=function(e,r){var n={};for(var i in r)RD.call(r,i)&&(n[i]=r[i]);return n[_k]=e,n},ese=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return ID(r,n,i),tX(function(){return PD(r,n,i)}),null},tse=kD(function(t,e,r){var n=t.css;typeof n=="string"&&e.registered[n]!==void 0&&(n=e.registered[n]);var i=t[_k],a=[n],s="";typeof t.className=="string"?s=JG(e.registered,a,t.className):t.className!=null&&(s=t.className+" ");var o=Sx(a,void 0,te.useContext(Ex));s+=e.key+"-"+o.name;var c={};for(var h in t)RD.call(t,h)&&h!=="css"&&h!==_k&&(c[h]=t[h]);return c.className=s,r&&(c.ref=r),te.createElement(te.Fragment,null,te.createElement(ese,{cache:e,serialized:o,isStringTag:typeof i=="string"}),te.createElement(i,c))}),rse=tse,Y8=function(e,r){var n=arguments;if(r==null||!RD.call(r,"css"))return te.createElement.apply(void 0,n);var i=n.length,a=new Array(i);a[0]=rse,a[1]=Qoe(e,r);for(var s=2;s<i;s++)a[s]=n[s];return te.createElement.apply(null,a)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(Y8||(Y8={}));var nX=kD(function(t,e){var r=t.styles,n=Sx([r],void 0,te.useContext(Ex)),i=te.useRef();return X8(function(){var a=e.key+"-global",s=new e.sheet.constructor({key:a,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),o=!1,c=document.querySelector('style[data-emotion="'+a+" "+n.name+'"]');return e.sheet.tags.length&&(s.before=e.sheet.tags[0]),c!==null&&(o=!0,c.setAttribute("data-emotion",a),s.hydrate([c])),i.current=[s,o],function(){s.flush()}},[e]),X8(function(){var a=i.current,s=a[0],o=a[1];if(o){a[1]=!1;return}if(n.next!==void 0&&PD(e,n.next,!0),s.tags.length){var c=s.tags[s.tags.length-1].nextElementSibling;s.before=c,s.flush()}e.insert("",n,s,!1)},[e,n.name]),null});function MD(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Sx(e)}function Tx(){var t=MD.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var nse=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,ise=ZG(function(t){return nse.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),ase=ise,ose=function(e){return e!=="theme"},Z8=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?ase:ose},K8=function(e,r,n){var i;if(r){var a=r.shouldForwardProp;i=e.__emotion_forwardProp&&a?function(s){return e.__emotion_forwardProp(s)&&a(s)}:a}return typeof i!="function"&&n&&(i=e.__emotion_forwardProp),i},sse=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return ID(r,n,i),tX(function(){return PD(r,n,i)}),null},lse=function t(e,r){var n=e.__emotion_real===e,i=n&&e.__emotion_base||e,a,s;r!==void 0&&(a=r.label,s=r.target);var o=K8(e,r,n),c=o||Z8(i),h=!c("as");return function(){var d=arguments,m=n&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(a!==void 0&&m.push("label:"+a+";"),d[0]==null||d[0].raw===void 0)m.push.apply(m,d);else{var b=d[0];m.push(b[0]);for(var x=d.length,E=1;E<x;E++)m.push(d[E],b[E])}var T=kD(function(A,M,F){var N=h&&A.as||i,O="",U=[],j=A;if(A.theme==null){j={};for(var H in A)j[H]=A[H];j.theme=te.useContext(Ex)}typeof A.className=="string"?O=JG(M.registered,U,A.className):A.className!=null&&(O=A.className+" ");var G=Sx(m.concat(U),M.registered,j);O+=M.key+"-"+G.name,s!==void 0&&(O+=" "+s);var X=h&&o===void 0?Z8(N):c,ae={};for(var Q in A)h&&Q==="as"||X(Q)&&(ae[Q]=A[Q]);return ae.className=O,F&&(ae.ref=F),te.createElement(te.Fragment,null,te.createElement(sse,{cache:M,serialized:G,isStringTag:typeof N=="string"}),te.createElement(N,ae))});return T.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",T.defaultProps=e.defaultProps,T.__emotion_real=T,T.__emotion_base=i,T.__emotion_styles=m,T.__emotion_forwardProp=o,Object.defineProperty(T,"toString",{value:function(){return"."+s}}),T.withComponent=function(A,M){var F=t(A,jS({},r,M,{shouldForwardProp:K8(T,M,!0)}));return F.apply(void 0,m)},T}},use=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],bk=lse.bind(null);use.forEach(function(t){bk[t]=bk(t)});var nA={exports:{}},iA,J8;function cse(){if(J8)return iA;J8=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return iA=t,iA}var aA,Q8;function hse(){if(Q8)return aA;Q8=1;var t=cse();function e(){}function r(){}return r.resetWarningCache=e,aA=function(){function n(s,o,c,h,d,m){if(m!==t){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},aA}var eB;function fse(){return eB||(eB=1,nA.exports=hse()()),nA.exports}var dse=fse();const Rn=Id(dse);function pse(t){return t==null||Object.keys(t).length===0}function iX(t){const{styles:e,defaultTheme:r={}}=t,n=typeof e=="function"?i=>e(pse(i)?r:i):e;return J.jsx(nX,{styles:n})}function aX(t,e){return bk(t,e)}function gse(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const tB=[];function vg(t){return tB[0]=t,Sx(tB)}var oA={exports:{}},_o={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rB;function mse(){if(rB)return _o;rB=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),b=Symbol.for("react.view_transition"),x=Symbol.for("react.client.reference");function E(T){if(typeof T=="object"&&T!==null){var A=T.$$typeof;switch(A){case t:switch(T=T.type,T){case r:case i:case n:case c:case h:case b:return T;default:switch(T=T&&T.$$typeof,T){case s:case o:case m:case d:return T;case a:return T;default:return A}}case e:return A}}}return _o.ContextConsumer=a,_o.ContextProvider=s,_o.Element=t,_o.ForwardRef=o,_o.Fragment=r,_o.Lazy=m,_o.Memo=d,_o.Portal=e,_o.Profiler=i,_o.StrictMode=n,_o.Suspense=c,_o.SuspenseList=h,_o.isContextConsumer=function(T){return E(T)===a},_o.isContextProvider=function(T){return E(T)===s},_o.isElement=function(T){return typeof T=="object"&&T!==null&&T.$$typeof===t},_o.isForwardRef=function(T){return E(T)===o},_o.isFragment=function(T){return E(T)===r},_o.isLazy=function(T){return E(T)===m},_o.isMemo=function(T){return E(T)===d},_o.isPortal=function(T){return E(T)===e},_o.isProfiler=function(T){return E(T)===i},_o.isStrictMode=function(T){return E(T)===n},_o.isSuspense=function(T){return E(T)===c},_o.isSuspenseList=function(T){return E(T)===h},_o.isValidElementType=function(T){return typeof T=="string"||typeof T=="function"||T===r||T===i||T===n||T===c||T===h||typeof T=="object"&&T!==null&&(T.$$typeof===m||T.$$typeof===d||T.$$typeof===s||T.$$typeof===a||T.$$typeof===o||T.$$typeof===x||T.getModuleId!==void 0)},_o.typeOf=E,_o}var nB;function yse(){return nB||(nB=1,oA.exports=mse()),oA.exports}var oX=yse();function ud(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function sX(t){if(te.isValidElement(t)||oX.isValidElementType(t)||!ud(t))return t;const e={};return Object.keys(t).forEach(r=>{e[r]=sX(t[r])}),e}function Qu(t,e,r={clone:!0}){const n=r.clone?{...t}:t;return ud(t)&&ud(e)&&Object.keys(e).forEach(i=>{te.isValidElement(e[i])||oX.isValidElementType(e[i])?n[i]=e[i]:ud(e[i])&&Object.prototype.hasOwnProperty.call(t,i)&&ud(t[i])?n[i]=Qu(t[i],e[i],r):r.clone?n[i]=ud(e[i])?sX(e[i]):e[i]:n[i]=e[i]}),n}const vse=t=>{const e=Object.keys(t).map(r=>({key:r,val:t[r]}))||[];return e.sort((r,n)=>r.val-n.val),e.reduce((r,n)=>({...r,[n.key]:n.val}),{})};function _se(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:n=5,...i}=t,a=vse(e),s=Object.keys(a);function o(b){return`@media (min-width:${typeof e[b]=="number"?e[b]:b}${r})`}function c(b){return`@media (max-width:${(typeof e[b]=="number"?e[b]:b)-n/100}${r})`}function h(b,x){const E=s.indexOf(x);return`@media (min-width:${typeof e[b]=="number"?e[b]:b}${r}) and (max-width:${(E!==-1&&typeof e[s[E]]=="number"?e[s[E]]:x)-n/100}${r})`}function d(b){return s.indexOf(b)+1<s.length?h(b,s[s.indexOf(b)+1]):o(b)}function m(b){const x=s.indexOf(b);return x===0?o(s[1]):x===s.length-1?c(s[x]):h(b,s[s.indexOf(b)+1]).replace("@media","@media not all and")}return{keys:s,values:a,up:o,down:c,between:h,only:d,not:m,unit:r,...i}}function iB(t,e){if(!t.containerQueries)return e;const r=Object.keys(e).filter(n=>n.startsWith("@container")).sort((n,i)=>{const a=/min-width:\s*([0-9.]+)/;return+(n.match(a)?.[1]||0)-+(i.match(a)?.[1]||0)});return r.length?r.reduce((n,i)=>{const a=e[i];return delete n[i],n[i]=a,n},{...e}):e}function bse(t,e){return e==="@"||e.startsWith("@")&&(t.some(r=>e.startsWith(`@${r}`))||!!e.match(/^@\d/))}function xse(t,e){const r=e.match(/^@([^/]+)?\/?(.+)?$/);if(!r)return null;const[,n,i]=r,a=Number.isNaN(+n)?n||0:+n;return t.containerQueries(i).up(a)}function wse(t){const e=(a,s)=>a.replace("@media",s?`@container ${s}`:"@container");function r(a,s){a.up=(...o)=>e(t.breakpoints.up(...o),s),a.down=(...o)=>e(t.breakpoints.down(...o),s),a.between=(...o)=>e(t.breakpoints.between(...o),s),a.only=(...o)=>e(t.breakpoints.only(...o),s),a.not=(...o)=>{const c=e(t.breakpoints.not(...o),s);return c.includes("not all and")?c.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):c}}const n={},i=a=>(r(n,a),n);return r(i),{...t,containerQueries:i}}const Sse={borderRadius:4};function ib(t,e){return e?Qu(t,e,{clone:!1}):t}const kT={xs:0,sm:600,md:900,lg:1200,xl:1536},aB={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${kT[t]}px)`},Ese={containerQueries:t=>({up:e=>{let r=typeof e=="number"?e:kT[e]||e;return typeof r=="number"&&(r=`${r}px`),t?`@container ${t} (min-width:${r})`:`@container (min-width:${r})`}})};function bp(t,e,r){const n=t.theme||{};if(Array.isArray(e)){const a=n.breakpoints||aB;return e.reduce((s,o,c)=>(s[a.up(a.keys[c])]=r(e[c]),s),{})}if(typeof e=="object"){const a=n.breakpoints||aB;return Object.keys(e).reduce((s,o)=>{if(bse(a.keys,o)){const c=xse(n.containerQueries?n:Ese,o);c&&(s[c]=r(e[o],o))}else if(Object.keys(a.values||kT).includes(o)){const c=a.up(o);s[c]=r(e[o],o)}else{const c=o;s[c]=e[c]}return s},{})}return r(e)}function Tse(t={}){return t.keys?.reduce((r,n)=>{const i=t.up(n);return r[i]={},r},{})||{}}function oB(t,e){return t.reduce((r,n)=>{const i=r[n];return(!i||Object.keys(i).length===0)&&delete r[n],r},e)}function cn(t){if(typeof t!="string")throw new Error(_p(7));return t.charAt(0).toUpperCase()+t.slice(1)}function RT(t,e,r=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&r){const n=`vars.${e}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,t);if(n!=null)return n}return e.split(".").reduce((n,i)=>n&&n[i]!=null?n[i]:null,t)}function VS(t,e,r,n=r){let i;return typeof t=="function"?i=t(r):Array.isArray(t)?i=t[r]||n:i=RT(t,r)||n,e&&(i=e(i,n,t)),i}function al(t){const{prop:e,cssProperty:r=t.prop,themeKey:n,transform:i}=t,a=s=>{if(s[e]==null)return null;const o=s[e],c=s.theme,h=RT(c,n)||{};return bp(s,o,m=>{let b=VS(h,i,m);return m===b&&typeof m=="string"&&(b=VS(h,i,`${e}${m==="default"?"":cn(m)}`,m)),r===!1?b:{[r]:b}})};return a.propTypes={},a.filterProps=[e],a}function Cse(t){const e={};return r=>(e[r]===void 0&&(e[r]=t(r)),e[r])}const Ase={m:"margin",p:"padding"},Ise={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},sB={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Pse=Cse(t=>{if(t.length>2)if(sB[t])t=sB[t];else return[t];const[e,r]=t.split(""),n=Ase[e],i=Ise[r]||"";return Array.isArray(i)?i.map(a=>n+a):[n+i]}),DD=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],OD=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...DD,...OD];function Cx(t,e,r,n){const i=RT(t,e,!0)??r;return typeof i=="number"||typeof i=="string"?a=>typeof a=="string"?a:typeof i=="string"?i.startsWith("var(")&&a===0?0:i.startsWith("var(")&&a===1?i:`calc(${a} * ${i})`:i*a:Array.isArray(i)?a=>{if(typeof a=="string")return a;const s=Math.abs(a),o=i[s];return a>=0?o:typeof o=="number"?-o:typeof o=="string"&&o.startsWith("var(")?`calc(-1 * ${o})`:`-${o}`}:typeof i=="function"?i:()=>{}}function ND(t){return Cx(t,"spacing",8)}function Ax(t,e){return typeof e=="string"||e==null?e:t(e)}function kse(t,e){return r=>t.reduce((n,i)=>(n[i]=Ax(e,r),n),{})}function Rse(t,e,r,n){if(!e.includes(r))return null;const i=Pse(r),a=kse(i,n),s=t[r];return bp(t,s,a)}function lX(t,e){const r=ND(t.theme);return Object.keys(t).map(n=>Rse(t,e,n,r)).reduce(ib,{})}function Ls(t){return lX(t,DD)}Ls.propTypes={};Ls.filterProps=DD;function Fs(t){return lX(t,OD)}Fs.propTypes={};Fs.filterProps=OD;function uX(t=8,e=ND({spacing:t})){if(t.mui)return t;const r=(...n)=>(n.length===0?[1]:n).map(a=>{const s=e(a);return typeof s=="number"?`${s}px`:s}).join(" ");return r.mui=!0,r}function MT(...t){const e=t.reduce((n,i)=>(i.filterProps.forEach(a=>{n[a]=i}),n),{}),r=n=>Object.keys(n).reduce((i,a)=>e[a]?ib(i,e[a](n)):i,{});return r.propTypes={},r.filterProps=t.reduce((n,i)=>n.concat(i.filterProps),[]),r}function Mh(t){return typeof t!="number"?t:`${t}px solid`}function Zh(t,e){return al({prop:t,themeKey:"borders",transform:e})}const Mse=Zh("border",Mh),Dse=Zh("borderTop",Mh),Ose=Zh("borderRight",Mh),Nse=Zh("borderBottom",Mh),Lse=Zh("borderLeft",Mh),Fse=Zh("borderColor"),Bse=Zh("borderTopColor"),zse=Zh("borderRightColor"),jse=Zh("borderBottomColor"),Use=Zh("borderLeftColor"),Vse=Zh("outline",Mh),$se=Zh("outlineColor"),DT=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Cx(t.theme,"shape.borderRadius",4),r=n=>({borderRadius:Ax(e,n)});return bp(t,t.borderRadius,r)}return null};DT.propTypes={};DT.filterProps=["borderRadius"];MT(Mse,Dse,Ose,Nse,Lse,Fse,Bse,zse,jse,Use,DT,Vse,$se);const OT=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Cx(t.theme,"spacing",8),r=n=>({gap:Ax(e,n)});return bp(t,t.gap,r)}return null};OT.propTypes={};OT.filterProps=["gap"];const NT=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Cx(t.theme,"spacing",8),r=n=>({columnGap:Ax(e,n)});return bp(t,t.columnGap,r)}return null};NT.propTypes={};NT.filterProps=["columnGap"];const LT=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Cx(t.theme,"spacing",8),r=n=>({rowGap:Ax(e,n)});return bp(t,t.rowGap,r)}return null};LT.propTypes={};LT.filterProps=["rowGap"];const qse=al({prop:"gridColumn"}),Hse=al({prop:"gridRow"}),Wse=al({prop:"gridAutoFlow"}),Gse=al({prop:"gridAutoColumns"}),Xse=al({prop:"gridAutoRows"}),Yse=al({prop:"gridTemplateColumns"}),Zse=al({prop:"gridTemplateRows"}),Kse=al({prop:"gridTemplateAreas"}),Jse=al({prop:"gridArea"});MT(OT,NT,LT,qse,Hse,Wse,Gse,Xse,Yse,Zse,Kse,Jse);function x0(t,e){return e==="grey"?e:t}const Qse=al({prop:"color",themeKey:"palette",transform:x0}),ele=al({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:x0}),tle=al({prop:"backgroundColor",themeKey:"palette",transform:x0});MT(Qse,ele,tle);function nh(t){return t<=1&&t!==0?`${t*100}%`:t}const rle=al({prop:"width",transform:nh}),LD=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=r=>{const n=t.theme?.breakpoints?.values?.[r]||kT[r];return n?t.theme?.breakpoints?.unit!=="px"?{maxWidth:`${n}${t.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:nh(r)}};return bp(t,t.maxWidth,e)}return null};LD.filterProps=["maxWidth"];const nle=al({prop:"minWidth",transform:nh}),ile=al({prop:"height",transform:nh}),ale=al({prop:"maxHeight",transform:nh}),ole=al({prop:"minHeight",transform:nh});al({prop:"size",cssProperty:"width",transform:nh});al({prop:"size",cssProperty:"height",transform:nh});const sle=al({prop:"boxSizing"});MT(rle,LD,nle,ile,ale,ole,sle);const Ix={border:{themeKey:"borders",transform:Mh},borderTop:{themeKey:"borders",transform:Mh},borderRight:{themeKey:"borders",transform:Mh},borderBottom:{themeKey:"borders",transform:Mh},borderLeft:{themeKey:"borders",transform:Mh},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Mh},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:DT},color:{themeKey:"palette",transform:x0},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:x0},backgroundColor:{themeKey:"palette",transform:x0},p:{style:Fs},pt:{style:Fs},pr:{style:Fs},pb:{style:Fs},pl:{style:Fs},px:{style:Fs},py:{style:Fs},padding:{style:Fs},paddingTop:{style:Fs},paddingRight:{style:Fs},paddingBottom:{style:Fs},paddingLeft:{style:Fs},paddingX:{style:Fs},paddingY:{style:Fs},paddingInline:{style:Fs},paddingInlineStart:{style:Fs},paddingInlineEnd:{style:Fs},paddingBlock:{style:Fs},paddingBlockStart:{style:Fs},paddingBlockEnd:{style:Fs},m:{style:Ls},mt:{style:Ls},mr:{style:Ls},mb:{style:Ls},ml:{style:Ls},mx:{style:Ls},my:{style:Ls},margin:{style:Ls},marginTop:{style:Ls},marginRight:{style:Ls},marginBottom:{style:Ls},marginLeft:{style:Ls},marginX:{style:Ls},marginY:{style:Ls},marginInline:{style:Ls},marginInlineStart:{style:Ls},marginInlineEnd:{style:Ls},marginBlock:{style:Ls},marginBlockStart:{style:Ls},marginBlockEnd:{style:Ls},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:OT},rowGap:{style:LT},columnGap:{style:NT},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:nh},maxWidth:{style:LD},minWidth:{transform:nh},height:{transform:nh},maxHeight:{transform:nh},minHeight:{transform:nh},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function lle(...t){const e=t.reduce((n,i)=>n.concat(Object.keys(i)),[]),r=new Set(e);return t.every(n=>r.size===Object.keys(n).length)}function ule(t,e){return typeof t=="function"?t(e):t}function cle(){function t(r,n,i,a){const s={[r]:n,theme:i},o=a[r];if(!o)return{[r]:n};const{cssProperty:c=r,themeKey:h,transform:d,style:m}=o;if(n==null)return null;if(h==="typography"&&n==="inherit")return{[r]:n};const b=RT(i,h)||{};return m?m(s):bp(s,n,E=>{let T=VS(b,d,E);return E===T&&typeof E=="string"&&(T=VS(b,d,`${r}${E==="default"?"":cn(E)}`,E)),c===!1?T:{[c]:T}})}function e(r){const{sx:n,theme:i={},nested:a}=r||{};if(!n)return null;const s=i.unstable_sxConfig??Ix;function o(c){let h=c;if(typeof c=="function")h=c(i);else if(typeof c!="object")return c;if(!h)return null;const d=Tse(i.breakpoints),m=Object.keys(d);let b=d;return Object.keys(h).forEach(x=>{const E=ule(h[x],i);if(E!=null)if(typeof E=="object")if(s[x])b=ib(b,t(x,E,i,s));else{const T=bp({theme:i},E,A=>({[x]:A}));lle(T,E)?b[x]=e({sx:E,theme:i,nested:!0}):b=ib(b,T)}else b=ib(b,t(x,E,i,s))}),!a&&i.modularCssLayers?{"@layer sx":iB(i,oB(m,b))}:iB(i,oB(m,b))}return Array.isArray(n)?n.map(o):o(n)}return e}const Sg=cle();Sg.filterProps=["sx"];function hle(t,e){const r=this;if(r.vars){if(!r.colorSchemes?.[t]||typeof r.getColorSchemeSelector!="function")return{};let n=r.getColorSchemeSelector(t);return n==="&"?e:((n.includes("data-")||n.includes("."))&&(n=`*:where(${n.replace(/\s*&$/,"")}) &`),{[n]:e})}return r.palette.mode===t?e:{}}function FT(t={},...e){const{breakpoints:r={},palette:n={},spacing:i,shape:a={},...s}=t,o=_se(r),c=uX(i);let h=Qu({breakpoints:o,direction:"ltr",components:{},palette:{mode:"light",...n},spacing:c,shape:{...Sse,...a}},s);return h=wse(h),h.applyStyles=hle,h=e.reduce((d,m)=>Qu(d,m),h),h.unstable_sxConfig={...Ix,...s?.unstable_sxConfig},h.unstable_sx=function(m){return Sg({sx:m,theme:this})},h}function fle(t){return Object.keys(t).length===0}function BT(t=null){const e=te.useContext(Ex);return!e||fle(e)?t:e}const dle=FT();function Px(t=dle){return BT(t)}function sA(t){const e=vg(t);return t!==e&&e.styles?(e.styles.match(/^@layer\s+[^{]*$/)||(e.styles=`@layer global{${e.styles}}`),e):t}function cX({styles:t,themeId:e,defaultTheme:r={}}){const n=Px(r),i=e&&n[e]||n;let a=typeof t=="function"?t(i):t;return i.modularCssLayers&&(Array.isArray(a)?a=a.map(s=>sA(typeof s=="function"?s(i):s)):a=sA(a)),J.jsx(iX,{styles:a})}const ple=t=>{const e={systemProps:{},otherProps:{}},r=t?.theme?.unstable_sxConfig??Ix;return Object.keys(t).forEach(n=>{r[n]?e.systemProps[n]=t[n]:e.otherProps[n]=t[n]}),e};function FD(t){const{sx:e,...r}=t,{systemProps:n,otherProps:i}=ple(r);let a;return Array.isArray(e)?a=[n,...e]:typeof e=="function"?a=(...s)=>{const o=e(...s);return ud(o)?{...n,...o}:n}:a={...n,...e},{...i,sx:a}}const lB=t=>t,gle=()=>{let t=lB;return{configure(e){t=e},generate(e){return t(e)},reset(){t=lB}}},BD=gle();function hX(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=hX(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function An(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=hX(t))&&(n&&(n+=" "),n+=e);return n}function fX(t={}){const{themeId:e,defaultTheme:r,defaultClassName:n="MuiBox-root",generateClassName:i}=t,a=aX("div",{shouldForwardProp:o=>o!=="theme"&&o!=="sx"&&o!=="as"})(Sg);return te.forwardRef(function(c,h){const d=Px(r),{className:m,component:b="div",...x}=FD(c);return J.jsx(a,{as:b,ref:h,className:An(m,i?i(n):n),theme:e&&d[e]||d,...x})})}const mle={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function gi(t,e,r="Mui"){const n=mle[e];return n?`${r}-${n}`:`${BD.generate(t)}-${e}`}function pi(t,e,r="Mui"){const n={};return e.forEach(i=>{n[i]=gi(t,i,r)}),n}const yle=pi("MuiBox",["root"]),Mv=fX({defaultClassName:yle.root,generateClassName:BD.generate});function dX(t){const{variants:e,...r}=t,n={variants:e,style:vg(r),isProcessed:!0};return n.style===r||e&&e.forEach(i=>{typeof i.style!="function"&&(i.style=vg(i.style))}),n}const vle=FT();function lA(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function Im(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}function _le(t){return t?(e,r)=>r[t]:null}function ble(t,e,r){t.theme=wle(t.theme)?r:t.theme[e]||t.theme}function lS(t,e,r){const n=typeof e=="function"?e(t):e;if(Array.isArray(n))return n.flatMap(i=>lS(t,i,r));if(Array.isArray(n?.variants)){let i;if(n.isProcessed)i=r?Im(n.style,r):n.style;else{const{variants:a,...s}=n;i=r?Im(vg(s),r):s}return pX(t,n.variants,[i],r)}return n?.isProcessed?r?Im(vg(n.style),r):n.style:r?Im(vg(n),r):n}function pX(t,e,r=[],n=void 0){let i;e:for(let a=0;a<e.length;a+=1){const s=e[a];if(typeof s.props=="function"){if(i??={...t,...t.ownerState,ownerState:t.ownerState},!s.props(i))continue}else for(const o in s.props)if(t[o]!==s.props[o]&&t.ownerState?.[o]!==s.props[o])continue e;typeof s.style=="function"?(i??={...t,...t.ownerState,ownerState:t.ownerState},r.push(n?Im(vg(s.style(i)),n):s.style(i))):r.push(n?Im(vg(s.style),n):s.style)}return r}function gX(t={}){const{themeId:e,defaultTheme:r=vle,rootShouldForwardProp:n=lA,slotShouldForwardProp:i=lA}=t;function a(o){ble(o,e,r)}return(o,c={})=>{gse(o,j=>j.filter(H=>H!==Sg));const{name:h,slot:d,skipVariantsResolver:m,skipSx:b,overridesResolver:x=_le(Ele(d)),...E}=c,T=h&&h.startsWith("Mui")||d?"components":"custom",A=m!==void 0?m:d&&d!=="Root"&&d!=="root"||!1,M=b||!1;let F=lA;d==="Root"||d==="root"?F=n:d?F=i:Sle(o)&&(F=void 0);const N=aX(o,{shouldForwardProp:F,label:xle(),...E}),O=j=>{if(j.__emotion_real===j)return j;if(typeof j=="function")return function(G){return lS(G,j,G.theme.modularCssLayers?T:void 0)};if(ud(j)){const H=dX(j);return function(X){return H.variants?lS(X,H,X.theme.modularCssLayers?T:void 0):X.theme.modularCssLayers?Im(H.style,T):H.style}}return j},U=(...j)=>{const H=[],G=j.map(O),X=[];if(H.push(a),h&&x&&X.push(function(oe){const he=oe.theme.components?.[h]?.styleOverrides;if(!he)return null;const _e={};for(const Ce in he)_e[Ce]=lS(oe,he[Ce],oe.theme.modularCssLayers?"theme":void 0);return x(oe,_e)}),h&&!A&&X.push(function(oe){const he=oe.theme?.components?.[h]?.variants;return he?pX(oe,he,[],oe.theme.modularCssLayers?"theme":void 0):null}),M||X.push(Sg),Array.isArray(G[0])){const W=G.shift(),oe=new Array(H.length).fill(""),se=new Array(X.length).fill("");let he;he=[...oe,...W,...se],he.raw=[...oe,...W.raw,...se],H.unshift(he)}const ae=[...H,...G,...X],Q=N(...ae);return o.muiName&&(Q.muiName=o.muiName),Q};return N.withConfig&&(U.withConfig=N.withConfig),U}}function xle(t,e){return void 0}function wle(t){for(const e in t)return!1;return!0}function Sle(t){return typeof t=="string"&&t.charCodeAt(0)>96}function Ele(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}const _y=gX();function Ob(t,e,r=!1){const n={...e};for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const a=i;if(a==="components"||a==="slots")n[a]={...t[a],...n[a]};else if(a==="componentsProps"||a==="slotProps"){const s=t[a],o=e[a];if(!o)n[a]=s||{};else if(!s)n[a]=o;else{n[a]={...o};for(const c in s)if(Object.prototype.hasOwnProperty.call(s,c)){const h=c;n[a][h]=Ob(s[h],o[h],r)}}}else a==="className"&&r&&e.className?n.className=An(t?.className,e?.className):a==="style"&&r&&e.style?n.style={...t?.style,...e?.style}:n[a]===void 0&&(n[a]=t[a])}return n}function mX(t){const{theme:e,name:r,props:n}=t;return!e||!e.components||!e.components[r]||!e.components[r].defaultProps?n:Ob(e.components[r].defaultProps,n)}function Tle({props:t,name:e,defaultTheme:r,themeId:n}){let i=Px(r);return n&&(i=i[n]||i),mX({theme:i,name:e,props:t})}const Tu=typeof window<"u"?te.useLayoutEffect:te.useEffect;function Cle(t,e,r,n,i){const[a,s]=te.useState(()=>i&&r?r(t).matches:n?n(t).matches:e);return Tu(()=>{if(!r)return;const o=r(t),c=()=>{s(o.matches)};return c(),o.addEventListener("change",c),()=>{o.removeEventListener("change",c)}},[t,r]),a}const Ale={...zS},yX=Ale.useSyncExternalStore;function Ile(t,e,r,n,i){const a=te.useCallback(()=>e,[e]),s=te.useMemo(()=>{if(i&&r)return()=>r(t).matches;if(n!==null){const{matches:d}=n(t);return()=>d}return a},[a,t,n,i,r]),[o,c]=te.useMemo(()=>{if(r===null)return[a,()=>()=>{}];const d=r(t);return[()=>d.matches,m=>(d.addEventListener("change",m),()=>{d.removeEventListener("change",m)})]},[a,r,t]);return yX(c,o,s)}function vX(t={}){const{themeId:e}=t;return function(n,i={}){let a=BT();a&&e&&(a=a[e]||a);const s=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:o=!1,matchMedia:c=s?window.matchMedia:null,ssrMatchMedia:h=null,noSsr:d=!1}=mX({name:"MuiUseMediaQuery",props:i,theme:a});let m=typeof n=="function"?n(a):n;return m=m.replace(/^@media( ?)/m,""),m.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),(yX!==void 0?Ile:Cle)(m,o,c,h,d)}}vX();function Dv(t,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,r))}function zD(t,e=0,r=1){return Dv(t,e,r)}function Ple(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let r=t.match(e);return r&&r[0].length===1&&(r=r.map(n=>n+n)),r?`rgb${r.length===4?"a":""}(${r.map((n,i)=>i<3?parseInt(n,16):Math.round(parseInt(n,16)/255*1e3)/1e3).join(", ")})`:""}function Eg(t){if(t.type)return t;if(t.charAt(0)==="#")return Eg(Ple(t));const e=t.indexOf("("),r=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(r))throw new Error(_p(9,t));let n=t.substring(e+1,t.length-1),i;if(r==="color"){if(n=n.split(" "),i=n.shift(),n.length===4&&n[3].charAt(0)==="/"&&(n[3]=n[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(i))throw new Error(_p(10,i))}else n=n.split(",");return n=n.map(a=>parseFloat(a)),{type:r,values:n,colorSpace:i}}const kle=t=>{const e=Eg(t);return e.values.slice(0,3).map((r,n)=>e.type.includes("hsl")&&n!==0?`${r}%`:r).join(" ")},P1=(t,e)=>{try{return kle(t)}catch{return t}};function zT(t){const{type:e,colorSpace:r}=t;let{values:n}=t;return e.includes("rgb")?n=n.map((i,a)=>a<3?parseInt(i,10):i):e.includes("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),e.includes("color")?n=`${r} ${n.join(" ")}`:n=`${n.join(", ")}`,`${e}(${n})`}function _X(t){t=Eg(t);const{values:e}=t,r=e[0],n=e[1]/100,i=e[2]/100,a=n*Math.min(i,1-i),s=(h,d=(h+r/30)%12)=>i-a*Math.max(Math.min(d-3,9-d,1),-1);let o="rgb";const c=[Math.round(s(0)*255),Math.round(s(8)*255),Math.round(s(4)*255)];return t.type==="hsla"&&(o+="a",c.push(e[3])),zT({type:o,values:c})}function xk(t){t=Eg(t);let e=t.type==="hsl"||t.type==="hsla"?Eg(_X(t)).values:t.values;return e=e.map(r=>(t.type!=="color"&&(r/=255),r<=.03928?r/12.92:((r+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Rle(t,e){const r=xk(t),n=xk(e);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}function $S(t,e){return t=Eg(t),e=zD(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,zT(t)}function um(t,e,r){try{return $S(t,e)}catch{return t}}function jT(t,e){if(t=Eg(t),e=zD(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]*=1-e;return zT(t)}function co(t,e,r){try{return jT(t,e)}catch{return t}}function UT(t,e){if(t=Eg(t),e=zD(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let r=0;r<3;r+=1)t.values[r]+=(255-t.values[r])*e;else if(t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]+=(1-t.values[r])*e;return zT(t)}function ho(t,e,r){try{return UT(t,e)}catch{return t}}function wk(t,e=.15){return xk(t)>.5?jT(t,e):UT(t,e)}function B2(t,e,r){try{return wk(t,e)}catch{return t}}const bX=te.createContext(null);function jD(){return te.useContext(bX)}const Mle=typeof Symbol=="function"&&Symbol.for,Dle=Mle?Symbol.for("mui.nested"):"__THEME_NESTED__";function Ole(t,e){return typeof e=="function"?e(t):{...t,...e}}function Nle(t){const{children:e,theme:r}=t,n=jD(),i=te.useMemo(()=>{const a=n===null?{...r}:Ole(n,r);return a!=null&&(a[Dle]=n!==null),a},[r,n]);return J.jsx(bX.Provider,{value:i,children:e})}const xX=te.createContext();function Lle({value:t,...e}){return J.jsx(xX.Provider,{value:t??!0,...e})}const kx=()=>te.useContext(xX)??!1,wX=te.createContext(void 0);function Fle({value:t,children:e}){return J.jsx(wX.Provider,{value:t,children:e})}function Ble(t){const{theme:e,name:r,props:n}=t;if(!e||!e.components||!e.components[r])return n;const i=e.components[r];return i.defaultProps?Ob(i.defaultProps,n,e.components.mergeClassNameAndStyle):!i.styleOverrides&&!i.variants?Ob(i,n,e.components.mergeClassNameAndStyle):n}function zle({props:t,name:e}){const r=te.useContext(wX);return Ble({props:t,name:e,theme:{components:r}})}let uB=0;function jle(t){const[e,r]=te.useState(t),n=t||e;return te.useEffect(()=>{e==null&&(uB+=1,r(`mui-${uB}`))},[e]),n}const Ule={...zS},cB=Ule.useId;function Og(t){if(cB!==void 0){const e=cB();return t??e}return jle(t)}function Vle(t){const e=BT(),r=Og()||"",{modularCssLayers:n}=t;let i="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!n||e!==null?i="":typeof n=="string"?i=n.replace(/mui(?!\.)/g,i):i=`@layer ${i};`,Tu(()=>{const a=document.querySelector("head");if(!a)return;const s=a.firstChild;if(i){if(s&&s.hasAttribute?.("data-mui-layer-order")&&s.getAttribute("data-mui-layer-order")===r)return;const o=document.createElement("style");o.setAttribute("data-mui-layer-order",r),o.textContent=i,a.prepend(o)}else a.querySelector(`style[data-mui-layer-order="${r}"]`)?.remove()},[i,r]),i?J.jsx(cX,{styles:i}):null}const hB={};function fB(t,e,r,n=!1){return te.useMemo(()=>{const i=t&&e[t]||e;if(typeof r=="function"){const a=r(i),s=t?{...e,[t]:a}:a;return n?()=>s:s}return t?{...e,[t]:r}:{...e,...r}},[t,e,r,n])}function SX(t){const{children:e,theme:r,themeId:n}=t,i=BT(hB),a=jD()||hB,s=fB(n,i,r),o=fB(n,a,r,!0),c=(n?s[n]:s).direction==="rtl",h=Vle(s);return J.jsx(Nle,{theme:o,children:J.jsx(Ex.Provider,{value:s,children:J.jsx(Lle,{value:c,children:J.jsxs(Fle,{value:n?s[n].components:s.components,children:[h,e]})})})})}const dB={theme:void 0};function $le(t){let e,r;return function(i){let a=e;return(a===void 0||i.theme!==r)&&(dB.theme=i.theme,a=dX(t(dB)),e=a,r=i.theme),a}}const UD="mode",VD="color-scheme",qle="data-color-scheme";function Hle(t){const{defaultMode:e="system",defaultLightColorScheme:r="light",defaultDarkColorScheme:n="dark",modeStorageKey:i=UD,colorSchemeStorageKey:a=VD,attribute:s=qle,colorSchemeNode:o="document.documentElement",nonce:c}=t||{};let h="",d=s;if(s==="class"&&(d=".%s"),s==="data"&&(d="[data-%s]"),d.startsWith(".")){const b=d.substring(1);h+=`${o}.classList.remove('${b}'.replace('%s', light), '${b}'.replace('%s', dark));
      ${o}.classList.add('${b}'.replace('%s', colorScheme));`}const m=d.match(/\[([^[\]]+)\]/);if(m){const[b,x]=m[1].split("=");x||(h+=`${o}.removeAttribute('${b}'.replace('%s', light));
      ${o}.removeAttribute('${b}'.replace('%s', dark));`),h+=`
      ${o}.setAttribute('${b}'.replace('%s', colorScheme), ${x?`${x}.replace('%s', colorScheme)`:'""'});`}else h+=`${o}.setAttribute('${d}', colorScheme);`;return J.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?c:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${i}') || '${e}';
  const dark = localStorage.getItem('${a}-dark') || '${n}';
  const light = localStorage.getItem('${a}-light') || '${r}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${h}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function Wle(){}const Gle=({key:t,storageWindow:e})=>(!e&&typeof window<"u"&&(e=window),{get(r){if(typeof window>"u")return;if(!e)return r;let n;try{n=e.localStorage.getItem(t)}catch{}return n||r},set:r=>{if(e)try{e.localStorage.setItem(t,r)}catch{}},subscribe:r=>{if(!e)return Wle;const n=i=>{const a=i.newValue;i.key===t&&r(a)};return e.addEventListener("storage",n),()=>{e.removeEventListener("storage",n)}}});function uA(){}function pB(t){if(typeof window<"u"&&typeof window.matchMedia=="function"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function EX(t,e){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return e("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return e("dark")}function Xle(t){return EX(t,e=>{if(e==="light")return t.lightColorScheme;if(e==="dark")return t.darkColorScheme})}function Yle(t){const{defaultMode:e="light",defaultLightColorScheme:r,defaultDarkColorScheme:n,supportedColorSchemes:i=[],modeStorageKey:a=UD,colorSchemeStorageKey:s=VD,storageWindow:o=typeof window>"u"?void 0:window,storageManager:c=Gle,noSsr:h=!1}=t,d=i.join(","),m=i.length>1,b=te.useMemo(()=>c?.({key:a,storageWindow:o}),[c,a,o]),x=te.useMemo(()=>c?.({key:`${s}-light`,storageWindow:o}),[c,s,o]),E=te.useMemo(()=>c?.({key:`${s}-dark`,storageWindow:o}),[c,s,o]),[T,A]=te.useState(()=>{const G=b?.get(e)||e,X=x?.get(r)||r,ae=E?.get(n)||n;return{mode:G,systemMode:pB(G),lightColorScheme:X,darkColorScheme:ae}}),[M,F]=te.useState(h||!m);te.useEffect(()=>{F(!0)},[]);const N=Xle(T),O=te.useCallback(G=>{A(X=>{if(G===X.mode)return X;const ae=G??e;return b?.set(ae),{...X,mode:ae,systemMode:pB(ae)}})},[b,e]),U=te.useCallback(G=>{G?typeof G=="string"?G&&!d.includes(G)?console.error(`\`${G}\` does not exist in \`theme.colorSchemes\`.`):A(X=>{const ae={...X};return EX(X,Q=>{Q==="light"&&(x?.set(G),ae.lightColorScheme=G),Q==="dark"&&(E?.set(G),ae.darkColorScheme=G)}),ae}):A(X=>{const ae={...X},Q=G.light===null?r:G.light,W=G.dark===null?n:G.dark;return Q&&(d.includes(Q)?(ae.lightColorScheme=Q,x?.set(Q)):console.error(`\`${Q}\` does not exist in \`theme.colorSchemes\`.`)),W&&(d.includes(W)?(ae.darkColorScheme=W,E?.set(W)):console.error(`\`${W}\` does not exist in \`theme.colorSchemes\`.`)),ae}):A(X=>(x?.set(r),E?.set(n),{...X,lightColorScheme:r,darkColorScheme:n}))},[d,x,E,r,n]),j=te.useCallback(G=>{T.mode==="system"&&A(X=>{const ae=G?.matches?"dark":"light";return X.systemMode===ae?X:{...X,systemMode:ae}})},[T.mode]),H=te.useRef(j);return H.current=j,te.useEffect(()=>{if(typeof window.matchMedia!="function"||!m)return;const G=(...ae)=>H.current(...ae),X=window.matchMedia("(prefers-color-scheme: dark)");return X.addListener(G),G(X),()=>{X.removeListener(G)}},[m]),te.useEffect(()=>{if(m){const G=b?.subscribe(Q=>{(!Q||["light","dark","system"].includes(Q))&&O(Q||e)})||uA,X=x?.subscribe(Q=>{(!Q||d.match(Q))&&U({light:Q})})||uA,ae=E?.subscribe(Q=>{(!Q||d.match(Q))&&U({dark:Q})})||uA;return()=>{G(),X(),ae()}}},[U,O,d,e,o,m,b,x,E]),{...T,mode:M?T.mode:void 0,systemMode:M?T.systemMode:void 0,colorScheme:M?N:void 0,setMode:O,setColorScheme:U}}const Zle="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function Kle(t){const{themeId:e,theme:r={},modeStorageKey:n=UD,colorSchemeStorageKey:i=VD,disableTransitionOnChange:a=!1,defaultColorScheme:s,resolveTheme:o}=t,c={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},h=te.createContext(void 0),d=()=>te.useContext(h)||c,m={},b={};function x(M){const{children:F,theme:N,modeStorageKey:O=n,colorSchemeStorageKey:U=i,disableTransitionOnChange:j=a,storageManager:H,storageWindow:G=typeof window>"u"?void 0:window,documentNode:X=typeof document>"u"?void 0:document,colorSchemeNode:ae=typeof document>"u"?void 0:document.documentElement,disableNestedContext:Q=!1,disableStyleSheetGeneration:W=!1,defaultMode:oe="system",forceThemeRerender:se=!1,noSsr:he}=M,_e=te.useRef(!1),Ce=jD(),me=te.useContext(h),xe=!!me&&!Q,Ae=te.useMemo(()=>N||(typeof r=="function"?r():r),[N]),De=Ae[e],de=De||Ae,{colorSchemes:Ee=m,components:we=b,cssVarPrefix:Le}=de,Fe=Object.keys(Ee).filter(at=>!!Ee[at]).join(","),Xe=te.useMemo(()=>Fe.split(","),[Fe]),Be=typeof s=="string"?s:s.light,ot=typeof s=="string"?s:s.dark,Qe=Ee[Be]&&Ee[ot]?oe:Ee[de.defaultColorScheme]?.palette?.mode||de.palette?.mode,{mode:rt,setMode:Re,systemMode:zt,lightColorScheme:st,darkColorScheme:$e,colorScheme:Jt,setColorScheme:Ht}=Yle({supportedColorSchemes:Xe,defaultLightColorScheme:Be,defaultDarkColorScheme:ot,modeStorageKey:O,colorSchemeStorageKey:U,defaultMode:Qe,storageManager:H,storageWindow:G,noSsr:he});let pr=rt,_t=Jt;xe&&(pr=me.mode,_t=me.colorScheme);let vr=_t||de.defaultColorScheme;de.vars&&!se&&(vr=de.defaultColorScheme);const br=te.useMemo(()=>{const at=de.generateThemeVars?.()||de.vars,ke={...de,components:we,colorSchemes:Ee,cssVarPrefix:Le,vars:at};if(typeof ke.generateSpacing=="function"&&(ke.spacing=ke.generateSpacing()),vr){const be=Ee[vr];be&&typeof be=="object"&&Object.keys(be).forEach(je=>{be[je]&&typeof be[je]=="object"?ke[je]={...ke[je],...be[je]}:ke[je]=be[je]})}return o?o(ke):ke},[de,vr,we,Ee,Le]),lr=de.colorSchemeSelector;Tu(()=>{if(_t&&ae&&lr&&lr!=="media"){const at=lr;let ke=lr;if(at==="class"&&(ke=".%s"),at==="data"&&(ke="[data-%s]"),at?.startsWith("data-")&&!at.includes("%s")&&(ke=`[${at}="%s"]`),ke.startsWith("."))ae.classList.remove(...Xe.map(be=>ke.substring(1).replace("%s",be))),ae.classList.add(ke.substring(1).replace("%s",_t));else{const be=ke.replace("%s",_t).match(/\[([^\]]+)\]/);if(be){const[je,qe]=be[1].split("=");qe||Xe.forEach(We=>{ae.removeAttribute(je.replace(_t,We))}),ae.setAttribute(je,qe?qe.replace(/"|'/g,""):"")}else ae.setAttribute(ke,_t)}}},[_t,lr,ae,Xe]),te.useEffect(()=>{let at;if(j&&_e.current&&X){const ke=X.createElement("style");ke.appendChild(X.createTextNode(Zle)),X.head.appendChild(ke),window.getComputedStyle(X.body),at=setTimeout(()=>{X.head.removeChild(ke)},1)}return()=>{clearTimeout(at)}},[_t,j,X]),te.useEffect(()=>(_e.current=!0,()=>{_e.current=!1}),[]);const Cr=te.useMemo(()=>({allColorSchemes:Xe,colorScheme:_t,darkColorScheme:$e,lightColorScheme:st,mode:pr,setColorScheme:Ht,setMode:Re,systemMode:zt}),[Xe,_t,$e,st,pr,Ht,Re,zt,br.colorSchemeSelector]);let Tr=!0;(W||de.cssVariables===!1||xe&&Ce?.cssVarPrefix===Le)&&(Tr=!1);const Qt=J.jsxs(te.Fragment,{children:[J.jsx(SX,{themeId:De?e:void 0,theme:br,children:F}),Tr&&J.jsx(iX,{styles:br.generateStyleSheets?.()||[]})]});return xe?Qt:J.jsx(h.Provider,{value:Cr,children:Qt})}const E=typeof s=="string"?s:s.light,T=typeof s=="string"?s:s.dark;return{CssVarsProvider:x,useColorScheme:d,getInitColorSchemeScript:M=>Hle({colorSchemeStorageKey:i,defaultLightColorScheme:E,defaultDarkColorScheme:T,modeStorageKey:n,...M})}}function Jle(t=""){function e(...n){if(!n.length)return"";const i=n[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${i}${e(...n.slice(1))})`:`, ${i}`}return(n,...i)=>`var(--${t?`${t}-`:""}${n}${e(...i)})`}const gB=(t,e,r,n=[])=>{let i=t;e.forEach((a,s)=>{s===e.length-1?Array.isArray(i)?i[Number(a)]=r:i&&typeof i=="object"&&(i[a]=r):i&&typeof i=="object"&&(i[a]||(i[a]=n.includes(a)?[]:{}),i=i[a])})},Qle=(t,e,r)=>{function n(i,a=[],s=[]){Object.entries(i).forEach(([o,c])=>{(!r||r&&!r([...a,o]))&&c!=null&&(typeof c=="object"&&Object.keys(c).length>0?n(c,[...a,o],Array.isArray(c)?[...s,o]:s):e([...a,o],c,s))})}n(t)},eue=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(n=>t.includes(n))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function cA(t,e){const{prefix:r,shouldSkipGeneratingVar:n}=e||{},i={},a={},s={};return Qle(t,(o,c,h)=>{if((typeof c=="string"||typeof c=="number")&&(!n||!n(o,c))){const d=`--${r?`${r}-`:""}${o.join("-")}`,m=eue(o,c);Object.assign(i,{[d]:m}),gB(a,o,`var(${d})`,h),gB(s,o,`var(${d}, ${m})`,h)}},o=>o[0]==="vars"),{css:i,vars:a,varsWithDefaults:s}}function tue(t,e={}){const{getSelector:r=M,disableCssColorScheme:n,colorSchemeSelector:i,enableContrastVars:a}=e,{colorSchemes:s={},components:o,defaultColorScheme:c="light",...h}=t,{vars:d,css:m,varsWithDefaults:b}=cA(h,e);let x=b;const E={},{[c]:T,...A}=s;if(Object.entries(A||{}).forEach(([O,U])=>{const{vars:j,css:H,varsWithDefaults:G}=cA(U,e);x=Qu(x,G),E[O]={css:H,vars:j}}),T){const{css:O,vars:U,varsWithDefaults:j}=cA(T,e);x=Qu(x,j),E[c]={css:O,vars:U}}function M(O,U){let j=i;if(i==="class"&&(j=".%s"),i==="data"&&(j="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(j=`[${i}="%s"]`),O){if(j==="media")return t.defaultColorScheme===O?":root":{[`@media (prefers-color-scheme: ${s[O]?.palette?.mode||O})`]:{":root":U}};if(j)return t.defaultColorScheme===O?`:root, ${j.replace("%s",String(O))}`:j.replace("%s",String(O))}return":root"}return{vars:x,generateThemeVars:()=>{let O={...d};return Object.entries(E).forEach(([,{vars:U}])=>{O=Qu(O,U)}),O},generateStyleSheets:()=>{const O=[],U=t.defaultColorScheme||"light";function j(X,ae){Object.keys(ae).length&&O.push(typeof X=="string"?{[X]:{...ae}}:X)}j(r(void 0,{...m}),m);const{[U]:H,...G}=E;if(H){const{css:X}=H,ae=s[U]?.palette?.mode,Q=!n&&ae?{colorScheme:ae,...X}:{...X};j(r(U,{...Q}),Q)}return Object.entries(G).forEach(([X,{css:ae}])=>{const Q=s[X]?.palette?.mode,W=!n&&Q?{colorScheme:Q,...ae}:{...ae};j(r(X,{...W}),W)}),a&&O.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),O}}}function rue(t){return function(r){return t==="media"?`@media (prefers-color-scheme: ${r})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${r}"] &`:t==="class"?`.${r} &`:t==="data"?`[data-${r}] &`:`${t.replace("%s",r)} &`:"&"}}function mi(t,e,r=void 0){const n={};for(const i in t){const a=t[i];let s="",o=!0;for(let c=0;c<a.length;c+=1){const h=a[c];h&&(s+=(o===!0?"":" ")+e(h),o=!1,r&&r[h]&&(s+=" "+r[h]))}n[i]=s}return n}function ab(t,e){return te.isValidElement(t)&&e.indexOf(t.type.muiName??t.type?._payload?.value?.muiName)!==-1}const nue=(t,e)=>t.filter(r=>e.includes(r)),u_=(t,e,r)=>{const n=t.keys[0];Array.isArray(e)?e.forEach((i,a)=>{r((s,o)=>{a<=t.keys.length-1&&(a===0?Object.assign(s,o):s[t.up(t.keys[a])]=o)},i)}):e&&typeof e=="object"?(Object.keys(e).length>t.keys.length?t.keys:nue(t.keys,Object.keys(e))).forEach(a=>{if(t.keys.includes(a)){const s=e[a];s!==void 0&&r((o,c)=>{n===a?Object.assign(o,c):o[t.up(a)]=c},s)}}):(typeof e=="number"||typeof e=="string")&&r((i,a)=>{Object.assign(i,a)},e)};function qS(t){return`--Grid-${t}Spacing`}function VT(t){return`--Grid-parent-${t}Spacing`}const mB="--Grid-columns",w0="--Grid-parent-columns",iue=({theme:t,ownerState:e})=>{const r={};return u_(t.breakpoints,e.size,(n,i)=>{let a={};i==="grow"&&(a={flexBasis:0,flexGrow:1,maxWidth:"100%"}),i==="auto"&&(a={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof i=="number"&&(a={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${i} / var(${w0}) - (var(${w0}) - ${i}) * (var(${VT("column")}) / var(${w0})))`}),n(r,a)}),r},aue=({theme:t,ownerState:e})=>{const r={};return u_(t.breakpoints,e.offset,(n,i)=>{let a={};i==="auto"&&(a={marginLeft:"auto"}),typeof i=="number"&&(a={marginLeft:i===0?"0px":`calc(100% * ${i} / var(${w0}) + var(${VT("column")}) * ${i} / var(${w0}))`}),n(r,a)}),r},oue=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={[mB]:12};return u_(t.breakpoints,e.columns,(n,i)=>{const a=i??12;n(r,{[mB]:a,"> *":{[w0]:a}})}),r},sue=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return u_(t.breakpoints,e.rowSpacing,(n,i)=>{const a=typeof i=="string"?i:t.spacing?.(i);n(r,{[qS("row")]:a,"> *":{[VT("row")]:a}})}),r},lue=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return u_(t.breakpoints,e.columnSpacing,(n,i)=>{const a=typeof i=="string"?i:t.spacing?.(i);n(r,{[qS("column")]:a,"> *":{[VT("column")]:a}})}),r},uue=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return u_(t.breakpoints,e.direction,(n,i)=>{n(r,{flexDirection:i})}),r},cue=({ownerState:t})=>({minWidth:0,boxSizing:"border-box",...t.container&&{display:"flex",flexWrap:"wrap",...t.wrap&&t.wrap!=="wrap"&&{flexWrap:t.wrap},gap:`var(${qS("row")}) var(${qS("column")})`}}),hue=t=>{const e=[];return Object.entries(t).forEach(([r,n])=>{n!==!1&&n!==void 0&&e.push(`grid-${r}-${String(n)}`)}),e},fue=(t,e="xs")=>{function r(n){return n===void 0?!1:typeof n=="string"&&!Number.isNaN(Number(n))||typeof n=="number"&&n>0}if(r(t))return[`spacing-${e}-${String(t)}`];if(typeof t=="object"&&!Array.isArray(t)){const n=[];return Object.entries(t).forEach(([i,a])=>{r(a)&&n.push(`spacing-${i}-${String(a)}`)}),n}return[]},due=t=>t===void 0?[]:typeof t=="object"?Object.entries(t).map(([e,r])=>`direction-${e}-${r}`):[`direction-xs-${String(t)}`];function pue(t,e){t.item!==void 0&&delete t.item,t.zeroMinWidth!==void 0&&delete t.zeroMinWidth,e.keys.forEach(r=>{t[r]!==void 0&&delete t[r]})}const gue=FT(),mue=_y("div",{name:"MuiGrid",slot:"Root"});function yue(t){return Tle({props:t,name:"MuiGrid",defaultTheme:gue})}function vue(t={}){const{createStyledComponent:e=mue,useThemeProps:r=yue,useTheme:n=Px,componentName:i="MuiGrid"}=t,a=(h,d)=>{const{container:m,direction:b,spacing:x,wrap:E,size:T}=h,A={root:["root",m&&"container",E!=="wrap"&&`wrap-xs-${String(E)}`,...due(b),...hue(T),...m?fue(x,d.breakpoints.keys[0]):[]]};return mi(A,M=>gi(i,M),{})};function s(h,d,m=()=>!0){const b={};return h===null||(Array.isArray(h)?h.forEach((x,E)=>{x!==null&&m(x)&&d.keys[E]&&(b[d.keys[E]]=x)}):typeof h=="object"?Object.keys(h).forEach(x=>{const E=h[x];E!=null&&m(E)&&(b[x]=E)}):b[d.keys[0]]=h),b}const o=e(oue,lue,sue,iue,uue,cue,aue),c=te.forwardRef(function(d,m){const b=n(),x=r(d),E=FD(x);pue(E,b.breakpoints);const{className:T,children:A,columns:M=12,container:F=!1,component:N="div",direction:O="row",wrap:U="wrap",size:j={},offset:H={},spacing:G=0,rowSpacing:X=G,columnSpacing:ae=G,unstable_level:Q=0,...W}=E,oe=s(j,b.breakpoints,De=>De!==!1),se=s(H,b.breakpoints),he=d.columns??(Q?void 0:M),_e=d.spacing??(Q?void 0:G),Ce=d.rowSpacing??d.spacing??(Q?void 0:X),me=d.columnSpacing??d.spacing??(Q?void 0:ae),xe={...E,level:Q,columns:he,container:F,direction:O,wrap:U,spacing:_e,rowSpacing:Ce,columnSpacing:me,size:oe,offset:se},Ae=a(xe,b);return J.jsx(o,{ref:m,as:N,ownerState:xe,className:An(Ae.root,T),...W,children:te.Children.map(A,De=>te.isValidElement(De)&&ab(De,["Grid"])&&F&&De.props.container?te.cloneElement(De,{unstable_level:De.props?.unstable_level??Q+1}):De)})});return c.muiName="Grid",c}const Nb={black:"#000",white:"#fff"},_ue={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},sv={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},lv={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},J_={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},uv={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},cv={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},hv={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function TX(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Nb.white,default:Nb.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const CX=TX();function AX(){return{text:{primary:Nb.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Nb.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const Sk=AX();function yB(t,e,r,n){const i=n.light||n,a=n.dark||n*1.5;t[e]||(t.hasOwnProperty(r)?t[e]=t[r]:e==="light"?t.light=UT(t.main,i):e==="dark"&&(t.dark=jT(t.main,a)))}function vB(t,e,r,n,i){const a=i.light||i,s=i.dark||i*1.5;e[r]||(e.hasOwnProperty(n)?e[r]=e[n]:r==="light"?e.light=`color-mix(in ${t}, ${e.main}, #fff ${(a*100).toFixed(0)}%)`:r==="dark"&&(e.dark=`color-mix(in ${t}, ${e.main}, #000 ${(s*100).toFixed(0)}%)`))}function bue(t="light"){return t==="dark"?{main:uv[200],light:uv[50],dark:uv[400]}:{main:uv[700],light:uv[400],dark:uv[800]}}function xue(t="light"){return t==="dark"?{main:sv[200],light:sv[50],dark:sv[400]}:{main:sv[500],light:sv[300],dark:sv[700]}}function wue(t="light"){return t==="dark"?{main:lv[500],light:lv[300],dark:lv[700]}:{main:lv[700],light:lv[400],dark:lv[800]}}function Sue(t="light"){return t==="dark"?{main:cv[400],light:cv[300],dark:cv[700]}:{main:cv[700],light:cv[500],dark:cv[900]}}function Eue(t="light"){return t==="dark"?{main:hv[400],light:hv[300],dark:hv[700]}:{main:hv[800],light:hv[500],dark:hv[900]}}function Tue(t="light"){return t==="dark"?{main:J_[400],light:J_[300],dark:J_[700]}:{main:"#ed6c02",light:J_[500],dark:J_[900]}}function Cue(t){return`oklch(from ${t} var(--__l) 0 h / var(--__a))`}function $D(t){const{mode:e="light",contrastThreshold:r=3,tonalOffset:n=.2,colorSpace:i,...a}=t,s=t.primary||bue(e),o=t.secondary||xue(e),c=t.error||wue(e),h=t.info||Sue(e),d=t.success||Eue(e),m=t.warning||Tue(e);function b(A){return i?Cue(A):Rle(A,Sk.text.primary)>=r?Sk.text.primary:CX.text.primary}const x=({color:A,name:M,mainShade:F=500,lightShade:N=300,darkShade:O=700})=>{if(A={...A},!A.main&&A[F]&&(A.main=A[F]),!A.hasOwnProperty("main"))throw new Error(_p(11,M?` (${M})`:"",F));if(typeof A.main!="string")throw new Error(_p(12,M?` (${M})`:"",JSON.stringify(A.main)));return i?(vB(i,A,"light",N,n),vB(i,A,"dark",O,n)):(yB(A,"light",N,n),yB(A,"dark",O,n)),A.contrastText||(A.contrastText=b(A.main)),A};let E;return e==="light"?E=TX():e==="dark"&&(E=AX()),Qu({common:{...Nb},mode:e,primary:x({color:s,name:"primary"}),secondary:x({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:x({color:c,name:"error"}),warning:x({color:m,name:"warning"}),info:x({color:h,name:"info"}),success:x({color:d,name:"success"}),grey:_ue,contrastThreshold:r,getContrastText:b,augmentColor:x,tonalOffset:n,...E},a)}function Aue(t){const e={};return Object.entries(t).forEach(n=>{const[i,a]=n;typeof a=="object"&&(e[i]=`${a.fontStyle?`${a.fontStyle} `:""}${a.fontVariant?`${a.fontVariant} `:""}${a.fontWeight?`${a.fontWeight} `:""}${a.fontStretch?`${a.fontStretch} `:""}${a.fontSize||""}${a.lineHeight?`/${a.lineHeight} `:""}${a.fontFamily||""}`)}),e}function Iue(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function Pue(t){return Math.round(t*1e5)/1e5}const _B={textTransform:"uppercase"},bB='"Roboto", "Helvetica", "Arial", sans-serif';function IX(t,e){const{fontFamily:r=bB,fontSize:n=14,fontWeightLight:i=300,fontWeightRegular:a=400,fontWeightMedium:s=500,fontWeightBold:o=700,htmlFontSize:c=16,allVariants:h,pxToRem:d,...m}=typeof e=="function"?e(t):e,b=n/14,x=d||(A=>`${A/c*b}rem`),E=(A,M,F,N,O)=>({fontFamily:r,fontWeight:A,fontSize:x(M),lineHeight:F,...r===bB?{letterSpacing:`${Pue(N/M)}em`}:{},...O,...h}),T={h1:E(i,96,1.167,-1.5),h2:E(i,60,1.2,-.5),h3:E(a,48,1.167,0),h4:E(a,34,1.235,.25),h5:E(a,24,1.334,0),h6:E(s,20,1.6,.15),subtitle1:E(a,16,1.75,.15),subtitle2:E(s,14,1.57,.1),body1:E(a,16,1.5,.15),body2:E(a,14,1.43,.15),button:E(s,14,1.75,.4,_B),caption:E(a,12,1.66,.4),overline:E(a,12,2.66,1,_B),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Qu({htmlFontSize:c,pxToRem:x,fontFamily:r,fontSize:n,fontWeightLight:i,fontWeightRegular:a,fontWeightMedium:s,fontWeightBold:o,...T},m,{clone:!1})}const kue=.2,Rue=.14,Mue=.12;function ss(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${kue})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${Rue})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${Mue})`].join(",")}const Due=["none",ss(0,2,1,-1,0,1,1,0,0,1,3,0),ss(0,3,1,-2,0,2,2,0,0,1,5,0),ss(0,3,3,-2,0,3,4,0,0,1,8,0),ss(0,2,4,-1,0,4,5,0,0,1,10,0),ss(0,3,5,-1,0,5,8,0,0,1,14,0),ss(0,3,5,-1,0,6,10,0,0,1,18,0),ss(0,4,5,-2,0,7,10,1,0,2,16,1),ss(0,5,5,-3,0,8,10,1,0,3,14,2),ss(0,5,6,-3,0,9,12,1,0,3,16,2),ss(0,6,6,-3,0,10,14,1,0,4,18,3),ss(0,6,7,-4,0,11,15,1,0,4,20,3),ss(0,7,8,-4,0,12,17,2,0,5,22,4),ss(0,7,8,-4,0,13,19,2,0,5,24,4),ss(0,7,9,-4,0,14,21,2,0,5,26,4),ss(0,8,9,-5,0,15,22,2,0,6,28,5),ss(0,8,10,-5,0,16,24,2,0,6,30,5),ss(0,8,11,-5,0,17,26,2,0,6,32,5),ss(0,9,11,-5,0,18,28,2,0,7,34,6),ss(0,9,12,-6,0,19,29,2,0,7,36,6),ss(0,10,13,-6,0,20,31,3,0,8,38,7),ss(0,10,13,-6,0,21,33,3,0,8,40,7),ss(0,10,14,-6,0,22,35,3,0,8,42,7),ss(0,11,14,-7,0,23,36,3,0,9,44,8),ss(0,11,15,-7,0,24,38,3,0,9,46,8)],Oue={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},PX={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function xB(t){return`${Math.round(t)}ms`}function Nue(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function Lue(t){const e={...Oue,...t.easing},r={...PX,...t.duration};return{getAutoHeightDuration:Nue,create:(i=["all"],a={})=>{const{duration:s=r.standard,easing:o=e.easeInOut,delay:c=0,...h}=a;return(Array.isArray(i)?i:[i]).map(d=>`${d} ${typeof s=="string"?s:xB(s)} ${o} ${typeof c=="string"?c:xB(c)}`).join(",")},...t,easing:e,duration:r}}const Fue={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function Bue(t){return ud(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function kX(t={}){const e={...t};function r(n){const i=Object.entries(n);for(let a=0;a<i.length;a++){const[s,o]=i[a];!Bue(o)||s.startsWith("unstable_")?delete n[s]:ud(o)&&(n[s]={...o},r(n[s]))}}return r(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function wB(t){return typeof t=="number"?`${(t*100).toFixed(0)}%`:`calc((${t}) * 100%)`}const zue=t=>{if(!Number.isNaN(+t))return+t;const e=t.match(/\d*\.?\d+/g);if(!e)return 0;let r=0;for(let n=0;n<e.length;n+=1)r+=+e[n];return r};function jue(t){Object.assign(t,{alpha(e,r){const n=this||t;return n.colorSpace?`oklch(from ${e} l c h / ${typeof r=="string"?`calc(${r})`:r})`:n.vars?`rgba(${e.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof r=="string"?`calc(${r})`:r})`:$S(e,zue(r))},lighten(e,r){const n=this||t;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #fff ${wB(r)})`:UT(e,r)},darken(e,r){const n=this||t;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #000 ${wB(r)})`:jT(e,r)}})}function Ek(t={},...e){const{breakpoints:r,mixins:n={},spacing:i,palette:a={},transitions:s={},typography:o={},shape:c,colorSpace:h,...d}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error(_p(20));const m=$D({...a,colorSpace:h}),b=FT(t);let x=Qu(b,{mixins:Iue(b.breakpoints,n),palette:m,shadows:Due.slice(),typography:IX(m,o),transitions:Lue(s),zIndex:{...Fue}});return x=Qu(x,d),x=e.reduce((E,T)=>Qu(E,T),x),x.unstable_sxConfig={...Ix,...d?.unstable_sxConfig},x.unstable_sx=function(T){return Sg({sx:T,theme:this})},x.toRuntimeSource=kX,jue(x),x}function Tk(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const Uue=[...Array(25)].map((t,e)=>{if(e===0)return"none";const r=Tk(e);return`linear-gradient(rgba(255 255 255 / ${r}), rgba(255 255 255 / ${r}))`});function RX(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function MX(t){return t==="dark"?Uue:[]}function Vue(t){const{palette:e={mode:"light"},opacity:r,overlays:n,colorSpace:i,...a}=t,s=$D({...e,colorSpace:i});return{palette:s,opacity:{...RX(s.mode),...r},overlays:n||MX(s.mode),...a}}function $ue(t){return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!t[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const que=t=>[...[...Array(25)].map((e,r)=>`--${t?`${t}-`:""}overlays-${r}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],Hue=t=>(e,r)=>{const n=t.rootSelector||":root",i=t.colorSchemeSelector;let a=i;if(i==="class"&&(a=".%s"),i==="data"&&(a="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(a=`[${i}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const s={};return que(t.cssVarPrefix).forEach(o=>{s[o]=r[o],delete r[o]}),a==="media"?{[n]:r,"@media (prefers-color-scheme: dark)":{[n]:s}}:a?{[a.replace("%s",e)]:s,[`${n}, ${a.replace("%s",e)}`]:r}:{[n]:{...r,...s}}}if(a&&a!=="media")return`${n}, ${a.replace("%s",String(e))}`}else if(e){if(a==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[n]:r}};if(a)return a.replace("%s",String(e))}return n};function Wue(t,e){e.forEach(r=>{t[r]||(t[r]={})})}function Ur(t,e,r){!t[e]&&r&&(t[e]=r)}function k1(t){return typeof t!="string"||!t.startsWith("hsl")?t:_X(t)}function Zd(t,e){`${e}Channel`in t||(t[`${e}Channel`]=P1(k1(t[e])))}function Gue(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const Qf=t=>{try{return t()}catch{}},Xue=(t="mui")=>Jle(t);function hA(t,e,r,n,i){if(!r)return;r=r===!0?{}:r;const a=i==="dark"?"dark":"light";if(!n){e[i]=Vue({...r,palette:{mode:a,...r?.palette},colorSpace:t});return}const{palette:s,...o}=Ek({...n,palette:{mode:a,...r?.palette},colorSpace:t});return e[i]={...r,palette:s,opacity:{...RX(a),...r?.opacity},overlays:r?.overlays||MX(a)},o}function Yue(t={},...e){const{colorSchemes:r={light:!0},defaultColorScheme:n,disableCssColorScheme:i=!1,cssVarPrefix:a="mui",nativeColor:s=!1,shouldSkipGeneratingVar:o=$ue,colorSchemeSelector:c=r.light&&r.dark?"media":void 0,rootSelector:h=":root",...d}=t,m=Object.keys(r)[0],b=n||(r.light&&m!=="light"?"light":m),x=Xue(a),{[b]:E,light:T,dark:A,...M}=r,F={...M};let N=E;if((b==="dark"&&!("dark"in r)||b==="light"&&!("light"in r))&&(N=!0),!N)throw new Error(_p(21,b));let O;s&&(O="oklch");const U=hA(O,F,N,d,b);T&&!F.light&&hA(O,F,T,void 0,"light"),A&&!F.dark&&hA(O,F,A,void 0,"dark");let j={defaultColorScheme:b,...U,cssVarPrefix:a,colorSchemeSelector:c,rootSelector:h,getCssVar:x,colorSchemes:F,font:{...Aue(U.typography),...U.font},spacing:Gue(d.spacing)};Object.keys(j.colorSchemes).forEach(Q=>{const W=j.colorSchemes[Q].palette,oe=he=>{const _e=he.split("-"),Ce=_e[1],me=_e[2];return x(he,W[Ce][me])};W.mode==="light"&&(Ur(W.common,"background","#fff"),Ur(W.common,"onBackground","#000")),W.mode==="dark"&&(Ur(W.common,"background","#000"),Ur(W.common,"onBackground","#fff"));function se(he,_e,Ce){if(O){let me;return he===um&&(me=`transparent ${((1-Ce)*100).toFixed(0)}%`),he===co&&(me=`#000 ${(Ce*100).toFixed(0)}%`),he===ho&&(me=`#fff ${(Ce*100).toFixed(0)}%`),`color-mix(in ${O}, ${_e}, ${me})`}return he(_e,Ce)}if(Wue(W,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),W.mode==="light"){Ur(W.Alert,"errorColor",se(co,W.error.light,.6)),Ur(W.Alert,"infoColor",se(co,W.info.light,.6)),Ur(W.Alert,"successColor",se(co,W.success.light,.6)),Ur(W.Alert,"warningColor",se(co,W.warning.light,.6)),Ur(W.Alert,"errorFilledBg",oe("palette-error-main")),Ur(W.Alert,"infoFilledBg",oe("palette-info-main")),Ur(W.Alert,"successFilledBg",oe("palette-success-main")),Ur(W.Alert,"warningFilledBg",oe("palette-warning-main")),Ur(W.Alert,"errorFilledColor",Qf(()=>W.getContrastText(W.error.main))),Ur(W.Alert,"infoFilledColor",Qf(()=>W.getContrastText(W.info.main))),Ur(W.Alert,"successFilledColor",Qf(()=>W.getContrastText(W.success.main))),Ur(W.Alert,"warningFilledColor",Qf(()=>W.getContrastText(W.warning.main))),Ur(W.Alert,"errorStandardBg",se(ho,W.error.light,.9)),Ur(W.Alert,"infoStandardBg",se(ho,W.info.light,.9)),Ur(W.Alert,"successStandardBg",se(ho,W.success.light,.9)),Ur(W.Alert,"warningStandardBg",se(ho,W.warning.light,.9)),Ur(W.Alert,"errorIconColor",oe("palette-error-main")),Ur(W.Alert,"infoIconColor",oe("palette-info-main")),Ur(W.Alert,"successIconColor",oe("palette-success-main")),Ur(W.Alert,"warningIconColor",oe("palette-warning-main")),Ur(W.AppBar,"defaultBg",oe("palette-grey-100")),Ur(W.Avatar,"defaultBg",oe("palette-grey-400")),Ur(W.Button,"inheritContainedBg",oe("palette-grey-300")),Ur(W.Button,"inheritContainedHoverBg",oe("palette-grey-A100")),Ur(W.Chip,"defaultBorder",oe("palette-grey-400")),Ur(W.Chip,"defaultAvatarColor",oe("palette-grey-700")),Ur(W.Chip,"defaultIconColor",oe("palette-grey-700")),Ur(W.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Ur(W.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Ur(W.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Ur(W.LinearProgress,"primaryBg",se(ho,W.primary.main,.62)),Ur(W.LinearProgress,"secondaryBg",se(ho,W.secondary.main,.62)),Ur(W.LinearProgress,"errorBg",se(ho,W.error.main,.62)),Ur(W.LinearProgress,"infoBg",se(ho,W.info.main,.62)),Ur(W.LinearProgress,"successBg",se(ho,W.success.main,.62)),Ur(W.LinearProgress,"warningBg",se(ho,W.warning.main,.62)),Ur(W.Skeleton,"bg",O?se(um,W.text.primary,.11):`rgba(${oe("palette-text-primaryChannel")} / 0.11)`),Ur(W.Slider,"primaryTrack",se(ho,W.primary.main,.62)),Ur(W.Slider,"secondaryTrack",se(ho,W.secondary.main,.62)),Ur(W.Slider,"errorTrack",se(ho,W.error.main,.62)),Ur(W.Slider,"infoTrack",se(ho,W.info.main,.62)),Ur(W.Slider,"successTrack",se(ho,W.success.main,.62)),Ur(W.Slider,"warningTrack",se(ho,W.warning.main,.62));const he=O?se(co,W.background.default,.6825):B2(W.background.default,.8);Ur(W.SnackbarContent,"bg",he),Ur(W.SnackbarContent,"color",Qf(()=>O?Sk.text.primary:W.getContrastText(he))),Ur(W.SpeedDialAction,"fabHoverBg",B2(W.background.paper,.15)),Ur(W.StepConnector,"border",oe("palette-grey-400")),Ur(W.StepContent,"border",oe("palette-grey-400")),Ur(W.Switch,"defaultColor",oe("palette-common-white")),Ur(W.Switch,"defaultDisabledColor",oe("palette-grey-100")),Ur(W.Switch,"primaryDisabledColor",se(ho,W.primary.main,.62)),Ur(W.Switch,"secondaryDisabledColor",se(ho,W.secondary.main,.62)),Ur(W.Switch,"errorDisabledColor",se(ho,W.error.main,.62)),Ur(W.Switch,"infoDisabledColor",se(ho,W.info.main,.62)),Ur(W.Switch,"successDisabledColor",se(ho,W.success.main,.62)),Ur(W.Switch,"warningDisabledColor",se(ho,W.warning.main,.62)),Ur(W.TableCell,"border",se(ho,se(um,W.divider,1),.88)),Ur(W.Tooltip,"bg",se(um,W.grey[700],.92))}if(W.mode==="dark"){Ur(W.Alert,"errorColor",se(ho,W.error.light,.6)),Ur(W.Alert,"infoColor",se(ho,W.info.light,.6)),Ur(W.Alert,"successColor",se(ho,W.success.light,.6)),Ur(W.Alert,"warningColor",se(ho,W.warning.light,.6)),Ur(W.Alert,"errorFilledBg",oe("palette-error-dark")),Ur(W.Alert,"infoFilledBg",oe("palette-info-dark")),Ur(W.Alert,"successFilledBg",oe("palette-success-dark")),Ur(W.Alert,"warningFilledBg",oe("palette-warning-dark")),Ur(W.Alert,"errorFilledColor",Qf(()=>W.getContrastText(W.error.dark))),Ur(W.Alert,"infoFilledColor",Qf(()=>W.getContrastText(W.info.dark))),Ur(W.Alert,"successFilledColor",Qf(()=>W.getContrastText(W.success.dark))),Ur(W.Alert,"warningFilledColor",Qf(()=>W.getContrastText(W.warning.dark))),Ur(W.Alert,"errorStandardBg",se(co,W.error.light,.9)),Ur(W.Alert,"infoStandardBg",se(co,W.info.light,.9)),Ur(W.Alert,"successStandardBg",se(co,W.success.light,.9)),Ur(W.Alert,"warningStandardBg",se(co,W.warning.light,.9)),Ur(W.Alert,"errorIconColor",oe("palette-error-main")),Ur(W.Alert,"infoIconColor",oe("palette-info-main")),Ur(W.Alert,"successIconColor",oe("palette-success-main")),Ur(W.Alert,"warningIconColor",oe("palette-warning-main")),Ur(W.AppBar,"defaultBg",oe("palette-grey-900")),Ur(W.AppBar,"darkBg",oe("palette-background-paper")),Ur(W.AppBar,"darkColor",oe("palette-text-primary")),Ur(W.Avatar,"defaultBg",oe("palette-grey-600")),Ur(W.Button,"inheritContainedBg",oe("palette-grey-800")),Ur(W.Button,"inheritContainedHoverBg",oe("palette-grey-700")),Ur(W.Chip,"defaultBorder",oe("palette-grey-700")),Ur(W.Chip,"defaultAvatarColor",oe("palette-grey-300")),Ur(W.Chip,"defaultIconColor",oe("palette-grey-300")),Ur(W.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Ur(W.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Ur(W.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Ur(W.LinearProgress,"primaryBg",se(co,W.primary.main,.5)),Ur(W.LinearProgress,"secondaryBg",se(co,W.secondary.main,.5)),Ur(W.LinearProgress,"errorBg",se(co,W.error.main,.5)),Ur(W.LinearProgress,"infoBg",se(co,W.info.main,.5)),Ur(W.LinearProgress,"successBg",se(co,W.success.main,.5)),Ur(W.LinearProgress,"warningBg",se(co,W.warning.main,.5)),Ur(W.Skeleton,"bg",O?se(um,W.text.primary,.13):`rgba(${oe("palette-text-primaryChannel")} / 0.13)`),Ur(W.Slider,"primaryTrack",se(co,W.primary.main,.5)),Ur(W.Slider,"secondaryTrack",se(co,W.secondary.main,.5)),Ur(W.Slider,"errorTrack",se(co,W.error.main,.5)),Ur(W.Slider,"infoTrack",se(co,W.info.main,.5)),Ur(W.Slider,"successTrack",se(co,W.success.main,.5)),Ur(W.Slider,"warningTrack",se(co,W.warning.main,.5));const he=O?se(ho,W.background.default,.985):B2(W.background.default,.98);Ur(W.SnackbarContent,"bg",he),Ur(W.SnackbarContent,"color",Qf(()=>O?CX.text.primary:W.getContrastText(he))),Ur(W.SpeedDialAction,"fabHoverBg",B2(W.background.paper,.15)),Ur(W.StepConnector,"border",oe("palette-grey-600")),Ur(W.StepContent,"border",oe("palette-grey-600")),Ur(W.Switch,"defaultColor",oe("palette-grey-300")),Ur(W.Switch,"defaultDisabledColor",oe("palette-grey-600")),Ur(W.Switch,"primaryDisabledColor",se(co,W.primary.main,.55)),Ur(W.Switch,"secondaryDisabledColor",se(co,W.secondary.main,.55)),Ur(W.Switch,"errorDisabledColor",se(co,W.error.main,.55)),Ur(W.Switch,"infoDisabledColor",se(co,W.info.main,.55)),Ur(W.Switch,"successDisabledColor",se(co,W.success.main,.55)),Ur(W.Switch,"warningDisabledColor",se(co,W.warning.main,.55)),Ur(W.TableCell,"border",se(co,se(um,W.divider,1),.68)),Ur(W.Tooltip,"bg",se(um,W.grey[700],.92))}Zd(W.background,"default"),Zd(W.background,"paper"),Zd(W.common,"background"),Zd(W.common,"onBackground"),Zd(W,"divider"),Object.keys(W).forEach(he=>{const _e=W[he];he!=="tonalOffset"&&_e&&typeof _e=="object"&&(_e.main&&Ur(W[he],"mainChannel",P1(k1(_e.main))),_e.light&&Ur(W[he],"lightChannel",P1(k1(_e.light))),_e.dark&&Ur(W[he],"darkChannel",P1(k1(_e.dark))),_e.contrastText&&Ur(W[he],"contrastTextChannel",P1(k1(_e.contrastText))),he==="text"&&(Zd(W[he],"primary"),Zd(W[he],"secondary")),he==="action"&&(_e.active&&Zd(W[he],"active"),_e.selected&&Zd(W[he],"selected")))})}),j=e.reduce((Q,W)=>Qu(Q,W),j);const H={prefix:a,disableCssColorScheme:i,shouldSkipGeneratingVar:o,getSelector:Hue(j),enableContrastVars:s},{vars:G,generateThemeVars:X,generateStyleSheets:ae}=tue(j,H);return j.vars=G,Object.entries(j.colorSchemes[j.defaultColorScheme]).forEach(([Q,W])=>{j[Q]=W}),j.generateThemeVars=X,j.generateStyleSheets=ae,j.generateSpacing=function(){return uX(d.spacing,ND(this))},j.getColorSchemeSelector=rue(c),j.spacing=j.generateSpacing(),j.shouldSkipGeneratingVar=o,j.unstable_sxConfig={...Ix,...d?.unstable_sxConfig},j.unstable_sx=function(W){return Sg({sx:W,theme:this})},j.toRuntimeSource=kX,j}function SB(t,e,r){t.colorSchemes&&r&&(t.colorSchemes[e]={...r!==!0&&r,palette:$D({...r===!0?{}:r.palette,mode:e})})}function c_(t={},...e){const{palette:r,cssVariables:n=!1,colorSchemes:i=r?void 0:{light:!0},defaultColorScheme:a=r?.mode,...s}=t,o=a||"light",c=i?.[o],h={...i,...r?{[o]:{...typeof c!="boolean"&&c,palette:r}}:void 0};if(n===!1){if(!("colorSchemes"in t))return Ek(t,...e);let d=r;"palette"in t||h[o]&&(h[o]!==!0?d=h[o].palette:o==="dark"&&(d={mode:"dark"}));const m=Ek({...t,palette:d},...e);return m.defaultColorScheme=o,m.colorSchemes=h,m.palette.mode==="light"&&(m.colorSchemes.light={...h.light!==!0&&h.light,palette:m.palette},SB(m,"dark",h.dark)),m.palette.mode==="dark"&&(m.colorSchemes.dark={...h.dark!==!0&&h.dark,palette:m.palette},SB(m,"light",h.light)),m}return!r&&!("light"in h)&&o==="light"&&(h.light=!0),Yue({...s,colorSchemes:h,defaultColorScheme:o,...typeof n!="boolean"&&n},...e)}const qD=c_();function Lc(){const t=Px(qD);return t[Sf]||t}function $T(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const Al=t=>$T(t)&&t!=="classes",Dr=gX({themeId:Sf,defaultTheme:qD,rootShouldForwardProp:Al});function Zue({theme:t,...e}){const r=Sf in t?t[Sf]:void 0;return J.jsx(SX,{...e,themeId:r?Sf:void 0,theme:r||t})}const z2={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:Kue}=Kle({themeId:Sf,theme:()=>c_({cssVariables:!0}),colorSchemeStorageKey:z2.colorSchemeStorageKey,modeStorageKey:z2.modeStorageKey,defaultColorScheme:{light:z2.defaultLightColorScheme,dark:z2.defaultDarkColorScheme},resolveTheme:t=>{const e={...t,typography:IX(t.palette,t.typography)};return e.unstable_sx=function(n){return Sg({sx:n,theme:this})},e}}),Jue=Kue;function DX({theme:t,...e}){const r=te.useMemo(()=>{if(typeof t=="function")return t;const n=Sf in t?t[Sf]:t;return"colorSchemes"in n?null:"vars"in n?t:{...t,vars:null}},[t]);return r?J.jsx(Zue,{theme:r,...e}):J.jsx(Jue,{theme:t,...e})}const Que=c_({palette:{mode:"light"}}),ece=c_({palette:{mode:"dark"}}),tce=t=>({...t==="light"?Que:ece,palette:{mode:t,...t==="dark"?{primary:{main:"#009EE0"},secondary:{main:"#747577"},background:{paper:"#313131"},text:{primary:"#FFF",contrast:"#000"},topToolbar:{barColor:"#000"},navigation:{buttonColor:"#fff",navColor:"#313131",navHover:"#747577"},GPS:{GPSActiveColor:"#fff",GPSInactiveColor:"#fff",GPSActiveBackgroundColor:"#747577"},compass:{compColor:"#313131",compHover:"#747577",compStroke:"#d3dce1",compNorth:"#cf003f",compSouth:"#d3dcf0"}}:{primary:{main:"#009EE0"},secondary:{main:"#747577"},text:{primary:"#000",contrast:"#fff"},topToolbar:{barColor:"#fff"},navigation:{buttonColor:"#747577",navColor:"#fff",navHover:"#f5f5f5"},GPS:{GPSActiveColor:"#009EE0",GPSInactiveColor:"#747577",GPSActiveBackgroundColor:"#fff"},compass:{compColor:"#fff",compHover:"#f5f5f5",compStroke:"#009ee0",compNorth:"#cf003f",compSouth:"#d3dcf0"}}}}),OX=t=>{const e=tce(t&&["light","dark"].includes(t)?t:"light");return c_(e,{components:{MuiTypography:{styleOverrides:{root:{}}},MuiAppBar:{styleOverrides:{root:{backgroundColor:e.palette.topToolbar.barColor}}},MuiButton:{variants:[{props:{variant:"navtools"},style:{minWidth:"20px",minHeight:"20px",fontWeight:600,[e.breakpoints.down("md")]:{width:"50px",height:"50px",fontSize:"1.4em"},[e.breakpoints.up("md")]:{width:"30px",height:"30px",fontSize:"1.2em"},color:e.palette.text.primary,backgroundColor:e.palette.navigation.navColor,borderRadius:"23%",margin:"0.15px",marginTop:"4px",":hover":{backgroundColor:e.palette.navigation.navHover}}}]},MuiListItemText:{styleOverrides:{primary:({ownerState:r})=>r?.variant==="layerlist"?{fontSize:"0.9rem"}:{},secondary:({ownerState:r})=>r?.variant==="layerlist"?{fontSize:"0.7rem"}:{}}}}})};try{MapcomponentsTheme.displayName="MapcomponentsTheme",MapcomponentsTheme.__docgenInfo={description:"",displayName:"MapcomponentsTheme",props:{}}}catch{}const ec={source_openmaptiles_url:"https://wms.wheregroup.com/tileserver/tile/world-0-14.json",sprite:"https://wms.wheregroup.com/tileserver/sprites/osm-bright",glyphs:"https://wms.wheregroup.com/tileserver/fonts/{fontstack}/{range}.pbf",sourceOptions_tiles:["https://wms.wheregroup.com/tileserver/tile/world-0-14/{z}/{x}/{y}.pbf"]},bu=[];for(let t=0;t<256;++t)bu.push((t+256).toString(16).slice(1));function rce(t,e=0){return(bu[t[e+0]]+bu[t[e+1]]+bu[t[e+2]]+bu[t[e+3]]+"-"+bu[t[e+4]]+bu[t[e+5]]+"-"+bu[t[e+6]]+bu[t[e+7]]+"-"+bu[t[e+8]]+bu[t[e+9]]+"-"+bu[t[e+10]]+bu[t[e+11]]+bu[t[e+12]]+bu[t[e+13]]+bu[t[e+14]]+bu[t[e+15]]).toLowerCase()}let fA;const nce=new Uint8Array(16);function ice(){if(!fA){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");fA=crypto.getRandomValues.bind(crypto)}return fA(nce)}const ace=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),EB={randomUUID:ace};function vc(t,e,r){if(EB.randomUUID&&!t)return EB.randomUUID();t=t||{};const n=t.random??t.rng?.()??ice();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,rce(n)}const HD=gt.createContext({});function Ck(t){const[e,r]=gt.useState([]),[n,i]=gt.useState([]),[a,s]=gt.useState([]),[o,c]=gt.useState(ec.sourceOptions_tiles[0]),h=te.useMemo(()=>({layerId:"openmaptiles",sourceOptions:{type:"vector",tiles:[o]}}),[o]),d=T=>{if(!T)return;const A=[],M=[];T.layers.forEach((F,N)=>{F.type==="symbol"?M.push(F):(N===0&&(F.id=T.name||"background"),A.push(F))}),i(A),s(M)};te.useEffect(()=>{if(e.filter(T=>!T?.id).length){const T=[...e];T.forEach(A=>{A?.id||(A.id=vc())}),r(T)}},[e]);const m=te.useCallback((T,A)=>{const M=e?.filter?.(F=>F.id===T);if(M.length>0){const F=[...e],N=M[0],O=e.indexOf(N),U=A(O);U>=0&&U<=e.length-1&&(F.splice(O,1),F.splice(U,0,N),r(F))}},[e]),b=te.useCallback(T=>{m(T,A=>A+1)},[m]),x=te.useCallback(T=>{m(T,A=>A-1)},[m]),E={layers:e,setLayers:r,backgroundLayers:n,setBackgroundLayers:i,symbolLayers:a,setSymbolLayers:s,updateStyle:d,vtLayerConfig:h,tileUrl:o,setTileUrl:c,moveUp:x,moveDown:b,moveLayer:m};return J.jsx(HD.Provider,{value:E,children:t.children})}try{Ck.displayName="LayerContextProvider",Ck.__docgenInfo={description:"",displayName:"LayerContextProvider",props:{}}}catch{}const Ng=gt.createContext({}),Ak=({children:t})=>{const[e,r]=te.useState(void 0),[n,i]=te.useState([]),a=te.useRef([]),s=te.useRef({}),o=d=>{if(d){typeof s.current[d]<"u"&&delete s.current[d];const m=a.current.indexOf(d);m>-1&&a.current.splice(m,1),i([...a.current]),a.current.length===0&&e&&r(void 0)}else o("anonymous_map")},h={map:e,setMap:d=>{if(r(d),n.length===0){const m="anonymous_map";i([...n,m]),s.current[m]=d}},maps:s.current,mapIds:n,registerMap:(d,m)=>{d&&m&&(s.current[d]=m,a.current.push(d),i([...a.current]),(!e||e?.cancelled===!0)&&r(m))},removeMap:o,mapExists:d=>d&&Object.keys(s.current).indexOf(d)===-1?!1:!(!d&&!e),getMap:d=>d&&n.indexOf(d)!==-1?s.current[d]:!d&&e?e:null};return J.jsx(Ng.Provider,{value:h,children:J.jsx(Ck,{children:J.jsx(DX,{theme:OX("light"),children:t})})})};try{Ak.displayName="MapComponentsProvider",Ak.__docgenInfo={description:`MapComponentsProvider must be imported and wrapped around component where at least one of its child nodes requires access to a MapLibre-gl or openlayers instance that is registered in this mapContext.
MapComponentsProvider must be used one level higher than the first use of MapContext.

MapComponentsProvider requires at least one use of the MapLibreMap component somewhere down the component tree that will create the MapLibre-gl object and set the reference at MapContext.map. For MapLibre maps it is a good idea to provide a mapId attribute to the MapLibreMap Component even if you are only using a single map instance at start. It will make a later transition to using multiple instances within the same project much easier.`,displayName:"MapComponentsProvider",props:{}}}catch{}const NX={mapId:void 0,options:{center:{lng:8.607,lat:53.1409349},zoom:11,container:"",style:{version:8,name:"blank",center:[0,0],zoom:0,sources:{},sprite:"https://wms.wheregroup.com/tileserver/sprites/osm-bright",glyphs:"https://wms.wheregroup.com/tileserver/fonts/{fontstack}/{range}.pbf",layers:[{id:"_background",type:"background",paint:{"background-color":"rgba(0,0,0,0)"}}]}}},LX=t=>{const e=te.useRef(null),r=te.useRef(null),n=te.useContext(Ng),i=te.useRef(t.mapId),a=te.useRef(!1),s=te.useRef(t.options?.style);return te.useEffect(()=>{const o=i.current;return()=>{a.current=!1,n.removeMap(o),e.current&&(e.current.map?.remove?.(),e.current.cancelled=!0,e.current=null)}},[]),te.useEffect(()=>{a.current||r.current&&(a.current=!0,t?.options?.style&&(s.current=JSON.stringify(t.options.style)),e.current=new doe({mapOptions:{style:"",...t.options,...t?.options?.style?{}:{style:NX?.options?.style},container:r.current},onReady:(o,c)=>{o.once("load",()=>{c?.cancelled?o.remove():(window._map=o,t.mapId?n.registerMap(t.mapId,c):n.setMap(c))})}}))},[t.options,t.mapId]),te.useEffect(()=>{if(e.current?.map&&t?.options?.style){const o=JSON.stringify(t.options.style);s.current!==o&&(s.current=o,e.current.map.setStyle(t.options.style))}},[t?.options?.style]),J.jsx("div",{ref:r,className:"mapContainer",style:t.style})};LX.defaultProps=NX;function qT(t){const e=te.useContext(Ng),r=te.useRef(!1),n=te.useRef(null),[i,a]=te.useState(),s=te.useRef(void 0),[o,c]=te.useState([]),h=te.useRef(""),d=te.useRef(vc()),m=te.useCallback(x=>!t?.filter?.includeBaseLayers&&x?.baseLayer?!1:typeof t.filter?.matchLayerIds<"u"?t.filter.matchLayerIds instanceof RegExp?t.filter.matchLayerIds.test(x.id):x.id.includes(t.filter.matchLayerIds):!0,[t.filter]),b=te.useCallback(()=>{if(!n.current)return;const x=n.current.wrapper.layerState.filter(m),E=JSON.stringify(x);h.current!==E&&(h.current=E,c(x))},[m]);return te.useEffect(()=>{const x=d.current;return()=>{n.current&&(n.current.cleanup(x),n.current=null),r.current=!1}},[]),te.useEffect(()=>{if(!(!e.mapExists(t.mapId)||r.current)){if(r.current=!0,n.current=e.getMap(t.mapId),!n.current){r.current=!1;return}t?.watch?.viewport&&(a(n.current.wrapper.viewportState),n.current.wrapper.on("viewportchange",()=>{s.current!==n.current?.wrapper.viewportStateString&&a(n.current?.wrapper.viewportState)},d.current)),t?.watch?.layers&&(b(),n.current.wrapper.on("layerchange",b,{includeBaseLayers:t?.filter?.includeBaseLayers,matchLayerIds:t?.filter?.matchLayerIds},d.current))}},[e.mapIds,e,t.mapId,b,t]),{layers:o,viewport:i}}qT.defaultProps={mapId:void 0,watch:{layers:!0,sources:!1,viewport:!1},filter:{includeBaseLayers:!1}};function va(t){const e=te.useContext(Ng),[r,n]=te.useState({map:void 0,ready:!1}),i=qT({mapId:t?.mapId,watch:{viewport:!1,layers:!!t?.waitForLayer,sources:!1},filter:{includeBaseLayers:!0}}),a=te.useRef(null),s=te.useRef(vc()),o=()=>{a.current&&a.current.cleanup(s.current)};return te.useEffect(()=>()=>{o(),a.current=null},[]),te.useEffect(()=>{if(a.current&&a.current.cancelled===!0&&(a.current=null,n({map:void 0,ready:!1})),!(a.current||!e.mapExists(t?.mapId))){if(t?.waitForLayer){let c=!1;if(i?.layers?.forEach(h=>{h.id===t?.waitForLayer&&(c=!0)}),!c)return}a.current=e.getMap(t?.mapId),n({map:a.current,ready:!0})}},[e.mapIds,i.layers,e,t]),{map:r.map,mapIsReady:r.ready,componentId:s.current,layers:i.layers,cleanup:o}}function Ik(...t){return t.reduce((e,r)=>r==null?e:function(...i){e.apply(this,i),r.apply(this,i)},()=>{})}function oce(t){return J.jsx(cX,{...t,defaultTheme:qD,themeId:Sf})}function sce(t){return function(r){return J.jsx(oce,{styles:typeof t=="function"?n=>t({theme:n,...r}):t})}}function lce(){return FD}const ci=$le;function bi(t){return zle(t)}function uce(t){return gi("MuiSvgIcon",t)}pi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const cce=t=>{const{color:e,fontSize:r,classes:n}=t,i={root:["root",e!=="inherit"&&`color${cn(e)}`,`fontSize${cn(r)}`]};return mi(i,uce,n)},hce=Dr("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color!=="inherit"&&e[`color${cn(r.color)}`],e[`fontSize${cn(r.fontSize)}`]]}})(ci(({theme:t})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:t.transitions?.create?.("fill",{duration:(t.vars??t).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:t.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:t.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,e])=>e&&e.main).map(([e])=>({props:{color:e},style:{color:(t.vars??t).palette?.[e]?.main}})),{props:{color:"action"},style:{color:(t.vars??t).palette?.action?.active}},{props:{color:"disabled"},style:{color:(t.vars??t).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),Pk=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSvgIcon"}),{children:i,className:a,color:s="inherit",component:o="svg",fontSize:c="medium",htmlColor:h,inheritViewBox:d=!1,titleAccess:m,viewBox:b="0 0 24 24",...x}=n,E=te.isValidElement(i)&&i.type==="svg",T={...n,color:s,component:o,fontSize:c,instanceFontSize:e.fontSize,inheritViewBox:d,viewBox:b,hasSvgAsChild:E},A={};d||(A.viewBox=b);const M=cce(T);return J.jsxs(hce,{as:o,className:An(M.root,a),focusable:"false",color:h,"aria-hidden":m?void 0:!0,role:m?"img":void 0,ref:r,...A,...x,...E&&i.props,ownerState:T,children:[E?i.props.children:i,m?J.jsx("title",{children:m}):null]})});Pk.muiName="SvgIcon";function Ji(t,e){function r(n,i){return J.jsx(Pk,{"data-testid":void 0,ref:i,...n,children:t})}return r.muiName=Pk.muiName,te.memo(te.forwardRef(r))}function WD(t,e=166){let r;function n(...i){const a=()=>{t.apply(this,i)};clearTimeout(r),r=setTimeout(a,e)}return n.clear=()=>{clearTimeout(r)},n}function cs(t){return t&&t.ownerDocument||document}function _c(t){return cs(t).defaultView||window}function TB(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function Ym(t){const{controlled:e,default:r,name:n,state:i="value"}=t,{current:a}=te.useRef(e!==void 0),[s,o]=te.useState(r),c=a?e:s,h=te.useCallback(d=>{a||o(d)},[]);return[c,h]}function ou(t){const e=te.useRef(t);return Tu(()=>{e.current=t}),te.useRef((...r)=>(0,e.current)(...r)).current}function Uo(...t){const e=te.useRef(void 0),r=te.useCallback(n=>{const i=t.map(a=>{if(a==null)return null;if(typeof a=="function"){const s=a,o=s(n);return typeof o=="function"?o:()=>{s(null)}}return a.current=n,()=>{a.current=null}});return()=>{i.forEach(a=>a?.())}},t);return te.useMemo(()=>t.every(n=>n==null)?null:n=>{e.current&&(e.current(),e.current=void 0),n!=null&&(e.current=r(n))},t)}function fce(t,e){const r=t.charCodeAt(2);return t[0]==="o"&&t[1]==="n"&&r>=65&&r<=90&&typeof e=="function"}function Lb(t,e){if(!t)return e;function r(s,o){const c={};return Object.keys(o).forEach(h=>{fce(h,o[h])&&typeof s[h]=="function"&&(c[h]=(...d)=>{s[h](...d),o[h](...d)})}),c}if(typeof t=="function"||typeof e=="function")return s=>{const o=typeof e=="function"?e(s):e,c=typeof t=="function"?t({...s,...o}):t,h=An(s?.className,o?.className,c?.className),d=r(c,o);return{...o,...c,...d,...!!h&&{className:h},...o?.style&&c?.style&&{style:{...o.style,...c.style}},...o?.sx&&c?.sx&&{sx:[...Array.isArray(o.sx)?o.sx:[o.sx],...Array.isArray(c.sx)?c.sx:[c.sx]]}}};const n=e,i=r(t,n),a=An(n?.className,t?.className);return{...e,...t,...i,...!!a&&{className:a},...n?.style&&t?.style&&{style:{...n.style,...t.style}},...n?.sx&&t?.sx&&{sx:[...Array.isArray(n.sx)?n.sx:[n.sx],...Array.isArray(t.sx)?t.sx:[t.sx]]}}}function FX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function kk(t,e){return kk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},kk(t,e)}function BX(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,kk(t,e)}const CB={disabled:!1},HS=gt.createContext(null);var dce=function(e){return e.scrollTop},R1="unmounted",ym="exited",vm="entering",Ov="entered",Rk="exiting",Kh=(function(t){BX(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=i,o=s&&!s.isMounting?n.enter:n.appear,c;return a.appearStatus=null,n.in?o?(c=ym,a.appearStatus=vm):c=Ov:n.unmountOnExit||n.mountOnEnter?c=R1:c=ym,a.state={status:c},a.nextCallback=null,a}e.getDerivedStateFromProps=function(i,a){var s=i.in;return s&&a.status===R1?{status:ym}:null};var r=e.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(i){var a=null;if(i!==this.props){var s=this.state.status;this.props.in?s!==vm&&s!==Ov&&(a=vm):(s===vm||s===Ov)&&(a=Rk)}this.updateStatus(!1,a)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var i=this.props.timeout,a,s,o;return a=s=o=i,i!=null&&typeof i!="number"&&(a=i.exit,s=i.enter,o=i.appear!==void 0?i.appear:s),{exit:a,enter:s,appear:o}},r.updateStatus=function(i,a){if(i===void 0&&(i=!1),a!==null)if(this.cancelNextCallback(),a===vm){if(this.props.unmountOnExit||this.props.mountOnEnter){var s=this.props.nodeRef?this.props.nodeRef.current:I1.findDOMNode(this);s&&dce(s)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ym&&this.setState({status:R1})},r.performEnter=function(i){var a=this,s=this.props.enter,o=this.context?this.context.isMounting:i,c=this.props.nodeRef?[o]:[I1.findDOMNode(this),o],h=c[0],d=c[1],m=this.getTimeouts(),b=o?m.appear:m.enter;if(!i&&!s||CB.disabled){this.safeSetState({status:Ov},function(){a.props.onEntered(h)});return}this.props.onEnter(h,d),this.safeSetState({status:vm},function(){a.props.onEntering(h,d),a.onTransitionEnd(b,function(){a.safeSetState({status:Ov},function(){a.props.onEntered(h,d)})})})},r.performExit=function(){var i=this,a=this.props.exit,s=this.getTimeouts(),o=this.props.nodeRef?void 0:I1.findDOMNode(this);if(!a||CB.disabled){this.safeSetState({status:ym},function(){i.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:Rk},function(){i.props.onExiting(o),i.onTransitionEnd(s.exit,function(){i.safeSetState({status:ym},function(){i.props.onExited(o)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(i,a){a=this.setNextCallback(a),this.setState(i,a)},r.setNextCallback=function(i){var a=this,s=!0;return this.nextCallback=function(o){s&&(s=!1,a.nextCallback=null,i(o))},this.nextCallback.cancel=function(){s=!1},this.nextCallback},r.onTransitionEnd=function(i,a){this.setNextCallback(a);var s=this.props.nodeRef?this.props.nodeRef.current:I1.findDOMNode(this),o=i==null&&!this.props.addEndListener;if(!s||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[s,this.nextCallback],h=c[0],d=c[1];this.props.addEndListener(h,d)}i!=null&&setTimeout(this.nextCallback,i)},r.render=function(){var i=this.state.status;if(i===R1)return null;var a=this.props,s=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var o=FX(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return gt.createElement(HS.Provider,{value:null},typeof s=="function"?s(i,o):gt.cloneElement(gt.Children.only(s),o))},e})(gt.Component);Kh.contextType=HS;Kh.propTypes={};function fv(){}Kh.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:fv,onEntering:fv,onEntered:fv,onExit:fv,onExiting:fv,onExited:fv};Kh.UNMOUNTED=R1;Kh.EXITED=ym;Kh.ENTERING=vm;Kh.ENTERED=Ov;Kh.EXITING=Rk;function pce(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function GD(t,e){var r=function(a){return e&&te.isValidElement(a)?e(a):a},n=Object.create(null);return t&&te.Children.map(t,function(i){return i}).forEach(function(i){n[i.key]=r(i)}),n}function gce(t,e){t=t||{},e=e||{};function r(d){return d in e?e[d]:t[d]}var n=Object.create(null),i=[];for(var a in t)a in e?i.length&&(n[a]=i,i=[]):i.push(a);var s,o={};for(var c in e){if(n[c])for(s=0;s<n[c].length;s++){var h=n[c][s];o[n[c][s]]=r(h)}o[c]=r(c)}for(s=0;s<i.length;s++)o[i[s]]=r(i[s]);return o}function Pm(t,e,r){return r[e]!=null?r[e]:t.props[e]}function mce(t,e){return GD(t.children,function(r){return te.cloneElement(r,{onExited:e.bind(null,r),in:!0,appear:Pm(r,"appear",t),enter:Pm(r,"enter",t),exit:Pm(r,"exit",t)})})}function yce(t,e,r){var n=GD(t.children),i=gce(e,n);return Object.keys(i).forEach(function(a){var s=i[a];if(te.isValidElement(s)){var o=a in e,c=a in n,h=e[a],d=te.isValidElement(h)&&!h.props.in;c&&(!o||d)?i[a]=te.cloneElement(s,{onExited:r.bind(null,s),in:!0,exit:Pm(s,"exit",t),enter:Pm(s,"enter",t)}):!c&&o&&!d?i[a]=te.cloneElement(s,{in:!1}):c&&o&&te.isValidElement(h)&&(i[a]=te.cloneElement(s,{onExited:r.bind(null,s),in:h.props.in,exit:Pm(s,"exit",t),enter:Pm(s,"enter",t)}))}}),i}var vce=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},_ce={component:"div",childFactory:function(e){return e}},XD=(function(t){BX(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=a.handleExited.bind(pce(a));return a.state={contextValue:{isMounting:!0},handleExited:s,firstRender:!0},a}var r=e.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,a){var s=a.children,o=a.handleExited,c=a.firstRender;return{children:c?mce(i,o):yce(i,s,o),firstRender:!1}},r.handleExited=function(i,a){var s=GD(this.props.children);i.key in s||(i.props.onExited&&i.props.onExited(a),this.mounted&&this.setState(function(o){var c=jS({},o.children);return delete c[i.key],{children:c}}))},r.render=function(){var i=this.props,a=i.component,s=i.childFactory,o=FX(i,["component","childFactory"]),c=this.state.contextValue,h=vce(this.state.children).map(s);return delete o.appear,delete o.enter,delete o.exit,a===null?gt.createElement(HS.Provider,{value:c},h):gt.createElement(HS.Provider,{value:c},gt.createElement(a,o,h))},e})(gt.Component);XD.propTypes={};XD.defaultProps=_ce;const AB={};function zX(t,e){const r=te.useRef(AB);return r.current===AB&&(r.current=t(e)),r}const bce=[];function xce(t){te.useEffect(t,bce)}class HT{static create(){return new HT}currentId=null;start(e,r){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,r()},e)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function hg(){const t=zX(HT.create).current;return xce(t.disposeEffect),t}const YD=t=>t.scrollTop;function xp(t,e){const{timeout:r,easing:n,style:i={}}=t;return{duration:i.transitionDuration??(typeof r=="number"?r:r[e.mode]||0),easing:i.transitionTimingFunction??(typeof n=="object"?n[e.mode]:n),delay:i.transitionDelay}}function wce(t){return gi("MuiCollapse",t)}pi("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const Sce=t=>{const{orientation:e,classes:r}=t,n={root:["root",`${e}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${e}`],wrapperInner:["wrapperInner",`${e}`]};return mi(n,wce,r)},Ece=Dr("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.orientation],r.state==="entered"&&e.entered,r.state==="exited"&&!r.in&&r.collapsedSize==="0px"&&e.hidden]}})(ci(({theme:t})=>({height:0,overflow:"hidden",transition:t.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:t.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:e})=>e.state==="exited"&&!e.in&&e.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),Tce=Dr("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Cce=Dr("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Mk=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiCollapse"}),{addEndListener:i,children:a,className:s,collapsedSize:o="0px",component:c,easing:h,in:d,onEnter:m,onEntered:b,onEntering:x,onExit:E,onExited:T,onExiting:A,orientation:M="vertical",style:F,timeout:N=PX.standard,TransitionComponent:O=Kh,...U}=n,j={...n,orientation:M,collapsedSize:o},H=Sce(j),G=Lc(),X=hg(),ae=te.useRef(null),Q=te.useRef(),W=typeof o=="number"?`${o}px`:o,oe=M==="horizontal",se=oe?"width":"height",he=te.useRef(null),_e=Uo(r,he),Ce=Fe=>Xe=>{if(Fe){const Be=he.current;Xe===void 0?Fe(Be):Fe(Be,Xe)}},me=()=>ae.current?ae.current[oe?"clientWidth":"clientHeight"]:0,xe=Ce((Fe,Xe)=>{ae.current&&oe&&(ae.current.style.position="absolute"),Fe.style[se]=W,m&&m(Fe,Xe)}),Ae=Ce((Fe,Xe)=>{const Be=me();ae.current&&oe&&(ae.current.style.position="");const{duration:ot,easing:Qe}=xp({style:F,timeout:N,easing:h},{mode:"enter"});if(N==="auto"){const rt=G.transitions.getAutoHeightDuration(Be);Fe.style.transitionDuration=`${rt}ms`,Q.current=rt}else Fe.style.transitionDuration=typeof ot=="string"?ot:`${ot}ms`;Fe.style[se]=`${Be}px`,Fe.style.transitionTimingFunction=Qe,x&&x(Fe,Xe)}),De=Ce((Fe,Xe)=>{Fe.style[se]="auto",b&&b(Fe,Xe)}),de=Ce(Fe=>{Fe.style[se]=`${me()}px`,E&&E(Fe)}),Ee=Ce(T),we=Ce(Fe=>{const Xe=me(),{duration:Be,easing:ot}=xp({style:F,timeout:N,easing:h},{mode:"exit"});if(N==="auto"){const Qe=G.transitions.getAutoHeightDuration(Xe);Fe.style.transitionDuration=`${Qe}ms`,Q.current=Qe}else Fe.style.transitionDuration=typeof Be=="string"?Be:`${Be}ms`;Fe.style[se]=W,Fe.style.transitionTimingFunction=ot,A&&A(Fe)}),Le=Fe=>{N==="auto"&&X.start(Q.current||0,Fe),i&&i(he.current,Fe)};return J.jsx(O,{in:d,onEnter:xe,onEntered:De,onEntering:Ae,onExit:de,onExited:Ee,onExiting:we,addEndListener:Le,nodeRef:he,timeout:N==="auto"?null:N,...U,children:(Fe,{ownerState:Xe,...Be})=>J.jsx(Ece,{as:c,className:An(H.root,s,{entered:H.entered,exited:!d&&W==="0px"&&H.hidden}[Fe]),style:{[oe?"minWidth":"minHeight"]:W,...F},ref:_e,ownerState:{...j,state:Fe},...Be,children:J.jsx(Tce,{ownerState:{...j,state:Fe},className:H.wrapper,ref:ae,children:J.jsx(Cce,{ownerState:{...j,state:Fe},className:H.wrapperInner,children:a})})})})});Mk&&(Mk.muiSupportAuto=!0);function Ace(t){return gi("MuiPaper",t)}pi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Ice=t=>{const{square:e,elevation:r,variant:n,classes:i}=t,a={root:["root",n,!e&&"rounded",n==="elevation"&&`elevation${r}`]};return mi(a,Ace,i)},Pce=Dr("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],!r.square&&e.rounded,r.variant==="elevation"&&e[`elevation${r.elevation}`]]}})(ci(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:t.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(t.vars||t).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),uh=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiPaper"}),i=Lc(),{className:a,component:s="div",elevation:o=1,square:c=!1,variant:h="elevation",...d}=n,m={...n,component:s,elevation:o,square:c,variant:h},b=Ice(m);return J.jsx(Pce,{as:s,ownerState:m,className:An(b.root,a),ref:r,...d,style:{...h==="elevation"&&{"--Paper-shadow":(i.vars||i).shadows[o],...i.vars&&{"--Paper-overlay":i.vars.overlays?.[o]},...!i.vars&&i.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${$S("#fff",Tk(o))}, ${$S("#fff",Tk(o))})`}},...d.style}})}),jX=te.createContext({});function vd(t){return typeof t=="string"}function UX(t,e,r){return t===void 0||vd(t)?e:{...e,ownerState:{...e.ownerState,...r}}}function VX(t,e,r){return typeof t=="function"?t(e,r):t}function Nm(t,e=[]){if(t===void 0)return{};const r={};return Object.keys(t).filter(n=>n.match(/^on[A-Z]/)&&typeof t[n]=="function"&&!e.includes(n)).forEach(n=>{r[n]=t[n]}),r}function IB(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(r=>!(r.match(/^on[A-Z]/)&&typeof t[r]=="function")).forEach(r=>{e[r]=t[r]}),e}function $X(t){const{getSlotProps:e,additionalProps:r,externalSlotProps:n,externalForwardedProps:i,className:a}=t;if(!e){const x=An(r?.className,a,i?.className,n?.className),E={...r?.style,...i?.style,...n?.style},T={...r,...i,...n};return x.length>0&&(T.className=x),Object.keys(E).length>0&&(T.style=E),{props:T,internalRef:void 0}}const s=Nm({...i,...n}),o=IB(n),c=IB(i),h=e(s),d=An(h?.className,r?.className,a,i?.className,n?.className),m={...h?.style,...r?.style,...i?.style,...n?.style},b={...h,...r,...c,...o};return d.length>0&&(b.className=d),Object.keys(m).length>0&&(b.style=m),{props:b,internalRef:h.ref}}function Ei(t,e){const{className:r,elementType:n,ownerState:i,externalForwardedProps:a,internalForwardedProps:s,shouldForwardComponentProp:o=!1,...c}=e,{component:h,slots:d={[t]:void 0},slotProps:m={[t]:void 0},...b}=a,x=d[t]||n,E=VX(m[t],i),{props:{component:T,...A},internalRef:M}=$X({className:r,...c,externalForwardedProps:t==="root"?b:void 0,externalSlotProps:E}),F=Uo(M,E?.ref,e.ref),N=t==="root"?T||h:T,O=UX(x,{...t==="root"&&!h&&!d[t]&&s,...t!=="root"&&!d[t]&&s,...A,...N&&!o&&{as:N},...N&&o&&{component:N},ref:F},i);return[x,O]}function kce(t){return gi("MuiAccordion",t)}const j2=pi("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),Rce=t=>{const{classes:e,square:r,expanded:n,disabled:i,disableGutters:a}=t;return mi({root:["root",!r&&"rounded",n&&"expanded",i&&"disabled",!a&&"gutters"],heading:["heading"],region:["region"]},kce,e)},Mce=Dr(uh,{name:"MuiAccordion",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${j2.region}`]:e.region},e.root,!r.square&&e.rounded,!r.disableGutters&&e.gutters]}})(ci(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{position:"relative",transition:t.transitions.create(["margin"],e),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(t.vars||t).palette.divider,transition:t.transitions.create(["opacity","background-color"],e)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${j2.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${j2.disabled}`]:{backgroundColor:(t.vars||t).palette.action.disabledBackground}}}),ci(({theme:t})=>({variants:[{props:e=>!e.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(t.vars||t).shape.borderRadius,borderBottomRightRadius:(t.vars||t).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:e=>!e.disableGutters,style:{[`&.${j2.expanded}`]:{margin:"16px 0"}}}]}))),Dce=Dr("h3",{name:"MuiAccordion",slot:"Heading"})({all:"unset"}),Oce=Dr("div",{name:"MuiAccordion",slot:"Region"})({}),Nce=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAccordion"}),{children:i,className:a,defaultExpanded:s=!1,disabled:o=!1,disableGutters:c=!1,expanded:h,onChange:d,square:m=!1,slots:b={},slotProps:x={},TransitionComponent:E,TransitionProps:T,...A}=n,[M,F]=Ym({controlled:h,default:s,name:"Accordion",state:"expanded"}),N=te.useCallback(Ae=>{F(!M),d&&d(Ae,!M)},[M,d,F]),[O,...U]=te.Children.toArray(i),j=te.useMemo(()=>({expanded:M,disabled:o,disableGutters:c,toggle:N}),[M,o,c,N]),H={...n,square:m,disabled:o,disableGutters:c,expanded:M},G=Rce(H),X={transition:E,...b},ae={transition:T,...x},Q={slots:X,slotProps:ae},[W,oe]=Ei("root",{elementType:Mce,externalForwardedProps:{...Q,...A},className:An(G.root,a),shouldForwardComponentProp:!0,ownerState:H,ref:r,additionalProps:{square:m}}),[se,he]=Ei("heading",{elementType:Dce,externalForwardedProps:Q,className:G.heading,ownerState:H}),[_e,Ce]=Ei("transition",{elementType:Mk,externalForwardedProps:Q,ownerState:H}),[me,xe]=Ei("region",{elementType:Oce,externalForwardedProps:Q,ownerState:H,className:G.region,additionalProps:{"aria-labelledby":O.props.id,id:O.props["aria-controls"],role:"region"}});return J.jsxs(W,{...oe,children:[J.jsx(se,{...he,children:J.jsx(jX.Provider,{value:j,children:O})}),J.jsx(_e,{in:M,timeout:"auto",...Ce,children:J.jsx(me,{...xe,children:U})})]})});function N0(t){try{return t.matches(":focus-visible")}catch{}return!1}class WS{static create(){return new WS}static use(){const e=zX(WS.create).current,[r,n]=te.useState(!1);return e.shouldMount=r,e.setShouldMount=n,te.useEffect(e.mountEffect,[r]),e}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=Fce(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())};start(...e){this.mount().then(()=>this.ref.current?.start(...e))}stop(...e){this.mount().then(()=>this.ref.current?.stop(...e))}pulsate(...e){this.mount().then(()=>this.ref.current?.pulsate(...e))}}function Lce(){return WS.use()}function Fce(){let t,e;const r=new Promise((n,i)=>{t=n,e=i});return r.resolve=t,r.reject=e,r}function Bce(t){const{className:e,classes:r,pulsate:n=!1,rippleX:i,rippleY:a,rippleSize:s,in:o,onExited:c,timeout:h}=t,[d,m]=te.useState(!1),b=An(e,r.ripple,r.rippleVisible,n&&r.ripplePulsate),x={width:s,height:s,top:-(s/2)+a,left:-(s/2)+i},E=An(r.child,d&&r.childLeaving,n&&r.childPulsate);return!o&&!d&&m(!0),te.useEffect(()=>{if(!o&&c!=null){const T=setTimeout(c,h);return()=>{clearTimeout(T)}}},[c,o,h]),J.jsx("span",{className:b,style:x,children:J.jsx("span",{className:E})})}const kh=pi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Dk=550,zce=80,jce=Tx`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,Uce=Tx`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,Vce=Tx`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,$ce=Dr("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),qce=Dr(Bce,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${kh.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${jce};
    animation-duration: ${Dk}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  &.${kh.ripplePulsate} {
    animation-duration: ${({theme:t})=>t.transitions.duration.shorter}ms;
  }

  & .${kh.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${kh.childLeaving} {
    opacity: 0;
    animation-name: ${Uce};
    animation-duration: ${Dk}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  & .${kh.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${Vce};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,Hce=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:a={},className:s,...o}=n,[c,h]=te.useState([]),d=te.useRef(0),m=te.useRef(null);te.useEffect(()=>{m.current&&(m.current(),m.current=null)},[c]);const b=te.useRef(!1),x=hg(),E=te.useRef(null),T=te.useRef(null),A=te.useCallback(O=>{const{pulsate:U,rippleX:j,rippleY:H,rippleSize:G,cb:X}=O;h(ae=>[...ae,J.jsx(qce,{classes:{ripple:An(a.ripple,kh.ripple),rippleVisible:An(a.rippleVisible,kh.rippleVisible),ripplePulsate:An(a.ripplePulsate,kh.ripplePulsate),child:An(a.child,kh.child),childLeaving:An(a.childLeaving,kh.childLeaving),childPulsate:An(a.childPulsate,kh.childPulsate)},timeout:Dk,pulsate:U,rippleX:j,rippleY:H,rippleSize:G},d.current)]),d.current+=1,m.current=X},[a]),M=te.useCallback((O={},U={},j=()=>{})=>{const{pulsate:H=!1,center:G=i||U.pulsate,fakeElement:X=!1}=U;if(O?.type==="mousedown"&&b.current){b.current=!1;return}O?.type==="touchstart"&&(b.current=!0);const ae=X?null:T.current,Q=ae?ae.getBoundingClientRect():{width:0,height:0,left:0,top:0};let W,oe,se;if(G||O===void 0||O.clientX===0&&O.clientY===0||!O.clientX&&!O.touches)W=Math.round(Q.width/2),oe=Math.round(Q.height/2);else{const{clientX:he,clientY:_e}=O.touches&&O.touches.length>0?O.touches[0]:O;W=Math.round(he-Q.left),oe=Math.round(_e-Q.top)}if(G)se=Math.sqrt((2*Q.width**2+Q.height**2)/3),se%2===0&&(se+=1);else{const he=Math.max(Math.abs((ae?ae.clientWidth:0)-W),W)*2+2,_e=Math.max(Math.abs((ae?ae.clientHeight:0)-oe),oe)*2+2;se=Math.sqrt(he**2+_e**2)}O?.touches?E.current===null&&(E.current=()=>{A({pulsate:H,rippleX:W,rippleY:oe,rippleSize:se,cb:j})},x.start(zce,()=>{E.current&&(E.current(),E.current=null)})):A({pulsate:H,rippleX:W,rippleY:oe,rippleSize:se,cb:j})},[i,A,x]),F=te.useCallback(()=>{M({},{pulsate:!0})},[M]),N=te.useCallback((O,U)=>{if(x.clear(),O?.type==="touchend"&&E.current){E.current(),E.current=null,x.start(0,()=>{N(O,U)});return}E.current=null,h(j=>j.length>0?j.slice(1):j),m.current=U},[x]);return te.useImperativeHandle(r,()=>({pulsate:F,start:M,stop:N}),[F,M,N]),J.jsx($ce,{className:An(kh.root,a.root,s),ref:T,...o,children:J.jsx(XD,{component:null,exit:!0,children:c})})});function Wce(t){return gi("MuiButtonBase",t)}const Gce=pi("MuiButtonBase",["root","disabled","focusVisible"]),Xce=t=>{const{disabled:e,focusVisible:r,focusVisibleClassName:n,classes:i}=t,s=mi({root:["root",e&&"disabled",r&&"focusVisible"]},Wce,i);return r&&n&&(s.root+=` ${n}`),s},Yce=Dr("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Gce.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),h_=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:a=!1,children:s,className:o,component:c="button",disabled:h=!1,disableRipple:d=!1,disableTouchRipple:m=!1,focusRipple:b=!1,focusVisibleClassName:x,LinkComponent:E="a",onBlur:T,onClick:A,onContextMenu:M,onDragLeave:F,onFocus:N,onFocusVisible:O,onKeyDown:U,onKeyUp:j,onMouseDown:H,onMouseLeave:G,onMouseUp:X,onTouchEnd:ae,onTouchMove:Q,onTouchStart:W,tabIndex:oe=0,TouchRippleProps:se,touchRippleRef:he,type:_e,...Ce}=n,me=te.useRef(null),xe=Lce(),Ae=Uo(xe.ref,he),[De,de]=te.useState(!1);h&&De&&de(!1),te.useImperativeHandle(i,()=>({focusVisible:()=>{de(!0),me.current.focus()}}),[]);const Ee=xe.shouldMount&&!d&&!h;te.useEffect(()=>{De&&b&&!d&&xe.pulsate()},[d,b,De,xe]);const we=Kd(xe,"start",H,m),Le=Kd(xe,"stop",M,m),Fe=Kd(xe,"stop",F,m),Xe=Kd(xe,"stop",X,m),Be=Kd(xe,"stop",lr=>{De&&lr.preventDefault(),G&&G(lr)},m),ot=Kd(xe,"start",W,m),Qe=Kd(xe,"stop",ae,m),rt=Kd(xe,"stop",Q,m),Re=Kd(xe,"stop",lr=>{N0(lr.target)||de(!1),T&&T(lr)},!1),zt=ou(lr=>{me.current||(me.current=lr.currentTarget),N0(lr.target)&&(de(!0),O&&O(lr)),N&&N(lr)}),st=()=>{const lr=me.current;return c&&c!=="button"&&!(lr.tagName==="A"&&lr.href)},$e=ou(lr=>{b&&!lr.repeat&&De&&lr.key===" "&&xe.stop(lr,()=>{xe.start(lr)}),lr.target===lr.currentTarget&&st()&&lr.key===" "&&lr.preventDefault(),U&&U(lr),lr.target===lr.currentTarget&&st()&&lr.key==="Enter"&&!h&&(lr.preventDefault(),A&&A(lr))}),Jt=ou(lr=>{b&&lr.key===" "&&De&&!lr.defaultPrevented&&xe.stop(lr,()=>{xe.pulsate(lr)}),j&&j(lr),A&&lr.target===lr.currentTarget&&st()&&lr.key===" "&&!lr.defaultPrevented&&A(lr)});let Ht=c;Ht==="button"&&(Ce.href||Ce.to)&&(Ht=E);const pr={};Ht==="button"?(pr.type=_e===void 0?"button":_e,pr.disabled=h):(!Ce.href&&!Ce.to&&(pr.role="button"),h&&(pr["aria-disabled"]=h));const _t=Uo(r,me),vr={...n,centerRipple:a,component:c,disabled:h,disableRipple:d,disableTouchRipple:m,focusRipple:b,tabIndex:oe,focusVisible:De},br=Xce(vr);return J.jsxs(Yce,{as:Ht,className:An(br.root,o),ownerState:vr,onBlur:Re,onClick:A,onContextMenu:Le,onFocus:zt,onKeyDown:$e,onKeyUp:Jt,onMouseDown:we,onMouseLeave:Be,onMouseUp:Xe,onDragLeave:Fe,onTouchEnd:Qe,onTouchMove:rt,onTouchStart:ot,ref:_t,tabIndex:h?-1:oe,type:_e,...pr,...Ce,children:[s,Ee?J.jsx(Hce,{ref:Ae,center:a,...se}):null]})});function Kd(t,e,r,n=!1){return ou(i=>(r&&r(i),n||t[e](i),!0))}function Zce(t){return gi("MuiAccordionSummary",t)}const n0=pi("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),Kce=t=>{const{classes:e,expanded:r,disabled:n,disableGutters:i}=t;return mi({root:["root",r&&"expanded",n&&"disabled",!i&&"gutters"],focusVisible:["focusVisible"],content:["content",r&&"expanded",!i&&"contentGutters"],expandIconWrapper:["expandIconWrapper",r&&"expanded"]},Zce,e)},Jce=Dr(h_,{name:"MuiAccordionSummary",slot:"Root"})(ci(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:t.spacing(0,2),transition:t.transitions.create(["min-height","background-color"],e),[`&.${n0.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${n0.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`&:hover:not(.${n0.disabled})`]:{cursor:"pointer"},variants:[{props:r=>!r.disableGutters,style:{[`&.${n0.expanded}`]:{minHeight:64}}}]}})),Qce=Dr("span",{name:"MuiAccordionSummary",slot:"Content"})(ci(({theme:t})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:e=>!e.disableGutters,style:{transition:t.transitions.create(["margin"],{duration:t.transitions.duration.shortest}),[`&.${n0.expanded}`]:{margin:"20px 0"}}}]}))),ehe=Dr("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper"})(ci(({theme:t})=>({display:"flex",color:(t.vars||t).palette.action.active,transform:"rotate(0deg)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest}),[`&.${n0.expanded}`]:{transform:"rotate(180deg)"}}))),the=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAccordionSummary"}),{children:i,className:a,expandIcon:s,focusVisibleClassName:o,onClick:c,slots:h,slotProps:d,...m}=n,{disabled:b=!1,disableGutters:x,expanded:E,toggle:T}=te.useContext(jX),A=ae=>{T&&T(ae),c&&c(ae)},M={...n,expanded:E,disabled:b,disableGutters:x},F=Kce(M),N={slots:h,slotProps:d},[O,U]=Ei("root",{ref:r,shouldForwardComponentProp:!0,className:An(F.root,a),elementType:Jce,externalForwardedProps:{...N,...m},ownerState:M,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:b,"aria-expanded":E,focusVisibleClassName:An(F.focusVisible,o)},getSlotProps:ae=>({...ae,onClick:Q=>{ae.onClick?.(Q),A(Q)}})}),[j,H]=Ei("content",{className:F.content,elementType:Qce,externalForwardedProps:N,ownerState:M}),[G,X]=Ei("expandIconWrapper",{className:F.expandIconWrapper,elementType:ehe,externalForwardedProps:N,ownerState:M});return J.jsxs(O,{...U,children:[J.jsx(j,{...H,children:i}),s&&J.jsx(G,{...X,children:s})]})});function rhe(t){return typeof t.main=="string"}function nhe(t,e=[]){if(!rhe(t))return!1;for(const r of e)if(!t.hasOwnProperty(r)||typeof t[r]!="string")return!1;return!0}function jl(t=[]){return([,e])=>e&&nhe(e,t)}function ihe(t){return gi("MuiCircularProgress",t)}pi("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Kp=44,Ok=Tx`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,Nk=Tx`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,ahe=typeof Ok!="string"?MD`
        animation: ${Ok} 1.4s linear infinite;
      `:null,ohe=typeof Nk!="string"?MD`
        animation: ${Nk} 1.4s ease-in-out infinite;
      `:null,she=t=>{const{classes:e,variant:r,color:n,disableShrink:i}=t,a={root:["root",r,`color${cn(n)}`],svg:["svg"],circle:["circle",`circle${cn(r)}`,i&&"circleDisableShrink"]};return mi(a,ihe,e)},lhe=Dr("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`color${cn(r.color)}`]]}})(ci(({theme:t})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:ahe||{animation:`${Ok} 1.4s linear infinite`}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))]}))),uhe=Dr("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),che=Dr("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.circle,e[`circle${cn(r.variant)}`],r.disableShrink&&e.circleDisableShrink]}})(ci(({theme:t})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:ohe||{animation:`${Nk} 1.4s ease-in-out infinite`}}]}))),WT=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiCircularProgress"}),{className:i,color:a="primary",disableShrink:s=!1,size:o=40,style:c,thickness:h=3.6,value:d=0,variant:m="indeterminate",...b}=n,x={...n,color:a,disableShrink:s,size:o,thickness:h,value:d,variant:m},E=she(x),T={},A={},M={};if(m==="determinate"){const F=2*Math.PI*((Kp-h)/2);T.strokeDasharray=F.toFixed(3),M["aria-valuenow"]=Math.round(d),T.strokeDashoffset=`${((100-d)/100*F).toFixed(3)}px`,A.transform="rotate(-90deg)"}return J.jsx(lhe,{className:An(E.root,i),style:{width:o,height:o,...A,...c},ownerState:x,ref:r,role:"progressbar",...M,...b,children:J.jsx(uhe,{className:E.svg,ownerState:x,viewBox:`${Kp/2} ${Kp/2} ${Kp} ${Kp}`,children:J.jsx(che,{className:E.circle,style:T,ownerState:x,cx:Kp,cy:Kp,r:(Kp-h)/2,fill:"none",strokeWidth:h})})})});function hhe(t){return gi("MuiIconButton",t)}const PB=pi("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),fhe=t=>{const{classes:e,disabled:r,color:n,edge:i,size:a,loading:s}=t,o={root:["root",s&&"loading",r&&"disabled",n!=="default"&&`color${cn(n)}`,i&&`edge${cn(i)}`,`size${cn(a)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return mi(o,hhe,e)},dhe=Dr(h_,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.loading&&e.loading,r.color!=="default"&&e[`color${cn(r.color)}`],r.edge&&e[`edge${cn(r.edge)}`],e[`size${cn(r.size)}`]]}})(ci(({theme:t})=>({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),ci(({theme:t})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],[`&.${PB.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled},[`&.${PB.loading}`]:{color:"transparent"}}))),phe=Dr("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(t.vars||t).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),kc=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiIconButton"}),{edge:i=!1,children:a,className:s,color:o="default",disabled:c=!1,disableFocusRipple:h=!1,size:d="medium",id:m,loading:b=null,loadingIndicator:x,...E}=n,T=Og(m),A=x??J.jsx(WT,{"aria-labelledby":T,color:"inherit",size:16}),M={...n,edge:i,color:o,disabled:c,disableFocusRipple:h,loading:b,loadingIndicator:A,size:d},F=fhe(M);return J.jsxs(dhe,{id:b?T:m,className:An(F.root,s),centerRipple:!0,focusRipple:!h,disabled:c||b,ref:r,...E,ownerState:M,children:[typeof b=="boolean"&&J.jsx("span",{className:F.loadingWrapper,style:{display:"contents"},children:J.jsx(phe,{className:F.loadingIndicator,ownerState:M,children:b&&A})}),a]})});function ghe(t){return gi("MuiTypography",t)}const kB=pi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),mhe={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},yhe=lce(),vhe=t=>{const{align:e,gutterBottom:r,noWrap:n,paragraph:i,variant:a,classes:s}=t,o={root:["root",a,t.align!=="inherit"&&`align${cn(e)}`,r&&"gutterBottom",n&&"noWrap",i&&"paragraph"]};return mi(o,ghe,s)},_he=Dr("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.variant&&e[r.variant],r.align!=="inherit"&&e[`align${cn(r.align)}`],r.noWrap&&e.noWrap,r.gutterBottom&&e.gutterBottom,r.paragraph&&e.paragraph]}})(ci(({theme:t})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(t.typography).filter(([e,r])=>e!=="inherit"&&r&&typeof r=="object").map(([e,r])=>({props:{variant:e},style:r})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette?.text||{}).filter(([,e])=>typeof e=="string").map(([e])=>({props:{color:`text${cn(e)}`},style:{color:(t.vars||t).palette.text[e]}})),{props:({ownerState:e})=>e.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:e})=>e.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:e})=>e.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:e})=>e.paragraph,style:{marginBottom:16}}]}))),RB={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Ss=te.forwardRef(function(e,r){const{color:n,...i}=bi({props:e,name:"MuiTypography"}),a=!mhe[n],s=yhe({...i,...a&&{color:n}}),{align:o="inherit",className:c,component:h,gutterBottom:d=!1,noWrap:m=!1,paragraph:b=!1,variant:x="body1",variantMapping:E=RB,...T}=s,A={...s,align:o,color:n,className:c,component:h,gutterBottom:d,noWrap:m,paragraph:b,variant:x,variantMapping:E},M=h||(b?"p":E[x]||RB[x])||"span",F=vhe(A);return J.jsx(_he,{as:M,ref:r,className:An(F.root,c),...T,ownerState:A,style:{...o!=="inherit"&&{"--Typography-textAlign":o},...T.style}})});function bhe(t){return gi("MuiAppBar",t)}pi("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const xhe=t=>{const{color:e,position:r,classes:n}=t,i={root:["root",`color${cn(e)}`,`position${cn(r)}`]};return mi(i,bhe,n)},MB=(t,e)=>t?`${t?.replace(")","")}, ${e})`:e,whe=Dr(uh,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`position${cn(r.position)}`],e[`color${cn(r.color)}`]]}})(ci(({theme:t})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[100],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[100]),...t.applyStyles("dark",{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[900],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[900])})}},...Object.entries(t.palette).filter(jl(["contrastText"])).map(([e])=>({props:{color:e},style:{"--AppBar-background":(t.vars??t).palette[e].main,"--AppBar-color":(t.vars??t).palette[e].contrastText}})),{props:e=>e.enableColorOnDark===!0&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:e=>e.enableColorOnDark===!1&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundColor:t.vars?MB(t.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:t.vars?MB(t.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundImage:"none"})}}]}))),She=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAppBar"}),{className:i,color:a="primary",enableColorOnDark:s=!1,position:o="fixed",...c}=n,h={...n,color:a,position:o,enableColorOnDark:s},d=xhe(h);return J.jsx(whe,{square:!0,component:"header",ownerState:h,elevation:4,className:An(d.root,i,o==="fixed"&&"mui-fixed"),ref:r,...c})});var Rc="top",Uh="bottom",Vh="right",Mc="left",ZD="auto",Rx=[Rc,Uh,Vh,Mc],L0="start",Fb="end",Ehe="clippingParents",qX="viewport",Q_="popper",The="reference",DB=Rx.reduce(function(t,e){return t.concat([e+"-"+L0,e+"-"+Fb])},[]),HX=[].concat(Rx,[ZD]).reduce(function(t,e){return t.concat([e,e+"-"+L0,e+"-"+Fb])},[]),Che="beforeRead",Ahe="read",Ihe="afterRead",Phe="beforeMain",khe="main",Rhe="afterMain",Mhe="beforeWrite",Dhe="write",Ohe="afterWrite",Nhe=[Che,Ahe,Ihe,Phe,khe,Rhe,Mhe,Dhe,Ohe];function Sd(t){return t?(t.nodeName||"").toLowerCase():null}function ch(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Zm(t){var e=ch(t).Element;return t instanceof e||t instanceof Element}function Lh(t){var e=ch(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function KD(t){if(typeof ShadowRoot>"u")return!1;var e=ch(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Lhe(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},a=e.elements[r];!Lh(a)||!Sd(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function Fhe(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],a=e.attributes[n]||{},s=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),o=s.reduce(function(c,h){return c[h]="",c},{});!Lh(i)||!Sd(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(c){i.removeAttribute(c)}))})}}const Bhe={name:"applyStyles",enabled:!0,phase:"write",fn:Lhe,effect:Fhe,requires:["computeStyles"]};function _d(t){return t.split("-")[0]}var Lm=Math.max,GS=Math.min,F0=Math.round;function Lk(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function WX(){return!/^((?!chrome|android).)*safari/i.test(Lk())}function B0(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,a=1;e&&Lh(t)&&(i=t.offsetWidth>0&&F0(n.width)/t.offsetWidth||1,a=t.offsetHeight>0&&F0(n.height)/t.offsetHeight||1);var s=Zm(t)?ch(t):window,o=s.visualViewport,c=!WX()&&r,h=(n.left+(c&&o?o.offsetLeft:0))/i,d=(n.top+(c&&o?o.offsetTop:0))/a,m=n.width/i,b=n.height/a;return{width:m,height:b,top:d,right:h+m,bottom:d+b,left:h,x:h,y:d}}function JD(t){var e=B0(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function GX(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&KD(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function wp(t){return ch(t).getComputedStyle(t)}function zhe(t){return["table","td","th"].indexOf(Sd(t))>=0}function Lg(t){return((Zm(t)?t.ownerDocument:t.document)||window.document).documentElement}function GT(t){return Sd(t)==="html"?t:t.assignedSlot||t.parentNode||(KD(t)?t.host:null)||Lg(t)}function OB(t){return!Lh(t)||wp(t).position==="fixed"?null:t.offsetParent}function jhe(t){var e=/firefox/i.test(Lk()),r=/Trident/i.test(Lk());if(r&&Lh(t)){var n=wp(t);if(n.position==="fixed")return null}var i=GT(t);for(KD(i)&&(i=i.host);Lh(i)&&["html","body"].indexOf(Sd(i))<0;){var a=wp(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Mx(t){for(var e=ch(t),r=OB(t);r&&zhe(r)&&wp(r).position==="static";)r=OB(r);return r&&(Sd(r)==="html"||Sd(r)==="body"&&wp(r).position==="static")?e:r||jhe(t)||e}function QD(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function ob(t,e,r){return Lm(t,GS(e,r))}function Uhe(t,e,r){var n=ob(t,e,r);return n>r?r:n}function XX(){return{top:0,right:0,bottom:0,left:0}}function YX(t){return Object.assign({},XX(),t)}function ZX(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var Vhe=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,YX(typeof e!="number"?e:ZX(e,Rx))};function $he(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,s=r.modifiersData.popperOffsets,o=_d(r.placement),c=QD(o),h=[Mc,Vh].indexOf(o)>=0,d=h?"height":"width";if(!(!a||!s)){var m=Vhe(i.padding,r),b=JD(a),x=c==="y"?Rc:Mc,E=c==="y"?Uh:Vh,T=r.rects.reference[d]+r.rects.reference[c]-s[c]-r.rects.popper[d],A=s[c]-r.rects.reference[c],M=Mx(a),F=M?c==="y"?M.clientHeight||0:M.clientWidth||0:0,N=T/2-A/2,O=m[x],U=F-b[d]-m[E],j=F/2-b[d]/2+N,H=ob(O,j,U),G=c;r.modifiersData[n]=(e={},e[G]=H,e.centerOffset=H-j,e)}}function qhe(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||GX(e.elements.popper,i)&&(e.elements.arrow=i))}const Hhe={name:"arrow",enabled:!0,phase:"main",fn:$he,effect:qhe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function z0(t){return t.split("-")[1]}var Whe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ghe(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:F0(r*i)/i||0,y:F0(n*i)/i||0}}function NB(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,s=t.offsets,o=t.position,c=t.gpuAcceleration,h=t.adaptive,d=t.roundOffsets,m=t.isFixed,b=s.x,x=b===void 0?0:b,E=s.y,T=E===void 0?0:E,A=typeof d=="function"?d({x,y:T}):{x,y:T};x=A.x,T=A.y;var M=s.hasOwnProperty("x"),F=s.hasOwnProperty("y"),N=Mc,O=Rc,U=window;if(h){var j=Mx(r),H="clientHeight",G="clientWidth";if(j===ch(r)&&(j=Lg(r),wp(j).position!=="static"&&o==="absolute"&&(H="scrollHeight",G="scrollWidth")),j=j,i===Rc||(i===Mc||i===Vh)&&a===Fb){O=Uh;var X=m&&j===U&&U.visualViewport?U.visualViewport.height:j[H];T-=X-n.height,T*=c?1:-1}if(i===Mc||(i===Rc||i===Uh)&&a===Fb){N=Vh;var ae=m&&j===U&&U.visualViewport?U.visualViewport.width:j[G];x-=ae-n.width,x*=c?1:-1}}var Q=Object.assign({position:o},h&&Whe),W=d===!0?Ghe({x,y:T},ch(r)):{x,y:T};if(x=W.x,T=W.y,c){var oe;return Object.assign({},Q,(oe={},oe[O]=F?"0":"",oe[N]=M?"0":"",oe.transform=(U.devicePixelRatio||1)<=1?"translate("+x+"px, "+T+"px)":"translate3d("+x+"px, "+T+"px, 0)",oe))}return Object.assign({},Q,(e={},e[O]=F?T+"px":"",e[N]=M?x+"px":"",e.transform="",e))}function Xhe(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,s=a===void 0?!0:a,o=r.roundOffsets,c=o===void 0?!0:o,h={placement:_d(e.placement),variation:z0(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,NB(Object.assign({},h,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:c})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,NB(Object.assign({},h,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Yhe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Xhe,data:{}};var U2={passive:!0};function Zhe(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=i===void 0?!0:i,s=n.resize,o=s===void 0?!0:s,c=ch(e.elements.popper),h=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&h.forEach(function(d){d.addEventListener("scroll",r.update,U2)}),o&&c.addEventListener("resize",r.update,U2),function(){a&&h.forEach(function(d){d.removeEventListener("scroll",r.update,U2)}),o&&c.removeEventListener("resize",r.update,U2)}}const Khe={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Zhe,data:{}};var Jhe={left:"right",right:"left",bottom:"top",top:"bottom"};function uS(t){return t.replace(/left|right|bottom|top/g,function(e){return Jhe[e]})}var Qhe={start:"end",end:"start"};function LB(t){return t.replace(/start|end/g,function(e){return Qhe[e]})}function eO(t){var e=ch(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function tO(t){return B0(Lg(t)).left+eO(t).scrollLeft}function efe(t,e){var r=ch(t),n=Lg(t),i=r.visualViewport,a=n.clientWidth,s=n.clientHeight,o=0,c=0;if(i){a=i.width,s=i.height;var h=WX();(h||!h&&e==="fixed")&&(o=i.offsetLeft,c=i.offsetTop)}return{width:a,height:s,x:o+tO(t),y:c}}function tfe(t){var e,r=Lg(t),n=eO(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=Lm(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Lm(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+tO(t),c=-n.scrollTop;return wp(i||r).direction==="rtl"&&(o+=Lm(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:c}}function rO(t){var e=wp(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function KX(t){return["html","body","#document"].indexOf(Sd(t))>=0?t.ownerDocument.body:Lh(t)&&rO(t)?t:KX(GT(t))}function sb(t,e){var r;e===void 0&&(e=[]);var n=KX(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),a=ch(n),s=i?[a].concat(a.visualViewport||[],rO(n)?n:[]):n,o=e.concat(s);return i?o:o.concat(sb(GT(s)))}function Fk(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function rfe(t,e){var r=B0(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function FB(t,e,r){return e===qX?Fk(efe(t,r)):Zm(e)?rfe(e,r):Fk(tfe(Lg(t)))}function nfe(t){var e=sb(GT(t)),r=["absolute","fixed"].indexOf(wp(t).position)>=0,n=r&&Lh(t)?Mx(t):t;return Zm(n)?e.filter(function(i){return Zm(i)&&GX(i,n)&&Sd(i)!=="body"}):[]}function ife(t,e,r,n){var i=e==="clippingParents"?nfe(t):[].concat(e),a=[].concat(i,[r]),s=a[0],o=a.reduce(function(c,h){var d=FB(t,h,n);return c.top=Lm(d.top,c.top),c.right=GS(d.right,c.right),c.bottom=GS(d.bottom,c.bottom),c.left=Lm(d.left,c.left),c},FB(t,s,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function JX(t){var e=t.reference,r=t.element,n=t.placement,i=n?_d(n):null,a=n?z0(n):null,s=e.x+e.width/2-r.width/2,o=e.y+e.height/2-r.height/2,c;switch(i){case Rc:c={x:s,y:e.y-r.height};break;case Uh:c={x:s,y:e.y+e.height};break;case Vh:c={x:e.x+e.width,y:o};break;case Mc:c={x:e.x-r.width,y:o};break;default:c={x:e.x,y:e.y}}var h=i?QD(i):null;if(h!=null){var d=h==="y"?"height":"width";switch(a){case L0:c[h]=c[h]-(e[d]/2-r[d]/2);break;case Fb:c[h]=c[h]+(e[d]/2-r[d]/2);break}}return c}function Bb(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,a=r.strategy,s=a===void 0?t.strategy:a,o=r.boundary,c=o===void 0?Ehe:o,h=r.rootBoundary,d=h===void 0?qX:h,m=r.elementContext,b=m===void 0?Q_:m,x=r.altBoundary,E=x===void 0?!1:x,T=r.padding,A=T===void 0?0:T,M=YX(typeof A!="number"?A:ZX(A,Rx)),F=b===Q_?The:Q_,N=t.rects.popper,O=t.elements[E?F:b],U=ife(Zm(O)?O:O.contextElement||Lg(t.elements.popper),c,d,s),j=B0(t.elements.reference),H=JX({reference:j,element:N,placement:i}),G=Fk(Object.assign({},N,H)),X=b===Q_?G:j,ae={top:U.top-X.top+M.top,bottom:X.bottom-U.bottom+M.bottom,left:U.left-X.left+M.left,right:X.right-U.right+M.right},Q=t.modifiersData.offset;if(b===Q_&&Q){var W=Q[i];Object.keys(ae).forEach(function(oe){var se=[Vh,Uh].indexOf(oe)>=0?1:-1,he=[Rc,Uh].indexOf(oe)>=0?"y":"x";ae[oe]+=W[he]*se})}return ae}function afe(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,s=r.padding,o=r.flipVariations,c=r.allowedAutoPlacements,h=c===void 0?HX:c,d=z0(n),m=d?o?DB:DB.filter(function(E){return z0(E)===d}):Rx,b=m.filter(function(E){return h.indexOf(E)>=0});b.length===0&&(b=m);var x=b.reduce(function(E,T){return E[T]=Bb(t,{placement:T,boundary:i,rootBoundary:a,padding:s})[_d(T)],E},{});return Object.keys(x).sort(function(E,T){return x[E]-x[T]})}function ofe(t){if(_d(t)===ZD)return[];var e=uS(t);return[LB(t),e,LB(e)]}function sfe(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!0:s,c=r.fallbackPlacements,h=r.padding,d=r.boundary,m=r.rootBoundary,b=r.altBoundary,x=r.flipVariations,E=x===void 0?!0:x,T=r.allowedAutoPlacements,A=e.options.placement,M=_d(A),F=M===A,N=c||(F||!E?[uS(A)]:ofe(A)),O=[A].concat(N).reduce(function(we,Le){return we.concat(_d(Le)===ZD?afe(e,{placement:Le,boundary:d,rootBoundary:m,padding:h,flipVariations:E,allowedAutoPlacements:T}):Le)},[]),U=e.rects.reference,j=e.rects.popper,H=new Map,G=!0,X=O[0],ae=0;ae<O.length;ae++){var Q=O[ae],W=_d(Q),oe=z0(Q)===L0,se=[Rc,Uh].indexOf(W)>=0,he=se?"width":"height",_e=Bb(e,{placement:Q,boundary:d,rootBoundary:m,altBoundary:b,padding:h}),Ce=se?oe?Vh:Mc:oe?Uh:Rc;U[he]>j[he]&&(Ce=uS(Ce));var me=uS(Ce),xe=[];if(a&&xe.push(_e[W]<=0),o&&xe.push(_e[Ce]<=0,_e[me]<=0),xe.every(function(we){return we})){X=Q,G=!1;break}H.set(Q,xe)}if(G)for(var Ae=E?3:1,De=function(Le){var Fe=O.find(function(Xe){var Be=H.get(Xe);if(Be)return Be.slice(0,Le).every(function(ot){return ot})});if(Fe)return X=Fe,"break"},de=Ae;de>0;de--){var Ee=De(de);if(Ee==="break")break}e.placement!==X&&(e.modifiersData[n]._skip=!0,e.placement=X,e.reset=!0)}}const lfe={name:"flip",enabled:!0,phase:"main",fn:sfe,requiresIfExists:["offset"],data:{_skip:!1}};function BB(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function zB(t){return[Rc,Vh,Uh,Mc].some(function(e){return t[e]>=0})}function ufe(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,s=Bb(e,{elementContext:"reference"}),o=Bb(e,{altBoundary:!0}),c=BB(s,n),h=BB(o,i,a),d=zB(c),m=zB(h);e.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:h,isReferenceHidden:d,hasPopperEscaped:m},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":m})}const cfe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ufe};function hfe(t,e,r){var n=_d(t),i=[Mc,Rc].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[Mc,Vh].indexOf(n)>=0?{x:o,y:s}:{x:s,y:o}}function ffe(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=i===void 0?[0,0]:i,s=HX.reduce(function(d,m){return d[m]=hfe(m,e.rects,a),d},{}),o=s[e.placement],c=o.x,h=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=c,e.modifiersData.popperOffsets.y+=h),e.modifiersData[n]=s}const dfe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:ffe};function pfe(t){var e=t.state,r=t.name;e.modifiersData[r]=JX({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const gfe={name:"popperOffsets",enabled:!0,phase:"read",fn:pfe,data:{}};function mfe(t){return t==="x"?"y":"x"}function yfe(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!1:s,c=r.boundary,h=r.rootBoundary,d=r.altBoundary,m=r.padding,b=r.tether,x=b===void 0?!0:b,E=r.tetherOffset,T=E===void 0?0:E,A=Bb(e,{boundary:c,rootBoundary:h,padding:m,altBoundary:d}),M=_d(e.placement),F=z0(e.placement),N=!F,O=QD(M),U=mfe(O),j=e.modifiersData.popperOffsets,H=e.rects.reference,G=e.rects.popper,X=typeof T=="function"?T(Object.assign({},e.rects,{placement:e.placement})):T,ae=typeof X=="number"?{mainAxis:X,altAxis:X}:Object.assign({mainAxis:0,altAxis:0},X),Q=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,W={x:0,y:0};if(j){if(a){var oe,se=O==="y"?Rc:Mc,he=O==="y"?Uh:Vh,_e=O==="y"?"height":"width",Ce=j[O],me=Ce+A[se],xe=Ce-A[he],Ae=x?-G[_e]/2:0,De=F===L0?H[_e]:G[_e],de=F===L0?-G[_e]:-H[_e],Ee=e.elements.arrow,we=x&&Ee?JD(Ee):{width:0,height:0},Le=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:XX(),Fe=Le[se],Xe=Le[he],Be=ob(0,H[_e],we[_e]),ot=N?H[_e]/2-Ae-Be-Fe-ae.mainAxis:De-Be-Fe-ae.mainAxis,Qe=N?-H[_e]/2+Ae+Be+Xe+ae.mainAxis:de+Be+Xe+ae.mainAxis,rt=e.elements.arrow&&Mx(e.elements.arrow),Re=rt?O==="y"?rt.clientTop||0:rt.clientLeft||0:0,zt=(oe=Q?.[O])!=null?oe:0,st=Ce+ot-zt-Re,$e=Ce+Qe-zt,Jt=ob(x?GS(me,st):me,Ce,x?Lm(xe,$e):xe);j[O]=Jt,W[O]=Jt-Ce}if(o){var Ht,pr=O==="x"?Rc:Mc,_t=O==="x"?Uh:Vh,vr=j[U],br=U==="y"?"height":"width",lr=vr+A[pr],Cr=vr-A[_t],Tr=[Rc,Mc].indexOf(M)!==-1,Qt=(Ht=Q?.[U])!=null?Ht:0,at=Tr?lr:vr-H[br]-G[br]-Qt+ae.altAxis,ke=Tr?vr+H[br]+G[br]-Qt-ae.altAxis:Cr,be=x&&Tr?Uhe(at,vr,ke):ob(x?at:lr,vr,x?ke:Cr);j[U]=be,W[U]=be-vr}e.modifiersData[n]=W}}const vfe={name:"preventOverflow",enabled:!0,phase:"main",fn:yfe,requiresIfExists:["offset"]};function _fe(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function bfe(t){return t===ch(t)||!Lh(t)?eO(t):_fe(t)}function xfe(t){var e=t.getBoundingClientRect(),r=F0(e.width)/t.offsetWidth||1,n=F0(e.height)/t.offsetHeight||1;return r!==1||n!==1}function wfe(t,e,r){r===void 0&&(r=!1);var n=Lh(e),i=Lh(e)&&xfe(e),a=Lg(e),s=B0(t,i,r),o={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!r)&&((Sd(e)!=="body"||rO(a))&&(o=bfe(e)),Lh(e)?(c=B0(e,!0),c.x+=e.clientLeft,c.y+=e.clientTop):a&&(c.x=tO(a))),{x:s.left+o.scrollLeft-c.x,y:s.top+o.scrollTop-c.y,width:s.width,height:s.height}}function Sfe(t){var e=new Map,r=new Set,n=[];t.forEach(function(a){e.set(a.name,a)});function i(a){r.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!r.has(o)){var c=e.get(o);c&&i(c)}}),n.push(a)}return t.forEach(function(a){r.has(a.name)||i(a)}),n}function Efe(t){var e=Sfe(t);return Nhe.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function Tfe(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function Cfe(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var jB={placement:"bottom",modifiers:[],strategy:"absolute"};function UB(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function Afe(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,a=i===void 0?jB:i;return function(o,c,h){h===void 0&&(h=a);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},jB,a),modifiersData:{},elements:{reference:o,popper:c},attributes:{},styles:{}},m=[],b=!1,x={state:d,setOptions:function(M){var F=typeof M=="function"?M(d.options):M;T(),d.options=Object.assign({},a,d.options,F),d.scrollParents={reference:Zm(o)?sb(o):o.contextElement?sb(o.contextElement):[],popper:sb(c)};var N=Efe(Cfe([].concat(n,d.options.modifiers)));return d.orderedModifiers=N.filter(function(O){return O.enabled}),E(),x.update()},forceUpdate:function(){if(!b){var M=d.elements,F=M.reference,N=M.popper;if(UB(F,N)){d.rects={reference:wfe(F,Mx(N),d.options.strategy==="fixed"),popper:JD(N)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(ae){return d.modifiersData[ae.name]=Object.assign({},ae.data)});for(var O=0;O<d.orderedModifiers.length;O++){if(d.reset===!0){d.reset=!1,O=-1;continue}var U=d.orderedModifiers[O],j=U.fn,H=U.options,G=H===void 0?{}:H,X=U.name;typeof j=="function"&&(d=j({state:d,options:G,name:X,instance:x})||d)}}}},update:Tfe(function(){return new Promise(function(A){x.forceUpdate(),A(d)})}),destroy:function(){T(),b=!0}};if(!UB(o,c))return x;x.setOptions(h).then(function(A){!b&&h.onFirstUpdate&&h.onFirstUpdate(A)});function E(){d.orderedModifiers.forEach(function(A){var M=A.name,F=A.options,N=F===void 0?{}:F,O=A.effect;if(typeof O=="function"){var U=O({state:d,name:M,instance:x,options:N}),j=function(){};m.push(U||j)}})}function T(){m.forEach(function(A){return A()}),m=[]}return x}}var Ife=[Khe,gfe,Yhe,Bhe,dfe,lfe,vfe,Hhe,cfe],Pfe=Afe({defaultModifiers:Ife});function ad(t){const{elementType:e,externalSlotProps:r,ownerState:n,skipResolvingSlotProps:i=!1,...a}=t,s=i?{}:VX(r,n),{props:o,internalRef:c}=$X({...a,externalSlotProps:s}),h=Uo(c,s?.ref,t.additionalProps?.ref);return UX(e,{...o,ref:h},n)}function Fg(t){return parseInt(te.version,10)>=19?t?.props?.ref||null:t?.ref||null}function kfe(t){return typeof t=="function"?t():t}const QX=te.forwardRef(function(e,r){const{children:n,container:i,disablePortal:a=!1}=e,[s,o]=te.useState(null),c=Uo(te.isValidElement(n)?Fg(n):null,r);if(Tu(()=>{a||o(kfe(i)||document.body)},[i,a]),Tu(()=>{if(s&&!a)return TB(r,s),()=>{TB(r,null)}},[r,s,a]),a){if(te.isValidElement(n)){const h={ref:c};return te.cloneElement(n,h)}return n}return s&&hp.createPortal(n,s)});function Rfe(t){return gi("MuiPopper",t)}pi("MuiPopper",["root"]);function Mfe(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function Bk(t){return typeof t=="function"?t():t}function Dfe(t){return t.nodeType!==void 0}const Ofe=t=>{const{classes:e}=t;return mi({root:["root"]},Rfe,e)},Nfe={},Lfe=te.forwardRef(function(e,r){const{anchorEl:n,children:i,direction:a,disablePortal:s,modifiers:o,open:c,placement:h,popperOptions:d,popperRef:m,slotProps:b={},slots:x={},TransitionProps:E,ownerState:T,...A}=e,M=te.useRef(null),F=Uo(M,r),N=te.useRef(null),O=Uo(N,m),U=te.useRef(O);Tu(()=>{U.current=O},[O]),te.useImperativeHandle(m,()=>N.current,[]);const j=Mfe(h,a),[H,G]=te.useState(j),[X,ae]=te.useState(Bk(n));te.useEffect(()=>{N.current&&N.current.forceUpdate()}),te.useEffect(()=>{n&&ae(Bk(n))},[n]),Tu(()=>{if(!X||!c)return;const he=me=>{G(me.placement)};let _e=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:me})=>{he(me)}}];o!=null&&(_e=_e.concat(o)),d&&d.modifiers!=null&&(_e=_e.concat(d.modifiers));const Ce=Pfe(X,M.current,{placement:j,...d,modifiers:_e});return U.current(Ce),()=>{Ce.destroy(),U.current(null)}},[X,s,o,c,d,j]);const Q={placement:H};E!==null&&(Q.TransitionProps=E);const W=Ofe(e),oe=x.root??"div",se=ad({elementType:oe,externalSlotProps:b.root,externalForwardedProps:A,additionalProps:{role:"tooltip",ref:F},ownerState:e,className:W.root});return J.jsx(oe,{...se,children:typeof i=="function"?i(Q):i})}),Ffe=te.forwardRef(function(e,r){const{anchorEl:n,children:i,container:a,direction:s="ltr",disablePortal:o=!1,keepMounted:c=!1,modifiers:h,open:d,placement:m="bottom",popperOptions:b=Nfe,popperRef:x,style:E,transition:T=!1,slotProps:A={},slots:M={},...F}=e,[N,O]=te.useState(!0),U=()=>{O(!1)},j=()=>{O(!0)};if(!c&&!d&&(!T||N))return null;let H;if(a)H=a;else if(n){const ae=Bk(n);H=ae&&Dfe(ae)?cs(ae).body:cs(null).body}const G=!d&&c&&(!T||N)?"none":void 0,X=T?{in:d,onEnter:U,onExited:j}:void 0;return J.jsx(QX,{disablePortal:o,container:H,children:J.jsx(Lfe,{anchorEl:n,direction:s,disablePortal:o,modifiers:h,ref:r,open:T?!N:d,placement:m,popperOptions:b,popperRef:x,slotProps:A,slots:M,...F,style:{position:"fixed",top:0,left:0,display:G,...E},TransitionProps:X,children:i})})}),Bfe=Dr(Ffe,{name:"MuiPopper",slot:"Root"})({}),eY=te.forwardRef(function(e,r){const n=kx(),i=bi({props:e,name:"MuiPopper"}),{anchorEl:a,component:s,components:o,componentsProps:c,container:h,disablePortal:d,keepMounted:m,modifiers:b,open:x,placement:E,popperOptions:T,popperRef:A,transition:M,slots:F,slotProps:N,...O}=i,U=F?.root??o?.Root,j={anchorEl:a,container:h,disablePortal:d,keepMounted:m,modifiers:b,open:x,placement:E,popperOptions:T,popperRef:A,transition:M,...O};return J.jsx(Bfe,{as:s,direction:n?"rtl":"ltr",slots:{root:U},slotProps:N??c,...j,ref:r})});function V2(t){return parseInt(t,10)||0}const zfe={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function jfe(t){for(const e in t)return!1;return!0}function VB(t){return jfe(t)||t.outerHeightStyle===0&&!t.overflowing}const Ufe=te.forwardRef(function(e,r){const{onChange:n,maxRows:i,minRows:a=1,style:s,value:o,...c}=e,{current:h}=te.useRef(o!=null),d=te.useRef(null),m=Uo(r,d),b=te.useRef(null),x=te.useRef(null),E=te.useCallback(()=>{const N=d.current,O=x.current;if(!N||!O)return;const j=_c(N).getComputedStyle(N);if(j.width==="0px")return{outerHeightStyle:0,overflowing:!1};O.style.width=j.width,O.value=N.value||e.placeholder||"x",O.value.slice(-1)===`
`&&(O.value+=" ");const H=j.boxSizing,G=V2(j.paddingBottom)+V2(j.paddingTop),X=V2(j.borderBottomWidth)+V2(j.borderTopWidth),ae=O.scrollHeight;O.value="x";const Q=O.scrollHeight;let W=ae;a&&(W=Math.max(Number(a)*Q,W)),i&&(W=Math.min(Number(i)*Q,W)),W=Math.max(W,Q);const oe=W+(H==="border-box"?G+X:0),se=Math.abs(W-ae)<=1;return{outerHeightStyle:oe,overflowing:se}},[i,a,e.placeholder]),T=ou(()=>{const N=d.current,O=E();if(!N||!O||VB(O))return!1;const U=O.outerHeightStyle;return b.current!=null&&b.current!==U}),A=te.useCallback(()=>{const N=d.current,O=E();if(!N||!O||VB(O))return;const U=O.outerHeightStyle;b.current!==U&&(b.current=U,N.style.height=`${U}px`),N.style.overflow=O.overflowing?"hidden":""},[E]),M=te.useRef(-1);Tu(()=>{const N=WD(A),O=d?.current;if(!O)return;const U=_c(O);U.addEventListener("resize",N);let j;return typeof ResizeObserver<"u"&&(j=new ResizeObserver(()=>{T()&&(j.unobserve(O),cancelAnimationFrame(M.current),A(),M.current=requestAnimationFrame(()=>{j.observe(O)}))}),j.observe(O)),()=>{N.clear(),cancelAnimationFrame(M.current),U.removeEventListener("resize",N),j&&j.disconnect()}},[E,A,T]),Tu(()=>{A()});const F=N=>{h||A();const O=N.target,U=O.value.length,j=O.value.endsWith(`
`),H=O.selectionStart===U;j&&H&&O.setSelectionRange(U,U),n&&n(N)};return J.jsxs(te.Fragment,{children:[J.jsx("textarea",{value:o,onChange:F,ref:m,rows:a,style:s,...c}),J.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:x,tabIndex:-1,style:{...zfe.shadow,...s,paddingTop:0,paddingBottom:0}})]})});function Bg({props:t,states:e,muiFormControl:r}){return e.reduce((n,i)=>(n[i]=t[i],r&&typeof t[i]>"u"&&(n[i]=r[i]),n),{})}const nO=te.createContext(void 0);function Pd(){return te.useContext(nO)}function $B(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function XS(t,e=!1){return t&&($B(t.value)&&t.value!==""||e&&$B(t.defaultValue)&&t.defaultValue!=="")}function Vfe(t){return t.startAdornment}function $fe(t){return gi("MuiInputBase",t)}const j0=pi("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var qB;const XT=(t,e)=>{const{ownerState:r}=t;return[e.root,r.formControl&&e.formControl,r.startAdornment&&e.adornedStart,r.endAdornment&&e.adornedEnd,r.error&&e.error,r.size==="small"&&e.sizeSmall,r.multiline&&e.multiline,r.color&&e[`color${cn(r.color)}`],r.fullWidth&&e.fullWidth,r.hiddenLabel&&e.hiddenLabel]},YT=(t,e)=>{const{ownerState:r}=t;return[e.input,r.size==="small"&&e.inputSizeSmall,r.multiline&&e.inputMultiline,r.type==="search"&&e.inputTypeSearch,r.startAdornment&&e.inputAdornedStart,r.endAdornment&&e.inputAdornedEnd,r.hiddenLabel&&e.inputHiddenLabel]},qfe=t=>{const{classes:e,color:r,disabled:n,error:i,endAdornment:a,focused:s,formControl:o,fullWidth:c,hiddenLabel:h,multiline:d,readOnly:m,size:b,startAdornment:x,type:E}=t,T={root:["root",`color${cn(r)}`,n&&"disabled",i&&"error",c&&"fullWidth",s&&"focused",o&&"formControl",b&&b!=="medium"&&`size${cn(b)}`,d&&"multiline",x&&"adornedStart",a&&"adornedEnd",h&&"hiddenLabel",m&&"readOnly"],input:["input",n&&"disabled",E==="search"&&"inputTypeSearch",d&&"inputMultiline",b==="small"&&"inputSizeSmall",h&&"inputHiddenLabel",x&&"inputAdornedStart",a&&"inputAdornedEnd",m&&"readOnly"]};return mi(T,$fe,e)},ZT=Dr("div",{name:"MuiInputBase",slot:"Root",overridesResolver:XT})(ci(({theme:t})=>({...t.typography.body1,color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${j0.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:e})=>e.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:e,size:r})=>e.multiline&&r==="small",style:{paddingTop:1}},{props:({ownerState:e})=>e.fullWidth,style:{width:"100%"}}]}))),KT=Dr("input",{name:"MuiInputBase",slot:"Input",overridesResolver:YT})(ci(({theme:t})=>{const e=t.palette.mode==="light",r={color:"currentColor",...t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5},transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})},n={opacity:"0 !important"},i=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${j0.formControl} &`]:{"&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&::-ms-input-placeholder":n,"&:focus::-webkit-input-placeholder":i,"&:focus::-moz-placeholder":i,"&:focus::-ms-input-placeholder":i},[`&.${j0.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},variants:[{props:({ownerState:a})=>!a.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:a})=>a.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),HB=sce({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),iO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiInputBase"}),{"aria-describedby":i,autoComplete:a,autoFocus:s,className:o,color:c,components:h={},componentsProps:d={},defaultValue:m,disabled:b,disableInjectingGlobalStyles:x,endAdornment:E,error:T,fullWidth:A=!1,id:M,inputComponent:F="input",inputProps:N={},inputRef:O,margin:U,maxRows:j,minRows:H,multiline:G=!1,name:X,onBlur:ae,onChange:Q,onClick:W,onFocus:oe,onKeyDown:se,onKeyUp:he,placeholder:_e,readOnly:Ce,renderSuffix:me,rows:xe,size:Ae,slotProps:De={},slots:de={},startAdornment:Ee,type:we="text",value:Le,...Fe}=n,Xe=N.value!=null?N.value:Le,{current:Be}=te.useRef(Xe!=null),ot=te.useRef(),Qe=te.useCallback(We=>{},[]),rt=Uo(ot,O,N.ref,Qe),[Re,zt]=te.useState(!1),st=Pd(),$e=Bg({props:n,muiFormControl:st,states:["color","disabled","error","hiddenLabel","size","required","filled"]});$e.focused=st?st.focused:Re,te.useEffect(()=>{!st&&b&&Re&&(zt(!1),ae&&ae())},[st,b,Re,ae]);const Jt=st&&st.onFilled,Ht=st&&st.onEmpty,pr=te.useCallback(We=>{XS(We)?Jt&&Jt():Ht&&Ht()},[Jt,Ht]);Tu(()=>{Be&&pr({value:Xe})},[Xe,pr,Be]);const _t=We=>{oe&&oe(We),N.onFocus&&N.onFocus(We),st&&st.onFocus?st.onFocus(We):zt(!0)},vr=We=>{ae&&ae(We),N.onBlur&&N.onBlur(We),st&&st.onBlur?st.onBlur(We):zt(!1)},br=(We,...Lt)=>{if(!Be){const Et=We.target||ot.current;if(Et==null)throw new Error(_p(1));pr({value:Et.value})}N.onChange&&N.onChange(We,...Lt),Q&&Q(We,...Lt)};te.useEffect(()=>{pr(ot.current)},[]);const lr=We=>{ot.current&&We.currentTarget===We.target&&ot.current.focus(),W&&W(We)};let Cr=F,Tr=N;G&&Cr==="input"&&(xe?Tr={type:void 0,minRows:xe,maxRows:xe,...Tr}:Tr={type:void 0,maxRows:j,minRows:H,...Tr},Cr=Ufe);const Qt=We=>{pr(We.animationName==="mui-auto-fill-cancel"?ot.current:{value:"x"})};te.useEffect(()=>{st&&st.setAdornedStart(!!Ee)},[st,Ee]);const at={...n,color:$e.color||"primary",disabled:$e.disabled,endAdornment:E,error:$e.error,focused:$e.focused,formControl:st,fullWidth:A,hiddenLabel:$e.hiddenLabel,multiline:G,size:$e.size,startAdornment:Ee,type:we},ke=qfe(at),be=de.root||h.Root||ZT,je=De.root||d.root||{},qe=de.input||h.Input||KT;return Tr={...Tr,...De.input??d.input},J.jsxs(te.Fragment,{children:[!x&&typeof HB=="function"&&(qB||(qB=J.jsx(HB,{}))),J.jsxs(be,{...je,ref:r,onClick:lr,...Fe,...!vd(be)&&{ownerState:{...at,...je.ownerState}},className:An(ke.root,je.className,o,Ce&&"MuiInputBase-readOnly"),children:[Ee,J.jsx(nO.Provider,{value:null,children:J.jsx(qe,{"aria-invalid":$e.error,"aria-describedby":i,autoComplete:a,autoFocus:s,defaultValue:m,disabled:$e.disabled,id:M,onAnimationStart:Qt,name:X,placeholder:_e,readOnly:Ce,required:$e.required,rows:xe,value:Xe,onKeyDown:se,onKeyUp:he,type:we,...Tr,...!vd(qe)&&{as:Cr,ownerState:{...at,...Tr.ownerState}},ref:rt,className:An(ke.input,Tr.className,Ce&&"MuiInputBase-readOnly"),onBlur:vr,onChange:br,onFocus:_t})}),E,me?me({...$e,startAdornment:Ee}):null]})]})});function Hfe(t){return gi("MuiInput",t)}const e1={...j0,...pi("MuiInput",["root","underline","input"])};function Wfe(t){return gi("MuiOutlinedInput",t)}const ed={...j0,...pi("MuiOutlinedInput",["root","notchedOutline","input"])};function Gfe(t){return gi("MuiFilledInput",t)}const cm={...j0,...pi("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},Xfe=Ji(J.jsx("path",{d:"M7 10l5 5 5-5z"})),Yfe=Ji(J.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function Zfe(t){return gi("MuiAvatar",t)}pi("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const Kfe=t=>{const{classes:e,variant:r,colorDefault:n}=t;return mi({root:["root",r,n&&"colorDefault"],img:["img"],fallback:["fallback"]},Zfe,e)},Jfe=Dr("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],r.colorDefault&&e.colorDefault]}})(ci(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),Qfe=Dr("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),ede=Dr(Yfe,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function tde({crossOrigin:t,referrerPolicy:e,src:r,srcSet:n}){const[i,a]=te.useState(!1);return te.useEffect(()=>{if(!r&&!n)return;a(!1);let s=!0;const o=new Image;return o.onload=()=>{s&&a("loaded")},o.onerror=()=>{s&&a("error")},o.crossOrigin=t,o.referrerPolicy=e,o.src=r,n&&(o.srcset=n),()=>{s=!1}},[t,e,r,n]),i}const tY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAvatar"}),{alt:i,children:a,className:s,component:o="div",slots:c={},slotProps:h={},imgProps:d,sizes:m,src:b,srcSet:x,variant:E="circular",...T}=n;let A=null;const M={...n,component:o,variant:E},F=tde({...d,...typeof h.img=="function"?h.img(M):h.img,src:b,srcSet:x}),N=b||x,O=N&&F!=="error";M.colorDefault=!O,delete M.ownerState;const U=Kfe(M),[j,H]=Ei("root",{ref:r,className:An(U.root,s),elementType:Jfe,externalForwardedProps:{slots:c,slotProps:h,component:o,...T},ownerState:M}),[G,X]=Ei("img",{className:U.img,elementType:Qfe,externalForwardedProps:{slots:c,slotProps:{img:{...d,...h.img}}},additionalProps:{alt:i,src:b,srcSet:x,sizes:m},ownerState:M}),[ae,Q]=Ei("fallback",{className:U.fallback,elementType:ede,externalForwardedProps:{slots:c,slotProps:h},shouldForwardComponentProp:!0,ownerState:M});return O?A=J.jsx(G,{...X}):a||a===0?A=a:N&&i?A=i[0]:A=J.jsx(ae,{...Q}),J.jsx(j,{...H,children:A})}),rde={entering:{opacity:1},entered:{opacity:1}},zk=te.forwardRef(function(e,r){const n=Lc(),i={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:a,appear:s=!0,children:o,easing:c,in:h,onEnter:d,onEntered:m,onEntering:b,onExit:x,onExited:E,onExiting:T,style:A,timeout:M=i,TransitionComponent:F=Kh,...N}=e,O=te.useRef(null),U=Uo(O,Fg(o),r),j=se=>he=>{if(se){const _e=O.current;he===void 0?se(_e):se(_e,he)}},H=j(b),G=j((se,he)=>{YD(se);const _e=xp({style:A,timeout:M,easing:c},{mode:"enter"});se.style.webkitTransition=n.transitions.create("opacity",_e),se.style.transition=n.transitions.create("opacity",_e),d&&d(se,he)}),X=j(m),ae=j(T),Q=j(se=>{const he=xp({style:A,timeout:M,easing:c},{mode:"exit"});se.style.webkitTransition=n.transitions.create("opacity",he),se.style.transition=n.transitions.create("opacity",he),x&&x(se)}),W=j(E),oe=se=>{a&&a(O.current,se)};return J.jsx(F,{appear:s,in:h,nodeRef:O,onEnter:G,onEntered:X,onEntering:H,onExit:Q,onExited:W,onExiting:ae,addEndListener:oe,timeout:M,...N,children:(se,{ownerState:he,..._e})=>te.cloneElement(o,{style:{opacity:0,visibility:se==="exited"&&!h?"hidden":void 0,...rde[se],...A,...o.props.style},ref:U,..._e})})});function nde(t){return gi("MuiBackdrop",t)}pi("MuiBackdrop",["root","invisible"]);const ide=t=>{const{classes:e,invisible:r}=t;return mi({root:["root",r&&"invisible"]},nde,e)},ade=Dr("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.invisible&&e.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),rY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiBackdrop"}),{children:i,className:a,component:s="div",invisible:o=!1,open:c,components:h={},componentsProps:d={},slotProps:m={},slots:b={},TransitionComponent:x,transitionDuration:E,...T}=n,A={...n,component:s,invisible:o},M=ide(A),F={transition:x,root:h.Root,...b},N={...d,...m},O={component:s,slots:F,slotProps:N},[U,j]=Ei("root",{elementType:ade,externalForwardedProps:O,className:An(M.root,a),ownerState:A}),[H,G]=Ei("transition",{elementType:zk,externalForwardedProps:O,ownerState:A});return J.jsx(H,{in:c,timeout:E,...T,...G,children:J.jsx(U,{"aria-hidden":!0,...j,classes:M,ref:r,children:i})})}),ode=pi("MuiBox",["root"]),sde=c_(),Bo=fX({themeId:Sf,defaultTheme:sde,defaultClassName:ode.root,generateClassName:BD.generate});function lde(t){return gi("MuiButton",t)}const hm=pi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),nY=te.createContext({}),iY=te.createContext(void 0),ude=t=>{const{color:e,disableElevation:r,fullWidth:n,size:i,variant:a,loading:s,loadingPosition:o,classes:c}=t,h={root:["root",s&&"loading",a,`${a}${cn(e)}`,`size${cn(i)}`,`${a}Size${cn(i)}`,`color${cn(e)}`,r&&"disableElevation",n&&"fullWidth",s&&`loadingPosition${cn(o)}`],startIcon:["icon","startIcon",`iconSize${cn(i)}`],endIcon:["icon","endIcon",`iconSize${cn(i)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},d=mi(h,lde,c);return{...c,...d}},aY=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],cde=Dr(h_,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`${r.variant}${cn(r.color)}`],e[`size${cn(r.size)}`],e[`${r.variant}Size${cn(r.size)}`],r.color==="inherit"&&e.colorInherit,r.disableElevation&&e.disableElevation,r.fullWidth&&e.fullWidth,r.loading&&e.loading]}})(ci(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],r=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${hm.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${hm.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${hm.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${hm.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(jl()).map(([n])=>({props:{color:n},style:{"--variant-textColor":(t.vars||t).palette[n].main,"--variant-outlinedColor":(t.vars||t).palette[n].main,"--variant-outlinedBorder":t.alpha((t.vars||t).palette[n].main,.5),"--variant-containedColor":(t.vars||t).palette[n].contrastText,"--variant-containedBg":(t.vars||t).palette[n].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[n].dark,"--variant-textBg":t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[n].main,"--variant-outlinedBg":t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:e,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:r,"--variant-textBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${hm.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${hm.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${hm.loading}`]:{color:"transparent"}}}]}})),hde=Dr("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.startIcon,r.loading&&e.startIconLoadingStart,e[`iconSize${cn(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...aY]})),fde=Dr("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.endIcon,r.loading&&e.endIconLoadingEnd,e[`iconSize${cn(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...aY]})),dde=Dr("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),WB=Dr("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),ta=te.forwardRef(function(e,r){const n=te.useContext(nY),i=te.useContext(iY),a=Ob(n,e),s=bi({props:a,name:"MuiButton"}),{children:o,color:c="primary",component:h="button",className:d,disabled:m=!1,disableElevation:b=!1,disableFocusRipple:x=!1,endIcon:E,focusVisibleClassName:T,fullWidth:A=!1,id:M,loading:F=null,loadingIndicator:N,loadingPosition:O="center",size:U="medium",startIcon:j,type:H,variant:G="text",...X}=s,ae=Og(M),Q=N??J.jsx(WT,{"aria-labelledby":ae,color:"inherit",size:16}),W={...s,color:c,component:h,disabled:m,disableElevation:b,disableFocusRipple:x,fullWidth:A,loading:F,loadingIndicator:Q,loadingPosition:O,size:U,type:H,variant:G},oe=ude(W),se=(j||F&&O==="start")&&J.jsx(hde,{className:oe.startIcon,ownerState:W,children:j||J.jsx(WB,{className:oe.loadingIconPlaceholder,ownerState:W})}),he=(E||F&&O==="end")&&J.jsx(fde,{className:oe.endIcon,ownerState:W,children:E||J.jsx(WB,{className:oe.loadingIconPlaceholder,ownerState:W})}),_e=i||"",Ce=typeof F=="boolean"?J.jsx("span",{className:oe.loadingWrapper,style:{display:"contents"},children:F&&J.jsx(dde,{className:oe.loadingIndicator,ownerState:W,children:Q})}):null;return J.jsxs(cde,{ownerState:W,className:An(n.className,oe.root,d,_e),component:h,disabled:m||F,focusRipple:!x,focusVisibleClassName:An(oe.focusVisible,T),ref:r,type:H,id:F?ae:M,...X,classes:oe,children:[se,O!=="end"&&Ce,o,O==="end"&&Ce,he]})});function pde(t){return te.Children.toArray(t).filter(e=>te.isValidElement(e))}function gde(t){return gi("MuiButtonGroup",t)}const ea=pi("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),mde=(t,e)=>{const{ownerState:r}=t;return[{[`& .${ea.grouped}`]:e.grouped},{[`& .${ea.grouped}`]:e[`grouped${cn(r.orientation)}`]},{[`& .${ea.grouped}`]:e[`grouped${cn(r.variant)}`]},{[`& .${ea.grouped}`]:e[`grouped${cn(r.variant)}${cn(r.orientation)}`]},{[`& .${ea.grouped}`]:e[`grouped${cn(r.variant)}${cn(r.color)}`]},{[`& .${ea.firstButton}`]:e.firstButton},{[`& .${ea.lastButton}`]:e.lastButton},{[`& .${ea.middleButton}`]:e.middleButton},e.root,e[r.variant],r.disableElevation===!0&&e.disableElevation,r.fullWidth&&e.fullWidth,r.orientation==="vertical"&&e.vertical]},yde=t=>{const{classes:e,color:r,disabled:n,disableElevation:i,fullWidth:a,orientation:s,variant:o}=t,c={root:["root",o,s,a&&"fullWidth",i&&"disableElevation",`color${cn(r)}`],grouped:["grouped",`grouped${cn(s)}`,`grouped${cn(o)}`,`grouped${cn(o)}${cn(s)}`,`grouped${cn(o)}${cn(r)}`,n&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return mi(c,gde,e)},vde=Dr("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:mde})(ci(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(t.vars||t).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${ea.lastButton},& .${ea.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${ea.lastButton},& .${ea.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderRight:t.vars?`1px solid ${t.alpha(t.vars.palette.common.onBackground,.23)}`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${ea.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottom:t.vars?`1px solid ${t.alpha(t.vars.palette.common.onBackground,.23)}`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${ea.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(jl()).flatMap(([e])=>[{props:{variant:"text",color:e},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderColor:t.alpha((t.vars||t).palette[e].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${ea.lastButton},& .${ea.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${ea.lastButton},& .${ea.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${ea.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${ea.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(jl(["dark"])).map(([e])=>({props:{variant:"contained",color:e},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderColor:(t.vars||t).palette[e].dark}}}))],[`& .${ea.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),jk=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiButtonGroup"}),{children:i,className:a,color:s="primary",component:o="div",disabled:c=!1,disableElevation:h=!1,disableFocusRipple:d=!1,disableRipple:m=!1,fullWidth:b=!1,orientation:x="horizontal",size:E="medium",variant:T="outlined",...A}=n,M={...n,color:s,component:o,disabled:c,disableElevation:h,disableFocusRipple:d,disableRipple:m,fullWidth:b,orientation:x,size:E,variant:T},F=yde(M),N=te.useMemo(()=>({className:F.grouped,color:s,disabled:c,disableElevation:h,disableFocusRipple:d,disableRipple:m,fullWidth:b,size:E,variant:T}),[s,c,h,d,m,b,E,T,F.grouped]),O=pde(i),U=O.length,j=H=>{const G=H===0,X=H===U-1;return G&&X?"":G?F.firstButton:X?F.lastButton:F.middleButton};return J.jsx(vde,{as:o,role:"group",className:An(F.root,a),ref:r,ownerState:M,...A,children:J.jsx(nY.Provider,{value:N,children:O.map((H,G)=>J.jsx(iY.Provider,{value:j(G),children:H},G))})})});function _de(t){return gi("PrivateSwitchBase",t)}pi("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const bde=t=>{const{classes:e,checked:r,disabled:n,edge:i}=t,a={root:["root",r&&"checked",n&&"disabled",i&&`edge${cn(i)}`],input:["input"]};return mi(a,_de,e)},xde=Dr(h_,{name:"MuiSwitchBase"})({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:t,ownerState:e})=>t==="start"&&e.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:t,ownerState:e})=>t==="end"&&e.size!=="small",style:{marginRight:-12}}]}),wde=Dr("input",{name:"MuiSwitchBase",shouldForwardProp:Al})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),oY=te.forwardRef(function(e,r){const{autoFocus:n,checked:i,checkedIcon:a,defaultChecked:s,disabled:o,disableFocusRipple:c=!1,edge:h=!1,icon:d,id:m,inputProps:b,inputRef:x,name:E,onBlur:T,onChange:A,onFocus:M,readOnly:F,required:N=!1,tabIndex:O,type:U,value:j,slots:H={},slotProps:G={},...X}=e,[ae,Q]=Ym({controlled:i,default:!!s,name:"SwitchBase",state:"checked"}),W=Pd(),oe=Le=>{M&&M(Le),W&&W.onFocus&&W.onFocus(Le)},se=Le=>{T&&T(Le),W&&W.onBlur&&W.onBlur(Le)},he=Le=>{if(Le.nativeEvent.defaultPrevented)return;const Fe=Le.target.checked;Q(Fe),A&&A(Le,Fe)};let _e=o;W&&typeof _e>"u"&&(_e=W.disabled);const Ce=U==="checkbox"||U==="radio",me={...e,checked:ae,disabled:_e,disableFocusRipple:c,edge:h},xe=bde(me),Ae={slots:H,slotProps:{input:b,...G}},[De,de]=Ei("root",{ref:r,elementType:xde,className:xe.root,shouldForwardComponentProp:!0,externalForwardedProps:{...Ae,component:"span",...X},getSlotProps:Le=>({...Le,onFocus:Fe=>{Le.onFocus?.(Fe),oe(Fe)},onBlur:Fe=>{Le.onBlur?.(Fe),se(Fe)}}),ownerState:me,additionalProps:{centerRipple:!0,focusRipple:!c,disabled:_e,role:void 0,tabIndex:null}}),[Ee,we]=Ei("input",{ref:x,elementType:wde,className:xe.input,externalForwardedProps:Ae,getSlotProps:Le=>({...Le,onChange:Fe=>{Le.onChange?.(Fe),he(Fe)}}),ownerState:me,additionalProps:{autoFocus:n,checked:i,defaultChecked:s,disabled:_e,id:Ce?m:void 0,name:E,readOnly:F,required:N,tabIndex:O,type:U,...U==="checkbox"&&j===void 0?{}:{value:j}}});return J.jsxs(De,{...de,children:[J.jsx(Ee,{...we}),ae?a:d]})}),Sde=Ji(J.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),Ede=Ji(J.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),Tde=Ji(J.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}));function Cde(t){return gi("MuiCheckbox",t)}const dA=pi("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Ade=t=>{const{classes:e,indeterminate:r,color:n,size:i}=t,a={root:["root",r&&"indeterminate",`color${cn(n)}`,`size${cn(i)}`]},s=mi(a,Cde,e);return{...e,...s}},Ide=Dr(oY,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.indeterminate&&e.indeterminate,e[`size${cn(r.size)}`],r.color!=="default"&&e[`color${cn(r.color)}`]]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{[`&.${dA.checked}, &.${dA.indeterminate}`]:{color:(t.vars||t).palette[e].main},[`&.${dA.disabled}`]:{color:(t.vars||t).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),Pde=J.jsx(Ede,{}),kde=J.jsx(Sde,{}),Rde=J.jsx(Tde,{}),U0=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiCheckbox"}),{checkedIcon:i=Pde,color:a="primary",icon:s=kde,indeterminate:o=!1,indeterminateIcon:c=Rde,inputProps:h,size:d="medium",disableRipple:m=!1,className:b,slots:x={},slotProps:E={},...T}=n,A=o?c:s,M=o?c:i,F={...n,disableRipple:m,color:a,indeterminate:o,size:d},N=Ade(F),O=E.input??h,[U,j]=Ei("root",{ref:r,elementType:Ide,className:An(N.root,b),shouldForwardComponentProp:!0,externalForwardedProps:{slots:x,slotProps:E,...T},ownerState:F,additionalProps:{type:"checkbox",icon:te.cloneElement(A,{fontSize:A.props.fontSize??d}),checkedIcon:te.cloneElement(M,{fontSize:M.props.fontSize??d}),disableRipple:m,slots:x,slotProps:{input:Lb(typeof O=="function"?O(F):O,{"data-indeterminate":o})}}});return J.jsx(U,{...j,classes:N})});function GB(t){return t.substring(2).toLowerCase()}function Mde(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function Dde(t){const{children:e,disableReactTree:r=!1,mouseEvent:n="onClick",onClickAway:i,touchEvent:a="onTouchEnd"}=t,s=te.useRef(!1),o=te.useRef(null),c=te.useRef(!1),h=te.useRef(!1);te.useEffect(()=>(setTimeout(()=>{c.current=!0},0),()=>{c.current=!1}),[]);const d=Uo(Fg(e),o),m=ou(E=>{const T=h.current;h.current=!1;const A=cs(o.current);if(!c.current||!o.current||"clientX"in E&&Mde(E,A))return;if(s.current){s.current=!1;return}let M;E.composedPath?M=E.composedPath().includes(o.current):M=!A.documentElement.contains(E.target)||o.current.contains(E.target),!M&&(r||!T)&&i(E)}),b=E=>T=>{h.current=!0;const A=e.props[E];A&&A(T)},x={ref:d};return a!==!1&&(x[a]=b(a)),te.useEffect(()=>{if(a!==!1){const E=GB(a),T=cs(o.current),A=()=>{s.current=!0};return T.addEventListener(E,m),T.addEventListener("touchmove",A),()=>{T.removeEventListener(E,m),T.removeEventListener("touchmove",A)}}},[m,a]),n!==!1&&(x[n]=b(n)),te.useEffect(()=>{if(n!==!1){const E=GB(n),T=cs(o.current);return T.addEventListener(E,m),()=>{T.removeEventListener(E,m)}}},[m,n]),te.cloneElement(e,x)}function sY(t=window){const e=t.document.documentElement.clientWidth;return t.innerWidth-e}function Ode(t){const e=cs(t);return e.body===t?_c(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function lb(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function XB(t){return parseInt(_c(t).getComputedStyle(t).paddingRight,10)||0}function Nde(t){const r=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(t.tagName),n=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return r||n}function YB(t,e,r,n,i){const a=[e,r,...n];[].forEach.call(t.children,s=>{const o=!a.includes(s),c=!Nde(s);o&&c&&lb(s,i)})}function pA(t,e){let r=-1;return t.some((n,i)=>e(n)?(r=i,!0):!1),r}function Lde(t,e){const r=[],n=t.container;if(!e.disableScrollLock){if(Ode(n)){const s=sY(_c(n));r.push({value:n.style.paddingRight,property:"padding-right",el:n}),n.style.paddingRight=`${XB(n)+s}px`;const o=cs(n).querySelectorAll(".mui-fixed");[].forEach.call(o,c=>{r.push({value:c.style.paddingRight,property:"padding-right",el:c}),c.style.paddingRight=`${XB(c)+s}px`})}let a;if(n.parentNode instanceof DocumentFragment)a=cs(n).body;else{const s=n.parentElement,o=_c(n);a=s?.nodeName==="HTML"&&o.getComputedStyle(s).overflowY==="scroll"?s:n}r.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return()=>{r.forEach(({value:a,el:s,property:o})=>{a?s.style.setProperty(o,a):s.style.removeProperty(o)})}}function Fde(t){const e=[];return[].forEach.call(t.children,r=>{r.getAttribute("aria-hidden")==="true"&&e.push(r)}),e}class Bde{constructor(){this.modals=[],this.containers=[]}add(e,r){let n=this.modals.indexOf(e);if(n!==-1)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&lb(e.modalRef,!1);const i=Fde(r);YB(r,e.mount,e.modalRef,i,!0);const a=pA(this.containers,s=>s.container===r);return a!==-1?(this.containers[a].modals.push(e),n):(this.containers.push({modals:[e],container:r,restore:null,hiddenSiblings:i}),n)}mount(e,r){const n=pA(this.containers,a=>a.modals.includes(e)),i=this.containers[n];i.restore||(i.restore=Lde(i,r))}remove(e,r=!0){const n=this.modals.indexOf(e);if(n===-1)return n;const i=pA(this.containers,s=>s.modals.includes(e)),a=this.containers[i];if(a.modals.splice(a.modals.indexOf(e),1),this.modals.splice(n,1),a.modals.length===0)a.restore&&a.restore(),e.modalRef&&lb(e.modalRef,r),YB(a.container,e.mount,e.modalRef,a.hiddenSiblings,!1),this.containers.splice(i,1);else{const s=a.modals[a.modals.length-1];s.modalRef&&lb(s.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const zde=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function jde(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function Ude(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=n=>t.ownerDocument.querySelector(`input[type="radio"]${n}`);let r=e(`[name="${t.name}"]:checked`);return r||(r=e(`[name="${t.name}"]`)),r!==t}function Vde(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||Ude(t))}function $de(t){const e=[],r=[];return Array.from(t.querySelectorAll(zde)).forEach((n,i)=>{const a=jde(n);a===-1||!Vde(n)||(a===0?e.push(n):r.push({documentOrder:i,tabIndex:a,node:n}))}),r.sort((n,i)=>n.tabIndex===i.tabIndex?n.documentOrder-i.documentOrder:n.tabIndex-i.tabIndex).map(n=>n.node).concat(e)}function qde(){return!0}function Hde(t){const{children:e,disableAutoFocus:r=!1,disableEnforceFocus:n=!1,disableRestoreFocus:i=!1,getTabbable:a=$de,isEnabled:s=qde,open:o}=t,c=te.useRef(!1),h=te.useRef(null),d=te.useRef(null),m=te.useRef(null),b=te.useRef(null),x=te.useRef(!1),E=te.useRef(null),T=Uo(Fg(e),E),A=te.useRef(null);te.useEffect(()=>{!o||!E.current||(x.current=!r)},[r,o]),te.useEffect(()=>{if(!o||!E.current)return;const N=cs(E.current);return E.current.contains(N.activeElement)||(E.current.hasAttribute("tabIndex")||E.current.setAttribute("tabIndex","-1"),x.current&&E.current.focus()),()=>{i||(m.current&&m.current.focus&&(c.current=!0,m.current.focus()),m.current=null)}},[o]),te.useEffect(()=>{if(!o||!E.current)return;const N=cs(E.current),O=H=>{A.current=H,!(n||!s()||H.key!=="Tab")&&N.activeElement===E.current&&H.shiftKey&&(c.current=!0,d.current&&d.current.focus())},U=()=>{const H=E.current;if(H===null)return;if(!N.hasFocus()||!s()||c.current){c.current=!1;return}if(H.contains(N.activeElement)||n&&N.activeElement!==h.current&&N.activeElement!==d.current)return;if(N.activeElement!==b.current)b.current=null;else if(b.current!==null)return;if(!x.current)return;let G=[];if((N.activeElement===h.current||N.activeElement===d.current)&&(G=a(E.current)),G.length>0){const X=!!(A.current?.shiftKey&&A.current?.key==="Tab"),ae=G[0],Q=G[G.length-1];typeof ae!="string"&&typeof Q!="string"&&(X?Q.focus():ae.focus())}else H.focus()};N.addEventListener("focusin",U),N.addEventListener("keydown",O,!0);const j=setInterval(()=>{N.activeElement&&N.activeElement.tagName==="BODY"&&U()},50);return()=>{clearInterval(j),N.removeEventListener("focusin",U),N.removeEventListener("keydown",O,!0)}},[r,n,i,s,o,a]);const M=N=>{m.current===null&&(m.current=N.relatedTarget),x.current=!0,b.current=N.target;const O=e.props.onFocus;O&&O(N)},F=N=>{m.current===null&&(m.current=N.relatedTarget),x.current=!0};return J.jsxs(te.Fragment,{children:[J.jsx("div",{tabIndex:o?0:-1,onFocus:F,ref:h,"data-testid":"sentinelStart"}),te.cloneElement(e,{ref:T,onFocus:M}),J.jsx("div",{tabIndex:o?0:-1,onFocus:F,ref:d,"data-testid":"sentinelEnd"})]})}function Wde(t){return typeof t=="function"?t():t}function Gde(t){return t?t.props.hasOwnProperty("in"):!1}const ZB=()=>{},$2=new Bde;function Xde(t){const{container:e,disableEscapeKeyDown:r=!1,disableScrollLock:n=!1,closeAfterTransition:i=!1,onTransitionEnter:a,onTransitionExited:s,children:o,onClose:c,open:h,rootRef:d}=t,m=te.useRef({}),b=te.useRef(null),x=te.useRef(null),E=Uo(x,d),[T,A]=te.useState(!h),M=Gde(o);let F=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(F=!1);const N=()=>cs(b.current),O=()=>(m.current.modalRef=x.current,m.current.mount=b.current,m.current),U=()=>{$2.mount(O(),{disableScrollLock:n}),x.current&&(x.current.scrollTop=0)},j=ou(()=>{const he=Wde(e)||N().body;$2.add(O(),he),x.current&&U()}),H=()=>$2.isTopModal(O()),G=ou(he=>{b.current=he,he&&(h&&H()?U():x.current&&lb(x.current,F))}),X=te.useCallback(()=>{$2.remove(O(),F)},[F]);te.useEffect(()=>()=>{X()},[X]),te.useEffect(()=>{h?j():(!M||!i)&&X()},[h,X,M,i,j]);const ae=he=>_e=>{he.onKeyDown?.(_e),!(_e.key!=="Escape"||_e.which===229||!H())&&(r||(_e.stopPropagation(),c&&c(_e,"escapeKeyDown")))},Q=he=>_e=>{he.onClick?.(_e),_e.target===_e.currentTarget&&c&&c(_e,"backdropClick")};return{getRootProps:(he={})=>{const _e=Nm(t);delete _e.onTransitionEnter,delete _e.onTransitionExited;const Ce={..._e,...he};return{role:"presentation",...Ce,onKeyDown:ae(Ce),ref:E}},getBackdropProps:(he={})=>{const _e=he;return{"aria-hidden":!0,..._e,onClick:Q(_e),open:h}},getTransitionProps:()=>{const he=()=>{A(!1),a&&a()},_e=()=>{A(!0),s&&s(),i&&X()};return{onEnter:Ik(he,o?.props.onEnter??ZB),onExited:Ik(_e,o?.props.onExited??ZB)}},rootRef:E,portalRef:G,isTopModal:H,exited:T,hasTransition:M}}function Yde(t){return gi("MuiModal",t)}pi("MuiModal",["root","hidden","backdrop"]);const Zde=t=>{const{open:e,exited:r,classes:n}=t;return mi({root:["root",!e&&r&&"hidden"],backdrop:["backdrop"]},Yde,n)},Kde=Dr("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.open&&r.exited&&e.hidden]}})(ci(({theme:t})=>({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),Jde=Dr(rY,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),aO=te.forwardRef(function(e,r){const n=bi({name:"MuiModal",props:e}),{BackdropComponent:i=Jde,BackdropProps:a,classes:s,className:o,closeAfterTransition:c=!1,children:h,container:d,component:m,components:b={},componentsProps:x={},disableAutoFocus:E=!1,disableEnforceFocus:T=!1,disableEscapeKeyDown:A=!1,disablePortal:M=!1,disableRestoreFocus:F=!1,disableScrollLock:N=!1,hideBackdrop:O=!1,keepMounted:U=!1,onClose:j,onTransitionEnter:H,onTransitionExited:G,open:X,slotProps:ae={},slots:Q={},theme:W,...oe}=n,se={...n,closeAfterTransition:c,disableAutoFocus:E,disableEnforceFocus:T,disableEscapeKeyDown:A,disablePortal:M,disableRestoreFocus:F,disableScrollLock:N,hideBackdrop:O,keepMounted:U},{getRootProps:he,getBackdropProps:_e,getTransitionProps:Ce,portalRef:me,isTopModal:xe,exited:Ae,hasTransition:De}=Xde({...se,rootRef:r}),de={...se,exited:Ae},Ee=Zde(de),we={};if(h.props.tabIndex===void 0&&(we.tabIndex="-1"),De){const{onEnter:Qe,onExited:rt}=Ce();we.onEnter=Qe,we.onExited=rt}const Le={slots:{root:b.Root,backdrop:b.Backdrop,...Q},slotProps:{...x,...ae}},[Fe,Xe]=Ei("root",{ref:r,elementType:Kde,externalForwardedProps:{...Le,...oe,component:m},getSlotProps:he,ownerState:de,className:An(o,Ee?.root,!de.open&&de.exited&&Ee?.hidden)}),[Be,ot]=Ei("backdrop",{ref:a?.ref,elementType:i,externalForwardedProps:Le,shouldForwardComponentProp:!0,additionalProps:a,getSlotProps:Qe=>_e({...Qe,onClick:rt=>{Qe?.onClick&&Qe.onClick(rt)}}),className:An(a?.className,Ee?.backdrop),ownerState:de});return!U&&!X&&(!De||Ae)?null:J.jsx(QX,{ref:me,container:d,disablePortal:M,children:J.jsxs(Fe,{...Xe,children:[!O&&i?J.jsx(Be,{...ot}):null,J.jsx(Hde,{disableEnforceFocus:T,disableAutoFocus:E,disableRestoreFocus:F,isEnabled:xe,open:X,children:te.cloneElement(h,we)})]})})});function Qde(t){return gi("MuiDialog",t)}const gA=pi("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),lY=te.createContext({}),epe=Dr(rY,{name:"MuiDialog",slot:"Backdrop",overrides:(t,e)=>e.backdrop})({zIndex:-1}),tpe=t=>{const{classes:e,scroll:r,maxWidth:n,fullWidth:i,fullScreen:a}=t,s={root:["root"],container:["container",`scroll${cn(r)}`],paper:["paper",`paperScroll${cn(r)}`,`paperWidth${cn(String(n))}`,i&&"paperFullWidth",a&&"paperFullScreen"]};return mi(s,Qde,e)},rpe=Dr(aO,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),npe=Dr("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.container,e[`scroll${cn(r.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),ipe=Dr(uh,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`scrollPaper${cn(r.scroll)}`],e[`paperWidth${cn(String(r.maxWidth))}`],r.fullWidth&&e.paperFullWidth,r.fullScreen&&e.paperFullScreen]}})(ci(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${gA.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(e=>e!=="xs").map(e=>({props:{maxWidth:e},style:{maxWidth:`${t.breakpoints.values[e]}${t.breakpoints.unit}`,[`&.${gA.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[e]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${gA.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),oO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialog"}),i=Lc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{"aria-describedby":s,"aria-labelledby":o,"aria-modal":c=!0,BackdropComponent:h,BackdropProps:d,children:m,className:b,disableEscapeKeyDown:x=!1,fullScreen:E=!1,fullWidth:T=!1,maxWidth:A="sm",onClick:M,onClose:F,open:N,PaperComponent:O=uh,PaperProps:U={},scroll:j="paper",slots:H={},slotProps:G={},TransitionComponent:X=zk,transitionDuration:ae=a,TransitionProps:Q,...W}=n,oe={...n,disableEscapeKeyDown:x,fullScreen:E,fullWidth:T,maxWidth:A,scroll:j},se=tpe(oe),he=te.useRef(),_e=zt=>{he.current=zt.target===zt.currentTarget},Ce=zt=>{M&&M(zt),he.current&&(he.current=null,F&&F(zt,"backdropClick"))},me=Og(o),xe=te.useMemo(()=>({titleId:me}),[me]),Ae={transition:X,...H},De={transition:Q,paper:U,backdrop:d,...G},de={slots:Ae,slotProps:De},[Ee,we]=Ei("root",{elementType:rpe,shouldForwardComponentProp:!0,externalForwardedProps:de,ownerState:oe,className:An(se.root,b),ref:r}),[Le,Fe]=Ei("backdrop",{elementType:epe,shouldForwardComponentProp:!0,externalForwardedProps:de,ownerState:oe}),[Xe,Be]=Ei("paper",{elementType:ipe,shouldForwardComponentProp:!0,externalForwardedProps:de,ownerState:oe,className:An(se.paper,U.className)}),[ot,Qe]=Ei("container",{elementType:npe,externalForwardedProps:de,ownerState:oe,className:se.container}),[rt,Re]=Ei("transition",{elementType:zk,externalForwardedProps:de,ownerState:oe,additionalProps:{appear:!0,in:N,timeout:ae,role:"presentation"}});return J.jsx(Ee,{closeAfterTransition:!0,slots:{backdrop:Le},slotProps:{backdrop:{transitionDuration:ae,as:h,...Fe}},disableEscapeKeyDown:x,onClose:F,open:N,onClick:Ce,...we,...W,children:J.jsx(rt,{...Re,children:J.jsx(ot,{onMouseDown:_e,...Qe,children:J.jsx(Xe,{as:O,elevation:24,role:"dialog","aria-describedby":s,"aria-labelledby":me,"aria-modal":c,...Be,children:J.jsx(lY.Provider,{value:xe,children:m})})})})})});function ape(t){return gi("MuiDialogActions",t)}pi("MuiDialogActions",["root","spacing"]);const ope=t=>{const{classes:e,disableSpacing:r}=t;return mi({root:["root",!r&&"spacing"]},ape,e)},spe=Dr("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableSpacing&&e.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:t})=>!t.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Dx=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogActions"}),{className:i,disableSpacing:a=!1,...s}=n,o={...n,disableSpacing:a},c=ope(o);return J.jsx(spe,{className:An(c.root,i),ownerState:o,ref:r,...s})});function lpe(t){return gi("MuiDialogContent",t)}pi("MuiDialogContent",["root","dividers"]);function upe(t){return gi("MuiDialogTitle",t)}const cpe=pi("MuiDialogTitle",["root"]),hpe=t=>{const{classes:e,dividers:r}=t;return mi({root:["root",r&&"dividers"]},lpe,e)},fpe=Dr("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.dividers&&e.dividers]}})(ci(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:e})=>e.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>!e.dividers,style:{[`.${cpe.root} + &`]:{paddingTop:0}}}]}))),sO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogContent"}),{className:i,dividers:a=!1,...s}=n,o={...n,dividers:a},c=hpe(o);return J.jsx(fpe,{className:An(c.root,i),ownerState:o,ref:r,...s})});function dpe(t){return gi("MuiDialogContentText",t)}pi("MuiDialogContentText",["root"]);const ppe=t=>{const{classes:e}=t,n=mi({root:["root"]},dpe,e);return{...e,...n}},gpe=Dr(Ss,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiDialogContentText",slot:"Root"})({}),mpe=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogContentText"}),{children:i,className:a,...s}=n,o=ppe(s);return J.jsx(gpe,{component:"p",variant:"body1",color:"textSecondary",ref:r,ownerState:s,className:An(o.root,a),...n,classes:o})}),ype=t=>{const{classes:e}=t;return mi({root:["root"]},upe,e)},vpe=Dr(Ss,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),by=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogTitle"}),{className:i,id:a,...s}=n,o=n,c=ype(o),{titleId:h=a}=te.useContext(lY);return J.jsx(vpe,{component:"h2",className:An(c.root,i),ownerState:o,ref:r,variant:"h6",id:a??h,...s})});function _pe(t){return gi("MuiDivider",t)}const KB=pi("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),bpe=t=>{const{absolute:e,children:r,classes:n,flexItem:i,light:a,orientation:s,textAlign:o,variant:c}=t;return mi({root:["root",e&&"absolute",c,a&&"light",s==="vertical"&&"vertical",i&&"flexItem",r&&"withChildren",r&&s==="vertical"&&"withChildrenVertical",o==="right"&&s!=="vertical"&&"textAlignRight",o==="left"&&s!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",s==="vertical"&&"wrapperVertical"]},_pe,n)},xpe=Dr("div",{name:"MuiDivider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.absolute&&e.absolute,e[r.variant],r.light&&e.light,r.orientation==="vertical"&&e.vertical,r.flexItem&&e.flexItem,r.children&&e.withChildren,r.children&&r.orientation==="vertical"&&e.withChildrenVertical,r.textAlign==="right"&&r.orientation!=="vertical"&&e.textAlignRight,r.textAlign==="left"&&r.orientation!=="vertical"&&e.textAlignLeft]}})(ci(({theme:t})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:t.alpha((t.vars||t).palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:t.spacing(1),marginBottom:t.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:e})=>!!e.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:e})=>e.children&&e.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:e})=>e.orientation==="vertical"&&e.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(t.vars||t).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:e})=>e.textAlign==="right"&&e.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:e})=>e.textAlign==="left"&&e.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),wpe=Dr("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.wrapper,r.orientation==="vertical"&&e.wrapperVertical]}})(ci(({theme:t})=>({display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`}}]}))),Uk=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDivider"}),{absolute:i=!1,children:a,className:s,orientation:o="horizontal",component:c=a||o==="vertical"?"div":"hr",flexItem:h=!1,light:d=!1,role:m=c!=="hr"?"separator":void 0,textAlign:b="center",variant:x="fullWidth",...E}=n,T={...n,absolute:i,component:c,flexItem:h,light:d,orientation:o,role:m,textAlign:b,variant:x},A=bpe(T);return J.jsx(xpe,{as:c,className:An(A.root,s),role:m,ref:r,ownerState:T,"aria-orientation":m==="separator"&&(c!=="hr"||o==="vertical")?o:void 0,...E,children:a?J.jsx(wpe,{className:A.wrapper,ownerState:T,children:a}):null})});Uk&&(Uk.muiSkipListHighlight=!0);function Spe(t,e,r){const n=e.getBoundingClientRect(),i=r&&r.getBoundingClientRect(),a=_c(e);let s;if(e.fakeTransform)s=e.fakeTransform;else{const h=a.getComputedStyle(e);s=h.getPropertyValue("-webkit-transform")||h.getPropertyValue("transform")}let o=0,c=0;if(s&&s!=="none"&&typeof s=="string"){const h=s.split("(")[1].split(")")[0].split(",");o=parseInt(h[4],10),c=parseInt(h[5],10)}return t==="left"?i?`translateX(${i.right+o-n.left}px)`:`translateX(${a.innerWidth+o-n.left}px)`:t==="right"?i?`translateX(-${n.right-i.left-o}px)`:`translateX(-${n.left+n.width-o}px)`:t==="up"?i?`translateY(${i.bottom+c-n.top}px)`:`translateY(${a.innerHeight+c-n.top}px)`:i?`translateY(-${n.top-i.top+n.height-c}px)`:`translateY(-${n.top+n.height-c}px)`}function Epe(t){return typeof t=="function"?t():t}function q2(t,e,r){const n=Epe(r),i=Spe(t,e,n);i&&(e.style.webkitTransform=i,e.style.transform=i)}const Tpe=te.forwardRef(function(e,r){const n=Lc(),i={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},a={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:s,appear:o=!0,children:c,container:h,direction:d="down",easing:m=i,in:b,onEnter:x,onEntered:E,onEntering:T,onExit:A,onExited:M,onExiting:F,style:N,timeout:O=a,TransitionComponent:U=Kh,...j}=e,H=te.useRef(null),G=Uo(Fg(c),H,r),X=me=>xe=>{me&&(xe===void 0?me(H.current):me(H.current,xe))},ae=X((me,xe)=>{q2(d,me,h),YD(me),x&&x(me,xe)}),Q=X((me,xe)=>{const Ae=xp({timeout:O,style:N,easing:m},{mode:"enter"});me.style.webkitTransition=n.transitions.create("-webkit-transform",{...Ae}),me.style.transition=n.transitions.create("transform",{...Ae}),me.style.webkitTransform="none",me.style.transform="none",T&&T(me,xe)}),W=X(E),oe=X(F),se=X(me=>{const xe=xp({timeout:O,style:N,easing:m},{mode:"exit"});me.style.webkitTransition=n.transitions.create("-webkit-transform",xe),me.style.transition=n.transitions.create("transform",xe),q2(d,me,h),A&&A(me)}),he=X(me=>{me.style.webkitTransition="",me.style.transition="",M&&M(me)}),_e=me=>{s&&s(H.current,me)},Ce=te.useCallback(()=>{H.current&&q2(d,H.current,h)},[d,h]);return te.useEffect(()=>{if(b||d==="down"||d==="right")return;const me=WD(()=>{H.current&&q2(d,H.current,h)}),xe=_c(H.current);return xe.addEventListener("resize",me),()=>{me.clear(),xe.removeEventListener("resize",me)}},[d,b,h]),te.useEffect(()=>{b||Ce()},[b,Ce]),J.jsx(U,{nodeRef:H,onEnter:ae,onEntered:W,onEntering:Q,onExit:se,onExited:he,onExiting:oe,addEndListener:_e,appear:o,in:b,timeout:O,...j,children:(me,{ownerState:xe,...Ae})=>te.cloneElement(c,{ref:G,style:{visibility:me==="exited"&&!b?"hidden":void 0,...N,...c.props.style},...Ae})})});function Cpe(t){return gi("MuiDrawer",t)}pi("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const uY=(t,e)=>{const{ownerState:r}=t;return[e.root,(r.variant==="permanent"||r.variant==="persistent")&&e.docked,e.modal]},Ape=t=>{const{classes:e,anchor:r,variant:n}=t,i={root:["root",`anchor${cn(r)}`],docked:[(n==="permanent"||n==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${cn(r)}`,n!=="temporary"&&`paperAnchorDocked${cn(r)}`]};return mi(i,Cpe,e)},Ipe=Dr(aO,{name:"MuiDrawer",slot:"Root",overridesResolver:uY})(ci(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer}))),Ppe=Dr("div",{shouldForwardProp:Al,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:uY})({flex:"0 0 auto"}),kpe=Dr(uh,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`paperAnchor${cn(r.anchor)}`],r.variant!=="temporary"&&e[`paperAnchorDocked${cn(r.anchor)}`]]}})(ci(({theme:t})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:e})=>e.anchor==="left"&&e.variant!=="temporary",style:{borderRight:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="top"&&e.variant!=="temporary",style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="right"&&e.variant!=="temporary",style:{borderLeft:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="bottom"&&e.variant!=="temporary",style:{borderTop:`1px solid ${(t.vars||t).palette.divider}`}}]}))),cY={left:"right",right:"left",top:"down",bottom:"up"};function xm(t){return["left","right"].includes(t)}function M1({direction:t},e){return t==="rtl"&&xm(e)?cY[e]:e}const lO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDrawer"}),i=Lc(),a=kx(),s={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:o="left",BackdropProps:c,children:h,className:d,elevation:m=16,hideBackdrop:b=!1,ModalProps:{BackdropProps:x,...E}={},onClose:T,open:A=!1,PaperProps:M={},SlideProps:F,TransitionComponent:N,transitionDuration:O=s,variant:U="temporary",slots:j={},slotProps:H={},...G}=n,X=te.useRef(!1);te.useEffect(()=>{X.current=!0},[]);const ae=M1({direction:a?"rtl":"ltr"},o),W={...n,anchor:o,elevation:m,open:A,variant:U,...G},oe=Ape(W),se={slots:{transition:N,...j},slotProps:{paper:M,transition:F,...H,backdrop:Lb(H.backdrop||{...c,...x},{transitionDuration:O})}},[he,_e]=Ei("root",{ref:r,elementType:Ipe,className:An(oe.root,oe.modal,d),shouldForwardComponentProp:!0,ownerState:W,externalForwardedProps:{...se,...G,...E},additionalProps:{open:A,onClose:T,hideBackdrop:b,slots:{backdrop:se.slots.backdrop},slotProps:{backdrop:se.slotProps.backdrop}}}),[Ce,me]=Ei("paper",{elementType:kpe,shouldForwardComponentProp:!0,className:An(oe.paper,M.className),ownerState:W,externalForwardedProps:se,additionalProps:{elevation:U==="temporary"?m:0,square:!0,...U==="temporary"&&{role:"dialog","aria-modal":"true"}}}),[xe,Ae]=Ei("docked",{elementType:Ppe,ref:r,className:An(oe.root,oe.docked,d),ownerState:W,externalForwardedProps:se,additionalProps:G}),[De,de]=Ei("transition",{elementType:Tpe,ownerState:W,externalForwardedProps:se,additionalProps:{in:A,direction:cY[ae],timeout:O,appear:X.current}}),Ee=J.jsx(Ce,{...me,children:h});if(U==="permanent")return J.jsx(xe,{...Ae,children:Ee});const we=J.jsx(De,{...de,children:Ee});return U==="persistent"?J.jsx(xe,{...Ae,children:we}):J.jsx(he,{..._e,children:we})}),Rpe=t=>{const{classes:e,disableUnderline:r,startAdornment:n,endAdornment:i,size:a,hiddenLabel:s,multiline:o}=t,c={root:["root",!r&&"underline",n&&"adornedStart",i&&"adornedEnd",a==="small"&&`size${cn(a)}`,s&&"hiddenLabel",o&&"multiline"],input:["input"]},h=mi(c,Gfe,e);return{...e,...h}},Mpe=Dr(ZT,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...XT(t,e),!r.disableUnderline&&e.underline]}})(ci(({theme:t})=>{const e=t.palette.mode==="light",r=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",n=e?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",i=e?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",a=e?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:i,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n}},[`&.${cm.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n},[`&.${cm.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:a},variants:[{props:({ownerState:s})=>!s.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${cm.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${cm.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline):r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${cm.disabled}, .${cm.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${cm.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(jl()).map(([s])=>({props:{disableUnderline:!1,color:s},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[s]?.main}`}}})),{props:({ownerState:s})=>s.startAdornment,style:{paddingLeft:12}},{props:({ownerState:s})=>s.endAdornment,style:{paddingRight:12}},{props:({ownerState:s})=>s.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:s,size:o})=>s.multiline&&o==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel&&s.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),Dpe=Dr(KT,{name:"MuiFilledInput",slot:"Input",overridesResolver:YT})(ci(({theme:t})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:e})=>e.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}},{props:({ownerState:e})=>e.hiddenLabel&&e.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:e})=>e.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),uO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFilledInput"}),{disableUnderline:i=!1,components:a={},componentsProps:s,fullWidth:o=!1,hiddenLabel:c,inputComponent:h="input",multiline:d=!1,slotProps:m,slots:b={},type:x="text",...E}=n,T={...n,disableUnderline:i,fullWidth:o,inputComponent:h,multiline:d,type:x},A=Rpe(n),M={root:{ownerState:T},input:{ownerState:T}},F=m??s?Qu(M,m??s):M,N=b.root??a.Root??Mpe,O=b.input??a.Input??Dpe;return J.jsx(iO,{slots:{root:N,input:O},slotProps:F,fullWidth:o,inputComponent:h,multiline:d,ref:r,type:x,...E,classes:A})});uO.muiName="Input";function Ope(t){return gi("MuiFormControl",t)}pi("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Npe=t=>{const{classes:e,margin:r,fullWidth:n}=t,i={root:["root",r!=="none"&&`margin${cn(r)}`,n&&"fullWidth"]};return mi(i,Ope,e)},Lpe=Dr("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`margin${cn(r.margin)}`],r.fullWidth&&e.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),ih=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormControl"}),{children:i,className:a,color:s="primary",component:o="div",disabled:c=!1,error:h=!1,focused:d,fullWidth:m=!1,hiddenLabel:b=!1,margin:x="none",required:E=!1,size:T="medium",variant:A="outlined",...M}=n,F={...n,color:s,component:o,disabled:c,error:h,fullWidth:m,hiddenLabel:b,margin:x,required:E,size:T,variant:A},N=Npe(F),[O,U]=te.useState(()=>{let he=!1;return i&&te.Children.forEach(i,_e=>{if(!ab(_e,["Input","Select"]))return;const Ce=ab(_e,["Select"])?_e.props.input:_e;Ce&&Vfe(Ce.props)&&(he=!0)}),he}),[j,H]=te.useState(()=>{let he=!1;return i&&te.Children.forEach(i,_e=>{ab(_e,["Input","Select"])&&(XS(_e.props,!0)||XS(_e.props.inputProps,!0))&&(he=!0)}),he}),[G,X]=te.useState(!1);c&&G&&X(!1);const ae=d!==void 0&&!c?d:G;let Q;te.useRef(!1);const W=te.useCallback(()=>{H(!0)},[]),oe=te.useCallback(()=>{H(!1)},[]),se=te.useMemo(()=>({adornedStart:O,setAdornedStart:U,color:s,disabled:c,error:h,filled:j,focused:ae,fullWidth:m,hiddenLabel:b,size:T,onBlur:()=>{X(!1)},onFocus:()=>{X(!0)},onEmpty:oe,onFilled:W,registerEffect:Q,required:E,variant:A}),[O,s,c,h,j,ae,m,b,Q,oe,W,E,T,A]);return J.jsx(nO.Provider,{value:se,children:J.jsx(Lpe,{as:o,ownerState:F,className:An(N.root,a),ref:r,...M,children:i})})});function Fpe(t){return gi("MuiFormControlLabel",t)}const D1=pi("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),Bpe=t=>{const{classes:e,disabled:r,labelPlacement:n,error:i,required:a}=t,s={root:["root",r&&"disabled",`labelPlacement${cn(n)}`,i&&"error",a&&"required"],label:["label",r&&"disabled"],asterisk:["asterisk",i&&"error"]};return mi(s,Fpe,e)},zpe=Dr("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${D1.label}`]:e.label},e.root,e[`labelPlacement${cn(r.labelPlacement)}`]]}})(ci(({theme:t})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${D1.disabled}`]:{cursor:"default"},[`& .${D1.label}`]:{[`&.${D1.disabled}`]:{color:(t.vars||t).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:e})=>e==="start"||e==="top"||e==="bottom",style:{marginLeft:16}}]}))),jpe=Dr("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(ci(({theme:t})=>({[`&.${D1.error}`]:{color:(t.vars||t).palette.error.main}}))),Vk=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormControlLabel"}),{checked:i,className:a,componentsProps:s={},control:o,disabled:c,disableTypography:h,inputRef:d,label:m,labelPlacement:b="end",name:x,onChange:E,required:T,slots:A={},slotProps:M={},value:F,...N}=n,O=Pd(),U=c??o.props.disabled??O?.disabled,j=T??o.props.required,H={disabled:U,required:j};["checked","name","onChange","value","inputRef"].forEach(he=>{typeof o.props[he]>"u"&&typeof n[he]<"u"&&(H[he]=n[he])});const G=Bg({props:n,muiFormControl:O,states:["error"]}),X={...n,disabled:U,labelPlacement:b,required:j,error:G.error},ae=Bpe(X),Q={slots:A,slotProps:{...s,...M}},[W,oe]=Ei("typography",{elementType:Ss,externalForwardedProps:Q,ownerState:X});let se=m;return se!=null&&se.type!==Ss&&!h&&(se=J.jsx(W,{component:"span",...oe,className:An(ae.label,oe?.className),children:se})),J.jsxs(zpe,{className:An(ae.root,a),ownerState:X,ref:r,...N,children:[te.cloneElement(o,H),j?J.jsxs("div",{children:[se,J.jsxs(jpe,{ownerState:X,"aria-hidden":!0,className:ae.asterisk,children:["","*"]})]}):se]})});function Upe(t){return gi("MuiFormGroup",t)}pi("MuiFormGroup",["root","row","error"]);const Vpe=t=>{const{classes:e,row:r,error:n}=t;return mi({root:["root",r&&"row",n&&"error"]},Upe,e)},$pe=Dr("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.row&&e.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),hY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormGroup"}),{className:i,row:a=!1,...s}=n,o=Pd(),c=Bg({props:n,muiFormControl:o,states:["error"]}),h={...n,row:a,error:c.error},d=Vpe(h);return J.jsx($pe,{className:An(d.root,i),ownerState:h,ref:r,...s})});function qpe(t){return gi("MuiFormHelperText",t)}const JB=pi("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var QB;const Hpe=t=>{const{classes:e,contained:r,size:n,disabled:i,error:a,filled:s,focused:o,required:c}=t,h={root:["root",i&&"disabled",a&&"error",n&&`size${cn(n)}`,r&&"contained",o&&"focused",s&&"filled",c&&"required"]};return mi(h,qpe,e)},Wpe=Dr("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size&&e[`size${cn(r.size)}`],r.contained&&e.contained,r.filled&&e.filled]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${JB.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${JB.error}`]:{color:(t.vars||t).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:e})=>e.contained,style:{marginLeft:14,marginRight:14}}]}))),Gpe=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormHelperText"}),{children:i,className:a,component:s="p",disabled:o,error:c,filled:h,focused:d,margin:m,required:b,variant:x,...E}=n,T=Pd(),A=Bg({props:n,muiFormControl:T,states:["variant","size","disabled","error","filled","focused","required"]}),M={...n,component:s,contained:A.variant==="filled"||A.variant==="outlined",variant:A.variant,size:A.size,disabled:A.disabled,error:A.error,filled:A.filled,focused:A.focused,required:A.required};delete M.ownerState;const F=Hpe(M);return J.jsx(Wpe,{as:s,className:An(F.root,a),ref:r,...E,ownerState:M,children:i===" "?QB||(QB=J.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):i})});function Xpe(t){return gi("MuiFormLabel",t)}const ub=pi("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Ype=t=>{const{classes:e,color:r,focused:n,disabled:i,error:a,filled:s,required:o}=t,c={root:["root",`color${cn(r)}`,i&&"disabled",a&&"error",s&&"filled",n&&"focused",o&&"required"],asterisk:["asterisk",a&&"error"]};return mi(c,Xpe,e)},Zpe=Dr("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color==="secondary"&&e.colorSecondary,r.filled&&e.filled]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{[`&.${ub.focused}`]:{color:(t.vars||t).palette[e].main}}})),{props:{},style:{[`&.${ub.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${ub.error}`]:{color:(t.vars||t).palette.error.main}}}]}))),Kpe=Dr("span",{name:"MuiFormLabel",slot:"Asterisk"})(ci(({theme:t})=>({[`&.${ub.error}`]:{color:(t.vars||t).palette.error.main}}))),fY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormLabel"}),{children:i,className:a,color:s,component:o="label",disabled:c,error:h,filled:d,focused:m,required:b,...x}=n,E=Pd(),T=Bg({props:n,muiFormControl:E,states:["color","required","focused","disabled","error","filled"]}),A={...n,color:T.color||"primary",component:o,disabled:T.disabled,error:T.error,filled:T.filled,focused:T.focused,required:T.required},M=Ype(A);return J.jsxs(Zpe,{as:o,ownerState:A,className:An(M.root,a),ref:r,...x,children:[i,T.required&&J.jsxs(Kpe,{ownerState:A,"aria-hidden":!0,className:M.asterisk,children:["","*"]})]})}),fp=vue({createStyledComponent:Dr("div",{name:"MuiGrid",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.container&&e.container]}}),componentName:"MuiGrid",useThemeProps:t=>bi({props:t,name:"MuiGrid"}),useTheme:Lc});function $k(t){return`scale(${t}, ${t**2})`}const Jpe={entering:{opacity:1,transform:$k(1)},entered:{opacity:1,transform:"none"}},mA=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),zb=te.forwardRef(function(e,r){const{addEndListener:n,appear:i=!0,children:a,easing:s,in:o,onEnter:c,onEntered:h,onEntering:d,onExit:m,onExited:b,onExiting:x,style:E,timeout:T="auto",TransitionComponent:A=Kh,...M}=e,F=hg(),N=te.useRef(),O=Lc(),U=te.useRef(null),j=Uo(U,Fg(a),r),H=he=>_e=>{if(he){const Ce=U.current;_e===void 0?he(Ce):he(Ce,_e)}},G=H(d),X=H((he,_e)=>{YD(he);const{duration:Ce,delay:me,easing:xe}=xp({style:E,timeout:T,easing:s},{mode:"enter"});let Ae;T==="auto"?(Ae=O.transitions.getAutoHeightDuration(he.clientHeight),N.current=Ae):Ae=Ce,he.style.transition=[O.transitions.create("opacity",{duration:Ae,delay:me}),O.transitions.create("transform",{duration:mA?Ae:Ae*.666,delay:me,easing:xe})].join(","),c&&c(he,_e)}),ae=H(h),Q=H(x),W=H(he=>{const{duration:_e,delay:Ce,easing:me}=xp({style:E,timeout:T,easing:s},{mode:"exit"});let xe;T==="auto"?(xe=O.transitions.getAutoHeightDuration(he.clientHeight),N.current=xe):xe=_e,he.style.transition=[O.transitions.create("opacity",{duration:xe,delay:Ce}),O.transitions.create("transform",{duration:mA?xe:xe*.666,delay:mA?Ce:Ce||xe*.333,easing:me})].join(","),he.style.opacity=0,he.style.transform=$k(.75),m&&m(he)}),oe=H(b),se=he=>{T==="auto"&&F.start(N.current||0,he),n&&n(U.current,he)};return J.jsx(A,{appear:i,in:o,nodeRef:U,onEnter:X,onEntered:ae,onEntering:G,onExit:W,onExited:oe,onExiting:Q,addEndListener:se,timeout:T==="auto"?null:T,...M,children:(he,{ownerState:_e,...Ce})=>te.cloneElement(a,{style:{opacity:0,transform:$k(.75),visibility:he==="exited"&&!o?"hidden":void 0,...Jpe[he],...E,...a.props.style},ref:j,...Ce})})});zb&&(zb.muiSupportAuto=!0);const Qpe=t=>{const{classes:e,disableUnderline:r}=t,i=mi({root:["root",!r&&"underline"],input:["input"]},Hfe,e);return{...e,...i}},ege=Dr(ZT,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...XT(t,e),!r.disableUnderline&&e.underline]}})(ci(({theme:t})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline)),{position:"relative",variants:[{props:({ownerState:n})=>n.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:n})=>!n.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${e1.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${e1.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${e1.disabled}, .${e1.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${e1.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(jl()).map(([n])=>({props:{color:n,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[n].main}`}}}))]}})),tge=Dr(KT,{name:"MuiInput",slot:"Input",overridesResolver:YT})({}),cO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiInput"}),{disableUnderline:i=!1,components:a={},componentsProps:s,fullWidth:o=!1,inputComponent:c="input",multiline:h=!1,slotProps:d,slots:m={},type:b="text",...x}=n,E=Qpe(n),A={root:{ownerState:{disableUnderline:i}}},M=d??s?Qu(d??s,A):A,F=m.root??a.Root??ege,N=m.input??a.Input??tge;return J.jsx(iO,{slots:{root:F,input:N},slotProps:M,fullWidth:o,inputComponent:c,multiline:h,ref:r,type:b,...x,classes:E})});cO.muiName="Input";function rge(t){return gi("MuiInputLabel",t)}pi("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const nge=t=>{const{classes:e,formControl:r,size:n,shrink:i,disableAnimation:a,variant:s,required:o}=t,c={root:["root",r&&"formControl",!a&&"animated",i&&"shrink",n&&n!=="medium"&&`size${cn(n)}`,s],asterisk:[o&&"asterisk"]},h=mi(c,rge,e);return{...e,...h}},ige=Dr(fY,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${ub.asterisk}`]:e.asterisk},e.root,r.formControl&&e.formControl,r.size==="small"&&e.sizeSmall,r.shrink&&e.shrink,!r.disableAnimation&&e.animated,r.focused&&e.focused,e[r.variant]]}})(ci(({theme:t})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:e})=>e.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:e})=>e.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:e})=>!e.disableAnimation,style:{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="filled"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:e,ownerState:r,size:n})=>e==="filled"&&r.shrink&&n==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="outlined"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),_g=te.forwardRef(function(e,r){const n=bi({name:"MuiInputLabel",props:e}),{disableAnimation:i=!1,margin:a,shrink:s,variant:o,className:c,...h}=n,d=Pd();let m=s;typeof m>"u"&&d&&(m=d.filled||d.focused||d.adornedStart);const b=Bg({props:n,muiFormControl:d,states:["size","variant","required","focused"]}),x={...n,disableAnimation:i,formControl:d,shrink:m,size:b.size,variant:b.variant,required:b.required,focused:b.focused},E=nge(x);return J.jsx(ige,{"data-shrink":m,ref:r,className:An(E.root,c),...h,ownerState:x,classes:E})}),Fh=te.createContext({});function age(t){return gi("MuiList",t)}pi("MuiList",["root","padding","dense","subheader"]);const oge=t=>{const{classes:e,disablePadding:r,dense:n,subheader:i}=t;return mi({root:["root",!r&&"padding",n&&"dense",i&&"subheader"]},age,e)},sge=Dr("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disablePadding&&e.padding,r.dense&&e.dense,r.subheader&&e.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:t})=>!t.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:t})=>t.subheader,style:{paddingTop:0}}]}),Rf=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiList"}),{children:i,className:a,component:s="ul",dense:o=!1,disablePadding:c=!1,subheader:h,...d}=n,m=te.useMemo(()=>({dense:o}),[o]),b={...n,component:s,dense:o,disablePadding:c},x=oge(b);return J.jsx(Fh.Provider,{value:m,children:J.jsxs(sge,{as:s,className:An(x.root,a),ref:r,ownerState:b,...d,children:[h,i]})})});function lge(t){return gi("MuiListItem",t)}pi("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);function uge(t){return gi("MuiListItemButton",t)}const Nv=pi("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),cge=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters]},hge=t=>{const{alignItems:e,classes:r,dense:n,disabled:i,disableGutters:a,divider:s,selected:o}=t,h=mi({root:["root",n&&"dense",!a&&"gutters",s&&"divider",i&&"disabled",e==="flex-start"&&"alignItemsFlexStart",o&&"selected"]},uge,r);return{...r,...h}},fge=Dr(h_,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:cge})(ci(({theme:t})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Nv.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${Nv.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}},[`&.${Nv.selected}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity)}},[`&.${Nv.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${Nv.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},variants:[{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.dense,style:{paddingTop:4,paddingBottom:4}}]}))),dY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemButton"}),{alignItems:i="center",autoFocus:a=!1,component:s="div",children:o,dense:c=!1,disableGutters:h=!1,divider:d=!1,focusVisibleClassName:m,selected:b=!1,className:x,...E}=n,T=te.useContext(Fh),A=te.useMemo(()=>({dense:c||T.dense||!1,alignItems:i,disableGutters:h}),[i,T.dense,c,h]),M=te.useRef(null);Tu(()=>{a&&M.current&&M.current.focus()},[a]);const F={...n,alignItems:i,dense:A.dense,disableGutters:h,divider:d,selected:b},N=hge(F),O=Uo(M,r);return J.jsx(Fh.Provider,{value:A,children:J.jsx(fge,{ref:O,href:E.href||E.to,component:(E.href||E.to)&&s==="div"?"button":s,focusVisibleClassName:An(N.focusVisible,m),ownerState:F,className:An(N.root,x),...E,classes:N,children:o})})});function dge(t){return gi("MuiListItemSecondaryAction",t)}pi("MuiListItemSecondaryAction",["root","disableGutters"]);const pge=t=>{const{disableGutters:e,classes:r}=t;return mi({root:["root",e&&"disableGutters"]},dge,r)},gge=Dr("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.disableGutters&&e.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:t})=>t.disableGutters,style:{right:0}}]}),pY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemSecondaryAction"}),{className:i,...a}=n,s=te.useContext(Fh),o={...n,disableGutters:s.disableGutters},c=pge(o);return J.jsx(gge,{className:An(c.root,i),ownerState:o,ref:r,...a})});pY.muiName="ListItemSecondaryAction";const mge=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters,!r.disablePadding&&e.padding,r.hasSecondaryAction&&e.secondaryAction]},yge=t=>{const{alignItems:e,classes:r,dense:n,disableGutters:i,disablePadding:a,divider:s,hasSecondaryAction:o}=t;return mi({root:["root",n&&"dense",!i&&"gutters",!a&&"padding",s&&"divider",e==="flex-start"&&"alignItemsFlexStart",o&&"secondaryAction"],container:["container"]},lge,r)},vge=Dr("div",{name:"MuiListItem",slot:"Root",overridesResolver:mge})(ci(({theme:t})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>!e.disablePadding&&e.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:e})=>!e.disablePadding&&!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>!e.disablePadding&&!!e.secondaryAction,style:{paddingRight:48}},{props:({ownerState:e})=>!!e.secondaryAction,style:{[`& > .${Nv.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>e.button,style:{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:e})=>e.hasSecondaryAction,style:{paddingRight:48}}]}))),_ge=Dr("li",{name:"MuiListItem",slot:"Container"})({position:"relative"}),$h=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItem"}),{alignItems:i="center",children:a,className:s,component:o,components:c={},componentsProps:h={},ContainerComponent:d="li",ContainerProps:{className:m,...b}={},dense:x=!1,disableGutters:E=!1,disablePadding:T=!1,divider:A=!1,secondaryAction:M,slotProps:F={},slots:N={},...O}=n,U=te.useContext(Fh),j=te.useMemo(()=>({dense:x||U.dense||!1,alignItems:i,disableGutters:E}),[i,U.dense,x,E]),H=te.useRef(null),G=te.Children.toArray(a),X=G.length&&ab(G[G.length-1],["ListItemSecondaryAction"]),ae={...n,alignItems:i,dense:j.dense,disableGutters:E,disablePadding:T,divider:A,hasSecondaryAction:X},Q=yge(ae),W=Uo(H,r),oe=N.root||c.Root||vge,se=F.root||h.root||{},he={className:An(Q.root,se.className,s),...O};let _e=o||"li";return X?(_e=!he.component&&!o?"div":_e,d==="li"&&(_e==="li"?_e="div":he.component==="li"&&(he.component="div")),J.jsx(Fh.Provider,{value:j,children:J.jsxs(_ge,{as:d,className:An(Q.container,m),ref:W,ownerState:ae,...b,children:[J.jsx(oe,{...se,...!vd(oe)&&{as:_e,ownerState:{...ae,...se.ownerState}},...he,children:G}),G.pop()]})})):J.jsx(Fh.Provider,{value:j,children:J.jsxs(oe,{...se,as:_e,ref:W,...!vd(oe)&&{ownerState:{...ae,...se.ownerState}},...he,children:[G,M&&J.jsx(pY,{children:M})]})})});function bge(t){return gi("MuiListItemAvatar",t)}pi("MuiListItemAvatar",["root","alignItemsFlexStart"]);const xge=t=>{const{alignItems:e,classes:r}=t;return mi({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},bge,r)},wge=Dr("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})({minWidth:56,flexShrink:0,variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}),gY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemAvatar"}),{className:i,...a}=n,s=te.useContext(Fh),o={...n,alignItems:s.alignItems},c=xge(o);return J.jsx(wge,{className:An(c.root,i),ownerState:o,ref:r,...a})});function Sge(t){return gi("MuiListItemIcon",t)}const ez=pi("MuiListItemIcon",["root","alignItemsFlexStart"]),Ege=t=>{const{alignItems:e,classes:r}=t;return mi({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},Sge,r)},Tge=Dr("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})(ci(({theme:t})=>({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),jb=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemIcon"}),{className:i,...a}=n,s=te.useContext(Fh),o={...n,alignItems:s.alignItems},c=Ege(o);return J.jsx(Tge,{className:An(c.root,i),ownerState:o,ref:r,...a})});function Cge(t){return gi("MuiListItemText",t)}const i0=pi("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Age=t=>{const{classes:e,inset:r,primary:n,secondary:i,dense:a}=t;return mi({root:["root",r&&"inset",a&&"dense",n&&i&&"multiline"],primary:["primary"],secondary:["secondary"]},Cge,e)},Ige=Dr("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${i0.primary}`]:e.primary},{[`& .${i0.secondary}`]:e.secondary},e.root,r.inset&&e.inset,r.primary&&r.secondary&&e.multiline,r.dense&&e.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${kB.root}:where(& .${i0.primary})`]:{display:"block"},[`.${kB.root}:where(& .${i0.secondary})`]:{display:"block"},variants:[{props:({ownerState:t})=>t.primary&&t.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:t})=>t.inset,style:{paddingLeft:56}}]}),Dh=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemText"}),{children:i,className:a,disableTypography:s=!1,inset:o=!1,primary:c,primaryTypographyProps:h,secondary:d,secondaryTypographyProps:m,slots:b={},slotProps:x={},...E}=n,{dense:T}=te.useContext(Fh);let A=c??i,M=d;const F={...n,disableTypography:s,inset:o,primary:!!A,secondary:!!M,dense:T},N=Age(F),O={slots:b,slotProps:{primary:h,secondary:m,...x}},[U,j]=Ei("root",{className:An(N.root,a),elementType:Ige,externalForwardedProps:{...O,...E},ownerState:F,ref:r}),[H,G]=Ei("primary",{className:N.primary,elementType:Ss,externalForwardedProps:O,ownerState:F}),[X,ae]=Ei("secondary",{className:N.secondary,elementType:Ss,externalForwardedProps:O,ownerState:F});return A!=null&&A.type!==Ss&&!s&&(A=J.jsx(H,{variant:T?"body2":"body1",component:G?.variant?void 0:"span",...G,children:A})),M!=null&&M.type!==Ss&&!s&&(M=J.jsx(X,{variant:"body2",color:"textSecondary",...ae,children:M})),J.jsxs(U,{...j,children:[A,M]})});function yA(t,e,r){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:r?null:t.firstChild}function tz(t,e,r){return t===e?r?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:r?null:t.lastChild}function mY(t,e){if(e===void 0)return!0;let r=t.innerText;return r===void 0&&(r=t.textContent),r=r.trim().toLowerCase(),r.length===0?!1:e.repeating?r[0]===e.keys[0]:r.startsWith(e.keys.join(""))}function t1(t,e,r,n,i,a){let s=!1,o=i(t,e,e?r:!1);for(;o;){if(o===t.firstChild){if(s)return!1;s=!0}const c=n?!1:o.disabled||o.getAttribute("aria-disabled")==="true";if(!o.hasAttribute("tabindex")||!mY(o,a)||c)o=i(t,o,r);else return o.focus(),!0}return!1}const Pge=te.forwardRef(function(e,r){const{actions:n,autoFocus:i=!1,autoFocusItem:a=!1,children:s,className:o,disabledItemsFocusable:c=!1,disableListWrap:h=!1,onKeyDown:d,variant:m="selectedMenu",...b}=e,x=te.useRef(null),E=te.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Tu(()=>{i&&x.current.focus()},[i]),te.useImperativeHandle(n,()=>({adjustStyleForScrollbar:(N,{direction:O})=>{const U=!x.current.style.width;if(N.clientHeight<x.current.clientHeight&&U){const j=`${sY(_c(N))}px`;x.current.style[O==="rtl"?"paddingLeft":"paddingRight"]=j,x.current.style.width=`calc(100% + ${j})`}return x.current}}),[]);const T=N=>{const O=x.current,U=N.key;if(N.ctrlKey||N.metaKey||N.altKey){d&&d(N);return}const H=cs(O).activeElement;if(U==="ArrowDown")N.preventDefault(),t1(O,H,h,c,yA);else if(U==="ArrowUp")N.preventDefault(),t1(O,H,h,c,tz);else if(U==="Home")N.preventDefault(),t1(O,null,h,c,yA);else if(U==="End")N.preventDefault(),t1(O,null,h,c,tz);else if(U.length===1){const G=E.current,X=U.toLowerCase(),ae=performance.now();G.keys.length>0&&(ae-G.lastTime>500?(G.keys=[],G.repeating=!0,G.previousKeyMatched=!0):G.repeating&&X!==G.keys[0]&&(G.repeating=!1)),G.lastTime=ae,G.keys.push(X);const Q=H&&!G.repeating&&mY(H,G);G.previousKeyMatched&&(Q||t1(O,H,!1,c,yA,G))?N.preventDefault():G.previousKeyMatched=!1}d&&d(N)},A=Uo(x,r);let M=-1;te.Children.forEach(s,(N,O)=>{if(!te.isValidElement(N)){M===O&&(M+=1,M>=s.length&&(M=-1));return}N.props.disabled||(m==="selectedMenu"&&N.props.selected||M===-1)&&(M=O),M===O&&(N.props.disabled||N.props.muiSkipListHighlight||N.type.muiSkipListHighlight)&&(M+=1,M>=s.length&&(M=-1))});const F=te.Children.map(s,(N,O)=>{if(O===M){const U={};return a&&(U.autoFocus=!0),N.props.tabIndex===void 0&&m==="selectedMenu"&&(U.tabIndex=0),te.cloneElement(N,U)}return N});return J.jsx(Rf,{role:"menu",ref:A,className:o,onKeyDown:T,tabIndex:i?0:-1,...b,children:F})});function kge(t){return gi("MuiPopover",t)}pi("MuiPopover",["root","paper"]);function rz(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.height/2:e==="bottom"&&(r=t.height),r}function nz(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.width/2:e==="right"&&(r=t.width),r}function iz(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function H2(t){return typeof t=="function"?t():t}const Rge=t=>{const{classes:e}=t;return mi({root:["root"],paper:["paper"]},kge,e)},Mge=Dr(aO,{name:"MuiPopover",slot:"Root"})({}),yY=Dr(uh,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Dge=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiPopover"}),{action:i,anchorEl:a,anchorOrigin:s={vertical:"top",horizontal:"left"},anchorPosition:o,anchorReference:c="anchorEl",children:h,className:d,container:m,elevation:b=8,marginThreshold:x=16,open:E,PaperProps:T={},slots:A={},slotProps:M={},transformOrigin:F={vertical:"top",horizontal:"left"},TransitionComponent:N,transitionDuration:O="auto",TransitionProps:U={},disableScrollLock:j=!1,...H}=n,G=te.useRef(),X={...n,anchorOrigin:s,anchorReference:c,elevation:b,marginThreshold:x,transformOrigin:F,TransitionComponent:N,transitionDuration:O,TransitionProps:U},ae=Rge(X),Q=te.useCallback(()=>{if(c==="anchorPosition")return o;const Qe=H2(a),Re=(Qe&&Qe.nodeType===1?Qe:cs(G.current).body).getBoundingClientRect();return{top:Re.top+rz(Re,s.vertical),left:Re.left+nz(Re,s.horizontal)}},[a,s.horizontal,s.vertical,o,c]),W=te.useCallback(Qe=>({vertical:rz(Qe,F.vertical),horizontal:nz(Qe,F.horizontal)}),[F.horizontal,F.vertical]),oe=te.useCallback(Qe=>{const rt={width:Qe.offsetWidth,height:Qe.offsetHeight},Re=W(rt);if(c==="none")return{top:null,left:null,transformOrigin:iz(Re)};const zt=Q();let st=zt.top-Re.vertical,$e=zt.left-Re.horizontal;const Jt=st+rt.height,Ht=$e+rt.width,pr=_c(H2(a)),_t=pr.innerHeight-x,vr=pr.innerWidth-x;if(x!==null&&st<x){const br=st-x;st-=br,Re.vertical+=br}else if(x!==null&&Jt>_t){const br=Jt-_t;st-=br,Re.vertical+=br}if(x!==null&&$e<x){const br=$e-x;$e-=br,Re.horizontal+=br}else if(Ht>vr){const br=Ht-vr;$e-=br,Re.horizontal+=br}return{top:`${Math.round(st)}px`,left:`${Math.round($e)}px`,transformOrigin:iz(Re)}},[a,c,Q,W,x]),[se,he]=te.useState(E),_e=te.useCallback(()=>{const Qe=G.current;if(!Qe)return;const rt=oe(Qe);rt.top!==null&&Qe.style.setProperty("top",rt.top),rt.left!==null&&(Qe.style.left=rt.left),Qe.style.transformOrigin=rt.transformOrigin,he(!0)},[oe]);te.useEffect(()=>(j&&window.addEventListener("scroll",_e),()=>window.removeEventListener("scroll",_e)),[a,j,_e]);const Ce=()=>{_e()},me=()=>{he(!1)};te.useEffect(()=>{E&&_e()}),te.useImperativeHandle(i,()=>E?{updatePosition:()=>{_e()}}:null,[E,_e]),te.useEffect(()=>{if(!E)return;const Qe=WD(()=>{_e()}),rt=_c(H2(a));return rt.addEventListener("resize",Qe),()=>{Qe.clear(),rt.removeEventListener("resize",Qe)}},[a,E,_e]);let xe=O;const Ae={slots:{transition:N,...A},slotProps:{transition:U,paper:T,...M}},[De,de]=Ei("transition",{elementType:zb,externalForwardedProps:Ae,ownerState:X,getSlotProps:Qe=>({...Qe,onEntering:(rt,Re)=>{Qe.onEntering?.(rt,Re),Ce()},onExited:rt=>{Qe.onExited?.(rt),me()}}),additionalProps:{appear:!0,in:E}});O==="auto"&&!De.muiSupportAuto&&(xe=void 0);const Ee=m||(a?cs(H2(a)).body:void 0),[we,{slots:Le,slotProps:Fe,...Xe}]=Ei("root",{ref:r,elementType:Mge,externalForwardedProps:{...Ae,...H},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:A.backdrop},slotProps:{backdrop:Lb(typeof M.backdrop=="function"?M.backdrop(X):M.backdrop,{invisible:!0})},container:Ee,open:E},ownerState:X,className:An(ae.root,d)}),[Be,ot]=Ei("paper",{ref:G,className:ae.paper,elementType:yY,externalForwardedProps:Ae,shouldForwardComponentProp:!0,additionalProps:{elevation:b,style:se?void 0:{opacity:0}},ownerState:X});return J.jsx(we,{...Xe,...!vd(we)&&{slots:Le,slotProps:Fe,disableScrollLock:j},children:J.jsx(De,{...de,timeout:xe,children:J.jsx(Be,{...ot,children:h})})})});function Oge(t){return gi("MuiMenu",t)}pi("MuiMenu",["root","paper","list"]);const Nge={vertical:"top",horizontal:"right"},Lge={vertical:"top",horizontal:"left"},Fge=t=>{const{classes:e}=t;return mi({root:["root"],paper:["paper"],list:["list"]},Oge,e)},Bge=Dr(Dge,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiMenu",slot:"Root"})({}),zge=Dr(yY,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),jge=Dr(Pge,{name:"MuiMenu",slot:"List"})({outline:0}),vY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiMenu"}),{autoFocus:i=!0,children:a,className:s,disableAutoFocusItem:o=!1,MenuListProps:c={},onClose:h,open:d,PaperProps:m={},PopoverClasses:b,transitionDuration:x="auto",TransitionProps:{onEntering:E,...T}={},variant:A="selectedMenu",slots:M={},slotProps:F={},...N}=n,O=kx(),U={...n,autoFocus:i,disableAutoFocusItem:o,MenuListProps:c,onEntering:E,PaperProps:m,transitionDuration:x,TransitionProps:T,variant:A},j=Fge(U),H=i&&!o&&d,G=te.useRef(null),X=(xe,Ae)=>{G.current&&G.current.adjustStyleForScrollbar(xe,{direction:O?"rtl":"ltr"}),E&&E(xe,Ae)},ae=xe=>{xe.key==="Tab"&&(xe.preventDefault(),h&&h(xe,"tabKeyDown"))};let Q=-1;te.Children.map(a,(xe,Ae)=>{te.isValidElement(xe)&&(xe.props.disabled||(A==="selectedMenu"&&xe.props.selected||Q===-1)&&(Q=Ae))});const W={slots:M,slotProps:{list:c,transition:T,paper:m,...F}},oe=ad({elementType:M.root,externalSlotProps:F.root,ownerState:U,className:[j.root,s]}),[se,he]=Ei("paper",{className:j.paper,elementType:zge,externalForwardedProps:W,shouldForwardComponentProp:!0,ownerState:U}),[_e,Ce]=Ei("list",{className:An(j.list,c.className),elementType:jge,shouldForwardComponentProp:!0,externalForwardedProps:W,getSlotProps:xe=>({...xe,onKeyDown:Ae=>{ae(Ae),xe.onKeyDown?.(Ae)}}),ownerState:U}),me=typeof W.slotProps.transition=="function"?W.slotProps.transition(U):W.slotProps.transition;return J.jsx(Bge,{onClose:h,anchorOrigin:{vertical:"bottom",horizontal:O?"right":"left"},transformOrigin:O?Nge:Lge,slots:{root:M.root,paper:se,backdrop:M.backdrop,...M.transition&&{transition:M.transition}},slotProps:{root:oe,paper:he,backdrop:typeof F.backdrop=="function"?F.backdrop(U):F.backdrop,transition:{...me,onEntering:(...xe)=>{X(...xe),me?.onEntering?.(...xe)}}},open:d,ref:r,transitionDuration:x,ownerState:U,...N,classes:b,children:J.jsx(_e,{actions:G,autoFocus:i&&(Q===-1||o),autoFocusItem:H,variant:A,...Ce,children:a})})});function Uge(t){return gi("MuiMenuItem",t)}const r1=pi("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Vge=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.divider&&e.divider,!r.disableGutters&&e.gutters]},$ge=t=>{const{disabled:e,dense:r,divider:n,disableGutters:i,selected:a,classes:s}=t,c=mi({root:["root",r&&"dense",e&&"disabled",!i&&"gutters",n&&"divider",a&&"selected"]},Uge,s);return{...s,...c}},qge=Dr(h_,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:Vge})(ci(({theme:t})=>({...t.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${r1.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${r1.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}},[`&.${r1.selected}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity)}},[`&.${r1.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${r1.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${KB.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${KB.inset}`]:{marginLeft:52},[`& .${i0.root}`]:{marginTop:0,marginBottom:0},[`& .${i0.inset}`]:{paddingLeft:36},[`& .${ez.root}`]:{minWidth:36},variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>!e.dense,style:{[t.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:e})=>e.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...t.typography.body2,[`& .${ez.root} svg`]:{fontSize:"1.25rem"}}}]}))),Fm=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiMenuItem"}),{autoFocus:i=!1,component:a="li",dense:s=!1,divider:o=!1,disableGutters:c=!1,focusVisibleClassName:h,role:d="menuitem",tabIndex:m,className:b,...x}=n,E=te.useContext(Fh),T=te.useMemo(()=>({dense:s||E.dense||!1,disableGutters:c}),[E.dense,s,c]),A=te.useRef(null);Tu(()=>{i&&A.current&&A.current.focus()},[i]);const M={...n,dense:T.dense,divider:o,disableGutters:c},F=$ge(n),N=Uo(A,r);let O;return n.disabled||(O=m!==void 0?m:-1),J.jsx(Fh.Provider,{value:T,children:J.jsx(qge,{ref:N,role:d,tabIndex:O,component:a,focusVisibleClassName:An(F.focusVisible,h),className:An(F.root,b),...x,ownerState:M,classes:F})})});function Hge(t){return gi("MuiNativeSelect",t)}const hO=pi("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Wge=t=>{const{classes:e,variant:r,disabled:n,multiple:i,open:a,error:s}=t,o={select:["select",r,n&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${cn(r)}`,a&&"iconOpen",n&&"disabled"]};return mi(o,Hge,e)},_Y=Dr("select",{name:"MuiNativeSelect"})(({theme:t})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${hO.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},variants:[{props:({ownerState:e})=>e.variant!=="filled"&&e.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}}]})),Gge=Dr(_Y,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Al,overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.select,e[r.variant],r.error&&e.error,{[`&.${hO.multiple}`]:e.multiple}]}})({}),bY=Dr("svg",{name:"MuiNativeSelect"})(({theme:t})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,[`&.${hO.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:({ownerState:e})=>e.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),Xge=Dr(bY,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${cn(r.variant)}`],r.open&&e.iconOpen]}})({}),Yge=te.forwardRef(function(e,r){const{className:n,disabled:i,error:a,IconComponent:s,inputRef:o,variant:c="standard",...h}=e,d={...e,disabled:i,variant:c,error:a},m=Wge(d);return J.jsxs(te.Fragment,{children:[J.jsx(Gge,{ownerState:d,className:An(m.select,n),disabled:i,ref:o||r,...h}),e.multiple?null:J.jsx(Xge,{as:s,ownerState:d,className:m.icon})]})});function Zge(t){const{children:e,defer:r=!1,fallback:n=null}=t,[i,a]=te.useState(!1);return Tu(()=>{r||a(!0)},[r]),te.useEffect(()=>{r&&a(!0)},[r]),i?e:n}var az;const Kge=Dr("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:Al})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),Jge=Dr("legend",{name:"MuiNotchedOutlined",shouldForwardProp:Al})(ci(({theme:t})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:e})=>!e.withLabel,style:{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})}},{props:({ownerState:e})=>e.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:e})=>e.withLabel&&e.notched,style:{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}}]})));function Qge(t){const{children:e,classes:r,className:n,label:i,notched:a,...s}=t,o=i!=null&&i!=="",c={...t,notched:a,withLabel:o};return J.jsx(Kge,{"aria-hidden":!0,className:n,ownerState:c,...s,children:J.jsx(Jge,{ownerState:c,children:o?J.jsx("span",{children:i}):az||(az=J.jsx("span",{className:"notranslate","aria-hidden":!0,children:""}))})})}const eme=t=>{const{classes:e}=t,n=mi({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Wfe,e);return{...e,...n}},tme=Dr(ZT,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:XT})(ci(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${ed.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${ed.notchedOutline}`]:{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}},[`&.${ed.focused} .${ed.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(t.palette).filter(jl()).map(([r])=>({props:{color:r},style:{[`&.${ed.focused} .${ed.notchedOutline}`]:{borderColor:(t.vars||t).palette[r].main}}})),{props:{},style:{[`&.${ed.error} .${ed.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${ed.disabled} .${ed.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:14}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:14}},{props:({ownerState:r})=>r.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:r,size:n})=>r.multiline&&n==="small",style:{padding:"8.5px 14px"}}]}})),rme=Dr(Qge,{name:"MuiOutlinedInput",slot:"NotchedOutline"})(ci(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}})),nme=Dr(KT,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:YT})(ci(({theme:t})=>({padding:"16.5px 14px",...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:e})=>e.multiline,style:{padding:0}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}}]}))),JT=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiOutlinedInput"}),{components:i={},fullWidth:a=!1,inputComponent:s="input",label:o,multiline:c=!1,notched:h,slots:d={},slotProps:m={},type:b="text",...x}=n,E=eme(n),T=Pd(),A=Bg({props:n,muiFormControl:T,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),M={...n,color:A.color||"primary",disabled:A.disabled,error:A.error,focused:A.focused,formControl:T,fullWidth:a,hiddenLabel:A.hiddenLabel,multiline:c,size:A.size,type:b},F=d.root??i.Root??tme,N=d.input??i.Input??nme,[O,U]=Ei("notchedOutline",{elementType:rme,className:E.notchedOutline,shouldForwardComponentProp:!0,ownerState:M,externalForwardedProps:{slots:d,slotProps:m},additionalProps:{label:o!=null&&o!==""&&A.required?J.jsxs(te.Fragment,{children:[o,"","*"]}):o}});return J.jsx(iO,{slots:{root:F,input:N},slotProps:m,renderSuffix:j=>J.jsx(O,{...U,notched:typeof h<"u"?h:!!(j.startAdornment||j.filled||j.focused)}),fullWidth:a,inputComponent:s,multiline:c,ref:r,type:b,...x,classes:{...E,notchedOutline:null}})});JT.muiName="Input";const ime=Ji(J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),ame=Ji(J.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),ome=Dr("span",{name:"MuiRadioButtonIcon",shouldForwardProp:Al})({position:"relative",display:"flex"}),sme=Dr(ime,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),lme=Dr(ame,{name:"MuiRadioButtonIcon"})(ci(({theme:t})=>({left:0,position:"absolute",transform:"scale(0)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.shortest})}}]})));function xY(t){const{checked:e=!1,classes:r={},fontSize:n}=t,i={...t,checked:e};return J.jsxs(ome,{className:r.root,ownerState:i,children:[J.jsx(sme,{fontSize:n,className:r.background,ownerState:i}),J.jsx(lme,{fontSize:n,className:r.dot,ownerState:i})]})}const wY=te.createContext(void 0);function ume(){return te.useContext(wY)}function cme(t){return gi("MuiRadio",t)}const oz=pi("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),hme=t=>{const{classes:e,color:r,size:n}=t,i={root:["root",`color${cn(r)}`,n!=="medium"&&`size${cn(n)}`]};return{...e,...mi(i,cme,e)}},fme=Dr(oY,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size!=="medium"&&e[`size${cn(r.size)}`],e[`color${cn(r.color)}`]]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,[`&.${oz.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,disabled:!1},style:{[`&.${oz.checked}`]:{color:(t.vars||t).palette[e].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function dme(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}const pme=J.jsx(xY,{checked:!0}),gme=J.jsx(xY,{}),sz=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiRadio"}),{checked:i,checkedIcon:a=pme,color:s="primary",icon:o=gme,name:c,onChange:h,size:d="medium",className:m,disabled:b,disableRipple:x=!1,slots:E={},slotProps:T={},inputProps:A,...M}=n,F=Pd();let N=b;F&&typeof N>"u"&&(N=F.disabled),N??=!1;const O={...n,disabled:N,disableRipple:x,color:s,size:d},U=hme(O),j=ume();let H=i;const G=Ik(h,j&&j.onChange);let X=c;j&&(typeof H>"u"&&(H=dme(j.value,n.value)),typeof X>"u"&&(X=j.name));const ae=T.input??A,[Q,W]=Ei("root",{ref:r,elementType:fme,className:An(U.root,m),shouldForwardComponentProp:!0,externalForwardedProps:{slots:E,slotProps:T,...M},getSlotProps:oe=>({...oe,onChange:(se,...he)=>{oe.onChange?.(se,...he),G(se,...he)}}),ownerState:O,additionalProps:{type:"radio",icon:te.cloneElement(o,{fontSize:o.props.fontSize??d}),checkedIcon:te.cloneElement(a,{fontSize:a.props.fontSize??d}),disabled:N,name:X,checked:H,slots:E,slotProps:{input:typeof ae=="function"?ae(O):ae}}});return J.jsx(Q,{...W,classes:U})});function mme(t){return gi("MuiRadioGroup",t)}pi("MuiRadioGroup",["root","row","error"]);const yme=t=>{const{classes:e,row:r,error:n}=t;return mi({root:["root",r&&"row",n&&"error"]},mme,e)},vme=te.forwardRef(function(e,r){const{actions:n,children:i,className:a,defaultValue:s,name:o,onChange:c,value:h,...d}=e,m=te.useRef(null),b=yme(e),[x,E]=Ym({controlled:h,default:s,name:"RadioGroup"});te.useImperativeHandle(n,()=>({focus:()=>{let F=m.current.querySelector("input:not(:disabled):checked");F||(F=m.current.querySelector("input:not(:disabled)")),F&&F.focus()}}),[]);const T=Uo(r,m),A=Og(o),M=te.useMemo(()=>({name:A,onChange(F){E(F.target.value),c&&c(F,F.target.value)},value:x}),[A,c,E,x]);return J.jsx(wY.Provider,{value:M,children:J.jsx(hY,{role:"radiogroup",ref:T,className:An(b.root,a),...d,children:i})})}),_me={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function SY(t){return gi("MuiSelect",t)}const n1=pi("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var lz;const bme=Dr(_Y,{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`&.${n1.select}`]:e.select},{[`&.${n1.select}`]:e[r.variant]},{[`&.${n1.error}`]:e.error},{[`&.${n1.multiple}`]:e.multiple}]}})({[`&.${n1.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),xme=Dr(bY,{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${cn(r.variant)}`],r.open&&e.iconOpen]}})({}),wme=Dr("input",{shouldForwardProp:t=>$T(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function uz(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function Sme(t){return t==null||typeof t=="string"&&!t.trim()}const Eme=t=>{const{classes:e,variant:r,disabled:n,multiple:i,open:a,error:s}=t,o={select:["select",r,n&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${cn(r)}`,a&&"iconOpen",n&&"disabled"],nativeInput:["nativeInput"]};return mi(o,SY,e)},Tme=te.forwardRef(function(e,r){const{"aria-describedby":n,"aria-label":i,autoFocus:a,autoWidth:s,children:o,className:c,defaultOpen:h,defaultValue:d,disabled:m,displayEmpty:b,error:x=!1,IconComponent:E,inputRef:T,labelId:A,MenuProps:M={},multiple:F,name:N,onBlur:O,onChange:U,onClose:j,onFocus:H,onOpen:G,open:X,readOnly:ae,renderValue:Q,required:W,SelectDisplayProps:oe={},tabIndex:se,type:he,value:_e,variant:Ce="standard",...me}=e,[xe,Ae]=Ym({controlled:_e,default:d,name:"Select"}),[De,de]=Ym({controlled:X,default:h,name:"Select"}),Ee=te.useRef(null),we=te.useRef(null),[Le,Fe]=te.useState(null),{current:Xe}=te.useRef(X!=null),[Be,ot]=te.useState(),Qe=Uo(r,T),rt=te.useCallback(ct=>{we.current=ct,ct&&Fe(ct)},[]),Re=Le?.parentNode;te.useImperativeHandle(Qe,()=>({focus:()=>{we.current.focus()},node:Ee.current,value:xe}),[xe]),te.useEffect(()=>{h&&De&&Le&&!Xe&&(ot(s?null:Re.clientWidth),we.current.focus())},[Le,s]),te.useEffect(()=>{a&&we.current.focus()},[a]),te.useEffect(()=>{if(!A)return;const ct=cs(we.current).getElementById(A);if(ct){const Kt=()=>{getSelection().isCollapsed&&we.current.focus()};return ct.addEventListener("click",Kt),()=>{ct.removeEventListener("click",Kt)}}},[A]);const zt=(ct,Kt)=>{ct?G&&G(Kt):j&&j(Kt),Xe||(ot(s?null:Re.clientWidth),de(ct))},st=ct=>{ct.button===0&&(ct.preventDefault(),we.current.focus(),zt(!0,ct))},$e=ct=>{zt(!1,ct)},Jt=te.Children.toArray(o),Ht=ct=>{const Kt=Jt.find(qt=>qt.props.value===ct.target.value);Kt!==void 0&&(Ae(Kt.props.value),U&&U(ct,Kt))},pr=ct=>Kt=>{let qt;if(Kt.currentTarget.hasAttribute("tabindex")){if(F){qt=Array.isArray(xe)?xe.slice():[];const Ir=xe.indexOf(ct.props.value);Ir===-1?qt.push(ct.props.value):qt.splice(Ir,1)}else qt=ct.props.value;if(ct.props.onClick&&ct.props.onClick(Kt),xe!==qt&&(Ae(qt),U)){const Ir=Kt.nativeEvent||Kt,Ar=new Ir.constructor(Ir.type,Ir);Object.defineProperty(Ar,"target",{writable:!0,value:{value:qt,name:N}}),U(Ar,ct)}F||zt(!1,Kt)}},_t=ct=>{ae||[" ","ArrowUp","ArrowDown","Enter"].includes(ct.key)&&(ct.preventDefault(),zt(!0,ct))},vr=Le!==null&&De,br=ct=>{!vr&&O&&(Object.defineProperty(ct,"target",{writable:!0,value:{value:xe,name:N}}),O(ct))};delete me["aria-invalid"];let lr,Cr;const Tr=[];let Qt=!1;(XS({value:xe})||b)&&(Q?lr=Q(xe):Qt=!0);const at=Jt.map(ct=>{if(!te.isValidElement(ct))return null;let Kt;if(F){if(!Array.isArray(xe))throw new Error(_p(2));Kt=xe.some(qt=>uz(qt,ct.props.value)),Kt&&Qt&&Tr.push(ct.props.children)}else Kt=uz(xe,ct.props.value),Kt&&Qt&&(Cr=ct.props.children);return te.cloneElement(ct,{"aria-selected":Kt?"true":"false",onClick:pr(ct),onKeyUp:qt=>{qt.key===" "&&qt.preventDefault(),ct.props.onKeyUp&&ct.props.onKeyUp(qt)},role:"option",selected:Kt,value:void 0,"data-value":ct.props.value})});Qt&&(F?Tr.length===0?lr=null:lr=Tr.reduce((ct,Kt,qt)=>(ct.push(Kt),qt<Tr.length-1&&ct.push(", "),ct),[]):lr=Cr);let ke=Be;!s&&Xe&&Le&&(ke=Re.clientWidth);let be;typeof se<"u"?be=se:be=m?null:0;const je=oe.id||(N?`mui-component-select-${N}`:void 0),qe={...e,variant:Ce,value:xe,open:vr,error:x},We=Eme(qe),Lt={...M.PaperProps,...typeof M.slotProps?.paper=="function"?M.slotProps.paper(qe):M.slotProps?.paper},Et={...M.MenuListProps,...typeof M.slotProps?.list=="function"?M.slotProps.list(qe):M.slotProps?.list},mt=Og();return J.jsxs(te.Fragment,{children:[J.jsx(bme,{as:"div",ref:rt,tabIndex:be,role:"combobox","aria-controls":vr?mt:void 0,"aria-disabled":m?"true":void 0,"aria-expanded":vr?"true":"false","aria-haspopup":"listbox","aria-label":i,"aria-labelledby":[A,je].filter(Boolean).join(" ")||void 0,"aria-describedby":n,"aria-required":W?"true":void 0,"aria-invalid":x?"true":void 0,onKeyDown:_t,onMouseDown:m||ae?null:st,onBlur:br,onFocus:H,...oe,ownerState:qe,className:An(oe.className,We.select,c),id:je,children:Sme(lr)?lz||(lz=J.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):lr}),J.jsx(wme,{"aria-invalid":x,value:Array.isArray(xe)?xe.join(","):xe,name:N,ref:Ee,"aria-hidden":!0,onChange:Ht,tabIndex:-1,disabled:m,className:We.nativeInput,autoFocus:a,required:W,...me,ownerState:qe}),J.jsx(xme,{as:E,className:We.icon,ownerState:qe}),J.jsx(vY,{id:`menu-${N||""}`,anchorEl:Re,open:vr,onClose:$e,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...M,slotProps:{...M.slotProps,list:{"aria-labelledby":A,role:"listbox","aria-multiselectable":F?"true":void 0,disableListWrap:!0,id:mt,...Et},paper:{...Lt,style:{minWidth:ke,...Lt!=null?Lt.style:null}}},children:at})]})}),Cme=t=>{const{classes:e}=t,n=mi({root:["root"]},SY,e);return{...e,...n}},fO={name:"MuiSelect",slot:"Root",shouldForwardProp:t=>Al(t)&&t!=="variant"},Ame=Dr(cO,fO)(""),Ime=Dr(JT,fO)(""),Pme=Dr(uO,fO)(""),bg=te.forwardRef(function(e,r){const n=bi({name:"MuiSelect",props:e}),{autoWidth:i=!1,children:a,classes:s={},className:o,defaultOpen:c=!1,displayEmpty:h=!1,IconComponent:d=Xfe,id:m,input:b,inputProps:x,label:E,labelId:T,MenuProps:A,multiple:M=!1,native:F=!1,onClose:N,onOpen:O,open:U,renderValue:j,SelectDisplayProps:H,variant:G="outlined",...X}=n,ae=F?Yge:Tme,Q=Pd(),W=Bg({props:n,muiFormControl:Q,states:["variant","error"]}),oe=W.variant||G,se={...n,variant:oe,classes:s},he=Cme(se),{root:_e,...Ce}=he,me=b||{standard:J.jsx(Ame,{ownerState:se}),outlined:J.jsx(Ime,{label:E,ownerState:se}),filled:J.jsx(Pme,{ownerState:se})}[oe],xe=Uo(r,Fg(me));return J.jsx(te.Fragment,{children:te.cloneElement(me,{inputComponent:ae,inputProps:{children:a,error:W.error,IconComponent:d,variant:oe,type:void 0,multiple:M,...F?{id:m}:{autoWidth:i,defaultOpen:c,displayEmpty:h,labelId:T,MenuProps:A,onClose:N,onOpen:O,open:U,renderValue:j,SelectDisplayProps:{id:m,...H}},...x,classes:x?Qu(Ce,x.classes):Ce,...b?b.props.inputProps:{}},...(M&&F||h)&&oe==="outlined"?{notched:!0}:{},ref:xe,className:An(me.props.className,o,he.root),...!b&&{variant:oe},...X})})});bg.muiName="Select";function kme(t,e,r=(n,i)=>n===i){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}const Rme=2;function dv(t,e,r,n,i){return r===1?Math.min(t+e,i):Math.max(t-e,n)}function EY(t,e){return t-e}function cz(t,e){const{index:r}=t.reduce((n,i,a)=>{const s=Math.abs(e-i);return n===null||s<n.distance||s===n.distance?{distance:s,index:a}:n},null)??{};return r}function W2(t,e){if(e.current!==void 0&&t.changedTouches){const r=t;for(let n=0;n<r.changedTouches.length;n+=1){const i=r.changedTouches[n];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function YS(t,e,r){return(t-e)*100/(r-e)}function Mme(t,e,r){return(r-e)*t+e}function Dme(t){if(Math.abs(t)<1){const r=t.toExponential().split("e-"),n=r[0].split(".")[1];return(n?n.length:0)+parseInt(r[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function Ome(t,e,r){const n=Math.round((t-r)/e)*e+r;return Number(n.toFixed(Dme(e)))}function hz({values:t,newValue:e,index:r}){const n=t.slice();return n[r]=e,n.sort(EY)}function G2({sliderRef:t,activeIndex:e,setActive:r}){const n=cs(t.current);(!t.current?.contains(n.activeElement)||Number(n?.activeElement?.getAttribute("data-index"))!==e)&&t.current?.querySelector(`[type="range"][data-index="${e}"]`).focus(),r&&r(e)}function X2(t,e){return typeof t=="number"&&typeof e=="number"?t===e:typeof t=="object"&&typeof e=="object"?kme(t,e):!1}const Nme={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},Lme=t=>t;let Y2;function fz(){return Y2===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?Y2=CSS.supports("touch-action","none"):Y2=!0),Y2}function Fme(t){const{"aria-labelledby":e,defaultValue:r,disabled:n=!1,disableSwap:i=!1,isRtl:a=!1,marks:s=!1,max:o=100,min:c=0,name:h,onChange:d,onChangeCommitted:m,orientation:b="horizontal",rootRef:x,scale:E=Lme,step:T=1,shiftStep:A=10,tabIndex:M,value:F}=t,N=te.useRef(void 0),[O,U]=te.useState(-1),[j,H]=te.useState(-1),[G,X]=te.useState(!1),ae=te.useRef(0),Q=te.useRef(null),[W,oe]=Ym({controlled:F,default:r??c,name:"Slider"}),se=d&&((Qt,at,ke)=>{const be=Qt.nativeEvent||Qt,je=new be.constructor(be.type,be);Object.defineProperty(je,"target",{writable:!0,value:{value:at,name:h}}),Q.current=at,d(je,at,ke)}),he=Array.isArray(W);let _e=he?W.slice().sort(EY):[W];_e=_e.map(Qt=>Qt==null?c:Dv(Qt,c,o));const Ce=s===!0&&T!==null?[...Array(Math.floor((o-c)/T)+1)].map((Qt,at)=>({value:c+T*at})):s||[],me=Ce.map(Qt=>Qt.value),[xe,Ae]=te.useState(-1),De=te.useRef(null),de=Uo(x,De),Ee=Qt=>at=>{const ke=Number(at.currentTarget.getAttribute("data-index"));N0(at.target)&&Ae(ke),H(ke),Qt?.onFocus?.(at)},we=Qt=>at=>{N0(at.target)||Ae(-1),H(-1),Qt?.onBlur?.(at)},Le=(Qt,at)=>{const ke=Number(Qt.currentTarget.getAttribute("data-index")),be=_e[ke],je=me.indexOf(be);let qe=at;if(Ce&&T==null){const We=me[me.length-1];qe>=We?qe=We:qe<=me[0]?qe=me[0]:qe=qe<be?me[je-1]:me[je+1]}if(qe=Dv(qe,c,o),he){i&&(qe=Dv(qe,_e[ke-1]||-1/0,_e[ke+1]||1/0));const We=qe;qe=hz({values:_e,newValue:qe,index:ke});let Lt=ke;i||(Lt=qe.indexOf(We)),G2({sliderRef:De,activeIndex:Lt})}oe(qe),Ae(ke),se&&!X2(qe,W)&&se(Qt,qe,ke),m&&m(Qt,Q.current??qe)},Fe=Qt=>at=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(at.key)){at.preventDefault();const ke=Number(at.currentTarget.getAttribute("data-index")),be=_e[ke];let je=null;if(T!=null){const qe=at.shiftKey?A:T;switch(at.key){case"ArrowUp":je=dv(be,qe,1,c,o);break;case"ArrowRight":je=dv(be,qe,a?-1:1,c,o);break;case"ArrowDown":je=dv(be,qe,-1,c,o);break;case"ArrowLeft":je=dv(be,qe,a?1:-1,c,o);break;case"PageUp":je=dv(be,A,1,c,o);break;case"PageDown":je=dv(be,A,-1,c,o);break;case"Home":je=c;break;case"End":je=o;break}}else if(Ce){const qe=me[me.length-1],We=me.indexOf(be),Lt=[a?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"],Et=[a?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];Lt.includes(at.key)?We===0?je=me[0]:je=me[We-1]:Et.includes(at.key)&&(We===me.length-1?je=qe:je=me[We+1])}je!=null&&Le(at,je)}Qt?.onKeyDown?.(at)};Tu(()=>{n&&De.current.contains(document.activeElement)&&document.activeElement?.blur()},[n]),n&&O!==-1&&U(-1),n&&xe!==-1&&Ae(-1);const Xe=Qt=>at=>{Qt.onChange?.(at),Le(at,at.target.valueAsNumber)},Be=te.useRef(void 0);let ot=b;a&&b==="horizontal"&&(ot+="-reverse");const Qe=({finger:Qt,move:at=!1})=>{const{current:ke}=De,{width:be,height:je,bottom:qe,left:We}=ke.getBoundingClientRect();let Lt;ot.startsWith("vertical")?Lt=(qe-Qt.y)/je:Lt=(Qt.x-We)/be,ot.includes("-reverse")&&(Lt=1-Lt);let Et;if(Et=Mme(Lt,c,o),T)Et=Ome(Et,T,c);else{const ct=cz(me,Et);Et=me[ct]}Et=Dv(Et,c,o);let mt=0;if(he){at?mt=Be.current:mt=cz(_e,Et),i&&(Et=Dv(Et,_e[mt-1]||-1/0,_e[mt+1]||1/0));const ct=Et;Et=hz({values:_e,newValue:Et,index:mt}),i&&at||(mt=Et.indexOf(ct),Be.current=mt)}return{newValue:Et,activeIndex:mt}},rt=ou(Qt=>{const at=W2(Qt,N);if(!at)return;if(ae.current+=1,Qt.type==="mousemove"&&Qt.buttons===0){Re(Qt);return}const{newValue:ke,activeIndex:be}=Qe({finger:at,move:!0});G2({sliderRef:De,activeIndex:be,setActive:U}),oe(ke),!G&&ae.current>Rme&&X(!0),se&&!X2(ke,W)&&se(Qt,ke,be)}),Re=ou(Qt=>{const at=W2(Qt,N);if(X(!1),!at)return;const{newValue:ke}=Qe({finger:at,move:!0});U(-1),Qt.type==="touchend"&&H(-1),m&&m(Qt,Q.current??ke),N.current=void 0,st()}),zt=ou(Qt=>{if(n)return;fz()||Qt.preventDefault();const at=Qt.changedTouches[0];at!=null&&(N.current=at.identifier);const ke=W2(Qt,N);if(ke!==!1){const{newValue:je,activeIndex:qe}=Qe({finger:ke});G2({sliderRef:De,activeIndex:qe,setActive:U}),oe(je),se&&!X2(je,W)&&se(Qt,je,qe)}ae.current=0;const be=cs(De.current);be.addEventListener("touchmove",rt,{passive:!0}),be.addEventListener("touchend",Re,{passive:!0})}),st=te.useCallback(()=>{const Qt=cs(De.current);Qt.removeEventListener("mousemove",rt),Qt.removeEventListener("mouseup",Re),Qt.removeEventListener("touchmove",rt),Qt.removeEventListener("touchend",Re)},[Re,rt]);te.useEffect(()=>{const{current:Qt}=De;return Qt.addEventListener("touchstart",zt,{passive:fz()}),()=>{Qt.removeEventListener("touchstart",zt),st()}},[st,zt]),te.useEffect(()=>{n&&st()},[n,st]);const $e=Qt=>at=>{if(Qt.onMouseDown?.(at),n||at.defaultPrevented||at.button!==0)return;at.preventDefault();const ke=W2(at,N);if(ke!==!1){const{newValue:je,activeIndex:qe}=Qe({finger:ke});G2({sliderRef:De,activeIndex:qe,setActive:U}),oe(je),se&&!X2(je,W)&&se(at,je,qe)}ae.current=0;const be=cs(De.current);be.addEventListener("mousemove",rt,{passive:!0}),be.addEventListener("mouseup",Re)},Jt=YS(he?_e[0]:c,c,o),Ht=YS(_e[_e.length-1],c,o)-Jt,pr=(Qt={})=>{const at=Nm(Qt),ke={onMouseDown:$e(at||{})},be={...at,...ke};return{...Qt,ref:de,...be}},_t=Qt=>at=>{Qt.onMouseOver?.(at);const ke=Number(at.currentTarget.getAttribute("data-index"));H(ke)},vr=Qt=>at=>{Qt.onMouseLeave?.(at),H(-1)},br=(Qt={})=>{const at=Nm(Qt),ke={onMouseOver:_t(at||{}),onMouseLeave:vr(at||{})};return{...Qt,...at,...ke}},lr=Qt=>({pointerEvents:O!==-1&&O!==Qt?"none":void 0});let Cr;return b==="vertical"&&(Cr=a?"vertical-rl":"vertical-lr"),{active:O,axis:ot,axisProps:Nme,dragging:G,focusedThumbIndex:xe,getHiddenInputProps:(Qt={})=>{const at=Nm(Qt),ke={onChange:Xe(at||{}),onFocus:Ee(at||{}),onBlur:we(at||{}),onKeyDown:Fe(at||{})},be={...at,...ke};return{tabIndex:M,"aria-labelledby":e,"aria-orientation":b,"aria-valuemax":E(o),"aria-valuemin":E(c),name:h,type:"range",min:t.min,max:t.max,step:t.step===null&&t.marks?"any":t.step??void 0,disabled:n,...Qt,...be,style:{..._me,direction:a?"rtl":"ltr",width:"100%",height:"100%",writingMode:Cr}}},getRootProps:pr,getThumbProps:br,marks:Ce,open:j,range:he,rootRef:de,trackLeap:Ht,trackOffset:Jt,values:_e,getThumbStyle:lr}}const Bme=t=>!t||!vd(t);function zme(t){return gi("MuiSlider",t)}const Oh=pi("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),jme=t=>{const{open:e}=t;return{offset:An(e&&Oh.valueLabelOpen),circle:Oh.valueLabelCircle,label:Oh.valueLabelLabel}};function Ume(t){const{children:e,className:r,value:n}=t,i=jme(t);return e?te.cloneElement(e,{className:e.props.className},J.jsxs(te.Fragment,{children:[e.props.children,J.jsx("span",{className:An(i.offset,r),"aria-hidden":!0,children:J.jsx("span",{className:i.circle,children:J.jsx("span",{className:i.label,children:n})})})]})):null}function dz(t){return t}const Vme=Dr("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`color${cn(r.color)}`],r.size!=="medium"&&e[`size${cn(r.size)}`],r.marked&&e.marked,r.orientation==="vertical"&&e.vertical,r.track==="inverted"&&e.trackInverted,r.track===!1&&e.trackFalse]}})(ci(({theme:t})=>({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${Oh.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${Oh.dragging}`]:{[`& .${Oh.thumb}, & .${Oh.track}`]:{transition:"none"}},variants:[...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}))),$me=Dr("span",{name:"MuiSlider",slot:"Rail"})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),qme=Dr("span",{name:"MuiSlider",slot:"Track"})(ci(({theme:t})=>({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,track:"inverted"},style:{...t.vars?{backgroundColor:t.vars.palette.Slider[`${e}Track`],borderColor:t.vars.palette.Slider[`${e}Track`]}:{backgroundColor:t.lighten(t.palette[e].main,.62),borderColor:t.lighten(t.palette[e].main,.62),...t.applyStyles("dark",{backgroundColor:t.darken(t.palette[e].main,.5)}),...t.applyStyles("dark",{borderColor:t.darken(t.palette[e].main,.5)})}}}))]}))),Hme=Dr("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.thumb,e[`thumbColor${cn(r.color)}`],r.size!=="medium"&&e[`thumbSize${cn(r.size)}`]]}})(ci(({theme:t})=>({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${Oh.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{[`&:hover, &.${Oh.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${t.alpha((t.vars||t).palette[e].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${Oh.active}`]:{boxShadow:`0px 0px 0px 14px ${t.alpha((t.vars||t).palette[e].main,.16)}`}}}))]}))),Wme=Dr(Ume,{name:"MuiSlider",slot:"ValueLabel"})(ci(({theme:t})=>({zIndex:1,whiteSpace:"nowrap",...t.typography.body2,fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${Oh.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${Oh.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]}))),Gme=Dr("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>$T(t)&&t!=="markActive",overridesResolver:(t,e)=>{const{markActive:r}=t;return[e.mark,r&&e.markActive]}})(ci(({theme:t})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}))),Xme=Dr("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>$T(t)&&t!=="markLabelActive"})(ci(({theme:t})=>({...t.typography.body2,color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]}))),Yme=t=>{const{disabled:e,dragging:r,marked:n,orientation:i,track:a,classes:s,color:o,size:c}=t,h={root:["root",e&&"disabled",r&&"dragging",n&&"marked",i==="vertical"&&"vertical",a==="inverted"&&"trackInverted",a===!1&&"trackFalse",o&&`color${cn(o)}`,c&&`size${cn(c)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled",c&&`thumbSize${cn(c)}`,o&&`thumbColor${cn(o)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return mi(h,zme,s)},Zme=({children:t})=>t,dO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSlider"}),i=kx(),{"aria-label":a,"aria-valuetext":s,"aria-labelledby":o,component:c="span",components:h={},componentsProps:d={},color:m="primary",classes:b,className:x,disableSwap:E=!1,disabled:T=!1,getAriaLabel:A,getAriaValueText:M,marks:F=!1,max:N=100,min:O=0,name:U,onChange:j,onChangeCommitted:H,orientation:G="horizontal",shiftStep:X=10,size:ae="medium",step:Q=1,scale:W=dz,slotProps:oe,slots:se,tabIndex:he,track:_e="normal",value:Ce,valueLabelDisplay:me="off",valueLabelFormat:xe=dz,...Ae}=n,De={...n,isRtl:i,max:N,min:O,classes:b,disabled:T,disableSwap:E,orientation:G,marks:F,color:m,size:ae,step:Q,shiftStep:X,scale:W,track:_e,valueLabelDisplay:me,valueLabelFormat:xe},{axisProps:de,getRootProps:Ee,getHiddenInputProps:we,getThumbProps:Le,open:Fe,active:Xe,axis:Be,focusedThumbIndex:ot,range:Qe,dragging:rt,marks:Re,values:zt,trackOffset:st,trackLeap:$e,getThumbStyle:Jt}=Fme({...De,rootRef:r});De.marked=Re.length>0&&Re.some(zr=>zr.label),De.dragging=rt,De.focusedThumbIndex=ot;const Ht=Yme(De),pr=se?.root??h.Root??Vme,_t=se?.rail??h.Rail??$me,vr=se?.track??h.Track??qme,br=se?.thumb??h.Thumb??Hme,lr=se?.valueLabel??h.ValueLabel??Wme,Cr=se?.mark??h.Mark??Gme,Tr=se?.markLabel??h.MarkLabel??Xme,Qt=se?.input??h.Input??"input",at=oe?.root??d.root,ke=oe?.rail??d.rail,be=oe?.track??d.track,je=oe?.thumb??d.thumb,qe=oe?.valueLabel??d.valueLabel,We=oe?.mark??d.mark,Lt=oe?.markLabel??d.markLabel,Et=oe?.input??d.input,mt=ad({elementType:pr,getSlotProps:Ee,externalSlotProps:at,externalForwardedProps:Ae,additionalProps:{...Bme(pr)&&{as:c}},ownerState:{...De,...at?.ownerState},className:[Ht.root,x]}),ct=ad({elementType:_t,externalSlotProps:ke,ownerState:De,className:Ht.rail}),Kt=ad({elementType:vr,externalSlotProps:be,additionalProps:{style:{...de[Be].offset(st),...de[Be].leap($e)}},ownerState:{...De,...be?.ownerState},className:Ht.track}),qt=ad({elementType:br,getSlotProps:Le,externalSlotProps:je,ownerState:{...De,...je?.ownerState},className:Ht.thumb}),Ir=ad({elementType:lr,externalSlotProps:qe,ownerState:{...De,...qe?.ownerState},className:Ht.valueLabel}),Ar=ad({elementType:Cr,externalSlotProps:We,ownerState:De,className:Ht.mark}),$r=ad({elementType:Tr,externalSlotProps:Lt,ownerState:De,className:Ht.markLabel}),hn=ad({elementType:Qt,getSlotProps:we,externalSlotProps:Et,ownerState:De});return J.jsxs(pr,{...mt,children:[J.jsx(_t,{...ct}),J.jsx(vr,{...Kt}),Re.filter(zr=>zr.value>=O&&zr.value<=N).map((zr,Mt)=>{const en=YS(zr.value,O,N),jn=de[Be].offset(en);let Qr;return _e===!1?Qr=zt.includes(zr.value):Qr=_e==="normal"&&(Qe?zr.value>=zt[0]&&zr.value<=zt[zt.length-1]:zr.value<=zt[0])||_e==="inverted"&&(Qe?zr.value<=zt[0]||zr.value>=zt[zt.length-1]:zr.value>=zt[0]),J.jsxs(te.Fragment,{children:[J.jsx(Cr,{"data-index":Mt,...Ar,...!vd(Cr)&&{markActive:Qr},style:{...jn,...Ar.style},className:An(Ar.className,Qr&&Ht.markActive)}),zr.label!=null?J.jsx(Tr,{"aria-hidden":!0,"data-index":Mt,...$r,...!vd(Tr)&&{markLabelActive:Qr},style:{...jn,...$r.style},className:An(Ht.markLabel,$r.className,Qr&&Ht.markLabelActive),children:zr.label}):null]},Mt)}),zt.map((zr,Mt)=>{const en=YS(zr,O,N),jn=de[Be].offset(en),Qr=me==="off"?Zme:lr;return J.jsx(Qr,{...!vd(Qr)&&{valueLabelFormat:xe,valueLabelDisplay:me,value:typeof xe=="function"?xe(W(zr),Mt):xe,index:Mt,open:Fe===Mt||Xe===Mt||me==="on",disabled:T},...Ir,children:J.jsx(br,{"data-index":Mt,...qt,className:An(Ht.thumb,qt.className,Xe===Mt&&Ht.active,ot===Mt&&Ht.focusVisible),style:{...jn,...Jt(Mt),...qt.style},children:J.jsx(Qt,{"data-index":Mt,"aria-label":A?A(Mt):a,"aria-valuenow":W(zr),"aria-labelledby":o,"aria-valuetext":M?M(W(zr),Mt):s,value:zt[Mt],...hn})})},Mt)})]})});function Kme(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:r=!1,onClose:n,open:i,resumeHideDuration:a}=t,s=hg();te.useEffect(()=>{if(!i)return;function M(F){F.defaultPrevented||F.key==="Escape"&&n?.(F,"escapeKeyDown")}return document.addEventListener("keydown",M),()=>{document.removeEventListener("keydown",M)}},[i,n]);const o=ou((M,F)=>{n?.(M,F)}),c=ou(M=>{!n||M==null||s.start(M,()=>{o(null,"timeout")})});te.useEffect(()=>(i&&c(e),s.clear),[i,e,c,s]);const h=M=>{n?.(M,"clickaway")},d=s.clear,m=te.useCallback(()=>{e!=null&&c(a??e*.5)},[e,a,c]),b=M=>F=>{const N=M.onBlur;N?.(F),m()},x=M=>F=>{const N=M.onFocus;N?.(F),d()},E=M=>F=>{const N=M.onMouseEnter;N?.(F),d()},T=M=>F=>{const N=M.onMouseLeave;N?.(F),m()};return te.useEffect(()=>{if(!r&&i)return window.addEventListener("focus",m),window.addEventListener("blur",d),()=>{window.removeEventListener("focus",m),window.removeEventListener("blur",d)}},[r,i,m,d]),{getRootProps:(M={})=>{const F={...Nm(t),...Nm(M)};return{role:"presentation",...M,...F,onBlur:b(F),onFocus:x(F),onMouseEnter:E(F),onMouseLeave:T(F)}},onClickAway:h}}function Jme(t){return gi("MuiSnackbarContent",t)}pi("MuiSnackbarContent",["root","message","action"]);const Qme=t=>{const{classes:e}=t;return mi({root:["root"],action:["action"],message:["message"]},Jme,e)},eye=Dr(uh,{name:"MuiSnackbarContent",slot:"Root"})(ci(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98;return{...t.typography.body2,color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(wk(t.palette.background.default,e)),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:wk(t.palette.background.default,e),display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),tye=Dr("div",{name:"MuiSnackbarContent",slot:"Message"})({padding:"8px 0"}),rye=Dr("div",{name:"MuiSnackbarContent",slot:"Action"})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),nye=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSnackbarContent"}),{action:i,className:a,message:s,role:o="alert",...c}=n,h=n,d=Qme(h);return J.jsxs(eye,{role:o,elevation:6,className:An(d.root,a),ownerState:h,ref:r,...c,children:[J.jsx(tye,{className:d.message,ownerState:h,children:s}),i?J.jsx(rye,{className:d.action,ownerState:h,children:i}):null]})});function iye(t){return gi("MuiSnackbar",t)}pi("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const aye=t=>{const{classes:e,anchorOrigin:r}=t,n={root:["root",`anchorOrigin${cn(r.vertical)}${cn(r.horizontal)}`]};return mi(n,iye,e)},oye=Dr("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`anchorOrigin${cn(r.anchorOrigin.vertical)}${cn(r.anchorOrigin.horizontal)}`]]}})(ci(({theme:t})=>({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:e})=>e.anchorOrigin.vertical==="top",style:{top:8,[t.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:e})=>e.anchorOrigin.vertical!=="top",style:{bottom:8,[t.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[t.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[t.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="center",style:{[t.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),sye=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSnackbar"}),i=Lc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{action:s,anchorOrigin:{vertical:o,horizontal:c}={vertical:"bottom",horizontal:"left"},autoHideDuration:h=null,children:d,className:m,ClickAwayListenerProps:b,ContentProps:x,disableWindowBlurListener:E=!1,message:T,onBlur:A,onClose:M,onFocus:F,onMouseEnter:N,onMouseLeave:O,open:U,resumeHideDuration:j,slots:H={},slotProps:G={},TransitionComponent:X,transitionDuration:ae=a,TransitionProps:{onEnter:Q,onExited:W,...oe}={},...se}=n,he={...n,anchorOrigin:{vertical:o,horizontal:c},autoHideDuration:h,disableWindowBlurListener:E,TransitionComponent:X,transitionDuration:ae},_e=aye(he),{getRootProps:Ce,onClickAway:me}=Kme({...he}),[xe,Ae]=te.useState(!0),De=zt=>{Ae(!0),W&&W(zt)},de=(zt,st)=>{Ae(!1),Q&&Q(zt,st)},Ee={slots:{transition:X,...H},slotProps:{content:x,clickAwayListener:b,transition:oe,...G}},[we,Le]=Ei("root",{ref:r,className:[_e.root,m],elementType:oye,getSlotProps:Ce,externalForwardedProps:{...Ee,...se},ownerState:he}),[Fe,{ownerState:Xe,...Be}]=Ei("clickAwayListener",{elementType:Dde,externalForwardedProps:Ee,getSlotProps:zt=>({onClickAway:(...st)=>{const $e=st[0];zt.onClickAway?.(...st),!$e?.defaultMuiPrevented&&me(...st)}}),ownerState:he}),[ot,Qe]=Ei("content",{elementType:nye,shouldForwardComponentProp:!0,externalForwardedProps:Ee,additionalProps:{message:T,action:s},ownerState:he}),[rt,Re]=Ei("transition",{elementType:zb,externalForwardedProps:Ee,getSlotProps:zt=>({onEnter:(...st)=>{zt.onEnter?.(...st),de(...st)},onExited:(...st)=>{zt.onExited?.(...st),De(...st)}}),additionalProps:{appear:!0,in:U,timeout:ae,direction:o==="top"?"down":"up"},ownerState:he});return!U&&xe?null:J.jsx(Fe,{...Be,...H.clickAwayListener&&{ownerState:Xe},children:J.jsx(we,{...Le,children:J.jsx(rt,{...Re,children:d||J.jsx(ot,{...Qe})})})})});function lye(t){return gi("MuiTooltip",t)}const Bs=pi("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function uye(t){return Math.round(t*1e5)/1e5}const cye=t=>{const{classes:e,disableInteractive:r,arrow:n,touch:i,placement:a}=t,s={popper:["popper",!r&&"popperInteractive",n&&"popperArrow"],tooltip:["tooltip",n&&"tooltipArrow",i&&"touch",`tooltipPlacement${cn(a.split("-")[0])}`],arrow:["arrow"]};return mi(s,lye,e)},hye=Dr(eY,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.popper,!r.disableInteractive&&e.popperInteractive,r.arrow&&e.popperArrow,!r.open&&e.popperClose]}})(ci(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${Bs.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Bs.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Bs.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${Bs.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Bs.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Bs.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Bs.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Bs.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),fye=Dr("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.tooltip,r.touch&&e.touch,r.arrow&&e.tooltipArrow,e[`tooltipPlacement${cn(r.placement.split("-")[0])}`]]}})(ci(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${Bs.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${Bs.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${Bs.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${Bs.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${uye(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${Bs.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${Bs.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${Bs.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${Bs.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${Bs.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${Bs.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${Bs.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${Bs.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Bs.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Bs.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),dye=Dr("span",{name:"MuiTooltip",slot:"Arrow"})(ci(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let Z2=!1;const pz=new HT;let i1={x:0,y:0};function K2(t,e){return(r,...n)=>{e&&e(r,...n),t(r,...n)}}const fg=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiTooltip"}),{arrow:i=!1,children:a,classes:s,components:o={},componentsProps:c={},describeChild:h=!1,disableFocusListener:d=!1,disableHoverListener:m=!1,disableInteractive:b=!1,disableTouchListener:x=!1,enterDelay:E=100,enterNextDelay:T=0,enterTouchDelay:A=700,followCursor:M=!1,id:F,leaveDelay:N=0,leaveTouchDelay:O=1500,onClose:U,onOpen:j,open:H,placement:G="bottom",PopperComponent:X,PopperProps:ae={},slotProps:Q={},slots:W={},title:oe,TransitionComponent:se,TransitionProps:he,..._e}=n,Ce=te.isValidElement(a)?a:J.jsx("span",{children:a}),me=Lc(),xe=kx(),[Ae,De]=te.useState(),[de,Ee]=te.useState(null),we=te.useRef(!1),Le=b||M,Fe=hg(),Xe=hg(),Be=hg(),ot=hg(),[Qe,rt]=Ym({controlled:H,default:!1,name:"Tooltip",state:"open"});let Re=Qe;const zt=Og(F),st=te.useRef(),$e=ou(()=>{st.current!==void 0&&(document.body.style.WebkitUserSelect=st.current,st.current=void 0),ot.clear()});te.useEffect(()=>$e,[$e]);const Jt=nr=>{pz.clear(),Z2=!0,rt(!0),j&&!Re&&j(nr)},Ht=ou(nr=>{pz.start(800+N,()=>{Z2=!1}),rt(!1),U&&Re&&U(nr),Fe.start(me.transitions.duration.shortest,()=>{we.current=!1})}),pr=nr=>{we.current&&nr.type!=="touchstart"||(Ae&&Ae.removeAttribute("title"),Xe.clear(),Be.clear(),E||Z2&&T?Xe.start(Z2?T:E,()=>{Jt(nr)}):Jt(nr))},_t=nr=>{Xe.clear(),Be.start(N,()=>{Ht(nr)})},[,vr]=te.useState(!1),br=nr=>{N0(nr.target)||(vr(!1),_t(nr))},lr=nr=>{Ae||De(nr.currentTarget),N0(nr.target)&&(vr(!0),pr(nr))},Cr=nr=>{we.current=!0;const oi=Ce.props;oi.onTouchStart&&oi.onTouchStart(nr)},Tr=nr=>{Cr(nr),Be.clear(),Fe.clear(),$e(),st.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",ot.start(A,()=>{document.body.style.WebkitUserSelect=st.current,pr(nr)})},Qt=nr=>{Ce.props.onTouchEnd&&Ce.props.onTouchEnd(nr),$e(),Be.start(O,()=>{Ht(nr)})};te.useEffect(()=>{if(!Re)return;function nr(oi){oi.key==="Escape"&&Ht(oi)}return document.addEventListener("keydown",nr),()=>{document.removeEventListener("keydown",nr)}},[Ht,Re]);const at=Uo(Fg(Ce),De,r);!oe&&oe!==0&&(Re=!1);const ke=te.useRef(),be=nr=>{const oi=Ce.props;oi.onMouseMove&&oi.onMouseMove(nr),i1={x:nr.clientX,y:nr.clientY},ke.current&&ke.current.update()},je={},qe=typeof oe=="string";h?(je.title=!Re&&qe&&!m?oe:null,je["aria-describedby"]=Re?zt:null):(je["aria-label"]=qe?oe:null,je["aria-labelledby"]=Re&&!qe?zt:null);const We={...je,..._e,...Ce.props,className:An(_e.className,Ce.props.className),onTouchStart:Cr,ref:at,...M?{onMouseMove:be}:{}},Lt={};x||(We.onTouchStart=Tr,We.onTouchEnd=Qt),m||(We.onMouseOver=K2(pr,We.onMouseOver),We.onMouseLeave=K2(_t,We.onMouseLeave),Le||(Lt.onMouseOver=pr,Lt.onMouseLeave=_t)),d||(We.onFocus=K2(lr,We.onFocus),We.onBlur=K2(br,We.onBlur),Le||(Lt.onFocus=lr,Lt.onBlur=br));const Et={...n,isRtl:xe,arrow:i,disableInteractive:Le,placement:G,PopperComponentProp:X,touch:we.current},mt=typeof Q.popper=="function"?Q.popper(Et):Q.popper,ct=te.useMemo(()=>{let nr=[{name:"arrow",enabled:!!de,options:{element:de,padding:4}}];return ae.popperOptions?.modifiers&&(nr=nr.concat(ae.popperOptions.modifiers)),mt?.popperOptions?.modifiers&&(nr=nr.concat(mt.popperOptions.modifiers)),{...ae.popperOptions,...mt?.popperOptions,modifiers:nr}},[de,ae.popperOptions,mt?.popperOptions]),Kt=cye(Et),qt=typeof Q.transition=="function"?Q.transition(Et):Q.transition,Ir={slots:{popper:o.Popper,transition:o.Transition??se,tooltip:o.Tooltip,arrow:o.Arrow,...W},slotProps:{arrow:Q.arrow??c.arrow,popper:{...ae,...mt??c.popper},tooltip:Q.tooltip??c.tooltip,transition:{...he,...qt??c.transition}}},[Ar,$r]=Ei("popper",{elementType:hye,externalForwardedProps:Ir,ownerState:Et,className:An(Kt.popper,ae?.className)}),[hn,zr]=Ei("transition",{elementType:zb,externalForwardedProps:Ir,ownerState:Et}),[Mt,en]=Ei("tooltip",{elementType:fye,className:Kt.tooltip,externalForwardedProps:Ir,ownerState:Et}),[jn,Qr]=Ei("arrow",{elementType:dye,className:Kt.arrow,externalForwardedProps:Ir,ownerState:Et,ref:Ee});return J.jsxs(te.Fragment,{children:[te.cloneElement(Ce,We),J.jsx(Ar,{as:X??eY,placement:G,anchorEl:M?{getBoundingClientRect:()=>({top:i1.y,left:i1.x,right:i1.x,bottom:i1.y,width:0,height:0})}:Ae,popperRef:ke,open:Ae?Re:!1,id:zt,transition:!0,...Lt,...$r,popperOptions:ct,children:({TransitionProps:nr})=>J.jsx(hn,{timeout:me.transitions.duration.shorter,...nr,...zr,children:J.jsxs(Mt,{...en,children:[oe,i?J.jsx(jn,{...Qr}):null]})})})]})}),pye=Dr("div",{name:"MuiSwipeArea",shouldForwardProp:Al})(ci(({theme:t})=>({position:"fixed",top:0,left:0,bottom:0,zIndex:t.zIndex.drawer-1,variants:[{props:{anchor:"left"},style:{right:"auto"}},{props:{anchor:"right"},style:{left:"auto",right:0}},{props:{anchor:"top"},style:{bottom:"auto",right:0}},{props:{anchor:"bottom"},style:{top:"auto",bottom:0,right:0}}]}))),gye=te.forwardRef(function(e,r){const{anchor:n,classes:i={},className:a,width:s,style:o,...c}=e,h=e;return J.jsx(pye,{className:An("PrivateSwipeArea-root",i.root,i[`anchor${cn(n)}`],a),ref:r,style:{[xm(n)?"width":"height"]:s,...o},ownerState:h,...c})}),J2=3,vA=20;let Jd=null;function _A(t,e,r){return t==="right"?r.body.offsetWidth-e[0].pageX:e[0].pageX}function bA(t,e,r){return t==="bottom"?r.innerHeight-e[0].clientY:e[0].clientY}function a1(t,e){return t?e.clientWidth:e.clientHeight}function gz(t,e,r,n){return Math.min(Math.max(r?e-t:n+e-t,0),n)}function mye(t,e){const r=[];for(;t&&t!==e.parentElement;){const n=_c(e).getComputedStyle(t);n.getPropertyValue("position")==="absolute"||n.getPropertyValue("overflow-x")==="hidden"||(t.clientWidth>0&&t.scrollWidth>t.clientWidth||t.clientHeight>0&&t.scrollHeight>t.clientHeight)&&r.push(t),t=t.parentElement}return r}function yye({domTreeShapes:t,start:e,current:r,anchor:n}){const i={scrollPosition:{x:"scrollLeft",y:"scrollTop"},scrollLength:{x:"scrollWidth",y:"scrollHeight"},clientLength:{x:"clientWidth",y:"clientHeight"}};return t.some(a=>{let s=r>=e;(n==="top"||n==="left")&&(s=!s);const o=n==="left"||n==="right"?"x":"y",c=Math.round(a[i.scrollPosition[o]]),h=c>0,d=c+a[i.clientLength[o]]<a[i.scrollLength[o]];return!!(s&&d||!s&&h)})}const vye=typeof navigator<"u"&&/iPad|iPhone|iPod/.test(navigator.userAgent),_ye=te.forwardRef(function(e,r){const n=bi({name:"MuiSwipeableDrawer",props:e}),i=Lc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:s="left",disableBackdropTransition:o=!1,disableDiscovery:c=!1,disableSwipeToOpen:h=vye,hideBackdrop:d,hysteresis:m=.52,allowSwipeInChildren:b=!1,minFlingVelocity:x=450,ModalProps:{BackdropProps:E,...T}={},onClose:A,onOpen:M,open:F=!1,PaperProps:N={},SwipeAreaProps:O,swipeAreaWidth:U=20,transitionDuration:j=a,variant:H="temporary",slots:G={},slotProps:X={},...ae}=n,[Q,W]=te.useState(!1),oe=te.useRef({isSwiping:null}),se=te.useRef(),he=te.useRef(),_e=te.useRef(),Ce=Uo(N.ref,_e),me=te.useRef(!1),xe=te.useRef();Tu(()=>{xe.current=null},[F]);const Ae=te.useCallback((Xe,Be={})=>{const{mode:ot=null,changeTransition:Qe=!0}=Be,rt=M1(i,s),Re=["right","bottom"].includes(rt)?1:-1,zt=xm(s),st=zt?`translate(${Re*Xe}px, 0)`:`translate(0, ${Re*Xe}px)`,$e=_e.current.style;$e.webkitTransform=st,$e.transform=st;let Jt="";if(ot&&(Jt=i.transitions.create("all",xp({easing:void 0,style:void 0,timeout:j},{mode:ot}))),Qe&&($e.webkitTransition=Jt,$e.transition=Jt),!o&&!d){const Ht=he.current.style;Ht.opacity=1-Xe/a1(zt,_e.current),Qe&&(Ht.webkitTransition=Jt,Ht.transition=Jt)}},[s,o,d,i,j]),De=ou(Xe=>{if(!me.current)return;if(Jd=null,me.current=!1,hp.flushSync(()=>{W(!1)}),!oe.current.isSwiping){oe.current.isSwiping=null;return}oe.current.isSwiping=null;const Be=M1(i,s),ot=xm(s);let Qe;ot?Qe=_A(Be,Xe.changedTouches,cs(Xe.currentTarget)):Qe=bA(Be,Xe.changedTouches,_c(Xe.currentTarget));const rt=ot?oe.current.startX:oe.current.startY,Re=a1(ot,_e.current),zt=gz(Qe,rt,F,Re),st=zt/Re;if(Math.abs(oe.current.velocity)>x&&(xe.current=Math.abs((Re-zt)/oe.current.velocity)*1e3),F){oe.current.velocity>x||st>m?A():Ae(0,{mode:"exit"});return}oe.current.velocity<-x||1-st>m?M():Ae(a1(ot,_e.current),{mode:"enter"})}),de=(Xe=!1)=>{if(!Q){(Xe||!(c&&b))&&hp.flushSync(()=>{W(!0)});const Be=xm(s);!F&&_e.current&&Ae(a1(Be,_e.current)+(c?15:-vA),{changeTransition:!1}),oe.current.velocity=0,oe.current.lastTime=null,oe.current.lastTranslate=null,oe.current.paperHit=!1,me.current=!0}},Ee=ou(Xe=>{if(!_e.current||!me.current||Jd!==null&&Jd!==oe.current)return;de(!0);const Be=M1(i,s),ot=xm(s),Qe=_A(Be,Xe.touches,cs(Xe.currentTarget)),rt=bA(Be,Xe.touches,_c(Xe.currentTarget));if(F&&_e.current.contains(Xe.target)&&Jd===null){const Jt=mye(Xe.target,_e.current);if(yye({domTreeShapes:Jt,start:ot?oe.current.startX:oe.current.startY,current:ot?Qe:rt,anchor:s})){Jd=!0;return}Jd=oe.current}if(oe.current.isSwiping==null){const Jt=Math.abs(Qe-oe.current.startX),Ht=Math.abs(rt-oe.current.startY),pr=ot?Jt>Ht&&Jt>J2:Ht>Jt&&Ht>J2;if(pr&&Xe.cancelable&&Xe.preventDefault(),pr===!0||(ot?Ht>J2:Jt>J2)){if(oe.current.isSwiping=pr,!pr){De(Xe);return}oe.current.startX=Qe,oe.current.startY=rt,!c&&!F&&(ot?oe.current.startX-=vA:oe.current.startY-=vA)}}if(!oe.current.isSwiping)return;const Re=a1(ot,_e.current);let zt=ot?oe.current.startX:oe.current.startY;F&&!oe.current.paperHit&&(zt=Math.min(zt,Re));const st=gz(ot?Qe:rt,zt,F,Re);if(F)if(oe.current.paperHit)st===0&&(oe.current.startX=Qe,oe.current.startY=rt);else if(ot?Qe<Re:rt<Re)oe.current.paperHit=!0,oe.current.startX=Qe,oe.current.startY=rt;else return;oe.current.lastTranslate===null&&(oe.current.lastTranslate=st,oe.current.lastTime=performance.now()+1);const $e=(st-oe.current.lastTranslate)/(performance.now()-oe.current.lastTime)*1e3;oe.current.velocity=oe.current.velocity*.4+$e*.6,oe.current.lastTranslate=st,oe.current.lastTime=performance.now(),Xe.cancelable&&Xe.preventDefault(),Ae(st)}),we=ou(Xe=>{if(Xe.defaultPrevented||Xe.defaultMuiPrevented||F&&(d||!he.current.contains(Xe.target))&&!_e.current.contains(Xe.target))return;const Be=M1(i,s),ot=xm(s),Qe=_A(Be,Xe.touches,cs(Xe.currentTarget)),rt=bA(Be,Xe.touches,_c(Xe.currentTarget));if(!F){if(h||!(Xe.target===se.current||_e.current?.contains(Xe.target)&&(typeof b=="function"?b(Xe,se.current,_e.current):b)))return;if(ot){if(Qe>U)return}else if(rt>U)return}Xe.defaultMuiPrevented=!0,Jd=null,oe.current.startX=Qe,oe.current.startY=rt,de()});te.useEffect(()=>{if(H==="temporary"){const Xe=cs(_e.current);return Xe.addEventListener("touchstart",we),Xe.addEventListener("touchmove",Ee,{passive:!F}),Xe.addEventListener("touchend",De),()=>{Xe.removeEventListener("touchstart",we),Xe.removeEventListener("touchmove",Ee,{passive:!F}),Xe.removeEventListener("touchend",De)}}},[H,F,we,Ee,De]),te.useEffect(()=>()=>{Jd===oe.current&&(Jd=null)},[]),te.useEffect(()=>{F||W(!1)},[F]);const[Le,Fe]=Ei("swipeArea",{ref:se,elementType:gye,ownerState:n,externalForwardedProps:{slots:G,slotProps:{swipeArea:O,...X}},additionalProps:{width:U,anchor:s}});return J.jsxs(te.Fragment,{children:[J.jsx(lO,{open:H==="temporary"&&Q?!0:F,variant:H,ModalProps:{BackdropProps:{...E,ref:he},...H==="temporary"&&{keepMounted:!0},...T},hideBackdrop:d,anchor:s,transitionDuration:xe.current||j,onClose:A,ref:r,slots:G,slotProps:{...X,backdrop:Lb(X.backdrop??E,{ref:he}),paper:Lb(X.paper??N,{style:{pointerEvents:H==="temporary"&&!F&&!b?"none":""},ref:Ce})},...ae}),!h&&H==="temporary"&&J.jsx(Zge,{children:J.jsx(Le,{...Fe})})]})});function bye(t){return gi("MuiToolbar",t)}pi("MuiToolbar",["root","gutters","regular","dense"]);const xye=t=>{const{classes:e,disableGutters:r,variant:n}=t;return mi({root:["root",!r&&"gutters",n]},bye,e)},wye=Dr("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableGutters&&e.gutters,e[r.variant]]}})(ci(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}))),Sye=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiToolbar"}),{className:i,component:a="div",disableGutters:s=!1,variant:o="regular",...c}=n,h={...n,component:a,disableGutters:s,variant:o},d=xye(h);return J.jsx(wye,{as:a,className:An(d.root,i),ref:r,ownerState:h,...c})});function Eye(t){return gi("MuiTextField",t)}pi("MuiTextField",["root"]);const Tye={standard:cO,filled:uO,outlined:JT},Cye=t=>{const{classes:e}=t;return mi({root:["root"]},Eye,e)},Aye=Dr(ih,{name:"MuiTextField",slot:"Root"})({}),QT=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiTextField"}),{autoComplete:i,autoFocus:a=!1,children:s,className:o,color:c="primary",defaultValue:h,disabled:d=!1,error:m=!1,FormHelperTextProps:b,fullWidth:x=!1,helperText:E,id:T,InputLabelProps:A,inputProps:M,InputProps:F,inputRef:N,label:O,maxRows:U,minRows:j,multiline:H=!1,name:G,onBlur:X,onChange:ae,onFocus:Q,placeholder:W,required:oe=!1,rows:se,select:he=!1,SelectProps:_e,slots:Ce={},slotProps:me={},type:xe,value:Ae,variant:De="outlined",...de}=n,Ee={...n,autoFocus:a,color:c,disabled:d,error:m,fullWidth:x,multiline:H,required:oe,select:he,variant:De},we=Cye(Ee),Le=Og(T),Fe=E&&Le?`${Le}-helper-text`:void 0,Xe=O&&Le?`${Le}-label`:void 0,Be=Tye[De],ot={slots:Ce,slotProps:{input:F,inputLabel:A,htmlInput:M,formHelperText:b,select:_e,...me}},Qe={},rt=ot.slotProps.inputLabel;De==="outlined"&&(rt&&typeof rt.shrink<"u"&&(Qe.notched=rt.shrink),Qe.label=O),he&&((!_e||!_e.native)&&(Qe.id=void 0),Qe["aria-describedby"]=void 0);const[Re,zt]=Ei("root",{elementType:Aye,shouldForwardComponentProp:!0,externalForwardedProps:{...ot,...de},ownerState:Ee,className:An(we.root,o),ref:r,additionalProps:{disabled:d,error:m,fullWidth:x,required:oe,color:c,variant:De}}),[st,$e]=Ei("input",{elementType:Be,externalForwardedProps:ot,additionalProps:Qe,ownerState:Ee}),[Jt,Ht]=Ei("inputLabel",{elementType:_g,externalForwardedProps:ot,ownerState:Ee}),[pr,_t]=Ei("htmlInput",{elementType:"input",externalForwardedProps:ot,ownerState:Ee}),[vr,br]=Ei("formHelperText",{elementType:Gpe,externalForwardedProps:ot,ownerState:Ee}),[lr,Cr]=Ei("select",{elementType:bg,externalForwardedProps:ot,ownerState:Ee}),Tr=J.jsx(st,{"aria-describedby":Fe,autoComplete:i,autoFocus:a,defaultValue:h,fullWidth:x,multiline:H,name:G,rows:se,maxRows:U,minRows:j,type:xe,value:Ae,id:Le,inputRef:N,onBlur:X,onChange:ae,onFocus:Q,placeholder:W,inputProps:_t,slots:{input:Ce.htmlInput?pr:void 0},...$e});return J.jsxs(Re,{...zt,children:[O!=null&&O!==""&&J.jsx(Jt,{htmlFor:Le,id:Xe,...Ht,children:O}),he?J.jsx(lr,{"aria-describedby":Fe,id:Le,labelId:Xe,value:Ae,input:Tr,...Cr,children:s}):Tr,E&&J.jsx(vr,{id:Fe,...br,children:E})]})}),Ox=vX({themeId:Sf}),Iye=Ji(J.jsx("path",{d:"M5 15H3v4c0 1.1.9 2 2 2h4v-2H5zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2m0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2zM12 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),qk=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(!1),i=()=>{navigator.geolocation.getCurrentPosition(a,s)},a=te.useCallback(o=>{e.map?.map.setCenter?.([o.coords.longitude,o.coords.latitude])},[e.map]),s=()=>{console.log("Access of user location denied"),n(!0)};return J.jsx(J.Fragment,{children:J.jsx(ta,{variant:"navtools",sx:o=>({zIndex:1002,color:r?t.offColor??o.palette.navigation.buttonColor:t.onColor??o.palette.navigation.buttonColor}),onClick:i,disabled:r,children:J.jsx(Iye,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})})};try{qk.displayName="MlCenterPosition",qk.__docgenInfo={description:"Component template",displayName:"MlCenterPosition",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},onColor:{defaultValue:null,description:"Active button font color",name:"onColor",required:!1,type:{name:"string | undefined"}},offColor:{defaultValue:null,description:"Inactive button font color",name:"offColor",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"CSS style object that is applied to the button component",name:"style",required:!1,type:{name:"SxProps<Theme> | undefined"}}}}}catch{}const mz=t=>{const e=va({mapId:t.mapId});return console.log(e.componentId+" remove this log"),J.jsx(J.Fragment,{})};try{mz.displayName="MlComponentTemplate",mz.__docgenInfo={description:"Component description",displayName:"MlComponentTemplate",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const Pye=Ji(J.jsx("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3m-3 11H8v-5h8zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m-1-9H6v4h12z"}));function fo(t){"@babel/helpers - typeof";return fo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fo(t)}var Tf=Uint8Array,ah=Uint16Array,pO=Int32Array,gO=new Tf([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),mO=new Tf([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),yz=new Tf([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),TY=function(t,e){for(var r=new ah(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new pO(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},CY=TY(gO,2),kye=CY.b,Hk=CY.r;kye[28]=258,Hk[258]=28;var Rye=TY(mO,0),vz=Rye.r,Wk=new ah(32768);for(var Qo=0;Qo<32768;++Qo){var Jp=(Qo&43690)>>1|(Qo&21845)<<1;Jp=(Jp&52428)>>2|(Jp&13107)<<2,Jp=(Jp&61680)>>4|(Jp&3855)<<4,Wk[Qo]=((Jp&65280)>>8|(Jp&255)<<8)>>1}var cb=(function(t,e,r){for(var n=t.length,i=0,a=new ah(e);i<n;++i)t[i]&&++a[t[i]-1];var s=new ah(e);for(i=1;i<e;++i)s[i]=s[i-1]+a[i-1]<<1;var o;if(r){o=new ah(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var h=i<<4|t[i],d=e-t[i],m=s[t[i]-1]++<<d,b=m|(1<<d)-1;m<=b;++m)o[Wk[m]>>c]=h}else for(o=new ah(n),i=0;i<n;++i)t[i]&&(o[i]=Wk[s[t[i]-1]++]>>15-t[i]);return o}),Km=new Tf(288);for(var Qo=0;Qo<144;++Qo)Km[Qo]=8;for(var Qo=144;Qo<256;++Qo)Km[Qo]=9;for(var Qo=256;Qo<280;++Qo)Km[Qo]=7;for(var Qo=280;Qo<288;++Qo)Km[Qo]=8;var ZS=new Tf(32);for(var Qo=0;Qo<32;++Qo)ZS[Qo]=5;var Mye=cb(Km,9,0),Dye=cb(ZS,5,0),AY=function(t){return(t+7)/8|0},Oye=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Tf(t.subarray(e,r))},Qd=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},o1=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},xA=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,a=r.slice();if(!i)return{t:PY,l:0};if(i==1){var s=new Tf(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(U,j){return U.f-j.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],h=0,d=1,m=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};d!=i-1;)o=r[r[h].f<r[m].f?h++:m++],c=r[h!=d&&r[h].f<r[m].f?h++:m++],r[d++]={s:-1,f:o.f+c.f,l:o,r:c};for(var b=a[0].s,n=1;n<i;++n)a[n].s>b&&(b=a[n].s);var x=new ah(b+1),E=Gk(r[d-1],x,0);if(E>e){var n=0,T=0,A=E-e,M=1<<A;for(a.sort(function(j,H){return x[H.s]-x[j.s]||j.f-H.f});n<i;++n){var F=a[n].s;if(x[F]>e)T+=M-(1<<E-x[F]),x[F]=e;else break}for(T>>=A;T>0;){var N=a[n].s;x[N]<e?T-=1<<e-x[N]++-1:++n}for(;n>=0&&T;--n){var O=a[n].s;x[O]==e&&(--x[O],++T)}E=e}return{t:new Tf(x),l:E}},Gk=function(t,e,r){return t.s==-1?Math.max(Gk(t.l,e,r+1),Gk(t.r,e,r+1)):e[t.s]=r},_z=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new ah(++e),n=0,i=t[0],a=1,s=function(c){r[n++]=c},o=1;o<=e;++o)if(t[o]==i&&o!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(i),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(i);a=1,i=t[o]}return{c:r.subarray(0,n),n:e}},s1=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},IY=function(t,e,r){var n=r.length,i=AY(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<n;++a)t[i+a+4]=r[a];return(i+4+n)*8},bz=function(t,e,r,n,i,a,s,o,c,h,d){Qd(e,d++,r),++i[256];for(var m=xA(i,15),b=m.t,x=m.l,E=xA(a,15),T=E.t,A=E.l,M=_z(b),F=M.c,N=M.n,O=_z(T),U=O.c,j=O.n,H=new ah(19),G=0;G<F.length;++G)++H[F[G]&31];for(var G=0;G<U.length;++G)++H[U[G]&31];for(var X=xA(H,7),ae=X.t,Q=X.l,W=19;W>4&&!ae[yz[W-1]];--W);var oe=h+5<<3,se=s1(i,Km)+s1(a,ZS)+s,he=s1(i,b)+s1(a,T)+s+14+3*W+s1(H,ae)+2*H[16]+3*H[17]+7*H[18];if(c>=0&&oe<=se&&oe<=he)return IY(e,d,t.subarray(c,c+h));var _e,Ce,me,xe;if(Qd(e,d,1+(he<se)),d+=2,he<se){_e=cb(b,x,0),Ce=b,me=cb(T,A,0),xe=T;var Ae=cb(ae,Q,0);Qd(e,d,N-257),Qd(e,d+5,j-1),Qd(e,d+10,W-4),d+=14;for(var G=0;G<W;++G)Qd(e,d+3*G,ae[yz[G]]);d+=3*W;for(var De=[F,U],de=0;de<2;++de)for(var Ee=De[de],G=0;G<Ee.length;++G){var we=Ee[G]&31;Qd(e,d,Ae[we]),d+=ae[we],we>15&&(Qd(e,d,Ee[G]>>5&127),d+=Ee[G]>>12)}}else _e=Mye,Ce=Km,me=Dye,xe=ZS;for(var G=0;G<o;++G){var Le=n[G];if(Le>255){var we=Le>>18&31;o1(e,d,_e[we+257]),d+=Ce[we+257],we>7&&(Qd(e,d,Le>>23&31),d+=gO[we]);var Fe=Le&31;o1(e,d,me[Fe]),d+=xe[Fe],Fe>3&&(o1(e,d,Le>>5&8191),d+=mO[Fe])}else o1(e,d,_e[Le]),d+=Ce[Le]}return o1(e,d,_e[256]),d+Ce[256]},Nye=new pO([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),PY=new Tf(0),Lye=function(t,e,r,n,i,a){var s=a.z||t.length,o=new Tf(n+s+5*(1+Math.ceil(s/7e3))+i),c=o.subarray(n,o.length-i),h=a.l,d=(a.r||0)&7;if(e){d&&(c[0]=a.r>>3);for(var m=Nye[e-1],b=m>>13,x=m&8191,E=(1<<r)-1,T=a.p||new ah(32768),A=a.h||new ah(E+1),M=Math.ceil(r/3),F=2*M,N=function(st){return(t[st]^t[st+1]<<M^t[st+2]<<F)&E},O=new pO(25e3),U=new ah(288),j=new ah(32),H=0,G=0,X=a.i||0,ae=0,Q=a.w||0,W=0;X+2<s;++X){var oe=N(X),se=X&32767,he=A[oe];if(T[se]=he,A[oe]=se,Q<=X){var _e=s-X;if((H>7e3||ae>24576)&&(_e>423||!h)){d=bz(t,c,0,O,U,j,G,ae,W,X-W,d),ae=H=G=0,W=X;for(var Ce=0;Ce<286;++Ce)U[Ce]=0;for(var Ce=0;Ce<30;++Ce)j[Ce]=0}var me=2,xe=0,Ae=x,De=se-he&32767;if(_e>2&&oe==N(X-De))for(var de=Math.min(b,_e)-1,Ee=Math.min(32767,X),we=Math.min(258,_e);De<=Ee&&--Ae&&se!=he;){if(t[X+me]==t[X+me-De]){for(var Le=0;Le<we&&t[X+Le]==t[X+Le-De];++Le);if(Le>me){if(me=Le,xe=De,Le>de)break;for(var Fe=Math.min(De,Le-2),Xe=0,Ce=0;Ce<Fe;++Ce){var Be=X-De+Ce&32767,ot=T[Be],Qe=Be-ot&32767;Qe>Xe&&(Xe=Qe,he=Be)}}}se=he,he=T[se],De+=se-he&32767}if(xe){O[ae++]=268435456|Hk[me]<<18|vz[xe];var rt=Hk[me]&31,Re=vz[xe]&31;G+=gO[rt]+mO[Re],++U[257+rt],++j[Re],Q=X+me,++H}else O[ae++]=t[X],++U[t[X]]}}for(X=Math.max(X,Q);X<s;++X)O[ae++]=t[X],++U[t[X]];d=bz(t,c,h,O,U,j,G,ae,W,X-W,d),h||(a.r=d&7|c[d/8|0]<<3,d-=7,a.h=A,a.p=T,a.i=X,a.w=Q)}else{for(var X=a.w||0;X<s+h;X+=65535){var zt=X+65535;zt>=s&&(c[d/8|0]=h,zt=s),d=IY(c,d+1,t.subarray(X,zt))}a.i=s}return Oye(o,0,n+AY(d)+i)},kY=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,a=r.length|0,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},Fye=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),s=new Tf(a.length+t.length);s.set(a),s.set(t,a.length),t=s,i.w=a.length}return Lye(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},RY=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},Bye=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=kY();i.p(e.dictionary),RY(t,2,i.d())}};function Xk(t,e){e||(e={});var r=kY();r.p(t);var n=Fye(t,e,e.dictionary?6:2,4);return Bye(n,e),RY(n,n.length-4,r.d()),n}var zye=typeof TextDecoder<"u"&&new TextDecoder,jye=0;try{zye.decode(PY,{stream:!0}),jye=1}catch{}function Uye(t){if(Array.isArray(t))return t}function Vye(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],c=!0,h=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(c=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);c=!0);}catch(d){h=!0,i=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(h)throw i}}return o}}function xz(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function $ye(t,e){if(t){if(typeof t=="string")return xz(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xz(t,e):void 0}}function qye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wz(t,e){return Uye(t)||Vye(t,e)||$ye(t,e)||qye()}function Sz(t,e="utf8"){return new TextDecoder(e).decode(t)}const Hye=new TextEncoder;function Wye(t){return Hye.encode(t)}const Gye=1024*8,Xye=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),wA={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class yO{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=Gye,r={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const i=r.offset?r.offset>>>0:0,a=e.byteLength-i;let s=i;(ArrayBuffer.isView(e)||e instanceof yO)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+i),e=e.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=wA[r].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,a=this.buffer.slice(i,i+n);if(this.littleEndian===Xye&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(i,i+n));o.reverse();const c=new wA[r](o.buffer);return this.offset+=n,c.reverse(),c}const s=new wA[r](a);return this.offset+=n,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return Sz(this.readBytes(e))}decodeText(e=1,r="utf8"){return Sz(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(Wye(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function f_(t){let e=t.length;for(;--e>=0;)t[e]=0}const Yye=3,Zye=258,MY=29,Kye=256,Jye=Kye+1+MY,DY=30,Qye=512,eve=new Array((Jye+2)*2);f_(eve);const tve=new Array(DY*2);f_(tve);const rve=new Array(Qye);f_(rve);const nve=new Array(Zye-Yye+1);f_(nve);const ive=new Array(MY);f_(ive);const ave=new Array(DY);f_(ave);const ove=(t,e,r,n)=>{let i=t&65535|0,a=t>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do i=i+e[n++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16|0};var Yk=ove;const sve=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},lve=new Uint32Array(sve()),uve=(t,e,r,n)=>{const i=lve,a=n+r;t^=-1;for(let s=n;s<a;s++)t=t>>>8^i[(t^e[s])&255];return t^-1};var td=uve,Zk={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},OY={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const cve=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var hve=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)cve(r,n)&&(t[n]=r[n])}}return t},fve=t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,a=t.length;n<a;n++){let s=t[n];r.set(s,i),i+=s.length}return r},NY={assign:hve,flattenChunks:fve};let LY=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{LY=!1}const Ub=new Uint8Array(256);for(let t=0;t<256;t++)Ub[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Ub[254]=Ub[254]=1;var dve=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,a,s=t.length,o=0;for(i=0;i<s;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(o),a=0,i=0;a<o;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|r&63):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|r&63):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|r&63);return e};const pve=(t,e)=>{if(e<65534&&t.subarray&&LY)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var gve=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const a=new Array(r*2);for(i=0,n=0;n<r;){let s=t[n++];if(s<128){a[i++]=s;continue}let o=Ub[s];if(o>4){a[i++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<r;)s=s<<6|t[n++]&63,o--;if(o>1){a[i++]=65533;continue}s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|s&1023)}return pve(a,i)},mve=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+Ub[t[r]]>e?r:e},Kk={string2buf:dve,buf2string:gve,utf8border:mve};function yve(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var vve=yve;const Q2=16209,_ve=16191;var bve=function(e,r){let n,i,a,s,o,c,h,d,m,b,x,E,T,A,M,F,N,O,U,j,H,G,X,ae;const Q=e.state;n=e.next_in,X=e.input,i=n+(e.avail_in-5),a=e.next_out,ae=e.output,s=a-(r-e.avail_out),o=a+(e.avail_out-257),c=Q.dmax,h=Q.wsize,d=Q.whave,m=Q.wnext,b=Q.window,x=Q.hold,E=Q.bits,T=Q.lencode,A=Q.distcode,M=(1<<Q.lenbits)-1,F=(1<<Q.distbits)-1;e:do{E<15&&(x+=X[n++]<<E,E+=8,x+=X[n++]<<E,E+=8),N=T[x&M];t:for(;;){if(O=N>>>24,x>>>=O,E-=O,O=N>>>16&255,O===0)ae[a++]=N&65535;else if(O&16){U=N&65535,O&=15,O&&(E<O&&(x+=X[n++]<<E,E+=8),U+=x&(1<<O)-1,x>>>=O,E-=O),E<15&&(x+=X[n++]<<E,E+=8,x+=X[n++]<<E,E+=8),N=A[x&F];r:for(;;){if(O=N>>>24,x>>>=O,E-=O,O=N>>>16&255,O&16){if(j=N&65535,O&=15,E<O&&(x+=X[n++]<<E,E+=8,E<O&&(x+=X[n++]<<E,E+=8)),j+=x&(1<<O)-1,j>c){e.msg="invalid distance too far back",Q.mode=Q2;break e}if(x>>>=O,E-=O,O=a-s,j>O){if(O=j-O,O>d&&Q.sane){e.msg="invalid distance too far back",Q.mode=Q2;break e}if(H=0,G=b,m===0){if(H+=h-O,O<U){U-=O;do ae[a++]=b[H++];while(--O);H=a-j,G=ae}}else if(m<O){if(H+=h+m-O,O-=m,O<U){U-=O;do ae[a++]=b[H++];while(--O);if(H=0,m<U){O=m,U-=O;do ae[a++]=b[H++];while(--O);H=a-j,G=ae}}}else if(H+=m-O,O<U){U-=O;do ae[a++]=b[H++];while(--O);H=a-j,G=ae}for(;U>2;)ae[a++]=G[H++],ae[a++]=G[H++],ae[a++]=G[H++],U-=3;U&&(ae[a++]=G[H++],U>1&&(ae[a++]=G[H++]))}else{H=a-j;do ae[a++]=ae[H++],ae[a++]=ae[H++],ae[a++]=ae[H++],U-=3;while(U>2);U&&(ae[a++]=ae[H++],U>1&&(ae[a++]=ae[H++]))}}else if((O&64)===0){N=A[(N&65535)+(x&(1<<O)-1)];continue r}else{e.msg="invalid distance code",Q.mode=Q2;break e}break}}else if((O&64)===0){N=T[(N&65535)+(x&(1<<O)-1)];continue t}else if(O&32){Q.mode=_ve;break e}else{e.msg="invalid literal/length code",Q.mode=Q2;break e}break}}while(n<i&&a<o);U=E>>3,n-=U,E-=U<<3,x&=(1<<E)-1,e.next_in=n,e.next_out=a,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=a<o?257+(o-a):257-(a-o),Q.hold=x,Q.bits=E};const pv=15,Ez=852,Tz=592,Cz=0,SA=1,Az=2,xve=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),wve=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Sve=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Eve=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Tve=(t,e,r,n,i,a,s,o)=>{const c=o.bits;let h=0,d=0,m=0,b=0,x=0,E=0,T=0,A=0,M=0,F=0,N,O,U,j,H,G=null,X;const ae=new Uint16Array(pv+1),Q=new Uint16Array(pv+1);let W=null,oe,se,he;for(h=0;h<=pv;h++)ae[h]=0;for(d=0;d<n;d++)ae[e[r+d]]++;for(x=c,b=pv;b>=1&&ae[b]===0;b--);if(x>b&&(x=b),b===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,o.bits=1,0;for(m=1;m<b&&ae[m]===0;m++);for(x<m&&(x=m),A=1,h=1;h<=pv;h++)if(A<<=1,A-=ae[h],A<0)return-1;if(A>0&&(t===Cz||b!==1))return-1;for(Q[1]=0,h=1;h<pv;h++)Q[h+1]=Q[h]+ae[h];for(d=0;d<n;d++)e[r+d]!==0&&(s[Q[e[r+d]]++]=d);if(t===Cz?(G=W=s,X=20):t===SA?(G=xve,W=wve,X=257):(G=Sve,W=Eve,X=0),F=0,d=0,h=m,H=a,E=x,T=0,U=-1,M=1<<x,j=M-1,t===SA&&M>Ez||t===Az&&M>Tz)return 1;for(;;){oe=h-T,s[d]+1<X?(se=0,he=s[d]):s[d]>=X?(se=W[s[d]-X],he=G[s[d]-X]):(se=96,he=0),N=1<<h-T,O=1<<E,m=O;do O-=N,i[H+(F>>T)+O]=oe<<24|se<<16|he|0;while(O!==0);for(N=1<<h-1;F&N;)N>>=1;if(N!==0?(F&=N-1,F+=N):F=0,d++,--ae[h]===0){if(h===b)break;h=e[r+s[d]]}if(h>x&&(F&j)!==U){for(T===0&&(T=x),H+=m,E=h-T,A=1<<E;E+T<b&&(A-=ae[E+T],!(A<=0));)E++,A<<=1;if(M+=1<<E,t===SA&&M>Ez||t===Az&&M>Tz)return 1;U=F&j,i[U]=x<<24|E<<16|H-a|0}}return F!==0&&(i[H+F]=h-T<<24|64<<16|0),o.bits=x,0};var hb=Tve;const Cve=0,FY=1,BY=2,{Z_FINISH:Iz,Z_BLOCK:Ave,Z_TREES:ew,Z_OK:Jm,Z_STREAM_END:Ive,Z_NEED_DICT:Pve,Z_STREAM_ERROR:qh,Z_DATA_ERROR:zY,Z_MEM_ERROR:jY,Z_BUF_ERROR:kve,Z_DEFLATED:Pz}=OY,e3=16180,kz=16181,Rz=16182,Mz=16183,Dz=16184,Oz=16185,Nz=16186,Lz=16187,Fz=16188,Bz=16189,KS=16190,ep=16191,EA=16192,zz=16193,TA=16194,jz=16195,Uz=16196,Vz=16197,$z=16198,tw=16199,rw=16200,qz=16201,Hz=16202,Wz=16203,Gz=16204,Xz=16205,CA=16206,Yz=16207,Zz=16208,ls=16209,UY=16210,VY=16211,Rve=852,Mve=592,Dve=15,Ove=Dve,Kz=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Nve(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const xy=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<e3||e.mode>VY?1:0},$Y=t=>{if(xy(t))return qh;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=e3,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Rve),e.distcode=e.distdyn=new Int32Array(Mve),e.sane=1,e.back=-1,Jm},qY=t=>{if(xy(t))return qh;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,$Y(t)},HY=(t,e)=>{let r;if(xy(t))return qh;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?qh:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,qY(t))},WY=(t,e)=>{if(!t)return qh;const r=new Nve;t.state=r,r.strm=t,r.window=null,r.mode=e3;const n=HY(t,e);return n!==Jm&&(t.state=null),n},Lve=t=>WY(t,Ove);let Jz=!0,AA,IA;const Fve=t=>{if(Jz){AA=new Int32Array(512),IA=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(hb(FY,t.lens,0,288,AA,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;hb(BY,t.lens,0,32,IA,0,t.work,{bits:5}),Jz=!1}t.lencode=AA,t.lenbits=9,t.distcode=IA,t.distbits=5},GY=(t,e,r,n)=>{let i;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),a.window.set(e.subarray(r-n,r-n+i),a.wnext),n-=i,n?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},Bve=(t,e)=>{let r,n,i,a,s,o,c,h,d,m,b,x,E,T,A=0,M,F,N,O,U,j,H,G;const X=new Uint8Array(4);let ae,Q;const W=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(xy(t)||!t.output||!t.input&&t.avail_in!==0)return qh;r=t.state,r.mode===ep&&(r.mode=EA),s=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,n=t.input,o=t.avail_in,h=r.hold,d=r.bits,m=o,b=c,G=Jm;e:for(;;)switch(r.mode){case e3:if(r.wrap===0){r.mode=EA;break}for(;d<16;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}if(r.wrap&2&&h===35615){r.wbits===0&&(r.wbits=15),r.check=0,X[0]=h&255,X[1]=h>>>8&255,r.check=td(r.check,X,2,0),h=0,d=0,r.mode=kz;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((h&255)<<8)+(h>>8))%31){t.msg="incorrect header check",r.mode=ls;break}if((h&15)!==Pz){t.msg="unknown compression method",r.mode=ls;break}if(h>>>=4,d-=4,H=(h&15)+8,r.wbits===0&&(r.wbits=H),H>15||H>r.wbits){t.msg="invalid window size",r.mode=ls;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=h&512?Bz:ep,h=0,d=0;break;case kz:for(;d<16;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}if(r.flags=h,(r.flags&255)!==Pz){t.msg="unknown compression method",r.mode=ls;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=ls;break}r.head&&(r.head.text=h>>8&1),r.flags&512&&r.wrap&4&&(X[0]=h&255,X[1]=h>>>8&255,r.check=td(r.check,X,2,0)),h=0,d=0,r.mode=Rz;case Rz:for(;d<32;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}r.head&&(r.head.time=h),r.flags&512&&r.wrap&4&&(X[0]=h&255,X[1]=h>>>8&255,X[2]=h>>>16&255,X[3]=h>>>24&255,r.check=td(r.check,X,4,0)),h=0,d=0,r.mode=Mz;case Mz:for(;d<16;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}r.head&&(r.head.xflags=h&255,r.head.os=h>>8),r.flags&512&&r.wrap&4&&(X[0]=h&255,X[1]=h>>>8&255,r.check=td(r.check,X,2,0)),h=0,d=0,r.mode=Dz;case Dz:if(r.flags&1024){for(;d<16;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}r.length=h,r.head&&(r.head.extra_len=h),r.flags&512&&r.wrap&4&&(X[0]=h&255,X[1]=h>>>8&255,r.check=td(r.check,X,2,0)),h=0,d=0}else r.head&&(r.head.extra=null);r.mode=Oz;case Oz:if(r.flags&1024&&(x=r.length,x>o&&(x=o),x&&(r.head&&(H=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+x),H)),r.flags&512&&r.wrap&4&&(r.check=td(r.check,n,x,a)),o-=x,a+=x,r.length-=x),r.length))break e;r.length=0,r.mode=Nz;case Nz:if(r.flags&2048){if(o===0)break e;x=0;do H=n[a+x++],r.head&&H&&r.length<65536&&(r.head.name+=String.fromCharCode(H));while(H&&x<o);if(r.flags&512&&r.wrap&4&&(r.check=td(r.check,n,x,a)),o-=x,a+=x,H)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Lz;case Lz:if(r.flags&4096){if(o===0)break e;x=0;do H=n[a+x++],r.head&&H&&r.length<65536&&(r.head.comment+=String.fromCharCode(H));while(H&&x<o);if(r.flags&512&&r.wrap&4&&(r.check=td(r.check,n,x,a)),o-=x,a+=x,H)break e}else r.head&&(r.head.comment=null);r.mode=Fz;case Fz:if(r.flags&512){for(;d<16;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}if(r.wrap&4&&h!==(r.check&65535)){t.msg="header crc mismatch",r.mode=ls;break}h=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=ep;break;case Bz:for(;d<32;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}t.adler=r.check=Kz(h),h=0,d=0,r.mode=KS;case KS:if(r.havedict===0)return t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,r.hold=h,r.bits=d,Pve;t.adler=r.check=1,r.mode=ep;case ep:if(e===Ave||e===ew)break e;case EA:if(r.last){h>>>=d&7,d-=d&7,r.mode=CA;break}for(;d<3;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}switch(r.last=h&1,h>>>=1,d-=1,h&3){case 0:r.mode=zz;break;case 1:if(Fve(r),r.mode=tw,e===ew){h>>>=2,d-=2;break e}break;case 2:r.mode=Uz;break;case 3:t.msg="invalid block type",r.mode=ls}h>>>=2,d-=2;break;case zz:for(h>>>=d&7,d-=d&7;d<32;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}if((h&65535)!==(h>>>16^65535)){t.msg="invalid stored block lengths",r.mode=ls;break}if(r.length=h&65535,h=0,d=0,r.mode=TA,e===ew)break e;case TA:r.mode=jz;case jz:if(x=r.length,x){if(x>o&&(x=o),x>c&&(x=c),x===0)break e;i.set(n.subarray(a,a+x),s),o-=x,a+=x,c-=x,s+=x,r.length-=x;break}r.mode=ep;break;case Uz:for(;d<14;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}if(r.nlen=(h&31)+257,h>>>=5,d-=5,r.ndist=(h&31)+1,h>>>=5,d-=5,r.ncode=(h&15)+4,h>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=ls;break}r.have=0,r.mode=Vz;case Vz:for(;r.have<r.ncode;){for(;d<3;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}r.lens[W[r.have++]]=h&7,h>>>=3,d-=3}for(;r.have<19;)r.lens[W[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,ae={bits:r.lenbits},G=hb(Cve,r.lens,0,19,r.lencode,0,r.work,ae),r.lenbits=ae.bits,G){t.msg="invalid code lengths set",r.mode=ls;break}r.have=0,r.mode=$z;case $z:for(;r.have<r.nlen+r.ndist;){for(;A=r.lencode[h&(1<<r.lenbits)-1],M=A>>>24,F=A>>>16&255,N=A&65535,!(M<=d);){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}if(N<16)h>>>=M,d-=M,r.lens[r.have++]=N;else{if(N===16){for(Q=M+2;d<Q;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}if(h>>>=M,d-=M,r.have===0){t.msg="invalid bit length repeat",r.mode=ls;break}H=r.lens[r.have-1],x=3+(h&3),h>>>=2,d-=2}else if(N===17){for(Q=M+3;d<Q;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}h>>>=M,d-=M,H=0,x=3+(h&7),h>>>=3,d-=3}else{for(Q=M+7;d<Q;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}h>>>=M,d-=M,H=0,x=11+(h&127),h>>>=7,d-=7}if(r.have+x>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=ls;break}for(;x--;)r.lens[r.have++]=H}}if(r.mode===ls)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=ls;break}if(r.lenbits=9,ae={bits:r.lenbits},G=hb(FY,r.lens,0,r.nlen,r.lencode,0,r.work,ae),r.lenbits=ae.bits,G){t.msg="invalid literal/lengths set",r.mode=ls;break}if(r.distbits=6,r.distcode=r.distdyn,ae={bits:r.distbits},G=hb(BY,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,ae),r.distbits=ae.bits,G){t.msg="invalid distances set",r.mode=ls;break}if(r.mode=tw,e===ew)break e;case tw:r.mode=rw;case rw:if(o>=6&&c>=258){t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,r.hold=h,r.bits=d,bve(t,b),s=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,n=t.input,o=t.avail_in,h=r.hold,d=r.bits,r.mode===ep&&(r.back=-1);break}for(r.back=0;A=r.lencode[h&(1<<r.lenbits)-1],M=A>>>24,F=A>>>16&255,N=A&65535,!(M<=d);){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}if(F&&(F&240)===0){for(O=M,U=F,j=N;A=r.lencode[j+((h&(1<<O+U)-1)>>O)],M=A>>>24,F=A>>>16&255,N=A&65535,!(O+M<=d);){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}h>>>=O,d-=O,r.back+=O}if(h>>>=M,d-=M,r.back+=M,r.length=N,F===0){r.mode=Xz;break}if(F&32){r.back=-1,r.mode=ep;break}if(F&64){t.msg="invalid literal/length code",r.mode=ls;break}r.extra=F&15,r.mode=qz;case qz:if(r.extra){for(Q=r.extra;d<Q;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Hz;case Hz:for(;A=r.distcode[h&(1<<r.distbits)-1],M=A>>>24,F=A>>>16&255,N=A&65535,!(M<=d);){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}if((F&240)===0){for(O=M,U=F,j=N;A=r.distcode[j+((h&(1<<O+U)-1)>>O)],M=A>>>24,F=A>>>16&255,N=A&65535,!(O+M<=d);){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}h>>>=O,d-=O,r.back+=O}if(h>>>=M,d-=M,r.back+=M,F&64){t.msg="invalid distance code",r.mode=ls;break}r.offset=N,r.extra=F&15,r.mode=Wz;case Wz:if(r.extra){for(Q=r.extra;d<Q;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=ls;break}r.mode=Gz;case Gz:if(c===0)break e;if(x=b-c,r.offset>x){if(x=r.offset-x,x>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=ls;break}x>r.wnext?(x-=r.wnext,E=r.wsize-x):E=r.wnext-x,x>r.length&&(x=r.length),T=r.window}else T=i,E=s-r.offset,x=r.length;x>c&&(x=c),c-=x,r.length-=x;do i[s++]=T[E++];while(--x);r.length===0&&(r.mode=rw);break;case Xz:if(c===0)break e;i[s++]=r.length,c--,r.mode=rw;break;case CA:if(r.wrap){for(;d<32;){if(o===0)break e;o--,h|=n[a++]<<d,d+=8}if(b-=c,t.total_out+=b,r.total+=b,r.wrap&4&&b&&(t.adler=r.check=r.flags?td(r.check,i,b,s-b):Yk(r.check,i,b,s-b)),b=c,r.wrap&4&&(r.flags?h:Kz(h))!==r.check){t.msg="incorrect data check",r.mode=ls;break}h=0,d=0}r.mode=Yz;case Yz:if(r.wrap&&r.flags){for(;d<32;){if(o===0)break e;o--,h+=n[a++]<<d,d+=8}if(r.wrap&4&&h!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=ls;break}h=0,d=0}r.mode=Zz;case Zz:G=Ive;break e;case ls:G=zY;break e;case UY:return jY;case VY:default:return qh}return t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,r.hold=h,r.bits=d,(r.wsize||b!==t.avail_out&&r.mode<ls&&(r.mode<CA||e!==Iz))&&GY(t,t.output,t.next_out,b-t.avail_out),m-=t.avail_in,b-=t.avail_out,t.total_in+=m,t.total_out+=b,r.total+=b,r.wrap&4&&b&&(t.adler=r.check=r.flags?td(r.check,i,b,t.next_out-b):Yk(r.check,i,b,t.next_out-b)),t.data_type=r.bits+(r.last?64:0)+(r.mode===ep?128:0)+(r.mode===tw||r.mode===TA?256:0),(m===0&&b===0||e===Iz)&&G===Jm&&(G=kve),G},zve=t=>{if(xy(t))return qh;let e=t.state;return e.window&&(e.window=null),t.state=null,Jm},jve=(t,e)=>{if(xy(t))return qh;const r=t.state;return(r.wrap&2)===0?qh:(r.head=e,e.done=!1,Jm)},Uve=(t,e)=>{const r=e.length;let n,i,a;return xy(t)||(n=t.state,n.wrap!==0&&n.mode!==KS)?qh:n.mode===KS&&(i=1,i=Yk(i,e,r,0),i!==n.check)?zY:(a=GY(t,e,r,r),a?(n.mode=UY,jY):(n.havedict=1,Jm))};var Vve=qY,$ve=HY,qve=$Y,Hve=Lve,Wve=WY,Gve=Bve,Xve=zve,Yve=jve,Zve=Uve,Kve="pako inflate (from Nodeca project)",ap={inflateReset:Vve,inflateReset2:$ve,inflateResetKeep:qve,inflateInit:Hve,inflateInit2:Wve,inflate:Gve,inflateEnd:Xve,inflateGetHeader:Yve,inflateSetDictionary:Zve,inflateInfo:Kve};function Jve(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Qve=Jve;const XY=Object.prototype.toString,{Z_NO_FLUSH:e0e,Z_FINISH:t0e,Z_OK:Vb,Z_STREAM_END:PA,Z_NEED_DICT:kA,Z_STREAM_ERROR:r0e,Z_DATA_ERROR:Qz,Z_MEM_ERROR:n0e}=OY;function Nx(t){this.options=NY.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vve,this.strm.avail_out=0;let r=ap.inflateInit2(this.strm,e.windowBits);if(r!==Vb)throw new Error(Zk[r]);if(this.header=new Qve,ap.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Kk.string2buf(e.dictionary):XY.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=ap.inflateSetDictionary(this.strm,e.dictionary),r!==Vb)))throw new Error(Zk[r])}Nx.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?t0e:e0e,XY.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=ap.inflate(r,s),a===kA&&i&&(a=ap.inflateSetDictionary(r,i),a===Vb?a=ap.inflate(r,s):a===Qz&&(a=kA));r.avail_in>0&&a===PA&&r.state.wrap>0&&t[r.next_in]!==0;)ap.inflateReset(r),a=ap.inflate(r,s);switch(a){case r0e:case Qz:case kA:case n0e:return this.onEnd(a),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||a===PA))if(this.options.to==="string"){let c=Kk.utf8border(r.output,r.next_out),h=r.next_out-c,d=Kk.buf2string(r.output,c);r.next_out=h,r.avail_out=n-h,h&&r.output.set(r.output.subarray(c,c+h),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===Vb&&o===0)){if(a===PA)return a=ap.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Nx.prototype.onData=function(t){this.chunks.push(t)};Nx.prototype.onEnd=function(t){t===Vb&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=NY.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function i0e(t,e){const r=new Nx(e);if(r.push(t),r.err)throw r.msg||Zk[r.err];return r.result}var a0e=Nx,o0e=i0e,s0e={Inflate:a0e,inflate:o0e};const{Inflate:l0e,inflate:u0e}=s0e;var e9=l0e,c0e=u0e;const YY=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;YY[t]=e}const t9=4294967295;function h0e(t,e,r){let n=t;for(let i=0;i<r;i++)n=YY[(n^e[i])&255]^n>>>8;return n}function f0e(t,e){return(h0e(t9,t,e)^t9)>>>0}function r9(t,e,r){const n=t.readUint32(),i=f0e(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function ZY(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function KY(t,e,r,n){let i=0;for(;i<n;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+e[i-n]&255}function JY(t,e,r,n){let i=0;if(r.length===0)for(;i<n;i++)e[i]=t[i];else for(;i<n;i++)e[i]=t[i]+r[i]&255}function QY(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+(e[a-i]>>1)&255}else{for(;a<i;a++)e[a]=t[a]+(r[a]>>1)&255;for(;a<n;a++)e[a]=t[a]+(e[a-i]+r[a]>>1)&255}}function eZ(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-i]&255}else{for(;a<i;a++)e[a]=t[a]+r[a]&255;for(;a<n;a++)e[a]=t[a]+d0e(e[a-i],r[a],r[a-i])&255}}function d0e(t,e,r){const n=t+e-r,i=Math.abs(n-t),a=Math.abs(n-e),s=Math.abs(n-r);return i<=a&&i<=s?t:a<=s?e:r}function p0e(t,e,r,n,i,a){switch(t){case 0:ZY(e,r,i);break;case 1:KY(e,r,i,a);break;case 2:JY(e,r,n,i);break;case 3:QY(e,r,n,i,a);break;case 4:eZ(e,r,n,i,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const g0e=new Uint16Array([255]),m0e=new Uint8Array(g0e.buffer),y0e=m0e[0]===255;function v0e(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*i,c=new Uint8Array(n*r*o);let h=0;for(let d=0;d<7;d++){const m=s[d],b=Math.ceil((r-m.x)/m.xStep),x=Math.ceil((n-m.y)/m.yStep);if(b<=0||x<=0)continue;const E=b*o,T=new Uint8Array(E);for(let A=0;A<x;A++){const M=e[h++],F=e.subarray(h,h+E);h+=E;const N=new Uint8Array(E);p0e(M,F,N,T,E,o),T.set(N);for(let O=0;O<b;O++){const U=m.x+O*m.xStep,j=m.y+A*m.yStep;if(!(U>=r||j>=n))for(let H=0;H<o;H++)c[(j*r+U)*o+H]=N[O*o+H]}}}if(a===16){const d=new Uint16Array(c.buffer);if(y0e)for(let m=0;m<d.length;m++)d[m]=_0e(d[m]);return d}else return c}function _0e(t){return(t&255)<<8|t>>8&255}const b0e=new Uint16Array([255]),x0e=new Uint8Array(b0e.buffer),w0e=x0e[0]===255,S0e=new Uint8Array(0);function n9(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,s=Math.ceil(a/8)*i,o=Math.ceil(a/8*i*r),c=new Uint8Array(n*o);let h=S0e,d=0,m,b;for(let x=0;x<n;x++){switch(m=e.subarray(d+1,d+1+o),b=c.subarray(x*o,(x+1)*o),e[d]){case 0:ZY(m,b,o);break;case 1:KY(m,b,o,s);break;case 2:JY(m,b,h,o);break;case 3:QY(m,b,h,o,s);break;case 4:eZ(m,b,h,o,s);break;default:throw new Error(`Unsupported filter: ${e[d]}`)}h=b,d+=o+1}if(a===16){const x=new Uint16Array(c.buffer);if(w0e)for(let E=0;E<x.length;E++)x[E]=E0e(x[E]);return x}else return c}function E0e(t){return(t&255)<<8|t>>8&255}const cS=Uint8Array.of(137,80,78,71,13,10,26,10);function i9(t){if(!T0e(t.readBytes(cS.length)))throw new Error("wrong PNG signature")}function T0e(t){if(t.length<cS.length)return!1;for(let e=0;e<cS.length;e++)if(t[e]!==cS[e])return!1;return!0}const C0e="tEXt",A0e=0,tZ=new TextDecoder("latin1");function I0e(t){if(k0e(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const P0e=/^[\u0000-\u00FF]*$/;function k0e(t){if(!P0e.test(t))throw new Error("invalid latin1 text")}function R0e(t,e,r){const n=rZ(e);t[n]=M0e(e,r-n.length-1)}function rZ(t){for(t.mark();t.readByte()!==A0e;);const e=t.offset;t.reset();const r=tZ.decode(t.readBytes(e-t.offset-1));return t.skip(1),I0e(r),r}function M0e(t,e){return tZ.decode(t.readBytes(e))}const Kc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},RA={UNKNOWN:-1,DEFLATE:0},a9={UNKNOWN:-1,ADAPTIVE:0},MA={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},nw={NONE:0,BACKGROUND:1,PREVIOUS:2},DA={SOURCE:0,OVER:1};class D0e extends yO{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:n=!1}=r;this._checkCrc=n,this._inflator=new e9,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=RA.UNKNOWN,this._filterMethod=a9.UNKNOWN,this._interlaceMethod=MA.UNKNOWN,this._colorType=Kc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(i9(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(i9(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const n=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case C0e:R0e(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?r9(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const n=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?r9(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=O0e(this.readUint8());const r=this.readUint8();this._colorType=r;let n;switch(r){case Kc.GREYSCALE:n=1;break;case Kc.TRUECOLOUR:n=3;break;case Kc.INDEXED_COLOUR:n=1;break;case Kc.GREYSCALE_ALPHA:n=2;break;case Kc.TRUECOLOUR_ALPHA:n=4;break;case Kc.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==RA.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let i=0;i<r;i++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,n=this.offset+this.byteOffset;if(n+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Kc.GREYSCALE:case Kc.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case Kc.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const n=this.readByte();this._palette[r].push(n)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Kc.UNKNOWN:case Kc.GREYSCALE_ALPHA:case Kc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=rZ(this),n=this.readUint8();if(n!==RA.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const i=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:c0e(i)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:r,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=n9({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)r.data=n.data;else{const i=this._apng.frames.at(e-1);this.disposeFrame(n,i,r),this.addFrameDataToCanvas(r,n)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,n){switch(e.disposeOp){case nw.NONE:break;case nw.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let a=0;a<this._png.width;a++){const s=(i*e.width+a)*this._png.channels;for(let o=0;o<this._png.channels;o++)n.data[s+o]=0}break;case nw.PREVIOUS:n.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const n=1<<this._png.depth,i=(a,s)=>{const o=((a+r.yOffset)*this._png.width+r.xOffset+s)*this._png.channels,c=(a*r.width+s)*this._png.channels;return{index:o,frameIndex:c}};switch(r.blendOp){case DA.SOURCE:for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const{index:o,frameIndex:c}=i(a,s);for(let h=0;h<this._png.channels;h++)e.data[o+h]=r.data[c+h]}break;case DA.OVER:for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const{index:o,frameIndex:c}=i(a,s);for(let h=0;h<this._png.channels;h++){const d=r.data[c+this._png.channels-1]/n,m=h%(this._png.channels-1)===0?1:r.data[c+h],b=Math.floor(d*m+(1-d)*e.data[o+h]);e.data[o+h]+=b}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==a9.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===MA.NO_INTERLACE)this._png.data=n9({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===MA.ADAM7)this._png.data=v0e({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:nw.NONE,blendOp:DA.SOURCE,data:e}),this._inflator=new e9,this._writingDataChunks=!1}}function O0e(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var o9;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(o9||(o9={}));function N0e(t,e){return new D0e(t,e).decode()}var Oi=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function OA(){Oi.console&&typeof Oi.console.log=="function"&&Oi.console.log.apply(Oi.console,arguments)}var Ro={log:OA,warn:function(t){Oi.console&&(typeof Oi.console.warn=="function"?Oi.console.warn.apply(Oi.console,arguments):OA.call(null,arguments))},error:function(t){Oi.console&&(typeof Oi.console.error=="function"?Oi.console.error.apply(Oi.console,arguments):OA(t))}};function NA(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){_m(n.response,e,r)},n.onerror=function(){Ro.error("could not download file")},n.send()}function s9(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function iw(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var _m=Oi.saveAs||((typeof window>"u"?"undefined":fo(window))!=="object"||window!==Oi?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Oi.URL||Oi.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?s9(i.href)?NA(t,e,r):iw(i,i.target="_blank"):iw(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){iw(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(s9(t))NA(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){iw(n)})}else navigator.msSaveOrOpenBlob((function(i,a){return a===void 0?a={autoBom:!1}:fo(a)!=="object"&&(Ro.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return NA(t,e,r);var i=t.type==="application/octet-stream",a=/constructor/i.test(Oi.HTMLElement)||Oi.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&a)&&(typeof FileReader>"u"?"undefined":fo(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var d=o.result;d=s?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},o.readAsDataURL(t)}else{var c=Oi.URL||Oi.webkitURL,h=c.createObjectURL(t);n?n.location=h:location.href=h,n=null,setTimeout(function(){c.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function nZ(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,s=i.exec(t);s&&(e=a(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),c=this.g.toString(16),h=this.b.toString(16);return o.length==1&&(o="0"+o),c.length==1&&(c="0"+c),h.length==1&&(h="0"+h),"#"+o+c+h}}var hS=Oi.atob.bind(Oi),l9=Oi.btoa.bind(Oi);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function LA(t,e){var r=t[0],n=t[1],i=t[2],a=t[3];r=Vu(r,n,i,a,e[0],7,-680876936),a=Vu(a,r,n,i,e[1],12,-389564586),i=Vu(i,a,r,n,e[2],17,606105819),n=Vu(n,i,a,r,e[3],22,-1044525330),r=Vu(r,n,i,a,e[4],7,-176418897),a=Vu(a,r,n,i,e[5],12,1200080426),i=Vu(i,a,r,n,e[6],17,-1473231341),n=Vu(n,i,a,r,e[7],22,-45705983),r=Vu(r,n,i,a,e[8],7,1770035416),a=Vu(a,r,n,i,e[9],12,-1958414417),i=Vu(i,a,r,n,e[10],17,-42063),n=Vu(n,i,a,r,e[11],22,-1990404162),r=Vu(r,n,i,a,e[12],7,1804603682),a=Vu(a,r,n,i,e[13],12,-40341101),i=Vu(i,a,r,n,e[14],17,-1502002290),r=$u(r,n=Vu(n,i,a,r,e[15],22,1236535329),i,a,e[1],5,-165796510),a=$u(a,r,n,i,e[6],9,-1069501632),i=$u(i,a,r,n,e[11],14,643717713),n=$u(n,i,a,r,e[0],20,-373897302),r=$u(r,n,i,a,e[5],5,-701558691),a=$u(a,r,n,i,e[10],9,38016083),i=$u(i,a,r,n,e[15],14,-660478335),n=$u(n,i,a,r,e[4],20,-405537848),r=$u(r,n,i,a,e[9],5,568446438),a=$u(a,r,n,i,e[14],9,-1019803690),i=$u(i,a,r,n,e[3],14,-187363961),n=$u(n,i,a,r,e[8],20,1163531501),r=$u(r,n,i,a,e[13],5,-1444681467),a=$u(a,r,n,i,e[2],9,-51403784),i=$u(i,a,r,n,e[7],14,1735328473),r=qu(r,n=$u(n,i,a,r,e[12],20,-1926607734),i,a,e[5],4,-378558),a=qu(a,r,n,i,e[8],11,-2022574463),i=qu(i,a,r,n,e[11],16,1839030562),n=qu(n,i,a,r,e[14],23,-35309556),r=qu(r,n,i,a,e[1],4,-1530992060),a=qu(a,r,n,i,e[4],11,1272893353),i=qu(i,a,r,n,e[7],16,-155497632),n=qu(n,i,a,r,e[10],23,-1094730640),r=qu(r,n,i,a,e[13],4,681279174),a=qu(a,r,n,i,e[0],11,-358537222),i=qu(i,a,r,n,e[3],16,-722521979),n=qu(n,i,a,r,e[6],23,76029189),r=qu(r,n,i,a,e[9],4,-640364487),a=qu(a,r,n,i,e[12],11,-421815835),i=qu(i,a,r,n,e[15],16,530742520),r=Hu(r,n=qu(n,i,a,r,e[2],23,-995338651),i,a,e[0],6,-198630844),a=Hu(a,r,n,i,e[7],10,1126891415),i=Hu(i,a,r,n,e[14],15,-1416354905),n=Hu(n,i,a,r,e[5],21,-57434055),r=Hu(r,n,i,a,e[12],6,1700485571),a=Hu(a,r,n,i,e[3],10,-1894986606),i=Hu(i,a,r,n,e[10],15,-1051523),n=Hu(n,i,a,r,e[1],21,-2054922799),r=Hu(r,n,i,a,e[8],6,1873313359),a=Hu(a,r,n,i,e[15],10,-30611744),i=Hu(i,a,r,n,e[6],15,-1560198380),n=Hu(n,i,a,r,e[13],21,1309151649),r=Hu(r,n,i,a,e[4],6,-145523070),a=Hu(a,r,n,i,e[11],10,-1120210379),i=Hu(i,a,r,n,e[2],15,718787259),n=Hu(n,i,a,r,e[9],21,-343485551),t[0]=dg(r,t[0]),t[1]=dg(n,t[1]),t[2]=dg(i,t[2]),t[3]=dg(a,t[3])}function t3(t,e,r,n,i,a){return e=dg(dg(e,t),dg(n,a)),dg(e<<i|e>>>32-i,r)}function Vu(t,e,r,n,i,a,s){return t3(e&r|~e&n,t,e,i,a,s)}function $u(t,e,r,n,i,a,s){return t3(e&n|r&~n,t,e,i,a,s)}function qu(t,e,r,n,i,a,s){return t3(e^r^n,t,e,i,a,s)}function Hu(t,e,r,n,i,a,s){return t3(r^(e|~n),t,e,i,a,s)}function iZ(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)LA(n,L0e(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(LA(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,LA(n,i),n}function L0e(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var u9="0123456789abcdef".split("");function F0e(t){for(var e="",r=0;r<4;r++)e+=u9[t>>8*r+4&15]+u9[t>>8*r&15];return e}function B0e(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Jk(t){return iZ(t).map(B0e).join("")}var z0e=(function(t){for(var e=0;e<t.length;e++)t[e]=F0e(t[e]);return t.join("")})(iZ("hello"))!="5d41402abc4b2a76b9719d911017c592";function dg(t,e){if(z0e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Qk(t,e){var r,n,i,a;if(t!==r){for(var s=(i=t,a=1+(256/t.length|0),new Array(a+1).join(i)),o=[],c=0;c<256;c++)o[c]=c;var h=0;for(c=0;c<256;c++){var d=o[c];h=(h+d+s.charCodeAt(c))%256,o[c]=o[h],o[h]=d}r=t,n=o}else o=n;var m=e.length,b=0,x=0,E="";for(c=0;c<m;c++)x=(x+(d=o[b=(b+1)%256]))%256,o[b]=o[x],o[x]=d,s=o[(o[b]+o[x])%256],E+=String.fromCharCode(e.charCodeAt(c)^s);return E}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var c9={print:4,modify:8,copy:16,"annot-forms":32};function Lv(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(o){if(c9.perm!==void 0)throw new Error("Invalid permission: "+o);i+=c9[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,s),this.P=-(1+(255^i)),this.encryptionKey=Jk(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Qk(this.encryptionKey,this.padding)}function Fv(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[n]}return e}function h9(t){if(fo(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!i],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in e[r]){var s=e[r][a];try{s[0].apply(t,n)}catch(o){Oi.console&&Ro.error("jsPDF PubSub Error",o.message,o)}s[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function JS(t){if(!(this instanceof JS))return new JS(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function aZ(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function wm(t,e,r,n,i){if(!(this instanceof wm))return new wm(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,aZ.call(this,n,i)}function a0(t,e,r,n,i){if(!(this instanceof a0))return new a0(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,aZ.call(this,n,i)}function di(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],s=[],o=1,c=16,h="S",d=null;fo(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,a=t.compress||t.compressPdf||a,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),h=t.defaultPathOperation||"S"),s=t.filters||(a===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var m=t.putOnlyUsedFonts||!1,b={},x={internal:{},__private__:{}};x.__private__.PubSub=h9;var E="1.3",T=x.__private__.getPdfVersion=function(){return E};x.__private__.setPdfVersion=function(ue){E=ue};var A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};x.__private__.getPageFormats=function(){return A};var M=x.__private__.getPageFormat=function(ue){return A[ue]};i=i||"a4";var F="compat",N="advanced",O=F;function U(){this.saveGraphicsState(),$e(new un(qe,0,0,-qe,0,Do()*qe).toString()+" cm"),this.setFontSize(this.getFontSize()/qe),h="n",O=N}function j(){this.restoreGraphicsState(),h="S",O=F}var H=x.__private__.combineFontStyleAndFontWeight=function(ue,Ge){if(ue=="bold"&&Ge=="normal"||ue=="bold"&&Ge==400||ue=="normal"&&Ge=="italic"||ue=="bold"&&Ge=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ge&&(ue=Ge==400||Ge==="normal"?ue==="italic"?"italic":"normal":Ge!=700&&Ge!=="bold"||ue!=="normal"?(Ge==700?"bold":Ge)+""+ue:"bold"),ue};x.advancedAPI=function(ue){var Ge=O===F;return Ge&&U.call(this),typeof ue!="function"||(ue(this),Ge&&j.call(this)),this},x.compatAPI=function(ue){var Ge=O===N;return Ge&&j.call(this),typeof ue!="function"||(ue(this),Ge&&U.call(this)),this},x.isAdvancedAPI=function(){return O===N};var G,X=function(ue){if(O!==N)throw new Error(ue+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},ae=x.roundToPrecision=x.__private__.roundToPrecision=function(ue,Ge){var bt=e||Ge;if(isNaN(ue)||isNaN(bt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return ue.toFixed(bt).replace(/0+$/,"")};G=x.hpf=x.__private__.hpf=typeof c=="number"?function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.hpf");return ae(ue,c)}:c==="smart"?function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.hpf");return ae(ue,ue>-1&&ue<1?16:5)}:function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.hpf");return ae(ue,16)};var Q=x.f2=x.__private__.f2=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.f2");return ae(ue,2)},W=x.__private__.f3=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.f3");return ae(ue,3)},oe=x.scale=x.__private__.scale=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.scale");return O===F?ue*qe:O===N?ue:void 0},se=function(ue){return oe((function(Ge){return O===F?Do()-Ge:O===N?Ge:void 0})(ue))};x.__private__.setPrecision=x.setPrecision=function(ue){typeof parseInt(ue,10)=="number"&&(e=parseInt(ue,10))};var he,_e="00000000000000000000000000000000",Ce=x.__private__.getFileId=function(){return _e},me=x.__private__.setFileId=function(ue){return _e=ue!==void 0&&/^[a-fA-F0-9]{32}$/.test(ue)?ue.toUpperCase():_e.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Ba=new Lv(d.userPermissions,d.userPassword,d.ownerPassword,_e)),_e};x.setFileId=function(ue){return me(ue),this},x.getFileId=function(){return Ce()};var xe=x.__private__.convertDateToPDFDate=function(ue){var Ge=ue.getTimezoneOffset(),bt=Ge<0?"+":"-",Bt=Math.floor(Math.abs(Ge/60)),sr=Math.abs(Ge%60),Nr=[bt,we(Bt),"'",we(sr),"'"].join("");return["D:",ue.getFullYear(),we(ue.getMonth()+1),we(ue.getDate()),we(ue.getHours()),we(ue.getMinutes()),we(ue.getSeconds()),Nr].join("")},Ae=x.__private__.convertPDFDateToDate=function(ue){var Ge=parseInt(ue.substr(2,4),10),bt=parseInt(ue.substr(6,2),10)-1,Bt=parseInt(ue.substr(8,2),10),sr=parseInt(ue.substr(10,2),10),Nr=parseInt(ue.substr(12,2),10),Zr=parseInt(ue.substr(14,2),10);return new Date(Ge,bt,Bt,sr,Nr,Zr,0)},De=x.__private__.setCreationDate=function(ue){var Ge;if(ue===void 0&&(ue=new Date),ue instanceof Date)Ge=xe(ue);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(ue))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ge=ue}return he=Ge},de=x.__private__.getCreationDate=function(ue){var Ge=he;return ue==="jsDate"&&(Ge=Ae(he)),Ge};x.setCreationDate=function(ue){return De(ue),this},x.getCreationDate=function(ue){return de(ue)};var Ee,we=x.__private__.padd2=function(ue){return("0"+parseInt(ue)).slice(-2)},Le=x.__private__.padd2Hex=function(ue){return("00"+(ue=ue.toString())).substr(ue.length)},Fe=0,Xe=[],Be=[],ot=0,Qe=[],rt=[],Re=!1,zt=Be;x.__private__.setCustomOutputDestination=function(ue){Re=!0,zt=ue};var st=function(ue){Re||(zt=ue)};x.__private__.resetCustomOutputDestination=function(){Re=!1,zt=Be};var $e=x.__private__.out=function(ue){return ue=ue.toString(),ot+=ue.length+1,zt.push(ue),zt},Jt=x.__private__.write=function(ue){return $e(arguments.length===1?ue.toString():Array.prototype.join.call(arguments," "))},Ht=x.__private__.getArrayBuffer=function(ue){for(var Ge=ue.length,bt=new ArrayBuffer(Ge),Bt=new Uint8Array(bt);Ge--;)Bt[Ge]=ue.charCodeAt(Ge);return bt},pr=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];x.__private__.getStandardFonts=function(){return pr};var _t=t.fontSize||16;x.__private__.setFontSize=x.setFontSize=function(ue){return _t=O===N?ue/qe:ue,this};var vr,br=x.__private__.getFontSize=x.getFontSize=function(){return O===F?_t:_t*qe},lr=t.R2L||!1;x.__private__.setR2L=x.setR2L=function(ue){return lr=ue,this},x.__private__.getR2L=x.getR2L=function(){return lr};var Cr,Tr=x.__private__.setZoomMode=function(ue){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(ue))vr=ue;else if(isNaN(ue)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(ue)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+ue+'" is not recognized.');vr=ue}else vr=parseInt(ue,10)};x.__private__.getZoomMode=function(){return vr};var Qt,at=x.__private__.setPageMode=function(ue){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(ue)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+ue+'" is not recognized.');Cr=ue};x.__private__.getPageMode=function(){return Cr};var ke=x.__private__.setLayoutMode=function(ue){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(ue)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+ue+'" is not recognized.');Qt=ue};x.__private__.getLayoutMode=function(){return Qt},x.__private__.setDisplayMode=x.setDisplayMode=function(ue,Ge,bt){return Tr(ue),ke(Ge),at(bt),this};var be={title:"",subject:"",author:"",keywords:"",creator:""};x.__private__.getDocumentProperty=function(ue){if(Object.keys(be).indexOf(ue)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return be[ue]},x.__private__.getDocumentProperties=function(){return be},x.__private__.setDocumentProperties=x.setProperties=x.setDocumentProperties=function(ue){for(var Ge in be)be.hasOwnProperty(Ge)&&ue[Ge]&&(be[Ge]=ue[Ge]);return this},x.__private__.setDocumentProperty=function(ue,Ge){if(Object.keys(be).indexOf(ue)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return be[ue]=Ge};var je,qe,We,Lt,Et,mt={},ct={},Kt=[],qt={},Ir={},Ar={},$r={},hn=null,zr=0,Mt=[],en=new h9(x),jn=t.hotfixes||[],Qr={},nr={},oi=[],un=function ue(Ge,bt,Bt,sr,Nr,Zr){if(!(this instanceof ue))return new ue(Ge,bt,Bt,sr,Nr,Zr);isNaN(Ge)&&(Ge=1),isNaN(bt)&&(bt=0),isNaN(Bt)&&(Bt=0),isNaN(sr)&&(sr=1),isNaN(Nr)&&(Nr=0),isNaN(Zr)&&(Zr=0),this._matrix=[Ge,bt,Bt,sr,Nr,Zr]};Object.defineProperty(un.prototype,"sx",{get:function(){return this._matrix[0]},set:function(ue){this._matrix[0]=ue}}),Object.defineProperty(un.prototype,"shy",{get:function(){return this._matrix[1]},set:function(ue){this._matrix[1]=ue}}),Object.defineProperty(un.prototype,"shx",{get:function(){return this._matrix[2]},set:function(ue){this._matrix[2]=ue}}),Object.defineProperty(un.prototype,"sy",{get:function(){return this._matrix[3]},set:function(ue){this._matrix[3]=ue}}),Object.defineProperty(un.prototype,"tx",{get:function(){return this._matrix[4]},set:function(ue){this._matrix[4]=ue}}),Object.defineProperty(un.prototype,"ty",{get:function(){return this._matrix[5]},set:function(ue){this._matrix[5]=ue}}),Object.defineProperty(un.prototype,"a",{get:function(){return this._matrix[0]},set:function(ue){this._matrix[0]=ue}}),Object.defineProperty(un.prototype,"b",{get:function(){return this._matrix[1]},set:function(ue){this._matrix[1]=ue}}),Object.defineProperty(un.prototype,"c",{get:function(){return this._matrix[2]},set:function(ue){this._matrix[2]=ue}}),Object.defineProperty(un.prototype,"d",{get:function(){return this._matrix[3]},set:function(ue){this._matrix[3]=ue}}),Object.defineProperty(un.prototype,"e",{get:function(){return this._matrix[4]},set:function(ue){this._matrix[4]=ue}}),Object.defineProperty(un.prototype,"f",{get:function(){return this._matrix[5]},set:function(ue){this._matrix[5]=ue}}),Object.defineProperty(un.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(un.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(un.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(un.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),un.prototype.join=function(ue){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(G).join(ue)},un.prototype.multiply=function(ue){var Ge=ue.sx*this.sx+ue.shy*this.shx,bt=ue.sx*this.shy+ue.shy*this.sy,Bt=ue.shx*this.sx+ue.sy*this.shx,sr=ue.shx*this.shy+ue.sy*this.sy,Nr=ue.tx*this.sx+ue.ty*this.shx+this.tx,Zr=ue.tx*this.shy+ue.ty*this.sy+this.ty;return new un(Ge,bt,Bt,sr,Nr,Zr)},un.prototype.decompose=function(){var ue=this.sx,Ge=this.shy,bt=this.shx,Bt=this.sy,sr=this.tx,Nr=this.ty,Zr=Math.sqrt(ue*ue+Ge*Ge),Ln=(ue/=Zr)*bt+(Ge/=Zr)*Bt;bt-=ue*Ln,Bt-=Ge*Ln;var qn=Math.sqrt(bt*bt+Bt*Bt);return Ln/=qn,ue*(Bt/=qn)<Ge*(bt/=qn)&&(ue=-ue,Ge=-Ge,Ln=-Ln,Zr=-Zr),{scale:new un(Zr,0,0,qn,0,0),translate:new un(1,0,0,1,sr,Nr),rotate:new un(ue,Ge,-Ge,ue,0,0),skew:new un(1,0,Ln,1,0,0)}},un.prototype.toString=function(ue){return this.join(" ")},un.prototype.inversed=function(){var ue=this.sx,Ge=this.shy,bt=this.shx,Bt=this.sy,sr=this.tx,Nr=this.ty,Zr=1/(ue*Bt-Ge*bt),Ln=Bt*Zr,qn=-Ge*Zr,Un=-bt*Zr,ui=ue*Zr;return new un(Ln,qn,Un,ui,-Ln*sr-Un*Nr,-qn*sr-ui*Nr)},un.prototype.applyToPoint=function(ue){var Ge=ue.x*this.sx+ue.y*this.shx+this.tx,bt=ue.x*this.shy+ue.y*this.sy+this.ty;return new Ru(Ge,bt)},un.prototype.applyToRectangle=function(ue){var Ge=this.applyToPoint(ue),bt=this.applyToPoint(new Ru(ue.x+ue.w,ue.y+ue.h));return new Mu(Ge.x,Ge.y,bt.x-Ge.x,bt.y-Ge.y)},un.prototype.clone=function(){var ue=this.sx,Ge=this.shy,bt=this.shx,Bt=this.sy,sr=this.tx,Nr=this.ty;return new un(ue,Ge,bt,Bt,sr,Nr)},x.Matrix=un;var Kn=x.matrixMult=function(ue,Ge){return Ge.multiply(ue)},Me=new un(1,0,0,1,0,0);x.unitMatrix=x.identityMatrix=Me;var He=function(ue,Ge){if(!Ir[ue]){var bt=(Ge instanceof wm?"Sh":"P")+(Object.keys(qt).length+1).toString(10);Ge.id=bt,Ir[ue]=bt,qt[bt]=Ge,en.publish("addPattern",Ge)}};x.ShadingPattern=wm,x.TilingPattern=a0,x.addShadingPattern=function(ue,Ge){return X("addShadingPattern()"),He(ue,Ge),this},x.beginTilingPattern=function(ue){X("beginTilingPattern()"),ji(ue.boundingBox[0],ue.boundingBox[1],ue.boundingBox[2]-ue.boundingBox[0],ue.boundingBox[3]-ue.boundingBox[1],ue.matrix)},x.endTilingPattern=function(ue,Ge){X("endTilingPattern()"),Ge.stream=rt[Ee].join(`
`),He(ue,Ge),en.publish("endTilingPattern",Ge),oi.pop().restore()};var Tt,Wt=x.__private__.newObject=function(){var ue=Ut();return Xr(ue,!0),ue},Ut=x.__private__.newObjectDeferred=function(){return Fe++,Xe[Fe]=function(){return ot},Fe},Xr=function(ue,Ge){return Ge=typeof Ge=="boolean"&&Ge,Xe[ue]=ot,Ge&&$e(ue+" 0 obj"),ue},Nn=x.__private__.newAdditionalObject=function(){var ue={objId:Ut(),content:""};return Qe.push(ue),ue},Bi=Ut(),Ci=Ut(),Fr=x.__private__.decodeColorString=function(ue){var Ge=ue.split(" ");if(Ge.length!==2||Ge[1]!=="g"&&Ge[1]!=="G")Ge.length!==5||Ge[4]!=="k"&&Ge[4]!=="K"||(Ge=[(1-Ge[0])*(1-Ge[3]),(1-Ge[1])*(1-Ge[3]),(1-Ge[2])*(1-Ge[3]),"r"]);else{var bt=parseFloat(Ge[0]);Ge=[bt,bt,bt,"r"]}for(var Bt="#",sr=0;sr<3;sr++)Bt+=("0"+Math.floor(255*parseFloat(Ge[sr])).toString(16)).slice(-2);return Bt},Mn=x.__private__.encodeColorString=function(ue){var Ge;typeof ue=="string"&&(ue={ch1:ue});var bt=ue.ch1,Bt=ue.ch2,sr=ue.ch3,Nr=ue.ch4,Zr=ue.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof bt=="string"&&bt.charAt(0)!=="#"){var Ln=new nZ(bt);if(Ln.ok)bt=Ln.toHex();else if(!/^\d*\.?\d*$/.test(bt))throw new Error('Invalid color "'+bt+'" passed to jsPDF.encodeColorString.')}if(typeof bt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(bt)&&(bt="#"+bt[1]+bt[1]+bt[2]+bt[2]+bt[3]+bt[3]),typeof bt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(bt)){var qn=parseInt(bt.substr(1),16);bt=qn>>16&255,Bt=qn>>8&255,sr=255&qn}if(Bt===void 0||Nr===void 0&&bt===Bt&&Bt===sr)Ge=typeof bt=="string"?bt+" "+Zr[0]:ue.precision===2?Q(bt/255)+" "+Zr[0]:W(bt/255)+" "+Zr[0];else if(Nr===void 0||fo(Nr)==="object"){if(Nr&&!isNaN(Nr.a)&&Nr.a===0)return["1.","1.","1.",Zr[1]].join(" ");Ge=typeof bt=="string"?[bt,Bt,sr,Zr[1]].join(" "):ue.precision===2?[Q(bt/255),Q(Bt/255),Q(sr/255),Zr[1]].join(" "):[W(bt/255),W(Bt/255),W(sr/255),Zr[1]].join(" ")}else Ge=typeof bt=="string"?[bt,Bt,sr,Nr,Zr[2]].join(" "):ue.precision===2?[Q(bt),Q(Bt),Q(sr),Q(Nr),Zr[2]].join(" "):[W(bt),W(Bt),W(sr),W(Nr),Zr[2]].join(" ");return Ge},Bn=x.__private__.getFilters=function(){return s},ei=x.__private__.putStream=function(ue){var Ge=(ue=ue||{}).data||"",bt=ue.filters||Bn(),Bt=ue.alreadyAppliedFilters||[],sr=ue.addLength1||!1,Nr=Ge.length,Zr=ue.objectId,Ln=function(Si){return Si};if(d!==null&&Zr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Ln=Ba.encryptor(Zr,0));var qn={};bt===!0&&(bt=["FlateEncode"]);var Un=ue.additionalKeyValues||[],ui=(qn=di.API.processDataByFilters!==void 0?di.API.processDataByFilters(Ge,bt):{data:Ge,reverseChain:[]}).reverseChain+(Array.isArray(Bt)?Bt.join(" "):Bt.toString());if(qn.data.length!==0&&(Un.push({key:"Length",value:qn.data.length}),sr===!0&&Un.push({key:"Length1",value:Nr})),ui.length!=0)if(ui.split("/").length-1==1)Un.push({key:"Filter",value:ui});else{Un.push({key:"Filter",value:"["+ui+"]"});for(var Hn=0;Hn<Un.length;Hn+=1)if(Un[Hn].key==="DecodeParms"){for(var Ui=[],Xi=0;Xi<qn.reverseChain.split("/").length-1;Xi+=1)Ui.push("null");Ui.push(Un[Hn].value),Un[Hn].value="["+Ui.join(" ")+"]"}}$e("<<");for(var ra=0;ra<Un.length;ra++)$e("/"+Un[ra].key+" "+Un[ra].value);$e(">>"),qn.data.length!==0&&($e("stream"),$e(Ln(qn.data)),$e("endstream"))},ua=x.__private__.putPage=function(ue){var Ge=ue.number,bt=ue.data,Bt=ue.objId,sr=ue.contentsObjId;Xr(Bt,!0),$e("<</Type /Page"),$e("/Parent "+ue.rootDictionaryObjId+" 0 R"),$e("/Resources "+ue.resourceDictionaryObjId+" 0 R"),$e("/MediaBox ["+parseFloat(G(ue.mediaBox.bottomLeftX))+" "+parseFloat(G(ue.mediaBox.bottomLeftY))+" "+G(ue.mediaBox.topRightX)+" "+G(ue.mediaBox.topRightY)+"]"),ue.cropBox!==null&&$e("/CropBox ["+G(ue.cropBox.bottomLeftX)+" "+G(ue.cropBox.bottomLeftY)+" "+G(ue.cropBox.topRightX)+" "+G(ue.cropBox.topRightY)+"]"),ue.bleedBox!==null&&$e("/BleedBox ["+G(ue.bleedBox.bottomLeftX)+" "+G(ue.bleedBox.bottomLeftY)+" "+G(ue.bleedBox.topRightX)+" "+G(ue.bleedBox.topRightY)+"]"),ue.trimBox!==null&&$e("/TrimBox ["+G(ue.trimBox.bottomLeftX)+" "+G(ue.trimBox.bottomLeftY)+" "+G(ue.trimBox.topRightX)+" "+G(ue.trimBox.topRightY)+"]"),ue.artBox!==null&&$e("/ArtBox ["+G(ue.artBox.bottomLeftX)+" "+G(ue.artBox.bottomLeftY)+" "+G(ue.artBox.topRightX)+" "+G(ue.artBox.topRightY)+"]"),typeof ue.userUnit=="number"&&ue.userUnit!==1&&$e("/UserUnit "+ue.userUnit),en.publish("putPage",{objId:Bt,pageContext:Mt[Ge],pageNumber:Ge,page:bt}),$e("/Contents "+sr+" 0 R"),$e(">>"),$e("endobj");var Nr=bt.join(`
`);return O===N&&(Nr+=`
Q`),Xr(sr,!0),ei({data:Nr,filters:Bn(),objectId:sr}),$e("endobj"),Bt},fa=x.__private__.putPages=function(){var ue,Ge,bt=[];for(ue=1;ue<=zr;ue++)Mt[ue].objId=Ut(),Mt[ue].contentsObjId=Ut();for(ue=1;ue<=zr;ue++)bt.push(ua({number:ue,data:rt[ue],objId:Mt[ue].objId,contentsObjId:Mt[ue].contentsObjId,mediaBox:Mt[ue].mediaBox,cropBox:Mt[ue].cropBox,bleedBox:Mt[ue].bleedBox,trimBox:Mt[ue].trimBox,artBox:Mt[ue].artBox,userUnit:Mt[ue].userUnit,rootDictionaryObjId:Bi,resourceDictionaryObjId:Ci}));Xr(Bi,!0),$e("<</Type /Pages");var Bt="/Kids [";for(Ge=0;Ge<zr;Ge++)Bt+=bt[Ge]+" 0 R ";$e(Bt+"]"),$e("/Count "+zr),$e(">>"),$e("endobj"),en.publish("postPutPages")},zn=function(ue){en.publish("putFont",{font:ue,out:$e,newObject:Wt,putStream:ei}),ue.isAlreadyPutted!==!0&&(ue.objectNumber=Wt(),$e("<<"),$e("/Type /Font"),$e("/BaseFont /"+Fv(ue.postScriptName)),$e("/Subtype /Type1"),typeof ue.encoding=="string"&&$e("/Encoding /"+ue.encoding),$e("/FirstChar 32"),$e("/LastChar 255"),$e(">>"),$e("endobj"))},La=function(ue){ue.objectNumber=Wt();var Ge=[];Ge.push({key:"Type",value:"/XObject"}),Ge.push({key:"Subtype",value:"/Form"}),Ge.push({key:"BBox",value:"["+[G(ue.x),G(ue.y),G(ue.x+ue.width),G(ue.y+ue.height)].join(" ")+"]"}),Ge.push({key:"Matrix",value:"["+ue.matrix.toString()+"]"});var bt=ue.pages[1].join(`
`);ei({data:bt,additionalKeyValues:Ge,objectId:ue.objectNumber}),$e("endobj")},Gi=function(ue,Ge){Ge||(Ge=21);var bt=Wt(),Bt=(function(Zr,Ln){var qn,Un=[],ui=1/(Ln-1);for(qn=0;qn<1;qn+=ui)Un.push(qn);if(Un.push(1),Zr[0].offset!=0){var Hn={offset:0,color:Zr[0].color};Zr.unshift(Hn)}if(Zr[Zr.length-1].offset!=1){var Ui={offset:1,color:Zr[Zr.length-1].color};Zr.push(Ui)}for(var Xi="",ra=0,Si=0;Si<Un.length;Si++){for(qn=Un[Si];qn>Zr[ra+1].offset;)ra++;var Ia=Zr[ra].offset,za=(qn-Ia)/(Zr[ra+1].offset-Ia),Hs=Zr[ra].color,ll=Zr[ra+1].color;Xi+=Le(Math.round((1-za)*Hs[0]+za*ll[0]).toString(16))+Le(Math.round((1-za)*Hs[1]+za*ll[1]).toString(16))+Le(Math.round((1-za)*Hs[2]+za*ll[2]).toString(16))}return Xi.trim()})(ue.colors,Ge),sr=[];sr.push({key:"FunctionType",value:"0"}),sr.push({key:"Domain",value:"[0.0 1.0]"}),sr.push({key:"Size",value:"["+Ge+"]"}),sr.push({key:"BitsPerSample",value:"8"}),sr.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),sr.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ei({data:Bt,additionalKeyValues:sr,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:bt}),$e("endobj"),ue.objectNumber=Wt(),$e("<< /ShadingType "+ue.type),$e("/ColorSpace /DeviceRGB");var Nr="/Coords ["+G(parseFloat(ue.coords[0]))+" "+G(parseFloat(ue.coords[1]))+" ";ue.type===2?Nr+=G(parseFloat(ue.coords[2]))+" "+G(parseFloat(ue.coords[3])):Nr+=G(parseFloat(ue.coords[2]))+" "+G(parseFloat(ue.coords[3]))+" "+G(parseFloat(ue.coords[4]))+" "+G(parseFloat(ue.coords[5])),$e(Nr+="]"),ue.matrix&&$e("/Matrix ["+ue.matrix.toString()+"]"),$e("/Function "+bt+" 0 R"),$e("/Extend [true true]"),$e(">>"),$e("endobj")},fs=function(ue,Ge){var bt=Ut(),Bt=Wt();Ge.push({resourcesOid:bt,objectOid:Bt}),ue.objectNumber=Bt;var sr=[];sr.push({key:"Type",value:"/Pattern"}),sr.push({key:"PatternType",value:"1"}),sr.push({key:"PaintType",value:"1"}),sr.push({key:"TilingType",value:"1"}),sr.push({key:"BBox",value:"["+ue.boundingBox.map(G).join(" ")+"]"}),sr.push({key:"XStep",value:G(ue.xStep)}),sr.push({key:"YStep",value:G(ue.yStep)}),sr.push({key:"Resources",value:bt+" 0 R"}),ue.matrix&&sr.push({key:"Matrix",value:"["+ue.matrix.toString()+"]"}),ei({data:ue.stream,additionalKeyValues:sr,objectId:ue.objectNumber}),$e("endobj")},Ca=function(ue){for(var Ge in ue.objectNumber=Wt(),$e("<<"),ue)switch(Ge){case"opacity":$e("/ca "+Q(ue[Ge]));break;case"stroke-opacity":$e("/CA "+Q(ue[Ge]))}$e(">>"),$e("endobj")},Mo=function(ue){Xr(ue.resourcesOid,!0),$e("<<"),$e("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Ge in $e("/Font <<"),mt)mt.hasOwnProperty(Ge)&&(m===!1||m===!0&&b.hasOwnProperty(Ge))&&$e("/"+Ge+" "+mt[Ge].objectNumber+" 0 R");$e(">>")})(),(function(){if(Object.keys(qt).length>0){for(var Ge in $e("/Shading <<"),qt)qt.hasOwnProperty(Ge)&&qt[Ge]instanceof wm&&qt[Ge].objectNumber>=0&&$e("/"+Ge+" "+qt[Ge].objectNumber+" 0 R");en.publish("putShadingPatternDict"),$e(">>")}})(),(function(Ge){if(Object.keys(qt).length>0){for(var bt in $e("/Pattern <<"),qt)qt.hasOwnProperty(bt)&&qt[bt]instanceof x.TilingPattern&&qt[bt].objectNumber>=0&&qt[bt].objectNumber<Ge&&$e("/"+bt+" "+qt[bt].objectNumber+" 0 R");en.publish("putTilingPatternDict"),$e(">>")}})(ue.objectOid),(function(){if(Object.keys(Ar).length>0){var Ge;for(Ge in $e("/ExtGState <<"),Ar)Ar.hasOwnProperty(Ge)&&Ar[Ge].objectNumber>=0&&$e("/"+Ge+" "+Ar[Ge].objectNumber+" 0 R");en.publish("putGStateDict"),$e(">>")}})(),(function(){for(var Ge in $e("/XObject <<"),Qr)Qr.hasOwnProperty(Ge)&&Qr[Ge].objectNumber>=0&&$e("/"+Ge+" "+Qr[Ge].objectNumber+" 0 R");en.publish("putXobjectDict"),$e(">>")})(),$e(">>"),$e("endobj")},Ya=function(ue){ct[ue.fontName]=ct[ue.fontName]||{},ct[ue.fontName][ue.fontStyle]=ue.id},ol=function(ue,Ge,bt,Bt,sr){var Nr={id:"F"+(Object.keys(mt).length+1).toString(10),postScriptName:ue,fontName:Ge,fontStyle:bt,encoding:Bt,isStandardFont:sr||!1,metadata:{}};return en.publish("addFont",{font:Nr,instance:this}),mt[Nr.id]=Nr,Ya(Nr),Nr.id},xi=x.__private__.pdfEscape=x.pdfEscape=function(ue,Ge){return(function(bt,Bt){var sr,Nr,Zr,Ln,qn,Un,ui,Hn,Ui;if(Zr=(Bt=Bt||{}).sourceEncoding||"Unicode",qn=Bt.outputEncoding,(Bt.autoencode||qn)&&mt[je].metadata&&mt[je].metadata[Zr]&&mt[je].metadata[Zr].encoding&&(Ln=mt[je].metadata[Zr].encoding,!qn&&mt[je].encoding&&(qn=mt[je].encoding),!qn&&Ln.codePages&&(qn=Ln.codePages[0]),typeof qn=="string"&&(qn=Ln[qn]),qn)){for(ui=!1,Un=[],sr=0,Nr=bt.length;sr<Nr;sr++)(Hn=qn[bt.charCodeAt(sr)])?Un.push(String.fromCharCode(Hn)):Un.push(bt[sr]),Un[sr].charCodeAt(0)>>8&&(ui=!0);bt=Un.join("")}for(sr=bt.length;ui===void 0&&sr!==0;)bt.charCodeAt(sr-1)>>8&&(ui=!0),sr--;if(!ui)return bt;for(Un=Bt.noBOM?[]:[254,255],sr=0,Nr=bt.length;sr<Nr;sr++){if((Ui=(Hn=bt.charCodeAt(sr))>>8)>>8)throw new Error("Character at position "+sr+" of string '"+bt+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Un.push(Ui),Un.push(Hn-(Ui<<8))}return String.fromCharCode.apply(void 0,Un)})(ue,Ge).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zi=x.__private__.beginPage=function(ue){rt[++zr]=[],Mt[zr]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(ue[0]),topRightY:Number(ue[1])}},Za(zr),st(rt[Ee])},Iu=function(ue,Ge){var bt,Bt,sr;switch(r=Ge||r,typeof ue=="string"&&(bt=M(ue.toLowerCase()),Array.isArray(bt)&&(Bt=bt[0],sr=bt[1])),Array.isArray(ue)&&(Bt=ue[0]*qe,sr=ue[1]*qe),isNaN(Bt)&&(Bt=i[0],sr=i[1]),(Bt>14400||sr>14400)&&(Ro.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Bt=Math.min(14400,Bt),sr=Math.min(14400,sr)),i=[Bt,sr],r.substr(0,1)){case"l":sr>Bt&&(i=[sr,Bt]);break;case"p":Bt>sr&&(i=[sr,Bt])}zi(i),Mr($n),$e(Ts),Ka!==0&&$e(Ka+" J"),$s!==0&&$e($s+" j"),en.publish("addPage",{pageNumber:zr})},ga=function(ue){ue>0&&ue<=zr&&(rt.splice(ue,1),Mt.splice(ue,1),zr--,Ee>zr&&(Ee=zr),this.setPage(Ee))},Za=function(ue){ue>0&&ue<=zr&&(Ee=ue)},ds=x.__private__.getNumberOfPages=x.getNumberOfPages=function(){return rt.length-1},Aa=function(ue,Ge,bt){var Bt,sr=void 0;return bt=bt||{},ue=ue!==void 0?ue:mt[je].fontName,Ge=Ge!==void 0?Ge:mt[je].fontStyle,Bt=ue.toLowerCase(),ct[Bt]!==void 0&&ct[Bt][Ge]!==void 0?sr=ct[Bt][Ge]:ct[ue]!==void 0&&ct[ue][Ge]!==void 0?sr=ct[ue][Ge]:bt.disableWarning===!1&&Ro.warn("Unable to look up font label for font '"+ue+"', '"+Ge+"'. Refer to getFontList() for available fonts."),sr||bt.noFallback||(sr=ct.times[Ge])==null&&(sr=ct.times.normal),sr},ps=x.__private__.putInfo=function(){var ue=Wt(),Ge=function(Bt){return Bt};for(var bt in d!==null&&(Ge=Ba.encryptor(ue,0)),$e("<<"),$e("/Producer ("+xi(Ge("jsPDF "+di.version))+")"),be)be.hasOwnProperty(bt)&&be[bt]&&$e("/"+bt.substr(0,1).toUpperCase()+bt.substr(1)+" ("+xi(Ge(be[bt]))+")");$e("/CreationDate ("+xi(Ge(he))+")"),$e(">>"),$e("endobj")},Ul=x.__private__.putCatalog=function(ue){var Ge=(ue=ue||{}).rootDictionaryObjId||Bi;switch(Wt(),$e("<<"),$e("/Type /Catalog"),$e("/Pages "+Ge+" 0 R"),vr||(vr="fullwidth"),vr){case"fullwidth":$e("/OpenAction [3 0 R /FitH null]");break;case"fullheight":$e("/OpenAction [3 0 R /FitV null]");break;case"fullpage":$e("/OpenAction [3 0 R /Fit]");break;case"original":$e("/OpenAction [3 0 R /XYZ null null 1]");break;default:var bt=""+vr;bt.substr(bt.length-1)==="%"&&(vr=parseInt(vr)/100),typeof vr=="number"&&$e("/OpenAction [3 0 R /XYZ null null "+Q(vr)+"]")}switch(Qt||(Qt="continuous"),Qt){case"continuous":$e("/PageLayout /OneColumn");break;case"single":$e("/PageLayout /SinglePage");break;case"two":case"twoleft":$e("/PageLayout /TwoColumnLeft");break;case"tworight":$e("/PageLayout /TwoColumnRight")}Cr&&$e("/PageMode /"+Cr),en.publish("putCatalog"),$e(">>"),$e("endobj")},Fa=x.__private__.putTrailer=function(){$e("trailer"),$e("<<"),$e("/Size "+(Fe+1)),$e("/Root "+Fe+" 0 R"),$e("/Info "+(Fe-1)+" 0 R"),d!==null&&$e("/Encrypt "+Ba.oid+" 0 R"),$e("/ID [ <"+_e+"> <"+_e+"> ]"),$e(">>")},_a=x.__private__.putHeader=function(){$e("%PDF-"+E),$e("%")},xc=x.__private__.putXRef=function(){var ue="0000000000";$e("xref"),$e("0 "+(Fe+1)),$e("0000000000 65535 f ");for(var Ge=1;Ge<=Fe;Ge++)typeof Xe[Ge]=="function"?$e((ue+Xe[Ge]()).slice(-10)+" 00000 n "):Xe[Ge]!==void 0?$e((ue+Xe[Ge]).slice(-10)+" 00000 n "):$e("0000000000 00000 n ")},sl=x.__private__.buildDocument=function(){var ue;Fe=0,ot=0,Be=[],Xe=[],Qe=[],Bi=Ut(),Ci=Ut(),st(Be),en.publish("buildDocument"),_a(),fa(),(function(){en.publish("putAdditionalObjects");for(var bt=0;bt<Qe.length;bt++){var Bt=Qe[bt];Xr(Bt.objId,!0),$e(Bt.content),$e("endobj")}en.publish("postPutAdditionalObjects")})(),ue=[],(function(){for(var bt in mt)mt.hasOwnProperty(bt)&&(m===!1||m===!0&&b.hasOwnProperty(bt))&&zn(mt[bt])})(),(function(){var bt;for(bt in Ar)Ar.hasOwnProperty(bt)&&Ca(Ar[bt])})(),(function(){for(var bt in Qr)Qr.hasOwnProperty(bt)&&La(Qr[bt])})(),(function(bt){var Bt;for(Bt in qt)qt.hasOwnProperty(Bt)&&(qt[Bt]instanceof wm?Gi(qt[Bt]):qt[Bt]instanceof a0&&fs(qt[Bt],bt))})(ue),en.publish("putResources"),ue.forEach(Mo),Mo({resourcesOid:Ci,objectOid:Number.MAX_SAFE_INTEGER}),en.publish("postPutResources"),d!==null&&(Ba.oid=Wt(),$e("<<"),$e("/Filter /Standard"),$e("/V "+Ba.v),$e("/R "+Ba.r),$e("/U <"+Ba.toHexString(Ba.U)+">"),$e("/O <"+Ba.toHexString(Ba.O)+">"),$e("/P "+Ba.P),$e(">>"),$e("endobj")),ps(),Ul();var Ge=ot;return xc(),Fa(),$e("startxref"),$e(""+Ge),$e("%%EOF"),st(rt[Ee]),Be.join(`
`)},ts=x.__private__.getBlob=function(ue){return new Blob([Ht(ue)],{type:"application/pdf"})},oo=x.output=x.__private__.output=(Tt=function(ue,Ge){switch(typeof(Ge=Ge||{})=="string"?Ge={filename:Ge}:Ge.filename=Ge.filename||"generated.pdf",ue){case void 0:return sl();case"save":x.save(Ge.filename);break;case"arraybuffer":return Ht(sl());case"blob":return ts(sl());case"bloburi":case"bloburl":if(Oi.URL!==void 0&&typeof Oi.URL.createObjectURL=="function")return Oi.URL&&Oi.URL.createObjectURL(ts(sl()))||void 0;Ro.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var bt="",Bt=sl();try{bt=l9(Bt)}catch{bt=l9(unescape(encodeURIComponent(Bt)))}return"data:application/pdf;filename="+Ge.filename+";base64,"+bt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Oi)==="[object Window]"){var sr="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Nr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ge.pdfObjectUrl&&(sr=Ge.pdfObjectUrl,Nr="");var Zr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+sr+'"'+Nr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ge)+");<\/script></body></html>",Ln=Oi.open();return Ln!==null&&Ln.document.write(Zr),Ln}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Oi)==="[object Window]"){var qn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ge.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ge.filename+'" width="500px" height="400px" /></body></html>',Un=Oi.open();if(Un!==null){Un.document.write(qn);var ui=this;Un.document.documentElement.querySelector("#pdfViewer").onload=function(){Un.document.title=Ge.filename,Un.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ui.output("bloburl"))}}return Un}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Oi)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Hn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ge)+'"></iframe></body></html>',Ui=Oi.open();if(Ui!==null&&(Ui.document.write(Hn),Ui.document.title=Ge.filename),Ui||typeof safari>"u")return Ui;break;case"datauri":case"dataurl":return Oi.document.location.href=this.output("datauristring",Ge);default:return null}},Tt.foo=function(){try{return Tt.apply(this,arguments)}catch(bt){var ue=bt.stack||"";~ue.indexOf(" at ")&&(ue=ue.split(" at ")[1]);var Ge="Error in function "+ue.split(`
`)[0].split("<")[0]+": "+bt.message;if(!Oi.console)throw new Error(Ge);Oi.console.error(Ge,bt),Oi.alert&&alert(Ge)}},Tt.foo.bar=Tt,Tt.foo),rs=function(ue){return Array.isArray(jn)===!0&&jn.indexOf(ue)>-1};switch(n){case"pt":qe=1;break;case"mm":qe=72/25.4;break;case"cm":qe=72/2.54;break;case"in":qe=72;break;case"px":qe=rs("px_scaling")==1?.75:96/72;break;case"pc":case"em":qe=12;break;case"ex":qe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);qe=n}var Ba=null;De(),me();var Us=x.__private__.getPageInfo=x.getPageInfo=function(ue){if(isNaN(ue)||ue%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Mt[ue].objId,pageNumber:ue,pageContext:Mt[ue]}},Uc=x.__private__.getPageInfoByObjId=function(ue){if(isNaN(ue)||ue%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ge in Mt)if(Mt[Ge].objId===ue)break;return Us(Ge)},Pu=x.__private__.getCurrentPageInfo=x.getCurrentPageInfo=function(){return{objId:Mt[Ee].objId,pageNumber:Ee,pageContext:Mt[Ee]}};x.addPage=function(){return Iu.apply(this,arguments),this},x.setPage=function(){return Za.apply(this,arguments),st.call(this,rt[Ee]),this},x.insertPage=function(ue){return this.addPage(),this.movePage(Ee,ue),this},x.movePage=function(ue,Ge){var bt,Bt;if(ue>Ge){bt=rt[ue],Bt=Mt[ue];for(var sr=ue;sr>Ge;sr--)rt[sr]=rt[sr-1],Mt[sr]=Mt[sr-1];rt[Ge]=bt,Mt[Ge]=Bt,this.setPage(Ge)}else if(ue<Ge){bt=rt[ue],Bt=Mt[ue];for(var Nr=ue;Nr<Ge;Nr++)rt[Nr]=rt[Nr+1],Mt[Nr]=Mt[Nr+1];rt[Ge]=bt,Mt[Ge]=Bt,this.setPage(Ge)}return this},x.deletePage=function(){return ga.apply(this,arguments),this},x.__private__.text=x.text=function(ue,Ge,bt,Bt,sr){var Nr,Zr,Ln,qn,Un,ui,Hn,Ui,Xi,ra=(Bt=Bt||{}).scope||this;if(typeof ue=="number"&&typeof Ge=="number"&&(typeof bt=="string"||Array.isArray(bt))){var Si=bt;bt=Ge,Ge=ue,ue=Si}if(arguments[3]instanceof un==0?(Ln=arguments[4],qn=arguments[5],fo(Hn=arguments[3])==="object"&&Hn!==null||(typeof Ln=="string"&&(qn=Ln,Ln=null),typeof Hn=="string"&&(qn=Hn,Hn=null),typeof Hn=="number"&&(Ln=Hn,Hn=null),Bt={flags:Hn,angle:Ln,align:qn})):(X("The transform parameter of text() with a Matrix value"),Xi=sr),isNaN(Ge)||isNaN(bt)||ue==null)throw new Error("Invalid arguments passed to jsPDF.text");if(ue.length===0)return ra;var Ia,za="",Hs=typeof Bt.lineHeightFactor=="number"?Bt.lineHeightFactor:Ri,ll=ra.internal.scaleFactor;function Ws(Pn){return Pn=Pn.split("	").join(Array(Bt.TabLen||9).join(" ")),xi(Pn,Hn)}function $o(Pn){for(var I,y=Pn.concat(),_=[],P=y.length;P--;)typeof(I=y.shift())=="string"?_.push(I):Array.isArray(Pn)&&(I.length===1||I[1]===void 0&&I[2]===void 0)?_.push(I[0]):_.push([I[0],I[1],I[2]]);return _}function Gs(Pn,I){var y;if(typeof Pn=="string")y=I(Pn)[0];else if(Array.isArray(Pn)){for(var _,P,$=Pn.concat(),ne=[],ye=$.length;ye--;)typeof(_=$.shift())=="string"?ne.push(I(_)[0]):Array.isArray(_)&&typeof _[0]=="string"&&(P=I(_[0],_[1],_[2]),ne.push([P[0],P[1],P[2]]));y=ne}return y}var Pa=!1,Xs=!0;if(typeof ue=="string")Pa=!0;else if(Array.isArray(ue)){var Il=ue.concat();Zr=[];for(var gs,Di=Il.length;Di--;)(typeof(gs=Il.shift())!="string"||Array.isArray(gs)&&typeof gs[0]!="string")&&(Xs=!1);Pa=Xs}if(Pa===!1)throw new Error('Type of text must be string or Array. "'+ue+'" is not recognized.');typeof ue=="string"&&(ue=ue.match(/[\r?\n]/)?ue.split(/\r\n|\r|\n/g):[ue]);var qo=_t/ra.internal.scaleFactor,Da=qo*(Hs-1);switch(Bt.baseline){case"bottom":bt-=Da;break;case"top":bt+=qo-Da;break;case"hanging":bt+=qo-2*Da;break;case"middle":bt+=qo/2-Da}if((ui=Bt.maxWidth||0)>0&&(typeof ue=="string"?ue=ra.splitTextToSize(ue,ui):Object.prototype.toString.call(ue)==="[object Array]"&&(ue=ue.reduce(function(Pn,I){return Pn.concat(ra.splitTextToSize(I,ui))},[]))),Nr={text:ue,x:Ge,y:bt,options:Bt,mutex:{pdfEscape:xi,activeFontKey:je,fonts:mt,activeFontSize:_t}},en.publish("preProcessText",Nr),ue=Nr.text,Ln=(Bt=Nr.options).angle,Xi instanceof un==0&&Ln&&typeof Ln=="number"){Ln*=Math.PI/180,Bt.rotationDirection===0&&(Ln=-Ln),O===N&&(Ln=-Ln);var ns=Math.cos(Ln),As=Math.sin(Ln);Xi=new un(ns,As,-As,ns,0,0)}else Ln&&Ln instanceof un&&(Xi=Ln);O!==N||Xi||(Xi=Me),(Un=Bt.charSpace||oa)!==void 0&&(za+=G(oe(Un))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ui=Bt.horizontalScale)!==void 0&&(za+=G(100*Ui)+` Tz
`),Bt.lang;var Ja=-1,rc=Bt.renderingMode!==void 0?Bt.renderingMode:Bt.stroke,uu=ra.internal.getCurrentPageInfo().pageContext;switch(rc){case 0:case!1:case"fill":Ja=0;break;case 1:case!0:case"stroke":Ja=1;break;case 2:case"fillThenStroke":Ja=2;break;case 3:case"invisible":Ja=3;break;case 4:case"fillAndAddForClipping":Ja=4;break;case 5:case"strokeAndAddPathForClipping":Ja=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ja=6;break;case 7:case"addToPathForClipping":Ja=7}var Ys=uu.usedRenderingMode!==void 0?uu.usedRenderingMode:-1;Ja!==-1?za+=Ja+` Tr
`:Ys!==-1&&(za+=`0 Tr
`),Ja!==-1&&(uu.usedRenderingMode=Ja),qn=Bt.align||"left";var ja,Is=_t*Hs,nc=ra.internal.pageSize.getWidth(),ic=mt[je];Un=Bt.charSpace||oa,ui=Bt.maxWidth||0,Hn=Object.assign({autoencode:!0,noBOM:!0},Bt.flags);var ul=[],cu=function(Pn){return ra.getStringUnitWidth(Pn,{font:ic,charSpace:Un,fontSize:_t,doKerning:!1})*_t/ll};if(Object.prototype.toString.call(ue)==="[object Array]"){var Oo;Zr=$o(ue),qn!=="left"&&(ja=Zr.map(cu));var mo,Du=0;if(qn==="right"){Ge-=ja[0],ue=[],Di=Zr.length;for(var Ua=0;Ua<Di;Ua++)Ua===0?(mo=$i(Ge),Oo=ba(bt)):(mo=oe(Du-ja[Ua]),Oo=-Is),ue.push([Zr[Ua],mo,Oo]),Du=ja[Ua]}else if(qn==="center"){Ge-=ja[0]/2,ue=[],Di=Zr.length;for(var hu=0;hu<Di;hu++)hu===0?(mo=$i(Ge),Oo=ba(bt)):(mo=oe((Du-ja[hu])/2),Oo=-Is),ue.push([Zr[hu],mo,Oo]),Du=ja[hu]}else if(qn==="left"){ue=[],Di=Zr.length;for(var Zs=0;Zs<Di;Zs++)ue.push(Zr[Zs])}else if(qn==="justify"&&ic.encoding==="Identity-H"){ue=[],Di=Zr.length,ui=ui!==0?ui:nc;for(var ms=0,Va=0;Va<Di;Va++)if(Oo=Va===0?ba(bt):-Is,mo=Va===0?$i(Ge):ms,Va<Di-1){var Vl=oe((ui-ja[Va])/(Zr[Va].split(" ").length-1)),cl=Zr[Va].split(" ");ue.push([cl[0]+" ",mo,Oo]),ms=0;for(var hl=1;hl<cl.length;hl++){var $l=(cu(cl[hl-1]+" "+cl[hl])-cu(cl[hl]))*ll+Vl;hl==cl.length-1?ue.push([cl[hl],$l,0]):ue.push([cl[hl]+" ",$l,0]),ms-=$l}}else ue.push([Zr[Va],mo,Oo]);ue.push(["",ms,0])}else{if(qn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(ue=[],Di=Zr.length,ui=ui!==0?ui:nc,Va=0;Va<Di;Va++)Oo=Va===0?ba(bt):-Is,mo=Va===0?$i(Ge):0,Va<Di-1?ul.push(G(oe((ui-ja[Va])/(Zr[Va].split(" ").length-1)))):ul.push(0),ue.push([Zr[Va],mo,Oo])}}(typeof Bt.R2L=="boolean"?Bt.R2L:lr)===!0&&(ue=Gs(ue,function(Pn,I,y){return[Pn.split("").reverse().join(""),I,y]})),Nr={text:ue,x:Ge,y:bt,options:Bt,mutex:{pdfEscape:xi,activeFontKey:je,fonts:mt,activeFontSize:_t}},en.publish("postProcessText",Nr),ue=Nr.text,Ia=Nr.mutex.isHex||!1;var ql=mt[je].encoding;ql!=="WinAnsiEncoding"&&ql!=="StandardEncoding"||(ue=Gs(ue,function(Pn,I,y){return[Ws(Pn),I,y]})),Zr=$o(ue),ue=[];for(var fl,Hl,Ou,tr=Array.isArray(Zr[0])?1:0,mr="",dn=function(Pn,I,y){var _="";return y instanceof un?(y=typeof Bt.angle=="number"?Kn(y,new un(1,0,0,1,Pn,I)):Kn(new un(1,0,0,1,Pn,I),y),O===N&&(y=Kn(new un(1,0,0,-1,0,0),y)),_=y.join(" ")+` Tm
`):_=G(Pn)+" "+G(I)+` Td
`,_},In=0;In<Zr.length;In++){switch(mr="",tr){case 1:Ou=(Ia?"<":"(")+Zr[In][0]+(Ia?">":")"),fl=parseFloat(Zr[In][1]),Hl=parseFloat(Zr[In][2]);break;case 0:Ou=(Ia?"<":"(")+Zr[In]+(Ia?">":")"),fl=$i(Ge),Hl=ba(bt)}ul!==void 0&&ul[In]!==void 0&&(mr=ul[In]+` Tw
`),In===0?ue.push(mr+dn(fl,Hl,Xi)+Ou):tr===0?ue.push(mr+Ou):tr===1&&ue.push(mr+dn(fl,Hl,Xi)+Ou)}ue=tr===0?ue.join(` Tj
T* `):ue.join(` Tj
`),ue+=` Tj
`;var vi=`BT
/`;return vi+=je+" "+_t+` Tf
`,vi+=G(_t*Hs)+` TL
`,vi+=Mi+`
`,vi+=za,vi+=ue,$e(vi+="ET"),b[je]=!0,ra};var ee=x.__private__.clip=x.clip=function(ue){return $e(ue==="evenodd"?"W*":"W"),this};x.clipEvenOdd=function(){return ee("evenodd")},x.__private__.discardPath=x.discardPath=function(){return $e("n"),this};var pe=x.__private__.isValidStyle=function(ue){var Ge=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(ue)!==-1&&(Ge=!0),Ge};x.__private__.setDefaultPathOperation=x.setDefaultPathOperation=function(ue){return pe(ue)&&(h=ue),this};var Ke=x.__private__.getStyle=x.getStyle=function(ue){var Ge=h;switch(ue){case"D":case"S":Ge="S";break;case"F":Ge="f";break;case"FD":case"DF":Ge="B";break;case"f":case"f*":case"B":case"B*":Ge=ue}return Ge},It=x.close=function(){return $e("h"),this};x.stroke=function(){return $e("S"),this},x.fill=function(ue){return Vt("f",ue),this},x.fillEvenOdd=function(ue){return Vt("f*",ue),this},x.fillStroke=function(ue){return Vt("B",ue),this},x.fillStrokeEvenOdd=function(ue){return Vt("B*",ue),this};var Vt=function(ue,Ge){fo(Ge)==="object"?Yr(Ge,ue):$e(ue)},$t=function(ue){ue===null||O===N&&ue===void 0||(ue=Ke(ue),$e(ue))};function er(ue,Ge,bt,Bt,sr){var Nr=new a0(Ge||this.boundingBox,bt||this.xStep,Bt||this.yStep,this.gState,sr||this.matrix);Nr.stream=this.stream;var Zr=ue+"$$"+this.cloneIndex+++"$$";return He(Zr,Nr),Nr}var Yr=function(ue,Ge){var bt=Ir[ue.key],Bt=qt[bt];if(Bt instanceof wm)$e("q"),$e(tn(Ge)),Bt.gState&&x.setGState(Bt.gState),$e(ue.matrix.toString()+" cm"),$e("/"+bt+" sh"),$e("Q");else if(Bt instanceof a0){var sr=new un(1,0,0,-1,0,Do());ue.matrix&&(sr=sr.multiply(ue.matrix||Me),bt=er.call(Bt,ue.key,ue.boundingBox,ue.xStep,ue.yStep,sr).id),$e("q"),$e("/Pattern cs"),$e("/"+bt+" scn"),Bt.gState&&x.setGState(Bt.gState),$e(Ge),$e("Q")}},tn=function(ue){switch(ue){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Wr=x.moveTo=function(ue,Ge){return $e(G(oe(ue))+" "+G(se(Ge))+" m"),this},on=x.lineTo=function(ue,Ge){return $e(G(oe(ue))+" "+G(se(Ge))+" l"),this},kr=x.curveTo=function(ue,Ge,bt,Bt,sr,Nr){return $e([G(oe(ue)),G(se(Ge)),G(oe(bt)),G(se(Bt)),G(oe(sr)),G(se(Nr)),"c"].join(" ")),this};x.__private__.line=x.line=function(ue,Ge,bt,Bt,sr){if(isNaN(ue)||isNaN(Ge)||isNaN(bt)||isNaN(Bt)||!pe(sr))throw new Error("Invalid arguments passed to jsPDF.line");return O===F?this.lines([[bt-ue,Bt-Ge]],ue,Ge,[1,1],sr||"S"):this.lines([[bt-ue,Bt-Ge]],ue,Ge,[1,1]).stroke()},x.__private__.lines=x.lines=function(ue,Ge,bt,Bt,sr,Nr){var Zr,Ln,qn,Un,ui,Hn,Ui,Xi,ra,Si,Ia,za;if(typeof ue=="number"&&(za=bt,bt=Ge,Ge=ue,ue=za),Bt=Bt||[1,1],Nr=Nr||!1,isNaN(Ge)||isNaN(bt)||!Array.isArray(ue)||!Array.isArray(Bt)||!pe(sr)||typeof Nr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Wr(Ge,bt),Zr=Bt[0],Ln=Bt[1],Un=ue.length,Si=Ge,Ia=bt,qn=0;qn<Un;qn++)(ui=ue[qn]).length===2?(Si=ui[0]*Zr+Si,Ia=ui[1]*Ln+Ia,on(Si,Ia)):(Hn=ui[0]*Zr+Si,Ui=ui[1]*Ln+Ia,Xi=ui[2]*Zr+Si,ra=ui[3]*Ln+Ia,Si=ui[4]*Zr+Si,Ia=ui[5]*Ln+Ia,kr(Hn,Ui,Xi,ra,Si,Ia));return Nr&&It(),$t(sr),this},x.path=function(ue){for(var Ge=0;Ge<ue.length;Ge++){var bt=ue[Ge],Bt=bt.c;switch(bt.op){case"m":Wr(Bt[0],Bt[1]);break;case"l":on(Bt[0],Bt[1]);break;case"c":kr.apply(this,Bt);break;case"h":It()}}return this},x.__private__.rect=x.rect=function(ue,Ge,bt,Bt,sr){if(isNaN(ue)||isNaN(Ge)||isNaN(bt)||isNaN(Bt)||!pe(sr))throw new Error("Invalid arguments passed to jsPDF.rect");return O===F&&(Bt=-Bt),$e([G(oe(ue)),G(se(Ge)),G(oe(bt)),G(oe(Bt)),"re"].join(" ")),$t(sr),this},x.__private__.triangle=x.triangle=function(ue,Ge,bt,Bt,sr,Nr,Zr){if(isNaN(ue)||isNaN(Ge)||isNaN(bt)||isNaN(Bt)||isNaN(sr)||isNaN(Nr)||!pe(Zr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[bt-ue,Bt-Ge],[sr-bt,Nr-Bt],[ue-sr,Ge-Nr]],ue,Ge,[1,1],Zr,!0),this},x.__private__.roundedRect=x.roundedRect=function(ue,Ge,bt,Bt,sr,Nr,Zr){if(isNaN(ue)||isNaN(Ge)||isNaN(bt)||isNaN(Bt)||isNaN(sr)||isNaN(Nr)||!pe(Zr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ln=4/3*(Math.SQRT2-1);return sr=Math.min(sr,.5*bt),Nr=Math.min(Nr,.5*Bt),this.lines([[bt-2*sr,0],[sr*Ln,0,sr,Nr-Nr*Ln,sr,Nr],[0,Bt-2*Nr],[0,Nr*Ln,-sr*Ln,Nr,-sr,Nr],[2*sr-bt,0],[-sr*Ln,0,-sr,-Nr*Ln,-sr,-Nr],[0,2*Nr-Bt],[0,-Nr*Ln,sr*Ln,-Nr,sr,-Nr]],ue+sr,Ge,[1,1],Zr,!0),this},x.__private__.ellipse=x.ellipse=function(ue,Ge,bt,Bt,sr){if(isNaN(ue)||isNaN(Ge)||isNaN(bt)||isNaN(Bt)||!pe(sr))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Nr=4/3*(Math.SQRT2-1)*bt,Zr=4/3*(Math.SQRT2-1)*Bt;return Wr(ue+bt,Ge),kr(ue+bt,Ge-Zr,ue+Nr,Ge-Bt,ue,Ge-Bt),kr(ue-Nr,Ge-Bt,ue-bt,Ge-Zr,ue-bt,Ge),kr(ue-bt,Ge+Zr,ue-Nr,Ge+Bt,ue,Ge+Bt),kr(ue+Nr,Ge+Bt,ue+bt,Ge+Zr,ue+bt,Ge),$t(sr),this},x.__private__.circle=x.circle=function(ue,Ge,bt,Bt){if(isNaN(ue)||isNaN(Ge)||isNaN(bt)||!pe(Bt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(ue,Ge,bt,bt,Bt)},x.setFont=function(ue,Ge,bt){return bt&&(Ge=H(Ge,bt)),je=Aa(ue,Ge,{disableWarning:!1}),this};var ti=x.__private__.getFont=x.getFont=function(){return mt[Aa.apply(x,arguments)]};x.__private__.getFontList=x.getFontList=function(){var ue,Ge,bt={};for(ue in ct)if(ct.hasOwnProperty(ue))for(Ge in bt[ue]=[],ct[ue])ct[ue].hasOwnProperty(Ge)&&bt[ue].push(Ge);return bt},x.addFont=function(ue,Ge,bt,Bt,sr){var Nr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Nr.indexOf(arguments[3])!==-1?sr=arguments[3]:arguments[3]&&Nr.indexOf(arguments[3])==-1&&(bt=H(bt,Bt)),ol.call(this,ue,Ge,bt,sr=sr||"Identity-H")};var Ri,$n=t.lineWidth||.200025,_n=x.__private__.getLineWidth=x.getLineWidth=function(){return $n},Mr=x.__private__.setLineWidth=x.setLineWidth=function(ue){return $n=ue,$e(G(oe(ue))+" w"),this};x.__private__.setLineDash=di.API.setLineDash=di.API.setLineDashPattern=function(ue,Ge){if(ue=ue||[],Ge=Ge||0,isNaN(Ge)||!Array.isArray(ue))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return ue=ue.map(function(bt){return G(oe(bt))}).join(" "),Ge=G(oe(Ge)),$e("["+ue+"] "+Ge+" d"),this};var fn=x.__private__.getLineHeight=x.getLineHeight=function(){return _t*Ri};x.__private__.getLineHeight=x.getLineHeight=function(){return _t*Ri};var mn=x.__private__.setLineHeightFactor=x.setLineHeightFactor=function(ue){return typeof(ue=ue||1.15)=="number"&&(Ri=ue),this},hi=x.__private__.getLineHeightFactor=x.getLineHeightFactor=function(){return Ri};mn(t.lineHeight);var $i=x.__private__.getHorizontalCoordinate=function(ue){return oe(ue)},ba=x.__private__.getVerticalCoordinate=function(ue){return O===N?ue:Mt[Ee].mediaBox.topRightY-Mt[Ee].mediaBox.bottomLeftY-oe(ue)},wi=x.__private__.getHorizontalCoordinateString=x.getHorizontalCoordinateString=function(ue){return G($i(ue))},fi=x.__private__.getVerticalCoordinateString=x.getVerticalCoordinateString=function(ue){return G(ba(ue))},Ts=t.strokeColor||"0 G";x.__private__.getStrokeColor=x.getDrawColor=function(){return Fr(Ts)},x.__private__.setStrokeColor=x.setDrawColor=function(ue,Ge,bt,Bt){return Ts=Mn({ch1:ue,ch2:Ge,ch3:bt,ch4:Bt,pdfColorType:"draw",precision:2}),$e(Ts),this};var Vs=t.fillColor||"0 g";x.__private__.getFillColor=x.getFillColor=function(){return Fr(Vs)},x.__private__.setFillColor=x.setFillColor=function(ue,Ge,bt,Bt){return Vs=Mn({ch1:ue,ch2:Ge,ch3:bt,ch4:Bt,pdfColorType:"fill",precision:2}),$e(Vs),this};var Mi=t.textColor||"0 g",Cs=x.__private__.getTextColor=x.getTextColor=function(){return Fr(Mi)};x.__private__.setTextColor=x.setTextColor=function(ue,Ge,bt,Bt){return Mi=Mn({ch1:ue,ch2:Ge,ch3:bt,ch4:Bt,pdfColorType:"text",precision:3}),this};var oa=t.charSpace,ku=x.__private__.getCharSpace=x.getCharSpace=function(){return parseFloat(oa||0)};x.__private__.setCharSpace=x.setCharSpace=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return oa=ue,this};var Ka=0;x.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},x.__private__.setLineCap=x.setLineCap=function(ue){var Ge=x.CapJoinStyles[ue];if(Ge===void 0)throw new Error("Line cap style of '"+ue+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ka=Ge,$e(Ge+" J"),this};var $s=0;x.__private__.setLineJoin=x.setLineJoin=function(ue){var Ge=x.CapJoinStyles[ue];if(Ge===void 0)throw new Error("Line join style of '"+ue+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return $s=Ge,$e(Ge+" j"),this},x.__private__.setLineMiterLimit=x.__private__.setMiterLimit=x.setLineMiterLimit=x.setMiterLimit=function(ue){if(ue=ue||0,isNaN(ue))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return $e(G(oe(ue))+" M"),this},x.GState=JS,x.setGState=function(ue){(ue=typeof ue=="string"?Ar[$r[ue]]:Vo(null,ue)).equals(hn)||($e("/"+ue.id+" gs"),hn=ue)};var Vo=function(ue,Ge){if(!ue||!$r[ue]){var bt=!1;for(var Bt in Ar)if(Ar.hasOwnProperty(Bt)&&Ar[Bt].equals(Ge)){bt=!0;break}if(bt)Ge=Ar[Bt];else{var sr="GS"+(Object.keys(Ar).length+1).toString(10);Ar[sr]=Ge,Ge.id=sr}return ue&&($r[ue]=Ge.id),en.publish("addGState",Ge),Ge}};x.addGState=function(ue,Ge){return Vo(ue,Ge),this},x.saveGraphicsState=function(){return $e("q"),Kt.push({key:je,size:_t,color:Mi}),this},x.restoreGraphicsState=function(){$e("Q");var ue=Kt.pop();return je=ue.key,_t=ue.size,Mi=ue.color,hn=null,this},x.setCurrentTransformationMatrix=function(ue){return $e(ue.toString()+" cm"),this},x.comment=function(ue){return $e("#"+ue),this};var Ru=function(ue,Ge){var bt=ue||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return bt},set:function(Nr){isNaN(Nr)||(bt=parseFloat(Nr))}});var Bt=Ge||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Bt},set:function(Nr){isNaN(Nr)||(Bt=parseFloat(Nr))}});var sr="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return sr},set:function(Nr){sr=Nr.toString()}}),this},Mu=function(ue,Ge,bt,Bt){Ru.call(this,ue,Ge),this.type="rect";var sr=bt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return sr},set:function(Zr){isNaN(Zr)||(sr=parseFloat(Zr))}});var Nr=Bt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Nr},set:function(Zr){isNaN(Zr)||(Nr=parseFloat(Zr))}}),this},go=function(){this.page=zr,this.currentPage=Ee,this.pages=rt.slice(0),this.pagesContext=Mt.slice(0),this.x=We,this.y=Lt,this.matrix=Et,this.width=ii(Ee),this.height=Do(Ee),this.outputDestination=zt,this.id="",this.objectNumber=-1};go.prototype.restore=function(){zr=this.page,Ee=this.currentPage,Mt=this.pagesContext,rt=this.pages,We=this.x,Lt=this.y,Et=this.matrix,ri(Ee,this.width),ai(Ee,this.height),zt=this.outputDestination};var ji=function(ue,Ge,bt,Bt,sr){oi.push(new go),zr=Ee=0,rt=[],We=ue,Lt=Ge,Et=sr,zi([bt,Bt])};for(var qs in x.beginFormObject=function(ue,Ge,bt,Bt,sr){return ji(ue,Ge,bt,Bt,sr),this},x.endFormObject=function(ue){return(function(Ge){if(nr[Ge])oi.pop().restore();else{var bt=new go,Bt="Xo"+(Object.keys(Qr).length+1).toString(10);bt.id=Bt,nr[Ge]=Bt,Qr[Bt]=bt,en.publish("addFormObject",bt),oi.pop().restore()}})(ue),this},x.doFormObject=function(ue,Ge){var bt=Qr[nr[ue]];return $e("q"),$e(Ge.toString()+" cm"),$e("/"+bt.id+" Do"),$e("Q"),this},x.getFormObject=function(ue){var Ge=Qr[nr[ue]];return{x:Ge.x,y:Ge.y,width:Ge.width,height:Ge.height,matrix:Ge.matrix}},x.save=function(ue,Ge){return ue=ue||"generated.pdf",(Ge=Ge||{}).returnPromise=Ge.returnPromise||!1,Ge.returnPromise===!1?(_m(ts(sl()),ue),typeof _m.unload=="function"&&Oi.setTimeout&&setTimeout(_m.unload,911),this):new Promise(function(bt,Bt){try{var sr=_m(ts(sl()),ue);typeof _m.unload=="function"&&Oi.setTimeout&&setTimeout(_m.unload,911),bt(sr)}catch(Nr){Bt(Nr.message)}})},di.API)di.API.hasOwnProperty(qs)&&(qs==="events"&&di.API.events.length?(function(ue,Ge){var bt,Bt,sr;for(sr=Ge.length-1;sr!==-1;sr--)bt=Ge[sr][0],Bt=Ge[sr][1],ue.subscribe.apply(ue,[bt].concat(typeof Bt=="function"?[Bt]:Bt))})(en,di.API.events):x[qs]=di.API[qs]);var ii=x.getPageWidth=function(ue){return(Mt[ue=ue||Ee].mediaBox.topRightX-Mt[ue].mediaBox.bottomLeftX)/qe},ri=x.setPageWidth=function(ue,Ge){Mt[ue].mediaBox.topRightX=Ge*qe+Mt[ue].mediaBox.bottomLeftX},Do=x.getPageHeight=function(ue){return(Mt[ue=ue||Ee].mediaBox.topRightY-Mt[ue].mediaBox.bottomLeftY)/qe},ai=x.setPageHeight=function(ue,Ge){Mt[ue].mediaBox.topRightY=Ge*qe+Mt[ue].mediaBox.bottomLeftY};return x.internal={pdfEscape:xi,getStyle:Ke,getFont:ti,getFontSize:br,getCharSpace:ku,getTextColor:Cs,getLineHeight:fn,getLineHeightFactor:hi,getLineWidth:_n,write:Jt,getHorizontalCoordinate:$i,getVerticalCoordinate:ba,getCoordinateString:wi,getVerticalCoordinateString:fi,collections:{},newObject:Wt,newAdditionalObject:Nn,newObjectDeferred:Ut,newObjectDeferredBegin:Xr,getFilters:Bn,putStream:ei,events:en,scaleFactor:qe,pageSize:{getWidth:function(){return ii(Ee)},setWidth:function(ue){ri(Ee,ue)},getHeight:function(){return Do(Ee)},setHeight:function(ue){ai(Ee,ue)}},encryptionOptions:d,encryption:Ba,getEncryptor:function(ue){return d!==null?Ba.encryptor(ue,0):function(Ge){return Ge}},output:oo,getNumberOfPages:ds,pages:rt,out:$e,f2:Q,f3:W,getPageInfo:Us,getPageInfoByObjId:Uc,getCurrentPageInfo:Pu,getPDFVersion:T,Point:Ru,Rectangle:Mu,Matrix:un,hasHotfix:rs},Object.defineProperty(x.internal.pageSize,"width",{get:function(){return ii(Ee)},set:function(ue){ri(Ee,ue)},enumerable:!0,configurable:!0}),Object.defineProperty(x.internal.pageSize,"height",{get:function(){return Do(Ee)},set:function(ue){ai(Ee,ue)},enumerable:!0,configurable:!0}),(function(ue){for(var Ge=0,bt=pr.length;Ge<bt;Ge++){var Bt=ol.call(this,ue[Ge][0],ue[Ge][1],ue[Ge][2],pr[Ge][3],!0);m===!1&&(b[Bt]=!0);var sr=ue[Ge][0].split("-");Ya({id:Bt,fontName:sr[0],fontStyle:sr[1]||""})}en.publish("addFonts",{fonts:mt,dictionary:ct})}).call(x,pr),je="F1",Iu(i,r),en.publish("initialized"),x}Lv.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Lv.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Lv.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Lv.prototype.processOwnerPassword=function(t,e){return Qk(Jk(e).substr(0,5),t)},Lv.prototype.encryptor=function(t,e){var r=Jk(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Qk(r,n)}},JS.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||fo(t)!==fo(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},di.API={events:[]},di.version="3.0.2";var zs=di.API,vO=1,wy=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},gv=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Vi=function(t){return t.toFixed(2)},Qp=function(t){return t.toFixed(5)};zs.__acroform__={};var Fc=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},f9=function(t){return t*vO},id=function(t){var e=new sZ,r=Qn.internal.getHeight(t)||0,n=Qn.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Vi(n)),Number(Vi(r))],e},j0e=zs.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},U0e=zs.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},V0e=zs.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},el=zs.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return V0e(t,e-1)},tl=zs.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return j0e(t,e-1)},rl=zs.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return U0e(t,e-1)},$0e=zs.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],a=t[1],s=t[2],o=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(a+o)||0,c.upperRight_X=r(i+s)||0,c.upperRight_Y=n(a)||0,[Number(Vi(c.lowerLeft_X)),Number(Vi(c.lowerLeft_Y)),Number(Vi(c.upperRight_X)),Number(Vi(c.upperRight_Y))]},q0e=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=eR(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+Vi(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=id(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},eR=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(Q){return Q.split(`
`)}):i.map(function(Q){return[Q]});var a=r,s=Qn.internal.getHeight(t)||0;s=s<0?-s:s;var o=Qn.internal.getWidth(t)||0;o=o<0?-o:o;var c=function(Q,W,oe){if(Q+1<i.length){var se=W+" "+i[Q+1][0];return aw(se,t,oe).width<=o-4}return!1};a++;e:for(;a>0;){e="",a--;var h,d,m=aw("3",t,a).height,b=t.multiline?s-a:(s-m)/2,x=b+=2,E=0,T=0,A=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+aw(e,t,a=12).width+", FieldWidth:"+o+`
`;break}for(var M="",F=0,N=0;N<i.length;N++)if(i.hasOwnProperty(N)){var O=!1;if(i[N].length!==1&&A!==i[N].length-1){if((m+2)*(F+2)+2>s)continue e;M+=i[N][A],O=!0,T=N,N--}else{M=(M+=i[N][A]+" ").substr(M.length-1)==" "?M.substr(0,M.length-1):M;var U=parseInt(N),j=c(U,M,a),H=N>=i.length-1;if(j&&!H){M+=" ",A=0;continue}if(j||H){if(H)T=U;else if(t.multiline&&(m+2)*(F+2)+2>s)continue e}else{if(!t.multiline||(m+2)*(F+2)+2>s)continue e;T=U}}for(var G="",X=E;X<=T;X++){var ae=i[X];if(t.multiline){if(X===T){G+=ae[A]+" ",A=(A+1)%ae.length;continue}if(X===E){G+=ae[ae.length-1]+" ";continue}}G+=ae[0]+" "}switch(G=G.substr(G.length-1)==" "?G.substr(0,G.length-1):G,d=aw(G,t,a).width,t.textAlign){case"right":h=o-d-2;break;case"center":h=(o-d)/2;break;default:h=2}e+=Vi(h)+" "+Vi(x)+` Td
`,e+="("+wy(G)+`) Tj
`,e+=-Vi(h)+` 0 Td
`,x=-(a+2),d=0,E=O?T:T+1,F++,M=""}break}return n.text=e,n.fontSize=a,n},aw=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},H0e={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},W0e=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},G0e=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Mf.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(H0e)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");vO=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new lZ,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&W0e(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var a=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],c=[],h=o.Rect;if(o.Rect&&(o.Rect=$0e(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Qn.createDefaultAppearanceStream(o),fo(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(c=o.getKeyValueListForStream()),o.Rect=h,o.hasAppearanceStream&&!o.appearanceStreamContent){var d=q0e(o);c.push({key:"AP",value:"<</N "+d+">>"}),i.internal.acroformPlugin.xForms.push(d)}if(o.appearanceStreamContent){var m="";for(var b in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(b)){var x=o.appearanceStreamContent[b];if(m+="/"+b+" ",m+="<<",Object.keys(x).length>=1||Array.isArray(x)){for(var s in x)if(x.hasOwnProperty(s)){var E=x[s];typeof E=="function"&&(E=E.call(i,o)),m+="/"+s+" "+E+" ",i.internal.acroformPlugin.xForms.indexOf(E)>=0||i.internal.acroformPlugin.xForms.push(E)}}else typeof(E=x)=="function"&&(E=E.call(i,o)),m+="/"+s+" "+E,i.internal.acroformPlugin.xForms.indexOf(E)>=0||i.internal.acroformPlugin.xForms.push(E);m+=">>"}c.push({key:"AP",value:`<<
`+m+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:o.objId}),i.internal.out("endobj")}a&&(function(T,A){for(var M in T)if(T.hasOwnProperty(M)){var F=M,N=T[M];A.internal.newObjectDeferredBegin(N.objId,!0),fo(N)==="object"&&typeof N.putStream=="function"&&N.putStream(),delete T[F]}})(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},oZ=zs.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),fo(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+wy(n(t[a].toString()))+")"):i+=t[a].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},FA=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+wy(n(t))+")"},fd=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};fd.prototype.toString=function(){return this.objId+" 0 R"},fd.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},fd.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:oZ(i,this.objId,this.scope)}):i instanceof fd?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var sZ=function(){fd.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Fc(sZ,fd);var lZ=function(){fd.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+wy(r(t))+")"}},set:function(r){t=r}})};Fc(lZ,fd);var Mf=function t(){fd.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(M){if(isNaN(M))throw new Error('Invalid value "'+M+'" for attribute F supplied.');e=M}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!el(e,3)},set:function(M){M?this.F=tl(e,3):this.F=rl(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(M){if(isNaN(M))throw new Error('Invalid value "'+M+'" for attribute Ff supplied.');r=M}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(M){n=M!==void 0?M:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(M){n[0]=M}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(M){n[1]=M}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(M){n[2]=M}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(M){n[3]=M}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(M){switch(M){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=M;break;default:throw new Error('Invalid value "'+M+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof QS)return;a="FieldObject"+t.FieldNum++}var M=function(F){return F};return this.scope&&(M=this.scope.internal.getEncryptor(this.objId)),"("+wy(M(a))+")"},set:function(M){a=M.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(M){a=M}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(M){s=M}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(M){o=M}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(M){c=M}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/vO:h},set:function(M){h=M}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(M){d=M}});var m="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!m||this instanceof QS||this instanceof Bm))return FA(m,this.objId,this.scope)},set:function(M){M=M.toString(),m=M}});var b=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof nu==0?FA(b,this.objId,this.scope):b},set:function(M){M=M.toString(),b=this instanceof nu==0?M.substr(0,1)==="("?gv(M.substr(1,M.length-2)):gv(M):M}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof nu==1?gv(b.substr(1,b.length-1)):b},set:function(M){M=M.toString(),b=this instanceof nu==1?"/"+M:M}});var x=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(x)return x},set:function(M){this.V=M}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof nu==0?FA(x,this.objId,this.scope):x},set:function(M){M=M.toString(),x=this instanceof nu==0?M.substr(0,1)==="("?gv(M.substr(1,M.length-2)):gv(M):M}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof nu==1?gv(x.substr(1,x.length-1)):x},set:function(M){M=M.toString(),x=this instanceof nu==1?"/"+M:M}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var E,T=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return T},set:function(M){M=!!M,T=M}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(E)return E},set:function(M){E=M}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,1)},set:function(M){M?this.Ff=tl(this.Ff,1):this.Ff=rl(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,2)},set:function(M){M?this.Ff=tl(this.Ff,2):this.Ff=rl(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,3)},set:function(M){M?this.Ff=tl(this.Ff,3):this.Ff=rl(this.Ff,3)}});var A=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(A!==null)return A},set:function(M){if([0,1,2].indexOf(M)===-1)throw new Error('Invalid value "'+M+'" for attribute Q supplied.');A=M}}),Object.defineProperty(this,"textAlign",{get:function(){var M;switch(A){case 0:default:M="left";break;case 1:M="center";break;case 2:M="right"}return M},configurable:!0,enumerable:!0,set:function(M){switch(M){case"right":case 2:A=2;break;case"center":case 1:A=1;break;default:A=0}}})};Fc(Mf,fd);var S0=function(){Mf.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return oZ(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=(function(a,s,o){o||(o=1);for(var c,h=[];c=s.exec(a);)h.push(c[o]);return h})(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,18)},set:function(r){r?this.Ff=tl(this.Ff,18):this.Ff=rl(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=tl(this.Ff,19):this.Ff=rl(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,20)},set:function(r){r?(this.Ff=tl(this.Ff,20),e.sort()):this.Ff=rl(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,22)},set:function(r){r?this.Ff=tl(this.Ff,22):this.Ff=rl(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,23)},set:function(r){r?this.Ff=tl(this.Ff,23):this.Ff=rl(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,27)},set:function(r){r?this.Ff=tl(this.Ff,27):this.Ff=rl(this.Ff,27)}}),this.hasAppearanceStream=!1};Fc(S0,Mf);var E0=function(){S0.call(this),this.fontName="helvetica",this.combo=!1};Fc(E0,S0);var T0=function(){E0.call(this),this.combo=!0};Fc(T0,E0);var fS=function(){T0.call(this),this.edit=!0};Fc(fS,T0);var nu=function(){Mf.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,15)},set:function(r){r?this.Ff=tl(this.Ff,15):this.Ff=rl(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,16)},set:function(r){r?this.Ff=tl(this.Ff,16):this.Ff=rl(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,17)},set:function(r){r?this.Ff=tl(this.Ff,17):this.Ff=rl(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,26)},set:function(r){r?this.Ff=tl(this.Ff,26):this.Ff=rl(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+wy(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){fo(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Fc(nu,Mf);var dS=function(){nu.call(this),this.pushButton=!0};Fc(dS,nu);var C0=function(){nu.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Fc(C0,nu);var QS=function(){var t,e;Mf.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,s=[];for(a in s.push("<<"),n)s.push("/"+a+" ("+wy(i(n[a]))+")");return s.push(">>"),s.join(`
`)},set:function(i){fo(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Qn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Fc(QS,Mf),C0.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},C0.prototype.createOption=function(t){var e=new QS;return e.Parent=this,e.optionName=t,this.Kids.push(e),X0e.call(this.scope,e),e};var pS=function(){nu.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Qn.CheckBox.createAppearanceStream()};Fc(pS,nu);var Bm=function(){Mf.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,13)},set:function(e){e?this.Ff=tl(this.Ff,13):this.Ff=rl(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,21)},set:function(e){e?this.Ff=tl(this.Ff,21):this.Ff=rl(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,23)},set:function(e){e?this.Ff=tl(this.Ff,23):this.Ff=rl(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,24)},set:function(e){e?this.Ff=tl(this.Ff,24):this.Ff=rl(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,25)},set:function(e){e?this.Ff=tl(this.Ff,25):this.Ff=rl(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,26)},set:function(e){e?this.Ff=tl(this.Ff,26):this.Ff=rl(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Fc(Bm,Mf);var gS=function(){Bm.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!el(this.Ff,14)},set:function(t){t?this.Ff=tl(this.Ff,14):this.Ff=rl(this.Ff,14)}}),this.password=!0};Fc(gS,Bm);var Qn={CheckBox:{createAppearanceStream:function(){return{N:{On:Qn.CheckBox.YesNormal},D:{On:Qn.CheckBox.YesPushDown,Off:Qn.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=id(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=eR(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Vi(a.fontSize)+" Tf "+i),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=id(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],a=Qn.internal.getHeight(t),s=Qn.internal.getWidth(t),o=eR(t,t.caption);return i.push("1 g"),i.push("0 0 "+Vi(s)+" "+Vi(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Vi(s-1)+" "+Vi(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Vi(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=id(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Qn.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Qn.RadioButton.Circle.YesNormal,e.D[t]=Qn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=id(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Qn.internal.Bezier_C,a=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Qp(Qn.internal.getWidth(t)/2)+" "+Qp(Qn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=id(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Qn.internal.Bezier_C).toFixed(5)),s=Number((n*Qn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Qp(Qn.internal.getWidth(t)/2)+" "+Qp(Qn.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Qp(Qn.internal.getWidth(t)/2)+" "+Qp(Qn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=id(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Qn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Qp(Qn.internal.getWidth(t)/2)+" "+Qp(Qn.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Qn.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Qn.RadioButton.Cross.YesNormal,e.D[t]=Qn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=id(t);e.scope=t.scope;var r=[],n=Qn.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Vi(Qn.internal.getWidth(t)-2)+" "+Vi(Qn.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Vi(n.x1.x)+" "+Vi(n.x1.y)+" m"),r.push(Vi(n.x2.x)+" "+Vi(n.x2.y)+" l"),r.push(Vi(n.x4.x)+" "+Vi(n.x4.y)+" m"),r.push(Vi(n.x3.x)+" "+Vi(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=id(t);e.scope=t.scope;var r=Qn.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Vi(Qn.internal.getWidth(t)-2)+" "+Vi(Qn.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Vi(r.x1.x)+" "+Vi(r.x1.y)+" m"),n.push(Vi(r.x2.x)+" "+Vi(r.x2.y)+" l"),n.push(Vi(r.x4.x)+" "+Vi(r.x4.y)+" m"),n.push(Vi(r.x3.x)+" "+Vi(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=id(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Qn.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Qn.internal.getWidth(t),r=Qn.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Qn.internal.getWidth=function(t){var e=0;return fo(t)==="object"&&(e=f9(t.Rect[2])),e},Qn.internal.getHeight=function(t){var e=0;return fo(t)==="object"&&(e=f9(t.Rect[3])),e};var X0e=zs.addField=function(t){if(G0e(this,t),!(t instanceof Mf))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};zs.AcroFormChoiceField=S0,zs.AcroFormListBox=E0,zs.AcroFormComboBox=T0,zs.AcroFormEditBox=fS,zs.AcroFormButton=nu,zs.AcroFormPushButton=dS,zs.AcroFormRadioButton=C0,zs.AcroFormCheckBox=pS,zs.AcroFormTextField=Bm,zs.AcroFormPasswordField=gS,zs.AcroFormAppearance=Qn,zs.AcroForm={ChoiceField:S0,ListBox:E0,ComboBox:T0,EditBox:fS,Button:nu,PushButton:dS,RadioButton:C0,CheckBox:pS,TextField:Bm,PasswordField:gS,Appearance:Qn},di.AcroForm={ChoiceField:S0,ListBox:E0,ComboBox:T0,EditBox:fS,Button:nu,PushButton:dS,RadioButton:C0,CheckBox:pS,TextField:Bm,PasswordField:gS,Appearance:Qn};di.AcroForm;function uZ(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(Q,W){var oe,se,he,_e,Ce,me=r;if((W=W||r)==="RGBA"||Q.data!==void 0&&Q.data instanceof Uint8ClampedArray&&"height"in Q&&"width"in Q)return"RGBA";if(j(Q))for(Ce in n)for(he=n[Ce],oe=0;oe<he.length;oe+=1){for(_e=!0,se=0;se<he[oe].length;se+=1)if(he[oe][se]!==void 0&&he[oe][se]!==Q[se]){_e=!1;break}if(_e===!0){me=Ce;break}}else for(Ce in n)for(he=n[Ce],oe=0;oe<he.length;oe+=1){for(_e=!0,se=0;se<he[oe].length;se+=1)if(he[oe][se]!==void 0&&he[oe][se]!==Q.charCodeAt(se)){_e=!1;break}if(_e===!0){me=Ce;break}}return me===r&&W!==r&&(me=W),me},a=function Q(W){for(var oe=this.internal.write,se=this.internal.putStream,he=(0,this.internal.getFilters)();he.indexOf("FlateEncode")!==-1;)he.splice(he.indexOf("FlateEncode"),1);W.objectId=this.internal.newObject();var _e=[];if(_e.push({key:"Type",value:"/XObject"}),_e.push({key:"Subtype",value:"/Image"}),_e.push({key:"Width",value:W.width}),_e.push({key:"Height",value:W.height}),W.colorSpace===M.INDEXED?_e.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(W.palette.length/3-1)+" "+("sMask"in W&&W.sMask!==void 0?W.objectId+2:W.objectId+1)+" 0 R]"}):(_e.push({key:"ColorSpace",value:"/"+W.colorSpace}),W.colorSpace===M.DEVICE_CMYK&&_e.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),_e.push({key:"BitsPerComponent",value:W.bitsPerComponent}),"decodeParameters"in W&&W.decodeParameters!==void 0&&_e.push({key:"DecodeParms",value:"<<"+W.decodeParameters+">>"}),"transparency"in W&&Array.isArray(W.transparency)){for(var Ce="",me=0,xe=W.transparency.length;me<xe;me++)Ce+=W.transparency[me]+" "+W.transparency[me]+" ";_e.push({key:"Mask",value:"["+Ce+"]"})}W.sMask!==void 0&&_e.push({key:"SMask",value:W.objectId+1+" 0 R"});var Ae=W.filter!==void 0?["/"+W.filter]:void 0;if(se({data:W.data,additionalKeyValues:_e,alreadyAppliedFilters:Ae,objectId:W.objectId}),oe("endobj"),"sMask"in W&&W.sMask!==void 0){var De=(W.predictor!=null?"/Predictor "+W.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+W.width,de={width:W.width,height:W.height,colorSpace:"DeviceGray",bitsPerComponent:W.bitsPerComponent,decodeParameters:De,data:W.sMask};"filter"in W&&(de.filter=W.filter),Q.call(this,de)}if(W.colorSpace===M.INDEXED){var Ee=this.internal.newObject();se({data:G(new Uint8Array(W.palette)),objectId:Ee}),oe("endobj")}},s=function(){var Q=this.internal.collections[e+"images"];for(var W in Q)a.call(this,Q[W])},o=function(){var Q,W=this.internal.collections[e+"images"],oe=this.internal.write;for(var se in W)oe("/I"+(Q=W[se]).index,Q.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},h=function(){var Q=this.internal.collections[e+"images"];return c.call(this),Q},d=function(){return Object.keys(this.internal.collections[e+"images"]).length},m=function(Q){return typeof t["process"+Q.toUpperCase()]=="function"},b=function(Q){return fo(Q)==="object"&&Q.nodeType===1},x=function(Q,W){if(Q.nodeName==="IMG"&&Q.hasAttribute("src")){var oe=""+Q.getAttribute("src");if(oe.indexOf("data:image/")===0)return hS(unescape(oe).split("base64,").pop());var se=t.loadFile(oe,!0);if(se!==void 0)return se}if(Q.nodeName==="CANVAS"){if(Q.width===0||Q.height===0)throw new Error("Given canvas must have data. Canvas width: "+Q.width+", height: "+Q.height);var he;switch(W){case"PNG":he="image/png";break;case"WEBP":he="image/webp";break;default:he="image/jpeg"}return hS(Q.toDataURL(he,1).split("base64,").pop())}},E=function(Q){var W=this.internal.collections[e+"images"];if(W){for(var oe in W)if(Q===W[oe].alias)return W[oe]}},T=function(Q,W,oe){return Q||W||(Q=-96,W=-96),Q<0&&(Q=-1*oe.width*72/Q/this.internal.scaleFactor),W<0&&(W=-1*oe.height*72/W/this.internal.scaleFactor),Q===0&&(Q=W*oe.width/oe.height),W===0&&(W=Q*oe.height/oe.width),[Q,W]},A=function(Q,W,oe,se,he,_e){var Ce=T.call(this,oe,se,he),me=this.internal.getCoordinateString,xe=this.internal.getVerticalCoordinateString,Ae=h.call(this);if(oe=Ce[0],se=Ce[1],Ae[he.index]=he,_e){_e*=Math.PI/180;var De=Math.cos(_e),de=Math.sin(_e),Ee=function(Le){return Le.toFixed(4)},we=[Ee(De),Ee(de),Ee(-1*de),Ee(De),0,0,"cm"]}this.internal.write("q"),_e?(this.internal.write([1,"0","0",1,me(Q),xe(W+se),"cm"].join(" ")),this.internal.write(we.join(" ")),this.internal.write([me(oe),"0","0",me(se),"0","0","cm"].join(" "))):this.internal.write([me(oe),"0","0",me(se),me(Q),xe(W+se),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+he.index+" Do"),this.internal.write("Q")},M=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var F=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},N=t.__addimage__.sHashCode=function(Q){var W,oe,se=0;if(typeof Q=="string")for(oe=Q.length,W=0;W<oe;W++)se=(se<<5)-se+Q.charCodeAt(W),se|=0;else if(j(Q))for(oe=Q.byteLength/2,W=0;W<oe;W++)se=(se<<5)-se+Q[W],se|=0;return se},O=t.__addimage__.validateStringAsBase64=function(Q){(Q=Q||"").toString().trim();var W=!0;return Q.length===0&&(W=!1),Q.length%4!=0&&(W=!1),/^[A-Za-z0-9+/]+$/.test(Q.substr(0,Q.length-2))===!1&&(W=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(Q.substr(-2))===!1&&(W=!1),W},U=t.__addimage__.extractImageFromDataUrl=function(Q){if(Q==null||!(Q=Q.trim()).startsWith("data:"))return null;var W=Q.indexOf(",");return W<0?null:Q.substring(0,W).trim().endsWith("base64")?Q.substring(W+1):null};t.__addimage__.isArrayBuffer=function(Q){return Q instanceof ArrayBuffer};var j=t.__addimage__.isArrayBufferView=function(Q){return Q instanceof Int8Array||Q instanceof Uint8Array||Q instanceof Uint8ClampedArray||Q instanceof Int16Array||Q instanceof Uint16Array||Q instanceof Int32Array||Q instanceof Uint32Array||Q instanceof Float32Array||Q instanceof Float64Array},H=t.__addimage__.binaryStringToUint8Array=function(Q){for(var W=Q.length,oe=new Uint8Array(W),se=0;se<W;se++)oe[se]=Q.charCodeAt(se);return oe},G=t.__addimage__.arrayBufferToBinaryString=function(Q){for(var W="",oe=j(Q)?Q:new Uint8Array(Q),se=0;se<oe.length;se+=8192)W+=String.fromCharCode.apply(null,oe.subarray(se,se+8192));return W};t.addImage=function(){var Q,W,oe,se,he,_e,Ce,me,xe;if(typeof arguments[1]=="number"?(W=r,oe=arguments[1],se=arguments[2],he=arguments[3],_e=arguments[4],Ce=arguments[5],me=arguments[6],xe=arguments[7]):(W=arguments[1],oe=arguments[2],se=arguments[3],he=arguments[4],_e=arguments[5],Ce=arguments[6],me=arguments[7],xe=arguments[8]),fo(Q=arguments[0])==="object"&&!b(Q)&&"imageData"in Q){var Ae=Q;Q=Ae.imageData,W=Ae.format||W||r,oe=Ae.x||oe||0,se=Ae.y||se||0,he=Ae.w||Ae.width||he,_e=Ae.h||Ae.height||_e,Ce=Ae.alias||Ce,me=Ae.compression||me,xe=Ae.rotation||Ae.angle||xe}var De=this.internal.getFilters();if(me===void 0&&De.indexOf("FlateEncode")!==-1&&(me="SLOW"),isNaN(oe)||isNaN(se))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var de=X.call(this,Q,W,Ce,me);return A.call(this,oe,se,he,_e,de,xe),this};var X=function(Q,W,oe,se){var he,_e,Ce;if(typeof Q=="string"&&i(Q)===r){Q=unescape(Q);var me=ae(Q,!1);(me!==""||(me=t.loadFile(Q,!0))!==void 0)&&(Q=me)}if(b(Q)&&(Q=x(Q,W)),W=i(Q,W),!m(W))throw new Error("addImage does not support files of type '"+W+"', please ensure that a plugin for '"+W+"' support is added.");if(((Ce=oe)==null||Ce.length===0)&&(oe=(function(xe){return typeof xe=="string"||j(xe)?N(xe):j(xe.data)?N(xe.data):null})(Q)),(he=E.call(this,oe))||(Q instanceof Uint8Array||W==="RGBA"||(_e=Q,Q=H(Q)),he=this["process"+W.toUpperCase()](Q,d.call(this),oe,(function(xe){return xe&&typeof xe=="string"&&(xe=xe.toUpperCase()),xe in t.image_compression?xe:F.NONE})(se),_e)),!he)throw new Error("An unknown error occurred whilst processing the image.");return he},ae=t.__addimage__.convertBase64ToBinaryString=function(Q,W){W=typeof W!="boolean"||W;var oe,se="";if(typeof Q=="string"){var he;oe=(he=U(Q))!==null&&he!==void 0?he:Q;try{se=hS(oe)}catch(_e){if(W)throw O(oe)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+_e.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return se};t.getImageProperties=function(Q){var W,oe,se="";if(b(Q)&&(Q=x(Q)),typeof Q=="string"&&i(Q)===r&&((se=ae(Q,!1))===""&&(se=t.loadFile(Q)||""),Q=se),oe=i(Q),!m(oe))throw new Error("addImage does not support files of type '"+oe+"', please ensure that a plugin for '"+oe+"' support is added.");if(Q instanceof Uint8Array||(Q=H(Q)),!(W=this["process"+oe.toUpperCase()](Q)))throw new Error("An unknown error occurred whilst processing the image");return W.fileType=oe,W}})(di.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};di.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,a,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),h=r.pageContext.annotations,d=!1,m=0;m<h.length&&!d;m++)switch((n=h[m]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var b=0;b<h.length;b++){n=h[b];var x=this.internal.pdfEscape,E=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var T=this.internal.newAdditionalObject(),A=this.internal.newAdditionalObject(),M=this.internal.getEncryptor(T.objId),F=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+x(M(n.contents))+")",a+=" /Popup "+A.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+x(M(F))+") >>",T.content=a;var N=T.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+N,n.open&&(a+=" /Open true"),a+=" >>",A.content=a,this.internal.write(T.objId,"0 R",A.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var O=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+x(E(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+O+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var U=this.annotations._nameMap[n.options.name];n.options.pageNumber=U.page,n.options.top=U.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+x(E(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var j=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+j+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,a,s){var o=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:c(r),y:h(n),w:c(r+i),h:h(n+a)},options:s,type:"link"})},t.textWithLink=function(r,n,i,a){var s,o,c=this.getTextWidth(r),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var d=this.splitTextToSize(r,o).length;s=Math.ceil(h*d)}else o=c,s=h;return this.text(r,n,i,a),i+=.2*h,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,i-h,o,s,a),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(di.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(T){return e[T.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(T){return typeof T=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(T)},o=t.__arabicParser__.isArabicEndLetter=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(T){return s(T)&&i.indexOf(T.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length>=1};var h=t.__arabicParser__.arabicLetterHasFinalForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length==4},m=t.__arabicParser__.resolveLigatures=function(T){var A=0,M=r,F="",N=0;for(A=0;A<T.length;A+=1)M[T.charCodeAt(A)]!==void 0?(N++,typeof(M=M[T.charCodeAt(A)])=="number"&&(F+=String.fromCharCode(M),M=r,N=0),A===T.length-1&&(M=r,F+=T.charAt(A-(N-1)),A-=N-1,N=0)):(M=r,F+=T.charAt(A-N),A-=N,N=0);return F};t.__arabicParser__.isArabicDiacritic=function(T){return T!==void 0&&n[T.charCodeAt(0)]!==void 0};var b=t.__arabicParser__.getCorrectForm=function(T,A,M){return s(T)?a(T)===!1?-1:!h(T)||!s(A)&&!s(M)||!s(M)&&o(A)||o(T)&&!s(A)||o(T)&&c(A)||o(T)&&o(A)?0:d(T)&&s(A)&&!o(A)&&s(M)&&h(M)?3:o(T)||!s(M)?1:2:-1},x=function(T){var A=0,M=0,F=0,N="",O="",U="",j=(T=T||"").split("\\s+"),H=[];for(A=0;A<j.length;A+=1){for(H.push(""),M=0;M<j[A].length;M+=1)N=j[A][M],O=j[A][M-1],U=j[A][M+1],s(N)?(F=b(N,O,U),H[A]+=F!==-1?String.fromCharCode(e[N.charCodeAt(0)][F]):N):H[A]+=N;H[A]=m(H[A])}return H.join(" ")},E=t.__arabicParser__.processArabic=t.processArabic=function(){var T,A=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,M=[];if(Array.isArray(A)){var F=0;for(M=[],F=0;F<A.length;F+=1)Array.isArray(A[F])?M.push([x(A[F][0]),A[F][1],A[F][2]]):M.push([x(A[F])]);T=M}else T=x(A);return typeof arguments[0]=="string"?T:(arguments[0].text=T,arguments[0])};t.events.push(["preProcessText",E])})(di.API),di.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(di.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(T){c=T}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(T){h=T}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(T){d=T}});var m=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return m},set:function(T){m=T}});var b=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return b},set:function(T){b=T}});var x=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return x},set:function(T){x=T}});var E=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return E},set:function(T){E=T}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,h){n.call(this);var d=(h=h||{}).fontSize||this.getFontSize(),m=h.font||this.getFont(),b=h.scaleFactor||this.internal.scaleFactor,x=0,E=0,T=0,A=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var M=h.maxWidth;M>0?typeof c=="string"?c=this.splitTextToSize(c,M):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(N,O){return N.concat(A.splitTextToSize(O,M))},[])):c=Array.isArray(c)?c:[c];for(var F=0;F<c.length;F++)x<(T=this.getStringUnitWidth(c[F],{font:m})*d)&&(x=T);return x!==0&&(E=c.length),{w:x/=b,h:Math.max((E*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/b,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var h=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,m=this.internal.__cell__.margins||e,b=this.internal.__cell__.tableHeaderRow,x=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===c.lineNumber?(c.x=(h.x||0)+(h.width||0),c.y=h.y||0):h.y+h.height+c.height+m.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=m.top,x&&b&&(this.printHeaderRow(c.lineNumber,!0),c.y+=b[0].height)):c.y=h.y+h.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};t.table=function(c,h,d,m,b){if(n.call(this),!d)throw new Error("No data for PDF table.");var x,E,T,A,M=[],F=[],N=[],O={},U={},j=[],H=[],G=(b=b||{}).autoSize||!1,X=b.printHeaders!==!1,ae=b.css&&b.css["font-size"]!==void 0?16*b.css["font-size"]:b.fontSize||12,Q=b.margins||Object.assign({width:this.getPageWidth()},e),W=typeof b.padding=="number"?b.padding:3,oe=b.headerBackgroundColor||"#c8c8c8",se=b.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=X,this.internal.__cell__.margins=Q,this.internal.__cell__.table_font_size=ae,this.internal.__cell__.padding=W,this.internal.__cell__.headerBackgroundColor=oe,this.internal.__cell__.headerTextColor=se,this.setFontSize(ae),m==null)F=M=Object.keys(d[0]),N=M.map(function(){return"left"});else if(Array.isArray(m)&&fo(m[0])==="object")for(M=m.map(function(Ae){return Ae.name}),F=m.map(function(Ae){return Ae.prompt||Ae.name||""}),N=m.map(function(Ae){return Ae.align||"left"}),x=0;x<m.length;x+=1)U[m[x].name]=.7499990551181103*m[x].width;else Array.isArray(m)&&typeof m[0]=="string"&&(F=M=m,N=M.map(function(){return"left"}));if(G||Array.isArray(m)&&typeof m[0]=="string")for(x=0;x<M.length;x+=1){for(O[A=M[x]]=d.map(function(Ae){return Ae[A]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(F[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),E=O[A],this.setFont(void 0,"normal"),T=0;T<E.length;T+=1)j.push(this.getTextDimensions(E[T],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);U[A]=Math.max.apply(null,j)+W+W,j=[]}if(X){var he={};for(x=0;x<M.length;x+=1)he[M[x]]={},he[M[x]].text=F[x],he[M[x]].align=N[x];var _e=o.call(this,he,U);H=M.map(function(Ae){return new a(c,h,U[Ae],_e,he[Ae].text,void 0,he[Ae].align)}),this.setTableHeaderRow(H),this.printHeaderRow(1,!1)}var Ce=m.reduce(function(Ae,De){return Ae[De.name]=De.align,Ae},{});for(x=0;x<d.length;x+=1){"rowStart"in b&&b.rowStart instanceof Function&&b.rowStart({row:x,data:d[x]},this);var me=o.call(this,d[x],U);for(T=0;T<M.length;T+=1){var xe=d[x][M[T]];"cellStart"in b&&b.cellStart instanceof Function&&b.cellStart({row:x,col:T,data:xe},this),s.call(this,new a(c,h,U[M[T]],me,xe,x+2,Ce[M[T]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=h,this};var o=function(c,h){var d=this.internal.__cell__.padding,m=this.internal.__cell__.table_font_size,b=this.internal.scaleFactor;return Object.keys(c).map(function(x){var E=c[x];return this.splitTextToSize(E.hasOwnProperty("text")?E.text:E,h[x]-d-d)},this).map(function(x){return this.getLineHeightFactor()*x.length*m/b+d+d},this).reduce(function(x,E){return Math.max(x,E)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,h){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var m=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(m[0],m[1],m[2],m[3],void 0,-1)}this.setFont(void 0,"bold");for(var b=[],x=0;x<this.internal.__cell__.tableHeaderRow.length;x+=1){d=this.internal.__cell__.tableHeaderRow[x].clone(),h&&(d.y=this.internal.__cell__.margins.top||0,b.push(d)),d.lineNumber=c;var E=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,d),this.setTextColor(E)}b.length>0&&this.setTableHeaderRow(b),this.setFont(void 0,"normal"),r=!1}})(di.API);var cZ={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},hZ=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],tR=uZ(hZ),fZ=[100,200,300,400,500,600,700,800,900],Y0e=uZ(fZ);function BA(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(a){return cZ[a=a||"normal"]?a:"normal"})(t.style),n=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(t.weight),i=(function(a){return typeof tR[a=a||"normal"]=="number"?a:"normal"})(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function d9(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var Z0e={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},p9={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function g9(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function m9(t){return t.trimLeft()}function K0e(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function J0e(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var ow,y9,v9,mv,sw,_9,b9,x9,zA=["times"];function w9(t,e,r,n){var i=4,a=E9;switch(n){case di.API.image_compression.FAST:i=1,a=S9;break;case di.API.image_compression.MEDIUM:i=6,a=T9;break;case di.API.image_compression.SLOW:i=9,a=C9}t=(function(o,c,h,d){for(var m,b=o.length/c,x=new Uint8Array(o.length+b),E=[Q0e,S9,E9,T9,C9],T=0;T<b;T+=1){var A=T*c,M=o.subarray(A,A+c);if(d)x.set(d(M,h,m),A+T);else{for(var F=E.length,N=[],O=0;O<F;O+=1)N[O]=E[O](M,h,m);var U=t_e(N.concat());x.set(N[U],A+T)}m=M}return x})(t,e,r,a);var s=Xk(t,{level:i});return di.API.__addimage__.arrayBufferToBinaryString(s)}function Q0e(t){var e=Array.apply([],t);return e.unshift(0),e}function S9(t,e){var r=t.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var a=t[i-e]||0;n[i+1]=t[i]-a+256&255}return n}function E9(t,e,r){var n=t.length,i=[];i[0]=2;for(var a=0;a<n;a+=1){var s=r&&r[a]||0;i[a+1]=t[a]-s+256&255}return i}function T9(t,e,r){var n=t.length,i=[];i[0]=3;for(var a=0;a<n;a+=1){var s=t[a-e]||0,o=r&&r[a]||0;i[a+1]=t[a]+256-(s+o>>>1)&255}return i}function C9(t,e,r){var n=t.length,i=[];i[0]=4;for(var a=0;a<n;a+=1){var s=e_e(t[a-e]||0,r&&r[a]||0,r&&r[a-e]||0);i[a+1]=t[a]-s+256&255}return i}function e_e(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),i=Math.abs(t-r),a=Math.abs(t+e-r-r);return n<=i&&n<=a?t:i<=a?e:r}function t_e(t){var e=t.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function jA(t,e,r){var n=e*r,i=Math.floor(n/8),a=16-(n-8*i+r),s=(1<<r)-1;return dZ(t,i)>>a&s}function A9(t,e,r,n){var i=r*n,a=Math.floor(i/8),s=16-(i-8*a+n),o=(1<<n)-1,c=(e&o)<<s;(function(h,d,m){if(d+1<h.byteLength)h.setUint16(d,m,!1);else{var b=m>>8&255;h.setUint8(d,b)}})(t,a,dZ(t,a)&~(o<<s)&65535|c)}function dZ(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function r_e(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,s=1<<1+(7&i);t[e++],t[e++];var o=null,c=null;a&&(o=e,c=s,e+=3*s);var h=!0,d=[],m=0,b=null,x=0,E=null;for(this.width=r,this.height=n;h&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,E=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((Q=t[e++])>=0))throw Error("Invalid block size");if(Q===0)break;e+=Q}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var T=t[e++];m=t[e++]|t[e++]<<8,b=t[e++],1&T||(b=null),x=T>>2&7,e++;break;case 254:for(;;){if(!((Q=t[e++])>=0))throw Error("Invalid block size");if(Q===0)break;e+=Q}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var A=t[e++]|t[e++]<<8,M=t[e++]|t[e++]<<8,F=t[e++]|t[e++]<<8,N=t[e++]|t[e++]<<8,O=t[e++],U=O>>6&1,j=1<<1+(7&O),H=o,G=c,X=!1;O>>7&&(X=!0,H=e,G=j,e+=3*j);var ae=e;for(e++;;){var Q;if(!((Q=t[e++])>=0))throw Error("Invalid block size");if(Q===0)break;e+=Q}d.push({x:A,y:M,width:F,height:N,has_local_palette:X,palette_offset:H,palette_size:G,data_offset:ae,data_length:e-ae,transparent_index:b,interlaced:!!U,delay:m,disposal:x});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return E},this.frameInfo=function(W){if(W<0||W>=d.length)throw new Error("Frame index out of range.");return d[W]},this.decodeAndBlitFrameBGRA=function(W,oe){var se=this.frameInfo(W),he=se.width*se.height,_e=new Uint8Array(he);I9(t,se.data_offset,_e,he);var Ce=se.palette_offset,me=se.transparent_index;me===null&&(me=256);var xe=se.width,Ae=r-xe,De=xe,de=4*(se.y*r+se.x),Ee=4*((se.y+se.height)*r+se.x),we=de,Le=4*Ae;se.interlaced===!0&&(Le+=4*r*7);for(var Fe=8,Xe=0,Be=_e.length;Xe<Be;++Xe){var ot=_e[Xe];if(De===0&&(De=xe,(we+=Le)>=Ee&&(Le=4*Ae+4*r*(Fe-1),we=de+(xe+Ae)*(Fe<<1),Fe>>=1)),ot===me)we+=4;else{var Qe=t[Ce+3*ot],rt=t[Ce+3*ot+1],Re=t[Ce+3*ot+2];oe[we++]=Re,oe[we++]=rt,oe[we++]=Qe,oe[we++]=255}--De}},this.decodeAndBlitFrameRGBA=function(W,oe){var se=this.frameInfo(W),he=se.width*se.height,_e=new Uint8Array(he);I9(t,se.data_offset,_e,he);var Ce=se.palette_offset,me=se.transparent_index;me===null&&(me=256);var xe=se.width,Ae=r-xe,De=xe,de=4*(se.y*r+se.x),Ee=4*((se.y+se.height)*r+se.x),we=de,Le=4*Ae;se.interlaced===!0&&(Le+=4*r*7);for(var Fe=8,Xe=0,Be=_e.length;Xe<Be;++Xe){var ot=_e[Xe];if(De===0&&(De=xe,(we+=Le)>=Ee&&(Le=4*Ae+4*r*(Fe-1),we=de+(xe+Ae)*(Fe<<1),Fe>>=1)),ot===me)we+=4;else{var Qe=t[Ce+3*ot],rt=t[Ce+3*ot+1],Re=t[Ce+3*ot+2];oe[we++]=Qe,oe[we++]=rt,oe[we++]=Re,oe[we++]=255}--De}}}function I9(t,e,r,n){for(var i=t[e++],a=1<<i,s=a+1,o=s+1,c=i+1,h=(1<<c)-1,d=0,m=0,b=0,x=t[e++],E=new Int32Array(4096),T=null;;){for(;d<16&&x!==0;)m|=t[e++]<<d,d+=8,x===1?x=t[e++]:--x;if(d<c)break;var A=m&h;if(m>>=c,d-=c,A!==a){if(A===s)break;for(var M=A<o?A:T,F=0,N=M;N>a;)N=E[N]>>8,++F;var O=N;if(b+F+(M!==A?1:0)>n)return void Ro.log("Warning, gif stream longer than expected.");r[b++]=O;var U=b+=F;for(M!==A&&(r[b++]=O),N=M;F--;)N=E[N],r[--U]=255&N,N>>=8;T!==null&&o<4096&&(E[o++]=T<<8|O,o>=h+1&&c<12&&(++c,h=h<<1|1)),T=A}else o=s+1,h=(1<<(c=i+1))-1,T=null}return b!==n&&Ro.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function UA(t){var e,r,n,i,a,s=Math.floor,o=new Array(64),c=new Array(64),h=new Array(64),d=new Array(64),m=new Array(65535),b=new Array(65535),x=new Array(64),E=new Array(64),T=[],A=0,M=7,F=new Array(64),N=new Array(64),O=new Array(64),U=new Array(256),j=new Array(2048),H=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],G=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],X=[0,1,2,3,4,5,6,7,8,9,10,11],ae=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Q=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],W=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],oe=[0,1,2,3,4,5,6,7,8,9,10,11],se=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],he=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function _e(de,Ee){for(var we=0,Le=0,Fe=new Array,Xe=1;Xe<=16;Xe++){for(var Be=1;Be<=de[Xe];Be++)Fe[Ee[Le]]=[],Fe[Ee[Le]][0]=we,Fe[Ee[Le]][1]=Xe,Le++,we++;we*=2}return Fe}function Ce(de){for(var Ee=de[0],we=de[1]-1;we>=0;)Ee&1<<we&&(A|=1<<M),we--,--M<0&&(A==255?(me(255),me(0)):me(A),M=7,A=0)}function me(de){T.push(de)}function xe(de){me(de>>8&255),me(255&de)}function Ae(de,Ee,we,Le,Fe){for(var Xe,Be=Fe[0],ot=Fe[240],Qe=(function(_t,vr){var br,lr,Cr,Tr,Qt,at,ke,be,je,qe,We=0;for(je=0;je<8;++je){br=_t[We],lr=_t[We+1],Cr=_t[We+2],Tr=_t[We+3],Qt=_t[We+4],at=_t[We+5],ke=_t[We+6];var Lt=br+(be=_t[We+7]),Et=br-be,mt=lr+ke,ct=lr-ke,Kt=Cr+at,qt=Cr-at,Ir=Tr+Qt,Ar=Tr-Qt,$r=Lt+Ir,hn=Lt-Ir,zr=mt+Kt,Mt=mt-Kt;_t[We]=$r+zr,_t[We+4]=$r-zr;var en=.707106781*(Mt+hn);_t[We+2]=hn+en,_t[We+6]=hn-en;var jn=.382683433*(($r=Ar+qt)-(Mt=ct+Et)),Qr=.5411961*$r+jn,nr=1.306562965*Mt+jn,oi=.707106781*(zr=qt+ct),un=Et+oi,Kn=Et-oi;_t[We+5]=Kn+Qr,_t[We+3]=Kn-Qr,_t[We+1]=un+nr,_t[We+7]=un-nr,We+=8}for(We=0,je=0;je<8;++je){br=_t[We],lr=_t[We+8],Cr=_t[We+16],Tr=_t[We+24],Qt=_t[We+32],at=_t[We+40],ke=_t[We+48];var Me=br+(be=_t[We+56]),He=br-be,Tt=lr+ke,Wt=lr-ke,Ut=Cr+at,Xr=Cr-at,Nn=Tr+Qt,Bi=Tr-Qt,Ci=Me+Nn,Fr=Me-Nn,Mn=Tt+Ut,Bn=Tt-Ut;_t[We]=Ci+Mn,_t[We+32]=Ci-Mn;var ei=.707106781*(Bn+Fr);_t[We+16]=Fr+ei,_t[We+48]=Fr-ei;var ua=.382683433*((Ci=Bi+Xr)-(Bn=Wt+He)),fa=.5411961*Ci+ua,zn=1.306562965*Bn+ua,La=.707106781*(Mn=Xr+Wt),Gi=He+La,fs=He-La;_t[We+40]=fs+fa,_t[We+24]=fs-fa,_t[We+8]=Gi+zn,_t[We+56]=Gi-zn,We++}for(je=0;je<64;++je)qe=_t[je]*vr[je],x[je]=qe>0?qe+.5|0:qe-.5|0;return x})(de,Ee),rt=0;rt<64;++rt)E[H[rt]]=Qe[rt];var Re=E[0]-we;we=E[0],Re==0?Ce(Le[0]):(Ce(Le[b[Xe=32767+Re]]),Ce(m[Xe]));for(var zt=63;zt>0&&E[zt]==0;)zt--;if(zt==0)return Ce(Be),we;for(var st,$e=1;$e<=zt;){for(var Jt=$e;E[$e]==0&&$e<=zt;)++$e;var Ht=$e-Jt;if(Ht>=16){st=Ht>>4;for(var pr=1;pr<=st;++pr)Ce(ot);Ht&=15}Xe=32767+E[$e],Ce(Fe[(Ht<<4)+b[Xe]]),Ce(m[Xe]),$e++}return zt!=63&&Ce(Be),we}function De(de){de=Math.min(Math.max(de,1),100),a!=de&&((function(Ee){for(var we=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Le=0;Le<64;Le++){var Fe=s((we[Le]*Ee+50)/100);Fe=Math.min(Math.max(Fe,1),255),o[H[Le]]=Fe}for(var Xe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Be=0;Be<64;Be++){var ot=s((Xe[Be]*Ee+50)/100);ot=Math.min(Math.max(ot,1),255),c[H[Be]]=ot}for(var Qe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],rt=0,Re=0;Re<8;Re++)for(var zt=0;zt<8;zt++)h[rt]=1/(o[H[rt]]*Qe[Re]*Qe[zt]*8),d[rt]=1/(c[H[rt]]*Qe[Re]*Qe[zt]*8),rt++})(de<50?Math.floor(5e3/de):Math.floor(200-2*de)),a=de)}this.encode=function(de,Ee){Ee&&De(Ee),T=new Array,A=0,M=7,xe(65496),xe(65504),xe(16),me(74),me(70),me(73),me(70),me(0),me(1),me(1),me(0),xe(1),xe(1),me(0),me(0),(function(){xe(65499),xe(132),me(0);for(var lr=0;lr<64;lr++)me(o[lr]);me(1);for(var Cr=0;Cr<64;Cr++)me(c[Cr])})(),(function(lr,Cr){xe(65472),xe(17),me(8),xe(Cr),xe(lr),me(3),me(1),me(17),me(0),me(2),me(17),me(1),me(3),me(17),me(1)})(de.width,de.height),(function(){xe(65476),xe(418),me(0);for(var lr=0;lr<16;lr++)me(G[lr+1]);for(var Cr=0;Cr<=11;Cr++)me(X[Cr]);me(16);for(var Tr=0;Tr<16;Tr++)me(ae[Tr+1]);for(var Qt=0;Qt<=161;Qt++)me(Q[Qt]);me(1);for(var at=0;at<16;at++)me(W[at+1]);for(var ke=0;ke<=11;ke++)me(oe[ke]);me(17);for(var be=0;be<16;be++)me(se[be+1]);for(var je=0;je<=161;je++)me(he[je])})(),xe(65498),xe(12),me(3),me(1),me(0),me(2),me(17),me(3),me(17),me(0),me(63),me(0);var we=0,Le=0,Fe=0;A=0,M=7,this.encode.displayName="_encode_";for(var Xe,Be,ot,Qe,rt,Re,zt,st,$e,Jt=de.data,Ht=de.width,pr=de.height,_t=4*Ht,vr=0;vr<pr;){for(Xe=0;Xe<_t;){for(rt=_t*vr+Xe,zt=-1,st=0,$e=0;$e<64;$e++)Re=rt+(st=$e>>3)*_t+(zt=4*(7&$e)),vr+st>=pr&&(Re-=_t*(vr+1+st-pr)),Xe+zt>=_t&&(Re-=Xe+zt-_t+4),Be=Jt[Re++],ot=Jt[Re++],Qe=Jt[Re++],F[$e]=(j[Be]+j[ot+256|0]+j[Qe+512|0]>>16)-128,N[$e]=(j[Be+768|0]+j[ot+1024|0]+j[Qe+1280|0]>>16)-128,O[$e]=(j[Be+1280|0]+j[ot+1536|0]+j[Qe+1792|0]>>16)-128;we=Ae(F,h,we,e,n),Le=Ae(N,d,Le,r,i),Fe=Ae(O,d,Fe,r,i),Xe+=32}vr+=8}if(M>=0){var br=[];br[1]=M+1,br[0]=(1<<M+1)-1,Ce(br)}return xe(65497),new Uint8Array(T)},t=t||50,(function(){for(var de=String.fromCharCode,Ee=0;Ee<256;Ee++)U[Ee]=de(Ee)})(),e=_e(G,X),r=_e(W,oe),n=_e(ae,Q),i=_e(se,he),(function(){for(var de=1,Ee=2,we=1;we<=15;we++){for(var Le=de;Le<Ee;Le++)b[32767+Le]=we,m[32767+Le]=[],m[32767+Le][1]=we,m[32767+Le][0]=Le;for(var Fe=-(Ee-1);Fe<=-de;Fe++)b[32767+Fe]=we,m[32767+Fe]=[],m[32767+Fe][1]=we,m[32767+Fe][0]=Ee-1+Fe;de<<=1,Ee<<=1}})(),(function(){for(var de=0;de<256;de++)j[de]=19595*de,j[de+256|0]=38470*de,j[de+512|0]=7471*de+32768,j[de+768|0]=-11059*de,j[de+1024|0]=-21709*de,j[de+1280|0]=32768*de+8421375,j[de+1536|0]=-27439*de,j[de+1792|0]=-5329*de})(),De(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function df(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function P9(t){function e(X){if(!X)throw Error("assert :P")}function r(X,ae,Q){for(var W=0;4>W;W++)if(X[ae+W]!=Q.charCodeAt(W))return!0;return!1}function n(X,ae,Q,W,oe){for(var se=0;se<oe;se++)X[ae+se]=Q[W+se]}function i(X,ae,Q,W){for(var oe=0;oe<W;oe++)X[ae+oe]=Q}function a(X){return new Int32Array(X)}function s(X,ae){for(var Q=[],W=0;W<X;W++)Q.push(new ae);return Q}function o(X,ae){var Q=[];return(function W(oe,se,he){for(var _e=he[se],Ce=0;Ce<_e&&(oe.push(he.length>se+1?[]:new ae),!(he.length<se+1));Ce++)W(oe[Ce],se+1,he)})(Q,0,X),Q}var c=function(){var X=this;function ae(q,K){for(var ge=1<<K-1>>>0;q&ge;)ge>>>=1;return ge?(q&ge-1)+ge:q}function Q(q,K,ge,Pe,Ye){e(!(Pe%ge));do q[K+(Pe-=ge)]=Ye;while(0<Pe)}function W(q,K,ge,Pe,Ye){if(e(2328>=Ye),512>=Ye)var Je=a(512);else if((Je=a(Ye))==null)return 0;return(function(it,lt,yt,At,Xt,_r){var St,Pt,hr=lt,Lr=1<<yt,gr=a(16),Br=a(16);for(e(Xt!=0),e(At!=null),e(it!=null),e(0<yt),Pt=0;Pt<Xt;++Pt){if(15<At[Pt])return 0;++gr[At[Pt]]}if(gr[0]==Xt)return 0;for(Br[1]=0,St=1;15>St;++St){if(gr[St]>1<<St)return 0;Br[St+1]=Br[St]+gr[St]}for(Pt=0;Pt<Xt;++Pt)St=At[Pt],0<At[Pt]&&(_r[Br[St]++]=Pt);if(Br[15]==1)return(At=new oe).g=0,At.value=_r[0],Q(it,hr,1,Lr,At),Lr;var jr,sn=-1,Jr=Lr-1,Jn=0,Vn=1,Ai=1,Zn=1<<yt;for(Pt=0,St=1,Xt=2;St<=yt;++St,Xt<<=1){if(Vn+=Ai<<=1,0>(Ai-=gr[St]))return 0;for(;0<gr[St];--gr[St])(At=new oe).g=St,At.value=_r[Pt++],Q(it,hr+Jn,Xt,Zn,At),Jn=ae(Jn,St)}for(St=yt+1,Xt=2;15>=St;++St,Xt<<=1){if(Vn+=Ai<<=1,0>(Ai-=gr[St]))return 0;for(;0<gr[St];--gr[St]){if(At=new oe,(Jn&Jr)!=sn){for(hr+=Zn,jr=1<<(sn=St)-yt;15>sn&&!(0>=(jr-=gr[sn]));)++sn,jr<<=1;Lr+=Zn=1<<(jr=sn-yt),it[lt+(sn=Jn&Jr)].g=jr+yt,it[lt+sn].value=hr-lt-sn}At.g=St-yt,At.value=_r[Pt++],Q(it,hr+(Jn>>yt),Xt,Zn,At),Jn=ae(Jn,St)}}return Vn!=2*Br[15]-1?0:Lr})(q,K,ge,Pe,Ye,Je)}function oe(){this.value=this.g=0}function se(){this.value=this.g=0}function he(){this.G=s(5,oe),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Ua,se)}function _e(q,K,ge,Pe){e(q!=null),e(K!=null),e(2147483648>Pe),q.Ca=254,q.I=0,q.b=-8,q.Ka=0,q.oa=K,q.pa=ge,q.Jd=K,q.Yc=ge+Pe,q.Zc=4<=Pe?ge+Pe-4+1:ge,Be(q)}function Ce(q,K){for(var ge=0;0<K--;)ge|=Qe(q,128)<<K;return ge}function me(q,K){var ge=Ce(q,K);return ot(q)?-ge:ge}function xe(q,K,ge,Pe){var Ye,Je=0;for(e(q!=null),e(K!=null),e(4294967288>Pe),q.Sb=Pe,q.Ra=0,q.u=0,q.h=0,4<Pe&&(Pe=4),Ye=0;Ye<Pe;++Ye)Je+=K[ge+Ye]<<8*Ye;q.Ra=Je,q.bb=Pe,q.oa=K,q.pa=ge}function Ae(q){for(;8<=q.u&&q.bb<q.Sb;)q.Ra>>>=8,q.Ra+=q.oa[q.pa+q.bb]<<ms-8>>>0,++q.bb,q.u-=8;Le(q)&&(q.h=1,q.u=0)}function De(q,K){if(e(0<=K),!q.h&&K<=Zs){var ge=we(q)&hu[K];return q.u+=K,Ae(q),ge}return q.h=1,q.u=0}function de(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Ee(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function we(q){return q.Ra>>>(q.u&ms-1)>>>0}function Le(q){return e(q.bb<=q.Sb),q.h||q.bb==q.Sb&&q.u>ms}function Fe(q,K){q.u=K,q.h=Le(q)}function Xe(q){q.u>=Va&&(e(q.u>=Va),Ae(q))}function Be(q){e(q!=null&&q.oa!=null),q.pa<q.Zc?(q.I=(q.oa[q.pa++]|q.I<<8)>>>0,q.b+=8):(e(q!=null&&q.oa!=null),q.pa<q.Yc?(q.b+=8,q.I=q.oa[q.pa++]|q.I<<8):q.Ka?q.b=0:(q.I<<=8,q.b+=8,q.Ka=1))}function ot(q){return Ce(q,1)}function Qe(q,K){var ge=q.Ca;0>q.b&&Be(q);var Pe=q.b,Ye=ge*K>>>8,Je=(q.I>>>Pe>Ye)+0;for(Je?(ge-=Ye,q.I-=Ye+1<<Pe>>>0):ge=Ye+1,Pe=ge,Ye=0;256<=Pe;)Ye+=8,Pe>>=8;return Pe=7^Ye+Vl[Pe],q.b-=Pe,q.Ca=(ge<<Pe)-1,Je}function rt(q,K,ge){q[K+0]=ge>>24&255,q[K+1]=ge>>16&255,q[K+2]=ge>>8&255,q[K+3]=255&ge}function Re(q,K){return q[K+0]|q[K+1]<<8}function zt(q,K){return Re(q,K)|q[K+2]<<16}function st(q,K){return Re(q,K)|Re(q,K+2)<<16}function $e(q,K){var ge=1<<K;return e(q!=null),e(0<K),q.X=a(ge),q.X==null?0:(q.Mb=32-K,q.Xa=K,1)}function Jt(q,K){e(q!=null),e(K!=null),e(q.Xa==K.Xa),n(K.X,0,q.X,0,1<<K.Xa)}function Ht(){this.X=[],this.Xa=this.Mb=0}function pr(q,K,ge,Pe){e(ge!=null),e(Pe!=null);var Ye=ge[0],Je=Pe[0];return Ye==0&&(Ye=(q*Je+K/2)/K),Je==0&&(Je=(K*Ye+q/2)/q),0>=Ye||0>=Je?0:(ge[0]=Ye,Pe[0]=Je,1)}function _t(q,K){return q+(1<<K)-1>>>K}function vr(q,K){return((4278255360&q)+(4278255360&K)>>>0&4278255360)+((16711935&q)+(16711935&K)>>>0&16711935)>>>0}function br(q,K){X[K]=function(ge,Pe,Ye,Je,it,lt,yt){var At;for(At=0;At<it;++At){var Xt=X[q](lt[yt+At-1],Ye,Je+At);lt[yt+At]=vr(ge[Pe+At],Xt)}}}function lr(){this.ud=this.hd=this.jd=0}function Cr(q,K){return((4278124286&(q^K))>>>1)+(q&K)>>>0}function Tr(q){return 0<=q&&256>q?q:0>q?0:255<q?255:void 0}function Qt(q,K){return Tr(q+(q-K+.5>>1))}function at(q,K,ge){return Math.abs(K-ge)-Math.abs(q-ge)}function ke(q,K,ge,Pe,Ye,Je,it){for(Pe=Je[it-1],ge=0;ge<Ye;++ge)Je[it+ge]=Pe=vr(q[K+ge],Pe)}function be(q,K,ge,Pe,Ye){var Je;for(Je=0;Je<ge;++Je){var it=q[K+Je],lt=it>>8&255,yt=16711935&(yt=(yt=16711935&it)+((lt<<16)+lt));Pe[Ye+Je]=(4278255360&it)+yt>>>0}}function je(q,K){K.jd=255&q,K.hd=q>>8&255,K.ud=q>>16&255}function qe(q,K,ge,Pe,Ye,Je){var it;for(it=0;it<Pe;++it){var lt=K[ge+it],yt=lt>>>8,At=lt,Xt=255&(Xt=(Xt=lt>>>16)+((q.jd<<24>>24)*(yt<<24>>24)>>>5));At=255&(At=(At+=(q.hd<<24>>24)*(yt<<24>>24)>>>5)+((q.ud<<24>>24)*(Xt<<24>>24)>>>5)),Ye[Je+it]=(4278255360&lt)+(Xt<<16)+At}}function We(q,K,ge,Pe,Ye){X[K]=function(Je,it,lt,yt,At,Xt,_r,St,Pt){for(yt=_r;yt<St;++yt)for(_r=0;_r<Pt;++_r)At[Xt++]=Ye(lt[Pe(Je[it++])])},X[q]=function(Je,it,lt,yt,At,Xt,_r){var St=8>>Je.b,Pt=Je.Ea,hr=Je.K[0],Lr=Je.w;if(8>St)for(Je=(1<<Je.b)-1,Lr=(1<<St)-1;it<lt;++it){var gr,Br=0;for(gr=0;gr<Pt;++gr)gr&Je||(Br=Pe(yt[At++])),Xt[_r++]=Ye(hr[Br&Lr]),Br>>=St}else X["VP8LMapColor"+ge](yt,At,hr,Lr,Xt,_r,it,lt,Pt)}}function Lt(q,K,ge,Pe,Ye){for(ge=K+ge;K<ge;){var Je=q[K++];Pe[Ye++]=Je>>16&255,Pe[Ye++]=Je>>8&255,Pe[Ye++]=255&Je}}function Et(q,K,ge,Pe,Ye){for(ge=K+ge;K<ge;){var Je=q[K++];Pe[Ye++]=Je>>16&255,Pe[Ye++]=Je>>8&255,Pe[Ye++]=255&Je,Pe[Ye++]=Je>>24&255}}function mt(q,K,ge,Pe,Ye){for(ge=K+ge;K<ge;){var Je=(it=q[K++])>>16&240|it>>12&15,it=240&it|it>>28&15;Pe[Ye++]=Je,Pe[Ye++]=it}}function ct(q,K,ge,Pe,Ye){for(ge=K+ge;K<ge;){var Je=(it=q[K++])>>16&248|it>>13&7,it=it>>5&224|it>>3&31;Pe[Ye++]=Je,Pe[Ye++]=it}}function Kt(q,K,ge,Pe,Ye){for(ge=K+ge;K<ge;){var Je=q[K++];Pe[Ye++]=255&Je,Pe[Ye++]=Je>>8&255,Pe[Ye++]=Je>>16&255}}function qt(q,K,ge,Pe,Ye,Je){if(Je==0)for(ge=K+ge;K<ge;)rt(Pe,((Je=q[K++])[0]>>24|Je[1]>>8&65280|Je[2]<<8&16711680|Je[3]<<24)>>>0),Ye+=32;else n(Pe,Ye,q,K,ge)}function Ir(q,K){X[K][0]=X[q+"0"],X[K][1]=X[q+"1"],X[K][2]=X[q+"2"],X[K][3]=X[q+"3"],X[K][4]=X[q+"4"],X[K][5]=X[q+"5"],X[K][6]=X[q+"6"],X[K][7]=X[q+"7"],X[K][8]=X[q+"8"],X[K][9]=X[q+"9"],X[K][10]=X[q+"10"],X[K][11]=X[q+"11"],X[K][12]=X[q+"12"],X[K][13]=X[q+"13"],X[K][14]=X[q+"0"],X[K][15]=X[q+"0"]}function Ar(q){return q==qg||q==Od||q==Vc||q==ef}function $r(){this.eb=[],this.size=this.A=this.fb=0}function hn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function zr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new $r,this.f.kb=new hn,this.sd=null}function Mt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function en(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function jn(q){return alert("todo:WebPSamplerProcessPlane"),q.T}function Qr(q,K){var ge=q.T,Pe=K.ba.f.RGBA,Ye=Pe.eb,Je=Pe.fb+q.ka*Pe.A,it=dl[K.ba.S],lt=q.y,yt=q.O,At=q.f,Xt=q.N,_r=q.ea,St=q.W,Pt=K.cc,hr=K.dc,Lr=K.Mc,gr=K.Nc,Br=q.ka,jr=q.ka+q.T,sn=q.U,Jr=sn+1>>1;for(Br==0?it(lt,yt,null,null,At,Xt,_r,St,At,Xt,_r,St,Ye,Je,null,null,sn):(it(K.ec,K.fc,lt,yt,Pt,hr,Lr,gr,At,Xt,_r,St,Ye,Je-Pe.A,Ye,Je,sn),++ge);Br+2<jr;Br+=2)Pt=At,hr=Xt,Lr=_r,gr=St,Xt+=q.Rc,St+=q.Rc,Je+=2*Pe.A,it(lt,(yt+=2*q.fa)-q.fa,lt,yt,Pt,hr,Lr,gr,At,Xt,_r,St,Ye,Je-Pe.A,Ye,Je,sn);return yt+=q.fa,q.j+jr<q.o?(n(K.ec,K.fc,lt,yt,sn),n(K.cc,K.dc,At,Xt,Jr),n(K.Mc,K.Nc,_r,St,Jr),ge--):1&jr||it(lt,yt,null,null,At,Xt,_r,St,At,Xt,_r,St,Ye,Je+Pe.A,null,null,sn),ge}function nr(q,K,ge){var Pe=q.F,Ye=[q.J];if(Pe!=null){var Je=q.U,it=K.ba.S,lt=it==Op||it==Vc;K=K.ba.f.RGBA;var yt=[0],At=q.ka;yt[0]=q.T,q.Kb&&(At==0?--yt[0]:(--At,Ye[0]-=q.width),q.j+q.ka+q.T==q.o&&(yt[0]=q.o-q.j-At));var Xt=K.eb;At=K.fb+At*K.A,q=ka(Pe,Ye[0],q.width,Je,yt,Xt,At+(lt?0:3),K.A),e(ge==yt),q&&Ar(it)&&ca(Xt,At,lt,Je,yt,K.A)}return 0}function oi(q){var K=q.ma,ge=K.ba.S,Pe=11>ge,Ye=ge==Qh||ge==pu||ge==Op||ge==Vg||ge==12||Ar(ge);if(K.memory=null,K.Ib=null,K.Jb=null,K.Nd=null,!Oo(K.Oa,q,Ye?11:12))return 0;if(Ye&&Ar(ge)&&Xs(),q.da)alert("todo:use_scaling");else{if(Pe){if(K.Ib=jn,q.Kb){if(ge=q.U+1>>1,K.memory=a(q.U+2*ge),K.memory==null)return 0;K.ec=K.memory,K.fc=0,K.cc=K.ec,K.dc=K.fc+q.U,K.Mc=K.cc,K.Nc=K.dc+ge,K.Ib=Qr,Xs()}}else alert("todo:EmitYUV");Ye&&(K.Jb=nr,Pe&&Gs())}if(Pe&&!Up){for(q=0;256>q;++q)Ud[q]=89858*(q-128)+jd>>zd,Kg[q]=-22014*(q-128)+jd,Zg[q]=-45773*(q-128),zy[q]=113618*(q-128)+jd>>zd;for(q=zf;q<wc;++q)K=76283*(q-16)+jd>>zd,jy[q-zf]=ja(K,255),Jg[q-zf]=ja(K+8>>4,15);Up=1}return 1}function un(q){var K=q.ma,ge=q.U,Pe=q.T;return e(!(1&q.ka)),0>=ge||0>=Pe?0:(ge=K.Ib(q,K),K.Jb!=null&&K.Jb(q,K,ge),K.Dc+=ge,1)}function Kn(q){q.ma.memory=null}function Me(q,K,ge,Pe){return De(q,8)!=47?0:(K[0]=De(q,14)+1,ge[0]=De(q,14)+1,Pe[0]=De(q,1),De(q,3)!=0?0:!q.h)}function He(q,K){if(4>q)return q+1;var ge=q-2>>1;return(2+(1&q)<<ge)+De(K,ge)+1}function Tt(q,K){return 120<K?K-120:1<=(ge=((ge=vh[K-1])>>4)*q+(8-(15&ge)))?ge:1;var ge}function Wt(q,K,ge){var Pe=we(ge),Ye=q[K+=255&Pe].g-8;return 0<Ye&&(Fe(ge,ge.u+8),Pe=we(ge),K+=q[K].value,K+=Pe&(1<<Ye)-1),Fe(ge,ge.u+q[K].g),q[K].value}function Ut(q,K,ge){return ge.g+=q.g,ge.value+=q.value<<K>>>0,e(8>=ge.g),q.g}function Xr(q,K,ge){var Pe=q.xc;return e((K=Pe==0?0:q.vc[q.md*(ge>>Pe)+(K>>Pe)])<q.Wb),q.Ya[K]}function Nn(q,K,ge,Pe){var Ye=q.ab,Je=q.c*K,it=q.C;K=it+K;var lt=ge,yt=Pe;for(Pe=q.Ta,ge=q.Ua;0<Ye--;){var At=q.gc[Ye],Xt=it,_r=K,St=lt,Pt=yt,hr=(yt=Pe,lt=ge,At.Ea);switch(e(Xt<_r),e(_r<=At.nc),At.hc){case 2:$l(St,Pt,(_r-Xt)*hr,yt,lt);break;case 0:var Lr=Xt,gr=_r,Br=yt,jr=lt,sn=(Zn=At).Ea;Lr==0&&(cl(St,Pt,null,null,1,Br,jr),ke(St,Pt+1,0,0,sn-1,Br,jr+1),Pt+=sn,jr+=sn,++Lr);for(var Jr=1<<Zn.b,Jn=Jr-1,Vn=_t(sn,Zn.b),Ai=Zn.K,Zn=Zn.w+(Lr>>Zn.b)*Vn;Lr<gr;){var Yi=Ai,No=Zn,Ni=1;for(hl(St,Pt,Br,jr-sn,1,Br,jr);Ni<sn;){var Yn=(Ni&~Jn)+Jr;Yn>sn&&(Yn=sn),(0,tr[Yi[No++]>>8&15])(St,Pt+ +Ni,Br,jr+Ni-sn,Yn-Ni,Br,jr+Ni),Ni=Yn}Pt+=sn,jr+=sn,++Lr&Jn||(Zn+=Vn)}_r!=At.nc&&n(yt,lt-hr,yt,lt+(_r-Xt-1)*hr,hr);break;case 1:for(hr=St,gr=Pt,sn=(St=At.Ea)-(jr=St&~(Br=(Pt=1<<At.b)-1)),Lr=_t(St,At.b),Jr=At.K,At=At.w+(Xt>>At.b)*Lr;Xt<_r;){for(Jn=Jr,Vn=At,Ai=new lr,Zn=gr+jr,Yi=gr+St;gr<Zn;)je(Jn[Vn++],Ai),mr(Ai,hr,gr,Pt,yt,lt),gr+=Pt,lt+=Pt;gr<Yi&&(je(Jn[Vn++],Ai),mr(Ai,hr,gr,sn,yt,lt),gr+=sn,lt+=sn),++Xt&Br||(At+=Lr)}break;case 3:if(St==yt&&Pt==lt&&0<At.b){for(gr=yt,St=hr=lt+(_r-Xt)*hr-(jr=(_r-Xt)*_t(At.Ea,At.b)),Pt=yt,Br=lt,Lr=[],jr=(sn=jr)-1;0<=jr;--jr)Lr[jr]=Pt[Br+jr];for(jr=sn-1;0<=jr;--jr)gr[St+jr]=Lr[jr];ql(At,Xt,_r,yt,hr,yt,lt)}else ql(At,Xt,_r,St,Pt,yt,lt)}lt=Pe,yt=ge}yt!=ge&&n(Pe,ge,lt,yt,Je)}function Bi(q,K){var ge=q.V,Pe=q.Ba+q.c*q.C,Ye=K-q.C;if(e(K<=q.l.o),e(16>=Ye),0<Ye){var Je=q.l,it=q.Ta,lt=q.Ua,yt=Je.width;if(Nn(q,Ye,ge,Pe),Ye=lt=[lt],e((ge=q.C)<(Pe=K)),e(Je.v<Je.va),Pe>Je.o&&(Pe=Je.o),ge<Je.j){var At=Je.j-ge;ge=Je.j,Ye[0]+=At*yt}if(ge>=Pe?ge=0:(Ye[0]+=4*Je.v,Je.ka=ge-Je.j,Je.U=Je.va-Je.v,Je.T=Pe-ge,ge=1),ge){if(lt=lt[0],11>(ge=q.ca).S){var Xt=ge.f.RGBA,_r=(Pe=ge.S,Ye=Je.U,Je=Je.T,At=Xt.eb,Xt.A),St=Je;for(Xt=Xt.fb+q.Ma*Xt.A;0<St--;){var Pt=it,hr=lt,Lr=Ye,gr=At,Br=Xt;switch(Pe){case Nu:dn(Pt,hr,Lr,gr,Br);break;case Qh:In(Pt,hr,Lr,gr,Br);break;case qg:In(Pt,hr,Lr,gr,Br),ca(gr,Br,0,Lr,1,0);break;case yh:I(Pt,hr,Lr,gr,Br);break;case pu:qt(Pt,hr,Lr,gr,Br,1);break;case Od:qt(Pt,hr,Lr,gr,Br,1),ca(gr,Br,0,Lr,1,0);break;case Op:qt(Pt,hr,Lr,gr,Br,0);break;case Vc:qt(Pt,hr,Lr,gr,Br,0),ca(gr,Br,1,Lr,1,0);break;case Vg:vi(Pt,hr,Lr,gr,Br);break;case ef:vi(Pt,hr,Lr,gr,Br),so(gr,Br,Lr,1,0);break;case $g:Pn(Pt,hr,Lr,gr,Br);break;default:e(0)}lt+=yt,Xt+=_r}q.Ma+=Je}else alert("todo:EmitRescaledRowsYUVA");e(q.Ma<=ge.height)}}q.C=K,e(q.C<=q.i)}function Ci(q){var K;if(0<q.ua)return 0;for(K=0;K<q.Wb;++K){var ge=q.Ya[K].G,Pe=q.Ya[K].H;if(0<ge[1][Pe[1]+0].g||0<ge[2][Pe[2]+0].g||0<ge[3][Pe[3]+0].g)return 0}return 1}function Fr(q,K,ge,Pe,Ye,Je){if(q.Z!=0){var it=q.qd,lt=q.rd;for(e(ac[q.Z]!=null);K<ge;++K)ac[q.Z](it,lt,Pe,Ye,Pe,Ye,Je),it=Pe,lt=Ye,Ye+=Je;q.qd=it,q.rd=lt}}function Mn(q,K){var ge=q.l.ma,Pe=ge.Z==0||ge.Z==1?q.l.j:q.C;if(Pe=q.C<Pe?Pe:q.C,e(K<=q.l.o),K>Pe){var Ye=q.l.width,Je=ge.ca,it=ge.tb+Ye*Pe,lt=q.V,yt=q.Ba+q.c*Pe,At=q.gc;e(q.ab==1),e(At[0].hc==3),Hl(At[0],Pe,K,lt,yt,Je,it),Fr(ge,Pe,K,Je,it,Ye)}q.C=q.Ma=K}function Bn(q,K,ge,Pe,Ye,Je,it){var lt=q.$/Pe,yt=q.$%Pe,At=q.m,Xt=q.s,_r=ge+q.$,St=_r;Ye=ge+Pe*Ye;var Pt=ge+Pe*Je,hr=280+Xt.ua,Lr=q.Pb?lt:16777216,gr=0<Xt.ua?Xt.Wa:null,Br=Xt.wc,jr=_r<Pt?Xr(Xt,yt,lt):null;e(q.C<Je),e(Pt<=Ye);var sn=!1;e:for(;;){for(;sn||_r<Pt;){var Jr=0;if(lt>=Lr){var Jn=_r-ge;e((Lr=q).Pb),Lr.wd=Lr.m,Lr.xd=Jn,0<Lr.s.ua&&Jt(Lr.s.Wa,Lr.s.vb),Lr=lt+Wg}if(yt&Br||(jr=Xr(Xt,yt,lt)),e(jr!=null),jr.Qb&&(K[_r]=jr.qb,sn=!0),!sn)if(Xe(At),jr.jc){Jr=At,Jn=K;var Vn=_r,Ai=jr.pd[we(Jr)&Ua-1];e(jr.jc),256>Ai.g?(Fe(Jr,Jr.u+Ai.g),Jn[Vn]=Ai.value,Jr=0):(Fe(Jr,Jr.u+Ai.g-256),e(256<=Ai.value),Jr=Ai.value),Jr==0&&(sn=!0)}else Jr=Wt(jr.G[0],jr.H[0],At);if(At.h)break;if(sn||256>Jr){if(!sn)if(jr.nd)K[_r]=(jr.qb|Jr<<8)>>>0;else{if(Xe(At),sn=Wt(jr.G[1],jr.H[1],At),Xe(At),Jn=Wt(jr.G[2],jr.H[2],At),Vn=Wt(jr.G[3],jr.H[3],At),At.h)break;K[_r]=(Vn<<24|sn<<16|Jr<<8|Jn)>>>0}if(sn=!1,++_r,++yt>=Pe&&(yt=0,++lt,it!=null&&lt<=Je&&!(lt%16)&&it(q,lt),gr!=null))for(;St<_r;)Jr=K[St++],gr.X[(506832829*Jr&4294967295)>>>gr.Mb]=Jr}else if(280>Jr){if(Jr=He(Jr-256,At),Jn=Wt(jr.G[4],jr.H[4],At),Xe(At),Jn=Tt(Pe,Jn=He(Jn,At)),At.h)break;if(_r-ge<Jn||Ye-_r<Jr)break e;for(Vn=0;Vn<Jr;++Vn)K[_r+Vn]=K[_r+Vn-Jn];for(_r+=Jr,yt+=Jr;yt>=Pe;)yt-=Pe,++lt,it!=null&&lt<=Je&&!(lt%16)&&it(q,lt);if(e(_r<=Ye),yt&Br&&(jr=Xr(Xt,yt,lt)),gr!=null)for(;St<_r;)Jr=K[St++],gr.X[(506832829*Jr&4294967295)>>>gr.Mb]=Jr}else{if(!(Jr<hr))break e;for(sn=Jr-280,e(gr!=null);St<_r;)Jr=K[St++],gr.X[(506832829*Jr&4294967295)>>>gr.Mb]=Jr;Jr=_r,e(!(sn>>>(Jn=gr).Xa)),K[Jr]=Jn.X[sn],sn=!0}sn||e(At.h==Le(At))}if(q.Pb&&At.h&&_r<Ye)e(q.m.h),q.a=5,q.m=q.wd,q.$=q.xd,0<q.s.ua&&Jt(q.s.vb,q.s.Wa);else{if(At.h)break e;it?.(q,lt>Je?Je:lt),q.a=0,q.$=_r-ge}return 1}return q.a=3,0}function ei(q){e(q!=null),q.vc=null,q.yc=null,q.Ya=null;var K=q.Wa;K!=null&&(K.X=null),q.vb=null,e(q!=null)}function ua(){var q=new Ui;return q==null?null:(q.a=0,q.xb=Xl,Ir("Predictor","VP8LPredictors"),Ir("Predictor","VP8LPredictors_C"),Ir("PredictorAdd","VP8LPredictorsAdd"),Ir("PredictorAdd","VP8LPredictorsAdd_C"),$l=be,mr=qe,dn=Lt,In=Et,vi=mt,Pn=ct,I=Kt,X.VP8LMapColor32b=fl,X.VP8LMapColor8b=Ou,q)}function fa(q,K,ge,Pe,Ye){var Je=1,it=[q],lt=[K],yt=Pe.m,At=Pe.s,Xt=null,_r=0;e:for(;;){if(ge)for(;Je&&De(yt,1);){var St=it,Pt=lt,hr=Pe,Lr=1,gr=hr.m,Br=hr.gc[hr.ab],jr=De(gr,2);if(hr.Oc&1<<jr)Je=0;else{switch(hr.Oc|=1<<jr,Br.hc=jr,Br.Ea=St[0],Br.nc=Pt[0],Br.K=[null],++hr.ab,e(4>=hr.ab),jr){case 0:case 1:Br.b=De(gr,3)+2,Lr=fa(_t(Br.Ea,Br.b),_t(Br.nc,Br.b),0,hr,Br.K),Br.K=Br.K[0];break;case 3:var sn,Jr=De(gr,8)+1,Jn=16<Jr?0:4<Jr?1:2<Jr?2:3;if(St[0]=_t(Br.Ea,Jn),Br.b=Jn,sn=Lr=fa(Jr,1,0,hr,Br.K)){var Vn,Ai=Jr,Zn=Br,Yi=1<<(8>>Zn.b),No=a(Yi);if(No==null)sn=0;else{var Ni=Zn.K[0],Yn=Zn.w;for(No[0]=Zn.K[0][0],Vn=1;Vn<1*Ai;++Vn)No[Vn]=vr(Ni[Yn+Vn],No[Vn-1]);for(;Vn<4*Yi;++Vn)No[Vn]=0;Zn.K[0]=null,Zn.K[0]=No,sn=1}}Lr=sn;break;case 2:break;default:e(0)}Je=Lr}}if(it=it[0],lt=lt[0],Je&&De(yt,1)&&!(Je=1<=(_r=De(yt,4))&&11>=_r)){Pe.a=3;break e}var wn;if(wn=Je)t:{var To,Pi,aa,da=Pe,ki=it,kl=lt,Qa=_r,ys=ge,ks=da.m,Wo=da.s,sa=[null],wa=1,Co=0,qi=tf[Qa];r:for(;;){if(ys&&De(ks,1)){var Go=De(ks,3)+2,Tn=_t(ki,Go),Sn=_t(kl,Go),Rs=Tn*Sn;if(!fa(Tn,Sn,0,da,sa))break r;for(sa=sa[0],Wo.xc=Go,To=0;To<Rs;++To){var Sa=sa[To]>>8&65535;sa[To]=Sa,Sa>=wa&&(wa=Sa+1)}}if(ks.h)break r;for(Pi=0;5>Pi;++Pi){var Lo=Lp[Pi];!Pi&&0<Qa&&(Lo+=1<<Qa),Co<Lo&&(Co=Lo)}var $a=s(wa*qi,oe),eo=wa,Rl=s(eo,he);if(Rl==null)var Yl=null;else e(65536>=eo),Yl=Rl;var Zl=a(Co);if(Yl==null||Zl==null||$a==null){da.a=1;break r}var gu=$a;for(To=aa=0;To<wa;++To){var Ea=Yl[To],ia=Ea.G,pa=Ea.H,mu=0,yu=1,is=0;for(Pi=0;5>Pi;++Pi){Lo=Lp[Pi],ia[Pi]=gu,pa[Pi]=aa,!Pi&&0<Qa&&(Lo+=1<<Qa);i:{var jf,Uf=Lo,Vf=da,qc=Zl,Hc=gu,$p=aa,of=0,sc=Vf.m,Vd=De(sc,1);if(i(qc,0,0,Uf),Vd){var Qg=De(sc,1)+1,$f=De(sc,1),xh=De(sc,$f==0?1:8);qc[xh]=1,Qg==2&&(qc[xh=De(sc,8)]=1);var qf=1}else{var Hf=a(19),wh=De(sc,4)+4;if(19<wh){Vf.a=3;var Wf=0;break i}for(jf=0;jf<wh;++jf)Hf[Bp[jf]]=De(sc,3);var Gf=void 0,Sh=void 0,qp=Vf,D=Hf,u=Uf,g=qc,w=0,C=qp.m,L=8,z=s(128,oe);n:for(;W(z,0,7,D,19);){if(De(C,1)){var Y=2+2*De(C,3);if((Gf=2+De(C,Y))>u)break n}else Gf=u;for(Sh=0;Sh<u&&Gf--;){Xe(C);var re=z[0+(127&we(C))];Fe(C,C.u+re.g);var le=re.value;if(16>le)g[Sh++]=le,le!=0&&(L=le);else{var fe=le==16,Ie=le-16,Te=Hg[Ie],Ue=De(C,Np[Ie])+Te;if(Sh+Ue>u)break n;for(var Ze=fe?L:0;0<Ue--;)g[Sh++]=Ze}}w=1;break n}w||(qp.a=3),qf=w}(qf=qf&&!sc.h)&&(of=W(Hc,$p,8,qc,Uf)),qf&&of!=0?Wf=of:(Vf.a=3,Wf=0)}if(Wf==0)break r;if(yu&&Fp[Pi]==1&&(yu=gu[aa].g==0),mu+=gu[aa].g,aa+=Wf,3>=Pi){var ft,pt=Zl[0];for(ft=1;ft<Lo;++ft)Zl[ft]>pt&&(pt=Zl[ft]);is+=pt}}if(Ea.nd=yu,Ea.Qb=0,yu&&(Ea.qb=(ia[3][pa[3]+0].value<<24|ia[1][pa[1]+0].value<<16|ia[2][pa[2]+0].value)>>>0,mu==0&&256>ia[0][pa[0]+0].value&&(Ea.Qb=1,Ea.qb+=ia[0][pa[0]+0].value<<8)),Ea.jc=!Ea.Qb&&6>is,Ea.jc){var dt,xt=Ea;for(dt=0;dt<Ua;++dt){var Ot=dt,wt=xt.pd[Ot],Nt=xt.G[0][xt.H[0]+Ot];256<=Nt.value?(wt.g=Nt.g+256,wt.value=Nt.value):(wt.g=0,wt.value=0,Ot>>=Ut(Nt,8,wt),Ot>>=Ut(xt.G[1][xt.H[1]+Ot],16,wt),Ot>>=Ut(xt.G[2][xt.H[2]+Ot],0,wt),Ut(xt.G[3][xt.H[3]+Ot],24,wt))}}}Wo.vc=sa,Wo.Wb=wa,Wo.Ya=Yl,Wo.yc=$a,wn=1;break t}wn=0}if(!(Je=wn)){Pe.a=3;break e}if(0<_r){if(At.ua=1<<_r,!$e(At.Wa,_r)){Pe.a=1,Je=0;break e}}else At.ua=0;var jt=Pe,Dt=it,Yt=lt,Sr=jt.s,dr=Sr.xc;if(jt.c=Dt,jt.i=Yt,Sr.md=_t(Dt,dr),Sr.wc=dr==0?-1:(1<<dr)-1,ge){Pe.xb=nf;break e}if((Xt=a(it*lt))==null){Pe.a=1,Je=0;break e}Je=(Je=Bn(Pe,Xt,0,it,lt,lt,null))&&!yt.h;break e}return Je?(Ye!=null?Ye[0]=Xt:(e(Xt==null),e(ge)),Pe.$=0,ge||ei(At)):ei(At),Je}function zn(q,K){var ge=q.c*q.i,Pe=ge+K+16*K;return e(q.c<=K),q.V=a(Pe),q.V==null?(q.Ta=null,q.Ua=0,q.a=1,0):(q.Ta=q.V,q.Ua=q.Ba+ge+K,1)}function La(q,K){var ge=q.C,Pe=K-ge,Ye=q.V,Je=q.Ba+q.c*ge;for(e(K<=q.l.o);0<Pe;){var it=16<Pe?16:Pe,lt=q.l.ma,yt=q.l.width,At=yt*it,Xt=lt.ca,_r=lt.tb+yt*ge,St=q.Ta,Pt=q.Ua;Nn(q,it,Ye,Je),Ho(St,Pt,Xt,_r,At),Fr(lt,ge,ge+it,Xt,_r,yt),Pe-=it,Ye+=it*q.c,ge+=it}e(ge==K),q.C=q.Ma=K}function Gi(){this.ub=this.yd=this.td=this.Rb=0}function fs(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ca(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Mo(){this.Yb=(function(){var q=[];return(function K(ge,Pe,Ye){for(var Je=Ye[Pe],it=0;it<Je&&(ge.push(Ye.length>Pe+1?[]:0),!(Ye.length<Pe+1));it++)K(ge[it],Pe+1,Ye)})(q,0,[3,11]),q})()}function Ya(){this.jb=a(3),this.Wc=o([4,8],Mo),this.Xc=o([4,17],Mo)}function ol(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function xi(){this.ld=this.La=this.dd=this.tc=0}function zi(){this.Na=this.la=0}function Iu(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ga(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Za(){this.uc=this.M=this.Nb=0,this.wa=Array(new xi),this.Y=0,this.ya=Array(new ga),this.aa=0,this.l=new ps}function ds(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Aa(){this.cb=this.a=0,this.sc="",this.m=new de,this.Od=new Gi,this.Kc=new fs,this.ed=new ol,this.Qa=new Ca,this.Ic=this.$c=this.Aa=0,this.D=new Za,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,de),this.ia=0,this.pb=s(4,Iu),this.Pa=new Ya,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ds),this.Hd=0,this.rb=Array(new zi),this.sb=0,this.wa=Array(new xi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ga),this.L=this.aa=0,this.gd=o([4,2],xi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ps(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ul(){var q=new Aa;return q!=null&&(q.a=0,q.sc="OK",q.cb=0,q.Xb=0,Nd||(Nd=sl)),q}function Fa(q,K,ge){return q.a==0&&(q.a=K,q.sc=ge,q.cb=0),0}function _a(q,K,ge){return 3<=ge&&q[K+0]==157&&q[K+1]==1&&q[K+2]==42}function xc(q,K){if(q==null)return 0;if(q.a=0,q.sc="OK",K==null)return Fa(q,2,"null VP8Io passed to VP8GetHeaders()");var ge=K.data,Pe=K.w,Ye=K.ha;if(4>Ye)return Fa(q,7,"Truncated header.");var Je=ge[Pe+0]|ge[Pe+1]<<8|ge[Pe+2]<<16,it=q.Od;if(it.Rb=!(1&Je),it.td=Je>>1&7,it.yd=Je>>4&1,it.ub=Je>>5,3<it.td)return Fa(q,3,"Incorrect keyframe parameters.");if(!it.yd)return Fa(q,4,"Frame not displayable.");Pe+=3,Ye-=3;var lt=q.Kc;if(it.Rb){if(7>Ye)return Fa(q,7,"cannot parse picture header");if(!_a(ge,Pe,Ye))return Fa(q,3,"Bad code word");lt.c=16383&(ge[Pe+4]<<8|ge[Pe+3]),lt.Td=ge[Pe+4]>>6,lt.i=16383&(ge[Pe+6]<<8|ge[Pe+5]),lt.Ud=ge[Pe+6]>>6,Pe+=7,Ye-=7,q.za=lt.c+15>>4,q.Ub=lt.i+15>>4,K.width=lt.c,K.height=lt.i,K.Da=0,K.j=0,K.v=0,K.va=K.width,K.o=K.height,K.da=0,K.ib=K.width,K.hb=K.height,K.U=K.width,K.T=K.height,i((Je=q.Pa).jb,0,255,Je.jb.length),e((Je=q.Qa)!=null),Je.Cb=0,Je.Bb=0,Je.Fb=1,i(Je.Zb,0,0,Je.Zb.length),i(Je.Lb,0,0,Je.Lb)}if(it.ub>Ye)return Fa(q,7,"bad partition length");_e(Je=q.m,ge,Pe,it.ub),Pe+=it.ub,Ye-=it.ub,it.Rb&&(lt.Ld=ot(Je),lt.Kd=ot(Je)),lt=q.Qa;var yt,At=q.Pa;if(e(Je!=null),e(lt!=null),lt.Cb=ot(Je),lt.Cb){if(lt.Bb=ot(Je),ot(Je)){for(lt.Fb=ot(Je),yt=0;4>yt;++yt)lt.Zb[yt]=ot(Je)?me(Je,7):0;for(yt=0;4>yt;++yt)lt.Lb[yt]=ot(Je)?me(Je,6):0}if(lt.Bb)for(yt=0;3>yt;++yt)At.jb[yt]=ot(Je)?Ce(Je,8):255}else lt.Bb=0;if(Je.Ka)return Fa(q,3,"cannot parse segment header");if((lt=q.ed).zd=ot(Je),lt.Tb=Ce(Je,6),lt.wb=Ce(Je,3),lt.Pc=ot(Je),lt.Pc&&ot(Je)){for(At=0;4>At;++At)ot(Je)&&(lt.vd[At]=me(Je,6));for(At=0;4>At;++At)ot(Je)&&(lt.od[At]=me(Je,6))}if(q.L=lt.Tb==0?0:lt.zd?1:2,Je.Ka)return Fa(q,3,"cannot parse filter header");var Xt=Ye;if(Ye=yt=Pe,Pe=yt+Xt,lt=Xt,q.Xb=(1<<Ce(q.m,2))-1,Xt<3*(At=q.Xb))ge=7;else{for(yt+=3*At,lt-=3*At,Xt=0;Xt<At;++Xt){var _r=ge[Ye+0]|ge[Ye+1]<<8|ge[Ye+2]<<16;_r>lt&&(_r=lt),_e(q.Jc[+Xt],ge,yt,_r),yt+=_r,lt-=_r,Ye+=3}_e(q.Jc[+At],ge,yt,lt),ge=yt<Pe?0:5}if(ge!=0)return Fa(q,ge,"cannot parse partitions");for(ge=Ce(yt=q.m,7),Ye=ot(yt)?me(yt,4):0,Pe=ot(yt)?me(yt,4):0,lt=ot(yt)?me(yt,4):0,At=ot(yt)?me(yt,4):0,yt=ot(yt)?me(yt,4):0,Xt=q.Qa,_r=0;4>_r;++_r){if(Xt.Cb){var St=Xt.Zb[_r];Xt.Fb||(St+=ge)}else{if(0<_r){q.pb[_r]=q.pb[0];continue}St=ge}var Pt=q.pb[_r];Pt.Sc[0]=Gg[ja(St+Ye,127)],Pt.Sc[1]=rf[ja(St+0,127)],Pt.Eb[0]=2*Gg[ja(St+Pe,127)],Pt.Eb[1]=101581*rf[ja(St+lt,127)]>>16,8>Pt.Eb[1]&&(Pt.Eb[1]=8),Pt.Qc[0]=Gg[ja(St+At,117)],Pt.Qc[1]=rf[ja(St+yt,127)],Pt.lc=St+yt}if(!it.Rb)return Fa(q,4,"Not a key frame.");for(ot(Je),it=q.Pa,ge=0;4>ge;++ge){for(Ye=0;8>Ye;++Ye)for(Pe=0;3>Pe;++Pe)for(lt=0;11>lt;++lt)At=Qe(Je,Bd[ge][Ye][Pe][lt])?Ce(Je,8):Ly[ge][Ye][Pe][lt],it.Wc[ge][Ye].Yb[Pe][lt]=At;for(Ye=0;17>Ye;++Ye)it.Xc[ge][Ye]=it.Wc[ge][zp[Ye]]}return q.kc=ot(Je),q.kc&&(q.Bd=Ce(Je,8)),q.cb=1}function sl(q,K,ge,Pe,Ye,Je,it){var lt=K[Ye].Yb[ge];for(ge=0;16>Ye;++Ye){if(!Qe(q,lt[ge+0]))return Ye;for(;!Qe(q,lt[ge+1]);)if(lt=K[++Ye].Yb[0],ge=0,Ye==16)return 16;var yt=K[Ye+1].Yb;if(Qe(q,lt[ge+2])){var At=q,Xt=0;if(Qe(At,(St=lt)[(_r=ge)+3]))if(Qe(At,St[_r+6])){for(lt=0,_r=2*(Xt=Qe(At,St[_r+8]))+(St=Qe(At,St[_r+9+Xt])),Xt=0,St=Ny[_r];St[lt];++lt)Xt+=Xt+Qe(At,St[lt]);Xt+=3+(8<<_r)}else Qe(At,St[_r+7])?(Xt=7+2*Qe(At,165),Xt+=Qe(At,145)):Xt=5+Qe(At,159);else Xt=Qe(At,St[_r+4])?3+Qe(At,St[_r+5]):2;lt=yt[2]}else Xt=1,lt=yt[1];yt=it+Ld[Ye],0>(At=q).b&&Be(At);var _r,St=At.b,Pt=(_r=At.Ca>>1)-(At.I>>St)>>31;--At.b,At.Ca+=Pt,At.Ca|=1,At.I-=(_r+1&Pt)<<St,Je[yt]=((Xt^Pt)-Pt)*Pe[(0<Ye)+0]}return 16}function ts(q){var K=q.rb[q.sb-1];K.la=0,K.Na=0,i(q.zc,0,0,q.zc.length),q.ja=0}function oo(q,K,ge,Pe,Ye){Ye=q[K+ge+32*Pe]+(Ye>>3),q[K+ge+32*Pe]=-256&Ye?0>Ye?0:255:Ye}function rs(q,K,ge,Pe,Ye,Je){oo(q,K,0,ge,Pe+Ye),oo(q,K,1,ge,Pe+Je),oo(q,K,2,ge,Pe-Je),oo(q,K,3,ge,Pe-Ye)}function Ba(q){return(20091*q>>16)+q}function Us(q,K,ge,Pe){var Ye,Je=0,it=a(16);for(Ye=0;4>Ye;++Ye){var lt=q[K+0]+q[K+8],yt=q[K+0]-q[K+8],At=(35468*q[K+4]>>16)-Ba(q[K+12]),Xt=Ba(q[K+4])+(35468*q[K+12]>>16);it[Je+0]=lt+Xt,it[Je+1]=yt+At,it[Je+2]=yt-At,it[Je+3]=lt-Xt,Je+=4,K++}for(Ye=Je=0;4>Ye;++Ye)lt=(q=it[Je+0]+4)+it[Je+8],yt=q-it[Je+8],At=(35468*it[Je+4]>>16)-Ba(it[Je+12]),oo(ge,Pe,0,0,lt+(Xt=Ba(it[Je+4])+(35468*it[Je+12]>>16))),oo(ge,Pe,1,0,yt+At),oo(ge,Pe,2,0,yt-At),oo(ge,Pe,3,0,lt-Xt),Je++,Pe+=32}function Uc(q,K,ge,Pe){var Ye=q[K+0]+4,Je=35468*q[K+4]>>16,it=Ba(q[K+4]),lt=35468*q[K+1]>>16;rs(ge,Pe,0,Ye+it,q=Ba(q[K+1]),lt),rs(ge,Pe,1,Ye+Je,q,lt),rs(ge,Pe,2,Ye-Je,q,lt),rs(ge,Pe,3,Ye-it,q,lt)}function Pu(q,K,ge,Pe,Ye){Us(q,K,ge,Pe),Ye&&Us(q,K+16,ge,Pe+4)}function ee(q,K,ge,Pe){_(q,K+0,ge,Pe,1),_(q,K+32,ge,Pe+128,1)}function pe(q,K,ge,Pe){var Ye;for(q=q[K+0]+4,Ye=0;4>Ye;++Ye)for(K=0;4>K;++K)oo(ge,Pe,K,Ye,q)}function Ke(q,K,ge,Pe){q[K+0]&&ne(q,K+0,ge,Pe),q[K+16]&&ne(q,K+16,ge,Pe+4),q[K+32]&&ne(q,K+32,ge,Pe+128),q[K+48]&&ne(q,K+48,ge,Pe+128+4)}function It(q,K,ge,Pe){var Ye,Je=a(16);for(Ye=0;4>Ye;++Ye){var it=q[K+0+Ye]+q[K+12+Ye],lt=q[K+4+Ye]+q[K+8+Ye],yt=q[K+4+Ye]-q[K+8+Ye],At=q[K+0+Ye]-q[K+12+Ye];Je[0+Ye]=it+lt,Je[8+Ye]=it-lt,Je[4+Ye]=At+yt,Je[12+Ye]=At-yt}for(Ye=0;4>Ye;++Ye)it=(q=Je[0+4*Ye]+3)+Je[3+4*Ye],lt=Je[1+4*Ye]+Je[2+4*Ye],yt=Je[1+4*Ye]-Je[2+4*Ye],At=q-Je[3+4*Ye],ge[Pe+0]=it+lt>>3,ge[Pe+16]=At+yt>>3,ge[Pe+32]=it-lt>>3,ge[Pe+48]=At-yt>>3,Pe+=64}function Vt(q,K,ge){var Pe,Ye=K-32,Je=Eo,it=255-q[Ye-1];for(Pe=0;Pe<ge;++Pe){var lt,yt=Je,At=it+q[K-1];for(lt=0;lt<ge;++lt)q[K+lt]=yt[At+q[Ye+lt]];K+=32}}function $t(q,K){Vt(q,K,4)}function er(q,K){Vt(q,K,8)}function Yr(q,K){Vt(q,K,16)}function tn(q,K){var ge;for(ge=0;16>ge;++ge)n(q,K+32*ge,q,K-32,16)}function Wr(q,K){var ge;for(ge=16;0<ge;--ge)i(q,K,q[K-1],16),K+=32}function on(q,K,ge){var Pe;for(Pe=0;16>Pe;++Pe)i(K,ge+32*Pe,q,16)}function kr(q,K){var ge,Pe=16;for(ge=0;16>ge;++ge)Pe+=q[K-1+32*ge]+q[K+ge-32];on(Pe>>5,q,K)}function ti(q,K){var ge,Pe=8;for(ge=0;16>ge;++ge)Pe+=q[K-1+32*ge];on(Pe>>4,q,K)}function Ri(q,K){var ge,Pe=8;for(ge=0;16>ge;++ge)Pe+=q[K+ge-32];on(Pe>>4,q,K)}function $n(q,K){on(128,q,K)}function _n(q,K,ge){return q+2*K+ge+2>>2}function Mr(q,K){var ge,Pe=K-32;for(Pe=new Uint8Array([_n(q[Pe-1],q[Pe+0],q[Pe+1]),_n(q[Pe+0],q[Pe+1],q[Pe+2]),_n(q[Pe+1],q[Pe+2],q[Pe+3]),_n(q[Pe+2],q[Pe+3],q[Pe+4])]),ge=0;4>ge;++ge)n(q,K+32*ge,Pe,0,Pe.length)}function fn(q,K){var ge=q[K-1],Pe=q[K-1+32],Ye=q[K-1+64],Je=q[K-1+96];rt(q,K+0,16843009*_n(q[K-1-32],ge,Pe)),rt(q,K+32,16843009*_n(ge,Pe,Ye)),rt(q,K+64,16843009*_n(Pe,Ye,Je)),rt(q,K+96,16843009*_n(Ye,Je,Je))}function mn(q,K){var ge,Pe=4;for(ge=0;4>ge;++ge)Pe+=q[K+ge-32]+q[K-1+32*ge];for(Pe>>=3,ge=0;4>ge;++ge)i(q,K+32*ge,Pe,4)}function hi(q,K){var ge=q[K-1+0],Pe=q[K-1+32],Ye=q[K-1+64],Je=q[K-1-32],it=q[K+0-32],lt=q[K+1-32],yt=q[K+2-32],At=q[K+3-32];q[K+0+96]=_n(Pe,Ye,q[K-1+96]),q[K+1+96]=q[K+0+64]=_n(ge,Pe,Ye),q[K+2+96]=q[K+1+64]=q[K+0+32]=_n(Je,ge,Pe),q[K+3+96]=q[K+2+64]=q[K+1+32]=q[K+0+0]=_n(it,Je,ge),q[K+3+64]=q[K+2+32]=q[K+1+0]=_n(lt,it,Je),q[K+3+32]=q[K+2+0]=_n(yt,lt,it),q[K+3+0]=_n(At,yt,lt)}function $i(q,K){var ge=q[K+1-32],Pe=q[K+2-32],Ye=q[K+3-32],Je=q[K+4-32],it=q[K+5-32],lt=q[K+6-32],yt=q[K+7-32];q[K+0+0]=_n(q[K+0-32],ge,Pe),q[K+1+0]=q[K+0+32]=_n(ge,Pe,Ye),q[K+2+0]=q[K+1+32]=q[K+0+64]=_n(Pe,Ye,Je),q[K+3+0]=q[K+2+32]=q[K+1+64]=q[K+0+96]=_n(Ye,Je,it),q[K+3+32]=q[K+2+64]=q[K+1+96]=_n(Je,it,lt),q[K+3+64]=q[K+2+96]=_n(it,lt,yt),q[K+3+96]=_n(lt,yt,yt)}function ba(q,K){var ge=q[K-1+0],Pe=q[K-1+32],Ye=q[K-1+64],Je=q[K-1-32],it=q[K+0-32],lt=q[K+1-32],yt=q[K+2-32],At=q[K+3-32];q[K+0+0]=q[K+1+64]=Je+it+1>>1,q[K+1+0]=q[K+2+64]=it+lt+1>>1,q[K+2+0]=q[K+3+64]=lt+yt+1>>1,q[K+3+0]=yt+At+1>>1,q[K+0+96]=_n(Ye,Pe,ge),q[K+0+64]=_n(Pe,ge,Je),q[K+0+32]=q[K+1+96]=_n(ge,Je,it),q[K+1+32]=q[K+2+96]=_n(Je,it,lt),q[K+2+32]=q[K+3+96]=_n(it,lt,yt),q[K+3+32]=_n(lt,yt,At)}function wi(q,K){var ge=q[K+0-32],Pe=q[K+1-32],Ye=q[K+2-32],Je=q[K+3-32],it=q[K+4-32],lt=q[K+5-32],yt=q[K+6-32],At=q[K+7-32];q[K+0+0]=ge+Pe+1>>1,q[K+1+0]=q[K+0+64]=Pe+Ye+1>>1,q[K+2+0]=q[K+1+64]=Ye+Je+1>>1,q[K+3+0]=q[K+2+64]=Je+it+1>>1,q[K+0+32]=_n(ge,Pe,Ye),q[K+1+32]=q[K+0+96]=_n(Pe,Ye,Je),q[K+2+32]=q[K+1+96]=_n(Ye,Je,it),q[K+3+32]=q[K+2+96]=_n(Je,it,lt),q[K+3+64]=_n(it,lt,yt),q[K+3+96]=_n(lt,yt,At)}function fi(q,K){var ge=q[K-1+0],Pe=q[K-1+32],Ye=q[K-1+64],Je=q[K-1+96];q[K+0+0]=ge+Pe+1>>1,q[K+2+0]=q[K+0+32]=Pe+Ye+1>>1,q[K+2+32]=q[K+0+64]=Ye+Je+1>>1,q[K+1+0]=_n(ge,Pe,Ye),q[K+3+0]=q[K+1+32]=_n(Pe,Ye,Je),q[K+3+32]=q[K+1+64]=_n(Ye,Je,Je),q[K+3+64]=q[K+2+64]=q[K+0+96]=q[K+1+96]=q[K+2+96]=q[K+3+96]=Je}function Ts(q,K){var ge=q[K-1+0],Pe=q[K-1+32],Ye=q[K-1+64],Je=q[K-1+96],it=q[K-1-32],lt=q[K+0-32],yt=q[K+1-32],At=q[K+2-32];q[K+0+0]=q[K+2+32]=ge+it+1>>1,q[K+0+32]=q[K+2+64]=Pe+ge+1>>1,q[K+0+64]=q[K+2+96]=Ye+Pe+1>>1,q[K+0+96]=Je+Ye+1>>1,q[K+3+0]=_n(lt,yt,At),q[K+2+0]=_n(it,lt,yt),q[K+1+0]=q[K+3+32]=_n(ge,it,lt),q[K+1+32]=q[K+3+64]=_n(Pe,ge,it),q[K+1+64]=q[K+3+96]=_n(Ye,Pe,ge),q[K+1+96]=_n(Je,Ye,Pe)}function Vs(q,K){var ge;for(ge=0;8>ge;++ge)n(q,K+32*ge,q,K-32,8)}function Mi(q,K){var ge;for(ge=0;8>ge;++ge)i(q,K,q[K-1],8),K+=32}function Cs(q,K,ge){var Pe;for(Pe=0;8>Pe;++Pe)i(K,ge+32*Pe,q,8)}function oa(q,K){var ge,Pe=8;for(ge=0;8>ge;++ge)Pe+=q[K+ge-32]+q[K-1+32*ge];Cs(Pe>>4,q,K)}function ku(q,K){var ge,Pe=4;for(ge=0;8>ge;++ge)Pe+=q[K+ge-32];Cs(Pe>>3,q,K)}function Ka(q,K){var ge,Pe=4;for(ge=0;8>ge;++ge)Pe+=q[K-1+32*ge];Cs(Pe>>3,q,K)}function $s(q,K){Cs(128,q,K)}function Vo(q,K,ge){var Pe=q[K-ge],Ye=q[K+0],Je=3*(Ye-Pe)+Wl[1020+q[K-2*ge]-q[K+ge]],it=Gl[112+(Je+4>>3)];q[K-ge]=Eo[255+Pe+Gl[112+(Je+3>>3)]],q[K+0]=Eo[255+Ye-it]}function Ru(q,K,ge,Pe){var Ye=q[K+0],Je=q[K+ge];return ni[255+q[K-2*ge]-q[K-ge]]>Pe||ni[255+Je-Ye]>Pe}function Mu(q,K,ge,Pe){return 4*ni[255+q[K-ge]-q[K+0]]+ni[255+q[K-2*ge]-q[K+ge]]<=Pe}function go(q,K,ge,Pe,Ye){var Je=q[K-3*ge],it=q[K-2*ge],lt=q[K-ge],yt=q[K+0],At=q[K+ge],Xt=q[K+2*ge],_r=q[K+3*ge];return 4*ni[255+lt-yt]+ni[255+it-At]>Pe?0:ni[255+q[K-4*ge]-Je]<=Ye&&ni[255+Je-it]<=Ye&&ni[255+it-lt]<=Ye&&ni[255+_r-Xt]<=Ye&&ni[255+Xt-At]<=Ye&&ni[255+At-yt]<=Ye}function ji(q,K,ge,Pe){var Ye=2*Pe+1;for(Pe=0;16>Pe;++Pe)Mu(q,K+Pe,ge,Ye)&&Vo(q,K+Pe,ge)}function qs(q,K,ge,Pe){var Ye=2*Pe+1;for(Pe=0;16>Pe;++Pe)Mu(q,K+Pe*ge,1,Ye)&&Vo(q,K+Pe*ge,1)}function ii(q,K,ge,Pe){var Ye;for(Ye=3;0<Ye;--Ye)ji(q,K+=4*ge,ge,Pe)}function ri(q,K,ge,Pe){var Ye;for(Ye=3;0<Ye;--Ye)qs(q,K+=4,ge,Pe)}function Do(q,K,ge,Pe,Ye,Je,it,lt){for(Je=2*Je+1;0<Ye--;){if(go(q,K,ge,Je,it))if(Ru(q,K,ge,lt))Vo(q,K,ge);else{var yt=q,At=K,Xt=ge,_r=yt[At-2*Xt],St=yt[At-Xt],Pt=yt[At+0],hr=yt[At+Xt],Lr=yt[At+2*Xt],gr=27*(jr=Wl[1020+3*(Pt-St)+Wl[1020+_r-hr]])+63>>7,Br=18*jr+63>>7,jr=9*jr+63>>7;yt[At-3*Xt]=Eo[255+yt[At-3*Xt]+jr],yt[At-2*Xt]=Eo[255+_r+Br],yt[At-Xt]=Eo[255+St+gr],yt[At+0]=Eo[255+Pt-gr],yt[At+Xt]=Eo[255+hr-Br],yt[At+2*Xt]=Eo[255+Lr-jr]}K+=Pe}}function ai(q,K,ge,Pe,Ye,Je,it,lt){for(Je=2*Je+1;0<Ye--;){if(go(q,K,ge,Je,it))if(Ru(q,K,ge,lt))Vo(q,K,ge);else{var yt=q,At=K,Xt=ge,_r=yt[At-Xt],St=yt[At+0],Pt=yt[At+Xt],hr=Gl[112+(4+(Lr=3*(St-_r))>>3)],Lr=Gl[112+(Lr+3>>3)],gr=hr+1>>1;yt[At-2*Xt]=Eo[255+yt[At-2*Xt]+gr],yt[At-Xt]=Eo[255+_r+Lr],yt[At+0]=Eo[255+St-hr],yt[At+Xt]=Eo[255+Pt-gr]}K+=Pe}}function ue(q,K,ge,Pe,Ye,Je){Do(q,K,ge,1,16,Pe,Ye,Je)}function Ge(q,K,ge,Pe,Ye,Je){Do(q,K,1,ge,16,Pe,Ye,Je)}function bt(q,K,ge,Pe,Ye,Je){var it;for(it=3;0<it;--it)ai(q,K+=4*ge,ge,1,16,Pe,Ye,Je)}function Bt(q,K,ge,Pe,Ye,Je){var it;for(it=3;0<it;--it)ai(q,K+=4,1,ge,16,Pe,Ye,Je)}function sr(q,K,ge,Pe,Ye,Je,it,lt){Do(q,K,Ye,1,8,Je,it,lt),Do(ge,Pe,Ye,1,8,Je,it,lt)}function Nr(q,K,ge,Pe,Ye,Je,it,lt){Do(q,K,1,Ye,8,Je,it,lt),Do(ge,Pe,1,Ye,8,Je,it,lt)}function Zr(q,K,ge,Pe,Ye,Je,it,lt){ai(q,K+4*Ye,Ye,1,8,Je,it,lt),ai(ge,Pe+4*Ye,Ye,1,8,Je,it,lt)}function Ln(q,K,ge,Pe,Ye,Je,it,lt){ai(q,K+4,1,Ye,8,Je,it,lt),ai(ge,Pe+4,1,Ye,8,Je,it,lt)}function qn(){this.ba=new zr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new en,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Un(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ui(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Hn(){this.ua=0,this.Wa=new Ht,this.vb=new Ht,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new he,this.yc=new oe}function Ui(){this.xb=this.a=0,this.l=new ps,this.ca=new zr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Ee,this.Pb=0,this.wd=new Ee,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Hn,this.ab=0,this.gc=s(4,ui),this.Oc=0}function Xi(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ps,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ra(q,K,ge,Pe,Ye,Je,it){for(q=q==null?0:q[K+0],K=0;K<it;++K)Ye[Je+K]=q+ge[Pe+K]&255,q=Ye[Je+K]}function Si(q,K,ge,Pe,Ye,Je,it){var lt;if(q==null)ra(null,null,ge,Pe,Ye,Je,it);else for(lt=0;lt<it;++lt)Ye[Je+lt]=q[K+lt]+ge[Pe+lt]&255}function Ia(q,K,ge,Pe,Ye,Je,it){if(q==null)ra(null,null,ge,Pe,Ye,Je,it);else{var lt,yt=q[K+0],At=yt,Xt=yt;for(lt=0;lt<it;++lt)At=Xt+(yt=q[K+lt])-At,Xt=ge[Pe+lt]+(-256&At?0>At?0:255:At)&255,At=yt,Ye[Je+lt]=Xt}}function za(q,K,ge,Pe){var Ye=K.width,Je=K.o;if(e(q!=null&&K!=null),0>ge||0>=Pe||ge+Pe>Je)return null;if(!q.Cc){if(q.ga==null){var it;if(q.ga=new Xi,(it=q.ga==null)||(it=K.width*K.o,e(q.Gb.length==0),q.Gb=a(it),q.Uc=0,q.Gb==null?it=0:(q.mb=q.Gb,q.nb=q.Uc,q.rc=null,it=1),it=!it),!it){it=q.ga;var lt=q.Fa,yt=q.P,At=q.qc,Xt=q.mb,_r=q.nb,St=yt+1,Pt=At-1,hr=it.l;if(e(lt!=null&&Xt!=null&&K!=null),ac[0]=null,ac[1]=ra,ac[2]=Si,ac[3]=Ia,it.ca=Xt,it.tb=_r,it.c=K.width,it.i=K.height,e(0<it.c&&0<it.i),1>=At)K=0;else if(it.$a=3&lt[yt+0],it.Z=lt[yt+0]>>2&3,it.Lc=lt[yt+0]>>4&3,yt=lt[yt+0]>>6&3,0>it.$a||1<it.$a||4<=it.Z||1<it.Lc||yt)K=0;else if(hr.put=un,hr.ac=oi,hr.bc=Kn,hr.ma=it,hr.width=K.width,hr.height=K.height,hr.Da=K.Da,hr.v=K.v,hr.va=K.va,hr.j=K.j,hr.o=K.o,it.$a)e:{e(it.$a==1),K=ua();t:for(;;){if(K==null){K=0;break e}if(e(it!=null),it.mc=K,K.c=it.c,K.i=it.i,K.l=it.l,K.l.ma=it,K.l.width=it.c,K.l.height=it.i,K.a=0,xe(K.m,lt,St,Pt),!fa(it.c,it.i,1,K,null)||(K.ab==1&&K.gc[0].hc==3&&Ci(K.s)?(it.ic=1,lt=K.c*K.i,K.Ta=null,K.Ua=0,K.V=a(lt),K.Ba=0,K.V==null?(K.a=1,K=0):K=1):(it.ic=0,K=zn(K,it.c)),!K))break t;K=1;break e}it.mc=null,K=0}else K=Pt>=it.c*it.i;it=!K}if(it)return null;q.ga.Lc!=1?q.Ga=0:Pe=Je-ge}e(q.ga!=null),e(ge+Pe<=Je);e:{if(K=(lt=q.ga).c,Je=lt.l.o,lt.$a==0){if(St=q.rc,Pt=q.Vc,hr=q.Fa,yt=q.P+1+ge*K,At=q.mb,Xt=q.nb+ge*K,e(yt<=q.P+q.qc),lt.Z!=0)for(e(ac[lt.Z]!=null),it=0;it<Pe;++it)ac[lt.Z](St,Pt,hr,yt,At,Xt,K),St=At,Pt=Xt,Xt+=K,yt+=K;else for(it=0;it<Pe;++it)n(At,Xt,hr,yt,K),St=At,Pt=Xt,Xt+=K,yt+=K;q.rc=St,q.Vc=Pt}else{if(e(lt.mc!=null),K=ge+Pe,e((it=lt.mc)!=null),e(K<=it.i),it.C>=K)K=1;else if(lt.ic||Gs(),lt.ic){lt=it.V,St=it.Ba,Pt=it.c;var Lr=it.i,gr=(hr=1,yt=it.$/Pt,At=it.$%Pt,Xt=it.m,_r=it.s,it.$),Br=Pt*Lr,jr=Pt*K,sn=_r.wc,Jr=gr<jr?Xr(_r,At,yt):null;e(gr<=Br),e(K<=Lr),e(Ci(_r));t:for(;;){for(;!Xt.h&&gr<jr;){if(At&sn||(Jr=Xr(_r,At,yt)),e(Jr!=null),Xe(Xt),256>(Lr=Wt(Jr.G[0],Jr.H[0],Xt)))lt[St+gr]=Lr,++gr,++At>=Pt&&(At=0,++yt<=K&&!(yt%16)&&Mn(it,yt));else{if(!(280>Lr)){hr=0;break t}Lr=He(Lr-256,Xt);var Jn,Vn=Wt(Jr.G[4],Jr.H[4],Xt);if(Xe(Xt),!(gr>=(Vn=Tt(Pt,Vn=He(Vn,Xt)))&&Br-gr>=Lr)){hr=0;break t}for(Jn=0;Jn<Lr;++Jn)lt[St+gr+Jn]=lt[St+gr+Jn-Vn];for(gr+=Lr,At+=Lr;At>=Pt;)At-=Pt,++yt<=K&&!(yt%16)&&Mn(it,yt);gr<jr&&At&sn&&(Jr=Xr(_r,At,yt))}e(Xt.h==Le(Xt))}Mn(it,yt>K?K:yt);break t}!hr||Xt.h&&gr<Br?(hr=0,it.a=Xt.h?5:3):it.$=gr,K=hr}else K=Bn(it,it.V,it.Ba,it.c,it.i,K,La);if(!K){Pe=0;break e}}ge+Pe>=Je&&(q.Cc=1),Pe=1}if(!Pe)return null;if(q.Cc&&((Pe=q.ga)!=null&&(Pe.mc=null),q.ga=null,0<q.Ga))return alert("todo:WebPDequantizeLevels"),null}return q.nb+ge*Ye}function Hs(q,K,ge,Pe,Ye,Je){for(;0<Ye--;){var it,lt=q,yt=K+(ge?1:0),At=q,Xt=K+(ge?0:3);for(it=0;it<Pe;++it){var _r=At[Xt+4*it];_r!=255&&(_r*=32897,lt[yt+4*it+0]=lt[yt+4*it+0]*_r>>23,lt[yt+4*it+1]=lt[yt+4*it+1]*_r>>23,lt[yt+4*it+2]=lt[yt+4*it+2]*_r>>23)}K+=Je}}function ll(q,K,ge,Pe,Ye){for(;0<Pe--;){var Je;for(Je=0;Je<ge;++Je){var it=q[K+2*Je+0],lt=15&(At=q[K+2*Je+1]),yt=4369*lt,At=(240&At|At>>4)*yt>>16;q[K+2*Je+0]=(240&it|it>>4)*yt>>16&240|(15&it|it<<4)*yt>>16>>4&15,q[K+2*Je+1]=240&At|lt}K+=Ye}}function Ws(q,K,ge,Pe,Ye,Je,it,lt){var yt,At,Xt=255;for(At=0;At<Ye;++At){for(yt=0;yt<Pe;++yt){var _r=q[K+yt];Je[it+4*yt]=_r,Xt&=_r}K+=ge,it+=lt}return Xt!=255}function $o(q,K,ge,Pe,Ye){var Je;for(Je=0;Je<Ye;++Je)ge[Pe+Je]=q[K+Je]>>8}function Gs(){ca=Hs,so=ll,ka=Ws,Ho=$o}function Pa(q,K,ge){X[q]=function(Pe,Ye,Je,it,lt,yt,At,Xt,_r,St,Pt,hr,Lr,gr,Br,jr,sn){var Jr,Jn=sn-1>>1,Vn=lt[yt+0]|At[Xt+0]<<16,Ai=_r[St+0]|Pt[hr+0]<<16;e(Pe!=null);var Zn=3*Vn+Ai+131074>>2;for(K(Pe[Ye+0],255&Zn,Zn>>16,Lr,gr),Je!=null&&(Zn=3*Ai+Vn+131074>>2,K(Je[it+0],255&Zn,Zn>>16,Br,jr)),Jr=1;Jr<=Jn;++Jr){var Yi=lt[yt+Jr]|At[Xt+Jr]<<16,No=_r[St+Jr]|Pt[hr+Jr]<<16,Ni=Vn+Yi+Ai+No+524296,Yn=Ni+2*(Yi+Ai)>>3;Zn=Yn+Vn>>1,Vn=(Ni=Ni+2*(Vn+No)>>3)+Yi>>1,K(Pe[Ye+2*Jr-1],255&Zn,Zn>>16,Lr,gr+(2*Jr-1)*ge),K(Pe[Ye+2*Jr-0],255&Vn,Vn>>16,Lr,gr+(2*Jr-0)*ge),Je!=null&&(Zn=Ni+Ai>>1,Vn=Yn+No>>1,K(Je[it+2*Jr-1],255&Zn,Zn>>16,Br,jr+(2*Jr-1)*ge),K(Je[it+2*Jr+0],255&Vn,Vn>>16,Br,jr+(2*Jr+0)*ge)),Vn=Yi,Ai=No}1&sn||(Zn=3*Vn+Ai+131074>>2,K(Pe[Ye+sn-1],255&Zn,Zn>>16,Lr,gr+(sn-1)*ge),Je!=null&&(Zn=3*Ai+Vn+131074>>2,K(Je[it+sn-1],255&Zn,Zn>>16,Br,jr+(sn-1)*ge)))}}function Xs(){dl[Nu]=jp,dl[Qh]=Bf,dl[yh]=_h,dl[pu]=bh,dl[Op]=af,dl[Vg]=Xg,dl[$g]=By,dl[qg]=Bf,dl[Od]=bh,dl[Vc]=af,dl[ef]=Xg}function Il(q){return q&-16384?0>q?0:255:q>>Yg}function gs(q,K){return Il((19077*q>>8)+(26149*K>>8)-14234)}function Di(q,K,ge){return Il((19077*q>>8)-(6419*K>>8)-(13320*ge>>8)+8708)}function qo(q,K){return Il((19077*q>>8)+(33050*K>>8)-17685)}function Da(q,K,ge,Pe,Ye){Pe[Ye+0]=gs(q,ge),Pe[Ye+1]=Di(q,K,ge),Pe[Ye+2]=qo(q,K)}function ns(q,K,ge,Pe,Ye){Pe[Ye+0]=qo(q,K),Pe[Ye+1]=Di(q,K,ge),Pe[Ye+2]=gs(q,ge)}function As(q,K,ge,Pe,Ye){var Je=Di(q,K,ge);K=Je<<3&224|qo(q,K)>>3,Pe[Ye+0]=248&gs(q,ge)|Je>>5,Pe[Ye+1]=K}function Ja(q,K,ge,Pe,Ye){var Je=240&qo(q,K)|15;Pe[Ye+0]=240&gs(q,ge)|Di(q,K,ge)>>4,Pe[Ye+1]=Je}function rc(q,K,ge,Pe,Ye){Pe[Ye+0]=255,Da(q,K,ge,Pe,Ye+1)}function uu(q,K,ge,Pe,Ye){ns(q,K,ge,Pe,Ye),Pe[Ye+3]=255}function Ys(q,K,ge,Pe,Ye){Da(q,K,ge,Pe,Ye),Pe[Ye+3]=255}function ja(q,K){return 0>q?0:q>K?K:q}function Is(q,K,ge){X[q]=function(Pe,Ye,Je,it,lt,yt,At,Xt,_r){for(var St=Xt+(-2&_r)*ge;Xt!=St;)K(Pe[Ye+0],Je[it+0],lt[yt+0],At,Xt),K(Pe[Ye+1],Je[it+0],lt[yt+0],At,Xt+ge),Ye+=2,++it,++yt,Xt+=2*ge;1&_r&&K(Pe[Ye+0],Je[it+0],lt[yt+0],At,Xt)}}function nc(q,K,ge){return ge==0?q==0?K==0?6:5:K==0?4:0:ge}function ic(q,K,ge,Pe,Ye){switch(q>>>30){case 3:_(K,ge,Pe,Ye,0);break;case 2:P(K,ge,Pe,Ye);break;case 1:ne(K,ge,Pe,Ye)}}function ul(q,K){var ge,Pe,Ye=K.M,Je=K.Nb,it=q.oc,lt=q.pc+40,yt=q.oc,At=q.pc+584,Xt=q.oc,_r=q.pc+600;for(ge=0;16>ge;++ge)it[lt+32*ge-1]=129;for(ge=0;8>ge;++ge)yt[At+32*ge-1]=129,Xt[_r+32*ge-1]=129;for(0<Ye?it[lt-1-32]=yt[At-1-32]=Xt[_r-1-32]=129:(i(it,lt-32-1,127,21),i(yt,At-32-1,127,9),i(Xt,_r-32-1,127,9)),Pe=0;Pe<q.za;++Pe){var St=K.ya[K.aa+Pe];if(0<Pe){for(ge=-1;16>ge;++ge)n(it,lt+32*ge-4,it,lt+32*ge+12,4);for(ge=-1;8>ge;++ge)n(yt,At+32*ge-4,yt,At+32*ge+4,4),n(Xt,_r+32*ge-4,Xt,_r+32*ge+4,4)}var Pt=q.Gd,hr=q.Hd+Pe,Lr=St.ad,gr=St.Hc;if(0<Ye&&(n(it,lt-32,Pt[hr].y,0,16),n(yt,At-32,Pt[hr].f,0,8),n(Xt,_r-32,Pt[hr].ea,0,8)),St.Za){var Br=it,jr=lt-32+16;for(0<Ye&&(Pe>=q.za-1?i(Br,jr,Pt[hr].y[15],4):n(Br,jr,Pt[hr+1].y,0,4)),ge=0;4>ge;ge++)Br[jr+128+ge]=Br[jr+256+ge]=Br[jr+384+ge]=Br[jr+0+ge];for(ge=0;16>ge;++ge,gr<<=2)Br=it,jr=lt+Vp[ge],Lu[St.Ob[ge]](Br,jr),ic(gr,Lr,16*+ge,Br,jr)}else if(Br=nc(Pe,Ye,St.Ob[0]),$c[Br](it,lt),gr!=0)for(ge=0;16>ge;++ge,gr<<=2)ic(gr,Lr,16*+ge,it,lt+Vp[ge]);for(ge=St.Gc,Br=nc(Pe,Ye,St.Dd),xa[Br](yt,At),xa[Br](Xt,_r),gr=Lr,Br=yt,jr=At,255&(St=0|ge)&&(170&St?$(gr,256,Br,jr):ye(gr,256,Br,jr)),St=Xt,gr=_r,255&(ge>>=8)&&(170&ge?$(Lr,320,St,gr):ye(Lr,320,St,gr)),Ye<q.Ub-1&&(n(Pt[hr].y,0,it,lt+480,16),n(Pt[hr].f,0,yt,At+224,8),n(Pt[hr].ea,0,Xt,_r+224,8)),ge=8*Je*q.B,Pt=q.sa,hr=q.ta+16*Pe+16*Je*q.R,Lr=q.qa,St=q.ra+8*Pe+ge,gr=q.Ha,Br=q.Ia+8*Pe+ge,ge=0;16>ge;++ge)n(Pt,hr+ge*q.R,it,lt+32*ge,16);for(ge=0;8>ge;++ge)n(Lr,St+ge*q.B,yt,At+32*ge,8),n(gr,Br+ge*q.B,Xt,_r+32*ge,8)}}function cu(q,K,ge,Pe,Ye,Je,it,lt,yt){var At=[0],Xt=[0],_r=0,St=yt!=null?yt.kd:0,Pt=yt??new Un;if(q==null||12>ge)return 7;Pt.data=q,Pt.w=K,Pt.ha=ge,K=[K],ge=[ge],Pt.gb=[Pt.gb];e:{var hr=K,Lr=ge,gr=Pt.gb;if(e(q!=null),e(Lr!=null),e(gr!=null),gr[0]=0,12<=Lr[0]&&!r(q,hr[0],"RIFF")){if(r(q,hr[0]+8,"WEBP")){gr=3;break e}var Br=st(q,hr[0]+4);if(12>Br||4294967286<Br){gr=3;break e}if(St&&Br>Lr[0]-8){gr=7;break e}gr[0]=Br,hr[0]+=12,Lr[0]-=12}gr=0}if(gr!=0)return gr;for(Br=0<Pt.gb[0],ge=ge[0];;){e:{var jr=q;Lr=K,gr=ge;var sn=At,Jr=Xt,Jn=hr=[0];if((Zn=_r=[_r])[0]=0,8>gr[0])gr=7;else{if(!r(jr,Lr[0],"VP8X")){if(st(jr,Lr[0]+4)!=10){gr=3;break e}if(18>gr[0]){gr=7;break e}var Vn=st(jr,Lr[0]+8),Ai=1+zt(jr,Lr[0]+12);if(2147483648<=Ai*(jr=1+zt(jr,Lr[0]+15))){gr=3;break e}Jn!=null&&(Jn[0]=Vn),sn!=null&&(sn[0]=Ai),Jr!=null&&(Jr[0]=jr),Lr[0]+=18,gr[0]-=18,Zn[0]=1}gr=0}}if(_r=_r[0],hr=hr[0],gr!=0)return gr;if(Lr=!!(2&hr),!Br&&_r)return 3;if(Je!=null&&(Je[0]=!!(16&hr)),it!=null&&(it[0]=Lr),lt!=null&&(lt[0]=0),it=At[0],hr=Xt[0],_r&&Lr&&yt==null){gr=0;break}if(4>ge){gr=7;break}if(Br&&_r||!Br&&!_r&&!r(q,K[0],"ALPH")){ge=[ge],Pt.na=[Pt.na],Pt.P=[Pt.P],Pt.Sa=[Pt.Sa];e:{Vn=q,gr=K,Br=ge;var Zn=Pt.gb;sn=Pt.na,Jr=Pt.P,Jn=Pt.Sa,Ai=22,e(Vn!=null),e(Br!=null),jr=gr[0];var Yi=Br[0];for(e(sn!=null),e(Jn!=null),sn[0]=null,Jr[0]=null,Jn[0]=0;;){if(gr[0]=jr,Br[0]=Yi,8>Yi){gr=7;break e}var No=st(Vn,jr+4);if(4294967286<No){gr=3;break e}var Ni=8+No+1&-2;if(Ai+=Ni,0<Zn&&Ai>Zn){gr=3;break e}if(!r(Vn,jr,"VP8 ")||!r(Vn,jr,"VP8L")){gr=0;break e}if(Yi[0]<Ni){gr=7;break e}r(Vn,jr,"ALPH")||(sn[0]=Vn,Jr[0]=jr+8,Jn[0]=No),jr+=Ni,Yi-=Ni}}if(ge=ge[0],Pt.na=Pt.na[0],Pt.P=Pt.P[0],Pt.Sa=Pt.Sa[0],gr!=0)break}ge=[ge],Pt.Ja=[Pt.Ja],Pt.xa=[Pt.xa];e:if(Zn=q,gr=K,Br=ge,sn=Pt.gb[0],Jr=Pt.Ja,Jn=Pt.xa,Vn=gr[0],jr=!r(Zn,Vn,"VP8 "),Ai=!r(Zn,Vn,"VP8L"),e(Zn!=null),e(Br!=null),e(Jr!=null),e(Jn!=null),8>Br[0])gr=7;else{if(jr||Ai){if(Zn=st(Zn,Vn+4),12<=sn&&Zn>sn-12){gr=3;break e}if(St&&Zn>Br[0]-8){gr=7;break e}Jr[0]=Zn,gr[0]+=8,Br[0]-=8,Jn[0]=Ai}else Jn[0]=5<=Br[0]&&Zn[Vn+0]==47&&!(Zn[Vn+4]>>5),Jr[0]=Br[0];gr=0}if(ge=ge[0],Pt.Ja=Pt.Ja[0],Pt.xa=Pt.xa[0],K=K[0],gr!=0)break;if(4294967286<Pt.Ja)return 3;if(lt==null||Lr||(lt[0]=Pt.xa?2:1),it=[it],hr=[hr],Pt.xa){if(5>ge){gr=7;break}lt=it,St=hr,Lr=Je,q==null||5>ge?q=0:5<=ge&&q[K+0]==47&&!(q[K+4]>>5)?(Br=[0],Zn=[0],sn=[0],xe(Jr=new Ee,q,K,ge),Me(Jr,Br,Zn,sn)?(lt!=null&&(lt[0]=Br[0]),St!=null&&(St[0]=Zn[0]),Lr!=null&&(Lr[0]=sn[0]),q=1):q=0):q=0}else{if(10>ge){gr=7;break}lt=hr,q==null||10>ge||!_a(q,K+3,ge-3)?q=0:(St=q[K+0]|q[K+1]<<8|q[K+2]<<16,Lr=16383&(q[K+7]<<8|q[K+6]),q=16383&(q[K+9]<<8|q[K+8]),1&St||3<(St>>1&7)||!(St>>4&1)||St>>5>=Pt.Ja||!Lr||!q?q=0:(it&&(it[0]=Lr),lt&&(lt[0]=q),q=1))}if(!q||(it=it[0],hr=hr[0],_r&&(At[0]!=it||Xt[0]!=hr)))return 3;yt!=null&&(yt[0]=Pt,yt.offset=K-yt.w,e(4294967286>K-yt.w),e(yt.offset==yt.ha-ge));break}return gr==0||gr==7&&_r&&yt==null?(Je!=null&&(Je[0]|=Pt.na!=null&&0<Pt.na.length),Pe!=null&&(Pe[0]=it),Ye!=null&&(Ye[0]=hr),0):gr}function Oo(q,K,ge){var Pe=K.width,Ye=K.height,Je=0,it=0,lt=Pe,yt=Ye;if(K.Da=q!=null&&0<q.Da,K.Da&&(lt=q.cd,yt=q.bd,Je=q.v,it=q.j,11>ge||(Je&=-2,it&=-2),0>Je||0>it||0>=lt||0>=yt||Je+lt>Pe||it+yt>Ye))return 0;if(K.v=Je,K.j=it,K.va=Je+lt,K.o=it+yt,K.U=lt,K.T=yt,K.da=q!=null&&0<q.da,K.da){if(!pr(lt,yt,ge=[q.ib],Je=[q.hb]))return 0;K.ib=ge[0],K.hb=Je[0]}return K.ob=q!=null&&q.ob,K.Kb=q==null||!q.Sd,K.da&&(K.ob=K.ib<3*Pe/4&&K.hb<3*Ye/4,K.Kb=0),1}function mo(q){if(q==null)return 2;if(11>q.S){var K=q.f.RGBA;K.fb+=(q.height-1)*K.A,K.A=-K.A}else K=q.f.kb,q=q.height,K.O+=(q-1)*K.fa,K.fa=-K.fa,K.N+=(q-1>>1)*K.Ab,K.Ab=-K.Ab,K.W+=(q-1>>1)*K.Db,K.Db=-K.Db,K.F!=null&&(K.J+=(q-1)*K.lb,K.lb=-K.lb);return 0}function Du(q,K,ge,Pe){if(Pe==null||0>=q||0>=K)return 2;if(ge!=null){if(ge.Da){var Ye=ge.cd,Je=ge.bd,it=-2&ge.v,lt=-2&ge.j;if(0>it||0>lt||0>=Ye||0>=Je||it+Ye>q||lt+Je>K)return 2;q=Ye,K=Je}if(ge.da){if(!pr(q,K,Ye=[ge.ib],Je=[ge.hb]))return 2;q=Ye[0],K=Je[0]}}Pe.width=q,Pe.height=K;e:{var yt=Pe.width,At=Pe.height;if(q=Pe.S,0>=yt||0>=At||!(q>=Nu&&13>q))q=2;else{if(0>=Pe.Rd&&Pe.sd==null){it=Je=Ye=K=0;var Xt=(lt=yt*Bu[q])*At;if(11>q||(Je=(At+1)/2*(K=(yt+1)/2),q==12&&(it=(Ye=yt)*At)),(At=a(Xt+2*Je+it))==null){q=1;break e}Pe.sd=At,11>q?((yt=Pe.f.RGBA).eb=At,yt.fb=0,yt.A=lt,yt.size=Xt):((yt=Pe.f.kb).y=At,yt.O=0,yt.fa=lt,yt.Fd=Xt,yt.f=At,yt.N=0+Xt,yt.Ab=K,yt.Cd=Je,yt.ea=At,yt.W=0+Xt+Je,yt.Db=K,yt.Ed=Je,q==12&&(yt.F=At,yt.J=0+Xt+2*Je),yt.Tc=it,yt.lb=Ye)}if(K=1,Ye=Pe.S,Je=Pe.width,it=Pe.height,Ye>=Nu&&13>Ye)if(11>Ye)q=Pe.f.RGBA,K&=(lt=Math.abs(q.A))*(it-1)+Je<=q.size,K&=lt>=Je*Bu[Ye],K&=q.eb!=null;else{q=Pe.f.kb,lt=(Je+1)/2,Xt=(it+1)/2,yt=Math.abs(q.fa),At=Math.abs(q.Ab);var _r=Math.abs(q.Db),St=Math.abs(q.lb),Pt=St*(it-1)+Je;K&=yt*(it-1)+Je<=q.Fd,K&=At*(Xt-1)+lt<=q.Cd,K=(K&=_r*(Xt-1)+lt<=q.Ed)&yt>=Je&At>=lt&_r>=lt,K&=q.y!=null,K&=q.f!=null,K&=q.ea!=null,Ye==12&&(K&=St>=Je,K&=Pt<=q.Tc,K&=q.F!=null)}else K=0;q=K?0:2}}return q!=0||ge!=null&&ge.fd&&(q=mo(Pe)),q}var Ua=64,hu=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Zs=24,ms=32,Va=8,Vl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];br("Predictor0","PredictorAdd0"),X.Predictor0=function(){return 4278190080},X.Predictor1=function(q){return q},X.Predictor2=function(q,K,ge){return K[ge+0]},X.Predictor3=function(q,K,ge){return K[ge+1]},X.Predictor4=function(q,K,ge){return K[ge-1]},X.Predictor5=function(q,K,ge){return Cr(Cr(q,K[ge+1]),K[ge+0])},X.Predictor6=function(q,K,ge){return Cr(q,K[ge-1])},X.Predictor7=function(q,K,ge){return Cr(q,K[ge+0])},X.Predictor8=function(q,K,ge){return Cr(K[ge-1],K[ge+0])},X.Predictor9=function(q,K,ge){return Cr(K[ge+0],K[ge+1])},X.Predictor10=function(q,K,ge){return Cr(Cr(q,K[ge-1]),Cr(K[ge+0],K[ge+1]))},X.Predictor11=function(q,K,ge){var Pe=K[ge+0];return 0>=at(Pe>>24&255,q>>24&255,(K=K[ge-1])>>24&255)+at(Pe>>16&255,q>>16&255,K>>16&255)+at(Pe>>8&255,q>>8&255,K>>8&255)+at(255&Pe,255&q,255&K)?Pe:q},X.Predictor12=function(q,K,ge){var Pe=K[ge+0];return(Tr((q>>24&255)+(Pe>>24&255)-((K=K[ge-1])>>24&255))<<24|Tr((q>>16&255)+(Pe>>16&255)-(K>>16&255))<<16|Tr((q>>8&255)+(Pe>>8&255)-(K>>8&255))<<8|Tr((255&q)+(255&Pe)-(255&K)))>>>0},X.Predictor13=function(q,K,ge){var Pe=K[ge-1];return(Qt((q=Cr(q,K[ge+0]))>>24&255,Pe>>24&255)<<24|Qt(q>>16&255,Pe>>16&255)<<16|Qt(q>>8&255,Pe>>8&255)<<8|Qt(255&q,255&Pe))>>>0};var cl=X.PredictorAdd0;X.PredictorAdd1=ke,br("Predictor2","PredictorAdd2"),br("Predictor3","PredictorAdd3"),br("Predictor4","PredictorAdd4"),br("Predictor5","PredictorAdd5"),br("Predictor6","PredictorAdd6"),br("Predictor7","PredictorAdd7"),br("Predictor8","PredictorAdd8"),br("Predictor9","PredictorAdd9"),br("Predictor10","PredictorAdd10"),br("Predictor11","PredictorAdd11"),br("Predictor12","PredictorAdd12"),br("Predictor13","PredictorAdd13");var hl=X.PredictorAdd2;We("ColorIndexInverseTransform","MapARGB","32b",function(q){return q>>8&255},function(q){return q}),We("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(q){return q},function(q){return q>>8&255});var $l,ql=X.ColorIndexInverseTransform,fl=X.MapARGB,Hl=X.VP8LColorIndexInverseTransformAlpha,Ou=X.MapAlpha,tr=X.VP8LPredictorsAdd=[];tr.length=16,(X.VP8LPredictors=[]).length=16,(X.VP8LPredictorsAdd_C=[]).length=16,(X.VP8LPredictors_C=[]).length=16;var mr,dn,In,vi,Pn,I,y,_,P,$,ne,ye,Oe,tt,ht,rr,ur,qr,bn,Dn,Xn,Fn,En,na,ca,so,ka,Ho,Ks=a(511),Pl=a(2041),fu=a(225),du=a(767),Ps=0,Wl=Pl,Gl=fu,Eo=du,ni=Ks,Nu=0,Qh=1,yh=2,pu=3,Op=4,Vg=5,$g=6,qg=7,Od=8,Vc=9,ef=10,Np=[2,3,7],Hg=[3,3,11],Lp=[280,256,256,256,40],Fp=[0,1,1,1,0],Bp=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],vh=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],tf=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Wg=8,Gg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],rf=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Nd=null,Ny=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Ld=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Fd=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Ly=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Fy=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Bd=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],zp=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],$c=[],Lu=[],xa=[],nf=1,Xl=2,ac=[],dl=[];Pa("UpsampleRgbLinePair",Da,3),Pa("UpsampleBgrLinePair",ns,3),Pa("UpsampleRgbaLinePair",Ys,4),Pa("UpsampleBgraLinePair",uu,4),Pa("UpsampleArgbLinePair",rc,4),Pa("UpsampleRgba4444LinePair",Ja,2),Pa("UpsampleRgb565LinePair",As,2);var jp=X.UpsampleRgbLinePair,_h=X.UpsampleBgrLinePair,Bf=X.UpsampleRgbaLinePair,bh=X.UpsampleBgraLinePair,af=X.UpsampleArgbLinePair,Xg=X.UpsampleRgba4444LinePair,By=X.UpsampleRgb565LinePair,zd=16,jd=1<<zd-1,zf=-227,wc=482,Yg=6,Up=0,Ud=a(256),zy=a(256),Zg=a(256),Kg=a(256),jy=a(wc-zf),Jg=a(wc-zf);Is("YuvToRgbRow",Da,3),Is("YuvToBgrRow",ns,3),Is("YuvToRgbaRow",Ys,4),Is("YuvToBgraRow",uu,4),Is("YuvToArgbRow",rc,4),Is("YuvToRgba4444Row",Ja,2),Is("YuvToRgb565Row",As,2);var Vp=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],oc=[0,2,8],Uy=[8,7,6,4,4,2,2,2,1,1,1,1],Fu=1;this.WebPDecodeRGBA=function(q,K,ge,Pe,Ye){var Je=Qh,it=new qn,lt=new zr;it.ba=lt,lt.S=Je,lt.width=[lt.width],lt.height=[lt.height];var yt=lt.width,At=lt.height,Xt=new Mt;if(Xt==null||q==null)var _r=2;else e(Xt!=null),_r=cu(q,K,ge,Xt.width,Xt.height,Xt.Pd,Xt.Qd,Xt.format,null);if(_r!=0?yt=0:(yt!=null&&(yt[0]=Xt.width[0]),At!=null&&(At[0]=Xt.height[0]),yt=1),yt){lt.width=lt.width[0],lt.height=lt.height[0],Pe!=null&&(Pe[0]=lt.width),Ye!=null&&(Ye[0]=lt.height);e:{if(Pe=new ps,(Ye=new Un).data=q,Ye.w=K,Ye.ha=ge,Ye.kd=1,K=[0],e(Ye!=null),((q=cu(Ye.data,Ye.w,Ye.ha,null,null,null,K,null,Ye))==0||q==7)&&K[0]&&(q=4),(K=q)==0){if(e(it!=null),Pe.data=Ye.data,Pe.w=Ye.w+Ye.offset,Pe.ha=Ye.ha-Ye.offset,Pe.put=un,Pe.ac=oi,Pe.bc=Kn,Pe.ma=it,Ye.xa){if((q=ua())==null){it=1;break e}if((function(St,Pt){var hr=[0],Lr=[0],gr=[0];t:for(;;){if(St==null)return 0;if(Pt==null)return St.a=2,0;if(St.l=Pt,St.a=0,xe(St.m,Pt.data,Pt.w,Pt.ha),!Me(St.m,hr,Lr,gr)){St.a=3;break t}if(St.xb=Xl,Pt.width=hr[0],Pt.height=Lr[0],!fa(hr[0],Lr[0],1,St,null))break t;return 1}return e(St.a!=0),0})(q,Pe)){if(Pe=(K=Du(Pe.width,Pe.height,it.Oa,it.ba))==0){t:{Pe=q;r:for(;;){if(Pe==null){Pe=0;break t}if(e(Pe.s.yc!=null),e(Pe.s.Ya!=null),e(0<Pe.s.Wb),e((ge=Pe.l)!=null),e((Ye=ge.ma)!=null),Pe.xb!=0){if(Pe.ca=Ye.ba,Pe.tb=Ye.tb,e(Pe.ca!=null),!Oo(Ye.Oa,ge,pu)){Pe.a=2;break r}if(!zn(Pe,ge.width)||ge.da)break r;if((ge.da||Ar(Pe.ca.S))&&Gs(),11>Pe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Pe.ca.f.kb.F!=null&&Gs()),Pe.Pb&&0<Pe.s.ua&&Pe.s.vb.X==null&&!$e(Pe.s.vb,Pe.s.Wa.Xa)){Pe.a=1;break r}Pe.xb=0}if(!Bn(Pe,Pe.V,Pe.Ba,Pe.c,Pe.i,ge.o,Bi))break r;Ye.Dc=Pe.Ma,Pe=1;break t}e(Pe.a!=0),Pe=0}Pe=!Pe}Pe&&(K=q.a)}else K=q.a}else{if((q=new Ul)==null){it=1;break e}if(q.Fa=Ye.na,q.P=Ye.P,q.qc=Ye.Sa,xc(q,Pe)){if((K=Du(Pe.width,Pe.height,it.Oa,it.ba))==0){if(q.Aa=0,ge=it.Oa,e((Ye=q)!=null),ge!=null){if(0<(yt=0>(yt=ge.Md)?0:100<yt?255:255*yt/100)){for(At=Xt=0;4>At;++At)12>(_r=Ye.pb[At]).lc&&(_r.ia=yt*Uy[0>_r.lc?0:_r.lc]>>3),Xt|=_r.ia;Xt&&(alert("todo:VP8InitRandom"),Ye.ia=1)}Ye.Ga=ge.Id,100<Ye.Ga?Ye.Ga=100:0>Ye.Ga&&(Ye.Ga=0)}(function(St,Pt){if(St==null)return 0;if(Pt==null)return Fa(St,2,"NULL VP8Io parameter in VP8Decode().");if(!St.cb&&!xc(St,Pt))return 0;if(e(St.cb),Pt.ac==null||Pt.ac(Pt)){Pt.ob&&(St.L=0);var hr=oc[St.L];if(St.L==2?(St.yb=0,St.zb=0):(St.yb=Pt.v-hr>>4,St.zb=Pt.j-hr>>4,0>St.yb&&(St.yb=0),0>St.zb&&(St.zb=0)),St.Va=Pt.o+15+hr>>4,St.Hb=Pt.va+15+hr>>4,St.Hb>St.za&&(St.Hb=St.za),St.Va>St.Ub&&(St.Va=St.Ub),0<St.L){var Lr=St.ed;for(hr=0;4>hr;++hr){var gr;if(St.Qa.Cb){var Br=St.Qa.Lb[hr];St.Qa.Fb||(Br+=Lr.Tb)}else Br=Lr.Tb;for(gr=0;1>=gr;++gr){var jr=St.gd[hr][gr],sn=Br;if(Lr.Pc&&(sn+=Lr.vd[0],gr&&(sn+=Lr.od[0])),0<(sn=0>sn?0:63<sn?63:sn)){var Jr=sn;0<Lr.wb&&(Jr=4<Lr.wb?Jr>>2:Jr>>1)>9-Lr.wb&&(Jr=9-Lr.wb),1>Jr&&(Jr=1),jr.dd=Jr,jr.tc=2*sn+Jr,jr.ld=40<=sn?2:15<=sn?1:0}else jr.tc=0;jr.La=gr}}}hr=0}else Fa(St,6,"Frame setup failed"),hr=St.a;if(hr=hr==0){if(hr){St.$c=0,0<St.Aa||(St.Ic=Fu);t:{hr=St.Ic,Lr=4*(Jr=St.za);var Jn=32*Jr,Vn=Jr+1,Ai=0<St.L?Jr*(0<St.Aa?2:1):0,Zn=(St.Aa==2?2:1)*Jr;if((jr=Lr+832+(gr=3*(16*hr+oc[St.L])/2*Jn)+(Br=St.Fa!=null&&0<St.Fa.length?St.Kc.c*St.Kc.i:0))!=jr)hr=0;else{if(jr>St.Vb){if(St.Vb=0,St.Ec=a(jr),St.Fc=0,St.Ec==null){hr=Fa(St,1,"no memory during frame initialization.");break t}St.Vb=jr}jr=St.Ec,sn=St.Fc,St.Ac=jr,St.Bc=sn,sn+=Lr,St.Gd=s(Jn,ds),St.Hd=0,St.rb=s(Vn+1,zi),St.sb=1,St.wa=Ai?s(Ai,xi):null,St.Y=0,St.D.Nb=0,St.D.wa=St.wa,St.D.Y=St.Y,0<St.Aa&&(St.D.Y+=Jr),e(!0),St.oc=jr,St.pc=sn,sn+=832,St.ya=s(Zn,ga),St.aa=0,St.D.ya=St.ya,St.D.aa=St.aa,St.Aa==2&&(St.D.aa+=Jr),St.R=16*Jr,St.B=8*Jr,Jr=(Jn=oc[St.L])*St.R,Jn=Jn/2*St.B,St.sa=jr,St.ta=sn+Jr,St.qa=St.sa,St.ra=St.ta+16*hr*St.R+Jn,St.Ha=St.qa,St.Ia=St.ra+8*hr*St.B+Jn,St.$c=0,sn+=gr,St.mb=Br?jr:null,St.nb=Br?sn:null,e(sn+Br<=St.Fc+St.Vb),ts(St),i(St.Ac,St.Bc,0,Lr),hr=1}}if(hr){if(Pt.ka=0,Pt.y=St.sa,Pt.O=St.ta,Pt.f=St.qa,Pt.N=St.ra,Pt.ea=St.Ha,Pt.Vd=St.Ia,Pt.fa=St.R,Pt.Rc=St.B,Pt.F=null,Pt.J=0,!Ps){for(hr=-255;255>=hr;++hr)Ks[255+hr]=0>hr?-hr:hr;for(hr=-1020;1020>=hr;++hr)Pl[1020+hr]=-128>hr?-128:127<hr?127:hr;for(hr=-112;112>=hr;++hr)fu[112+hr]=-16>hr?-16:15<hr?15:hr;for(hr=-255;510>=hr;++hr)du[255+hr]=0>hr?0:255<hr?255:hr;Ps=1}y=It,_=Pu,$=ee,ne=pe,ye=Ke,P=Uc,Oe=ue,tt=Ge,ht=sr,rr=Nr,ur=bt,qr=Bt,bn=Zr,Dn=Ln,Xn=ji,Fn=qs,En=ii,na=ri,Lu[0]=mn,Lu[1]=$t,Lu[2]=Mr,Lu[3]=fn,Lu[4]=hi,Lu[5]=ba,Lu[6]=$i,Lu[7]=wi,Lu[8]=Ts,Lu[9]=fi,$c[0]=kr,$c[1]=Yr,$c[2]=tn,$c[3]=Wr,$c[4]=ti,$c[5]=Ri,$c[6]=$n,xa[0]=oa,xa[1]=er,xa[2]=Vs,xa[3]=Mi,xa[4]=Ka,xa[5]=ku,xa[6]=$s,hr=1}else hr=0}hr&&(hr=(function(Yi,No){for(Yi.M=0;Yi.M<Yi.Va;++Yi.M){var Ni,Yn=Yi.Jc[Yi.M&Yi.Xb],wn=Yi.m,To=Yi;for(Ni=0;Ni<To.za;++Ni){var Pi=wn,aa=To,da=aa.Ac,ki=aa.Bc+4*Ni,kl=aa.zc,Qa=aa.ya[aa.aa+Ni];if(aa.Qa.Bb?Qa.$b=Qe(Pi,aa.Pa.jb[0])?2+Qe(Pi,aa.Pa.jb[2]):Qe(Pi,aa.Pa.jb[1]):Qa.$b=0,aa.kc&&(Qa.Ad=Qe(Pi,aa.Bd)),Qa.Za=!Qe(Pi,145)+0,Qa.Za){var ys=Qa.Ob,ks=0;for(aa=0;4>aa;++aa){var Wo,sa=kl[0+aa];for(Wo=0;4>Wo;++Wo){sa=Fy[da[ki+Wo]][sa];for(var wa=Fd[Qe(Pi,sa[0])];0<wa;)wa=Fd[2*wa+Qe(Pi,sa[wa])];sa=-wa,da[ki+Wo]=sa}n(ys,ks,da,ki,4),ks+=4,kl[0+aa]=sa}}else sa=Qe(Pi,156)?Qe(Pi,128)?1:3:Qe(Pi,163)?2:0,Qa.Ob[0]=sa,i(da,ki,sa,4),i(kl,0,sa,4);Qa.Dd=Qe(Pi,142)?Qe(Pi,114)?Qe(Pi,183)?1:3:2:0}if(To.m.Ka)return Fa(Yi,7,"Premature end-of-partition0 encountered.");for(;Yi.ja<Yi.za;++Yi.ja){if(To=Yn,Pi=(wn=Yi).rb[wn.sb-1],da=wn.rb[wn.sb+wn.ja],Ni=wn.ya[wn.aa+wn.ja],ki=wn.kc?Ni.Ad:0)Pi.la=da.la=0,Ni.Za||(Pi.Na=da.Na=0),Ni.Hc=0,Ni.Gc=0,Ni.ia=0;else{var Co,qi;if(Pi=da,da=To,ki=wn.Pa.Xc,kl=wn.ya[wn.aa+wn.ja],Qa=wn.pb[kl.$b],aa=kl.ad,ys=0,ks=wn.rb[wn.sb-1],sa=Wo=0,i(aa,ys,0,384),kl.Za)var Go=0,Tn=ki[3];else{wa=a(16);var Sn=Pi.Na+ks.Na;if(Sn=Nd(da,ki[1],Sn,Qa.Eb,0,wa,0),Pi.Na=ks.Na=(0<Sn)+0,1<Sn)y(wa,0,aa,ys);else{var Rs=wa[0]+3>>3;for(wa=0;256>wa;wa+=16)aa[ys+wa]=Rs}Go=1,Tn=ki[0]}var Sa=15&Pi.la,Lo=15&ks.la;for(wa=0;4>wa;++wa){var $a=1&Lo;for(Rs=qi=0;4>Rs;++Rs)Sa=Sa>>1|($a=(Sn=Nd(da,Tn,Sn=$a+(1&Sa),Qa.Sc,Go,aa,ys))>Go)<<7,qi=qi<<2|(3<Sn?3:1<Sn?2:aa[ys+0]!=0),ys+=16;Sa>>=4,Lo=Lo>>1|$a<<7,Wo=(Wo<<8|qi)>>>0}for(Tn=Sa,Go=Lo>>4,Co=0;4>Co;Co+=2){for(qi=0,Sa=Pi.la>>4+Co,Lo=ks.la>>4+Co,wa=0;2>wa;++wa){for($a=1&Lo,Rs=0;2>Rs;++Rs)Sn=$a+(1&Sa),Sa=Sa>>1|($a=0<(Sn=Nd(da,ki[2],Sn,Qa.Qc,0,aa,ys)))<<3,qi=qi<<2|(3<Sn?3:1<Sn?2:aa[ys+0]!=0),ys+=16;Sa>>=2,Lo=Lo>>1|$a<<5}sa|=qi<<4*Co,Tn|=Sa<<4<<Co,Go|=(240&Lo)<<Co}Pi.la=Tn,ks.la=Go,kl.Hc=Wo,kl.Gc=sa,kl.ia=43690&sa?0:Qa.ia,ki=!(Wo|sa)}if(0<wn.L&&(wn.wa[wn.Y+wn.ja]=wn.gd[Ni.$b][Ni.Za],wn.wa[wn.Y+wn.ja].La|=!ki),To.Ka)return Fa(Yi,7,"Premature end-of-file encountered.")}if(ts(Yi),wn=No,To=1,Ni=(Yn=Yi).D,Pi=0<Yn.L&&Yn.M>=Yn.zb&&Yn.M<=Yn.Va,Yn.Aa==0)t:{if(Ni.M=Yn.M,Ni.uc=Pi,ul(Yn,Ni),To=1,Ni=(qi=Yn.D).Nb,Pi=(sa=oc[Yn.L])*Yn.R,da=sa/2*Yn.B,wa=16*Ni*Yn.R,Rs=8*Ni*Yn.B,ki=Yn.sa,kl=Yn.ta-Pi+wa,Qa=Yn.qa,aa=Yn.ra-da+Rs,ys=Yn.Ha,ks=Yn.Ia-da+Rs,Lo=(Sa=qi.M)==0,Wo=Sa>=Yn.Va-1,Yn.Aa==2&&ul(Yn,qi),qi.uc)for($a=(Sn=Yn).D.M,e(Sn.D.uc),qi=Sn.yb;qi<Sn.Hb;++qi){Go=qi,Tn=$a;var eo=(Rl=(is=Sn).D).Nb;Co=is.R;var Rl=Rl.wa[Rl.Y+Go],Yl=is.sa,Zl=is.ta+16*eo*Co+16*Go,gu=Rl.dd,Ea=Rl.tc;if(Ea!=0)if(e(3<=Ea),is.L==1)0<Go&&Fn(Yl,Zl,Co,Ea+4),Rl.La&&na(Yl,Zl,Co,Ea),0<Tn&&Xn(Yl,Zl,Co,Ea+4),Rl.La&&En(Yl,Zl,Co,Ea);else{var ia=is.B,pa=is.qa,mu=is.ra+8*eo*ia+8*Go,yu=is.Ha,is=is.Ia+8*eo*ia+8*Go;eo=Rl.ld,0<Go&&(tt(Yl,Zl,Co,Ea+4,gu,eo),rr(pa,mu,yu,is,ia,Ea+4,gu,eo)),Rl.La&&(qr(Yl,Zl,Co,Ea,gu,eo),Dn(pa,mu,yu,is,ia,Ea,gu,eo)),0<Tn&&(Oe(Yl,Zl,Co,Ea+4,gu,eo),ht(pa,mu,yu,is,ia,Ea+4,gu,eo)),Rl.La&&(ur(Yl,Zl,Co,Ea,gu,eo),bn(pa,mu,yu,is,ia,Ea,gu,eo))}}if(Yn.ia&&alert("todo:DitherRow"),wn.put!=null){if(qi=16*Sa,Sa=16*(Sa+1),Lo?(wn.y=Yn.sa,wn.O=Yn.ta+wa,wn.f=Yn.qa,wn.N=Yn.ra+Rs,wn.ea=Yn.Ha,wn.W=Yn.Ia+Rs):(qi-=sa,wn.y=ki,wn.O=kl,wn.f=Qa,wn.N=aa,wn.ea=ys,wn.W=ks),Wo||(Sa-=sa),Sa>wn.o&&(Sa=wn.o),wn.F=null,wn.J=null,Yn.Fa!=null&&0<Yn.Fa.length&&qi<Sa&&(wn.J=za(Yn,wn,qi,Sa-qi),wn.F=Yn.mb,wn.F==null&&wn.F.length==0)){To=Fa(Yn,3,"Could not decode alpha data.");break t}qi<wn.j&&(sa=wn.j-qi,qi=wn.j,e(!(1&sa)),wn.O+=Yn.R*sa,wn.N+=Yn.B*(sa>>1),wn.W+=Yn.B*(sa>>1),wn.F!=null&&(wn.J+=wn.width*sa)),qi<Sa&&(wn.O+=wn.v,wn.N+=wn.v>>1,wn.W+=wn.v>>1,wn.F!=null&&(wn.J+=wn.v),wn.ka=qi-wn.j,wn.U=wn.va-wn.v,wn.T=Sa-qi,To=wn.put(wn))}Ni+1!=Yn.Ic||Wo||(n(Yn.sa,Yn.ta-Pi,ki,kl+16*Yn.R,Pi),n(Yn.qa,Yn.ra-da,Qa,aa+8*Yn.B,da),n(Yn.Ha,Yn.Ia-da,ys,ks+8*Yn.B,da))}if(!To)return Fa(Yi,6,"Output aborted.")}return 1})(St,Pt)),Pt.bc!=null&&Pt.bc(Pt),hr&=1}return hr?(St.cb=0,hr):0})(q,Pe)||(K=q.a)}}else K=q.a}K==0&&it.Oa!=null&&it.Oa.fd&&(K=mo(it.ba))}it=K}Je=it!=0?null:11>Je?lt.f.RGBA.eb:lt.f.kb.y}else Je=null;return Je};var Bu=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(X,ae){for(var Q="",W=0;W<4;W++)Q+=String.fromCharCode(X[ae++]);return Q}function d(X,ae){return X[ae+0]|X[ae+1]<<8}function m(X,ae){return(X[ae+0]|X[ae+1]<<8|X[ae+2]<<16)>>>0}function b(X,ae){return(X[ae+0]|X[ae+1]<<8|X[ae+2]<<16|X[ae+3]<<24)>>>0}new c;var x=[0],E=[0],T=[],A=new c,M=t,F=(function(X,ae){var Q={},W=0,oe=!1,se=0,he=0;if(Q.frames=[],!(function(de,Ee){for(var we=0;we<4;we++)if(de[Ee+we]!="RIFF".charCodeAt(we))return!0;return!1})(X,ae)){for(b(X,ae+=4),ae+=8;ae<X.length;){var _e=h(X,ae),Ce=b(X,ae+=4);ae+=4;var me=Ce+(1&Ce);switch(_e){case"VP8 ":case"VP8L":Q.frames[W]===void 0&&(Q.frames[W]={}),(De=Q.frames[W]).src_off=oe?he:ae-8,De.src_size=se+Ce+8,W++,oe&&(oe=!1,se=0,he=0);break;case"VP8X":(De=Q.header={}).feature_flags=X[ae];var xe=ae+4;De.canvas_width=1+m(X,xe),xe+=3,De.canvas_height=1+m(X,xe),xe+=3;break;case"ALPH":oe=!0,se=me+8,he=ae-8;break;case"ANIM":(De=Q.header).bgcolor=b(X,ae),xe=ae+4,De.loop_count=d(X,xe),xe+=2;break;case"ANMF":var Ae,De;(De=Q.frames[W]={}).offset_x=2*m(X,ae),ae+=3,De.offset_y=2*m(X,ae),ae+=3,De.width=1+m(X,ae),ae+=3,De.height=1+m(X,ae),ae+=3,De.duration=m(X,ae),ae+=3,Ae=X[ae++],De.dispose=1&Ae,De.blend=Ae>>1&1}_e!="ANMF"&&(ae+=me)}return Q}})(M,0);F.response=M,F.rgbaoutput=!0,F.dataurl=!1;var N=F.header?F.header:null,O=F.frames?F.frames:null;if(N){N.loop_counter=N.loop_count,x=[N.canvas_height],E=[N.canvas_width];for(var U=0;U<O.length&&O[U].blend!=0;U++);}var j=O[0],H=A.WebPDecodeRGBA(M,j.src_off,j.src_size,E,x);j.rgba=H,j.imgwidth=E[0],j.imgheight=x[0];for(var G=0;G<E[0]*x[0]*4;G++)T[G]=H[G];return this.width=E,this.height=x,this.data=T,this}(function(t){var e,r,n,i,a,s,o,c,h,d=function(de){return de=de||{},this.isStrokeTransparent=de.isStrokeTransparent||!1,this.strokeOpacity=de.strokeOpacity||1,this.strokeStyle=de.strokeStyle||"#000000",this.fillStyle=de.fillStyle||"#000000",this.isFillTransparent=de.isFillTransparent||!1,this.fillOpacity=de.fillOpacity||1,this.font=de.font||"10px sans-serif",this.textBaseline=de.textBaseline||"alphabetic",this.textAlign=de.textAlign||"left",this.lineWidth=de.lineWidth||1,this.lineJoin=de.lineJoin||"miter",this.lineCap=de.lineCap||"butt",this.path=de.path||[],this.transform=de.transform!==void 0?de.transform.clone():new c,this.globalCompositeOperation=de.globalCompositeOperation||"normal",this.globalAlpha=de.globalAlpha||1,this.clip_path=de.clip_path||[],this.currentPoint=de.currentPoint||new s,this.miterLimit=de.miterLimit||10,this.lastPoint=de.lastPoint||new s,this.lineDashOffset=de.lineDashOffset||0,this.lineDash=de.lineDash||[],this.margin=de.margin||[0,0,0,0],this.prevPageLastElemOffset=de.prevPageLastElemOffset||0,this.ignoreClearRect=typeof de.ignoreClearRect!="boolean"||de.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new m(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,h=new d}]);var m=function(de){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Ee=de;Object.defineProperty(this,"pdf",{get:function(){return Ee}});var we=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return we},set:function(st){we=!!st}});var Le=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Le},set:function(st){Le=!!st}});var Fe=0;Object.defineProperty(this,"posX",{get:function(){return Fe},set:function(st){isNaN(st)||(Fe=st)}});var Xe=0;Object.defineProperty(this,"posY",{get:function(){return Xe},set:function(st){isNaN(st)||(Xe=st)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(st){var $e;typeof st=="number"?$e=[st,st,st,st]:(($e=new Array(4))[0]=st[0],$e[1]=st.length>=2?st[1]:$e[0],$e[2]=st.length>=3?st[2]:$e[0],$e[3]=st.length>=4?st[3]:$e[1]),h.margin=$e}});var Be=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Be},set:function(st){Be=st}});var ot=0;Object.defineProperty(this,"lastBreak",{get:function(){return ot},set:function(st){ot=st}});var Qe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Qe},set:function(st){Qe=st}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(st){st instanceof d&&(h=st)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(st){h.path=st}});var rt=[];Object.defineProperty(this,"ctxStack",{get:function(){return rt},set:function(st){rt=st}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(st){var $e;$e=b(st),this.ctx.fillStyle=$e.style,this.ctx.isFillTransparent=$e.a===0,this.ctx.fillOpacity=$e.a,this.pdf.setFillColor($e.r,$e.g,$e.b,{a:$e.a}),this.pdf.setTextColor($e.r,$e.g,$e.b,{a:$e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(st){var $e=b(st);this.ctx.strokeStyle=$e.style,this.ctx.isStrokeTransparent=$e.a===0,this.ctx.strokeOpacity=$e.a,$e.a===0?this.pdf.setDrawColor(255,255,255):($e.a,this.pdf.setDrawColor($e.r,$e.g,$e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(st){["butt","round","square"].indexOf(st)!==-1&&(this.ctx.lineCap=st,this.pdf.setLineCap(st))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(st){isNaN(st)||(this.ctx.lineWidth=st,this.pdf.setLineWidth(st))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(st){["bevel","round","miter"].indexOf(st)!==-1&&(this.ctx.lineJoin=st,this.pdf.setLineJoin(st))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(st){isNaN(st)||(this.ctx.miterLimit=st,this.pdf.setMiterLimit(st))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(st){this.ctx.textBaseline=st}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(st){["right","end","center","left","start"].indexOf(st)!==-1&&(this.ctx.textAlign=st)}});var Re=null,zt=null;Object.defineProperty(this,"fontFaces",{get:function(){return zt},set:function(st){Re=null,zt=st}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(st){var $e;if(this.ctx.font=st,($e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(st))!==null){var Jt=$e[1];$e[2];var Ht=$e[3],pr=$e[4];$e[5];var _t=$e[6],vr=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(pr)[2];pr=Math.floor(vr==="px"?parseFloat(pr)*this.pdf.internal.scaleFactor:vr==="em"?parseFloat(pr)*this.pdf.getFontSize():parseFloat(pr)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(pr);var br=(function(qe){var We,Lt,Et=[],mt=qe.trim();if(mt==="")return zA;if(mt in p9)return[p9[mt]];for(;mt!=="";){switch(Lt=null,We=(mt=m9(mt)).charAt(0)){case'"':case"'":Lt=K0e(mt.substring(1),We);break;default:Lt=J0e(mt)}if(Lt===null||(Et.push(Lt[0]),(mt=m9(Lt[1]))!==""&&mt.charAt(0)!==","))return zA;mt=mt.replace(/^,/,"")}return Et})(_t);if(this.fontFaces){var lr=(function(qe,We){if(Re===null){var Lt=(function(Et){var mt=[];return Object.keys(Et).forEach(function(ct){Et[ct].forEach(function(Kt){var qt=null;switch(Kt){case"bold":qt={family:ct,weight:"bold"};break;case"italic":qt={family:ct,style:"italic"};break;case"bolditalic":qt={family:ct,weight:"bold",style:"italic"};break;case"":case"normal":qt={family:ct}}qt!==null&&(qt.ref={name:ct,style:Kt},mt.push(qt))})}),mt})(qe.getFontList());Re=(function(Et){for(var mt={},ct=0;ct<Et.length;++ct){var Kt=BA(Et[ct]),qt=Kt.family,Ir=Kt.stretch,Ar=Kt.style,$r=Kt.weight;mt[qt]=mt[qt]||{},mt[qt][Ir]=mt[qt][Ir]||{},mt[qt][Ir][Ar]=mt[qt][Ir][Ar]||{},mt[qt][Ir][Ar][$r]=Kt}return mt})(Lt.concat(We))}return Re})(this.pdf,this.fontFaces),Cr=br.map(function(qe){return{family:qe,stretch:"normal",weight:Ht,style:Jt}}),Tr=(function(qe,We,Lt){for(var Et=(Lt=Lt||{}).defaultFontFamily||"times",mt=Object.assign({},Z0e,Lt.genericFontFamilies||{}),ct=null,Kt=null,qt=0;qt<We.length;++qt)if(mt[(ct=BA(We[qt])).family]&&(ct.family=mt[ct.family]),qe.hasOwnProperty(ct.family)){Kt=qe[ct.family];break}if(!(Kt=Kt||qe[Et]))throw new Error("Could not find a font-family for the rule '"+g9(ct)+"' and default family '"+Et+"'.");if(Kt=(function(Ir,Ar){if(Ar[Ir])return Ar[Ir];var $r=tR[Ir],hn=$r<=tR.normal?-1:1,zr=d9(Ar,hZ,$r,hn);if(!zr)throw new Error("Could not find a matching font-stretch value for "+Ir);return zr})(ct.stretch,Kt),Kt=(function(Ir,Ar){if(Ar[Ir])return Ar[Ir];for(var $r=cZ[Ir],hn=0;hn<$r.length;++hn)if(Ar[$r[hn]])return Ar[$r[hn]];throw new Error("Could not find a matching font-style for "+Ir)})(ct.style,Kt),!(Kt=(function(Ir,Ar){if(Ar[Ir])return Ar[Ir];if(Ir===400&&Ar[500])return Ar[500];if(Ir===500&&Ar[400])return Ar[400];var $r=Y0e[Ir],hn=d9(Ar,fZ,$r,Ir<400?-1:1);if(!hn)throw new Error("Could not find a matching font-weight for value "+Ir);return hn})(ct.weight,Kt)))throw new Error("Failed to resolve a font for the rule '"+g9(ct)+"'.");return Kt})(lr,Cr);this.pdf.setFont(Tr.ref.name,Tr.ref.style)}else{var Qt="";(Ht==="bold"||parseInt(Ht,10)>=700||Jt==="bold")&&(Qt="bold"),Jt==="italic"&&(Qt+="italic"),Qt.length===0&&(Qt="normal");for(var at="",ke={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},be=0;be<br.length;be++){if(this.pdf.internal.getFont(br[be],Qt,{noFallback:!0,disableWarning:!0})!==void 0){at=br[be];break}if(Qt==="bolditalic"&&this.pdf.internal.getFont(br[be],"bold",{noFallback:!0,disableWarning:!0})!==void 0)at=br[be],Qt="bold";else if(this.pdf.internal.getFont(br[be],"normal",{noFallback:!0,disableWarning:!0})!==void 0){at=br[be],Qt="normal";break}}if(at===""){for(var je=0;je<br.length;je++)if(ke[br[je]]){at=ke[br[je]];break}}at=at===""?"Times":at,this.pdf.setFont(at,Qt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(st){this.ctx.globalCompositeOperation=st}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(st){this.ctx.globalAlpha=st}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(st){this.ctx.lineDashOffset=st,De.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(st){this.ctx.lineDash=st,De.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(st){this.ctx.ignoreClearRect=!!st}})};m.prototype.setLineDash=function(de){this.lineDash=de},m.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},m.prototype.fill=function(){O.call(this,"fill",!1)},m.prototype.stroke=function(){O.call(this,"stroke",!1)},m.prototype.beginPath=function(){this.path=[{type:"begin"}]},m.prototype.moveTo=function(de,Ee){if(isNaN(de)||isNaN(Ee))throw Ro.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var we=this.ctx.transform.applyToPoint(new s(de,Ee));this.path.push({type:"mt",x:we.x,y:we.y}),this.ctx.lastPoint=new s(de,Ee)},m.prototype.closePath=function(){var de=new s(0,0),Ee=0;for(Ee=this.path.length-1;Ee!==-1;Ee--)if(this.path[Ee].type==="begin"&&fo(this.path[Ee+1])==="object"&&typeof this.path[Ee+1].x=="number"){de=new s(this.path[Ee+1].x,this.path[Ee+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(de.x,de.y)},m.prototype.lineTo=function(de,Ee){if(isNaN(de)||isNaN(Ee))throw Ro.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var we=this.ctx.transform.applyToPoint(new s(de,Ee));this.path.push({type:"lt",x:we.x,y:we.y}),this.ctx.lastPoint=new s(we.x,we.y)},m.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),O.call(this,null,!0)},m.prototype.quadraticCurveTo=function(de,Ee,we,Le){if(isNaN(we)||isNaN(Le)||isNaN(de)||isNaN(Ee))throw Ro.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Fe=this.ctx.transform.applyToPoint(new s(we,Le)),Xe=this.ctx.transform.applyToPoint(new s(de,Ee));this.path.push({type:"qct",x1:Xe.x,y1:Xe.y,x:Fe.x,y:Fe.y}),this.ctx.lastPoint=new s(Fe.x,Fe.y)},m.prototype.bezierCurveTo=function(de,Ee,we,Le,Fe,Xe){if(isNaN(Fe)||isNaN(Xe)||isNaN(de)||isNaN(Ee)||isNaN(we)||isNaN(Le))throw Ro.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Be=this.ctx.transform.applyToPoint(new s(Fe,Xe)),ot=this.ctx.transform.applyToPoint(new s(de,Ee)),Qe=this.ctx.transform.applyToPoint(new s(we,Le));this.path.push({type:"bct",x1:ot.x,y1:ot.y,x2:Qe.x,y2:Qe.y,x:Be.x,y:Be.y}),this.ctx.lastPoint=new s(Be.x,Be.y)},m.prototype.arc=function(de,Ee,we,Le,Fe,Xe){if(isNaN(de)||isNaN(Ee)||isNaN(we)||isNaN(Le)||isNaN(Fe))throw Ro.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Xe=!!Xe,!this.ctx.transform.isIdentity){var Be=this.ctx.transform.applyToPoint(new s(de,Ee));de=Be.x,Ee=Be.y;var ot=this.ctx.transform.applyToPoint(new s(0,we)),Qe=this.ctx.transform.applyToPoint(new s(0,0));we=Math.sqrt(Math.pow(ot.x-Qe.x,2)+Math.pow(ot.y-Qe.y,2))}Math.abs(Fe-Le)>=2*Math.PI&&(Le=0,Fe=2*Math.PI),this.path.push({type:"arc",x:de,y:Ee,radius:we,startAngle:Le,endAngle:Fe,counterclockwise:Xe})},m.prototype.arcTo=function(de,Ee,we,Le,Fe){throw new Error("arcTo not implemented.")},m.prototype.rect=function(de,Ee,we,Le){if(isNaN(de)||isNaN(Ee)||isNaN(we)||isNaN(Le))throw Ro.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(de,Ee),this.lineTo(de+we,Ee),this.lineTo(de+we,Ee+Le),this.lineTo(de,Ee+Le),this.lineTo(de,Ee),this.lineTo(de+we,Ee),this.lineTo(de,Ee)},m.prototype.fillRect=function(de,Ee,we,Le){if(isNaN(de)||isNaN(Ee)||isNaN(we)||isNaN(Le))throw Ro.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!x.call(this)){var Fe={};this.lineCap!=="butt"&&(Fe.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Fe.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(de,Ee,we,Le),this.fill(),Fe.hasOwnProperty("lineCap")&&(this.lineCap=Fe.lineCap),Fe.hasOwnProperty("lineJoin")&&(this.lineJoin=Fe.lineJoin)}},m.prototype.strokeRect=function(de,Ee,we,Le){if(isNaN(de)||isNaN(Ee)||isNaN(we)||isNaN(Le))throw Ro.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");E.call(this)||(this.beginPath(),this.rect(de,Ee,we,Le),this.stroke())},m.prototype.clearRect=function(de,Ee,we,Le){if(isNaN(de)||isNaN(Ee)||isNaN(we)||isNaN(Le))throw Ro.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(de,Ee,we,Le))},m.prototype.save=function(de){de=typeof de!="boolean"||de;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,we=0;we<this.pdf.internal.getNumberOfPages();we++)this.pdf.setPage(we+1),this.pdf.internal.out("q");if(this.pdf.setPage(Ee),de){this.ctx.fontSize=this.pdf.internal.getFontSize();var Le=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Le}},m.prototype.restore=function(de){de=typeof de!="boolean"||de;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,we=0;we<this.pdf.internal.getNumberOfPages();we++)this.pdf.setPage(we+1),this.pdf.internal.out("Q");this.pdf.setPage(Ee),de&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},m.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var b=function(de){var Ee,we,Le,Fe;if(de.isCanvasGradient===!0&&(de=de.getColor()),!de)return{r:0,g:0,b:0,a:0,style:de};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(de))Ee=0,we=0,Le=0,Fe=0;else{var Xe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(de);if(Xe!==null)Ee=parseInt(Xe[1]),we=parseInt(Xe[2]),Le=parseInt(Xe[3]),Fe=1;else if((Xe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(de))!==null)Ee=parseInt(Xe[1]),we=parseInt(Xe[2]),Le=parseInt(Xe[3]),Fe=parseFloat(Xe[4]);else{if(Fe=1,typeof de=="string"&&de.charAt(0)!=="#"){var Be=new nZ(de);de=Be.ok?Be.toHex():"#000000"}de.length===4?(Ee=de.substring(1,2),Ee+=Ee,we=de.substring(2,3),we+=we,Le=de.substring(3,4),Le+=Le):(Ee=de.substring(1,3),we=de.substring(3,5),Le=de.substring(5,7)),Ee=parseInt(Ee,16),we=parseInt(we,16),Le=parseInt(Le,16)}}return{r:Ee,g:we,b:Le,a:Fe,style:de}},x=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},E=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};m.prototype.fillText=function(de,Ee,we,Le){if(isNaN(Ee)||isNaN(we)||typeof de!="string")throw Ro.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Le=isNaN(Le)?void 0:Le,!x.call(this)){var Fe=me(this.ctx.transform.rotation),Xe=this.ctx.transform.scaleX;W.call(this,{text:de,x:Ee,y:we,scale:Xe,angle:Fe,align:this.textAlign,maxWidth:Le})}},m.prototype.strokeText=function(de,Ee,we,Le){if(isNaN(Ee)||isNaN(we)||typeof de!="string")throw Ro.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!E.call(this)){Le=isNaN(Le)?void 0:Le;var Fe=me(this.ctx.transform.rotation),Xe=this.ctx.transform.scaleX;W.call(this,{text:de,x:Ee,y:we,scale:Xe,renderingMode:"stroke",angle:Fe,align:this.textAlign,maxWidth:Le})}},m.prototype.measureText=function(de){if(typeof de!="string")throw Ro.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Ee=this.pdf,we=this.pdf.internal.scaleFactor,Le=Ee.internal.getFontSize(),Fe=Ee.getStringUnitWidth(de)*Le/Ee.internal.scaleFactor;return new function(Xe){var Be=(Xe=Xe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Be}}),this}({width:Fe*=Math.round(96*we/72*1e4)/1e4})},m.prototype.scale=function(de,Ee){if(isNaN(de)||isNaN(Ee))throw Ro.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var we=new c(de,0,0,Ee,0,0);this.ctx.transform=this.ctx.transform.multiply(we)},m.prototype.rotate=function(de){if(isNaN(de))throw Ro.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Ee=new c(Math.cos(de),Math.sin(de),-Math.sin(de),Math.cos(de),0,0);this.ctx.transform=this.ctx.transform.multiply(Ee)},m.prototype.translate=function(de,Ee){if(isNaN(de)||isNaN(Ee))throw Ro.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var we=new c(1,0,0,1,de,Ee);this.ctx.transform=this.ctx.transform.multiply(we)},m.prototype.transform=function(de,Ee,we,Le,Fe,Xe){if(isNaN(de)||isNaN(Ee)||isNaN(we)||isNaN(Le)||isNaN(Fe)||isNaN(Xe))throw Ro.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Be=new c(de,Ee,we,Le,Fe,Xe);this.ctx.transform=this.ctx.transform.multiply(Be)},m.prototype.setTransform=function(de,Ee,we,Le,Fe,Xe){de=isNaN(de)?1:de,Ee=isNaN(Ee)?0:Ee,we=isNaN(we)?0:we,Le=isNaN(Le)?1:Le,Fe=isNaN(Fe)?0:Fe,Xe=isNaN(Xe)?0:Xe,this.ctx.transform=new c(de,Ee,we,Le,Fe,Xe)};var T=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};m.prototype.drawImage=function(de,Ee,we,Le,Fe,Xe,Be,ot,Qe){var rt=this.pdf.getImageProperties(de),Re=1,zt=1,st=1,$e=1;Le!==void 0&&ot!==void 0&&(st=ot/Le,$e=Qe/Fe,Re=rt.width/Le*ot/Le,zt=rt.height/Fe*Qe/Fe),Xe===void 0&&(Xe=Ee,Be=we,Ee=0,we=0),Le!==void 0&&ot===void 0&&(ot=Le,Qe=Fe),Le===void 0&&ot===void 0&&(ot=rt.width,Qe=rt.height);for(var Jt,Ht=this.ctx.transform.decompose(),pr=me(Ht.rotate.shx),_t=new c,vr=(_t=(_t=(_t=_t.multiply(Ht.translate)).multiply(Ht.skew)).multiply(Ht.scale)).applyToRectangle(new o(Xe-Ee*st,Be-we*$e,Le*Re,Fe*zt)),br=A.call(this,vr),lr=[],Cr=0;Cr<br.length;Cr+=1)lr.indexOf(br[Cr])===-1&&lr.push(br[Cr]);if(N(lr),this.autoPaging)for(var Tr=lr[0],Qt=lr[lr.length-1],at=Tr;at<Qt+1;at++){this.pdf.setPage(at);var ke=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],be=at===1?this.posY+this.margin[0]:this.margin[0],je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],We=at===1?0:je+(at-2)*qe;if(this.ctx.clip_path.length!==0){var Lt=this.path;Jt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=F(Jt,this.posX+this.margin[3],-We+be+this.ctx.prevPageLastElemOffset),U.call(this,"fill",!0),this.path=Lt}var Et=JSON.parse(JSON.stringify(vr));Et=F([Et],this.posX+this.margin[3],-We+be+this.ctx.prevPageLastElemOffset)[0];var mt=(at>Tr||at<Qt)&&T.call(this);mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ke,qe,null).clip().discardPath()),this.pdf.addImage(de,"JPEG",Et.x,Et.y,Et.w,Et.h,null,null,pr),mt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(de,"JPEG",vr.x,vr.y,vr.w,vr.h,null,null,pr)};var A=function(de,Ee,we){var Le=[];Ee=Ee||this.pdf.internal.pageSize.width,we=we||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Fe=this.posY+this.ctx.prevPageLastElemOffset;switch(de.type){default:case"mt":case"lt":Le.push(Math.floor((de.y+Fe)/we)+1);break;case"arc":Le.push(Math.floor((de.y+Fe-de.radius)/we)+1),Le.push(Math.floor((de.y+Fe+de.radius)/we)+1);break;case"qct":var Xe=xe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,de.x1,de.y1,de.x,de.y);Le.push(Math.floor((Xe.y+Fe)/we)+1),Le.push(Math.floor((Xe.y+Xe.h+Fe)/we)+1);break;case"bct":var Be=Ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,de.x1,de.y1,de.x2,de.y2,de.x,de.y);Le.push(Math.floor((Be.y+Fe)/we)+1),Le.push(Math.floor((Be.y+Be.h+Fe)/we)+1);break;case"rect":Le.push(Math.floor((de.y+Fe)/we)+1),Le.push(Math.floor((de.y+de.h+Fe)/we)+1)}for(var ot=0;ot<Le.length;ot+=1)for(;this.pdf.internal.getNumberOfPages()<Le[ot];)M.call(this);return Le},M=function(){var de=this.fillStyle,Ee=this.strokeStyle,we=this.font,Le=this.lineCap,Fe=this.lineWidth,Xe=this.lineJoin;this.pdf.addPage(),this.fillStyle=de,this.strokeStyle=Ee,this.font=we,this.lineCap=Le,this.lineWidth=Fe,this.lineJoin=Xe},F=function(de,Ee,we){for(var Le=0;Le<de.length;Le++)switch(de[Le].type){case"bct":de[Le].x2+=Ee,de[Le].y2+=we;case"qct":de[Le].x1+=Ee,de[Le].y1+=we;default:de[Le].x+=Ee,de[Le].y+=we}return de},N=function(de){return de.sort(function(Ee,we){return Ee-we})},O=function(de,Ee){for(var we,Le,Fe=this.fillStyle,Xe=this.strokeStyle,Be=this.lineCap,ot=this.lineWidth,Qe=Math.abs(ot*this.ctx.transform.scaleX),rt=this.lineJoin,Re=JSON.parse(JSON.stringify(this.path)),zt=JSON.parse(JSON.stringify(this.path)),st=[],$e=0;$e<zt.length;$e++)if(zt[$e].x!==void 0)for(var Jt=A.call(this,zt[$e]),Ht=0;Ht<Jt.length;Ht+=1)st.indexOf(Jt[Ht])===-1&&st.push(Jt[Ht]);for(var pr=0;pr<st.length;pr++)for(;this.pdf.internal.getNumberOfPages()<st[pr];)M.call(this);if(N(st),this.autoPaging)for(var _t=st[0],vr=st[st.length-1],br=_t;br<vr+1;br++){this.pdf.setPage(br),this.fillStyle=Fe,this.strokeStyle=Xe,this.lineCap=Be,this.lineWidth=Qe,this.lineJoin=rt;var lr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Cr=br===1?this.posY+this.margin[0]:this.margin[0],Tr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],at=br===1?0:Tr+(br-2)*Qt;if(this.ctx.clip_path.length!==0){var ke=this.path;we=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=F(we,this.posX+this.margin[3],-at+Cr+this.ctx.prevPageLastElemOffset),U.call(this,de,!0),this.path=ke}if(Le=JSON.parse(JSON.stringify(Re)),this.path=F(Le,this.posX+this.margin[3],-at+Cr+this.ctx.prevPageLastElemOffset),Ee===!1||br===0){var be=(br>_t||br<vr)&&T.call(this);be&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lr,Qt,null).clip().discardPath()),U.call(this,de,Ee),be&&this.pdf.restoreGraphicsState()}this.lineWidth=ot}else this.lineWidth=Qe,U.call(this,de,Ee),this.lineWidth=ot;this.path=Re},U=function(de,Ee){if((de!=="stroke"||Ee||!E.call(this))&&(de==="stroke"||Ee||!x.call(this))){for(var we,Le,Fe=[],Xe=this.path,Be=0;Be<Xe.length;Be++){var ot=Xe[Be];switch(ot.type){case"begin":Fe.push({begin:!0});break;case"close":Fe.push({close:!0});break;case"mt":Fe.push({start:ot,deltas:[],abs:[]});break;case"lt":var Qe=Fe.length;if(Xe[Be-1]&&!isNaN(Xe[Be-1].x)&&(we=[ot.x-Xe[Be-1].x,ot.y-Xe[Be-1].y],Qe>0)){for(;Qe>=0;Qe--)if(Fe[Qe-1].close!==!0&&Fe[Qe-1].begin!==!0){Fe[Qe-1].deltas.push(we),Fe[Qe-1].abs.push(ot);break}}break;case"bct":we=[ot.x1-Xe[Be-1].x,ot.y1-Xe[Be-1].y,ot.x2-Xe[Be-1].x,ot.y2-Xe[Be-1].y,ot.x-Xe[Be-1].x,ot.y-Xe[Be-1].y],Fe[Fe.length-1].deltas.push(we);break;case"qct":var rt=Xe[Be-1].x+2/3*(ot.x1-Xe[Be-1].x),Re=Xe[Be-1].y+2/3*(ot.y1-Xe[Be-1].y),zt=ot.x+2/3*(ot.x1-ot.x),st=ot.y+2/3*(ot.y1-ot.y),$e=ot.x,Jt=ot.y;we=[rt-Xe[Be-1].x,Re-Xe[Be-1].y,zt-Xe[Be-1].x,st-Xe[Be-1].y,$e-Xe[Be-1].x,Jt-Xe[Be-1].y],Fe[Fe.length-1].deltas.push(we);break;case"arc":Fe.push({deltas:[],abs:[],arc:!0}),Array.isArray(Fe[Fe.length-1].abs)&&Fe[Fe.length-1].abs.push(ot)}}Le=Ee?null:de==="stroke"?"stroke":"fill";for(var Ht=!1,pr=0;pr<Fe.length;pr++)if(Fe[pr].arc)for(var _t=Fe[pr].abs,vr=0;vr<_t.length;vr++){var br=_t[vr];br.type==="arc"?G.call(this,br.x,br.y,br.radius,br.startAngle,br.endAngle,br.counterclockwise,void 0,Ee,!Ht):oe.call(this,br.x,br.y),Ht=!0}else if(Fe[pr].close===!0)this.pdf.internal.out("h"),Ht=!1;else if(Fe[pr].begin!==!0){var lr=Fe[pr].start.x,Cr=Fe[pr].start.y;se.call(this,Fe[pr].deltas,lr,Cr),Ht=!0}Le&&X.call(this,Le),Ee&&ae.call(this)}},j=function(de){var Ee=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,we=Ee*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return de-we;case"top":return de+Ee-we;case"hanging":return de+Ee-2*we;case"middle":return de+Ee/2-we;default:return de}},H=function(de){return de+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};m.prototype.createLinearGradient=function(){var de=function(){};return de.colorStops=[],de.addColorStop=function(Ee,we){this.colorStops.push([Ee,we])},de.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},de.isCanvasGradient=!0,de},m.prototype.createPattern=function(){return this.createLinearGradient()},m.prototype.createRadialGradient=function(){return this.createLinearGradient()};var G=function(de,Ee,we,Le,Fe,Xe,Be,ot,Qe){for(var rt=_e.call(this,we,Le,Fe,Xe),Re=0;Re<rt.length;Re++){var zt=rt[Re];Re===0&&(Qe?Q.call(this,zt.x1+de,zt.y1+Ee):oe.call(this,zt.x1+de,zt.y1+Ee)),he.call(this,de,Ee,zt.x2,zt.y2,zt.x3,zt.y3,zt.x4,zt.y4)}ot?ae.call(this):X.call(this,Be)},X=function(de){switch(de){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ae=function(){this.pdf.clip(),this.pdf.discardPath()},Q=function(de,Ee){this.pdf.internal.out(r(de)+" "+n(Ee)+" m")},W=function(de){var Ee;switch(de.align){case"right":case"end":Ee="right";break;case"center":Ee="center";break;default:Ee="left"}var we=this.pdf.getTextDimensions(de.text),Le=j.call(this,de.y),Fe=H.call(this,Le)-we.h,Xe=this.ctx.transform.applyToPoint(new s(de.x,Le)),Be=this.ctx.transform.decompose(),ot=new c;ot=(ot=(ot=ot.multiply(Be.translate)).multiply(Be.skew)).multiply(Be.scale);for(var Qe,rt,Re,zt=this.ctx.transform.applyToRectangle(new o(de.x,Le,we.w,we.h)),st=ot.applyToRectangle(new o(de.x,Fe,we.w,we.h)),$e=A.call(this,st),Jt=[],Ht=0;Ht<$e.length;Ht+=1)Jt.indexOf($e[Ht])===-1&&Jt.push($e[Ht]);if(N(Jt),this.autoPaging)for(var pr=Jt[0],_t=Jt[Jt.length-1],vr=pr;vr<_t+1;vr++){this.pdf.setPage(vr);var br=vr===1?this.posY+this.margin[0]:this.margin[0],lr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Cr=this.pdf.internal.pageSize.height-this.margin[2],Tr=Cr-this.margin[0],Qt=this.pdf.internal.pageSize.width-this.margin[1],at=Qt-this.margin[3],ke=vr===1?0:lr+(vr-2)*Tr;if(this.ctx.clip_path.length!==0){var be=this.path;Qe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=F(Qe,this.posX+this.margin[3],-1*ke+br),U.call(this,"fill",!0),this.path=be}var je=F([JSON.parse(JSON.stringify(st))],this.posX+this.margin[3],-ke+br+this.ctx.prevPageLastElemOffset)[0];de.scale>=.01&&(rt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(rt*de.scale),Re=this.lineWidth,this.lineWidth=Re*de.scale);var qe=this.autoPaging!=="text";if(qe||je.y+je.h<=Cr){if(qe||je.y>=br&&je.x<=Qt){var We=qe?de.text:this.pdf.splitTextToSize(de.text,de.maxWidth||Qt-je.x)[0],Lt=F([JSON.parse(JSON.stringify(zt))],this.posX+this.margin[3],-ke+br+this.ctx.prevPageLastElemOffset)[0],Et=qe&&(vr>pr||vr<_t)&&T.call(this);Et&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],at,Tr,null).clip().discardPath()),this.pdf.text(We,Lt.x,Lt.y,{angle:de.angle,align:Ee,renderingMode:de.renderingMode}),Et&&this.pdf.restoreGraphicsState()}}else je.y<Cr&&(this.ctx.prevPageLastElemOffset+=Cr-je.y);de.scale>=.01&&(this.pdf.setFontSize(rt),this.lineWidth=Re)}else de.scale>=.01&&(rt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(rt*de.scale),Re=this.lineWidth,this.lineWidth=Re*de.scale),this.pdf.text(de.text,Xe.x+this.posX,Xe.y+this.posY,{angle:de.angle,align:Ee,renderingMode:de.renderingMode,maxWidth:de.maxWidth}),de.scale>=.01&&(this.pdf.setFontSize(rt),this.lineWidth=Re)},oe=function(de,Ee,we,Le){we=we||0,Le=Le||0,this.pdf.internal.out(r(de+we)+" "+n(Ee+Le)+" l")},se=function(de,Ee,we){return this.pdf.lines(de,Ee,we,null,null)},he=function(de,Ee,we,Le,Fe,Xe,Be,ot){this.pdf.internal.out([e(i(we+de)),e(a(Le+Ee)),e(i(Fe+de)),e(a(Xe+Ee)),e(i(Be+de)),e(a(ot+Ee)),"c"].join(" "))},_e=function(de,Ee,we,Le){for(var Fe=2*Math.PI,Xe=Math.PI/2;Ee>we;)Ee-=Fe;var Be=Math.abs(we-Ee);Be<Fe&&Le&&(Be=Fe-Be);for(var ot=[],Qe=Le?-1:1,rt=Ee;Be>1e-5;){var Re=rt+Qe*Math.min(Be,Xe);ot.push(Ce.call(this,de,rt,Re)),Be-=Math.abs(Re-rt),rt=Re}return ot},Ce=function(de,Ee,we){var Le=(we-Ee)/2,Fe=de*Math.cos(Le),Xe=de*Math.sin(Le),Be=Fe,ot=-Xe,Qe=Be*Be+ot*ot,rt=Qe+Be*Fe+ot*Xe,Re=4/3*(Math.sqrt(2*Qe*rt)-rt)/(Be*Xe-ot*Fe),zt=Be-Re*ot,st=ot+Re*Be,$e=zt,Jt=-st,Ht=Le+Ee,pr=Math.cos(Ht),_t=Math.sin(Ht);return{x1:de*Math.cos(Ee),y1:de*Math.sin(Ee),x2:zt*pr-st*_t,y2:zt*_t+st*pr,x3:$e*pr-Jt*_t,y3:$e*_t+Jt*pr,x4:de*Math.cos(we),y4:de*Math.sin(we)}},me=function(de){return 180*de/Math.PI},xe=function(de,Ee,we,Le,Fe,Xe){var Be=de+.5*(we-de),ot=Ee+.5*(Le-Ee),Qe=Fe+.5*(we-Fe),rt=Xe+.5*(Le-Xe),Re=Math.min(de,Fe,Be,Qe),zt=Math.max(de,Fe,Be,Qe),st=Math.min(Ee,Xe,ot,rt),$e=Math.max(Ee,Xe,ot,rt);return new o(Re,st,zt-Re,$e-st)},Ae=function(de,Ee,we,Le,Fe,Xe,Be,ot){var Qe,rt,Re,zt,st,$e,Jt,Ht,pr,_t,vr,br,lr,Cr,Tr=we-de,Qt=Le-Ee,at=Fe-we,ke=Xe-Le,be=Be-Fe,je=ot-Xe;for(rt=0;rt<41;rt++)pr=(Jt=(Re=de+(Qe=rt/40)*Tr)+Qe*((st=we+Qe*at)-Re))+Qe*(st+Qe*(Fe+Qe*be-st)-Jt),_t=(Ht=(zt=Ee+Qe*Qt)+Qe*(($e=Le+Qe*ke)-zt))+Qe*($e+Qe*(Xe+Qe*je-$e)-Ht),rt==0?(vr=pr,br=_t,lr=pr,Cr=_t):(vr=Math.min(vr,pr),br=Math.min(br,_t),lr=Math.max(lr,pr),Cr=Math.max(Cr,_t));return new o(Math.round(vr),Math.round(br),Math.round(lr-vr),Math.round(Cr-br))},De=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var de,Ee,we=(de=this.ctx.lineDash,Ee=this.ctx.lineDashOffset,JSON.stringify({lineDash:de,lineDashOffset:Ee}));this.prevLineDash!==we&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=we)}}})(di.API),(function(t){var e=function(s){var o,c,h,d,m,b,x,E,T,A;for(c=[],h=0,d=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;d>h;h+=4)(m=(s.charCodeAt(h)<<24)+(s.charCodeAt(h+1)<<16)+(s.charCodeAt(h+2)<<8)+s.charCodeAt(h+3))!==0?(b=(m=((m=((m=((m=(m-(A=m%85))/85)-(T=m%85))/85)-(E=m%85))/85)-(x=m%85))/85)%85,c.push(b+33,x+33,E+33,T+33,A+33)):c.push(122);return(function(M,F){for(var N=F;N>0;N--)M.pop()})(c,o.length),String.fromCharCode.apply(String,c)+"~>"},r=function(s){var o,c,h,d,m,b=String,x="length",E=255,T="charCodeAt",A="slice",M="replace";for(s[A](-2),s=s[A](0,-2)[M](/\s/g,"")[M]("z","!!!!!"),h=[],d=0,m=(s+=o="uuuuu"[A](s[x]%5||5))[x];m>d;d+=5)c=52200625*(s[T](d)-33)+614125*(s[T](d+1)-33)+7225*(s[T](d+2)-33)+85*(s[T](d+3)-33)+(s[T](d+4)-33),h.push(E&c>>24,E&c>>16,E&c>>8,E&c);return(function(F,N){for(var O=N;O>0;O--)F.pop()})(h,o[x]),b.fromCharCode.apply(b,h)},n=function(s){return s.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var c="",h=0;h<s.length;h+=2)c+=String.fromCharCode("0x"+(s[h]+s[h+1]));return c},a=function(s){for(var o=new Uint8Array(s.length),c=s.length;c--;)o[c]=s.charCodeAt(c);return(o=Xk(o)).reduce(function(h,d){return h+String.fromCharCode(d)},"")};t.processDataByFilters=function(s,o){var c=0,h=s||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),c=0;c<o.length;c+=1)switch(o[c]){case"ASCII85Decode":case"/ASCII85Decode":h=r(h),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=e(h),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=i(h),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=n(h),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=a(h),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[c]+'" is not implemented')}return{data:h,reverseChain:d.reverse().join(" ")}}})(di.API),(function(t){t.loadFile=function(e,r,n){return(function(i,a,s){a=a!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=(function(c,h,d){var m=new XMLHttpRequest,b=0,x=function(E){var T=E.length,A=[],M=String.fromCharCode;for(b=0;b<T;b+=1)A.push(M(255&E.charCodeAt(b)));return A.join("")};if(m.open("GET",c,!h),m.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(m.onload=function(){m.status===200?d(x(this.responseText)):d(void 0)}),m.send(null),h&&m.status===200)return x(m.responseText)})(i,a,s)}catch{}return o})(e,r,n)},t.loadImageFile=t.loadFile})(di.API),(function(t){function e(){return(Oi.html2canvas?Promise.resolve(Oi.html2canvas):nb(()=>import("./html2canvas.esm-B0tyYwQk.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Oi.DOMPurify?Promise.resolve(Oi.DOMPurify):nb(()=>import("./purify.es-CQJ0hv7W.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var c=fo(o);return c==="undefined"?"undefined":c==="string"||o instanceof String?"string":c==="number"||o instanceof Number?"number":c==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(o,c){var h=document.createElement(o);for(var d in c.className&&(h.className=c.className),c.innerHTML&&c.dompurify&&(h.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)h.style[d]=c.style[d];return h},a=function o(c,h){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),m=c.firstChild;m;m=m.nextSibling)h!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||d.appendChild(o(m,h));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},s=function o(c){var h=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),h);return(d=d.setProgress(1,o,1,[o])).set(c)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,c){return o.__proto__=c||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,c){return this.then(function(){switch(c=c||(function(h){switch(n(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),c){case"string":return this.then(r).then(function(h){return this.set({src:i("div",{innerHTML:o,dompurify:h})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(c){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,c(this.prop.container,h)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(c){var h=this.opt.jsPDF,d=this.opt.fontFaces,m=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,b=Object.assign({async:!0,allowTaint:!0,scale:m,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete b.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=d,d)for(var x=0;x<d.length;++x){var E=d[x],T=E.src.find(function(A){return A.format==="truetype"});T&&h.addFont(T.url,E.ref.name,E.ref.style)}return b.windowHeight=b.windowHeight||0,b.windowHeight=b.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):b.windowHeight,h.context2d.save(!0),c(this.prop.container,b)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,c,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(o,c):this.outputPdf(o,c)},s.prototype.outputPdf=function(o,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,c)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(n(o)!=="object")return this;var c=Object.keys(o||{}).map(function(h){if(h in s.template.prop)return function(){this.prop[h]=o[h]};switch(h){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[h]=o[h]}}},this);return this.then(function(){return this.thenList(c)})},s.prototype.get=function(o,c){return this.then(function(){var h=o in s.template.prop?this.prop[o]:this.opt[o];return c?c(h):h})},s.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function c(h,d){return Math.floor(h*d/72*96)}return this.then(function(){(o=o||di.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:c(o.inner.width,o.k),height:c(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,c,h,d){return o!=null&&(this.progress.val=o),c!=null&&(this.progress.state=c),h!=null&&(this.progress.n=h),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,c,h,d){return this.setProgress(o?this.progress.val+o:null,c||null,h?this.progress.n+h:null,d?this.progress.stack.concat(d):null)},s.prototype.then=function(o,c){var h=this;return this.thenCore(o,c,function(d,m){return h.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(b){return h.updateProgress(null,d),b}).then(d,m).then(function(b){return h.updateProgress(1),b})})},s.prototype.thenCore=function(o,c,h){h=h||Promise.prototype.then;var d=this;o&&(o=o.bind(d)),c&&(c=c.bind(d));var m=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:s.convert(Object.assign({},d),Promise.prototype),b=h.call(m,o,c);return s.convert(b,d.__proto__)},s.prototype.thenExternal=function(o,c){return Promise.prototype.then.call(this,o,c)},s.prototype.thenList=function(o){var c=this;return o.forEach(function(h){c=c.thenCore(h)}),c},s.prototype.catch=function(o){o&&(o=o.bind(this));var c=Promise.prototype.catch.call(this,o);return s.convert(c,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,di.getPageSize=function(o,c,h){if(fo(o)==="object"){var d=o;o=d.orientation,c=d.unit||c,h=d.format||h}c=c||"mm",h=h||"a4",o=(""+(o||"P")).toLowerCase();var m,b=(""+h).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":m=1;break;case"mm":m=72/25.4;break;case"cm":m=72/2.54;break;case"in":m=72;break;case"px":m=.75;break;case"pc":case"em":m=12;break;case"ex":m=6;break;default:throw"Invalid unit: "+c}var E,T=0,A=0;if(x.hasOwnProperty(b))T=x[b][1]/m,A=x[b][0]/m;else try{T=h[1],A=h[0]}catch{throw new Error("Invalid format: "+h)}if(o==="p"||o==="portrait")o="p",A>T&&(E=A,A=T,T=E);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",T>A&&(E=A,A=T,T=E)}return{width:A,height:T,unit:c,k:m,orientation:o}},t.html=function(o,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(BA):null;var h=new s(c);return c.worker?h:h.from(o).doCallback()}})(di.API),di.API.addJS=function(t){return v9=t,this.internal.events.subscribe("postPutResources",function(){ow=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ow+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),y9=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+v9+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){ow!==void 0&&y9!==void 0&&this.internal.out("/Names <</JavaScript "+ow+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),a=0;a<i.length;a++){var s=i[a],o=n.exec(s);if(o!=null){var c=o[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,d=[];for(a=0;a<h;a++){var m=r.internal.newObject();d.push(m);var b=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+b.objId+" 0 R /XYZ null null null]>> endobj")}var x=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<d.length;a++)r.internal.write("(page_"+(a+1)+")"+d[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+x+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,a){var s={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var s=n.children[a];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var h=0;h<n.children.length;h++)this.renderItems(n.children[h])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])})(di.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,a,s,o){var c,h=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=(function(m){for(var b,x=256*m.charCodeAt(4)+m.charCodeAt(5),E=m.length,T={width:0,height:0,numcomponents:1},A=4;A<E;A+=2){if(A+=x,e.indexOf(m.charCodeAt(A+1))!==-1){b=256*m.charCodeAt(A+5)+m.charCodeAt(A+6),T={width:256*m.charCodeAt(A+7)+m.charCodeAt(A+8),height:b,numcomponents:m.charCodeAt(A+9)};break}x=256*m.charCodeAt(A+2)+m.charCodeAt(A+3)}return T})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:o,bitsPerComponent:8,filter:h,index:n,alias:i}}return d}})(di.API),di.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,a=N0e(t,{checkCrc:!0}),s=a.width,o=a.height,c=a.channels,h=a.palette,d=a.depth;i=h&&c===1?(function(H){for(var G=H.width,X=H.height,ae=H.data,Q=H.palette,W=H.depth,oe=!1,se=[],he=[],_e=void 0,Ce=!1,me=0,xe=0;xe<Q.length;xe++){var Ae=wz(Q[xe],4),De=Ae[0],de=Ae[1],Ee=Ae[2],we=Ae[3];se.push(De,de,Ee),we!=null&&(we===0?(me++,he.length<1&&he.push(xe)):we<255&&(Ce=!0))}if(Ce||me>1){oe=!0,he=void 0;var Le=G*X;_e=new Uint8Array(Le);for(var Fe=new DataView(ae.buffer),Xe=0;Xe<Le;Xe++){var Be=jA(Fe,Xe,W),ot=wz(Q[Be],4)[3];_e[Xe]=ot}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:ae,alphaBytes:_e,needSMask:oe,palette:se,mask:he}})(a):c===2||c===4?(function(H){for(var G=H.data,X=H.width,ae=H.height,Q=H.channels,W=H.depth,oe=Q===2?"DeviceGray":"DeviceRGB",se=Q-1,he=X*ae,_e=se,Ce=he*_e,me=1*he,xe=Math.ceil(Ce*W/8),Ae=Math.ceil(me*W/8),De=new Uint8Array(xe),de=new Uint8Array(Ae),Ee=new DataView(G.buffer),we=new DataView(De.buffer),Le=new DataView(de.buffer),Fe=!1,Xe=0;Xe<he;Xe++){for(var Be=Xe*Q,ot=0;ot<_e;ot++)A9(we,jA(Ee,Be+ot,W),Xe*_e+ot,W);var Qe=jA(Ee,Be+_e,W);Qe<(1<<W)-1&&(Fe=!0),A9(Le,Qe,1*Xe,W)}return{colorSpace:oe,colorsPerPixel:se,colorBytes:De,alphaBytes:de,needSMask:Fe}})(a):(function(H){var G=H.data,X=H.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:X,colorsPerPixel:X==="DeviceGray"?1:3,colorBytes:G instanceof Uint8Array?G:new Uint8Array(G.buffer),needSMask:!1}})(a);var m,b,x,E=i,T=E.colorSpace,A=E.colorsPerPixel,M=E.colorBytes,F=E.alphaBytes,N=E.needSMask,O=E.palette,U=E.mask,j=null;return n!==di.API.image_compression.NONE&&typeof Xk=="function"?(j=(function(H){var G;switch(H){case di.API.image_compression.FAST:G=11;break;case di.API.image_compression.MEDIUM:G=13;break;case di.API.image_compression.SLOW:G=14;break;default:G=12}return G})(n),m=this.decode.FLATE_DECODE,b="/Predictor ".concat(j," "),t=w9(M,s*A,A,n),N&&(x=w9(F,s,1,n))):(m=void 0,b="",t=M,N&&(x=F)),b+="/Colors ".concat(A," /BitsPerComponent ").concat(d," /Columns ").concat(s),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(x&&this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),{alias:r,data:t,index:e,filter:m,decodeParameters:b,transparency:U,palette:O,sMask:x,predictor:j,width:s,height:o,bitsPerComponent:d,colorSpace:T}}},(function(t){t.processGIF89A=function(e,r,n,i){var a=new r_e(e),s=a.width,o=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var h={data:c,width:s,height:o},d=new UA(100).encode(h,100);return t.processJPEG.call(this,d,r,n,i)},t.processGIF87A=t.processGIF89A})(di.API),df.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},df.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Ro.log("bit decode error:"+r)}},df.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var c=this.palette[a>>7-o&1];this.data[s+4*o]=c.blue,this.data[s+4*o+1]=c.green,this.data[s+4*o+2]=c.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},df.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,o=a>>4,c=15&a,h=this.palette[o];if(this.data[s]=h.blue,this.data[s+1]=h.green,this.data[s+2]=h.red,this.data[s+3]=255,2*i+1>=this.width)break;h=this.palette[c],this.data[s+4]=h.blue,this.data[s+4+1]=h.green,this.data[s+4+2]=h.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},df.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[a]=s.red,this.data[a+1]=s.green,this.data[a+2]=s.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},df.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(a&e)/e*255|0,o=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,h=a>>15?255:0,d=n*this.width*4+4*i;this.data[d]=c,this.data[d+1]=o,this.data[d+2]=s,this.data[d+3]=h}this.pos+=t}},df.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,c=(s>>5&r)/r*255|0,h=(s>>11)/e*255|0,d=i*this.width*4+4*a;this.data[d]=h,this.data[d+1]=c,this.data[d+2]=o,this.data[d+3]=255}this.pos+=t}},df.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=a,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},df.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=s}},df.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,n,i){var a=new df(e,!1),s=a.width,o=a.height,c={data:a.getData(),width:s,height:o},h=new UA(100).encode(c,100);return t.processJPEG.call(this,h,r,n,i)}})(di.API),P9.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,n,i){var a=new P9(e),s=a.width,o=a.height,c={data:a.getData(),width:s,height:o},h=new UA(100).encode(c,100);return t.processJPEG.call(this,h,r,n,i)}})(di.API),di.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,a=new Uint8Array(i/4*3),s=new Uint8Array(i/4),o=0,c=0,h=0;h<i;h+=4){var d=n[h],m=n[h+1],b=n[h+2],x=n[h+3];a[o++]=d,a[o++]=m,a[o++]=b,s[c++]=x}var E=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:E,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},di.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},mv=di.API,sw=mv.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:i.metadata.Unicode.widths,c=o.fof?o.fof:1,h=e.kerning?e.kerning:i.metadata.Unicode.kerning,d=h.fof?h.fof:1,m=e.doKerning!==!1,b=0,x=t.length,E=0,T=o[0]||c,A=[];for(r=0;r<x;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?A.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/a)||0)/1e3):(b=m&&fo(h[n])==="object"&&!isNaN(parseInt(h[n][E],10))?h[n][E]/d:0,A.push((o[n]||T)/c+b)),E=n;return A},_9=mv.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return mv.processArabic&&(t=mv.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:sw.apply(this,arguments).reduce(function(a,s){return a+s},0)},b9=function(t,e,r,n){for(var i=[],a=0,s=t.length,o=0;a!==s&&o+e[a]<r;)o+=e[a],a++;i.push(t.slice(0,a));var c=a;for(o=0;a!==s;)o+e[a]>n&&(i.push(t.slice(c,a)),o=0,c=a),o+=e[a],a++;return c!==a&&i.push(t.slice(c,a)),i},x9=function(t,e,r){r||(r={});var n,i,a,s,o,c,h,d=[],m=[d],b=r.textIndent||0,x=0,E=0,T=t.split(" "),A=sw.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?T[0].length+2:r.lineIndent||0){var M=Array(c).join(" "),F=[];T.map(function(O){(O=O.split(/\s*\n/)).length>1?F=F.concat(O.map(function(U,j){return(j&&U.length?`
`:"")+U})):F.push(O[0])}),T=F,c=_9.apply(this,[M,r])}for(a=0,s=T.length;a<s;a++){var N=0;if(n=T[a],c&&n[0]==`
`&&(n=n.substr(1),N=1),b+x+(E=(i=sw.apply(this,[n,r])).reduce(function(O,U){return O+U},0))>e||N){if(E>e){for(o=b9.apply(this,[n,i,e-(b+x),e]),d.push(o.shift()),d=[o.pop()];o.length;)m.push([o.shift()]);E=i.slice(n.length-(d[0]?d[0].length:0)).reduce(function(O,U){return O+U},0)}else d=[n];m.push(d),b=E+c,x=A}else d.push(n),b+=x+E,x=A}return h=c?function(O,U){return(U?M:"")+O.join(" ")}:function(O){return O.join(" ")},m.map(h)},mv.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var m=this.internal.getFont(d.fontName,d.fontStyle),b="Unicode";return m.metadata[b]?{widths:m.metadata[b].widths||{0:1},kerning:m.metadata[b].kerning||{}}:{font:m.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=r.lineIndent;var o,c,h=[];for(o=0,c=n.length;o<c;o++)h=h.concat(x9.apply(this,[n[o],s,a]));return h},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},a=0;a<16;a++)n[r[a]]=e[a],i[e[a]]=r[a];var s=function(b){return"0x"+parseInt(b,10).toString(16)},o=t.__fontmetrics__.compress=function(b){var x,E,T,A,M=["{"];for(var F in b){if(x=b[F],isNaN(parseInt(F,10))?E="'"+F+"'":(F=parseInt(F,10),E=(E=s(F).slice(2)).slice(0,-1)+i[E.slice(-1)]),typeof x=="number")x<0?(T=s(x).slice(3),A="-"):(T=s(x).slice(2),A=""),T=A+T.slice(0,-1)+i[T.slice(-1)];else{if(fo(x)!=="object")throw new Error("Don't know what to do with value type "+fo(x)+".");T=o(x)}M.push(E+T)}return M.push("}"),M.join("")},c=t.__fontmetrics__.uncompress=function(b){if(typeof b!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,E,T,A,M={},F=1,N=M,O=[],U="",j="",H=b.length-1,G=1;G<H;G+=1)(A=b[G])=="'"?x?(T=x.join(""),x=void 0):x=[]:x?x.push(A):A=="{"?(O.push([N,T]),N={},T=void 0):A=="}"?((E=O.pop())[0][E[1]]=N,T=void 0,N=E[0]):A=="-"?F=-1:T===void 0?n.hasOwnProperty(A)?(U+=n[A],T=parseInt(U,16)*F,F=1,U=""):U+=A:n.hasOwnProperty(A)?(j+=n[A],N[T]=parseInt(j,16)*F,F=1,T=void 0,j=""):j+=A;return M},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},m={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(b){var x=b.font,E=m.Unicode[x.postScriptName];E&&(x.metadata.Unicode={},x.metadata.Unicode.widths=E.widths,x.metadata.Unicode.kerning=E.kerning);var T=d.Unicode[x.postScriptName];T&&(x.metadata.Unicode.encoding=T,x.encoding=T.codePages[0])}])})(di.API),(function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=r.charCodeAt(a);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,a=r.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(hS(o)),s.metadata=t.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])})(di),di.API.addSvgAsImage=function(t,e,r,n,i,a,s,o){if(isNaN(e)||isNaN(r))throw Ro.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw Ro.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=i;var h=c.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return(Oi.canvg?Promise.resolve(Oi.canvg):nb(()=>import("./index.es-BniBxkcP.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)).catch(function(b){return Promise.reject(new Error("Could not load canvg: "+b))}).then(function(b){return b.default?b.default:b}).then(function(b){return b.fromString(h,t,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(b){return b.render(d)}).then(function(){m.addImage(c.toDataURL("image/jpeg",1),e,r,n,i,s,o)})},di.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},di.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,a,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),c=[],h=0,d=0,m=0;function b(E,T){var A,M=!1;for(A=0;A<E.length;A+=1)E[A]===T&&(M=!0);return M}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var x=o.length;for(m=0;m<x;m+=1)r[o[m]].value=r[o[m]].defaultValue,r[o[m]].explicitSet=!1}if(fo(t)==="object"){for(i in t)if(a=t[i],b(o,i)&&a!==void 0){if(r[i].type==="boolean"&&typeof a=="boolean")r[i].value=a;else if(r[i].type==="name"&&b(r[i].valueSet,a))r[i].value=a;else if(r[i].type==="integer"&&Number.isInteger(a))r[i].value=a;else if(r[i].type==="array"){for(h=0;h<a.length;h+=1)if(n=!0,a[h].length===1&&typeof a[h][0]=="number")c.push(String(a[h]-1));else if(a[h].length>1){for(d=0;d<a[h].length;d+=1)typeof a[h][d]!="number"&&(n=!1);n===!0&&c.push([a[h][0]-1,a[h][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var E,T=[];for(E in r)r[E].explicitSet===!0&&(r[E].type==="name"?T.push("/"+E+" /"+r[E].value):T.push("/"+E+" "+r[E].value));T.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+T.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),h=a.length+s.length+o.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(i+a+s+o+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(di.API),(function(t){var e=t.API,r=e.pdfEscape16=function(a,s){for(var o,c=s.metadata.Unicode.widths,h=["","0","00","000","0000"],d=[""],m=0,b=a.length;m<b;++m){if(o=s.metadata.characterToGlyph(a.charCodeAt(m)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=a.charCodeAt(m),c.indexOf(o)==-1&&(c.push(o),c.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return d.join("");o=o.toString(16),d.push(h[4-o.length],o)}return d.join("")},n=function(a){var s,o,c,h,d,m,b;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],m=0,b=(o=Object.keys(a).sort(function(x,E){return x-E})).length;m<b;m++)s=o[m],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[s]!==void 0&&a[s]!==null&&typeof a[s].toString=="function"&&(h=("0000"+a[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+h+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(s){var o=s.font,c=s.out,h=s.newObject,d=s.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var m=o.metadata.Unicode.widths,b=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),x="",E=0;E<b.length;E++)x+=String.fromCharCode(b[E]);var T=h();d({data:x,addLength1:!0,objectId:T}),c("endobj");var A=h();d({data:n(o.metadata.toUnicode),addLength1:!0,objectId:A}),c("endobj");var M=h();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Fv(o.fontName)),c("/FontFile2 "+T+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),c("/Flags "+o.metadata.flags),c("/StemV "+o.metadata.stemV),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c(">>"),c("endobj");var F=h();c("<<"),c("/Type /Font"),c("/BaseFont /"+Fv(o.fontName)),c("/FontDescriptor "+M+" 0 R"),c("/W "+t.API.PDFObject.convert(m)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+o.encoding+")"),c(">>"),c(">>"),c("endobj"),o.objectNumber=h(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+A+" 0 R"),c("/BaseFont /"+Fv(o.fontName)),c("/Encoding /"+o.encoding),c("/DescendantFonts ["+F+" 0 R]"),c(">>"),c("endobj"),o.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(s){var o=s.font,c=s.out,h=s.newObject,d=s.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var m=o.metadata.rawData,b="",x=0;x<m.length;x++)b+=String.fromCharCode(m[x]);var E=h();d({data:b,addLength1:!0,objectId:E}),c("endobj");var T=h();d({data:n(o.metadata.toUnicode),addLength1:!0,objectId:T}),c("endobj");var A=h();c("<<"),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c("/StemV "+o.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+E+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),c("/FontName /"+Fv(o.fontName)),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c(">>"),c("endobj"),o.objectNumber=h();for(var M=0;M<o.metadata.hmtx.widths.length;M++)o.metadata.hmtx.widths[M]=parseInt(o.metadata.hmtx.widths[M]*(1e3/o.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+T+" 0 R/BaseFont/"+Fv(o.fontName)+"/FontDescriptor "+A+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),c("endobj"),o.isAlreadyPutted=!0}})(a)}]);var i=function(a){var s,o=a.text||"",c=a.x,h=a.y,d=a.options||{},m=a.mutex||{},b=m.pdfEscape,x=m.activeFontKey,E=m.fonts,T=x,A="",M=0,F="",N=E[T].encoding;if(E[T].encoding!=="Identity-H")return{text:o,x:c,y:h,options:d,mutex:m};for(F=o,T=x,Array.isArray(o)&&(F=o[0]),M=0;M<F.length;M+=1)E[T].metadata.hasOwnProperty("cmap")&&(s=E[T].metadata.cmap.unicode.codeMap[F[M].charCodeAt(0)]),s||F[M].charCodeAt(0)<256&&E[T].metadata.hasOwnProperty("Unicode")?A+=F[M]:A+="";var O="";return parseInt(T.slice(1))<14||N==="WinAnsiEncoding"?O=b(A,T).split("").map(function(U){return U.charCodeAt(0).toString(16)}).join(""):N==="Identity-H"&&(O=r(A,E[T])),m.isHex=!0,{text:O,x:c,y:h,options:d,mutex:m}};e.events.push(["postProcessText",function(a){var s=a.text||"",o=[],c={text:s,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(s)){var h=0;for(h=0;h<s.length;h+=1)Array.isArray(s[h])&&s[h].length===3?o.push([i(Object.assign({},c,{text:s[h][0]})).text,s[h][1],s[h][2]]):o.push(i(Object.assign({},c,{text:s[h]})).text);a.text=o}else a.text=i(Object.assign({},c,{text:s})).text}])})(di),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(di.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,a,s,o,c,h,d,m=e,b=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],x=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],E={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},T={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},A=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],M=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),F=!1,N=0;this.__bidiEngine__={};var O=function(Q){var W=Q.charCodeAt(),oe=W>>8,se=T[oe];return se!==void 0?m[256*se+(255&W)]:oe===252||oe===253?"AL":M.test(oe)?"L":oe===8?"R":"N"},U=function(Q){for(var W,oe=0;oe<Q.length;oe++){if((W=O(Q.charAt(oe)))==="L")return!1;if(W==="R")return!0}return!1},j=function(Q,W,oe,se){var he,_e,Ce,me,xe=W[se];switch(xe){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":F=!1;break;case"N":case"AN":break;case"EN":F&&(xe="AN");break;case"AL":F=!0,xe="R";break;case"WS":case"BN":xe="N";break;case"CS":se<1||se+1>=W.length||(he=oe[se-1])!=="EN"&&he!=="AN"||(_e=W[se+1])!=="EN"&&_e!=="AN"?xe="N":F&&(_e="AN"),xe=_e===he?_e:"N";break;case"ES":xe=(he=se>0?oe[se-1]:"B")==="EN"&&se+1<W.length&&W[se+1]==="EN"?"EN":"N";break;case"ET":if(se>0&&oe[se-1]==="EN"){xe="EN";break}if(F){xe="N";break}for(Ce=se+1,me=W.length;Ce<me&&W[Ce]==="ET";)Ce++;xe=Ce<me&&W[Ce]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(me=W.length,Ce=se+1;Ce<me&&W[Ce]==="NSM";)Ce++;if(Ce<me){var Ae=Q[se],De=Ae>=1425&&Ae<=2303||Ae===64286;if(he=W[Ce],De&&(he==="R"||he==="AL")){xe="R";break}}}xe=se<1||(he=W[se-1])==="B"?"N":oe[se-1];break;case"B":F=!1,i=!0,xe=N;break;case"S":a=!0,xe="N"}return xe},H=function(Q,W,oe){var se=Q.split("");return oe&&G(se,oe,{hiLevel:N}),se.reverse(),W&&W.reverse(),se.join("")},G=function(Q,W,oe){var se,he,_e,Ce,me,xe=-1,Ae=Q.length,De=0,de=[],Ee=N?x:b,we=[];for(F=!1,i=!1,a=!1,he=0;he<Ae;he++)we[he]=O(Q[he]);for(_e=0;_e<Ae;_e++){if(me=De,de[_e]=j(Q,we,de,_e),se=240&(De=Ee[me][E[de[_e]]]),De&=15,W[_e]=Ce=Ee[De][5],se>0)if(se===16){for(he=xe;he<_e;he++)W[he]=1;xe=-1}else xe=-1;if(Ee[De][6])xe===-1&&(xe=_e);else if(xe>-1){for(he=xe;he<_e;he++)W[he]=Ce;xe=-1}we[_e]==="B"&&(W[_e]=0),oe.hiLevel|=Ce}a&&(function(Le,Fe,Xe){for(var Be=0;Be<Xe;Be++)if(Le[Be]==="S"){Fe[Be]=N;for(var ot=Be-1;ot>=0&&Le[ot]==="WS";ot--)Fe[ot]=N}})(we,W,Ae)},X=function(Q,W,oe,se,he){if(!(he.hiLevel<Q)){if(Q===1&&N===1&&!i)return W.reverse(),void(oe&&oe.reverse());for(var _e,Ce,me,xe,Ae=W.length,De=0;De<Ae;){if(se[De]>=Q){for(me=De+1;me<Ae&&se[me]>=Q;)me++;for(xe=De,Ce=me-1;xe<Ce;xe++,Ce--)_e=W[xe],W[xe]=W[Ce],W[Ce]=_e,oe&&(_e=oe[xe],oe[xe]=oe[Ce],oe[Ce]=_e);De=me}De++}}},ae=function(Q,W,oe){var se=Q.split(""),he={hiLevel:N};return oe||(oe=[]),G(se,oe,he),(function(_e,Ce,me){if(me.hiLevel!==0&&d)for(var xe,Ae=0;Ae<_e.length;Ae++)Ce[Ae]===1&&(xe=A.indexOf(_e[Ae]))>=0&&(_e[Ae]=A[xe+1])})(se,oe,he),X(2,se,W,oe,he),X(1,se,W,oe,he),se.join("")};return this.__bidiEngine__.doBidiReorder=function(Q,W,oe){if((function(he,_e){if(_e)for(var Ce=0;Ce<he.length;Ce++)_e[Ce]=Ce;o===void 0&&(o=U(he)),h===void 0&&(h=U(he))})(Q,W),s||!c||h)if(s&&c&&o^h)N=o?1:0,Q=H(Q,W,oe);else if(!s&&c&&h)N=o?1:0,Q=ae(Q,W,oe),Q=H(Q,W);else if(!s||o||c||h){if(s&&!c&&o^h)Q=H(Q,W),o?(N=0,Q=ae(Q,W,oe)):(N=1,Q=ae(Q,W,oe),Q=H(Q,W));else if(s&&o&&!c&&h)N=1,Q=ae(Q,W,oe),Q=H(Q,W);else if(!s&&!c&&o^h){var se=d;o?(N=1,Q=ae(Q,W,oe),N=0,d=!1,Q=ae(Q,W,oe),d=se):(N=0,Q=ae(Q,W,oe),Q=H(Q,W),N=1,d=!1,Q=ae(Q,W,oe),d=se,Q=H(Q,W))}}else N=0,Q=ae(Q,W,oe);else N=o?1:0,Q=ae(Q,W,oe);return Q},this.__bidiEngine__.setOptions=function(Q){Q&&(s=Q.isInputVisual,c=Q.isOutputVisual,o=Q.isInputRtl,h=Q.isOutputRtl,d=Q.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var s=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(s=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?s.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):s.push([r.doBidiReorder(i[o])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])})(di),di.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Tg(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new y_e(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new n_e(this.contents),this.head=new a_e(this),this.name=new c_e(this),this.cmap=new pZ(this),this.toUnicode={},this.hhea=new o_e(this),this.maxp=new h_e(this),this.hmtx=new f_e(this),this.post=new l_e(this),this.os2=new s_e(this),this.loca=new m_e(this),this.glyf=new d_e(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,c,h;for(h=[],s=0,o=(c=this.bbox).length;s<o;s++)e=c[s],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,a,s,o;for(s=0,a=0,o=(e=""+e).length;0<=o?a<o:a>o;a=0<=o?++a:--a)i=e.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t})();var Df,Tg=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,a,s,o,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^s)+256*(255^o)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*a+65536*s+256*o+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,a;for(a=[],n=0,i=e.length;n<i;n++)r=e[n],a.push(this.writeByte(r));return a},t})(),n_e=(function(){var t;function e(r){var n,i,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,a,s,o,c,h,d,m,b,x,E,T;for(T in x=Object.keys(r).length,c=Math.log(2),m=16*Math.floor(Math.log(x)/c),s=Math.floor(m/c),d=16*x-m,(i=new Tg).writeInt(this.scalarType),i.writeShort(x),i.writeShort(m),i.writeShort(s),i.writeShort(d),a=16*x,h=i.pos+a,o=null,E=[],r)for(b=r[T],i.writeString(T),i.writeInt(t(b)),i.writeInt(h),i.writeInt(b.length),E=E.concat(b),T==="head"&&(o=h),h+=b.length;h%4;)E.push(0),h++;return i.write(E),n=2981146554-t(i.data),i.pos=o+8,i.writeUInt32(n),i.data},t=function(r){var n,i,a,s;for(r=gZ.call(r);r.length%4;)r.push(0);for(a=new Tg(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=a.readUInt32();return 4294967295&i},e})(),i_e={}.hasOwnProperty,kd=function(t,e){for(var r in e)i_e.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Df=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var a_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Df),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new Tg).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),k9=(function(){function t(e,r){var n,i,a,s,o,c,h,d,m,b,x,E,T,A,M,F,N;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),m=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(x=e.readUInt16(),b=x/2,e.pos+=6,a=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),e.pos+=2,T=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),h=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),d=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),i=(this.length-e.pos+this.offset)/2,o=(function(){var O,U;for(U=[],c=O=0;0<=i?O<i:O>i;c=0<=i?++O:--O)U.push(e.readUInt16());return U})(),c=M=0,N=a.length;M<N;c=++M)for(A=a[c],n=F=E=T[c];E<=A?F<=A:F>=A;n=E<=A?++F:--F)d[c]===0?s=n+h[c]:(s=o[d[c]/2+(n-E)-(b-c)]||0)!==0&&(s+=h[c]),this.codeMap[n]=65535&s}e.pos=m}return t.encode=function(e,r){var n,i,a,s,o,c,h,d,m,b,x,E,T,A,M,F,N,O,U,j,H,G,X,ae,Q,W,oe,se,he,_e,Ce,me,xe,Ae,De,de,Ee,we,Le,Fe,Xe,Be,ot,Qe,rt,Re;switch(se=new Tg,s=Object.keys(e).sort(function(zt,st){return zt-st}),r){case"macroman":for(T=0,A=(function(){var zt=[];for(E=0;E<256;++E)zt.push(0);return zt})(),F={0:0},a={},he=0,xe=s.length;he<xe;he++)F[ot=e[i=s[he]]]==null&&(F[ot]=++T),a[i]={old:e[i],new:F[e[i]]},A[i]=F[e[i]];return se.writeUInt16(1),se.writeUInt16(0),se.writeUInt32(12),se.writeUInt16(0),se.writeUInt16(262),se.writeUInt16(0),se.write(A),{charMap:a,subtable:se.data,maxGlyphID:T+1};case"unicode":for(W=[],m=[],N=0,F={},n={},M=h=null,_e=0,Ae=s.length;_e<Ae;_e++)F[U=e[i=s[_e]]]==null&&(F[U]=++N),n[i]={old:U,new:F[U]},o=F[U]-i,M!=null&&o===h||(M&&m.push(M),W.push(i),h=o),M=i;for(M&&m.push(M),m.push(65535),W.push(65535),ae=2*(X=W.length),G=2*Math.pow(Math.log(X)/Math.LN2,2),b=Math.log(G/2)/Math.LN2,H=2*X-G,c=[],j=[],x=[],E=Ce=0,De=W.length;Ce<De;E=++Ce){if(Q=W[E],d=m[E],Q===65535){c.push(0),j.push(0);break}if(Q-(oe=n[Q].new)>=32768)for(c.push(0),j.push(2*(x.length+X-E)),i=me=Q;Q<=d?me<=d:me>=d;i=Q<=d?++me:--me)x.push(n[i].new);else c.push(oe-Q),j.push(0)}for(se.writeUInt16(3),se.writeUInt16(1),se.writeUInt32(12),se.writeUInt16(4),se.writeUInt16(16+8*X+2*x.length),se.writeUInt16(0),se.writeUInt16(ae),se.writeUInt16(G),se.writeUInt16(b),se.writeUInt16(H),Xe=0,de=m.length;Xe<de;Xe++)i=m[Xe],se.writeUInt16(i);for(se.writeUInt16(0),Be=0,Ee=W.length;Be<Ee;Be++)i=W[Be],se.writeUInt16(i);for(Qe=0,we=c.length;Qe<we;Qe++)o=c[Qe],se.writeUInt16(o);for(rt=0,Le=j.length;rt<Le;rt++)O=j[rt],se.writeUInt16(O);for(Re=0,Fe=x.length;Re<Fe;Re++)T=x[Re],se.writeUInt16(T);return{charMap:n,subtable:se.data,maxGlyphID:N+1}}},t})(),pZ=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Df),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new k9(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,i;return r==null&&(r="macroman"),n=k9.encode(e,r),(i=new Tg).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},t})(),o_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Df),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),s_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Df),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n})(),this.charRange=(function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),l_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Df),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)r=e.readByte(),i.push(this.names.push(e.readString(r)));return i;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var s,o,c;for(c=[],a=s=0,o=this.file.maxp.numGlyphs;0<=o?s<o:s>o;a=0<=o?++s:--s)c.push(e.readUInt32());return c}).call(this)}},t})(),u_e=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},c_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Df),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,i,a,s,o,c,h,d,m,b;for(e.pos=this.offset,e.readShort(),r=e.readShort(),o=e.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(c={},a=d=0,m=n.length;d<m;a=++d)i=n[a],e.pos=i.offset,h=e.readString(i.length),s=new u_e(h,i),c[b=i.nameID]==null&&(c[b]=[]),c[i.nameID].push(s);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t})(),h_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Df),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),f_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Df),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,i,a,s,o,c;for(e.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,d;for(d=[],r=h=0;0<=i?h<i:h>i;r=0<=i?++h:--h)d.push(e.readInt16());return d})(),this.widths=(function(){var h,d,m,b;for(b=[],h=0,d=(m=this.metrics).length;h<d;h++)a=m[h],b.push(a.advance);return b}).call(this),n=this.widths[this.widths.length-1],c=[],r=s=0;0<=i?s<i:s>i;r=0<=i?++s:--s)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),gZ=[].slice,d_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Df),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,i,a,s,o,c,h,d,m;return e in this.cache?this.cache[e]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(e),(i=a.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,s=(o=new Tg(r.read(i))).readShort(),h=o.readShort(),m=o.readShort(),c=o.readShort(),d=o.readShort(),this.cache[e]=s===-1?new g_e(o,h,m,c,d):new p_e(o,s,h,m,c,d),this.cache[e]))},t.prototype.encode=function(e,r,n){var i,a,s,o,c;for(s=[],a=[],o=0,c=r.length;o<c;o++)i=e[r[o]],a.push(s.length),i&&(s=s.concat(i.encode(n)));return a.push(s.length),{table:s,offsets:a}},t})(),p_e=(function(){function t(e,r,n,i,a,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),g_e=(function(){function t(e,r,n,i,a){var s,o;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Tg(gZ.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),m_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return kd(t,Df),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),i=0,a=0,s=0;s<n.length;++s)if(n[s]=i,a<r.length&&r[a]==s){++a,n[s]=i;var o=this.offsets[s],c=this.offsets[s+1]-o;c>0&&(i+=c)}for(var h=new Array(4*n.length),d=0;d<n.length;++d)h[4*d+3]=255&n[d],h[4*d+2]=(65280&n[d])>>8,h[4*d+1]=(16711680&n[d])>>16,h[4*d]=(4278190080&n[d])>>24;return h},t})(),y_e=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,a;for(r in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,a,s,o,c;for(i={},s=0,o=e.length;s<o;s++)i[a=e[s]]=this.font.glyf.glyphFor(a);for(a in r=[],i)(n=i[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],i[a]=n;return i},t.prototype.encode=function(e,r){var n,i,a,s,o,c,h,d,m,b,x,E,T,A,M;for(i in n=pZ.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),x={0:0},M=n.charMap)x[(c=M[i]).old]=c.new;for(E in b=n.maxGlyphID,s)E in x||(x[E]=b++);return d=(function(F){var N,O;for(N in O={},F)O[F[N]]=N;return O})(x),m=Object.keys(d).sort(function(F,N){return F-N}),T=(function(){var F,N,O;for(O=[],F=0,N=m.length;F<N;F++)o=m[F],O.push(d[o]);return O})(),a=this.font.glyf.encode(s,T,x),h=this.font.loca.encode(a.offsets,T),A={cmap:this.font.cmap.raw(),glyf:a.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(A["OS/2"]=this.font.os2.raw()),this.font.directory.encode(A)},t})();di.API.PDFObject=(function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,a,s;if(Array.isArray(r))return"["+(function(){var o,c,h;for(h=[],o=0,c=r.length;o<c;o++)n=r[o],h.push(e.convert(n));return h})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in a=["<<"],r)s=r[i],a.push("/"+i+" "+e.convert(s));return a.push(">>"),a.join(`
`)}return""+r},e})();const v_e=t=>{const e=t.width,r=t.height,n=document.createElement("div");n.className="hidden-map",n.style.width="0px",n.style.height="0px",n.style.overflow="hidden",document.body.appendChild(n);const i=document.createElement("div");i.style.width=e+"px",i.style.height=r+"px",n.appendChild(i);const a=t.map.map.getStyle();for(const c in a.sources){const h=a.sources[c];Object.keys(h).forEach(d=>{h[d]||delete h[d]})}const s=new CT.Map({container:i,center:t.map.map.getCenter(),zoom:t.map.map.getZoom(),bearing:0,pitch:0,interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,style:a}),o=s._cameraForBoxAndBearing([t.bboxUnrotated[0],t.bboxUnrotated[1]],[t.bboxUnrotated[2],t.bboxUnrotated[3]],t.bearing+t.map.map.getBearing());return s._fitInternal(o),new Promise(c=>{console.log("before idle"),s.once("idle",function(){const h={...t,renderMap:s,hiddenContainer:n,createPdf:d=>__e({...t,renderMap:s,hiddenContainer:n,...d}),createPng:d=>x_e({...t,renderMap:s,hiddenContainer:n,...d})};c(h)})})};function __e(t){const e=new di({orientation:t?.orientation==="portrait"?"p":"l",unit:"mm",compress:!0,format:t.format});return Object.defineProperty(window,"devicePixelRatio",{get:function(){return 300/96}}),new Promise(r=>{e.addImage(t.renderMap.getCanvas().toDataURL("image/png"),"png",0,0,e.internal.pageSize.getWidth(),e.internal.pageSize.getHeight(),void 0,"FAST"),t.renderMap.remove(),t.hiddenContainer.parentNode?.removeChild(t.hiddenContainer);const n={...t,pdf:e,downloadPdf:i=>b_e({...n,...i}),formData:new FormData};r(n)})}function b_e(t){return t.pdf.save("Map.pdf"),new Promise(function(e){e({...t})})}function x_e(t){return new Promise(e=>{const r=t.renderMap.getCanvas().toDataURL("image/png"),n={...t,png:r,downloadPng:i=>w_e({...n,...i})};e(n)})}function w_e(t){const e=document.createElement("a");return e.download=t?.name?t.name+".png":"map.png",e.href=t.png,document.body.appendChild(e),e.click(),document.body.removeChild(e),new Promise(function(r){r({...t})})}function mZ(t){const e=va({mapId:t.mapId});return{createExport:te.useMemo(()=>{if(e.map)return n=>v_e({map:e.map,...n})},[e.map])}}const R9=t=>{const e=va({mapId:t.mapId}),r=mZ({mapId:t.mapId}),[n,i]=gt.useState(!1);return J.jsx(J.Fragment,{children:J.jsx(ta,{color:"primary",variant:"contained",onClick:()=>{if(e.map&&r?.createExport){i(!0);const a=e.map.getBounds(),s=[a.getWest(),a.getSouth(),a.getEast(),a.getNorth()];r.createExport({width:595*1.4,height:842*1.4,bbox:s,bboxUnrotated:s,bearing:e.map.getBearing(),format:"a4",orientation:"portrait",...t.exportOptions}).then(o=>o.createPdf()).then(o=>(i(!1),o.downloadPdf())).catch(o=>{console.log(o),i(!1)})}},children:n?J.jsx(WT,{size:24,sx:{color:"#fff"}}):J.jsx(Pye,{})})})};try{R9.displayName="MlCreatePdfButton",R9.__docgenInfo={description:"Renders a button that will create a PDF version of the current map view (dimensions adjusted to fit Din A4 Paper).",displayName:"MlCreatePdfButton",props:{mapId:{defaultValue:null,description:"ID of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},exportOptions:{defaultValue:null,description:"Option overrides for the createExport function",name:"exportOptions",required:!1,type:{name:"createExportOptions | undefined"}}}}}catch{}const o0={A4:{"300dpi":{width:2480,height:3508},"150dpi":{width:1240,height:1754},"72dpi":{width:595,height:842}},A3:{"300dpi":{width:3505,height:4961},"150dpi":{width:1754,height:2480},"72dpi":{width:842,height:1191}},A2:{"300dpi":{width:4961,height:7016},"150dpi":{width:2480,height:3508},"72dpi":{width:1191,height:1684}},A1:{"300dpi":{width:7016,height:9933},"150dpi":{width:3508,height:4967},"72dpi":{width:1684,height:2384}},A0:{"300dpi":{width:9933,height:14043},"150dpi":{width:4967,height:7022},"72dpi":{width:2384,height:3370}}},yZ=gt.createContext({}),S_e=o0.A4["72dpi"],rR=({children:t})=>{const[e,r]=te.useState("A4"),[n,i]=te.useState("72dpi"),[a,s]=te.useState({center:void 0,scale:void 0,rotate:0,width:210,height:297,orientation:"portrait",fixedScale:0}),o=te.useRef(null),c=te.useMemo(()=>typeof o0[e][n]<"u"?a.orientation==="portrait"?o0[e][n]:{width:o0[e][n].height,height:o0[e][n].width}:S_e,[e,n,a.orientation]),h={options:a,setOptions:s,format:e,setFormat:r,quality:n,setQuality:i,geojsonRef:o,template:c};return J.jsx(yZ.Provider,{value:h,children:t})};try{rR.displayName="PdfContextProvider",rR.__docgenInfo={description:"",displayName:"PdfContextProvider",props:{}}}catch{}function _O(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return!0;return!1}function vZ(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return t[n];return null}function _Z(t){var e=t;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function bO(t,e){try{return new RegExp(t,"g").exec(e)}catch{return null}}function E_e(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!!(e&&e.length)}function T_e(t,e){var r=bO("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return r?r[3]:""}function nR(t){return t.replace(/_/g,".")}function O1(t,e){var r=null,n="-1";return _O(t,function(i){var a=bO("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(r=i,n=a[3]||"-1",i.versionAlias?n=i.versionAlias:i.versionTest&&(n=T_e(i.versionTest.toLowerCase(),e)||n),n=nR(n),!0)}),{preset:r,version:n}}function lw(t,e){var r={brand:"",version:"-1"};return _O(t,function(n){var i=bZ(e,n);return i?(r.brand=n.id,r.version=n.versionAlias||i.version,r.version!=="-1"):!1}),r}function bZ(t,e){return vZ(t,function(r){var n=r.brand;return bO(""+e.test,n.toLowerCase())})}var xZ=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],wZ=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],iR=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],SZ=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],EZ=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function TZ(t){return!!O1(SZ,t).preset}function C_e(t){var e=_Z(t),r=!!/mobi/g.exec(e),n={name:"unknown",version:"-1",majorVersion:-1,webview:TZ(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=O1(xZ,e),s=a.preset,o=a.version,c=O1(EZ,e),h=c.preset,d=c.version,m=O1(wZ,e);if(n.chromium=!!m.preset,n.chromiumVersion=m.version,!n.chromium){var b=O1(iR,e);n.webkit=!!b.preset,n.webkitVersion=b.version}return h&&(i.name=h.id,i.version=d,i.majorVersion=parseInt(d,10)),s&&(n.name=s.id,n.version=o,n.webview&&i.name==="ios"&&n.name!=="safari"&&(n.webview=!1)),n.majorVersion=parseInt(n.version,10),{browser:n,os:i,isMobile:r,isHints:!1}}function A_e(t){var e=navigator.userAgentData,r=(e.uaList||e.brands).slice(),n=e.mobile||!1,i=r[0],a=(e.platform||navigator.platform).toLowerCase(),s={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!lw(SZ,r).brand||TZ(_Z())},o={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&_O(iR,function(b){return bZ(r,b)});var c=lw(wZ,r);if(s.chromium=!!c.brand,s.chromiumVersion=c.version||"-1",!s.chromium){var h=lw(iR,r);s.webkit=!!h.brand,s.webkitVersion=h.version||"-1"}var d=vZ(EZ,function(b){return new RegExp(""+b.test,"g").exec(a)});o.name=d?d.id:"";{var m=lw(xZ,r);s.name=m.brand||s.name,s.version=m.brand&&t?t.uaFullVersion:m.version}return s.webkit&&(o.name=n?"ios":"mac"),o.name==="ios"&&s.webview&&(s.version="-1"),o.version=nR(o.version),s.version=nR(s.version),o.majorVersion=parseInt(o.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:o,isMobile:n,isHints:!0}}function I_e(t){return E_e()?A_e():C_e(t)}function P_e(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.map(function(n){return n.split(" ").map(function(i){return i?""+t+i:""}).join(" ")}).join(" ")}function k_e(t,e){return e.replace(/([^}{]*){/gm,function(r,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"})}function zm(t,e){return function(r){r&&(t[e]=r)}}function CZ(t,e,r){return function(n){n&&(t[e][r]=n)}}function R_e(t,e){return e===void 0&&(e={}),function(r,n){t.forEach(function(i){var a=e[i]||i;a in r||(r[a]=function(){for(var s,o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];var h=(s=this[n])[i].apply(s,o);return h===this[n]?this:h})})}}var M_e="function",D_e="object",O_e="string",N_e="number",xO="undefined",AZ=typeof window!==xO,L_e=typeof document!==xO&&document,F_e=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Tl=1e-7,uw={cm:function(t){return t*96/2.54},mm:function(t){return t*96/254},in:function(t){return t*96},pt:function(t){return t*96/72},pc:function(t){return t*96/6},"%":function(t,e){return t*e/100},vw:function(t,e){return e===void 0&&(e=window.innerWidth),t/100*e},vh:function(t,e){return e===void 0&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function B_e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function eE(t,e,r,n){return(t*n+e*r)/(r+n)}function wO(t){return typeof t===xO}function Cf(t){return t&&typeof t===D_e}function su(t){return Array.isArray(t)}function kp(t){return typeof t===O_e}function $b(t){return typeof t===N_e}function SO(t){return typeof t===M_e}function z_e(t,e){var r=t===""||t==" ",n=e===""||e==" ";return n&&r||t===e}function IZ(t,e,r,n,i){var a=EO(t,e,r);return a?r:j_e(t,e,r+1,n,i)}function EO(t,e,r){if(!t.ignore)return null;var n=e.slice(Math.max(r-3,0),r+3).join("");return new RegExp(t.ignore).exec(n)}function j_e(t,e,r,n,i){for(var a=function(h){var d=e[h].trim();if(d===t.close&&!EO(t,e,h))return{value:h};var m=h,b=hh(i,function(x){var E=x.open;return E===d});if(b&&(m=IZ(b,e,h,n,i)),m===-1)return s=h,"break";h=m,s=h},s,o=r;o<n;++o){var c=a(o);if(o=s,typeof c=="object")return c.value;if(c==="break")break}return-1}function TO(t,e){var r=kp(e)?{separator:e}:e,n=r.separator,i=n===void 0?",":n,a=r.isSeparateFirst,s=r.isSeparateOnlyOpenClose,o=r.isSeparateOpenClose,c=o===void 0?s:o,h=r.openCloseCharacters,d=h===void 0?F_e:h,m=d.map(function(H){var G=H.open,X=H.close;return G===X?G:G+"|"+X}).join("|"),b="(\\s*"+i+"\\s*|"+m+"|\\s+)",x=new RegExp(b,"g"),E=t.split(x).filter(function(H){return H&&H!=="undefined"}),T=E.length,A=[],M=[];function F(){return M.length?(A.push(M.join("")),M=[],!0):!1}for(var N=function(H){var G=E[H].trim(),X=H,ae=hh(d,function(oe){var se=oe.open;return se===G}),Q=hh(d,function(oe){var se=oe.close;return se===G});if(ae){if(X=IZ(ae,E,H,T,d),X!==-1&&c)return F()&&a||(A.push(E.slice(H,X+1).join("")),H=X,a)?(O=H,"break"):(O=H,"continue")}else if(Q&&!EO(Q,E,H)){var W=B_e(d);return W.splice(d.indexOf(Q),1),{value:TO(t,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:s,isSeparateOpenClose:c,openCloseCharacters:W})}}else if(z_e(G,i)&&!s)return F(),a?(O=H,"break"):(O=H,"continue");X===-1&&(X=T-1),M.push(E.slice(H,X+1).join("")),H=X,O=H},O,U=0;U<T;++U){var j=N(U);if(U=O,typeof j=="object")return j.value;if(j==="break")break}return M.length&&A.push(M.join("")),A}function Cg(t){return TO(t,"")}function km(t){return TO(t,",")}function PZ(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Lx(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var r=e[1],n=e[2],i=e[3];return{prefix:r,unit:i,value:parseFloat(n)}}function U_e(t,e){return t.replace(/([a-z])([A-Z])/g,function(r,n,i){return""+n+e+i.toLowerCase()})}function qb(){return Date.now?Date.now():new Date().getTime()}function Sp(t,e,r){r===void 0&&(r=-1);for(var n=t.length,i=0;i<n;++i)if(e(t[i],i,t))return i;return r}function hh(t,e,r){var n=Sp(t,e);return n>-1?t[n]:r}var kZ=(function(){var t=qb(),e=AZ&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(r){var n=qb(),i=setTimeout(function(){r(n-t)},1e3/60);return i}})(),V_e=(function(){var t=AZ&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(e){clearTimeout(e)}})();function d_(t){return Object.keys(t)}function xo(t,e){var r=Lx(t),n=r.value,i=r.unit;if(Cf(e)){var a=e[i];if(a){if(SO(a))return a(n);if(uw[i])return uw[i](n,a)}}else if(i==="%")return n*e/100;return uw[i]?uw[i](n):n}function aR(t,e,r){return Math.max(e,Math.min(t,r))}function M9(t,e,r,n){return n===void 0&&(n=t[0]/t[1]),[[Fi(e[0],Tl),Fi(e[0]/n,Tl)],[Fi(e[1]*n,Tl),Fi(e[1],Tl)]].filter(function(i){return i.every(function(a,s){var o=e[s],c=Fi(o,Tl);return r?a<=o||a<=c:a>=o||a>=c})})[0]||t}function RZ(t,e,r,n){if(!n)return t.map(function(x,E){return aR(x,e[E],r[E])});var i=t[0],a=t[1],s=n===!0?i/a:n,o=M9(t,e,!1,s),c=o[0],h=o[1],d=M9(t,r,!0,s),m=d[0],b=d[1];return i<c||a<h?(i=c,a=h):(i>m||a>b)&&(i=m,a=b),[i,a]}function $_e(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return r}function oR(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return e?r/e:0}function il(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function q_e(t){return[0,1].map(function(e){return oR(t.map(function(r){return r[e]}))})}function D9(t){var e=q_e(t),r=il(e,t[0]),n=il(e,t[1]);return r<n&&n-r<Math.PI||r>n&&n-r<-Math.PI?1:-1}function gp(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function Fi(t,e){if(!e)return t;var r=1/e;return Math.round(t/e)/r}function O9(t,e){return t.forEach(function(r,n){t[n]=Fi(t[n],e)}),t}function H_e(t){for(var e=[],r=0;r<t;++r)e.push(r);return e}function W_e(t){return t.reduce(function(e,r){return e.concat(r)},[])}function Bl(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function MZ(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function DZ(t,e){if(t.classList)t.classList.remove(e);else{var r=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(r," ")}}function Wu(t,e,r,n){t.addEventListener(e,r,n)}function _u(t,e,r,n){t.removeEventListener(e,r,n)}function CO(t){return t?.ownerDocument||L_e}function AO(t){return CO(t).documentElement}function zg(t){return CO(t).body}function xg(t){var e;return((e=t?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function OZ(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function IO(t){return Cf(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}function G_e(t,e,r,n,i,a){for(var s=0;s<i;++s){var o=r+s*i,c=n+s*i;t[o]+=t[c]*a,e[o]+=e[c]*a}}function X_e(t,e,r,n,i){for(var a=0;a<i;++a){var s=r+a*i,o=n+a*i,c=t[s],h=e[s];t[s]=t[o],t[o]=c,e[s]=e[o],e[o]=h}}function Y_e(t,e,r,n,i){for(var a=0;a<n;++a){var s=r+a*n;t[s]/=i,e[s]/=i}}function NZ(t,e,r){for(var n=t.slice(),i=0;i<r;++i)n[i*r+e-1]=0,n[(e-1)*r+i]=0;return n[(e-1)*(r+1)]=1,n}function Ed(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=t.slice(),n=Jo(e),i=0;i<e;++i){var a=e*i+i;if(!Fi(r[a],Tl)){for(var s=i+1;s<e;++s)if(r[e*i+s]){X_e(r,n,i,s,e);break}}if(!Fi(r[a],Tl))return[];Y_e(r,n,i,e,r[a]);for(var s=0;s<e;++s){var o=s,c=s+i*e,h=r[c];!Fi(h,Tl)||i===s||G_e(r,n,o,i,e,-h)}}return n}function Z_e(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=0;n<e;++n)for(var i=0;i<e;++i)r[i*e+n]=t[e*n+i];return r}function LZ(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=t[e*e-1],i=0;i<e-1;++i)r[i]=t[e*(e-1)+i]/n;return r[e-1]=0,r}function K_e(t,e){for(var r=Jo(e),n=0;n<e-1;++n)r[e*(e-1)+n]=t[n]||0;return r}function Qm(t,e){for(var r=t.slice(),n=t.length;n<e-1;++n)r[n]=0;return r[e-1]=1,r}function Af(t,e,r){if(e===void 0&&(e=Math.sqrt(t.length)),e===r)return t;for(var n=Jo(r),i=Math.min(e,r),a=0;a<i-1;++a){for(var s=0;s<i-1;++s)n[a*r+s]=t[a*e+s];n[(a+1)*r-1]=t[(a+1)*e-1],n[(r-1)*r+a]=t[(e-1)*e+a]}return n[r*r-1]=t[e*e-1],n}function tE(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=Jo(t);return e.forEach(function(i){n=wo(n,i,t)}),n}function wo(t,e,r){r===void 0&&(r=Math.sqrt(t.length));var n=[],i=t.length/r,a=e.length/i;if(i){if(!a)return t}else return e;for(var s=0;s<r;++s)for(var o=0;o<a;++o){n[o*r+s]=0;for(var c=0;c<i;++c)n[o*r+s]+=t[c*r+s]*e[o*i+c]}return n}function Ma(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]+e[i];return n}function _i(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]-e[i];return n}function J_e(t,e){return e===void 0&&(e=t.length===6),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function FZ(t,e){return e===void 0&&(e=t.length===9),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function tc(t,e,r){r===void 0&&(r=e.length);var n=wo(t,e,r),i=n[r-1];return n.map(function(a){return a/i})}function Q_e(t,e){return wo(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function e1e(t,e){return wo(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function t1e(t,e){return wo(t,Bx(e,4))}function cw(t,e){var r=e[0],n=r===void 0?1:r,i=e[1],a=i===void 0?1:i,s=e[2],o=s===void 0?1:s;return wo(t,[n,0,0,0,0,a,0,0,0,0,o,0,0,0,0,1],4)}function Fx(t,e){return tc(Bx(e,3),Qm(t,3))}function VA(t,e){var r=e[0],n=r===void 0?0:r,i=e[1],a=i===void 0?0:i,s=e[2],o=s===void 0?0:s;return wo(t,[1,0,0,0,0,1,0,0,0,0,1,0,n,a,o,1],4)}function N9(t,e){return wo(t,e,4)}function Bx(t,e){var r=Math.cos(t),n=Math.sin(t),i=Jo(e);return i[0]=r,i[1]=n,i[e]=-n,i[e+1]=r,i}function Jo(t){for(var e=t*t,r=[],n=0;n<e;++n)r[n]=n%(t+1)?0:1;return r}function PO(t,e){for(var r=Jo(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[(e+1)*i]=t[i];return r}function ey(t,e){for(var r=Jo(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[e*(e-1)+i]=t[i];return r}function kO(t,e,r,n,i,a,s,o){var c=t[0],h=t[1],d=e[0],m=e[1],b=r[0],x=r[1],E=n[0],T=n[1],A=i[0],M=i[1],F=a[0],N=a[1],O=s[0],U=s[1],j=o[0],H=o[1],G=[c,0,d,0,b,0,E,0,h,0,m,0,x,0,T,0,1,0,1,0,1,0,1,0,0,c,0,d,0,b,0,E,0,h,0,m,0,x,0,T,0,1,0,1,0,1,0,1,-A*c,-M*c,-F*d,-N*d,-O*b,-U*b,-j*E,-H*E,-A*h,-M*h,-F*m,-N*m,-O*x,-U*x,-j*T,-H*T],X=Ed(G,8);if(!X.length)return[];var ae=wo(X,[A,M,F,N,O,U,j,H],8);return ae[8]=1,Af(Z_e(ae),3,4)}var fb=function(){return fb=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},fb.apply(this,arguments)};function r1e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Hb(t,e){return e===void 0&&(e=0),Bv(V0(t,e))}function n1e(t,e){var r=tc(t,[e[0],e[1]||0,e[2]||0,1],4),n=r[3]||1;return[r[0]/n,r[1]/n,r[2]/n]}function Bv(t){var e=r1e();return t.forEach(function(r){var n=r.matrixFunction,i=r.functionValue;n&&(e=n(e,i))}),e}function V0(t,e){e===void 0&&(e=0);var r=su(t)?t:Cg(t);return r.map(function(n){var i=PZ(n),a=i.prefix,s=i.value,o=null,c=a,h="";if(a==="translate"||a==="translateX"||a==="translate3d"){var d=Cf(e)?fb(fb({},e),{"o%":e["%"]}):{"%":e,"o%":e},m=km(s).map(function(oe,se){return se===0&&"x%"in d?d["%"]=e["x%"]:se===1&&"y%"in d?d["%"]=e["y%"]:d["%"]=e["o%"],xo(oe,d)}),b=m[0],x=m[1],E=x===void 0?0:x,T=m[2],A=T===void 0?0:T;o=VA,h=[b,E,A]}else if(a==="translateY"){var M=Cf(e)?fb({"%":e["y%"]},e):{"%":e},E=xo(s,M);o=VA,h=[0,E,0]}else if(a==="translateZ"){var A=parseFloat(s);o=VA,h=[0,0,A]}else if(a==="scale"||a==="scale3d"){var F=km(s).map(function(oe){return parseFloat(oe)}),N=F[0],O=F[1],U=O===void 0?N:O,j=F[2],H=j===void 0?1:j;o=cw,h=[N,U,H]}else if(a==="scaleX"){var N=parseFloat(s);o=cw,h=[N,1,1]}else if(a==="scaleY"){var U=parseFloat(s);o=cw,h=[1,U,1]}else if(a==="scaleZ"){var H=parseFloat(s);o=cw,h=[1,1,H]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var G=Lx(s),X=G.unit,ae=G.value,Q=X==="rad"?ae:ae*Math.PI/180;a==="rotate"||a==="rotateZ"?(c="rotateZ",o=t1e):a==="rotateX"?o=Q_e:a==="rotateY"&&(o=e1e),h=Q}else if(a==="matrix3d")o=N9,h=km(s).map(function(oe){return parseFloat(oe)});else if(a==="matrix"){var W=km(s).map(function(oe){return parseFloat(oe)});o=N9,h=[W[0],W[1],0,0,W[2],W[3],0,0,0,0,1,0,W[4],W[5],0,1]}else c="";return{name:a,functionName:c,value:s,matrixFunction:o,functionValue:h}})}var i1e=(function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(r){return this.values[this.keys.indexOf(r)]},e.set=function(r,n){var i=this.keys,a=this.values,s=i.indexOf(r),o=s===-1?i.length:s;i[o]=r,a[o]=n},t})(),a1e=(function(){function t(){this.object={}}var e=t.prototype;return e.get=function(r){return this.object[r]},e.set=function(r,n){this.object[r]=n},t})(),o1e=typeof Map=="function",s1e=(function(){function t(){}var e=t.prototype;return e.connect=function(r,n){this.prev=r,this.next=n,r&&(r.next=this),n&&(n.prev=this)},e.disconnect=function(){var r=this.prev,n=this.next;r&&(r.next=n),n&&(n.prev=r)},e.getIndex=function(){for(var r=this,n=-1;r;)r=r.prev,++n;return n},t})();function l1e(t,e){var r=[],n=[];return t.forEach(function(i){var a=i[0],s=i[1],o=new s1e;r[a]=o,n[s]=o}),r.forEach(function(i,a){i.connect(r[a-1])}),t.filter(function(i,a){return!e[a]}).map(function(i,a){var s=i[0],o=i[1];if(s===o)return[0,0];var c=r[s],h=n[o-1],d=c.getIndex();c.disconnect(),h?c.connect(h,h.next):c.connect(void 0,r[0]);var m=c.getIndex();return[d,m]})}var u1e=(function(){function t(r,n,i,a,s,o,c,h){this.prevList=r,this.list=n,this.added=i,this.removed=a,this.changed=s,this.maintained=o,this.changedBeforeAdded=c,this.fixed=h}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var r=l1e(this.changedBeforeAdded,this.fixed),n=this.changed,i=[];this.cacheOrdered=r.filter(function(a,s){var o=a[0],c=a[1],h=n[s],d=h[0],m=h[1];if(o!==c)return i.push([d,m]),!0}),this.cachePureChanged=i},t})();function RO(t,e,r){var n=o1e?Map:r?a1e:i1e,i=r||function(F){return F},a=[],s=[],o=[],c=t.map(i),h=e.map(i),d=new n,m=new n,b=[],x=[],E={},T=[],A=0,M=0;return c.forEach(function(F,N){d.set(F,N)}),h.forEach(function(F,N){m.set(F,N)}),c.forEach(function(F,N){var O=m.get(F);typeof O>"u"?(++M,s.push(N)):E[O]=M}),h.forEach(function(F,N){var O=d.get(F);typeof O>"u"?(a.push(N),++A):(o.push([O,N]),M=E[N]||0,b.push([O-M,N-A]),x.push(N===O),O!==N&&T.push([O,N]))}),s.reverse(),new u1e(t,e,a,s,T,o,b,x)}var c1e=(function(){function t(r,n){r===void 0&&(r=[]),this.findKeyCallback=n,this.list=[].slice.call(r)}var e=t.prototype;return e.update=function(r){var n=[].slice.call(r),i=RO(this.list,n,this.findKeyCallback);return this.list=n,i},t})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var sR=function(t,e){return sR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},sR(t,e)};function h1e(t,e){sR(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var BZ=typeof Map=="function"?void 0:(function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}})(),zZ=(function(t){h1e(e,t);function e(r){return r===void 0&&(r=[]),t.call(this,r,BZ)||this}return e})(c1e);function f1e(t,e){return RO(t,e,BZ)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var lR=function(){return lR=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},lR.apply(this,arguments)};function d1e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}var MO=(function(){function t(){this._events={}}var e=t.prototype;return e.on=function(r,n){if(Cf(r))for(var i in r)this.on(i,r[i]);else this._addEvent(r,n,{});return this},e.off=function(r,n){if(!r)this._events={};else if(Cf(r))for(var i in r)this.off(i);else if(!n)this._events[r]=[];else{var a=this._events[r];if(a){var s=Sp(a,function(o){return o.listener===n});s>-1&&a.splice(s,1)}}return this},e.once=function(r,n){var i=this;return n&&this._addEvent(r,n,{once:!0}),new Promise(function(a){i._addEvent(r,a,{once:!0})})},e.emit=function(r,n){var i=this;n===void 0&&(n={});var a=this._events[r];if(!r||!a)return!0;var s=!1;return n.eventType=r,n.stop=function(){s=!0},n.currentTarget=this,d1e(a).forEach(function(o){o.listener(n),o.once&&i.off(r,o.listener)}),!s},e.trigger=function(r,n){return n===void 0&&(n={}),this.emit(r,n)},e._addEvent=function(r,n,i){var a=this._events;a[r]=a[r]||[];var s=a[r];s.push(lR({listener:n},i))},t})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var uR=function(t,e){return uR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},uR(t,e)};function p1e(t,e){uR(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var s0=function(){return s0=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},s0.apply(this,arguments)};function g1e(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function L9(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function hw(t){if(t){if(kp(t))return document.querySelector(t)}else return null;if(SO(t))return t();if(t instanceof Element)return t;if("current"in t)return t.current;if("value"in t)return t.value}var m1e=(function(t){p1e(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n._startRect=null,n._startPos=[],n._prevTime=0,n._timer=0,n._prevScrollPos=[0,0],n._isWait=!1,n._flag=!1,n._currentOptions=null,n._lock=!1,n._unregister=null,n._onScroll=function(){var i=n._currentOptions;n._lock||!i||n.emit("scrollDrag",{next:function(a){n.checkScroll({container:i.container,inputEvent:a})}})},n}var r=e.prototype;return r.dragStart=function(n,i){var a=hw(i.container);if(!a){this._flag=!1;return}var s=0,o=0,c=0,h=0;if(a===document.body)c=window.innerWidth,h=window.innerHeight;else{var d=a.getBoundingClientRect();s=d.top,o=d.left,c=d.width,h=d.height}this._flag=!0,this._startPos=[n.clientX,n.clientY],this._startRect={top:s,left:o,width:c,height:h},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},r.drag=function(n,i){if(clearTimeout(this._timer),!!this._flag){var a=n.clientX,s=n.clientY,o=i.threshold,c=o===void 0?0:o,h=this,d=h._startRect,m=h._startPos;this._currentOptions=i;var b=[0,0];return d.top>s-c?(m[1]>d.top||s<m[1])&&(b[1]=-1):d.top+d.height<s+c&&(m[1]<d.top+d.height||s>m[1])&&(b[1]=1),d.left>a-c?(m[0]>d.left||a<m[0])&&(b[0]=-1):d.left+d.width<a+c&&(m[0]<d.left+d.width||a>m[0])&&(b[0]=1),!b[0]&&!b[1]?!1:this._continueDrag(s0(s0({},i),{direction:b,inputEvent:n,isDrag:!0}))}},r.checkScroll=function(n){var i=this;if(this._isWait)return!1;var a=n.prevScrollPos,s=a===void 0?this._prevScrollPos:a,o=n.direction,c=n.throttleTime,h=c===void 0?0:c,d=n.inputEvent,m=n.isDrag,b=this._getScrollPosition(o||[0,0],n),x=b[0]-s[0],E=b[1]-s[1],T=o||[x?Math.abs(x)/x:0,E?Math.abs(E)/E:0];return this._prevScrollPos=b,this._lock=!1,!x&&!E?!1:(this.emit("move",{offsetX:T[0]?x:0,offsetY:T[1]?E:0,inputEvent:d}),h&&m&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},h)),!0)},r.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},r._getScrollPosition=function(n,i){var a=i.container,s=i.getScrollPosition,o=s===void 0?g1e:s;return o({container:hw(a),direction:n})},r._continueDrag=function(n){var i=this,a,s=n.container,o=n.direction,c=n.throttleTime,h=n.useScroll,d=n.isDrag,m=n.inputEvent;if(!(!this._flag||d&&this._isWait)){var b=qb(),x=Math.max(c+this._prevTime-b,0);if(x>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},x),!1;this._prevTime=b;var E=this._getScrollPosition(o,n);this._prevScrollPos=E,d&&(this._isWait=!0),h||(this._lock=!0);var T={container:hw(s),direction:o,inputEvent:m};return(a=n.requestScroll)===null||a===void 0||a.call(n,T),this.emit("scroll",T),this._isWait=!1,h||this.checkScroll(s0(s0({},n),{prevScrollPos:E,direction:o,inputEvent:m}))}},r._registerScrollEvent=function(n){this._unregisterScrollEvent();var i=n.checkScrollEvent;if(i){var a=i===!0?L9:i,s=hw(n.container);i===!0&&(s===document.body||s===document.documentElement)?this._unregister=L9(window,this._onScroll):this._unregister=a(s,this._onScroll)}},r._unregisterScrollEvent=function(){var n;(n=this._unregister)===null||n===void 0||n.call(this),this._unregister=null},e})(MO);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function y1e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function Ic(t){return Fi(t,Tl)}function v1e(t,e){return t.every(function(r,n){return Ic(r-e[n])===0})}function _1e(t,e){return!Ic(t[0]-e[0])&&!Ic(t[1]-e[1])}function jZ(t){return t.length<3?0:Math.abs($_e(t.map(function(e,r){var n=t[r+1]||t[0];return e[0]*n[1]-n[0]*e[1]})))/2}function F9(t,e){var r=e.width,n=e.height,i=e.left,a=e.top,s=ty(t),o=s.minX,c=s.minY,h=s.maxX,d=s.maxY,m=r/(h-o),b=n/(d-c);return t.map(function(x){return[i+(x[0]-o)*m,a+(x[1]-c)*b]})}function ty(t){var e=t.map(function(n){return n[0]}),r=t.map(function(n){return n[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,r),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,r)}}function cR(t,e,r){var n=t[0],i=t[1],a=ty(e),s=a.minX,o=a.maxX,c=[[s,i],[o,i]],h=rE(c[0],c[1]),d=hR(e),m=[];if(d.forEach(function(E){var T=rE(E[0],E[1]),A=E[0];if(v1e(h,T))m.push({pos:t,line:E,type:"line"});else{var M=UZ(DO(h,T),[c,E]);M.forEach(function(F){E.some(function(N){return _1e(N,F)})?m.push({pos:F,line:E,type:"point"}):Ic(A[1]-i)!==0&&m.push({pos:F,line:E,type:"intersection"})})}}),hh(m,function(E){return E[0]===n}))return!0;var b=0,x={};return m.forEach(function(E){var T=E.pos,A=E.type,M=E.line;if(!(T[0]>n))if(A==="intersection")++b;else{if(A==="line")return;if(A==="point"){var F=hh(M,function(U){return U[1]!==i}),N=x[T[0]],O=F[1]>i?1:-1;N?N!==O&&++b:x[T[0]]=O}}}),b%2===1}function rE(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],s=i-r,o=a-n;Math.abs(s)<Tl&&(s=0),Math.abs(o)<Tl&&(o=0);var c=0,h=0,d=0;return s?o?(c=-o/s,h=1,d=-c*r-n):(h=1,d=-n):o&&(c=-1,d=r),[c,h,d]}function DO(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],c=r===0&&a===0,h=n===0&&s===0,d=[];if(c&&h)return[];if(c){var m=-i/n,b=-o/s;return m!==b?[]:[[-1/0,m],[1/0,m]]}else if(h){var x=-i/r,E=-o/a;return x!==E?[]:[[x,-1/0],[x,1/0]]}else if(r===0){var T=-i/n,A=-(s*T+o)/a;d=[[A,T]]}else if(a===0){var T=-o/s,A=-(n*T+i)/r;d=[[A,T]]}else if(n===0){var A=-i/r,T=-(a*A+o)/s;d=[[A,T]]}else if(s===0){var A=-o/a,T=-(r*A+i)/n;d=[[A,T]]}else{var A=(n*o-s*i)/(s*r-n*a),T=-(r*A+i)/n;d=[[A,T]]}return d.map(function(M){return[M[0],M[1]]})}function UZ(t,e){var r=e.map(function(m){return[0,1].map(function(b){return[Math.min(m[0][b],m[1][b]),Math.max(m[0][b],m[1][b])]})}),n=[];if(t.length===2){var i=t[0],a=i[0],s=i[1];if(Ic(a-t[1][0])){if(!Ic(s-t[1][1])){var h=Math.max.apply(Math,r.map(function(m){return m[0][0]})),d=Math.min.apply(Math,r.map(function(m){return m[0][1]}));if(Ic(h-d)>0)return[];n=[[h,s],[d,s]]}}else{var o=Math.max.apply(Math,r.map(function(m){return m[1][0]})),c=Math.min.apply(Math,r.map(function(m){return m[1][1]}));if(Ic(o-c)>0)return[];n=[[a,o],[a,c]]}}return n.length||(n=t.filter(function(m){var b=m[0],x=m[1];return r.every(function(E){return 0<=Ic(b-E[0][0])&&0<=Ic(E[0][1]-b)&&0<=Ic(x-E[1][0])&&0<=Ic(E[1][1]-x)})})),n.map(function(m){return[Ic(m[0]),Ic(m[1])]})}function hR(t){return y1e(t.slice(1),[t[0]]).map(function(e,r){return[t[r],e]})}function b1e(t,e){var r=t.slice(),n=e.slice();D9(r)===-1&&r.reverse(),D9(n)===-1&&n.reverse();var i=hR(r),a=hR(n),s=i.map(function(d){return rE(d[0],d[1])}),o=a.map(function(d){return rE(d[0],d[1])}),c=[];s.forEach(function(d,m){var b=i[m],x=[];o.forEach(function(E,T){var A=DO(d,E),M=UZ(A,[b,a[T]]);x.push.apply(x,M.map(function(F){return{index1:m,index2:T,pos:F,type:"intersection"}}))}),x.sort(function(E,T){return gp(b[0],E.pos)-gp(b[0],T.pos)}),c.push.apply(c,x),cR(b[1],n)&&c.push({index1:m,index2:-1,pos:b[1],type:"inside"})}),a.forEach(function(d,m){if(cR(d[1],r)){var b=!1,x=Sp(c,function(E){var T=E.index2;return T===m?(b=!0,!1):!!b});x===-1&&(b=!1,x=Sp(c,function(E){var T=E.index1,A=E.index2;return T===-1&&A+1===m?(b=!0,!1):!!b})),x===-1?c.push({index1:-1,index2:m,pos:d[1],type:"inside"}):c.splice(x,0,{index1:-1,index2:m,pos:d[1],type:"inside"})}});var h={};return c.filter(function(d){var m=d.pos,b=m[0]+"x"+m[1];return h[b]?!1:(h[b]=!0,!0)})}function x1e(t,e){var r=b1e(t,e);return r.map(function(n){var i=n.pos;return i})}function w1e(t,e){var r=x1e(t,e);return jZ(r)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var fR=function(t,e){return fR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},fR(t,e)};function S1e(t,e){fR(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var xl=function(){return xl=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},xl.apply(this,arguments)};function E1e(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function $A(t){return E1e([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function T1e(t){return t.touches&&t.touches.length>=2}function fw(t){return t?t.touches?A1e(t.touches):[VZ(t)]:[]}function C1e(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}function B9(t,e,r){var n=r.length,i=db(t,n),a=i.clientX,s=i.clientY,o=i.originalClientX,c=i.originalClientY,h=db(e,n),d=h.clientX,m=h.clientY,b=db(r,n),x=b.clientX,E=b.clientY,T=a-d,A=s-m,M=a-x,F=s-E;return{clientX:o,clientY:c,deltaX:T,deltaY:A,distX:M,distY:F}}function qA(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function A1e(t){for(var e=Math.min(t.length,2),r=[],n=0;n<e;++n)r.push(VZ(t[n]));return r}function VZ(t){return{clientX:t.clientX,clientY:t.clientY}}function db(t,e){e===void 0&&(e=t.length);for(var r={clientX:0,clientY:0,originalClientX:0,originalClientY:0},n=Math.min(t.length,e),i=0;i<n;++i){var a=t[i];r.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,r.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,r.clientX+=a.clientX,r.clientY+=a.clientY}return e?{clientX:r.clientX/e,clientY:r.clientY/e,originalClientX:r.originalClientX/e,originalClientY:r.originalClientY/e}:r}var HA=(function(){function t(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return t.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),$A(e)},t.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),$A(e)-$A(this.startClients)},t.prototype.getPosition=function(e,r){e===void 0&&(e=this.prevClients);var n=B9(e||this.prevClients,this.prevClients,this.startClients),i=n.deltaX,a=n.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,n},t.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var r=this.prevClients,n=this.startClients,i=Math.min(this.length,r.length),a=[],s=0;s<i;++s)a[s]=B9([e[s]],[r[s]],[n[s]]);return a},t.prototype.getMovement=function(e){var r=this.movement;if(!e)return r;var n=db(e,this.length),i=db(this.prevClients,this.length),a=n.clientX-i.clientX,s=n.clientY-i.clientY;return Math.sqrt(a*a+s*s)+r},t.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),qA(e)},t.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),qA(e)/qA(this.startClients)},t.prototype.move=function(e,r){this.startClients.forEach(function(n){n.clientX-=e,n.clientY-=r}),this.prevClients.forEach(function(n){n.clientX-=e,n.clientY-=r})},t})(),z9=["textarea","input"],I1e=(function(t){S1e(e,t);function e(r,n){n===void 0&&(n={});var i=t.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(b,x){if(x===void 0&&(x=!0),!(!i.flag&&b.cancelable===!1)){var E=b.type.indexOf("drag")>=-1;if(!(i.flag&&E)){i._isDragAPI=!0;var T=i.options,A=T.container,M=T.pinchOutside,F=T.preventWheelClick,N=T.preventRightClick,O=T.preventDefault,U=T.checkInput,j=T.dragFocusedInput,H=T.preventClickEventOnDragStart,G=T.preventClickEventOnDrag,X=T.preventClickEventByCondition,ae=i._useTouch,Q=!i.flag;if(i._isSecondaryButton=b.which===3||b.button===2,F&&(b.which===2||b.button===1)||N&&(b.which===3||b.button===2))return i.stop(),!1;if(Q){var W=i._window.document.activeElement,oe=b.target;if(oe){var se=oe.tagName.toLowerCase(),he=z9.indexOf(se)>-1,_e=oe.isContentEditable;if(he||_e){if(U||!j&&W===oe)return!1;if(W&&(W===oe||_e&&W.isContentEditable&&W.contains(oe)))if(j)oe.blur();else return!1}else if((O||b.type==="touchstart")&&W){var Ce=W.tagName.toLowerCase();(W.isContentEditable||z9.indexOf(Ce)>-1)&&W.blur()}(H||G||X)&&Wu(i._window,"click",i._onClick,!0)}i.clientStores=[new HA(fw(b))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=x,i._dragFlag=!0,i._prevInputEvent=b,i.data={},i.doubleFlag=qb()-i.prevTime<200,i._isMouseEvent=C1e(b),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var me=i._preventMouseEvent||i.emit("dragStart",xl(xl({data:i.data,datas:i.data,inputEvent:b,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:x,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){b.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));me===!1&&i.stop(),i._isMouseEvent&&i.flag&&O&&b.preventDefault()}if(!i.flag)return!1;var xe=0;if(Q?(i._attchDragEvent(),ae&&M&&(xe=setTimeout(function(){Wu(A,"touchstart",i.onDragStart,{passive:!1})}))):ae&&M&&_u(A,"touchstart",i.onDragStart),i.flag&&T1e(b)){if(clearTimeout(xe),Q&&b.touches.length!==b.changedTouches.length)return;i.pinchFlag||i.onPinchStart(b)}}}},i.onDrag=function(b,x){if(i.flag){var E=i.options.preventDefault;!i._isMouseEvent&&E&&b.preventDefault(),i._prevInputEvent=b;var T=fw(b),A=i.moveClients(T,b,!1);if(i._dragFlag){if(i.pinchFlag||A.deltaX||A.deltaY){var M=i._preventMouseEvent||i.emit("drag",xl(xl({},A),{isScroll:!!x,inputEvent:b}));if(M===!1){i.stop();return}}i.pinchFlag&&i.onPinch(b,T)}i.getCurrentStore().getPosition(T,!0)}},i.onDragEnd=function(b){if(i.flag){var x=i.options,E=x.pinchOutside,T=x.container,A=x.preventClickEventOnDrag,M=x.preventClickEventOnDragStart,F=x.preventClickEventByCondition,N=i.isDrag;(A||M||F)&&requestAnimationFrame(function(){i._allowClickEvent()}),!F&&!M&&A&&!N&&i._allowClickEvent(),i._useTouch&&E&&_u(T,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(b);var O=b?.touches?fw(b):[],U=O.length;U===0||!i.options.keepDragging?i.flag=!1:i._addStore(new HA(O));var j=i._getPosition(),H=qb(),G=!N&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=N||G?0:H,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",xl({data:i.data,datas:i.data,isDouble:G,isDrag:N,isClick:!N,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:b,isTrusted:i._isTrusted},j)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){_u(i._window,"click",i._onClick,!0)},i._onClick=function(b){i._allowClickEvent(),i._allowMouseEvent();var x=i.options.preventClickEventByCondition;x?.(b)||(b.stopPropagation(),b.preventDefault())},i._onContextMenu=function(b){var x=i.options;x.preventRightClick?i.onDragEnd(b):b.preventDefault()},i._passCallback=function(){};var a=[].concat(r),s=a[0];i._window=OZ(s)?s:xg(s),i.options=xl({checkInput:!1,container:s&&!("document"in s)?xg(s):s,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var o=i.options,c=o.container,h=o.events,d=o.checkWindowBlur;if(i._useDrag=h.indexOf("drag")>-1,i._useTouch=h.indexOf("touch")>-1,i._useMouse=h.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(b){Wu(b,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(b){Wu(b,"mousedown",i.onDragStart),Wu(b,"mousemove",i._passCallback)}),Wu(c,"contextmenu",i._onContextMenu)),d&&Wu(xg(),"blur",i.onBlur),i._useTouch){var m={passive:!1};a.forEach(function(b){Wu(b,"touchstart",i.onDragStart,m),Wu(b,"touchmove",i._passCallback,m)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(r){return this.getCurrentStore().getMovement(r)+this.clientStores.slice(1).reduce(function(n,i){return n+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(r,n,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(r,n),a&&this.onDrag(i,!0))},e.prototype.move=function(r,n){var i=r[0],a=r[1],s=this.getCurrentStore(),o=s.prevClients;return this.moveClients(o.map(function(c){var h=c.clientX,d=c.clientY;return{clientX:h+i,clientY:d+a,originalClientX:h,originalClientY:d}}),n,!0)},e.prototype.triggerDragStart=function(r){this.onDragStart(r,!1)},e.prototype.setEventData=function(r){var n=this.data;for(var i in r)n[i]=r[i];return this},e.prototype.setEventDatas=function(r){return this.setEventData(r)},e.prototype.getCurrentEvent=function(r){return r===void 0&&(r=this._prevInputEvent),xl(xl({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:r})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var r=this,n=this.targets,i=this.options.container;this.off(),_u(this._window,"blur",this.onBlur),this._useDrag&&n.forEach(function(a){_u(a,"dragstart",r.onDragStart)}),this._useMouse&&(n.forEach(function(a){_u(a,"mousedown",r.onDragStart)}),_u(i,"contextmenu",this._onContextMenu)),this._useTouch&&(n.forEach(function(a){_u(a,"touchstart",r.onDragStart)}),_u(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(r){var n=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new HA(fw(r));this.pinchFlag=!0,this._addStore(a);var s=this.emit("pinchStart",xl(xl({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:r,isTrusted:this._isTrusted,preventDefault:function(){r.preventDefault()},preventDrag:function(){n._dragFlag=!1}}));s===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(r,n){if(!(!this.flag||!this.pinchFlag||n.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",xl(xl({data:this.data,datas:this.data,movement:this.getMovement(n),angle:i.getAngle(n),rotation:i.getRotation(n),touches:i.getPositions(n),scale:i.getScale(n),distance:i.getDistance(n)},i.getPosition(n)),{inputEvent:r,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(r){if(this.pinchFlag){var n=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",xl(xl({data:this.data,datas:this.data,isPinch:n,touches:i.getPositions()},i.getPosition()),{inputEvent:r}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(r,n,i){var a=this._getPosition(r,i),s=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var o=!1;return!s&&this.isDrag&&(o=!0),xl(xl({data:this.data,datas:this.data},a),{movement:this.getMovement(r),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:n,isTrusted:this._isTrusted,isFirstDrag:o})},e.prototype._addStore=function(r){this.clientStores.splice(0,0,r)},e.prototype._getPosition=function(r,n){var i=this.getCurrentStore(),a=i.getPosition(r,n),s=this.clientStores.slice(1).reduce(function(h,d){var m=d.getPosition();return h.distX+=m.distX,h.distY+=m.distY,h},a),o=s.distX,c=s.distY;return xl(xl({},a),{distX:o,distY:c})},e.prototype._attchDragEvent=function(){var r=this._window,n=this.options.container,i={passive:!1};this._isDragAPI&&(Wu(n,"dragover",this.onDrag,i),Wu(r,"dragend",this.onDragEnd)),this._useMouse&&(Wu(n,"mousemove",this.onDrag),Wu(r,"mouseup",this.onDragEnd)),this._useTouch&&(Wu(n,"touchmove",this.onDrag,i),Wu(r,"touchend",this.onDragEnd,i),Wu(r,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var r=this._window,n=this.options.container;this._isDragAPI&&(_u(n,"dragover",this.onDrag),_u(r,"dragend",this.onDragEnd)),this._useMouse&&(_u(n,"mousemove",this.onDrag),_u(r,"mouseup",this.onDragEnd)),this._useTouch&&(_u(n,"touchstart",this.onDragStart),_u(n,"touchmove",this.onDrag),_u(r,"touchend",this.onDragEnd),_u(r,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(MO);function P1e(t){for(var e=5381,r=t.length;r;)e=e*33^t.charCodeAt(--r);return e>>>0}var k1e=P1e;function R1e(t){return k1e(t).toString(36)}function M1e(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function D1e(t,e,r){return r.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(n,i){var a=i.trim();return(a?km(a):[""]).map(function(s){var o=s.trim();return o.indexOf("@")===0?o:o.indexOf(":global")>-1?o.replace(/\:global/g,""):o.indexOf(":host")>-1?"".concat(o.replace(/\:host/g,".".concat(t))):o?".".concat(t," ").concat(o):".".concat(t)}).join(", ")+" {"})}function O1e(t,e,r,n,i){var a=CO(n),s=a.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",t),s.setAttribute("data-styled-count","1"),r.nonce&&s.setAttribute("nonce",r.nonce),s.innerHTML=D1e(t,e,r),(i||a.head||a.body).appendChild(s),s}function N1e(t){var e="rCS"+R1e(t);return{className:e,inject:function(r,n){n===void 0&&(n={});var i=M1e(r),a=(i||r.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=O1e(e,t,n,r,i);else{var s=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(s+1))}return{destroy:function(){var o,c=parseFloat(a.getAttribute("data-styled-count"))||0;c<=1?(a.remove?a.remove():(o=a.parentNode)===null||o===void 0||o.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(c-1))}}}}}var dR=function(){return dR=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},dR.apply(this,arguments)};function L1e(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function $Z(t,e){var r=N1e(e),n=r.className;return te.forwardRef(function(i,a){var s=i.className,o=s===void 0?"":s;i.cspNonce;var c=L1e(i,["className","cspNonce"]),h=te.useRef();return te.useImperativeHandle(a,function(){return h.current},[]),te.useEffect(function(){var d=r.inject(h.current,{nonce:i.cspNonce});return function(){d.destroy()}},[]),te.createElement(t,dR({ref:h,"data-styled-id":n,className:"".concat(o," ").concat(n)},c))})}var pR=function(t,e){return pR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},pR(t,e)};function zx(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");pR(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Gt=function(){return Gt=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Gt.apply(this,arguments)};function F1e(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function B1e(t,e,r,n){var i=arguments.length,a=i<3?e:n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(a=(i<3?s(a):i>3?s(e,r,a):s(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function z1e(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zt(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,a=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return a}function yn(t,e,r){if(arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}function jx(t,e){return Gt({events:[],props:[],name:t},e)}var j1e=["n","w","s","e"],OO=["n","w","s","e","nw","ne","sw","se"];function U1e(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function V1e(t){var e=U1e(1,t),r=Math.round(t/45)*45%180,n="ns-resize";return r===135?n="nwse-resize":r===45?n="nesw-resize":r===90&&(n="ew-resize"),"cursor:".concat(n,";cursor: url('").concat(e,"') 16 16, ").concat(n,";")}var p_=I_e(),qZ=p_.browser.webkit,HZ=qZ&&(function(){var t=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),WZ=p_.browser.name,GZ=parseInt(p_.browser.version,10),$1e=WZ==="chrome",q1e=p_.browser.chromium,H1e=parseInt(p_.browser.chromiumVersion,10)||0,W1e=$1e&&GZ>=109||q1e&&H1e>=109,G1e=WZ==="firefox",X1e=parseInt(p_.browser.webkitVersion,10)>=612||GZ>=15,NO="moveable-",Y1e=OO.map(function(t){var e="",r="",n="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",i="top"),t.indexOf("w")>-1&&(r="left: ".concat(a,";"),n="right"),t.indexOf("e")>-1&&(r="left: 0px;",n="left"),'.around-control[data-direction*="'.concat(t,`"] {
        `).concat(r).concat(e,`
        transform-origin: `).concat(n," ").concat(i,`;
    }`)}).join(`
`),Z1e=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(Y1e,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return`
.direction[data-rotation="`.concat(t,'"], :global .view-control-rotation').concat(t,` {
`).concat(V1e(t),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(HZ?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),K1e=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],gR=1e-4,bc=1e-7,dw=1e-9,mR=Math.pow(10,10),j9=-mR,J1e={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},LO={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},XZ={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},Q1e=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Ux(t,e,r,n,i,a){var s,o;a===void 0&&(a="draggable");var c=(o=(s=e.gestos[a])===null||s===void 0?void 0:s.move(r,t.inputEvent))!==null&&o!==void 0?o:{},h=c.originalDatas||c.datas,d=h[a]||(h[a]={});return Gt(Gt({},c),{isPinch:!!n,parentEvent:!0,datas:d,originalDatas:t.originalDatas})}var $0=(function(){function t(e){var r;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(r={},r[e]={},r)}return t.prototype.dragStart=function(e,r){this.isDrag=!1,this.isFlag=!1;var n=r.originalDatas;return this.datas=n,n[this.ableName]||(n[this.ableName]={}),Gt(Gt({},this.move(e,r.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(e,r){return this.move([e[0]-this.prevX,e[1]-this.prevY],r)},t.prototype.move=function(e,r){var n,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],n=e[0],i=e[1],this.isFlag=!0;else{var s=this.isDrag;n=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!s&&this.isDrag&&(a=!0)}return this.prevX=n,this.prevY=i,{type:"drag",clientX:n,clientY:i,inputEvent:r,isFirstDrag:a,isDrag:this.isDrag,distX:n-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t})();function A0(t,e,r,n){var i=t.length===16,a=i?4:3,s=Ey(t,r,n,a),o=Zt(s,4),c=Zt(o[0],2),h=c[0],d=c[1],m=Zt(o[1],2),b=m[0],x=m[1],E=Zt(o[2],2),T=E[0],A=E[1],M=Zt(o[3],2),F=M[0],N=M[1],O=Zt(bs(t,e,a),2),U=O[0],j=O[1],H=Math.min(h,b,T,F),G=Math.min(d,x,A,N),X=Math.max(h,b,T,F),ae=Math.max(d,x,A,N);h=h-H||0,b=b-H||0,T=T-H||0,F=F-H||0,d=d-G||0,x=x-G||0,A=A-G||0,N=N-G||0,U=U-H||0,j=j-G||0;var Q=t[0],W=t[a+1],oe=gc(Q*W);return{left:H,top:G,right:X,bottom:ae,origin:[U,j],pos1:[h,d],pos2:[b,x],pos3:[T,A],pos4:[F,N],direction:oe}}function YZ(t,e){var r=e.clientX,n=e.clientY,i=e.datas,a=t.state,s=a.moveableClientRect,o=a.rootMatrix,c=a.is3d,h=a.pos1,d=s.left,m=s.top,b=c?4:3,x=Zt(_i(W0(o,[r-d,n-m],b),h),2),E=x[0],T=x[1],A=Zt(Rd({datas:i,distX:E,distY:T}),2),M=A[0],F=A[1];return[M,F]}function Sy(t,e){var r=e.datas,n=t.state,i=n.allMatrix,a=n.beforeMatrix,s=n.is3d,o=n.left,c=n.top,h=n.origin,d=n.offsetMatrix,m=n.targetMatrix,b=n.transformOrigin,x=s?4:3;r.is3d=s,r.matrix=i,r.targetMatrix=m,r.beforeMatrix=a,r.offsetMatrix=d,r.transformOrigin=b,r.inverseMatrix=Ed(i,x),r.inverseBeforeMatrix=Ed(a,x),r.absoluteOrigin=Qm(Ma([o,c],h),x),r.startDragBeforeDist=tc(r.inverseBeforeMatrix,r.absoluteOrigin,x),r.startDragDist=tc(r.inverseMatrix,r.absoluteOrigin,x)}function ebe(t){return A0(t.datas.beforeTransform,[50,50],100,100).direction}function r3(t,e,r){var n=e.datas,i=e.originalDatas.beforeRenderable,a=n.transformIndex,s=i.nextTransforms,o=s.length,c=i.nextTransformAppendedIndexes,h=-1;a===-1?(r==="translate"?h=0:r==="rotate"&&(h=Sp(s,function(x){return x.match(/scale\(/g)})),h===-1&&(h=s.length),n.transformIndex=h):hh(c,function(x){return x.index===a&&x.functionName===r})?h=a:h=a+c.filter(function(x){return x.index<a}).length;var d=Cxe(s,t.state,h),m=d.targetFunction,b=r==="rotate"?"rotateZ":r;n.beforeFunctionTexts=d.beforeFunctionTexts,n.afterFunctionTexts=d.afterFunctionTexts,n.beforeTransform=d.beforeFunctionMatrix,n.beforeTransform2=d.beforeFunctionMatrix2,n.targetTansform=d.targetFunctionMatrix,n.afterTransform=d.afterFunctionMatrix,n.afterTransform2=d.afterFunctionMatrix2,n.targetAllTransform=d.allFunctionMatrix,m.functionName===b?(n.afterFunctionTexts.splice(0,1),n.isAppendTransform=!1):o>h&&(n.isAppendTransform=!0,i.nextTransformAppendedIndexes=yn(yn([],Zt(c),!1),[{functionName:r,index:h,isAppend:!0}],!1))}function n3(t,e,r){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?r:e," ").concat(t.afterFunctionTexts.join(" "))}function tbe(t){var e=t.datas,r=t.distX,n=t.distY,i=Zt(KZ({datas:e,distX:r,distY:n}),2),a=i[0],s=i[1],o=ZZ(e,K_e([a,s],4));return tc(o,Qm([0,0,0],4),4)}function ZZ(t,e,r){var n=t.beforeTransform,i=t.afterTransform,a=t.beforeTransform2,s=t.afterTransform2,o=t.targetAllTransform,c=r?wo(o,e,4):wo(e,o,4),h=wo(Ed(r?a:n,4),c,4),d=wo(h,Ed(r?s:i,4),4);return d}function KZ(t){var e=t.datas,r=t.distX,n=t.distY,i=e.inverseBeforeMatrix,a=e.is3d,s=e.startDragBeforeDist,o=e.absoluteOrigin,c=a?4:3;return _i(tc(i,Ma(o,[r,n]),c),s)}function Rd(t,e){var r=t.datas,n=t.distX,i=t.distY,a=r.inverseBeforeMatrix,s=r.inverseMatrix,o=r.is3d,c=r.startDragBeforeDist,h=r.startDragDist,d=r.absoluteOrigin,m=o?4:3;return _i(tc(e?a:s,Ma(d,[n,i]),m),e?c:h)}function rbe(t,e){var r=t.datas,n=t.distX,i=t.distY;r.beforeMatrix;var a=r.matrix,s=r.is3d;r.startDragBeforeDist;var o=r.startDragDist,c=r.absoluteOrigin,h=s?4:3;return _i(tc(a,Ma(o,[n,i]),h),c)}function nbe(t,e,r,n,i,a){return n===void 0&&(n=e),i===void 0&&(i=r),a===void 0&&(a=[0,0]),t?t.map(function(s,o){var c=Lx(s),h=c.value,d=c.unit,m=o?i:n,b=o?r:e;if(s==="%"||isNaN(h)){var x=m?a[o]/m:0;return b*x}else if(d!=="%")return h;return b*h/100}):a}function JZ(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function ibe(t,e){return JZ(e).map(function(r){return t[r]})}function WA(t,e){var r=(e+1)/2;return[eE(t[0][0],t[1][0],r,1-r),eE(t[0][1],t[1][1],r,1-r)]}function zl(t,e){var r=WA([t[0],t[1]],e[0]),n=WA([t[2],t[3]],e[0]);return WA([r,n],e[1])}function abe(t,e,r,n,i,a){var s=Ey(e,r,n,i),o=zl(s,a),c=t[0]-o[0],h=t[1]-o[1];return[c,h]}function Vx(t,e,r,n){return wo(t,gb(e,n,r),n)}function obe(t,e,r,n){var i=t.transformOrigin,a=t.offsetMatrix,s=t.is3d,o=s?4:3,c;if(kp(r)){var h=e.beforeTransform,d=e.afterTransform;n?c=Af(Hb(r),4,o):c=Af(wo(wo(h,Hb([r]),4),d,4),4,o)}else c=r;return Vx(a,c,i,o)}function sbe(t,e){var r=t.transformOrigin,n=t.offsetMatrix,i=t.is3d,a=t.targetMatrix,s=t.targetAllTransform,o=i?4:3;return Vx(n,wo(s||a,PO(e,o),o),r,o)}function i3(t,e){var r=g_(e);return{setTransform:function(n,i){i===void 0&&(i=-1),r.startTransforms=su(n)?n:Cg(n),yR(t,e,i)},setTransformIndex:function(n){yR(t,e,n)}}}function a3(t,e,r){var n=g_(e),i=n.startTransforms;yR(t,e,Sp(i,function(a){return a.indexOf("".concat(r,"("))===0}))}function yR(t,e,r){var n=g_(e),i=e.datas;if(i.transformIndex=r,r!==-1){var a=n.startTransforms[r];if(a){var s=t.state,o=V0([a],{"x%":function(c){return c/100*s.offsetWidth},"y%":function(c){return c/100*s.offsetHeight}});i.startValue=o[0].functionValue}}}function FO(t,e){var r=g_(t);r.nextTransforms=Cg(e)}function g_(t){return t.originalDatas.beforeRenderable}function nE(t){var e=t.originalDatas.beforeRenderable;return e.nextTransforms}function pw(t){return(nE(t)||[]).join(" ")}function gw(t){return g_(t).nextStyle}function QZ(t,e,r,n,i){FO(i,e);var a=pc.drag(t,Ux(i,t.state,r,n)),s=a?a.transform:e;return Gt(Gt({transform:e,drag:a},yc({transform:s},i)),{afterTransform:s})}function BO(t,e,r,n,i,a){var s=obe(t.state,i,e,a),o=cbe(t,r,n,s);return o}function eK(t,e,r,n,i,a,s){var o=BO(t,e,r,i,a,s),c=t.state,h=c.left,d=c.top,m=t.props.groupable,b=m?h:0,x=m?d:0,E=_i(n,o);return _i(E,[b,x])}function lbe(t,e,r,n,i,a,s){var o=eK(t,e,r,n,i,a,s);return o}function ube(t,e,r){return[e?-1+t[0]/(e/2):0,r?-1+t[1]/(r/2):0]}function cbe(t,e,r,n){n===void 0&&(n=t.state.allMatrix);var i=t.state,a=i.width,s=i.height,o=i.is3d,c=o?4:3,h=[a/2*(1+e[0])+r[0],s/2*(1+e[1])+r[1]];return bs(n,h,c)}function hbe(t,e,r){var n=r.fixedDirection,i=r.fixedPosition,a=r.fixedOffset;return eK(t,"rotate(".concat(e,"deg)"),n,i,a,r)}function fbe(t,e,r,n,i,a){var s=t.props.groupable,o=t.state,c=o.transformOrigin,h=o.offsetMatrix,d=o.is3d,m=o.width,b=o.height,x=o.left,E=o.top,T=a.fixedDirection,A=a.nextTargetMatrix||o.targetMatrix,M=d?4:3,F=nbe(i,e,r,m,b,c),N=s?x:0,O=s?E:0,U=Vx(h,A,F,M),j=abe(n,U,e,r,M,T);return _i(j,[N,O])}function dbe(t,e){return zl(Wh(t.state),e)}function pbe(t,e){var r=t.targetGesto,n=t.controlGesto,i;return r?.isFlag()&&(i=r.getEventData()[e]),!i&&n?.isFlag()&&(i=n.getEventData()[e]),i||{}}function gbe(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function mbe(t){var e=t("scale"),r=t("rotate"),n=t("translate"),i=[];return n&&n!=="0px"&&n!=="none"&&i.push("translate(".concat(n.split(/\s+/).join(","),")")),r&&r!=="1"&&r!=="none"&&i.push("rotate(".concat(r,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function tK(t,e,r){for(var n=t,i=[],a=AO(t)||zg(t),s=!r&&t===e||t===a,o=s,c=!1,h=3,d,m,b,x=!1,E=Gb(e,e,!0).offsetParent,T=1;n&&!o;){o=s;var A=Nc(n),M=A("position"),F=TK(n),N=M==="fixed",O=mbe(A),U=J_e(dxe(F)),j=void 0,H=!1,G=!1,X=0,ae=0,Q=0,W=0,oe={hasTransform:!1,fixedContainer:null};N&&(x=!0,oe=vxe(n),E=oe.fixedContainer);var se=U.length;!c&&(se===16||O.length)&&(c=!0,h=4,SR(i),b&&(b=Af(b,3,4))),c&&se===9&&(U=Af(U,3,4));var he=yxe(n,t),_e=he.tagName,Ce=he.hasOffset,me=he.isSVG,xe=he.origin,Ae=he.targetOrigin,De=he.offset,de=Zt(De,2),Ee=de[0],we=de[1];_e==="svg"&&!n.ownerSVGElement&&b&&(i.push({type:"target",target:n,matrix:_xe(n,h)}),i.push({type:"offset",target:n,matrix:Jo(h)}));var Le=parseFloat(A("zoom"))||1;if(N)j=oe.fixedContainer,H=!0;else{var Fe=Gb(n,e,!1,!0,A),Xe=Fe.offsetZoom;if(j=Fe.offsetParent,H=Fe.isEnd,G=Fe.isStatic,T*=Xe,(Fe.isCustomElement||Xe!==1)&&G)Ee-=j.offsetLeft,we-=j.offsetTop;else if(G1e||W1e){var Be=Fe.parentSlotElement;if(Be){for(var ot=j,Qe=0,rt=0;ot&&gbe(ot);)Qe+=ot.offsetLeft,rt+=ot.offsetTop,ot=ot.offsetParent;Ee-=Qe,we-=rt}}}if(qZ&&!X1e&&Ce&&!me&&G&&(M==="relative"||M==="static")&&(Ee-=j.offsetLeft,we-=j.offsetTop,s=s||H),N)Ce&&oe.hasTransform&&(Q=j.clientLeft,W=j.clientTop);else if(Ce&&E!==j&&(X=j.clientLeft,ae=j.clientTop),Ce&&j===a){var Re=CK(n,!1);Ee+=Re[0],we+=Re[1]}if(i.push({type:"target",target:n,matrix:gb(U,h,xe)}),O.length&&(i.push({type:"offset",target:n,matrix:Jo(h)}),i.push({type:"target",target:n,matrix:gb(Hb(O),h,xe)})),Ce){var zt=n===t,st=zt?0:n.scrollLeft,$e=zt?0:n.scrollTop;i.push({type:"offset",target:n,matrix:ey([Ee-st+X-Q,we-$e+ae-W],h)})}else i.push({type:"offset",target:n,origin:xe});if(Le!==1&&i.push({type:"zoom",target:n,matrix:gb(PO([Le,Le],h),h,[0,0])}),b||(b=U),d||(d=xe),m||(m=Ae),o||N)break;n=j,s=H,(!r||n===a)&&(o=s)}return b||(b=Jo(h)),d||(d=[0,0]),m||(m=[0,0]),{zoom:T,offsetContainer:E,matrixes:i,targetMatrix:b,transformOrigin:d,targetOrigin:m,is3d:c,hasFixed:x}}var Sm=null,Em=null,l0=null;function q0(t){t?(window.Map&&(Sm=new Map,Em=new Map),l0=[]):(Sm=null,l0=null,Em=null)}function ybe(t){var e=Em?.get(t);if(e)return e;var r=mb(t,!0);return Em&&Em.set(t,r),r}function vbe(t,e){if(l0){var r=hh(l0,function(i){return i[0][0]==t&&i[0][1]==e});if(r)return r[1]}var n=tK(t,e,!0);return l0&&l0.push([[t,e],n]),n}function Nc(t){var e=Sm?.get(t);if(!e){var r=xg(t).getComputedStyle(t);if(!Sm)return function(a){return r[a]};e={style:r,cached:{}},Sm.set(t,e)}var n=e.cached,i=e.style;return function(a){return a in n||(n[a]=i[a]),n[a]}}function Ef(t,e,r){var n=r.originalDatas;n.groupable=n.groupable||{};var i=n.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return t.moveables.map(function(s,o){return a[o]=a[o]||{},a[o][e]=a[o][e]||{},Gt(Gt({},r),{isRequestChild:!0,datas:a[o][e],originalDatas:a[o]})})}function GA(t,e,r,n,i,a,s){var o=!!r.match(/Start$/g),c=!!r.match(/End$/g),h=i.isPinch,d=i.datas,m=Ef(t,e.name,i),b=t.moveables,x=[],E=m.map(function(T,A){var M=b[A],F=M.state,N=F.gestos,O=T;if(o)O=new $0(s).dragStart(n,T),x.push(O);else{if(N[s]||(N[s]=d.childGestos[A]),!N[s])return;O=Ux(T,F,n,h,a,s),x.push(O)}var U=e[r](M,Gt(Gt({},O),{parentFlag:!0}));return c&&(N[s]=null),U});return o&&(d.childGestos=b.map(function(T){return T.state.gestos[s]})),{eventParams:E,childEvents:x}}function mp(t,e,r,n,i,a){i===void 0&&(i=function(d,m){return m});var s=!!r.match(/End$/g),o=Ef(t,e.name,n),c=t.moveables,h=o.map(function(d,m){var b=c[m],x=d;x=i(b,d);var E=e[r](b,Gt(Gt({},x),{parentFlag:!0}));return s&&(b.state.gestos={}),E});return h}function iE(t,e,r,n){var i=r.fixedDirection,a=r.fixedPosition,s=n.datas.startPositions||Wh(e.state),o=zl(s,i),c=Zt(tc(Bx(-t.rotation/180*Math.PI,3),[o[0]-a[0],o[1]-a[1],1],3),2),h=c[0],d=c[1];return n.datas.originalX=h,n.datas.originalY=d,n}function rK(t,e,r,n){var i=t.getState(),a=i.renderPoses,s=i.rotation,o=i.direction,c=ry(t.props,e).zoom,h=pb(s/Math.PI*180),d={},m=t.renderState;m.renderDirectionMap||(m.renderDirectionMap={});var b=m.renderDirectionMap;r.forEach(function(E){var T=E.dir;d[T]=!0});var x=gc(o);return r.map(function(E){var T=E.data,A=E.classNames,M=E.dir,F=LO[M];if(!F||!d[M])return null;b[M]=!0;var N=(Fi(h,15)+x*XZ[M]+720)%180,O={};return d_(T).forEach(function(U){O["data-".concat(U)]=T[U]}),n.createElement("div",Gt({className:yi.apply(void 0,yn(["control","direction",M,e],Zt(A),!1)),"data-rotation":N,"data-direction":M},O,{key:"direction-".concat(M),style:lE.apply(void 0,yn([s,c],Zt(F.map(function(U){return a[U]})),!1))}))})}function nK(t,e,r,n){var i=ry(t.props,r),a=i.renderDirections,s=a===void 0?e:a,o=i.displayAroundControls;if(!s)return[];var c=s===!0?OO:s;return yn(yn([],Zt(o?sK(t,n,r,c):[]),!1),Zt(rK(t,r,c.map(function(h){return{data:{},classNames:[],dir:h}}),n)),!1)}function Wb(t,e,r,n,i,a){for(var s=[],o=6;o<arguments.length;o++)s[o-6]=arguments[o];var c=il(r,n),h=e?Fi(c/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(a),className:yi.apply(void 0,yn(["line","direction",e?"edge":"",e],Zt(s),!1)),"data-rotation":h,"data-line-key":a,"data-direction":e,style:L1(r,n,i,c)})}function iK(t,e,r,n,i){var a=r===!0?j1e:r;return a.map(function(s,o){var c=Zt(LO[s],2),h=c[0],d=c[1];if(d!=null)return Wb(t,s,n[h],n[d],i,"".concat(e,"Edge").concat(o),e)}).filter(Boolean)}function aK(t){return function(e,r){var n=ry(e.props,t).edge;return n&&(n===!0||n.length)?yn(yn([],Zt(iK(r,t,n,e.getState().renderPoses,e.props.zoom)),!1),Zt(_be(e,t,r)),!1):oK(e,t,r)}}function oK(t,e,r){return nK(t,OO,e,r)}function _be(t,e,r){return nK(t,["nw","ne","sw","se"],e,r)}function sK(t,e,r,n){var i=t.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=t.getState(),s=a.renderPoses,o=a.rotation,c=a.direction,h=i.renderDirectionMap,d=t.props.zoom,m=gc(c),b=o/Math.PI*180;return(n||d_(h)).map(function(x){var E=LO[x];if(!E)return null;var T=(Fi(b,15)+m*XZ[x]+720)%180,A=["around-control"];return r&&A.push("direction",r),e.createElement("div",{className:yi.apply(void 0,yn([],Zt(A),!1)),"data-rotation":T,"data-direction":x,key:"direction-around-".concat(x),style:lE.apply(void 0,yn([o,d],Zt(E.map(function(M){return s[M]})),!1))})})}function zO(t,e,r){var n=t||{},i=n.position,a=i===void 0?"client":i,s=n.left,o=s===void 0?-1/0:s,c=n.top,h=c===void 0?-1/0:c,d=n.right,m=d===void 0?1/0:d,b=n.bottom,x=b===void 0?1/0:b,E={position:a,left:o,top:h,right:m,bottom:x};return{vertical:U9(E,e,!0),horizontal:U9(E,r,!1)}}function o3(t,e){var r=t.state,n=r.containerClientRect,i=n.clientHeight,a=n.clientWidth,s=n.clientLeft,o=n.clientTop,c=r.snapOffset,h=c.left,d=c.top,m=c.right,b=c.bottom,x=e||t.props.bounds||{},E=x.position||"client",T=E==="css",A=x.left,M=A===void 0?-1/0:A,F=x.top,N=F===void 0?-1/0:F,O=x.right,U=O===void 0?T?-1/0:1/0:O,j=x.bottom,H=j===void 0?T?-1/0:1/0:j;return T&&(U=a+m-h-U,H=i+b-d-H),{left:M+h-s,right:U+h-s,top:N+d-o,bottom:H+d-o}}function bbe(t,e,r){var n=o3(t),i=n.left,a=n.top,s=n.right,o=n.bottom,c=Zt(r,2),h=c[0],d=c[1],m=Zt(_i(r,e),2),b=m[0],x=m[1];nn(b)<bc&&(b=0),nn(x)<bc&&(x=0);var E=x>0,T=b>0,A={isBound:!1,offset:0,pos:0},M={isBound:!1,offset:0,pos:0};if(b===0&&x===0)return{vertical:A,horizontal:M};if(b===0)E?o<d&&(M.pos=o,M.offset=d-o):a>d&&(M.pos=a,M.offset=d-a);else if(x===0)T?s<h&&(A.pos=s,A.offset=h-s):i>h&&(A.pos=i,A.offset=h-i);else{var F=x/b,N=r[1]-F*h,O=0,U=0,j=!1;T&&s<=h?(O=F*s+N,U=s,j=!0):!T&&h<=i&&(O=F*i+N,U=i,j=!0),j&&(O<a||O>o)&&(j=!1),j||(E&&o<=d?(O=o,U=(O-N)/F,j=!0):!E&&d<=a&&(O=a,U=(O-N)/F,j=!0)),j&&(A.isBound=!0,A.pos=U,A.offset=h-U,M.isBound=!0,M.pos=O,M.offset=d-O)}return{vertical:A,horizontal:M}}function U9(t,e,r){var n=t[r?"left":"top"],i=t[r?"right":"bottom"],a=Math.min.apply(Math,yn([],Zt(e),!1)),s=Math.max.apply(Math,yn([],Zt(e),!1)),o=[];return n+1>a&&o.push({direction:"start",isBound:!0,offset:a-n,pos:n}),i-1<s&&o.push({direction:"end",isBound:!0,offset:s-i,pos:i}),o.length||o.push({isBound:!1,offset:0,pos:0}),o.sort(function(c,h){return nn(h.offset)-nn(c.offset)})}function V9(t,e,r){var n=r?t.map(function(i){return Fx(i,r)}):t;return n.some(function(i){return i[0]<e.left&&nn(i[0]-e.left)>.1||i[0]>e.right&&nn(i[0]-e.right)>.1||i[1]<e.top&&nn(i[1]-e.top)>.1||i[1]>e.bottom&&nn(i[1]-e.bottom)>.1})}function xbe(t,e,r){var n=Hh(t),i=Math.sqrt(n*n-e*e)||0;return[i,-i].sort(function(a,s){return nn(a-t[r?0:1])-nn(s-t[r?0:1])}).map(function(a){return il([0,0],r?[a,e]:[e,a])})}function wbe(t,e,r,n,i){if(!t.props.bounds)return[];var a=i*Math.PI/180,s=o3(t),o=s.left,c=s.top,h=s.right,d=s.bottom,m=o-n[0],b=h-n[0],x=c-n[1],E=d-n[1],T={left:m,top:x,right:b,bottom:E};if(!V9(r,T,0))return[];var A=[];return[[m,0],[b,0],[x,1],[E,1]].forEach(function(M){var F=Zt(M,2),N=F[0],O=F[1];r.forEach(function(U){var j=il([0,0],U);A.push.apply(A,yn([],Zt(xbe(U,N,O).map(function(H){return a+H-j}).filter(function(H){return!V9(e,T,H)}).map(function(H){return Fi(H*180/Math.PI,bc)})),!1))})}),A}var Sbe=["left","right","center"],Ebe=["top","bottom","middle"],$9={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},Ag={start:"left",end:"right",center:"center"},Ig={start:"top",end:"bottom",center:"middle"};function u0(){return{left:!1,top:!1,right:!1,bottom:!1}}function m_(t,e){var r=t.props,n=r.snappable,i=r.bounds,a=r.innerBounds,s=r.verticalGuidelines,o=r.horizontalGuidelines,c=r.snapGridWidth,h=r.snapGridHeight,d=t.state,m=d.guidelines,b=d.enableSnap;return!n||!b||e&&n!==!0&&n.indexOf(e)<0?!1:!!(c||h||i||a||m&&m.length||s&&s.length||o&&o.length)}function jO(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function Tbe(t,e){var r=jO(t),n={};for(var i in r)i in e&&r[i]&&(n[i]=e[i]);return n}function UO(t,e){var r=Tbe(t,e),n=Ebe.filter(function(a){return a in r}),i=Sbe.filter(function(a){return a in r});return{horizontalNames:n,verticalNames:i,horizontal:n.map(function(a){return r[a]}),vertical:i.map(function(a){return r[a]})}}function Cbe(t,e,r){var n=bs(t,[e.clientLeft,e.clientTop],r);return[e.left+n[0],e.top+n[1]]}function Abe(t){var e=Zt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];Math.abs(i)<Tl&&(i=0),Math.abs(a)<Tl&&(a=0);var s=0,o=0,c=0;return i?a?(s=-a/i,o=1,c=s*r[0]-r[1]):(o=1,c=-r[1]):(s=-1,c=r[0]),[s,o,c].map(function(h){return Fi(h,Tl)})}var lK="snapRotationThreshold",uK="snapRotationDegrees",cK="snapHorizontalThreshold",hK="snapVerticalThreshold";function s3(t,e,r,n,i,a,s){var o;n===void 0&&(n=[]),i===void 0&&(i=[]);var c=t.props,h=((o=t.state.snapThresholdInfo)===null||o===void 0?void 0:o.multiples)||[1,1],d=i7(s,c[cK],5),m=i7(a,c[hK],5);return fK(t.state.guidelines,e,r,n,i,d,m,h)}function fK(t,e,r,n,i,a,s,o){return{vertical:H9(t,"vertical",e,s*o[0],n),horizontal:H9(t,"horizontal",r,a*o[1],i)}}function Ibe(t,e,r){var n=Zt(r,2),i=n[0],a=n[1],s=Zt(e,2),o=s[0],c=s[1],h=Zt(_i(r,e),2),d=h[0],m=h[1],b=m>0,x=d>0;d=uE(d),m=uE(m);var E={isSnap:!1,offset:0,pos:0},T={isSnap:!1,offset:0,pos:0};if(d===0&&m===0)return{vertical:E,horizontal:T};var A=s3(t,d?[i]:[],m?[a]:[],[],[],void 0,void 0),M=A.vertical,F=A.horizontal;M.posInfos.filter(function(_e){var Ce=_e.pos;return x?Ce>=o:Ce<=o}),F.posInfos.filter(function(_e){var Ce=_e.pos;return b?Ce>=c:Ce<=c}),M.isSnap=M.posInfos.length>0,F.isSnap=F.posInfos.length>0;var N=vR(M),O=N.isSnap,U=N.guideline,j=vR(F),H=j.isSnap,G=j.guideline,X=H?G.pos[1]:0,ae=O?U.pos[0]:0;if(d===0)H&&(T.isSnap=!0,T.pos=G.pos[1],T.offset=a-T.pos);else if(m===0)O&&(E.isSnap=!0,E.pos=ae,E.offset=i-ae);else{var Q=m/d,W=r[1]-Q*i,oe=0,se=0,he=!1;O?(se=ae,oe=Q*se+W,he=!0):H&&(oe=X,se=(oe-W)/Q,he=!0),he&&(E.isSnap=!0,E.pos=se,E.offset=i-se,T.isSnap=!0,T.pos=oe,T.offset=a-oe)}return{vertical:E,horizontal:T}}function pg(t){var e="";return t===-1||t==="top"||t==="left"?e="start":t===0||t==="center"||t==="middle"?e="center":(t===1||t==="right"||t==="bottom")&&(e="end"),e}function q9(t,e,r,n){var i=UO(t.props.snapDirections,e),a=s3(t,i.vertical,i.horizontal,i.verticalNames.map(function(c){return pg(c)}),i.horizontalNames.map(function(c){return pg(c)}),r,n),s=pg(i.horizontalNames[a.horizontal.index]),o=pg(i.verticalNames[a.vertical.index]);return{vertical:Gt(Gt({},a.vertical),{direction:o}),horizontal:Gt(Gt({},a.horizontal),{direction:s})}}function vR(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var r=t.posInfos[0],n=r.guidelineInfos[0],i=n.offset,a=n.dist,s=n.guideline;return{isSnap:e,offset:i,dist:a,pos:r.pos,guideline:s}}function H9(t,e,r,n,i){var a,s;if(i===void 0&&(i=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var o=e==="vertical",c=o?0:1,h=r.map(function(m,b){var x=i[b]||"",E=t.map(function(T){var A=T.pos,M=m-A[c];return{offset:M,dist:nn(M),guideline:T,direction:x}}).filter(function(T){var A=T.guideline,M=T.dist,F=A.type;return!(F!==e||M>n)}).sort(function(T,A){return T.dist-A.dist});return{pos:m,index:b,guidelineInfos:E,direction:x}}).filter(function(m){return m.guidelineInfos.length>0}).sort(function(m,b){return m.guidelineInfos[0].dist-b.guidelineInfos[0].dist}),d=h.length>0;return{isSnap:d,index:d?h[0].index:-1,direction:(s=(a=h[0])===null||a===void 0?void 0:a.direction)!==null&&s!==void 0?s:"",posInfos:h}}function Pbe(t,e,r,n,i){var a=[];r[0]&&r[1]?a=[r,[-r[0],r[1]],[r[0],-r[1]]]:!r[0]&&!r[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(b,x,E){var T=E[x+1]||E[0];a.push(b),a.push([(b[0]+T[0])/2,(b[1]+T[1])/2])}):t.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],r):(a.push.apply(a,yn([],Zt(ibe([[-1,-1],[1,-1],[-1,-1],[1,1]],r)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var s=a.map(function(b){return zl(e,b)}),o=s.map(function(b){return b[0]}),c=s.map(function(b){return b[1]}),h=s3(t,o,c,a.map(function(b){return pg(b[0])}),a.map(function(b){return pg(b[1])}),n,i),d=pg(a.map(function(b){return b[0]})[h.vertical.index]),m=pg(a.map(function(b){return b[1]})[h.horizontal.index]);return{vertical:Gt(Gt({},h.vertical),{direction:d}),horizontal:Gt(Gt({},h.horizontal),{direction:m})}}function dK(t,e){var r=nn(t.offset),n=nn(e.offset);return t.isBound&&e.isBound?n-r:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?n-r:t.isSnap?-1:e.isSnap||r<bc?1:n<bc?-1:r-n}function aE(t,e){return t.slice().sort(function(r,n){var i=r.sign[e],a=n.sign[e],s=r.offset[e],o=n.offset[e];if(i){if(!a)return-1}else return 1;return dK({isBound:r.isBound,isSnap:r.isSnap,offset:s},{isBound:n.isBound,isSnap:n.isSnap,offset:o})})[0]}function kbe(t,e,r){var n=[];if(r)nn(e[0])!==1||nn(e[1])!==1?n.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):n.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),n.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var i=t[0]?t:[1,1];[1,-1].forEach(function(s){[1,-1].forEach(function(o){var c=[s*i[0],o*i[1]];e[0]===c[0]&&e[1]===c[1]||n.push([e,c])})})}else if(t[0]){var a=nn(e[0])===1?[1]:[1,-1];a.forEach(function(s){n.push([[e[0],-1],[s*t[0],-1]],[[e[0],0],[s*t[0],0]],[[e[0],1],[s*t[0],1]])})}else if(t[1]){var a=nn(e[1])===1?[1]:[1,-1];a.forEach(function(o){n.push([[-1,e[1]],[-1,o*t[1]]],[[0,e[1]],[0,o*t[1]]],[[1,e[1]],[1,o*t[1]]])})}return n}function pK(t,e){var r=oR([e[0][0],e[1][0]]),n=oR([e[0][1],e[1][1]]);return{vertical:r<=t[0],horizontal:n<=t[1]}}function VO(t,e){var r=Zt(e,2),n=r[0],i=r[1],a=i[0]-n[0],s=i[1]-n[1];nn(a)<bc&&(a=0),nn(s)<bc&&(s=0);var o,c;if(!a)o=n[0],c=t[0];else if(!s)o=n[1],c=t[1];else{var h=s/a;o=h*(t[0]-n[0])+n[1],c=t[1]}return o-c}function gK(t,e,r,n){return n===void 0&&(n=bc),t.every(function(i){var a=VO(i,e),s=a<=0;return s===r||nn(a)<=n})}function W9(t,e,r,n,i){return i===void 0&&(i=0),n&&e-i<=t||!n&&t<=r+i?{isBound:!0,offset:n?e-t:r-t}:{isBound:!1,offset:0}}function Rbe(t,e){var r=e.line,n=e.centerSign,i=e.verticalSign,a=e.horizontalSign,s=e.lineConstants,o=t.props.innerBounds;if(!o)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var c=o.left,h=o.top,d=o.width,m=o.height,b=[[c,h],[c,h+m]],x=[[c,h],[c+d,h]],E=[[c+d,h],[c+d,h+m]],T=[[c,h+m],[c+d,h+m]];if(gK([[c,h],[c+d,h],[c,h+m],[c+d,h+m]],r,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var A=gg(r,s,x,i),M=gg(r,s,T,i),F=gg(r,s,b,a),N=gg(r,s,E,a),O=A.isBound&&M.isBound,U=A.isBound||M.isBound,j=F.isBound&&N.isBound,H=F.isBound||N.isBound,G=H0(A.offset,M.offset),X=H0(F.offset,N.offset),ae=[0,0],Q=!1,W=!1;return nn(X)<nn(G)?(ae=[G,0],Q=U,W=O):(ae=[0,X],Q=H,W=j),{isAllBound:W,isVerticalBound:U,isHorizontalBound:H,isBound:Q,offset:ae}}function gg(t,e,r,n,i,a){var s=Zt(e,2),o=s[0],c=s[1],h=t[0],d=r[0],m=r[1],b=uE(m[1]-d[1]),x=uE(m[0]-d[0]),E=c,T=o,A=-o/c;if(x){if(!b){if(a&&!E)return{isBound:!1,offset:0};if(T){var O=(d[1]-h[1])/A+h[0];return W9(O,d[0],m[0],n,i)}else{var F=d[1]-h[1],N=nn(F)<=(i||0);return{isBound:N,offset:N?F:0}}}}else{if(a&&!T)return{isBound:!1,offset:0};if(E){var M=A*(d[0]-h[0])+h[1];return W9(M,d[1],m[1],n,i)}else{var F=d[0]-h[0],N=nn(F)<=(i||0);return{isBound:N,offset:N?F:0}}}return{isBound:!1,offset:0}}function mK(t,e,r){return e.map(function(n){var i=Rbe(t,n),a=i.isBound,s=i.offset,o=i.isVerticalBound,c=i.isHorizontalBound,h=n.multiple,d=Rd({datas:r,distX:s[0],distY:s[1]}).map(function(m,b){return m*(h[b]?2/h[b]:0)});return{sign:h,isBound:a,isVerticalBound:o,isHorizontalBound:c,isSnap:!1,offset:d}})}function Mbe(t,e,r){var n,i=$O(t,e,[0,0],!1).map(function(b){return Gt(Gt({},b),{multiple:b.multiple.map(function(x){return nn(x)*2})})}),a=mK(t,i,r),s=aE(a,0),o=aE(a,1),c=0,h=0,d=s.isVerticalBound||o.isVerticalBound,m=s.isHorizontalBound||o.isHorizontalBound;return(d||m)&&(n=Zt(rbe({datas:r,distX:-s.offset[0],distY:-o.offset[1]}),2),c=n[0],h=n[1]),{vertical:{isBound:d,offset:c},horizontal:{isBound:m,offset:h}}}function Dbe(t,e){var r=[],n=t[0],i=t[1];return n&&i?r.push([[0,i*2],t,[-n,i]],[[n*2,0],t,[n,-i]]):n?(r.push([[n*2,0],[n,1],[n,-1]]),e&&r.push([[0,-1],[n,-1],[-n,-1]],[[0,1],[n,1],[-n,1]])):i?(r.push([[0,i*2],[1,i],[-1,i]]),e&&r.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):r.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),r}function $O(t,e,r,n){var i=t.state,a=i.allMatrix,s=i.is3d,o=Ey(a,100,100,s?4:3),c=zl(o,[0,0]);return Dbe(r,n).map(function(h){var d=Zt(h,3),m=d[0],b=d[1],x=d[2],E=[zl(o,b),zl(o,x)],T=Abe(E),A=pK(c,E),M=A.vertical,F=A.horizontal,N=VO(c,E)<=0;return{multiple:m,centerSign:N,verticalSign:M,horizontalSign:F,lineConstants:T,line:[zl(e,b),zl(e,x)]}})}function G9(t,e,r,n){var i=n?t.map(function(a){return Fx(a,n)}):t;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var s=VO(r,a)<=0;return!gK(e,a,s)})}function Obe(t){var e=Zt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return nn(r[0]);if(!a)return nn(r[1]);var s=a/i;return nn((-s*r[0]+r[1])/Math.sqrt(Math.pow(s,2)+1))}function Nbe(t){var e=Zt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return[r[0],0];if(!a)return[0,r[1]];var s=a/i,o=-s*r[0]+r[1];return[-o/(s+1/s),o/(s*s+1)]}function Lbe(t,e,r,n,i){var a=t.props.innerBounds,s=i*Math.PI/180;if(!a)return[];var o=a.left,c=a.top,h=a.width,d=a.height,m=o-n[0],b=o+h-n[0],x=c-n[1],E=c+d-n[1],T=[[m,x],[b,x],[m,E],[b,E]],A=zl(r,[0,0]);if(!G9(r,T,A,0))return[];var M=[],F=T.map(function(N){return[Hh(N),il([0,0],N)]});return[[r[0],r[1]],[r[1],r[3]],[r[3],r[2]],[r[2],r[0]]].forEach(function(N){var O=il([0,0],Nbe(N)),U=Obe(N);M.push.apply(M,yn([],Zt(F.filter(function(j){var H=Zt(j,1),G=H[0];return G&&U<=G}).map(function(j){var H=Zt(j,2),G=H[0],X=H[1],ae=Math.acos(G?U/G:0),Q=X+ae,W=X-ae;return[s+Q-O,s+W-O]}).reduce(function(j,H){return j.push.apply(j,yn([],Zt(H),!1)),j},[]).filter(function(j){return!G9(e,T,A,j)}).map(function(j){return Fi(j*180/Math.PI,bc)})),!1))}),M}function Fbe(t){var e=t.props.innerBounds,r=u0();if(!e)return{boundMap:r,vertical:[],horizontal:[]};var n=t.getRect(),i=n.pos1,a=n.pos2,s=n.pos3,o=n.pos4,c=[i,a,s,o],h=zl(c,[0,0]),d=e.left,m=e.top,b=e.width,x=e.height,E=[[d,m],[d,m+x]],T=[[d,m],[d+b,m]],A=[[d+b,m],[d+b,m+x]],M=[[d,m+x],[d+b,m+x]],F=$O(t,c,[0,0],!1),N=[],O=[];return F.forEach(function(U){var j=U.line,H=U.lineConstants,G=pK(h,j),X=G.horizontal,ae=G.vertical,Q=gg(j,H,T,ae,1,!0),W=gg(j,H,M,ae,1,!0),oe=gg(j,H,E,X,1,!0),se=gg(j,H,A,X,1,!0);Q.isBound&&!r.top&&(N.push(m),r.top=!0),W.isBound&&!r.bottom&&(N.push(m+x),r.bottom=!0),oe.isBound&&!r.left&&(O.push(d),r.left=!0),se.isBound&&!r.right&&(O.push(d+b),r.right=!0)}),{boundMap:r,horizontal:N,vertical:O}}function Bbe(t,e,r,n){var i=e[0]-t[0],a=e[1]-t[1];if(nn(i)<Tl&&(i=0),nn(a)<Tl&&(a=0),!i)return n?[0,0]:[0,r];if(!a)return n?[r,0]:[0,0];var s=a/i,o=t[1]-s*t[0];if(n){var c=s*(e[0]+r)+o;return[r,c-e[1]]}else{var h=(e[1]+r-o)/s;return[h-e[0],r]}}function _R(t,e,r,n,i){var a=Bbe(t,e,r,n);if(!a)return{isOutside:!1,offset:[0,0]};var s=gp(t,e),o=gp(a,t),c=gp(a,e),h=o>s||c>s,d=Zt(Rd({datas:i,distX:a[0],distY:a[1]}),2),m=d[0],b=d[1];return{offset:[m,b],isOutside:h}}function oE(t,e){return t.isBound?t.offset:e.isSnap?vR(e).offset:0}function zbe(t,e,r,n,i){var a=Zt(e,2),s=a[0],o=a[1],c=Zt(r,2),h=c[0],d=c[1],m=Zt(n,2),b=m[0],x=m[1],E=Zt(i,2),T=E[0],A=E[1],M=-T,F=-A;if(t&&s&&o){M=0,F=0;var N=[];if(h&&d?N.push([0,A],[T,0]):h?N.push([T,0]):d?N.push([0,A]):b&&x?N.push([0,A],[T,0]):b?N.push([T,0]):x&&N.push([0,A]),N.length){N.sort(function(H,G){return Hh(_i([s,o],H))-Hh(_i([s,o],G))});var O=N[0];if(O[0]&&nn(s)>Tl)M=-O[0],F=o*nn(s+M)/nn(s)-o;else if(O[1]&&nn(o)>Tl){var U=o;F=-O[1],M=s*nn(o+F)/nn(U)-s}if(t&&d&&h)if(nn(M)>Tl&&nn(M)<nn(T)){var j=nn(T)/nn(M);M*=j,F*=j}else if(nn(F)>Tl&&nn(F)<nn(A)){var j=nn(A)/nn(F);M*=j,F*=j}else M=H0(-T,M),F=H0(-A,F)}}else M=s||h?-T:0,F=o||d?-A:0;return[M,F]}function jbe(t,e,r,n,i,a){if(!m_(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var s=WO(a.absolutePoses,[e,r]),o=Bh(s),c=o.left,h=o.right,d=o.top,m=o.bottom,b={horizontal:s.map(function(se){return se[1]}),vertical:s.map(function(se){return se[0]})},x=jO(t.props.snapDirections),E=UO(x,{left:c,right:h,top:d,bottom:m,center:(c+h)/2,middle:(d+m)/2}),T=l3(t,i,E,b),A=T.vertical,M=T.horizontal,F=Mbe(t,s,a),N=F.vertical,O=F.horizontal,U=A.isSnap,j=M.isSnap,H=A.isBound||N.isBound,G=M.isBound||O.isBound,X=H0(A.offset,N.offset),ae=H0(M.offset,O.offset),Q=Zt(zbe(n,[e,r],[H,G],[U,j],[X,ae]),2),W=Q[0],oe=Q[1];return[{isBound:H,isSnap:U,offset:W},{isBound:G,isSnap:j,offset:oe}]}function l3(t,e,r,n){n===void 0&&(n=r);var i=zO(o3(t),n.vertical,n.horizontal),a=i.horizontal,s=i.vertical,o=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:s3(t,r.vertical,r.horizontal,void 0,void 0,void 0,void 0),c=o.horizontal,h=o.vertical,d=oE(a[0],c),m=oE(s[0],h),b=nn(d),x=nn(m);return{horizontal:{isBound:a[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:d,dist:b,bounds:a,snap:c},vertical:{isBound:s[0].isBound,isSnap:h.isSnap,snapIndex:h.index,offset:m,dist:x,bounds:s,snap:h}}}function X9(t,e,r,n,i,a,s){s===void 0&&(s=[1,1]);var o=zO(e,r,n),c=o.horizontal,h=o.vertical,d=fK(t,r,n,[],[],i,a,s),m=d.horizontal,b=d.vertical,x=oE(c[0],m),E=oE(h[0],b),T=nn(x),A=nn(E);return{horizontal:{isBound:c[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:x,dist:T,bounds:c,snap:m},vertical:{isBound:h[0].isBound,isSnap:b.isSnap,snapIndex:b.index,offset:E,dist:A,bounds:h,snap:b}}}function Ube(t,e,r,n){var i=il(t,e)/Math.PI*180,a=r.vertical,s=a.isBound,o=a.isSnap,c=a.dist,h=r.horizontal,d=h.isBound,m=h.isSnap,b=h.dist,x=i%180,E=x<3||x>177,T=x>87&&x<93;return b<c&&(s||o&&!T&&(!n||!E))?"vertical":d||m&&!E&&(!n||!T)?"horizontal":""}function Vbe(t,e,r,n,i,a){return r.map(function(s){var o=Zt(s,2),c=o[0],h=o[1],d=zl(e,c),m=zl(e,h),b=n?$be(t,d,m,i):l3(t,i,{vertical:[m[0]],horizontal:[m[1]]}),x=b.horizontal,E=x.offset,T=x.isBound,A=x.isSnap,M=b.vertical,F=M.offset,N=M.isBound,O=M.isSnap,U=_i(h,c);if(!F&&!E)return{isBound:N||T,isSnap:O||A,sign:U,offset:[0,0]};var j=Ube(d,m,b,n);if(!j)return{sign:U,isBound:!1,isSnap:!1,offset:[0,0]};var H=j==="vertical",G=[0,0];return!n&&nn(h[0])===1&&nn(h[1])===1&&c[0]!==h[0]&&c[1]!==h[1]?G=Rd({datas:a,distX:-F,distY:-E}):G=_R(d,m,-(H?F:E),H,a).offset,G=G.map(function(X,ae){return X*(U[ae]?2/U[ae]:0)}),{sign:U,isBound:H?N:T,isSnap:H?O:A,offset:G}})}function Y9(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function $be(t,e,r,n){var i=bbe(t,e,r),a=i.horizontal,s=i.vertical,o=n?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:Ibe(t,e,r),c=o.horizontal,h=o.vertical,d=Y9(a,c),m=Y9(s,h),b=nn(d),x=nn(m);return{horizontal:{isBound:a.isBound,isSnap:c.isSnap,offset:d,dist:b},vertical:{isBound:s.isBound,isSnap:h.isSnap,offset:m,dist:x}}}function qbe(t,e,r,n,i){var a=[-r[0],-r[1]],s=t.state,o=s.width,c=s.height,h=t.props.bounds,d=1/0,m=1/0;if(h){var b=[[r[0],-r[1]],[-r[0],r[1]]],x=h.left,E=x===void 0?-1/0:x,T=h.top,A=T===void 0?-1/0:T,M=h.right,F=M===void 0?1/0:M,N=h.bottom,O=N===void 0?1/0:N;b.forEach(function(U){var j=U[0]!==a[0],H=U[1]!==a[1],G=zl(e,U),X=il(n,G)*360/Math.PI;if(H){var ae=G.slice();(nn(X-360)<2||nn(X-180)<2)&&(ae[1]=n[1]);var Q=_R(n,ae,(n[1]<G[1]?O:A)-G[1],!1,i),W=Zt(Q.offset,2),oe=W[1],se=Q.isOutside;isNaN(oe)||(m=c+(se?1:-1)*nn(oe))}if(j){var ae=G.slice();(nn(X-90)<2||nn(X-270)<2)&&(ae[0]=n[0]);var he=_R(n,ae,(n[0]<G[0]?F:E)-G[0],!0,i),_e=Zt(he.offset,1),Ce=_e[0],me=he.isOutside;isNaN(Ce)||(d=o+(me?1:-1)*nn(Ce))}})}return{maxWidth:d,maxHeight:m}}var pc={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var r=t.props,n=r.hideThrottleDragRotateLine,i=r.throttleDragRotate,a=r.zoom,s=t.getState(),o=s.dragInfo,c=s.beforeOrigin;if(n||!i||!o)return[];var h=o.dist;if(!h[0]&&!h[1])return[];var d=Hh(h),m=il(h,[0,0]);return[e.createElement("div",{className:yi("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(d,"px"),transform:"translate(".concat(c[0],"px, ").concat(c[1],"px) rotate(").concat(m,"rad) scaleY(").concat(a,")")}})]},dragStart:function(t,e){var r=e.datas,n=e.parentEvent,i=e.parentGesto,a=t.state,s=a.gestos,o=a.style;if(s.draggable)return!1;s.draggable=i||t.targetGesto,r.datas={},r.left=parseFloat(o.left||"")||0,r.top=parseFloat(o.top||"")||0,r.bottom=parseFloat(o.bottom||"")||0,r.right=parseFloat(o.right||"")||0,r.startValue=[0,0],Sy(t,e),a3(t,e,"translate"),uxe(t,r),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,r.deltaOffset=[0,0];var c=Ki(t,e,Gt({set:function(d){r.startValue=d}},i3(t,e))),h=n||Gn(t,"onDragStart",c);return h!==!1?(r.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(s.draggable=null,r.isPinch=!1),r.isDrag?c:!1},drag:function(t,e){if(e){r3(t,e,"translate");var r=e.datas,n=e.parentEvent,i=e.parentFlag,a=e.isPinch,s=e.deltaOffset,o=e.useSnap,c=e.isRequest,h=e.isGroup,d=e.parentThrottleDrag,m=e.distX,b=e.distY,x=r.isDrag,E=r.prevDist,T=r.prevBeforeDist,A=r.startValue;if(x){s&&(m+=s[0],b+=s[1]);var M=t.props,F=M.parentMoveable,N=h?0:M.throttleDrag||d||0,O=n?0:M.throttleDragRotate||0,U=0,j=!1,H=!1,G=!1,X=!1;if(!n&&O>0&&(m||b)){var ae=M.startDragRotate||0,Q=Fi(ae+il([0,0],[m,b])*180/Math.PI,O)-ae,W=b*Math.abs(Math.cos((Q-90)/180*Math.PI)),oe=m*Math.abs(Math.cos(Q/180*Math.PI)),se=Hh([oe,W]);U=Q*Math.PI/180,m=se*Math.cos(U),b=se*Math.sin(U)}if(!a&&!n&&!i){var he=Zt(jbe(t,m,b,O,!o&&c||s,r),2),_e=he[0],Ce=he[1];j=_e.isSnap,H=_e.isBound,G=Ce.isSnap,X=Ce.isBound;var me=_e.offset,xe=Ce.offset;m+=me,b+=xe}var Ae=Ma(KZ({datas:r,distX:m,distY:b}),A),De=Ma(tbe({datas:r,distX:m,distY:b}),A);O9(De,bc),O9(Ae,bc),O||(!j&&!H&&(De[0]=Fi(De[0],N),Ae[0]=Fi(Ae[0],N)),!G&&!X&&(De[1]=Fi(De[1],N),Ae[1]=Fi(Ae[1],N)));var de=_i(Ae,A),Ee=_i(De,A),we=_i(Ee,E),Le=_i(de,T);r.prevDist=Ee,r.prevBeforeDist=de,r.passDelta=we,r.passDist=Ee;var Fe=r.left+de[0],Xe=r.top+de[1],Be=r.right-de[0],ot=r.bottom-de[1],Qe=n3(r,"translate(".concat(De[0],"px, ").concat(De[1],"px)"),"translate(".concat(Ee[0],"px, ").concat(Ee[1],"px)"));if(FO(e,Qe),t.state.dragInfo.dist=n?[0,0]:Ee,!(!n&&!F&&we.every(function($e){return!$e})&&Le.some(function($e){return!$e}))){var rt=t.state,Re=rt.width,zt=rt.height,st=Ki(t,e,Gt({transform:Qe,dist:Ee,delta:we,translate:De,beforeDist:de,beforeDelta:Le,beforeTranslate:Ae,left:Fe,top:Xe,right:Be,bottom:ot,width:Re,height:zt,isPinch:a},yc({transform:Qe},e)));return!n&&Gn(t,"onDrag",st),st}}}},dragAfter:function(t,e){var r=e.datas,n=r.deltaOffset;return n[0]||n[1]?(r.deltaOffset=[0,0],this.drag(t,Gt(Gt({},e),{deltaOffset:n}))):!1},dragEnd:function(t,e){var r=e.parentEvent,n=e.datas;if(t.state.dragInfo=null,!!n.isDrag){n.isDrag=!1;var i=fh(t,e,{});return!r&&Gn(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=this.dragStart(t,e);if(!o)return!1;var c=GA(t,this,"dragStart",[a||0,s||0],e,!1,"draggable"),h=c.childEvents,d=c.eventParams,m=Gt(Gt({},o),{targets:t.props.targets,events:d}),b=Gn(t,"onDragGroupStart",m);i.isDrag=b!==!1;var x=(n=(r=h[0])===null||r===void 0?void 0:r.datas.startValue)!==null&&n!==void 0?n:[0,0];return i.throttleOffset=[x[0]%1,x[1]%1],i.isDrag?o:!1},dragGroup:function(t,e){var r=e.datas;if(r.isDrag){var n=this.drag(t,Gt(Gt({},e),{parentThrottleDrag:t.props.throttleDrag})),i=e.datas.passDelta,a=GA(t,this,"drag",i,e,!1,"draggable").eventParams;if(n){var s=Gt({targets:t.props.targets,events:a},n);return Gn(t,"onDragGroup",s),s}}},dragGroupEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isDrag){this.dragEnd(t,e);var i=GA(t,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return Gn(t,"onDragGroupEnd",fh(t,e,{targets:t.props.targets,events:i})),r}},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=!1;return{isControl:!1,requestStart:function(s){return a=s.useSnap,{datas:e,useSnap:a}},request:function(s){return"x"in s?n=s.x-r.left:"deltaX"in s&&(n+=s.deltaX),"y"in s?i=s.y-r.top:"deltaY"in s&&(i+=s.deltaY),{datas:e,distX:n,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function yK(t,e){var r=zl(t,e),n=[0,0];return{fixedPosition:r,fixedDirection:e,fixedOffset:n}}function Hbe(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=[i/2*(1+e[0]),a/2*(1+e[1])],c=bs(r,o,s),h=[0,0];return{fixedPosition:c,fixedDirection:e,fixedOffset:h}}function vK(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=ube(e,i,a),c=bs(r,e,s),h=[i?0:e[0],a?0:e[1]];return{fixedPosition:c,fixedDirection:o,fixedOffset:h}}var Z9=YO("resizable"),bR={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:aK("resizable"),dragControlCondition:Z9,viewClassName:XO("resizable"),dragControlStart:function(t,e){var r,n=e.inputEvent,i=e.isPinch,a=e.isGroup,s=e.parentDirection,o=e.parentGesto,c=e.datas,h=e.parentFixedDirection,d=e.parentEvent,m=RK(s,i,n,c),b=t.state,x=b.target,E=b.width,T=b.height,A=b.gestos;if(!m||!x||A.resizable)return!1;A.resizable=o||t.controlGesto,!i&&Sy(t,e),c.datas={},c.direction=m,c.startOffsetWidth=E,c.startOffsetHeight=T,c.prevWidth=0,c.prevHeight=0,c.minSize=[0,0],c.startWidth=b.inlineCSSWidth||b.cssWidth,c.startHeight=b.inlineCSSHeight||b.cssHeight,c.maxSize=[1/0,1/0],a||(c.minSize=[b.minOffsetWidth,b.minOffsetHeight],c.maxSize=[b.maxOffsetWidth,b.maxOffsetHeight]);var M=t.props.transformOrigin||"% %";c.transformOrigin=kp(M)?M.split(" "):M,c.startOffsetMatrix=b.offsetMatrix,c.startTransformOrigin=b.transformOrigin,c.isWidth=(r=e?.parentIsWidth)!==null&&r!==void 0?r:!m[0]&&!m[1]||m[0]||!m[1];function F(X){c.ratio=X&&isFinite(X)?X:0}c.startPositions=Wh(t.state);function N(X){var ae=yK(c.startPositions,X);c.fixedDirection=ae.fixedDirection,c.fixedPosition=ae.fixedPosition,c.fixedOffset=ae.fixedOffset}function O(X){var ae=vK(t.state,X);c.fixedDirection=ae.fixedDirection,c.fixedPosition=ae.fixedPosition,c.fixedOffset=ae.fixedOffset}function U(X){c.minSize=[xo("".concat(X[0]),0)||0,xo("".concat(X[1]),0)||0]}function j(X){var ae=[X[0]||1/0,X[1]||1/0];(!$b(ae[0])||isFinite(ae[0]))&&(ae[0]=xo("".concat(ae[0]),0)||1/0),(!$b(ae[1])||isFinite(ae[1]))&&(ae[1]=xo("".concat(ae[1]),0)||1/0),c.maxSize=ae}F(E/T),N(h||[-m[0],-m[1]]),c.setFixedDirection=N,c.setFixedPosition=O,c.setMin=U,c.setMax=j;var H=Ki(t,e,{direction:m,startRatio:c.ratio,set:function(X){var ae=Zt(X,2),Q=ae[0],W=ae[1];c.startWidth=Q,c.startHeight=W},setMin:U,setMax:j,setRatio:F,setFixedDirection:N,setFixedPosition:O,setOrigin:function(X){c.transformOrigin=X},dragStart:pc.dragStart(t,new $0().dragStart([0,0],e))}),G=d||Gn(t,"onResizeStart",H);return c.startFixedDirection=c.fixedDirection,c.startFixedPosition=c.fixedPosition,G!==!1&&(c.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:m}),c.isResize?H:!1},dragControl:function(t,e){var r,n=e.datas,i=e.parentFlag,a=e.isPinch,s=e.parentKeepRatio,o=e.dragClient,c=e.parentDist,h=e.useSnap,d=e.isRequest,m=e.isGroup,b=e.parentEvent,x=e.resolveMatrix,E=n.isResize,T=n.transformOrigin,A=n.startWidth,M=n.startHeight,F=n.prevWidth,N=n.prevHeight,O=n.minSize,U=n.maxSize,j=n.ratio,H=n.startOffsetWidth,G=n.startOffsetHeight,X=n.isWidth;if(!E)return;if(x){var ae=t.state.is3d,Q=n.startOffsetMatrix,W=n.startTransformOrigin,oe=ae?4:3,se=Hb(nE(e)),he=Math.sqrt(se.length);oe!==he&&(se=Af(se,he,oe));var _e=Vx(Q,se,W,oe),Ce=Ey(_e,H,G,oe);n.startPositions=Ce,n.nextTargetMatrix=se,n.nextAllMatrix=_e}var me=ry(t.props,"resizable"),xe=me.resizeFormat,Ae=me.throttleResize,De=Ae===void 0?i?0:1:Ae,de=me.parentMoveable,Ee=me.keepRatioFinally,we=n.direction,Le=we,Fe=0,Xe=0;!we[0]&&!we[1]&&(Le=[1,1]);var Be=j&&(s??me.keepRatio)||!1;function ot(){var Tr=n.fixedDirection,Qt=FK(Le,Be,n,e);Fe=Qt.distWidth,Xe=Qt.distHeight;var at=Le[0]-Tr[0]||Be?Math.max(H+Fe,bc):H,ke=Le[1]-Tr[1]||Be?Math.max(G+Xe,bc):G;return Be&&H&&G&&(X?ke=at/j:at=ke*j),[at,ke]}var Qe=Zt(ot(),2),rt=Qe[0],Re=Qe[1];b||(n.setFixedDirection(n.fixedDirection),Gn(t,"onBeforeResize",Ki(t,e,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection:function(Tr){var Qt;return n.setFixedDirection(Tr),Qt=Zt(ot(),2),rt=Qt[0],Re=Qt[1],[rt,Re]},setFixedPosition:function(Tr){var Qt;return n.setFixedPosition(Tr),Qt=Zt(ot(),2),rt=Qt[0],Re=Qt[1],[rt,Re]},boundingWidth:rt,boundingHeight:Re,setSize:function(Tr){var Qt;Qt=Zt(Tr,2),rt=Qt[0],Re=Qt[1]}},!0)));var zt=o;o||(!i&&a?zt=dbe(t,[0,0]):zt=n.fixedPosition);var st=[0,0];a||(st=sxe(t,rt,Re,we,zt,!h&&d,n)),c&&(!c[0]&&(st[0]=0),!c[1]&&(st[1]=0));function $e(){var Tr;xe&&(Tr=Zt(xe([rt,Re]),2),rt=Tr[0],Re=Tr[1]),rt=Fi(rt,De),Re=Fi(Re,De)}if(Be){Le[0]&&Le[1]&&st[0]&&st[1]&&(nn(st[0])>nn(st[1])?st[1]=0:st[0]=0);var Jt=!st[0]&&!st[1];Jt&&$e(),Le[0]&&!Le[1]||st[0]&&!st[1]||Jt&&X?(rt+=st[0],Re=rt/j):(!Le[0]&&Le[1]||!st[0]&&st[1]||Jt&&!X)&&(Re+=st[1],rt=Re*j)}else rt+=st[0],Re+=st[1],rt=Math.max(0,rt),Re=Math.max(0,Re);r=Zt(RZ([rt,Re],O,U,Be?j:!1),2),rt=r[0],Re=r[1],$e(),Be&&(m||Ee)&&(X?Re=rt/j:rt=Re*j),Fe=rt-H,Xe=Re-G;var Ht=[Fe-F,Xe-N];n.prevWidth=Fe,n.prevHeight=Xe;var pr=fbe(t,rt,Re,zt,T,n);if(!(!de&&Ht.every(function(Tr){return!Tr})&&pr.every(function(Tr){return!Tr}))){var _t=pc.drag(t,Ux(e,t.state,pr,!!a,!1,"draggable")),vr=_t.transform,br=A+Fe,lr=M+Xe,Cr=Ki(t,e,Gt({width:br,height:lr,offsetWidth:Math.round(rt),offsetHeight:Math.round(Re),startRatio:j,boundingWidth:rt,boundingHeight:Re,direction:we,dist:[Fe,Xe],delta:Ht,isPinch:!!a,drag:_t},DK({style:{width:"".concat(br,"px"),height:"".concat(lr,"px")},transform:vr},_t,e)));return!b&&Gn(t,"onResize",Cr),Cr}},dragControlAfter:function(t,e){var r=e.datas,n=r.isResize,i=r.startOffsetWidth,a=r.startOffsetHeight,s=r.prevWidth,o=r.prevHeight;if(!(!n||t.props.checkResizableError===!1)){var c=t.state,h=c.width,d=c.height,m=h-(i+s),b=d-(a+o),x=nn(m)>3,E=nn(b)>3;if(x&&(r.startWidth+=m,r.startOffsetWidth+=m,r.prevWidth+=m),E&&(r.startHeight+=b,r.startOffsetHeight+=b,r.prevHeight+=b),x||E)return this.dragControl(t,e)}},dragControlEnd:function(t,e){var r=e.datas,n=e.parentEvent;if(r.isResize){r.isResize=!1;var i=fh(t,e,{});return!n&&Gn(t,"onResizeEnd",i),i}},dragGroupControlCondition:Z9,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,Gt(Gt({},e),{isGroup:!0}));if(!n)return!1;var i=Ef(t,"resizable",e),a=r.startOffsetWidth,s=r.startOffsetHeight;function o(){var x=r.minSize;i.forEach(function(E){var T=E.datas,A=T.minSize,M=T.startOffsetWidth,F=T.startOffsetHeight,N=a*(M?A[0]/M:0),O=s*(F?A[1]/F:0);x[0]=Math.max(x[0],N),x[1]=Math.max(x[1],O)})}function c(){var x=r.maxSize;i.forEach(function(E){var T=E.datas,A=T.maxSize,M=T.startOffsetWidth,F=T.startOffsetHeight,N=a*(M?A[0]/M:0),O=s*(F?A[1]/F:0);x[0]=Math.min(x[0],N),x[1]=Math.min(x[1],O)})}var h=mp(t,this,"dragControlStart",e,function(x,E){return iE(t,x,r,E)});o(),c();var d=function(x){n.setFixedDirection(x),h.forEach(function(E,T){E.setFixedDirection(x),iE(t,E.moveable,r,i[T])})};r.setFixedDirection=d;var m=Gt(Gt({},n),{targets:t.props.targets,events:h.map(function(x){return Gt(Gt({},x),{setMin:function(E){x.setMin(E),o()},setMax:function(E){x.setMax(E),c()}})}),setFixedDirection:d,setMin:function(x){n.setMin(x),o()},setMax:function(x){n.setMax(x),c()}}),b=Gn(t,"onResizeGroupStart",m);return r.isResize=b!==!1,r.isResize?n:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isResize){var n=ry(t.props,"resizable");c3(t,"onBeforeResize",function(x){Gn(t,"onBeforeResizeGroup",Ki(t,e,Gt(Gt({},x),{targets:n.targets}),!0))});var i=this.dragControl(t,Gt(Gt({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,s=i.boundingHeight,o=i.dist,c=n.keepRatio,h=[a/(a-o[0]),s/(s-o[1])],d=r.fixedPosition,m=mp(t,this,"dragControl",e,function(x,E){var T=Zt(tc(Bx(t.rotation/180*Math.PI,3),[E.datas.originalX*h[0],E.datas.originalY*h[1],1],3),2),A=T[0],M=T[1];return Gt(Gt({},E),{parentDist:null,parentScale:h,dragClient:Ma(d,[A,M]),parentKeepRatio:c})}),b=Gt({targets:n.targets,events:m},i);return Gn(t,"onResizeGroup",b),b}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isResize){this.dragControlEnd(t,e);var i=mp(t,this,"dragControlEnd",e),a=fh(t,e,{targets:t.props.targets,events:i});return Gn(t,"onResizeGroupEnd",a),r}},request:function(t){var e={},r=0,n=0,i=!1,a=t.getRect();return{isControl:!0,requestStart:function(s){var o;return i=s.useSnap,{datas:e,parentDirection:s.direction||[1,1],parentIsWidth:(o=s?.horizontal)!==null&&o!==void 0?o:!0,useSnap:i}},request:function(s){return"offsetWidth"in s?r=s.offsetWidth-a.offsetWidth:"deltaWidth"in s&&(r+=s.deltaWidth),"offsetHeight"in s?n=s.offsetHeight-a.offsetHeight:"deltaHeight"in s&&(n+=s.deltaHeight),{datas:e,parentDist:[r,n],parentKeepRatio:s.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.resizable=null}};function XA(t,e,r,n,i){var a=t.props.groupable,s=t.state,o=s.is3d?4:3,c=e.origin,h=bs(t.state.rootMatrix,_i([c[0],c[1]],a?[0,0]:[s.left,s.top]),o),d=Ma([i.left,i.top],h);e.startAbsoluteOrigin=d,e.prevDeg=il(d,[r,n])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=gp(d,[r,n])}function mS(t,e,r){var n=r.defaultDeg,i=r.prevDeg,a=i%360,s=Math.floor(i/360);a<0&&(a+=360),a>t&&a>270&&t<90?++s:a<t&&a<90&&t>270&&--s;var o=e*(s*360+t-n);return r.prevDeg=n+o,o}function YA(t,e,r,n){return mS(il(n.startAbsoluteOrigin,[t,e])/Math.PI*180,r,n)}function ZA(t,e,r,n,i,a){var s=t.props.throttleRotate,o=s===void 0?0:s,c=r.prevSnapDeg,h=0,d=!1;if(a){var m=oxe(t,e,n,i+n);d=m.isSnap,h=i+m.dist}d||(h=Fi(i+n,o));var b=h-i;return r.prevSnapDeg=b,[b-c,b,h]}function _K(t,e,r){var n=Zt(e,4),i=n[0],a=n[1],s=n[2],o=n[3];if(t==="none")return[];if(su(t))return t.map(function(A){return _K(A,[i,a,s,o],r)[0]});var c=Zt((t||"top").split("-"),2),h=c[0],d=c[1],m=[i,a];h==="left"?m=[s,i]:h==="right"?m=[a,o]:h==="bottom"&&(m=[o,s]);var b=[(m[0][0]+m[1][0])/2,(m[0][1]+m[1][1])/2],x=PK(m,r);if(d){var E=d==="top"||d==="left",T=h==="bottom"||h==="left";b=m[E&&!T||!E&&T?0:1]}return[[b,x]]}function xR(t,e){if(e.isRequest)return e.requestAble==="rotatable";var r=e.inputEvent.target;if(Bl(r,yi("rotation-control"))||t.props.rotateAroundControls&&Bl(r,yi("around-control"))||Bl(r,yi("control"))&&Bl(r,yi("rotatable")))return!0;var n=t.props.rotationTarget;return n?ZO(n,!0).some(function(i){return i?r===i||r.contains(i):!1}):!1}var Wbe=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,Gbe={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[Wbe],viewClassName:function(t){return t.isDragging("rotatable")?yi("view-rotation-dragging"):""},render:function(t,e){var r=ry(t.props,"rotatable"),n=r.rotatable,i=r.rotationPosition,a=r.zoom,s=r.renderDirections,o=r.rotateAroundControls,c=r.resolveAblesWithRotatable,h=t.getState(),d=h.renderPoses,m=h.direction;if(!n)return null;var b=_K(i,d,m),x=[];if(b.forEach(function(M,F){var N=Zt(M,2),O=N[0],U=N[1];x.push(e.createElement("div",{key:"rotation".concat(F),className:yi("rotation"),style:{transform:"translate(-50%) translate(".concat(O[0],"px, ").concat(O[1],"px) rotate(").concat(U,"rad)")}},e.createElement("div",{className:yi("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:yi("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),s){var E=d_(c||{}),T={};E.forEach(function(M){c[M].forEach(function(F){T[F]=M})});var A=[];su(s)&&(A=s.map(function(M){var F=T[M];return{data:F?{resolve:F}:{},classNames:F?["move"]:[],dir:M}})),x.push.apply(x,yn([],Zt(rK(t,"rotatable",A,e)),!1))}return o&&x.push.apply(x,yn([],Zt(sK(t,e)),!1)),x},dragControlCondition:xR,dragControlStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=e.parentRotate,c=e.parentFlag,h=e.isPinch,d=e.isRequest,m=t.state,b=m.target,x=m.left,E=m.top,T=m.direction,A=m.beforeDirection,M=m.targetTransform,F=m.moveableClientRect,N=m.offsetMatrix,O=m.targetMatrix,U=m.allMatrix,j=m.width,H=m.height;if(!d&&!b)return!1;var G=t.getRect();i.rect=G,i.transform=M,i.left=x,i.top=E;var X=function(Le){var Fe=vK(t.state,Le);i.fixedDirection=Fe.fixedDirection,i.fixedOffset=Fe.fixedOffset,i.fixedPosition=Fe.fixedPosition,De&&De.setFixedPosition(Le)},ae=function(Le){var Fe=Hbe(t.state,Le);i.fixedDirection=Fe.fixedDirection,i.fixedOffset=Fe.fixedOffset,i.fixedPosition=Fe.fixedPosition,De&&De.setFixedDirection(Le)},Q=a,W=s;if(d||h||c){var oe=o||0;i.beforeInfo={origin:G.beforeOrigin,prevDeg:oe,defaultDeg:oe,prevSnapDeg:0,startDist:0},i.afterInfo=Gt(Gt({},i.beforeInfo),{origin:G.origin}),i.absoluteInfo=Gt(Gt({},i.beforeInfo),{origin:G.origin,startValue:oe})}else{var se=(n=e.inputEvent)===null||n===void 0?void 0:n.target;if(se){var he=se.getAttribute("data-direction")||"",_e=J1e[he];if(_e){i.isControl=!0,i.isAroundControl=Bl(se,yi("around-control")),i.controlDirection=_e;var Ce=se.getAttribute("data-resolve");Ce&&(i.resolveAble=Ce);var me=wxe(m.rootMatrix,m.renderPoses,F);r=Zt(zl(me,_e),2),Q=r[0],W=r[1]}}i.beforeInfo={origin:G.beforeOrigin},i.afterInfo={origin:G.origin},i.absoluteInfo={origin:G.origin,startValue:G.rotation};var xe=X;X=function(Le){var Fe=m.is3d?4:3,Xe=Zt(Ma(LZ(O,Fe),Le),2),Be=Xe[0],ot=Xe[1],Qe=tc(N,Qm([Be,ot],Fe)),rt=tc(U,Qm([Le[0],Le[1]],Fe));xe(Le);var Re=m.posDelta;i.beforeInfo.origin=_i(Qe,Re),i.afterInfo.origin=_i(rt,Re),i.absoluteInfo.origin=_i(rt,Re),XA(t,i.beforeInfo,Q,W,F),XA(t,i.afterInfo,Q,W,F),XA(t,i.absoluteInfo,Q,W,F)},ae=function(Le){var Fe=zl([[0,0],[j,0],[0,H],[j,H]],Le);X(Fe)}}i.startClientX=Q,i.startClientY=W,i.direction=T,i.beforeDirection=A,i.startValue=0,i.datas={},a3(t,e,"rotate");var Ae=!1,De=!1;if(i.isControl&&i.resolveAble){var de=i.resolveAble;de==="resizable"&&(De=bR.dragControlStart(t,Gt(Gt({},new $0("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}De||(Ae=pc.dragStart(t,new $0().dragStart([0,0],e))),X(Sxe(t));var Ee=Ki(t,e,Gt(Gt({set:function(Le){i.startValue=Le*Math.PI/180},setFixedDirection:ae,setFixedPosition:X},i3(t,e)),{dragStart:Ae,resizeStart:De})),we=Gn(t,"onRotateStart",Ee);return i.isRotate=we!==!1,m.snapRenderInfo={request:e.isRequest},i.isRotate?Ee:!1},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.clientDistX,o=e.clientDistY,c=e.parentRotate,h=e.parentFlag,d=e.isPinch,m=e.groupDelta,b=e.resolveMatrix,x=a.beforeDirection,E=a.beforeInfo,T=a.afterInfo,A=a.absoluteInfo,M=a.isRotate,F=a.startValue,N=a.rect,O=a.startClientX,U=a.startClientY;if(M){r3(t,e,"rotate");var j=ebe(e),H=x*j,G=t.props.parentMoveable,X=0,ae,Q,W=0,oe,se,he=0,_e,Ce,me=180/Math.PI*F,xe=A.startValue,Ae=!1,De=O+s,de=U+o;if(!h&&"parentDist"in e){var Ee=e.parentDist;ae=Ee,oe=Ee,_e=Ee}else d||h?(ae=mS(c,x,E),oe=mS(c,H,T),_e=mS(c,H,A)):(ae=YA(De,de,x,E),oe=YA(De,de,H,T),_e=YA(De,de,H,A),Ae=!0);if(Q=me+ae,se=me+oe,Ce=xe+_e,Gn(t,"onBeforeRotate",Ki(t,e,{beforeRotation:Q,rotation:se,absoluteRotation:Ce,setRotation:function(zt){oe=zt-me,ae=oe,_e=oe}},!0)),r=Zt(ZA(t,N,E,ae,me,Ae),3),X=r[0],ae=r[1],Q=r[2],n=Zt(ZA(t,N,T,oe,me,Ae),3),W=n[0],oe=n[1],se=n[2],i=Zt(ZA(t,N,A,_e,xe,Ae),3),he=i[0],_e=i[1],Ce=i[2],!(!he&&!W&&!X&&!G&&!b)){var we=n3(a,"rotate(".concat(se,"deg)"),"rotate(".concat(oe,"deg)"));b&&(a.fixedPosition=BO(t,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var Le=hbe(t,oe,a),Fe=_i(Ma(m||[0,0],Le),a.prevInverseDist||[0,0]);a.prevInverseDist=Le,a.requestValue=null;var Xe=QZ(t,we,Fe,d,e),Be=Xe,ot=gp([De,de],A.startAbsoluteOrigin)-A.startDist,Qe=void 0;if(a.resolveAble==="resizable"){var rt=bR.dragControl(t,Gt(Gt({},Ux(e,t.state,[e.deltaX,e.deltaY],!!d,!1,"resizable")),{resolveMatrix:!0,parentDistance:ot}));rt&&(Qe=rt,Be=DK(Be,rt,e))}var Re=Ki(t,e,Gt(Gt({delta:W,dist:oe,rotate:se,rotation:se,beforeDist:ae,beforeDelta:X,beforeRotate:Q,beforeRotation:Q,absoluteDist:_e,absoluteDelta:he,absoluteRotate:Ce,absoluteRotation:Ce,isPinch:!!d,resize:Qe},Xe),Be));return Gn(t,"onRotate",Re),Re}}},dragControlEnd:function(t,e){var r=e.datas;if(r.isRotate){r.isRotate=!1;var n=fh(t,e,{});return Gn(t,"onRotateEnd",n),n}},dragGroupControlCondition:xR,dragGroupControlStart:function(t,e){var r=e.datas,n=t.state,i=n.left,a=n.top,s=n.beforeOrigin,o=this.dragControlStart(t,e);if(!o)return!1;o.set(r.beforeDirection*t.rotation);var c=mp(t,this,"dragControlStart",e,function(m,b){var x=m.state,E=x.left,T=x.top,A=x.beforeOrigin,M=Ma(_i([E,T],[i,a]),_i(A,s));return b.datas.startGroupClient=M,b.datas.groupClient=M,Gt(Gt({},b),{parentRotate:0})}),h=Gt(Gt({},o),{targets:t.props.targets,events:c}),d=Gn(t,"onRotateGroupStart",h);return r.isRotate=d!==!1,r.isRotate?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isRotate){c3(t,"onBeforeRotate",function(h){Gn(t,"onBeforeRotateGroup",Ki(t,e,Gt(Gt({},h),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=r.beforeDirection,a=n.beforeDist,s=a/180*Math.PI,o=mp(t,this,"dragControl",e,function(h,d){var m=d.datas.startGroupClient,b=Zt(d.datas.groupClient,2),x=b[0],E=b[1],T=Zt(Fx(m,s*i),2),A=T[0],M=T[1],F=[A-x,M-E];return d.datas.groupClient=[A,M],Gt(Gt({},d),{parentRotate:a,groupDelta:F})});t.rotation=i*n.beforeRotation;var c=Gt({targets:t.props.targets,events:o,set:function(h){t.rotation=h},setGroupRotation:function(h){t.rotation=h}},n);return Gn(t,"onRotateGroup",c),c}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isRotate){this.dragControlEnd(t,e);var i=mp(t,this,"dragControlEnd",e),a=fh(t,e,{targets:t.props.targets,events:i});return Gn(t,"onRotateGroupEnd",a),r}},request:function(t){var e={},r=0,n=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?r+=i.deltaRotate:"rotate"in i&&(r=i.rotate-n),{datas:e,parentDist:r}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function Xbe(t,e){var r,n=t.direction,i=t.classNames,a=t.size,s=t.pos,o=t.zoom,c=t.key,h=n==="horizontal",d=h?"Y":"X";return e.createElement("div",{key:c,className:i.join(" "),style:(r={},r[h?"width":"height"]="".concat(a),r.transform="translate(".concat(s[0],", ").concat(s[1],") translate").concat(d,"(-50%) scale").concat(d,"(").concat(o,")"),r)})}function qO(t,e){return Xbe(Gt(Gt({},t),{classNames:yn([yi("line","guideline",t.direction)],Zt(t.classNames),!1).filter(function(r){return r}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(r){return"".concat(Fi(r,.1),"px")})}),e)}function K9(t,e,r,n,i,a,s,o){var c=t.props.zoom;return r.map(function(h,d){var m=h.type,b=h.pos,x=[0,0];return x[s]=n,x[s?0:1]=-i+b,qO({key:"".concat(e,"TargetGuideline").concat(d),classNames:[yi("target","bold",m)],posValue:x,sizeValue:a,zoom:c,direction:e},o)})}function J9(t,e,r,n,i,a){var s=t.props,o=s.zoom,c=s.isDisplayInnerSnapDigit,h=e==="horizontal"?Ag:Ig,d=i[h.start],m=i[h.end];return r.filter(function(b){var x=b.hide,E=b.elementRect;if(x)return!1;if(c&&E){var T=E.rect;if(T[h.start]<=d&&m<=T[h.end])return!1}return!0}).map(function(b,x){var E=b.pos,T=b.size,A=b.element,M=b.className,F=[-n[0]+E[0],-n[1]+E[1]];return qO({key:"".concat(e,"-default-guideline-").concat(x),classNames:A?[yi("bold"),M]:[yi("normal"),M],direction:e,posValue:F,sizeValue:T,zoom:o},a)})}function N1(t,e,r,n,i,a,s,o){var c,h=t.props,d=h.snapDigit,m=d===void 0?0:d,b=h.isDisplaySnapDigit,x=b===void 0?!0:b,E=h.snapDistFormat,T=E===void 0?function(U,j){return U}:E,A=h.zoom,M=e==="horizontal"?"X":"Y",F=e==="vertical"?"height":"width",N=Math.abs(i),O=x?parseFloat(N.toFixed(m)):0;return o.createElement("div",{key:"".concat(e,"-").concat(r,"-guideline-").concat(n),className:yi("guideline-group",e),style:(c={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},c[F]="".concat(N,"px"),c)},qO({direction:e,classNames:[yi(r),s],size:"100%",posValue:[0,0],sizeValue:N,zoom:A},o),o.createElement("div",{className:yi("size-value","gap"),style:{transform:"translate".concat(M,"(-50%) scale(").concat(A,")")}},O>0?T(O,e):""))}function Ybe(t,e,r,n){var i=t==="vertical"?0:1,a=t==="vertical"?1:0,s=i?Ag:Ig,o=r[s.start],c=r[s.end];return OK(e,function(h){return h.pos[i]}).map(function(h){var d=[],m=[],b=[];return h.forEach(function(x){var E,T,A=x.element,M=x.elementRect.rect;if(M[s.end]<o)d.push(x);else if(c<M[s.start])m.push(x);else if(M[s.start]<=o&&c<=M[s.end]&&n){var F=x.pos,N={element:A,rect:Gt(Gt({},M),(E={},E[s.end]=M[s.start],E))},O={element:A,rect:Gt(Gt({},M),(T={},T[s.start]=M[s.end],T))},U=[0,0],j=[0,0];U[i]=F[i],U[a]=F[a],j[i]=F[i],j[a]=F[a]+x.size,d.push({type:t,pos:U,size:0,elementRect:N,direction:"",elementDirection:"end"}),m.push({type:t,pos:j,size:0,elementRect:O,direction:"",elementDirection:"start"})}}),d.sort(function(x,E){return E.pos[a]-x.pos[a]}),m.sort(function(x,E){return x.pos[a]-E.pos[a]}),{total:h,start:d,end:m,inner:b}})}function Zbe(t,e,r,n,i){var a=t.props.isDisplayInnerSnapDigit,s=[];return["vertical","horizontal"].forEach(function(o){var c=e.filter(function(A){return A.type===o}),h=o==="vertical"?1:0,d=h?0:1,m=Ybe(o,c,n,a),b=h?Ig:Ag,x=h?Ag:Ig,E=n[b.start],T=n[b.end];m.forEach(function(A){var M=A.total,F=A.start,N=A.end,O=A.inner,U=r[d]+M[0].pos[d]-n[x.start],j=n;F.forEach(function(H){var G=H.elementRect.rect,X=j[b.start]-G[b.end];if(X>0){var ae=[0,0];ae[h]=r[h]+j[b.start]-E-X,ae[d]=U,s.push(N1(t,o,"dashed",s.length,X,ae,H.className,i))}j=G}),j=n,N.forEach(function(H){var G=H.elementRect.rect,X=G[b.start]-j[b.end];if(X>0){var ae=[0,0];ae[h]=r[h]+j[b.end]-E,ae[d]=U,s.push(N1(t,o,"dashed",s.length,X,ae,H.className,i))}j=G}),O.forEach(function(H){var G=H.elementRect.rect,X=E-G[b.start],ae=G[b.end]-T,Q=[0,0],W=[0,0];Q[h]=r[h]-X,Q[d]=U,W[h]=r[h]+T-E,W[d]=U,s.push(N1(t,o,"dashed",s.length,X,Q,H.className,i)),s.push(N1(t,o,"dashed",s.length,ae,W,H.className,i))})})}),s}function Kbe(t,e,r,n,i){var a=[];return["horizontal","vertical"].forEach(function(s){var o=e.filter(function(A){return A.type===s}).slice(0,1),c=s==="vertical"?0:1,h=c?0:1,d=c?Ig:Ag,m=c?Ag:Ig,b=n[d.start],x=n[d.end],E=n[m.start],T=n[m.end];o.forEach(function(A){var M=A.gap,F=A.gapRects,N=Math.max.apply(Math,yn([E],Zt(F.map(function(j){var H=j.rect;return H[m.start]})),!1)),O=Math.min.apply(Math,yn([T],Zt(F.map(function(j){var H=j.rect;return H[m.end]})),!1)),U=(N+O)/2;N===O||U===(E+T)/2||F.forEach(function(j){var H=j.rect,G=j.className,X=[r[0],r[1]];if(H[d.end]<b)X[c]+=H[d.end]-b;else if(x<H[d.start])X[c]+=H[d.start]-b-M;else return;X[h]+=U-E,a.push(N1(t,c?"vertical":"horizontal","gap",a.length,M,X,G,i))})})}),a}function wR(t){var e,r,n=t.state,i=n.containerClientRect,a=n.hasFixed,s=i.overflow,o=i.scrollHeight,c=i.scrollWidth,h=i.clientHeight,d=i.clientWidth,m=i.clientLeft,b=i.clientTop,x=t.props,E=x.snapGap,T=E===void 0?!0:E,A=x.verticalGuidelines,M=x.horizontalGuidelines,F=x.snapThreshold,N=F===void 0?5:F,O=x.maxSnapElementGuidelineDistance,U=O===void 0?1/0:O,j=x.isDisplayGridGuidelines,H=Bh(Wh(t.state)),G=H.top,X=H.left,ae=H.bottom,Q=H.right,W={top:G,left:X,bottom:ae,right:Q,center:(X+Q)/2,middle:(G+ae)/2},oe=txe(t),se=yn([],Zt(oe),!1),he=((r=(e=n.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&r!==void 0?r:[1,1]).map(function(xe){return xe*N});T&&se.push.apply(se,yn([],Zt(Jbe(t,W,he)),!1));var _e=Gt({},n.snapOffset||{left:0,top:0,bottom:0,right:0});if(se.push.apply(se,yn([],Zt(exe(t,s?c:d,s?o:h,m,b,_e,j)),!1)),a){var Ce=i.left,me=i.top;_e.left+=Ce,_e.top+=me,_e.right+=Ce,_e.bottom+=me}return se.push.apply(se,yn([],Zt(xK(M||!1,A||!1,s?c:d,s?o:h,m,b,_e)),!1)),se=se.filter(function(xe){var Ae=xe.element,De=xe.elementRect,de=xe.type;if(!Ae||!De)return!0;var Ee=De.rect;return bK(W,Ee,de,U)}),se}function Jbe(t,e,r){var n=t.props,i=n.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,s=n.maxSnapElementGapDistance,o=s===void 0?1/0:s,c=t.state.elementRects,h=[];return[["vertical",Ag,Ig],["horizontal",Ig,Ag]].forEach(function(d){var m=Zt(d,3),b=m[0],x=m[1],E=m[2],T=e[x.start],A=e[x.end],M=e[x.center],F=e[E.start],N=e[E.end],O={left:r[0],top:r[1]};function U(G){var X=G.rect,ae=O[x.start];return X[x.end]<T+ae?T-X[x.end]:A-ae<X[x.start]?X[x.start]-A:-1}var j=c.filter(function(G){var X=G.rect;return X[E.start]>N||X[E.end]<F?!1:U(G)>0}).sort(function(G,X){return U(G)-U(X)}),H=[];j.forEach(function(G){j.forEach(function(X){if(G!==X){var ae=G.rect,Q=X.rect,W=ae[E.start],oe=ae[E.end],se=Q[E.start],he=Q[E.end];W>he||se>oe||H.push([G,X])}})}),H.forEach(function(G){var X=Zt(G,2),ae=X[0],Q=X[1],W=ae.rect,oe=Q.rect,se=W[x.start],he=W[x.end],_e=oe[x.start],Ce=oe[x.end],me=O[x.start],xe=0,Ae=0,De=!1,de=!1,Ee=!1;if(he<=T&&A<=_e){if(de=!0,xe=(_e-he-(A-T))/2,Ae=he+xe+(A-T)/2,nn(Ae-M)>me)return}else if(he<_e&&Ce<T+me){if(De=!0,xe=_e-he,Ae=Ce+xe,nn(Ae-T)>me)return}else if(he<_e&&A-me<se){if(Ee=!0,xe=_e-he,Ae=se-xe,nn(Ae-A)>me)return}else return;xe&&bK(e,oe,b,a)&&(xe>o||h.push({type:b,pos:b==="vertical"?[Ae,0]:[0,Ae],element:Q.element,size:0,className:Q.className,isStart:De,isCenter:de,isEnd:Ee,gap:xe,hide:!0,gapRects:[ae,Q],direction:"",elementDirection:""}))})}),h}function Qbe(t,e,r,n){var i,a,s=t.props,o=t.state,c=s.snapGridAll,h=s.snapGridWidth,d=h===void 0?0:h,m=s.snapGridHeight,b=m===void 0?0:m,x=o.snapRenderInfo,E=x&&(((i=x.direction)===null||i===void 0?void 0:i[0])||((a=x.direction)===null||a===void 0?void 0:a[1])),T=t.moveables;if(c&&T&&E&&(d||b)){if(o.snapThresholdInfo)return;o.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var A=t.getRect(),M=A.children,F=x.direction;if(M){var N=F.map(function(U,j){var H=j===0?{snapSize:d,posName:"left",sizeName:"width",clientOffset:n.left-e}:{snapSize:b,posName:"top",sizeName:"height",clientOffset:n.top-r},G=H.snapSize,X=H.posName,ae=H.sizeName,Q=H.clientOffset;if(!G)return{dir:U,multiple:1,snapSize:G,snapOffset:0};var W=A[ae],oe=A[X],se=W_e(M.map(function(De){return[De[X]-oe,De[ae],W-De[ae]-De[X]+oe]})).filter(function(De){return De}).sort(function(De,de){return De-de}),he=se[0],_e=se.map(function(De){return Fi(De/he,.1)*G}),Ce=1,me=Fi(W/he,.1);for(Ce=1;Ce<=10&&!_e.every(function(De){return De*Ce%1===0});++Ce);var xe=(-U+1)/2,Ae=eE(oe-Q,oe-Q+W,xe,1-xe);return{multiple:me*Ce,dir:U,snapSize:G,snapOffset:Math.round(Ae/G)}}),O=N.map(function(U){return U.multiple||1});o.snapThresholdInfo.multiples=O,o.snapThresholdInfo.offset=N.map(function(U){return U.snapOffset}),N.forEach(function(U,j){U.snapSize})}}else o.snapThresholdInfo=null}function exe(t,e,r,n,i,a,s){n===void 0&&(n=0),i===void 0&&(i=0);var o=t.props,c=t.state,h=o.snapGridWidth,d=h===void 0?0:h,m=o.snapGridHeight,b=m===void 0?0:m,x=[],E=a.left,T=a.top,A=[0,0];Qbe(t,n,i,a);var M=c.snapThresholdInfo,F=d,N=b;if(M&&(d*=M.multiples[0]||1,b*=M.multiples[1]||1,A=M.offset),b){for(var O=function(j){x.push({type:"horizontal",pos:[E,Fi(A[1]*N+j-i+T,.1)],className:yi("grid-guideline"),size:e,hide:!s,direction:"",grid:!0})},U=0;U<=r*2;U+=b)O(U);for(var U=-b;U>=-r;U-=b)O(U)}if(d){for(var O=function(H){x.push({type:"vertical",pos:[Fi(A[0]*F+H-n+E,.1),T],className:yi("grid-guideline"),size:r,hide:!s,direction:"",grid:!0})},U=0;U<=e*2;U+=d)O(U);for(var U=-d;U>=-e;U-=d)O(U)}return x}function bK(t,e,r,n){return r==="horizontal"?nn(t.right-e.left)<=n||nn(t.left-e.right)<=n||t.left<=e.right&&e.left<=t.right:r==="vertical"?nn(t.bottom-e.top)<=n||nn(t.top-e.bottom)<=n||t.top<=e.bottom&&e.top<=t.bottom:!0}function txe(t){var e=t.state,r=t.props.elementGuidelines,n=r===void 0?[]:r;if(!n.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(b){return!b.refresh}),a=n.map(function(b){return Cf(b)&&"element"in b?Gt(Gt({},b),{element:bd(b.element,!0)}):{element:bd(b,!0)}}).filter(function(b){return b.element}),s=f1e(i.map(function(b){return b.element}),a.map(function(b){return b.element})),o=s.maintained,c=s.added,h=[];o.forEach(function(b){var x=Zt(b,2),E=x[0],T=x[1];h[T]=i[E]}),rxe(t,c.map(function(b){return a[b]})).map(function(b,x){h[c[x]]=b}),e.elementRects=h;var d=jO(t.props.elementSnapDirections),m=[];return h.forEach(function(b){var x=b.element,E=b.top,T=E===void 0?d.top:E,A=b.left,M=A===void 0?d.left:A,F=b.right,N=F===void 0?d.right:F,O=b.bottom,U=O===void 0?d.bottom:O,j=b.center,H=j===void 0?d.center:j,G=b.middle,X=G===void 0?d.middle:G,ae=b.className,Q=b.rect,W=UO({top:T,right:N,left:M,bottom:U,center:H,middle:X},Q),oe=W.horizontal,se=W.vertical,he=W.horizontalNames,_e=W.verticalNames,Ce=Q.top,me=Q.left,xe=Q.right-me,Ae=Q.bottom-Ce,De=[xe,Ae];se.forEach(function(de,Ee){m.push({type:"vertical",element:x,pos:[Fi(de,.1),Ce],size:Ae,sizes:De,className:ae,elementRect:b,elementDirection:$9[_e[Ee]]||_e[Ee],direction:""})}),oe.forEach(function(de,Ee){m.push({type:"horizontal",element:x,pos:[me,Fi(de,.1)],size:xe,sizes:De,className:ae,elementRect:b,elementDirection:$9[he[Ee]]||he[Ee],direction:""})})}),m}function Q9(t,e){return t?t.map(function(r){var n=Cf(r)?r:{pos:r},i=n.pos;return $b(i)?n:Gt(Gt({},n),{pos:xo(i,e)})}):[]}function xK(t,e,r,n,i,a,s){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s={left:0,top:0,right:0,bottom:0});var o=[],c=s.left,h=s.top,d=s.bottom,m=s.right,b=r+m-c,x=n+d-h;return Q9(t,x).forEach(function(E){o.push({type:"horizontal",pos:[c,Fi(E.pos-a+h,.1)],size:b,className:E.className,direction:""})}),Q9(e,b).forEach(function(E){o.push({type:"vertical",pos:[Fi(E.pos-i+c,.1),h],size:x,className:E.className,direction:""})}),o}function rxe(t,e){if(!e.length)return[];var r=t.props.groupable,n=t.state,i=n.containerClientRect,a=n.rootMatrix,s=n.is3d,o=n.offsetDelta,c=s?4:3,h=Zt(Cbe(a,i,c),2),d=h[0],m=h[1],b=r?0:o[0],x=r?0:o[1];return e.map(function(E){var T=E.element.getBoundingClientRect(),A=T.left-d-b,M=T.top-m-x,F=M+T.height,N=A+T.width,O=Zt(W0(a,[A,M],c),2),U=O[0],j=O[1],H=Zt(W0(a,[N,F],c),2),G=H[0],X=H[1];return Gt(Gt({},E),{rect:{left:U,right:G,top:j,bottom:X,center:(U+G)/2,middle:(j+X)/2}})})}function mw(t){var e=t.state,r=e.container,n=t.props.snapContainer||r;if(e.snapContainer===n&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(r!==n){var s=bd(n,!0);if(s){var o=mb(s),c=a7(e,[o.left-i.left,o.top-i.top]),h=a7(e,[o.right-i.right,o.bottom-i.bottom]);a.left=Fi(c[0],1e-5),a.top=Fi(c[1],1e-5),a.right=Fi(h[0],1e-5),a.bottom=Fi(h[1],1e-5)}}return e.snapContainer=n,e.snapOffset=a,e.guidelines=wR(t),e.enableSnap=!0,!0}function wK(t,e,r,n,i,a){var s=Ey(t,e,r,a?4:3),o=zl(s,n);return WO(s,_i(i,o))}function e7(t){return t?t/nn(t):0}function nxe(t,e,r,n,i,a){var s=a.fixedDirection,o=kbe(r,s,n),c=$O(t,e,r,n),h=yn(yn([],Zt(Vbe(t,e,o,n,i,a)),!1),Zt(mK(t,c,a)),!1),d=aE(h,0),m=aE(h,1);return{width:{isBound:d.isBound,offset:d.offset[0]},height:{isBound:m.isBound,offset:m.offset[1]}}}function ixe(t,e,r,n,i,a,s,o,c){var h=zl(e,s),d=l3(t,o,{vertical:[h[0]],horizontal:[h[1]]}),m=d.horizontal.offset,b=d.vertical.offset;if(Fi(b,gR)||Fi(m,gR)){var x=Zt(Rd({datas:c,distX:-b,distY:-m}),2),E=x[0],T=x[1],A=Math.min(i||1/0,r+s[0]*E),M=Math.min(a||1/0,n+s[1]*T);return[A-r,M-n]}return[0,0]}function SK(t,e,r,n,i,a,s,o){for(var c=Wh(t.state),h=t.props.keepRatio,d=0,m=0,b=0;b<2;++b){var x=e(d,m),E=nxe(t,x,i,h,s,o),T=E.width,A=E.height,M=T.isBound,F=A.isBound,N=T.offset,O=A.offset;if(b===1&&(M||(N=0),F||(O=0)),b===0&&s&&!M&&!F)return[0,0];if(h){var U=nn(N)*(r?1/r:1),j=nn(O)*(n?1/n:1),H=M&&F?U<j:F||!M&&U<j;H?N=r*O/n:O=n*N/r}d+=N,m+=O}if(!h&&i[0]&&i[1]){var G=qbe(t,c,i,a,o),X=G.maxWidth,ae=G.maxHeight,Q=Zt(ixe(t,e(d,m).map(function(se){return se.map(function(he){return Fi(he,gR)})}),r+d,n+m,X,ae,i,s,o),2),N=Q[0],O=Q[1];d+=N,m+=O}return[d,m]}function pb(t){return t<0&&(t=t%360+360),t%=360,t}function axe(t,e){e=pb(e);var r=Math.floor(t/360),n=r*360+360-e,i=r*360+e;return nn(t-n)<nn(t-i)?n:i}function KA(t,e){t=pb(t),e=pb(e);var r=pb(t-e);return Math.min(r,360-r)}function oxe(t,e,r,n){var i,a=t.props,s=(i=a[lK])!==null&&i!==void 0?i:5,o=a[uK];if(m_(t,"rotatable")){var c=e.pos1,h=e.pos2,d=e.pos3,m=e.pos4,b=e.origin,x=r*Math.PI/180,E=[c,h,d,m].map(function(O){return _i(O,b)}),T=E.map(function(O){return Fx(O,x)}),A=yn(yn([],Zt(wbe(t,E,T,b,r)),!1),Zt(Lbe(t,E,T,b,r)),!1);A.sort(function(O,U){return nn(O-r)-nn(U-r)});var M=A.length>0;if(M)return{isSnap:M,dist:M?A[0]:r}}if(o?.length&&s){var F=o.slice().sort(function(O,U){return KA(O,n)-KA(U,n)}),N=F[0];if(KA(N,n)<=s)return{isSnap:!0,dist:r+axe(n,N)-n}}return{isSnap:!1,dist:r}}function sxe(t,e,r,n,i,a,s){if(!m_(t,"resizable"))return[0,0];var o=s.fixedDirection,c=s.nextAllMatrix,h=t.state,d=h.allMatrix,m=h.is3d;return SK(t,function(b,x){return wK(c||d,e+b,r+x,o,i,m)},e,r,n,i,a,s)}function lxe(t,e,r,n,i){if(!m_(t,"scalable"))return[0,0];var a=i.startOffsetWidth,s=i.startOffsetHeight,o=i.fixedPosition,c=i.fixedDirection,h=i.is3d,d=SK(t,function(m,b){return wK(sbe(i,Ma(e,[m/a,b/s])),a,s,c,o,h)},a,s,r,o,n,i);return[d[0]/a,d[1]/s]}function uxe(t,e){e.absolutePoses=Wh(t.state)}function t7(t){var e=[];return t.forEach(function(r){r.guidelineInfos.forEach(function(n){var i=n.guideline;hh(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:r}))})}),e.map(function(r){var n=r.guideline,i=r.posInfo;return Gt(Gt({},n),{direction:i.direction})})}function r7(t,e,r,n,i,a){var s=zO(o3(t,a),e,r),o=s.vertical,c=s.horizontal,h=u0();o.forEach(function(E){E.isBound&&(E.direction==="start"&&(h.left=!0),E.direction==="end"&&(h.right=!0),n.push({type:"bounds",pos:E.pos}))}),c.forEach(function(E){E.isBound&&(E.direction==="start"&&(h.top=!0),E.direction==="end"&&(h.bottom=!0),i.push({type:"bounds",pos:E.pos}))});var d=Fbe(t),m=d.boundMap,b=d.vertical,x=d.horizontal;return b.forEach(function(E){Sp(n,function(T){var A=T.type,M=T.pos;return A==="bounds"&&M===E})>=0||n.push({type:"bounds",pos:E})}),x.forEach(function(E){Sp(i,function(T){var A=T.type,M=T.pos;return A==="bounds"&&M===E})>=0||i.push({type:"bounds",pos:E})}),{boundMap:h,innerBoundMap:m}}var cxe=YO("",["resizable","scalable"]),hxe={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",lK,uK,cK,hK,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(t,e){var r=t.state,n=r.top,i=r.left,a=r.pos1,s=r.pos2,o=r.pos3,c=r.pos4,h=r.snapRenderInfo,d=t.props.snapRenderThreshold,m=d===void 0?1:d;if(!h||!h.render||!m_(t,""))return h0(t,"boundMap",u0(),function(we){return JSON.stringify(we)}),h0(t,"innerBoundMap",u0(),function(we){return JSON.stringify(we)}),[];r.guidelines=wR(t);var b=Math.min(a[0],s[0],o[0],c[0]),x=Math.min(a[1],s[1],o[1],c[1]),E=h.externalPoses||[],T=Wh(t.state),A=[],M=[],F=[],N=[],O=[],U=Bh(T),j=U.width,H=U.height,G=U.top,X=U.left,ae=U.bottom,Q=U.right,W={left:X,right:Q,top:G,bottom:ae,center:(X+Q)/2,middle:(G+ae)/2},oe=E.length>0,se=oe?Bh(E):{};if(!h.request){if(h.direction&&O.push(Pbe(t,T,h.direction,m,m)),h.snap){var he=Bh(T);h.center&&(he.middle=(he.top+he.bottom)/2,he.center=(he.left+he.right)/2),O.push(q9(t,he,m,m))}oe&&(h.center&&(se.middle=(se.top+se.bottom)/2,se.center=(se.left+se.right)/2),O.push(q9(t,se,m,m))),O.forEach(function(we){var Le=we.vertical.posInfos,Fe=we.horizontal.posInfos;A.push.apply(A,yn([],Zt(Le.filter(function(Xe){var Be=Xe.guidelineInfos;return Be.some(function(ot){var Qe=ot.guideline;return!Qe.hide})}).map(function(Xe){return{type:"snap",pos:Xe.pos}})),!1)),M.push.apply(M,yn([],Zt(Fe.filter(function(Xe){var Be=Xe.guidelineInfos;return Be.some(function(ot){var Qe=ot.guideline;return!Qe.hide})}).map(function(Xe){return{type:"snap",pos:Xe.pos}})),!1)),F.push.apply(F,yn([],Zt(t7(Le)),!1)),N.push.apply(N,yn([],Zt(t7(Fe)),!1))})}var _e=r7(t,[X,Q],[G,ae],A,M),Ce=_e.boundMap,me=_e.innerBoundMap;oe&&r7(t,[se.left,se.right],[se.top,se.bottom],A,M,h.externalBounds);var xe=yn(yn([],Zt(F),!1),Zt(N),!1),Ae=xe.filter(function(we){return we.element&&!we.gapRects}),De=xe.filter(function(we){return we.gapRects}).sort(function(we,Le){return we.gap-Le.gap});Gn(t,"onSnap",{guidelines:xe.filter(function(we){var Le=we.element;return!Le}),elements:Ae,gaps:De},!0);var de=h0(t,"boundMap",Ce,function(we){return JSON.stringify(we)},u0()),Ee=h0(t,"innerBoundMap",me,function(we){return JSON.stringify(we)},u0());return(Ce===de||me===Ee)&&Gn(t,"onBound",{bounds:Ce,innerBounds:me},!0),yn(yn(yn(yn(yn(yn([],Zt(Zbe(t,Ae,[b,x],W,e)),!1),Zt(Kbe(t,De,[b,x],W,e)),!1),Zt(J9(t,"horizontal",N,[i,n],W,e)),!1),Zt(J9(t,"vertical",F,[i,n],W,e)),!1),Zt(K9(t,"horizontal",M,b,n,j,0,e)),!1),Zt(K9(t,"vertical",A,x,i,H,1,e)),!1)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},mw(t)},drag:function(t){var e=t.state;mw(t)||(e.guidelines=wR(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){if(cxe(t,e)||xR(t,e))return!0;if(!e.isRequest&&e.inputEvent)return Bl(e.inputEvent.target,yi("snap-control"))},dragControlStart:function(t){t.state.snapRenderInfo=null,mw(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,mw(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function fxe(t,e){return[t[0]*e[0],t[1]*e[1]]}function yi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return P_e.apply(void 0,yn([NO],Zt(t),!1))}function EK(t){t()}function dxe(t){return!t||t==="none"?[1,0,0,1,0,0]:Cf(t)?t:Hb(t)}function gb(t,e,r){return tE(e,ey(r,e),t,ey(r.map(function(n){return-n}),e))}function pxe(t,e,r){if(e==="%"){var n=HO(t.ownerSVGElement);return n[r?"width":"height"]/100}return 1}function gxe(t){var e=mxe(GO(t,":before"));return e.map(function(r,n){var i=Lx(r),a=i.value,s=i.unit;return a*pxe(t,s,n===0)})}function sE(t){return t?t.split(" "):["0","0"]}function mxe(t){return sE(t.transformOrigin)}function TK(t){var e=Nc(t),r=e("transform");if(r&&r!=="none")return r;if("transform"in t){var n=t.transform,i=n.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var s=[],o=function(h){var d=i[h].matrix;s.push("matrix(".concat(["a","b","c","d","e","f"].map(function(m){return d[m]}).join(", "),")"))},c=0;c<a;++c)o(c);return s.join(" ")}return""}function Gb(t,e,r,n,i){var a,s,o=AO(t)||zg(t),c=!1,h,d;if(!t||r)h=t;else{var m=(a=t?.assignedSlot)===null||a===void 0?void 0:a.parentElement,b=t.parentElement;m?(c=!0,d=b,h=m):h=b}for(var x=!1,E=t===e||h===e,T="relative",A=1,M=parseFloat(i?.("zoom"))||1,F=i?.("position");h&&h!==o;){e===h&&(E=!0);var N=Nc(h),O=h.tagName.toLowerCase(),U=TK(h),j=N("willChange"),H=parseFloat(N("zoom"))||1;if(T=N("position"),n&&H!==1){A=H;break}if(!r&&n&&M!==1&&F&&F!=="absolute"||O==="svg"||O==="foreignobject"||T!=="static"||U&&U!=="none"||j==="transform")break;var G=(s=t?.assignedSlot)===null||s===void 0?void 0:s.parentNode,X=h.parentNode;G&&(c=!0,d=X);var ae=X;if(ae&&ae.nodeType===11){h=ae.host,x=!0,T=Nc(h)("position");break}h=ae,T="relative"}return{offsetZoom:A,hasSlot:c,parentSlotElement:d,isCustomElement:x,isStatic:T==="static",isEnd:E||!h||h===o,offsetParent:h||o}}function yxe(t,e){var r,n=t.tagName.toLowerCase(),i=t.offsetLeft,a=t.offsetTop,s=Nc(t),o=wO(i),c=!o,h,d;return!c&&(n!=="svg"||t.ownerSVGElement)?(h=HZ?gxe(t):sE(s("transformOrigin")).map(function(m){return parseFloat(m)}),d=h.slice(),c=!0,n==="svg"?(i=0,a=0):(r=Zt(bxe(t,h,t===e&&e.tagName.toLowerCase()==="g"),4),i=r[0],a=r[1],h[0]=r[2],h[1]=r[3])):(h=sE(s("transformOrigin")).map(function(m){return parseFloat(m)}),d=h.slice()),{tagName:n,isSVG:o,hasOffset:c,offset:[i||0,a||0],origin:h,targetOrigin:d}}function CK(t,e){var r=Nc(t),n=Nc(zg(t)),i=n("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(n("marginLeft"),10),s=parseInt(n("marginTop"),10);return r("position")==="absolute"&&((r("top")!=="auto"||r("bottom")!=="auto")&&(s=0),(r("left")!=="auto"||r("right")!=="auto")&&(a=0)),[a,s]}function SR(t){t.forEach(function(e){var r=e.matrix;r&&(e.matrix=Af(r,3,4))})}function vxe(t){for(var e=t.parentElement,r=!1,n=zg(t);e;){var i=GO(e).transform;if(i&&i!=="none"){r=!0;break}if(e===n)break;e=e.parentElement}return{fixedContainer:e||n,hasTransform:r}}function u3(t,e){return e===void 0&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(FZ(t,!e).join(","),")")}function HO(t){var e=t.clientWidth,r=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:r};var n=t.viewBox,i=n&&n.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||r,clientWidth:e,clientHeight:r}}function _xe(t,e){var r,n=HO(t),i=n.width,a=n.height,s=n.clientWidth,o=n.clientHeight,c=s/i,h=o/a,d=t.preserveAspectRatio.baseVal,m=d.align,b=d.meetOrSlice,x=[0,0],E=[c,h],T=[0,0];if(m!==1){var A=(m-2)%3,M=Math.floor((m-2)/3);x[0]=i*A/2,x[1]=a*M/2;var F=b===2?Math.max(h,c):Math.min(c,h);E[0]=F,E[1]=F,T[0]=(s-i)/2*A,T[1]=(o-a)/2*M}var N=PO(E,e);return r=Zt(T,2),N[e*(e-1)]=r[0],N[e*(e-1)+1]=r[1],gb(N,e,x)}function bxe(t,e,r){var n=t.tagName.toLowerCase();if(!t.getBBox||!r&&n==="g")return[0,0,0,0];var i=Nc(t),a=i("transform-box")==="fill-box",s=t.getBBox(),o=HO(t.ownerSVGElement),c=s.x,h=s.y;n==="foreignobject"&&!c&&!h&&(c=parseFloat(t.getAttribute("x"))||0,h=parseFloat(t.getAttribute("y"))||0);var d=c-o.x,m=h-o.y,b=a?e[0]:e[0]-d,x=a?e[1]:e[1]-m;return[d,m,b,x]}function bs(t,e,r){return tc(t,Qm(e,r),r)}function Ey(t,e,r,n){return[[0,0],[e,0],[0,r],[e,r]].map(function(i){return bs(t,i,n)})}function Bh(t){var e=t.map(function(h){return h[0]}),r=t.map(function(h){return h[1]}),n=Math.min.apply(Math,yn([],Zt(e),!1)),i=Math.min.apply(Math,yn([],Zt(r),!1)),a=Math.max.apply(Math,yn([],Zt(e),!1)),s=Math.max.apply(Math,yn([],Zt(r),!1)),o=a-n,c=s-i;return{left:n,top:i,right:a,bottom:s,width:o,height:c}}function n7(t,e,r,n){var i=Ey(t,e,r,n);return Bh(i)}function xxe(t,e,r,n,i){var a,s=t.target,o=t.origin,c=e.matrix,h=IK(s),d=h.offsetWidth,m=h.offsetHeight,b=r.getBoundingClientRect(),x=[0,0];r===zg(r)&&(x=CK(s,!0));for(var E=s.getBoundingClientRect(),T=E.left-b.left+r.scrollLeft-(r.clientLeft||0)+x[0],A=E.top-b.top+r.scrollTop-(r.clientTop||0)+x[1],M=E.width,F=E.height,N=tE(n,i,c),O=n7(N,d,m,n),U=O.left,j=O.top,H=O.width,G=O.height,X=bs(N,o,n),ae=_i(X,[U,j]),Q=[T+ae[0]*M/H,A+ae[1]*F/G],W=[0,0],oe=0;++oe<10;){var se=Ed(i,n);a=Zt(_i(bs(se,Q,n),bs(se,X,n)),2),W[0]=a[0],W[1]=a[1];var he=tE(n,i,ey(W,n),c),_e=n7(he,d,m,n),Ce=_e.left,me=_e.top,xe=Ce-T,Ae=me-A;if(nn(xe)<2&&nn(Ae)<2)break;Q[0]-=xe,Q[1]-=Ae}return W.map(function(De){return Math.round(De)})}function wxe(t,e,r){var n=t.length===16,i=n?4:3,a=e.map(function(c){return bs(t,c,i)}),s=r.left,o=r.top;return a.map(function(c){return[c[0]+s,c[1]+o]})}function Hh(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function AK(t,e){return Hh([e[0]-t[0],e[1]-t[1]])}function L1(t,e,r,n){r===void 0&&(r=1),n===void 0&&(n=il(t,e));var i=AK(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(n,"rad) scaleY(").concat(r,")"),width:"".concat(i,"px")}}function lE(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r.length,a=r.reduce(function(o,c){return o+c[0]},0)/i,s=r.reduce(function(o,c){return o+c[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(s,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function ry(t,e){var r=t[e];return Cf(r)?Gt(Gt({},t),r):t}function IK(t){var e=t&&!wO(t.offsetWidth),r=0,n=0,i=0,a=0,s=0,o=0,c=0,h=0,d=0,m=0,b=0,x=0,E=1/0,T=1/0,A=1/0,M=1/0,F=0,N=0,O=!1;if(t)if(!e&&t.ownerSVGElement){var U=t.getBBox();O=!0,r=U.width,n=U.height,s=r,o=n,c=r,h=n,i=r,a=n}else{var j=Nc(t),H=t.style,G=j("boxSizing")==="border-box",X=parseFloat(j("borderLeftWidth"))||0,ae=parseFloat(j("borderRightWidth"))||0,Q=parseFloat(j("borderTopWidth"))||0,W=parseFloat(j("borderBottomWidth"))||0,oe=parseFloat(j("paddingLeft"))||0,se=parseFloat(j("paddingRight"))||0,he=parseFloat(j("paddingTop"))||0,_e=parseFloat(j("paddingBottom"))||0,Ce=oe+se,me=he+_e,xe=X+ae,Ae=Q+W,De=Ce+xe,de=me+Ae,Ee=j("position"),we=0,Le=0;if("clientLeft"in t){var Fe=null;if(Ee==="absolute"){var Xe=Gb(t,zg(t));Fe=Xe.offsetParent}else Fe=t.parentElement;if(Fe){var Be=Nc(Fe);we=parseFloat(Be("width")),Le=parseFloat(Be("height"))}}d=Math.max(Ce,xo(j("minWidth"),we)||0),m=Math.max(me,xo(j("minHeight"),Le)||0),E=xo(j("maxWidth"),we),T=xo(j("maxHeight"),Le),isNaN(E)&&(E=1/0),isNaN(T)&&(T=1/0),F=xo(H.width,0)||0,N=xo(H.height,0)||0,s=parseFloat(j("width"))||0,o=parseFloat(j("height"))||0,c=nn(s-F)<1?aR(d,F||s,E):s,h=nn(o-N)<1?aR(m,N||o,T):o,r=c,n=h,i=c,a=h,G?(A=E,M=T,b=d,x=m,c=r-De,h=n-de):(A=E+De,M=T+de,b=d+De,x=m+de,r=c+De,n=h+de),i=c+Ce,a=h+me}return{svg:O,offsetWidth:r,offsetHeight:n,clientWidth:i,clientHeight:a,contentWidth:c,contentHeight:h,inlineCSSWidth:F,inlineCSSHeight:N,cssWidth:s,cssHeight:o,minWidth:d,minHeight:m,maxWidth:E,maxHeight:T,minOffsetWidth:b,minOffsetHeight:x,maxOffsetWidth:A,maxOffsetHeight:M}}function PK(t,e){return il(e>0?t[0]:t[1],e>0?t[1]:t[0])}function yw(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function kK(t,e){var r=t===zg(t)||t===AO(t),n={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return r&&(n.clientHeight=Math.max(e.height,n.clientHeight),n.scrollHeight=Math.max(e.height,n.scrollHeight)),n.overflow=Nc(t)("overflow")!=="visible",Gt(Gt({},e),n)}function JA(t,e,r,n){var i=t.left,a=t.right,s=t.top,o=t.bottom,c=e.top,h=e.left,d={left:h+i,top:c+s,right:h+a,bottom:c+o,width:a-i,height:o-s};return r&&n?kK(r,d):d}function mb(t,e){var r=0,n=0,i=0,a=0;if(t){var s=t.getBoundingClientRect();r=s.left,n=s.top,i=s.width,a=s.height}var o={left:r,top:n,width:i,height:a,right:r+i,bottom:n+a};return t&&e?kK(t,o):o}function Sxe(t){var e=t.props,r=e.groupable,n=e.svgOrigin,i=t.getState(),a=i.offsetWidth,s=i.offsetHeight,o=i.svg,c=i.transformOrigin;return!r&&o&&n?KO(n,a,s):c}function RK(t,e,r,n){var i;if(t)i=t;else if(e)i=[0,0];else{var a=r.target;i=MK(a,n)}return i}function MK(t,e){if(t){var r=t.getAttribute("data-rotation")||"",n=t.getAttribute("data-direction");if(e.deg=r,!!n){var i=[0,0];return n.indexOf("w")>-1&&(i[0]=-1),n.indexOf("e")>-1&&(i[0]=1),n.indexOf("n")>-1&&(i[1]=-1),n.indexOf("s")>-1&&(i[1]=1),i}}}function WO(t,e){return[Ma(e,t[0]),Ma(e,t[1]),Ma(e,t[2]),Ma(e,t[3])]}function Wh(t){var e=t.left,r=t.top,n=t.pos1,i=t.pos2,a=t.pos3,s=t.pos4;return WO([n,i,a,s],[e,r])}function ER(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(r){r.unset&&r.unset(t)})}function c0(t,e){var r=e?"controlGesto":"targetGesto",n=t[r];n?.isIdle()===!1&&ER(t,e),n?.unset(),t[r]=null}function yc(t,e){if(e){var r=g_(e);r.nextStyle=Gt(Gt({},r.nextStyle),t)}return{style:t,cssText:d_(t).map(function(n){return"".concat(U_e(n,"-"),": ").concat(t[n],";")}).join("")}}function DK(t,e,r){var n=e.afterTransform||e.transform;return Gt(Gt({},yc(Gt(Gt(Gt({},t.style),e.style),{transform:n}),r)),{afterTransform:n,transform:t.transform})}function Ki(t,e,r,n){var i=e.datas;i.datas||(i.datas={});var a=Gt(Gt({},r),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var s;(s=e.stop)===null||s===void 0||s.call(e)}});return i.isStartEvent?n||(i.lastEvent=a):i.isStartEvent=!0,a}function fh(t,e,r){var n=e.datas,i="isDrag"in r?r.isDrag:e.isDrag;return n.datas||(n.datas={}),Gt(Gt({isDrag:i},r),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:n.lastEvent,isDouble:e.isDouble,datas:n.datas,isFirstDrag:!!e.isFirstDrag})}function c3(t,e,r){t._emitter.on(e,r)}function Gn(t,e,r,n,i){return t.triggerEvent(e,r,n,i)}function GO(t,e){return xg(t).getComputedStyle(t,e)}function vw(t,e,r){var n={},i={};return t.filter(function(a){var s=a.name;if(n[s]||!e.some(function(o){return a[o]}))return!1;if(!r&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return n[s]=!0,!0})}function TR(t,e){return t===e||t==null&&e==null}function i7(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length-1,n=0;n<r;++n){var i=t[n];if(!wO(i))return i}return t[r]}function OK(t,e){var r=[],n=[];return t.forEach(function(i,a){var s=e(i,a,t),o=n.indexOf(s),c=r[o]||[];o===-1&&(n.push(s),r.push(c)),c.push(i)}),r}function Exe(t,e){var r=[],n={};return t.forEach(function(i,a){var s=e(i,a,t),o=n[s];o||(o=[],n[s]=o,r.push(o)),o.push(i)}),r}function NK(t){return t.reduce(function(e,r){return e.concat(r)},[])}function H0(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort(function(r,n){return nn(n)-nn(r)}),t[0]}function W0(t,e,r){return tc(Ed(t,r),Qm(e,r),r)}function Txe(t,e){var r,n=t.is3d,i=t.rootMatrix,a=n?4:3;return r=Zt(W0(i,[e.distX,e.distY],a),2),e.distX=r[0],e.distY=r[1],e}function Ah(t,e,r,n){if(!r[0]&&!r[1])return e;var i=bs(t,[e7(r[0]||1),0],n),a=bs(t,[0,e7(r[1]||1)],n),s=bs(t,[r[0]/Hh(i),r[1]/Hh(a)],n);return Ma(e,s)}function yf(t,e,r){return r?"".concat(t/e*100,"%"):"".concat(t,"px")}function uE(t){return nn(t)<=bc?0:t}function XO(t){return function(e){if(!e.isDragging(t))return"";var r=pbe(e,t),n=r.deg;return n?yi("view-control-rotation".concat(n)):""}}function YO(t,e){return e===void 0&&(e=[t]),function(r,n){if(n.isRequest)return e.some(function(a){return n.requestAble===a})?n.parentDirection:!1;var i=n.inputEvent.target;return Bl(i,yi("direction"))&&(!t||Bl(i,yi(t)))}}function Cxe(t,e,r){var n,i=V0(t,{"x%":function(U){return U/100*e.offsetWidth},"y%":function(U){return U/100*e.offsetHeight}}),a=t.slice(0,r<0?void 0:r),s=t.slice(0,r<0?void 0:r+1),o=t[r]||"",c=r<0?[]:t.slice(r),h=r<0?[]:t.slice(r+1),d=i.slice(0,r<0?void 0:r),m=i.slice(0,r<0?void 0:r+1),b=(n=i[r])!==null&&n!==void 0?n:V0([""])[0],x=r<0?[]:i.slice(r),E=r<0?[]:i.slice(r+1),T=b?[b]:[],A=Bv(d),M=Bv(m),F=Bv(x),N=Bv(E),O=wo(A,F,4);return{transforms:t,beforeFunctionMatrix:A,beforeFunctionMatrix2:M,targetFunctionMatrix:Bv(T),afterFunctionMatrix:F,afterFunctionMatrix2:N,allFunctionMatrix:O,beforeFunctions:d,beforeFunctions2:m,targetFunction:T[0],afterFunctions:x,afterFunctions2:E,beforeFunctionTexts:a,beforeFunctionTexts2:s,targetFunctionText:o,afterFunctionTexts:c,afterFunctionTexts2:h}}function Axe(t){return!t||!Cf(t)||IO(t)?!1:su(t)||"length"in t}function bd(t,e){return t?IO(t)?t:kp(t)?e?document.querySelector(t):t:SO(t)?t():OZ(t)?t:"current"in t?t.current:t:null}function ZO(t,e){if(!t)return[];var r=Axe(t)?[].slice.call(t):[t];return r.reduce(function(n,i){return kp(i)&&e?yn(yn([],Zt(n),!1),Zt([].slice.call(document.querySelectorAll(i))),!1):(su(i)?n.push(ZO(i,e)):n.push(bd(i,e)),n)},[])}function Ixe(t,e,r){var n=il(t,e)/Math.PI*180;return n=r>=0?n:180-n,n=n>=0?n:360+n,n}function a7(t,e){var r=t.rootMatrix,n=t.is3d,i=n?4:3,a=Ed(r,i);return n||(a=Af(a,3,4)),a[12]=0,a[13]=0,a[14]=0,n1e(a,e)}function LK(t,e,r,n,i){var a=Zt(t,2),s=a[0],o=a[1],c=0,h=0;if(i&&s&&o){var d=il([0,0],e),m=il([0,0],n),b=Hh(e),x=Math.cos(d-m)*b;if(!n[0])h=x,c=h*r;else if(!n[1])c=x,h=c/r;else{var E=n[0]*s,T=n[1]*o,A=Math.atan2(E+e[0],T+e[1]),M=Math.atan2(E,T);A<0&&(A+=Math.PI*2),M<0&&(M+=Math.PI*2);var F=0;nn(A-M)<Math.PI/2||nn(A-M)>Math.PI/2*3||(M+=Math.PI),F=A-M,F>Math.PI*2?F-=Math.PI*2:F>Math.PI?F=2*Math.PI-F:F<-Math.PI&&(F=-2*Math.PI-F);var N=Hh([E+e[0],T+e[1]])*Math.cos(F);c=N*Math.sin(M)-E,h=N*Math.cos(M)-T,n[0]<0&&(c*=-1),n[1]<0&&(h*=-1)}}else c=n[0]*e[0],h=n[1]*e[1];return[c,h]}function FK(t,e,r,n){var i,a=r.ratio,s=r.startOffsetWidth,o=r.startOffsetHeight,c=0,h=0,d=n.distX,m=n.distY,b=n.pinchScale,x=n.parentDistance,E=n.parentDist,T=n.parentScale,A=r.fixedDirection,M=[0,1].map(function(H){return nn(t[H]-A[H])}),F=[0,1].map(function(H){var G=M[H];return G!==0&&(G=2/G),G});if(E)c=E[0],h=E[1],e&&(c?h||(h=c/a):c=h*a);else if($b(b))c=(b-1)*s,h=(b-1)*o;else if(T)c=(T[0]-1)*s,h=(T[1]-1)*o;else if(x){var N=s*M[0],O=o*M[1],U=Hh([N,O]);c=x/U*N*F[0],h=x/U*O*F[1]}else{var j=Rd({datas:r,distX:d,distY:m});j=F.map(function(H,G){return j[G]*H}),i=Zt(LK([s,o],j,a,t,e),2),c=i[0],h=i[1]}return{distWidth:c,distHeight:h}}function CR(t,e){if(e){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};var r=Zt(t.split(" "),2),n=r[0],i=r[1],a=CR(n||""),s=CR(i||""),o=Gt(Gt({},a),s),c={x:"50%",y:"50%"};return o.x&&(c.x=o.x),o.y&&(c.y=o.y),o.value&&(o.x&&!o.y&&(c.y=o.value),!o.x&&o.y&&(c.x=o.value)),c}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function KO(t,e,r){var n=CR(t,!0),i=n.x,a=n.y;return[xo(i,e)||0,xo(a,r)||0]}function Pxe(t,e,r){var n=t.map(function(a){return _i(a,e)}),i=n.map(function(a){return Fx(a,r)});return{prev:n,next:i,result:i.map(function(a){return Ma(a,e)})}}function BK(t,e){return t.length===e.length&&t.every(function(r,n){var i=e[n],a=su(r),s=su(i);return a&&s?BK(r,i):!a&&!s?r===i:!1})}function h0(t,e,r,n,i){var a=t._store,s=a[e];if(!(e in a))if(i!=null)a[e]=i,s=i;else return a[e]=r,r;return s===r||n(s)===n(r)?s:(a[e]=r,r)}function gc(t){return t>=0?1:-1}function nn(t){return Math.abs(t)}function QA(t,e){return H_e(t).map(function(r){return e(r)})}function zK(t){return $b(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var kxe=jx("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,e){var r=e.datas,n=e.targets,i=e.angle,a=e.originalDatas,s=t.props,o=s.pinchable,c=s.ables;if(!o)return!1;var h="onPinch".concat(n?"Group":"","Start"),d="drag".concat(n?"Group":"","ControlStart"),m=(o===!0?t.controlAbles:c.filter(function(T){return o.indexOf(T.name)>-1})).filter(function(T){return T.canPinch&&T[d]}),b=Ki(t,e,{});n&&(b.targets=n);var x=Gn(t,h,b);r.isPinch=x!==!1,r.ables=m;var E=r.isPinch;return E?(m.forEach(function(T){if(a[T.name]=a[T.name]||{},!!T[d]){var A=Gt(Gt({},e),{datas:a[T.name],parentRotate:i,isPinch:!0});T[d](t,A)}}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},E):!1},pinch:function(t,e){var r=e.datas,n=e.scale,i=e.distance,a=e.originalDatas,s=e.inputEvent,o=e.targets,c=e.angle;if(r.isPinch){var h=i*(1-1/n),d=Ki(t,e,{});o&&(d.targets=o);var m="onPinch".concat(o?"Group":"");Gn(t,m,d);var b=r.ables,x="drag".concat(o?"Group":"","Control");return b.forEach(function(E){E[x]&&E[x](t,Gt(Gt({},e),{datas:a[E.name],inputEvent:s,resolveMatrix:!0,pinchScale:n,parentDistance:h,parentRotate:c,isPinch:!0}))}),d}},pinchEnd:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.targets,s=e.originalDatas;if(r.isPinch){var o="onPinch".concat(a?"Group":"","End"),c=fh(t,e,{isDrag:n});a&&(c.targets=a),Gn(t,o,c);var h=r.ables,d="drag".concat(a?"Group":"","ControlEnd");return h.forEach(function(m){m[d]&&m[d](t,Gt(Gt({},e),{isDrag:n,datas:s[m.name],inputEvent:i,isPinch:!0}))}),n}},pinchGroupStart:function(t,e){return this.pinchStart(t,Gt(Gt({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,Gt(Gt({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,Gt(Gt({},e),{targets:t.props.targets}))}}),o7=YO("scalable"),Rxe={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:aK("scalable"),dragControlCondition:o7,viewClassName:XO("scalable"),dragControlStart:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.parentDirection,s=RK(a,n,i,r),o=t.state,c=o.width,h=o.height,d=o.targetTransform,m=o.target,b=o.pos1,x=o.pos2,E=o.pos4;if(!s||!m)return!1;n||Sy(t,e),r.datas={},r.transform=d,r.prevDist=[1,1],r.direction=s,r.startOffsetWidth=c,r.startOffsetHeight=h,r.startValue=[1,1];var T=!s[0]&&!s[1]||s[0]||!s[1];a3(t,e,"scale"),r.isWidth=T;function A(j){r.ratio=j&&isFinite(j)?j:0}r.startPositions=Wh(t.state);function M(j){var H=yK(r.startPositions,j);r.fixedDirection=H.fixedDirection,r.fixedPosition=H.fixedPosition,r.fixedOffset=H.fixedOffset}r.setFixedDirection=M,A(gp(b,x)/gp(x,E)),M([-s[0],-s[1]]);var F=function(j){r.minScaleSize=j},N=function(j){r.maxScaleSize=j};F([-1/0,-1/0]),N([1/0,1/0]);var O=Ki(t,e,Gt(Gt({direction:s,set:function(j){r.startValue=j},setRatio:A,setFixedDirection:M,setMinScaleSize:F,setMaxScaleSize:N},i3(t,e)),{dragStart:pc.dragStart(t,new $0().dragStart([0,0],e))})),U=Gn(t,"onScaleStart",O);return r.startFixedDirection=r.fixedDirection,U!==!1&&(r.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:s}),r.isScale?O:!1},dragControl:function(t,e){r3(t,e,"scale");var r=e.datas,n=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,s=e.dragClient,o=e.isRequest,c=e.useSnap,h=e.resolveMatrix,d=r.prevDist,m=r.direction,b=r.startOffsetWidth,x=r.startOffsetHeight,E=r.isScale,T=r.startValue,A=r.isWidth,M=r.ratio;if(!E)return!1;var F=t.props,N=F.throttleScale,O=F.parentMoveable,U=m;!m[0]&&!m[1]&&(U=[1,1]);var j=M&&(n??F.keepRatio)||!1,H=t.state,G=[T[0],T[1]];function X(){var rt=FK(U,j,r,e),Re=rt.distWidth,zt=rt.distHeight,st=b?(b+Re)/b:1,$e=x?(x+zt)/x:1;T[0]||(G[0]=Re/b),T[1]||(G[1]=zt/x);var Jt=(U[0]||j?st:1)*G[0],Ht=(U[1]||j?$e:1)*G[1];return Jt===0&&(Jt=gc(d[0])*dw),Ht===0&&(Ht=gc(d[1])*dw),[Jt,Ht]}var ae=X();if(!a&&t.props.groupable){var Q=H.snapRenderInfo||{},W=Q.direction;su(W)&&(W[0]||W[1])&&(H.snapRenderInfo={direction:m,request:e.isRequest})}Gn(t,"onBeforeScale",Ki(t,e,{scale:ae,setFixedDirection:function(rt){return r.setFixedDirection(rt),ae=X(),ae},startFixedDirection:r.startFixedDirection,setScale:function(rt){ae=rt}},!0));var oe=[ae[0]/G[0],ae[1]/G[1]],se=s,he=[0,0],_e=gc(oe[0]*oe[1]),Ce=!s&&!i&&a;if(Ce||h?se=BO(t,r.targetAllTransform,[0,0],[0,0],r):s||(se=r.fixedPosition),a||(he=lxe(t,oe,m,!c&&o,r)),j){U[0]&&U[1]&&he[0]&&he[1]&&(Math.abs(he[0]*b)>Math.abs(he[1]*x)?he[1]=0:he[0]=0);var me=!he[0]&&!he[1];if(me&&(A?oe[0]=Fi(oe[0]*G[0],N)/G[0]:oe[1]=Fi(oe[1]*G[1],N)/G[1]),U[0]&&!U[1]||he[0]&&!he[1]||me&&A){oe[0]+=he[0];var xe=b*oe[0]*G[0]/M;oe[1]=gc(_e*oe[0])*nn(xe/x/G[1])}else if(!U[0]&&U[1]||!he[0]&&he[1]||me&&!A){oe[1]+=he[1];var Ae=x*oe[1]*G[1]*M;oe[0]=gc(_e*oe[1])*nn(Ae/b/G[0])}}else oe[0]+=he[0],oe[1]+=he[1],he[0]||(oe[0]=Fi(oe[0]*G[0],N)/G[0]),he[1]||(oe[1]=Fi(oe[1]*G[1],N)/G[1]);oe[0]===0&&(oe[0]=gc(d[0])*dw),oe[1]===0&&(oe[1]=gc(d[1])*dw),ae=fxe(oe,[G[0],G[1]]);var De=[b,x],de=[b*ae[0],x*ae[1]];de=RZ(de,r.minScaleSize,r.maxScaleSize,j?M:!1),ae=QA(2,function(rt){return De[rt]?de[rt]/De[rt]:de[rt]}),oe=QA(2,function(rt){return ae[rt]/G[rt]});var Ee=QA(2,function(rt){return d[rt]?oe[rt]/d[rt]:oe[rt]}),we="scale(".concat(oe.join(", "),")"),Le="scale(".concat(ae.join(", "),")"),Fe=n3(r,Le,we),Xe=!T[0]||!T[1],Be=lbe(t,Xe?Le:we,r.fixedDirection,se,r.fixedOffset,r,Xe),ot=Ce?Be:_i(Be,r.prevInverseDist||[0,0]);if(r.prevDist=oe,r.prevInverseDist=Be,ae[0]===d[0]&&ae[1]===d[1]&&ot.every(function(rt){return!rt})&&!O&&!Ce)return!1;var Qe=Ki(t,e,Gt({offsetWidth:b,offsetHeight:x,direction:m,scale:ae,dist:oe,delta:Ee,isPinch:!!a},QZ(t,Fe,ot,a,e)));return Gn(t,"onScale",Qe),Qe},dragControlEnd:function(t,e){var r=e.datas;if(!r.isScale)return!1;r.isScale=!1;var n=fh(t,e,{});return Gn(t,"onScaleEnd",n),n},dragGroupControlCondition:o7,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,e);if(!n)return!1;var i=Ef(t,"resizable",e);r.moveableScale=t.scale;var a=mp(t,this,"dragControlStart",e,function(h,d){return iE(t,h,r,d)}),s=function(h){n.setFixedDirection(h),a.forEach(function(d,m){d.setFixedDirection(h),iE(t,d.moveable,r,i[m])})};r.setFixedDirection=s;var o=Gt(Gt({},n),{targets:t.props.targets,events:a,setFixedDirection:s}),c=Gn(t,"onScaleGroupStart",o);return r.isScale=c!==!1,r.isScale?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isScale){c3(t,"onBeforeScale",function(d){Gn(t,"onBeforeScaleGroup",Ki(t,e,Gt(Gt({},d),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=n.dist,a=r.moveableScale;t.scale=[i[0]*a[0],i[1]*a[1]];var s=t.props.keepRatio,o=r.fixedPosition,c=mp(t,this,"dragControl",e,function(d,m){var b=Zt(tc(Bx(t.rotation/180*Math.PI,3),[m.datas.originalX*i[0],m.datas.originalY*i[1],1],3),2),x=b[0],E=b[1];return Gt(Gt({},m),{parentDist:null,parentScale:i,parentKeepRatio:s,dragClient:Ma(o,[x,E])})}),h=Gt({targets:t.props.targets,events:c},n);return Gn(t,"onScaleGroup",h),h}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isScale){this.dragControlEnd(t,e);var i=mp(t,this,"dragControlEnd",e),a=fh(t,e,{targets:t.props.targets,events:i});return Gn(t,"onScaleGroupEnd",a),r}},request:function(){var t={},e=0,r=0,n=!1;return{isControl:!0,requestStart:function(i){return n=i.useSnap,{datas:t,parentDirection:i.direction||[1,1],useSnap:n}},request:function(i){return e+=i.deltaWidth,r+=i.deltaHeight,{datas:t,parentDist:[e,r],parentKeepRatio:i.keepRatio,useSnap:n}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:n}}}}};function eg(t,e){return t.map(function(r,n){return eE(r,e[n],1,2)})}function s7(t,e,r){var n=il(t,e),i=il(t,r),a=i-n;return a>=0?a:a+2*Math.PI}function Mxe(t,e){var r=s7(t[0],t[1],t[2]),n=s7(e[0],e[1],e[2]),i=Math.PI;return!(r>=i&&n<=i||r<=i&&n>=i)}var Dxe={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:XO("warpable"),render:function(t,e){var r=t.props,n=r.resizable,i=r.scalable,a=r.warpable,s=r.zoom;if(n||i||!a)return[];var o=t.state,c=o.pos1,h=o.pos2,d=o.pos3,m=o.pos4,b=eg(c,h),x=eg(h,c),E=eg(c,d),T=eg(d,c),A=eg(d,m),M=eg(m,d),F=eg(h,m),N=eg(m,h);return yn([e.createElement("div",{className:yi("line"),key:"middeLine1",style:L1(b,A,s)}),e.createElement("div",{className:yi("line"),key:"middeLine2",style:L1(x,M,s)}),e.createElement("div",{className:yi("line"),key:"middeLine3",style:L1(E,F,s)}),e.createElement("div",{className:yi("line"),key:"middeLine4",style:L1(T,N,s)})],Zt(oK(t,"warpable",e)),!1)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var r=e.inputEvent.target;return Bl(r,yi("direction"))&&Bl(r,yi("warpable"))},dragControlStart:function(t,e){var r=e.datas,n=e.inputEvent,i=t.props.target,a=n.target,s=MK(a,r);if(!s||!i)return!1;var o=t.state,c=o.transformOrigin,h=o.is3d,d=o.targetTransform,m=o.targetMatrix,b=o.width,x=o.height,E=o.left,T=o.top;r.datas={},r.targetTransform=d,r.warpTargetMatrix=h?m:Af(m,3,4),r.targetInverseMatrix=NZ(Ed(r.warpTargetMatrix,4),3,4),r.direction=s,r.left=E,r.top=T,r.poses=[[0,0],[b,0],[0,x],[b,x]].map(function(F){return _i(F,c)}),r.nextPoses=r.poses.map(function(F){var N=Zt(F,2),O=N[0],U=N[1];return tc(r.warpTargetMatrix,[O,U,0,1],4)}),r.startValue=Jo(4),r.prevMatrix=Jo(4),r.absolutePoses=Wh(o),r.posIndexes=JZ(s),Sy(t,e),a3(t,e,"matrix3d"),o.snapRenderInfo={request:e.isRequest,direction:s};var A=Ki(t,e,Gt({set:function(F){r.startValue=F}},i3(t,e))),M=Gn(t,"onWarpStart",A);return M!==!1&&(r.isWarp=!0),r.isWarp},dragControl:function(t,e){var r=e.datas,n=e.isRequest,i=e.distX,a=e.distY,s=r.targetInverseMatrix,o=r.prevMatrix,c=r.isWarp,h=r.startValue,d=r.poses,m=r.posIndexes,b=r.absolutePoses;if(!c)return!1;if(r3(t,e,"matrix3d"),m_(t,"warpable")){var x=m.map(function(X){return b[X]});x.length>1&&x.push([(x[0][0]+x[1][0])/2,(x[0][1]+x[1][1])/2]);var E=l3(t,n,{horizontal:x.map(function(X){return X[1]+a}),vertical:x.map(function(X){return X[0]+i})}),T=E.horizontal,A=E.vertical;a-=T.offset,i-=A.offset}var M=Rd({datas:r,distX:i,distY:a},!0),F=r.nextPoses.slice();if(m.forEach(function(X){F[X]=Ma(F[X],M)}),!K1e.every(function(X){return Mxe(X.map(function(ae){return d[ae]}),X.map(function(ae){return F[ae]}))}))return!1;var N=kO(d[0],d[2],d[1],d[3],F[0],F[2],F[1],F[3]);if(!N.length)return!1;var O=wo(s,N,4),U=ZZ(r,O,!0),j=wo(Ed(o,4),U,4);r.prevMatrix=U;var H=wo(h,U,4),G=n3(r,"matrix3d(".concat(H.join(", "),")"),"matrix3d(".concat(U.join(", "),")"));return FO(e,G),Gn(t,"onWarp",Ki(t,e,Gt({delta:j,matrix:H,dist:U,multiply:wo,transform:G},yc({transform:G},e)))),!0},dragControlEnd:function(t,e){var r=e.datas,n=e.isDrag;return r.isWarp?(r.isWarp=!1,Gn(t,"onWarpEnd",fh(t,e,{})),n):!1}},Oxe=yi("area-pieces"),_w=yi("area-piece"),jK=yi("avoid"),Nxe=yi("view-dragging");function e5(t){var e=t.areaElement;if(e){var r=t.state,n=r.width,i=r.height;DZ(e,jK),e.style.cssText+="left: 0px; top: 0px; width: ".concat(n,"px; height: ").concat(i,"px")}}function l7(t){return t.createElement("div",{key:"area_pieces",className:Oxe},t.createElement("div",{className:_w}),t.createElement("div",{className:_w}),t.createElement("div",{className:_w}),t.createElement("div",{className:_w}))}var UK={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,e){var r=t.props,n=r.target,i=r.dragArea,a=r.groupable,s=r.passDragArea,o=t.getState(),c=o.width,h=o.height,d=o.renderPoses,m=s?yi("area","pass"):yi("area");if(a)return[e.createElement("div",{key:"area",ref:zm(t,"areaElement"),className:m}),l7(e)];if(!n||!i)return[];var b=kO([0,0],[c,0],[0,h],[c,h],d[0],d[1],d[2],d[3]),x=b.length?u3(b,!0):"none";return[e.createElement("div",{key:"area",ref:zm(t,"areaElement"),className:m,style:{top:"0px",left:"0px",width:"".concat(c,"px"),height:"".concat(h,"px"),transformOrigin:"0 0",transform:x}}),l7(e)]},dragStart:function(t,e){var r=e.datas,n=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;r.isDragArea=!1;var s=t.areaElement,o=t.state,c=o.moveableClientRect,h=o.renderPoses,d=o.rootMatrix,m=o.is3d,b=c.left,x=c.top,E=Bh(h),T=E.left,A=E.top,M=E.width,F=E.height,N=m?4:3,O=Zt(W0(d,[n-b,i-x],N),2),U=O[0],j=O[1];U-=T,j-=A;var H=[{left:T,top:A,width:M,height:j-10},{left:T,top:A,width:U-10,height:F},{left:T,top:A+j+10,width:M,height:F-j-10},{left:T+U+10,top:A,width:M-U-10,height:F}],G=[].slice.call(s.nextElementSibling.children);H.forEach(function(X,ae){G[ae].style.cssText="left: ".concat(X.left,"px;top: ").concat(X.top,"px; width: ").concat(X.width,"px; height: ").concat(X.height,"px;")}),MZ(s,jK),o.disableNativeEvent=!0},drag:function(t,e){var r=e.datas,n=e.inputEvent;if(this.enableNativeEvent(t),!n)return!1;r.isDragArea||(r.isDragArea=!0,e5(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var r=e.inputEvent,n=e.datas;if(!r)return!1;n.isDragArea||e5(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){e5(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&kZ(function(){e.disableNativeEvent=!1})}},Lxe=jx("origin",{props:["origin","svgOrigin"],render:function(t,e){var r=t.props,n=r.zoom,i=r.svgOrigin,a=r.groupable,s=t.getState(),o=s.beforeOrigin,c=s.rotation,h=s.svg,d=s.allMatrix,m=s.is3d,b=s.left,x=s.top,E=s.offsetWidth,T=s.offsetHeight,A;if(!a&&h&&i){var M=Zt(KO(i,E,T),2),F=M[0],N=M[1],O=m?4:3,U=bs(d,[F,N],O);A=lE(c,n,_i(U,[b,x]))}else A=lE(c,n,o);return[e.createElement("div",{className:yi("control","origin"),style:A,key:"beforeOrigin"})]}});function Fxe(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var Bxe={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,e){var r=t.props,n=r.scrollContainer,i=n===void 0?t.getContainer():n,a=r.scrollOptions,s=new m1e,o=bd(i,!0);e.datas.dragScroll=s,t.state.dragScroll=s;var c=e.isControl?"controlGesto":"targetGesto",h=e.targets;s.on("scroll",function(d){var m=d.container,b=d.direction,x=Ki(t,e,{scrollContainer:m,direction:b}),E=h?"onScrollGroup":"onScroll";h&&(x.targets=h),Gn(t,E,x)}).on("move",function(d){var m=d.offsetX,b=d.offsetY,x=d.inputEvent;t[c].scrollBy(m,b,x.inputEvent,!1)}).on("scrollDrag",function(d){var m=d.next;m(t[c].getCurrentEvent())}),s.dragStart(e,Gt({container:o},a))},checkScroll:function(t,e){var r=e.datas.dragScroll;if(r){var n=t.props,i=n.scrollContainer,a=i===void 0?t.getContainer():i,s=n.scrollThreshold,o=s===void 0?0:s,c=n.scrollThrottleTime,h=c===void 0?0:c,d=n.getScrollPosition,m=d===void 0?Fxe:d,b=n.scrollOptions;return r.drag(e,Gt({container:a,threshold:o,throttleTime:h,getScrollPosition:function(x){return m({scrollContainer:x.container,direction:x.direction})}},b)),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,Gt(Gt({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,Gt(Gt({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,Gt(Gt({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,Gt(Gt({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,Gt(Gt({},e),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,e){return this.drag(t,Gt(Gt({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,Gt(Gt({},e),{targets:t.props.targets}))},unset:function(t){var e,r=t.state;(e=r.dragScroll)===null||e===void 0||e.dragEnd(),r.dragScroll=null}},VK={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},zxe=jx("padding",{props:["padding"],render:function(t,e){var r=t.props;if(r.dragArea)return[];var n=zK(r.padding||{}),i=n.left,a=n.top,s=n.right,o=n.bottom,c=t.getState(),h=c.renderPoses,d=c.pos1,m=c.pos2,b=c.pos3,x=c.pos4,E=[d,m,b,x],T=[];return i>0&&T.push([0,2]),a>0&&T.push([0,1]),s>0&&T.push([1,3]),o>0&&T.push([2,3]),T.map(function(A,M){var F=Zt(A,2),N=F[0],O=F[1],U=E[N],j=E[O],H=h[N],G=h[O],X=kO([0,0],[100,0],[0,100],[100,100],U,j,H,G);if(X.length)return e.createElement("div",{key:"padding".concat(M),className:yi("padding"),style:{transform:u3(X,!0)}})})}}),u7=["nw","ne","se","sw"];function bw(t,e){var r=t[0]+t[1],n=r>e?e/r:1;return t[0]*=n,t[1]=e-t[1]*n,t}var jxe=[1,2,5,6],Uxe=[0,3,4,7],Tm=[1,-1,-1,1],Cm=[1,1,-1,-1];function JO(t,e,r,n,i,a,s,o){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=r),o===void 0&&(o=n);var c=[],h=!1,d=t.filter(function(b){return!b.virtual}),m=d.map(function(b){var x=b.horizontal,E=b.vertical,T=b.pos;if(E&&!h&&(h=!0,c.push("/")),h){var A=Math.max(0,E===1?T[1]-a:o-T[1]);return c.push(yf(A,n,e)),A}else{var A=Math.max(0,x===1?T[0]-i:s-T[0]);return c.push(yf(A,r,e)),A}});return{radiusPoses:d,styles:c,raws:m}}function $K(t){for(var e=[0,0],r=[0,0],n=t.length,i=0;i<n;++i){var a=t[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,r[0]=i+1),a.vertical&&(r[1]===0&&(r[0]=i),r[1]=i-r[0]+1))}return{horizontalRange:e,verticalRange:r}}function qK(t,e,r,n,i,a,s){var o,c,h,d;a===void 0&&(a=[0,0]),s===void 0&&(s=!1);var m=t.indexOf("/"),b=(m>-1?t.slice(0,m):t).length,x=t.slice(0,b),E=t.slice(b+1),T=x.length,A=E.length,M=A>0,F=Zt(x,4),N=F[0],O=N===void 0?"0px":N,U=F[1],j=U===void 0?O:U,H=F[2],G=H===void 0?O:H,X=F[3],ae=X===void 0?j:X,Q=Zt(E,4),W=Q[0],oe=W===void 0?O:W,se=Q[1],he=se===void 0?M?oe:j:se,_e=Q[2],Ce=_e===void 0?M?oe:G:_e,me=Q[3],xe=me===void 0?M?he:ae:me,Ae=[O,j,G,ae].map(function(Fe){return xo(Fe,e)}),De=[oe,he,Ce,xe].map(function(Fe){return xo(Fe,r)}),de=Ae.slice(),Ee=De.slice();o=Zt(bw([de[0],de[1]],e),2),de[0]=o[0],de[1]=o[1],c=Zt(bw([de[3],de[2]],e),2),de[3]=c[0],de[2]=c[1],h=Zt(bw([Ee[0],Ee[3]],r),2),Ee[0]=h[0],Ee[3]=h[1],d=Zt(bw([Ee[1],Ee[2]],r),2),Ee[1]=d[0],Ee[2]=d[1];var we=s?de:de.slice(0,Math.max(a[0],T)),Le=s?Ee:Ee.slice(0,Math.max(a[1],A));return yn(yn([],Zt(we.map(function(Fe,Xe){var Be=u7[Xe];return{virtual:Xe>=T,horizontal:Tm[Xe],vertical:0,pos:[n+Fe,i+(Cm[Xe]===-1?r:0)],sub:!0,raw:Ae[Xe],direction:Be}})),!1),Zt(Le.map(function(Fe,Xe){var Be=u7[Xe];return{virtual:Xe>=A,horizontal:0,vertical:Cm[Xe],pos:[n+(Tm[Xe]===-1?e:0),i+Fe],sub:!0,raw:De[Xe],direction:Be}})),!1)}function Vxe(t,e,r,n,i){i===void 0&&(i=e.length);var a=$K(t.slice(n)),s=a.horizontalRange,o=a.verticalRange,c=r-n,h=0;if(c===0)h=i;else if(c>0&&c<s[1])h=s[1]-c;else if(c>=o[0])h=o[0]+o[1]-c;else return;t.splice(r,h),e.splice(r,h)}function $xe(t,e,r,n,i,a,s,o,c,h,d){h===void 0&&(h=0),d===void 0&&(d=0);var m=$K(t.slice(r)),b=m.horizontalRange,x=m.verticalRange;if(n>-1)for(var E=Tm[n]===1?a-h:o-a,T=b[1];T<=n;++T){var A=Cm[T]===1?d:c,M=0;if(n===T?M=a:T===0?M=h+E:Tm[T]===-1&&(M=o-(e[r][0]-h)),t.splice(r+T,0,{horizontal:Tm[T],vertical:0,pos:[M,A]}),e.splice(r+T,0,[M,A]),T===0)break}else if(i>-1){var F=Cm[i]===1?s-d:c-s;if(b[1]===0&&x[1]===0){var N=[h+F,d];t.push({horizontal:Tm[0],vertical:0,pos:N}),e.push(N)}for(var O=x[0],T=x[1];T<=i;++T){var M=Tm[T]===1?h:o,A=0;if(i===T?A=s:T===0?A=d+F:Cm[T]===1?A=e[r+O][1]:Cm[T]===-1&&(A=c-(e[r+O][1]-d)),t.push({horizontal:0,vertical:Cm[T],pos:[M,A]}),e.push([M,A]),T===0)break}}}function qxe(t,e){e===void 0&&(e=t.map(function(i){return i.raw}));var r=t.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),n=t.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:r,verticals:n}}var Hxe=[[0,-1,"n"],[1,0,"e"]],Wxe=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function QO(t,e,r){var n=t.props.clipRelative,i=t.state,a=i.width,s=i.height,o=e,c=o.type,h=o.poses,d=c==="rect",m=c==="circle";if(c==="polygon")return r.map(function(j){return"".concat(yf(j[0],a,n)," ").concat(yf(j[1],s,n))});if(d||c==="inset"){var b=r[1][1],x=r[3][0],E=r[7][0],T=r[5][1];if(d)return[b,x,T,E].map(function(j){return"".concat(j,"px")});var A=[b,a-x,s-T,E].map(function(j,H){return yf(j,H%2?a:s,n)});if(r.length>8){var M=Zt(_i(r[4],r[0]),2),F=M[0],N=M[1];A.push.apply(A,yn(["round"],Zt(JO(h.slice(8).map(function(j,H){return Gt(Gt({},j),{pos:r[H]})}),n,F,N,E,b,x,T).styles),!1))}return A}else if(m||c==="ellipse"){var O=r[0],U=yf(nn(r[1][1]-O[1]),m?Math.sqrt((a*a+s*s)/2):s,n),A=m?[U]:[yf(nn(r[2][0]-O[0]),a,n),U];return A.push("at",yf(O[0],a,n),yf(O[1],s,n)),A}}function cE(t,e,r,n){var i=[n,(n+e)/2,e],a=[t,(t+r)/2,r];return Wxe.map(function(s){var o=Zt(s,3),c=o[0],h=o[1],d=o[2],m=i[c+1],b=a[h+1];return{vertical:nn(h),horizontal:nn(c),direction:d,pos:[m,b]}})}function HK(t){var e=[1/0,-1/0],r=[1/0,-1/0];return t.forEach(function(n){var i=n.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),r[0]=Math.min(r[0],i[1]),r[1]=Math.max(r[1],i[1])}),[nn(e[1]-e[0]),nn(r[1]-r[0])]}function c7(t,e,r,n,i){var a,s,o,c,h,d,m,b,x;if(t){var E=i;if(!E){var T=Nc(t),A=T("clipPath");E=A!=="none"?A:T("clip")}if(!((!E||E==="none"||E==="auto")&&(E=n,!E))){var M=PZ(E),F=M.prefix,N=F===void 0?E:F,O=M.value,U=O===void 0?"":O,j=N==="circle",H=" ";if(N==="polygon"){var G=km(U||"0% 0%, 100% 0%, 100% 100%, 0% 100%");H=",";var X=G.map(function(br){var lr=Zt(br.split(" "),2),Cr=lr[0],Tr=lr[1];return{vertical:1,horizontal:1,pos:[xo(Cr,e),xo(Tr,r)]}}),ae=ty(X.map(function(br){return br.pos}));return{type:N,clipText:E,poses:X,splitter:H,left:ae.minX,right:ae.maxX,top:ae.minY,bottom:ae.maxY}}else if(j||N==="ellipse"){var Q="",W="",oe=0,se=0,G=Cg(U);if(j){var he="";a=Zt(G,4),s=a[0],he=s===void 0?"50%":s,o=a[2],Q=o===void 0?"50%":o,c=a[3],W=c===void 0?"50%":c,oe=xo(he,Math.sqrt((e*e+r*r)/2)),se=oe}else{var _e="",Ce="";h=Zt(G,5),d=h[0],_e=d===void 0?"50%":d,m=h[1],Ce=m===void 0?"50%":m,b=h[3],Q=b===void 0?"50%":b,x=h[4],W=x===void 0?"50%":x,oe=xo(_e,e),se=xo(Ce,r)}var me=[xo(Q,e),xo(W,r)],X=yn([{vertical:1,horizontal:1,pos:me,direction:"nesw"}],Zt(Hxe.slice(0,j?1:2).map(function(Cr){return{vertical:nn(Cr[1]),horizontal:Cr[0],direction:Cr[2],sub:!0,pos:[me[0]+Cr[0]*oe,me[1]+Cr[1]*se]}})),!1);return{type:N,clipText:E,radiusX:oe,radiusY:se,left:me[0]-oe,top:me[1]-se,right:me[0]+oe,bottom:me[1]+se,poses:X,splitter:H}}else if(N==="inset"){var G=Cg(U||"0 0 0 0"),xe=G.indexOf("round"),Ae=(xe>-1?G.slice(0,xe):G).length,De=G.slice(Ae+1),de=Zt(G.slice(0,Ae),4),Ee=de[0],we=de[1],Le=we===void 0?Ee:we,Fe=de[2],Xe=Fe===void 0?Ee:Fe,Be=de[3],ot=Be===void 0?Le:Be,Qe=Zt([Ee,Xe].map(function(Cr){return xo(Cr,r)}),2),rt=Qe[0],Re=Qe[1],zt=Zt([ot,Le].map(function(Cr){return xo(Cr,e)}),2),st=zt[0],$e=zt[1],Jt=e-$e,Ht=r-Re,pr=qK(De,Jt-st,Ht-rt,st,rt),X=yn(yn([],Zt(cE(rt,Jt,Ht,st)),!1),Zt(pr),!1);return{type:"inset",clipText:E,poses:X,top:rt,left:st,right:Jt,bottom:Ht,radius:De,splitter:H}}else if(N==="rect"){var G=km(U||"0px, ".concat(e,"px, ").concat(r,"px, 0px"));H=",";var _t=Zt(G.map(function(at){var ke=Lx(at).value;return ke}),4),vr=_t[0],$e=_t[1],Re=_t[2],st=_t[3],X=cE(vr,$e,Re,st);return{type:"rect",clipText:E,poses:X,top:vr,right:$e,bottom:Re,left:st,values:G,splitter:H}}}}}function Gxe(t,e,r,n,i){var a=t[e],s=a.direction,o=a.sub,c=t.map(function(){return[0,0]}),h=s?s.split(""):[];if(n&&e<8){var d=h.filter(function(oe){return oe==="w"||oe==="e"}),m=h.filter(function(oe){return oe==="n"||oe==="s"}),b=d[0],x=m[0];c[e]=r;var E=Zt(HK(t),2),T=E[0],A=E[1],M=T&&A?T/A:0;if(M&&i){var F=(e+4)%8,N=t[F].pos,O=[0,0];s.indexOf("w")>-1?O[0]=-1:s.indexOf("e")>-1&&(O[0]=1),s.indexOf("n")>-1?O[1]=-1:s.indexOf("s")>-1&&(O[1]=1);var U=LK([T,A],r,M,O,!0),j=T+U[0],H=A+U[1],G=N[1],X=N[1],ae=N[0],Q=N[0];O[0]===-1?ae=Q-j:O[0]===1?Q=ae+j:(ae=ae-j/2,Q=Q+j/2),O[1]===-1?G=X-H:(O[1]===1||(G=X-H/2),X=G+H);var W=cE(G,Q,X,ae);t.forEach(function(oe,se){c[se][0]=W[se].pos[0]-oe.pos[0],c[se][1]=W[se].pos[1]-oe.pos[1]})}else t.forEach(function(oe,se){var he=oe.direction;he&&(he.indexOf(b)>-1&&(c[se][0]=r[0]),he.indexOf(x)>-1&&(c[se][1]=r[1]))}),b&&(c[1][0]=r[0]/2,c[5][0]=r[0]/2),x&&(c[3][1]=r[1]/2,c[7][1]=r[1]/2)}else s&&!o?h.forEach(function(oe){var se=oe==="n"||oe==="s";t.forEach(function(he,_e){var Ce=he.direction,me=he.horizontal,xe=he.vertical;!Ce||Ce.indexOf(oe)===-1||(c[_e]=[se||!me?0:r[0],!se||!xe?0:r[1]])})}):c[e]=r;return c}function Xxe(t,e){var r=Zt(YZ(t,e),2),n=r[0],i=r[1],a=e.datas,s=a.clipPath,o=a.clipIndex,c=s,h=c.type,d=c.poses,m=c.splitter,b=d.map(function(F){return F.pos});if(h==="polygon")b.splice(o,0,[n,i]);else if(h==="inset"){var x=jxe.indexOf(o),E=Uxe.indexOf(o),T=d.length;if($xe(d,b,8,x,E,n,i,b[4][0],b[4][1],b[0][0],b[0][1]),T===d.length)return}else return;var A=QO(t,s,b),M="".concat(h,"(").concat(A.join(m),")");Gn(t,"onClip",Ki(t,e,Gt({clipEventType:"added",clipType:h,poses:b,clipStyles:A,clipStyle:M,distX:0,distY:0},yc({clipPath:M},e))))}function Yxe(t,e){var r=e.datas,n=r.clipPath,i=r.clipIndex,a=n,s=a.type,o=a.poses,c=a.splitter,h=o.map(function(x){return x.pos}),d=h.length;if(s==="polygon")o.splice(i,1),h.splice(i,1);else if(s==="inset"){if(i<8||(Vxe(o,h,i,8,d),d===o.length))return}else return;var m=QO(t,n,h),b="".concat(s,"(").concat(m.join(c),")");Gn(t,"onClip",Ki(t,e,Gt({clipEventType:"removed",clipType:s,poses:h,clipStyles:m,clipStyle:b,distX:0,distY:0},yc({clipPath:b},e))))}var Zxe={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(t,e){var r=t.props,n=r.customClipPath,i=r.defaultClipPath,a=r.clipArea,s=r.zoom,o=r.groupable,c=t.getState(),h=c.target,d=c.width,m=c.height,b=c.allMatrix,x=c.is3d,E=c.left,T=c.top,A=c.pos1,M=c.pos2,F=c.pos3,N=c.pos4,O=c.clipPathState,U=c.snapBoundInfos,j=c.rotation;if(!h||o)return[];var H=c7(h,d,m,i||"inset",O||n);if(!H)return[];var G=x?4:3,X=H.type,ae=H.poses,Q=ae.map(function($e){var Jt=bs(b,$e.pos,G);return[Jt[0]-E,Jt[1]-T]}),W=[],oe=[],se=X==="rect",he=X==="inset",_e=X==="polygon";if(se||he||_e){var Ce=he?Q.slice(0,8):Q;oe=Ce.map(function($e,Jt){var Ht=Jt===0?Ce[Ce.length-1]:Ce[Jt-1],pr=il(Ht,$e),_t=AK(Ht,$e);return e.createElement("div",{key:"clipLine".concat(Jt),className:yi("line","clip-line","snap-control"),"data-clip-index":Jt,style:{width:"".concat(_t,"px"),transform:"translate(".concat(Ht[0],"px, ").concat(Ht[1],"px) rotate(").concat(pr,"rad) scaleY(").concat(s,")")}})})}if(W=Q.map(function($e,Jt){return e.createElement("div",{key:"clipControl".concat(Jt),className:yi("control","clip-control","snap-control"),"data-clip-index":Jt,style:{transform:"translate(".concat($e[0],"px, ").concat($e[1],"px) rotate(").concat(j,"rad) scale(").concat(s,")")}})}),he&&W.push.apply(W,yn([],Zt(Q.slice(8).map(function($e,Jt){return e.createElement("div",{key:"clipRadiusControl".concat(Jt),className:yi("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Jt,style:{transform:"translate(".concat($e[0],"px, ").concat($e[1],"px) rotate(").concat(j,"rad) scale(").concat(s,")")}})})),!1)),X==="circle"||X==="ellipse"){var me=H.left,xe=H.top,Ae=H.radiusX,De=H.radiusY,de=Zt(_i(bs(b,[me,xe],G),bs(b,[0,0],G)),2),Ee=de[0],we=de[1],Le="none";if(!a){for(var Fe=Math.max(10,Ae/5,De/5),Xe=[],Be=0;Be<=Fe;++Be){var ot=Math.PI*2/Fe*Be;Xe.push([Ae+(Ae-s)*Math.cos(ot),De+(De-s)*Math.sin(ot)])}Xe.push([Ae,-2]),Xe.push([-2,-2]),Xe.push([-2,De*2+2]),Xe.push([Ae*2+2,De*2+2]),Xe.push([Ae*2+2,-2]),Xe.push([Ae,-2]),Le="polygon(".concat(Xe.map(function($e){return"".concat($e[0],"px ").concat($e[1],"px")}).join(", "),")")}W.push(e.createElement("div",{key:"clipEllipse",className:yi("clip-ellipse","snap-control"),style:{width:"".concat(Ae*2,"px"),height:"".concat(De*2,"px"),clipPath:Le,transform:"translate(".concat(-E+Ee,"px, ").concat(-T+we,"px) ").concat(u3(b))}}))}if(a){var Qe=Bh(yn([A,M,F,N],Zt(Q),!1)),rt=Qe.width,Re=Qe.height,zt=Qe.left,st=Qe.top;if(_e||se||he){var Xe=he?Q.slice(0,8):Q;W.push(e.createElement("div",{key:"clipArea",className:yi("clip-area","snap-control"),style:{width:"".concat(rt,"px"),height:"".concat(Re,"px"),transform:"translate(".concat(zt,"px, ").concat(st,"px)"),clipPath:"polygon(".concat(Xe.map(function(Jt){return"".concat(Jt[0]-zt,"px ").concat(Jt[1]-st,"px")}).join(", "),")")}}))}}return U&&["vertical","horizontal"].forEach(function($e){var Jt=U[$e],Ht=$e==="horizontal";Jt.isSnap&&oe.push.apply(oe,yn([],Zt(Jt.snap.posInfos.map(function(pr,_t){var vr=pr.pos,br=_i(bs(b,Ht?[0,vr]:[vr,0],G),[E,T]),lr=_i(bs(b,Ht?[d,vr]:[vr,m],G),[E,T]);return Wb(e,"",br,lr,s,"clip".concat($e,"snap").concat(_t),"guideline")})),!1)),Jt.isBound&&oe.push.apply(oe,yn([],Zt(Jt.bounds.map(function(pr,_t){var vr=pr.pos,br=_i(bs(b,Ht?[0,vr]:[vr,0],G),[E,T]),lr=_i(bs(b,Ht?[d,vr]:[vr,m],G),[E,T]);return Wb(e,"",br,lr,s,"clip".concat($e,"bounds").concat(_t),"guideline","bounds","bold")})),!1))}),yn(yn([],Zt(W),!1),Zt(oe),!1)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var r=t.props,n=r.dragWithClip,i=n===void 0?!0:n;return i?!1:this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,Gt(Gt({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var r=t.state,n=t.props,i=n.defaultClipPath,a=n.customClipPath,s=r.target,o=r.width,c=r.height,h=e.inputEvent?e.inputEvent.target:null,d=h&&h.getAttribute("class")||"",m=e.datas,b=c7(s,o,c,i||"inset",a);if(!b)return!1;var x=b.clipText,E=b.type,T=b.poses,A=Gn(t,"onClipStart",Ki(t,e,{clipType:E,clipStyle:x,poses:T.map(function(M){return M.pos})}));return A===!1?(m.isClipStart=!1,!1):(m.isControl=d&&d.indexOf("clip-control")>-1,m.isLine=d.indexOf("clip-line")>-1,m.isArea=d.indexOf("clip-area")>-1||d.indexOf("clip-ellipse")>-1,m.clipIndex=h?parseInt(h.getAttribute("data-clip-index"),10):-1,m.clipPath=b,m.isClipStart=!0,r.clipPathState=x,Sy(t,e),!0)},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.originalDatas,o=e.isDragTarget;if(!a.isClipStart)return!1;var c=a,h=c.isControl,d=c.isLine,m=c.isArea,b=c.clipIndex,x=c.clipPath;if(!x)return!1;var E=ry(t.props,"clippable"),T=E.keepRatio,A=0,M=0,F=s.draggable,N=Rd(e);o&&F?(r=Zt(F.prevBeforeDist,2),A=r[0],M=r[1]):(n=Zt(N,2),A=n[0],M=n[1]);var O=[A,M],U=t.state,j=U.width,H=U.height,G=!m&&!h&&!d,X=x.type,ae=x.poses,Q=x.splitter,W=ae.map(function($r){return $r.pos});G&&(A=-A,M=-M);var oe=!h||ae[b].direction==="nesw",se=X==="inset"||X==="rect",he=ae.map(function(){return[0,0]});if(h&&!oe){var _e=ae[b],Ce=_e.horizontal,me=_e.vertical,xe=[A*nn(Ce),M*nn(me)];he=Gxe(ae,b,xe,se,T)}else oe&&(he=W.map(function(){return[A,M]}));var Ae=W.map(function($r,hn){return Ma($r,he[hn])}),De=yn([],Zt(Ae),!1);U.snapBoundInfos=null;var de=x.type==="circle",Ee=x.type==="ellipse";if(de||Ee){var we=Bh(Ae),Le=nn(we.bottom-we.top),Fe=nn(Ee?we.right-we.left:Le),Xe=Ae[0][1]+Le,Be=Ae[0][0]-Fe,ot=Ae[0][0]+Fe;de&&(De.push([ot,we.bottom]),he.push([1,0])),De.push([we.left,Xe]),he.push([0,1]),De.push([Be,we.bottom]),he.push([1,0])}var Qe=xK((E.clipHorizontalGuidelines||[]).map(function($r){return xo("".concat($r),H)}),(E.clipVerticalGuidelines||[]).map(function($r){return xo("".concat($r),j)}),j,H),rt=[],Re=[];if(de||Ee)rt=[De[4][0],De[2][0]],Re=[De[1][1],De[3][1]];else if(se){var zt=[De[0],De[2],De[4],De[6]],st=[he[0],he[2],he[4],he[6]];rt=zt.filter(function($r,hn){return st[hn][0]}).map(function($r){return $r[0]}),Re=zt.filter(function($r,hn){return st[hn][1]}).map(function($r){return $r[1]})}else rt=De.filter(function($r,hn){return he[hn][0]}).map(function($r){return $r[0]}),Re=De.filter(function($r,hn){return he[hn][1]}).map(function($r){return $r[1]});var $e=[0,0],Jt=X9(Qe,E.clipTargetBounds&&{left:0,top:0,right:j,bottom:H},rt,Re,5,5),Ht=Jt.horizontal,pr=Jt.vertical,_t=Ht.offset,vr=pr.offset;if(Ht.isBound&&($e[1]+=_t),pr.isBound&&($e[0]+=vr),(Ee||de)&&he[0][0]===0&&he[0][1]===0){var we=Bh(Ae),br=we.bottom-we.top,lr=Ee?we.right-we.left:br,Cr=pr.isBound?nn(vr):pr.snapIndex===0?-vr:vr,Tr=Ht.isBound?nn(_t):Ht.snapIndex===0?-_t:_t;lr-=Cr,br-=Tr,de&&(br=dK(pr,Ht)>0?br:lr,lr=br);var Qt=De[0];De[1][1]=Qt[1]-br,De[2][0]=Qt[0]+lr,De[3][1]=Qt[1]+br,De[4][0]=Qt[0]-lr}else if(se&&T&&h){var at=Zt(HK(ae),2),ke=at[0],be=at[1],je=ke&&be?ke/be:0,qe=ae[b],We=qe.direction||"",Lt=De[1][1],Xe=De[5][1],Be=De[7][0],ot=De[3][0];nn(_t)<=nn(vr)?_t=gc(_t)*nn(vr)/je:vr=gc(vr)*nn(_t)*je,We.indexOf("w")>-1?Be-=vr:We.indexOf("e")>-1?ot-=vr:(Be+=vr/2,ot-=vr/2),We.indexOf("n")>-1?Lt-=_t:We.indexOf("s")>-1?Xe-=_t:(Lt+=_t/2,Xe-=_t/2);var Et=cE(Lt,ot,Xe,Be);De.forEach(function(Mt,en){var jn;jn=Zt(Et[en].pos,2),Mt[0]=jn[0],Mt[1]=jn[1]})}else De.forEach(function($r,hn){var zr=he[hn];zr[0]&&($r[0]-=vr),zr[1]&&($r[1]-=_t)});var mt=QO(t,x,Ae),ct="".concat(X,"(").concat(mt.join(Q),")");if(U.clipPathState=ct,de||Ee)rt=[De[4][0],De[2][0]],Re=[De[1][1],De[3][1]];else if(se){var zt=[De[0],De[2],De[4],De[6]];rt=zt.map(function(hn){return hn[0]}),Re=zt.map(function(hn){return hn[1]})}else rt=De.map(function($r){return $r[0]}),Re=De.map(function($r){return $r[1]});if(U.snapBoundInfos=X9(Qe,E.clipTargetBounds&&{left:0,top:0,right:j,bottom:H},rt,Re,1,1),F){var Kt=U.is3d,qt=U.allMatrix,Ir=Kt?4:3,Ar=$e;o&&(Ar=[O[0]+$e[0]-N[0],O[1]+$e[1]-N[1]]),F.deltaOffset=wo(qt,[Ar[0],Ar[1],0,0],Ir)}return Gn(t,"onClip",Ki(t,e,Gt({clipEventType:"changed",clipType:X,poses:Ae,clipStyle:ct,clipStyles:mt,distX:A,distY:M},yc((i={},i[X==="rect"?"clip":"clipPath"]=ct,i),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var r=e.isDrag,n=e.datas,i=e.isDouble,a=n.isLine,s=n.isClipStart,o=n.isControl;return s?(Gn(t,"onClipEnd",fh(t,e,{})),i&&(o?Yxe(t,e):a&&Xxe(t,e)),i||r):!1},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},Kxe={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(t,e){return e.isRequest?e.requestAble==="originDraggable":Bl(e.inputEvent.target,yi("origin"))},dragControlStart:function(t,e){var r=e.datas;Sy(t,e);var n=Ki(t,e,{dragStart:pc.dragStart(t,new $0().dragStart([0,0],e))}),i=Gn(t,"onDragOriginStart",n);return r.startOrigin=t.state.transformOrigin,r.startTargetOrigin=t.state.targetOrigin,r.prevOrigin=[0,0],r.isDragOrigin=!0,i===!1?(r.isDragOrigin=!1,!1):n},dragControl:function(t,e){var r=e.datas,n=e.isPinch,i=e.isRequest;if(!r.isDragOrigin)return!1;var a=Zt(Rd(e),2),s=a[0],o=a[1],c=t.state,h=c.width,d=c.height,m=c.offsetMatrix,b=c.targetMatrix,x=c.is3d,E=t.props.originRelative,T=E===void 0?!0:E,A=x?4:3,M=[s,o];if(i){var F=e.distOrigin;(F[0]||F[1])&&(M=F)}var N=Ma(r.startOrigin,M),O=Ma(r.startTargetOrigin,M),U=_i(M,r.prevOrigin),j=Vx(m,b,N,A),H=t.getRect(),G=Bh(Ey(j,h,d,A)),X=[H.left-G.left,H.top-G.top];r.prevOrigin=M;var ae=[yf(O[0],h,T),yf(O[1],d,T)].join(" "),Q=pc.drag(t,Ux(e,t.state,X,!!n)),W=Ki(t,e,Gt(Gt({width:h,height:d,origin:N,dist:M,delta:U,transformOrigin:ae,drag:Q},yc({transformOrigin:ae,transform:Q.transform},e)),{afterTransform:Q.transform}));return Gn(t,"onDragOrigin",W),W},dragControlEnd:function(t,e){var r=e.datas;return r.isDragOrigin?(Gn(t,"onDragOriginEnd",fh(t,e,{})),!0):!1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);return!!r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);return r?(t.transformOrigin=r.transformOrigin,!0):!1},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=r.transformOrigin,s=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(o){return"deltaOrigin"in o?(s[0]+=o.deltaOrigin[0],s[1]+=o.deltaOrigin[1]):"origin"in o?(s[0]=o.origin[0]-a[0],s[1]=o.origin[1]-a[1]):("x"in o?n=o.x-r.left:"deltaX"in o&&(n+=o.deltaX),"y"in o?i=o.y-r.top:"deltaY"in o&&(i+=o.deltaY)),{datas:e,distX:n,distY:i,distOrigin:s}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function Jxe(t,e,r,n){var i=t.filter(function(c){var h=c.virtual,d=c.horizontal;return d&&!h}).length,a=t.filter(function(c){var h=c.virtual,d=c.vertical;return d&&!h}).length,s=-1;if(e===0&&(i===0?s=0:i===1&&(s=1)),e===2&&(i<=2?s=2:i<=3&&(s=3)),e===3&&(a===0?s=4:a<4&&(s=7)),e===1&&(a<=1?s=5:a<=2&&(s=6)),!(s===-1||!t[s].virtual)){var o=t[s];Qxe(t,s),s<4?o.pos[0]=r:o.pos[1]=n}}function Qxe(t,e){e<4?t.slice(0,e+1).forEach(function(r){r.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(function(r){r.virtual=!1}))}function e2e(t,e){e<4?t.slice(e,4).forEach(function(r){r.virtual=!0}):t.slice(e).forEach(function(r){r.virtual=!0})}function h7(t,e,r,n,i){n===void 0&&(n=[0,0]);var a=[];return!t||t==="0px"?a=[]:a=Cg(t),qK(a,e,r,0,0,n,i)}function f7(t,e,r,n,i){var a=t.state,s=a.width,o=a.height,c=JO(i,t.props.roundRelative,s,o),h=c.raws,d=c.styles,m=c.radiusPoses,b=qxe(m,h),x=b.horizontals,E=b.verticals,T=d.join(" ");a.borderRadiusState=T;var A=Ki(t,e,Gt({horizontals:x,verticals:E,borderRadius:T,width:s,height:o,delta:n,dist:r},yc({borderRadius:T},e)));return Gn(t,"onRound",A),A}function d7(t){var e,r,n=t.getState().style,i=n.borderRadius||"";if(!i&&t.props.groupable){var a=t.moveables[0],s=t.getTargets()[0];s&&(a?.props.target===s?(i=(r=(e=t.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&r!==void 0?r:"",n.borderRadius=i):(i=GO(s).borderRadius,n.borderRadius=i))}return i}var t2e={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(t){var e=t.props.roundClickable;return e===!0||e==="line"?yi("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,e){var r=t.getState(),n=r.target,i=r.width,a=r.height,s=r.allMatrix,o=r.is3d,c=r.left,h=r.top,d=r.borderRadiusState,m=t.props,b=m.minRoundControls,x=b===void 0?[0,0]:b,E=m.maxRoundControls,T=E===void 0?[4,4]:E,A=m.zoom,M=m.roundPadding,F=M===void 0?0:M,N=m.isDisplayShadowRoundControls,O=m.groupable;if(!n)return null;var U=d||d7(t),j=o?4:3,H=h7(U,i,a,x,!0);if(!H)return null;var G=0,X=0,ae=O?[0,0]:[c,h];return H.map(function(Q,W){var oe=Q.horizontal,se=Q.vertical,he=Q.direction||"",_e=yn([],Zt(Q.pos),!1);X+=Math.abs(oe),G+=Math.abs(se),oe&&he.indexOf("n")>-1&&(_e[1]-=F),se&&he.indexOf("w")>-1&&(_e[0]-=F),oe&&he.indexOf("s")>-1&&(_e[1]+=F),se&&he.indexOf("e")>-1&&(_e[0]+=F);var Ce=_i(bs(s,_e,j),ae),me=N&&N!=="horizontal",xe=Q.vertical?G<=T[1]&&(me||!Q.virtual):X<=T[0]&&(N||!Q.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(W),className:yi("control","border-radius",Q.vertical?"vertical":"",Q.virtual?"virtual":""),"data-radius-index":W,style:{display:xe?"block":"none",transform:"translate(".concat(Ce[0],"px, ").concat(Ce[1],"px) scale(").concat(A,")")}})})},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var r=e.inputEvent.target.getAttribute("class")||"";return r.indexOf("border-radius")>-1||r.indexOf("moveable-line")>-1&&r.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var r=e.inputEvent,n=e.datas,i=r.target,a=i.getAttribute("class")||"",s=a.indexOf("border-radius")>-1,o=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,c=s?parseInt(i.getAttribute("data-radius-index"),10):-1,h=-1;if(o){var d=i.getAttribute("data-line-key")||"";d&&(h=parseInt(d.replace(/render-line-/g,""),10),isNaN(h)&&(h=-1))}if(!s&&!o)return!1;var m=Ki(t,e,{}),b=Gn(t,"onRoundStart",m);if(b===!1)return!1;n.lineIndex=h,n.controlIndex=c,n.isControl=s,n.isLine=o,Sy(t,e);var x=t.props,E=x.roundRelative,T=x.minRoundControls,A=T===void 0?[0,0]:T,M=t.state,F=M.width,N=M.height;n.isRound=!0,n.prevDist=[0,0];var O=d7(t),U=h7(O||"",F,N,A,!0)||[];return n.controlPoses=U,M.borderRadiusState=JO(U,E,F,N).styles.join(" "),m},dragControl:function(t,e){var r=e.datas,n=r.controlPoses;if(!r.isRound||!r.isControl||!n.length)return!1;var i=r.controlIndex,a=Zt(Rd(e),2),s=a[0],o=a[1],c=[s,o],h=_i(c,r.prevDist),d=t.props.maxRoundControls,m=d===void 0?[4,4]:d,b=t.state,x=b.width,E=b.height,T=n[i],A=T.vertical,M=T.horizontal,F=n.map(function(O){var U=O.horizontal,j=O.vertical,H=[U*M*c[0],j*A*c[1]];if(U){if(m[0]===1)return H;if(m[0]<4&&U!==M)return H}else{if(m[1]===0)return H[1]=j*M*c[0]/x*E,H;if(A){if(m[1]===1)return H;if(m[1]<4&&j!==A)return H}}return[0,0]});F[i]=c;var N=n.map(function(O,U){return Gt(Gt({},O),{pos:Ma(O.pos,F[U])})});return i<4?N.slice(0,i+1).forEach(function(O){O.virtual=!1}):N.slice(4,i+1).forEach(function(O){O.virtual=!1}),r.prevDist=[s,o],f7(t,e,c,h,N)},dragControlEnd:function(t,e){var r=t.state;r.borderRadiusState="";var n=e.datas,i=e.isDouble;if(!n.isRound)return!1;var a=n.isControl,s=n.controlIndex,o=n.isLine,c=n.lineIndex,h=n.controlPoses,d=h.filter(function(M){var F=M.virtual;return F}).length,m=t.props.roundClickable,b=m===void 0?!0:m;if(i&&b){if(a&&(b===!0||b==="control"))e2e(h,s);else if(o&&(b===!0||b==="line")){var x=Zt(YZ(t,e),2),E=x[0],T=x[1];Jxe(h,c,E,T)}d!==h.filter(function(M){var F=M.virtual;return F}).length&&f7(t,e,[0,0],[0,0],h)}var A=fh(t,e,{});return Gn(t,"onRoundEnd",A),r.borderRadiusState="",A},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=Ef(t,"roundable",e),s=Gt({targets:t.props.targets,events:a.map(function(o,c){return Gt(Gt({},o),{target:i[c],moveable:n[c],currentTarget:n[c]})})},r);return Gn(t,"onRoundGroupStart",s),r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=Ef(t,"roundable",e),s=Gt({targets:t.props.targets,events:a.map(function(o,c){return Gt(Gt(Gt({},o),{target:i[c],moveable:n[c],currentTarget:n[c]}),yc({borderRadius:r.borderRadius},o))})},r);return Gn(t,"onRoundGroup",s),s},dragGroupControlEnd:function(t,e){var r=t.moveables,n=t.props.targets,i=Ef(t,"roundable",e);c3(t,"onRound",function(o){var c=Gt({targets:t.props.targets,events:i.map(function(h,d){return Gt(Gt(Gt({},h),{target:n[d],moveable:r[d],currentTarget:r[d]}),yc({borderRadius:o.borderRadius},h))})},o);Gn(t,"onRoundGroup",c)});var a=this.dragControlEnd(t,e);if(!a)return!1;var s=Gt({targets:t.props.targets,events:i.map(function(o,c){var h;return Gt(Gt({},o),{target:n[c],moveable:r[c],currentTarget:r[c],lastEvent:(h=o.datas)===null||h===void 0?void 0:h.lastEvent})})},a);return Gn(t,"onRoundGroupEnd",s),s},unset:function(t){t.state.borderRadiusState=""}};function r2e(t,e){var r=e?4:3,n=Jo(r),i="matrix".concat(e?"3d":"","(").concat(n.join(","),")");return t===i||t==="matrix(1,0,0,1,0,0)"}var WK={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,e){var r=t.state,n=r.is3d,i=r.targetMatrix,a=r.inlineTransform,s=n?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(FZ(i,!0),")"),o=!a||a==="none"?s:a;e.datas.startTransforms=r2e(o,n)?[]:Cg(o)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return Ki(t,e,{setTransform:function(r){e.datas.startTransforms=su(r)?r:Cg(r)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return Ki(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),Gn(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),Gn(t,"onBeforeRender",Ki(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),Gn(t,"onBeforeRenderEnd",Ki(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var r=this;this.dragStart(t,e);var n=Ef(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.setTransform(c,s),r.resetStyle(s),r.fillDragStartParams(c,s)});Gn(t,"onBeforeRenderGroupStart",Ki(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:a}))},dragGroup:function(t,e){var r=this;this.drag(t,e);var n=Ef(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.resetStyle(s),r.fillDragParams(c,s)});Gn(t,"onBeforeRenderGroup",Ki(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:a}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),Gn(t,"onBeforeRenderGroupEnd",Ki(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},GK={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,e){Gn(t,"onRenderStart",Ki(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){Gn(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){return this.drag(t,e)},dragEnd:function(t,e){Gn(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){Gn(t,"onRenderGroupStart",Ki(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var r=this,n=Ef(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.fillDragParams(c,s)});Gn(t,"onRenderGroup",Ki(t,e,Gt(Gt({isPinch:!!e.isPinch,targets:t.props.targets,transform:pw(e),transformObject:{}},yc(gw(e))),{events:a})))},dragGroupEnd:function(t,e){var r=this,n=Ef(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.fillDragEndParams(c,s)});Gn(t,"onRenderGroupEnd",Ki(t,e,Gt({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:a,transformObject:{},transform:pw(e)},yc(gw(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){var r={};return V0(nE(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),Ki(t,e,Gt({isPinch:!!e.isPinch,transformObject:r,transform:pw(e)},yc(gw(e))))},fillDragEndParams:function(t,e){var r={};return V0(nE(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),Ki(t,e,Gt({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:r,transform:pw(e)},yc(gw(e))))}};function yb(t,e,r,n,i,a,s){a.clientDistX=a.distX,a.clientDistY=a.distY;var o=i==="Start",c=i==="End",h=i==="After",d=t.state.target,m=a.isRequest,b=n.indexOf("Control")>-1;if(!d||o&&b&&!m&&t.areaElement===a.inputEvent.target)return!1;var x=yn([],Zt(e),!1);if(m){var E=a.requestAble;x.some(function(W){return W.name===E})||x.push.apply(x,yn([],Zt(t.props.ables.filter(function(W){return W.name===E})),!1))}if(!x.length||x.every(function(W){return W.dragRelation}))return!1;var T=a.inputEvent,A;c&&T&&(A=document.elementFromPoint(a.clientX,a.clientY)||T.target);var M=!1,F=function(){var W;M=!0,(W=a.stop)===null||W===void 0||W.call(a)},N=o&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());N&&t.updateRect(i,!0,!1);var O=a.datas,U=b?"controlGesto":"targetGesto",j=t[U],H=function(W,oe,se){if(!(oe in W)||j!==t[U])return!1;var he=W.name,_e=O[he]||(O[he]={});if(o&&(_e.isEventStart=!se||!W[se]||W[se](t,a)),!_e.isEventStart)return!1;var Ce=W[oe](t,Gt(Gt({},a),{stop:F,datas:_e,originalDatas:O,inputTarget:A}));return t._emitter.off(),o&&Ce===!1&&(_e.isEventStart=!1),Ce};N&&x.forEach(function(W){W.unset&&W.unset(t)}),H(WK,"drag".concat(n).concat(i));var G=0,X=0;r.forEach(function(W){if(M)return!1;var oe="".concat(W).concat(n).concat(i),se="".concat(W).concat(n,"Condition");i===""&&!m&&Txe(t.state,a);var he=x.filter(function(me){return me[oe]});he=he.filter(function(me,xe){return me.name&&he.indexOf(me)===xe});var _e=he.filter(function(me){return H(me,oe,se)}),Ce=_e.length;M&&++G,Ce&&++X,!M&&o&&he.length&&!Ce&&(G+=he.filter(function(me){var xe=me.name,Ae=O[xe];return Ae.isEventStart?me.dragRelation!=="strong":!1}).length?1:0)}),(!h||X)&&H(GK,"drag".concat(n).concat(i));var ae=j!==t[U]||G===r.length;if((c||M||ae)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(W){W.state.gestos={}}),x.forEach(function(W){W.unset&&W.unset(t)})),o&&!ae&&!m&&X&&t.props.preventDefault&&a?.preventDefault(),t.isUnmounted||ae)return!1;if(!o&&X&&!s||c){var Q=t.props.flushSync||EK;Q(function(){t.updateRect(c?i:"",!0,!1),t.forceUpdate()})}return!o&&!c&&!h&&X&&!s&&yb(t,e,r,n,i+"After",a),!0}function eN(t,e){return function(r,n){var i;n===void 0&&(n=r.inputEvent.target);var a=n,s=t.areaElement,o=t._dragTarget;return!o||!e&&(!((i=t.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===o||o.contains(a)||a===s||!t.isMoveableElement(a)&&!t.controlBox.contains(a)||Bl(a,"moveable-area")||Bl(a,"moveable-padding")||Bl(a,"moveable-edgeDraggable")}}function XK(t,e,r){var n=t.controlBox,i=[],a=t.props,s=a.dragArea,o=t.state.target,c=a.dragTarget;i.push(n),(!s||c)&&i.push(e),!s&&c&&o&&e!==o&&a.dragTargetSelf&&i.push(o);var h=eN(t);return ZK(t,i,"targetAbles",r,{dragStart:h,pinchStart:h})}function YK(t,e){var r=t.controlBox,n=[];n.push(r);var i=eN(t,!0),a=function(s,o){if(o===void 0&&(o=s.inputEvent.target),o===r)return!0;var c=i(s,o);return!c};return ZK(t,n,"controlAbles",e,{dragStart:a,pinchStart:a})}function ZK(t,e,r,n,i){i===void 0&&(i={});var a=r==="targetAbles",s=t.props,o=s.pinchOutside,c=s.pinchThreshold,h=s.preventClickEventOnDrag,d=s.preventClickDefault,m=s.checkInput,b=s.dragFocusedInput,x=s.preventDefault,E=x===void 0?!0:x,T=s.preventRightClick,A=T===void 0?!0:T,M=s.preventWheelClick,F=M===void 0?!0:M,N=s.dragContainer,O=bd(N,!0),U={preventDefault:E,preventRightClick:A,preventWheelClick:F,container:O||xg(t.getControlBoxElement()),pinchThreshold:c,pinchOutside:o,preventClickEventOnDrag:a?h:!1,preventClickEventOnDragStart:a?d:!1,preventClickEventByCondition:a?null:function(G){return t.controlBox.contains(G.target)},checkInput:a?m:!1,dragFocusedInput:b},j=new I1e(e,U),H=n==="Control";return["drag","pinch"].forEach(function(G){["Start","","End"].forEach(function(X){j.on("".concat(G).concat(X),function(ae){var Q,W=ae.eventType,oe=G==="drag"&&ae.isPinch;if(i[W]&&!i[W](ae)){ae.stop();return}if(!oe){var se=G==="drag"?[G]:["drag",G],he=yn([],Zt(t[r]),!1),_e=yb(t,he,se,n,X,ae);_e?(t.props.stopPropagation||X==="Start"&&H)&&((Q=ae?.inputEvent)===null||Q===void 0||Q.stopPropagation()):ae.stop()}})})}),j}var n2e=(function(){function t(e,r,n){var i=this;this.target=e,this.moveable=r,this.eventName=n,this.ables=[],this._onEvent=function(a){var s=i.eventName,o=i.moveable;o.state.disableNativeEvent||i.ables.forEach(function(c){c[s](o,{inputEvent:a})})},e.addEventListener(n.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(e){this.ables=e},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t})();function i2e(t,e,r,n){var i;r===void 0&&(r=e);var a=tK(t,e),s=a.matrixes,o=a.is3d,c=a.targetMatrix,h=a.transformOrigin,d=a.targetOrigin,m=a.offsetContainer,b=a.hasFixed,x=a.zoom,E=vbe(m,r),T=E.matrixes,A=E.is3d,M=E.offsetContainer,F=E.zoom,N=n,O=4,U=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t,j=c,H=Jo(O),G=Jo(O),X=Jo(O),ae=Jo(O),Q=s.length,W=T.map(function(xe){return Gt(Gt({},xe),{matrix:xe.matrix?yn([],Zt(xe.matrix),!1):void 0})}).reverse();s.reverse(),!o&&N&&(j=Af(j,3,4),SR(s)),!A&&N&&SR(W),W.forEach(function(xe){G=wo(G,xe.matrix,O)});var oe=r||zg(t),se=((i=W[0])===null||i===void 0?void 0:i.target)||Gb(oe,oe,!0).offsetParent,he=W.slice(1).reduce(function(xe,Ae){return wo(xe,Ae.matrix,O)},Jo(O));s.forEach(function(xe,Ae){if(Q-2===Ae&&(X=H.slice()),Q-1===Ae&&(ae=H.slice()),!xe.matrix){var De=s[Ae+1],de=xxe(xe,De,se,O,wo(he,H,O));xe.matrix=ey(de,O)}H=wo(H,xe.matrix,O)});var _e=!U&&o;j||(j=Jo(_e?4:3));var Ce=u3(U&&j.length===16?Af(j,4,3):j,_e),me=G;return G=NZ(G,O,O),{hasZoom:x!==1||F!==1,hasFixed:b,matrixes:s,rootMatrix:G,originalRootMatrix:me,beforeMatrix:X,offsetMatrix:ae,allMatrix:H,targetMatrix:j,targetTransform:Ce,inlineTransform:t.style.transform,transformOrigin:h,targetOrigin:d,is3d:N,offsetContainer:m,offsetRootContainer:M}}function a2e(t,e,r,n){r===void 0&&(r=e);var i=0,a=0,s=0,o={},c=IK(t);if(t&&(i=c.offsetWidth,a=c.offsetHeight),t){var h=i2e(t,e,r,n),d=A0(h.allMatrix,h.transformOrigin,i,a);o=Gt(Gt({},h),d);var m=A0(h.allMatrix,[50,50],100,100);s=PK([m.pos1,m.pos2],m.direction)}var b=4;return Gt(Gt(Gt({hasZoom:!1,width:i,height:a,rotation:s},c),{originalRootMatrix:Jo(b),rootMatrix:Jo(b),beforeMatrix:Jo(b),offsetMatrix:Jo(b),allMatrix:Jo(b),targetMatrix:Jo(b),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),o)}function AR(t,e,r,n,i,a){a===void 0&&(a=[]);var s=1,o=[0,0],c=yw(),h=yw(),d=yw(),m=yw(),b=[0,0],x={},E=a2e(e,r,i,!0);if(e){var T=Nc(e);a.forEach(function(W){x[W]=T(W)});var A=E.is3d?4:3,M=A0(E.offsetMatrix,Ma(E.transformOrigin,LZ(E.targetMatrix,A)),E.width,E.height);s=M.direction,o=Ma(M.origin,[M.left-E.left,M.top-E.top]),m=mb(E.offsetRootContainer);var F=Gb(n,n,!0).offsetParent||E.offsetRootContainer;if(E.hasZoom){var N=A0(wo(E.originalRootMatrix,E.allMatrix),E.transformOrigin,E.width,E.height),O=A0(E.originalRootMatrix,sE(Nc(F)("transformOrigin")).map(function(W){return parseFloat(W)}),F.offsetWidth,F.offsetHeight);if(c=JA(N,m),d=JA(O,m,F,!0),t){var U=N.left,j=N.top;h=JA({left:U,top:j,bottom:j,right:j},m)}}else{c=mb(e),d=ybe(F),t&&(h=mb(t));var H=d.left,G=d.top,X=d.clientLeft,ae=d.clientTop,Q=[c.left-H,c.top-G];b=_i(W0(E.rootMatrix,Q,4),[X+E.left,ae+E.top])}}return Gt({targetClientRect:c,containerClientRect:d,moveableClientRect:h,rootContainerClientRect:m,beforeDirection:s,beforeOrigin:o,originalBeforeOrigin:o,target:e,style:x,offsetDelta:b},E)}function p7(t){var e=t.pos1,r=t.pos2,n=t.pos3,i=t.pos4;if(!e||!r||!n||!i)return null;var a=ty([e,r,n,i]),s=[a.minX,a.minY],o=_i(t.origin,s);return e=_i(e,s),r=_i(r,s),n=_i(n,s),i=_i(i,s),Gt(Gt({},t),{left:t.left,top:t.top,posDelta:s,pos1:e,pos2:r,pos3:n,pos4:i,origin:o,beforeOrigin:o,isPersisted:!0})}var G0=(function(t){zx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.state=Gt({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},AR(null)),r.renderState={},r.enabledAbles=[],r.targetAbles=[],r.controlAbles=[],r.rotation=0,r.scale=[1,1],r.isMoveableMounted=!1,r.isUnmounted=!1,r.events={mouseEnter:null,mouseLeave:null},r._emitter=new MO,r._prevOriginalDragTarget=null,r._originalDragTarget=null,r._prevDragTarget=null,r._dragTarget=null,r._prevPropTarget=null,r._propTarget=null,r._prevDragArea=!1,r._isPropTargetChanged=!1,r._hasFirstTarget=!1,r._reiszeObserver=null,r._observerId=0,r._mutationObserver=null,r._rootContainer=null,r._viewContainer=null,r._viewClassNames=[],r._store={},r.checkUpdateRect=function(){if(!r.isDragging()){var n=r.props.parentMoveable;if(n){n.checkUpdateRect();return}V_e(r._observerId),r._observerId=kZ(function(){r.isDragging()||r.updateRect()})}},r._onPreventClick=function(n){n.stopPropagation(),n.preventDefault()},r}return e.prototype.render=function(){var r=this.props,n=this.getState(),i=r.parentPosition,a=r.className,s=r.target,o=r.zoom,c=r.cspNonce,h=r.translateZ,d=r.cssStyled,m=r.groupable,b=r.linePadding,x=r.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var E=Zt(i||[0,0],2),T=E[0],A=E[1],M=n.left,F=n.top,N=n.target,O=n.direction,U=n.hasFixed,j=n.offsetDelta,H=r.targets,G=this.isDragging(),X={};this.getEnabledAbles().forEach(function(he){X["data-able-".concat(he.name.toLowerCase())]=!0});var ae=this._getAbleClassName(),Q=H&&H.length&&(N||m)||s||!this._hasFirstTarget&&this.state.isPersisted,W=this.controlBox||this.props.firstRenderState||this.props.persistData,oe=[M-T,F-A];!m&&r.useAccuratePosition&&(oe[0]+=j[0],oe[1]+=j[1]);var se={position:U?"fixed":"absolute",display:Q?"block":"none",visibility:W?"visible":"hidden",transform:"translate3d(".concat(oe[0],"px, ").concat(oe[1],"px, ").concat(h,")"),"--zoom":o,"--zoompx":"".concat(o,"px")};return b&&(se["--moveable-line-padding"]=b),x&&(se["--moveable-control-padding"]=x),te.createElement(d,Gt({cspNonce:c,ref:zm(this,"controlBox"),className:"".concat(yi("control-box",O===-1?"reverse":"",G?"dragging":"")," ").concat(ae," ").concat(a)},X,{onClick:this._onPreventClick,style:se}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var r=this.props,n=r.parentMoveable,i=r.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!n&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(r){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(r)},e.prototype.componentWillUnmount=function(){var r,n;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(r=this._reiszeObserver)===null||r===void 0||r.disconnect(),(n=this._mutationObserver)===null||n===void 0||n.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),c0(this,!1),c0(this,!0);var a=this.events;for(var s in a){var o=a[s];o&&o.destroy()}},e.prototype.getTargets=function(){var r=this.props.target;return r?[r]:[]},e.prototype.getAble=function(r){var n=this.props.ables||[];return hh(n,function(i){return i.name===r})},e.prototype.getContainer=function(){var r=this.props,n=r.parentMoveable,i=r.wrapperMoveable,a=r.container;return a||i&&i.getContainer()||n&&n.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(r){var n;return r&&(((n=r.getAttribute)===null||n===void 0?void 0:n.call(r,"class"))||"").indexOf(NO)>-1},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=this.targetGesto,a=this.controlGesto;return i&&eN(this)({inputEvent:r},n)?i.isFlag()||i.triggerDragStart(r):a&&this.isMoveableElement(n)&&(a.isFlag()||a.triggerDragStart(r)),this},e.prototype.hitTest=function(r){var n=this.state,i=n.target,a=n.pos1,s=n.pos2,o=n.pos3,c=n.pos4,h=n.targetClientRect;if(!i)return 0;var d;if(IO(r)){var m=r.getBoundingClientRect();d={left:m.left,top:m.top,width:m.width,height:m.height}}else d=Gt({width:0,height:0},r);var b=d.left,x=d.top,E=d.width,T=d.height,A=F9([a,s,c,o],h),M=w1e(A,[[b,x],[b+E,x],[b+E,x+T],[b,x+T]]),F=jZ(A);return!M||!F?0:Math.min(100,M/F*100)},e.prototype.isInside=function(r,n){var i=this.state,a=i.target,s=i.pos1,o=i.pos2,c=i.pos3,h=i.pos4,d=i.targetClientRect;return a?cR([r,n],F9([s,o,h,c],d)):!1},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0);var a=this.props,s=!a.parentPosition&&!a.wrapperMoveable;s&&q0(!0);var o=a.parentMoveable,c=this.state,h=c.target||a.target,d=this.getContainer(),m=o?o._rootContainer:this._rootContainer,b=AR(this.controlBox,h,d,d,m||d,this._getRequestStyles());if(!h&&this._hasFirstTarget&&a.persistData){var x=p7(a.persistData);for(var E in x)b[E]=x[E]}s&&q0(),this.updateState(b,o?!1:i)},e.prototype.isDragging=function(r){var n,i,a=this.targetGesto,s=this.controlGesto;if(a?.isFlag()){if(!r)return!0;var o=a.getEventData();return!!(!((n=o[r])===null||n===void 0)&&n.isEventStart)}if(s?.isFlag()){if(!r)return!0;var o=s.getEventData();return!!(!((i=o[r])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(r){this.updateRect(r,!0)},e.prototype.getRect=function(){var r=this.state,n=Wh(this.state),i=Zt(n,4),a=i[0],s=i[1],o=i[2],c=i[3],h=Bh(n),d=r.width,m=r.height,b=h.width,x=h.height,E=h.left,T=h.top,A=[r.left,r.top],M=Ma(A,r.origin),F=Ma(A,r.beforeOrigin),N=r.transformOrigin;return{width:b,height:x,left:E,top:T,pos1:a,pos2:s,pos3:o,pos4:c,offsetWidth:d,offsetHeight:m,beforeOrigin:F,origin:M,transformOrigin:N,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(r){if(!r||r==="target"){var n=this.targetGesto;n?.isIdle()===!1&&ER(this,!1),n?.stop()}if(!r||r==="control"){var n=this.controlGesto;n?.isIdle()===!1&&ER(this,!0),n?.stop()}},e.prototype.getRotation=function(){var r=this.state,n=r.pos1,i=r.pos2,a=r.direction;return Ixe(n,i,a)},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this,s=a.props,o=s.parentMoveable||s.wrapperMoveable||a,c=o.props.ables,h=s.groupable,d=hh(c,function(M){return M.name===r});if(this.isDragging()||!d||!d.request)return{request:function(){return this},requestEnd:function(){return this}};var m=d.request(a),b=i||n.isInstant,x=m.isControl?"controlAbles":"targetAbles",E="".concat(h?"Group":"").concat(m.isControl?"Control":""),T=yn([],Zt(o[x]),!1),A={request:function(M){return yb(a,T,["drag"],E,"",Gt(Gt({},m.request(M)),{requestAble:r,isRequest:!0}),b),A},requestEnd:function(){return yb(a,T,["drag"],E,"End",Gt(Gt({},m.requestEnd()),{requestAble:r,isRequest:!0}),b),A}};return yb(a,T,["drag"],E,"Start",Gt(Gt({},m.requestStart(n)),{requestAble:r,isRequest:!0}),b),b?A.request(n).requestEnd():A},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var r=this.getState(),n=this.props,i=n.padding,a=r.originalBeforeOrigin,s=r.transformOrigin,o=r.allMatrix,c=r.is3d,h=r.pos1,d=r.pos2,m=r.pos3,b=r.pos4,x=r.left,E=r.top,T=r.isPersisted,A=n.zoom||1;if(!i&&A<=1){r.renderPoses=[h,d,m,b],r.renderLines=[[h,d],[d,b],[b,m],[m,h]];return}var M=zK(i||{}),F=M.left,N=M.top,O=M.bottom,U=M.right,j=c?4:3,H=[];T?H=s:this.controlBox&&n.groupable?H=a:H=Ma(a,[x,E]);var G=tE(j,ey(H.map(function(se){return-se}),j),o,ey(s,j)),X=Ah(G,h,[-F,-N],j),ae=Ah(G,d,[U,-N],j),Q=Ah(G,m,[-F,O],j),W=Ah(G,b,[U,O],j);r.renderPoses=[X,ae,Q,W],r.renderLines=[[X,ae],[ae,W],[W,Q],[Q,X]];{var oe=A/2;r.renderLines=[[Ah(G,h,[-F-oe,-N],j),Ah(G,d,[U+oe,-N],j)],[Ah(G,d,[U,-N-oe],j),Ah(G,b,[U,O+oe],j)],[Ah(G,b,[U+oe,O],j),Ah(G,m,[-F-oe,O],j)],[Ah(G,m,[-F,O+oe],j),Ah(G,h,[-F,-N-oe],j)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var r=this.props,n=r.target,i=r.container,a=r.parentMoveable,s=this.state,o=s.target,c=s.container;if(!(!o&&!n)){this.updateAbles();var h=!TR(o,n),d=h||!TR(c,i);if(d){var m=i||this.controlBox;m&&this.unsetAbles(),this.updateState({target:n,container:i}),!a&&m&&this.updateRect("End",!1,!1),this._isPropTargetChanged=h}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(r,n){var i=this.props;if(this._emitter.trigger(r,n),i.parentMoveable&&n.isRequest&&!n.isRequestChild)return i.parentMoveable.triggerEvent(r,n,!0);var a=i[r];return a&&a(n)},e.prototype.useCSS=function(r,n){var i=this.props.customStyledMap,a=r+n;return i[a]||(i[a]=$Z(r,n)),i[a]},e.prototype.getState=function(){var r,n=this.props;(n.target||!((r=n.targets)===null||r===void 0)&&r.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=n.persistData,s=n.firstRenderState;if(s&&!i)return s;if(!this._hasFirstTarget&&a){var o=p7(a);if(o)return this.updateState(o,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var r=this;this.targetAbles.forEach(function(n){n.unset&&n.unset(r)})},e.prototype.updateAbles=function(r,n){r===void 0&&(r=this.props.ables),n===void 0&&(n="");var i=this.props,a=i.triggerAblesSimultaneously,s=this.getEnabledAbles(r),o="drag".concat(n,"Start"),c="pinch".concat(n,"Start"),h="drag".concat(n,"ControlStart"),d=vw(s,[o,c],a),m=vw(s,[h],a);this.enabledAbles=s,this.targetAbles=d,this.controlAbles=m},e.prototype.updateState=function(r,n){if(n){if(this.isUnmounted)return;this.setState(r)}else{var i=this.state;for(var a in r)i[a]=r[a]}},e.prototype.getEnabledAbles=function(r){r===void 0&&(r=this.props.ables);var n=this.props;return r.filter(function(i){return i&&(i.always&&n[i.name]!==!1||n[i.name])})},e.prototype.renderAbles=function(){var r=this,n=this.props,i=n.triggerAblesSimultaneously,a={createElement:te.createElement};return this.renderState={},Exe(NK(vw(this.getEnabledAbles(),["render"],i).map(function(s){var o=s.render;return o(r,a)||[]})).filter(function(s){return s}),function(s){var o=s.key;return o}).map(function(s){return s[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return yn(yn([],Zt(n),!1),Zt(o),!1)},yn([],Zt(this.props.requestStyles||[]),!1));return r},e.prototype._updateObserver=function(r){this._updateResizeObserver(r),this._updateMutationObserver(r)},e.prototype._updateEvents=function(){var r=this.targetAbles.length,n=this.controlAbles.length,i=this._dragTarget,a=!r&&this.targetGesto||this._isTargetChanged(!0);a&&(c0(this,!1),this.updateState({gestos:{}})),n||c0(this,!0),i&&r&&!this.targetGesto&&(this.targetGesto=XK(this,i,"")),!this.controlGesto&&n&&(this.controlGesto=YK(this,"Control"))},e.prototype._updateTargets=function(){var r=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=r.dragArea,this._propTarget=r.target,this._originalDragTarget=r.dragTarget||r.target,this._dragTarget=bd(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var r=this.props,n=r,i=n.zoom,a=n.hideDefaultLines,s=n.hideChildMoveableDefaultLines,o=n.parentMoveable;if(a||o&&s)return[];var c=this.getState(),h={createElement:te.createElement};return c.renderLines.map(function(d,m){return Wb(h,"",d[0],d[1],i,"render-line-".concat(m))})},e.prototype._isTargetChanged=function(r){var n=this.props,i=n.dragTarget||n.target,a=this._prevOriginalDragTarget,s=this._prevDragArea,o=n.dragArea,c=!o&&a!==i,h=(r||o)&&s!==o;return c||h||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var r=this,n=this.props,i=n.dragArea?this.areaElement:this.state.target,a=this.events,s=d_(a);if(this._isTargetChanged())for(var o in a){var c=a[o];c&&c.destroy(),a[o]=null}if(i){var h=this.enabledAbles;s.forEach(function(d){var m=vw(h,[d]),b=m.length>0,x=a[d];if(!b){x&&(x.destroy(),a[d]=null);return}x||(x=new n2e(i,r,d),a[d]=x),x.setAbles(m)})}},e.prototype._checkUpdateRootContainer=function(){var r=this.props.rootContainer;!this._rootContainer&&r&&(this._rootContainer=bd(r,!0))},e.prototype._checkUpdateViewContainer=function(){var r=this.props.viewContainer;!this._viewContainer&&r&&(this._viewContainer=bd(r,!0));var n=this._viewContainer;n&&this._changeAbleViewClassNames(yn(yn([],Zt(this._getAbleViewClassNames()),!1),[this.isDragging()?Nxe:""],!1))},e.prototype._changeAbleViewClassNames=function(r){var n=this._viewContainer,i=OK(r.filter(Boolean),function(h){return h}).map(function(h){var d=Zt(h,1),m=d[0];return m}),a=this._viewClassNames,s=RO(a,i),o=s.removed,c=s.added;o.forEach(function(h){DZ(n,a[h])}),c.forEach(function(h){MZ(n,i[h])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var r=this;return(this.getEnabledAbles().map(function(n){var i;return((i=n.viewClassName)===null||i===void 0?void 0:i.call(n,r))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(r){var n=this;r===void 0&&(r="");var i=this.getEnabledAbles(),a=this.targetGesto,s=this.controlGesto,o=a?.isFlag()?a.getEventData():{},c=s?.isFlag()?s.getEventData():{};return i.map(function(h){var d,m,b,x=h.name,E=((d=h.className)===null||d===void 0?void 0:d.call(h,n))||"";return(!((m=o[x])===null||m===void 0)&&m.isEventStart||!((b=c[x])===null||b===void 0)&&b.isEventStart)&&(E+=" ".concat(yi("".concat(x).concat(r,"-dragging")))),E.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(r){var n,i=this.props,a=i.target,s=xg(this.getControlBoxElement());if(!s.ResizeObserver||!a||!i.useResizeObserver){(n=this._reiszeObserver)===null||n===void 0||n.disconnect();return}if(!(r.target===a&&this._reiszeObserver)){var o=new s.ResizeObserver(this.checkUpdateRect);o.observe(a,{box:"border-box"}),this._reiszeObserver=o}},e.prototype._updateMutationObserver=function(r){var n=this,i,a=this.props,s=a.target,o=xg(this.getControlBoxElement());if(!o.MutationObserver||!s||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(r.target===s&&this._mutationObserver)){var c=new o.MutationObserver(function(h){var d,m;try{for(var b=z1e(h),x=b.next();!x.done;x=b.next()){var E=x.value;E.type==="attributes"&&E.attributeName==="style"&&n.checkUpdateRect()}}catch(T){d={error:T}}finally{try{x&&!x.done&&(m=b.return)&&m.call(b)}finally{if(d)throw d.error}}});c.observe(s,{attributes:!0}),this._mutationObserver=c}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:EK,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(te.PureComponent),tN={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,e){var r,n=t.props,i=n.targets||[],a=t.getState(),s=a.left,o=a.top,c=a.isPersisted,h=n.zoom||1,d=t.renderGroupRects,m=((r=n.persistData)===null||r===void 0?void 0:r.children)||[];c?i=m.map(function(){return null}):m=[];var b=h0(t,"parentPosition",[s,o],function(E){return E.join(",")}),x=h0(t,"requestStyles",t.getRequestChildStyles(),function(E){return E.join(",")});return t.moveables=t.moveables.slice(0,i.length),yn(yn([],Zt(i.map(function(E,T){return e.createElement(G0,{key:"moveable"+T,ref:CZ(t,"moveables",T),target:E,origin:!1,requestStyles:x,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,useMutationObserver:n.useMutationObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[s,o],persistData:m[T],zoom:h})})),!1),Zt(NK(d.map(function(E,T){var A=E.pos1,M=E.pos2,F=E.pos3,N=E.pos4,O=[A,M,F,N];return[[0,1],[1,3],[3,2],[2,0]].map(function(U,j){var H=Zt(U,2),G=H[0],X=H[1];return Wb(e,"",_i(O[G],b),_i(O[X],b),h,"group-rect-".concat(T,"-").concat(j))})}))),!1)}},o2e=jx("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var r=t.props.target,n=e.inputEvent,i=e.inputTarget,a=t.isMoveableElement(i),s=!a&&t.controlBox.contains(i);if(!(!n||!i||e.isDrag||t.isMoveableElement(i)||s)){var o=r.contains(i);Gn(t,"onClick",Ki(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:r===i,moveableTarget:t.props.target,containsTarget:o}))}},dragGroupEnd:function(t,e){var r=e.inputEvent,n=e.inputTarget;if(!(!r||!n||e.isDrag||t.isMoveableElement(n)||e.datas.inputTarget===n)){var i=t.props.targets,a=i.indexOf(n),s=a>-1,o=!1;a===-1&&(a=Sp(i,function(c){return c.contains(n)}),o=a>-1),Gn(t,"onClickGroup",Ki(t,e,{isDouble:e.isDouble,targets:i,inputTarget:n,targetIndex:a,isTarget:s,containsTarget:o,moveableTarget:i[a]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function yv(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),Gt(Gt({},t),{datas:e})}var s2e=jx("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(t,e){var r=t.props,n=r.edgeDraggable;return n?iK(e,"edgeDraggable",n,t.getState().renderPoses,r.zoom):[]},dragCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Bl(i,yi("direction"))&&Bl(i,yi("edge"))&&Bl(i,yi("edgeDraggable"))},dragStart:function(t,e){return pc.dragStart(t,yv(e))},drag:function(t,e){return pc.drag(t,yv(e))},dragEnd:function(t,e){return pc.dragEnd(t,yv(e))},dragGroupCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Bl(i,yi("direction"))&&Bl(i,yi("line"))},dragGroupStart:function(t,e){return pc.dragGroupStart(t,yv(e))},dragGroup:function(t,e){return pc.dragGroup(t,yv(e))},dragGroupEnd:function(t,e){return pc.dragGroupEnd(t,yv(e))},unset:function(t){return pc.unset(t)}}),KK={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},l2e=[WK,VK,hxe,kxe,pc,s2e,bR,Rxe,Dxe,Gbe,Bxe,zxe,Lxe,Kxe,Zxe,t2e,tN,KK,o2e,UK,GK];function g7(t,e){var r=Zt(t,3),n=r[0],i=r[1],a=r[2];return(n*e[0]+i*e[1]+a)/Math.sqrt(n*n+i*i)}function xw(t,e){var r=Zt(t,2),n=r[0],i=r[1];return-n*e[0]-i*e[1]}function m7(t,e){return Math.max.apply(Math,yn([],Zt(t.map(function(r){var n=Zt(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.max(i[e],a[e],s[e],o[e])})),!1))}function y7(t,e){return Math.min.apply(Math,yn([],Zt(t.map(function(r){var n=Zt(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.min(i[e],a[e],s[e],o[e])})),!1))}function u2e(t,e){var r,n,i,a=[0,0],s=[0,0],o=[0,0],c=[0,0],h=0,d=0;if(!t.length)return{pos1:a,pos2:s,pos3:o,pos4:c,minX:0,minY:0,maxX:0,maxY:0,width:h,height:d,rotation:e};var m=Fi(e,bc);if(m%90){var b=m/180*Math.PI,x=Math.tan(b),E=-1/x,T=[mR,j9],A=[[0,0],[0,0]],M=[mR,j9],F=[[0,0],[0,0]];t.forEach(function(Ee){Ee.forEach(function(we){var Le=g7([-x,1,0],we),Fe=g7([-E,1,0],we);T[0]>Le&&(A[0]=we,T[0]=Le),T[1]<Le&&(A[1]=we,T[1]=Le),M[0]>Fe&&(F[0]=we,M[0]=Fe),M[1]<Fe&&(F[1]=we,M[1]=Fe)})});var N=Zt(A,2),O=N[0],U=N[1],j=Zt(F,2),H=j[0],G=j[1],X=[-x,1,xw([-x,1],O)],ae=[-x,1,xw([-x,1],U)],Q=[-E,1,xw([-E,1],H)],W=[-E,1,xw([-E,1],G)];r=Zt([[X,Q],[X,W],[ae,Q],[ae,W]].map(function(Ee){var we=Zt(Ee,2),Le=we[0],Fe=we[1];return DO(Le,Fe)[0]}),4),a=r[0],s=r[1],o=r[2],c=r[3],h=M[1]-M[0],d=T[1]-T[0]}else{var oe=y7(t,0),se=y7(t,1),he=m7(t,0),_e=m7(t,1);if(a=[oe,se],s=[he,se],o=[oe,_e],c=[he,_e],h=he-oe,d=_e-se,m%180){var Ce=[o,a,c,s];n=Zt(Ce,4),a=n[0],s=n[1],o=n[2],c=n[3],h=_e-se,d=he-oe}}if(m%360>180){var Ce=[c,o,s,a];i=Zt(Ce,4),a=i[0],s=i[1],o=i[2],c=i[3]}var me=ty([a,s,o,c]),xe=me.minX,Ae=me.minY,De=me.maxX,de=me.maxY;return{pos1:a,pos2:s,pos3:o,pos4:c,width:h,height:d,minX:xe,minY:Ae,maxX:De,maxY:de,rotation:e}}function JK(t,e){var r=e.map(function(n){if(su(n)){var i=JK(t,n),a=i.length;return a>1?i:a===1?i[0]:null}else{var s=hh(t,function(o){var c=o.manager;return c.props.target===n});return s?(s.finded=!0,s.manager):null}}).filter(Boolean);return r.length===1&&su(r[0])?r[0]:r}var c2e=(function(t){zx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.differ=new zZ,r.moveables=[],r.transformOrigin="50% 50%",r.renderGroupRects=[],r._targetGroups=[],r._hasFirstTargets=!1,r}return e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){var a;i===void 0&&(i=!0);var s=this.state;if(!this.controlBox||s.isPersisted)return;q0(!0),this.moveables.forEach(function(Be){Be.updateRect(r,!1,!1)});var o=this.props,c=this.moveables,h=s.target||o.target,d=c.map(function(Be){return{finded:!1,manager:Be}}),m=this.props.targetGroups||[],b=JK(d,m),x=o.useDefaultGroupRotate;b.push.apply(b,yn([],Zt(d.filter(function(Be){var ot=Be.finded;return!ot}).map(function(Be){var ot=Be.manager;return ot})),!1));var E=[],T=!n||r!==""&&o.updateGroup,A=o.defaultGroupRotate||0;if(!this._hasFirstTargets){var M=(a=o.persistData)===null||a===void 0?void 0:a.rotation;M!=null&&(A=M)}function F(Be,ot,Qe){var rt=Be.map(function(pr){if(su(pr)){var _t=F(pr,ot),vr=[_t.pos1,_t.pos2,_t.pos3,_t.pos4];return E.push(_t),{poses:vr,rotation:_t.rotation}}else return{poses:Wh(pr.state),rotation:pr.getRotation()}}),Re=rt.map(function(pr){var _t=pr.rotation;return _t}),zt=0,st=Re[0],$e=Re.every(function(pr){return Math.abs(st-pr)<.1});T?zt=!x&&$e?st:A:zt=!x&&!Qe&&$e?st:ot;var Jt=rt.map(function(pr){var _t=pr.poses;return _t}),Ht=u2e(Jt,zt);return Ht}var N=F(b,this.rotation,!0);T&&(this.rotation=N.rotation,this.transformOrigin=o.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=m,this.renderGroupRects=E;var O=this.transformOrigin,U=this.rotation,j=this.scale,H=N.width,G=N.height,X=N.minX,ae=N.minY,Q=Pxe([[0,0],[H,0],[0,G],[H,G]],KO(O,H,G),this.rotation/180*Math.PI),W=ty(Q.result),oe=W.minX,se=W.minY,he=" rotate(".concat(U,"deg)")+" scale(".concat(gc(j[0]),", ").concat(gc(j[1]),")"),_e="translate(".concat(-oe,"px, ").concat(-se,"px)").concat(he);this.controlBox.style.transform="translate3d(".concat(X,"px, ").concat(ae,"px, ").concat(this.props.translateZ||0,")"),h.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(O,";")+"width:".concat(H,"px;height:").concat(G,"px;")+"transform: ".concat(_e),s.width=H,s.height=G;var Ce=this.getContainer(),me=AR(this.controlBox,h,this.controlBox,this.getContainer(),this._rootContainer||Ce,[]),xe=[me.left,me.top],Ae=Zt(Wh(me),4),De=Ae[0],de=Ae[1],Ee=Ae[2],we=Ae[3],Le=ty([De,de,Ee,we]),Fe=[Le.minX,Le.minY],Xe=gc(j[0]*j[1]);me.pos1=_i(De,Fe),me.pos2=_i(de,Fe),me.pos3=_i(Ee,Fe),me.pos4=_i(we,Fe),me.left=X-me.left+Fe[0],me.top=ae-me.top+Fe[1],me.origin=_i(Ma(xe,me.origin),Fe),me.beforeOrigin=_i(Ma(xe,me.beforeOrigin),Fe),me.originalBeforeOrigin=Ma(xe,me.originalBeforeOrigin),me.transformOrigin=_i(Ma(xe,me.transformOrigin),Fe),h.style.transform="translate(".concat(-oe-Fe[0],"px, ").concat(-se-Fe[1],"px)")+he,q0(),this.updateState(Gt(Gt({},me),{posDelta:Fe,direction:Xe,beforeDirection:Xe}),i)},e.prototype.getRect=function(){return Gt(Gt({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.triggerEvent=function(r,n,i){if(i||r.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,r,n);this._emitter.trigger(r,n)},e.prototype.getRequestChildStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return yn(yn([],Zt(n),!1),Zt(o),!1)},[]);return r},e.prototype.getMoveables=function(){return yn([],Zt(this.moveables),!1)},e.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,yn(yn([],Zt(this.props.ables),!1),[tN],!1),"Group")},e.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=bd(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var r=this.state,n=this.props,i=this._prevDragTarget,a=n.dragTarget||this.areaElement,s=n.targets,o=this.differ.update(s),c=o.added,h=o.changed,d=o.removed,m=c.length||d.length;(m||this._prevOriginalDragTarget!==this._originalDragTarget)&&(c0(this,!1),c0(this,!0),this.updateState({gestos:{}})),i!==a&&(r.target=null),r.target||(r.target=this.areaElement,this.controlBox.style.display="block"),r.target&&(this.targetGesto||(this.targetGesto=XK(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=YK(this,"GroupControl")));var b=!TR(r.container,n.container);b&&(r.container=n.container),(b||m||this.transformOrigin!==(n.defaultGroupOrigin||"50% 50%")||h.length||s.length&&!BK(this._targetGroups,n.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!m},e.prototype._updateObserver=function(){},e.defaultProps=Gt(Gt({},G0.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(G0),h2e=(function(t){zx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.moveables=[],r}return e.prototype.render=function(){var r=this,n,i=this.props,a=i.cspNonce,s=i.cssStyled,o=i.persistData,c=i.targets||[],h=c.length,d=this.isUnmounted||!h,m=(n=o?.children)!==null&&n!==void 0?n:[];return d&&!h&&m.length?c=m.map(function(){return null}):d||(m=[]),te.createElement(s,{cspNonce:a,ref:zm(this,"controlBox"),className:yi("control-box")},c.map(function(b,x){var E,T,A=(T=(E=i.individualGroupableProps)===null||E===void 0?void 0:E.call(i,b,x))!==null&&T!==void 0?T:{};return te.createElement(G0,Gt({key:"moveable"+x,ref:CZ(r,"moveables",x)},i,A,{target:b,wrapperMoveable:r,isWrapperMounted:r.isMoveableMounted,persistData:m[x]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0),q0(!0),this.moveables.forEach(function(a){a.updateRect(r,n,i)}),q0()},e.prototype.getRect=function(){return Gt(Gt({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this.moveables.map(function(c){return c.request(r,Gt(Gt({},n),{isInstant:!1}),!1)}),s=i||n.isInstant,o={request:function(c){return a.forEach(function(h){return h.request(c)}),this},requestEnd:function(){return a.forEach(function(c){return c.requestEnd()}),this}};return s?o.request(n).requestEnd():o},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=n,a=hh(this.moveables,function(s){var o=s.getTargets()[0],c=s.getControlBoxElement(),h=s.getDragElement();return!o||!h?!1:h===i||h.contains(i)||h!==o&&o===i||o.contains(i)||c===i||c.contains(i)});return a&&a.dragStart(r,n),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return yn([],Zt(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(G0);function QK(t,e){var r=[];return t.forEach(function(n){if(n){if(kp(n)){e[n]&&r.push.apply(r,yn([],Zt(e[n]),!1));return}su(n)?r.push.apply(r,yn([],Zt(QK(n,e)),!1)):r.push(n)}}),r}function eJ(t,e){var r=[];return t.forEach(function(n){if(n){if(kp(n)){e[n]&&r.push.apply(r,yn([],Zt(e[n]),!1));return}su(n)?r.push(eJ(n,e)):r.push(n)}}),r}function tJ(t,e){return t.length!==e.length||t.some(function(r,n){var i=e[n];return!r&&!i?!1:r!=i?su(r)&&su(i)?tJ(r,i):!0:!1})}var f2e=(function(t){zx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.refTargets=[],r.selectorMap={},r._differ=new zZ,r._elementTargets=[],r._tmpRefTargets=[],r._tmpSelectorMap={},r._onChangeTargets=null,r}return e.makeStyled=function(){var r={},n=this.getTotalAbles();n.forEach(function(a){var s=a.css;s&&s.forEach(function(o){r[o]=!0})});var i=d_(r).join(`
`);this.defaultStyled=$Z("div",k_e(NO,Z1e+i))},e.getTotalAbles=function(){return yn([VK,tN,KK,UK],Zt(this.defaultAbles),!1)},e.prototype.render=function(){var r,n=this.constructor;n.defaultStyled||n.makeStyled();var i=this.props,a=i.ables,s=i.props,o=F1e(i,["ables","props"]),c=Zt(this._updateRefs(!0),2),h=c[0],d=c[1],m=QK(h,d),b=m.length>1,x=n.getTotalAbles(),E=yn(yn([],Zt(x),!1),Zt(a||[]),!1),T=Gt(Gt(Gt({},o),s||{}),{ables:E,cssStyled:n.defaultStyled,customStyledMap:n.customStyledMap});this._elementTargets=m;var A=null,M=this.moveable,F=o.persistData;if(F?.children&&(b=!0),o.individualGroupable)return te.createElement(h2e,Gt({key:"individual-group",ref:zm(this,"moveable")},T,{target:null,targets:m}));if(b){var N=eJ(h,d);if(M&&!M.props.groupable&&!M.props.individualGroupable){var O=M.props.target;O&&m.indexOf(O)>-1&&(A=Gt({},M.state))}return te.createElement(c2e,Gt({key:"group",ref:zm(this,"moveable")},T,(r=o.groupableProps)!==null&&r!==void 0?r:{},{target:null,targets:m,targetGroups:N,firstRenderState:A}))}else{var U=m[0];if(M&&(M.props.groupable||M.props.individualGroupable)){var j=M.moveables||[],H=hh(j,function(G){return G.props.target===U});H&&(A=Gt({},H.state))}return te.createElement(G0,Gt({key:"single",ref:zm(this,"moveable")},T,{target:U,firstRenderState:A}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var r,n;return(n=(r=this.moveable)===null||r===void 0?void 0:r.getTargets())!==null&&n!==void 0?n:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var r=this,n;return this._onChangeTargets=function(){r._onChangeTargets=null,n()},new Promise(function(i){n=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(r){var n=this.refTargets,i=ZO(this.props.target||this.props.targets),a=typeof document<"u",s=tJ(n,i),o=this.selectorMap,c={};return this.refTargets.forEach(function h(d){if(kp(d)){var m=o[d];m?c[d]=o[d]:a&&(s=!0,c[d]=[].slice.call(document.querySelectorAll(d)))}else su(d)&&d.forEach(h)}),this._tmpRefTargets=i,this._tmpSelectorMap=c,[i,c,!r&&s]},e.prototype._checkChangeTargets=function(){var r,n,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),s=a.added,o=a.removed,c=s.length||o.length;c&&((n=(r=this.props).onChangeTargets)===null||n===void 0||n.call(r,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var h=Zt(this._updateRefs(),3),d=h[0],m=h[1],b=h[2];this.refTargets=d,this.selectorMap=m,b&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,B1e([R_e(Q1e)],e.prototype,"moveable",void 0),e})(te.PureComponent),d2e=(function(t){zx(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.defaultAbles=l2e,e})(f2e),Ku=63710088e-1,rJ={centimeters:Ku*100,centimetres:Ku*100,degrees:360/(2*Math.PI),feet:Ku*3.28084,inches:Ku*39.37,kilometers:Ku/1e3,kilometres:Ku/1e3,meters:Ku,metres:Ku,miles:Ku/1609.344,millimeters:Ku*1e3,millimetres:Ku*1e3,nauticalmiles:Ku/1852,radians:1,yards:Ku*1.0936};function ny(t,e,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function Gh(t,e,r={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!v7(t[0])||!v7(t[1]))throw new Error("coordinates must contain numbers");return ny({type:"Point",coordinates:t},e,r)}function h3(t,e,r={}){for(const i of t){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<i[i.length-1].length;a++)if(i[i.length-1][a]!==i[0][a])throw new Error("First and last Position are not equivalent.")}return ny({type:"Polygon",coordinates:t},e,r)}function Su(t,e,r={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return ny({type:"LineString",coordinates:t},e,r)}function Ep(t,e={}){const r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function p2e(t,e,r={}){return ny({type:"MultiLineString",coordinates:t},e,r)}function nJ(t,e="kilometers"){const r=rJ[e];if(!r)throw new Error(e+" units is invalid");return t*r}function rN(t,e="kilometers"){const r=rJ[e];if(!r)throw new Error(e+" units is invalid");return t/r}function g2e(t,e){return hE(rN(t,e))}function hE(t){return t%(2*Math.PI)*180/Math.PI}function bf(t){return t%360*Math.PI/180}function v7(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function nN(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function Pg(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function iJ(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Xb(t){return t.type==="Feature"?t.geometry:t}function aJ(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}function Yb(t,e,r={}){if(r.final===!0)return m2e(t,e);const n=Pg(t),i=Pg(e),a=bf(n[0]),s=bf(i[0]),o=bf(n[1]),c=bf(i[1]),h=Math.sin(s-a)*Math.cos(c),d=Math.cos(o)*Math.sin(c)-Math.sin(o)*Math.cos(c)*Math.cos(s-a);return hE(Math.atan2(h,d))}function m2e(t,e){let r=Yb(e,t);return r=(r+180)%360,r}function X0(t,e,r,n={}){const i=Pg(t),a=bf(i[0]),s=bf(i[1]),o=bf(r),c=rN(e,n.units),h=Math.asin(Math.sin(s)*Math.cos(c)+Math.cos(s)*Math.sin(c)*Math.cos(o)),d=a+Math.atan2(Math.sin(o)*Math.sin(c)*Math.cos(s),Math.cos(c)-Math.sin(s)*Math.sin(h)),m=hE(d),b=hE(h);return Gh([m,b],n.properties)}function f3(t,e,r={}){var n=Pg(t),i=Pg(e),a=bf(i[1]-n[1]),s=bf(i[0]-n[0]),o=bf(n[1]),c=bf(i[1]),h=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(o)*Math.cos(c);return nJ(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),r.units)}function y2e(t,e,r={}){const i=Xb(t).coordinates;let a=0;for(let s=0;s<i.length&&!(e>=a&&s===i.length-1);s++)if(a>=e){const o=e-a;if(o){const c=Yb(i[s],i[s-1])-180;return X0(i[s],o,c,r)}else return Gh(i[s])}else a+=f3(i[s],i[s+1],r);return Gh(i[i.length-1])}function y_(t,e,r){if(t!==null)for(var n,i,a,s,o,c,h,d=0,m=0,b,x=t.type,E=x==="FeatureCollection",T=x==="Feature",A=E?t.features.length:1,M=0;M<A;M++){h=E?t.features[M].geometry:T?t.geometry:t,b=h?h.type==="GeometryCollection":!1,o=b?h.geometries.length:1;for(var F=0;F<o;F++){var N=0,O=0;if(s=b?h.geometries[F]:h,s!==null){c=s.coordinates;var U=s.type;switch(d=r&&(U==="Polygon"||U==="MultiPolygon")?1:0,U){case null:break;case"Point":if(e(c,m,M,N,O)===!1)return!1;m++,N++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(e(c[n],m,M,N,O)===!1)return!1;m++,U==="MultiPoint"&&N++}U==="LineString"&&N++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(i=0;i<c[n].length-d;i++){if(e(c[n][i],m,M,N,O)===!1)return!1;m++}U==="MultiLineString"&&N++,U==="Polygon"&&O++}U==="Polygon"&&N++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(O=0,i=0;i<c[n].length;i++){for(a=0;a<c[n][i].length-d;a++){if(e(c[n][i][a],m,M,N,O)===!1)return!1;m++}O++}N++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(y_(s.geometries[n],e,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function _7(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var r=0;r<t.features.length&&e(t.features[r],r)!==!1;r++);}function d3(t,e){var r,n,i,a,s,o,c,h,d,m,b=0,x=t.type==="FeatureCollection",E=t.type==="Feature",T=x?t.features.length:1;for(r=0;r<T;r++){for(o=x?t.features[r].geometry:E?t.geometry:t,h=x?t.features[r].properties:E?t.properties:{},d=x?t.features[r].bbox:E?t.bbox:void 0,m=x?t.features[r].id:E?t.id:void 0,c=o?o.type==="GeometryCollection":!1,s=c?o.geometries.length:1,i=0;i<s;i++){if(a=c?o.geometries[i]:o,a===null){if(e(null,b,h,d,m)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,b,h,d,m)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(e(a.geometries[n],b,h,d,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}b++}}function v2e(t,e,r){var n=r;return d3(t,function(i,a,s,o,c){n=e(n,i,a,s,o,c)}),n}function iN(t,e){d3(t,function(r,n,i,a,s){var o=r===null?null:r.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return e(ny(r,i,{bbox:a,id:s}),n,0)===!1?!1:void 0}var c;switch(o){case"MultiPoint":c="Point";break;case"MultiLineString":c="LineString";break;case"MultiPolygon":c="Polygon";break}for(var h=0;h<r.coordinates.length;h++){var d=r.coordinates[h],m={type:c,coordinates:d};if(e(ny(m,i),n,h)===!1)return!1}})}function _2e(t,e){iN(t,function(r,n,i){var a=0;if(r.geometry){var s=r.geometry.type;if(!(s==="Point"||s==="MultiPoint")){var o,c=0,h=0,d=0;if(y_(r,function(m,b,x,E,T){if(o===void 0||n>c||E>h||T>d){o=m,c=n,h=E,d=T,a=0;return}var A=Su([o,m],r.properties);if(e(A,n,i,T,a)===!1)return!1;a++,o=m})===!1)return!1}}})}function b2e(t,e,r){var n=r,i=!1;return _2e(t,function(a,s,o,c,h){i===!1&&r===void 0?n=a:n=e(n,a,s,o,c,h),i=!0}),n}function x2e(t){return v2e(t,(e,r)=>e+w2e(r),0)}function w2e(t){let e=0,r;switch(t.type){case"Polygon":return b7(t.coordinates);case"MultiPolygon":for(r=0;r<t.coordinates.length;r++)e+=b7(t.coordinates[r]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function b7(t){let e=0;if(t&&t.length>0){e+=Math.abs(x7(t[0]));for(let r=1;r<t.length;r++)e-=Math.abs(x7(t[r]))}return e}var S2e=Ku*Ku/2,t5=Math.PI/180;function x7(t){const e=t.length-1;if(e<=2)return 0;let r=0,n=0;for(;n<e;){const i=t[n],a=t[n+1===e?0:n+1],s=t[n+2>=e?(n+2)%e:n+2],o=i[0]*t5,c=a[1]*t5,h=s[0]*t5;r+=(h-o)*Math.sin(c),n++}return r*S2e}function dh(t,e={}){if(t.bbox!=null&&e.recompute!==!0)return t.bbox;const r=[1/0,1/0,-1/0,-1/0];return y_(t,n=>{r[0]>n[0]&&(r[0]=n[0]),r[1]>n[1]&&(r[1]=n[1]),r[2]<n[0]&&(r[2]=n[0]),r[3]<n[1]&&(r[3]=n[1])}),r}function w7(t,e={}){const r=Number(t[0]),n=Number(t[1]),i=Number(t[2]),a=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const s=[r,n];return h3([[s,[i,n],[i,a],[r,a],s]],e.properties,{bbox:t,id:e.id})}const yp=11102230246251565e-32,Gu=134217729,E2e=(3+8*yp)*yp;function r5(t,e,r,n,i){let a,s,o,c,h=e[0],d=n[0],m=0,b=0;d>h==d>-h?(a=h,h=e[++m]):(a=d,d=n[++b]);let x=0;if(m<t&&b<r)for(d>h==d>-h?(s=h+a,o=a-(s-h),h=e[++m]):(s=d+a,o=a-(s-d),d=n[++b]),a=s,o!==0&&(i[x++]=o);m<t&&b<r;)d>h==d>-h?(s=a+h,c=s-a,o=a-(s-c)+(h-c),h=e[++m]):(s=a+d,c=s-a,o=a-(s-c)+(d-c),d=n[++b]),a=s,o!==0&&(i[x++]=o);for(;m<t;)s=a+h,c=s-a,o=a-(s-c)+(h-c),h=e[++m],a=s,o!==0&&(i[x++]=o);for(;b<r;)s=a+d,c=s-a,o=a-(s-c)+(d-c),d=n[++b],a=s,o!==0&&(i[x++]=o);return(a!==0||x===0)&&(i[x++]=a),x}function T2e(t,e){let r=e[0];for(let n=1;n<t;n++)r+=e[n];return r}function $x(t){return new Float64Array(t)}const C2e=(3+16*yp)*yp,A2e=(2+12*yp)*yp,I2e=(9+64*yp)*yp*yp,vv=$x(4),S7=$x(8),E7=$x(12),T7=$x(16),hc=$x(4);function P2e(t,e,r,n,i,a,s){let o,c,h,d,m,b,x,E,T,A,M,F,N,O,U,j,H,G;const X=t-i,ae=r-i,Q=e-a,W=n-a;O=X*W,b=Gu*X,x=b-(b-X),E=X-x,b=Gu*W,T=b-(b-W),A=W-T,U=E*A-(O-x*T-E*T-x*A),j=Q*ae,b=Gu*Q,x=b-(b-Q),E=Q-x,b=Gu*ae,T=b-(b-ae),A=ae-T,H=E*A-(j-x*T-E*T-x*A),M=U-H,m=U-M,vv[0]=U-(M+m)+(m-H),F=O+M,m=F-O,N=O-(F-m)+(M-m),M=N-j,m=N-M,vv[1]=N-(M+m)+(m-j),G=F+M,m=G-F,vv[2]=F-(G-m)+(M-m),vv[3]=G;let oe=T2e(4,vv),se=A2e*s;if(oe>=se||-oe>=se||(m=t-X,o=t-(X+m)+(m-i),m=r-ae,h=r-(ae+m)+(m-i),m=e-Q,c=e-(Q+m)+(m-a),m=n-W,d=n-(W+m)+(m-a),o===0&&c===0&&h===0&&d===0)||(se=I2e*s+E2e*Math.abs(oe),oe+=X*d+W*o-(Q*h+ae*c),oe>=se||-oe>=se))return oe;O=o*W,b=Gu*o,x=b-(b-o),E=o-x,b=Gu*W,T=b-(b-W),A=W-T,U=E*A-(O-x*T-E*T-x*A),j=c*ae,b=Gu*c,x=b-(b-c),E=c-x,b=Gu*ae,T=b-(b-ae),A=ae-T,H=E*A-(j-x*T-E*T-x*A),M=U-H,m=U-M,hc[0]=U-(M+m)+(m-H),F=O+M,m=F-O,N=O-(F-m)+(M-m),M=N-j,m=N-M,hc[1]=N-(M+m)+(m-j),G=F+M,m=G-F,hc[2]=F-(G-m)+(M-m),hc[3]=G;const he=r5(4,vv,4,hc,S7);O=X*d,b=Gu*X,x=b-(b-X),E=X-x,b=Gu*d,T=b-(b-d),A=d-T,U=E*A-(O-x*T-E*T-x*A),j=Q*h,b=Gu*Q,x=b-(b-Q),E=Q-x,b=Gu*h,T=b-(b-h),A=h-T,H=E*A-(j-x*T-E*T-x*A),M=U-H,m=U-M,hc[0]=U-(M+m)+(m-H),F=O+M,m=F-O,N=O-(F-m)+(M-m),M=N-j,m=N-M,hc[1]=N-(M+m)+(m-j),G=F+M,m=G-F,hc[2]=F-(G-m)+(M-m),hc[3]=G;const _e=r5(he,S7,4,hc,E7);O=o*d,b=Gu*o,x=b-(b-o),E=o-x,b=Gu*d,T=b-(b-d),A=d-T,U=E*A-(O-x*T-E*T-x*A),j=c*h,b=Gu*c,x=b-(b-c),E=c-x,b=Gu*h,T=b-(b-h),A=h-T,H=E*A-(j-x*T-E*T-x*A),M=U-H,m=U-M,hc[0]=U-(M+m)+(m-H),F=O+M,m=F-O,N=O-(F-m)+(M-m),M=N-j,m=N-M,hc[1]=N-(M+m)+(m-j),G=F+M,m=G-F,hc[2]=F-(G-m)+(M-m),hc[3]=G;const Ce=r5(_e,E7,4,hc,T7);return T7[Ce-1]}function k2e(t,e,r,n,i,a){const s=(e-a)*(r-i),o=(t-i)*(n-a),c=s-o,h=Math.abs(s+o);return Math.abs(c)>=C2e*h?c:-P2e(t,e,r,n,i,a,h)}function R2e(t,e){var r,n,i=0,a,s,o,c,h,d,m,b=t[0],x=t[1],E=e.length;for(r=0;r<E;r++){n=0;var T=e[r],A=T.length-1;if(d=T[0],d[0]!==T[A][0]&&d[1]!==T[A][1])throw new Error("First and last coordinates in a ring must be the same");for(s=d[0]-b,o=d[1]-x,n;n<A;n++){if(m=T[n+1],c=m[0]-b,h=m[1]-x,o===0&&h===0){if(c<=0&&s>=0||s<=0&&c>=0)return 0}else if(h>=0&&o<=0||h<=0&&o>=0){if(a=k2e(s,c,o,h,0,0),a===0)return 0;(a>0&&h>0&&o<=0||a<0&&h<=0&&o>0)&&i++}d=m,o=h,s=c}}return i%2!==0}function p3(t,e,r={}){if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");const n=Pg(t),i=Xb(e),a=i.type,s=e.bbox;let o=i.coordinates;if(s&&M2e(n,s)===!1)return!1;a==="Polygon"&&(o=[o]);let c=!1;for(var h=0;h<o.length;++h){const d=R2e(n,o[h]);if(d===0)return!r.ignoreBoundary;d&&(c=!0)}return c}function M2e(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}function Zb(t,e,r={}){const n=Pg(t),i=iJ(e);for(let a=0;a<i.length-1;a++){let s=!1;if(r.ignoreEndVertices&&(a===0&&(s="start"),a===i.length-2&&(s="end"),a===0&&a+1===i.length-1&&(s="both")),D2e(i[a],i[a+1],n,s,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}function D2e(t,e,r,n,i){const a=r[0],s=r[1],o=t[0],c=t[1],h=e[0],d=e[1],m=r[0]-o,b=r[1]-c,x=h-o,E=d-c,T=m*E-b*x;if(i!==null){if(Math.abs(T)>i)return!1}else if(T!==0)return!1;if(Math.abs(x)===Math.abs(E)&&Math.abs(x)===0)return n?!1:r[0]===t[0]&&r[1]===t[1];if(n){if(n==="start")return Math.abs(x)>=Math.abs(E)?x>0?o<a&&a<=h:h<=a&&a<o:E>0?c<s&&s<=d:d<=s&&s<c;if(n==="end")return Math.abs(x)>=Math.abs(E)?x>0?o<=a&&a<h:h<a&&a<=o:E>0?c<=s&&s<d:d<s&&s<=c;if(n==="both")return Math.abs(x)>=Math.abs(E)?x>0?o<a&&a<h:h<a&&a<o:E>0?c<s&&s<d:d<s&&s<c}else return Math.abs(x)>=Math.abs(E)?x>0?o<=a&&a<=h:h<=a&&a<=o:E>0?c<=s&&s<=d:d<=s&&s<=c;return!1}function O2e(t,e){const r=Xb(t),n=Xb(e),i=r.type,a=n.type,s=r.coordinates,o=n.coordinates;switch(i){case"Point":switch(a){case"Point":return aN(s,o);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPoint":switch(a){case"Point":return L2e(r,n);case"MultiPoint":return F2e(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"LineString":switch(a){case"Point":return Zb(n,r,{ignoreEndVertices:!0});case"LineString":return j2e(r,n);case"MultiPoint":return B2e(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"Polygon":switch(a){case"Point":return p3(n,r,{ignoreBoundary:!0});case"LineString":return U2e(r,n);case"Polygon":return oJ(r,n);case"MultiPoint":return z2e(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPolygon":switch(a){case"Polygon":return N2e(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function N2e(t,e){return t.coordinates.some(r=>oJ({type:"Polygon",coordinates:r},e))}function L2e(t,e){let r,n=!1;for(r=0;r<t.coordinates.length;r++)if(aN(t.coordinates[r],e.coordinates)){n=!0;break}return n}function F2e(t,e){for(const r of e.coordinates){let n=!1;for(const i of t.coordinates)if(aN(r,i)){n=!0;break}if(!n)return!1}return!0}function B2e(t,e){let r=!1;for(const n of e.coordinates)if(Zb(n,t,{ignoreEndVertices:!0})&&(r=!0),!Zb(n,t))return!1;return!!r}function z2e(t,e){for(const r of e.coordinates)if(!p3(r,t,{ignoreBoundary:!0}))return!1;return!0}function j2e(t,e){let r=!1;for(const n of e.coordinates)if(Zb({type:"Point",coordinates:n},t,{ignoreEndVertices:!0})&&(r=!0),!Zb({type:"Point",coordinates:n},t,{ignoreEndVertices:!1}))return!1;return r}function U2e(t,e){let r=!1,n=0;const i=dh(t),a=dh(e);if(!sJ(i,a))return!1;for(n;n<e.coordinates.length-1;n++){const s=V2e(e.coordinates[n],e.coordinates[n+1]);if(p3({type:"Point",coordinates:s},t,{ignoreBoundary:!0})){r=!0;break}}return r}function oJ(t,e){if(t.type==="Feature"&&t.geometry===null||e.type==="Feature"&&e.geometry===null)return!1;const r=dh(t),n=dh(e);if(!sJ(r,n))return!1;const i=Xb(e).coordinates;for(const a of i)for(const s of a)if(!p3(s,t))return!1;return!0}function sJ(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function aN(t,e){return t[0]===e[0]&&t[1]===e[1]}function V2e(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function $2e(t,e={}){const r=dh(t),n=(r[0]+r[2])/2,i=(r[1]+r[3])/2;return Gh([n,i],e.properties,e)}var yS={exports:{}},q2e=yS.exports,C7;function H2e(){return C7||(C7=1,(function(t,e){(function(r,n){t.exports=n()})(q2e,(function(){function r(I,y){(y==null||y>I.length)&&(y=I.length);for(var _=0,P=Array(y);_<y;_++)P[_]=I[_];return P}function n(I,y,_){return y=d(y),(function(P,$){if($&&(typeof $=="object"||typeof $=="function"))return $;if($!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(ne){if(ne===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne})(P)})(I,b()?Reflect.construct(y,_||[],d(I).constructor):y.apply(I,_))}function i(I,y){if(!(I instanceof y))throw new TypeError("Cannot call a class as a function")}function a(I,y,_){if(b())return Reflect.construct.apply(null,arguments);var P=[null];P.push.apply(P,y);var $=new(I.bind.apply(I,P));return _&&x($,_.prototype),$}function s(I,y){for(var _=0;_<y.length;_++){var P=y[_];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(I,A(P.key),P)}}function o(I,y,_){return y&&s(I.prototype,y),_&&s(I,_),Object.defineProperty(I,"prototype",{writable:!1}),I}function c(I,y){var _=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!_){if(Array.isArray(I)||(_=M(I))||y){_&&(I=_);var P=0,$=function(){};return{s:$,n:function(){return P>=I.length?{done:!0}:{done:!1,value:I[P++]}},e:function(tt){throw tt},f:$}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ne,ye=!0,Oe=!1;return{s:function(){_=_.call(I)},n:function(){var tt=_.next();return ye=tt.done,tt},e:function(tt){Oe=!0,ne=tt},f:function(){try{ye||_.return==null||_.return()}finally{if(Oe)throw ne}}}}function h(){return h=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(I,y,_){var P=(function(ne,ye){for(;!{}.hasOwnProperty.call(ne,ye)&&(ne=d(ne))!==null;);return ne})(I,y);if(P){var $=Object.getOwnPropertyDescriptor(P,y);return $.get?$.get.call(arguments.length<3?I:_):$.value}},h.apply(null,arguments)}function d(I){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(y){return y.__proto__||Object.getPrototypeOf(y)},d(I)}function m(I,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");I.prototype=Object.create(y&&y.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),Object.defineProperty(I,"prototype",{writable:!1}),y&&x(I,y)}function b(){try{var I=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(b=function(){return!!I})()}function x(I,y){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,P){return _.__proto__=P,_},x(I,y)}function E(I,y,_,P){var $=h(d(1&P?I.prototype:I),y,_);return 2&P&&typeof $=="function"?function(ne){return $.apply(_,ne)}:$}function T(I){return(function(y){if(Array.isArray(y))return r(y)})(I)||(function(y){if(typeof Symbol<"u"&&y[Symbol.iterator]!=null||y["@@iterator"]!=null)return Array.from(y)})(I)||M(I)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function A(I){var y=(function(_,P){if(typeof _!="object"||!_)return _;var $=_[Symbol.toPrimitive];if($!==void 0){var ne=$.call(_,P);if(typeof ne!="object")return ne;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)})(I,"string");return typeof y=="symbol"?y:y+""}function M(I,y){if(I){if(typeof I=="string")return r(I,y);var _={}.toString.call(I).slice(8,-1);return _==="Object"&&I.constructor&&(_=I.constructor.name),_==="Map"||_==="Set"?Array.from(I):_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?r(I,y):void 0}}function F(I){var y=typeof Map=="function"?new Map:void 0;return F=function(_){if(_===null||!(function($){try{return Function.toString.call($).indexOf("[native code]")!==-1}catch{return typeof $=="function"}})(_))return _;if(typeof _!="function")throw new TypeError("Super expression must either be null or a function");if(y!==void 0){if(y.has(_))return y.get(_);y.set(_,P)}function P(){return a(_,arguments,d(this).constructor)}return P.prototype=Object.create(_.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),x(P,_)},F(I)}var N=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(y){this._quadrantSegments=y,this._quadrantSegments===0&&(this._joinStyle=I.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=I.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),y<=0&&(this._quadrantSegments=1),this._joinStyle!==I.JOIN_ROUND&&(this._quadrantSegments=I.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(y){this._joinStyle=y}},{key:"setSimplifyFactor",value:function(y){this._simplifyFactor=y<0?0:y}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(y){this._endCapStyle=y}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(y){this._mitreLimit=y}},{key:"setSingleSided",value:function(y){this._isSingleSided=y}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=I.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=I.CAP_ROUND,this._joinStyle=I.JOIN_ROUND,this._mitreLimit=I.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=I.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var y=arguments[0];this.setQuadrantSegments(y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.setQuadrantSegments(_),this.setEndCapStyle(P)}else if(arguments.length===4){var $=arguments[0],ne=arguments[1],ye=arguments[2],Oe=arguments[3];this.setQuadrantSegments($),this.setEndCapStyle(ne),this.setJoinStyle(ye),this.setMitreLimit(Oe)}}}},{key:"bufferDistanceError",value:function(y){var _=Math.PI/2/y;return 1-Math.cos(_/2)}}])})();N.CAP_ROUND=1,N.CAP_FLAT=2,N.CAP_SQUARE=3,N.JOIN_ROUND=1,N.JOIN_MITRE=2,N.JOIN_BEVEL=3,N.DEFAULT_QUADRANT_SEGMENTS=8,N.DEFAULT_MITRE_LIMIT=5,N.DEFAULT_SIMPLIFY_FACTOR=.01;var O=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({Exception:y})[0],P}return m(y,I),o(y,[{key:"toString",value:function(){return this.message}}])})(F(Error)),U=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({IllegalArgumentException:y})[0],P}return m(y,I),o(y)})(O),j=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I){}}])})();function H(){}function G(){}function X(){}var ae,Q,W,oe,se,he,_e,Ce,me=(function(){return o((function I(){i(this,I)}),null,[{key:"equalsWithTolerance",value:function(I,y,_){return Math.abs(I-y)<=_}}])})(),xe=(function(){return o((function I(y,_){i(this,I),this.low=_||0,this.high=y||0}),null,[{key:"toBinaryString",value:function(I){var y,_="";for(y=2147483648;y>0;y>>>=1)_+=(I.high&y)===y?"1":"0";for(y=2147483648;y>0;y>>>=1)_+=(I.low&y)===y?"1":"0";return _}}])})();function Ae(){}function De(){}Ae.NaN=NaN,Ae.isNaN=function(I){return Number.isNaN(I)},Ae.isInfinite=function(I){return!Number.isFinite(I)},Ae.MAX_VALUE=Number.MAX_VALUE,Ae.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Ae.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(he=2146435072,_e=new Float64Array(1),Ce=new Int32Array(_e.buffer),Ae.doubleToLongBits=function(I){_e[0]=I;var y=0|Ce[0],_=0|Ce[1];return(_&he)===he&&1048575&_&&y!==0&&(y=0,_=2146959360),new xe(_,y)},Ae.longBitsToDouble=function(I){return Ce[0]=I.low,Ce[1]=I.high,_e[0]}):(ae=1023,Q=Math.log2,W=Math.floor,oe=Math.pow,se=(function(){for(var I=53;I>0;I--){var y=oe(2,I)-1;if(W(Q(y))+1===I)return y}return 0})(),Ae.doubleToLongBits=function(I){var y,_,P,$,ne,ye,Oe,tt,ht;if(I<0||1/I===Number.NEGATIVE_INFINITY?(ye=1<<31,I=-I):ye=0,I===0)return new xe(tt=ye,ht=0);if(I===1/0)return new xe(tt=2146435072|ye,ht=0);if(I!=I)return new xe(tt=2146959360,ht=0);if($=0,ht=0,(y=W(I))>1)if(y<=se)($=W(Q(y)))<=20?(ht=0,tt=y<<20-$&1048575):(ht=y%(_=oe(2,P=$-20))<<32-P,tt=y/_&1048575);else for(P=y,ht=0;(P=W(_=P/2))!==0;)$++,ht>>>=1,ht|=(1&tt)<<31,tt>>>=1,_!==P&&(tt|=524288);if(Oe=$+ae,ne=y===0,y=I-y,$<52&&y!==0)for(P=0;;){if((_=2*y)>=1?(y=_-1,ne?(Oe--,ne=!1):(P<<=1,P|=1,$++)):(y=_,ne?--Oe==0&&($++,ne=!1):(P<<=1,$++)),$===20)tt|=P,P=0;else if($===52){ht|=P;break}if(_===1){$<20?tt|=P<<20-$:$<52&&(ht|=P<<52-$);break}}return tt|=Oe<<20,new xe(tt|=ye,ht)},Ae.longBitsToDouble=function(I){var y,_,P,$,ne=I.high,ye=I.low,Oe=ne&1<<31?-1:1;for(P=((2146435072&ne)>>20)-ae,$=0,_=1<<19,y=1;y<=20;y++)ne&_&&($+=oe(2,-y)),_>>>=1;for(_=1<<31,y=21;y<=52;y++)ye&_&&($+=oe(2,-y)),_>>>=1;if(P===-1023){if($===0)return 0*Oe;P=-1022}else{if(P===1024)return $===0?Oe/0:NaN;$+=1}return Oe*$*oe(2,P)});var de=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({RuntimeException:y})[0],P}return m(y,I),o(y)})(O),Ee=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,null,[{key:"constructor_",value:function(){if(arguments.length===0)de.constructor_.call(this);else if(arguments.length===1){var _=arguments[0];de.constructor_.call(this,_)}}}])})(de),we=(function(){function I(){i(this,I)}return o(I,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)I.shouldNeverReachHere(null);else if(arguments.length===1){var y=arguments[0];throw new Ee("Should never reach here"+(y!==null?": "+y:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var y=arguments[0];I.isTrue(y,null)}else if(arguments.length===2){var _=arguments[1];if(!arguments[0])throw _===null?new Ee:new Ee(_)}}},{key:"equals",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];I.equals(y,_,null)}else if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2];if(!$.equals(P))throw new Ee("Expected "+P+" but encountered "+$+(ne!==null?": "+ne:""))}}}])})(),Le=new ArrayBuffer(8),Fe=new Float64Array(Le),Xe=new Int32Array(Le),Be=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getM",value:function(){return Ae.NaN}},{key:"setOrdinate",value:function(y,_){switch(y){case I.X:this.x=_;break;case I.Y:this.y=_;break;case I.Z:this.setZ(_);break;default:throw new U("Invalid ordinate index: "+y)}}},{key:"equals2D",value:function(){if(arguments.length===1){var y=arguments[0];return this.x===y.x&&this.y===y.y}if(arguments.length===2){var _=arguments[0],P=arguments[1];return!!me.equalsWithTolerance(this.x,_.x,P)&&!!me.equalsWithTolerance(this.y,_.y,P)}}},{key:"setM",value:function(y){throw new U("Invalid ordinate index: "+I.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(y){switch(y){case I.X:return this.x;case I.Y:return this.y;case I.Z:return this.getZ()}throw new U("Invalid ordinate index: "+y)}},{key:"equals3D",value:function(y){return this.x===y.x&&this.y===y.y&&(this.getZ()===y.getZ()||Ae.isNaN(this.getZ())&&Ae.isNaN(y.getZ()))}},{key:"equals",value:function(y){return y instanceof I&&this.equals2D(y)}},{key:"equalInZ",value:function(y,_){return me.equalsWithTolerance(this.getZ(),y.getZ(),_)}},{key:"setX",value:function(y){this.x=y}},{key:"compareTo",value:function(y){var _=y;return this.x<_.x?-1:this.x>_.x?1:this.y<_.y?-1:this.y>_.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(y){this.z=y}},{key:"clone",value:function(){try{return null}catch(y){if(y instanceof CloneNotSupportedException)return we.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw y}}},{key:"copy",value:function(){return new I(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(y){var _=this.x-y.x,P=this.y-y.y,$=this.getZ()-y.getZ();return Math.sqrt(_*_+P*P+$*$)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(y){this.y=y}},{key:"distance",value:function(y){var _=this.x-y.x,P=this.y-y.y;return Math.sqrt(_*_+P*P)}},{key:"hashCode",value:function(){var y=17;return y=37*(y=37*y+I.hashCode(this.x))+I.hashCode(this.y)}},{key:"setCoordinate",value:function(y){this.x=y.x,this.y=y.y,this.z=y.getZ()}},{key:"interfaces_",get:function(){return[H,G,X]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)I.constructor_.call(this,0,0);else if(arguments.length===1){var y=arguments[0];I.constructor_.call(this,y.x,y.y,y.getZ())}else if(arguments.length===2){var _=arguments[0],P=arguments[1];I.constructor_.call(this,_,P,I.NULL_ORDINATE)}else if(arguments.length===3){var $=arguments[0],ne=arguments[1],ye=arguments[2];this.x=$,this.y=ne,this.z=ye}}},{key:"hashCode",value:function(y){return Fe[0]=y,Xe[0]^Xe[1]}}])})(),ot=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"compare",value:function(y,_){var P=I.compare(y.x,_.x);if(P!==0)return P;var $=I.compare(y.y,_.y);return $!==0?$:this._dimensionsToTest<=2?0:I.compare(y.getZ(),_.getZ())}},{key:"interfaces_",get:function(){return[De]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)I.constructor_.call(this,2);else if(arguments.length===1){var y=arguments[0];if(y!==2&&y!==3)throw new U("only 2 or 3 dimensions may be specified");this._dimensionsToTest=y}}},{key:"compare",value:function(y,_){return y<_?-1:y>_?1:Ae.isNaN(y)?Ae.isNaN(_)?0:-1:Ae.isNaN(_)?1:0}}])})();Be.DimensionalComparator=ot,Be.NULL_ORDINATE=Ae.NaN,Be.X=0,Be.Y=1,Be.Z=2,Be.M=3;var Qe=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(y){if(!(y instanceof I))return!1;var _=y;return this.isNull()?_.isNull():this._maxx===_.getMaxX()&&this._maxy===_.getMaxY()&&this._minx===_.getMinX()&&this._miny===_.getMinY()}},{key:"intersection",value:function(y){if(this.isNull()||y.isNull()||!this.intersects(y))return new I;var _=this._minx>y._minx?this._minx:y._minx,P=this._miny>y._miny?this._miny:y._miny;return new I(_,this._maxx<y._maxx?this._maxx:y._maxx,P,this._maxy<y._maxy?this._maxy:y._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];return this.covers(y.x,y.y)}if(arguments[0]instanceof I){var _=arguments[0];return!this.isNull()&&!_.isNull()&&_.getMinX()>=this._minx&&_.getMaxX()<=this._maxx&&_.getMinY()>=this._miny&&_.getMaxY()<=this._maxy}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];return!this.isNull()&&P>=this._minx&&P<=this._maxx&&$>=this._miny&&$<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return!this.isNull()&&!y.isNull()&&!(y._minx>this._maxx||y._maxx<this._minx||y._miny>this._maxy||y._maxy<this._miny)}if(arguments[0]instanceof Be){var _=arguments[0];return this.intersects(_.x,_.y)}}else if(arguments.length===2){if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var P=arguments[0],$=arguments[1];return!this.isNull()&&!((P.x<$.x?P.x:$.x)>this._maxx)&&!((P.x>$.x?P.x:$.x)<this._minx)&&!((P.y<$.y?P.y:$.y)>this._maxy)&&!((P.y>$.y?P.y:$.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var ne=arguments[0],ye=arguments[1];return!this.isNull()&&!(ne>this._maxx||ne<this._minx||ye>this._maxy||ye<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return Math.sqrt(y*y+_*_)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];this.expandToInclude(y.x,y.y)}else if(arguments[0]instanceof I){var _=arguments[0];if(_.isNull())return null;this.isNull()?(this._minx=_.getMinX(),this._maxx=_.getMaxX(),this._miny=_.getMinY(),this._maxy=_.getMaxY()):(_._minx<this._minx&&(this._minx=_._minx),_._maxx>this._maxx&&(this._maxx=_._maxx),_._miny<this._miny&&(this._miny=_._miny),_._maxy>this._maxy&&(this._maxy=_._maxy))}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.isNull()?(this._minx=P,this._maxx=P,this._miny=$,this._maxy=$):(P<this._minx&&(this._minx=P),P>this._maxx&&(this._maxx=P),$<this._miny&&(this._miny=$),$>this._maxy&&(this._maxy=$))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return y<_?y:_}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(y){var _=y;return this.isNull()?_.isNull()?0:-1:_.isNull()?1:this._minx<_._minx?-1:this._minx>_._minx?1:this._miny<_._miny?-1:this._miny>_._miny?1:this._maxx<_._maxx?-1:this._maxx>_._maxx?1:this._maxy<_._maxy?-1:this._maxy>_._maxy?1:0}},{key:"translate",value:function(y,_){if(this.isNull())return null;this.init(this.getMinX()+y,this.getMaxX()+y,this.getMinY()+_,this.getMaxY()+_)}},{key:"copy",value:function(){return new I(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(y){return!(!this.isNull()&&!y.isNull())||y._minx>this._maxx||y._maxx<this._minx||y._miny>this._maxy||y._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return y>_?y:_}},{key:"expandBy",value:function(){if(arguments.length===1){var y=arguments[0];this.expandBy(y,y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];if(this.isNull())return null;this._minx-=_,this._maxx+=_,this._miny-=P,this._maxy+=P,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.covers(y)}if(arguments[0]instanceof Be){var _=arguments[0];return this.covers(_)}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];return this.covers(P,$)}}},{key:"centre",value:function(){return this.isNull()?null:new Be((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];this.init(y.x,y.x,y.y,y.y)}else if(arguments[0]instanceof I){var _=arguments[0];this._minx=_._minx,this._maxx=_._maxx,this._miny=_._miny,this._maxy=_._maxy}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.init(P.x,$.x,P.y,$.y)}else if(arguments.length===4){var ne=arguments[0],ye=arguments[1],Oe=arguments[2],tt=arguments[3];ne<ye?(this._minx=ne,this._maxx=ye):(this._minx=ye,this._maxx=ne),Oe<tt?(this._miny=Oe,this._maxy=tt):(this._miny=tt,this._maxy=Oe)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(y){if(this.intersects(y))return 0;var _=0;this._maxx<y._minx?_=y._minx-this._maxx:this._minx>y._maxx&&(_=this._minx-y._maxx);var P=0;return this._maxy<y._miny?P=y._miny-this._maxy:this._miny>y._maxy&&(P=this._miny-y._maxy),_===0?P:P===0?_:Math.sqrt(_*_+P*P)}},{key:"hashCode",value:function(){var y=17;return y=37*(y=37*(y=37*(y=37*y+Be.hashCode(this._minx))+Be.hashCode(this._maxx))+Be.hashCode(this._miny))+Be.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[H,X]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];this.init(y.x,y.x,y.y,y.y)}else if(arguments[0]instanceof I){var _=arguments[0];this.init(_)}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.init(P.x,$.x,P.y,$.y)}else if(arguments.length===4){var ne=arguments[0],ye=arguments[1],Oe=arguments[2],tt=arguments[3];this.init(ne,ye,Oe,tt)}}},{key:"intersects",value:function(){if(arguments.length===3){var y=arguments[0],_=arguments[1],P=arguments[2];return P.x>=(y.x<_.x?y.x:_.x)&&P.x<=(y.x>_.x?y.x:_.x)&&P.y>=(y.y<_.y?y.y:_.y)&&P.y<=(y.y>_.y?y.y:_.y)}if(arguments.length===4){var $=arguments[0],ne=arguments[1],ye=arguments[2],Oe=arguments[3],tt=Math.min(ye.x,Oe.x),ht=Math.max(ye.x,Oe.x),rr=Math.min($.x,ne.x),ur=Math.max($.x,ne.x);return!(rr>ht)&&!(ur<tt)&&(tt=Math.min(ye.y,Oe.y),ht=Math.max(ye.y,Oe.y),rr=Math.min($.y,ne.y),ur=Math.max($.y,ne.y),!(rr>ht)&&!(ur<tt))}}}])})(),rt=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===I.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(y){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(y){return this===y||this.equalsExact(y,0)}},{key:"geometryChanged",value:function(){this.apply(I.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(y){return y!==null&&this.norm().equalsExact(y.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var y;if(arguments.length===1){var _=arguments[0];return y=_,this.getTypeCode()!==y.getTypeCode()?this.getTypeCode()-y.getTypeCode():this.isEmpty()&&y.isEmpty()?0:this.isEmpty()?-1:y.isEmpty()?1:this.compareToSameClass(_)}if(arguments.length===2){var P=arguments[0],$=arguments[1];return y=P,this.getTypeCode()!==y.getTypeCode()?this.getTypeCode()-y.getTypeCode():this.isEmpty()&&y.isEmpty()?0:this.isEmpty()?-1:y.isEmpty()?1:this.compareToSameClass(P,$)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(y){if(y.getTypeCode()===I.TYPECODE_GEOMETRYCOLLECTION)throw new U("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(y,_,P){return P===0?y.equals(_):y.distance(_)<=P}},{key:"norm",value:function(){var y=this.copy();return y.normalize(),y}},{key:"reverse",value:function(){var y=this.reverseInternal();return this.envelope!=null&&(y.envelope=this.envelope.copy()),y.setSRID(this.getSRID()),y}},{key:"copy",value:function(){var y=this.copyInternal();return y.envelope=this._envelope==null?null:this._envelope.copy(),y._SRID=this._SRID,y._userData=this._userData,y}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Qe(this._envelope)}},{key:"setSRID",value:function(y){this._SRID=y}},{key:"setUserData",value:function(y){this._userData=y}},{key:"compare",value:function(y,_){for(var P=y.iterator(),$=_.iterator();P.hasNext()&&$.hasNext();){var ne=P.next(),ye=$.next(),Oe=ne.compareTo(ye);if(Oe!==0)return Oe}return P.hasNext()?1:$.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(y){return this.getClass()===y.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===I.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===I.TYPECODE_MULTIPOINT||this.getTypeCode()===I.TYPECODE_MULTILINESTRING||this.getTypeCode()===I.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[G,H,X]}},{key:"getClass",value:function(){return I}}],[{key:"hasNonEmptyElements",value:function(y){for(var _=0;_<y.length;_++)if(!y[_].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(y){for(var _=0;_<y.length;_++)if(y[_]===null)return!0;return!1}}])})();rt.constructor_=function(I){I&&(this._envelope=null,this._userData=null,this._factory=I,this._SRID=I.getSRID())},rt.TYPECODE_POINT=0,rt.TYPECODE_MULTIPOINT=1,rt.TYPECODE_LINESTRING=2,rt.TYPECODE_LINEARRING=3,rt.TYPECODE_MULTILINESTRING=4,rt.TYPECODE_POLYGON=5,rt.TYPECODE_MULTIPOLYGON=6,rt.TYPECODE_GEOMETRYCOLLECTION=7,rt.TYPENAME_POINT="Point",rt.TYPENAME_MULTIPOINT="MultiPoint",rt.TYPENAME_LINESTRING="LineString",rt.TYPENAME_LINEARRING="LinearRing",rt.TYPENAME_MULTILINESTRING="MultiLineString",rt.TYPENAME_POLYGON="Polygon",rt.TYPENAME_MULTIPOLYGON="MultiPolygon",rt.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",rt.geometryChangedFilter={get interfaces_(){return[j]},filter:function(I){I.geometryChangedAction()}};var Re=(function(){function I(){i(this,I)}return o(I,null,[{key:"toLocationSymbol",value:function(y){switch(y){case I.EXTERIOR:return"e";case I.BOUNDARY:return"b";case I.INTERIOR:return"i";case I.NONE:return"-"}throw new U("Unknown location value: "+y)}}])})();Re.INTERIOR=0,Re.BOUNDARY=1,Re.EXTERIOR=2,Re.NONE=-1;var zt=(function(){return o((function I(){i(this,I)}),[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])})(),st=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({NoSuchElementException:y})[0],P}return m(y,I),o(y)})(O),$e=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({UnsupportedOperationException:y})[0],P}return m(y,I),o(y)})(O),Jt=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y,[{key:"contains",value:function(){}}])})(zt),Ht=(function(I){function y(_){var P;return i(this,y),(P=n(this,y)).map=new Map,_ instanceof zt&&P.addAll(_),P}return m(y,I),o(y,[{key:"contains",value:function(_){var P=_.hashCode?_.hashCode():_;return!!this.map.has(P)}},{key:"add",value:function(_){var P=_.hashCode?_.hashCode():_;return!this.map.has(P)&&!!this.map.set(P,_)}},{key:"addAll",value:function(_){var P,$=c(_);try{for($.s();!(P=$.n()).done;){var ne=P.value;this.add(ne)}}catch(ye){$.e(ye)}finally{$.f()}return!0}},{key:"remove",value:function(){throw new $e}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new pr(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])})(Jt),pr=(function(){return o((function I(y){i(this,I),this.iterator=y.values();var _=this.iterator.next(),P=_.done,$=_.value;this.done=P,this.value=$}),[{key:"next",value:function(){if(this.done)throw new st;var I=this.value,y=this.iterator.next(),_=y.done,P=y.value;return this.done=_,this.value=P,I}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new $e}}])})(),_t=(function(){function I(){i(this,I)}return o(I,null,[{key:"opposite",value:function(y){return y===I.LEFT?I.RIGHT:y===I.RIGHT?I.LEFT:y}}])})();_t.ON=0,_t.LEFT=1,_t.RIGHT=2;var vr=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({EmptyStackException:y})[0],P}return m(y,I),o(y)})(O),br=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({IndexOutOfBoundsException:y})[0],P}return m(y,I),o(y)})(O),lr=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])})(zt),Cr=(function(I){function y(){var _;return i(this,y),(_=n(this,y)).array=[],_}return m(y,I),o(y,[{key:"add",value:function(_){return this.array.push(_),!0}},{key:"get",value:function(_){if(_<0||_>=this.size())throw new br;return this.array[_]}},{key:"push",value:function(_){return this.array.push(_),_}},{key:"pop",value:function(){if(this.array.length===0)throw new vr;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new vr;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(_){return this.array.indexOf(_)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])})(lr);function Tr(I,y){return I.interfaces_&&I.interfaces_.indexOf(y)>-1}var Qt=(function(){return o((function I(y){i(this,I),this.str=y}),[{key:"append",value:function(I){this.str+=I}},{key:"setCharAt",value:function(I,y){this.str=this.str.substr(0,I)+y+this.str.substr(I+1)}},{key:"toString",value:function(){return this.str}}])})(),at=(function(){function I(y){i(this,I),this.value=y}return o(I,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(y){return this.value<y?-1:this.value>y?1:0}}],[{key:"compare",value:function(y,_){return y<_?-1:y>_?1:0}},{key:"isNan",value:function(y){return Number.isNaN(y)}},{key:"valueOf",value:function(y){return new I(y)}}])})(),ke=(function(){return o((function I(){i(this,I)}),null,[{key:"isWhitespace",value:function(I){return I<=32&&I>=0||I===127}},{key:"toUpperCase",value:function(I){return I.toUpperCase()}}])})(),be=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"le",value:function(y){return this._hi<y._hi||this._hi===y._hi&&this._lo<=y._lo}},{key:"extractSignificantDigits",value:function(y,_){var P=this.abs(),$=I.magnitude(P._hi),ne=I.TEN.pow($);(P=P.divide(ne)).gt(I.TEN)?(P=P.divide(I.TEN),$+=1):P.lt(I.ONE)&&(P=P.multiply(I.TEN),$-=1);for(var ye=$+1,Oe=new Qt,tt=I.MAX_PRINT_DIGITS-1,ht=0;ht<=tt;ht++){y&&ht===ye&&Oe.append(".");var rr=Math.trunc(P._hi);if(rr<0)break;var ur=!1,qr=0;rr>9?(ur=!0,qr="9"):qr="0"+rr,Oe.append(qr),P=P.subtract(I.valueOf(rr)).multiply(I.TEN),ur&&P.selfAdd(I.TEN);var bn=!0,Dn=I.magnitude(P._hi);if(Dn<0&&Math.abs(Dn)>=tt-ht&&(bn=!1),!bn)break}return _[0]=$,Oe.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return this.add(y.negate())}if(typeof arguments[0]=="number"){var _=arguments[0];return this.add(-_)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof I){var y=arguments[0];return this._hi===y._hi&&this._lo===y._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return this.isNaN()?this:this.selfAdd(-y._hi,-y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.isNaN()?this:this.selfAdd(-_,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(y){return this.le(y)?this:y}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.selfDivide(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.selfDivide(_,0)}}else if(arguments.length===2){var P,$,ne,ye,Oe=arguments[0],tt=arguments[1],ht=null,rr=null,ur=null,qr=null;return ne=this._hi/Oe,qr=(ht=(ur=I.SPLIT*ne)-(ht=ur-ne))*(rr=(qr=I.SPLIT*Oe)-(rr=qr-Oe))-(ye=ne*Oe)+ht*($=Oe-rr)+(P=ne-ht)*rr+P*$,qr=ne+(ur=(this._hi-ye-qr+this._lo-ne*tt)/Oe),this._hi=qr,this._lo=ne-qr+ur,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof I){var y,_,P,$,ne=arguments[0],ye=null,Oe=null,tt=null,ht=null;return y=(P=this._hi/ne._hi)-(ye=(tt=I.SPLIT*P)-(ye=tt-P)),ht=ye*(Oe=(ht=I.SPLIT*ne._hi)-(Oe=ht-ne._hi))-($=P*ne._hi)+ye*(_=ne._hi-Oe)+y*Oe+y*_,new I(ht=P+(tt=(this._hi-$-ht+this._lo-P*ne._lo)/ne._hi),P-ht+tt)}if(typeof arguments[0]=="number"){var rr=arguments[0];return Ae.isNaN(rr)?I.createNaN():I.copy(this).selfDivide(rr,0)}}},{key:"ge",value:function(y){return this._hi>y._hi||this._hi===y._hi&&this._lo>=y._lo}},{key:"pow",value:function(y){if(y===0)return I.valueOf(1);var _=new I(this),P=I.valueOf(1),$=Math.abs(y);if($>1)for(;$>0;)$%2==1&&P.selfMultiply(_),($/=2)>0&&(_=_.sqr());else P=_;return y<0?P.reciprocal():P}},{key:"ceil",value:function(){if(this.isNaN())return I.NaN;var y=Math.ceil(this._hi),_=0;return y===this._hi&&(_=Math.ceil(this._lo)),new I(y,_)}},{key:"compareTo",value:function(y){var _=y;return this._hi<_._hi?-1:this._hi>_._hi?1:this._lo<_._lo?-1:this._lo>_._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return this.init(y),this}if(typeof arguments[0]=="number"){var _=arguments[0];return this.init(_),this}}},{key:"max",value:function(y){return this.ge(y)?this:y}},{key:"sqrt",value:function(){if(this.isZero())return I.valueOf(0);if(this.isNegative())return I.NaN;var y=1/Math.sqrt(this._hi),_=this._hi*y,P=I.valueOf(_),$=this.subtract(P.sqr())._hi*(.5*y);return P.add($)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.selfAdd(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _,P,$,ne,ye,Oe=arguments[0],tt=null;return tt=($=this._hi+Oe)-(ne=$-this._hi),P=(ye=(tt=Oe-ne+(this._hi-tt))+this._lo)+($-(_=$+ye)),this._hi=_+P,this._lo=P+(_-this._hi),this}}else if(arguments.length===2){var ht,rr,ur,qr,bn=arguments[0],Dn=arguments[1],Xn=null,Fn=null,En=null;ur=this._hi+bn,rr=this._lo+Dn,Fn=ur-(En=ur-this._hi),Xn=rr-(qr=rr-this._lo);var na=(ht=ur+(En=(Fn=bn-En+(this._hi-Fn))+rr))+(En=(Xn=Dn-qr+(this._lo-Xn))+(En+(ur-ht))),ca=En+(ht-na);return this._hi=na,this._lo=ca,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.selfMultiply(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.selfMultiply(_,0)}}else if(arguments.length===2){var P,$,ne=arguments[0],ye=arguments[1],Oe=null,tt=null,ht=null,rr=null;Oe=(ht=I.SPLIT*this._hi)-this._hi,rr=I.SPLIT*ne,Oe=ht-Oe,P=this._hi-Oe,tt=rr-ne;var ur=(ht=this._hi*ne)+(rr=Oe*(tt=rr-tt)-ht+Oe*($=ne-tt)+P*tt+P*$+(this._hi*ye+this._lo*ne)),qr=rr+(Oe=ht-ur);return this._hi=ur,this._lo=qr,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return I.NaN;var y=Math.floor(this._hi),_=0;return y===this._hi&&(_=Math.floor(this._lo)),new I(y,_)}},{key:"negate",value:function(){return this.isNaN()?this:new I(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(y){if(y instanceof CloneNotSupportedException)return null;throw y}}},{key:"multiply",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return y.isNaN()?I.createNaN():I.copy(this).selfMultiply(y)}if(typeof arguments[0]=="number"){var _=arguments[0];return Ae.isNaN(_)?I.createNaN():I.copy(this).selfMultiply(_,0)}}},{key:"isNaN",value:function(){return Ae.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var y=I.magnitude(this._hi);return y>=-3&&y<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var y=this.getSpecialNumberString();if(y!==null)return y;var _=new Array(1).fill(null),P=this.extractSignificantDigits(!0,_),$=_[0]+1,ne=P;if(P.charAt(0)===".")ne="0"+P;else if($<0)ne="0."+I.stringOfChar("0",-$)+P;else if(P.indexOf(".")===-1){var ye=$-P.length;ne=P+I.stringOfChar("0",ye)+".0"}return this.isNegative()?"-"+ne:ne}},{key:"reciprocal",value:function(){var y,_,P,$,ne=null,ye=null,Oe=null,tt=null;y=(P=1/this._hi)-(ne=(Oe=I.SPLIT*P)-(ne=Oe-P)),ye=(tt=I.SPLIT*this._hi)-this._hi;var ht=P+(Oe=(1-($=P*this._hi)-(tt=ne*(ye=tt-ye)-$+ne*(_=this._hi-ye)+y*ye+y*_)-P*this._lo)/this._hi);return new I(ht,P-ht+Oe)}},{key:"toSciNotation",value:function(){if(this.isZero())return I.SCI_NOT_ZERO;var y=this.getSpecialNumberString();if(y!==null)return y;var _=new Array(1).fill(null),P=this.extractSignificantDigits(!1,_),$=I.SCI_NOT_EXPONENT_CHAR+_[0];if(P.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+P);var ne="";P.length>1&&(ne=P.substring(1));var ye=P.charAt(0)+"."+ne;return this.isNegative()?"-"+ye+$:ye+$}},{key:"abs",value:function(){return this.isNaN()?I.NaN:this.isNegative()?this.negate():new I(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(y){return this._hi<y._hi||this._hi===y._hi&&this._lo<y._lo}},{key:"add",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return I.copy(this).selfAdd(y)}if(typeof arguments[0]=="number"){var _=arguments[0];return I.copy(this).selfAdd(_)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var y=arguments[0];this._hi=y,this._lo=0}else if(arguments[0]instanceof I){var _=arguments[0];this._hi=_._hi,this._lo=_._lo}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this._hi=P,this._lo=$}}},{key:"gt",value:function(y){return this._hi>y._hi||this._hi===y._hi&&this._lo>y._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?I.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[X,H,G]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var y=arguments[0];this.init(y)}else if(arguments[0]instanceof I){var _=arguments[0];this.init(_)}else if(typeof arguments[0]=="string"){var P=arguments[0];I.constructor_.call(this,I.parse(P))}}else if(arguments.length===2){var $=arguments[0],ne=arguments[1];this.init($,ne)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1],P=arguments[2],$=arguments[3];return I.determinant(I.valueOf(y),I.valueOf(_),I.valueOf(P),I.valueOf($))}if(arguments[3]instanceof I&&arguments[2]instanceof I&&arguments[0]instanceof I&&arguments[1]instanceof I){var ne=arguments[1],ye=arguments[2],Oe=arguments[3];return arguments[0].multiply(Oe).selfSubtract(ne.multiply(ye))}}},{key:"sqr",value:function(y){return I.valueOf(y).selfMultiply(y)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var y=arguments[0];return I.parse(y)}if(typeof arguments[0]=="number")return new I(arguments[0])}},{key:"sqrt",value:function(y){return I.valueOf(y).sqrt()}},{key:"parse",value:function(y){for(var _=0,P=y.length;ke.isWhitespace(y.charAt(_));)_++;var $=!1;if(_<P){var ne=y.charAt(_);ne!=="-"&&ne!=="+"||(_++,ne==="-"&&($=!0))}for(var ye=new I,Oe=0,tt=0,ht=0,rr=!1;!(_>=P);){var ur=y.charAt(_);if(_++,ke.isDigit(ur)){var qr=ur-"0";ye.selfMultiply(I.TEN),ye.selfAdd(qr),Oe++}else{if(ur!=="."){if(ur==="e"||ur==="E"){var bn=y.substring(_);try{ht=at.parseInt(bn)}catch(na){throw na instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+bn+" in string "+y):na}break}throw new NumberFormatException("Unexpected character '"+ur+"' at position "+_+" in string "+y)}tt=Oe,rr=!0}}var Dn=ye;rr||(tt=Oe);var Xn=Oe-tt-ht;if(Xn===0)Dn=ye;else if(Xn>0){var Fn=I.TEN.pow(Xn);Dn=ye.divide(Fn)}else if(Xn<0){var En=I.TEN.pow(-Xn);Dn=ye.multiply(En)}return $?Dn.negate():Dn}},{key:"createNaN",value:function(){return new I(Ae.NaN,Ae.NaN)}},{key:"copy",value:function(y){return new I(y)}},{key:"magnitude",value:function(y){var _=Math.abs(y),P=Math.log(_)/Math.log(10),$=Math.trunc(Math.floor(P));return 10*Math.pow(10,$)<=_&&($+=1),$}},{key:"stringOfChar",value:function(y,_){for(var P=new Qt,$=0;$<_;$++)P.append(y);return P.toString()}}])})();be.PI=new be(3.141592653589793,12246467991473532e-32),be.TWO_PI=new be(6.283185307179586,24492935982947064e-32),be.PI_2=new be(1.5707963267948966,6123233995736766e-32),be.E=new be(2.718281828459045,14456468917292502e-32),be.NaN=new be(Ae.NaN,Ae.NaN),be.EPS=123259516440783e-46,be.SPLIT=134217729,be.MAX_PRINT_DIGITS=32,be.TEN=be.valueOf(10),be.ONE=be.valueOf(1),be.SCI_NOT_EXPONENT_CHAR="E",be.SCI_NOT_ZERO="0.0E0";var je=(function(){function I(){i(this,I)}return o(I,null,[{key:"orientationIndex",value:function(y,_,P){var $=I.orientationIndexFilter(y,_,P);if($<=1)return $;var ne=be.valueOf(_.x).selfAdd(-y.x),ye=be.valueOf(_.y).selfAdd(-y.y),Oe=be.valueOf(P.x).selfAdd(-_.x),tt=be.valueOf(P.y).selfAdd(-_.y);return ne.selfMultiply(tt).selfSubtract(ye.selfMultiply(Oe)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof be&&arguments[2]instanceof be&&arguments[0]instanceof be&&arguments[1]instanceof be){var y=arguments[1],_=arguments[2],P=arguments[3];return arguments[0].multiply(P).selfSubtract(y.multiply(_)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var $=arguments[0],ne=arguments[1],ye=arguments[2],Oe=arguments[3],tt=be.valueOf($),ht=be.valueOf(ne),rr=be.valueOf(ye),ur=be.valueOf(Oe);return tt.multiply(ur).selfSubtract(ht.multiply(rr)).signum()}}},{key:"intersection",value:function(y,_,P,$){var ne=new be(y.y).selfSubtract(_.y),ye=new be(_.x).selfSubtract(y.x),Oe=new be(y.x).selfMultiply(_.y).selfSubtract(new be(_.x).selfMultiply(y.y)),tt=new be(P.y).selfSubtract($.y),ht=new be($.x).selfSubtract(P.x),rr=new be(P.x).selfMultiply($.y).selfSubtract(new be($.x).selfMultiply(P.y)),ur=ye.multiply(rr).selfSubtract(ht.multiply(Oe)),qr=tt.multiply(Oe).selfSubtract(ne.multiply(rr)),bn=ne.multiply(ht).selfSubtract(tt.multiply(ye)),Dn=ur.selfDivide(bn).doubleValue(),Xn=qr.selfDivide(bn).doubleValue();return Ae.isNaN(Dn)||Ae.isInfinite(Dn)||Ae.isNaN(Xn)||Ae.isInfinite(Xn)?null:new Be(Dn,Xn)}},{key:"orientationIndexFilter",value:function(y,_,P){var $=null,ne=(y.x-P.x)*(_.y-P.y),ye=(y.y-P.y)*(_.x-P.x),Oe=ne-ye;if(ne>0){if(ye<=0)return I.signum(Oe);$=ne+ye}else{if(!(ne<0)||ye>=0)return I.signum(Oe);$=-ne-ye}var tt=I.DP_SAFE_EPSILON*$;return Oe>=tt||-Oe>=tt?I.signum(Oe):2}},{key:"signum",value:function(y){return y>0?1:y<0?-1:0}}])})();je.DP_SAFE_EPSILON=1e-15;var qe=(function(){return o((function I(){i(this,I)}),[{key:"getM",value:function(I){if(this.hasM()){var y=this.getDimension()-this.getMeasures();return this.getOrdinate(I,y)}return Ae.NaN}},{key:"setOrdinate",value:function(I,y,_){}},{key:"getZ",value:function(I){return this.hasZ()?this.getOrdinate(I,2):Ae.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(I,y){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(I){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(I){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(I){}},{key:"copy",value:function(){}},{key:"getY",value:function(I){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[G]}}])})();qe.X=0,qe.Y=1,qe.Z=2,qe.M=3;var We=(function(){function I(){i(this,I)}return o(I,null,[{key:"index",value:function(y,_,P){return je.orientationIndex(y,_,P)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var y=arguments[0],_=y.length-1;if(_<3)throw new U("Ring has fewer than 4 points, so orientation cannot be determined");for(var P=y[0],$=0,ne=1;ne<=_;ne++){var ye=y[ne];ye.y>P.y&&(P=ye,$=ne)}var Oe=$;do(Oe-=1)<0&&(Oe=_);while(y[Oe].equals2D(P)&&Oe!==$);var tt=$;do tt=(tt+1)%_;while(y[tt].equals2D(P)&&tt!==$);var ht=y[Oe],rr=y[tt];if(ht.equals2D(P)||rr.equals2D(P)||ht.equals2D(rr))return!1;var ur=I.index(ht,P,rr);return ur===0?ht.x>rr.x:ur>0}if(Tr(arguments[0],qe)){var qr=arguments[0],bn=qr.size()-1;if(bn<3)throw new U("Ring has fewer than 4 points, so orientation cannot be determined");for(var Dn=qr.getCoordinate(0),Xn=0,Fn=1;Fn<=bn;Fn++){var En=qr.getCoordinate(Fn);En.y>Dn.y&&(Dn=En,Xn=Fn)}var na=null,ca=Xn;do(ca-=1)<0&&(ca=bn),na=qr.getCoordinate(ca);while(na.equals2D(Dn)&&ca!==Xn);var so=null,ka=Xn;do ka=(ka+1)%bn,so=qr.getCoordinate(ka);while(so.equals2D(Dn)&&ka!==Xn);if(na.equals2D(Dn)||so.equals2D(Dn)||na.equals2D(so))return!1;var Ho=I.index(na,Dn,so);return Ho===0?na.x>so.x:Ho>0}}}])})();We.CLOCKWISE=-1,We.RIGHT=We.CLOCKWISE,We.COUNTERCLOCKWISE=1,We.LEFT=We.COUNTERCLOCKWISE,We.COLLINEAR=0,We.STRAIGHT=We.COLLINEAR;var Lt=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(I,y){var _=this.getRightmostSideOfSegment(I,y);return _<0&&(_=this.getRightmostSideOfSegment(I,y-1)),_<0&&(this._minCoord=null,this.checkForRightmostCoordinate(I)),_}},{key:"findRightmostEdgeAtVertex",value:function(){var I=this._minDe.getEdge().getCoordinates();we.isTrue(this._minIndex>0&&this._minIndex<I.length,"rightmost point expected to be interior vertex of edge");var y=I[this._minIndex-1],_=I[this._minIndex+1],P=We.index(this._minCoord,_,y),$=!1;(y.y<this._minCoord.y&&_.y<this._minCoord.y&&P===We.COUNTERCLOCKWISE||y.y>this._minCoord.y&&_.y>this._minCoord.y&&P===We.CLOCKWISE)&&($=!0),$&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(I,y){var _=I.getEdge().getCoordinates();if(y<0||y+1>=_.length||_[y].y===_[y+1].y)return-1;var P=_t.LEFT;return _[y].y<_[y+1].y&&(P=_t.RIGHT),P}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(I){for(var y=I.getEdge().getCoordinates(),_=0;_<y.length-1;_++)(this._minCoord===null||y[_].x>this._minCoord.x)&&(this._minDe=I,this._minIndex=_,this._minCoord=y[_])}},{key:"findRightmostEdgeAtNode",value:function(){var I=this._minDe.getNode().getEdges();this._minDe=I.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(I){for(var y=I.iterator();y.hasNext();){var _=y.next();_.isForward()&&this.checkForRightmostCoordinate(_)}we.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===_t.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])})(),Et=(function(I){function y(_,P){var $;return i(this,y),($=n(this,y,[P?_+" [ "+P+" ]":_])).pt=P?new Be(P):void 0,$.name=Object.keys({TopologyException:y})[0],$}return m(y,I),o(y,[{key:"getCoordinate",value:function(){return this.pt}}])})(de),mt=(function(){return o((function I(){i(this,I),this.array=[]}),[{key:"addLast",value:function(I){this.array.push(I)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])})(),ct=(function(I){function y(_){var P;return i(this,y),(P=n(this,y)).array=[],_ instanceof zt&&P.addAll(_),P}return m(y,I),o(y,[{key:"interfaces_",get:function(){return[lr,zt]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(_){return arguments.length===1?this.array.push(_):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(_){var P,$=c(_);try{for($.s();!(P=$.n()).done;){var ne=P.value;this.array.push(ne)}}catch(ye){$.e(ye)}finally{$.f()}}},{key:"set",value:function(_,P){var $=this.array[_];return this.array[_]=P,$}},{key:"iterator",value:function(){return new Kt(this)}},{key:"get",value:function(_){if(_<0||_>=this.size())throw new br;return this.array[_]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(_){_?this.array.sort((function(P,$){return _.compare(P,$)})):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(_){for(var P=0,$=this.array.length;P<$;P++)if(this.array[P]===_)return!!this.array.splice(P,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])})(lr),Kt=(function(){return o((function I(y){i(this,I),this.arrayList=y,this.position=0}),[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new st;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(I){return this.arrayList.set(this.position-1,I)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])})(),qt=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"clearVisitedEdges",value:function(){for(var I=this._dirEdgeList.iterator();I.hasNext();)I.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(I){for(var y=null,_=I.getEdges().iterator();_.hasNext();){var P=_.next();if(P.isVisited()||P.getSym().isVisited()){y=P;break}}if(y===null)throw new Et("unable to find edge to compute depths at "+I.getCoordinate());I.getEdges().computeDepths(y);for(var $=I.getEdges().iterator();$.hasNext();){var ne=$.next();ne.setVisited(!0),this.copySymDepths(ne)}}},{key:"computeDepth",value:function(I){this.clearVisitedEdges();var y=this._finder.getEdge();y.getNode(),y.getLabel(),y.setEdgeDepths(_t.RIGHT,I),this.copySymDepths(y),this.computeDepths(y)}},{key:"create",value:function(I){this.addReachable(I),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var I=this._dirEdgeList.iterator();I.hasNext();){var y=I.next();y.getDepth(_t.RIGHT)>=1&&y.getDepth(_t.LEFT)<=0&&!y.isInteriorAreaEdge()&&y.setInResult(!0)}}},{key:"computeDepths",value:function(I){var y=new Ht,_=new mt,P=I.getNode();for(_.addLast(P),y.add(P),I.setVisited(!0);!_.isEmpty();){var $=_.removeFirst();y.add($),this.computeNodeDepth($);for(var ne=$.getEdges().iterator();ne.hasNext();){var ye=ne.next().getSym();if(!ye.isVisited()){var Oe=ye.getNode();y.contains(Oe)||(_.addLast(Oe),y.add(Oe))}}}}},{key:"compareTo",value:function(I){var y=I;return this._rightMostCoord.x<y._rightMostCoord.x?-1:this._rightMostCoord.x>y._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var I=new Qe,y=this._dirEdgeList.iterator();y.hasNext();)for(var _=y.next().getEdge().getCoordinates(),P=0;P<_.length-1;P++)I.expandToInclude(_[P]);this._env=I}return this._env}},{key:"addReachable",value:function(I){var y=new Cr;for(y.add(I);!y.empty();){var _=y.pop();this.add(_,y)}}},{key:"copySymDepths",value:function(I){var y=I.getSym();y.setDepth(_t.LEFT,I.getDepth(_t.RIGHT)),y.setDepth(_t.RIGHT,I.getDepth(_t.LEFT))}},{key:"add",value:function(I,y){I.setVisited(!0),this._nodes.add(I);for(var _=I.getEdges().iterator();_.hasNext();){var P=_.next();this._dirEdgeList.add(P);var $=P.getSym().getNode();$.isVisited()||y.push($)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new ct,this._nodes=new ct,this._rightMostCoord=null,this._env=null,this._finder=new Lt}}])})(),Ir=(function(){return o((function I(){i(this,I)}),null,[{key:"intersection",value:function(I,y,_,P){var $=I.x<y.x?I.x:y.x,ne=I.y<y.y?I.y:y.y,ye=I.x>y.x?I.x:y.x,Oe=I.y>y.y?I.y:y.y,tt=_.x<P.x?_.x:P.x,ht=_.y<P.y?_.y:P.y,rr=_.x>P.x?_.x:P.x,ur=_.y>P.y?_.y:P.y,qr=(($>tt?$:tt)+(ye<rr?ye:rr))/2,bn=((ne>ht?ne:ht)+(Oe<ur?Oe:ur))/2,Dn=I.x-qr,Xn=I.y-bn,Fn=y.x-qr,En=y.y-bn,na=_.x-qr,ca=_.y-bn,so=P.x-qr,ka=P.y-bn,Ho=Xn-En,Ks=Fn-Dn,Pl=Dn*En-Fn*Xn,fu=ca-ka,du=so-na,Ps=na*ka-so*ca,Wl=Ho*du-fu*Ks,Gl=(Ks*Ps-du*Pl)/Wl,Eo=(fu*Pl-Ho*Ps)/Wl;return Ae.isNaN(Gl)||Ae.isInfinite(Gl)||Ae.isNaN(Eo)||Ae.isInfinite(Eo)?null:new Be(Gl+qr,Eo+bn)}}])})(),Ar=(function(){return o((function I(){i(this,I)}),null,[{key:"arraycopy",value:function(I,y,_,P,$){for(var ne=0,ye=y;ye<y+$;ye++)_[P+ne]=I[ye],ne++}},{key:"getProperty",value:function(I){return{"line.separator":`
`}[I]}}])})(),$r=(function(){function I(){i(this,I)}return o(I,null,[{key:"log10",value:function(y){var _=Math.log(y);return Ae.isInfinite(_)||Ae.isNaN(_)?_:_/I.LOG_10}},{key:"min",value:function(y,_,P,$){var ne=y;return _<ne&&(ne=_),P<ne&&(ne=P),$<ne&&(ne=$),ne}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1],P=arguments[2];return y<_?_:y>P?P:y}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var $=arguments[0],ne=arguments[1],ye=arguments[2];return $<ne?ne:$>ye?ye:$}}},{key:"wrap",value:function(y,_){return y<0?_- -y%_:y%_}},{key:"max",value:function(){if(arguments.length===3){var y=arguments[1],_=arguments[2],P=arguments[0];return y>P&&(P=y),_>P&&(P=_),P}if(arguments.length===4){var $=arguments[1],ne=arguments[2],ye=arguments[3],Oe=arguments[0];return $>Oe&&(Oe=$),ne>Oe&&(Oe=ne),ye>Oe&&(Oe=ye),Oe}}},{key:"average",value:function(y,_){return(y+_)/2}}])})();$r.LOG_10=Math.log(10);var hn=(function(){function I(){i(this,I)}return o(I,null,[{key:"segmentToSegment",value:function(y,_,P,$){if(y.equals(_))return I.pointToSegment(y,P,$);if(P.equals($))return I.pointToSegment($,y,_);var ne=!1;if(Qe.intersects(y,_,P,$)){var ye=(_.x-y.x)*($.y-P.y)-(_.y-y.y)*($.x-P.x);if(ye===0)ne=!0;else{var Oe=(y.y-P.y)*($.x-P.x)-(y.x-P.x)*($.y-P.y),tt=((y.y-P.y)*(_.x-y.x)-(y.x-P.x)*(_.y-y.y))/ye,ht=Oe/ye;(ht<0||ht>1||tt<0||tt>1)&&(ne=!0)}}else ne=!0;return ne?$r.min(I.pointToSegment(y,P,$),I.pointToSegment(_,P,$),I.pointToSegment(P,y,_),I.pointToSegment($,y,_)):0}},{key:"pointToSegment",value:function(y,_,P){if(_.x===P.x&&_.y===P.y)return y.distance(_);var $=(P.x-_.x)*(P.x-_.x)+(P.y-_.y)*(P.y-_.y),ne=((y.x-_.x)*(P.x-_.x)+(y.y-_.y)*(P.y-_.y))/$;if(ne<=0)return y.distance(_);if(ne>=1)return y.distance(P);var ye=((_.y-y.y)*(P.x-_.x)-(_.x-y.x)*(P.y-_.y))/$;return Math.abs(ye)*Math.sqrt($)}},{key:"pointToLinePerpendicular",value:function(y,_,P){var $=(P.x-_.x)*(P.x-_.x)+(P.y-_.y)*(P.y-_.y),ne=((_.y-y.y)*(P.x-_.x)-(_.x-y.x)*(P.y-_.y))/$;return Math.abs(ne)*Math.sqrt($)}},{key:"pointToSegmentString",value:function(y,_){if(_.length===0)throw new U("Line array must contain at least one vertex");for(var P=y.distance(_[0]),$=0;$<_.length-1;$++){var ne=I.pointToSegment(y,_[$],_[$+1]);ne<P&&(P=ne)}return P}}])})(),zr=(function(){return o((function I(){i(this,I)}),[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||Tr(arguments[0],qe);else if(arguments.length!==2){if(arguments.length===3){var I=arguments[0],y=arguments[1];return this.create(I,y)}}}}])})(),Mt=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I){}}])})(),en=(function(){return o((function I(){i(this,I)}),null,[{key:"ofLine",value:function(I){var y=I.size();if(y<=1)return 0;var _=0,P=new Be;I.getCoordinate(0,P);for(var $=P.x,ne=P.y,ye=1;ye<y;ye++){I.getCoordinate(ye,P);var Oe=P.x,tt=P.y,ht=Oe-$,rr=tt-ne;_+=Math.sqrt(ht*ht+rr*rr),$=Oe,ne=tt}return _}}])})(),jn=o((function I(){i(this,I)})),Qr=(function(){function I(){i(this,I)}return o(I,null,[{key:"copyCoord",value:function(y,_,P,$){for(var ne=Math.min(y.getDimension(),P.getDimension()),ye=0;ye<ne;ye++)P.setOrdinate($,ye,y.getOrdinate(_,ye))}},{key:"isRing",value:function(y){var _=y.size();return _===0||!(_<=3)&&y.getOrdinate(0,qe.X)===y.getOrdinate(_-1,qe.X)&&y.getOrdinate(0,qe.Y)===y.getOrdinate(_-1,qe.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(Tr(arguments[0],qe)&&Number.isInteger(arguments[1])){var y=arguments[0],_=arguments[1];I.scroll(y,_,I.isRing(y))}else if(Tr(arguments[0],qe)&&arguments[1]instanceof Be){var P=arguments[0],$=arguments[1],ne=I.indexOf($,P);if(ne<=0)return null;I.scroll(P,ne)}}else if(arguments.length===3){var ye=arguments[0],Oe=arguments[1],tt=arguments[2];if(Oe<=0)return null;for(var ht=ye.copy(),rr=tt?ye.size()-1:ye.size(),ur=0;ur<rr;ur++)for(var qr=0;qr<ye.getDimension();qr++)ye.setOrdinate(ur,qr,ht.getOrdinate((Oe+ur)%rr,qr));if(tt)for(var bn=0;bn<ye.getDimension();bn++)ye.setOrdinate(rr,bn,ye.getOrdinate(0,bn))}}},{key:"isEqual",value:function(y,_){var P=y.size();if(P!==_.size())return!1;for(var $=Math.min(y.getDimension(),_.getDimension()),ne=0;ne<P;ne++)for(var ye=0;ye<$;ye++){var Oe=y.getOrdinate(ne,ye),tt=_.getOrdinate(ne,ye);if(y.getOrdinate(ne,ye)!==_.getOrdinate(ne,ye)&&(!Ae.isNaN(Oe)||!Ae.isNaN(tt)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var y=arguments[0];return I.minCoordinateIndex(y,0,y.size()-1)}if(arguments.length===3){for(var _=arguments[0],P=arguments[2],$=-1,ne=null,ye=arguments[1];ye<=P;ye++){var Oe=_.getCoordinate(ye);(ne===null||ne.compareTo(Oe)>0)&&(ne=Oe,$=ye)}return $}}},{key:"extend",value:function(y,_,P){var $=y.create(P,_.getDimension()),ne=_.size();if(I.copy(_,0,$,0,ne),ne>0)for(var ye=ne;ye<P;ye++)I.copy(_,ne-1,$,ye,1);return $}},{key:"reverse",value:function(y){for(var _=y.size()-1,P=Math.trunc(_/2),$=0;$<=P;$++)I.swap(y,$,_-$)}},{key:"swap",value:function(y,_,P){if(_===P)return null;for(var $=0;$<y.getDimension();$++){var ne=y.getOrdinate(_,$);y.setOrdinate(_,$,y.getOrdinate(P,$)),y.setOrdinate(P,$,ne)}}},{key:"copy",value:function(y,_,P,$,ne){for(var ye=0;ye<ne;ye++)I.copyCoord(y,_+ye,P,$+ye)}},{key:"ensureValidRing",value:function(y,_){var P=_.size();return P===0?_:P<=3?I.createClosedRing(y,_,4):_.getOrdinate(0,qe.X)===_.getOrdinate(P-1,qe.X)&&_.getOrdinate(0,qe.Y)===_.getOrdinate(P-1,qe.Y)?_:I.createClosedRing(y,_,P+1)}},{key:"indexOf",value:function(y,_){for(var P=0;P<_.size();P++)if(y.x===_.getOrdinate(P,qe.X)&&y.y===_.getOrdinate(P,qe.Y))return P;return-1}},{key:"createClosedRing",value:function(y,_,P){var $=y.create(P,_.getDimension()),ne=_.size();I.copy(_,0,$,0,ne);for(var ye=ne;ye<P;ye++)I.copy(_,0,$,ye,1);return $}},{key:"minCoordinate",value:function(y){for(var _=null,P=0;P<y.size();P++){var $=y.getCoordinate(P);(_===null||_.compareTo($)>0)&&(_=$)}return _}}])})(),nr=(function(){function I(){i(this,I)}return o(I,null,[{key:"toDimensionSymbol",value:function(y){switch(y){case I.FALSE:return I.SYM_FALSE;case I.TRUE:return I.SYM_TRUE;case I.DONTCARE:return I.SYM_DONTCARE;case I.P:return I.SYM_P;case I.L:return I.SYM_L;case I.A:return I.SYM_A}throw new U("Unknown dimension value: "+y)}},{key:"toDimensionValue",value:function(y){switch(ke.toUpperCase(y)){case I.SYM_FALSE:return I.FALSE;case I.SYM_TRUE:return I.TRUE;case I.SYM_DONTCARE:return I.DONTCARE;case I.SYM_P:return I.P;case I.SYM_L:return I.L;case I.SYM_A:return I.A}throw new U("Unknown dimension symbol: "+y)}}])})();nr.P=0,nr.L=1,nr.A=2,nr.FALSE=-1,nr.TRUE=-2,nr.DONTCARE=-3,nr.SYM_FALSE="F",nr.SYM_TRUE="T",nr.SYM_DONTCARE="*",nr.SYM_P="0",nr.SYM_L="1",nr.SYM_A="2";var oi=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I){}}])})(),un=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I,y){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])})(),Kn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new Qe:this._points.expandEnvelope(new Qe)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new y(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],P=arguments[1];if(!this.isEquivalentClass(_))return!1;var $=_;if(this._points.size()!==$._points.size())return!1;for(var ne=0;ne<this._points.size();ne++)if(!this.equal(this._points.getCoordinate(ne),$._points.getCoordinate(ne),P))return!1;return!0}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var _=0;_<Math.trunc(this._points.size()/2);_++){var P=this._points.size()-1-_;if(!this._points.getCoordinate(_).equals(this._points.getCoordinate(P))){if(this._points.getCoordinate(_).compareTo(this._points.getCoordinate(P))>0){var $=this._points.copy();Qr.reverse($),this._points=$}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?nr.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var _=this._points.copy();return Qr.reverse(_),this.getFactory().createLineString(_)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return rt.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return en.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var _=arguments[0],P=0,$=0;P<this._points.size()&&$<_._points.size();){var ne=this._points.getCoordinate(P).compareTo(_._points.getCoordinate($));if(ne!==0)return ne;P++,$++}return P<this._points.size()?1:$<_._points.size()?-1:0}if(arguments.length===2){var ye=arguments[0];return arguments[1].compare(this._points,ye._points)}}},{key:"apply",value:function(){if(Tr(arguments[0],Mt))for(var _=arguments[0],P=0;P<this._points.size();P++)_.filter(this._points.getCoordinate(P));else if(Tr(arguments[0],un)){var $=arguments[0];if(this._points.size()===0)return null;for(var ne=0;ne<this._points.size()&&($.filter(this._points,ne),!$.isDone());ne++);$.isGeometryChanged()&&this.geometryChanged()}else Tr(arguments[0],oi)?arguments[0].filter(this):Tr(arguments[0],j)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new $e}},{key:"isEquivalentClass",value:function(_){return _ instanceof y}},{key:"getCoordinateN",value:function(_){return this._points.getCoordinate(_)}},{key:"getGeometryType",value:function(){return rt.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(_){if(_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),_.size()===1)throw new U("Invalid number of points in LineString (found "+_.size()+" - must be 0 or >= 2)");this._points=_}},{key:"isCoordinate",value:function(_){for(var P=0;P<this._points.size();P++)if(this._points.getCoordinate(P).equals(_))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(_){return this.getFactory().createPoint(this._points.getCoordinate(_))}},{key:"interfaces_",get:function(){return[jn]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var _=arguments[0],P=arguments[1];rt.constructor_.call(this,P),this.init(_)}}}}])})(rt),Me=o((function I(){i(this,I)})),He=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new Qe;var _=new Qe;return _.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),_}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new y(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&(!(!this.isEmpty()||!_.isEmpty())||this.isEmpty()===_.isEmpty()&&this.equal(_.getCoordinate(),this.getCoordinate(),P))}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return nr.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return rt.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0];return this.getCoordinate().compareTo(_.getCoordinate())}if(arguments.length===2){var P=arguments[0];return arguments[1].compare(this._coordinates,P._coordinates)}}},{key:"apply",value:function(){if(Tr(arguments[0],Mt)){var _=arguments[0];if(this.isEmpty())return null;_.filter(this.getCoordinate())}else if(Tr(arguments[0],un)){var P=arguments[0];if(this.isEmpty())return null;P.filter(this._coordinates,0),P.isGeometryChanged()&&this.geometryChanged()}else Tr(arguments[0],oi)?arguments[0].filter(this):Tr(arguments[0],j)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return rt.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(_){_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),we.isTrue(_.size()<=1),this._coordinates=_}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[Me]}}],[{key:"constructor_",value:function(){this._coordinates=null;var _=arguments[0],P=arguments[1];rt.constructor_.call(this,P),this.init(_)}}])})(rt),Tt=(function(){function I(){i(this,I)}return o(I,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var y=arguments[0];return Math.abs(I.ofRingSigned(y))}if(Tr(arguments[0],qe)){var _=arguments[0];return Math.abs(I.ofRingSigned(_))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var y=arguments[0];if(y.length<3)return 0;for(var _=0,P=y[0].x,$=1;$<y.length-1;$++){var ne=y[$].x-P,ye=y[$+1].y;_+=ne*(y[$-1].y-ye)}return _/2}if(Tr(arguments[0],qe)){var Oe=arguments[0],tt=Oe.size();if(tt<3)return 0;var ht=new Be,rr=new Be,ur=new Be;Oe.getCoordinate(0,rr),Oe.getCoordinate(1,ur);var qr=rr.x;ur.x-=qr;for(var bn=0,Dn=1;Dn<tt-1;Dn++)ht.y=rr.y,rr.x=ur.x,rr.y=ur.y,Oe.getCoordinate(Dn+1,ur),ur.x-=qr,bn+=rr.x*(ht.y-ur.y);return bn/2}}}])})(),Wt=(function(){return o((function I(){i(this,I)}),null,[{key:"sort",value:function(){var I=arguments,y=arguments[0];if(arguments.length===1)y.sort((function(qr,bn){return qr.compareTo(bn)}));else if(arguments.length===2)y.sort((function(qr,bn){return I[1].compare(qr,bn)}));else if(arguments.length===3){var _=y.slice(arguments[1],arguments[2]);_.sort();var P=y.slice(0,arguments[1]).concat(_,y.slice(arguments[2],y.length));y.splice(0,y.length);var $,ne=c(P);try{for(ne.s();!($=ne.n()).done;){var ye=$.value;y.push(ye)}}catch(qr){ne.e(qr)}finally{ne.f()}}else if(arguments.length===4){var Oe=y.slice(arguments[1],arguments[2]);Oe.sort((function(qr,bn){return I[3].compare(qr,bn)}));var tt=y.slice(0,arguments[1]).concat(Oe,y.slice(arguments[2],y.length));y.splice(0,y.length);var ht,rr=c(tt);try{for(rr.s();!(ht=rr.n()).done;){var ur=ht.value;y.push(ur)}}catch(qr){rr.e(qr)}finally{rr.f()}}}},{key:"asList",value:function(I){var y,_=new ct,P=c(I);try{for(P.s();!(y=P.n()).done;){var $=y.value;_.add($)}}catch(ne){P.e(ne)}finally{P.f()}return _}},{key:"copyOf",value:function(I,y){return I.slice(0,y)}}])})(),Ut=o((function I(){i(this,I)})),Xr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var _=new Array(this.getNumPoints()).fill(null),P=-1,$=this._shell.getCoordinates(),ne=0;ne<$.length;ne++)_[++P]=$[ne];for(var ye=0;ye<this._holes.length;ye++)for(var Oe=this._holes[ye].getCoordinates(),tt=0;tt<Oe.length;tt++)_[++P]=Oe[tt];return _}},{key:"getArea",value:function(){var _=0;_+=Tt.ofRing(this._shell.getCoordinateSequence());for(var P=0;P<this._holes.length;P++)_-=Tt.ofRing(this._holes[P].getCoordinateSequence());return _}},{key:"copyInternal",value:function(){for(var _=this._shell.copy(),P=new Array(this._holes.length).fill(null),$=0;$<this._holes.length;$++)P[$]=this._holes[$].copy();return new y(_,P,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var _=this._shell.getCoordinateSequence(),P=this.getEnvelopeInternal(),$=0;$<5;$++){var ne=_.getX($);if(ne!==P.getMinX()&&ne!==P.getMaxX())return!1;var ye=_.getY($);if(ye!==P.getMinY()&&ye!==P.getMaxY())return!1}for(var Oe=_.getX(0),tt=_.getY(0),ht=1;ht<=4;ht++){var rr=_.getX(ht),ur=_.getY(ht);if(rr!==Oe==(ur!==tt))return!1;Oe=rr,tt=ur}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],P=arguments[1];if(!this.isEquivalentClass(_))return!1;var $=_,ne=this._shell,ye=$._shell;if(!ne.equalsExact(ye,P)||this._holes.length!==$._holes.length)return!1;for(var Oe=0;Oe<this._holes.length;Oe++)if(!this._holes[Oe].equalsExact($._holes[Oe],P))return!1;return!0}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var _=0;_<this._holes.length;_++)this._holes[_]=this.normalized(this._holes[_],!1);Wt.sort(this._holes)}else if(arguments.length===2){var P=arguments[0],$=arguments[1];if(P.isEmpty())return null;var ne=P.getCoordinateSequence(),ye=Qr.minCoordinateIndex(ne,0,ne.size()-2);Qr.scroll(ne,ye,!0),We.isCCW(ne)===$&&Qr.reverse(ne)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var _=this.getExteriorRing().reverse(),P=new Array(this.getNumInteriorRing()).fill(null),$=0;$<P.length;$++)P[$]=this.getInteriorRingN($).reverse();return this.getFactory().createPolygon(_,P)}},{key:"getTypeCode",value:function(){return rt.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var _=0;_+=this._shell.getLength();for(var P=0;P<this._holes.length;P++)_+=this._holes[P].getLength();return _}},{key:"getNumPoints",value:function(){for(var _=this._shell.getNumPoints(),P=0;P<this._holes.length;P++)_+=this._holes[P].getNumPoints();return _}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(_,P){var $=_.copy();return this.normalize($,P),$}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0],P=this._shell,$=_._shell;return P.compareToSameClass($)}if(arguments.length===2){var ne=arguments[1],ye=arguments[0],Oe=this._shell,tt=ye._shell,ht=Oe.compareToSameClass(tt,ne);if(ht!==0)return ht;for(var rr=this.getNumInteriorRing(),ur=ye.getNumInteriorRing(),qr=0;qr<rr&&qr<ur;){var bn=this.getInteriorRingN(qr),Dn=ye.getInteriorRingN(qr),Xn=bn.compareToSameClass(Dn,ne);if(Xn!==0)return Xn;qr++}return qr<rr?1:qr<ur?-1:0}}},{key:"apply",value:function(){if(Tr(arguments[0],Mt)){var _=arguments[0];this._shell.apply(_);for(var P=0;P<this._holes.length;P++)this._holes[P].apply(_)}else if(Tr(arguments[0],un)){var $=arguments[0];if(this._shell.apply($),!$.isDone())for(var ne=0;ne<this._holes.length&&(this._holes[ne].apply($),!$.isDone());ne++);$.isGeometryChanged()&&this.geometryChanged()}else if(Tr(arguments[0],oi))arguments[0].filter(this);else if(Tr(arguments[0],j)){var ye=arguments[0];ye.filter(this),this._shell.apply(ye);for(var Oe=0;Oe<this._holes.length;Oe++)this._holes[Oe].apply(ye)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var _=new Array(this._holes.length+1).fill(null);_[0]=this._shell;for(var P=0;P<this._holes.length;P++)_[P+1]=this._holes[P];return _.length<=1?this.getFactory().createLinearRing(_[0].getCoordinateSequence()):this.getFactory().createMultiLineString(_)}},{key:"getGeometryType",value:function(){return rt.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(_){return this._holes[_]}},{key:"interfaces_",get:function(){return[Ut]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var _=arguments[0],P=arguments[1],$=arguments[2];if(rt.constructor_.call(this,$),_===null&&(_=this.getFactory().createLinearRing()),P===null&&(P=[]),rt.hasNullElements(P))throw new U("holes must not contain null elements");if(_.isEmpty()&&rt.hasNonEmptyElements(P))throw new U("shell is empty but holes are not");this._shell=_,this._holes=P}}])})(rt),Nn=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y)})(Jt),Bi=(function(I){function y(_){var P;return i(this,y),(P=n(this,y)).array=[],_ instanceof zt&&P.addAll(_),P}return m(y,I),o(y,[{key:"contains",value:function(_){var P,$=c(this.array);try{for($.s();!(P=$.n()).done;)if(P.value.compareTo(_)===0)return!0}catch(ne){$.e(ne)}finally{$.f()}return!1}},{key:"add",value:function(_){if(this.contains(_))return!1;for(var P=0,$=this.array.length;P<$;P++)if(this.array[P].compareTo(_)===1)return!!this.array.splice(P,0,_);return this.array.push(_),!0}},{key:"addAll",value:function(_){var P,$=c(_);try{for($.s();!(P=$.n()).done;){var ne=P.value;this.add(ne)}}catch(ye){$.e(ye)}finally{$.f()}return!0}},{key:"remove",value:function(){throw new $e}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new Ci(this.array)}}])})(Nn),Ci=(function(){return o((function I(y){i(this,I),this.array=y,this.position=0}),[{key:"next",value:function(){if(this.position===this.array.length)throw new st;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new $e}}])})(),Fr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){for(var _=new Qe,P=0;P<this._geometries.length;P++)_.expandToInclude(this._geometries[P].getEnvelopeInternal());return _}},{key:"getGeometryN",value:function(_){return this._geometries[_]}},{key:"getCoordinates",value:function(){for(var _=new Array(this.getNumPoints()).fill(null),P=-1,$=0;$<this._geometries.length;$++)for(var ne=this._geometries[$].getCoordinates(),ye=0;ye<ne.length;ye++)_[++P]=ne[ye];return _}},{key:"getArea",value:function(){for(var _=0,P=0;P<this._geometries.length;P++)_+=this._geometries[P].getArea();return _}},{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],P=arguments[1];if(!this.isEquivalentClass(_))return!1;var $=_;if(this._geometries.length!==$._geometries.length)return!1;for(var ne=0;ne<this._geometries.length;ne++)if(!this._geometries[ne].equalsExact($._geometries[ne],P))return!1;return!0}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var _=0;_<this._geometries.length;_++)this._geometries[_].normalize();Wt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var _=nr.FALSE,P=0;P<this._geometries.length;P++)_=Math.max(_,this._geometries[P].getBoundaryDimension());return _}},{key:"reverseInternal",value:function(){for(var _=this._geometries.length,P=new ct(_),$=0;$<_;$++)P.add(this._geometries[$].reverse());return this.getFactory().buildGeometry(P)}},{key:"getTypeCode",value:function(){return rt.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var _=nr.FALSE,P=0;P<this._geometries.length;P++)_=Math.max(_,this._geometries[P].getDimension());return _}},{key:"getLength",value:function(){for(var _=0,P=0;P<this._geometries.length;P++)_+=this._geometries[P].getLength();return _}},{key:"getNumPoints",value:function(){for(var _=0,P=0;P<this._geometries.length;P++)_+=this._geometries[P].getNumPoints();return _}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0],P=new Bi(Wt.asList(this._geometries)),$=new Bi(Wt.asList(_._geometries));return this.compare(P,$)}if(arguments.length===2){for(var ne=arguments[1],ye=arguments[0],Oe=this.getNumGeometries(),tt=ye.getNumGeometries(),ht=0;ht<Oe&&ht<tt;){var rr=this.getGeometryN(ht),ur=ye.getGeometryN(ht),qr=rr.compareToSameClass(ur,ne);if(qr!==0)return qr;ht++}return ht<Oe?1:ht<tt?-1:0}}},{key:"apply",value:function(){if(Tr(arguments[0],Mt))for(var _=arguments[0],P=0;P<this._geometries.length;P++)this._geometries[P].apply(_);else if(Tr(arguments[0],un)){var $=arguments[0];if(this._geometries.length===0)return null;for(var ne=0;ne<this._geometries.length&&(this._geometries[ne].apply($),!$.isDone());ne++);$.isGeometryChanged()&&this.geometryChanged()}else if(Tr(arguments[0],oi)){var ye=arguments[0];ye.filter(this);for(var Oe=0;Oe<this._geometries.length;Oe++)this._geometries[Oe].apply(ye)}else if(Tr(arguments[0],j)){var tt=arguments[0];tt.filter(this);for(var ht=0;ht<this._geometries.length;ht++)this._geometries[ht].apply(tt)}}},{key:"getBoundary",value:function(){return rt.checkNotGeometryCollection(this),we.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return rt.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var _=arguments[0],P=arguments[1];if(rt.constructor_.call(this,P),_===null&&(_=[]),rt.hasNullElements(_))throw new U("geometries must not contain null elements");this._geometries=_}}}}])})(rt),Mn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&E(y,"equalsExact",this,1).call(this,_,P)}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var _=arguments[0];return this._geometries[_].getCoordinate()}return E(y,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return nr.FALSE}},{key:"getTypeCode",value:function(){return rt.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return rt.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[Me]}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Fr.constructor_.call(this,_,P)}}])})(Fr),Bn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){return new y(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return nr.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||E(y,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var _=this._points.copy();return Qr.reverse(_),this.getFactory().createLinearRing(_)}},{key:"getTypeCode",value:function(){return rt.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!E(y,"isClosed",this,1).call(this))throw new U("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<y.MINIMUM_VALID_SIZE)throw new U("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return rt.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Kn.constructor_.call(this,_,P),this.validateConstruction()}}])})(Kn);Bn.MINIMUM_VALID_SIZE=4;var ei=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"setOrdinate",value:function(_,P){switch(_){case y.X:this.x=P;break;case y.Y:this.y=P;break;default:throw new U("Invalid ordinate index: "+_)}}},{key:"getZ",value:function(){return Be.NULL_ORDINATE}},{key:"getOrdinate",value:function(_){switch(_){case y.X:return this.x;case y.Y:return this.y}throw new U("Invalid ordinate index: "+_)}},{key:"setZ",value:function(_){throw new U("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)Be.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Be.constructor_.call(this,_.x,_.y)}else if(arguments[0]instanceof Be){var P=arguments[0];Be.constructor_.call(this,P.x,P.y)}}else if(arguments.length===2){var $=arguments[0],ne=arguments[1];Be.constructor_.call(this,$,ne,Be.NULL_ORDINATE)}}}])})(Be);ei.X=0,ei.Y=1,ei.Z=-1,ei.M=-1;var ua=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(_,P){switch(_){case y.X:this.x=P;break;case y.Y:this.y=P;break;case y.M:this._m=P;break;default:throw new U("Invalid ordinate index: "+_)}}},{key:"setM",value:function(_){this._m=_}},{key:"getZ",value:function(){return Be.NULL_ORDINATE}},{key:"getOrdinate",value:function(_){switch(_){case y.X:return this.x;case y.Y:return this.y;case y.M:return this._m}throw new U("Invalid ordinate index: "+_)}},{key:"setZ",value:function(_){throw new U("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ(),this._m=_.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Be.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Be.constructor_.call(this,_.x,_.y),this._m=_._m}else if(arguments[0]instanceof Be){var P=arguments[0];Be.constructor_.call(this,P.x,P.y),this._m=this.getM()}}else if(arguments.length===3){var $=arguments[0],ne=arguments[1],ye=arguments[2];Be.constructor_.call(this,$,ne,Be.NULL_ORDINATE),this._m=ye}}}])})(Be);ua.X=0,ua.Y=1,ua.Z=-1,ua.M=2;var fa=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(_,P){switch(_){case Be.X:this.x=P;break;case Be.Y:this.y=P;break;case Be.Z:this.z=P;break;case Be.M:this._m=P;break;default:throw new U("Invalid ordinate index: "+_)}}},{key:"setM",value:function(_){this._m=_}},{key:"getOrdinate",value:function(_){switch(_){case Be.X:return this.x;case Be.Y:return this.y;case Be.Z:return this.getZ();case Be.M:return this.getM()}throw new U("Invalid ordinate index: "+_)}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ(),this._m=_.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Be.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Be.constructor_.call(this,_),this._m=_._m}else if(arguments[0]instanceof Be){var P=arguments[0];Be.constructor_.call(this,P),this._m=this.getM()}}else if(arguments.length===4){var $=arguments[0],ne=arguments[1],ye=arguments[2],Oe=arguments[3];Be.constructor_.call(this,$,ne,ye),this._m=Oe}}}])})(Be),zn=(function(){function I(){i(this,I)}return o(I,null,[{key:"measures",value:function(y){return y instanceof ei?0:y instanceof ua||y instanceof fa?1:0}},{key:"dimension",value:function(y){return y instanceof ei?2:y instanceof ua?3:y instanceof fa?4:3}},{key:"create",value:function(){if(arguments.length===1){var y=arguments[0];return I.create(y,0)}if(arguments.length===2){var _=arguments[0],P=arguments[1];return _===2?new ei:_===3&&P===0?new Be:_===3&&P===1?new ua:_===4&&P===1?new fa:new Be}}}])})(),La=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getCoordinate",value:function(_){return this.get(_)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&Tr(arguments[0],zt)){for(var _=arguments[1],P=!1,$=arguments[0].iterator();$.hasNext();)this.add($.next(),_),P=!0;return P}return E(y,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var _=E(y,"clone",this,1).call(this),P=0;P<this.size();P++)_.add(P,this.get(P).clone());return _}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(y.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(y.coordArrayType);for(var _=this.size(),P=new Array(_).fill(null),$=0;$<_;$++)P[$]=this.get(_-$-1);return P}}},{key:"add",value:function(){if(arguments.length===1){var _=arguments[0];return E(y,"add",this,1).call(this,_)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var P=arguments[0],$=arguments[1];return this.add(P,$,!0),!0}if(arguments[0]instanceof Be&&typeof arguments[1]=="boolean"){var ne=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(ne))return null;E(y,"add",this,1).call(this,ne)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var ye=arguments[0],Oe=arguments[1];return this.add(ye,Oe),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var tt=arguments[0],ht=arguments[1];if(arguments[2])for(var rr=0;rr<tt.length;rr++)this.add(tt[rr],ht);else for(var ur=tt.length-1;ur>=0;ur--)this.add(tt[ur],ht);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Be){var qr=arguments[0],bn=arguments[1];if(!arguments[2]){var Dn=this.size();if(Dn>0&&(qr>0&&this.get(qr-1).equals2D(bn)||qr<Dn&&this.get(qr).equals2D(bn)))return null}E(y,"add",this,1).call(this,qr,bn)}}else if(arguments.length===4){var Xn=arguments[0],Fn=arguments[1],En=arguments[2],na=arguments[3],ca=1;En>na&&(ca=-1);for(var so=En;so!==na;so+=ca)this.add(Xn[so],Fn);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var _=this.get(0).copy();this.add(_,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var _=arguments[0];this.ensureCapacity(_.length),this.add(_,!0)}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.ensureCapacity(P.length),this.add(P,$)}}}}])})(ct);La.coordArrayType=new Array(0).fill(null);var Gi=(function(){function I(){i(this,I)}return o(I,null,[{key:"isRing",value:function(y){return!(y.length<4)&&!!y[0].equals2D(y[y.length-1])}},{key:"ptNotInList",value:function(y,_){for(var P=0;P<y.length;P++){var $=y[P];if(I.indexOf($,_)<0)return $}return null}},{key:"scroll",value:function(y,_){var P=I.indexOf(_,y);if(P<0)return null;var $=new Array(y.length).fill(null);Ar.arraycopy(y,P,$,0,y.length-P),Ar.arraycopy(y,0,$,y.length-P,P),Ar.arraycopy($,0,y,0,y.length)}},{key:"equals",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];if(y===_)return!0;if(y===null||_===null||y.length!==_.length)return!1;for(var P=0;P<y.length;P++)if(!y[P].equals(_[P]))return!1;return!0}if(arguments.length===3){var $=arguments[0],ne=arguments[1],ye=arguments[2];if($===ne)return!0;if($===null||ne===null||$.length!==ne.length)return!1;for(var Oe=0;Oe<$.length;Oe++)if(ye.compare($[Oe],ne[Oe])!==0)return!1;return!0}}},{key:"intersection",value:function(y,_){for(var P=new La,$=0;$<y.length;$++)_.intersects(y[$])&&P.add(y[$],!0);return P.toCoordinateArray()}},{key:"measures",value:function(y){if(y===null||y.length===0)return 0;var _,P=0,$=c(y);try{for($.s();!(_=$.n()).done;){var ne=_.value;P=Math.max(P,zn.measures(ne))}}catch(ye){$.e(ye)}finally{$.f()}return P}},{key:"hasRepeatedPoints",value:function(y){for(var _=1;_<y.length;_++)if(y[_-1].equals(y[_]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(y){return I.hasRepeatedPoints(y)?new La(y,!1).toCoordinateArray():y}},{key:"reverse",value:function(y){for(var _=y.length-1,P=Math.trunc(_/2),$=0;$<=P;$++){var ne=y[$];y[$]=y[_-$],y[_-$]=ne}}},{key:"removeNull",value:function(y){for(var _=0,P=0;P<y.length;P++)y[P]!==null&&_++;var $=new Array(_).fill(null);if(_===0)return $;for(var ne=0,ye=0;ye<y.length;ye++)y[ye]!==null&&($[ne++]=y[ye]);return $}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var y=arguments[0],_=new Array(y.length).fill(null),P=0;P<y.length;P++)_[P]=y[P].copy();return _}if(arguments.length===5)for(var $=arguments[0],ne=arguments[1],ye=arguments[2],Oe=arguments[3],tt=arguments[4],ht=0;ht<tt;ht++)ye[Oe+ht]=$[ne+ht].copy()}},{key:"isEqualReversed",value:function(y,_){for(var P=0;P<y.length;P++){var $=y[P],ne=_[y.length-P-1];if($.compareTo(ne)!==0)return!1}return!0}},{key:"envelope",value:function(y){for(var _=new Qe,P=0;P<y.length;P++)_.expandToInclude(y[P]);return _}},{key:"toCoordinateArray",value:function(y){return y.toArray(I.coordArrayType)}},{key:"dimension",value:function(y){if(y===null||y.length===0)return 3;var _,P=0,$=c(y);try{for($.s();!(_=$.n()).done;){var ne=_.value;P=Math.max(P,zn.dimension(ne))}}catch(ye){$.e(ye)}finally{$.f()}return P}},{key:"atLeastNCoordinatesOrNothing",value:function(y,_){return _.length>=y?_:[]}},{key:"indexOf",value:function(y,_){for(var P=0;P<_.length;P++)if(y.equals(_[P]))return P;return-1}},{key:"increasingDirection",value:function(y){for(var _=0;_<Math.trunc(y.length/2);_++){var P=y.length-1-_,$=y[_].compareTo(y[P]);if($!==0)return $}return 1}},{key:"compare",value:function(y,_){for(var P=0;P<y.length&&P<_.length;){var $=y[P].compareTo(_[P]);if($!==0)return $;P++}return P<_.length?-1:P<y.length?1:0}},{key:"minCoordinate",value:function(y){for(var _=null,P=0;P<y.length;P++)(_===null||_.compareTo(y[P])>0)&&(_=y[P]);return _}},{key:"extract",value:function(y,_,P){_=$r.clamp(_,0,y.length);var $=(P=$r.clamp(P,-1,y.length))-_+1;P<0&&($=0),_>=y.length&&($=0),P<_&&($=0);var ne=new Array($).fill(null);if($===0)return ne;for(var ye=0,Oe=_;Oe<=P;Oe++)ne[ye++]=y[Oe];return ne}}])})(),fs=(function(){return o((function I(){i(this,I)}),[{key:"compare",value:function(I,y){var _=I,P=y;return Gi.compare(_,P)}},{key:"interfaces_",get:function(){return[De]}}])})(),Ca=(function(){return o((function I(){i(this,I)}),[{key:"compare",value:function(I,y){var _=I,P=y;if(_.length<P.length)return-1;if(_.length>P.length)return 1;if(_.length===0)return 0;var $=Gi.compare(_,P);return Gi.isEqualReversed(_,P)?0:$}},{key:"OLDcompare",value:function(I,y){var _=I,P=y;if(_.length<P.length)return-1;if(_.length>P.length)return 1;if(_.length===0)return 0;for(var $=Gi.increasingDirection(_),ne=Gi.increasingDirection(P),ye=$>0?0:_.length-1,Oe=ne>0?0:_.length-1,tt=0;tt<_.length;tt++){var ht=_[ye].compareTo(P[Oe]);if(ht!==0)return ht;ye+=$,Oe+=ne}return 0}},{key:"interfaces_",get:function(){return[De]}}])})();Gi.ForwardComparator=fs,Gi.BidirectionalComparator=Ca,Gi.coordArrayType=new Array(0).fill(null);var Mo=(function(){return o((function I(y){i(this,I),this.str=y}),[{key:"append",value:function(I){this.str+=I}},{key:"setCharAt",value:function(I,y){this.str=this.str.substr(0,I)+y+this.str.substr(I+1)}},{key:"toString",value:function(){return this.str}}])})(),Ya=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getM",value:function(y){return this.hasM()?this._coordinates[y].getM():Ae.NaN}},{key:"setOrdinate",value:function(y,_,P){switch(_){case qe.X:this._coordinates[y].x=P;break;case qe.Y:this._coordinates[y].y=P;break;default:this._coordinates[y].setOrdinate(_,P)}}},{key:"getZ",value:function(y){return this.hasZ()?this._coordinates[y].getZ():Ae.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(y,_){switch(_){case qe.X:return this._coordinates[y].x;case qe.Y:return this._coordinates[y].y;default:return this._coordinates[y].getOrdinate(_)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var y=arguments[0];return this._coordinates[y]}if(arguments.length===2){var _=arguments[0];arguments[1].setCoordinate(this._coordinates[_])}}},{key:"getCoordinateCopy",value:function(y){var _=this.createCoordinate();return _.setCoordinate(this._coordinates[y]),_}},{key:"createCoordinate",value:function(){return zn.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(y){return this._coordinates[y].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(y){for(var _=0;_<this._coordinates.length;_++)y.expandToInclude(this._coordinates[_]);return y}},{key:"copy",value:function(){for(var y=new Array(this.size()).fill(null),_=0;_<this._coordinates.length;_++){var P=this.createCoordinate();P.setCoordinate(this._coordinates[_]),y[_]=P}return new I(y,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var y=new Mo(17*this._coordinates.length);y.append("("),y.append(this._coordinates[0]);for(var _=1;_<this._coordinates.length;_++)y.append(", "),y.append(this._coordinates[_]);return y.append(")"),y.toString()}return"()"}},{key:"getY",value:function(y){return this._coordinates[y].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[qe,X]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];I.constructor_.call(this,y,Gi.dimension(y),Gi.measures(y))}else if(Number.isInteger(arguments[0])){var _=arguments[0];this._coordinates=new Array(_).fill(null);for(var P=0;P<_;P++)this._coordinates[P]=new Be}else if(Tr(arguments[0],qe)){var $=arguments[0];if($===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=$.getDimension(),this._measures=$.getMeasures(),this._coordinates=new Array($.size()).fill(null);for(var ne=0;ne<this._coordinates.length;ne++)this._coordinates[ne]=$.getCoordinateCopy(ne)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var ye=arguments[0],Oe=arguments[1];I.constructor_.call(this,ye,Oe,Gi.measures(ye))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var tt=arguments[0],ht=arguments[1];this._coordinates=new Array(tt).fill(null),this._dimension=ht;for(var rr=0;rr<tt;rr++)this._coordinates[rr]=zn.create(ht)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var ur=arguments[0],qr=arguments[1],bn=arguments[2];this._dimension=qr,this._measures=bn,this._coordinates=ur===null?new Array(0).fill(null):ur}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Dn=arguments[0],Xn=arguments[1],Fn=arguments[2];this._coordinates=new Array(Dn).fill(null),this._dimension=Xn,this._measures=Fn;for(var En=0;En<Dn;En++)this._coordinates[En]=this.createCoordinate()}}}}])})(),ol=(function(){function I(){i(this,I)}return o(I,[{key:"readResolve",value:function(){return I.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new Ya(arguments[0]);if(Tr(arguments[0],qe))return new Ya(arguments[0])}else{if(arguments.length===2){var y=arguments[1];return y>3&&(y=3),y<2&&(y=2),new Ya(arguments[0],y)}if(arguments.length===3){var _=arguments[2],P=arguments[1]-_;return _>1&&(_=1),P>3&&(P=3),P<2&&(P=2),new Ya(arguments[0],P+_,_)}}}},{key:"interfaces_",get:function(){return[zr,X]}}],[{key:"instance",value:function(){return I.instanceObject}}])})();ol.instanceObject=new ol;var xi=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&E(y,"equalsExact",this,1).call(this,_,P)}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return rt.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var _=new ct,P=0;P<this._geometries.length;P++)for(var $=this._geometries[P].getBoundary(),ne=0;ne<$.getNumGeometries();ne++)_.add($.getGeometryN(ne));var ye=new Array(_.size()).fill(null);return this.getFactory().createMultiLineString(_.toArray(ye))}},{key:"getGeometryType",value:function(){return rt.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Ut]}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Fr.constructor_.call(this,_,P)}}])})(Fr),zi=(function(){return o((function I(){i(this,I)}),[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])})(),Iu=(function(I){function y(){var _;return i(this,y),(_=n(this,y)).map=new Map,_}return m(y,I),o(y,[{key:"get",value:function(_){return this.map.get(_)||null}},{key:"put",value:function(_,P){return this.map.set(_,P),P}},{key:"values",value:function(){for(var _=new ct,P=this.map.values(),$=P.next();!$.done;)_.add($.value),$=P.next();return _}},{key:"entrySet",value:function(){var _=new Ht;return this.map.entries().forEach((function(P){return _.add(P)})),_}},{key:"size",value:function(){return this.map.size()}}])})(zi),ga=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"equals",value:function(y){if(!(y instanceof I))return!1;var _=y;return this._modelType===_._modelType&&this._scale===_._scale}},{key:"compareTo",value:function(y){var _=y,P=this.getMaximumSignificantDigits(),$=_.getMaximumSignificantDigits();return at.compare(P,$)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===I.FLOATING||this._modelType===I.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var y="UNKNOWN";return this._modelType===I.FLOATING?y="Floating":this._modelType===I.FLOATING_SINGLE?y="Floating-Single":this._modelType===I.FIXED&&(y="Fixed (Scale="+this.getScale()+")"),y}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var y=arguments[0];return Ae.isNaN(y)||this._modelType===I.FLOATING_SINGLE?y:this._modelType===I.FIXED?Math.round(y*this._scale)/this._scale:y}if(arguments[0]instanceof Be){var _=arguments[0];if(this._modelType===I.FLOATING)return null;_.x=this.makePrecise(_.x),_.y=this.makePrecise(_.y)}}},{key:"getMaximumSignificantDigits",value:function(){var y=16;return this._modelType===I.FLOATING?y=16:this._modelType===I.FLOATING_SINGLE?y=6:this._modelType===I.FIXED&&(y=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),y}},{key:"setScale",value:function(y){this._scale=Math.abs(y)}},{key:"interfaces_",get:function(){return[X,H]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=I.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Za){var y=arguments[0];this._modelType=y,y===I.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var _=arguments[0];this._modelType=I.FIXED,this.setScale(_)}else if(arguments[0]instanceof I){var P=arguments[0];this._modelType=P._modelType,this._scale=P._scale}}}},{key:"mostPrecise",value:function(y,_){return y.compareTo(_)>=0?y:_}}])})(),Za=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"readResolve",value:function(){return I.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){this._name=null;var y=arguments[0];this._name=y,I.nameToTypeMap.put(y,this)}}])})();Za.nameToTypeMap=new Iu,ga.Type=Za,ga.FIXED=new Za("FIXED"),ga.FLOATING=new Za("FLOATING"),ga.FLOATING_SINGLE=new Za("FLOATING SINGLE"),ga.maximumPreciseValue=9007199254740992;var ds=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof rt){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&E(y,"equalsExact",this,1).call(this,_,P)}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?nr.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return rt.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new $e}},{key:"getGeometryType",value:function(){return rt.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[jn]}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Fr.constructor_.call(this,_,P)}}])})(Fr),Aa=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"createEmpty",value:function(y){switch(y){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new U("Invalid dimension: "+y)}}},{key:"toGeometry",value:function(y){return y.isNull()?this.createPoint():y.getMinX()===y.getMaxX()&&y.getMinY()===y.getMaxY()?this.createPoint(new Be(y.getMinX(),y.getMinY())):y.getMinX()===y.getMaxX()||y.getMinY()===y.getMaxY()?this.createLineString([new Be(y.getMinX(),y.getMinY()),new Be(y.getMaxX(),y.getMaxY())]):this.createPolygon(this.createLinearRing([new Be(y.getMinX(),y.getMinY()),new Be(y.getMinX(),y.getMaxY()),new Be(y.getMaxX(),y.getMaxY()),new Be(y.getMaxX(),y.getMinY()),new Be(y.getMinX(),y.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];return this.createLineString(y!==null?this.getCoordinateSequenceFactory().create(y):null)}if(Tr(arguments[0],qe))return new Kn(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new ds(null,this):arguments.length===1?new ds(arguments[0],this):void 0}},{key:"buildGeometry",value:function(y){for(var _=null,P=!1,$=!1,ne=y.iterator();ne.hasNext();){var ye=ne.next(),Oe=ye.getTypeCode();_===null&&(_=Oe),Oe!==_&&(P=!0),ye instanceof Fr&&($=!0)}if(_===null)return this.createGeometryCollection();if(P||$)return this.createGeometryCollection(I.toGeometryArray(y));var tt=y.iterator().next();if(y.size()>1){if(tt instanceof Xr)return this.createMultiPolygon(I.toPolygonArray(y));if(tt instanceof Kn)return this.createMultiLineString(I.toLineStringArray(y));if(tt instanceof He)return this.createMultiPoint(I.toPointArray(y));we.shouldNeverReachHere("Unhandled geometry type: "+tt.getGeometryType())}return tt}},{key:"createMultiPointFromCoords",value:function(y){return this.createMultiPoint(y!==null?this.getCoordinateSequenceFactory().create(y):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];return this.createPoint(y!==null?this.getCoordinateSequenceFactory().create([y]):null)}if(Tr(arguments[0],qe))return new He(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(Tr(arguments[0],qe)){var y=arguments[0];return this.createPolygon(this.createLinearRing(y))}if(arguments[0]instanceof Array){var _=arguments[0];return this.createPolygon(this.createLinearRing(_))}if(arguments[0]instanceof Bn){var P=arguments[0];return this.createPolygon(P,null)}}else if(arguments.length===2)return new Xr(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new Fr(null,this):arguments.length===1?new Fr(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];return this.createLinearRing(y!==null?this.getCoordinateSequenceFactory().create(y):null)}if(Tr(arguments[0],qe))return new Bn(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new xi(null,this):arguments.length===1?new xi(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Mn(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new Mn(arguments[0],this);if(Tr(arguments[0],qe)){var y=arguments[0];if(y===null)return this.createMultiPoint(new Array(0).fill(null));for(var _=new Array(y.size()).fill(null),P=0;P<y.size();P++){var $=this.getCoordinateSequenceFactory().create(1,y.getDimension(),y.getMeasures());Qr.copy(y,P,$,0,1),_[P]=this.createPoint($)}return this.createMultiPoint(_)}}}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)I.constructor_.call(this,new ga,0);else if(arguments.length===1){if(Tr(arguments[0],zr)){var y=arguments[0];I.constructor_.call(this,new ga,0,y)}else if(arguments[0]instanceof ga){var _=arguments[0];I.constructor_.call(this,_,0,I.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];I.constructor_.call(this,P,$,I.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var ne=arguments[0],ye=arguments[1],Oe=arguments[2];this._precisionModel=ne,this._coordinateSequenceFactory=Oe,this._SRID=ye}}},{key:"toMultiPolygonArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toGeometryArray",value:function(y){if(y===null)return null;var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return ol.instance()}},{key:"toMultiLineStringArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toLineStringArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toMultiPointArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toLinearRingArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toPointArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toPolygonArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"createPointFromInternalCoord",value:function(y,_){return _.getPrecisionModel().makePrecise(y),_.getFactory().createPoint(y)}}])})(),ps="XY",Ul="XYZ",Fa="XYM",_a="XYZM",xc={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},sl="EMPTY",ts=1,oo=2,rs=3,Ba=4,Us=5,Uc=6;for(var Pu in xc)xc[Pu].toUpperCase();var ee=(function(){return o((function I(y){i(this,I),this.wkt=y,this.index_=-1}),[{key:"isAlpha_",value:function(I){return I>="a"&&I<="z"||I>="A"&&I<="Z"}},{key:"isNumeric_",value:function(I,y){return I>="0"&&I<="9"||I=="."&&!(y!==void 0&&y)}},{key:"isWhiteSpace_",value:function(I){return I==" "||I=="	"||I=="\r"||I==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var I,y=this.nextChar_(),_=this.index_,P=y;if(y=="(")I=oo;else if(y==",")I=Us;else if(y==")")I=rs;else if(this.isNumeric_(y)||y=="-")I=Ba,P=this.readNumber_();else if(this.isAlpha_(y))I=ts,P=this.readText_();else{if(this.isWhiteSpace_(y))return this.nextToken();if(y!=="")throw new Error("Unexpected character: "+y);I=Uc}return{position:_,value:P,type:I}}},{key:"readNumber_",value:function(){var I,y=this.index_,_=!1,P=!1;do I=="."?_=!0:I!="e"&&I!="E"||(P=!0),I=this.nextChar_();while(this.isNumeric_(I,_)||!P&&(I=="e"||I=="E")||P&&(I=="-"||I=="+"));return parseFloat(this.wkt.substring(y,this.index_--))}},{key:"readText_",value:function(){var I,y=this.index_;do I=this.nextChar_();while(this.isAlpha_(I));return this.wkt.substring(y,this.index_--).toUpperCase()}}])})(),pe=(function(){return o((function I(y,_){i(this,I),this.lexer_=y,this.token_,this.layout_=ps,this.factory=_}),[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(I){return this.token_.type==I}},{key:"match",value:function(I){var y=this.isTokenType(I);return y&&this.consume_(),y}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var I=ps,y=this.token_;if(this.isTokenType(ts)){var _=y.value;_==="Z"?I=Ul:_==="M"?I=Fa:_==="ZM"&&(I=_a),I!==ps&&this.consume_()}return I}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(oo)){var I=[];do I.push(this.parseGeometry_());while(this.match(Us));if(this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(oo)){var I=this.parsePoint_();if(this.match(rs))return I}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(oo)){var I=this.parsePointList_();if(this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(oo)){var I=this.parseLineStringTextList_();if(this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var I;if(this.match(oo)){if(I=this.token_.type==oo?this.parsePointTextList_():this.parsePointList_(),this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(oo)){var I=this.parseLineStringTextList_();if(this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(oo)){var I=this.parsePolygonTextList_();if(this.match(rs))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var I=[],y=this.layout_.length,_=0;_<y;++_){var P=this.token_;if(!this.match(Ba))break;I.push(P.value)}if(I.length==y)return I;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var I=[this.parsePoint_()];this.match(Us);)I.push(this.parsePoint_());return I}},{key:"parsePointTextList_",value:function(){for(var I=[this.parsePointText_()];this.match(Us);)I.push(this.parsePointText_());return I}},{key:"parseLineStringTextList_",value:function(){for(var I=[this.parseLineStringText_()];this.match(Us);)I.push(this.parseLineStringText_());return I}},{key:"parsePolygonTextList_",value:function(){for(var I=[this.parsePolygonText_()];this.match(Us);)I.push(this.parsePolygonText_());return I}},{key:"isEmptyGeometry_",value:function(){var I=this.isTokenType(ts)&&this.token_.value==sl;return I&&this.consume_(),I}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var I=this.factory,y=function(Xn){return a(Be,T(Xn))},_=function(Xn){var Fn=Xn.map((function(En){return I.createLinearRing(En.map(y))}));return Fn.length>1?I.createPolygon(Fn[0],Fn.slice(1)):I.createPolygon(Fn[0])},P=this.token_;if(this.match(ts)){var $=P.value;if(this.layout_=this.parseGeometryLayout_(),$=="GEOMETRYCOLLECTION"){var ne=this.parseGeometryCollectionText_();return I.createGeometryCollection(ne)}switch($){case"POINT":var ye=this.parsePointText_();return ye?I.createPoint(a(Be,T(ye))):I.createPoint();case"LINESTRING":var Oe=this.parseLineStringText_().map(y);return I.createLineString(Oe);case"LINEARRING":var tt=this.parseLineStringText_().map(y);return I.createLinearRing(tt);case"POLYGON":var ht=this.parsePolygonText_();return ht&&ht.length!==0?_(ht):I.createPolygon();case"MULTIPOINT":var rr=this.parseMultiPointText_();if(!rr||rr.length===0)return I.createMultiPoint();var ur=rr.map(y).map((function(Xn){return I.createPoint(Xn)}));return I.createMultiPoint(ur);case"MULTILINESTRING":var qr=this.parseMultiLineStringText_().map((function(Xn){return I.createLineString(Xn.map(y))}));return I.createMultiLineString(qr);case"MULTIPOLYGON":var bn=this.parseMultiPolygonText_();if(!bn||bn.length===0)return I.createMultiPolygon();var Dn=bn.map(_);return I.createMultiPolygon(Dn);default:throw new Error("Invalid geometry type: "+$)}}throw new Error(this.formatErrorMessage_())}}])})();function Ke(I){if(I.isEmpty())return"";var y=I.getCoordinate(),_=[y.x,y.y];return y.z===void 0||Number.isNaN(y.z)||_.push(y.z),y.m===void 0||Number.isNaN(y.m)||_.push(y.m),_.join(" ")}function It(I){for(var y=I.getCoordinates().map((function(ne){var ye=[ne.x,ne.y];return ne.z===void 0||Number.isNaN(ne.z)||ye.push(ne.z),ne.m===void 0||Number.isNaN(ne.m)||ye.push(ne.m),ye})),_=[],P=0,$=y.length;P<$;++P)_.push(y[P].join(" "));return _.join(", ")}function Vt(I){var y=[];y.push("("+It(I.getExteriorRing())+")");for(var _=0,P=I.getNumInteriorRing();_<P;++_)y.push("("+It(I.getInteriorRingN(_))+")");return y.join(", ")}var $t={Point:Ke,LineString:It,LinearRing:It,Polygon:Vt,MultiPoint:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push("("+Ke(I.getGeometryN(_))+")");return y.join(", ")},MultiLineString:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push("("+It(I.getGeometryN(_))+")");return y.join(", ")},MultiPolygon:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push("("+Vt(I.getGeometryN(_))+")");return y.join(", ")},GeometryCollection:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push(er(I.getGeometryN(_)));return y.join(", ")}};function er(I){var y=I.getGeometryType(),_=$t[y];y=y.toUpperCase();var P=(function($){var ne="";if($.isEmpty())return ne;var ye=$.getCoordinate();return ye.z===void 0||Number.isNaN(ye.z)||(ne+="Z"),ye.m===void 0||Number.isNaN(ye.m)||(ne+="M"),ne})(I);return P.length>0&&(y+=" "+P),I.isEmpty()?y+" "+sl:y+" ("+_(I)+")"}var Yr=(function(){return o((function I(y){i(this,I),this.geometryFactory=y||new Aa,this.precisionModel=this.geometryFactory.getPrecisionModel()}),[{key:"read",value:function(I){var y=new ee(I);return new pe(y,this.geometryFactory).parse()}},{key:"write",value:function(I){return er(I)}}])})(),tn=(function(){return o((function I(y){i(this,I),this.parser=new Yr(y)}),[{key:"write",value:function(I){return this.parser.write(I)}}],[{key:"toLineString",value:function(I,y){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+I.x+" "+I.y+", "+y.x+" "+y.y+" )"}}])})(),Wr=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getIndexAlongSegment",value:function(y,_){return this.computeIntLineIndex(),this._intLineIndex[y][_]}},{key:"getTopologySummary",value:function(){var y=new Mo;return this.isEndPoint()&&y.append(" endpoint"),this._isProper&&y.append(" proper"),this.isCollinear()&&y.append(" collinear"),y.toString()}},{key:"computeIntersection",value:function(y,_,P,$){this._inputLines[0][0]=y,this._inputLines[0][1]=_,this._inputLines[1][0]=P,this._inputLines[1][1]=$,this._result=this.computeIntersect(y,_,P,$)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var y=arguments[0];this.getEdgeDistance(y,0)>this.getEdgeDistance(y,1)?(this._intLineIndex[y][0]=0,this._intLineIndex[y][1]=1):(this._intLineIndex[y][0]=1,this._intLineIndex[y][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(y){this._precisionModel=y}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var y=arguments[0],_=0;_<this._result;_++)if(!this._intPt[_].equals2D(this._inputLines[y][0])&&!this._intPt[_].equals2D(this._inputLines[y][1]))return!0;return!1}}},{key:"getIntersection",value:function(y){return this._intPt[y]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==I.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(y,_){return I.computeEdgeDistance(this._intPt[_],this._inputLines[y][0],this._inputLines[y][1])}},{key:"isCollinear",value:function(){return this._result===I.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return tn.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+tn.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(y,_){return this._inputLines[y][_]}},{key:"isIntersection",value:function(y){for(var _=0;_<this._result;_++)if(this._intPt[_].equals2D(y))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(y,_){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[y][_]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Be,this._intPt[1]=new Be,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(y,_,P){var $=Math.abs(P.x-_.x),ne=Math.abs(P.y-_.y),ye=-1;if(y.equals(_))ye=0;else if(y.equals(P))ye=$>ne?$:ne;else{var Oe=Math.abs(y.x-_.x),tt=Math.abs(y.y-_.y);(ye=$>ne?Oe:tt)!==0||y.equals(_)||(ye=Math.max(Oe,tt))}return we.isTrue(!(ye===0&&!y.equals(_)),"Bad distance calculation"),ye}},{key:"nonRobustComputeEdgeDistance",value:function(y,_,P){var $=y.x-_.x,ne=y.y-_.y,ye=Math.sqrt($*$+ne*ne);return we.isTrue(!(ye===0&&!y.equals(_)),"Invalid distance calculation"),ye}}])})();Wr.DONT_INTERSECT=0,Wr.DO_INTERSECT=1,Wr.COLLINEAR=2,Wr.NO_INTERSECTION=0,Wr.POINT_INTERSECTION=1,Wr.COLLINEAR_INTERSECTION=2;var on=(function(I){function y(){return i(this,y),n(this,y)}return m(y,I),o(y,[{key:"isInSegmentEnvelopes",value:function(_){var P=new Qe(this._inputLines[0][0],this._inputLines[0][1]),$=new Qe(this._inputLines[1][0],this._inputLines[1][1]);return P.contains(_)&&$.contains(_)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return E(y,"computeIntersection",this,1).apply(this,arguments);var _=arguments[0],P=arguments[1],$=arguments[2];if(this._isProper=!1,Qe.intersects(P,$,_)&&We.index(P,$,_)===0&&We.index($,P,_)===0)return this._isProper=!0,(_.equals(P)||_.equals($))&&(this._isProper=!1),this._result=Wr.POINT_INTERSECTION,null;this._result=Wr.NO_INTERSECTION}},{key:"intersection",value:function(_,P,$,ne){var ye=this.intersectionSafe(_,P,$,ne);return this.isInSegmentEnvelopes(ye)||(ye=new Be(y.nearestEndpoint(_,P,$,ne))),this._precisionModel!==null&&this._precisionModel.makePrecise(ye),ye}},{key:"checkDD",value:function(_,P,$,ne,ye){var Oe=je.intersection(_,P,$,ne),tt=this.isInSegmentEnvelopes(Oe);Ar.out.println("DD in env = "+tt+"  --------------------- "+Oe),ye.distance(Oe)>1e-4&&Ar.out.println("Distance = "+ye.distance(Oe))}},{key:"intersectionSafe",value:function(_,P,$,ne){var ye=Ir.intersection(_,P,$,ne);return ye===null&&(ye=y.nearestEndpoint(_,P,$,ne)),ye}},{key:"computeCollinearIntersection",value:function(_,P,$,ne){var ye=Qe.intersects(_,P,$),Oe=Qe.intersects(_,P,ne),tt=Qe.intersects($,ne,_),ht=Qe.intersects($,ne,P);return ye&&Oe?(this._intPt[0]=$,this._intPt[1]=ne,Wr.COLLINEAR_INTERSECTION):tt&&ht?(this._intPt[0]=_,this._intPt[1]=P,Wr.COLLINEAR_INTERSECTION):ye&&tt?(this._intPt[0]=$,this._intPt[1]=_,!$.equals(_)||Oe||ht?Wr.COLLINEAR_INTERSECTION:Wr.POINT_INTERSECTION):ye&&ht?(this._intPt[0]=$,this._intPt[1]=P,!$.equals(P)||Oe||tt?Wr.COLLINEAR_INTERSECTION:Wr.POINT_INTERSECTION):Oe&&tt?(this._intPt[0]=ne,this._intPt[1]=_,!ne.equals(_)||ye||ht?Wr.COLLINEAR_INTERSECTION:Wr.POINT_INTERSECTION):Oe&&ht?(this._intPt[0]=ne,this._intPt[1]=P,!ne.equals(P)||ye||tt?Wr.COLLINEAR_INTERSECTION:Wr.POINT_INTERSECTION):Wr.NO_INTERSECTION}},{key:"computeIntersect",value:function(_,P,$,ne){if(this._isProper=!1,!Qe.intersects(_,P,$,ne))return Wr.NO_INTERSECTION;var ye=We.index(_,P,$),Oe=We.index(_,P,ne);if(ye>0&&Oe>0||ye<0&&Oe<0)return Wr.NO_INTERSECTION;var tt=We.index($,ne,_),ht=We.index($,ne,P);return tt>0&&ht>0||tt<0&&ht<0?Wr.NO_INTERSECTION:ye===0&&Oe===0&&tt===0&&ht===0?this.computeCollinearIntersection(_,P,$,ne):(ye===0||Oe===0||tt===0||ht===0?(this._isProper=!1,_.equals2D($)||_.equals2D(ne)?this._intPt[0]=_:P.equals2D($)||P.equals2D(ne)?this._intPt[0]=P:ye===0?this._intPt[0]=new Be($):Oe===0?this._intPt[0]=new Be(ne):tt===0?this._intPt[0]=new Be(_):ht===0&&(this._intPt[0]=new Be(P))):(this._isProper=!0,this._intPt[0]=this.intersection(_,P,$,ne)),Wr.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(_,P,$,ne){var ye=_,Oe=hn.pointToSegment(_,$,ne),tt=hn.pointToSegment(P,$,ne);return tt<Oe&&(Oe=tt,ye=P),(tt=hn.pointToSegment($,_,P))<Oe&&(Oe=tt,ye=$),(tt=hn.pointToSegment(ne,_,P))<Oe&&(Oe=tt,ye=ne),ye}}])})(Wr),kr=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"countSegment",value:function(y,_){if(y.x<this._p.x&&_.x<this._p.x)return null;if(this._p.x===_.x&&this._p.y===_.y)return this._isPointOnSegment=!0,null;if(y.y===this._p.y&&_.y===this._p.y){var P=y.x,$=_.x;return P>$&&(P=_.x,$=y.x),this._p.x>=P&&this._p.x<=$&&(this._isPointOnSegment=!0),null}if(y.y>this._p.y&&_.y<=this._p.y||_.y>this._p.y&&y.y<=this._p.y){var ne=We.index(y,_,this._p);if(ne===We.COLLINEAR)return this._isPointOnSegment=!0,null;_.y<y.y&&(ne=-ne),ne===We.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==Re.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?Re.BOUNDARY:this._crossingCount%2==1?Re.INTERIOR:Re.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var y=arguments[0];this._p=y}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof Be&&Tr(arguments[1],qe)){for(var y=arguments[1],_=new I(arguments[0]),P=new Be,$=new Be,ne=1;ne<y.size();ne++)if(y.getCoordinate(ne,P),y.getCoordinate(ne-1,$),_.countSegment(P,$),_.isOnSegment())return _.getLocation();return _.getLocation()}if(arguments[0]instanceof Be&&arguments[1]instanceof Array){for(var ye=arguments[1],Oe=new I(arguments[0]),tt=1;tt<ye.length;tt++){var ht=ye[tt],rr=ye[tt-1];if(Oe.countSegment(ht,rr),Oe.isOnSegment())return Oe.getLocation()}return Oe.getLocation()}}}])})(),ti=(function(){function I(){i(this,I)}return o(I,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof Be&&Tr(arguments[1],qe)){for(var y=arguments[0],_=arguments[1],P=new on,$=new Be,ne=new Be,ye=_.size(),Oe=1;Oe<ye;Oe++)if(_.getCoordinate(Oe-1,$),_.getCoordinate(Oe,ne),P.computeIntersection(y,$,ne),P.hasIntersection())return!0;return!1}if(arguments[0]instanceof Be&&arguments[1]instanceof Array){for(var tt=arguments[0],ht=arguments[1],rr=new on,ur=1;ur<ht.length;ur++){var qr=ht[ur-1],bn=ht[ur];if(rr.computeIntersection(tt,qr,bn),rr.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(y,_){return kr.locatePointInRing(y,_)}},{key:"isInRing",value:function(y,_){return I.locateInRing(y,_)!==Re.EXTERIOR}}])})(),Ri=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"setAllLocations",value:function(y){for(var _=0;_<this.location.length;_++)this.location[_]=y}},{key:"isNull",value:function(){for(var y=0;y<this.location.length;y++)if(this.location[y]!==Re.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(y){for(var _=0;_<this.location.length;_++)this.location[_]===Re.NONE&&(this.location[_]=y)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(y){if(y.location.length>this.location.length){var _=new Array(3).fill(null);_[_t.ON]=this.location[_t.ON],_[_t.LEFT]=Re.NONE,_[_t.RIGHT]=Re.NONE,this.location=_}for(var P=0;P<this.location.length;P++)this.location[P]===Re.NONE&&P<y.location.length&&(this.location[P]=y.location[P])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var y=this.location[_t.LEFT];this.location[_t.LEFT]=this.location[_t.RIGHT],this.location[_t.RIGHT]=y}},{key:"toString",value:function(){var y=new Qt;return this.location.length>1&&y.append(Re.toLocationSymbol(this.location[_t.LEFT])),y.append(Re.toLocationSymbol(this.location[_t.ON])),this.location.length>1&&y.append(Re.toLocationSymbol(this.location[_t.RIGHT])),y.toString()}},{key:"setLocations",value:function(y,_,P){this.location[_t.ON]=y,this.location[_t.LEFT]=_,this.location[_t.RIGHT]=P}},{key:"get",value:function(y){return y<this.location.length?this.location[y]:Re.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var y=0;y<this.location.length;y++)if(this.location[y]===Re.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var y=arguments[0];this.setLocation(_t.ON,y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.location[_]=P}}},{key:"init",value:function(y){this.location=new Array(y).fill(null),this.setAllLocations(Re.NONE)}},{key:"isEqualOnSide",value:function(y,_){return this.location[_]===y.location[_]}},{key:"allPositionsEqual",value:function(y){for(var _=0;_<this.location.length;_++)if(this.location[_]!==y)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];this.init(y.length)}else if(Number.isInteger(arguments[0])){var _=arguments[0];this.init(1),this.location[_t.ON]=_}else if(arguments[0]instanceof I){var P=arguments[0];if(this.init(P.location.length),P!==null)for(var $=0;$<this.location.length;$++)this.location[$]=P.location[$]}}else if(arguments.length===3){var ne=arguments[0],ye=arguments[1],Oe=arguments[2];this.init(3),this.location[_t.ON]=ne,this.location[_t.LEFT]=ye,this.location[_t.RIGHT]=Oe}}}])})(),$n=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getGeometryCount",value:function(){var y=0;return this.elt[0].isNull()||y++,this.elt[1].isNull()||y++,y}},{key:"setAllLocations",value:function(y,_){this.elt[y].setAllLocations(_)}},{key:"isNull",value:function(y){return this.elt[y].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var y=arguments[0];this.setAllLocationsIfNull(0,y),this.setAllLocationsIfNull(1,y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.elt[_].setAllLocationsIfNull(P)}}},{key:"isLine",value:function(y){return this.elt[y].isLine()}},{key:"merge",value:function(y){for(var _=0;_<2;_++)this.elt[_]===null&&y.elt[_]!==null?this.elt[_]=new Ri(y.elt[_]):this.elt[_].merge(y.elt[_])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var y=arguments[0];return this.elt[y].get(_t.ON)}if(arguments.length===2){var _=arguments[0],P=arguments[1];return this.elt[_].get(P)}}},{key:"toString",value:function(){var y=new Qt;return this.elt[0]!==null&&(y.append("A:"),y.append(this.elt[0].toString())),this.elt[1]!==null&&(y.append(" B:"),y.append(this.elt[1].toString())),y.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var y=arguments[0];return this.elt[y].isArea()}}},{key:"isAnyNull",value:function(y){return this.elt[y].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];this.elt[y].setLocation(_t.ON,_)}else if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2];this.elt[P].setLocation($,ne)}}},{key:"isEqualOnSide",value:function(y,_){return this.elt[0].isEqualOnSide(y.elt[0],_)&&this.elt[1].isEqualOnSide(y.elt[1],_)}},{key:"allPositionsEqual",value:function(y,_){return this.elt[y].allPositionsEqual(_)}},{key:"toLine",value:function(y){this.elt[y].isArea()&&(this.elt[y]=new Ri(this.elt[y].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var y=arguments[0];this.elt[0]=new Ri(y),this.elt[1]=new Ri(y)}else if(arguments[0]instanceof I){var _=arguments[0];this.elt[0]=new Ri(_.elt[0]),this.elt[1]=new Ri(_.elt[1])}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.elt[0]=new Ri(Re.NONE),this.elt[1]=new Ri(Re.NONE),this.elt[P].setLocation($)}else if(arguments.length===3){var ne=arguments[0],ye=arguments[1],Oe=arguments[2];this.elt[0]=new Ri(ne,ye,Oe),this.elt[1]=new Ri(ne,ye,Oe)}else if(arguments.length===4){var tt=arguments[0],ht=arguments[1],rr=arguments[2],ur=arguments[3];this.elt[0]=new Ri(Re.NONE,Re.NONE,Re.NONE),this.elt[1]=new Ri(Re.NONE,Re.NONE,Re.NONE),this.elt[tt].setLocations(ht,rr,ur)}}},{key:"toLineLabel",value:function(y){for(var _=new I(Re.NONE),P=0;P<2;P++)_.setLocation(P,y.getLocation(P));return _}}])})(),_n=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var I=new Array(this._pts.size()).fill(null),y=0;y<this._pts.size();y++)I[y]=this._pts.get(y);this._ring=this._geometryFactory.createLinearRing(I),this._isHole=We.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(I){this._startDe=I;var y=I,_=!0;do{if(y===null)throw new Et("Found null DirectedEdge");if(y.getEdgeRing()===this)throw new Et("Directed Edge visited twice during ring-building at "+y.getCoordinate());this._edges.add(y);var P=y.getLabel();we.isTrue(P.isArea()),this.mergeLabel(P),this.addPoints(y.getEdge(),y.isForward(),_),_=!1,this.setEdgeRing(y,this),y=this.getNext(y)}while(y!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(I){return this._pts.get(I)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var I=this._startDe;do{var y=I.getNode().getEdges().getOutgoingDegree(this);y>this._maxNodeDegree&&(this._maxNodeDegree=y),I=this.getNext(I)}while(I!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(I,y,_){var P=I.getCoordinates();if(y){var $=1;_&&($=0);for(var ne=$;ne<P.length;ne++)this._pts.add(P[ne])}else{var ye=P.length-2;_&&(ye=P.length-1);for(var Oe=ye;Oe>=0;Oe--)this._pts.add(P[Oe])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var I=this._startDe;do I.getEdge().setInResult(!0),I=I.getNext();while(I!==this._startDe)}},{key:"containsPoint",value:function(I){var y=this.getLinearRing();if(!y.getEnvelopeInternal().contains(I)||!ti.isInRing(I,y.getCoordinates()))return!1;for(var _=this._holes.iterator();_.hasNext();)if(_.next().containsPoint(I))return!1;return!0}},{key:"addHole",value:function(I){this._holes.add(I)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var I=arguments[0];this.mergeLabel(I,0),this.mergeLabel(I,1)}else if(arguments.length===2){var y=arguments[1],_=arguments[0].getLocation(y,_t.RIGHT);if(_===Re.NONE)return null;if(this._label.getLocation(y)===Re.NONE)return this._label.setLocation(y,_),null}}},{key:"setShell",value:function(I){this._shell=I,I!==null&&I.addHole(this)}},{key:"toPolygon",value:function(I){for(var y=new Array(this._holes.size()).fill(null),_=0;_<this._holes.size();_++)y[_]=this._holes.get(_).getLinearRing();return I.createPolygon(this.getLinearRing(),y)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new ct,this._pts=new ct,this._label=new $n(Re.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new ct,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var I=arguments[0],y=arguments[1];this._geometryFactory=y,this.computePoints(I),this.computeRing()}}}}])})(),Mr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"setEdgeRing",value:function(_,P){_.setMinEdgeRing(P)}},{key:"getNext",value:function(_){return _.getNextMin()}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];_n.constructor_.call(this,_,P)}}])})(_n),fn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"buildMinimalRings",value:function(){var _=new ct,P=this._startDe;do{if(P.getMinEdgeRing()===null){var $=new Mr(P,this._geometryFactory);_.add($)}P=P.getNext()}while(P!==this._startDe);return _}},{key:"setEdgeRing",value:function(_,P){_.setEdgeRing(P)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var _=this._startDe;do _.getNode().getEdges().linkMinimalDirectedEdges(this),_=_.getNext();while(_!==this._startDe)}},{key:"getNext",value:function(_){return _.getNext()}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];_n.constructor_.call(this,_,P)}}])})(_n),mn=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"setVisited",value:function(I){this._isVisited=I}},{key:"setInResult",value:function(I){this._isInResult=I}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(I){this._label=I}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(I){this._isCovered=I,this._isCoveredSet=!0}},{key:"updateIM",value:function(I){we.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(I)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var I=arguments[0];this._label=I}}}}])})(),hi=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"isIncidentEdgeInResult",value:function(){for(var _=this.getEdges().getEdges().iterator();_.hasNext();)if(_.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(_){_.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(_){}},{key:"computeMergedLocation",value:function(_,P){var $=Re.NONE;if($=this._label.getLocation(P),!_.isNull(P)){var ne=_.getLocation(P);$!==Re.BOUNDARY&&($=ne)}return $}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return E(y,"setLabel",this,1).apply(this,arguments);var _=arguments[0],P=arguments[1];this._label===null?this._label=new $n(_,P):this._label.setLocation(_,P)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof y){var _=arguments[0];this.mergeLabel(_._label)}else if(arguments[0]instanceof $n)for(var P=arguments[0],$=0;$<2;$++){var ne=this.computeMergedLocation(P,$);this._label.getLocation($)===Re.NONE&&this._label.setLocation($,ne)}}},{key:"add",value:function(_){this._edges.insert(_),_.setNode(this)}},{key:"setLabelBoundary",value:function(_){if(this._label===null)return null;var P=Re.NONE;this._label!==null&&(P=this._label.getLocation(_));var $=null;switch(P){case Re.BOUNDARY:$=Re.INTERIOR;break;case Re.INTERIOR:default:$=Re.BOUNDARY}this._label.setLocation(_,$)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var _=arguments[0],P=arguments[1];this._coord=_,this._edges=P,this._label=new $n(0,Re.NONE)}}])})(mn),$i=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y)})(zi);function ba(I){return I==null?0:I.color}function wi(I){return I==null?null:I.parent}function fi(I,y){I!==null&&(I.color=y)}function Ts(I){return I==null?null:I.left}function Vs(I){return I==null?null:I.right}var Mi=(function(I){function y(){var _;return i(this,y),(_=n(this,y)).root_=null,_.size_=0,_}return m(y,I),o(y,[{key:"get",value:function(_){for(var P=this.root_;P!==null;){var $=_.compareTo(P.key);if($<0)P=P.left;else{if(!($>0))return P.value;P=P.right}}return null}},{key:"put",value:function(_,P){if(this.root_===null)return this.root_={key:_,value:P,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var $,ne,ye=this.root_;do if($=ye,(ne=_.compareTo(ye.key))<0)ye=ye.left;else{if(!(ne>0)){var Oe=ye.value;return ye.value=P,Oe}ye=ye.right}while(ye!==null);var tt={key:_,left:null,right:null,value:P,parent:$,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return ne<0?$.left=tt:$.right=tt,this.fixAfterInsertion(tt),this.size_++,null}},{key:"fixAfterInsertion",value:function(_){var P;for(_.color=1;_!=null&&_!==this.root_&&_.parent.color===1;)wi(_)===Ts(wi(wi(_)))?ba(P=Vs(wi(wi(_))))===1?(fi(wi(_),0),fi(P,0),fi(wi(wi(_)),1),_=wi(wi(_))):(_===Vs(wi(_))&&(_=wi(_),this.rotateLeft(_)),fi(wi(_),0),fi(wi(wi(_)),1),this.rotateRight(wi(wi(_)))):ba(P=Ts(wi(wi(_))))===1?(fi(wi(_),0),fi(P,0),fi(wi(wi(_)),1),_=wi(wi(_))):(_===Ts(wi(_))&&(_=wi(_),this.rotateRight(_)),fi(wi(_),0),fi(wi(wi(_)),1),this.rotateLeft(wi(wi(_))));this.root_.color=0}},{key:"values",value:function(){var _=new ct,P=this.getFirstEntry();if(P!==null)for(_.add(P.value);(P=y.successor(P))!==null;)_.add(P.value);return _}},{key:"entrySet",value:function(){var _=new Ht,P=this.getFirstEntry();if(P!==null)for(_.add(P);(P=y.successor(P))!==null;)_.add(P);return _}},{key:"rotateLeft",value:function(_){if(_!=null){var P=_.right;_.right=P.left,P.left!=null&&(P.left.parent=_),P.parent=_.parent,_.parent==null?this.root_=P:_.parent.left===_?_.parent.left=P:_.parent.right=P,P.left=_,_.parent=P}}},{key:"rotateRight",value:function(_){if(_!=null){var P=_.left;_.left=P.right,P.right!=null&&(P.right.parent=_),P.parent=_.parent,_.parent==null?this.root_=P:_.parent.right===_?_.parent.right=P:_.parent.left=P,P.right=_,_.parent=P}}},{key:"getFirstEntry",value:function(){var _=this.root_;if(_!=null)for(;_.left!=null;)_=_.left;return _}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(_){for(var P=this.root_;P!==null;){var $=_.compareTo(P.key);if($<0)P=P.left;else{if(!($>0))return!0;P=P.right}}return!1}}],[{key:"successor",value:function(_){var P;if(_===null)return null;if(_.right!==null){for(P=_.right;P.left!==null;)P=P.left;return P}P=_.parent;for(var $=_;P!==null&&$===P.right;)$=P,P=P.parent;return P}}])})($i),Cs=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"find",value:function(I){return this.nodeMap.get(I)}},{key:"addNode",value:function(){if(arguments[0]instanceof Be){var I=arguments[0],y=this.nodeMap.get(I);return y===null&&(y=this.nodeFact.createNode(I),this.nodeMap.put(I,y)),y}if(arguments[0]instanceof hi){var _=arguments[0],P=this.nodeMap.get(_.getCoordinate());return P===null?(this.nodeMap.put(_.getCoordinate(),_),_):(P.mergeLabel(_),P)}}},{key:"print",value:function(I){for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(I){for(var y=new ct,_=this.iterator();_.hasNext();){var P=_.next();P.getLabel().getLocation(I)===Re.BOUNDARY&&y.add(P)}return y}},{key:"add",value:function(I){var y=I.getCoordinate();this.addNode(y).add(I)}}],[{key:"constructor_",value:function(){this.nodeMap=new Mi,this.nodeFact=null;var I=arguments[0];this.nodeFact=I}}])})(),oa=(function(){function I(){i(this,I)}return o(I,null,[{key:"isNorthern",value:function(y){return y===I.NE||y===I.NW}},{key:"isOpposite",value:function(y,_){return y!==_&&(y-_+4)%4===2}},{key:"commonHalfPlane",value:function(y,_){if(y===_)return y;if((y-_+4)%4===2)return-1;var P=y<_?y:_;return P===0&&(y>_?y:_)===3?3:P}},{key:"isInHalfPlane",value:function(y,_){return _===I.SE?y===I.SE||y===I.SW:y===_||y===_+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1];if(y===0&&_===0)throw new U("Cannot compute the quadrant for point ( "+y+", "+_+" )");return y>=0?_>=0?I.NE:I.SE:_>=0?I.NW:I.SW}if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var P=arguments[0],$=arguments[1];if($.x===P.x&&$.y===P.y)throw new U("Cannot compute the quadrant for two identical points "+P);return $.x>=P.x?$.y>=P.y?I.NE:I.SE:$.y>=P.y?I.NW:I.SW}}}])})();oa.NE=0,oa.NW=1,oa.SW=2,oa.SE=3;var ku=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"compareDirection",value:function(y){return this._dx===y._dx&&this._dy===y._dy?0:this._quadrant>y._quadrant?1:this._quadrant<y._quadrant?-1:We.index(y._p0,y._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(y){this._node=y}},{key:"print",value:function(y){var _=Math.atan2(this._dy,this._dx),P=this.getClass().getName(),$=P.lastIndexOf("."),ne=P.substring($+1);y.print("  "+ne+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+_+"   "+this._label)}},{key:"compareTo",value:function(y){var _=y;return this.compareDirection(_)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var y=Math.atan2(this._dy,this._dx),_=this.getClass().getName(),P=_.lastIndexOf(".");return"  "+_.substring(P+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+y+"   "+this._label}},{key:"computeLabel",value:function(y){}},{key:"init",value:function(y,_){this._p0=y,this._p1=_,this._dx=_.x-y.x,this._dy=_.y-y.y,this._quadrant=oa.quadrant(this._dx,this._dy),we.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var y=arguments[0];this._edge=y}else if(arguments.length===3){var _=arguments[0],P=arguments[1],$=arguments[2];I.constructor_.call(this,_,P,$,null)}else if(arguments.length===4){var ne=arguments[0],ye=arguments[1],Oe=arguments[2],tt=arguments[3];I.constructor_.call(this,ne),this.init(ye,Oe),this._label=tt}}}])})(),Ka=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(_){return this._depth[_]}},{key:"setVisited",value:function(_){this._isVisited=_}},{key:"computeDirectedLabel",value:function(){this._label=new $n(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(_,P){if(this._depth[_]!==-999&&this._depth[_]!==P)throw new Et("assigned depths do not match",this.getCoordinate());this._depth[_]=P}},{key:"isInteriorAreaEdge",value:function(){for(var _=!0,P=0;P<2;P++)this._label.isArea(P)&&this._label.getLocation(P,_t.LEFT)===Re.INTERIOR&&this._label.getLocation(P,_t.RIGHT)===Re.INTERIOR||(_=!1);return _}},{key:"setNextMin",value:function(_){this._nextMin=_}},{key:"print",value:function(_){E(y,"print",this,1).call(this,_),_.print(" "+this._depth[_t.LEFT]+"/"+this._depth[_t.RIGHT]),_.print(" ("+this.getDepthDelta()+")"),this._isInResult&&_.print(" inResult")}},{key:"setMinEdgeRing",value:function(_){this._minEdgeRing=_}},{key:"isLineEdge",value:function(){var _=this._label.isLine(0)||this._label.isLine(1),P=!this._label.isArea(0)||this._label.allPositionsEqual(0,Re.EXTERIOR),$=!this._label.isArea(1)||this._label.allPositionsEqual(1,Re.EXTERIOR);return _&&P&&$}},{key:"setEdgeRing",value:function(_){this._edgeRing=_}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var _=this._edge.getDepthDelta();return this._isForward||(_=-_),_}},{key:"setInResult",value:function(_){this._isInResult=_}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(_){this.print(_),_.print(" "),this._isForward?this._edge.print(_):this._edge.printReverse(_)}},{key:"setSym",value:function(_){this._sym=_}},{key:"setVisitedEdge",value:function(_){this.setVisited(_),this._sym.setVisited(_)}},{key:"setEdgeDepths",value:function(_,P){var $=this.getEdge().getDepthDelta();this._isForward||($=-$);var ne=1;_===_t.LEFT&&(ne=-1);var ye=_t.opposite(_),Oe=P+$*ne;this.setDepth(_,P),this.setDepth(ye,Oe)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(_){this._next=_}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var _=arguments[0],P=arguments[1];if(ku.constructor_.call(this,_),this._isForward=P,P)this.init(_.getCoordinate(0),_.getCoordinate(1));else{var $=_.getNumPoints()-1;this.init(_.getCoordinate($),_.getCoordinate($-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(_,P){return _===Re.EXTERIOR&&P===Re.INTERIOR?1:_===Re.INTERIOR&&P===Re.EXTERIOR?-1:0}}])})(ku),$s=(function(){return o((function I(){i(this,I)}),[{key:"createNode",value:function(I){return new hi(I,null)}}])})(),Vo=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"printEdges",value:function(I){I.println("Edges:");for(var y=0;y<this._edges.size();y++){I.println("edge "+y+":");var _=this._edges.get(y);_.print(I),_.eiList.print(I)}}},{key:"find",value:function(I){return this._nodes.find(I)}},{key:"addNode",value:function(){if(arguments[0]instanceof hi){var I=arguments[0];return this._nodes.addNode(I)}if(arguments[0]instanceof Be){var y=arguments[0];return this._nodes.addNode(y)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var I=this._nodes.iterator();I.hasNext();)I.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(I){Ar.out.println(I)}},{key:"isBoundaryNode",value:function(I,y){var _=this._nodes.find(y);if(_===null)return!1;var P=_.getLabel();return P!==null&&P.getLocation(I)===Re.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var I=this._nodes.iterator();I.hasNext();)I.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(I,y,_,P){return!!I.equals(_)&&We.index(I,y,P)===We.COLLINEAR&&oa.quadrant(I,y)===oa.quadrant(_,P)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(I){Ar.out.print(I)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(I,y){for(var _=0;_<this._edges.size();_++){var P=this._edges.get(_),$=P.getCoordinates();if(this.matchInSameDirection(I,y,$[0],$[1])||this.matchInSameDirection(I,y,$[$.length-1],$[$.length-2]))return P}return null}},{key:"insertEdge",value:function(I){this._edges.add(I)}},{key:"findEdgeEnd",value:function(I){for(var y=this.getEdgeEnds().iterator();y.hasNext();){var _=y.next();if(_.getEdge()===I)return _}return null}},{key:"addEdges",value:function(I){for(var y=I.iterator();y.hasNext();){var _=y.next();this._edges.add(_);var P=new Ka(_,!0),$=new Ka(_,!1);P.setSym($),$.setSym(P),this.add(P),this.add($)}}},{key:"add",value:function(I){this._nodes.add(I),this._edgeEndList.add(I)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(I,y){for(var _=0;_<this._edges.size();_++){var P=this._edges.get(_),$=P.getCoordinates();if(I.equals($[0])&&y.equals($[1]))return P}return null}}],[{key:"constructor_",value:function(){if(this._edges=new ct,this._nodes=null,this._edgeEndList=new ct,arguments.length===0)this._nodes=new Cs(new $s);else if(arguments.length===1){var I=arguments[0];this._nodes=new Cs(I)}}},{key:"linkResultDirectedEdges",value:function(I){for(var y=I.iterator();y.hasNext();)y.next().getEdges().linkResultDirectedEdges()}}])})(),Ru=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"sortShellsAndHoles",value:function(y,_,P){for(var $=y.iterator();$.hasNext();){var ne=$.next();ne.isHole()?P.add(ne):_.add(ne)}}},{key:"computePolygons",value:function(y){for(var _=new ct,P=y.iterator();P.hasNext();){var $=P.next().toPolygon(this._geometryFactory);_.add($)}return _}},{key:"placeFreeHoles",value:function(y,_){for(var P=_.iterator();P.hasNext();){var $=P.next();if($.getShell()===null){var ne=I.findEdgeRingContaining($,y);if(ne===null)throw new Et("unable to assign hole to a shell",$.getCoordinate(0));$.setShell(ne)}}}},{key:"buildMinimalEdgeRings",value:function(y,_,P){for(var $=new ct,ne=y.iterator();ne.hasNext();){var ye=ne.next();if(ye.getMaxNodeDegree()>2){ye.linkDirectedEdgesForMinimalEdgeRings();var Oe=ye.buildMinimalRings(),tt=this.findShell(Oe);tt!==null?(this.placePolygonHoles(tt,Oe),_.add(tt)):P.addAll(Oe)}else $.add(ye)}return $}},{key:"buildMaximalEdgeRings",value:function(y){for(var _=new ct,P=y.iterator();P.hasNext();){var $=P.next();if($.isInResult()&&$.getLabel().isArea()&&$.getEdgeRing()===null){var ne=new fn($,this._geometryFactory);_.add(ne),ne.setInResult()}}return _}},{key:"placePolygonHoles",value:function(y,_){for(var P=_.iterator();P.hasNext();){var $=P.next();$.isHole()&&$.setShell(y)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(y){for(var _=0,P=null,$=y.iterator();$.hasNext();){var ne=$.next();ne.isHole()||(P=ne,_++)}return we.isTrue(_<=1,"found two shells in MinimalEdgeRing list"),P}},{key:"add",value:function(){if(arguments.length===1){var y=arguments[0];this.add(y.getEdgeEnds(),y.getNodes())}else if(arguments.length===2){var _=arguments[0],P=arguments[1];Vo.linkResultDirectedEdges(P);var $=this.buildMaximalEdgeRings(_),ne=new ct,ye=this.buildMinimalEdgeRings($,this._shellList,ne);this.sortShellsAndHoles(ye,this._shellList,ne),this.placeFreeHoles(this._shellList,ne)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new ct;var y=arguments[0];this._geometryFactory=y}},{key:"findEdgeRingContaining",value:function(y,_){for(var P=y.getLinearRing(),$=P.getEnvelopeInternal(),ne=P.getCoordinateN(0),ye=null,Oe=null,tt=_.iterator();tt.hasNext();){var ht=tt.next(),rr=ht.getLinearRing(),ur=rr.getEnvelopeInternal();if(!ur.equals($)&&ur.contains($)){ne=Gi.ptNotInList(P.getCoordinates(),rr.getCoordinates());var qr=!1;ti.isInRing(ne,rr.getCoordinates())&&(qr=!0),qr&&(ye===null||Oe.contains(ur))&&(Oe=(ye=ht).getLinearRing().getEnvelopeInternal())}}return ye}}])})(),Mu=(function(){return o((function I(){i(this,I)}),[{key:"getBounds",value:function(){}}])})(),go=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[Mu,X]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var I=arguments[0],y=arguments[1];this._bounds=I,this._item=y}}])})(),ji=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"poll",value:function(){if(this.isEmpty())return null;var I=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),I}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(I){for(var y=null,_=this._items.get(I);2*I<=this._size&&((y=2*I)!==this._size&&this._items.get(y+1).compareTo(this._items.get(y))<0&&y++,this._items.get(y).compareTo(_)<0);I=y)this._items.set(I,this._items.get(y));this._items.set(I,_)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(I){this._items.add(null),this._size+=1;var y=this._size;for(this._items.set(0,I);I.compareTo(this._items.get(Math.trunc(y/2)))<0;y/=2)this._items.set(y,this._items.get(Math.trunc(y/2)));this._items.set(y,I)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new ct,this._items.add(null)}}])})(),qs=(function(){return o((function I(){i(this,I)}),[{key:"insert",value:function(I,y){}},{key:"remove",value:function(I,y){}},{key:"query",value:function(){}}])})(),ii=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(I){we.isTrue(this._bounds===null),this._childBoundables.add(I)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[Mu,X]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new ct,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var I=arguments[0];this._level=I}}}}])})(),ri={reverseOrder:function(){return{compare:function(I,y){return y.compareTo(I)}}},min:function(I){return ri.sort(I),I.get(0)},sort:function(I,y){var _=I.toArray();y?Wt.sort(_,y):Wt.sort(_);for(var P=I.iterator(),$=0,ne=_.length;$<ne;$++)P.next(),P.set(_[$])},singletonList:function(I){var y=new ct;return y.add(I),y}},Do=(function(){function I(){i(this,I)}return o(I,null,[{key:"maxDistance",value:function(y,_,P,$,ne,ye,Oe,tt){var ht=I.distance(y,_,ne,ye);return ht=Math.max(ht,I.distance(y,_,Oe,tt)),ht=Math.max(ht,I.distance(P,$,ne,ye)),ht=Math.max(ht,I.distance(P,$,Oe,tt))}},{key:"distance",value:function(y,_,P,$){var ne=P-y,ye=$-_;return Math.sqrt(ne*ne+ye*ye)}},{key:"maximumDistance",value:function(y,_){var P=Math.min(y.getMinX(),_.getMinX()),$=Math.min(y.getMinY(),_.getMinY()),ne=Math.max(y.getMaxX(),_.getMaxX()),ye=Math.max(y.getMaxY(),_.getMaxY());return I.distance(P,$,ne,ye)}},{key:"minMaxDistance",value:function(y,_){var P=y.getMinX(),$=y.getMinY(),ne=y.getMaxX(),ye=y.getMaxY(),Oe=_.getMinX(),tt=_.getMinY(),ht=_.getMaxX(),rr=_.getMaxY(),ur=I.maxDistance(P,$,P,ye,Oe,tt,Oe,rr);return ur=Math.min(ur,I.maxDistance(P,$,P,ye,Oe,tt,ht,tt)),ur=Math.min(ur,I.maxDistance(P,$,P,ye,ht,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(P,$,P,ye,ht,rr,ht,tt)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,Oe,tt,Oe,rr)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,Oe,tt,ht,tt)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,ht,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,ht,rr,ht,tt)),ur=Math.min(ur,I.maxDistance(ne,ye,P,ye,Oe,tt,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,ye,P,ye,Oe,tt,ht,tt)),ur=Math.min(ur,I.maxDistance(ne,ye,P,ye,ht,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,ye,P,ye,ht,rr,ht,tt)),ur=Math.min(ur,I.maxDistance(ne,ye,ne,$,Oe,tt,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,ye,ne,$,Oe,tt,ht,tt)),ur=Math.min(ur,I.maxDistance(ne,ye,ne,$,ht,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,ye,ne,$,ht,rr,ht,tt))}}])})(),ai=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"maximumDistance",value:function(){return Do.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(y,_){var P=I.isComposite(this._boundable1),$=I.isComposite(this._boundable2);if(P&&$)return I.area(this._boundable1)>I.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,y,_),null):(this.expand(this._boundable2,this._boundable1,!0,y,_),null);if(P)return this.expand(this._boundable1,this._boundable2,!1,y,_),null;if($)return this.expand(this._boundable2,this._boundable1,!0,y,_),null;throw new U("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(I.isComposite(this._boundable1)||I.isComposite(this._boundable2))}},{key:"compareTo",value:function(y){var _=y;return this._distance<_._distance?-1:this._distance>_._distance?1:0}},{key:"expand",value:function(y,_,P,$,ne){for(var ye=y.getChildBoundables().iterator();ye.hasNext();){var Oe=ye.next(),tt=null;(tt=P?new I(_,Oe,this._itemDistance):new I(Oe,_,this._itemDistance)).getDistance()<ne&&$.add(tt)}}},{key:"getBoundable",value:function(y){return y===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var y=arguments[0],_=arguments[1],P=arguments[2];this._boundable1=y,this._boundable2=_,this._itemDistance=P,this._distance=this.distance()}},{key:"area",value:function(y){return y.getBounds().getArea()}},{key:"isComposite",value:function(y){return y instanceof ii}}])})(),ue=(function(){return o((function I(){i(this,I)}),[{key:"visitItem",value:function(I){}}])})(),Ge=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"queryInternal",value:function(){if(Tr(arguments[2],ue)&&arguments[0]instanceof Object&&arguments[1]instanceof ii)for(var y=arguments[0],_=arguments[2],P=arguments[1].getChildBoundables(),$=0;$<P.size();$++){var ne=P.get($);this.getIntersectsOp().intersects(ne.getBounds(),y)&&(ne instanceof ii?this.queryInternal(y,ne,_):ne instanceof go?_.visitItem(ne.getItem()):we.shouldNeverReachHere())}else if(Tr(arguments[2],lr)&&arguments[0]instanceof Object&&arguments[1]instanceof ii)for(var ye=arguments[0],Oe=arguments[2],tt=arguments[1].getChildBoundables(),ht=0;ht<tt.size();ht++){var rr=tt.get(ht);this.getIntersectsOp().intersects(rr.getBounds(),ye)&&(rr instanceof ii?this.queryInternal(ye,rr,Oe):rr instanceof go?Oe.add(rr.getItem()):we.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(y){return y.get(y.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var y=0,_=arguments[0].getChildBoundables().iterator();_.hasNext();){var P=_.next();P instanceof ii?y+=this.size(P):P instanceof go&&(y+=1)}return y}}},{key:"removeItem",value:function(y,_){for(var P=null,$=y.getChildBoundables().iterator();$.hasNext();){var ne=$.next();ne instanceof go&&ne.getItem()===_&&(P=ne)}return P!==null&&(y.getChildBoundables().remove(P),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var y=this.itemsTree(this._root);return y===null?new ct:y}if(arguments.length===1){for(var _=arguments[0],P=new ct,$=_.getChildBoundables().iterator();$.hasNext();){var ne=$.next();if(ne instanceof ii){var ye=this.itemsTree(ne);ye!==null&&P.add(ye)}else ne instanceof go?P.add(ne.getItem()):we.shouldNeverReachHere()}return P.size()<=0?null:P}}},{key:"insert",value:function(y,_){we.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new go(y,_))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var y=arguments[0],_=new ct;return this.boundablesAtLevel(y,this._root,_),_}if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2];if(we.isTrue(P>-2),$.getLevel()===P)return ne.add($),null;for(var ye=$.getChildBoundables().iterator();ye.hasNext();){var Oe=ye.next();Oe instanceof ii?this.boundablesAtLevel(P,Oe,ne):(we.isTrue(Oe instanceof go),P===-1&&ne.add(Oe))}return null}}},{key:"query",value:function(){if(arguments.length===1){var y=arguments[0];this.build();var _=new ct;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),y)&&this.queryInternal(y,this._root,_),_}if(arguments.length===2){var P=arguments[0],$=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),P)&&this.queryInternal(P,this._root,$)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),y)&&this.remove(y,this._root,_)}if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2],ye=this.removeItem($,ne);if(ye)return!0;for(var Oe=null,tt=$.getChildBoundables().iterator();tt.hasNext();){var ht=tt.next();if(this.getIntersectsOp().intersects(ht.getBounds(),P)&&ht instanceof ii&&(ye=this.remove(P,ht,ne))){Oe=ht;break}}return Oe!==null&&Oe.getChildBoundables().isEmpty()&&$.getChildBoundables().remove(Oe),ye}}},{key:"createHigherLevels",value:function(y,_){we.isTrue(!y.isEmpty());var P=this.createParentBoundables(y,_+1);return P.size()===1?P.get(0):this.createHigherLevels(P,_+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var y=0,_=arguments[0].getChildBoundables().iterator();_.hasNext();){var P=_.next();if(P instanceof ii){var $=this.depth(P);$>y&&(y=$)}}return y+1}}},{key:"createParentBoundables",value:function(y,_){we.isTrue(!y.isEmpty());var P=new ct;P.add(this.createNode(_));var $=new ct(y);ri.sort($,this.getComparator());for(var ne=$.iterator();ne.hasNext();){var ye=ne.next();this.lastNode(P).getChildBoundables().size()===this.getNodeCapacity()&&P.add(this.createNode(_)),this.lastNode(P).addChildBoundable(ye)}return P}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new ct,this._nodeCapacity=null,arguments.length===0)I.constructor_.call(this,I.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var y=arguments[0];we.isTrue(y>1,"Node capacity must be greater than 1"),this._nodeCapacity=y}}},{key:"compareDoubles",value:function(y,_){return y>_?1:y<_?-1:0}}])})();Ge.IntersectsOp=function(){},Ge.DEFAULT_NODE_CAPACITY=10;var bt=(function(){return o((function I(){i(this,I)}),[{key:"distance",value:function(I,y){}}])})(),Bt=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"createParentBoundablesFromVerticalSlices",value:function(_,P){we.isTrue(_.length>0);for(var $=new ct,ne=0;ne<_.length;ne++)$.addAll(this.createParentBoundablesFromVerticalSlice(_[ne],P));return $}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var _=arguments[0],P=arguments[1];return this.nearestNeighbourK(_,Ae.POSITIVE_INFINITY,P)}if(arguments.length===3){var $=arguments[0],ne=arguments[2],ye=arguments[1],Oe=new ji;Oe.add($);for(var tt=new ji;!Oe.isEmpty()&&ye>=0;){var ht=Oe.poll(),rr=ht.getDistance();if(rr>=ye)break;ht.isLeaves()?tt.size()<ne?tt.add(ht):(tt.peek().getDistance()>rr&&(tt.poll(),tt.add(ht)),ye=tt.peek().getDistance()):ht.expandToQueue(Oe,ye)}return y.getItems(tt)}}},{key:"createNode",value:function(_){return new sr(_)}},{key:"size",value:function(){return arguments.length===0?E(y,"size",this,1).call(this):E(y,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Qe))return E(y,"insert",this,1).apply(this,arguments);var _=arguments[0],P=arguments[1];if(_.isNull())return null;E(y,"insert",this,1).call(this,_,P)}},{key:"getIntersectsOp",value:function(){return y.intersectsOp}},{key:"verticalSlices",value:function(_,P){for(var $=Math.trunc(Math.ceil(_.size()/P)),ne=new Array(P).fill(null),ye=_.iterator(),Oe=0;Oe<P;Oe++){ne[Oe]=new ct;for(var tt=0;ye.hasNext()&&tt<$;){var ht=ye.next();ne[Oe].add(ht),tt++}}return ne}},{key:"query",value:function(){if(arguments.length===1){var _=arguments[0];return E(y,"query",this,1).call(this,_)}if(arguments.length===2){var P=arguments[0],$=arguments[1];E(y,"query",this,1).call(this,P,$)}}},{key:"getComparator",value:function(){return y.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(_,P){return E(y,"createParentBoundables",this,1).call(this,_,P)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Qe){var _=arguments[0],P=arguments[1];return E(y,"remove",this,1).call(this,_,P)}return E(y,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?E(y,"depth",this,1).call(this):E(y,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(_,P){we.isTrue(!_.isEmpty());var $=Math.trunc(Math.ceil(_.size()/this.getNodeCapacity())),ne=new ct(_);ri.sort(ne,y.xComparator);var ye=this.verticalSlices(ne,Math.trunc(Math.ceil(Math.sqrt($))));return this.createParentBoundablesFromVerticalSlices(ye,P)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(Tr(arguments[0],bt)){var _=arguments[0];if(this.isEmpty())return null;var P=new ai(this.getRoot(),this.getRoot(),_);return this.nearestNeighbour(P)}if(arguments[0]instanceof ai){var $=arguments[0],ne=Ae.POSITIVE_INFINITY,ye=null,Oe=new ji;for(Oe.add($);!Oe.isEmpty()&&ne>0;){var tt=Oe.poll(),ht=tt.getDistance();if(ht>=ne)break;tt.isLeaves()?(ne=ht,ye=tt):tt.expandToQueue(Oe,ne)}return ye===null?null:[ye.getBoundable(0).getItem(),ye.getBoundable(1).getItem()]}}else{if(arguments.length===2){var rr=arguments[0],ur=arguments[1];if(this.isEmpty()||rr.isEmpty())return null;var qr=new ai(this.getRoot(),rr.getRoot(),ur);return this.nearestNeighbour(qr)}if(arguments.length===3){var bn=arguments[2],Dn=new go(arguments[0],arguments[1]),Xn=new ai(this.getRoot(),Dn,bn);return this.nearestNeighbour(Xn)[0]}if(arguments.length===4){var Fn=arguments[2],En=arguments[3],na=new go(arguments[0],arguments[1]),ca=new ai(this.getRoot(),na,Fn);return this.nearestNeighbourK(ca,En)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var _=arguments[0],P=arguments[1],$=Ae.POSITIVE_INFINITY,ne=new ji;for(ne.add(_);!ne.isEmpty();){var ye=ne.poll(),Oe=ye.getDistance();if(Oe>P)return!1;if(ye.maximumDistance()<=P)return!0;if(ye.isLeaves()){if(($=Oe)<=P)return!0}else ye.expandToQueue(ne,$)}return!1}if(arguments.length===3){var tt=arguments[0],ht=arguments[1],rr=arguments[2],ur=new ai(this.getRoot(),tt.getRoot(),ht);return this.isWithinDistance(ur,rr)}}},{key:"interfaces_",get:function(){return[qs,X]}}],[{key:"constructor_",value:function(){if(arguments.length===0)y.constructor_.call(this,y.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var _=arguments[0];Ge.constructor_.call(this,_)}}},{key:"centreX",value:function(_){return y.avg(_.getMinX(),_.getMaxX())}},{key:"avg",value:function(_,P){return(_+P)/2}},{key:"getItems",value:function(_){for(var P=new Array(_.size()).fill(null),$=0;!_.isEmpty();){var ne=_.poll();P[$]=ne.getBoundable(0).getItem(),$++}return P}},{key:"centreY",value:function(_){return y.avg(_.getMinY(),_.getMaxY())}}])})(Ge),sr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeBounds",value:function(){for(var _=null,P=this.getChildBoundables().iterator();P.hasNext();){var $=P.next();_===null?_=new Qe($.getBounds()):_.expandToInclude($.getBounds())}return _}}],[{key:"constructor_",value:function(){var _=arguments[0];ii.constructor_.call(this,_)}}])})(ii);Bt.STRtreeNode=sr,Bt.xComparator=new((function(){return o((function I(){i(this,I)}),[{key:"interfaces_",get:function(){return[De]}},{key:"compare",value:function(I,y){return Ge.compareDoubles(Bt.centreX(I.getBounds()),Bt.centreX(y.getBounds()))}}])})()),Bt.yComparator=new((function(){return o((function I(){i(this,I)}),[{key:"interfaces_",get:function(){return[De]}},{key:"compare",value:function(I,y){return Ge.compareDoubles(Bt.centreY(I.getBounds()),Bt.centreY(y.getBounds()))}}])})()),Bt.intersectsOp=new((function(){return o((function I(){i(this,I)}),[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(I,y){return I.intersects(y)}}])})()),Bt.DEFAULT_NODE_CAPACITY=10;var Nr=(function(){function I(){i(this,I)}return o(I,null,[{key:"relativeSign",value:function(y,_){return y<_?-1:y>_?1:0}},{key:"compare",value:function(y,_,P){if(_.equals2D(P))return 0;var $=I.relativeSign(_.x,P.x),ne=I.relativeSign(_.y,P.y);switch(y){case 0:return I.compareValue($,ne);case 1:return I.compareValue(ne,$);case 2:return I.compareValue(ne,-$);case 3:return I.compareValue(-$,ne);case 4:return I.compareValue(-$,-ne);case 5:return I.compareValue(-ne,-$);case 6:return I.compareValue(-ne,$);case 7:return I.compareValue($,-ne)}return we.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(y,_){return y<0?-1:y>0?1:_<0?-1:_>0?1:0}}])})(),Zr=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(I){I.print(this.coord),I.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(I){var y=I;return this.segmentIndex<y.segmentIndex?-1:this.segmentIndex>y.segmentIndex?1:this.coord.equals2D(y.coord)?0:this._isInterior?y._isInterior?Nr.compare(this._segmentOctant,this.coord,y.coord):1:-1}},{key:"isEndPoint",value:function(I){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===I}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var I=arguments[0],y=arguments[1],_=arguments[2],P=arguments[3];this._segString=I,this.coord=new Be(y),this.segmentIndex=_,this._segmentOctant=P,this._isInterior=!y.equals2D(I.getCoordinate(_))}}])})(),Ln=(function(){return o((function I(){i(this,I)}),[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])})(),qn=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getSplitCoordinates",value:function(){var I=new La;this.addEndpoints();for(var y=this.iterator(),_=y.next();y.hasNext();){var P=y.next();this.addEdgeCoordinates(_,P,I),_=P}return I.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var I=new ct;this.findCollapsesFromInsertedNodes(I),this.findCollapsesFromExistingVertices(I);for(var y=I.iterator();y.hasNext();){var _=y.next().intValue();this.add(this._edge.getCoordinate(_),_)}}},{key:"createSplitEdgePts",value:function(I,y){var _=y.segmentIndex-I.segmentIndex+2;if(_===2)return[new Be(I.coord),new Be(y.coord)];var P=this._edge.getCoordinate(y.segmentIndex),$=y.isInterior()||!y.coord.equals2D(P);$||_--;var ne=new Array(_).fill(null),ye=0;ne[ye++]=new Be(I.coord);for(var Oe=I.segmentIndex+1;Oe<=y.segmentIndex;Oe++)ne[ye++]=this._edge.getCoordinate(Oe);return $&&(ne[ye]=new Be(y.coord)),ne}},{key:"print",value:function(I){I.println("Intersections:");for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"findCollapsesFromExistingVertices",value:function(I){for(var y=0;y<this._edge.size()-2;y++){var _=this._edge.getCoordinate(y);this._edge.getCoordinate(y+1);var P=this._edge.getCoordinate(y+2);_.equals2D(P)&&I.add(at.valueOf(y+1))}}},{key:"addEdgeCoordinates",value:function(I,y,_){var P=this.createSplitEdgePts(I,y);_.add(P,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(I){this.addEndpoints(),this.addCollapsedNodes();for(var y=this.iterator(),_=y.next();y.hasNext();){var P=y.next(),$=this.createSplitEdge(_,P);I.add($),_=P}}},{key:"findCollapseIndex",value:function(I,y,_){if(!I.coord.equals2D(y.coord))return!1;var P=y.segmentIndex-I.segmentIndex;return y.isInterior()||P--,P===1&&(_[0]=I.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(I){for(var y=new Array(1).fill(null),_=this.iterator(),P=_.next();_.hasNext();){var $=_.next();this.findCollapseIndex(P,$,y)&&I.add(at.valueOf(y[0])),P=$}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var I=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(I),I)}},{key:"createSplitEdge",value:function(I,y){var _=this.createSplitEdgePts(I,y);return new Ui(_,this._edge.getData())}},{key:"add",value:function(I,y){var _=new Zr(this._edge,I,y,this._edge.getSegmentOctant(y)),P=this._nodeMap.get(_);return P!==null?(we.isTrue(P.coord.equals2D(I),"Found equal nodes with different coordinates"),P):(this._nodeMap.put(_,_),_)}},{key:"checkSplitEdgesCorrectness",value:function(I){var y=this._edge.getCoordinates(),_=I.get(0).getCoordinate(0);if(!_.equals2D(y[0]))throw new de("bad split edge start point at "+_);var P=I.get(I.size()-1).getCoordinates(),$=P[P.length-1];if(!$.equals2D(y[y.length-1]))throw new de("bad split edge end point at "+$)}}],[{key:"constructor_",value:function(){this._nodeMap=new Mi,this._edge=null;var I=arguments[0];this._edge=I}}])})(),Un=(function(){function I(){i(this,I)}return o(I,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1];if(y===0&&_===0)throw new U("Cannot compute the octant for point ( "+y+", "+_+" )");var P=Math.abs(y),$=Math.abs(_);return y>=0?_>=0?P>=$?0:1:P>=$?7:6:_>=0?P>=$?3:2:P>=$?4:5}if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var ne=arguments[0],ye=arguments[1],Oe=ye.x-ne.x,tt=ye.y-ne.y;if(Oe===0&&tt===0)throw new U("Cannot compute the octant for two identical points "+ne);return I.octant(Oe,tt)}}}])})(),ui=(function(){return o((function I(){i(this,I)}),[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(I){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(I){}},{key:"getData",value:function(){}}])})(),Hn=(function(){return o((function I(){i(this,I)}),[{key:"addIntersection",value:function(I,y){}},{key:"interfaces_",get:function(){return[ui]}}])})(),Ui=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(y){return this._pts[y]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(y){return y===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(y),this.getCoordinate(y+1))}},{key:"setData",value:function(y){this._data=y}},{key:"safeOctant",value:function(y,_){return y.equals2D(_)?0:Un.octant(y,_)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];this.addIntersectionNode(y,_)}else if(arguments.length===4){var P=arguments[1],$=arguments[3],ne=new Be(arguments[0].getIntersection($));this.addIntersection(ne,P)}}},{key:"toString",value:function(){return tn.toLineString(new Ya(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(y,_){var P=_,$=P+1;if($<this._pts.length){var ne=this._pts[$];y.equals2D(ne)&&(P=$)}return this._nodeList.add(y,P)}},{key:"addIntersections",value:function(y,_,P){for(var $=0;$<y.getIntersectionNum();$++)this.addIntersection(y,_,P,$)}},{key:"interfaces_",get:function(){return[Hn]}}],[{key:"constructor_",value:function(){this._nodeList=new qn(this),this._pts=null,this._data=null;var y=arguments[0],_=arguments[1];this._pts=y,this._data=_}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var y=arguments[0],_=new ct;return I.getNodedSubstrings(y,_),_}if(arguments.length===2)for(var P=arguments[1],$=arguments[0].iterator();$.hasNext();)$.next().getNodeList().addSplitEdges(P)}}])})(),Xi=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof I){var y=arguments[0],_=We.index(this.p0,this.p1,y.p0),P=We.index(this.p0,this.p1,y.p1);return _>=0&&P>=0||_<=0&&P<=0?Math.max(_,P):0}if(arguments[0]instanceof Be){var $=arguments[0];return We.index(this.p0,this.p1,$)}}},{key:"toGeometry",value:function(y){return y.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(y){if(!(y instanceof I))return!1;var _=y;return this.p0.equals(_.p0)&&this.p1.equals(_.p1)}},{key:"intersection",value:function(y){var _=new on;return _.computeIntersection(this.p0,this.p1,y.p0,y.p1),_.hasIntersection()?_.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof Be){var y=arguments[0];if(y.equals(this.p0)||y.equals(this.p1))return new Be(y);var _=this.projectionFactor(y),P=new Be;return P.x=this.p0.x+_*(this.p1.x-this.p0.x),P.y=this.p0.y+_*(this.p1.y-this.p0.y),P}if(arguments[0]instanceof I){var $=arguments[0],ne=this.projectionFactor($.p0),ye=this.projectionFactor($.p1);if(ne>=1&&ye>=1||ne<=0&&ye<=0)return null;var Oe=this.project($.p0);ne<0&&(Oe=this.p0),ne>1&&(Oe=this.p1);var tt=this.project($.p1);return ye<0&&(tt=this.p0),ye>1&&(tt=this.p1),new I(Oe,tt)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(y){return y===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(y){return hn.pointToLinePerpendicular(y,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return I.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(y){if(y.equals(this.p0))return 0;if(y.equals(this.p1))return 1;var _=this.p1.x-this.p0.x,P=this.p1.y-this.p0.y,$=_*_+P*P;return $<=0?Ae.NaN:((y.x-this.p0.x)*_+(y.y-this.p0.y)*P)/$}},{key:"closestPoints",value:function(y){var _=this.intersection(y);if(_!==null)return[_,_];var P=new Array(2).fill(null),$=Ae.MAX_VALUE,ne=null,ye=this.closestPoint(y.p0);$=ye.distance(y.p0),P[0]=ye,P[1]=y.p0;var Oe=this.closestPoint(y.p1);(ne=Oe.distance(y.p1))<$&&($=ne,P[0]=Oe,P[1]=y.p1);var tt=y.closestPoint(this.p0);(ne=tt.distance(this.p0))<$&&($=ne,P[0]=this.p0,P[1]=tt);var ht=y.closestPoint(this.p1);return(ne=ht.distance(this.p1))<$&&($=ne,P[0]=this.p1,P[1]=ht),P}},{key:"closestPoint",value:function(y){var _=this.projectionFactor(y);return _>0&&_<1?this.project(y):this.p0.distance(y)<this.p1.distance(y)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(y){var _=y,P=this.p0.compareTo(_.p0);return P!==0?P:this.p1.compareTo(_.p1)}},{key:"reverse",value:function(){var y=this.p0;this.p0=this.p1,this.p1=y}},{key:"equalsTopo",value:function(y){return this.p0.equals(y.p0)&&this.p1.equals(y.p1)||this.p0.equals(y.p1)&&this.p1.equals(y.p0)}},{key:"lineIntersection",value:function(y){return Ir.intersection(this.p0,this.p1,y.p0,y.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(y,_){var P=this.p0.x+y*(this.p1.x-this.p0.x),$=this.p0.y+y*(this.p1.y-this.p0.y),ne=this.p1.x-this.p0.x,ye=this.p1.y-this.p0.y,Oe=Math.sqrt(ne*ne+ye*ye),tt=0,ht=0;if(_!==0){if(Oe<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");tt=_*ne/Oe,ht=_*ye/Oe}return new Be(P-ht,$+tt)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var y=arguments[0];this.setCoordinates(y.p0,y.p1)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.p0.x=_.x,this.p0.y=_.y,this.p1.x=P.x,this.p1.y=P.y}}},{key:"segmentFraction",value:function(y){var _=this.projectionFactor(y);return _<0?_=0:(_>1||Ae.isNaN(_))&&(_=1),_}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(y){var _=this.p1.getY()-this.p0.getY(),P=this.p0.getX()-this.p1.getX(),$=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),ne=_*_+P*P,ye=_*_-P*P,Oe=y.getX(),tt=y.getY();return new Be((-ye*Oe-2*_*P*tt-2*_*$)/ne,(ye*tt-2*_*P*Oe-2*P*$)/ne)}},{key:"distance",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return hn.segmentToSegment(this.p0,this.p1,y.p0,y.p1)}if(arguments[0]instanceof Be){var _=arguments[0];return hn.pointToSegment(_,this.p0,this.p1)}}},{key:"pointAlong",value:function(y){var _=new Be;return _.x=this.p0.x+y*(this.p1.x-this.p0.x),_.y=this.p0.y+y*(this.p1.y-this.p0.y),_}},{key:"hashCode",value:function(){var y=Ae.doubleToLongBits(this.p0.x);y^=31*Ae.doubleToLongBits(this.p0.y);var _=Math.trunc(y)^Math.trunc(y>>32),P=Ae.doubleToLongBits(this.p1.x);return P^=31*Ae.doubleToLongBits(this.p1.y),_^(Math.trunc(P)^Math.trunc(P>>32))}},{key:"interfaces_",get:function(){return[H,X]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)I.constructor_.call(this,new Be,new Be);else if(arguments.length===1){var y=arguments[0];I.constructor_.call(this,y.p0,y.p1)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.p0=_,this.p1=P}else if(arguments.length===4){var $=arguments[0],ne=arguments[1],ye=arguments[2],Oe=arguments[3];I.constructor_.call(this,new Be($,ne),new Be(ye,Oe))}}},{key:"midPoint",value:function(y,_){return new Be((y.x+_.x)/2,(y.y+_.y)/2)}}])})(),ra=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var I=arguments[1],y=arguments[2],_=arguments[3];arguments[0].getLineSegment(I,this._overlapSeg1),y.getLineSegment(_,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new Xi,this._overlapSeg2=new Xi}}])})(),Si=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getLineSegment",value:function(I,y){y.p0=this._pts[I],y.p1=this._pts[I+1]}},{key:"computeSelect",value:function(I,y,_,P){var $=this._pts[y],ne=this._pts[_];if(_-y==1)return P.select(this,y),null;if(!I.intersects($,ne))return null;var ye=Math.trunc((y+_)/2);y<ye&&this.computeSelect(I,y,ye,P),ye<_&&this.computeSelect(I,ye,_,P)}},{key:"getCoordinates",value:function(){for(var I=new Array(this._end-this._start+1).fill(null),y=0,_=this._start;_<=this._end;_++)I[y++]=this._pts[_];return I}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var I=arguments[0],y=arguments[1];this.computeOverlaps(this._start,this._end,I,I._start,I._end,y)}else if(arguments.length===6){var _=arguments[0],P=arguments[1],$=arguments[2],ne=arguments[3],ye=arguments[4],Oe=arguments[5];if(P-_==1&&ye-ne==1)return Oe.overlap(this,_,$,ne),null;if(!this.overlaps(_,P,$,ne,ye))return null;var tt=Math.trunc((_+P)/2),ht=Math.trunc((ne+ye)/2);_<tt&&(ne<ht&&this.computeOverlaps(_,tt,$,ne,ht,Oe),ht<ye&&this.computeOverlaps(_,tt,$,ht,ye,Oe)),tt<P&&(ne<ht&&this.computeOverlaps(tt,P,$,ne,ht,Oe),ht<ye&&this.computeOverlaps(tt,P,$,ht,ye,Oe))}}},{key:"setId",value:function(I){this._id=I}},{key:"select",value:function(I,y){this.computeSelect(I,this._start,this._end,y)}},{key:"getEnvelope",value:function(){if(this._env===null){var I=this._pts[this._start],y=this._pts[this._end];this._env=new Qe(I,y)}return this._env}},{key:"overlaps",value:function(I,y,_,P,$){return Qe.intersects(this._pts[I],this._pts[y],_._pts[P],_._pts[$])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var I=arguments[0],y=arguments[1],_=arguments[2],P=arguments[3];this._pts=I,this._start=y,this._end=_,this._context=P}}])})(),Ia=(function(){function I(){i(this,I)}return o(I,null,[{key:"findChainEnd",value:function(y,_){for(var P=_;P<y.length-1&&y[P].equals2D(y[P+1]);)P++;if(P>=y.length-1)return y.length-1;for(var $=oa.quadrant(y[P],y[P+1]),ne=_+1;ne<y.length&&!(!y[ne-1].equals2D(y[ne])&&oa.quadrant(y[ne-1],y[ne])!==$);)ne++;return ne-1}},{key:"getChains",value:function(){if(arguments.length===1){var y=arguments[0];return I.getChains(y,null)}if(arguments.length===2){var _=arguments[0],P=arguments[1],$=new ct,ne=0;do{var ye=I.findChainEnd(_,ne),Oe=new Si(_,ne,ye,P);$.add(Oe),ne=ye}while(ne<_.length-1);return $}}}])})(),za=(function(){return o((function I(){i(this,I)}),[{key:"computeNodes",value:function(I){}},{key:"getNodedSubstrings",value:function(){}}])})(),Hs=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"setSegmentIntersector",value:function(I){this._segInt=I}},{key:"interfaces_",get:function(){return[za]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var I=arguments[0];this.setSegmentIntersector(I)}}}}])})(),ll=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return Ui.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(_){for(var P=Ia.getChains(_.getCoordinates(),_).iterator();P.hasNext();){var $=P.next();$.setId(this._idCounter++),this._index.insert($.getEnvelope(),$),this._monoChains.add($)}}},{key:"computeNodes",value:function(_){this._nodedSegStrings=_;for(var P=_.iterator();P.hasNext();)this.add(P.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var _=new Ws(this._segInt),P=this._monoChains.iterator();P.hasNext();)for(var $=P.next(),ne=this._index.query($.getEnvelope()).iterator();ne.hasNext();){var ye=ne.next();if(ye.getId()>$.getId()&&($.computeOverlaps(ye,_),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new ct,this._index=new Bt,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var _=arguments[0];Hs.constructor_.call(this,_)}}}}])})(Hs),Ws=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"overlap",value:function(){if(arguments.length!==4)return E(y,"overlap",this,1).apply(this,arguments);var _=arguments[1],P=arguments[2],$=arguments[3],ne=arguments[0].getContext(),ye=P.getContext();this._si.processIntersections(ne,_,ye,$)}}],[{key:"constructor_",value:function(){this._si=null;var _=arguments[0];this._si=_}}])})(ra);ll.SegmentOverlapAction=Ws;var $o=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isDeletable",value:function(y,_,P,$){var ne=this._inputLine[y],ye=this._inputLine[_],Oe=this._inputLine[P];return!!this.isConcave(ne,ye,Oe)&&!!this.isShallow(ne,ye,Oe,$)&&this.isShallowSampled(ne,ye,y,P,$)}},{key:"deleteShallowConcavities",value:function(){for(var y=1,_=this.findNextNonDeletedIndex(y),P=this.findNextNonDeletedIndex(_),$=!1;P<this._inputLine.length;){var ne=!1;this.isDeletable(y,_,P,this._distanceTol)&&(this._isDeleted[_]=I.DELETE,ne=!0,$=!0),y=ne?P:_,_=this.findNextNonDeletedIndex(y),P=this.findNextNonDeletedIndex(_)}return $}},{key:"isShallowConcavity",value:function(y,_,P,$){return We.index(y,_,P)===this._angleOrientation&&hn.pointToSegment(_,y,P)<$}},{key:"isShallowSampled",value:function(y,_,P,$,ne){var ye=Math.trunc(($-P)/I.NUM_PTS_TO_CHECK);ye<=0&&(ye=1);for(var Oe=P;Oe<$;Oe+=ye)if(!this.isShallow(y,_,this._inputLine[Oe],ne))return!1;return!0}},{key:"isConcave",value:function(y,_,P){var $=We.index(y,_,P)===this._angleOrientation;return $}},{key:"simplify",value:function(y){this._distanceTol=Math.abs(y),y<0&&(this._angleOrientation=We.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var _=!1;do _=this.deleteShallowConcavities();while(_);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(y){for(var _=y+1;_<this._inputLine.length&&this._isDeleted[_]===I.DELETE;)_++;return _}},{key:"isShallow",value:function(y,_,P,$){return hn.pointToSegment(_,y,P)<$}},{key:"collapseLine",value:function(){for(var y=new La,_=0;_<this._inputLine.length;_++)this._isDeleted[_]!==I.DELETE&&y.add(this._inputLine[_]);return y.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=We.COUNTERCLOCKWISE;var y=arguments[0];this._inputLine=y}},{key:"simplify",value:function(y,_){return new I(y).simplify(_)}}])})();$o.INIT=0,$o.DELETE=1,$o.KEEP=1,$o.NUM_PTS_TO_CHECK=10;var Gs=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getCoordinates",value:function(){return this._ptList.toArray(I.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(y){this._precisionModel=y}},{key:"addPt",value:function(y){var _=new Be(y);if(this._precisionModel.makePrecise(_),this.isRedundant(_))return null;this._ptList.add(_)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(y,_){if(_)for(var P=0;P<y.length;P++)this.addPt(y[P]);else for(var $=y.length-1;$>=0;$--)this.addPt(y[$])}},{key:"isRedundant",value:function(y){if(this._ptList.size()<1)return!1;var _=this._ptList.get(this._ptList.size()-1);return y.distance(_)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Aa().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var y=new Be(this._ptList.get(0)),_=this._ptList.get(this._ptList.size()-1);if(y.equals(_))return null;this._ptList.add(y)}},{key:"setMinimumVertexDistance",value:function(y){this._minimimVertexDistance=y}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new ct}}])})();Gs.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var Pa=(function(){function I(){i(this,I)}return o(I,null,[{key:"toDegrees",value:function(y){return 180*y/Math.PI}},{key:"normalize",value:function(y){for(;y>Math.PI;)y-=I.PI_TIMES_2;for(;y<=-Math.PI;)y+=I.PI_TIMES_2;return y}},{key:"angle",value:function(){if(arguments.length===1){var y=arguments[0];return Math.atan2(y.y,y.x)}if(arguments.length===2){var _=arguments[0],P=arguments[1],$=P.x-_.x,ne=P.y-_.y;return Math.atan2(ne,$)}}},{key:"isAcute",value:function(y,_,P){var $=y.x-_.x,ne=y.y-_.y;return $*(P.x-_.x)+ne*(P.y-_.y)>0}},{key:"isObtuse",value:function(y,_,P){var $=y.x-_.x,ne=y.y-_.y;return $*(P.x-_.x)+ne*(P.y-_.y)<0}},{key:"interiorAngle",value:function(y,_,P){var $=I.angle(_,y),ne=I.angle(_,P);return Math.abs(ne-$)}},{key:"normalizePositive",value:function(y){if(y<0){for(;y<0;)y+=I.PI_TIMES_2;y>=I.PI_TIMES_2&&(y=0)}else{for(;y>=I.PI_TIMES_2;)y-=I.PI_TIMES_2;y<0&&(y=0)}return y}},{key:"angleBetween",value:function(y,_,P){var $=I.angle(_,y),ne=I.angle(_,P);return I.diff($,ne)}},{key:"diff",value:function(y,_){var P=null;return(P=y<_?_-y:y-_)>Math.PI&&(P=2*Math.PI-P),P}},{key:"toRadians",value:function(y){return y*Math.PI/180}},{key:"getTurn",value:function(y,_){var P=Math.sin(_-y);return P>0?I.COUNTERCLOCKWISE:P<0?I.CLOCKWISE:I.NONE}},{key:"angleBetweenOriented",value:function(y,_,P){var $=I.angle(_,y),ne=I.angle(_,P)-$;return ne<=-Math.PI?ne+I.PI_TIMES_2:ne>Math.PI?ne-I.PI_TIMES_2:ne}}])})();Pa.PI_TIMES_2=2*Math.PI,Pa.PI_OVER_2=Math.PI/2,Pa.PI_OVER_4=Math.PI/4,Pa.COUNTERCLOCKWISE=We.COUNTERCLOCKWISE,Pa.CLOCKWISE=We.CLOCKWISE,Pa.NONE=We.COLLINEAR;var Xs=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"addNextSegment",value:function(y,_){if(this._s0=this._s1,this._s1=this._s2,this._s2=y,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var P=We.index(this._s0,this._s1,this._s2),$=P===We.CLOCKWISE&&this._side===_t.LEFT||P===We.COUNTERCLOCKWISE&&this._side===_t.RIGHT;P===0?this.addCollinear(_):$?this.addOutsideTurn(P,_):this.addInsideTurn(P,_)}},{key:"addLineEndCap",value:function(y,_){var P=new Xi(y,_),$=new Xi;this.computeOffsetSegment(P,_t.LEFT,this._distance,$);var ne=new Xi;this.computeOffsetSegment(P,_t.RIGHT,this._distance,ne);var ye=_.x-y.x,Oe=_.y-y.y,tt=Math.atan2(Oe,ye);switch(this._bufParams.getEndCapStyle()){case N.CAP_ROUND:this._segList.addPt($.p1),this.addDirectedFillet(_,tt+Math.PI/2,tt-Math.PI/2,We.CLOCKWISE,this._distance),this._segList.addPt(ne.p1);break;case N.CAP_FLAT:this._segList.addPt($.p1),this._segList.addPt(ne.p1);break;case N.CAP_SQUARE:var ht=new Be;ht.x=Math.abs(this._distance)*Math.cos(tt),ht.y=Math.abs(this._distance)*Math.sin(tt);var rr=new Be($.p1.x+ht.x,$.p1.y+ht.y),ur=new Be(ne.p1.x+ht.x,ne.p1.y+ht.y);this._segList.addPt(rr),this._segList.addPt(ur)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(y,_,P,$){var ne=Ir.intersection(_.p0,_.p1,P.p0,P.p1);if(ne!==null&&($<=0?1:ne.distance(y)/Math.abs($))<=this._bufParams.getMitreLimit())return this._segList.addPt(ne),null;this.addLimitedMitreJoin(_,P,$,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(y,_){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*I.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===N.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===N.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(_&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,y,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(y){this._segList.addPt(new Be(y.x+this._distance,y.y+this._distance)),this._segList.addPt(new Be(y.x+this._distance,y.y-this._distance)),this._segList.addPt(new Be(y.x-this._distance,y.y-this._distance)),this._segList.addPt(new Be(y.x-this._distance,y.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(y,_){this._segList.addPts(y,_)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(y,_,P,$,ne){var ye=_.x-y.x,Oe=_.y-y.y,tt=Math.atan2(Oe,ye),ht=P.x-y.x,rr=P.y-y.y,ur=Math.atan2(rr,ht);$===We.CLOCKWISE?tt<=ur&&(tt+=2*Math.PI):tt>=ur&&(tt-=2*Math.PI),this._segList.addPt(_),this.addDirectedFillet(y,tt,ur,$,ne),this._segList.addPt(P)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(y,_,P){this._s1=y,this._s2=_,this._side=P,this._seg1.setCoordinates(y,_),this.computeOffsetSegment(this._seg1,P,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(y,_,P,$){var ne=this._seg0.p1,ye=Pa.angle(ne,this._seg0.p0),Oe=Pa.angleBetweenOriented(this._seg0.p0,ne,this._seg1.p1)/2,tt=Pa.normalize(ye+Oe),ht=Pa.normalize(tt+Math.PI),rr=$*P,ur=P-rr*Math.abs(Math.sin(Oe)),qr=ne.x+rr*Math.cos(ht),bn=ne.y+rr*Math.sin(ht),Dn=new Be(qr,bn),Xn=new Xi(ne,Dn),Fn=Xn.pointAlongOffset(1,ur),En=Xn.pointAlongOffset(1,-ur);this._side===_t.LEFT?(this._segList.addPt(Fn),this._segList.addPt(En)):(this._segList.addPt(En),this._segList.addPt(Fn))}},{key:"addDirectedFillet",value:function(y,_,P,$,ne){var ye=$===We.CLOCKWISE?-1:1,Oe=Math.abs(_-P),tt=Math.trunc(Oe/this._filletAngleQuantum+.5);if(tt<1)return null;for(var ht=Oe/tt,rr=new Be,ur=0;ur<tt;ur++){var qr=_+ye*ur*ht;rr.x=y.x+ne*Math.cos(qr),rr.y=y.y+ne*Math.sin(qr),this._segList.addPt(rr)}}},{key:"computeOffsetSegment",value:function(y,_,P,$){var ne=_===_t.LEFT?1:-1,ye=y.p1.x-y.p0.x,Oe=y.p1.y-y.p0.y,tt=Math.sqrt(ye*ye+Oe*Oe),ht=ne*P*ye/tt,rr=ne*P*Oe/tt;$.p0.x=y.p0.x-rr,$.p0.y=y.p0.y+ht,$.p1.x=y.p1.x-rr,$.p1.y=y.p1.y+ht}},{key:"addInsideTurn",value:function(y,_){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*I.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var P=new Be((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(P);var $=new Be((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt($)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(y){var _=new Be(y.x+this._distance,y.y);this._segList.addPt(_),this.addDirectedFillet(y,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(y,_){this._segList.addPt(y.p1),this._segList.addPt(_.p0)}},{key:"init",value:function(y){this._distance=y,this._maxCurveSegmentError=y*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Gs,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(y*I.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(y){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===N.JOIN_BEVEL||this._bufParams.getJoinStyle()===N.JOIN_MITRE?(y&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,We.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Xi,this._seg1=new Xi,this._offset0=new Xi,this._offset1=new Xi,this._side=0,this._hasNarrowConcaveAngle=!1;var y=arguments[0],_=arguments[1],P=arguments[2];this._precisionModel=y,this._bufParams=_,this._li=new on,this._filletAngleQuantum=Math.PI/2/_.getQuadrantSegments(),_.getQuadrantSegments()>=8&&_.getJoinStyle()===N.JOIN_ROUND&&(this._closingSegLengthFactor=I.MAX_CLOSING_SEG_LEN_FACTOR),this.init(P)}}])})();Xs.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Xs.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Xs.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Xs.MAX_CLOSING_SEG_LEN_FACTOR=80;var Il=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getOffsetCurve",value:function(y,_){if(this._distance=_,_===0)return null;var P=_<0,$=Math.abs(_),ne=this.getSegGen($);y.length<=1?this.computePointCurve(y[0],ne):this.computeOffsetCurve(y,P,ne);var ye=ne.getCoordinates();return P&&Gi.reverse(ye),ye}},{key:"computeSingleSidedBufferCurve",value:function(y,_,P){var $=this.simplifyTolerance(this._distance);if(_){P.addSegments(y,!0);var ne=$o.simplify(y,-$),ye=ne.length-1;P.initSideSegments(ne[ye],ne[ye-1],_t.LEFT),P.addFirstSegment();for(var Oe=ye-2;Oe>=0;Oe--)P.addNextSegment(ne[Oe],!0)}else{P.addSegments(y,!1);var tt=$o.simplify(y,$),ht=tt.length-1;P.initSideSegments(tt[0],tt[1],_t.LEFT),P.addFirstSegment();for(var rr=2;rr<=ht;rr++)P.addNextSegment(tt[rr],!0)}P.addLastSegment(),P.closeRing()}},{key:"computeRingBufferCurve",value:function(y,_,P){var $=this.simplifyTolerance(this._distance);_===_t.RIGHT&&($=-$);var ne=$o.simplify(y,$),ye=ne.length-1;P.initSideSegments(ne[ye-1],ne[0],_);for(var Oe=1;Oe<=ye;Oe++){var tt=Oe!==1;P.addNextSegment(ne[Oe],tt)}P.closeRing()}},{key:"computeLineBufferCurve",value:function(y,_){var P=this.simplifyTolerance(this._distance),$=$o.simplify(y,P),ne=$.length-1;_.initSideSegments($[0],$[1],_t.LEFT);for(var ye=2;ye<=ne;ye++)_.addNextSegment($[ye],!0);_.addLastSegment(),_.addLineEndCap($[ne-1],$[ne]);var Oe=$o.simplify(y,-P),tt=Oe.length-1;_.initSideSegments(Oe[tt],Oe[tt-1],_t.LEFT);for(var ht=tt-2;ht>=0;ht--)_.addNextSegment(Oe[ht],!0);_.addLastSegment(),_.addLineEndCap(Oe[1],Oe[0]),_.closeRing()}},{key:"computePointCurve",value:function(y,_){switch(this._bufParams.getEndCapStyle()){case N.CAP_ROUND:_.createCircle(y);break;case N.CAP_SQUARE:_.createSquare(y)}}},{key:"getLineCurve",value:function(y,_){if(this._distance=_,this.isLineOffsetEmpty(_))return null;var P=Math.abs(_),$=this.getSegGen(P);if(y.length<=1)this.computePointCurve(y[0],$);else if(this._bufParams.isSingleSided()){var ne=_<0;this.computeSingleSidedBufferCurve(y,ne,$)}else this.computeLineBufferCurve(y,$);return $.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(y){return y*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(y,_,P){if(this._distance=P,y.length<=2)return this.getLineCurve(y,P);if(P===0)return I.copyCoordinates(y);var $=this.getSegGen(P);return this.computeRingBufferCurve(y,_,$),$.getCoordinates()}},{key:"computeOffsetCurve",value:function(y,_,P){var $=this.simplifyTolerance(this._distance);if(_){var ne=$o.simplify(y,-$),ye=ne.length-1;P.initSideSegments(ne[ye],ne[ye-1],_t.LEFT),P.addFirstSegment();for(var Oe=ye-2;Oe>=0;Oe--)P.addNextSegment(ne[Oe],!0)}else{var tt=$o.simplify(y,$),ht=tt.length-1;P.initSideSegments(tt[0],tt[1],_t.LEFT),P.addFirstSegment();for(var rr=2;rr<=ht;rr++)P.addNextSegment(tt[rr],!0)}P.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(y){return y===0||y<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(y){return new Xs(this._precisionModel,this._bufParams,y)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var y=arguments[0],_=arguments[1];this._precisionModel=y,this._bufParams=_}},{key:"copyCoordinates",value:function(y){for(var _=new Array(y.length).fill(null),P=0;P<_.length;P++)_[P]=new Be(y[P]);return _}}])})(),gs=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var I=arguments[0],y=new ct,_=this._subgraphs.iterator();_.hasNext();){var P=_.next(),$=P.getEnvelope();I.y<$.getMinY()||I.y>$.getMaxY()||this.findStabbedSegments(I,P.getDirectedEdges(),y)}return y}if(arguments.length===3){if(Tr(arguments[2],lr)&&arguments[0]instanceof Be&&arguments[1]instanceof Ka){for(var ne=arguments[0],ye=arguments[1],Oe=arguments[2],tt=ye.getEdge().getCoordinates(),ht=0;ht<tt.length-1;ht++)if(this._seg.p0=tt[ht],this._seg.p1=tt[ht+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<ne.x||this._seg.isHorizontal()||ne.y<this._seg.p0.y||ne.y>this._seg.p1.y||We.index(this._seg.p0,this._seg.p1,ne)===We.RIGHT)){var rr=ye.getDepth(_t.LEFT);this._seg.p0.equals(tt[ht])||(rr=ye.getDepth(_t.RIGHT));var ur=new Di(this._seg,rr);Oe.add(ur)}}else if(Tr(arguments[2],lr)&&arguments[0]instanceof Be&&Tr(arguments[1],lr))for(var qr=arguments[0],bn=arguments[2],Dn=arguments[1].iterator();Dn.hasNext();){var Xn=Dn.next();Xn.isForward()&&this.findStabbedSegments(qr,Xn,bn)}}}},{key:"getDepth",value:function(I){var y=this.findStabbedSegments(I);return y.size()===0?0:ri.min(y)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new Xi;var I=arguments[0];this._subgraphs=I}}])})(),Di=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"compareTo",value:function(I){var y=I;if(this._upwardSeg.minX()>=y._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=y._upwardSeg.minX())return-1;var _=this._upwardSeg.orientationIndex(y._upwardSeg);return _!==0||(_=-1*y._upwardSeg.orientationIndex(this._upwardSeg))!==0?_:this._upwardSeg.compareTo(y._upwardSeg)}},{key:"compareX",value:function(I,y){var _=I.p0.compareTo(y.p0);return _!==0?_:I.p1.compareTo(y.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var I=arguments[0],y=arguments[1];this._upwardSeg=new Xi(I),this._leftDepth=y}}])})();gs.DepthSegment=Di;var qo=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,null,[{key:"constructor_",value:function(){O.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])})(O),Da=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getY",value:function(){var y=this.y/this.w;if(Ae.isNaN(y)||Ae.isInfinite(y))throw new qo;return y}},{key:"getX",value:function(){var y=this.x/this.w;if(Ae.isNaN(y)||Ae.isInfinite(y))throw new qo;return y}},{key:"getCoordinate",value:function(){var y=new Be;return y.x=this.getX(),y.y=this.getY(),y}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var y=arguments[0];this.x=y.x,this.y=y.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var _=arguments[0],P=arguments[1];this.x=_,this.y=P,this.w=1}else if(arguments[0]instanceof I&&arguments[1]instanceof I){var $=arguments[0],ne=arguments[1];this.x=$.y*ne.w-ne.y*$.w,this.y=ne.x*$.w-$.x*ne.w,this.w=$.x*ne.y-ne.x*$.y}else if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var ye=arguments[0],Oe=arguments[1];this.x=ye.y-Oe.y,this.y=Oe.x-ye.x,this.w=ye.x*Oe.y-Oe.x*ye.y}}else if(arguments.length===3){var tt=arguments[0],ht=arguments[1],rr=arguments[2];this.x=tt,this.y=ht,this.w=rr}else if(arguments.length===4){var ur=arguments[0],qr=arguments[1],bn=arguments[2],Dn=arguments[3],Xn=ur.y-qr.y,Fn=qr.x-ur.x,En=ur.x*qr.y-qr.x*ur.y,na=bn.y-Dn.y,ca=Dn.x-bn.x,so=bn.x*Dn.y-Dn.x*bn.y;this.x=Fn*so-ca*En,this.y=na*En-Xn*so,this.w=Xn*ca-na*Fn}}}])})(),ns=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"area",value:function(){return I.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return I.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(y){if(y===null)throw new U("Supplied point is null.");return I.interpolateZ(y,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return I.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return I.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return I.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return I.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return I.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return I.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var y=arguments[0],_=arguments[1],P=arguments[2];this.p0=y,this.p1=_,this.p2=P}},{key:"area",value:function(y,_,P){return Math.abs(((P.x-y.x)*(_.y-y.y)-(_.x-y.x)*(P.y-y.y))/2)}},{key:"signedArea",value:function(y,_,P){return((P.x-y.x)*(_.y-y.y)-(_.x-y.x)*(P.y-y.y))/2}},{key:"det",value:function(y,_,P,$){return y*$-_*P}},{key:"interpolateZ",value:function(y,_,P,$){var ne=_.x,ye=_.y,Oe=P.x-ne,tt=$.x-ne,ht=P.y-ye,rr=$.y-ye,ur=Oe*rr-tt*ht,qr=y.x-ne,bn=y.y-ye,Dn=(rr*qr-tt*bn)/ur,Xn=(-ht*qr+Oe*bn)/ur;return _.getZ()+Dn*(P.getZ()-_.getZ())+Xn*($.getZ()-_.getZ())}},{key:"longestSideLength",value:function(y,_,P){var $=y.distance(_),ne=_.distance(P),ye=P.distance(y),Oe=$;return ne>Oe&&(Oe=ne),ye>Oe&&(Oe=ye),Oe}},{key:"circumcentreDD",value:function(y,_,P){var $=be.valueOf(y.x).subtract(P.x),ne=be.valueOf(y.y).subtract(P.y),ye=be.valueOf(_.x).subtract(P.x),Oe=be.valueOf(_.y).subtract(P.y),tt=be.determinant($,ne,ye,Oe).multiply(2),ht=$.sqr().add(ne.sqr()),rr=ye.sqr().add(Oe.sqr()),ur=be.determinant(ne,ht,Oe,rr),qr=be.determinant($,ht,ye,rr),bn=be.valueOf(P.x).subtract(ur.divide(tt)).doubleValue(),Dn=be.valueOf(P.y).add(qr.divide(tt)).doubleValue();return new Be(bn,Dn)}},{key:"isAcute",value:function(y,_,P){return!!Pa.isAcute(y,_,P)&&!!Pa.isAcute(_,P,y)&&!!Pa.isAcute(P,y,_)}},{key:"circumcentre",value:function(y,_,P){var $=P.x,ne=P.y,ye=y.x-$,Oe=y.y-ne,tt=_.x-$,ht=_.y-ne,rr=2*I.det(ye,Oe,tt,ht),ur=I.det(Oe,ye*ye+Oe*Oe,ht,tt*tt+ht*ht),qr=I.det(ye,ye*ye+Oe*Oe,tt,tt*tt+ht*ht);return new Be($-ur/rr,ne+qr/rr)}},{key:"perpendicularBisector",value:function(y,_){var P=_.x-y.x,$=_.y-y.y,ne=new Da(y.x+P/2,y.y+$/2,1),ye=new Da(y.x-$+P/2,y.y+P+$/2,1);return new Da(ne,ye)}},{key:"angleBisector",value:function(y,_,P){var $=_.distance(y),ne=$/($+_.distance(P)),ye=P.x-y.x,Oe=P.y-y.y;return new Be(y.x+ne*ye,y.y+ne*Oe)}},{key:"area3D",value:function(y,_,P){var $=_.x-y.x,ne=_.y-y.y,ye=_.getZ()-y.getZ(),Oe=P.x-y.x,tt=P.y-y.y,ht=P.getZ()-y.getZ(),rr=ne*ht-ye*tt,ur=ye*Oe-$*ht,qr=$*tt-ne*Oe,bn=rr*rr+ur*ur+qr*qr,Dn=Math.sqrt(bn)/2;return Dn}},{key:"centroid",value:function(y,_,P){var $=(y.x+_.x+P.x)/3,ne=(y.y+_.y+P.y)/3;return new Be($,ne)}},{key:"inCentre",value:function(y,_,P){var $=_.distance(P),ne=y.distance(P),ye=y.distance(_),Oe=$+ne+ye,tt=($*y.x+ne*_.x+ye*P.x)/Oe,ht=($*y.y+ne*_.y+ye*P.y)/Oe;return new Be(tt,ht)}}])})(),As=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"addRingSide",value:function(I,y,_,P,$){if(y===0&&I.length<Bn.MINIMUM_VALID_SIZE)return null;var ne=P,ye=$;I.length>=Bn.MINIMUM_VALID_SIZE&&We.isCCW(I)&&(ne=$,ye=P,_=_t.opposite(_));var Oe=this._curveBuilder.getRingCurve(I,_,y);this.addCurve(Oe,ne,ye)}},{key:"addRingBothSides",value:function(I,y){this.addRingSide(I,y,_t.LEFT,Re.EXTERIOR,Re.INTERIOR),this.addRingSide(I,y,_t.RIGHT,Re.INTERIOR,Re.EXTERIOR)}},{key:"addPoint",value:function(I){if(this._distance<=0)return null;var y=I.getCoordinates(),_=this._curveBuilder.getLineCurve(y,this._distance);this.addCurve(_,Re.EXTERIOR,Re.INTERIOR)}},{key:"addPolygon",value:function(I){var y=this._distance,_=_t.LEFT;this._distance<0&&(y=-this._distance,_=_t.RIGHT);var P=I.getExteriorRing(),$=Gi.removeRepeatedPoints(P.getCoordinates());if(this._distance<0&&this.isErodedCompletely(P,this._distance)||this._distance<=0&&$.length<3)return null;this.addRingSide($,y,_,Re.EXTERIOR,Re.INTERIOR);for(var ne=0;ne<I.getNumInteriorRing();ne++){var ye=I.getInteriorRingN(ne),Oe=Gi.removeRepeatedPoints(ye.getCoordinates());this._distance>0&&this.isErodedCompletely(ye,-this._distance)||this.addRingSide(Oe,y,_t.opposite(_),Re.INTERIOR,Re.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(I,y){var _=new ns(I[0],I[1],I[2]),P=_.inCentre();return hn.pointToSegment(P,_.p0,_.p1)<Math.abs(y)}},{key:"addLineString",value:function(I){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var y=Gi.removeRepeatedPoints(I.getCoordinates());if(Gi.isRing(y)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(y,this._distance);else{var _=this._curveBuilder.getLineCurve(y,this._distance);this.addCurve(_,Re.EXTERIOR,Re.INTERIOR)}}},{key:"addCurve",value:function(I,y,_){if(I===null||I.length<2)return null;var P=new Ui(I,new $n(0,Re.BOUNDARY,y,_));this._curveList.add(P)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(I){if(I.isEmpty())return null;if(I instanceof Xr)this.addPolygon(I);else if(I instanceof Kn)this.addLineString(I);else if(I instanceof He)this.addPoint(I);else if(I instanceof Mn)this.addCollection(I);else if(I instanceof ds)this.addCollection(I);else if(I instanceof xi)this.addCollection(I);else{if(!(I instanceof Fr))throw new $e(I.getGeometryType());this.addCollection(I)}}},{key:"isErodedCompletely",value:function(I,y){var _=I.getCoordinates();if(_.length<4)return y<0;if(_.length===4)return this.isTriangleErodedCompletely(_,y);var P=I.getEnvelopeInternal(),$=Math.min(P.getHeight(),P.getWidth());return y<0&&2*Math.abs(y)>$}},{key:"addCollection",value:function(I){for(var y=0;y<I.getNumGeometries();y++){var _=I.getGeometryN(y);this.add(_)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new ct;var I=arguments[0],y=arguments[1],_=arguments[2];this._inputGeom=I,this._distance=y,this._curveBuilder=_}}])})(),Ja=(function(){return o((function I(){i(this,I)}),[{key:"locate",value:function(I){}}])})(),rc=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,I.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new st;var y=this._parent.getGeometryN(this._index++);return y instanceof Fr?(this._subcollectionIterator=new I(y),this._subcollectionIterator.next()):y}},{key:"remove",value:function(){throw new $e(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[Ln]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var y=arguments[0];this._parent=y,this._atStart=!0,this._index=0,this._max=y.getNumGeometries()}},{key:"isAtomic",value:function(y){return!(y instanceof Fr)}}])})(),uu=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"locate",value:function(y){return I.locate(y,this._geom)}},{key:"interfaces_",get:function(){return[Ja]}}],[{key:"constructor_",value:function(){this._geom=null;var y=arguments[0];this._geom=y}},{key:"locatePointInPolygon",value:function(y,_){if(_.isEmpty())return Re.EXTERIOR;var P=_.getExteriorRing(),$=I.locatePointInRing(y,P);if($!==Re.INTERIOR)return $;for(var ne=0;ne<_.getNumInteriorRing();ne++){var ye=_.getInteriorRingN(ne),Oe=I.locatePointInRing(y,ye);if(Oe===Re.BOUNDARY)return Re.BOUNDARY;if(Oe===Re.INTERIOR)return Re.EXTERIOR}return Re.INTERIOR}},{key:"locatePointInRing",value:function(y,_){return _.getEnvelopeInternal().intersects(y)?ti.locateInRing(y,_.getCoordinates()):Re.EXTERIOR}},{key:"containsPointInPolygon",value:function(y,_){return Re.EXTERIOR!==I.locatePointInPolygon(y,_)}},{key:"locateInGeometry",value:function(y,_){if(_ instanceof Xr)return I.locatePointInPolygon(y,_);if(_ instanceof Fr)for(var P=new rc(_);P.hasNext();){var $=P.next();if($!==_){var ne=I.locateInGeometry(y,$);if(ne!==Re.EXTERIOR)return ne}}return Re.EXTERIOR}},{key:"isContained",value:function(y,_){return Re.EXTERIOR!==I.locate(y,_)}},{key:"locate",value:function(y,_){return _.isEmpty()?Re.EXTERIOR:_.getEnvelopeInternal().intersects(y)?I.locateInGeometry(y,_):Re.EXTERIOR}}])})(),Ys=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getNextCW",value:function(I){this.getEdges();var y=this._edgeList.indexOf(I),_=y-1;return y===0&&(_=this._edgeList.size()-1),this._edgeList.get(_)}},{key:"propagateSideLabels",value:function(I){for(var y=Re.NONE,_=this.iterator();_.hasNext();){var P=_.next().getLabel();P.isArea(I)&&P.getLocation(I,_t.LEFT)!==Re.NONE&&(y=P.getLocation(I,_t.LEFT))}if(y===Re.NONE)return null;for(var $=y,ne=this.iterator();ne.hasNext();){var ye=ne.next(),Oe=ye.getLabel();if(Oe.getLocation(I,_t.ON)===Re.NONE&&Oe.setLocation(I,_t.ON,$),Oe.isArea(I)){var tt=Oe.getLocation(I,_t.LEFT),ht=Oe.getLocation(I,_t.RIGHT);if(ht!==Re.NONE){if(ht!==$)throw new Et("side location conflict",ye.getCoordinate());tt===Re.NONE&&we.shouldNeverReachHere("found single null side (at "+ye.getCoordinate()+")"),$=tt}else we.isTrue(Oe.getLocation(I,_t.LEFT)===Re.NONE,"found single null side"),Oe.setLocation(I,_t.RIGHT,$),Oe.setLocation(I,_t.LEFT,$)}}}},{key:"getCoordinate",value:function(){var I=this.iterator();return I.hasNext()?I.next().getCoordinate():null}},{key:"print",value:function(I){Ar.out.println("EdgeEndStar:   "+this.getCoordinate());for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"isAreaLabelsConsistent",value:function(I){return this.computeEdgeEndLabels(I.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(I){var y=this.getEdges();if(y.size()<=0)return!0;var _=y.size()-1,P=y.get(_).getLabel().getLocation(I,_t.LEFT);we.isTrue(P!==Re.NONE,"Found unlabelled area edge");for(var $=P,ne=this.iterator();ne.hasNext();){var ye=ne.next().getLabel();we.isTrue(ye.isArea(I),"Found non-area edge");var Oe=ye.getLocation(I,_t.LEFT),tt=ye.getLocation(I,_t.RIGHT);if(Oe===tt||tt!==$)return!1;$=Oe}return!0}},{key:"findIndex",value:function(I){this.iterator();for(var y=0;y<this._edgeList.size();y++)if(this._edgeList.get(y)===I)return y;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new ct(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(I,y,_){return this._ptInAreaLocation[I]===Re.NONE&&(this._ptInAreaLocation[I]=uu.locate(y,_[I].getGeometry())),this._ptInAreaLocation[I]}},{key:"toString",value:function(){var I=new Qt;I.append("EdgeEndStar:   "+this.getCoordinate()),I.append(`
`);for(var y=this.iterator();y.hasNext();){var _=y.next();I.append(_),I.append(`
`)}return I.toString()}},{key:"computeEdgeEndLabels",value:function(I){for(var y=this.iterator();y.hasNext();)y.next().computeLabel(I)}},{key:"computeLabelling",value:function(I){this.computeEdgeEndLabels(I[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var y=[!1,!1],_=this.iterator();_.hasNext();)for(var P=_.next().getLabel(),$=0;$<2;$++)P.isLine($)&&P.getLocation($)===Re.BOUNDARY&&(y[$]=!0);for(var ne=this.iterator();ne.hasNext();)for(var ye=ne.next(),Oe=ye.getLabel(),tt=0;tt<2;tt++)if(Oe.isAnyNull(tt)){var ht=Re.NONE;if(y[tt])ht=Re.EXTERIOR;else{var rr=ye.getCoordinate();ht=this.getLocation(tt,rr,I)}Oe.setAllLocationsIfNull(tt,ht)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(I,y){this._edgeMap.put(I,y),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new Mi,this._edgeList=null,this._ptInAreaLocation=[Re.NONE,Re.NONE]}}])})(),ja=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var _=null,P=null,$=this._SCANNING_FOR_INCOMING,ne=0;ne<this._resultAreaEdgeList.size();ne++){var ye=this._resultAreaEdgeList.get(ne),Oe=ye.getSym();if(ye.getLabel().isArea())switch(_===null&&ye.isInResult()&&(_=ye),$){case this._SCANNING_FOR_INCOMING:if(!Oe.isInResult())continue;P=Oe,$=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!ye.isInResult())continue;P.setNext(ye),$=this._SCANNING_FOR_INCOMING}}if($===this._LINKING_TO_OUTGOING){if(_===null)throw new Et("no outgoing dirEdge found",this.getCoordinate());we.isTrue(_.isInResult(),"unable to link last incoming dirEdge"),P.setNext(_)}}},{key:"insert",value:function(_){var P=_;this.insertEdgeEnd(P,P)}},{key:"getRightmostEdge",value:function(){var _=this.getEdges(),P=_.size();if(P<1)return null;var $=_.get(0);if(P===1)return $;var ne=_.get(P-1),ye=$.getQuadrant(),Oe=ne.getQuadrant();return oa.isNorthern(ye)&&oa.isNorthern(Oe)?$:oa.isNorthern(ye)||oa.isNorthern(Oe)?$.getDy()!==0?$:ne.getDy()!==0?ne:(we.shouldNeverReachHere("found two horizontal edges incident on node"),null):ne}},{key:"print",value:function(_){Ar.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var P=this.iterator();P.hasNext();){var $=P.next();_.print("out "),$.print(_),_.println(),_.print("in "),$.getSym().print(_),_.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new ct;for(var _=this.iterator();_.hasNext();){var P=_.next();(P.isInResult()||P.getSym().isInResult())&&this._resultAreaEdgeList.add(P)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(_){for(var P=this.iterator();P.hasNext();){var $=P.next().getLabel();$.setAllLocationsIfNull(0,_.getLocation(0)),$.setAllLocationsIfNull(1,_.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var _=null,P=null,$=this._edgeList.size()-1;$>=0;$--){var ne=this._edgeList.get($),ye=ne.getSym();P===null&&(P=ye),_!==null&&ye.setNext(_),_=ne}P.setNext(_)}},{key:"computeDepths",value:function(){if(arguments.length===1){var _=arguments[0],P=this.findIndex(_),$=_.getDepth(_t.LEFT),ne=_.getDepth(_t.RIGHT),ye=this.computeDepths(P+1,this._edgeList.size(),$);if(this.computeDepths(0,P,ye)!==ne)throw new Et("depth mismatch at "+_.getCoordinate())}else if(arguments.length===3){for(var Oe=arguments[1],tt=arguments[2],ht=arguments[0];ht<Oe;ht++){var rr=this._edgeList.get(ht);rr.setEdgeDepths(_t.RIGHT,tt),tt=rr.getDepth(_t.LEFT)}return tt}}},{key:"mergeSymLabels",value:function(){for(var _=this.iterator();_.hasNext();){var P=_.next();P.getLabel().merge(P.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(_){for(var P=null,$=null,ne=this._SCANNING_FOR_INCOMING,ye=this._resultAreaEdgeList.size()-1;ye>=0;ye--){var Oe=this._resultAreaEdgeList.get(ye),tt=Oe.getSym();switch(P===null&&Oe.getEdgeRing()===_&&(P=Oe),ne){case this._SCANNING_FOR_INCOMING:if(tt.getEdgeRing()!==_)continue;$=tt,ne=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(Oe.getEdgeRing()!==_)continue;$.setNextMin(Oe),ne=this._SCANNING_FOR_INCOMING}}ne===this._LINKING_TO_OUTGOING&&(we.isTrue(P!==null,"found null for first outgoing dirEdge"),we.isTrue(P.getEdgeRing()===_,"unable to link last incoming dirEdge"),$.setNextMin(P))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var _=0,P=this.iterator();P.hasNext();)P.next().isInResult()&&_++;return _}if(arguments.length===1){for(var $=arguments[0],ne=0,ye=this.iterator();ye.hasNext();)ye.next().getEdgeRing()===$&&ne++;return ne}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var _=Re.NONE,P=this.iterator();P.hasNext();){var $=P.next(),ne=$.getSym();if(!$.isLineEdge()){if($.isInResult()){_=Re.INTERIOR;break}if(ne.isInResult()){_=Re.EXTERIOR;break}}}if(_===Re.NONE)return null;for(var ye=_,Oe=this.iterator();Oe.hasNext();){var tt=Oe.next(),ht=tt.getSym();tt.isLineEdge()?tt.getEdge().setCovered(ye===Re.INTERIOR):(tt.isInResult()&&(ye=Re.EXTERIOR),ht.isInResult()&&(ye=Re.INTERIOR))}}},{key:"computeLabelling",value:function(_){E(y,"computeLabelling",this,1).call(this,_),this._label=new $n(Re.NONE);for(var P=this.iterator();P.hasNext();)for(var $=P.next().getEdge().getLabel(),ne=0;ne<2;ne++){var ye=$.getLocation(ne);ye!==Re.INTERIOR&&ye!==Re.BOUNDARY||this._label.setLocation(ne,Re.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])})(Ys),Is=(function(I){function y(){return i(this,y),n(this,y)}return m(y,I),o(y,[{key:"createNode",value:function(_){return new hi(_,new ja)}}])})($s),nc=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"compareTo",value:function(y){var _=y;return I.compareOriented(this._pts,this._orientation,_._pts,_._orientation)}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var y=arguments[0];this._pts=y,this._orientation=I.orientation(y)}},{key:"orientation",value:function(y){return Gi.increasingDirection(y)===1}},{key:"compareOriented",value:function(y,_,P,$){for(var ne=_?1:-1,ye=$?1:-1,Oe=_?y.length:-1,tt=$?P.length:-1,ht=_?0:y.length-1,rr=$?0:P.length-1;;){var ur=y[ht].compareTo(P[rr]);if(ur!==0)return ur;var qr=(ht+=ne)===Oe,bn=(rr+=ye)===tt;if(qr&&!bn)return-1;if(!qr&&bn)return 1;if(qr&&bn)return 0}}}])})(),ic=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"print",value:function(I){I.print("MULTILINESTRING ( ");for(var y=0;y<this._edges.size();y++){var _=this._edges.get(y);y>0&&I.print(","),I.print("(");for(var P=_.getCoordinates(),$=0;$<P.length;$++)$>0&&I.print(","),I.print(P[$].x+" "+P[$].y);I.println(")")}I.print(")  ")}},{key:"addAll",value:function(I){for(var y=I.iterator();y.hasNext();)this.add(y.next())}},{key:"findEdgeIndex",value:function(I){for(var y=0;y<this._edges.size();y++)if(this._edges.get(y).equals(I))return y;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(I){return this._edges.get(I)}},{key:"findEqualEdge",value:function(I){var y=new nc(I.getCoordinates());return this._ocaMap.get(y)}},{key:"add",value:function(I){this._edges.add(I);var y=new nc(I.getCoordinates());this._ocaMap.put(y,I)}}],[{key:"constructor_",value:function(){this._edges=new ct,this._ocaMap=new Mi}}])})(),ul=(function(){return o((function I(){i(this,I)}),[{key:"processIntersections",value:function(I,y,_,P){}},{key:"isDone",value:function(){}}])})(),cu=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isTrivialIntersection",value:function(y,_,P,$){if(y===P&&this._li.getIntersectionNum()===1){if(I.isAdjacentSegments(_,$))return!0;if(y.isClosed()){var ne=y.size()-1;if(_===0&&$===ne||$===0&&_===ne)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(y,_,P,$){if(y===P&&_===$)return null;this.numTests++;var ne=y.getCoordinates()[_],ye=y.getCoordinates()[_+1],Oe=P.getCoordinates()[$],tt=P.getCoordinates()[$+1];this._li.computeIntersection(ne,ye,Oe,tt),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(y,_,P,$)||(this._hasIntersection=!0,y.addIntersections(this._li,_,0),P.addIntersections(this._li,$,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[ul]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var y=arguments[0];this._li=y}},{key:"isAdjacentSegments",value:function(y,_){return Math.abs(y-_)===1}}])})(),Oo=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(I){I.print(this.coord),I.print(" seg # = "+this.segmentIndex),I.println(" dist = "+this.dist)}},{key:"compareTo",value:function(I){var y=I;return this.compare(y.segmentIndex,y.dist)}},{key:"isEndPoint",value:function(I){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===I}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(I,y){return this.segmentIndex<I?-1:this.segmentIndex>I?1:this.dist<y?-1:this.dist>y?1:0}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var I=arguments[0],y=arguments[1],_=arguments[2];this.coord=new Be(I),this.segmentIndex=y,this.dist=_}}])})(),mo=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"print",value:function(I){I.println("Intersections:");for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(I){this.addEndpoints();for(var y=this.iterator(),_=y.next();y.hasNext();){var P=y.next(),$=this.createSplitEdge(_,P);I.add($),_=P}}},{key:"addEndpoints",value:function(){var I=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[I],I,0)}},{key:"createSplitEdge",value:function(I,y){var _=y.segmentIndex-I.segmentIndex+2,P=this.edge.pts[y.segmentIndex],$=y.dist>0||!y.coord.equals2D(P);$||_--;var ne=new Array(_).fill(null),ye=0;ne[ye++]=new Be(I.coord);for(var Oe=I.segmentIndex+1;Oe<=y.segmentIndex;Oe++)ne[ye++]=this.edge.pts[Oe];return $&&(ne[ye]=y.coord),new Va(ne,new $n(this.edge._label))}},{key:"add",value:function(I,y,_){var P=new Oo(I,y,_),$=this._nodeMap.get(P);return $!==null?$:(this._nodeMap.put(P,P),P)}},{key:"isIntersection",value:function(I){for(var y=this.iterator();y.hasNext();)if(y.next().coord.equals(I))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new Mi,this.edge=null;var I=arguments[0];this.edge=I}}])})(),Du=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(I.isTrue(this._matrix[Re.INTERIOR][Re.INTERIOR])||I.isTrue(this._matrix[Re.INTERIOR][Re.BOUNDARY])||I.isTrue(this._matrix[Re.BOUNDARY][Re.INTERIOR])||I.isTrue(this._matrix[Re.BOUNDARY][Re.BOUNDARY]))&&this._matrix[Re.EXTERIOR][Re.INTERIOR]===nr.FALSE&&this._matrix[Re.EXTERIOR][Re.BOUNDARY]===nr.FALSE}},{key:"isCoveredBy",value:function(){return(I.isTrue(this._matrix[Re.INTERIOR][Re.INTERIOR])||I.isTrue(this._matrix[Re.INTERIOR][Re.BOUNDARY])||I.isTrue(this._matrix[Re.BOUNDARY][Re.INTERIOR])||I.isTrue(this._matrix[Re.BOUNDARY][Re.BOUNDARY]))&&this._matrix[Re.INTERIOR][Re.EXTERIOR]===nr.FALSE&&this._matrix[Re.BOUNDARY][Re.EXTERIOR]===nr.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<y.length;_++){var P=Math.trunc(_/3),$=_%3;this._matrix[P][$]=nr.toDimensionValue(y.charAt(_))}else if(arguments.length===3){var ne=arguments[0],ye=arguments[1],Oe=arguments[2];this._matrix[ne][ye]=Oe}}},{key:"isContains",value:function(){return I.isTrue(this._matrix[Re.INTERIOR][Re.INTERIOR])&&this._matrix[Re.EXTERIOR][Re.INTERIOR]===nr.FALSE&&this._matrix[Re.EXTERIOR][Re.BOUNDARY]===nr.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<y.length;_++){var P=Math.trunc(_/3),$=_%3;this.setAtLeast(P,$,nr.toDimensionValue(y.charAt(_)))}else if(arguments.length===3){var ne=arguments[0],ye=arguments[1],Oe=arguments[2];this._matrix[ne][ye]<Oe&&(this._matrix[ne][ye]=Oe)}}},{key:"setAtLeastIfValid",value:function(y,_,P){y>=0&&_>=0&&this.setAtLeast(y,_,P)}},{key:"isWithin",value:function(){return I.isTrue(this._matrix[Re.INTERIOR][Re.INTERIOR])&&this._matrix[Re.INTERIOR][Re.EXTERIOR]===nr.FALSE&&this._matrix[Re.BOUNDARY][Re.EXTERIOR]===nr.FALSE}},{key:"isTouches",value:function(y,_){return y>_?this.isTouches(_,y):(y===nr.A&&_===nr.A||y===nr.L&&_===nr.L||y===nr.L&&_===nr.A||y===nr.P&&_===nr.A||y===nr.P&&_===nr.L)&&this._matrix[Re.INTERIOR][Re.INTERIOR]===nr.FALSE&&(I.isTrue(this._matrix[Re.INTERIOR][Re.BOUNDARY])||I.isTrue(this._matrix[Re.BOUNDARY][Re.INTERIOR])||I.isTrue(this._matrix[Re.BOUNDARY][Re.BOUNDARY]))}},{key:"isOverlaps",value:function(y,_){return y===nr.P&&_===nr.P||y===nr.A&&_===nr.A?I.isTrue(this._matrix[Re.INTERIOR][Re.INTERIOR])&&I.isTrue(this._matrix[Re.INTERIOR][Re.EXTERIOR])&&I.isTrue(this._matrix[Re.EXTERIOR][Re.INTERIOR]):y===nr.L&&_===nr.L&&this._matrix[Re.INTERIOR][Re.INTERIOR]===1&&I.isTrue(this._matrix[Re.INTERIOR][Re.EXTERIOR])&&I.isTrue(this._matrix[Re.EXTERIOR][Re.INTERIOR])}},{key:"isEquals",value:function(y,_){return y===_&&I.isTrue(this._matrix[Re.INTERIOR][Re.INTERIOR])&&this._matrix[Re.INTERIOR][Re.EXTERIOR]===nr.FALSE&&this._matrix[Re.BOUNDARY][Re.EXTERIOR]===nr.FALSE&&this._matrix[Re.EXTERIOR][Re.INTERIOR]===nr.FALSE&&this._matrix[Re.EXTERIOR][Re.BOUNDARY]===nr.FALSE}},{key:"toString",value:function(){for(var y=new Mo("123456789"),_=0;_<3;_++)for(var P=0;P<3;P++)y.setCharAt(3*_+P,nr.toDimensionSymbol(this._matrix[_][P]));return y.toString()}},{key:"setAll",value:function(y){for(var _=0;_<3;_++)for(var P=0;P<3;P++)this._matrix[_][P]=y}},{key:"get",value:function(y,_){return this._matrix[y][_]}},{key:"transpose",value:function(){var y=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=y,y=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=y,y=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=y,this}},{key:"matches",value:function(y){if(y.length!==9)throw new U("Should be length 9: "+y);for(var _=0;_<3;_++)for(var P=0;P<3;P++)if(!I.matches(this._matrix[_][P],y.charAt(3*_+P)))return!1;return!0}},{key:"add",value:function(y){for(var _=0;_<3;_++)for(var P=0;P<3;P++)this.setAtLeast(_,P,y.get(_,P))}},{key:"isDisjoint",value:function(){return this._matrix[Re.INTERIOR][Re.INTERIOR]===nr.FALSE&&this._matrix[Re.INTERIOR][Re.BOUNDARY]===nr.FALSE&&this._matrix[Re.BOUNDARY][Re.INTERIOR]===nr.FALSE&&this._matrix[Re.BOUNDARY][Re.BOUNDARY]===nr.FALSE}},{key:"isCrosses",value:function(y,_){return y===nr.P&&_===nr.L||y===nr.P&&_===nr.A||y===nr.L&&_===nr.A?I.isTrue(this._matrix[Re.INTERIOR][Re.INTERIOR])&&I.isTrue(this._matrix[Re.INTERIOR][Re.EXTERIOR]):y===nr.L&&_===nr.P||y===nr.A&&_===nr.P||y===nr.A&&_===nr.L?I.isTrue(this._matrix[Re.INTERIOR][Re.INTERIOR])&&I.isTrue(this._matrix[Re.EXTERIOR][Re.INTERIOR]):y===nr.L&&_===nr.L&&this._matrix[Re.INTERIOR][Re.INTERIOR]===0}},{key:"interfaces_",get:function(){return[G]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map((function(){return Array(3)})),this.setAll(nr.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var y=arguments[0];I.constructor_.call(this),this.set(y)}else if(arguments[0]instanceof I){var _=arguments[0];I.constructor_.call(this),this._matrix[Re.INTERIOR][Re.INTERIOR]=_._matrix[Re.INTERIOR][Re.INTERIOR],this._matrix[Re.INTERIOR][Re.BOUNDARY]=_._matrix[Re.INTERIOR][Re.BOUNDARY],this._matrix[Re.INTERIOR][Re.EXTERIOR]=_._matrix[Re.INTERIOR][Re.EXTERIOR],this._matrix[Re.BOUNDARY][Re.INTERIOR]=_._matrix[Re.BOUNDARY][Re.INTERIOR],this._matrix[Re.BOUNDARY][Re.BOUNDARY]=_._matrix[Re.BOUNDARY][Re.BOUNDARY],this._matrix[Re.BOUNDARY][Re.EXTERIOR]=_._matrix[Re.BOUNDARY][Re.EXTERIOR],this._matrix[Re.EXTERIOR][Re.INTERIOR]=_._matrix[Re.EXTERIOR][Re.INTERIOR],this._matrix[Re.EXTERIOR][Re.BOUNDARY]=_._matrix[Re.EXTERIOR][Re.BOUNDARY],this._matrix[Re.EXTERIOR][Re.EXTERIOR]=_._matrix[Re.EXTERIOR][Re.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var y=arguments[0],_=arguments[1];return _===nr.SYM_DONTCARE||_===nr.SYM_TRUE&&(y>=0||y===nr.TRUE)||_===nr.SYM_FALSE&&y===nr.FALSE||_===nr.SYM_P&&y===nr.P||_===nr.SYM_L&&y===nr.L||_===nr.SYM_A&&y===nr.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var P=arguments[1];return new I(arguments[0]).matches(P)}}},{key:"isTrue",value:function(y){return y>=0||y===nr.TRUE}}])})(),Ua=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(y){return y===null||y.length===0?null:(this.ensureCapacity(this._size+y.length),Ar.arraycopy(y,0,this._data,this._size,y.length),void(this._size+=y.length))}},{key:"ensureCapacity",value:function(y){if(y<=this._data.length)return null;var _=Math.max(y,2*this._data.length);this._data=Wt.copyOf(this._data,_)}},{key:"toArray",value:function(){var y=new Array(this._size).fill(null);return Ar.arraycopy(this._data,0,y,0,this._size),y}},{key:"add",value:function(y){this.ensureCapacity(this._size+1),this._data[this._size]=y,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)I.constructor_.call(this,10);else if(arguments.length===1){var y=arguments[0];this._data=new Array(y).fill(null)}}}])})(),hu=(function(){function I(){i(this,I)}return o(I,[{key:"getChainStartIndices",value:function(y){var _=0,P=new Ua(Math.trunc(y.length/2));P.add(_);do{var $=this.findChainEnd(y,_);P.add($),_=$}while(_<y.length-1);return P.toArray()}},{key:"findChainEnd",value:function(y,_){for(var P=oa.quadrant(y[_],y[_+1]),$=_+1;$<y.length&&oa.quadrant(y[$-1],y[$])===P;)$++;return $-1}},{key:"OLDgetChainStartIndices",value:function(y){var _=0,P=new ct;P.add(_);do{var $=this.findChainEnd(y,_);P.add($),_=$}while(_<y.length-1);return I.toIntArray(P)}}],[{key:"toIntArray",value:function(y){for(var _=new Array(y.size()).fill(null),P=0;P<_.length;P++)_[P]=y.get(P).intValue();return _}}])})(),Zs=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(I){var y=this.pts[this.startIndex[I]].x,_=this.pts[this.startIndex[I+1]].x;return y>_?y:_}},{key:"getMinX",value:function(I){var y=this.pts[this.startIndex[I]].x,_=this.pts[this.startIndex[I+1]].x;return y<_?y:_}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var I=arguments[0],y=arguments[1],_=arguments[2],P=arguments[3];this.computeIntersectsForChain(this.startIndex[I],this.startIndex[I+1],y,y.startIndex[_],y.startIndex[_+1],P)}else if(arguments.length===6){var $=arguments[0],ne=arguments[1],ye=arguments[2],Oe=arguments[3],tt=arguments[4],ht=arguments[5];if(ne-$==1&&tt-Oe==1)return ht.addIntersections(this.e,$,ye.e,Oe),null;if(!this.overlaps($,ne,ye,Oe,tt))return null;var rr=Math.trunc(($+ne)/2),ur=Math.trunc((Oe+tt)/2);$<rr&&(Oe<ur&&this.computeIntersectsForChain($,rr,ye,Oe,ur,ht),ur<tt&&this.computeIntersectsForChain($,rr,ye,ur,tt,ht)),rr<ne&&(Oe<ur&&this.computeIntersectsForChain(rr,ne,ye,Oe,ur,ht),ur<tt&&this.computeIntersectsForChain(rr,ne,ye,ur,tt,ht))}}},{key:"overlaps",value:function(I,y,_,P,$){return Qe.intersects(this.pts[I],this.pts[y],_.pts[P],_.pts[$])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(I,y){for(var _=0;_<this.startIndex.length-1;_++)for(var P=0;P<I.startIndex.length-1;P++)this.computeIntersectsForChain(_,I,P,y)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var I=arguments[0];this.e=I,this.pts=I.getCoordinates();var y=new hu;this.startIndex=y.getChainStartIndices(this.pts)}}])})(),ms=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getDepth",value:function(y,_){return this._depth[y][_]}},{key:"setDepth",value:function(y,_,P){this._depth[y][_]=P}},{key:"isNull",value:function(){if(arguments.length===0){for(var y=0;y<2;y++)for(var _=0;_<3;_++)if(this._depth[y][_]!==I.NULL_VALUE)return!1;return!0}if(arguments.length===1){var P=arguments[0];return this._depth[P][1]===I.NULL_VALUE}if(arguments.length===2){var $=arguments[0],ne=arguments[1];return this._depth[$][ne]===I.NULL_VALUE}}},{key:"normalize",value:function(){for(var y=0;y<2;y++)if(!this.isNull(y)){var _=this._depth[y][1];this._depth[y][2]<_&&(_=this._depth[y][2]),_<0&&(_=0);for(var P=1;P<3;P++){var $=0;this._depth[y][P]>_&&($=1),this._depth[y][P]=$}}}},{key:"getDelta",value:function(y){return this._depth[y][_t.RIGHT]-this._depth[y][_t.LEFT]}},{key:"getLocation",value:function(y,_){return this._depth[y][_]<=0?Re.EXTERIOR:Re.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<2;_++)for(var P=1;P<3;P++){var $=y.getLocation(_,P);$!==Re.EXTERIOR&&$!==Re.INTERIOR||(this.isNull(_,P)?this._depth[_][P]=I.depthAtLocation($):this._depth[_][P]+=I.depthAtLocation($))}else if(arguments.length===3){var ne=arguments[0],ye=arguments[1];arguments[2]===Re.INTERIOR&&this._depth[ne][ye]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var y=0;y<2;y++)for(var _=0;_<3;_++)this._depth[y][_]=I.NULL_VALUE}},{key:"depthAtLocation",value:function(y){return y===Re.EXTERIOR?0:y===Re.INTERIOR?1:I.NULL_VALUE}}])})();ms.NULL_VALUE=-1;var Va=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var _=new Array(2).fill(null);return _[0]=this.pts[0],_[1]=this.pts[1],new y(_,$n.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(_){this._isIsolated=_}},{key:"setName",value:function(_){this._name=_}},{key:"equals",value:function(_){if(!(_ instanceof y))return!1;var P=_;if(this.pts.length!==P.pts.length)return!1;for(var $=!0,ne=!0,ye=this.pts.length,Oe=0;Oe<this.pts.length;Oe++)if(this.pts[Oe].equals2D(P.pts[Oe])||($=!1),this.pts[Oe].equals2D(P.pts[--ye])||(ne=!1),!$&&!ne)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var _=arguments[0];return this.pts[_]}}},{key:"print",value:function(_){_.print("edge "+this._name+": "),_.print("LINESTRING (");for(var P=0;P<this.pts.length;P++)P>0&&_.print(","),_.print(this.pts[P].x+" "+this.pts[P].y);_.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(_){y.updateIM(this._label,_)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(_){_.print("edge "+this._name+": ");for(var P=this.pts.length-1;P>=0;P--)_.print(this.pts[P]+" ");_.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new Zs(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new Qe;for(var _=0;_<this.pts.length;_++)this._env.expandToInclude(this.pts[_])}return this._env}},{key:"addIntersection",value:function(_,P,$,ne){var ye=new Be(_.getIntersection(ne)),Oe=P,tt=_.getEdgeDistance($,ne),ht=Oe+1;if(ht<this.pts.length){var rr=this.pts[ht];ye.equals2D(rr)&&(Oe=ht,tt=0)}this.eiList.add(ye,Oe,tt)}},{key:"toString",value:function(){var _=new Mo;_.append("edge "+this._name+": "),_.append("LINESTRING (");for(var P=0;P<this.pts.length;P++)P>0&&_.append(","),_.append(this.pts[P].x+" "+this.pts[P].y);return _.append(")  "+this._label+" "+this._depthDelta),_.toString()}},{key:"isPointwiseEqual",value:function(_){if(this.pts.length!==_.pts.length)return!1;for(var P=0;P<this.pts.length;P++)if(!this.pts[P].equals2D(_.pts[P]))return!1;return!0}},{key:"setDepthDelta",value:function(_){this._depthDelta=_}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(_,P,$){for(var ne=0;ne<_.getIntersectionNum();ne++)this.addIntersection(_,P,$,ne)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new mo(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ms,this._depthDelta=0,arguments.length===1){var _=arguments[0];y.constructor_.call(this,_,null)}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.pts=P,this._label=$}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Du&&arguments[0]instanceof $n))return E(y,"updateIM",this).apply(this,arguments);var _=arguments[0],P=arguments[1];P.setAtLeastIfValid(_.getLocation(0,_t.ON),_.getLocation(1,_t.ON),1),_.isArea()&&(P.setAtLeastIfValid(_.getLocation(0,_t.LEFT),_.getLocation(1,_t.LEFT),2),P.setAtLeastIfValid(_.getLocation(0,_t.RIGHT),_.getLocation(1,_t.RIGHT),2))}}])})(mn),Vl=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"setWorkingPrecisionModel",value:function(y){this._workingPrecisionModel=y}},{key:"insertUniqueEdge",value:function(y){var _=this._edgeList.findEqualEdge(y);if(_!==null){var P=_.getLabel(),$=y.getLabel();_.isPointwiseEqual(y)||($=new $n(y.getLabel())).flip(),P.merge($);var ne=I.depthDelta($),ye=_.getDepthDelta()+ne;_.setDepthDelta(ye)}else this._edgeList.add(y),y.setDepthDelta(I.depthDelta(y.getLabel()))}},{key:"buildSubgraphs",value:function(y,_){for(var P=new ct,$=y.iterator();$.hasNext();){var ne=$.next(),ye=ne.getRightmostCoordinate(),Oe=new gs(P).getDepth(ye);ne.computeDepth(Oe),ne.findResultEdges(),P.add(ne),_.add(ne.getDirectedEdges(),ne.getNodes())}}},{key:"createSubgraphs",value:function(y){for(var _=new ct,P=y.getNodes().iterator();P.hasNext();){var $=P.next();if(!$.isVisited()){var ne=new qt;ne.create($),_.add(ne)}}return ri.sort(_,ri.reverseOrder()),_}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(y){if(this._workingNoder!==null)return this._workingNoder;var _=new ll,P=new on;return P.setPrecisionModel(y),_.setSegmentIntersector(new cu(P)),_}},{key:"buffer",value:function(y,_){var P=this._workingPrecisionModel;P===null&&(P=y.getPrecisionModel()),this._geomFact=y.getFactory();var $=new Il(P,this._bufParams),ne=new As(y,_,$).getCurves();if(ne.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(ne,P),this._graph=new Vo(new Is),this._graph.addEdges(this._edgeList.getEdges());var ye=this.createSubgraphs(this._graph),Oe=new Ru(this._geomFact);this.buildSubgraphs(ye,Oe);var tt=Oe.getPolygons();return tt.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(tt)}},{key:"computeNodedEdges",value:function(y,_){var P=this.getNoder(_);P.computeNodes(y);for(var $=P.getNodedSubstrings().iterator();$.hasNext();){var ne=$.next(),ye=ne.getCoordinates();if(ye.length!==2||!ye[0].equals2D(ye[1])){var Oe=ne.getData(),tt=new Va(ne.getCoordinates(),new $n(Oe));this.insertUniqueEdge(tt)}}}},{key:"setNoder",value:function(y){this._workingNoder=y}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new ic;var y=arguments[0];this._bufParams=y}},{key:"depthDelta",value:function(y){var _=y.getLocation(0,_t.LEFT),P=y.getLocation(0,_t.RIGHT);return _===Re.INTERIOR&&P===Re.EXTERIOR?1:_===Re.EXTERIOR&&P===Re.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(y){for(var _=new Aa,P=new ct;y.hasNext();){var $=y.next(),ne=_.createLineString($.getCoordinates());P.add(ne)}return _.buildGeometry(P)}}])})(),cl=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"rescale",value:function(){if(Tr(arguments[0],zt))for(var y=arguments[0].iterator();y.hasNext();){var _=y.next();this.rescale(_.getCoordinates())}else if(arguments[0]instanceof Array){for(var P=arguments[0],$=0;$<P.length;$++)P[$].x=P[$].x/this._scaleFactor+this._offsetX,P[$].y=P[$].y/this._scaleFactor+this._offsetY;P.length===2&&P[0].equals2D(P[1])&&Ar.out.println(P)}}},{key:"scale",value:function(){if(Tr(arguments[0],zt)){for(var y=arguments[0],_=new ct(y.size()),P=y.iterator();P.hasNext();){var $=P.next();_.add(new Ui(this.scale($.getCoordinates()),$.getData()))}return _}if(arguments[0]instanceof Array){for(var ne=arguments[0],ye=new Array(ne.length).fill(null),Oe=0;Oe<ne.length;Oe++)ye[Oe]=new Be(Math.round((ne[Oe].x-this._offsetX)*this._scaleFactor),Math.round((ne[Oe].y-this._offsetY)*this._scaleFactor),ne[Oe].getZ());return Gi.removeRepeatedPoints(ye)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var y=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(y),y}},{key:"computeNodes",value:function(y){var _=y;this._isScaled&&(_=this.scale(y)),this._noder.computeNodes(_)}},{key:"interfaces_",get:function(){return[za]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var y=arguments[0],_=arguments[1];I.constructor_.call(this,y,_,0,0)}else if(arguments.length===4){var P=arguments[0],$=arguments[1];this._noder=P,this._scaleFactor=$,this._isScaled=!this.isIntegerPrecision()}}}])})(),hl=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();){var _=y.next().getCoordinates();this.checkEndPtVertexIntersections(_[0],this._segStrings),this.checkEndPtVertexIntersections(_[_.length-1],this._segStrings)}else if(arguments.length===2){for(var P=arguments[0],$=arguments[1].iterator();$.hasNext();)for(var ne=$.next().getCoordinates(),ye=1;ye<ne.length-1;ye++)if(ne[ye].equals(P))throw new de("found endpt/interior pt intersection at index "+ye+" :pt "+P)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();)for(var _=y.next(),P=this._segStrings.iterator();P.hasNext();){var $=P.next();this.checkInteriorIntersections(_,$)}else if(arguments.length===2)for(var ne=arguments[0],ye=arguments[1],Oe=ne.getCoordinates(),tt=ye.getCoordinates(),ht=0;ht<Oe.length-1;ht++)for(var rr=0;rr<tt.length-1;rr++)this.checkInteriorIntersections(ne,ht,ye,rr);else if(arguments.length===4){var ur=arguments[0],qr=arguments[1],bn=arguments[2],Dn=arguments[3];if(ur===bn&&qr===Dn)return null;var Xn=ur.getCoordinates()[qr],Fn=ur.getCoordinates()[qr+1],En=bn.getCoordinates()[Dn],na=bn.getCoordinates()[Dn+1];if(this._li.computeIntersection(Xn,Fn,En,na),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Xn,Fn)||this.hasInteriorIntersection(this._li,En,na)))throw new de("found non-noded intersection at "+Xn+"-"+Fn+" and "+En+"-"+na)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();){var _=y.next();this.checkCollapses(_)}else if(arguments.length===1)for(var P=arguments[0].getCoordinates(),$=0;$<P.length-2;$++)this.checkCollapse(P[$],P[$+1],P[$+2])}},{key:"hasInteriorIntersection",value:function(y,_,P){for(var $=0;$<y.getIntersectionNum();$++){var ne=y.getIntersection($);if(!ne.equals(_)&&!ne.equals(P))return!0}return!1}},{key:"checkCollapse",value:function(y,_,P){if(y.equals(P))throw new de("found non-noded collapse at "+I.fact.createLineString([y,_,P]))}}],[{key:"constructor_",value:function(){this._li=new on,this._segStrings=null;var y=arguments[0];this._segStrings=y}}])})();hl.fact=new Aa;var $l=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"intersectsScaled",value:function(y,_){var P=Math.min(y.x,_.x),$=Math.max(y.x,_.x),ne=Math.min(y.y,_.y),ye=Math.max(y.y,_.y),Oe=this._maxx<P||this._minx>$||this._maxy<ne||this._miny>ye;if(Oe)return!1;var tt=this.intersectsToleranceSquare(y,_);return we.isTrue(!(Oe&&tt),"Found bad envelope test"),tt}},{key:"initCorners",value:function(y){var _=.5;this._minx=y.x-_,this._maxx=y.x+_,this._miny=y.y-_,this._maxy=y.y+_,this._corner[0]=new Be(this._maxx,this._maxy),this._corner[1]=new Be(this._minx,this._maxy),this._corner[2]=new Be(this._minx,this._miny),this._corner[3]=new Be(this._maxx,this._miny)}},{key:"intersects",value:function(y,_){return this._scaleFactor===1?this.intersectsScaled(y,_):(this.copyScaled(y,this._p0Scaled),this.copyScaled(_,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(y){return Math.round(y*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(y,_){_.x=this.scale(y.x),_.y=this.scale(y.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var y=I.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Qe(this._originalPt.x-y,this._originalPt.x+y,this._originalPt.y-y,this._originalPt.y+y)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(y,_){return this._li.computeIntersection(y,_,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(y,_){var P=!1,$=!1;return this._li.computeIntersection(y,_,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(y,_,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(P=!0),this._li.computeIntersection(y,_,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&($=!0),this._li.computeIntersection(y,_,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!P||!$)||!!y.equals(this._pt)||!!_.equals(this._pt))))}},{key:"addSnappedNode",value:function(y,_){var P=y.getCoordinate(_),$=y.getCoordinate(_+1);return!!this.intersects(P,$)&&(y.addIntersection(this.getCoordinate(),_),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var y=arguments[0],_=arguments[1],P=arguments[2];if(this._originalPt=y,this._pt=y,this._scaleFactor=_,this._li=P,_<=0)throw new U("Scale factor must be non-zero");_!==1&&(this._pt=new Be(this.scale(y.x),this.scale(y.y)),this._p0Scaled=new Be,this._p1Scaled=new Be),this.initCorners(this._pt)}}])})();$l.SAFE_ENV_EXPANSION_FACTOR=.75;var ql=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var I=arguments[1];arguments[0].getLineSegment(I,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new Xi}}])})(),fl=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"snap",value:function(){if(arguments.length===1){var I=arguments[0];return this.snap(I,null,-1)}if(arguments.length===3){var y=arguments[0],_=arguments[1],P=arguments[2],$=y.getSafeEnvelope(),ne=new Hl(y,_,P);return this._index.query($,new((function(){return o((function ye(){i(this,ye)}),[{key:"interfaces_",get:function(){return[ue]}},{key:"visitItem",value:function(ye){ye.select($,ne)}}])})())),ne.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var I=arguments[0];this._index=I}}])})(),Hl=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof Si))return E(y,"select",this,1).apply(this,arguments);var _=arguments[1],P=arguments[0].getContext();if(this._parentEdge===P&&(_===this._hotPixelVertexIndex||_+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(P,_)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var _=arguments[0],P=arguments[1],$=arguments[2];this._hotPixel=_,this._parentEdge=P,this._hotPixelVertexIndex=$}}])})(ql);fl.HotPixelSnapAction=Hl;var Ou=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"processIntersections",value:function(I,y,_,P){if(I===_&&y===P)return null;var $=I.getCoordinates()[y],ne=I.getCoordinates()[y+1],ye=_.getCoordinates()[P],Oe=_.getCoordinates()[P+1];if(this._li.computeIntersection($,ne,ye,Oe),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var tt=0;tt<this._li.getIntersectionNum();tt++)this._interiorIntersections.add(this._li.getIntersection(tt));I.addIntersections(this._li,y,0),_.addIntersections(this._li,P,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[ul]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var I=arguments[0];this._li=I,this._interiorIntersections=new ct}}])})(),tr=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"checkCorrectness",value:function(I){var y=Ui.getNodedSubstrings(I),_=new hl(y);try{_.checkValid()}catch(P){if(!(P instanceof O))throw P;P.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return Ui.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(I,y){var _=this.findInteriorIntersections(I,y);this.computeIntersectionSnaps(_),this.computeVertexSnaps(I)}},{key:"findInteriorIntersections",value:function(I,y){var _=new Ou(y);return this._noder.setSegmentIntersector(_),this._noder.computeNodes(I),_.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(Tr(arguments[0],zt))for(var I=arguments[0].iterator();I.hasNext();){var y=I.next();this.computeVertexSnaps(y)}else if(arguments[0]instanceof Ui)for(var _=arguments[0],P=_.getCoordinates(),$=0;$<P.length;$++){var ne=new $l(P[$],this._scaleFactor,this._li);this._pointSnapper.snap(ne,_,$)&&_.addIntersection(P[$],$)}}},{key:"computeNodes",value:function(I){this._nodedSegStrings=I,this._noder=new ll,this._pointSnapper=new fl(this._noder.getIndex()),this.snapRound(I,this._li)}},{key:"computeIntersectionSnaps",value:function(I){for(var y=I.iterator();y.hasNext();){var _=y.next(),P=new $l(_,this._scaleFactor,this._li);this._pointSnapper.snap(P)}}},{key:"interfaces_",get:function(){return[za]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var I=arguments[0];this._pm=I,this._li=new on,this._li.setPrecisionModel(I),this._scaleFactor=I.getScale()}}])})(),mr=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"bufferFixedPrecision",value:function(y){var _=new cl(new tr(new ga(1)),y.getScale()),P=new Vl(this._bufParams);P.setWorkingPrecisionModel(y),P.setNoder(_),this._resultGeometry=P.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var y=I.MAX_PRECISION_DIGITS;y>=0;y--){try{this.bufferReducedPrecision(y)}catch(ne){if(!(ne instanceof Et))throw ne;this._saveException=ne}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var _=arguments[0],P=I.precisionScaleFactor(this._argGeom,this._distance,_),$=new ga(P);this.bufferFixedPrecision($)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var y=this._argGeom.getFactory().getPrecisionModel();y.getType()===ga.FIXED?this.bufferFixedPrecision(y):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(y){this._bufParams.setQuadrantSegments(y)}},{key:"bufferOriginalPrecision",value:function(){try{var y=new Vl(this._bufParams);this._resultGeometry=y.buffer(this._argGeom,this._distance)}catch(_){if(!(_ instanceof de))throw _;this._saveException=_}}},{key:"getResultGeometry",value:function(y){return this._distance=y,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(y){this._bufParams.setEndCapStyle(y)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new N,this._resultGeometry=null,this._saveException=null,arguments.length===1){var y=arguments[0];this._argGeom=y}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this._argGeom=_,this._bufParams=P}}},{key:"bufferOp",value:function(){if(arguments.length===2){var y=arguments[1];return new I(arguments[0]).getResultGeometry(y)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof rt&&typeof arguments[1]=="number"){var _=arguments[1],P=arguments[2],$=new I(arguments[0]);return $.setQuadrantSegments(P),$.getResultGeometry(_)}if(arguments[2]instanceof N&&arguments[0]instanceof rt&&typeof arguments[1]=="number"){var ne=arguments[1];return new I(arguments[0],arguments[2]).getResultGeometry(ne)}}else if(arguments.length===4){var ye=arguments[1],Oe=arguments[2],tt=arguments[3],ht=new I(arguments[0]);return ht.setQuadrantSegments(Oe),ht.setEndCapStyle(tt),ht.getResultGeometry(ye)}}},{key:"precisionScaleFactor",value:function(y,_,P){var $=y.getEnvelopeInternal(),ne=$r.max(Math.abs($.getMaxX()),Math.abs($.getMaxY()),Math.abs($.getMinX()),Math.abs($.getMinY()))+2*(_>0?_:0),ye=P-Math.trunc(Math.log(ne)/Math.log(10)+1);return Math.pow(10,ye)}}])})();mr.CAP_ROUND=N.CAP_ROUND,mr.CAP_BUTT=N.CAP_FLAT,mr.CAP_FLAT=N.CAP_FLAT,mr.CAP_SQUARE=N.CAP_SQUARE,mr.MAX_PRECISION_DIGITS=12;var dn=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],In=(function(){return o((function I(y){i(this,I),this.geometryFactory=y||new Aa}),[{key:"read",value:function(I){var y,_=(y=typeof I=="string"?JSON.parse(I):I).type;if(!vi[_])throw new Error("Unknown GeoJSON type: "+y.type);return dn.indexOf(_)!==-1?vi[_].call(this,y.coordinates):_==="GeometryCollection"?vi[_].call(this,y.geometries):vi[_].call(this,y)}},{key:"write",value:function(I){var y=I.getGeometryType();if(!Pn[y])throw new Error("Geometry is not supported");return Pn[y].call(this,I)}}])})(),vi={Feature:function(I){var y={};for(var _ in I)y[_]=I[_];if(I.geometry){var P=I.geometry.type;if(!vi[P])throw new Error("Unknown GeoJSON type: "+I.type);y.geometry=this.read(I.geometry)}return I.bbox&&(y.bbox=vi.bbox.call(this,I.bbox)),y},FeatureCollection:function(I){var y={};if(I.features){y.features=[];for(var _=0;_<I.features.length;++_)y.features.push(this.read(I.features[_]))}return I.bbox&&(y.bbox=this.parse.bbox.call(this,I.bbox)),y},coordinates:function(I){for(var y=[],_=0;_<I.length;++_){var P=I[_];y.push(a(Be,T(P)))}return y},bbox:function(I){return this.geometryFactory.createLinearRing([new Be(I[0],I[1]),new Be(I[2],I[1]),new Be(I[2],I[3]),new Be(I[0],I[3]),new Be(I[0],I[1])])},Point:function(I){var y=a(Be,T(I));return this.geometryFactory.createPoint(y)},MultiPoint:function(I){for(var y=[],_=0;_<I.length;++_)y.push(vi.Point.call(this,I[_]));return this.geometryFactory.createMultiPoint(y)},LineString:function(I){var y=vi.coordinates.call(this,I);return this.geometryFactory.createLineString(y)},MultiLineString:function(I){for(var y=[],_=0;_<I.length;++_)y.push(vi.LineString.call(this,I[_]));return this.geometryFactory.createMultiLineString(y)},Polygon:function(I){for(var y=vi.coordinates.call(this,I[0]),_=this.geometryFactory.createLinearRing(y),P=[],$=1;$<I.length;++$){var ne=I[$],ye=vi.coordinates.call(this,ne),Oe=this.geometryFactory.createLinearRing(ye);P.push(Oe)}return this.geometryFactory.createPolygon(_,P)},MultiPolygon:function(I){for(var y=[],_=0;_<I.length;++_){var P=I[_];y.push(vi.Polygon.call(this,P))}return this.geometryFactory.createMultiPolygon(y)},GeometryCollection:function(I){for(var y=[],_=0;_<I.length;++_){var P=I[_];y.push(this.read(P))}return this.geometryFactory.createGeometryCollection(y)}},Pn={coordinate:function(I){var y=[I.x,I.y];return I.z&&y.push(I.z),I.m&&y.push(I.m),y},Point:function(I){return{type:"Point",coordinates:Pn.coordinate.call(this,I.getCoordinate())}},MultiPoint:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=Pn.Point.call(this,P);y.push($.coordinates)}return{type:"MultiPoint",coordinates:y}},LineString:function(I){for(var y=[],_=I.getCoordinates(),P=0;P<_.length;++P){var $=_[P];y.push(Pn.coordinate.call(this,$))}return{type:"LineString",coordinates:y}},MultiLineString:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=Pn.LineString.call(this,P);y.push($.coordinates)}return{type:"MultiLineString",coordinates:y}},Polygon:function(I){var y=[],_=Pn.LineString.call(this,I._shell);y.push(_.coordinates);for(var P=0;P<I._holes.length;++P){var $=I._holes[P],ne=Pn.LineString.call(this,$);y.push(ne.coordinates)}return{type:"Polygon",coordinates:y}},MultiPolygon:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=Pn.Polygon.call(this,P);y.push($.coordinates)}return{type:"MultiPolygon",coordinates:y}},GeometryCollection:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=P.getGeometryType();y.push(Pn[$].call(this,P))}return{type:"GeometryCollection",geometries:y}}};return{BufferOp:mr,GeoJSONReader:(function(){return o((function I(y){i(this,I),this.parser=new In(y||new Aa)}),[{key:"read",value:function(I){return this.parser.read(I)}}])})(),GeoJSONWriter:(function(){return o((function I(){i(this,I),this.parser=new In(this.geometryFactory)}),[{key:"write",value:function(I){return this.parser.write(I)}}])})()}}))})(yS)),yS.exports}var W2e=H2e();const G2e=Id(W2e);function jg(){return new fE}function fE(){this.reset()}fE.prototype={constructor:fE,reset:function(){this.s=this.t=0},add:function(t){A7(ww,t,this.t),A7(this,ww.s,this.s),this.s?this.t+=ww.t:this.s=ww.t},valueOf:function(){return this.s}};var ww=new fE;function A7(t,e,r){var n=t.s=e+r,i=n-e,a=n-i;t.t=e-a+(r-i)}var zo=1e-6,Oa=Math.PI,dd=Oa/2,I7=Oa/4,Td=Oa*2,tg=180/Oa,Ph=Oa/180,au=Math.abs,X2e=Math.atan,Y0=Math.atan2,xs=Math.cos,ws=Math.sin,v_=Math.sqrt;function lJ(t){return t>1?0:t<-1?Oa:Math.acos(t)}function iy(t){return t>1?dd:t<-1?-dd:Math.asin(t)}function F1(){}function dE(t,e){t&&k7.hasOwnProperty(t.type)&&k7[t.type](t,e)}var P7={Feature:function(t,e){dE(t.geometry,e)},FeatureCollection:function(t,e){for(var r=t.features,n=-1,i=r.length;++n<i;)dE(r[n].geometry,e)}},k7={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)t=r[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){IR(t.coordinates,e,0)},MultiLineString:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)IR(r[n],e,0)},Polygon:function(t,e){R7(t.coordinates,e)},MultiPolygon:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)R7(r[n],e)},GeometryCollection:function(t,e){for(var r=t.geometries,n=-1,i=r.length;++n<i;)dE(r[n],e)}};function IR(t,e,r){var n=-1,i=t.length-r,a;for(e.lineStart();++n<i;)a=t[n],e.point(a[0],a[1],a[2]);e.lineEnd()}function R7(t,e){var r=-1,n=t.length;for(e.polygonStart();++r<n;)IR(t[r],e,1);e.polygonEnd()}function Y2e(t,e){t&&P7.hasOwnProperty(t.type)?P7[t.type](t,e):dE(t,e)}jg();jg();function PR(t){return[Y0(t[1],t[0]),iy(t[2])]}function Z0(t){var e=t[0],r=t[1],n=xs(r);return[n*xs(e),n*ws(e),ws(r)]}function Sw(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function pE(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function n5(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ew(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function kR(t){var e=v_(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}jg();function uJ(t,e){function r(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(r.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),r}function RR(t,e){return[t>Oa?t-Td:t<-Oa?t+Td:t,e]}RR.invert=RR;function Z2e(t,e,r){return(t%=Td)?e||r?uJ(D7(t),O7(e,r)):D7(t):e||r?O7(e,r):RR}function M7(t){return function(e,r){return e+=t,[e>Oa?e-Td:e<-Oa?e+Td:e,r]}}function D7(t){var e=M7(t);return e.invert=M7(-t),e}function O7(t,e){var r=xs(t),n=ws(t),i=xs(e),a=ws(e);function s(o,c){var h=xs(c),d=xs(o)*h,m=ws(o)*h,b=ws(c),x=b*r+d*n;return[Y0(m*i-x*a,d*r-b*n),iy(x*i+m*a)]}return s.invert=function(o,c){var h=xs(c),d=xs(o)*h,m=ws(o)*h,b=ws(c),x=b*i-m*a;return[Y0(m*i+b*a,d*r+x*n),iy(x*r-d*n)]},s}function K2e(t,e,r,n,i,a){if(r){var s=xs(e),o=ws(e),c=n*r;i==null?(i=e+n*Td,a=e-c/2):(i=N7(s,i),a=N7(s,a),(n>0?i<a:i>a)&&(i+=n*Td));for(var h,d=i;n>0?d>a:d<a;d-=c)h=PR([s,-o*xs(d),-o*ws(d)]),t.point(h[0],h[1])}}function N7(t,e){e=Z0(e),e[0]-=t,kR(e);var r=lJ(-e[1]);return((-e[2]<0?-r:r)+Td-zo)%Td}function cJ(){var t=[],e;return{point:function(r,n){e.push([r,n])},lineStart:function(){t.push(e=[])},lineEnd:F1,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],e=null,r}}}function J2e(t,e,r,n,i,a){var s=t[0],o=t[1],c=e[0],h=e[1],d=0,m=1,b=c-s,x=h-o,E;if(E=r-s,!(!b&&E>0)){if(E/=b,b<0){if(E<d)return;E<m&&(m=E)}else if(b>0){if(E>m)return;E>d&&(d=E)}if(E=i-s,!(!b&&E<0)){if(E/=b,b<0){if(E>m)return;E>d&&(d=E)}else if(b>0){if(E<d)return;E<m&&(m=E)}if(E=n-o,!(!x&&E>0)){if(E/=x,x<0){if(E<d)return;E<m&&(m=E)}else if(x>0){if(E>m)return;E>d&&(d=E)}if(E=a-o,!(!x&&E<0)){if(E/=x,x<0){if(E>m)return;E>d&&(d=E)}else if(x>0){if(E<d)return;E<m&&(m=E)}return d>0&&(t[0]=s+d*b,t[1]=o+d*x),m<1&&(e[0]=s+m*b,e[1]=o+m*x),!0}}}}}function vS(t,e){return au(t[0]-e[0])<zo&&au(t[1]-e[1])<zo}function Tw(t,e,r,n){this.x=t,this.z=e,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}function hJ(t,e,r,n,i){var a=[],s=[],o,c;if(t.forEach(function(E){if(!((T=E.length-1)<=0)){var T,A=E[0],M=E[T],F;if(vS(A,M)){for(i.lineStart(),o=0;o<T;++o)i.point((A=E[o])[0],A[1]);i.lineEnd();return}a.push(F=new Tw(A,E,null,!0)),s.push(F.o=new Tw(A,null,F,!1)),a.push(F=new Tw(M,E,null,!1)),s.push(F.o=new Tw(M,null,F,!0))}}),!!a.length){for(s.sort(e),L7(a),L7(s),o=0,c=s.length;o<c;++o)s[o].e=r=!r;for(var h=a[0],d,m;;){for(var b=h,x=!0;b.v;)if((b=b.n)===h)return;d=b.z,i.lineStart();do{if(b.v=b.o.v=!0,b.e){if(x)for(o=0,c=d.length;o<c;++o)i.point((m=d[o])[0],m[1]);else n(b.x,b.n.x,1,i);b=b.n}else{if(x)for(d=b.p.z,o=d.length-1;o>=0;--o)i.point((m=d[o])[0],m[1]);else n(b.x,b.p.x,-1,i);b=b.p}b=b.o,d=b.z,x=!x}while(!b.v);i.lineEnd()}}}function L7(t){if(e=t.length){for(var e,r=0,n=t[0],i;++r<e;)n.n=i=t[r],i.p=n,n=i;n.n=i=t[0],i.p=n}}function fJ(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Q2e(t){return t.length===1&&(t=ewe(t)),{left:function(e,r,n,i){for(n==null&&(n=0),i==null&&(i=e.length);n<i;){var a=n+i>>>1;t(e[a],r)<0?n=a+1:i=a}return n},right:function(e,r,n,i){for(n==null&&(n=0),i==null&&(i=e.length);n<i;){var a=n+i>>>1;t(e[a],r)>0?i=a:n=a+1}return n}}}function ewe(t){return function(e,r){return fJ(t(e),r)}}Q2e(fJ);function dJ(t){for(var e=t.length,r,n=-1,i=0,a,s;++n<e;)i+=t[n].length;for(a=new Array(i);--e>=0;)for(s=t[e],r=s.length;--r>=0;)a[--i]=s[r];return a}var B1=1e9,Cw=-B1;function twe(t,e,r,n){function i(h,d){return t<=h&&h<=r&&e<=d&&d<=n}function a(h,d,m,b){var x=0,E=0;if(h==null||(x=s(h,m))!==(E=s(d,m))||c(h,d)<0^m>0)do b.point(x===0||x===3?t:r,x>1?n:e);while((x=(x+m+4)%4)!==E);else b.point(d[0],d[1])}function s(h,d){return au(h[0]-t)<zo?d>0?0:3:au(h[0]-r)<zo?d>0?2:1:au(h[1]-e)<zo?d>0?1:0:d>0?3:2}function o(h,d){return c(h.x,d.x)}function c(h,d){var m=s(h,1),b=s(d,1);return m!==b?m-b:m===0?d[1]-h[1]:m===1?h[0]-d[0]:m===2?h[1]-d[1]:d[0]-h[0]}return function(h){var d=h,m=cJ(),b,x,E,T,A,M,F,N,O,U,j,H={point:G,lineStart:W,lineEnd:oe,polygonStart:ae,polygonEnd:Q};function G(he,_e){i(he,_e)&&d.point(he,_e)}function X(){for(var he=0,_e=0,Ce=x.length;_e<Ce;++_e)for(var me=x[_e],xe=1,Ae=me.length,De=me[0],de,Ee,we=De[0],Le=De[1];xe<Ae;++xe)de=we,Ee=Le,De=me[xe],we=De[0],Le=De[1],Ee<=n?Le>n&&(we-de)*(n-Ee)>(Le-Ee)*(t-de)&&++he:Le<=n&&(we-de)*(n-Ee)<(Le-Ee)*(t-de)&&--he;return he}function ae(){d=m,b=[],x=[],j=!0}function Q(){var he=X(),_e=j&&he,Ce=(b=dJ(b)).length;(_e||Ce)&&(h.polygonStart(),_e&&(h.lineStart(),a(null,null,1,h),h.lineEnd()),Ce&&hJ(b,o,he,a,h),h.polygonEnd()),d=h,b=x=E=null}function W(){H.point=se,x&&x.push(E=[]),U=!0,O=!1,F=N=NaN}function oe(){b&&(se(T,A),M&&O&&m.rejoin(),b.push(m.result())),H.point=G,O&&d.lineEnd()}function se(he,_e){var Ce=i(he,_e);if(x&&E.push([he,_e]),U)T=he,A=_e,M=Ce,U=!1,Ce&&(d.lineStart(),d.point(he,_e));else if(Ce&&O)d.point(he,_e);else{var me=[F=Math.max(Cw,Math.min(B1,F)),N=Math.max(Cw,Math.min(B1,N))],xe=[he=Math.max(Cw,Math.min(B1,he)),_e=Math.max(Cw,Math.min(B1,_e))];J2e(me,xe,t,e,r,n)?(O||(d.lineStart(),d.point(me[0],me[1])),d.point(xe[0],xe[1]),Ce||d.lineEnd(),j=!1):Ce&&(d.lineStart(),d.point(he,_e),j=!1)}F=he,N=_e,O=Ce}return H}}var i5=jg();function rwe(t,e){var r=e[0],n=e[1],i=[ws(r),-xs(r),0],a=0,s=0;i5.reset();for(var o=0,c=t.length;o<c;++o)if(d=(h=t[o]).length)for(var h,d,m=h[d-1],b=m[0],x=m[1]/2+I7,E=ws(x),T=xs(x),A=0;A<d;++A,b=F,E=O,T=U,m=M){var M=h[A],F=M[0],N=M[1]/2+I7,O=ws(N),U=xs(N),j=F-b,H=j>=0?1:-1,G=H*j,X=G>Oa,ae=E*O;if(i5.add(Y0(ae*H*ws(G),T*U+ae*xs(G))),a+=X?j+H*Td:j,X^b>=r^F>=r){var Q=pE(Z0(m),Z0(M));kR(Q);var W=pE(i,Q);kR(W);var oe=(X^j>=0?-1:1)*iy(W[2]);(n>oe||n===oe&&(Q[0]||Q[1]))&&(s+=X^j>=0?1:-1)}}return(a<-zo||a<zo&&i5<-zo)^s&1}jg();function F7(t){return t}jg();jg();var K0=1/0,gE=K0,Kb=-K0,mE=Kb,B7={point:nwe,lineStart:F1,lineEnd:F1,polygonStart:F1,polygonEnd:F1,result:function(){var t=[[K0,gE],[Kb,mE]];return Kb=mE=-(gE=K0=1/0),t}};function nwe(t,e){t<K0&&(K0=t),t>Kb&&(Kb=t),e<gE&&(gE=e),e>mE&&(mE=e)}jg();function pJ(t,e,r,n){return function(i,a){var s=e(a),o=i.invert(n[0],n[1]),c=cJ(),h=e(c),d=!1,m,b,x,E={point:T,lineStart:M,lineEnd:F,polygonStart:function(){E.point=N,E.lineStart=O,E.lineEnd=U,b=[],m=[]},polygonEnd:function(){E.point=T,E.lineStart=M,E.lineEnd=F,b=dJ(b);var j=rwe(m,o);b.length?(d||(a.polygonStart(),d=!0),hJ(b,awe,j,r,a)):j&&(d||(a.polygonStart(),d=!0),a.lineStart(),r(null,null,1,a),a.lineEnd()),d&&(a.polygonEnd(),d=!1),b=m=null},sphere:function(){a.polygonStart(),a.lineStart(),r(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function T(j,H){var G=i(j,H);t(j=G[0],H=G[1])&&a.point(j,H)}function A(j,H){var G=i(j,H);s.point(G[0],G[1])}function M(){E.point=A,s.lineStart()}function F(){E.point=T,s.lineEnd()}function N(j,H){x.push([j,H]);var G=i(j,H);h.point(G[0],G[1])}function O(){h.lineStart(),x=[]}function U(){N(x[0][0],x[0][1]),h.lineEnd();var j=h.clean(),H=c.result(),G,X=H.length,ae,Q,W;if(x.pop(),m.push(x),x=null,!!X){if(j&1){if(Q=H[0],(ae=Q.length-1)>0){for(d||(a.polygonStart(),d=!0),a.lineStart(),G=0;G<ae;++G)a.point((W=Q[G])[0],W[1]);a.lineEnd()}return}X>1&&j&2&&H.push(H.pop().concat(H.shift())),b.push(H.filter(iwe))}}return E}}function iwe(t){return t.length>1}function awe(t,e){return((t=t.x)[0]<0?t[1]-dd-zo:dd-t[1])-((e=e.x)[0]<0?e[1]-dd-zo:dd-e[1])}const z7=pJ(function(){return!0},owe,lwe,[-Oa,-dd]);function owe(t){var e=NaN,r=NaN,n=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(a,s){var o=a>0?Oa:-Oa,c=au(a-e);au(c-Oa)<zo?(t.point(e,r=(r+s)/2>0?dd:-dd),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),t.point(a,r),i=0):n!==o&&c>=Oa&&(au(e-n)<zo&&(e-=n*zo),au(a-o)<zo&&(a-=o*zo),r=swe(e,r,a,s),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),i=0),t.point(e=a,r=s),n=o},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-i}}}function swe(t,e,r,n){var i,a,s=ws(t-r);return au(s)>zo?X2e((ws(e)*(a=xs(n))*ws(r)-ws(n)*(i=xs(e))*ws(t))/(i*a*s)):(e+n)/2}function lwe(t,e,r,n){var i;if(t==null)i=r*dd,n.point(-Oa,i),n.point(0,i),n.point(Oa,i),n.point(Oa,0),n.point(Oa,-i),n.point(0,-i),n.point(-Oa,-i),n.point(-Oa,0),n.point(-Oa,i);else if(au(t[0]-e[0])>zo){var a=t[0]<e[0]?Oa:-Oa;i=r*a/2,n.point(-a,i),n.point(0,i),n.point(a,i)}else n.point(e[0],e[1])}function uwe(t,e){var r=xs(t),n=r>0,i=au(r)>zo;function a(d,m,b,x){K2e(x,t,e,b,d,m)}function s(d,m){return xs(d)*xs(m)>r}function o(d){var m,b,x,E,T;return{lineStart:function(){E=x=!1,T=1},point:function(A,M){var F=[A,M],N,O=s(A,M),U=n?O?0:h(A,M):O?h(A+(A<0?Oa:-Oa),M):0;if(!m&&(E=x=O)&&d.lineStart(),O!==x&&(N=c(m,F),(!N||vS(m,N)||vS(F,N))&&(F[0]+=zo,F[1]+=zo,O=s(F[0],F[1]))),O!==x)T=0,O?(d.lineStart(),N=c(F,m),d.point(N[0],N[1])):(N=c(m,F),d.point(N[0],N[1]),d.lineEnd()),m=N;else if(i&&m&&n^O){var j;!(U&b)&&(j=c(F,m,!0))&&(T=0,n?(d.lineStart(),d.point(j[0][0],j[0][1]),d.point(j[1][0],j[1][1]),d.lineEnd()):(d.point(j[1][0],j[1][1]),d.lineEnd(),d.lineStart(),d.point(j[0][0],j[0][1])))}O&&(!m||!vS(m,F))&&d.point(F[0],F[1]),m=F,x=O,b=U},lineEnd:function(){x&&d.lineEnd(),m=null},clean:function(){return T|(E&&x)<<1}}}function c(d,m,b){var x=Z0(d),E=Z0(m),T=[1,0,0],A=pE(x,E),M=Sw(A,A),F=A[0],N=M-F*F;if(!N)return!b&&d;var O=r*M/N,U=-r*F/N,j=pE(T,A),H=Ew(T,O),G=Ew(A,U);n5(H,G);var X=j,ae=Sw(H,X),Q=Sw(X,X),W=ae*ae-Q*(Sw(H,H)-1);if(!(W<0)){var oe=v_(W),se=Ew(X,(-ae-oe)/Q);if(n5(se,H),se=PR(se),!b)return se;var he=d[0],_e=m[0],Ce=d[1],me=m[1],xe;_e<he&&(xe=he,he=_e,_e=xe);var Ae=_e-he,De=au(Ae-Oa)<zo,de=De||Ae<zo;if(!De&&me<Ce&&(xe=Ce,Ce=me,me=xe),de?De?Ce+me>0^se[1]<(au(se[0]-he)<zo?Ce:me):Ce<=se[1]&&se[1]<=me:Ae>Oa^(he<=se[0]&&se[0]<=_e)){var Ee=Ew(X,(-ae+oe)/Q);return n5(Ee,H),[se,PR(Ee)]}}}function h(d,m){var b=n?t:Oa-t,x=0;return d<-b?x|=1:d>b&&(x|=2),m<-b?x|=4:m>b&&(x|=8),x}return pJ(s,o,a,n?[0,-t]:[-Oa,t-Oa])}function gJ(t){return function(e){var r=new MR;for(var n in t)r[n]=t[n];return r.stream=e,r}}function MR(){}MR.prototype={constructor:MR,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function mJ(t,e,r){var n=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),a!=null&&t.clipExtent(null),Y2e(r,t.stream(B7));var s=B7.result(),o=Math.min(n/(s[1][0]-s[0][0]),i/(s[1][1]-s[0][1])),c=+e[0][0]+(n-o*(s[1][0]+s[0][0]))/2,h=+e[0][1]+(i-o*(s[1][1]+s[0][1]))/2;return a!=null&&t.clipExtent(a),t.scale(o*150).translate([c,h])}function cwe(t,e,r){return mJ(t,[[0,0],e],r)}var j7=16,hwe=xs(30*Ph);function U7(t,e){return+e?dwe(t,e):fwe(t)}function fwe(t){return gJ({point:function(e,r){e=t(e,r),this.stream.point(e[0],e[1])}})}function dwe(t,e){function r(n,i,a,s,o,c,h,d,m,b,x,E,T,A){var M=h-n,F=d-i,N=M*M+F*F;if(N>4*e&&T--){var O=s+b,U=o+x,j=c+E,H=v_(O*O+U*U+j*j),G=iy(j/=H),X=au(au(j)-1)<zo||au(a-m)<zo?(a+m)/2:Y0(U,O),ae=t(X,G),Q=ae[0],W=ae[1],oe=Q-n,se=W-i,he=F*oe-M*se;(he*he/N>e||au((M*oe+F*se)/N-.5)>.3||s*b+o*x+c*E<hwe)&&(r(n,i,a,s,o,c,Q,W,X,O/=H,U/=H,j,T,A),A.point(Q,W),r(Q,W,X,O,U,j,h,d,m,b,x,E,T,A))}}return function(n){var i,a,s,o,c,h,d,m,b,x,E,T,A={point:M,lineStart:F,lineEnd:O,polygonStart:function(){n.polygonStart(),A.lineStart=U},polygonEnd:function(){n.polygonEnd(),A.lineStart=F}};function M(G,X){G=t(G,X),n.point(G[0],G[1])}function F(){m=NaN,A.point=N,n.lineStart()}function N(G,X){var ae=Z0([G,X]),Q=t(G,X);r(m,b,d,x,E,T,m=Q[0],b=Q[1],d=G,x=ae[0],E=ae[1],T=ae[2],j7,n),n.point(m,b)}function O(){A.point=M,n.lineEnd()}function U(){F(),A.point=j,A.lineEnd=H}function j(G,X){N(i=G,X),a=m,s=b,o=x,c=E,h=T,A.point=N}function H(){r(m,b,d,x,E,T,a,s,i,o,c,h,j7,n),A.lineEnd=O,O()}return A}}var pwe=gJ({point:function(t,e){this.stream.point(t*Ph,e*Ph)}});function gwe(t){return mwe(function(){return t})()}function mwe(t){var e,r=150,n=480,i=250,a,s,o=0,c=0,h=0,d=0,m=0,b,x,E=null,T=z7,A=null,M,F,N,O=F7,U=.5,j=U7(Q,U),H,G;function X(se){return se=x(se[0]*Ph,se[1]*Ph),[se[0]*r+a,s-se[1]*r]}function ae(se){return se=x.invert((se[0]-a)/r,(s-se[1])/r),se&&[se[0]*tg,se[1]*tg]}function Q(se,he){return se=e(se,he),[se[0]*r+a,s-se[1]*r]}X.stream=function(se){return H&&G===se?H:H=pwe(T(b,j(O(G=se))))},X.clipAngle=function(se){return arguments.length?(T=+se?uwe(E=se*Ph,6*Ph):(E=null,z7),oe()):E*tg},X.clipExtent=function(se){return arguments.length?(O=se==null?(A=M=F=N=null,F7):twe(A=+se[0][0],M=+se[0][1],F=+se[1][0],N=+se[1][1]),oe()):A==null?null:[[A,M],[F,N]]},X.scale=function(se){return arguments.length?(r=+se,W()):r},X.translate=function(se){return arguments.length?(n=+se[0],i=+se[1],W()):[n,i]},X.center=function(se){return arguments.length?(o=se[0]%360*Ph,c=se[1]%360*Ph,W()):[o*tg,c*tg]},X.rotate=function(se){return arguments.length?(h=se[0]%360*Ph,d=se[1]%360*Ph,m=se.length>2?se[2]%360*Ph:0,W()):[h*tg,d*tg,m*tg]},X.precision=function(se){return arguments.length?(j=U7(Q,U=se*se),oe()):v_(U)},X.fitExtent=function(se,he){return mJ(X,se,he)},X.fitSize=function(se,he){return cwe(X,se,he)};function W(){x=uJ(b=Z2e(h,d,m),e);var se=e(o,c);return a=n-se[0]*r,s=i+se[1]*r,oe()}function oe(){return H=G=null,X}return function(){return e=t.apply(this,arguments),X.invert=e.invert&&ae,W()}}function yJ(t){return function(e,r){var n=xs(e),i=xs(r),a=t(n*i);return[a*i*ws(e),a*ws(r)]}}function vJ(t){return function(e,r){var n=v_(e*e+r*r),i=t(n),a=ws(i),s=xs(i);return[Y0(e*a,n*s),iy(n&&r*a/n)]}}var ywe=yJ(function(t){return v_(2/(1+t))});ywe.invert=vJ(function(t){return 2*iy(t/2)});var _J=yJ(function(t){return(t=lJ(t))&&t/ws(t)});_J.invert=vJ(function(t){return t});function vwe(){return gwe(_J).scale(79.4188).clipAngle(180-.001)}function V7(t,e){return[t,e]}V7.invert=V7;var{BufferOp:_we,GeoJSONReader:bwe,GeoJSONWriter:xwe}=G2e;function wwe(t,e,r){r=r||{};var n=r.units||"kilometers",i=r.steps||8;if(!t)throw new Error("geojson is required");if(typeof r!="object")throw new Error("options must be an object");if(typeof i!="number")throw new Error("steps must be an number");if(e===void 0)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var a=[];switch(t.type){case"GeometryCollection":return d3(t,function(s){var o=_S(s,e,n,i);o&&a.push(o)}),Ep(a);case"FeatureCollection":return _7(t,function(s){var o=_S(s,e,n,i);o&&_7(o,function(c){c&&a.push(c)})}),Ep(a)}return _S(t,e,n,i)}function _S(t,e,r,n){var i=t.properties||{},a=t.type==="Feature"?t.geometry:t;if(a.type==="GeometryCollection"){var s=[];return d3(t,function(T){var A=_S(T,e,r,n);A&&s.push(A)}),Ep(s)}var o=Swe(a),c={type:a.type,coordinates:xJ(a.coordinates,o)},h=new bwe,d=h.read(c),m=nJ(rN(e,r),"meters"),b=_we.bufferOp(d,m,n),x=new xwe;if(b=x.write(b),!bJ(b.coordinates)){var E={type:b.type,coordinates:wJ(b.coordinates,o)};return ny(E,i)}}function bJ(t){return Array.isArray(t[0])?bJ(t[0]):isNaN(t[0])}function xJ(t,e){return typeof t[0]!="object"?e(t):t.map(function(r){return xJ(r,e)})}function wJ(t,e){return typeof t[0]!="object"?e.invert(t):t.map(function(r){return wJ(r,e)})}function Swe(t){var e=$2e(t).geometry.coordinates,r=[-e[0],-e[1]];return vwe().rotate(r).scale(Ku)}function $7(t,e={}){let r=0,n=0,i=0;return y_(t,function(a){r+=a[0],n+=a[1],i++},!0),Gh([r/i,n/i],e.properties)}var Aw={exports:{}},bS={exports:{}},Ewe=bS.exports,q7;function Twe(){return q7||(q7=1,(function(t,e){(function(r,n){t.exports=n()})(Ewe,function(){function r(F,N,O,U,j){(function H(G,X,ae,Q,W){for(;Q>ae;){if(Q-ae>600){var oe=Q-ae+1,se=X-ae+1,he=Math.log(oe),_e=.5*Math.exp(2*he/3),Ce=.5*Math.sqrt(he*_e*(oe-_e)/oe)*(se-oe/2<0?-1:1),me=Math.max(ae,Math.floor(X-se*_e/oe+Ce)),xe=Math.min(Q,Math.floor(X+(oe-se)*_e/oe+Ce));H(G,X,me,xe,W)}var Ae=G[X],De=ae,de=Q;for(n(G,ae,X),W(G[Q],Ae)>0&&n(G,ae,Q);De<de;){for(n(G,De,de),De++,de--;W(G[De],Ae)<0;)De++;for(;W(G[de],Ae)>0;)de--}W(G[ae],Ae)===0?n(G,ae,de):n(G,++de,Q),de<=X&&(ae=de+1),X<=de&&(Q=de-1)}})(F,N,O||0,U||F.length-1,j||i)}function n(F,N,O){var U=F[N];F[N]=F[O],F[O]=U}function i(F,N){return F<N?-1:F>N?1:0}var a=function(F){F===void 0&&(F=9),this._maxEntries=Math.max(4,F),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(F,N,O){if(!O)return N.indexOf(F);for(var U=0;U<N.length;U++)if(O(F,N[U]))return U;return-1}function o(F,N){c(F,0,F.children.length,N,F)}function c(F,N,O,U,j){j||(j=A(null)),j.minX=1/0,j.minY=1/0,j.maxX=-1/0,j.maxY=-1/0;for(var H=N;H<O;H++){var G=F.children[H];h(j,F.leaf?U(G):G)}return j}function h(F,N){return F.minX=Math.min(F.minX,N.minX),F.minY=Math.min(F.minY,N.minY),F.maxX=Math.max(F.maxX,N.maxX),F.maxY=Math.max(F.maxY,N.maxY),F}function d(F,N){return F.minX-N.minX}function m(F,N){return F.minY-N.minY}function b(F){return(F.maxX-F.minX)*(F.maxY-F.minY)}function x(F){return F.maxX-F.minX+(F.maxY-F.minY)}function E(F,N){return F.minX<=N.minX&&F.minY<=N.minY&&N.maxX<=F.maxX&&N.maxY<=F.maxY}function T(F,N){return N.minX<=F.maxX&&N.minY<=F.maxY&&N.maxX>=F.minX&&N.maxY>=F.minY}function A(F){return{children:F,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function M(F,N,O,U,j){for(var H=[N,O];H.length;)if(!((O=H.pop())-(N=H.pop())<=U)){var G=N+Math.ceil((O-N)/U/2)*U;r(F,G,N,O,j),H.push(N,G,G,O)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(F){var N=this.data,O=[];if(!T(F,N))return O;for(var U=this.toBBox,j=[];N;){for(var H=0;H<N.children.length;H++){var G=N.children[H],X=N.leaf?U(G):G;T(F,X)&&(N.leaf?O.push(G):E(F,X)?this._all(G,O):j.push(G))}N=j.pop()}return O},a.prototype.collides=function(F){var N=this.data;if(!T(F,N))return!1;for(var O=[];N;){for(var U=0;U<N.children.length;U++){var j=N.children[U],H=N.leaf?this.toBBox(j):j;if(T(F,H)){if(N.leaf||E(F,H))return!0;O.push(j)}}N=O.pop()}return!1},a.prototype.load=function(F){if(!F||!F.length)return this;if(F.length<this._minEntries){for(var N=0;N<F.length;N++)this.insert(F[N]);return this}var O=this._build(F.slice(),0,F.length-1,0);if(this.data.children.length)if(this.data.height===O.height)this._splitRoot(this.data,O);else{if(this.data.height<O.height){var U=this.data;this.data=O,O=U}this._insert(O,this.data.height-O.height-1,!0)}else this.data=O;return this},a.prototype.insert=function(F){return F&&this._insert(F,this.data.height-1),this},a.prototype.clear=function(){return this.data=A([]),this},a.prototype.remove=function(F,N){if(!F)return this;for(var O,U,j,H=this.data,G=this.toBBox(F),X=[],ae=[];H||X.length;){if(H||(H=X.pop(),U=X[X.length-1],O=ae.pop(),j=!0),H.leaf){var Q=s(F,H.children,N);if(Q!==-1)return H.children.splice(Q,1),X.push(H),this._condense(X),this}j||H.leaf||!E(H,G)?U?(O++,H=U.children[O],j=!1):H=null:(X.push(H),ae.push(O),O=0,U=H,H=H.children[0])}return this},a.prototype.toBBox=function(F){return F},a.prototype.compareMinX=function(F,N){return F.minX-N.minX},a.prototype.compareMinY=function(F,N){return F.minY-N.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(F){return this.data=F,this},a.prototype._all=function(F,N){for(var O=[];F;)F.leaf?N.push.apply(N,F.children):O.push.apply(O,F.children),F=O.pop();return N},a.prototype._build=function(F,N,O,U){var j,H=O-N+1,G=this._maxEntries;if(H<=G)return o(j=A(F.slice(N,O+1)),this.toBBox),j;U||(U=Math.ceil(Math.log(H)/Math.log(G)),G=Math.ceil(H/Math.pow(G,U-1))),(j=A([])).leaf=!1,j.height=U;var X=Math.ceil(H/G),ae=X*Math.ceil(Math.sqrt(G));M(F,N,O,ae,this.compareMinX);for(var Q=N;Q<=O;Q+=ae){var W=Math.min(Q+ae-1,O);M(F,Q,W,X,this.compareMinY);for(var oe=Q;oe<=W;oe+=X){var se=Math.min(oe+X-1,W);j.children.push(this._build(F,oe,se,U-1))}}return o(j,this.toBBox),j},a.prototype._chooseSubtree=function(F,N,O,U){for(;U.push(N),!N.leaf&&U.length-1!==O;){for(var j=1/0,H=1/0,G=void 0,X=0;X<N.children.length;X++){var ae=N.children[X],Q=b(ae),W=(oe=F,se=ae,(Math.max(se.maxX,oe.maxX)-Math.min(se.minX,oe.minX))*(Math.max(se.maxY,oe.maxY)-Math.min(se.minY,oe.minY))-Q);W<H?(H=W,j=Q<j?Q:j,G=ae):W===H&&Q<j&&(j=Q,G=ae)}N=G||N.children[0]}var oe,se;return N},a.prototype._insert=function(F,N,O){var U=O?F:this.toBBox(F),j=[],H=this._chooseSubtree(U,this.data,N,j);for(H.children.push(F),h(H,U);N>=0&&j[N].children.length>this._maxEntries;)this._split(j,N),N--;this._adjustParentBBoxes(U,j,N)},a.prototype._split=function(F,N){var O=F[N],U=O.children.length,j=this._minEntries;this._chooseSplitAxis(O,j,U);var H=this._chooseSplitIndex(O,j,U),G=A(O.children.splice(H,O.children.length-H));G.height=O.height,G.leaf=O.leaf,o(O,this.toBBox),o(G,this.toBBox),N?F[N-1].children.push(G):this._splitRoot(O,G)},a.prototype._splitRoot=function(F,N){this.data=A([F,N]),this.data.height=F.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(F,N,O){for(var U,j,H,G,X,ae,Q,W=1/0,oe=1/0,se=N;se<=O-N;se++){var he=c(F,0,se,this.toBBox),_e=c(F,se,O,this.toBBox),Ce=(j=he,H=_e,G=void 0,X=void 0,ae=void 0,Q=void 0,G=Math.max(j.minX,H.minX),X=Math.max(j.minY,H.minY),ae=Math.min(j.maxX,H.maxX),Q=Math.min(j.maxY,H.maxY),Math.max(0,ae-G)*Math.max(0,Q-X)),me=b(he)+b(_e);Ce<W?(W=Ce,U=se,oe=me<oe?me:oe):Ce===W&&me<oe&&(oe=me,U=se)}return U||O-N},a.prototype._chooseSplitAxis=function(F,N,O){var U=F.leaf?this.compareMinX:d,j=F.leaf?this.compareMinY:m;this._allDistMargin(F,N,O,U)<this._allDistMargin(F,N,O,j)&&F.children.sort(U)},a.prototype._allDistMargin=function(F,N,O,U){F.children.sort(U);for(var j=this.toBBox,H=c(F,0,N,j),G=c(F,O-N,O,j),X=x(H)+x(G),ae=N;ae<O-N;ae++){var Q=F.children[ae];h(H,F.leaf?j(Q):Q),X+=x(H)}for(var W=O-N-1;W>=N;W--){var oe=F.children[W];h(G,F.leaf?j(oe):oe),X+=x(G)}return X},a.prototype._adjustParentBBoxes=function(F,N,O){for(var U=O;U>=0;U--)h(N[U],F)},a.prototype._condense=function(F){for(var N=F.length-1,O=void 0;N>=0;N--)F[N].children.length===0?N>0?(O=F[N-1].children).splice(O.indexOf(F[N]),1):this.clear():o(F[N],this.toBBox)},a})})(bS)),bS.exports}class Cwe{constructor(e=[],r=Awe){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:n}=this,i=r[e];for(;e>0;){const a=e-1>>1,s=r[a];if(n(i,s)>=0)break;r[e]=s,e=a}r[e]=i}_down(e){const{data:r,compare:n}=this,i=this.length>>1,a=r[e];for(;e<i;){let s=(e<<1)+1,o=r[s];const c=s+1;if(c<this.length&&n(r[c],o)<0&&(s=c,o=r[c]),n(o,a)>=0)break;r[e]=o,e=s}r[e]=a}}function Awe(t,e){return t<e?-1:t>e?1:0}const Iwe=Object.freeze(Object.defineProperty({__proto__:null,default:Cwe},Symbol.toStringTag,{value:"Module"})),Pwe=VG(Iwe);var l1={exports:{}},a5,H7;function kwe(){return H7||(H7=1,a5=function(e,r,n,i){var a=e[0],s=e[1],o=!1;n===void 0&&(n=0),i===void 0&&(i=r.length);for(var c=(i-n)/2,h=0,d=c-1;h<c;d=h++){var m=r[n+h*2+0],b=r[n+h*2+1],x=r[n+d*2+0],E=r[n+d*2+1],T=b>s!=E>s&&a<(x-m)*(s-b)/(E-b)+m;T&&(o=!o)}return o}),a5}var o5,W7;function Rwe(){return W7||(W7=1,o5=function(e,r,n,i){var a=e[0],s=e[1],o=!1;n===void 0&&(n=0),i===void 0&&(i=r.length);for(var c=i-n,h=0,d=c-1;h<c;d=h++){var m=r[h+n][0],b=r[h+n][1],x=r[d+n][0],E=r[d+n][1],T=b>s!=E>s&&a<(x-m)*(s-b)/(E-b)+m;T&&(o=!o)}return o}),o5}var G7;function Mwe(){if(G7)return l1.exports;G7=1;var t=kwe(),e=Rwe();return l1.exports=function(n,i,a,s){return i.length>0&&Array.isArray(i[0])?e(n,i,a,s):t(n,i,a,s)},l1.exports.nested=e,l1.exports.flat=t,l1.exports}var z1={exports:{}},Dwe=z1.exports,X7;function Owe(){return X7||(X7=1,(function(t,e){(function(r,n){n(e)})(Dwe,function(r){const i=33306690738754706e-32;function a(T,A,M,F,N){let O,U,j,H,G=A[0],X=F[0],ae=0,Q=0;X>G==X>-G?(O=G,G=A[++ae]):(O=X,X=F[++Q]);let W=0;if(ae<T&&Q<M)for(X>G==X>-G?(j=O-((U=G+O)-G),G=A[++ae]):(j=O-((U=X+O)-X),X=F[++Q]),O=U,j!==0&&(N[W++]=j);ae<T&&Q<M;)X>G==X>-G?(j=O-((U=O+G)-(H=U-O))+(G-H),G=A[++ae]):(j=O-((U=O+X)-(H=U-O))+(X-H),X=F[++Q]),O=U,j!==0&&(N[W++]=j);for(;ae<T;)j=O-((U=O+G)-(H=U-O))+(G-H),G=A[++ae],O=U,j!==0&&(N[W++]=j);for(;Q<M;)j=O-((U=O+X)-(H=U-O))+(X-H),X=F[++Q],O=U,j!==0&&(N[W++]=j);return O===0&&W!==0||(N[W++]=O),W}function s(T){return new Float64Array(T)}const o=33306690738754716e-32,c=22204460492503146e-32,h=11093356479670487e-47,d=s(4),m=s(8),b=s(12),x=s(16),E=s(4);r.orient2d=function(T,A,M,F,N,O){const U=(A-O)*(M-N),j=(T-N)*(F-O),H=U-j;if(U===0||j===0||U>0!=j>0)return H;const G=Math.abs(U+j);return Math.abs(H)>=o*G?H:-(function(X,ae,Q,W,oe,se,he){let _e,Ce,me,xe,Ae,De,de,Ee,we,Le,Fe,Xe,Be,ot,Qe,rt,Re,zt;const st=X-oe,$e=Q-oe,Jt=ae-se,Ht=W-se;Ae=(Qe=(Ee=st-(de=(De=134217729*st)-(De-st)))*(Le=Ht-(we=(De=134217729*Ht)-(De-Ht)))-((ot=st*Ht)-de*we-Ee*we-de*Le))-(Fe=Qe-(Re=(Ee=Jt-(de=(De=134217729*Jt)-(De-Jt)))*(Le=$e-(we=(De=134217729*$e)-(De-$e)))-((rt=Jt*$e)-de*we-Ee*we-de*Le))),d[0]=Qe-(Fe+Ae)+(Ae-Re),Ae=(Be=ot-((Xe=ot+Fe)-(Ae=Xe-ot))+(Fe-Ae))-(Fe=Be-rt),d[1]=Be-(Fe+Ae)+(Ae-rt),Ae=(zt=Xe+Fe)-Xe,d[2]=Xe-(zt-Ae)+(Fe-Ae),d[3]=zt;let pr=(function(Cr,Tr){let Qt=Tr[0];for(let at=1;at<Cr;at++)Qt+=Tr[at];return Qt})(4,d),_t=c*he;if(pr>=_t||-pr>=_t||(_e=X-(st+(Ae=X-st))+(Ae-oe),me=Q-($e+(Ae=Q-$e))+(Ae-oe),Ce=ae-(Jt+(Ae=ae-Jt))+(Ae-se),xe=W-(Ht+(Ae=W-Ht))+(Ae-se),_e===0&&Ce===0&&me===0&&xe===0)||(_t=h*he+i*Math.abs(pr),(pr+=st*xe+Ht*_e-(Jt*me+$e*Ce))>=_t||-pr>=_t))return pr;Ae=(Qe=(Ee=_e-(de=(De=134217729*_e)-(De-_e)))*(Le=Ht-(we=(De=134217729*Ht)-(De-Ht)))-((ot=_e*Ht)-de*we-Ee*we-de*Le))-(Fe=Qe-(Re=(Ee=Ce-(de=(De=134217729*Ce)-(De-Ce)))*(Le=$e-(we=(De=134217729*$e)-(De-$e)))-((rt=Ce*$e)-de*we-Ee*we-de*Le))),E[0]=Qe-(Fe+Ae)+(Ae-Re),Ae=(Be=ot-((Xe=ot+Fe)-(Ae=Xe-ot))+(Fe-Ae))-(Fe=Be-rt),E[1]=Be-(Fe+Ae)+(Ae-rt),Ae=(zt=Xe+Fe)-Xe,E[2]=Xe-(zt-Ae)+(Fe-Ae),E[3]=zt;const vr=a(4,d,4,E,m);Ae=(Qe=(Ee=st-(de=(De=134217729*st)-(De-st)))*(Le=xe-(we=(De=134217729*xe)-(De-xe)))-((ot=st*xe)-de*we-Ee*we-de*Le))-(Fe=Qe-(Re=(Ee=Jt-(de=(De=134217729*Jt)-(De-Jt)))*(Le=me-(we=(De=134217729*me)-(De-me)))-((rt=Jt*me)-de*we-Ee*we-de*Le))),E[0]=Qe-(Fe+Ae)+(Ae-Re),Ae=(Be=ot-((Xe=ot+Fe)-(Ae=Xe-ot))+(Fe-Ae))-(Fe=Be-rt),E[1]=Be-(Fe+Ae)+(Ae-rt),Ae=(zt=Xe+Fe)-Xe,E[2]=Xe-(zt-Ae)+(Fe-Ae),E[3]=zt;const br=a(vr,m,4,E,b);Ae=(Qe=(Ee=_e-(de=(De=134217729*_e)-(De-_e)))*(Le=xe-(we=(De=134217729*xe)-(De-xe)))-((ot=_e*xe)-de*we-Ee*we-de*Le))-(Fe=Qe-(Re=(Ee=Ce-(de=(De=134217729*Ce)-(De-Ce)))*(Le=me-(we=(De=134217729*me)-(De-me)))-((rt=Ce*me)-de*we-Ee*we-de*Le))),E[0]=Qe-(Fe+Ae)+(Ae-Re),Ae=(Be=ot-((Xe=ot+Fe)-(Ae=Xe-ot))+(Fe-Ae))-(Fe=Be-rt),E[1]=Be-(Fe+Ae)+(Ae-rt),Ae=(zt=Xe+Fe)-Xe,E[2]=Xe-(zt-Ae)+(Fe-Ae),E[3]=zt;const lr=a(br,b,4,E,x);return x[lr-1]})(T,A,M,F,N,O,G)},r.orient2dfast=function(T,A,M,F,N,O){return(A-O)*(M-N)-(T-N)*(F-O)},Object.defineProperty(r,"__esModule",{value:!0})})})(z1,z1.exports)),z1.exports}var Y7;function Nwe(){if(Y7)return Aw.exports;Y7=1;var t=Twe(),e=Pwe,r=Mwe(),n=Owe().orient2d;e.default&&(e=e.default),Aw.exports=i,Aw.exports.default=i;function i(O,U,j){U=Math.max(0,U===void 0?2:U),j=j||0;var H=x(O),G=new t(16);G.toBBox=function(de){return{minX:de[0],minY:de[1],maxX:de[0],maxY:de[1]}},G.compareMinX=function(de,Ee){return de[0]-Ee[0]},G.compareMinY=function(de,Ee){return de[1]-Ee[1]},G.load(O);for(var X=[],ae=0,Q;ae<H.length;ae++){var W=H[ae];G.remove(W),Q=E(W,Q),X.push(Q)}var oe=new t(16);for(ae=0;ae<X.length;ae++)oe.insert(b(X[ae]));for(var se=U*U,he=j*j;X.length;){var _e=X.shift(),Ce=_e.p,me=_e.next.p,xe=T(Ce,me);if(!(xe<he)){var Ae=xe/se;W=a(G,_e.prev.p,Ce,me,_e.next.next.p,Ae,oe),W&&Math.min(T(W,Ce),T(W,me))<=Ae&&(X.push(_e),X.push(E(W,_e)),G.remove(W),oe.remove(_e),oe.insert(b(_e)),oe.insert(b(_e.next)))}}_e=Q;var De=[];do De.push(_e.p),_e=_e.next;while(_e!==Q);return De.push(_e.p),De}function a(O,U,j,H,G,X,ae){for(var Q=new e([],s),W=O.data;W;){for(var oe=0;oe<W.children.length;oe++){var se=W.children[oe],he=W.leaf?A(se,j,H):o(j,H,se);he>X||Q.push({node:se,dist:he})}for(;Q.length&&!Q.peek().node.children;){var _e=Q.pop(),Ce=_e.node,me=A(Ce,U,j),xe=A(Ce,H,G);if(_e.dist<me&&_e.dist<xe&&h(j,Ce,ae)&&h(H,Ce,ae))return Ce}W=Q.pop(),W&&(W=W.node)}return null}function s(O,U){return O.dist-U.dist}function o(O,U,j){if(c(O,j)||c(U,j))return 0;var H=M(O[0],O[1],U[0],U[1],j.minX,j.minY,j.maxX,j.minY);if(H===0)return 0;var G=M(O[0],O[1],U[0],U[1],j.minX,j.minY,j.minX,j.maxY);if(G===0)return 0;var X=M(O[0],O[1],U[0],U[1],j.maxX,j.minY,j.maxX,j.maxY);if(X===0)return 0;var ae=M(O[0],O[1],U[0],U[1],j.minX,j.maxY,j.maxX,j.maxY);return ae===0?0:Math.min(H,G,X,ae)}function c(O,U){return O[0]>=U.minX&&O[0]<=U.maxX&&O[1]>=U.minY&&O[1]<=U.maxY}function h(O,U,j){for(var H=Math.min(O[0],U[0]),G=Math.min(O[1],U[1]),X=Math.max(O[0],U[0]),ae=Math.max(O[1],U[1]),Q=j.search({minX:H,minY:G,maxX:X,maxY:ae}),W=0;W<Q.length;W++)if(m(Q[W].p,Q[W].next.p,O,U))return!1;return!0}function d(O,U,j){return n(O[0],O[1],U[0],U[1],j[0],j[1])}function m(O,U,j,H){return O!==H&&U!==j&&d(O,U,j)>0!=d(O,U,H)>0&&d(j,H,O)>0!=d(j,H,U)>0}function b(O){var U=O.p,j=O.next.p;return O.minX=Math.min(U[0],j[0]),O.minY=Math.min(U[1],j[1]),O.maxX=Math.max(U[0],j[0]),O.maxY=Math.max(U[1],j[1]),O}function x(O){for(var U=O[0],j=O[0],H=O[0],G=O[0],X=0;X<O.length;X++){var ae=O[X];ae[0]<U[0]&&(U=ae),ae[0]>H[0]&&(H=ae),ae[1]<j[1]&&(j=ae),ae[1]>G[1]&&(G=ae)}var Q=[U,j,H,G],W=Q.slice();for(X=0;X<O.length;X++)r(O[X],Q)||W.push(O[X]);return N(W)}function E(O,U){var j={p:O,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return U?(j.next=U.next,j.prev=U,U.next.prev=j,U.next=j):(j.prev=j,j.next=j),j}function T(O,U){var j=O[0]-U[0],H=O[1]-U[1];return j*j+H*H}function A(O,U,j){var H=U[0],G=U[1],X=j[0]-H,ae=j[1]-G;if(X!==0||ae!==0){var Q=((O[0]-H)*X+(O[1]-G)*ae)/(X*X+ae*ae);Q>1?(H=j[0],G=j[1]):Q>0&&(H+=X*Q,G+=ae*Q)}return X=O[0]-H,ae=O[1]-G,X*X+ae*ae}function M(O,U,j,H,G,X,ae,Q){var W=j-O,oe=H-U,se=ae-G,he=Q-X,_e=O-G,Ce=U-X,me=W*W+oe*oe,xe=W*se+oe*he,Ae=se*se+he*he,De=W*_e+oe*Ce,de=se*_e+he*Ce,Ee=me*Ae-xe*xe,we,Le,Fe,Xe,Be=Ee,ot=Ee;Ee===0?(Le=0,Be=1,Xe=de,ot=Ae):(Le=xe*de-Ae*De,Xe=me*de-xe*De,Le<0?(Le=0,Xe=de,ot=Ae):Le>Be&&(Le=Be,Xe=de+xe,ot=Ae)),Xe<0?(Xe=0,-De<0?Le=0:-De>me?Le=Be:(Le=-De,Be=me)):Xe>ot&&(Xe=ot,-De+xe<0?Le=0:-De+xe>me?Le=Be:(Le=-De+xe,Be=me)),we=Le===0?0:Le/Be,Fe=Xe===0?0:Xe/ot;var Qe=(1-we)*O+we*j,rt=(1-we)*U+we*H,Re=(1-Fe)*G+Fe*ae,zt=(1-Fe)*X+Fe*Q,st=Re-Qe,$e=zt-rt;return st*st+$e*$e}function F(O,U){return O[0]===U[0]?O[1]-U[1]:O[0]-U[0]}function N(O){O.sort(F);for(var U=[],j=0;j<O.length;j++){for(;U.length>=2&&d(U[U.length-2],U[U.length-1],O[j])<=0;)U.pop();U.push(O[j])}for(var H=[],G=O.length-1;G>=0;G--){for(;H.length>=2&&d(H[H.length-2],H[H.length-1],O[G])<=0;)H.pop();H.push(O[G])}return H.pop(),U.pop(),U.concat(H)}return Aw.exports}var Lwe=Nwe();const Fwe=Id(Lwe);function Bwe(t,e={}){e.concavity=e.concavity||1/0;const r=[];if(y_(t,i=>{r.push([i[0],i[1]])}),!r.length)return null;const n=Fwe(r,e.concavity);return n.length>3?h3([n]):null}function oN(t,e={}){switch(aJ(t)){case"Point":return Gh(Pg(t),e.properties);case"Polygon":var r=[];y_(t,function(O){r.push(O)});var n=$7(t,{properties:e.properties}),i=n.geometry.coordinates,a=0,s=0,o=0,c,h,d,m,b,x,E,T,A=r.map(function(O){return[O[0]-i[0],O[1]-i[1]]});for(c=0;c<r.length-1;c++)h=A[c],m=h[0],x=h[1],d=A[c+1],b=d[0],E=d[1],T=m*E-b*x,o+=T,a+=(m+b)*T,s+=(x+E)*T;if(o===0)return n;var M=o*.5,F=1/(6*M);return Gh([i[0]+F*a,i[1]+F*s],e.properties);default:var N=Bwe(t);return N?oN(N,{properties:e.properties}):$7(t,{properties:e.properties})}}function SJ(t,e,r={}){const n=r.steps||64,i=r.properties?r.properties:!Array.isArray(t)&&t.type==="Feature"&&t.properties?t.properties:{},a=[];for(let s=0;s<n;s++)a.push(X0(t,e,s*-360/n,r).geometry.coordinates);return a.push(a[0]),h3([a],i)}function zwe(t){return t}function jwe(t){if(t==null)return zwe;var e,r,n=t.scale[0],i=t.scale[1],a=t.translate[0],s=t.translate[1];return function(o,c){c||(e=r=0);var h=2,d=o.length,m=new Array(d);for(m[0]=(e+=o[0])*n+a,m[1]=(r+=o[1])*i+s;h<d;)m[h]=o[h],++h;return m}}function Uwe(t,e){for(var r,n=t.length,i=n-e;i<--n;)r=t[i],t[i++]=t[n],t[n]=r}function Vwe(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(r){return Z7(t,r)})}:Z7(t,e)}function Z7(t,e){var r=e.id,n=e.bbox,i=e.properties==null?{}:e.properties,a=$we(t,e);return r==null&&n==null?{type:"Feature",properties:i,geometry:a}:n==null?{type:"Feature",id:r,properties:i,geometry:a}:{type:"Feature",id:r,bbox:n,properties:i,geometry:a}}function $we(t,e){var r=jwe(t.transform),n=t.arcs;function i(d,m){m.length&&m.pop();for(var b=n[d<0?~d:d],x=0,E=b.length;x<E;++x)m.push(r(b[x],x));d<0&&Uwe(m,E)}function a(d){return r(d)}function s(d){for(var m=[],b=0,x=d.length;b<x;++b)i(d[b],m);return m.length<2&&m.push(m[0]),m}function o(d){for(var m=s(d);m.length<4;)m.push(m[0]);return m}function c(d){return d.map(o)}function h(d){var m=d.type,b;switch(m){case"GeometryCollection":return{type:m,geometries:d.geometries.map(h)};case"Point":b=a(d.coordinates);break;case"MultiPoint":b=d.coordinates.map(a);break;case"LineString":b=s(d.arcs);break;case"MultiLineString":b=d.arcs.map(s);break;case"Polygon":b=c(d.arcs);break;case"MultiPolygon":b=d.arcs.map(c);break;default:return null}return{type:m,coordinates:b}}return h(e)}function Jb(t,e={}){return b2e(t,(r,n)=>{const i=n.geometry.coordinates;return r+f3(i[0],i[1],e)},0)}function qwe(t,e,r,n,i={}){const a=i.steps||64,s=K7(r),o=K7(n),c=!Array.isArray(t)&&t.type==="Feature"?t.properties:{};if(s===o)return Su(SJ(t,e,i).geometry.coordinates[0],c);const h=s,d=s<o?o:o+360;let m=h;const b=[];let x=0;const E=(d-h)/a;for(;m<=d;)b.push(X0(t,e,m,i).geometry.coordinates),x++,m=h+x*E;return Su(b,c)}function K7(t){let e=t%360;return e<0&&(e+=360),e}function Hwe(t,e,r,n){if(n=n||{},!nN(n))throw new Error("options is invalid");var i,a=[];if(t.type==="Feature")i=t.geometry.coordinates;else if(t.type==="LineString")i=t.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var s=i.length,o=0,c,h,d,m=0;m<i.length&&!(e>=o&&m===i.length-1);m++){if(o>e&&a.length===0){if(c=e-o,!c)return a.push(i[m]),Su(a);h=Yb(i[m],i[m-1])-180,d=X0(i[m],c,h,n),a.push(d.geometry.coordinates)}if(o>=r)return c=r-o,c?(h=Yb(i[m],i[m-1])-180,d=X0(i[m],c,h,n),a.push(d.geometry.coordinates),Su(a)):(a.push(i[m]),Su(a));if(o>=e&&a.push(i[m]),m===i.length-1)return Su(a);o+=f3(i[m],i[m+1],n)}if(o<e&&i.length===s)throw new Error("Start position is beyond line");var b=i[i.length-1];return Su([b,b])}function Wwe(t,e,r){if(r=r||{},!nN(r))throw new Error("options is invalid");var n=r.units,i=r.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var a=[];return iN(t,function(s){i&&(s.geometry.coordinates=s.geometry.coordinates.reverse()),Gwe(s,e,n,function(o){a.push(o)})}),Ep(a)}function Gwe(t,e,r,n){var i=Jb(t,{units:r});if(i<=e)return n(t);var a=i/e;Number.isInteger(a)||(a=Math.floor(a)+1);for(var s=0;s<a;s++){var o=Hwe(t,e*s,e*(s+1),{units:r});n(o,s)}}function yE(t){var e=t[0],r=t[1];return[r[0]-e[0],r[1]-e[1]]}function DR(t,e){return t[0]*e[1]-e[0]*t[1]}function Xwe(t,e){return[t[0]+e[0],t[1]+e[1]]}function Ywe(t,e){return[t[0]-e[0],t[1]-e[1]]}function Zwe(t,e){return[t*e[0],t*e[1]]}function Kwe(t,e){var r=t[0],n=yE(t),i=e[0],a=yE(e),s=DR(n,a),o=Ywe(i,r),c=DR(o,a),h=c/s,d=Xwe(r,Zwe(h,n));return d}function Jwe(t,e){var r=yE(t),n=yE(e);return DR(r,n)===0}function Qwe(t,e){return Jwe(t,e)?!1:Kwe(t,e)}function eSe(t,e,r){if(r=r||{},!nN(r))throw new Error("options is invalid");var n=r.units;if(!t)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("distance is required");var i=aJ(t),a=t.properties;switch(i){case"LineString":return J7(t,e,n);case"MultiLineString":var s=[];return iN(t,function(o){s.push(J7(o,e,n).geometry.coordinates)}),p2e(s,a);default:throw new Error("geometry "+i+" is not supported")}}function J7(t,e,r){var n=[],i=g2e(e,r),a=iJ(t),s=[];return a.forEach(function(o,c){if(c!==a.length-1){var h=tSe(o,a[c+1],i);if(n.push(h),c>0){var d=n[c-1],m=Qwe(h,d);m!==!1&&(d[1]=m,h[0]=m),s.push(d[0]),c===a.length-2&&(s.push(h[0]),s.push(h[1]))}a.length===2&&(s.push(h[0]),s.push(h[1]))}}),Su(s,t.properties)}function tSe(t,e,r){var n=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),i=t[0]+r*(e[1]-t[1])/n,a=e[0]+r*(e[1]-t[1])/n,s=t[1]+r*(t[0]-e[0])/n,o=e[1]+r*(t[0]-e[0])/n;return[[i,s],[a,o]]}function rSe(t){const r=window.getComputedStyle(t,null).getPropertyValue("transform");let n=0;if(r!=="none"){const i=r.split("(")[1].split(")")[0].split(","),a=parseFloat(i[0]),s=parseFloat(i[1]);n=Math.round(Math.atan2(s,a)*(180/Math.PI))}return n<0?n+360:n}function Iw(t,e,r){const n=getComputedStyle(t),i=[e[0]-r[0],e[1]-r[1]],a=new DOMMatrixReadOnly(n.transform);return[i[0]*a.a+i[1]*a.c+a.e+r[0],i[0]*a.b+i[1]*a.d+a.f+r[1]]}const Q7=10;function Pw(t,e){const r=e.unproject(t),n=e.unproject([t[0]+Q7,t[1]]),i=r.distanceTo(n);return Q7/i}function OR(t){const e=qT({mapId:t.mapId,watch:{layers:!1,viewport:!0}}),r=te.useRef(null),n=te.useRef(null),i=te.useRef(null),a=te.useRef(document.querySelector(".mapContainer")),s=va({mapId:t.mapId});te.useEffect(()=>{if(!e?.viewport?.zoom||!s.map)return;const h=Math.round(s.map.map._container.clientWidth/2),d=Math.round(s.map.map._container.clientHeight/2);if(!t.options.scale){const m=1/Pw([h,d],s.map.map);t.setOptions(b=>({...b,scale:[m,m]}))}if(!t.options.center){const m=s.map.map.unproject([h,d]);t.setOptions(b=>({...b,center:[m.lng,m.lat]}))}},[s.map,e.viewport?.zoom]),te.useEffect(()=>{if(!s.map)return;s.map.map.setPitch(0);const h=s.map.map.getMaxPitch();return s.map.map.setMaxPitch(0),()=>{s.map?.map.setMaxPitch(h)}},[s.map]);const o=te.useMemo(()=>t.options.orientation==="portrait"?[t.options.width/2,t.options.height/2]:[t.options.height/2,t.options.width/2],[t.options.orientation,t.options.width,t.options.height]),c=te.useMemo(()=>{if(!s.map||!t.options.scale)return"none";const h=s.map.map.project(t.options.center),d=h.x,m=h.y,b=t.options.scale[0]*Pw([d,m],s.map.map),x=e?.viewport?.bearing?e.viewport?.bearing:0,E=`translate(${Math.floor(h.x-o[0])}px,${Math.floor(h.y-o[1])}px) rotate(${t.options.rotate-x}deg) scale(${b},${b})`;return r.current&&(r.current.style.transform=E),E},[s.map,e.viewport,t.options.scale,t.options.rotate,t.options.center,o]);return te.useEffect(()=>{i.current?.updateTarget()},[c]),te.useEffect(()=>{if(!s.map||!t.options.center||!t.options.fixedScale||typeof t.options.fixedScale<"u"&&n.current===t.options.fixedScale)return;n.current=t.options.fixedScale;const h=Gh(t.options.center),d=t.options.fixedScale*(t.options.width/1e3),x=X0(h,d,90,{units:"meters"}),E=s.map.map.project(h.geometry.coordinates),T=s.map.map.project(x.geometry.coordinates),A=Math.round(T.x-E.x)/t.options.width*(1/Pw([E.x,E.y],s.map.map));t.setOptions(M=>({...M,scale:[A,A]}))},[s.map,t.options.width,t.options.center,t.options.fixedScale]),te.useEffect(()=>{if(r.current&&s.map){let h=t.options.width,d=t.options.height;t.options.orientation==="portrait"?(r.current.style.width=t.options.width+"px",r.current.style.height=t.options.height+"px"):(r.current.style.width=t.options.height+"px",r.current.style.height=t.options.width+"px",h=t.options.height,d=t.options.width),i.current?.updateTarget();const m=s.map.map.unproject(Iw(r.current,[0,0],o)),b=s.map.map.unproject(Iw(r.current,[h,0],o)),x=s.map.map.unproject(Iw(r.current,[0,d],o)),E=s.map.map.unproject(Iw(r.current,[h,d],o)),T={type:"Feature",bbox:[m.lng,m.lat,E.lng,E.lat],geometry:{type:"Polygon",coordinates:[[[m.lng,m.lat],[b.lng,b.lat],[E.lng,E.lat],[x.lng,x.lat],[m.lng,m.lat]]]},properties:{bearing:rSe(r.current)}};t.geojsonRef.current=T}},[s,c,t.options.orientation,t.geojsonRef,e,r.current,o]),a.current?I1.createPortal(J.jsxs(J.Fragment,{children:[J.jsx("div",{className:"target",ref:r,style:{transform:c,transformOrigin:"center center"}}),J.jsx(d2e,{ref:i,target:r,container:null,origin:!0,keepRatio:!0,draggable:!0,onDrag:h=>{if(s.map){let d=h.transform.split("translate(");d=d[1].split("px)")[0].split("px, ");const m=s.map?.map.unproject([parseInt(d[0])+o[0],parseInt(d[1])+o[1]]);t.setOptions(b=>({...b,center:[m.lng,m.lat]}))}},scalable:!t.options.fixedScale,onScale:h=>{if(s.map){let d=h.drag.transform.split("scale(");d=d[1].split(")")[0].split(", ");const m=s.map.map.project(t.options.center),b=m.x,x=m.y,E=parseFloat(d[0])*(1/Pw([b,x],s.map.map));t.setOptions(T=>({...T,scale:[E,E]}))}},rotatable:!0,onRotate:h=>{if(s.map&&e.viewport){const m=h.drag.transform.split("rotate(")[1].split("deg)")[0],b=e?.viewport?.bearing?e.viewport.bearing:0;t.setOptions(x=>({...x,rotate:parseFloat(m)+b}))}}})]}),a.current):J.jsx(J.Fragment,{})}try{OR.displayName="PdfPreview",OR.__docgenInfo={description:"PdfPreview component renders a transformable (drag, scale, rotate) preview of the desired export or print content",displayName:"PdfPreview",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},geojsonRef:{defaultValue:null,description:"Polygon GeoJson Feature representing the printing area",name:"geojsonRef",required:!0,type:{name:"MutableRefObject<Feature<Geometry, GeoJsonProperties> | undefined>"}},options:{defaultValue:null,description:"a state variable containing the PDF previews current state",name:"options",required:!0,type:{name:"PdfPreviewOptions"}},setOptions:{defaultValue:null,description:"setter function to update the current PDF preview state",name:"setOptions",required:!0,type:{name:"(arg1: (val: PdfPreviewOptions) => PdfPreviewOptions) => void"}}}}}catch{}const nSe=[{value:0,label:"free scale"},{value:250,label:"1/250"},{value:500,label:"1/500"},{value:750,label:"1/750"},{value:1e3,label:"1/1000"},{value:1500,label:"1/1500"},{value:2e3,label:"1/2000"},{value:1e4,label:"1/10000"},{value:1e5,label:"1/100000"}],iSe=[{value:"72dpi",label:"Draft (72dpi)"},{value:"150dpi",label:"Medium (150dpi)"},{value:"300dpi",label:"High (300dpi)"}];function NR(t){const[e,r]=te.useState(!1),n=te.useContext(yZ),i=va({mapId:t.mapId}),a=mZ({mapId:t.mapId}),s=te.useCallback(()=>{if(i.map&&a.createExport&&n.template&&n.format&&n.options?.orientation&&n.geojsonRef?.current?.bbox&&n.geojsonRef?.current){r(!0);const h=dh(n.geojsonRef.current);a.createExport({width:n.template.width,height:n.template.height,bbox:h,bboxUnrotated:n.geojsonRef.current.bbox,bearing:n.geojsonRef.current?.properties?.bearing||0,format:n.format.toLowerCase(),orientation:n.options.orientation}).then(d=>d.createPdf()).then(d=>(typeof t.onCreatePdf=="function"&&(d.formData=new FormData(document.getElementById("createPdfFormID")),t.onCreatePdf(d)),r(!1),d.downloadPdf())).catch(d=>{console.log(d),r(!1)})}},[i.map,n]),o=Ox("(max-width: 950px)"),c=te.useMemo(()=>({margin:o?"1px 0 8px 0 ":"5px 0 15px 0 ",...t?.formControlStyles?{...t.formControlStyles}:{}}),[o,t.formControlStyles]);return J.jsx(J.Fragment,{children:J.jsxs("form",{id:"createPdfFormID",children:[J.jsxs(ih,{fullWidth:!0,sx:c,children:[J.jsx(ta,{variant:"contained",className:"createPdfButton",onClick:s,disabled:e,sx:{marginBottom:"16px"},children:"create PDF"}),e&&J.jsx(WT,{size:24,sx:{color:"primary.main",position:"absolute",top:"25%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),J.jsxs(ih,{fullWidth:!0,sx:c,children:[J.jsx(_g,{sx:{marginTop:"3px"},id:"format-select-label",children:"Format"}),J.jsx(bg,{labelId:"format-select-label",id:"format-select",label:"Format",value:n.format,onChange:h=>{n.setFormat?.(h.target.value)},children:Object.keys(o0).map(h=>J.jsx(Fm,{value:h,children:h},h))})]}),J.jsxs(ih,{fullWidth:!0,sx:c,children:[J.jsx(fY,{id:"orientation-radio-buttons-group-label",children:"Orientation"}),J.jsxs(vme,{row:!0,"aria-labelledby":"orientation-radio-buttons-group-label",name:"orientation-radio-buttons-group",value:n.options?.orientation,onChange:h=>{n.setOptions&&n.setOptions(d=>({...d,orientation:h.target.value}))},children:[J.jsx(Vk,{value:"portrait",control:J.jsx(sz,{}),label:"Portrait"}),J.jsx(Vk,{value:"landscape",control:J.jsx(sz,{}),label:"Landscape"})]})]}),J.jsxs(ih,{fullWidth:!0,sx:c,children:[J.jsx(_g,{id:"quality-select-label",children:"Quality"}),J.jsx(bg,{labelId:"quality-select-label",id:"quality-select",label:"Quality",value:n.quality,onChange:h=>{n.setQuality?.(h.target.value)},children:iSe.map(h=>J.jsx(Fm,{value:h.value,children:h.label},h.value))})]}),J.jsxs(ih,{fullWidth:!0,sx:c,children:[J.jsx(_g,{id:"scale-select-label",children:"Scale"}),J.jsx(bg,{labelId:"scale-select-label",id:"scale-select",label:"Scale",value:n?.options?.fixedScale,onChange:h=>{n.setOptions?.(d=>({...d,fixedScale:h.target.value}))},children:nSe.map((h,d)=>J.jsx(Fm,{value:h.value,children:h.label},d))})]}),t?.additionalFields,n.options&&n.setOptions&&J.jsx(OR,{options:n.options,setOptions:n.setOptions,geojsonRef:n.geojsonRef})]})})}try{NR.displayName="PdfForm",NR.__docgenInfo={description:"",displayName:"PdfForm",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},onCreatePdf:{defaultValue:null,description:`Function that will be called before the PDF is created.
Allowing to access and manipulate the jspdf instance before the PDF is created.`,name:"onCreatePdf",required:!1,type:{name:"((options: createPdfResolverParams) => createPdfResolverParams) | undefined"}},formControlStyles:{defaultValue:null,description:"sx props that will be applied to the form control components",name:"formControlStyles",required:!1,type:{name:"SxProps | undefined"}},additionalFields:{defaultValue:null,description:`Define additional form fields that will be added to the bottom of the create-PDF form.
Values of form elements added this way are accessible inside the function passed to the onCreatePdf property using options.formData.get('{form_el_name}').
Make sure all form elements added this way have a name property defined to be able to access the value when rendering the PDF.`,name:"additionalFields",required:!1,type:{name:"ReactNode"}}}}}catch{}const ej=t=>J.jsx(J.Fragment,{children:J.jsx(rR,{children:J.jsx(NR,{...t})})});try{ej.displayName="MlCreatePdfForm",ej.__docgenInfo={description:"Create PDF Form Component",displayName:"MlCreatePdfForm",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},onCreatePdf:{defaultValue:null,description:`Function that will be called before the PDF is created.
Allowing to access and manipulate the jspdf instance before the PDF is created.`,name:"onCreatePdf",required:!1,type:{name:"((options: createPdfResolverParams) => createPdfResolverParams) | undefined"}},formControlStyles:{defaultValue:null,description:"sx props that will be applied to the form control components",name:"formControlStyles",required:!1,type:{name:"SxProps | undefined"}},additionalFields:{defaultValue:null,description:`Define additional form fields that will be added to the bottom of the create-PDF form.
Values of form elements added this way are accessible inside the function passed to the onCreatePdf property using options.formData.get('{form_el_name}').
Make sure all form elements added this way have a name property defined to be able to access the value when rendering the PDF.`,name:"additionalFields",required:!1,type:{name:"ReactNode"}}}}}catch{}var xS={exports:{}},aSe=xS.exports,tj;function oSe(){return tj||(tj=1,(function(t,e){(function(r,n){t.exports=n()})(aSe,(function(){var r=function(ee,pe){var Ke={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},It={on:function($t,er,Yr){if(Ke[$t]===void 0)throw new Error("Invalid event type: "+$t);Ke[$t].push({selector:er,fn:Yr})},render:function($t){pe.store.featureChanged($t)}},Vt=function($t,er){for(var Yr=Ke[$t],tn=Yr.length;tn--;){var Wr=Yr[tn];if(Wr.selector(er)){Wr.fn.call(It,er)||pe.store.render(),pe.ui.updateMapClasses();break}}};return ee.start.call(It),{render:ee.render,stop:function(){ee.stop&&ee.stop()},trash:function(){ee.trash&&(ee.trash(),pe.store.render())},combineFeatures:function(){ee.combineFeatures&&ee.combineFeatures()},uncombineFeatures:function(){ee.uncombineFeatures&&ee.uncombineFeatures()},drag:function($t){Vt("drag",$t)},click:function($t){Vt("click",$t)},mousemove:function($t){Vt("mousemove",$t)},mousedown:function($t){Vt("mousedown",$t)},mouseup:function($t){Vt("mouseup",$t)},mouseout:function($t){Vt("mouseout",$t)},keydown:function($t){Vt("keydown",$t)},keyup:function($t){Vt("keyup",$t)},touchstart:function($t){Vt("touchstart",$t)},touchmove:function($t){Vt("touchmove",$t)},touchend:function($t){Vt("touchend",$t)},tap:function($t){Vt("tap",$t)}}};function n(ee){return ee&&ee.__esModule&&Object.prototype.hasOwnProperty.call(ee,"default")?ee.default:ee}function i(ee){if(ee.__esModule)return ee;var pe=ee.default;if(typeof pe=="function"){var Ke=function It(){if(this instanceof It){var Vt=[null];Vt.push.apply(Vt,arguments);var $t=Function.bind.apply(pe,Vt);return new $t}return pe.apply(this,arguments)};Ke.prototype=pe.prototype}else Ke={};return Object.defineProperty(Ke,"__esModule",{value:!0}),Object.keys(ee).forEach((function(It){var Vt=Object.getOwnPropertyDescriptor(ee,It);Object.defineProperty(Ke,It,Vt.get?Vt:{enumerable:!0,get:function(){return ee[It]}})})),Ke}var a={},s={RADIUS:6378137},o=s;function c(ee){var pe=0;if(ee&&ee.length>0){pe+=Math.abs(h(ee[0]));for(var Ke=1;Ke<ee.length;Ke++)pe-=Math.abs(h(ee[Ke]))}return pe}function h(ee){var pe,Ke,It,Vt,$t,er,Yr=0,tn=ee.length;if(tn>2){for(er=0;er<tn;er++)er===tn-2?(It=tn-2,Vt=tn-1,$t=0):er===tn-1?(It=tn-1,Vt=0,$t=1):(It=er,Vt=er+1,$t=er+2),pe=ee[It],Ke=ee[Vt],Yr+=(d(ee[$t][0])-d(pe[0]))*Math.sin(d(Ke[1]));Yr=Yr*o.RADIUS*o.RADIUS/2}return Yr}function d(ee){return ee*Math.PI/180}a.geometry=function ee(pe){var Ke,It=0;switch(pe.type){case"Polygon":return c(pe.coordinates);case"MultiPolygon":for(Ke=0;Ke<pe.coordinates.length;Ke++)It+=c(pe.coordinates[Ke]);return It;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Ke=0;Ke<pe.geometries.length;Ke++)It+=ee(pe.geometries[Ke]);return It}},a.ring=h;var m={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},b={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},x={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},E={POLYGON:"polygon",LINE:"line_string",POINT:"point"},T={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},A={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},M={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},F={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},N={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},O={ACTIVE:"true",INACTIVE:"false"},U=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],j=-85,H=Object.freeze({__proto__:null,classes:m,sources:b,cursors:x,types:E,geojsonTypes:T,modes:A,events:M,updateActions:F,meta:N,activeStates:O,interactions:U,LAT_MIN:-90,LAT_RENDERED_MIN:j,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),G={Point:0,LineString:1,MultiLineString:1,Polygon:2};function X(ee,pe){var Ke=G[ee.geometry.type]-G[pe.geometry.type];return Ke===0&&ee.geometry.type===T.POLYGON?ee.area-pe.area:Ke}function ae(ee){return ee.map((function(pe){return pe.geometry.type===T.POLYGON&&(pe.area=a.geometry({type:T.FEATURE,property:{},geometry:pe.geometry})),pe})).sort(X).map((function(pe){return delete pe.area,pe}))}function Q(ee,pe){return pe===void 0&&(pe=0),[[ee.point.x-pe,ee.point.y-pe],[ee.point.x+pe,ee.point.y+pe]]}function W(ee){if(this._items={},this._nums={},this._length=ee?ee.length:0,ee)for(var pe=0,Ke=ee.length;pe<Ke;pe++)this.add(ee[pe]),ee[pe]!==void 0&&(typeof ee[pe]=="string"?this._items[ee[pe]]=pe:this._nums[ee[pe]]=pe)}W.prototype.add=function(ee){return this.has(ee)||(this._length++,typeof ee=="string"?this._items[ee]=this._length:this._nums[ee]=this._length),this},W.prototype.delete=function(ee){return this.has(ee)===!1||(this._length--,delete this._items[ee],delete this._nums[ee]),this},W.prototype.has=function(ee){return(typeof ee=="string"||typeof ee=="number")&&(this._items[ee]!==void 0||this._nums[ee]!==void 0)},W.prototype.values=function(){var ee=this,pe=[];return Object.keys(this._items).forEach((function(Ke){pe.push({k:Ke,v:ee._items[Ke]})})),Object.keys(this._nums).forEach((function(Ke){pe.push({k:JSON.parse(Ke),v:ee._nums[Ke]})})),pe.sort((function(Ke,It){return Ke.v-It.v})).map((function(Ke){return Ke.k}))},W.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var oe=[N.FEATURE,N.MIDPOINT,N.VERTEX],se={click:function(ee,pe,Ke){return he(ee,pe,Ke,Ke.options.clickBuffer)},touch:function(ee,pe,Ke){return he(ee,pe,Ke,Ke.options.touchBuffer)}};function he(ee,pe,Ke,It){if(Ke.map===null)return[];var Vt=ee?Q(ee,It):pe,$t={};Ke.options.styles&&($t.layers=Ke.options.styles.map((function(Wr){return Wr.id})).filter((function(Wr){return Ke.map.getLayer(Wr)!=null})));var er=Ke.map.queryRenderedFeatures(Vt,$t).filter((function(Wr){return oe.indexOf(Wr.properties.meta)!==-1})),Yr=new W,tn=[];return er.forEach((function(Wr){var on=Wr.properties.id;Yr.has(on)||(Yr.add(on),tn.push(Wr))})),ae(tn)}function _e(ee,pe){var Ke=se.click(ee,null,pe),It={mouse:x.NONE};return Ke[0]&&(It.mouse=Ke[0].properties.active===O.ACTIVE?x.MOVE:x.POINTER,It.feature=Ke[0].properties.meta),pe.events.currentModeName().indexOf("draw")!==-1&&(It.mouse=x.ADD),pe.ui.queueMapClasses(It),pe.ui.updateMapClasses(),Ke[0]}function Ce(ee,pe){var Ke=ee.x-pe.x,It=ee.y-pe.y;return Math.sqrt(Ke*Ke+It*It)}function me(ee,pe,Ke){Ke===void 0&&(Ke={});var It=Ke.fineTolerance!=null?Ke.fineTolerance:4,Vt=Ke.grossTolerance!=null?Ke.grossTolerance:12,$t=Ke.interval!=null?Ke.interval:500;ee.point=ee.point||pe.point,ee.time=ee.time||pe.time;var er=Ce(ee.point,pe.point);return er<It||er<Vt&&pe.time-ee.time<$t}function xe(ee,pe,Ke){Ke===void 0&&(Ke={});var It=Ke.tolerance!=null?Ke.tolerance:25,Vt=Ke.interval!=null?Ke.interval:250;return ee.point=ee.point||pe.point,ee.time=ee.time||pe.time,Ce(ee.point,pe.point)<It&&pe.time-ee.time<Vt}var Ae={exports:{}},De=Ae.exports=function(ee,pe){if(pe||(pe=16),ee===void 0&&(ee=128),ee<=0)return"0";for(var Ke=Math.log(Math.pow(2,ee))/Math.log(pe),It=2;Ke===1/0;It*=2)Ke=Math.log(Math.pow(2,ee/It))/Math.log(pe)*It;var Vt=Ke-Math.floor(Ke),$t="";for(It=0;It<Math.floor(Ke);It++)$t=Math.floor(Math.random()*pe).toString(pe)+$t;if(Vt){var er=Math.pow(pe,Vt);$t=Math.floor(Math.random()*er).toString(pe)+$t}var Yr=parseInt($t,pe);return Yr!==1/0&&Yr>=Math.pow(2,ee)?De(ee,pe):$t};De.rack=function(ee,pe,Ke){var It=function($t){var er=0;do{if(er++>10){if(!Ke)throw new Error("too many ID collisions, use more bits");ee+=Ke}var Yr=De(ee,pe)}while(Object.hasOwnProperty.call(Vt,Yr));return Vt[Yr]=$t,Yr},Vt=It.hats={};return It.get=function($t){return It.hats[$t]},It.set=function($t,er){return It.hats[$t]=er,It},It.bits=ee||128,It.base=pe||16,It};var de=n(Ae.exports),Ee=function(ee,pe){this.ctx=ee,this.properties=pe.properties||{},this.coordinates=pe.geometry.coordinates,this.id=pe.id||de(),this.type=pe.geometry.type};Ee.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Ee.prototype.incomingCoords=function(ee){this.setCoordinates(ee)},Ee.prototype.setCoordinates=function(ee){this.coordinates=ee,this.changed()},Ee.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Ee.prototype.setProperty=function(ee,pe){this.properties[ee]=pe},Ee.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:T.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Ee.prototype.internal=function(ee){var pe={id:this.id,meta:N.FEATURE,"meta:type":this.type,active:O.INACTIVE,mode:ee};if(this.ctx.options.userProperties)for(var Ke in this.properties)pe["user_"+Ke]=this.properties[Ke];return{type:T.FEATURE,properties:pe,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var we=function(ee,pe){Ee.call(this,ee,pe)};(we.prototype=Object.create(Ee.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},we.prototype.updateCoordinate=function(ee,pe,Ke){this.coordinates=arguments.length===3?[pe,Ke]:[ee,pe],this.changed()},we.prototype.getCoordinate=function(){return this.getCoordinates()};var Le=function(ee,pe){Ee.call(this,ee,pe)};(Le.prototype=Object.create(Ee.prototype)).isValid=function(){return this.coordinates.length>1},Le.prototype.addCoordinate=function(ee,pe,Ke){this.changed();var It=parseInt(ee,10);this.coordinates.splice(It,0,[pe,Ke])},Le.prototype.getCoordinate=function(ee){var pe=parseInt(ee,10);return JSON.parse(JSON.stringify(this.coordinates[pe]))},Le.prototype.removeCoordinate=function(ee){this.changed(),this.coordinates.splice(parseInt(ee,10),1)},Le.prototype.updateCoordinate=function(ee,pe,Ke){var It=parseInt(ee,10);this.coordinates[It]=[pe,Ke],this.changed()};var Fe=function(ee,pe){Ee.call(this,ee,pe),this.coordinates=this.coordinates.map((function(Ke){return Ke.slice(0,-1)}))};(Fe.prototype=Object.create(Ee.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every((function(ee){return ee.length>2}))},Fe.prototype.incomingCoords=function(ee){this.coordinates=ee.map((function(pe){return pe.slice(0,-1)})),this.changed()},Fe.prototype.setCoordinates=function(ee){this.coordinates=ee,this.changed()},Fe.prototype.addCoordinate=function(ee,pe,Ke){this.changed();var It=ee.split(".").map((function(Vt){return parseInt(Vt,10)}));this.coordinates[It[0]].splice(It[1],0,[pe,Ke])},Fe.prototype.removeCoordinate=function(ee){this.changed();var pe=ee.split(".").map((function(It){return parseInt(It,10)})),Ke=this.coordinates[pe[0]];Ke&&(Ke.splice(pe[1],1),Ke.length<3&&this.coordinates.splice(pe[0],1))},Fe.prototype.getCoordinate=function(ee){var pe=ee.split(".").map((function(It){return parseInt(It,10)})),Ke=this.coordinates[pe[0]];return JSON.parse(JSON.stringify(Ke[pe[1]]))},Fe.prototype.getCoordinates=function(){return this.coordinates.map((function(ee){return ee.concat([ee[0]])}))},Fe.prototype.updateCoordinate=function(ee,pe,Ke){this.changed();var It=ee.split("."),Vt=parseInt(It[0],10),$t=parseInt(It[1],10);this.coordinates[Vt]===void 0&&(this.coordinates[Vt]=[]),this.coordinates[Vt][$t]=[pe,Ke]};var Xe={MultiPoint:we,MultiLineString:Le,MultiPolygon:Fe},Be=function(ee,pe,Ke,It,Vt){var $t=Ke.split("."),er=parseInt($t[0],10),Yr=$t[1]?$t.slice(1).join("."):null;return ee[er][pe](Yr,It,Vt)},ot=function(ee,pe){if(Ee.call(this,ee,pe),delete this.coordinates,this.model=Xe[pe.geometry.type],this.model===void 0)throw new TypeError(pe.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(pe.geometry.coordinates)};function Qe(ee){this.map=ee.map,this.drawConfig=JSON.parse(JSON.stringify(ee.options||{})),this._ctx=ee}(ot.prototype=Object.create(Ee.prototype))._coordinatesToFeatures=function(ee){var pe=this,Ke=this.model.bind(this);return ee.map((function(It){return new Ke(pe.ctx,{id:de(),type:T.FEATURE,properties:{},geometry:{coordinates:It,type:pe.type.replace("Multi","")}})}))},ot.prototype.isValid=function(){return this.features.every((function(ee){return ee.isValid()}))},ot.prototype.setCoordinates=function(ee){this.features=this._coordinatesToFeatures(ee),this.changed()},ot.prototype.getCoordinate=function(ee){return Be(this.features,"getCoordinate",ee)},ot.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map((function(ee){return ee.type===T.POLYGON?ee.getCoordinates():ee.coordinates}))))},ot.prototype.updateCoordinate=function(ee,pe,Ke){Be(this.features,"updateCoordinate",ee,pe,Ke),this.changed()},ot.prototype.addCoordinate=function(ee,pe,Ke){Be(this.features,"addCoordinate",ee,pe,Ke),this.changed()},ot.prototype.removeCoordinate=function(ee){Be(this.features,"removeCoordinate",ee),this.changed()},ot.prototype.getFeatures=function(){return this.features},Qe.prototype.setSelected=function(ee){return this._ctx.store.setSelected(ee)},Qe.prototype.setSelectedCoordinates=function(ee){var pe=this;this._ctx.store.setSelectedCoordinates(ee),ee.reduce((function(Ke,It){return Ke[It.feature_id]===void 0&&(Ke[It.feature_id]=!0,pe._ctx.store.get(It.feature_id).changed()),Ke}),{})},Qe.prototype.getSelected=function(){return this._ctx.store.getSelected()},Qe.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Qe.prototype.isSelected=function(ee){return this._ctx.store.isSelected(ee)},Qe.prototype.getFeature=function(ee){return this._ctx.store.get(ee)},Qe.prototype.select=function(ee){return this._ctx.store.select(ee)},Qe.prototype.deselect=function(ee){return this._ctx.store.deselect(ee)},Qe.prototype.deleteFeature=function(ee,pe){return pe===void 0&&(pe={}),this._ctx.store.delete(ee,pe)},Qe.prototype.addFeature=function(ee){return this._ctx.store.add(ee)},Qe.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Qe.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Qe.prototype.setActionableState=function(ee){ee===void 0&&(ee={});var pe={trash:ee.trash||!1,combineFeatures:ee.combineFeatures||!1,uncombineFeatures:ee.uncombineFeatures||!1};return this._ctx.events.actionable(pe)},Qe.prototype.changeMode=function(ee,pe,Ke){return pe===void 0&&(pe={}),Ke===void 0&&(Ke={}),this._ctx.events.changeMode(ee,pe,Ke)},Qe.prototype.updateUIClasses=function(ee){return this._ctx.ui.queueMapClasses(ee)},Qe.prototype.activateUIButton=function(ee){return this._ctx.ui.setActiveButton(ee)},Qe.prototype.featuresAt=function(ee,pe,Ke){if(Ke===void 0&&(Ke="click"),Ke!=="click"&&Ke!=="touch")throw new Error("invalid buffer type");return se[Ke](ee,pe,this._ctx)},Qe.prototype.newFeature=function(ee){var pe=ee.geometry.type;return pe===T.POINT?new we(this._ctx,ee):pe===T.LINE_STRING?new Le(this._ctx,ee):pe===T.POLYGON?new Fe(this._ctx,ee):new ot(this._ctx,ee)},Qe.prototype.isInstanceOf=function(ee,pe){if(ee===T.POINT)return pe instanceof we;if(ee===T.LINE_STRING)return pe instanceof Le;if(ee===T.POLYGON)return pe instanceof Fe;if(ee==="MultiFeature")return pe instanceof ot;throw new Error("Unknown feature class: "+ee)},Qe.prototype.doRender=function(ee){return this._ctx.store.featureChanged(ee)},Qe.prototype.onSetup=function(){},Qe.prototype.onDrag=function(){},Qe.prototype.onClick=function(){},Qe.prototype.onMouseMove=function(){},Qe.prototype.onMouseDown=function(){},Qe.prototype.onMouseUp=function(){},Qe.prototype.onMouseOut=function(){},Qe.prototype.onKeyUp=function(){},Qe.prototype.onKeyDown=function(){},Qe.prototype.onTouchStart=function(){},Qe.prototype.onTouchMove=function(){},Qe.prototype.onTouchEnd=function(){},Qe.prototype.onTap=function(){},Qe.prototype.onStop=function(){},Qe.prototype.onTrash=function(){},Qe.prototype.onCombineFeature=function(){},Qe.prototype.onUncombineFeature=function(){},Qe.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var rt={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Re=Object.keys(rt);function zt(ee){var pe=Object.keys(ee);return function(Ke,It){It===void 0&&(It={});var Vt={},$t=pe.reduce((function(er,Yr){return er[Yr]=ee[Yr],er}),new Qe(Ke));return{start:function(){var er=this;Vt=$t.onSetup(It),Re.forEach((function(Yr){var tn,Wr=rt[Yr],on=function(){return!1};ee[Wr]&&(on=function(){return!0}),er.on(Yr,on,(tn=Wr,function(kr){return $t[tn](Vt,kr)}))}))},stop:function(){$t.onStop(Vt)},trash:function(){$t.onTrash(Vt)},combineFeatures:function(){$t.onCombineFeatures(Vt)},uncombineFeatures:function(){$t.onUncombineFeatures(Vt)},render:function(er,Yr){$t.toDisplayFeatures(Vt,er,Yr)}}}}function st(ee){return[].concat(ee).filter((function(pe){return pe!==void 0}))}function $e(){var ee=this;if(!(ee.ctx.map&&ee.ctx.map.getSource(b.HOT)!==void 0))return tn();var pe=ee.ctx.events.currentModeName();ee.ctx.ui.queueMapClasses({mode:pe});var Ke=[],It=[];ee.isDirty?It=ee.getAllIds():(Ke=ee.getChangedIds().filter((function(Wr){return ee.get(Wr)!==void 0})),It=ee.sources.hot.filter((function(Wr){return Wr.properties.id&&Ke.indexOf(Wr.properties.id)===-1&&ee.get(Wr.properties.id)!==void 0})).map((function(Wr){return Wr.properties.id}))),ee.sources.hot=[];var Vt=ee.sources.cold.length;ee.sources.cold=ee.isDirty?[]:ee.sources.cold.filter((function(Wr){var on=Wr.properties.id||Wr.properties.parent;return Ke.indexOf(on)===-1}));var $t=Vt!==ee.sources.cold.length||It.length>0;function er(Wr,on){var kr=ee.get(Wr).internal(pe);ee.ctx.events.currentModeRender(kr,(function(ti){ee.sources[on].push(ti)}))}if(Ke.forEach((function(Wr){return er(Wr,"hot")})),It.forEach((function(Wr){return er(Wr,"cold")})),$t&&ee.ctx.map.getSource(b.COLD).setData({type:T.FEATURE_COLLECTION,features:ee.sources.cold}),ee.ctx.map.getSource(b.HOT).setData({type:T.FEATURE_COLLECTION,features:ee.sources.hot}),ee._emitSelectionChange&&(ee.ctx.map.fire(M.SELECTION_CHANGE,{features:ee.getSelected().map((function(Wr){return Wr.toGeoJSON()})),points:ee.getSelectedCoordinates().map((function(Wr){return{type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:Wr.coordinates}}}))}),ee._emitSelectionChange=!1),ee._deletedFeaturesToEmit.length){var Yr=ee._deletedFeaturesToEmit.map((function(Wr){return Wr.toGeoJSON()}));ee._deletedFeaturesToEmit=[],ee.ctx.map.fire(M.DELETE,{features:Yr})}function tn(){ee.isDirty=!1,ee.clearChangedIds()}tn(),ee.ctx.map.fire(M.RENDER,{})}function Jt(ee){var pe,Ke=this;this._features={},this._featureIds=new W,this._selectedFeatureIds=new W,this._selectedCoordinates=[],this._changedFeatureIds=new W,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=ee,this.sources={hot:[],cold:[]},this.render=function(){pe||(pe=requestAnimationFrame((function(){pe=null,$e.call(Ke)})))},this.isDirty=!1}function Ht(ee,pe){var Ke=ee._selectedCoordinates.filter((function(It){return ee._selectedFeatureIds.has(It.feature_id)}));ee._selectedCoordinates.length===Ke.length||pe.silent||(ee._emitSelectionChange=!0),ee._selectedCoordinates=Ke}Jt.prototype.createRenderBatch=function(){var ee=this,pe=this.render,Ke=0;return this.render=function(){Ke++},function(){ee.render=pe,Ke>0&&ee.render()}},Jt.prototype.setDirty=function(){return this.isDirty=!0,this},Jt.prototype.featureChanged=function(ee){return this._changedFeatureIds.add(ee),this},Jt.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Jt.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Jt.prototype.getAllIds=function(){return this._featureIds.values()},Jt.prototype.add=function(ee){return this.featureChanged(ee.id),this._features[ee.id]=ee,this._featureIds.add(ee.id),this},Jt.prototype.delete=function(ee,pe){var Ke=this;return pe===void 0&&(pe={}),st(ee).forEach((function(It){Ke._featureIds.has(It)&&(Ke._featureIds.delete(It),Ke._selectedFeatureIds.delete(It),pe.silent||Ke._deletedFeaturesToEmit.indexOf(Ke._features[It])===-1&&Ke._deletedFeaturesToEmit.push(Ke._features[It]),delete Ke._features[It],Ke.isDirty=!0)})),Ht(this,pe),this},Jt.prototype.get=function(ee){return this._features[ee]},Jt.prototype.getAll=function(){var ee=this;return Object.keys(this._features).map((function(pe){return ee._features[pe]}))},Jt.prototype.select=function(ee,pe){var Ke=this;return pe===void 0&&(pe={}),st(ee).forEach((function(It){Ke._selectedFeatureIds.has(It)||(Ke._selectedFeatureIds.add(It),Ke._changedFeatureIds.add(It),pe.silent||(Ke._emitSelectionChange=!0))})),this},Jt.prototype.deselect=function(ee,pe){var Ke=this;return pe===void 0&&(pe={}),st(ee).forEach((function(It){Ke._selectedFeatureIds.has(It)&&(Ke._selectedFeatureIds.delete(It),Ke._changedFeatureIds.add(It),pe.silent||(Ke._emitSelectionChange=!0))})),Ht(this,pe),this},Jt.prototype.clearSelected=function(ee){return ee===void 0&&(ee={}),this.deselect(this._selectedFeatureIds.values(),{silent:ee.silent}),this},Jt.prototype.setSelected=function(ee,pe){var Ke=this;return pe===void 0&&(pe={}),ee=st(ee),this.deselect(this._selectedFeatureIds.values().filter((function(It){return ee.indexOf(It)===-1})),{silent:pe.silent}),this.select(ee.filter((function(It){return!Ke._selectedFeatureIds.has(It)})),{silent:pe.silent}),this},Jt.prototype.setSelectedCoordinates=function(ee){return this._selectedCoordinates=ee,this._emitSelectionChange=!0,this},Jt.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Jt.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Jt.prototype.getSelected=function(){var ee=this;return this._selectedFeatureIds.values().map((function(pe){return ee.get(pe)}))},Jt.prototype.getSelectedCoordinates=function(){var ee=this;return this._selectedCoordinates.map((function(pe){return{coordinates:ee.get(pe.feature_id).getCoordinate(pe.coord_path)}}))},Jt.prototype.isSelected=function(ee){return this._selectedFeatureIds.has(ee)},Jt.prototype.setFeatureProperty=function(ee,pe,Ke){this.get(ee).setProperty(pe,Ke),this.featureChanged(ee)},Jt.prototype.storeMapConfig=function(){var ee=this;U.forEach((function(pe){ee.ctx.map[pe]&&(ee._mapInitialConfig[pe]=ee.ctx.map[pe].isEnabled())}))},Jt.prototype.restoreMapConfig=function(){var ee=this;Object.keys(this._mapInitialConfig).forEach((function(pe){ee._mapInitialConfig[pe]?ee.ctx.map[pe].enable():ee.ctx.map[pe].disable()}))},Jt.prototype.getInitialConfigValue=function(ee){return this._mapInitialConfig[ee]===void 0||this._mapInitialConfig[ee]};var pr=function(){for(var ee=arguments,pe={},Ke=0;Ke<arguments.length;Ke++){var It=ee[Ke];for(var Vt in It)_t.call(It,Vt)&&(pe[Vt]=It[Vt])}return pe},_t=Object.prototype.hasOwnProperty,vr=n(pr),br=["mode","feature","mouse"];function lr(ee){var pe=null,Ke=null,It={onRemove:function(){return ee.map.off("load",It.connect),clearInterval(Ke),It.removeLayers(),ee.store.restoreMapConfig(),ee.ui.removeButtons(),ee.events.removeEventListeners(),ee.ui.clearMapClasses(),ee.boxZoomInitial&&ee.map.boxZoom.enable(),ee.map=null,ee.container=null,ee.store=null,pe&&pe.parentNode&&pe.parentNode.removeChild(pe),pe=null,this},connect:function(){ee.map.off("load",It.connect),clearInterval(Ke),It.addLayers(),ee.store.storeMapConfig(),ee.events.addEventListeners()},onAdd:function(Vt){var $t=Vt.fire;return Vt.fire=function(er,Yr){var tn=arguments;return $t.length===1&&arguments.length!==1&&(tn=[vr({},{type:er},Yr)]),$t.apply(Vt,tn)},ee.map=Vt,ee.events=(function(er){var Yr=Object.keys(er.options.modes).reduce((function(Mr,fn){return Mr[fn]=zt(er.options.modes[fn]),Mr}),{}),tn={},Wr={},on={},kr=null,ti=null;on.drag=function(Mr,fn){fn({point:Mr.point,time:new Date().getTime()})?(er.ui.queueMapClasses({mouse:x.DRAG}),ti.drag(Mr)):Mr.originalEvent.stopPropagation()},on.mousedrag=function(Mr){on.drag(Mr,(function(fn){return!me(tn,fn)}))},on.touchdrag=function(Mr){on.drag(Mr,(function(fn){return!xe(Wr,fn)}))},on.mousemove=function(Mr){if((Mr.originalEvent.buttons!==void 0?Mr.originalEvent.buttons:Mr.originalEvent.which)===1)return on.mousedrag(Mr);var fn=_e(Mr,er);Mr.featureTarget=fn,ti.mousemove(Mr)},on.mousedown=function(Mr){tn={time:new Date().getTime(),point:Mr.point};var fn=_e(Mr,er);Mr.featureTarget=fn,ti.mousedown(Mr)},on.mouseup=function(Mr){var fn=_e(Mr,er);Mr.featureTarget=fn,me(tn,{point:Mr.point,time:new Date().getTime()})?ti.click(Mr):ti.mouseup(Mr)},on.mouseout=function(Mr){ti.mouseout(Mr)},on.touchstart=function(Mr){if(er.options.touchEnabled){Wr={time:new Date().getTime(),point:Mr.point};var fn=se.touch(Mr,null,er)[0];Mr.featureTarget=fn,ti.touchstart(Mr)}},on.touchmove=function(Mr){if(er.options.touchEnabled)return ti.touchmove(Mr),on.touchdrag(Mr)},on.touchend=function(Mr){if(Mr.originalEvent.preventDefault(),er.options.touchEnabled){var fn=se.touch(Mr,null,er)[0];Mr.featureTarget=fn,xe(Wr,{time:new Date().getTime(),point:Mr.point})?ti.tap(Mr):ti.touchend(Mr)}};var Ri=function(Mr){return!(Mr===8||Mr===46||Mr>=48&&Mr<=57)};function $n(Mr,fn,mn){mn===void 0&&(mn={}),ti.stop();var hi=Yr[Mr];if(hi===void 0)throw new Error(Mr+" is not valid");kr=Mr;var $i=hi(er,fn);ti=r($i,er),mn.silent||er.map.fire(M.MODE_CHANGE,{mode:Mr}),er.store.setDirty(),er.store.render()}on.keydown=function(Mr){(Mr.srcElement||Mr.target).classList.contains("mapboxgl-canvas")&&(Mr.keyCode!==8&&Mr.keyCode!==46||!er.options.controls.trash?Ri(Mr.keyCode)?ti.keydown(Mr):Mr.keyCode===49&&er.options.controls.point?$n(A.DRAW_POINT):Mr.keyCode===50&&er.options.controls.line_string?$n(A.DRAW_LINE_STRING):Mr.keyCode===51&&er.options.controls.polygon&&$n(A.DRAW_POLYGON):(Mr.preventDefault(),ti.trash()))},on.keyup=function(Mr){Ri(Mr.keyCode)&&ti.keyup(Mr)},on.zoomend=function(){er.store.changeZoom()},on.data=function(Mr){if(Mr.dataType==="style"){var fn=er.setup,mn=er.map,hi=er.options,$i=er.store;hi.styles.some((function(ba){return mn.getLayer(ba.id)}))||(fn.addLayers(),$i.setDirty(),$i.render())}};var _n={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){kr=er.options.defaultMode,ti=r(Yr[kr](er),er)},changeMode:$n,actionable:function(Mr){var fn=!1;Object.keys(Mr).forEach((function(mn){if(_n[mn]===void 0)throw new Error("Invalid action type");_n[mn]!==Mr[mn]&&(fn=!0),_n[mn]=Mr[mn]})),fn&&er.map.fire(M.ACTIONABLE,{actions:_n})},currentModeName:function(){return kr},currentModeRender:function(Mr,fn){return ti.render(Mr,fn)},fire:function(Mr,fn){on[Mr]&&on[Mr](fn)},addEventListeners:function(){er.map.on("mousemove",on.mousemove),er.map.on("mousedown",on.mousedown),er.map.on("mouseup",on.mouseup),er.map.on("data",on.data),er.map.on("touchmove",on.touchmove),er.map.on("touchstart",on.touchstart),er.map.on("touchend",on.touchend),er.container.addEventListener("mouseout",on.mouseout),er.options.keybindings&&(er.container.addEventListener("keydown",on.keydown),er.container.addEventListener("keyup",on.keyup))},removeEventListeners:function(){er.map.off("mousemove",on.mousemove),er.map.off("mousedown",on.mousedown),er.map.off("mouseup",on.mouseup),er.map.off("data",on.data),er.map.off("touchmove",on.touchmove),er.map.off("touchstart",on.touchstart),er.map.off("touchend",on.touchend),er.container.removeEventListener("mouseout",on.mouseout),er.options.keybindings&&(er.container.removeEventListener("keydown",on.keydown),er.container.removeEventListener("keyup",on.keyup))},trash:function(Mr){ti.trash(Mr)},combineFeatures:function(){ti.combineFeatures()},uncombineFeatures:function(){ti.uncombineFeatures()},getMode:function(){return kr}}})(ee),ee.ui=(function(er){var Yr={},tn=null,Wr={mode:null,feature:null,mouse:null},on={mode:null,feature:null,mouse:null};function kr(Mr){on=vr(on,Mr)}function ti(){var Mr,fn;if(er.container){var mn=[],hi=[];br.forEach((function($i){on[$i]!==Wr[$i]&&(mn.push($i+"-"+Wr[$i]),on[$i]!==null&&hi.push($i+"-"+on[$i]))})),mn.length>0&&(Mr=er.container.classList).remove.apply(Mr,mn),hi.length>0&&(fn=er.container.classList).add.apply(fn,hi),Wr=vr(Wr,on)}}function Ri(Mr,fn){fn===void 0&&(fn={});var mn=document.createElement("button");return mn.className=m.CONTROL_BUTTON+" "+fn.className,mn.setAttribute("title",fn.title),fn.container.appendChild(mn),mn.addEventListener("click",(function(hi){if(hi.preventDefault(),hi.stopPropagation(),hi.target===tn)return $n(),void fn.onDeactivate();_n(Mr),fn.onActivate()}),!0),mn}function $n(){tn&&(tn.classList.remove(m.ACTIVE_BUTTON),tn=null)}function _n(Mr){$n();var fn=Yr[Mr];fn&&fn&&Mr!=="trash"&&(fn.classList.add(m.ACTIVE_BUTTON),tn=fn)}return{setActiveButton:_n,queueMapClasses:kr,updateMapClasses:ti,clearMapClasses:function(){kr({mode:null,feature:null,mouse:null}),ti()},addButtons:function(){var Mr=er.options.controls,fn=document.createElement("div");return fn.className=m.CONTROL_GROUP+" "+m.CONTROL_BASE,Mr&&(Mr[E.LINE]&&(Yr[E.LINE]=Ri(E.LINE,{container:fn,className:m.CONTROL_BUTTON_LINE,title:"LineString tool "+(er.options.keybindings?"(l)":""),onActivate:function(){return er.events.changeMode(A.DRAW_LINE_STRING)},onDeactivate:function(){return er.events.trash()}})),Mr[E.POLYGON]&&(Yr[E.POLYGON]=Ri(E.POLYGON,{container:fn,className:m.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(er.options.keybindings?"(p)":""),onActivate:function(){return er.events.changeMode(A.DRAW_POLYGON)},onDeactivate:function(){return er.events.trash()}})),Mr[E.POINT]&&(Yr[E.POINT]=Ri(E.POINT,{container:fn,className:m.CONTROL_BUTTON_POINT,title:"Marker tool "+(er.options.keybindings?"(m)":""),onActivate:function(){return er.events.changeMode(A.DRAW_POINT)},onDeactivate:function(){return er.events.trash()}})),Mr.trash&&(Yr.trash=Ri("trash",{container:fn,className:m.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){er.events.trash()}})),Mr.combine_features&&(Yr.combine_features=Ri("combineFeatures",{container:fn,className:m.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){er.events.combineFeatures()}})),Mr.uncombine_features&&(Yr.uncombine_features=Ri("uncombineFeatures",{container:fn,className:m.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){er.events.uncombineFeatures()}}))),fn},removeButtons:function(){Object.keys(Yr).forEach((function(Mr){var fn=Yr[Mr];fn.parentNode&&fn.parentNode.removeChild(fn),delete Yr[Mr]}))}}})(ee),ee.container=Vt.getContainer(),ee.store=new Jt(ee),pe=ee.ui.addButtons(),ee.options.boxSelect&&(ee.boxZoomInitial=Vt.boxZoom.isEnabled(),Vt.boxZoom.disable(),Vt.dragPan.disable(),Vt.dragPan.enable()),Vt.loaded()?It.connect():(Vt.on("load",It.connect),Ke=setInterval((function(){Vt.loaded()&&It.connect()}),16)),ee.events.start(),pe},addLayers:function(){ee.map.addSource(b.COLD,{data:{type:T.FEATURE_COLLECTION,features:[]},type:"geojson"}),ee.map.addSource(b.HOT,{data:{type:T.FEATURE_COLLECTION,features:[]},type:"geojson"}),ee.options.styles.forEach((function(Vt){ee.map.addLayer(Vt)})),ee.store.setDirty(!0),ee.store.render()},removeLayers:function(){ee.options.styles.forEach((function(Vt){ee.map.getLayer(Vt.id)&&ee.map.removeLayer(Vt.id)})),ee.map.getSource(b.COLD)&&ee.map.removeSource(b.COLD),ee.map.getSource(b.HOT)&&ee.map.removeSource(b.HOT)}};return ee.setup=It,It}var Cr=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function Tr(ee){return function(pe){var Ke=pe.featureTarget;return!!Ke&&!!Ke.properties&&Ke.properties.meta===ee}}function Qt(ee){return!!ee.originalEvent&&!!ee.originalEvent.shiftKey&&ee.originalEvent.button===0}function at(ee){return!!ee.featureTarget&&!!ee.featureTarget.properties&&ee.featureTarget.properties.active===O.ACTIVE&&ee.featureTarget.properties.meta===N.FEATURE}function ke(ee){return!!ee.featureTarget&&!!ee.featureTarget.properties&&ee.featureTarget.properties.active===O.INACTIVE&&ee.featureTarget.properties.meta===N.FEATURE}function be(ee){return ee.featureTarget===void 0}function je(ee){return!!ee.featureTarget&&!!ee.featureTarget.properties&&ee.featureTarget.properties.meta===N.FEATURE}function qe(ee){var pe=ee.featureTarget;return!!pe&&!!pe.properties&&pe.properties.meta===N.VERTEX}function We(ee){return!!ee.originalEvent&&ee.originalEvent.shiftKey===!0}function Lt(ee){return ee.keyCode===27}function Et(ee){return ee.keyCode===13}var mt=Object.freeze({__proto__:null,isOfMetaType:Tr,isShiftMousedown:Qt,isActiveFeature:at,isInactiveFeature:ke,noTarget:be,isFeature:je,isVertex:qe,isShiftDown:We,isEscapeKey:Lt,isEnterKey:Et,isTrue:function(){return!0}}),ct=Kt;function Kt(ee,pe){this.x=ee,this.y=pe}Kt.prototype={clone:function(){return new Kt(this.x,this.y)},add:function(ee){return this.clone()._add(ee)},sub:function(ee){return this.clone()._sub(ee)},multByPoint:function(ee){return this.clone()._multByPoint(ee)},divByPoint:function(ee){return this.clone()._divByPoint(ee)},mult:function(ee){return this.clone()._mult(ee)},div:function(ee){return this.clone()._div(ee)},rotate:function(ee){return this.clone()._rotate(ee)},rotateAround:function(ee,pe){return this.clone()._rotateAround(ee,pe)},matMult:function(ee){return this.clone()._matMult(ee)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(ee){return this.x===ee.x&&this.y===ee.y},dist:function(ee){return Math.sqrt(this.distSqr(ee))},distSqr:function(ee){var pe=ee.x-this.x,Ke=ee.y-this.y;return pe*pe+Ke*Ke},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(ee){return Math.atan2(this.y-ee.y,this.x-ee.x)},angleWith:function(ee){return this.angleWithSep(ee.x,ee.y)},angleWithSep:function(ee,pe){return Math.atan2(this.x*pe-this.y*ee,this.x*ee+this.y*pe)},_matMult:function(ee){var pe=ee[0]*this.x+ee[1]*this.y,Ke=ee[2]*this.x+ee[3]*this.y;return this.x=pe,this.y=Ke,this},_add:function(ee){return this.x+=ee.x,this.y+=ee.y,this},_sub:function(ee){return this.x-=ee.x,this.y-=ee.y,this},_mult:function(ee){return this.x*=ee,this.y*=ee,this},_div:function(ee){return this.x/=ee,this.y/=ee,this},_multByPoint:function(ee){return this.x*=ee.x,this.y*=ee.y,this},_divByPoint:function(ee){return this.x/=ee.x,this.y/=ee.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var ee=this.y;return this.y=this.x,this.x=-ee,this},_rotate:function(ee){var pe=Math.cos(ee),Ke=Math.sin(ee),It=pe*this.x-Ke*this.y,Vt=Ke*this.x+pe*this.y;return this.x=It,this.y=Vt,this},_rotateAround:function(ee,pe){var Ke=Math.cos(ee),It=Math.sin(ee),Vt=pe.x+Ke*(this.x-pe.x)-It*(this.y-pe.y),$t=pe.y+It*(this.x-pe.x)+Ke*(this.y-pe.y);return this.x=Vt,this.y=$t,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Kt.convert=function(ee){return ee instanceof Kt?ee:Array.isArray(ee)?new Kt(ee[0],ee[1]):ee};var qt=n(ct);function Ir(ee,pe){var Ke=pe.getBoundingClientRect();return new qt(ee.clientX-Ke.left-(pe.clientLeft||0),ee.clientY-Ke.top-(pe.clientTop||0))}function Ar(ee,pe,Ke,It){return{type:T.FEATURE,properties:{meta:N.VERTEX,parent:ee,coord_path:Ke,active:It?O.ACTIVE:O.INACTIVE},geometry:{type:T.POINT,coordinates:pe}}}function $r(ee,pe,Ke){var It=pe.geometry.coordinates,Vt=Ke.geometry.coordinates;if(It[1]>85||It[1]<j||Vt[1]>85||Vt[1]<j)return null;var $t={lng:(It[0]+Vt[0])/2,lat:(It[1]+Vt[1])/2};return{type:T.FEATURE,properties:{meta:N.MIDPOINT,parent:ee,lng:$t.lng,lat:$t.lat,coord_path:Ke.properties.coord_path},geometry:{type:T.POINT,coordinates:[$t.lng,$t.lat]}}}function hn(ee,pe,Ke){pe===void 0&&(pe={}),Ke===void 0&&(Ke=null);var It,Vt=ee.geometry,$t=Vt.type,er=Vt.coordinates,Yr=ee.properties&&ee.properties.id,tn=[];function Wr(kr,ti){var Ri="",$n=null;kr.forEach((function(_n,Mr){var fn=ti!=null?ti+"."+Mr:String(Mr),mn=Ar(Yr,_n,fn,on(fn));if(pe.midpoints&&$n){var hi=$r(Yr,$n,mn);hi&&tn.push(hi)}$n=mn;var $i=JSON.stringify(_n);Ri!==$i&&tn.push(mn),Mr===0&&(Ri=$i)}))}function on(kr){return!!pe.selectedPaths&&pe.selectedPaths.indexOf(kr)!==-1}return $t===T.POINT?tn.push(Ar(Yr,er,Ke,on(Ke))):$t===T.POLYGON?er.forEach((function(kr,ti){Wr(kr,Ke!==null?Ke+"."+ti:String(ti))})):$t===T.LINE_STRING?Wr(er,Ke):$t.indexOf(T.MULTI_PREFIX)===0&&(It=$t.replace(T.MULTI_PREFIX,""),er.forEach((function(kr,ti){var Ri={type:T.FEATURE,properties:ee.properties,geometry:{type:It,coordinates:kr}};tn=tn.concat(hn(Ri,pe,ti))}))),tn}var zr={enable:function(ee){setTimeout((function(){ee.map&&ee.map.doubleClickZoom&&ee._ctx&&ee._ctx.store&&ee._ctx.store.getInitialConfigValue&&ee._ctx.store.getInitialConfigValue("doubleClickZoom")&&ee.map.doubleClickZoom.enable()}),0)},disable:function(ee){setTimeout((function(){ee.map&&ee.map.doubleClickZoom&&ee.map.doubleClickZoom.disable()}),0)}},Mt={exports:{}},en=function(ee){if(!ee||!ee.type)return null;var pe=jn[ee.type];if(!pe)return null;if(pe==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:ee}]};if(pe==="feature")return{type:"FeatureCollection",features:[ee]};if(pe==="featurecollection")return ee},jn={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Qr=n(en),nr=Object.freeze({__proto__:null,default:function ee(pe){switch(pe&&pe.type||null){case"FeatureCollection":return pe.features=pe.features.reduce((function(Ke,It){return Ke.concat(ee(It))}),[]),pe;case"Feature":return pe.geometry?ee(pe.geometry).map((function(Ke){var It={type:"Feature",properties:JSON.parse(JSON.stringify(pe.properties)),geometry:Ke};return pe.id!==void 0&&(It.id=pe.id),It})):[pe];case"MultiPoint":return pe.coordinates.map((function(Ke){return{type:"Point",coordinates:Ke}}));case"MultiPolygon":return pe.coordinates.map((function(Ke){return{type:"Polygon",coordinates:Ke}}));case"MultiLineString":return pe.coordinates.map((function(Ke){return{type:"LineString",coordinates:Ke}}));case"GeometryCollection":return pe.geometries.map(ee).reduce((function(Ke,It){return Ke.concat(It)}),[]);case"Point":case"Polygon":case"LineString":return[pe]}}}),oi=en,un=i(nr),Kn=function(ee){return(function pe(Ke){return Array.isArray(Ke)&&Ke.length&&typeof Ke[0]=="number"?[Ke]:Ke.reduce((function(It,Vt){return Array.isArray(Vt)&&Array.isArray(Vt[0])?It.concat(pe(Vt)):(It.push(Vt),It)}),[])})(ee)};un instanceof Function||(un=un.default);var Me={exports:{}},He=Me.exports=function(ee){return new Tt(ee)};function Tt(ee){this.value=ee}function Wt(ee,pe,Ke){var It=[],Vt=[],$t=!0;return(function er(Yr){var tn=Ke?Ut(Yr):Yr,Wr={},on=!0,kr={node:tn,node_:Yr,path:[].concat(It),parent:Vt[Vt.length-1],parents:Vt,key:It.slice(-1)[0],isRoot:It.length===0,level:It.length,circular:null,update:function($n,_n){kr.isRoot||(kr.parent.node[kr.key]=$n),kr.node=$n,_n&&(on=!1)},delete:function($n){delete kr.parent.node[kr.key],$n&&(on=!1)},remove:function($n){Bi(kr.parent.node)?kr.parent.node.splice(kr.key,1):delete kr.parent.node[kr.key],$n&&(on=!1)},keys:null,before:function($n){Wr.before=$n},after:function($n){Wr.after=$n},pre:function($n){Wr.pre=$n},post:function($n){Wr.post=$n},stop:function(){$t=!1},block:function(){on=!1}};if(!$t)return kr;function ti(){if(typeof kr.node=="object"&&kr.node!==null){kr.keys&&kr.node_===kr.node||(kr.keys=Xr(kr.node)),kr.isLeaf=kr.keys.length==0;for(var $n=0;$n<Vt.length;$n++)if(Vt[$n].node_===Yr){kr.circular=Vt[$n];break}}else kr.isLeaf=!0,kr.keys=null;kr.notLeaf=!kr.isLeaf,kr.notRoot=!kr.isRoot}ti();var Ri=pe.call(kr,kr.node);return Ri!==void 0&&kr.update&&kr.update(Ri),Wr.before&&Wr.before.call(kr,kr.node),on&&(typeof kr.node!="object"||kr.node===null||kr.circular||(Vt.push(kr),ti(),Ci(kr.keys,(function($n,_n){It.push($n),Wr.pre&&Wr.pre.call(kr,kr.node[$n],$n);var Mr=er(kr.node[$n]);Ke&&Fr.call(kr.node,$n)&&(kr.node[$n]=Mr.node),Mr.isLast=_n==kr.keys.length-1,Mr.isFirst=_n==0,Wr.post&&Wr.post.call(kr,Mr),It.pop()})),Vt.pop()),Wr.after&&Wr.after.call(kr,kr.node)),kr})(ee).node}function Ut(ee){if(typeof ee=="object"&&ee!==null){var pe;if(Bi(ee))pe=[];else if(Nn(ee)==="[object Date]")pe=new Date(ee.getTime?ee.getTime():ee);else if((function(Vt){return Nn(Vt)==="[object RegExp]"})(ee))pe=new RegExp(ee);else if((function(Vt){return Nn(Vt)==="[object Error]"})(ee))pe={message:ee.message};else if((function(Vt){return Nn(Vt)==="[object Boolean]"})(ee))pe=new Boolean(ee);else if((function(Vt){return Nn(Vt)==="[object Number]"})(ee))pe=new Number(ee);else if((function(Vt){return Nn(Vt)==="[object String]"})(ee))pe=new String(ee);else if(Object.create&&Object.getPrototypeOf)pe=Object.create(Object.getPrototypeOf(ee));else if(ee.constructor===Object)pe={};else{var Ke=ee.constructor&&ee.constructor.prototype||ee.__proto__||{},It=function(){};It.prototype=Ke,pe=new It}return Ci(Xr(ee),(function(Vt){pe[Vt]=ee[Vt]})),pe}return ee}Tt.prototype.get=function(ee){for(var pe=this.value,Ke=0;Ke<ee.length;Ke++){var It=ee[Ke];if(!pe||!Fr.call(pe,It)){pe=void 0;break}pe=pe[It]}return pe},Tt.prototype.has=function(ee){for(var pe=this.value,Ke=0;Ke<ee.length;Ke++){var It=ee[Ke];if(!pe||!Fr.call(pe,It))return!1;pe=pe[It]}return!0},Tt.prototype.set=function(ee,pe){for(var Ke=this.value,It=0;It<ee.length-1;It++){var Vt=ee[It];Fr.call(Ke,Vt)||(Ke[Vt]={}),Ke=Ke[Vt]}return Ke[ee[It]]=pe,pe},Tt.prototype.map=function(ee){return Wt(this.value,ee,!0)},Tt.prototype.forEach=function(ee){return this.value=Wt(this.value,ee,!1),this.value},Tt.prototype.reduce=function(ee,pe){var Ke=arguments.length===1,It=Ke?this.value:pe;return this.forEach((function(Vt){this.isRoot&&Ke||(It=ee.call(this,It,Vt))})),It},Tt.prototype.paths=function(){var ee=[];return this.forEach((function(pe){ee.push(this.path)})),ee},Tt.prototype.nodes=function(){var ee=[];return this.forEach((function(pe){ee.push(this.node)})),ee},Tt.prototype.clone=function(){var ee=[],pe=[];return(function Ke(It){for(var Vt=0;Vt<ee.length;Vt++)if(ee[Vt]===It)return pe[Vt];if(typeof It=="object"&&It!==null){var $t=Ut(It);return ee.push(It),pe.push($t),Ci(Xr(It),(function(er){$t[er]=Ke(It[er])})),ee.pop(),pe.pop(),$t}return It})(this.value)};var Xr=Object.keys||function(ee){var pe=[];for(var Ke in ee)pe.push(Ke);return pe};function Nn(ee){return Object.prototype.toString.call(ee)}var Bi=Array.isArray||function(ee){return Object.prototype.toString.call(ee)==="[object Array]"},Ci=function(ee,pe){if(ee.forEach)return ee.forEach(pe);for(var Ke=0;Ke<ee.length;Ke++)pe(ee[Ke],Ke,ee)};Ci(Xr(Tt.prototype),(function(ee){He[ee]=function(pe){var Ke=[].slice.call(arguments,1),It=new Tt(pe);return It[ee].apply(It,Ke)}}));var Fr=Object.hasOwnProperty||function(ee,pe){return pe in ee},Mn=Me.exports,Bn=ei;function ei(ee){if(!(this instanceof ei))return new ei(ee);this._bbox=ee||[1/0,1/0,-1/0,-1/0],this._valid=!!ee}ei.prototype.include=function(ee){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],ee[0]),this._bbox[1]=Math.min(this._bbox[1],ee[1]),this._bbox[2]=Math.max(this._bbox[2],ee[0]),this._bbox[3]=Math.max(this._bbox[3],ee[1]),this},ei.prototype.equals=function(ee){var pe;return pe=ee instanceof ei?ee.bbox():ee,this._bbox[0]==pe[0]&&this._bbox[1]==pe[1]&&this._bbox[2]==pe[2]&&this._bbox[3]==pe[3]},ei.prototype.center=function(ee){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},ei.prototype.union=function(ee){var pe;return this._valid=!0,pe=ee instanceof ei?ee.bbox():ee,this._bbox[0]=Math.min(this._bbox[0],pe[0]),this._bbox[1]=Math.min(this._bbox[1],pe[1]),this._bbox[2]=Math.max(this._bbox[2],pe[2]),this._bbox[3]=Math.max(this._bbox[3],pe[3]),this},ei.prototype.bbox=function(){return this._valid?this._bbox:null},ei.prototype.contains=function(ee){if(!ee)return this._fastContains();if(!this._valid)return null;var pe=ee[0],Ke=ee[1];return this._bbox[0]<=pe&&this._bbox[1]<=Ke&&this._bbox[2]>=pe&&this._bbox[3]>=Ke},ei.prototype.intersect=function(ee){return this._valid?(pe=ee instanceof ei?ee.bbox():ee,!(this._bbox[0]>pe[2]||this._bbox[2]<pe[0]||this._bbox[3]<pe[1]||this._bbox[1]>pe[3])):null;var pe},ei.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var ee="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",ee)},ei.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var ua=function(ee){if(!ee)return[];var pe=un(oi(ee)),Ke=[];return pe.features.forEach((function(It){It.geometry&&(Ke=Ke.concat(Kn(It.geometry.coordinates)))})),Ke},fa=Mn,zn=Bn,La={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Gi=Object.keys(La);function fs(ee){for(var pe=zn(),Ke=ua(ee),It=0;It<Ke.length;It++)pe.include(Ke[It]);return pe}Mt.exports=function(ee){return fs(ee).bbox()},Mt.exports.polygon=function(ee){return fs(ee).polygon()},Mt.exports.bboxify=function(ee){return fa(ee).map((function(pe){pe&&Gi.some((function(Ke){return!!pe[Ke]&&La[Ke].indexOf(pe.type)!==-1}))&&(pe.bbox=fs(pe).bbox(),this.update(pe))}))};var Ca=n(Mt.exports),Mo=-90;function Ya(ee,pe){var Ke=Mo,It=90,Vt=Mo,$t=90,er=270,Yr=-270;ee.forEach((function(Wr){var on=Ca(Wr),kr=on[1],ti=on[3],Ri=on[0],$n=on[2];kr>Ke&&(Ke=kr),ti<It&&(It=ti),ti>Vt&&(Vt=ti),kr<$t&&($t=kr),Ri<er&&(er=Ri),$n>Yr&&(Yr=$n)}));var tn=pe;return Ke+tn.lat>85&&(tn.lat=85-Ke),Vt+tn.lat>90&&(tn.lat=90-Vt),It+tn.lat<-85&&(tn.lat=-85-It),$t+tn.lat<Mo&&(tn.lat=Mo-$t),er+tn.lng<=-270&&(tn.lng+=360*Math.ceil(Math.abs(tn.lng)/360)),Yr+tn.lng>=270&&(tn.lng-=360*Math.ceil(Math.abs(tn.lng)/360)),tn}function ol(ee,pe){var Ke=Ya(ee.map((function(It){return It.toGeoJSON()})),pe);ee.forEach((function(It){var Vt,$t=It.getCoordinates(),er=function(tn){var Wr={lng:tn[0]+Ke.lng,lat:tn[1]+Ke.lat};return[Wr.lng,Wr.lat]},Yr=function(tn){return tn.map((function(Wr){return er(Wr)}))};It.type===T.POINT?Vt=er($t):It.type===T.LINE_STRING||It.type===T.MULTI_POINT?Vt=$t.map(er):It.type===T.POLYGON||It.type===T.MULTI_LINE_STRING?Vt=$t.map(Yr):It.type===T.MULTI_POLYGON&&(Vt=$t.map((function(tn){return tn.map((function(Wr){return Yr(Wr)}))}))),It.incomingCoords(Vt)}))}var xi={onSetup:function(ee){var pe=this,Ke={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:ee.featureIds||[]};return this.setSelected(Ke.initiallySelectedFeatureIds.filter((function(It){return pe.getFeature(It)!==void 0}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),Ke},fireUpdate:function(){this.map.fire(M.UPDATE,{action:F.MOVE,features:this.getSelected().map((function(ee){return ee.toGeoJSON()}))})},fireActionable:function(){var ee=this,pe=this.getSelected(),Ke=pe.filter((function(Yr){return ee.isInstanceOf("MultiFeature",Yr)})),It=!1;if(pe.length>1){It=!0;var Vt=pe[0].type.replace("Multi","");pe.forEach((function(Yr){Yr.type.replace("Multi","")!==Vt&&(It=!1)}))}var $t=Ke.length>0,er=pe.length>0;this.setActionableState({combineFeatures:It,uncombineFeatures:$t,trash:er})},getUniqueIds:function(ee){return ee.length?ee.map((function(pe){return pe.properties.id})).filter((function(pe){return pe!==void 0})).reduce((function(pe,Ke){return pe.add(Ke),pe}),new W).values():[]},stopExtendedInteractions:function(ee){ee.boxSelectElement&&(ee.boxSelectElement.parentNode&&ee.boxSelectElement.parentNode.removeChild(ee.boxSelectElement),ee.boxSelectElement=null),this.map.dragPan.enable(),ee.boxSelecting=!1,ee.canBoxSelect=!1,ee.dragMoving=!1,ee.canDragMove=!1},onStop:function(){zr.enable(this)},onMouseMove:function(ee,pe){return je(pe)&&ee.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(ee),!0},onMouseOut:function(ee){return!ee.dragMoving||this.fireUpdate()}};xi.onTap=xi.onClick=function(ee,pe){return be(pe)?this.clickAnywhere(ee,pe):Tr(N.VERTEX)(pe)?this.clickOnVertex(ee,pe):je(pe)?this.clickOnFeature(ee,pe):void 0},xi.clickAnywhere=function(ee){var pe=this,Ke=this.getSelectedIds();Ke.length&&(this.clearSelectedFeatures(),Ke.forEach((function(It){return pe.doRender(It)}))),zr.enable(this),this.stopExtendedInteractions(ee)},xi.clickOnVertex=function(ee,pe){this.changeMode(A.DIRECT_SELECT,{featureId:pe.featureTarget.properties.parent,coordPath:pe.featureTarget.properties.coord_path,startPos:pe.lngLat}),this.updateUIClasses({mouse:x.MOVE})},xi.startOnActiveFeature=function(ee,pe){this.stopExtendedInteractions(ee),this.map.dragPan.disable(),this.doRender(pe.featureTarget.properties.id),ee.canDragMove=!0,ee.dragMoveLocation=pe.lngLat},xi.clickOnFeature=function(ee,pe){var Ke=this;zr.disable(this),this.stopExtendedInteractions(ee);var It=We(pe),Vt=this.getSelectedIds(),$t=pe.featureTarget.properties.id,er=this.isSelected($t);if(!It&&er&&this.getFeature($t).type!==T.POINT)return this.changeMode(A.DIRECT_SELECT,{featureId:$t});er&&It?(this.deselect($t),this.updateUIClasses({mouse:x.POINTER}),Vt.length===1&&zr.enable(this)):!er&&It?(this.select($t),this.updateUIClasses({mouse:x.MOVE})):er||It||(Vt.forEach((function(Yr){return Ke.doRender(Yr)})),this.setSelected($t),this.updateUIClasses({mouse:x.MOVE})),this.doRender($t)},xi.onMouseDown=function(ee,pe){return at(pe)?this.startOnActiveFeature(ee,pe):this.drawConfig.boxSelect&&Qt(pe)?this.startBoxSelect(ee,pe):void 0},xi.startBoxSelect=function(ee,pe){this.stopExtendedInteractions(ee),this.map.dragPan.disable(),ee.boxSelectStartLocation=Ir(pe.originalEvent,this.map.getContainer()),ee.canBoxSelect=!0},xi.onTouchStart=function(ee,pe){if(at(pe))return this.startOnActiveFeature(ee,pe)},xi.onDrag=function(ee,pe){return ee.canDragMove?this.dragMove(ee,pe):this.drawConfig.boxSelect&&ee.canBoxSelect?this.whileBoxSelect(ee,pe):void 0},xi.whileBoxSelect=function(ee,pe){ee.boxSelecting=!0,this.updateUIClasses({mouse:x.ADD}),ee.boxSelectElement||(ee.boxSelectElement=document.createElement("div"),ee.boxSelectElement.classList.add(m.BOX_SELECT),this.map.getContainer().appendChild(ee.boxSelectElement));var Ke=Ir(pe.originalEvent,this.map.getContainer()),It=Math.min(ee.boxSelectStartLocation.x,Ke.x),Vt=Math.max(ee.boxSelectStartLocation.x,Ke.x),$t=Math.min(ee.boxSelectStartLocation.y,Ke.y),er=Math.max(ee.boxSelectStartLocation.y,Ke.y),Yr="translate("+It+"px, "+$t+"px)";ee.boxSelectElement.style.transform=Yr,ee.boxSelectElement.style.WebkitTransform=Yr,ee.boxSelectElement.style.width=Vt-It+"px",ee.boxSelectElement.style.height=er-$t+"px"},xi.dragMove=function(ee,pe){ee.dragMoving=!0,pe.originalEvent.stopPropagation();var Ke={lng:pe.lngLat.lng-ee.dragMoveLocation.lng,lat:pe.lngLat.lat-ee.dragMoveLocation.lat};ol(this.getSelected(),Ke),ee.dragMoveLocation=pe.lngLat},xi.onTouchEnd=xi.onMouseUp=function(ee,pe){var Ke=this;if(ee.dragMoving)this.fireUpdate();else if(ee.boxSelecting){var It=[ee.boxSelectStartLocation,Ir(pe.originalEvent,this.map.getContainer())],Vt=this.featuresAt(null,It,"click"),$t=this.getUniqueIds(Vt).filter((function(er){return!Ke.isSelected(er)}));$t.length&&(this.select($t),$t.forEach((function(er){return Ke.doRender(er)})),this.updateUIClasses({mouse:x.MOVE}))}this.stopExtendedInteractions(ee)},xi.toDisplayFeatures=function(ee,pe,Ke){pe.properties.active=this.isSelected(pe.properties.id)?O.ACTIVE:O.INACTIVE,Ke(pe),this.fireActionable(),pe.properties.active===O.ACTIVE&&pe.geometry.type!==T.POINT&&hn(pe).forEach(Ke)},xi.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},xi.onCombineFeatures=function(){var ee=this.getSelected();if(!(ee.length===0||ee.length<2)){for(var pe=[],Ke=[],It=ee[0].type.replace("Multi",""),Vt=0;Vt<ee.length;Vt++){var $t=ee[Vt];if($t.type.replace("Multi","")!==It)return;$t.type.includes("Multi")?$t.getCoordinates().forEach((function(Yr){pe.push(Yr)})):pe.push($t.getCoordinates()),Ke.push($t.toGeoJSON())}if(Ke.length>1){var er=this.newFeature({type:T.FEATURE,properties:Ke[0].properties,geometry:{type:"Multi"+It,coordinates:pe}});this.addFeature(er),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([er.id]),this.map.fire(M.COMBINE_FEATURES,{createdFeatures:[er.toGeoJSON()],deletedFeatures:Ke})}this.fireActionable()}},xi.onUncombineFeatures=function(){var ee=this,pe=this.getSelected();if(pe.length!==0){for(var Ke=[],It=[],Vt=function(er){var Yr=pe[er];ee.isInstanceOf("MultiFeature",Yr)&&(Yr.getFeatures().forEach((function(tn){ee.addFeature(tn),tn.properties=Yr.properties,Ke.push(tn.toGeoJSON()),ee.select([tn.id])})),ee.deleteFeature(Yr.id,{silent:!0}),It.push(Yr.toGeoJSON()))},$t=0;$t<pe.length;$t++)Vt($t);Ke.length>1&&this.map.fire(M.UNCOMBINE_FEATURES,{createdFeatures:Ke,deletedFeatures:It}),this.fireActionable()}};var zi=Tr(N.VERTEX),Iu=Tr(N.MIDPOINT),ga={fireUpdate:function(){this.map.fire(M.UPDATE,{action:F.CHANGE_COORDINATES,features:this.getSelected().map((function(ee){return ee.toGeoJSON()}))})},fireActionable:function(ee){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:ee.selectedCoordPaths.length>0})},startDragging:function(ee,pe){this.map.dragPan.disable(),ee.canDragMove=!0,ee.dragMoveLocation=pe.lngLat},stopDragging:function(ee){this.map.dragPan.enable(),ee.dragMoving=!1,ee.canDragMove=!1,ee.dragMoveLocation=null},onVertex:function(ee,pe){this.startDragging(ee,pe);var Ke=pe.featureTarget.properties,It=ee.selectedCoordPaths.indexOf(Ke.coord_path);We(pe)||It!==-1?We(pe)&&It===-1&&ee.selectedCoordPaths.push(Ke.coord_path):ee.selectedCoordPaths=[Ke.coord_path];var Vt=this.pathsToCoordinates(ee.featureId,ee.selectedCoordPaths);this.setSelectedCoordinates(Vt)},onMidpoint:function(ee,pe){this.startDragging(ee,pe);var Ke=pe.featureTarget.properties;ee.feature.addCoordinate(Ke.coord_path,Ke.lng,Ke.lat),this.fireUpdate(),ee.selectedCoordPaths=[Ke.coord_path]},pathsToCoordinates:function(ee,pe){return pe.map((function(Ke){return{feature_id:ee,coord_path:Ke}}))},onFeature:function(ee,pe){ee.selectedCoordPaths.length===0?this.startDragging(ee,pe):this.stopDragging(ee)},dragFeature:function(ee,pe,Ke){ol(this.getSelected(),Ke),ee.dragMoveLocation=pe.lngLat},dragVertex:function(ee,pe,Ke){for(var It=ee.selectedCoordPaths.map((function(Yr){return ee.feature.getCoordinate(Yr)})),Vt=Ya(It.map((function(Yr){return{type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:Yr}}})),Ke),$t=0;$t<It.length;$t++){var er=It[$t];ee.feature.updateCoordinate(ee.selectedCoordPaths[$t],er[0]+Vt.lng,er[1]+Vt.lat)}},clickNoTarget:function(){this.changeMode(A.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(A.SIMPLE_SELECT)},clickActiveFeature:function(ee){ee.selectedCoordPaths=[],this.clearSelectedCoordinates(),ee.feature.changed()},onSetup:function(ee){var pe=ee.featureId,Ke=this.getFeature(pe);if(!Ke)throw new Error("You must provide a featureId to enter direct_select mode");if(Ke.type===T.POINT)throw new TypeError("direct_select mode doesn't handle point features");var It={featureId:pe,feature:Ke,dragMoveLocation:ee.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:ee.coordPath?[ee.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(pe,It.selectedCoordPaths)),this.setSelected(pe),zr.disable(this),this.setActionableState({trash:!0}),It},onStop:function(){zr.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(ee,pe,Ke){ee.featureId===pe.properties.id?(pe.properties.active=O.ACTIVE,Ke(pe),hn(pe,{map:this.map,midpoints:!0,selectedPaths:ee.selectedCoordPaths}).forEach(Ke)):(pe.properties.active=O.INACTIVE,Ke(pe)),this.fireActionable(ee)},onTrash:function(ee){ee.selectedCoordPaths.sort((function(pe,Ke){return Ke.localeCompare(pe,"en",{numeric:!0})})).forEach((function(pe){return ee.feature.removeCoordinate(pe)})),this.fireUpdate(),ee.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(ee),ee.feature.isValid()===!1&&(this.deleteFeature([ee.featureId]),this.changeMode(A.SIMPLE_SELECT,{}))},onMouseMove:function(ee,pe){var Ke=at(pe),It=zi(pe),Vt=Iu(pe),$t=ee.selectedCoordPaths.length===0;return Ke&&$t||It&&!$t?this.updateUIClasses({mouse:x.MOVE}):this.updateUIClasses({mouse:x.NONE}),(It||Ke||Vt)&&ee.dragMoving&&this.fireUpdate(),this.stopDragging(ee),!0},onMouseOut:function(ee){return ee.dragMoving&&this.fireUpdate(),!0}};ga.onTouchStart=ga.onMouseDown=function(ee,pe){return zi(pe)?this.onVertex(ee,pe):at(pe)?this.onFeature(ee,pe):Iu(pe)?this.onMidpoint(ee,pe):void 0},ga.onDrag=function(ee,pe){if(ee.canDragMove===!0){ee.dragMoving=!0,pe.originalEvent.stopPropagation();var Ke={lng:pe.lngLat.lng-ee.dragMoveLocation.lng,lat:pe.lngLat.lat-ee.dragMoveLocation.lat};ee.selectedCoordPaths.length>0?this.dragVertex(ee,pe,Ke):this.dragFeature(ee,pe,Ke),ee.dragMoveLocation=pe.lngLat}},ga.onClick=function(ee,pe){return be(pe)?this.clickNoTarget(ee,pe):at(pe)?this.clickActiveFeature(ee,pe):ke(pe)?this.clickInactive(ee,pe):void this.stopDragging(ee)},ga.onTap=function(ee,pe){return be(pe)?this.clickNoTarget(ee,pe):at(pe)?this.clickActiveFeature(ee,pe):ke(pe)?this.clickInactive(ee,pe):void 0},ga.onTouchEnd=ga.onMouseUp=function(ee){ee.dragMoving&&this.fireUpdate(),this.stopDragging(ee)};var Za={};function ds(ee,pe){return!!ee.lngLat&&ee.lngLat.lng===pe[0]&&ee.lngLat.lat===pe[1]}Za.onSetup=function(){var ee=this.newFeature({type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:[]}});return this.addFeature(ee),this.clearSelectedFeatures(),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(E.POINT),this.setActionableState({trash:!0}),{point:ee}},Za.stopDrawingAndRemove=function(ee){this.deleteFeature([ee.point.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)},Za.onTap=Za.onClick=function(ee,pe){this.updateUIClasses({mouse:x.MOVE}),ee.point.updateCoordinate("",pe.lngLat.lng,pe.lngLat.lat),this.map.fire(M.CREATE,{features:[ee.point.toGeoJSON()]}),this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.point.id]})},Za.onStop=function(ee){this.activateUIButton(),ee.point.getCoordinate().length||this.deleteFeature([ee.point.id],{silent:!0})},Za.toDisplayFeatures=function(ee,pe,Ke){var It=pe.properties.id===ee.point.id;if(pe.properties.active=It?O.ACTIVE:O.INACTIVE,!It)return Ke(pe)},Za.onTrash=Za.stopDrawingAndRemove,Za.onKeyUp=function(ee,pe){if(Lt(pe)||Et(pe))return this.stopDrawingAndRemove(ee,pe)};var Aa={onSetup:function(){var ee=this.newFeature({type:T.FEATURE,properties:{},geometry:{type:T.POLYGON,coordinates:[[]]}});return this.addFeature(ee),this.clearSelectedFeatures(),zr.disable(this),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(E.POLYGON),this.setActionableState({trash:!0}),{polygon:ee,currentVertexPosition:0}},clickAnywhere:function(ee,pe){if(ee.currentVertexPosition>0&&ds(pe,ee.polygon.coordinates[0][ee.currentVertexPosition-1]))return this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.polygon.id]});this.updateUIClasses({mouse:x.ADD}),ee.polygon.updateCoordinate("0."+ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),ee.currentVertexPosition++,ee.polygon.updateCoordinate("0."+ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat)},clickOnVertex:function(ee){return this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.polygon.id]})},onMouseMove:function(ee,pe){ee.polygon.updateCoordinate("0."+ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),qe(pe)&&this.updateUIClasses({mouse:x.POINTER})}};Aa.onTap=Aa.onClick=function(ee,pe){return qe(pe)?this.clickOnVertex(ee,pe):this.clickAnywhere(ee,pe)},Aa.onKeyUp=function(ee,pe){Lt(pe)?(this.deleteFeature([ee.polygon.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)):Et(pe)&&this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.polygon.id]})},Aa.onStop=function(ee){this.updateUIClasses({mouse:x.NONE}),zr.enable(this),this.activateUIButton(),this.getFeature(ee.polygon.id)!==void 0&&(ee.polygon.removeCoordinate("0."+ee.currentVertexPosition),ee.polygon.isValid()?this.map.fire(M.CREATE,{features:[ee.polygon.toGeoJSON()]}):(this.deleteFeature([ee.polygon.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT,{},{silent:!0})))},Aa.toDisplayFeatures=function(ee,pe,Ke){var It=pe.properties.id===ee.polygon.id;if(pe.properties.active=It?O.ACTIVE:O.INACTIVE,!It)return Ke(pe);if(pe.geometry.coordinates.length!==0){var Vt=pe.geometry.coordinates[0].length;if(!(Vt<3)){if(pe.properties.meta=N.FEATURE,Ke(Ar(ee.polygon.id,pe.geometry.coordinates[0][0],"0.0",!1)),Vt>3){var $t=pe.geometry.coordinates[0].length-3;Ke(Ar(ee.polygon.id,pe.geometry.coordinates[0][$t],"0."+$t,!1))}if(Vt<=4){var er=[[pe.geometry.coordinates[0][0][0],pe.geometry.coordinates[0][0][1]],[pe.geometry.coordinates[0][1][0],pe.geometry.coordinates[0][1][1]]];if(Ke({type:T.FEATURE,properties:pe.properties,geometry:{coordinates:er,type:T.LINE_STRING}}),Vt===3)return}return Ke(pe)}}},Aa.onTrash=function(ee){this.deleteFeature([ee.polygon.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)};var ps={onSetup:function(ee){var pe,Ke,It=(ee=ee||{}).featureId,Vt="forward";if(It){if(!(pe=this.getFeature(It)))throw new Error("Could not find a feature with the provided featureId");var $t=ee.from;if($t&&$t.type==="Feature"&&$t.geometry&&$t.geometry.type==="Point"&&($t=$t.geometry),$t&&$t.type==="Point"&&$t.coordinates&&$t.coordinates.length===2&&($t=$t.coordinates),!$t||!Array.isArray($t))throw new Error("Please use the `from` property to indicate which point to continue the line from");var er=pe.coordinates.length-1;if(pe.coordinates[er][0]===$t[0]&&pe.coordinates[er][1]===$t[1])Ke=er+1,pe.addCoordinate.apply(pe,[Ke].concat(pe.coordinates[er]));else{if(pe.coordinates[0][0]!==$t[0]||pe.coordinates[0][1]!==$t[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Vt="backwards",Ke=0,pe.addCoordinate.apply(pe,[Ke].concat(pe.coordinates[0]))}}else pe=this.newFeature({type:T.FEATURE,properties:{},geometry:{type:T.LINE_STRING,coordinates:[]}}),Ke=0,this.addFeature(pe);return this.clearSelectedFeatures(),zr.disable(this),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(E.LINE),this.setActionableState({trash:!0}),{line:pe,currentVertexPosition:Ke,direction:Vt}},clickAnywhere:function(ee,pe){if(ee.currentVertexPosition>0&&ds(pe,ee.line.coordinates[ee.currentVertexPosition-1])||ee.direction==="backwards"&&ds(pe,ee.line.coordinates[ee.currentVertexPosition+1]))return this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.line.id]});this.updateUIClasses({mouse:x.ADD}),ee.line.updateCoordinate(ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),ee.direction==="forward"?(ee.currentVertexPosition++,ee.line.updateCoordinate(ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat)):ee.line.addCoordinate(0,pe.lngLat.lng,pe.lngLat.lat)},clickOnVertex:function(ee){return this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.line.id]})},onMouseMove:function(ee,pe){ee.line.updateCoordinate(ee.currentVertexPosition,pe.lngLat.lng,pe.lngLat.lat),qe(pe)&&this.updateUIClasses({mouse:x.POINTER})}};ps.onTap=ps.onClick=function(ee,pe){if(qe(pe))return this.clickOnVertex(ee,pe);this.clickAnywhere(ee,pe)},ps.onKeyUp=function(ee,pe){Et(pe)?this.changeMode(A.SIMPLE_SELECT,{featureIds:[ee.line.id]}):Lt(pe)&&(this.deleteFeature([ee.line.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT))},ps.onStop=function(ee){zr.enable(this),this.activateUIButton(),this.getFeature(ee.line.id)!==void 0&&(ee.line.removeCoordinate(""+ee.currentVertexPosition),ee.line.isValid()?this.map.fire(M.CREATE,{features:[ee.line.toGeoJSON()]}):(this.deleteFeature([ee.line.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT,{},{silent:!0})))},ps.onTrash=function(ee){this.deleteFeature([ee.line.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)},ps.toDisplayFeatures=function(ee,pe,Ke){var It=pe.properties.id===ee.line.id;if(pe.properties.active=It?O.ACTIVE:O.INACTIVE,!It)return Ke(pe);pe.geometry.coordinates.length<2||(pe.properties.meta=N.FEATURE,Ke(Ar(ee.line.id,pe.geometry.coordinates[ee.direction==="forward"?pe.geometry.coordinates.length-2:1],""+(ee.direction==="forward"?pe.geometry.coordinates.length-2:1),!1)),Ke(pe))};var Ul={simple_select:xi,direct_select:ga,draw_point:Za,draw_polygon:Aa,draw_line_string:ps},Fa={defaultMode:A.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Cr,modes:Ul,controls:{},userProperties:!1},_a={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},xc={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function sl(ee,pe){return ee.map((function(Ke){return Ke.source?Ke:vr(Ke,{id:Ke.id+"."+pe,source:pe==="hot"?b.HOT:b.COLD})}))}var ts={exports:{}};(function(ee,pe){var Ke="__lodash_hash_undefined__",It=9007199254740991,Vt="[object Arguments]",$t="[object Array]",er="[object Boolean]",Yr="[object Date]",tn="[object Error]",Wr="[object Function]",on="[object Map]",kr="[object Number]",ti="[object Object]",Ri="[object Promise]",$n="[object RegExp]",_n="[object Set]",Mr="[object String]",fn="[object Symbol]",mn="[object WeakMap]",hi="[object ArrayBuffer]",$i="[object DataView]",ba=/^\[object .+?Constructor\]$/,wi=/^(?:0|[1-9]\d*)$/,fi={};fi["[object Float32Array]"]=fi["[object Float64Array]"]=fi["[object Int8Array]"]=fi["[object Int16Array]"]=fi["[object Int32Array]"]=fi["[object Uint8Array]"]=fi["[object Uint8ClampedArray]"]=fi["[object Uint16Array]"]=fi["[object Uint32Array]"]=!0,fi[Vt]=fi[$t]=fi[hi]=fi[er]=fi[$i]=fi[Yr]=fi[tn]=fi[Wr]=fi[on]=fi[kr]=fi[ti]=fi[$n]=fi[_n]=fi[Mr]=fi[mn]=!1;var Ts=typeof cg=="object"&&cg&&cg.Object===Object&&cg,Vs=typeof self=="object"&&self&&self.Object===Object&&self,Mi=Ts||Vs||Function("return this")(),Cs=pe&&!pe.nodeType&&pe,oa=Cs&&ee&&!ee.nodeType&&ee,ku=oa&&oa.exports===Cs,Ka=ku&&Ts.process,$s=(function(){try{return Ka&&Ka.binding&&Ka.binding("util")}catch{}})(),Vo=$s&&$s.isTypedArray;function Ru(tr,mr){for(var dn=-1,In=tr==null?0:tr.length;++dn<In;)if(mr(tr[dn],dn,tr))return!0;return!1}function Mu(tr){var mr=-1,dn=Array(tr.size);return tr.forEach((function(In,vi){dn[++mr]=[vi,In]})),dn}function go(tr){var mr=-1,dn=Array(tr.size);return tr.forEach((function(In){dn[++mr]=In})),dn}var ji,qs,ii,ri=Array.prototype,Do=Function.prototype,ai=Object.prototype,ue=Mi["__core-js_shared__"],Ge=Do.toString,bt=ai.hasOwnProperty,Bt=(ji=/[^.]+$/.exec(ue&&ue.keys&&ue.keys.IE_PROTO||""))?"Symbol(src)_1."+ji:"",sr=ai.toString,Nr=RegExp("^"+Ge.call(bt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zr=ku?Mi.Buffer:void 0,Ln=Mi.Symbol,qn=Mi.Uint8Array,Un=ai.propertyIsEnumerable,ui=ri.splice,Hn=Ln?Ln.toStringTag:void 0,Ui=Object.getOwnPropertySymbols,Xi=Zr?Zr.isBuffer:void 0,ra=(qs=Object.keys,ii=Object,function(tr){return qs(ii(tr))}),Si=mo(Mi,"DataView"),Ia=mo(Mi,"Map"),za=mo(Mi,"Promise"),Hs=mo(Mi,"Set"),ll=mo(Mi,"WeakMap"),Ws=mo(Object,"create"),$o=Zs(Si),Gs=Zs(Ia),Pa=Zs(za),Xs=Zs(Hs),Il=Zs(ll),gs=Ln?Ln.prototype:void 0,Di=gs?gs.valueOf:void 0;function qo(tr){var mr=-1,dn=tr==null?0:tr.length;for(this.clear();++mr<dn;){var In=tr[mr];this.set(In[0],In[1])}}function Da(tr){var mr=-1,dn=tr==null?0:tr.length;for(this.clear();++mr<dn;){var In=tr[mr];this.set(In[0],In[1])}}function ns(tr){var mr=-1,dn=tr==null?0:tr.length;for(this.clear();++mr<dn;){var In=tr[mr];this.set(In[0],In[1])}}function As(tr){var mr=-1,dn=tr==null?0:tr.length;for(this.__data__=new ns;++mr<dn;)this.add(tr[mr])}function Ja(tr){var mr=this.__data__=new Da(tr);this.size=mr.size}function rc(tr,mr){var dn=Vl(tr),In=!dn&&Va(tr),vi=!dn&&!In&&cl(tr),Pn=!dn&&!In&&!vi&&Hl(tr),I=dn||In||vi||Pn,y=I?(function($,ne){for(var ye=-1,Oe=Array($);++ye<$;)Oe[ye]=ne(ye);return Oe})(tr.length,String):[],_=y.length;for(var P in tr)!bt.call(tr,P)||I&&(P=="length"||vi&&(P=="offset"||P=="parent")||Pn&&(P=="buffer"||P=="byteLength"||P=="byteOffset")||hu(P,_))||y.push(P);return y}function uu(tr,mr){for(var dn=tr.length;dn--;)if(ms(tr[dn][0],mr))return dn;return-1}function Ys(tr){return tr==null?tr===void 0?"[object Undefined]":"[object Null]":Hn&&Hn in Object(tr)?(function(mr){var dn=bt.call(mr,Hn),In=mr[Hn];try{mr[Hn]=void 0;var vi=!0}catch{}var Pn=sr.call(mr);return vi&&(dn?mr[Hn]=In:delete mr[Hn]),Pn})(tr):(function(mr){return sr.call(mr)})(tr)}function ja(tr){return fl(tr)&&Ys(tr)==Vt}function Is(tr,mr,dn,In,vi){return tr===mr||(tr==null||mr==null||!fl(tr)&&!fl(mr)?tr!=tr&&mr!=mr:(function(Pn,I,y,_,P,$){var ne=Vl(Pn),ye=Vl(I),Oe=ne?$t:Ua(Pn),tt=ye?$t:Ua(I),ht=(Oe=Oe==Vt?ti:Oe)==ti,rr=(tt=tt==Vt?ti:tt)==ti,ur=Oe==tt;if(ur&&cl(Pn)){if(!cl(I))return!1;ne=!0,ht=!1}if(ur&&!ht)return $||($=new Ja),ne||Hl(Pn)?ul(Pn,I,y,_,P,$):(function(Fn,En,na,ca,so,ka,Ho){switch(na){case $i:if(Fn.byteLength!=En.byteLength||Fn.byteOffset!=En.byteOffset)return!1;Fn=Fn.buffer,En=En.buffer;case hi:return!(Fn.byteLength!=En.byteLength||!ka(new qn(Fn),new qn(En)));case er:case Yr:case kr:return ms(+Fn,+En);case tn:return Fn.name==En.name&&Fn.message==En.message;case $n:case Mr:return Fn==En+"";case on:var Ks=Mu;case _n:var Pl=1&ca;if(Ks||(Ks=go),Fn.size!=En.size&&!Pl)return!1;var fu=Ho.get(Fn);if(fu)return fu==En;ca|=2,Ho.set(Fn,En);var du=ul(Ks(Fn),Ks(En),ca,so,ka,Ho);return Ho.delete(Fn),du;case fn:if(Di)return Di.call(Fn)==Di.call(En)}return!1})(Pn,I,Oe,y,_,P,$);if(!(1&y)){var qr=ht&&bt.call(Pn,"__wrapped__"),bn=rr&&bt.call(I,"__wrapped__");if(qr||bn){var Dn=qr?Pn.value():Pn,Xn=bn?I.value():I;return $||($=new Ja),P(Dn,Xn,y,_,$)}}return ur?($||($=new Ja),(function(Fn,En,na,ca,so,ka){var Ho=1&na,Ks=cu(Fn),Pl=Ks.length,fu=cu(En).length;if(Pl!=fu&&!Ho)return!1;for(var du=Pl;du--;){var Ps=Ks[du];if(!(Ho?Ps in En:bt.call(En,Ps)))return!1}var Wl=ka.get(Fn);if(Wl&&ka.get(En))return Wl==En;var Gl=!0;ka.set(Fn,En),ka.set(En,Fn);for(var Eo=Ho;++du<Pl;){var ni=Fn[Ps=Ks[du]],Nu=En[Ps];if(ca)var Qh=Ho?ca(Nu,ni,Ps,En,Fn,ka):ca(ni,Nu,Ps,Fn,En,ka);if(!(Qh===void 0?ni===Nu||so(ni,Nu,na,ca,ka):Qh)){Gl=!1;break}Eo||(Eo=Ps=="constructor")}if(Gl&&!Eo){var yh=Fn.constructor,pu=En.constructor;yh==pu||!("constructor"in Fn)||!("constructor"in En)||typeof yh=="function"&&yh instanceof yh&&typeof pu=="function"&&pu instanceof pu||(Gl=!1)}return ka.delete(Fn),ka.delete(En),Gl})(Pn,I,y,_,P,$)):!1})(tr,mr,dn,In,Is,vi))}function nc(tr){return!(!ql(tr)||(function(mr){return!!Bt&&Bt in mr})(tr))&&(hl(tr)?Nr:ba).test(Zs(tr))}function ic(tr){if(dn=(mr=tr)&&mr.constructor,In=typeof dn=="function"&&dn.prototype||ai,mr!==In)return ra(tr);var mr,dn,In,vi=[];for(var Pn in Object(tr))bt.call(tr,Pn)&&Pn!="constructor"&&vi.push(Pn);return vi}function ul(tr,mr,dn,In,vi,Pn){var I=1&dn,y=tr.length,_=mr.length;if(y!=_&&!(I&&_>y))return!1;var P=Pn.get(tr);if(P&&Pn.get(mr))return P==mr;var $=-1,ne=!0,ye=2&dn?new As:void 0;for(Pn.set(tr,mr),Pn.set(mr,tr);++$<y;){var Oe=tr[$],tt=mr[$];if(In)var ht=I?In(tt,Oe,$,mr,tr,Pn):In(Oe,tt,$,tr,mr,Pn);if(ht!==void 0){if(ht)continue;ne=!1;break}if(ye){if(!Ru(mr,(function(rr,ur){if(qr=ur,!ye.has(qr)&&(Oe===rr||vi(Oe,rr,dn,In,Pn)))return ye.push(ur);var qr}))){ne=!1;break}}else if(Oe!==tt&&!vi(Oe,tt,dn,In,Pn)){ne=!1;break}}return Pn.delete(tr),Pn.delete(mr),ne}function cu(tr){return(function(mr,dn,In){var vi=dn(mr);return Vl(mr)?vi:(function(Pn,I){for(var y=-1,_=I.length,P=Pn.length;++y<_;)Pn[P+y]=I[y];return Pn})(vi,In(mr))})(tr,Ou,Du)}function Oo(tr,mr){var dn,In,vi=tr.__data__;return((In=typeof(dn=mr))=="string"||In=="number"||In=="symbol"||In=="boolean"?dn!=="__proto__":dn===null)?vi[typeof mr=="string"?"string":"hash"]:vi.map}function mo(tr,mr){var dn=(function(In,vi){return In?.[vi]})(tr,mr);return nc(dn)?dn:void 0}qo.prototype.clear=function(){this.__data__=Ws?Ws(null):{},this.size=0},qo.prototype.delete=function(tr){var mr=this.has(tr)&&delete this.__data__[tr];return this.size-=mr?1:0,mr},qo.prototype.get=function(tr){var mr=this.__data__;if(Ws){var dn=mr[tr];return dn===Ke?void 0:dn}return bt.call(mr,tr)?mr[tr]:void 0},qo.prototype.has=function(tr){var mr=this.__data__;return Ws?mr[tr]!==void 0:bt.call(mr,tr)},qo.prototype.set=function(tr,mr){var dn=this.__data__;return this.size+=this.has(tr)?0:1,dn[tr]=Ws&&mr===void 0?Ke:mr,this},Da.prototype.clear=function(){this.__data__=[],this.size=0},Da.prototype.delete=function(tr){var mr=this.__data__,dn=uu(mr,tr);return!(dn<0)&&(dn==mr.length-1?mr.pop():ui.call(mr,dn,1),--this.size,!0)},Da.prototype.get=function(tr){var mr=this.__data__,dn=uu(mr,tr);return dn<0?void 0:mr[dn][1]},Da.prototype.has=function(tr){return uu(this.__data__,tr)>-1},Da.prototype.set=function(tr,mr){var dn=this.__data__,In=uu(dn,tr);return In<0?(++this.size,dn.push([tr,mr])):dn[In][1]=mr,this},ns.prototype.clear=function(){this.size=0,this.__data__={hash:new qo,map:new(Ia||Da),string:new qo}},ns.prototype.delete=function(tr){var mr=Oo(this,tr).delete(tr);return this.size-=mr?1:0,mr},ns.prototype.get=function(tr){return Oo(this,tr).get(tr)},ns.prototype.has=function(tr){return Oo(this,tr).has(tr)},ns.prototype.set=function(tr,mr){var dn=Oo(this,tr),In=dn.size;return dn.set(tr,mr),this.size+=dn.size==In?0:1,this},As.prototype.add=As.prototype.push=function(tr){return this.__data__.set(tr,Ke),this},As.prototype.has=function(tr){return this.__data__.has(tr)},Ja.prototype.clear=function(){this.__data__=new Da,this.size=0},Ja.prototype.delete=function(tr){var mr=this.__data__,dn=mr.delete(tr);return this.size=mr.size,dn},Ja.prototype.get=function(tr){return this.__data__.get(tr)},Ja.prototype.has=function(tr){return this.__data__.has(tr)},Ja.prototype.set=function(tr,mr){var dn=this.__data__;if(dn instanceof Da){var In=dn.__data__;if(!Ia||In.length<199)return In.push([tr,mr]),this.size=++dn.size,this;dn=this.__data__=new ns(In)}return dn.set(tr,mr),this.size=dn.size,this};var Du=Ui?function(tr){return tr==null?[]:(tr=Object(tr),(function(mr,dn){for(var In=-1,vi=mr==null?0:mr.length,Pn=0,I=[];++In<vi;){var y=mr[In];dn(y,In,mr)&&(I[Pn++]=y)}return I})(Ui(tr),(function(mr){return Un.call(tr,mr)})))}:function(){return[]},Ua=Ys;function hu(tr,mr){return!!(mr=mr??It)&&(typeof tr=="number"||wi.test(tr))&&tr>-1&&tr%1==0&&tr<mr}function Zs(tr){if(tr!=null){try{return Ge.call(tr)}catch{}try{return tr+""}catch{}}return""}function ms(tr,mr){return tr===mr||tr!=tr&&mr!=mr}(Si&&Ua(new Si(new ArrayBuffer(1)))!=$i||Ia&&Ua(new Ia)!=on||za&&Ua(za.resolve())!=Ri||Hs&&Ua(new Hs)!=_n||ll&&Ua(new ll)!=mn)&&(Ua=function(tr){var mr=Ys(tr),dn=mr==ti?tr.constructor:void 0,In=dn?Zs(dn):"";if(In)switch(In){case $o:return $i;case Gs:return on;case Pa:return Ri;case Xs:return _n;case Il:return mn}return mr});var Va=ja((function(){return arguments})())?ja:function(tr){return fl(tr)&&bt.call(tr,"callee")&&!Un.call(tr,"callee")},Vl=Array.isArray,cl=Xi||function(){return!1};function hl(tr){if(!ql(tr))return!1;var mr=Ys(tr);return mr==Wr||mr=="[object GeneratorFunction]"||mr=="[object AsyncFunction]"||mr=="[object Proxy]"}function $l(tr){return typeof tr=="number"&&tr>-1&&tr%1==0&&tr<=It}function ql(tr){var mr=typeof tr;return tr!=null&&(mr=="object"||mr=="function")}function fl(tr){return tr!=null&&typeof tr=="object"}var Hl=Vo?(function(tr){return function(mr){return tr(mr)}})(Vo):function(tr){return fl(tr)&&$l(tr.length)&&!!fi[Ys(tr)]};function Ou(tr){return(mr=tr)!=null&&$l(mr.length)&&!hl(mr)?rc(tr):ic(tr);var mr}ee.exports=function(tr,mr){return Is(tr,mr)}})(ts,ts.exports);var oo=n(ts.exports);function rs(ee,pe){return ee.length===pe.length&&JSON.stringify(ee.map((function(Ke){return Ke})).sort())===JSON.stringify(pe.map((function(Ke){return Ke})).sort())}var Ba={Polygon:Fe,LineString:Le,Point:we,MultiPolygon:ot,MultiLineString:ot,MultiPoint:ot},Us=Object.freeze({__proto__:null,CommonSelectors:mt,constrainFeatureMovement:Ya,createMidPoint:$r,createSupplementaryPoints:hn,createVertex:Ar,doubleClickZoom:zr,euclideanDistance:Ce,featuresAt:se,getFeatureAtAndSetCursors:_e,isClick:me,isEventAtCoordinates:ds,isTap:xe,mapEventToBoundingBox:Q,ModeHandler:r,moveFeatures:ol,sortFeatures:ae,stringSetsAreEqual:rs,StringSet:W,theme:Cr,toDenseArray:st}),Uc=function(ee,pe){var Ke={options:ee=(function(Vt){Vt===void 0&&(Vt={});var $t=vr(Vt);return Vt.controls||($t.controls={}),Vt.displayControlsDefault===!1?$t.controls=vr(xc,Vt.controls):$t.controls=vr(_a,Vt.controls),($t=vr(Fa,$t)).styles=sl($t.styles,"cold").concat(sl($t.styles,"hot")),$t})(ee)};pe=(function(Vt,$t){return $t.modes=A,$t.getFeatureIdsAt=function(er){return se.click({point:er},null,Vt).map((function(Yr){return Yr.properties.id}))},$t.getSelectedIds=function(){return Vt.store.getSelectedIds()},$t.getSelected=function(){return{type:T.FEATURE_COLLECTION,features:Vt.store.getSelectedIds().map((function(er){return Vt.store.get(er)})).map((function(er){return er.toGeoJSON()}))}},$t.getSelectedPoints=function(){return{type:T.FEATURE_COLLECTION,features:Vt.store.getSelectedCoordinates().map((function(er){return{type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:er.coordinates}}}))}},$t.set=function(er){if(er.type===void 0||er.type!==T.FEATURE_COLLECTION||!Array.isArray(er.features))throw new Error("Invalid FeatureCollection");var Yr=Vt.store.createRenderBatch(),tn=Vt.store.getAllIds().slice(),Wr=$t.add(er),on=new W(Wr);return(tn=tn.filter((function(kr){return!on.has(kr)}))).length&&$t.delete(tn),Yr(),Wr},$t.add=function(er){var Yr=JSON.parse(JSON.stringify(Qr(er))).features.map((function(tn){if(tn.id=tn.id||de(),tn.geometry===null)throw new Error("Invalid geometry: null");if(Vt.store.get(tn.id)===void 0||Vt.store.get(tn.id).type!==tn.geometry.type){var Wr=Ba[tn.geometry.type];if(Wr===void 0)throw new Error("Invalid geometry type: "+tn.geometry.type+".");var on=new Wr(Vt,tn);Vt.store.add(on)}else{var kr=Vt.store.get(tn.id);kr.properties=tn.properties,oo(kr.properties,tn.properties)||Vt.store.featureChanged(kr.id),oo(kr.getCoordinates(),tn.geometry.coordinates)||kr.incomingCoords(tn.geometry.coordinates)}return tn.id}));return Vt.store.render(),Yr},$t.get=function(er){var Yr=Vt.store.get(er);if(Yr)return Yr.toGeoJSON()},$t.getAll=function(){return{type:T.FEATURE_COLLECTION,features:Vt.store.getAll().map((function(er){return er.toGeoJSON()}))}},$t.delete=function(er){return Vt.store.delete(er,{silent:!0}),$t.getMode()!==A.DIRECT_SELECT||Vt.store.getSelectedIds().length?Vt.store.render():Vt.events.changeMode(A.SIMPLE_SELECT,void 0,{silent:!0}),$t},$t.deleteAll=function(){return Vt.store.delete(Vt.store.getAllIds(),{silent:!0}),$t.getMode()===A.DIRECT_SELECT?Vt.events.changeMode(A.SIMPLE_SELECT,void 0,{silent:!0}):Vt.store.render(),$t},$t.changeMode=function(er,Yr){return Yr===void 0&&(Yr={}),er===A.SIMPLE_SELECT&&$t.getMode()===A.SIMPLE_SELECT?(rs(Yr.featureIds||[],Vt.store.getSelectedIds())||(Vt.store.setSelected(Yr.featureIds,{silent:!0}),Vt.store.render()),$t):(er===A.DIRECT_SELECT&&$t.getMode()===A.DIRECT_SELECT&&Yr.featureId===Vt.store.getSelectedIds()[0]||Vt.events.changeMode(er,Yr,{silent:!0}),$t)},$t.getMode=function(){return Vt.events.getMode()},$t.trash=function(){return Vt.events.trash({silent:!0}),$t},$t.combineFeatures=function(){return Vt.events.combineFeatures({silent:!0}),$t},$t.uncombineFeatures=function(){return Vt.events.uncombineFeatures({silent:!0}),$t},$t.setFeatureProperty=function(er,Yr,tn){return Vt.store.setFeatureProperty(er,Yr,tn),$t},$t})(Ke,pe),Ke.api=pe;var It=lr(Ke);return pe.onAdd=It.onAdd,pe.onRemove=It.onRemove,pe.types=E,pe.options=ee,pe};function Pu(ee){Uc(ee,this)}return Pu.modes=Ul,Pu.constants=H,Pu.lib=Us,Pu}))})(xS)),xS.exports}var sSe=oSe();const rj=Id(sSe);function lSe(){const t=Ox(r=>r.breakpoints.down("md"));return[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#009EE0","fill-outline-color":"#009EE0","fill-opacity":.3}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#009EE0","fill-outline-color":"#009EE0","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-width":3}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-width":4}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":t?5:4,"circle-color":"#ffffff","circle-stroke-color":"#009EE0","circle-stroke-width":1}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":t?8:6,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":t?7:5,"circle-color":"#ffffff","circle-stroke-color":"#009EE0","circle-stroke-width":1}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":t?10:9,"circle-opacity":1,"circle-color":"#009EE0"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":t?7.5:6.5,"circle-color":"#009EE0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":t?11:10,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":t?8.5:7.5,"circle-color":"#009EE0"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":t?8.5:6.5,"circle-color":"#404040"}}]}const LR=t=>{const e=te.useRef(null),r=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),n=te.useRef(!1),[i,a]=te.useState(!1),[s,o]=te.useState(),c=lSe(),h=te.useCallback(d=>{console.log("MlFeatureEditor mode change to "+d.mode),typeof t.onFinish=="function"&&d.mode==="simple_select"&&t.onFinish()},[t.onFinish]);return te.useEffect(()=>{r.map&&!n.current&&(n.current=!0,r.map.map.style&&r.map.map.getSource("mapbox-gl-draw-cold")&&e.current&&e.current?.remove(),e.current=new rj({displayControlsDefault:!1,defaultMode:t.mode||"simple_select",modes:Object.assign({},rj.modes),userProperties:!0,styles:c}),r.map.addControl(e.current,"top-left",r.componentId),r.map.on("draw.modechange",h,r.componentId),a(!0))},[r.map,t,n,h]),te.useEffect(()=>{if(!r.map||!i||!e.current)return;const d=m=>{const b=m?.features||[];o(b),t.onChange&&t.onChange(b)};return r.map.on("draw.create",d,r.componentId),r.map.on("draw.update",d,r.componentId),r.map.on("draw.delete",d,r.componentId),()=>{r.map&&(r.map.map.off("draw.create",d),r.map.map.off("draw.update",d),r.map.map.off("draw.delete",d))}},[i,r.map,t.onChange]),te.useEffect(()=>{e.current&&t.geojson?.geometry&&e.current.set({type:"FeatureCollection",features:[t.geojson]})},[t.geojson,i]),te.useEffect(()=>{t.mode&&e.current&&e.current?.getMode?.()!==t.mode&&(e.current?.changeMode?.(t.mode),t.mode!=="simple_select"&&t.mode!=="direct_select"&&e.current.set({type:"FeatureCollection",features:[]}))},[t.mode,r.map]),{feature:s,drawToolsReady:i,draw:e.current}};try{LR.displayName="useFeatureEditor",LR.__docgenInfo={description:"GeoJson Feature editor that allows to create or manipulate GeoJson data",displayName:"useFeatureEditor",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"Input GeoJson data at initialization",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | undefined"}},onChange:{defaultValue:null,description:`Callback function that is called each time the GeoJson data has changed within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((para: Feature<Geometry, GeoJsonProperties>[]) => void) | undefined"}},onFinish:{defaultValue:null,description:`Callback function that is called each time the GeoJson data within has been finished within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}},mode:{defaultValue:null,description:`Feature editor modes:
- draw_line_string
- draw_polygon
- draw_point
- simple_select
- direct_select`,name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"draw_line_string"'},{value:'"draw_polygon"'},{value:'"draw_point"'},{value:'"simple_select"'},{value:'"direct_select"'}]}}}}}catch{}const vE=t=>(LR({mode:t.mode,geojson:t.geojson,onChange:t.onChange,onFinish:t.onFinish,mapId:t.mapId}),J.jsx(J.Fragment,{}));try{vE.displayName="MlFeatureEditor",vE.__docgenInfo={description:"",displayName:"MlFeatureEditor",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"Input GeoJson data at initialization",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | undefined"}},onChange:{defaultValue:null,description:`Callback function that is called each time the GeoJson data has changed within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((para: Feature<Geometry, GeoJsonProperties>[]) => void) | undefined"}},onFinish:{defaultValue:null,description:`Callback function that is called each time the GeoJson data within has been finished within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}},mode:{defaultValue:null,description:`Feature editor modes:
- draw_line_string
- draw_polygon
- draw_point
- simple_select
- direct_select`,name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"draw_line_string"'},{value:'"draw_polygon"'},{value:'"draw_point"'},{value:'"simple_select"'},{value:'"direct_select"'}]}}}}}catch{}const nj=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","hillshade","background"];function uSe(t){return typeof t.options.source=="string"?{source:t.options.source}:t.geojson&&(!t.options?.source||typeof t?.options?.source!="string"&&t.options?.source?.attribution&&!t.options?.source?.type)?{source:{type:"geojson",data:t.geojson||"",attribution:typeof t?.options?.source!="string"&&t.options.source?.attribution?t.options.source?.attribution:""}}:{}}function cSe(t,e){if(t?.insertBeforeLayer)return t.insertBeforeLayer;if(t?.insertBeforeFirstSymbolLayer)return e?.map?.firstSymbolLayer}function Tp(t){const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=te.useRef(""),n=te.useRef(""),i=te.useRef(""),[a,s]=te.useState(),o=te.useRef(t.layerId||(t.idPrefix?t.idPrefix:"Layer-")+e.componentId),c=te.useCallback(()=>{if(!e.map||e?.map.cancelled||(e.map.map.getLayer(o.current)&&e.cleanup(),typeof t?.options?.source!="string"&&e.map.map.getSource(o.current)&&e.map.map.removeSource(o.current),typeof t.options.source=="string"&&(t.options.source===""||!e.map.map.getSource(t.options.source)))||typeof t?.options?.source!="string"&&!t.geojson&&!t?.options?.source?.data&&t?.options?.type!=="background"||typeof t.options.type>"u")return;try{e.map.addLayer({...t.options,...uSe(t),id:o.current},cSe(t,e),e.componentId)}catch(m){console.error("Failed to add layer:",m)}s(()=>e.map?.map.getLayer(o.current));const h=()=>{e.map?.map.getLayer(o.current)||c()};e.map.on("styledata",h,e.componentId);const d=(m,b,{source_id:x})=>{e.map&&typeof t?.options?.source=="string"&&t.options.source===x&&c()};e.map.wrapper.on("addsource",d,e.componentId),n.current=JSON.stringify(t.options?.paint),i.current=JSON.stringify(t.options?.layout),r.current=t.options.type},[t,e]);return te.useEffect(()=>{e.map&&(!t.geojson&&!t.options.source&&t?.options?.type!=="background"||e.map?.cancelled===!1&&e?.map?.map?.getLayer?.(o.current)&&(nj.indexOf(t.options.type)===-1||nj.indexOf(t.options.type)!==-1&&t.options.type===r.current)||c())},[e.map,e.mapIsReady,t,c]),te.useEffect(()=>{e.map?.cancelled===!0||!e.map?.map?.getSource?.(o.current)||e.map.map.getSource(o.current)?.setData?.(t.geojson)},[t.geojson,e.map,t.options.type]),te.useEffect(()=>{if(e.map?.cancelled===!0||!e.map||!e.map?.map?.getLayer?.(o.current)||t.options.type!==r.current)return;let h;const d=JSON.stringify(t.options.layout);if(t.options.layout&&d!==i.current){const b=JSON.parse(i.current);for(h in t.options.layout)t.options.layout?.[h]&&t.options.layout[h]!==b[h]&&e.map.map.setLayoutProperty(o.current,h,t.options.layout[h]);i.current=d}const m=JSON.stringify(t.options.paint);if(m!==n.current){const b=JSON.parse(n.current);for(h in t.options.paint)t.options.paint?.[h]&&t.options.paint[h]!==b[h]&&e.map.map.setPaintProperty(o.current,h,t.options.paint[h]);n.current=m}},[t.options,e.map]),te.useEffect(()=>{!t.insertBeforeLayer||!e.map||!e.map.getLayer(t.insertBeforeLayer)||!e.map.getLayer(o.current)||e.map.moveLayer(o.current,t.insertBeforeLayer)},[e.map,t.insertBeforeLayer]),te.useEffect(()=>()=>{e.cleanup()},[]),te.useEffect(()=>{if(typeof t?.options?.source!="string"||!e.map)return;const h=()=>{typeof t?.options?.source=="string"&&e?.map?.getSource?.(t.options.source)&&!e.map.getLayer(o.current)&&c()};e.map.on("sourcedataloading",h);const d=(m,b,{source_id:x})=>{e.map&&typeof t?.options?.source=="string"&&t.options.source===x&&c()};return e.map.wrapper.on("addsource",d),()=>{e?.map&&(e.map.off("sourcedataloading",h),e.map.wrapper.off("addsource",d))}},[e.map,t.options?.source]),te.useEffect(()=>{if(!t.onClick||!e?.map||!e?.map?.getLayer?.(o.current))return;const h=t.onClick;return e.map?.on("click",o.current,h),()=>{h&&e?.map&&e.map?.off("click",o.current,h)}},[e.map,t.onClick]),te.useEffect(()=>{if(!t.onHover||!e?.map||!e?.map?.getLayer?.(o.current))return;const h=t.onHover;return e.map?.on("mousemove",o.current,h),()=>{h&&e?.map&&e.map?.off("mousemove",o.current,h)}},[e.map,t.onHover]),te.useEffect(()=>{if(!t.onLeave||!e?.map||!e?.map?.getLayer?.(o.current))return;const h=t.onLeave;return e.map?.on("mouseleave",o.current,h),()=>{h&&e?.map&&e.map?.off("mouseleave",o.current,h)}},[e.map,t.onLeave]),{map:e.map,layer:a,layerId:o.current,componentId:e.componentId,mapHook:e}}Tp.defaultProps={};const FR=t=>(Tp({mapId:t.mapId,layerId:t.layerId||"MlFillExtrusionLayer-"+vc(),options:{id:"",type:"fill-extrusion",source:t.sourceId||"openmaptiles","source-layer":t.sourceLayer||"building",minzoom:t.minZoom||6,paint:{...t.paint}},insertBeforeFirstSymbolLayer:!0}),J.jsx(J.Fragment,{}));FR.defaultProps={mapId:void 0,paint:{"fill-extrusion-color":"hsl(196, 61%, 83%)","fill-extrusion-height":{property:"render_height",type:"identity"},"fill-extrusion-base":{property:"render_min_height",type:"identity"},"fill-extrusion-opacity":1}};try{FR.displayName="MlFillExtrusionLayer",FR.__docgenInfo={description:"Adds a fill extrusion layer to the MapLibre instance reference by props.mapId",displayName:"MlFillExtrusionLayer",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component",name:"layerId",required:!1,type:{name:"string | undefined"}},paint:{defaultValue:{value:`{
		'fill-extrusion-color': 'hsl(196, 61%, 83%)',
		'fill-extrusion-height': {
			property: 'render_height',
			type: 'identity',
		},
		'fill-extrusion-base': {
			property: 'render_min_height',
			type: 'identity',
		},
		'fill-extrusion-opacity': 1,
	}`},description:`Paint properties of the config object that is passed to the MapLibreGl.addLayer call. All
available properties are documented in the MapLibreGl documentation
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill-extrusion`,name:"paint",required:!1,type:{name:"object | undefined"}},sourceId:{defaultValue:null,description:`Source id of a vector tile source containing the geometries to use for this fill-extrusion
layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer`,name:"sourceId",required:!1,type:{name:"string | undefined"}},sourceLayer:{defaultValue:null,description:`Layer id from a vector tile source containing the geometries to use for this fill-extrusion
layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer`,name:"sourceLayer",required:!1,type:{name:"string | undefined"}},minZoom:{defaultValue:null,description:`This layer will be hidden for zoom levels lower than defined on this property
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#minzoom`,name:"minZoom",required:!1,type:{name:"number | undefined"}}}}}catch{}const EJ=(t,e)=>{switch(t){case"fill":return e?.fill?e.fill:{"fill-color":"#009EE0","fill-outline-color":"#009EE0"};case"line":return e?.line?(console.log(e.line),e.line):{"line-color":"#009EE0","line-width":4,"line-blur":0};case"circle":return e?.circle?e.circle:{"circle-color":"#009EE0","circle-stroke-color":"#fff","circle-stroke-width":2,"circle-radius":5};default:return{}}},ij={Position:"circle",Point:"circle",MultiPoint:"circle",LineString:"line",MultiLineString:"line",Polygon:"fill",MultiPolygon:"fill",GeometryCollection:"circle"},_E=t=>t?.type==="Feature"?ij?.[t?.geometry?.type]?ij[t.geometry.type]:"circle":t?.type==="FeatureCollection"?t.features.length?_E(t.features[0]):"circle":"fill";function sN(t){const e=va({mapId:t.mapId}),[r,n]=te.useState(),i=te.useRef(t.sourceId||(t.idPrefix?t.idPrefix:"Source-")+e.componentId),a=te.useCallback(()=>{if(e.map&&e.map?.style?._layers){for(const[o,c]of Object.entries(e.map.style._layers))c.source===i.current&&e.map.removeLayer(o);e.map.getSource(i.current)&&e.map.removeSource(i.current)}},[e.map]),s=te.useCallback(()=>{e.map&&(t.source.type==="geojson"&&!t.source.data||(e.map.map.getSource(i.current)&&a(),e.map?.addSource(i.current,{...t.source}),n(e.map.map.getSource(i.current))))},[t,e,a]);return te.useEffect(()=>{e.map?.map?.getSource(i.current)&&e.map.map.getSource(i.current)?.setData?.(t.source.data)},[t.source?.data]),te.useEffect(()=>{e?.map?.map?.getSource?.(t.sourceId)&&t.sourceId===i.current||(i.current=t.sourceId,s())},[e.map,t,s]),te.useEffect(()=>{if(!e.map)return;const o=()=>{e?.map?.getSource?.(t.sourceId)||s()};return e.map.on("styledata",o),()=>{e?.map&&e.map.off("styledata",o)}},[e.map,s]),te.useEffect(()=>()=>{a()},[a]),{map:e.map,source:r,componentId:e.componentId,mapHook:e}}const Dc=t=>{const e=t.type||_E(t.geojson),r=te.useRef(t.layerId||"MlGeoJsonLayer-"+vc()),n=`label-${r.current}`;return te.useEffect(()=>{t.layerId?r.current=t.layerId:r.current="MlGeoJsonLayer-"+vc()},[t.layerId]),sN({mapId:t.mapId,sourceId:"source-"+r.current,source:{type:"geojson",data:t.geojson,...typeof t?.options?.source<"u"&&typeof t?.options?.source!="string"?t.options.source:{}}}),Tp({mapId:t.mapId,layerId:r.current,options:{...typeof t?.options?.source<"u"&&typeof t?.options?.source=="string"?{source:t.options.source}:{source:"source-"+r.current},paint:{...t.paint||EJ(e,t.defaultPaintOverrides),...t?.options?.paint},layout:{...t?.layout||{},...t?.options?.layout},type:e},insertBeforeLayer:t.insertBeforeLayer,onHover:t.onHover,onClick:t.onClick,onLeave:t.onLeave}),Tp({mapId:t.mapId,options:{...typeof t?.options?.source<"u"&&typeof t?.options?.source=="string"?{source:t.options.source}:{source:"source-"+r.current},id:n,type:"symbol",maxzoom:24,minzoom:1,...t?.labelOptions?t.labelOptions:{},...t?.options?.filter?{filter:t.options.filter}:{},layout:{"text-font":["Open Sans Regular"],"text-field":`{${t.labelProp}}`,"text-size":12,"text-anchor":"top",...t?.labelOptions?.layout?t.labelOptions.layout:{},visibility:t?.layout?.visibility??t?.options?.layout?.visibility??"visible"},paint:{"text-halo-width":1,"text-halo-color":"#fefefe","text-color":"#121212",...t?.labelOptions?.paint?t.labelOptions.paint:{}}}}),J.jsx(J.Fragment,{})};try{Dc.displayName="MlGeoJsonLayer",Dc.__docgenInfo={description:"Adds source and layer to display GeoJSON data on the map.",displayName:"MlGeoJsonLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.
This layer will not be added to the maplibre-gl instance until a layer with an
id that matches the value of insertBeforeLayer is created.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the new layer and source that are added to the MapLibre instance",name:"layerId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}},type:{defaultValue:null,description:`Type of the layer that will be added to the MapLibre instance.
All types from LayerSpecification union type are supported except the type from
RasterLayerSpecification`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"symbol"'},{value:'"fill"'},{value:'"background"'},{value:'"circle"'},{value:'"line"'},{value:'"heatmap"'},{value:'"fill-extrusion"'},{value:'"hillshade"'},{value:'"color-relief"'}]}},paint:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.paint property instead. This will be removed in the next major release.
Paint property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All paint types from LayerSpecification union type are supported except the paint type from
RasterLayerSpecification`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | ... 8 more ... | undefined'}},layout:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.layout property instead. This will be removed in the next major release.
Layout property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All layout types from LayerSpecification union type are supported except the layout type from
RasterLayerSpecification`,name:"layout",required:!1,type:{name:'{ "symbol-placement"?: PropertyValueSpecification<"line" | "point" | "line-center"> | undefined; "symbol-spacing"?: PropertyValueSpecification<number> | undefined; ... 42 more ...; visibility?: VisibilitySpecification | undefined; } | ... 9 more ... | undefined'}},options:{defaultValue:null,description:"Javascript object that is spread into the addLayer commands first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},defaultPaintOverrides:{defaultValue:null,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.',name:"defaultPaintOverrides",required:!1,type:{name:'{ circle?: { "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | undefined; fill?: { ...; } | undefined; line?: { ...; } | undefined...'}},labelProp:{defaultValue:null,description:"Property name in the GeoJSON object to be used as a label.",name:"labelProp",required:!1,type:{name:"string | undefined"}},labelOptions:{defaultValue:null,description:"Label configuration options.",name:"labelOptions",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},onHover:{defaultValue:null,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}}}}}catch{}const lN=Ji(J.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"})),BR=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(!1),[i,a]=te.useState(),[s,o]=te.useState(!1),[c,h]=te.useState(),[d,m]=te.useState(0),b=te.useRef(!1),x=te.useCallback(M=>{if(!e.map||((!t.centerUserPosition&&!b.current||t.centerUserPosition)&&(t.useFlyTo?e.map.map.flyTo({center:[M.coords.longitude,M.coords.latitude],zoom:18,speed:1,curve:1}):e.map.map.setCenter([M.coords.longitude,M.coords.latitude]),b.current=!0),t.showUserLocation!==void 0&&!t.showUserLocation))return;const F=Gh([M.coords.longitude,M.coords.latitude]);a(F),h(SJ(F,M.coords.accuracy/1e3))},[e.map,t]),E=()=>{console.log("Access of user location denied"),o(!0)},T=te.useMemo(()=>{if(!i)return;const M=.02,F=d-15,N=d+15,j=qwe(i,M,F,N,{steps:65});return j.geometry.coordinates.push(i.geometry.coordinates),j.geometry.coordinates.slice(0,0),j},[d,i]),A=M=>{M?.alpha&&m(-M.alpha)};return te.useEffect(()=>{if(r){const M=A;return window.addEventListener("deviceorientation",M),()=>{window.removeEventListener("deviceorientation",M)}}else b.current=!1},[r]),te.useEffect(()=>{if(e.map&&r){const M=navigator.geolocation.watchPosition(x,E);return()=>{navigator.geolocation.clearWatch(M)}}},[e.map,r,x]),te.useEffect(()=>{if(c?.type){const M=e.map?.getBounds(),F=[M?._ne.lng,M?._ne.lat,M?._sw.lng,M?._sw.lat],N=dh(c);O2e(w7(F),w7(N))||e.map?.fitBounds(N,{padding:{top:25,bottom:25}})}},[c]),J.jsxs(J.Fragment,{children:[r&&i&&J.jsx(Dc,{geojson:c,type:"fill",paint:{"fill-color":"#cbd300","fill-opacity":.3,...t.accuracyPaint},insertBeforeLayer:t.insertBeforeLayer}),r&&T&&J.jsx(Dc,{geojson:T,type:"fill",paint:{"fill-color":"#0000ff","fill-antialias":!1,"fill-opacity":.3,...t.orientationConePaint},insertBeforeLayer:t.insertBeforeLayer}),r&&i&&J.jsx(Dc,{geojson:i,type:"circle",paint:{"circle-color":"#009ee0","circle-radius":5,"circle-stroke-color":"#fafaff","circle-stroke-width":1,...t.circlePaint},insertBeforeLayer:t.insertBeforeLayer}),J.jsx(ta,{variant:"navtools","data-testid":"mlFollowGpsBtn",sx:{zIndex:1002,color:r?M=>M.palette.GPS.GPSActiveColor:M=>M.palette.GPS.GPSInactiveColor,backgroundColor:r?M=>M.palette.GPS.GPSActiveBackgroundColor:M=>M.palette.navigation.navColor},disabled:s,onClick:()=>{n(!r)},children:J.jsx(lN,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})]})};try{BR.displayName="MlFollowGps",BR.__docgenInfo={description:`Adds a button that makes the map follow the users GPS position using
navigator.geolocation.watchPosition if activated`,displayName:"MlFollowGps",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},showUserLocation:{defaultValue:null,description:"By default a dot will be shown on the map at the user's location. Set to false to disable.",name:"showUserLocation",required:!1,type:{name:"boolean | undefined"}},showOrientation:{defaultValue:null,description:`By default a cone will be shown on the map at the user's location to indicate the device's orientation.
Set to false to disable.`,name:"showOrientation",required:!1,type:{name:"boolean | undefined"}},showAccuracyCircle:{defaultValue:null,description:`By default, if showUserLocation is true, a transparent circle will be drawn around the user location
indicating the accuracy (95% confidence level) of the user's location. Set to false to disable.`,name:"showAccuracyCircle",required:!1,type:{name:"boolean | undefined"}},useFlyTo:{defaultValue:null,description:`Use the MapLibre.flyTo function to center the map to the current users position if true.
Otherwise the MapLibre.setCenter function is used.`,name:"useFlyTo",required:!1,type:{name:"boolean | undefined"}},centerUserPosition:{defaultValue:null,description:`Center map to current position once updated location data is recieved.
"false" will center the map once on component activation and then display the updated user location on the map.`,name:"centerUserPosition",required:!1,type:{name:"boolean | undefined"}},orientationConePaint:{defaultValue:null,description:`Orientation cone paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the orientation cone polygon.
Use any available paint prop from layer type "fill".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"orientationConePaint",required:!1,type:{name:'{ "fill-antialias"?: PropertyValueSpecification<boolean> | undefined; "fill-opacity"?: DataDrivenPropertyValueSpecification<number> | undefined; ... 9 more ...; "fill-pattern-transition"?: TransitionSpecification | undefined; } | undefined'}},circlePaint:{defaultValue:null,description:`Position circle paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the position circle.
Use any available paint prop from layer type "circle".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle`,name:"circlePaint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | undefined'}},onColor:{defaultValue:null,description:"Active button font color",name:"onColor",required:!1,type:{name:"string | undefined"}},offColor:{defaultValue:null,description:"Inactive button font color",name:"offColor",required:!1,type:{name:"string | undefined"}},accuracyPaint:{defaultValue:null,description:`Accuracy paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the accuracy polygon.
Use any available paint prop from layer type "fill".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"accuracyPaint",required:!1,type:{name:'{ "fill-antialias"?: PropertyValueSpecification<boolean> | undefined; "fill-opacity"?: DataDrivenPropertyValueSpecification<number> | undefined; ... 9 more ...; "fill-pattern-transition"?: TransitionSpecification | undefined; } | undefined'}}}}}catch{}const aj=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(),i=te.useRef(t.imageId||"img_"+vc()),a=te.useRef(t.layerId||"MlImageMarkerLayer-"+e.componentId);Tp({geojson:t.options?.source?.data,layerId:a.current,options:{type:"symbol",layout:{...t.options?.layout,"icon-image":r||i.current},paint:{...t.options?.paint}}});const s=(o,c)=>{o.map&&c.imgSrc&&!o.map.map.hasImage(i.current)&&o.map.map.loadImage(c.imgSrc).then(function(h){if(!h?.data){console.log("image "+c.imgSrc+"could not be loaded");return}!o.map||o.map.map.hasImage(i.current)||(o.map.addImage(i.current,h.data,o.componentId),n(i.current))})};return te.useEffect(()=>{e.map&&t.imgSrc&&s(e,t)},[t,e]),J.jsx(J.Fragment,{})};try{aj.displayName="MlImageMarkerLayer",aj.__docgenInfo={description:"",displayName:"MlImageMarkerLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component to the maplibre-gl instance",name:"layerId",required:!1,type:{name:"string | undefined"}},imageId:{defaultValue:null,description:"Id of the image that will be added by this component to the maplibre-gl instance",name:"imageId",required:!1,type:{name:"string | undefined"}},imgSrc:{defaultValue:null,description:"Path or URL to a supported raster image",name:"imgSrc",required:!1,type:{name:"string | undefined"}},options:{defaultValue:null,description:"Javascript object that is passed the addLayer command as first parameter.",name:"options",required:!1,type:{name:"{ source?: { type?: string | undefined; data: Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined; } | undefined; layout?: { ...; } | undefined; paint?: { ...; } | undefined; } | undefined"}}}}}catch{}function hSe(t){switch(t){case"meters":return 1;case"millimeters":return 1e3;case"centimeters":return 100;case"kilometers":return .001;case"miles":return 1/1609.344;case"nauticalmiles":return 1/1852;case"inches":return 39.3701;case"yards":return 1.09361;case"feet":return 3.28084;default:return 1}}function oj(t){switch(t){case"miles":return"mi";case"acres":return"ac";case"kilometers":return"km";case"meters":return"m";case"millimeters":return"mm";case"centimeters":return"cm";case"nauticalmiles":return"nm";case"inches":return"in";case"yards":return"yd";case"feet":return"ft";case"hectares":return"ha";default:return"m"}}const zR=t=>{const[e,r]=te.useState({value:0,label:""}),[n,i]=te.useState([]);return te.useEffect(()=>{if(n[0]){let a=0;if(t.measureType==="polygon"){if(a=x2e(n[0]),t.unit){const s=t.unit;s==="acres"?a=a/4046.8564224:s==="hectares"?a=a/1e4:a=a*hSe(t.unit)**2}}else a=Jb(n[0],{units:t.unit});typeof t.onChange=="function"&&t.onChange({value:a,unit:t.unit,geojson:n[0]}),a>=.1&&r({value:a,label:oj(t.unit)})}},[t.unit,n]),J.jsxs(J.Fragment,{children:[J.jsx(vE,{onChange:a=>{a&&i(a)},mode:t.measureType==="polygon"?"draw_polygon":"draw_line_string",onFinish:t.onFinish}),e.value.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})," ",oj(t.unit),e.label&&t.measureType==="polygon"&&!["hectares","acres"].includes(t.unit||"")?" ":""]})};try{zR.displayName="MlMeasureTool",zR.__docgenInfo={description:"",displayName:"MlMeasureTool",props:{measureType:{defaultValue:null,description:'String that specify if the Tool measures an area ("polygon") or length ("line")',name:"measureType",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"line"'},{value:'"polygon"'}]}},unit:{defaultValue:null,description:"String that dictates which unit of measurement is used",name:"unit",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"meters"'},{value:'"metres"'},{value:'"millimeters"'},{value:'"millimetres"'},{value:'"centimeters"'},{value:'"centimetres"'},{value:'"kilometers"'},{value:'"kilometres"'},{value:'"miles"'},{value:'"nauticalmiles"'},{value:'"inches"'},{value:'"yards"'},{value:'"feet"'},{value:'"radians"'},{value:'"degrees"'}]}},onChange:{defaultValue:null,description:`Callback function that is called each time measurment geometry within has changed within MlMeasureTool.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((options: MlMeasureToolOnChangeOptions) => void) | undefined"}},onFinish:{defaultValue:null,description:"Callback function that is called by the end of drawing geometries.",name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}const TJ=Ji(J.jsx("path",{d:"M15 16v1.26l-6-3v-3.17L11.7 8H16V2h-6v4.9L7.3 10H3v6h5l7 3.5V22h6v-6z"})),CJ=Ji(J.jsx("path",{d:"m2 9 4 12h12l4-12-10-7z"})),fSe=Dr(Rf)({marginTop:"15px"});function jR(t){return J.jsx(fSe,{children:t?.children})}try{jR.displayName="LayerList",jR.__docgenInfo={description:"",displayName:"LayerList",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const qx=Ji(J.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),uN=Ji(J.jsx("path",{d:"M3 17v2h6v-2zM3 5v2h10V5zm10 16v-2h8v-2h-8v-2h-2v6zM7 9v2H3v2h4v2h2V9zm14 4v-2H11v2zm-6-4h2V7h4V5h-4V3h-2z"})),AJ=Ji(J.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),bE=Ji(J.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"})),dSe=_y($h)({paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"}),pSe=_y(jb)({minWidth:"30px"}),gSe=_y(kc)({marginRight:"0px",padding:"0px"}),mSe=_y(U0)({padding:0,marginRight:"5px"}),ySe=_y(Mv)(({open:t})=>({display:t?"block":"none"})),vSe=_y(Rf)({marginLeft:"50px"});function UR({visible:t=!0,name:e,children:r,setVisible:n}){const[i,a]=te.useState(!1),[s,o]=te.useState(!0),c=te.useMemo(()=>t?s:!1,[t,s]),h=te.useMemo(()=>r?Array.isArray(r)?r.map(d=>gt.cloneElement(d,{visible:c})):gt.cloneElement(r,{visible:c}):J.jsx(J.Fragment,{}),[c]);return J.jsxs(J.Fragment,{children:[J.jsxs(dSe,{children:[J.jsxs(pSe,{children:[J.jsx(gSe,{edge:"end","aria-label":"open",onClick:()=>a(!i),children:i?J.jsx(bE,{}):J.jsx(AJ,{})}),J.jsx(mSe,{disabled:n?!1:!t,checked:n?t:s,onClick:()=>{n?n(d=>!d):o(d=>!d)}})]}),J.jsx(Dh,{primary:e,variant:"layerlist"})]}),J.jsx(ySe,{open:i,children:J.jsx(vSe,{disablePadding:!0,children:h})})]})}try{UR.displayName="LayerListFolder",UR.__docgenInfo={description:"",displayName:"LayerListFolder",props:{visible:{defaultValue:{value:"true"},description:"",name:"visible",required:!1,type:{name:"boolean"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"ReactNode"}},setVisible:{defaultValue:null,description:"",name:"setVisible",required:!1,type:{name:"((visible: boolean | ((val: unknown) => boolean)) => void) | undefined"}}}}}catch{}var Tc={},_v={},s5,sj;function IJ(){if(sj)return s5;sj=1;var t=typeof cg=="object"&&cg&&cg.Object===Object&&cg;return s5=t,s5}var l5,lj;function Md(){if(lj)return l5;lj=1;var t=IJ(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return l5=r,l5}var u5,uj;function Hx(){if(uj)return u5;uj=1;var t=Md(),e=t.Symbol;return u5=e,u5}var c5,cj;function _Se(){if(cj)return c5;cj=1;var t=Hx(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,i=t?t.toStringTag:void 0;function a(s){var o=r.call(s,i),c=s[i];try{s[i]=void 0;var h=!0}catch{}var d=n.call(s);return h&&(o?s[i]=c:delete s[i]),d}return c5=a,c5}var h5,hj;function bSe(){if(hj)return h5;hj=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return h5=r,h5}var f5,fj;function Ty(){if(fj)return f5;fj=1;var t=Hx(),e=_Se(),r=bSe(),n="[object Null]",i="[object Undefined]",a=t?t.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?e(o):r(o)}return f5=s,f5}var d5,dj;function Of(){if(dj)return d5;dj=1;var t=Array.isArray;return d5=t,d5}var p5,pj;function Rp(){if(pj)return p5;pj=1;function t(e){return e!=null&&typeof e=="object"}return p5=t,p5}var g5,gj;function xSe(){if(gj)return g5;gj=1;var t=Ty(),e=Of(),r=Rp(),n="[object String]";function i(a){return typeof a=="string"||!e(a)&&r(a)&&t(a)==n}return g5=i,g5}var m5,mj;function wSe(){if(mj)return m5;mj=1;function t(e){return function(r,n,i){for(var a=-1,s=Object(r),o=i(r),c=o.length;c--;){var h=o[e?c:++a];if(n(s[h],h,s)===!1)break}return r}}return m5=t,m5}var y5,yj;function SSe(){if(yj)return y5;yj=1;var t=wSe(),e=t();return y5=e,y5}var v5,vj;function ESe(){if(vj)return v5;vj=1;function t(e,r){for(var n=-1,i=Array(e);++n<e;)i[n]=r(n);return i}return v5=t,v5}var _5,_j;function TSe(){if(_j)return _5;_j=1;var t=Ty(),e=Rp(),r="[object Arguments]";function n(i){return e(i)&&t(i)==r}return _5=n,_5}var b5,bj;function PJ(){if(bj)return b5;bj=1;var t=TSe(),e=Rp(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,a=t((function(){return arguments})())?t:function(s){return e(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return b5=a,b5}var j1={exports:{}},x5,xj;function CSe(){if(xj)return x5;xj=1;function t(){return!1}return x5=t,x5}j1.exports;var wj;function cN(){return wj||(wj=1,(function(t,e){var r=Md(),n=CSe(),i=e&&!e.nodeType&&e,a=i&&!0&&t&&!t.nodeType&&t,s=a&&a.exports===i,o=s?r.Buffer:void 0,c=o?o.isBuffer:void 0,h=c||n;t.exports=h})(j1,j1.exports)),j1.exports}var w5,Sj;function kJ(){if(Sj)return w5;Sj=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i??t,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return w5=r,w5}var S5,Ej;function hN(){if(Ej)return S5;Ej=1;var t=9007199254740991;function e(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=t}return S5=e,S5}var E5,Tj;function ASe(){if(Tj)return E5;Tj=1;var t=Ty(),e=hN(),r=Rp(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",c="[object Function]",h="[object Map]",d="[object Number]",m="[object Object]",b="[object RegExp]",x="[object Set]",E="[object String]",T="[object WeakMap]",A="[object ArrayBuffer]",M="[object DataView]",F="[object Float32Array]",N="[object Float64Array]",O="[object Int8Array]",U="[object Int16Array]",j="[object Int32Array]",H="[object Uint8Array]",G="[object Uint8ClampedArray]",X="[object Uint16Array]",ae="[object Uint32Array]",Q={};Q[F]=Q[N]=Q[O]=Q[U]=Q[j]=Q[H]=Q[G]=Q[X]=Q[ae]=!0,Q[n]=Q[i]=Q[A]=Q[a]=Q[M]=Q[s]=Q[o]=Q[c]=Q[h]=Q[d]=Q[m]=Q[b]=Q[x]=Q[E]=Q[T]=!1;function W(oe){return r(oe)&&e(oe.length)&&!!Q[t(oe)]}return E5=W,E5}var T5,Cj;function fN(){if(Cj)return T5;Cj=1;function t(e){return function(r){return e(r)}}return T5=t,T5}var U1={exports:{}};U1.exports;var Aj;function dN(){return Aj||(Aj=1,(function(t,e){var r=IJ(),n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===n,s=a&&r.process,o=(function(){try{var c=i&&i.require&&i.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}})();t.exports=o})(U1,U1.exports)),U1.exports}var C5,Ij;function RJ(){if(Ij)return C5;Ij=1;var t=ASe(),e=fN(),r=dN(),n=r&&r.isTypedArray,i=n?e(n):t;return C5=i,C5}var A5,Pj;function MJ(){if(Pj)return A5;Pj=1;var t=ESe(),e=PJ(),r=Of(),n=cN(),i=kJ(),a=RJ(),s=Object.prototype,o=s.hasOwnProperty;function c(h,d){var m=r(h),b=!m&&e(h),x=!m&&!b&&n(h),E=!m&&!b&&!x&&a(h),T=m||b||x||E,A=T?t(h.length,String):[],M=A.length;for(var F in h)(d||o.call(h,F))&&!(T&&(F=="length"||x&&(F=="offset"||F=="parent")||E&&(F=="buffer"||F=="byteLength"||F=="byteOffset")||i(F,M)))&&A.push(F);return A}return A5=c,A5}var I5,kj;function pN(){if(kj)return I5;kj=1;var t=Object.prototype;function e(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||t;return r===i}return I5=e,I5}var P5,Rj;function DJ(){if(Rj)return P5;Rj=1;function t(e,r){return function(n){return e(r(n))}}return P5=t,P5}var k5,Mj;function ISe(){if(Mj)return k5;Mj=1;var t=DJ(),e=t(Object.keys,Object);return k5=e,k5}var R5,Dj;function PSe(){if(Dj)return R5;Dj=1;var t=pN(),e=ISe(),r=Object.prototype,n=r.hasOwnProperty;function i(a){if(!t(a))return e(a);var s=[];for(var o in Object(a))n.call(a,o)&&o!="constructor"&&s.push(o);return s}return R5=i,R5}var M5,Oj;function __(){if(Oj)return M5;Oj=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return M5=t,M5}var D5,Nj;function OJ(){if(Nj)return D5;Nj=1;var t=Ty(),e=__(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var c=t(o);return c==n||c==i||c==r||c==a}return D5=s,D5}var O5,Lj;function g3(){if(Lj)return O5;Lj=1;var t=OJ(),e=hN();function r(n){return n!=null&&e(n.length)&&!t(n)}return O5=r,O5}var N5,Fj;function Wx(){if(Fj)return N5;Fj=1;var t=MJ(),e=PSe(),r=g3();function n(i){return r(i)?t(i):e(i)}return N5=n,N5}var L5,Bj;function NJ(){if(Bj)return L5;Bj=1;var t=SSe(),e=Wx();function r(n,i){return n&&t(n,i,e)}return L5=r,L5}var F5,zj;function LJ(){if(zj)return F5;zj=1;function t(e){return e}return F5=t,F5}var B5,jj;function kSe(){if(jj)return B5;jj=1;var t=LJ();function e(r){return typeof r=="function"?r:t}return B5=e,B5}var z5,Uj;function gN(){if(Uj)return z5;Uj=1;var t=NJ(),e=kSe();function r(n,i){return n&&t(n,e(i))}return z5=r,z5}var j5,Vj;function mN(){if(Vj)return j5;Vj=1;var t=DJ(),e=t(Object.getPrototypeOf,Object);return j5=e,j5}var U5,$j;function RSe(){if($j)return U5;$j=1;var t=Ty(),e=mN(),r=Rp(),n="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,c=s.call(Object);function h(d){if(!r(d)||t(d)!=n)return!1;var m=e(d);if(m===null)return!0;var b=o.call(m,"constructor")&&m.constructor;return typeof b=="function"&&b instanceof b&&s.call(b)==c}return U5=h,U5}var V5,qj;function FJ(){if(qj)return V5;qj=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=r(e[n],n,e);return a}return V5=t,V5}var $5,Hj;function MSe(){if(Hj)return $5;Hj=1;function t(){this.__data__=[],this.size=0}return $5=t,$5}var q5,Wj;function yN(){if(Wj)return q5;Wj=1;function t(e,r){return e===r||e!==e&&r!==r}return q5=t,q5}var H5,Gj;function m3(){if(Gj)return H5;Gj=1;var t=yN();function e(r,n){for(var i=r.length;i--;)if(t(r[i][0],n))return i;return-1}return H5=e,H5}var W5,Xj;function DSe(){if(Xj)return W5;Xj=1;var t=m3(),e=Array.prototype,r=e.splice;function n(i){var a=this.__data__,s=t(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():r.call(a,s,1),--this.size,!0}return W5=n,W5}var G5,Yj;function OSe(){if(Yj)return G5;Yj=1;var t=m3();function e(r){var n=this.__data__,i=t(n,r);return i<0?void 0:n[i][1]}return G5=e,G5}var X5,Zj;function NSe(){if(Zj)return X5;Zj=1;var t=m3();function e(r){return t(this.__data__,r)>-1}return X5=e,X5}var Y5,Kj;function LSe(){if(Kj)return Y5;Kj=1;var t=m3();function e(r,n){var i=this.__data__,a=t(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return Y5=e,Y5}var Z5,Jj;function y3(){if(Jj)return Z5;Jj=1;var t=MSe(),e=DSe(),r=OSe(),n=NSe(),i=LSe();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var h=s[o];this.set(h[0],h[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,Z5=a,Z5}var K5,Qj;function FSe(){if(Qj)return K5;Qj=1;var t=y3();function e(){this.__data__=new t,this.size=0}return K5=e,K5}var J5,eU;function BSe(){if(eU)return J5;eU=1;function t(e){var r=this.__data__,n=r.delete(e);return this.size=r.size,n}return J5=t,J5}var Q5,tU;function zSe(){if(tU)return Q5;tU=1;function t(e){return this.__data__.get(e)}return Q5=t,Q5}var e4,rU;function jSe(){if(rU)return e4;rU=1;function t(e){return this.__data__.has(e)}return e4=t,e4}var t4,nU;function USe(){if(nU)return t4;nU=1;var t=Md(),e=t["__core-js_shared__"];return t4=e,t4}var r4,iU;function VSe(){if(iU)return r4;iU=1;var t=USe(),e=(function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!e&&e in n}return r4=r,r4}var n4,aU;function BJ(){if(aU)return n4;aU=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return n4=r,n4}var i4,oU;function $Se(){if(oU)return i4;oU=1;var t=OJ(),e=VSe(),r=__(),n=BJ(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,c=s.toString,h=o.hasOwnProperty,d=RegExp("^"+c.call(h).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function m(b){if(!r(b)||e(b))return!1;var x=t(b)?d:a;return x.test(n(b))}return i4=m,i4}var a4,sU;function qSe(){if(sU)return a4;sU=1;function t(e,r){return e?.[r]}return a4=t,a4}var o4,lU;function Cy(){if(lU)return o4;lU=1;var t=$Se(),e=qSe();function r(n,i){var a=e(n,i);return t(a)?a:void 0}return o4=r,o4}var s4,uU;function vN(){if(uU)return s4;uU=1;var t=Cy(),e=Md(),r=t(e,"Map");return s4=r,s4}var l4,cU;function v3(){if(cU)return l4;cU=1;var t=Cy(),e=t(Object,"create");return l4=e,l4}var u4,hU;function HSe(){if(hU)return u4;hU=1;var t=v3();function e(){this.__data__=t?t(null):{},this.size=0}return u4=e,u4}var c4,fU;function WSe(){if(fU)return c4;fU=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return c4=t,c4}var h4,dU;function GSe(){if(dU)return h4;dU=1;var t=v3(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(t){var o=s[a];return o===e?void 0:o}return n.call(s,a)?s[a]:void 0}return h4=i,h4}var f4,pU;function XSe(){if(pU)return f4;pU=1;var t=v3(),e=Object.prototype,r=e.hasOwnProperty;function n(i){var a=this.__data__;return t?a[i]!==void 0:r.call(a,i)}return f4=n,f4}var d4,gU;function YSe(){if(gU)return d4;gU=1;var t=v3(),e="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=t&&i===void 0?e:i,this}return d4=r,d4}var p4,mU;function ZSe(){if(mU)return p4;mU=1;var t=HSe(),e=WSe(),r=GSe(),n=XSe(),i=YSe();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var h=s[o];this.set(h[0],h[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,p4=a,p4}var g4,yU;function KSe(){if(yU)return g4;yU=1;var t=ZSe(),e=y3(),r=vN();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return g4=n,g4}var m4,vU;function JSe(){if(vU)return m4;vU=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return m4=t,m4}var y4,_U;function _3(){if(_U)return y4;_U=1;var t=JSe();function e(r,n){var i=r.__data__;return t(n)?i[typeof n=="string"?"string":"hash"]:i.map}return y4=e,y4}var v4,bU;function QSe(){if(bU)return v4;bU=1;var t=_3();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return v4=e,v4}var _4,xU;function eEe(){if(xU)return _4;xU=1;var t=_3();function e(r){return t(this,r).get(r)}return _4=e,_4}var b4,wU;function tEe(){if(wU)return b4;wU=1;var t=_3();function e(r){return t(this,r).has(r)}return b4=e,b4}var x4,SU;function rEe(){if(SU)return x4;SU=1;var t=_3();function e(r,n){var i=t(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return x4=e,x4}var w4,EU;function _N(){if(EU)return w4;EU=1;var t=KSe(),e=QSe(),r=eEe(),n=tEe(),i=rEe();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var h=s[o];this.set(h[0],h[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,w4=a,w4}var S4,TU;function nEe(){if(TU)return S4;TU=1;var t=y3(),e=vN(),r=_N(),n=200;function i(a,s){var o=this.__data__;if(o instanceof t){var c=o.__data__;if(!e||c.length<n-1)return c.push([a,s]),this.size=++o.size,this;o=this.__data__=new r(c)}return o.set(a,s),this.size=o.size,this}return S4=i,S4}var E4,CU;function bN(){if(CU)return E4;CU=1;var t=y3(),e=FSe(),r=BSe(),n=zSe(),i=jSe(),a=nEe();function s(o){var c=this.__data__=new t(o);this.size=c.size}return s.prototype.clear=e,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,E4=s,E4}var T4,AU;function iEe(){if(AU)return T4;AU=1;var t="__lodash_hash_undefined__";function e(r){return this.__data__.set(r,t),this}return T4=e,T4}var C4,IU;function aEe(){if(IU)return C4;IU=1;function t(e){return this.__data__.has(e)}return C4=t,C4}var A4,PU;function oEe(){if(PU)return A4;PU=1;var t=_N(),e=iEe(),r=aEe();function n(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new t;++a<s;)this.add(i[a])}return n.prototype.add=n.prototype.push=e,n.prototype.has=r,A4=n,A4}var I4,kU;function sEe(){if(kU)return I4;kU=1;function t(e,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(e[n],n,e))return!0;return!1}return I4=t,I4}var P4,RU;function lEe(){if(RU)return P4;RU=1;function t(e,r){return e.has(r)}return P4=t,P4}var k4,MU;function zJ(){if(MU)return k4;MU=1;var t=oEe(),e=sEe(),r=lEe(),n=1,i=2;function a(s,o,c,h,d,m){var b=c&n,x=s.length,E=o.length;if(x!=E&&!(b&&E>x))return!1;var T=m.get(s),A=m.get(o);if(T&&A)return T==o&&A==s;var M=-1,F=!0,N=c&i?new t:void 0;for(m.set(s,o),m.set(o,s);++M<x;){var O=s[M],U=o[M];if(h)var j=b?h(U,O,M,o,s,m):h(O,U,M,s,o,m);if(j!==void 0){if(j)continue;F=!1;break}if(N){if(!e(o,function(H,G){if(!r(N,G)&&(O===H||d(O,H,c,h,m)))return N.push(G)})){F=!1;break}}else if(!(O===U||d(O,U,c,h,m))){F=!1;break}}return m.delete(s),m.delete(o),F}return k4=a,k4}var R4,DU;function jJ(){if(DU)return R4;DU=1;var t=Md(),e=t.Uint8Array;return R4=e,R4}var M4,OU;function uEe(){if(OU)return M4;OU=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(i,a){n[++r]=[a,i]}),n}return M4=t,M4}var D4,NU;function cEe(){if(NU)return D4;NU=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(i){n[++r]=i}),n}return D4=t,D4}var O4,LU;function hEe(){if(LU)return O4;LU=1;var t=Hx(),e=jJ(),r=yN(),n=zJ(),i=uEe(),a=cEe(),s=1,o=2,c="[object Boolean]",h="[object Date]",d="[object Error]",m="[object Map]",b="[object Number]",x="[object RegExp]",E="[object Set]",T="[object String]",A="[object Symbol]",M="[object ArrayBuffer]",F="[object DataView]",N=t?t.prototype:void 0,O=N?N.valueOf:void 0;function U(j,H,G,X,ae,Q,W){switch(G){case F:if(j.byteLength!=H.byteLength||j.byteOffset!=H.byteOffset)return!1;j=j.buffer,H=H.buffer;case M:return!(j.byteLength!=H.byteLength||!Q(new e(j),new e(H)));case c:case h:case b:return r(+j,+H);case d:return j.name==H.name&&j.message==H.message;case x:case T:return j==H+"";case m:var oe=i;case E:var se=X&s;if(oe||(oe=a),j.size!=H.size&&!se)return!1;var he=W.get(j);if(he)return he==H;X|=o,W.set(j,H);var _e=n(oe(j),oe(H),X,ae,Q,W);return W.delete(j),_e;case A:if(O)return O.call(j)==O.call(H)}return!1}return O4=U,O4}var N4,FU;function UJ(){if(FU)return N4;FU=1;function t(e,r){for(var n=-1,i=r.length,a=e.length;++n<i;)e[a+n]=r[n];return e}return N4=t,N4}var L4,BU;function VJ(){if(BU)return L4;BU=1;var t=UJ(),e=Of();function r(n,i,a){var s=i(n);return e(n)?s:t(s,a(n))}return L4=r,L4}var F4,zU;function fEe(){if(zU)return F4;zU=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=0,s=[];++n<i;){var o=e[n];r(o,n,e)&&(s[a++]=o)}return s}return F4=t,F4}var B4,jU;function $J(){if(jU)return B4;jU=1;function t(){return[]}return B4=t,B4}var z4,UU;function xN(){if(UU)return z4;UU=1;var t=fEe(),e=$J(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),t(i(s),function(o){return n.call(s,o)}))}:e;return z4=a,z4}var j4,VU;function qJ(){if(VU)return j4;VU=1;var t=VJ(),e=xN(),r=Wx();function n(i){return t(i,r,e)}return j4=n,j4}var U4,$U;function dEe(){if($U)return U4;$U=1;var t=qJ(),e=1,r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o,c,h,d){var m=o&e,b=t(a),x=b.length,E=t(s),T=E.length;if(x!=T&&!m)return!1;for(var A=x;A--;){var M=b[A];if(!(m?M in s:n.call(s,M)))return!1}var F=d.get(a),N=d.get(s);if(F&&N)return F==s&&N==a;var O=!0;d.set(a,s),d.set(s,a);for(var U=m;++A<x;){M=b[A];var j=a[M],H=s[M];if(c)var G=m?c(H,j,M,s,a,d):c(j,H,M,a,s,d);if(!(G===void 0?j===H||h(j,H,o,c,d):G)){O=!1;break}U||(U=M=="constructor")}if(O&&!U){var X=a.constructor,ae=s.constructor;X!=ae&&"constructor"in a&&"constructor"in s&&!(typeof X=="function"&&X instanceof X&&typeof ae=="function"&&ae instanceof ae)&&(O=!1)}return d.delete(a),d.delete(s),O}return U4=i,U4}var V4,qU;function pEe(){if(qU)return V4;qU=1;var t=Cy(),e=Md(),r=t(e,"DataView");return V4=r,V4}var $4,HU;function gEe(){if(HU)return $4;HU=1;var t=Cy(),e=Md(),r=t(e,"Promise");return $4=r,$4}var q4,WU;function mEe(){if(WU)return q4;WU=1;var t=Cy(),e=Md(),r=t(e,"Set");return q4=r,q4}var H4,GU;function yEe(){if(GU)return H4;GU=1;var t=Cy(),e=Md(),r=t(e,"WeakMap");return H4=r,H4}var W4,XU;function b3(){if(XU)return W4;XU=1;var t=pEe(),e=vN(),r=gEe(),n=mEe(),i=yEe(),a=Ty(),s=BJ(),o="[object Map]",c="[object Object]",h="[object Promise]",d="[object Set]",m="[object WeakMap]",b="[object DataView]",x=s(t),E=s(e),T=s(r),A=s(n),M=s(i),F=a;return(t&&F(new t(new ArrayBuffer(1)))!=b||e&&F(new e)!=o||r&&F(r.resolve())!=h||n&&F(new n)!=d||i&&F(new i)!=m)&&(F=function(N){var O=a(N),U=O==c?N.constructor:void 0,j=U?s(U):"";if(j)switch(j){case x:return b;case E:return o;case T:return h;case A:return d;case M:return m}return O}),W4=F,W4}var G4,YU;function vEe(){if(YU)return G4;YU=1;var t=bN(),e=zJ(),r=hEe(),n=dEe(),i=b3(),a=Of(),s=cN(),o=RJ(),c=1,h="[object Arguments]",d="[object Array]",m="[object Object]",b=Object.prototype,x=b.hasOwnProperty;function E(T,A,M,F,N,O){var U=a(T),j=a(A),H=U?d:i(T),G=j?d:i(A);H=H==h?m:H,G=G==h?m:G;var X=H==m,ae=G==m,Q=H==G;if(Q&&s(T)){if(!s(A))return!1;U=!0,X=!1}if(Q&&!X)return O||(O=new t),U||o(T)?e(T,A,M,F,N,O):r(T,A,H,M,F,N,O);if(!(M&c)){var W=X&&x.call(T,"__wrapped__"),oe=ae&&x.call(A,"__wrapped__");if(W||oe){var se=W?T.value():T,he=oe?A.value():A;return O||(O=new t),N(se,he,M,F,O)}}return Q?(O||(O=new t),n(T,A,M,F,N,O)):!1}return G4=E,G4}var X4,ZU;function HJ(){if(ZU)return X4;ZU=1;var t=vEe(),e=Rp();function r(n,i,a,s,o){return n===i?!0:n==null||i==null||!e(n)&&!e(i)?n!==n&&i!==i:t(n,i,a,s,r,o)}return X4=r,X4}var Y4,KU;function _Ee(){if(KU)return Y4;KU=1;var t=bN(),e=HJ(),r=1,n=2;function i(a,s,o,c){var h=o.length,d=h,m=!c;if(a==null)return!d;for(a=Object(a);h--;){var b=o[h];if(m&&b[2]?b[1]!==a[b[0]]:!(b[0]in a))return!1}for(;++h<d;){b=o[h];var x=b[0],E=a[x],T=b[1];if(m&&b[2]){if(E===void 0&&!(x in a))return!1}else{var A=new t;if(c)var M=c(E,T,x,a,s,A);if(!(M===void 0?e(T,E,r|n,c,A):M))return!1}}return!0}return Y4=i,Y4}var Z4,JU;function WJ(){if(JU)return Z4;JU=1;var t=__();function e(r){return r===r&&!t(r)}return Z4=e,Z4}var K4,QU;function bEe(){if(QU)return K4;QU=1;var t=WJ(),e=Wx();function r(n){for(var i=e(n),a=i.length;a--;){var s=i[a],o=n[s];i[a]=[s,o,t(o)]}return i}return K4=r,K4}var J4,eV;function GJ(){if(eV)return J4;eV=1;function t(e,r){return function(n){return n==null?!1:n[e]===r&&(r!==void 0||e in Object(n))}}return J4=t,J4}var Q4,tV;function xEe(){if(tV)return Q4;tV=1;var t=_Ee(),e=bEe(),r=GJ();function n(i){var a=e(i);return a.length==1&&a[0][2]?r(a[0][0],a[0][1]):function(s){return s===i||t(s,i,a)}}return Q4=n,Q4}var eI,rV;function wN(){if(rV)return eI;rV=1;var t=Ty(),e=Rp(),r="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&t(i)==r}return eI=n,eI}var tI,nV;function SN(){if(nV)return tI;nV=1;var t=Of(),e=wN(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(t(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return tI=i,tI}var rI,iV;function wEe(){if(iV)return rI;iV=1;var t=_N(),e="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],c=a.cache;if(c.has(o))return c.get(o);var h=n.apply(this,s);return a.cache=c.set(o,h)||c,h};return a.cache=new(r.Cache||t),a}return r.Cache=t,rI=r,rI}var nI,aV;function SEe(){if(aV)return nI;aV=1;var t=wEe(),e=500;function r(n){var i=t(n,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return nI=r,nI}var iI,oV;function EEe(){if(oV)return iI;oV=1;var t=SEe(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,c,h){a.push(c?h.replace(r,"$1"):o||s)}),a});return iI=n,iI}var aI,sV;function TEe(){if(sV)return aI;sV=1;var t=Hx(),e=FJ(),r=Of(),n=wN(),i=t?t.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return e(o,s)+"";if(n(o))return a?a.call(o):"";var c=o+"";return c=="0"&&1/o==-1/0?"-0":c}return aI=s,aI}var oI,lV;function CEe(){if(lV)return oI;lV=1;var t=TEe();function e(r){return r==null?"":t(r)}return oI=e,oI}var sI,uV;function XJ(){if(uV)return sI;uV=1;var t=Of(),e=SN(),r=EEe(),n=CEe();function i(a,s){return t(a)?a:e(a,s)?[a]:r(n(a))}return sI=i,sI}var lI,cV;function x3(){if(cV)return lI;cV=1;var t=wN();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return lI=e,lI}var uI,hV;function YJ(){if(hV)return uI;hV=1;var t=XJ(),e=x3();function r(n,i){i=t(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[e(i[a++])];return a&&a==s?n:void 0}return uI=r,uI}var cI,fV;function AEe(){if(fV)return cI;fV=1;var t=YJ();function e(r,n,i){var a=r==null?void 0:t(r,n);return a===void 0?i:a}return cI=e,cI}var hI,dV;function IEe(){if(dV)return hI;dV=1;function t(e,r){return e!=null&&r in Object(e)}return hI=t,hI}var fI,pV;function PEe(){if(pV)return fI;pV=1;var t=XJ(),e=PJ(),r=Of(),n=kJ(),i=hN(),a=x3();function s(o,c,h){c=t(c,o);for(var d=-1,m=c.length,b=!1;++d<m;){var x=a(c[d]);if(!(b=o!=null&&h(o,x)))break;o=o[x]}return b||++d!=m?b:(m=o==null?0:o.length,!!m&&i(m)&&n(x,m)&&(r(o)||e(o)))}return fI=s,fI}var dI,gV;function kEe(){if(gV)return dI;gV=1;var t=IEe(),e=PEe();function r(n,i){return n!=null&&e(n,i,t)}return dI=r,dI}var pI,mV;function REe(){if(mV)return pI;mV=1;var t=HJ(),e=AEe(),r=kEe(),n=SN(),i=WJ(),a=GJ(),s=x3(),o=1,c=2;function h(d,m){return n(d)&&i(m)?a(s(d),m):function(b){var x=e(b,d);return x===void 0&&x===m?r(b,d):t(m,x,o|c)}}return pI=h,pI}var gI,yV;function MEe(){if(yV)return gI;yV=1;function t(e){return function(r){return r?.[e]}}return gI=t,gI}var mI,vV;function DEe(){if(vV)return mI;vV=1;var t=YJ();function e(r){return function(n){return t(n,r)}}return mI=e,mI}var yI,_V;function OEe(){if(_V)return yI;_V=1;var t=MEe(),e=DEe(),r=SN(),n=x3();function i(a){return r(a)?t(n(a)):e(a)}return yI=i,yI}var vI,bV;function NEe(){if(bV)return vI;bV=1;var t=xEe(),e=REe(),r=LJ(),n=Of(),i=OEe();function a(s){return typeof s=="function"?s:s==null?r:typeof s=="object"?n(s)?e(s[0],s[1]):t(s):i(s)}return vI=a,vI}var _I,xV;function LEe(){if(xV)return _I;xV=1;var t=g3();function e(r,n){return function(i,a){if(i==null)return i;if(!t(i))return r(i,a);for(var s=i.length,o=n?s:-1,c=Object(i);(n?o--:++o<s)&&a(c[o],o,c)!==!1;);return i}}return _I=e,_I}var bI,wV;function FEe(){if(wV)return bI;wV=1;var t=NJ(),e=LEe(),r=e(t);return bI=r,bI}var xI,SV;function BEe(){if(SV)return xI;SV=1;var t=FEe(),e=g3();function r(n,i){var a=-1,s=e(n)?Array(n.length):[];return t(n,function(o,c,h){s[++a]=i(o,c,h)}),s}return xI=r,xI}var wI,EV;function zEe(){if(EV)return wI;EV=1;var t=FJ(),e=NEe(),r=BEe(),n=Of();function i(a,s){var o=n(a)?t:r;return o(a,e(s,3))}return wI=i,wI}var TV;function jEe(){if(TV)return _v;TV=1,Object.defineProperty(_v,"__esModule",{value:!0}),_v.flattenNames=void 0;var t=xSe(),e=c(t),r=gN(),n=c(r),i=RSe(),a=c(i),s=zEe(),o=c(s);function c(d){return d&&d.__esModule?d:{default:d}}var h=_v.flattenNames=function d(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],b=[];return(0,o.default)(m,function(x){Array.isArray(x)?d(x).map(function(E){return b.push(E)}):(0,a.default)(x)?(0,n.default)(x,function(E,T){E===!0&&b.push(T),b.push(T+"-"+E)}):(0,e.default)(x)&&b.push(x)}),b};return _v.default=h,_v}var bv={},SI,CV;function UEe(){if(CV)return SI;CV=1;function t(e,r){for(var n=-1,i=e==null?0:e.length;++n<i&&r(e[n],n,e)!==!1;);return e}return SI=t,SI}var EI,AV;function VEe(){if(AV)return EI;AV=1;var t=Cy(),e=(function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}})();return EI=e,EI}var TI,IV;function ZJ(){if(IV)return TI;IV=1;var t=VEe();function e(r,n,i){n=="__proto__"&&t?t(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return TI=e,TI}var CI,PV;function KJ(){if(PV)return CI;PV=1;var t=ZJ(),e=yN(),r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o){var c=a[s];(!(n.call(a,s)&&e(c,o))||o===void 0&&!(s in a))&&t(a,s,o)}return CI=i,CI}var AI,kV;function w3(){if(kV)return AI;kV=1;var t=KJ(),e=ZJ();function r(n,i,a,s){var o=!a;a||(a={});for(var c=-1,h=i.length;++c<h;){var d=i[c],m=s?s(a[d],n[d],d,a,n):void 0;m===void 0&&(m=n[d]),o?e(a,d,m):t(a,d,m)}return a}return AI=r,AI}var II,RV;function $Ee(){if(RV)return II;RV=1;var t=w3(),e=Wx();function r(n,i){return n&&t(i,e(i),n)}return II=r,II}var PI,MV;function qEe(){if(MV)return PI;MV=1;function t(e){var r=[];if(e!=null)for(var n in Object(e))r.push(n);return r}return PI=t,PI}var kI,DV;function HEe(){if(DV)return kI;DV=1;var t=__(),e=pN(),r=qEe(),n=Object.prototype,i=n.hasOwnProperty;function a(s){if(!t(s))return r(s);var o=e(s),c=[];for(var h in s)h=="constructor"&&(o||!i.call(s,h))||c.push(h);return c}return kI=a,kI}var RI,OV;function EN(){if(OV)return RI;OV=1;var t=MJ(),e=HEe(),r=g3();function n(i){return r(i)?t(i,!0):e(i)}return RI=n,RI}var MI,NV;function WEe(){if(NV)return MI;NV=1;var t=w3(),e=EN();function r(n,i){return n&&t(i,e(i),n)}return MI=r,MI}var V1={exports:{}};V1.exports;var LV;function GEe(){return LV||(LV=1,(function(t,e){var r=Md(),n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===n,s=a?r.Buffer:void 0,o=s?s.allocUnsafe:void 0;function c(h,d){if(d)return h.slice();var m=h.length,b=o?o(m):new h.constructor(m);return h.copy(b),b}t.exports=c})(V1,V1.exports)),V1.exports}var DI,FV;function XEe(){if(FV)return DI;FV=1;function t(e,r){var n=-1,i=e.length;for(r||(r=Array(i));++n<i;)r[n]=e[n];return r}return DI=t,DI}var OI,BV;function YEe(){if(BV)return OI;BV=1;var t=w3(),e=xN();function r(n,i){return t(n,e(n),i)}return OI=r,OI}var NI,zV;function JJ(){if(zV)return NI;zV=1;var t=UJ(),e=mN(),r=xN(),n=$J(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var o=[];s;)t(o,r(s)),s=e(s);return o}:n;return NI=a,NI}var LI,jV;function ZEe(){if(jV)return LI;jV=1;var t=w3(),e=JJ();function r(n,i){return t(n,e(n),i)}return LI=r,LI}var FI,UV;function KEe(){if(UV)return FI;UV=1;var t=VJ(),e=JJ(),r=EN();function n(i){return t(i,r,e)}return FI=n,FI}var BI,VV;function JEe(){if(VV)return BI;VV=1;var t=Object.prototype,e=t.hasOwnProperty;function r(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&e.call(n,"index")&&(a.index=n.index,a.input=n.input),a}return BI=r,BI}var zI,$V;function TN(){if($V)return zI;$V=1;var t=jJ();function e(r){var n=new r.constructor(r.byteLength);return new t(n).set(new t(r)),n}return zI=e,zI}var jI,qV;function QEe(){if(qV)return jI;qV=1;var t=TN();function e(r,n){var i=n?t(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return jI=e,jI}var UI,HV;function eTe(){if(HV)return UI;HV=1;var t=/\w*$/;function e(r){var n=new r.constructor(r.source,t.exec(r));return n.lastIndex=r.lastIndex,n}return UI=e,UI}var VI,WV;function tTe(){if(WV)return VI;WV=1;var t=Hx(),e=t?t.prototype:void 0,r=e?e.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return VI=n,VI}var $I,GV;function rTe(){if(GV)return $I;GV=1;var t=TN();function e(r,n){var i=n?t(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return $I=e,$I}var qI,XV;function nTe(){if(XV)return qI;XV=1;var t=TN(),e=QEe(),r=eTe(),n=tTe(),i=rTe(),a="[object Boolean]",s="[object Date]",o="[object Map]",c="[object Number]",h="[object RegExp]",d="[object Set]",m="[object String]",b="[object Symbol]",x="[object ArrayBuffer]",E="[object DataView]",T="[object Float32Array]",A="[object Float64Array]",M="[object Int8Array]",F="[object Int16Array]",N="[object Int32Array]",O="[object Uint8Array]",U="[object Uint8ClampedArray]",j="[object Uint16Array]",H="[object Uint32Array]";function G(X,ae,Q){var W=X.constructor;switch(ae){case x:return t(X);case a:case s:return new W(+X);case E:return e(X,Q);case T:case A:case M:case F:case N:case O:case U:case j:case H:return i(X,Q);case o:return new W;case c:case m:return new W(X);case h:return r(X);case d:return new W;case b:return n(X)}}return qI=G,qI}var HI,YV;function iTe(){if(YV)return HI;YV=1;var t=__(),e=Object.create,r=(function(){function n(){}return function(i){if(!t(i))return{};if(e)return e(i);n.prototype=i;var a=new n;return n.prototype=void 0,a}})();return HI=r,HI}var WI,ZV;function aTe(){if(ZV)return WI;ZV=1;var t=iTe(),e=mN(),r=pN();function n(i){return typeof i.constructor=="function"&&!r(i)?t(e(i)):{}}return WI=n,WI}var GI,KV;function oTe(){if(KV)return GI;KV=1;var t=b3(),e=Rp(),r="[object Map]";function n(i){return e(i)&&t(i)==r}return GI=n,GI}var XI,JV;function sTe(){if(JV)return XI;JV=1;var t=oTe(),e=fN(),r=dN(),n=r&&r.isMap,i=n?e(n):t;return XI=i,XI}var YI,QV;function lTe(){if(QV)return YI;QV=1;var t=b3(),e=Rp(),r="[object Set]";function n(i){return e(i)&&t(i)==r}return YI=n,YI}var ZI,e$;function uTe(){if(e$)return ZI;e$=1;var t=lTe(),e=fN(),r=dN(),n=r&&r.isSet,i=n?e(n):t;return ZI=i,ZI}var KI,t$;function cTe(){if(t$)return KI;t$=1;var t=bN(),e=UEe(),r=KJ(),n=$Ee(),i=WEe(),a=GEe(),s=XEe(),o=YEe(),c=ZEe(),h=qJ(),d=KEe(),m=b3(),b=JEe(),x=nTe(),E=aTe(),T=Of(),A=cN(),M=sTe(),F=__(),N=uTe(),O=Wx(),U=EN(),j=1,H=2,G=4,X="[object Arguments]",ae="[object Array]",Q="[object Boolean]",W="[object Date]",oe="[object Error]",se="[object Function]",he="[object GeneratorFunction]",_e="[object Map]",Ce="[object Number]",me="[object Object]",xe="[object RegExp]",Ae="[object Set]",De="[object String]",de="[object Symbol]",Ee="[object WeakMap]",we="[object ArrayBuffer]",Le="[object DataView]",Fe="[object Float32Array]",Xe="[object Float64Array]",Be="[object Int8Array]",ot="[object Int16Array]",Qe="[object Int32Array]",rt="[object Uint8Array]",Re="[object Uint8ClampedArray]",zt="[object Uint16Array]",st="[object Uint32Array]",$e={};$e[X]=$e[ae]=$e[we]=$e[Le]=$e[Q]=$e[W]=$e[Fe]=$e[Xe]=$e[Be]=$e[ot]=$e[Qe]=$e[_e]=$e[Ce]=$e[me]=$e[xe]=$e[Ae]=$e[De]=$e[de]=$e[rt]=$e[Re]=$e[zt]=$e[st]=!0,$e[oe]=$e[se]=$e[Ee]=!1;function Jt(Ht,pr,_t,vr,br,lr){var Cr,Tr=pr&j,Qt=pr&H,at=pr&G;if(_t&&(Cr=br?_t(Ht,vr,br,lr):_t(Ht)),Cr!==void 0)return Cr;if(!F(Ht))return Ht;var ke=T(Ht);if(ke){if(Cr=b(Ht),!Tr)return s(Ht,Cr)}else{var be=m(Ht),je=be==se||be==he;if(A(Ht))return a(Ht,Tr);if(be==me||be==X||je&&!br){if(Cr=Qt||je?{}:E(Ht),!Tr)return Qt?c(Ht,i(Cr,Ht)):o(Ht,n(Cr,Ht))}else{if(!$e[be])return br?Ht:{};Cr=x(Ht,be,Tr)}}lr||(lr=new t);var qe=lr.get(Ht);if(qe)return qe;lr.set(Ht,Cr),N(Ht)?Ht.forEach(function(Et){Cr.add(Jt(Et,pr,_t,Et,Ht,lr))}):M(Ht)&&Ht.forEach(function(Et,mt){Cr.set(mt,Jt(Et,pr,_t,mt,Ht,lr))});var We=at?Qt?d:h:Qt?U:O,Lt=ke?void 0:We(Ht);return e(Lt||Ht,function(Et,mt){Lt&&(mt=Et,Et=Ht[mt]),r(Cr,mt,Jt(Et,pr,_t,mt,Ht,lr))}),Cr}return KI=Jt,KI}var JI,r$;function hTe(){if(r$)return JI;r$=1;var t=cTe(),e=1,r=4;function n(i){return t(i,e|r)}return JI=n,JI}var n$;function fTe(){if(n$)return bv;n$=1,Object.defineProperty(bv,"__esModule",{value:!0}),bv.mergeClasses=void 0;var t=gN(),e=a(t),r=hTe(),n=a(r),i=Object.assign||function(o){for(var c=1;c<arguments.length;c++){var h=arguments[c];for(var d in h)Object.prototype.hasOwnProperty.call(h,d)&&(o[d]=h[d])}return o};function a(o){return o&&o.__esModule?o:{default:o}}var s=bv.mergeClasses=function(c){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],d=c.default&&(0,n.default)(c.default)||{};return h.map(function(m){var b=c[m];return b&&(0,e.default)(b,function(x,E){d[E]||(d[E]={}),d[E]=i({},d[E],b[E])}),m}),d};return bv.default=s,bv}var xv={},i$;function dTe(){if(i$)return xv;i$=1,Object.defineProperty(xv,"__esModule",{value:!0}),xv.autoprefix=void 0;var t=gN(),e=n(t),r=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(s[h]=c[h])}return s};function n(s){return s&&s.__esModule?s:{default:s}}var i={borderRadius:function(o){return{msBorderRadius:o,MozBorderRadius:o,OBorderRadius:o,WebkitBorderRadius:o,borderRadius:o}},boxShadow:function(o){return{msBoxShadow:o,MozBoxShadow:o,OBoxShadow:o,WebkitBoxShadow:o,boxShadow:o}},userSelect:function(o){return{WebkitTouchCallout:o,KhtmlUserSelect:o,MozUserSelect:o,msUserSelect:o,WebkitUserSelect:o,userSelect:o}},flex:function(o){return{WebkitBoxFlex:o,MozBoxFlex:o,WebkitFlex:o,msFlex:o,flex:o}},flexBasis:function(o){return{WebkitFlexBasis:o,flexBasis:o}},justifyContent:function(o){return{WebkitJustifyContent:o,justifyContent:o}},transition:function(o){return{msTransition:o,MozTransition:o,OTransition:o,WebkitTransition:o,transition:o}},transform:function(o){return{msTransform:o,MozTransform:o,OTransform:o,WebkitTransform:o,transform:o}},absolute:function(o){var c=o&&o.split(" ");return{position:"absolute",top:c&&c[0],right:c&&c[1],bottom:c&&c[2],left:c&&c[3]}},extend:function(o,c){var h=c[o];return h||{extend:o}}},a=xv.autoprefix=function(o){var c={};return(0,e.default)(o,function(h,d){var m={};(0,e.default)(h,function(b,x){var E=i[x];E?m=r({},m,E(b)):m[x]=b}),c[d]=m}),c};return xv.default=a,xv}var wv={},a$;function pTe(){if(a$)return wv;a$=1,Object.defineProperty(wv,"__esModule",{value:!0}),wv.hover=void 0;var t=Object.assign||function(c){for(var h=1;h<arguments.length;h++){var d=arguments[h];for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(c[m]=d[m])}return c},e=xx(),r=n(e);function n(c){return c&&c.__esModule?c:{default:c}}function i(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")}function a(c,h){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:c}function s(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(c,h):c.__proto__=h)}var o=wv.hover=function(h){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(m){s(b,m);function b(){var x,E,T,A;i(this,b);for(var M=arguments.length,F=Array(M),N=0;N<M;N++)F[N]=arguments[N];return A=(E=(T=a(this,(x=b.__proto__||Object.getPrototypeOf(b)).call.apply(x,[this].concat(F))),T),T.state={hover:!1},T.handleMouseOver=function(){return T.setState({hover:!0})},T.handleMouseOut=function(){return T.setState({hover:!1})},T.render=function(){return r.default.createElement(d,{onMouseOver:T.handleMouseOver,onMouseOut:T.handleMouseOut},r.default.createElement(h,t({},T.props,T.state)))},E),a(T,A)}return b})(r.default.Component)};return wv.default=o,wv}var Sv={},o$;function gTe(){if(o$)return Sv;o$=1,Object.defineProperty(Sv,"__esModule",{value:!0}),Sv.active=void 0;var t=Object.assign||function(c){for(var h=1;h<arguments.length;h++){var d=arguments[h];for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(c[m]=d[m])}return c},e=xx(),r=n(e);function n(c){return c&&c.__esModule?c:{default:c}}function i(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")}function a(c,h){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:c}function s(c,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);c.prototype=Object.create(h&&h.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(c,h):c.__proto__=h)}var o=Sv.active=function(h){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(m){s(b,m);function b(){var x,E,T,A;i(this,b);for(var M=arguments.length,F=Array(M),N=0;N<M;N++)F[N]=arguments[N];return A=(E=(T=a(this,(x=b.__proto__||Object.getPrototypeOf(b)).call.apply(x,[this].concat(F))),T),T.state={active:!1},T.handleMouseDown=function(){return T.setState({active:!0})},T.handleMouseUp=function(){return T.setState({active:!1})},T.render=function(){return r.default.createElement(d,{onMouseDown:T.handleMouseDown,onMouseUp:T.handleMouseUp},r.default.createElement(h,t({},T.props,T.state)))},E),a(T,A)}return b})(r.default.Component)};return Sv.default=o,Sv}var kw={},s$;function mTe(){if(s$)return kw;s$=1,Object.defineProperty(kw,"__esModule",{value:!0});var t=function(r,n){var i={},a=function(o){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;i[o]=c};return r===0&&a("first-child"),r===n-1&&a("last-child"),(r===0||r%2===0)&&a("even"),Math.abs(r%2)===1&&a("odd"),a("nth-child",r),i};return kw.default=t,kw}var l$;function yTe(){if(l$)return Tc;l$=1,Object.defineProperty(Tc,"__esModule",{value:!0}),Tc.ReactCSS=Tc.loop=Tc.handleActive=Tc.handleHover=Tc.hover=void 0;var t=jEe(),e=b(t),r=fTe(),n=b(r),i=dTe(),a=b(i),s=pTe(),o=b(s),c=gTe(),h=b(c),d=mTe(),m=b(d);function b(E){return E&&E.__esModule?E:{default:E}}Tc.hover=o.default,Tc.handleHover=o.default,Tc.handleActive=h.default,Tc.loop=m.default;var x=Tc.ReactCSS=function(T){for(var A=arguments.length,M=Array(A>1?A-1:0),F=1;F<A;F++)M[F-1]=arguments[F];var N=(0,e.default)(M),O=(0,n.default)(T,N);return(0,a.default)(O)};return Tc.default=x,Tc}var CN=yTe();const Li=Id(CN);var vTe=function(e,r,n,i,a){var s=a.clientWidth,o=a.clientHeight,c=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,h=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,d=c-(a.getBoundingClientRect().left+window.pageXOffset),m=h-(a.getBoundingClientRect().top+window.pageYOffset);if(n==="vertical"){var b=void 0;if(m<0?b=0:m>o?b=1:b=Math.round(m*100/o)/100,r.a!==b)return{h:r.h,s:r.s,l:r.l,a:b,source:"rgb"}}else{var x=void 0;if(d<0?x=0:d>s?x=1:x=Math.round(d*100/s)/100,i!==x)return{h:r.h,s:r.s,l:r.l,a:x,source:"rgb"}}return null},QI={},_Te=function(e,r,n,i){if(typeof document>"u"&&!i)return null;var a=i?new i:document.createElement("canvas");a.width=n*2,a.height=n*2;var s=a.getContext("2d");return s?(s.fillStyle=e,s.fillRect(0,0,a.width,a.height),s.fillStyle=r,s.fillRect(0,0,n,n),s.translate(n,n),s.fillRect(0,0,n,n),a.toDataURL()):null},bTe=function(e,r,n,i){var a=e+"-"+r+"-"+n+(i?"-server":"");if(QI[a])return QI[a];var s=_Te(e,r,n,i);return QI[a]=s,s},u$=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},b_=function(e){var r=e.white,n=e.grey,i=e.size,a=e.renderers,s=e.borderRadius,o=e.boxShadow,c=e.children,h=Li({default:{grid:{borderRadius:s,boxShadow:o,absolute:"0px 0px 0px 0px",background:"url("+bTe(r,n,i,a.canvas)+") center left"}}});return te.isValidElement(c)?gt.cloneElement(c,u$({},c.props,{style:u$({},c.props.style,h.grid)})):gt.createElement("div",{style:h.grid})};b_.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}};var xTe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wTe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function STe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c$(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function ETe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var AN=(function(t){ETe(e,t);function e(){var r,n,i,a;STe(this,e);for(var s=arguments.length,o=Array(s),c=0;c<s;c++)o[c]=arguments[c];return a=(n=(i=c$(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(o))),i),i.handleChange=function(h){var d=vTe(h,i.props.hsl,i.props.direction,i.props.a,i.container);d&&typeof i.props.onChange=="function"&&i.props.onChange(d,h)},i.handleMouseDown=function(h){i.handleChange(h),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},i.unbindEventListeners=function(){window.removeEventListener("mousemove",i.handleChange),window.removeEventListener("mouseup",i.handleMouseUp)},n),c$(i,a)}return wTe(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var n=this,i=this.props.rgb,a=Li({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:i.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)"},pointer:{left:0,top:i.a*100+"%"}},overwrite:xTe({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return gt.createElement("div",{style:a.alpha},gt.createElement("div",{style:a.checkboard},gt.createElement(b_,{renderers:this.props.renderers})),gt.createElement("div",{style:a.gradient}),gt.createElement("div",{style:a.container,ref:function(o){return n.container=o},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},gt.createElement("div",{style:a.pointer},this.props.pointer?gt.createElement(this.props.pointer,this.props):gt.createElement("div",{style:a.slider}))))}}]),e})(te.PureComponent||te.Component),TTe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function CTe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ATe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ITe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function PTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var kTe=1,QJ=38,RTe=40,MTe=[QJ,RTe],DTe=function(e){return MTe.indexOf(e)>-1},OTe=function(e){return Number(String(e).replace(/%/g,""))},NTe=1,ya=(function(t){PTe(e,t);function e(r){ATe(this,e);var n=ITe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.handleBlur=function(){n.state.blurValue&&n.setState({value:n.state.blurValue,blurValue:null})},n.handleChange=function(i){n.setUpdatedValue(i.target.value,i)},n.handleKeyDown=function(i){var a=OTe(i.target.value);if(!isNaN(a)&&DTe(i.keyCode)){var s=n.getArrowOffset(),o=i.keyCode===QJ?a+s:a-s;n.setUpdatedValue(o,i)}},n.handleDrag=function(i){if(n.props.dragLabel){var a=Math.round(n.props.value+i.movementX);a>=0&&a<=n.props.dragMax&&n.props.onChange&&n.props.onChange(n.getValueObjectWithLabel(a),i)}},n.handleMouseDown=function(i){n.props.dragLabel&&(i.preventDefault(),n.handleDrag(i),window.addEventListener("mousemove",n.handleDrag),window.addEventListener("mouseup",n.handleMouseUp))},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.handleMouseUp)},n.state={value:String(r.value).toUpperCase(),blurValue:String(r.value).toUpperCase()},n.inputId="rc-editable-input-"+NTe++,n}return TTe(e,[{key:"componentDidUpdate",value:function(n,i){this.props.value!==this.state.value&&(n.value!==this.props.value||i.value!==this.state.value)&&(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(n){return CTe({},this.props.label,n)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||kTe}},{key:"setUpdatedValue",value:function(n,i){var a=this.props.label?this.getValueObjectWithLabel(n):n;this.props.onChange&&this.props.onChange(a,i),this.setState({value:n})}},{key:"render",value:function(){var n=this,i=Li({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return gt.createElement("div",{style:i.wrap},gt.createElement("input",{id:this.inputId,style:i.input,ref:function(s){return n.input=s},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?gt.createElement("label",{htmlFor:this.inputId,style:i.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),e})(te.PureComponent||te.Component),LTe=function(e,r,n,i){var a=i.clientWidth,s=i.clientHeight,o=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,h=o-(i.getBoundingClientRect().left+window.pageXOffset),d=c-(i.getBoundingClientRect().top+window.pageYOffset);if(r==="vertical"){var m=void 0;if(d<0)m=359;else if(d>s)m=0;else{var b=-(d*100/s)+100;m=360*b/100}if(n.h!==m)return{h:m,s:n.s,l:n.l,a:n.a,source:"hsl"}}else{var x=void 0;if(h<0)x=0;else if(h>a)x=359;else{var E=h*100/a;x=360*E/100}if(n.h!==x)return{h:x,s:n.s,l:n.l,a:n.a,source:"hsl"}}return null},FTe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function BTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h$(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function zTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var x_=(function(t){zTe(e,t);function e(){var r,n,i,a;BTe(this,e);for(var s=arguments.length,o=Array(s),c=0;c<s;c++)o[c]=arguments[c];return a=(n=(i=h$(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(o))),i),i.handleChange=function(h){var d=LTe(h,i.props.direction,i.props.hsl,i.container);d&&typeof i.props.onChange=="function"&&i.props.onChange(d,h)},i.handleMouseDown=function(h){i.handleChange(h),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},n),h$(i,a)}return FTe(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.direction,a=i===void 0?"horizontal":i,s=Li({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:a==="vertical"});return gt.createElement("div",{style:s.hue},gt.createElement("div",{className:"hue-"+a,style:s.container,ref:function(c){return n.container=c},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},gt.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),gt.createElement("div",{style:s.pointer},this.props.pointer?gt.createElement(this.props.pointer,this.props):gt.createElement("div",{style:s.slider}))))}}]),e})(te.PureComponent||te.Component);function jTe(){this.__data__=[],this.size=0}function Gx(t,e){return t===e||t!==t&&e!==e}function S3(t,e){for(var r=t.length;r--;)if(Gx(t[r][0],e))return r;return-1}var UTe=Array.prototype,VTe=UTe.splice;function $Te(t){var e=this.__data__,r=S3(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():VTe.call(e,r,1),--this.size,!0}function qTe(t){var e=this.__data__,r=S3(e,t);return r<0?void 0:e[r][1]}function HTe(t){return S3(this.__data__,t)>-1}function WTe(t,e){var r=this.__data__,n=S3(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function Mp(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Mp.prototype.clear=jTe;Mp.prototype.delete=$Te;Mp.prototype.get=qTe;Mp.prototype.has=HTe;Mp.prototype.set=WTe;function GTe(){this.__data__=new Mp,this.size=0}function XTe(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function YTe(t){return this.__data__.get(t)}function ZTe(t){return this.__data__.has(t)}var eQ=typeof global=="object"&&global&&global.Object===Object&&global,KTe=typeof self=="object"&&self&&self.Object===Object&&self,Nf=eQ||KTe||Function("return this")(),kg=Nf.Symbol,tQ=Object.prototype,JTe=tQ.hasOwnProperty,QTe=tQ.toString,u1=kg?kg.toStringTag:void 0;function e3e(t){var e=JTe.call(t,u1),r=t[u1];try{t[u1]=void 0;var n=!0}catch{}var i=QTe.call(t);return n&&(e?t[u1]=r:delete t[u1]),i}var t3e=Object.prototype,r3e=t3e.toString;function n3e(t){return r3e.call(t)}var i3e="[object Null]",a3e="[object Undefined]",f$=kg?kg.toStringTag:void 0;function Ay(t){return t==null?t===void 0?a3e:i3e:f$&&f$ in Object(t)?e3e(t):n3e(t)}function Xh(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var o3e="[object AsyncFunction]",s3e="[object Function]",l3e="[object GeneratorFunction]",u3e="[object Proxy]";function IN(t){if(!Xh(t))return!1;var e=Ay(t);return e==s3e||e==l3e||e==o3e||e==u3e}var eP=Nf["__core-js_shared__"],d$=(function(){var t=/[^.]+$/.exec(eP&&eP.keys&&eP.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function c3e(t){return!!d$&&d$ in t}var h3e=Function.prototype,f3e=h3e.toString;function Iy(t){if(t!=null){try{return f3e.call(t)}catch{}try{return t+""}catch{}}return""}var d3e=/[\\^$.*+?()[\]{}|]/g,p3e=/^\[object .+?Constructor\]$/,g3e=Function.prototype,m3e=Object.prototype,y3e=g3e.toString,v3e=m3e.hasOwnProperty,_3e=RegExp("^"+y3e.call(v3e).replace(d3e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function b3e(t){if(!Xh(t)||c3e(t))return!1;var e=IN(t)?_3e:p3e;return e.test(Iy(t))}function x3e(t,e){return t?.[e]}function Py(t,e){var r=x3e(t,e);return b3e(r)?r:void 0}var Qb=Py(Nf,"Map"),ex=Py(Object,"create");function w3e(){this.__data__=ex?ex(null):{},this.size=0}function S3e(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var E3e="__lodash_hash_undefined__",T3e=Object.prototype,C3e=T3e.hasOwnProperty;function A3e(t){var e=this.__data__;if(ex){var r=e[t];return r===E3e?void 0:r}return C3e.call(e,t)?e[t]:void 0}var I3e=Object.prototype,P3e=I3e.hasOwnProperty;function k3e(t){var e=this.__data__;return ex?e[t]!==void 0:P3e.call(e,t)}var R3e="__lodash_hash_undefined__";function M3e(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=ex&&e===void 0?R3e:e,this}function ay(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ay.prototype.clear=w3e;ay.prototype.delete=S3e;ay.prototype.get=A3e;ay.prototype.has=k3e;ay.prototype.set=M3e;function D3e(){this.size=0,this.__data__={hash:new ay,map:new(Qb||Mp),string:new ay}}function O3e(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function E3(t,e){var r=t.__data__;return O3e(e)?r[typeof e=="string"?"string":"hash"]:r.map}function N3e(t){var e=E3(this,t).delete(t);return this.size-=e?1:0,e}function L3e(t){return E3(this,t).get(t)}function F3e(t){return E3(this,t).has(t)}function B3e(t,e){var r=E3(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function Dp(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Dp.prototype.clear=D3e;Dp.prototype.delete=N3e;Dp.prototype.get=L3e;Dp.prototype.has=F3e;Dp.prototype.set=B3e;var z3e=200;function j3e(t,e){var r=this.__data__;if(r instanceof Mp){var n=r.__data__;if(!Qb||n.length<z3e-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Dp(n)}return r.set(t,e),this.size=r.size,this}function xd(t){var e=this.__data__=new Mp(t);this.size=e.size}xd.prototype.clear=GTe;xd.prototype.delete=XTe;xd.prototype.get=YTe;xd.prototype.has=ZTe;xd.prototype.set=j3e;var xE=(function(){try{var t=Py(Object,"defineProperty");return t({},"",{}),t}catch{}})();function PN(t,e,r){e=="__proto__"&&xE?xE(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function VR(t,e,r){(r!==void 0&&!Gx(t[e],r)||r===void 0&&!(e in t))&&PN(t,e,r)}function U3e(t){return function(e,r,n){for(var i=-1,a=Object(e),s=n(e),o=s.length;o--;){var c=s[++i];if(r(a[c],c,a)===!1)break}return e}}var rQ=U3e(),nQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,p$=nQ&&typeof module=="object"&&module&&!module.nodeType&&module,V3e=p$&&p$.exports===nQ,g$=V3e?Nf.Buffer:void 0;g$&&g$.allocUnsafe;function $3e(t,e){return t.slice()}var wE=Nf.Uint8Array;function q3e(t){var e=new t.constructor(t.byteLength);return new wE(e).set(new wE(t)),e}function H3e(t,e){var r=q3e(t.buffer);return new t.constructor(r,t.byteOffset,t.length)}function W3e(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var m$=Object.create,G3e=(function(){function t(){}return function(e){if(!Xh(e))return{};if(m$)return m$(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();function iQ(t,e){return function(r){return t(e(r))}}var aQ=iQ(Object.getPrototypeOf,Object),X3e=Object.prototype;function kN(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||X3e;return t===r}function Y3e(t){return typeof t.constructor=="function"&&!kN(t)?G3e(aQ(t)):{}}function Rg(t){return t!=null&&typeof t=="object"}var Z3e="[object Arguments]";function y$(t){return Rg(t)&&Ay(t)==Z3e}var oQ=Object.prototype,K3e=oQ.hasOwnProperty,J3e=oQ.propertyIsEnumerable,SE=y$((function(){return arguments})())?y$:function(t){return Rg(t)&&K3e.call(t,"callee")&&!J3e.call(t,"callee")},ph=Array.isArray,Q3e=9007199254740991;function RN(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Q3e}function w_(t){return t!=null&&RN(t.length)&&!IN(t)}function eCe(t){return Rg(t)&&w_(t)}function tCe(){return!1}var sQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,v$=sQ&&typeof module=="object"&&module&&!module.nodeType&&module,rCe=v$&&v$.exports===sQ,_$=rCe?Nf.Buffer:void 0,nCe=_$?_$.isBuffer:void 0,EE=nCe||tCe,iCe="[object Object]",aCe=Function.prototype,oCe=Object.prototype,lQ=aCe.toString,sCe=oCe.hasOwnProperty,lCe=lQ.call(Object);function uCe(t){if(!Rg(t)||Ay(t)!=iCe)return!1;var e=aQ(t);if(e===null)return!0;var r=sCe.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&lQ.call(r)==lCe}var cCe="[object Arguments]",hCe="[object Array]",fCe="[object Boolean]",dCe="[object Date]",pCe="[object Error]",gCe="[object Function]",mCe="[object Map]",yCe="[object Number]",vCe="[object Object]",_Ce="[object RegExp]",bCe="[object Set]",xCe="[object String]",wCe="[object WeakMap]",SCe="[object ArrayBuffer]",ECe="[object DataView]",TCe="[object Float32Array]",CCe="[object Float64Array]",ACe="[object Int8Array]",ICe="[object Int16Array]",PCe="[object Int32Array]",kCe="[object Uint8Array]",RCe="[object Uint8ClampedArray]",MCe="[object Uint16Array]",DCe="[object Uint32Array]",Ko={};Ko[TCe]=Ko[CCe]=Ko[ACe]=Ko[ICe]=Ko[PCe]=Ko[kCe]=Ko[RCe]=Ko[MCe]=Ko[DCe]=!0;Ko[cCe]=Ko[hCe]=Ko[SCe]=Ko[fCe]=Ko[ECe]=Ko[dCe]=Ko[pCe]=Ko[gCe]=Ko[mCe]=Ko[yCe]=Ko[vCe]=Ko[_Ce]=Ko[bCe]=Ko[xCe]=Ko[wCe]=!1;function OCe(t){return Rg(t)&&RN(t.length)&&!!Ko[Ay(t)]}function NCe(t){return function(e){return t(e)}}var uQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,vb=uQ&&typeof module=="object"&&module&&!module.nodeType&&module,LCe=vb&&vb.exports===uQ,tP=LCe&&eQ.process,b$=(function(){try{var t=vb&&vb.require&&vb.require("util").types;return t||tP&&tP.binding&&tP.binding("util")}catch{}})(),x$=b$&&b$.isTypedArray,MN=x$?NCe(x$):OCe;function $R(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var FCe=Object.prototype,BCe=FCe.hasOwnProperty;function zCe(t,e,r){var n=t[e];(!(BCe.call(t,e)&&Gx(n,r))||r===void 0&&!(e in t))&&PN(t,e,r)}function jCe(t,e,r,n){var i=!r;r||(r={});for(var a=-1,s=e.length;++a<s;){var o=e[a],c=void 0;c===void 0&&(c=t[o]),i?PN(r,o,c):zCe(r,o,c)}return r}function UCe(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var VCe=9007199254740991,$Ce=/^(?:0|[1-9]\d*)$/;function DN(t,e){var r=typeof t;return e=e??VCe,!!e&&(r=="number"||r!="symbol"&&$Ce.test(t))&&t>-1&&t%1==0&&t<e}var qCe=Object.prototype,HCe=qCe.hasOwnProperty;function cQ(t,e){var r=ph(t),n=!r&&SE(t),i=!r&&!n&&EE(t),a=!r&&!n&&!i&&MN(t),s=r||n||i||a,o=s?UCe(t.length,String):[],c=o.length;for(var h in t)(e||HCe.call(t,h))&&!(s&&(h=="length"||i&&(h=="offset"||h=="parent")||a&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||DN(h,c)))&&o.push(h);return o}function WCe(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var GCe=Object.prototype,XCe=GCe.hasOwnProperty;function YCe(t){if(!Xh(t))return WCe(t);var e=kN(t),r=[];for(var n in t)n=="constructor"&&(e||!XCe.call(t,n))||r.push(n);return r}function hQ(t){return w_(t)?cQ(t,!0):YCe(t)}function ZCe(t){return jCe(t,hQ(t))}function KCe(t,e,r,n,i,a,s){var o=$R(t,r),c=$R(e,r),h=s.get(c);if(h){VR(t,r,h);return}var d=a?a(o,c,r+"",t,e,s):void 0,m=d===void 0;if(m){var b=ph(c),x=!b&&EE(c),E=!b&&!x&&MN(c);d=c,b||x||E?ph(o)?d=o:eCe(o)?d=W3e(o):x?(m=!1,d=$3e(c)):E?(m=!1,d=H3e(c)):d=[]:uCe(c)||SE(c)?(d=o,SE(o)?d=ZCe(o):(!Xh(o)||IN(o))&&(d=Y3e(c))):m=!1}m&&(s.set(c,d),i(d,c,n,a,s),s.delete(c)),VR(t,r,d)}function fQ(t,e,r,n,i){t!==e&&rQ(e,function(a,s){if(i||(i=new xd),Xh(a))KCe(t,e,s,r,fQ,n,i);else{var o=n?n($R(t,s),a,s+"",t,e,i):void 0;o===void 0&&(o=a),VR(t,s,o)}},hQ)}function T3(t){return t}function JCe(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var w$=Math.max;function QCe(t,e,r){return e=w$(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=w$(n.length-e,0),s=Array(a);++i<a;)s[i]=n[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=n[i];return o[e]=r(s),JCe(t,this,o)}}function eAe(t){return function(){return t}}var tAe=xE?function(t,e){return xE(t,"toString",{configurable:!0,enumerable:!1,value:eAe(e),writable:!0})}:T3,rAe=800,nAe=16,iAe=Date.now;function aAe(t){var e=0,r=0;return function(){var n=iAe(),i=nAe-(n-r);if(r=n,i>0){if(++e>=rAe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var oAe=aAe(tAe);function sAe(t,e){return oAe(QCe(t,e,T3),t+"")}function lAe(t,e,r){if(!Xh(r))return!1;var n=typeof e;return(n=="number"?w_(r)&&DN(e,r.length):n=="string"&&e in r)?Gx(r[e],t):!1}function uAe(t){return sAe(function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,s&&lAe(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var o=r[n];o&&t(e,o,n,a)}return e})}var Bc=uAe(function(t,e,r){fQ(t,e,r)}),Xx=function(e){var r=e.zDepth,n=e.radius,i=e.background,a=e.children,s=e.styles,o=s===void 0?{}:s,c=Li(Bc({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+r+"px "+r*4+"px rgba(0,0,0,.24)",borderRadius:n,background:i}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},o),{"zDepth-1":r===1});return gt.createElement("div",{style:c.wrap},gt.createElement("div",{style:c.bg}),gt.createElement("div",{style:c.content},a))};Xx.propTypes={background:Rn.string,zDepth:Rn.oneOf([0,1,2,3,4,5]),radius:Rn.number,styles:Rn.object};Xx.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}};var rP=function(){return Nf.Date.now()},cAe=/\s/;function hAe(t){for(var e=t.length;e--&&cAe.test(t.charAt(e)););return e}var fAe=/^\s+/;function dAe(t){return t&&t.slice(0,hAe(t)+1).replace(fAe,"")}var pAe="[object Symbol]";function C3(t){return typeof t=="symbol"||Rg(t)&&Ay(t)==pAe}var S$=NaN,gAe=/^[-+]0x[0-9a-f]+$/i,mAe=/^0b[01]+$/i,yAe=/^0o[0-7]+$/i,vAe=parseInt;function E$(t){if(typeof t=="number")return t;if(C3(t))return S$;if(Xh(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Xh(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=dAe(t);var r=mAe.test(t);return r||yAe.test(t)?vAe(t.slice(2),r?2:8):gAe.test(t)?S$:+t}var _Ae="Expected a function",bAe=Math.max,xAe=Math.min;function dQ(t,e,r){var n,i,a,s,o,c,h=0,d=!1,m=!1,b=!0;if(typeof t!="function")throw new TypeError(_Ae);e=E$(e)||0,Xh(r)&&(d=!!r.leading,m="maxWait"in r,a=m?bAe(E$(r.maxWait)||0,e):a,b="trailing"in r?!!r.trailing:b);function x(j){var H=n,G=i;return n=i=void 0,h=j,s=t.apply(G,H),s}function E(j){return h=j,o=setTimeout(M,e),d?x(j):s}function T(j){var H=j-c,G=j-h,X=e-H;return m?xAe(X,a-G):X}function A(j){var H=j-c,G=j-h;return c===void 0||H>=e||H<0||m&&G>=a}function M(){var j=rP();if(A(j))return F(j);o=setTimeout(M,T(j))}function F(j){return o=void 0,b&&n?x(j):(n=i=void 0,s)}function N(){o!==void 0&&clearTimeout(o),h=0,n=c=i=o=void 0}function O(){return o===void 0?s:F(rP())}function U(){var j=rP(),H=A(j);if(n=arguments,i=this,c=j,H){if(o===void 0)return E(c);if(m)return clearTimeout(o),o=setTimeout(M,e),x(c)}return o===void 0&&(o=setTimeout(M,e)),s}return U.cancel=N,U.flush=O,U}var wAe="Expected a function";function SAe(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(wAe);return Xh(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),dQ(t,e,{leading:n,maxWait:e,trailing:i})}var EAe=function(e,r,n){var i=n.getBoundingClientRect(),a=i.width,s=i.height,o=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,h=o-(n.getBoundingClientRect().left+window.pageXOffset),d=c-(n.getBoundingClientRect().top+window.pageYOffset);h<0?h=0:h>a&&(h=a),d<0?d=0:d>s&&(d=s);var m=h/a,b=1-d/s;return{h:r.h,s:m,v:b,a:r.a,source:"hsv"}},TAe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function CAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AAe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function IAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var A3=(function(t){IAe(e,t);function e(r){CAe(this,e);var n=AAe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r));return n.handleChange=function(i){typeof n.props.onChange=="function"&&n.throttle(n.props.onChange,EAe(i,n.props.hsl,n.container),i)},n.handleMouseDown=function(i){n.handleChange(i);var a=n.getContainerRenderWindow();a.addEventListener("mousemove",n.handleChange),a.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.throttle=SAe(function(i,a,s){i(a,s)},50),n}return TAe(e,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"getContainerRenderWindow",value:function(){for(var n=this.container,i=window;!i.document.contains(n)&&i.parent!==i;)i=i.parent;return i}},{key:"unbindEventListeners",value:function(){var n=this.getContainerRenderWindow();n.removeEventListener("mousemove",this.handleChange),n.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.style||{},a=i.color,s=i.white,o=i.black,c=i.pointer,h=i.circle,d=Li({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:a,white:s,black:o,pointer:c,circle:h}},{custom:!!this.props.style});return gt.createElement("div",{style:d.color,ref:function(b){return n.container=b},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},gt.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),gt.createElement("div",{style:d.white,className:"saturation-white"},gt.createElement("div",{style:d.black,className:"saturation-black"}),gt.createElement("div",{style:d.pointer},this.props.pointer?gt.createElement(this.props.pointer,this.props):gt.createElement("div",{style:d.circle}))))}}]),e})(te.PureComponent||te.Component);function PAe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var kAe=iQ(Object.keys,Object),RAe=Object.prototype,MAe=RAe.hasOwnProperty;function DAe(t){if(!kN(t))return kAe(t);var e=[];for(var r in Object(t))MAe.call(t,r)&&r!="constructor"&&e.push(r);return e}function ON(t){return w_(t)?cQ(t):DAe(t)}function OAe(t,e){return t&&rQ(t,e,ON)}function NAe(t,e){return function(r,n){if(r==null)return r;if(!w_(r))return t(r,n);for(var i=r.length,a=-1,s=Object(r);++a<i&&n(s[a],a,s)!==!1;);return r}}var pQ=NAe(OAe);function LAe(t){return typeof t=="function"?t:T3}function FAe(t,e){var r=ph(t)?PAe:pQ;return r(t,LAe(e))}function TE(t){"@babel/helpers - typeof";return TE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},TE(t)}var BAe=/^\s+/,zAe=/\s+$/;function li(t,e){if(t=t||"",e=e||{},t instanceof li)return t;if(!(this instanceof li))return new li(t,e);var r=jAe(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}li.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),r,n,i,a,s,o;return r=e.r/255,n=e.g/255,i=e.b/255,r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),.2126*a+.7152*s+.0722*o},setAlpha:function(e){return this._a=gQ(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=C$(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=C$(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.v*100);return this._a==1?"hsv("+r+", "+n+"%, "+i+"%)":"hsva("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=T$(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=T$(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.l*100);return this._a==1?"hsl("+r+", "+n+"%, "+i+"%)":"hsla("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return A$(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return qAe(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(us(this._r,255)*100)+"%",g:Math.round(us(this._g,255)*100)+"%",b:Math.round(us(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(us(this._r,255)*100)+"%, "+Math.round(us(this._g,255)*100)+"%, "+Math.round(us(this._b,255)*100)+"%)":"rgba("+Math.round(us(this._r,255)*100)+"%, "+Math.round(us(this._g,255)*100)+"%, "+Math.round(us(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:r5e[A$(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var r="#"+I$(this._r,this._g,this._b,this._a),n=r,i=this._gradientType?"GradientType = 1, ":"";if(e){var a=li(e);n="#"+I$(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+r+",endColorstr="+n+")"},toString:function(e){var r=!!e;e=e||this._format;var n=!1,i=this._a<1&&this._a>=0,a=!r&&i&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return a?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return li(this.toString())},_applyModification:function(e,r){var n=e.apply(null,[this].concat([].slice.call(r)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(XAe,arguments)},brighten:function(){return this._applyModification(YAe,arguments)},darken:function(){return this._applyModification(ZAe,arguments)},desaturate:function(){return this._applyModification(HAe,arguments)},saturate:function(){return this._applyModification(WAe,arguments)},greyscale:function(){return this._applyModification(GAe,arguments)},spin:function(){return this._applyModification(KAe,arguments)},_applyCombination:function(e,r){return e.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(e5e,arguments)},complement:function(){return this._applyCombination(JAe,arguments)},monochromatic:function(){return this._applyCombination(t5e,arguments)},splitcomplement:function(){return this._applyCombination(QAe,arguments)},triad:function(){return this._applyCombination(P$,[3])},tetrad:function(){return this._applyCombination(P$,[4])}};li.fromRatio=function(t,e){if(TE(t)=="object"){var r={};for(var n in t)t.hasOwnProperty(n)&&(n==="a"?r[n]=t[n]:r[n]=$1(t[n]));t=r}return li(t,e)};function jAe(t){var e={r:0,g:0,b:0},r=1,n=null,i=null,a=null,s=!1,o=!1;return typeof t=="string"&&(t=o5e(t)),TE(t)=="object"&&(tp(t.r)&&tp(t.g)&&tp(t.b)?(e=UAe(t.r,t.g,t.b),s=!0,o=String(t.r).substr(-1)==="%"?"prgb":"rgb"):tp(t.h)&&tp(t.s)&&tp(t.v)?(n=$1(t.s),i=$1(t.v),e=$Ae(t.h,n,i),s=!0,o="hsv"):tp(t.h)&&tp(t.s)&&tp(t.l)&&(n=$1(t.s),a=$1(t.l),e=VAe(t.h,n,a),s=!0,o="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=gQ(r),{ok:s,format:t.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}function UAe(t,e,r){return{r:us(t,255)*255,g:us(e,255)*255,b:us(r,255)*255}}function T$(t,e,r){t=us(t,255),e=us(e,255),r=us(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,s,o=(n+i)/2;if(n==i)a=s=0;else{var c=n-i;switch(s=o>.5?c/(2-n-i):c/(n+i),n){case t:a=(e-r)/c+(e<r?6:0);break;case e:a=(r-t)/c+2;break;case r:a=(t-e)/c+4;break}a/=6}return{h:a,s,l:o}}function VAe(t,e,r){var n,i,a;t=us(t,360),e=us(e,100),r=us(r,100);function s(h,d,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?h+(d-h)*6*m:m<1/2?d:m<2/3?h+(d-h)*(2/3-m)*6:h}if(e===0)n=i=a=r;else{var o=r<.5?r*(1+e):r+e-r*e,c=2*r-o;n=s(c,o,t+1/3),i=s(c,o,t),a=s(c,o,t-1/3)}return{r:n*255,g:i*255,b:a*255}}function C$(t,e,r){t=us(t,255),e=us(e,255),r=us(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,s,o=n,c=n-i;if(s=n===0?0:c/n,n==i)a=0;else{switch(n){case t:a=(e-r)/c+(e<r?6:0);break;case e:a=(r-t)/c+2;break;case r:a=(t-e)/c+4;break}a/=6}return{h:a,s,v:o}}function $Ae(t,e,r){t=us(t,360)*6,e=us(e,100),r=us(r,100);var n=Math.floor(t),i=t-n,a=r*(1-e),s=r*(1-i*e),o=r*(1-(1-i)*e),c=n%6,h=[r,s,a,a,o,r][c],d=[o,r,r,s,a,a][c],m=[a,a,o,r,r,s][c];return{r:h*255,g:d*255,b:m*255}}function A$(t,e,r,n){var i=[xf(Math.round(t).toString(16)),xf(Math.round(e).toString(16)),xf(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function qAe(t,e,r,n,i){var a=[xf(Math.round(t).toString(16)),xf(Math.round(e).toString(16)),xf(Math.round(r).toString(16)),xf(mQ(n))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function I$(t,e,r,n){var i=[xf(mQ(n)),xf(Math.round(t).toString(16)),xf(Math.round(e).toString(16)),xf(Math.round(r).toString(16))];return i.join("")}li.equals=function(t,e){return!t||!e?!1:li(t).toRgbString()==li(e).toRgbString()};li.random=function(){return li.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function HAe(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.s-=e/100,r.s=I3(r.s),li(r)}function WAe(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.s+=e/100,r.s=I3(r.s),li(r)}function GAe(t){return li(t).desaturate(100)}function XAe(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.l+=e/100,r.l=I3(r.l),li(r)}function YAe(t,e){e=e===0?0:e||10;var r=li(t).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),li(r)}function ZAe(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.l-=e/100,r.l=I3(r.l),li(r)}function KAe(t,e){var r=li(t).toHsl(),n=(r.h+e)%360;return r.h=n<0?360+n:n,li(r)}function JAe(t){var e=li(t).toHsl();return e.h=(e.h+180)%360,li(e)}function P$(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var r=li(t).toHsl(),n=[li(t)],i=360/e,a=1;a<e;a++)n.push(li({h:(r.h+a*i)%360,s:r.s,l:r.l}));return n}function QAe(t){var e=li(t).toHsl(),r=e.h;return[li(t),li({h:(r+72)%360,s:e.s,l:e.l}),li({h:(r+216)%360,s:e.s,l:e.l})]}function e5e(t,e,r){e=e||6,r=r||30;var n=li(t).toHsl(),i=360/r,a=[li(t)];for(n.h=(n.h-(i*e>>1)+720)%360;--e;)n.h=(n.h+i)%360,a.push(li(n));return a}function t5e(t,e){e=e||6;for(var r=li(t).toHsv(),n=r.h,i=r.s,a=r.v,s=[],o=1/e;e--;)s.push(li({h:n,s:i,v:a})),a=(a+o)%1;return s}li.mix=function(t,e,r){r=r===0?0:r||50;var n=li(t).toRgb(),i=li(e).toRgb(),a=r/100,s={r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a};return li(s)};li.readability=function(t,e){var r=li(t),n=li(e);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)};li.isReadable=function(t,e,r){var n=li.readability(t,e),i,a;switch(a=!1,i=s5e(r),i.level+i.size){case"AAsmall":case"AAAlarge":a=n>=4.5;break;case"AAlarge":a=n>=3;break;case"AAAsmall":a=n>=7;break}return a};li.mostReadable=function(t,e,r){var n=null,i=0,a,s,o,c;r=r||{},s=r.includeFallbackColors,o=r.level,c=r.size;for(var h=0;h<e.length;h++)a=li.readability(t,e[h]),a>i&&(i=a,n=li(e[h]));return li.isReadable(t,n,{level:o,size:c})||!s?n:(r.includeFallbackColors=!1,li.mostReadable(t,["#fff","#000"],r))};var qR=li.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},r5e=li.hexNames=n5e(qR);function n5e(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function gQ(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function us(t,e){i5e(t)&&(t="100%");var r=a5e(t);return t=Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function I3(t){return Math.min(1,Math.max(0,t))}function eh(t){return parseInt(t,16)}function i5e(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function a5e(t){return typeof t=="string"&&t.indexOf("%")!=-1}function xf(t){return t.length==1?"0"+t:""+t}function $1(t){return t<=1&&(t=t*100+"%"),t}function mQ(t){return Math.round(parseFloat(t)*255).toString(16)}function k$(t){return eh(t)/255}var gf=(function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function tp(t){return!!gf.CSS_UNIT.exec(t)}function o5e(t){t=t.replace(BAe,"").replace(zAe,"").toLowerCase();var e=!1;if(qR[t])t=qR[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=gf.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=gf.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=gf.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=gf.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=gf.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=gf.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=gf.hex8.exec(t))?{r:eh(r[1]),g:eh(r[2]),b:eh(r[3]),a:k$(r[4]),format:e?"name":"hex8"}:(r=gf.hex6.exec(t))?{r:eh(r[1]),g:eh(r[2]),b:eh(r[3]),format:e?"name":"hex"}:(r=gf.hex4.exec(t))?{r:eh(r[1]+""+r[1]),g:eh(r[2]+""+r[2]),b:eh(r[3]+""+r[3]),a:k$(r[4]+""+r[4]),format:e?"name":"hex8"}:(r=gf.hex3.exec(t))?{r:eh(r[1]+""+r[1]),g:eh(r[2]+""+r[2]),b:eh(r[3]+""+r[3]),format:e?"name":"hex"}:!1}function s5e(t){var e,r;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:e,size:r}}var R$=function(e){var r=["r","g","b","a","h","s","l","v"],n=0,i=0;return FAe(r,function(a){if(e[a]&&(n+=1,isNaN(e[a])||(i+=1),a==="s"||a==="l")){var s=/^\d+%$/;s.test(e[a])&&(i+=1)}}),n===i?e:!1},q1=function(e,r){var n=e.hex?li(e.hex):li(e),i=n.toHsl(),a=n.toHsv(),s=n.toRgb(),o=n.toHex();i.s===0&&(i.h=r||0,a.h=r||0);var c=o==="000000"&&s.a===0;return{hsl:i,hex:c?"transparent":"#"+o,rgb:s,hsv:a,oldHue:e.h||r||i.h,source:e.source}},Ug=function(e){if(e==="transparent")return!0;var r=String(e).charAt(0)==="#"?1:0;return e.length!==4+r&&e.length<7+r&&li(e).isValid()},NN=function(e){if(!e)return"#fff";var r=q1(e);if(r.hex==="transparent")return"rgba(0,0,0,0.4)";var n=(r.rgb.r*299+r.rgb.g*587+r.rgb.b*114)/1e3;return n>=128?"#000":"#fff"},nP=function(e,r){var n=e.replace("","");return li(r+" ("+n+")")._ok},c1=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},l5e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function u5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c5e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function h5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var zc=function(e){var r=(function(n){h5e(i,n);function i(a){u5e(this,i);var s=c5e(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return s.handleChange=function(o,c){var h=R$(o);if(h){var d=q1(o,o.h||s.state.oldHue);s.setState(d),s.props.onChangeComplete&&s.debounce(s.props.onChangeComplete,d,c),s.props.onChange&&s.props.onChange(d,c)}},s.handleSwatchHover=function(o,c){var h=R$(o);if(h){var d=q1(o,o.h||s.state.oldHue);s.props.onSwatchHover&&s.props.onSwatchHover(d,c)}},s.state=c1({},q1(a.color,0)),s.debounce=dQ(function(o,c,h){o(c,h)},100),s}return l5e(i,[{key:"render",value:function(){var s={};return this.props.onSwatchHover&&(s.onSwatchHover=this.handleSwatchHover),gt.createElement(e,c1({},this.props,this.state,{onChange:this.handleChange},s))}}],[{key:"getDerivedStateFromProps",value:function(s,o){return c1({},q1(s.color,o.oldHue))}}]),i})(te.PureComponent||te.Component);return r.propTypes=c1({},e.propTypes),r.defaultProps=c1({},e.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),r},f5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},d5e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function p5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M$(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function g5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var m5e=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(n){g5e(i,n);function i(){var a,s,o,c;p5e(this,i);for(var h=arguments.length,d=Array(h),m=0;m<h;m++)d[m]=arguments[m];return c=(s=(o=M$(this,(a=i.__proto__||Object.getPrototypeOf(i)).call.apply(a,[this].concat(d))),o),o.state={focus:!1},o.handleFocus=function(){return o.setState({focus:!0})},o.handleBlur=function(){return o.setState({focus:!1})},s),M$(o,c)}return d5e(i,[{key:"render",value:function(){return gt.createElement(r,{onFocus:this.handleFocus,onBlur:this.handleBlur},gt.createElement(e,f5e({},this.props,this.state)))}}]),i})(gt.Component)},D$=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},y5e=13,v5e=function(e){var r=e.color,n=e.style,i=e.onClick,a=i===void 0?function(){}:i,s=e.onHover,o=e.title,c=o===void 0?r:o,h=e.children,d=e.focus,m=e.focusStyle,b=m===void 0?{}:m,x=r==="transparent",E=Li({default:{swatch:D$({background:r,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},n,d?b:{})}}),T=function(O){return a(r,O)},A=function(O){return O.keyCode===y5e&&a(r,O)},M=function(O){return s(r,O)},F={};return s&&(F.onMouseOver=M),gt.createElement("div",D$({style:E.swatch,onClick:T,title:c,tabIndex:0,onKeyDown:A},F),h,x&&gt.createElement(b_,{borderRadius:E.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};const ky=m5e(v5e);var _5e=function(e){var r=e.direction,n=Li({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return gt.createElement("div",{style:n.picker})},b5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yQ=function(e){var r=e.rgb,n=e.hsl,i=e.width,a=e.height,s=e.onChange,o=e.direction,c=e.style,h=e.renderers,d=e.pointer,m=e.className,b=m===void 0?"":m,x=Li({default:{picker:{position:"relative",width:i,height:a},alpha:{radius:"2px",style:c}}});return gt.createElement("div",{style:x.picker,className:"alpha-picker "+b},gt.createElement(AN,b5e({},x.alpha,{rgb:r,hsl:n,pointer:d,renderers:h,onChange:s,direction:o})))};yQ.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:_5e};zc(yQ);function vQ(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var x5e="__lodash_hash_undefined__";function w5e(t){return this.__data__.set(t,x5e),this}function S5e(t){return this.__data__.has(t)}function CE(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Dp;++e<r;)this.add(t[e])}CE.prototype.add=CE.prototype.push=w5e;CE.prototype.has=S5e;function E5e(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function T5e(t,e){return t.has(e)}var C5e=1,A5e=2;function _Q(t,e,r,n,i,a){var s=r&C5e,o=t.length,c=e.length;if(o!=c&&!(s&&c>o))return!1;var h=a.get(t),d=a.get(e);if(h&&d)return h==e&&d==t;var m=-1,b=!0,x=r&A5e?new CE:void 0;for(a.set(t,e),a.set(e,t);++m<o;){var E=t[m],T=e[m];if(n)var A=s?n(T,E,m,e,t,a):n(E,T,m,t,e,a);if(A!==void 0){if(A)continue;b=!1;break}if(x){if(!E5e(e,function(M,F){if(!T5e(x,F)&&(E===M||i(E,M,r,n,a)))return x.push(F)})){b=!1;break}}else if(!(E===T||i(E,T,r,n,a))){b=!1;break}}return a.delete(t),a.delete(e),b}function I5e(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function P5e(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var k5e=1,R5e=2,M5e="[object Boolean]",D5e="[object Date]",O5e="[object Error]",N5e="[object Map]",L5e="[object Number]",F5e="[object RegExp]",B5e="[object Set]",z5e="[object String]",j5e="[object Symbol]",U5e="[object ArrayBuffer]",V5e="[object DataView]",O$=kg?kg.prototype:void 0,iP=O$?O$.valueOf:void 0;function $5e(t,e,r,n,i,a,s){switch(r){case V5e:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case U5e:return!(t.byteLength!=e.byteLength||!a(new wE(t),new wE(e)));case M5e:case D5e:case L5e:return Gx(+t,+e);case O5e:return t.name==e.name&&t.message==e.message;case F5e:case z5e:return t==e+"";case N5e:var o=I5e;case B5e:var c=n&k5e;if(o||(o=P5e),t.size!=e.size&&!c)return!1;var h=s.get(t);if(h)return h==e;n|=R5e,s.set(t,e);var d=_Q(o(t),o(e),n,i,a,s);return s.delete(t),d;case j5e:if(iP)return iP.call(t)==iP.call(e)}return!1}function q5e(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function H5e(t,e,r){var n=e(t);return ph(t)?n:q5e(n,r(t))}function W5e(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}function G5e(){return[]}var X5e=Object.prototype,Y5e=X5e.propertyIsEnumerable,N$=Object.getOwnPropertySymbols,Z5e=N$?function(t){return t==null?[]:(t=Object(t),W5e(N$(t),function(e){return Y5e.call(t,e)}))}:G5e;function L$(t){return H5e(t,ON,Z5e)}var K5e=1,J5e=Object.prototype,Q5e=J5e.hasOwnProperty;function e4e(t,e,r,n,i,a){var s=r&K5e,o=L$(t),c=o.length,h=L$(e),d=h.length;if(c!=d&&!s)return!1;for(var m=c;m--;){var b=o[m];if(!(s?b in e:Q5e.call(e,b)))return!1}var x=a.get(t),E=a.get(e);if(x&&E)return x==e&&E==t;var T=!0;a.set(t,e),a.set(e,t);for(var A=s;++m<c;){b=o[m];var M=t[b],F=e[b];if(n)var N=s?n(F,M,b,e,t,a):n(M,F,b,t,e,a);if(!(N===void 0?M===F||i(M,F,r,n,a):N)){T=!1;break}A||(A=b=="constructor")}if(T&&!A){var O=t.constructor,U=e.constructor;O!=U&&"constructor"in t&&"constructor"in e&&!(typeof O=="function"&&O instanceof O&&typeof U=="function"&&U instanceof U)&&(T=!1)}return a.delete(t),a.delete(e),T}var HR=Py(Nf,"DataView"),WR=Py(Nf,"Promise"),GR=Py(Nf,"Set"),XR=Py(Nf,"WeakMap"),F$="[object Map]",t4e="[object Object]",B$="[object Promise]",z$="[object Set]",j$="[object WeakMap]",U$="[object DataView]",r4e=Iy(HR),n4e=Iy(Qb),i4e=Iy(WR),a4e=Iy(GR),o4e=Iy(XR),ag=Ay;(HR&&ag(new HR(new ArrayBuffer(1)))!=U$||Qb&&ag(new Qb)!=F$||WR&&ag(WR.resolve())!=B$||GR&&ag(new GR)!=z$||XR&&ag(new XR)!=j$)&&(ag=function(t){var e=Ay(t),r=e==t4e?t.constructor:void 0,n=r?Iy(r):"";if(n)switch(n){case r4e:return U$;case n4e:return F$;case i4e:return B$;case a4e:return z$;case o4e:return j$}return e});var s4e=1,V$="[object Arguments]",$$="[object Array]",Rw="[object Object]",l4e=Object.prototype,q$=l4e.hasOwnProperty;function u4e(t,e,r,n,i,a){var s=ph(t),o=ph(e),c=s?$$:ag(t),h=o?$$:ag(e);c=c==V$?Rw:c,h=h==V$?Rw:h;var d=c==Rw,m=h==Rw,b=c==h;if(b&&EE(t)){if(!EE(e))return!1;s=!0,d=!1}if(b&&!d)return a||(a=new xd),s||MN(t)?_Q(t,e,r,n,i,a):$5e(t,e,c,r,n,i,a);if(!(r&s4e)){var x=d&&q$.call(t,"__wrapped__"),E=m&&q$.call(e,"__wrapped__");if(x||E){var T=x?t.value():t,A=E?e.value():e;return a||(a=new xd),i(T,A,r,n,a)}}return b?(a||(a=new xd),e4e(t,e,r,n,i,a)):!1}function LN(t,e,r,n,i){return t===e?!0:t==null||e==null||!Rg(t)&&!Rg(e)?t!==t&&e!==e:u4e(t,e,r,n,LN,i)}var c4e=1,h4e=2;function f4e(t,e,r,n){var i=r.length,a=i;if(t==null)return!a;for(t=Object(t);i--;){var s=r[i];if(s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<a;){s=r[i];var o=s[0],c=t[o],h=s[1];if(s[2]){if(c===void 0&&!(o in t))return!1}else{var d=new xd,m;if(!(m===void 0?LN(h,c,c4e|h4e,n,d):m))return!1}}return!0}function bQ(t){return t===t&&!Xh(t)}function d4e(t){for(var e=ON(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,bQ(i)]}return e}function xQ(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function p4e(t){var e=d4e(t);return e.length==1&&e[0][2]?xQ(e[0][0],e[0][1]):function(r){return r===t||f4e(r,t,e)}}var g4e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m4e=/^\w*$/;function FN(t,e){if(ph(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||C3(t)?!0:m4e.test(t)||!g4e.test(t)||e!=null&&t in Object(e)}var y4e="Expected a function";function BN(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(y4e);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var s=t.apply(this,n);return r.cache=a.set(i,s)||a,s};return r.cache=new(BN.Cache||Dp),r}BN.Cache=Dp;var v4e=500;function _4e(t){var e=BN(t,function(n){return r.size===v4e&&r.clear(),n}),r=e.cache;return e}var b4e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,x4e=/\\(\\)?/g,w4e=_4e(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(b4e,function(r,n,i,a){e.push(i?a.replace(x4e,"$1"):n||r)}),e}),H$=kg?kg.prototype:void 0,W$=H$?H$.toString:void 0;function wQ(t){if(typeof t=="string")return t;if(ph(t))return vQ(t,wQ)+"";if(C3(t))return W$?W$.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function S4e(t){return t==null?"":wQ(t)}function SQ(t,e){return ph(t)?t:FN(t,e)?[t]:w4e(S4e(t))}function P3(t){if(typeof t=="string"||C3(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function EQ(t,e){e=SQ(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[P3(e[r++])];return r&&r==n?t:void 0}function E4e(t,e,r){var n=t==null?void 0:EQ(t,e);return n===void 0?r:n}function T4e(t,e){return t!=null&&e in Object(t)}function C4e(t,e,r){e=SQ(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var s=P3(e[n]);if(!(a=t!=null&&r(t,s)))break;t=t[s]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&RN(i)&&DN(s,i)&&(ph(t)||SE(t)))}function A4e(t,e){return t!=null&&C4e(t,e,T4e)}var I4e=1,P4e=2;function k4e(t,e){return FN(t)&&bQ(e)?xQ(P3(t),e):function(r){var n=E4e(r,t);return n===void 0&&n===e?A4e(r,t):LN(e,n,I4e|P4e)}}function R4e(t){return function(e){return e?.[t]}}function M4e(t){return function(e){return EQ(e,t)}}function D4e(t){return FN(t)?R4e(P3(t)):M4e(t)}function O4e(t){return typeof t=="function"?t:t==null?T3:typeof t=="object"?ph(t)?k4e(t[0],t[1]):p4e(t):D4e(t)}function N4e(t,e){var r=-1,n=w_(t)?Array(t.length):[];return pQ(t,function(i,a,s){n[++r]=e(i,a,s)}),n}function Ry(t,e){var r=ph(t)?vQ:N4e;return r(t,O4e(e))}var L4e=function(e){var r=e.colors,n=e.onClick,i=e.onSwatchHover,a=Li({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return gt.createElement("div",{style:a.swatches},Ry(r,function(s){return gt.createElement(ky,{key:s,color:s,style:a.swatch,onClick:n,onHover:i,focusStyle:{boxShadow:"0 0 4px "+s}})}),gt.createElement("div",{style:a.clear}))},zN=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,a=e.colors,s=e.width,o=e.triangle,c=e.styles,h=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=i==="transparent",x=function(A,M){Ug(A)&&r({hex:A,source:"hex"},M)},E=Li(Bc({default:{card:{width:s,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:i,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:NN(i),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+i+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},h),{"hide-triangle":o==="hide"});return gt.createElement("div",{style:E.card,className:"block-picker "+m},gt.createElement("div",{style:E.triangle}),gt.createElement("div",{style:E.head},b&&gt.createElement(b_,{borderRadius:"6px 6px 0 0"}),gt.createElement("div",{style:E.label},i)),gt.createElement("div",{style:E.body},gt.createElement(L4e,{colors:a,onClick:x,onSwatchHover:n}),gt.createElement(ya,{style:{input:E.input},value:i,onChange:x})))};zN.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),colors:Rn.arrayOf(Rn.string),triangle:Rn.oneOf(["top","hide"]),styles:Rn.object};zN.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}};zc(zN);var zv={100:"#ffcdd2",300:"#e57373",500:"#f44336",700:"#d32f2f",900:"#b71c1c"},jv={100:"#f8bbd0",300:"#f06292",500:"#e91e63",700:"#c2185b",900:"#880e4f"},Uv={100:"#e1bee7",300:"#ba68c8",500:"#9c27b0",700:"#7b1fa2",900:"#4a148c"},Vv={100:"#d1c4e9",300:"#9575cd",500:"#673ab7",700:"#512da8",900:"#311b92"},$v={100:"#c5cae9",300:"#7986cb",500:"#3f51b5",700:"#303f9f",900:"#1a237e"},qv={100:"#bbdefb",300:"#64b5f6",500:"#2196f3",700:"#1976d2",900:"#0d47a1"},Hv={100:"#b3e5fc",300:"#4fc3f7",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Wv={100:"#b2ebf2",300:"#4dd0e1",500:"#00bcd4",700:"#0097a7",900:"#006064"},Gv={100:"#b2dfdb",300:"#4db6ac",500:"#009688",700:"#00796b",900:"#004d40"},H1={100:"#c8e6c9",300:"#81c784",500:"#4caf50",700:"#388e3c"},Xv={100:"#dcedc8",300:"#aed581",500:"#8bc34a",700:"#689f38",900:"#33691e"},Yv={100:"#f0f4c3",300:"#dce775",500:"#cddc39",700:"#afb42b",900:"#827717"},Zv={100:"#fff9c4",300:"#fff176",500:"#ffeb3b",700:"#fbc02d",900:"#f57f17"},Kv={100:"#ffecb3",300:"#ffd54f",500:"#ffc107",700:"#ffa000",900:"#ff6f00"},Jv={100:"#ffe0b2",300:"#ffb74d",500:"#ff9800",700:"#f57c00",900:"#e65100"},Qv={100:"#ffccbc",300:"#ff8a65",500:"#ff5722",700:"#e64a19",900:"#bf360c"},e0={100:"#d7ccc8",300:"#a1887f",500:"#795548",700:"#5d4037",900:"#3e2723"},t0={100:"#cfd8dc",300:"#90a4ae",500:"#607d8b",700:"#455a64",900:"#263238"},TQ=function(e){var r=e.color,n=e.onClick,i=e.onSwatchHover,a=e.hover,s=e.active,o=e.circleSize,c=e.circleSpacing,h=Li({default:{swatch:{width:o,height:o,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(o/2+1)+"px "+r,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+r}}},{hover:a,active:s});return gt.createElement("div",{style:h.swatch},gt.createElement(ky,{style:h.Swatch,color:r,onClick:n,onHover:i,focusStyle:{boxShadow:h.Swatch.boxShadow+", 0 0 5px "+r}}))};TQ.defaultProps={circleSize:28,circleSpacing:14};const F4e=CN.handleHover(TQ);var jN=function(e){var r=e.width,n=e.onChange,i=e.onSwatchHover,a=e.colors,s=e.hex,o=e.circleSize,c=e.styles,h=c===void 0?{}:c,d=e.circleSpacing,m=e.className,b=m===void 0?"":m,x=Li(Bc({default:{card:{width:r,display:"flex",flexWrap:"wrap",marginRight:-d,marginBottom:-d}}},h)),E=function(A,M){return n({hex:A,source:"hex"},M)};return gt.createElement("div",{style:x.card,className:"circle-picker "+b},Ry(a,function(T){return gt.createElement(F4e,{key:T,color:T,onClick:E,onSwatchHover:i,active:s===T.toLowerCase(),circleSize:o,circleSpacing:d})}))};jN.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),circleSize:Rn.number,circleSpacing:Rn.number,styles:Rn.object};jN.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[zv[500],jv[500],Uv[500],Vv[500],$v[500],qv[500],Hv[500],Wv[500],Gv[500],H1[500],Xv[500],Yv[500],Zv[500],Kv[500],Jv[500],Qv[500],e0[500],t0[500]],styles:{}};zc(jN);function G$(t){return t===void 0}var Mw={},X$;function B4e(){if(X$)return Mw;X$=1,Object.defineProperty(Mw,"__esModule",{value:!0});var t=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(s[h]=c[h])}return s},e=xx(),r=n(e);function n(s){return s&&s.__esModule?s:{default:s}}function i(s,o){var c={};for(var h in s)o.indexOf(h)>=0||Object.prototype.hasOwnProperty.call(s,h)&&(c[h]=s[h]);return c}var a=24;return Mw.default=function(s){var o=s.fill,c=o===void 0?"currentColor":o,h=s.width,d=h===void 0?a:h,m=s.height,b=m===void 0?a:m,x=s.style,E=x===void 0?{}:x,T=i(s,["fill","width","height","style"]);return r.default.createElement("svg",t({viewBox:"0 0 "+a+" "+a,style:t({fill:c,width:d,height:b},E)},T),r.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))},Mw}var z4e=B4e();const j4e=Id(z4e);var U4e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function V4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $4e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function q4e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var CQ=(function(t){q4e(e,t);function e(r){V4e(this,e);var n=$4e(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.toggleViews=function(){n.state.view==="hex"?n.setState({view:"rgb"}):n.state.view==="rgb"?n.setState({view:"hsl"}):n.state.view==="hsl"&&(n.props.hsl.a===1?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(i,a){i.hex?Ug(i.hex)&&n.props.onChange({hex:i.hex,source:"hex"},a):i.r||i.g||i.b?n.props.onChange({r:i.r||n.props.rgb.r,g:i.g||n.props.rgb.g,b:i.b||n.props.rgb.b,source:"rgb"},a):i.a?(i.a<0?i.a=0:i.a>1&&(i.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(i.a*100)/100,source:"rgb"},a)):(i.h||i.s||i.l)&&(typeof i.s=="string"&&i.s.includes("%")&&(i.s=i.s.replace("%","")),typeof i.l=="string"&&i.l.includes("%")&&(i.l=i.l.replace("%","")),i.s==1?i.s=.01:i.l==1&&(i.l=.01),n.props.onChange({h:i.h||n.props.hsl.h,s:Number(G$(i.s)?n.props.hsl.s:i.s),l:Number(G$(i.l)?n.props.hsl.l:i.l),source:"hsl"},a))},n.showHighlight=function(i){i.currentTarget.style.background="#eee"},n.hideHighlight=function(i){i.currentTarget.style.background="transparent"},r.hsl.a!==1&&r.view==="hex"?n.state={view:"rgb"}:n.state={view:r.view},n}return U4e(e,[{key:"render",value:function(){var n=this,i=Li({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),a=void 0;return this.state.view==="hex"?a=gt.createElement("div",{style:i.fields,className:"flexbox-fix"},gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?a=gt.createElement("div",{style:i.fields,className:"flexbox-fix"},gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),gt.createElement("div",{style:i.alpha},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(a=gt.createElement("div",{style:i.fields,className:"flexbox-fix"},gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),gt.createElement("div",{style:i.alpha},gt.createElement(ya,{style:{input:i.input,label:i.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),gt.createElement("div",{style:i.wrap,className:"flexbox-fix"},a,gt.createElement("div",{style:i.toggle},gt.createElement("div",{style:i.icon,onClick:this.toggleViews,ref:function(o){return n.icon=o}},gt.createElement(j4e,{style:i.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.hsl.a!==1&&i.view==="hex"?{view:"rgb"}:null}}]),e})(gt.Component);CQ.defaultProps={view:"hex"};var Y$=function(){var e=Li({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return gt.createElement("div",{style:e.picker})},H4e=function(){var e=Li({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return gt.createElement("div",{style:e.picker})},UN=function(e){var r=e.width,n=e.onChange,i=e.disableAlpha,a=e.rgb,s=e.hsl,o=e.hsv,c=e.hex,h=e.renderers,d=e.styles,m=d===void 0?{}:d,b=e.className,x=b===void 0?"":b,E=e.defaultView,T=Li(Bc({default:{picker:{width:r,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+a.r+", "+a.g+", "+a.b+", "+a.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},m),{disableAlpha:i});return gt.createElement("div",{style:T.picker,className:"chrome-picker "+x},gt.createElement("div",{style:T.saturation},gt.createElement(A3,{style:T.Saturation,hsl:s,hsv:o,pointer:H4e,onChange:n})),gt.createElement("div",{style:T.body},gt.createElement("div",{style:T.controls,className:"flexbox-fix"},gt.createElement("div",{style:T.color},gt.createElement("div",{style:T.swatch},gt.createElement("div",{style:T.active}),gt.createElement(b_,{renderers:h}))),gt.createElement("div",{style:T.toggles},gt.createElement("div",{style:T.hue},gt.createElement(x_,{style:T.Hue,hsl:s,pointer:Y$,onChange:n})),gt.createElement("div",{style:T.alpha},gt.createElement(AN,{style:T.Alpha,rgb:a,hsl:s,pointer:Y$,renderers:h,onChange:n})))),gt.createElement(CQ,{rgb:a,hsl:s,hex:c,view:E,onChange:n,disableAlpha:i})))};UN.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),disableAlpha:Rn.bool,styles:Rn.object,defaultView:Rn.oneOf(["hex","rgb","hsl"])};UN.defaultProps={width:225,disableAlpha:!1,styles:{}};const W4e=zc(UN);var G4e=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=e.active,o=Li({default:{color:{background:r,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:NN(r),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:s,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return gt.createElement(ky,{style:o.color,color:r,onClick:i,onHover:a,focusStyle:{boxShadow:"0 0 4px "+r}},gt.createElement("div",{style:o.dot}))},X4e=function(e){var r=e.hex,n=e.rgb,i=e.onChange,a=Li({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:r},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),s=function(c,h){c.r||c.g||c.b?i({r:c.r||n.r,g:c.g||n.g,b:c.b||n.b,source:"rgb"},h):i({hex:c.hex,source:"hex"},h)};return gt.createElement("div",{style:a.fields,className:"flexbox-fix"},gt.createElement("div",{style:a.active}),gt.createElement(ya,{style:{wrap:a.HEXwrap,input:a.HEXinput,label:a.HEXlabel},label:"hex",value:r,onChange:s}),gt.createElement(ya,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"r",value:n.r,onChange:s}),gt.createElement(ya,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"g",value:n.g,onChange:s}),gt.createElement(ya,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"b",value:n.b,onChange:s}))},VN=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.colors,a=e.hex,s=e.rgb,o=e.styles,c=o===void 0?{}:o,h=e.className,d=h===void 0?"":h,m=Li(Bc({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},c)),b=function(E,T){E.hex?Ug(E.hex)&&r({hex:E.hex,source:"hex"},T):r(E,T)};return gt.createElement(Xx,{style:m.Compact,styles:c},gt.createElement("div",{style:m.compact,className:"compact-picker "+d},gt.createElement("div",null,Ry(i,function(x){return gt.createElement(G4e,{key:x,color:x,active:x.toLowerCase()===a,onClick:b,onSwatchHover:n})}),gt.createElement("div",{style:m.clear})),gt.createElement(X4e,{hex:a,rgb:s,onChange:b})))};VN.propTypes={colors:Rn.arrayOf(Rn.string),styles:Rn.object};VN.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}};zc(VN);var Y4e=function(e){var r=e.hover,n=e.color,i=e.onClick,a=e.onSwatchHover,s={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},o=Li({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:s}},{hover:r});return gt.createElement("div",{style:o.swatch},gt.createElement(ky,{color:n,onClick:i,onHover:a,focusStyle:s}))};const Z4e=CN.handleHover(Y4e);var $N=function(e){var r=e.width,n=e.colors,i=e.onChange,a=e.onSwatchHover,s=e.triangle,o=e.styles,c=o===void 0?{}:o,h=e.className,d=h===void 0?"":h,m=Li(Bc({default:{card:{width:r,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},c),{"hide-triangle":s==="hide","top-left-triangle":s==="top-left","top-right-triangle":s==="top-right","bottom-left-triangle":s==="bottom-left","bottom-right-triangle":s==="bottom-right"}),b=function(E,T){return i({hex:E,source:"hex"},T)};return gt.createElement("div",{style:m.card,className:"github-picker "+d},gt.createElement("div",{style:m.triangleShadow}),gt.createElement("div",{style:m.triangle}),Ry(n,function(x){return gt.createElement(Z4e,{color:x,key:x,onClick:b,onSwatchHover:a})}))};$N.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),colors:Rn.arrayOf(Rn.string),triangle:Rn.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:Rn.object};$N.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}};zc($N);var K4e=function(e){var r=e.direction,n=Li({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return gt.createElement("div",{style:n.picker})},J4e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qN=function(e){var r=e.width,n=e.height,i=e.onChange,a=e.hsl,s=e.direction,o=e.pointer,c=e.styles,h=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=Li(Bc({default:{picker:{position:"relative",width:r,height:n},hue:{radius:"2px"}}},h)),x=function(T){return i({a:1,h:T.h,l:.5,s:1})};return gt.createElement("div",{style:b.picker,className:"hue-picker "+m},gt.createElement(x_,J4e({},b.hue,{hsl:a,pointer:o,onChange:x,direction:s})))};qN.propTypes={styles:Rn.object};qN.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:K4e,styles:{}};zc(qN);var Q4e=function(e){var r=e.onChange,n=e.hex,i=e.rgb,a=e.styles,s=a===void 0?{}:a,o=e.className,c=o===void 0?"":o,h=Li(Bc({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+n,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},s)),d=function(b,x){b.hex?Ug(b.hex)&&r({hex:b.hex,source:"hex"},x):(b.r||b.g||b.b)&&r({r:b.r||i.r,g:b.g||i.g,b:b.b||i.b,source:"rgb"},x)};return gt.createElement(Xx,{styles:s},gt.createElement("div",{style:h.material,className:"material-picker "+c},gt.createElement(ya,{style:{wrap:h.HEXwrap,input:h.HEXinput,label:h.HEXlabel},label:"hex",value:n,onChange:d}),gt.createElement("div",{style:h.split,className:"flexbox-fix"},gt.createElement("div",{style:h.third},gt.createElement(ya,{style:{wrap:h.RGBwrap,input:h.RGBinput,label:h.RGBlabel},label:"r",value:i.r,onChange:d})),gt.createElement("div",{style:h.third},gt.createElement(ya,{style:{wrap:h.RGBwrap,input:h.RGBinput,label:h.RGBlabel},label:"g",value:i.g,onChange:d})),gt.createElement("div",{style:h.third},gt.createElement(ya,{style:{wrap:h.RGBwrap,input:h.RGBinput,label:h.RGBlabel},label:"b",value:i.b,onChange:d})))))};zc(Q4e);var eIe=function(e){var r=e.onChange,n=e.rgb,i=e.hsv,a=e.hex,s=Li({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",top:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),o=function(h,d){h["#"]?Ug(h["#"])&&r({hex:h["#"],source:"hex"},d):h.r||h.g||h.b?r({r:h.r||n.r,g:h.g||n.g,b:h.b||n.b,source:"rgb"},d):(h.h||h.s||h.v)&&r({h:h.h||i.h,s:h.s||i.s,v:h.v||i.v,source:"hsv"},d)};return gt.createElement("div",{style:s.fields},gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"h",value:Math.round(i.h),onChange:o}),gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"s",value:Math.round(i.s*100),onChange:o}),gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"v",value:Math.round(i.v*100),onChange:o}),gt.createElement("div",{style:s.divider}),gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"r",value:n.r,onChange:o}),gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"g",value:n.g,onChange:o}),gt.createElement(ya,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"b",value:n.b,onChange:o}),gt.createElement("div",{style:s.divider}),gt.createElement(ya,{style:{wrap:s.HEXwrap,input:s.HEXinput,label:s.HEXlabel},label:"#",value:a.replace("#",""),onChange:o}),gt.createElement("div",{style:s.fieldSymbols},gt.createElement("div",{style:s.symbol},""),gt.createElement("div",{style:s.symbol},"%"),gt.createElement("div",{style:s.symbol},"%")))},tIe=function(e){var r=e.hsl,n=Li({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":r.l>.5});return gt.createElement("div",{style:n.picker})},rIe=function(){var e=Li({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return gt.createElement("div",{style:e.pointer},gt.createElement("div",{style:e.left},gt.createElement("div",{style:e.leftInside})),gt.createElement("div",{style:e.right},gt.createElement("div",{style:e.rightInside})))},Z$=function(e){var r=e.onClick,n=e.label,i=e.children,a=e.active,s=Li({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:a});return gt.createElement("div",{style:s.button,onClick:r},n||i)},nIe=function(e){var r=e.rgb,n=e.currentColor,i=Li({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+r.r+","+r.g+", "+r.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:n,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return gt.createElement("div",null,gt.createElement("div",{style:i.label},"new"),gt.createElement("div",{style:i.swatches},gt.createElement("div",{style:i.new}),gt.createElement("div",{style:i.current})),gt.createElement("div",{style:i.label},"current"))},iIe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function aIe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oIe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function sIe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var HN=(function(t){sIe(e,t);function e(r){aIe(this,e);var n=oIe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.state={currentColor:r.hex},n}return iIe(e,[{key:"render",value:function(){var n=this.props,i=n.styles,a=i===void 0?{}:i,s=n.className,o=s===void 0?"":s,c=Li(Bc({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},a));return gt.createElement("div",{style:c.picker,className:"photoshop-picker "+o},gt.createElement("div",{style:c.head},this.props.header),gt.createElement("div",{style:c.body,className:"flexbox-fix"},gt.createElement("div",{style:c.saturation},gt.createElement(A3,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:tIe,onChange:this.props.onChange})),gt.createElement("div",{style:c.hue},gt.createElement(x_,{direction:"vertical",hsl:this.props.hsl,pointer:rIe,onChange:this.props.onChange})),gt.createElement("div",{style:c.controls},gt.createElement("div",{style:c.top,className:"flexbox-fix"},gt.createElement("div",{style:c.previews},gt.createElement(nIe,{rgb:this.props.rgb,currentColor:this.state.currentColor})),gt.createElement("div",{style:c.actions},gt.createElement(Z$,{label:"OK",onClick:this.props.onAccept,active:!0}),gt.createElement(Z$,{label:"Cancel",onClick:this.props.onCancel}),gt.createElement(eIe,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),e})(gt.Component);HN.propTypes={header:Rn.string,styles:Rn.object};HN.defaultProps={header:"Color Picker",styles:{}};zc(HN);var lIe=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,a=e.hex,s=e.disableAlpha,o=Li({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:s}),c=function(d,m){d.hex?Ug(d.hex)&&r({hex:d.hex,source:"hex"},m):d.r||d.g||d.b?r({r:d.r||n.r,g:d.g||n.g,b:d.b||n.b,a:n.a,source:"rgb"},m):d.a&&(d.a<0?d.a=0:d.a>100&&(d.a=100),d.a/=100,r({h:i.h,s:i.s,l:i.l,a:d.a,source:"rgb"},m))};return gt.createElement("div",{style:o.fields,className:"flexbox-fix"},gt.createElement("div",{style:o.double},gt.createElement(ya,{style:{input:o.input,label:o.label},label:"hex",value:a.replace("#",""),onChange:c})),gt.createElement("div",{style:o.single},gt.createElement(ya,{style:{input:o.input,label:o.label},label:"r",value:n.r,onChange:c,dragLabel:"true",dragMax:"255"})),gt.createElement("div",{style:o.single},gt.createElement(ya,{style:{input:o.input,label:o.label},label:"g",value:n.g,onChange:c,dragLabel:"true",dragMax:"255"})),gt.createElement("div",{style:o.single},gt.createElement(ya,{style:{input:o.input,label:o.label},label:"b",value:n.b,onChange:c,dragLabel:"true",dragMax:"255"})),gt.createElement("div",{style:o.alpha},gt.createElement(ya,{style:{input:o.input,label:o.label},label:"a",value:Math.round(n.a*100),onChange:c,dragLabel:"true",dragMax:"100"})))},uIe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},AQ=function(e){var r=e.colors,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=Li({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!r||!r.length}),o=function(h,d){i({hex:h,source:"hex"},d)};return gt.createElement("div",{style:s.colors,className:"flexbox-fix"},r.map(function(c){var h=typeof c=="string"?{color:c}:c,d=""+h.color+(h.title||"");return gt.createElement("div",{key:d,style:s.swatchWrap},gt.createElement(ky,uIe({},h,{style:s.swatch,onClick:o,onHover:a,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+h.color}})))}))};AQ.propTypes={colors:Rn.arrayOf(Rn.oneOfType([Rn.string,Rn.shape({color:Rn.string,title:Rn.string})])).isRequired};var cIe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},WN=function(e){var r=e.width,n=e.rgb,i=e.hex,a=e.hsv,s=e.hsl,o=e.onChange,c=e.onSwatchHover,h=e.disableAlpha,d=e.presetColors,m=e.renderers,b=e.styles,x=b===void 0?{}:b,E=e.className,T=E===void 0?"":E,A=Li(Bc({default:cIe({picker:{width:r,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+n.r+","+n.g+","+n.b+","+n.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},x),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},x),{disableAlpha:h});return gt.createElement("div",{style:A.picker,className:"sketch-picker "+T},gt.createElement("div",{style:A.saturation},gt.createElement(A3,{style:A.Saturation,hsl:s,hsv:a,onChange:o})),gt.createElement("div",{style:A.controls,className:"flexbox-fix"},gt.createElement("div",{style:A.sliders},gt.createElement("div",{style:A.hue},gt.createElement(x_,{style:A.Hue,hsl:s,onChange:o})),gt.createElement("div",{style:A.alpha},gt.createElement(AN,{style:A.Alpha,rgb:n,hsl:s,renderers:m,onChange:o}))),gt.createElement("div",{style:A.color},gt.createElement(b_,null),gt.createElement("div",{style:A.activeColor}))),gt.createElement(lIe,{rgb:n,hsl:s,hex:i,onChange:o,disableAlpha:h}),gt.createElement(AQ,{colors:d,onClick:o,onSwatchHover:c}))};WN.propTypes={disableAlpha:Rn.bool,width:Rn.oneOfType([Rn.string,Rn.number]),styles:Rn.object};WN.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]};zc(WN);var h1=function(e){var r=e.hsl,n=e.offset,i=e.onClick,a=i===void 0?function(){}:i,s=e.active,o=e.first,c=e.last,h=Li({default:{swatch:{height:"12px",background:"hsl("+r.h+", 50%, "+n*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:s,first:o,last:c}),d=function(b){return a({h:r.h,s:.5,l:n,source:"hsl"},b)};return gt.createElement("div",{style:h.swatch,onClick:d})},hIe=function(e){var r=e.onClick,n=e.hsl,i=Li({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),a=.1;return gt.createElement("div",{style:i.swatches},gt.createElement("div",{style:i.swatch},gt.createElement(h1,{hsl:n,offset:".80",active:Math.abs(n.l-.8)<a&&Math.abs(n.s-.5)<a,onClick:r,first:!0})),gt.createElement("div",{style:i.swatch},gt.createElement(h1,{hsl:n,offset:".65",active:Math.abs(n.l-.65)<a&&Math.abs(n.s-.5)<a,onClick:r})),gt.createElement("div",{style:i.swatch},gt.createElement(h1,{hsl:n,offset:".50",active:Math.abs(n.l-.5)<a&&Math.abs(n.s-.5)<a,onClick:r})),gt.createElement("div",{style:i.swatch},gt.createElement(h1,{hsl:n,offset:".35",active:Math.abs(n.l-.35)<a&&Math.abs(n.s-.5)<a,onClick:r})),gt.createElement("div",{style:i.swatch},gt.createElement(h1,{hsl:n,offset:".20",active:Math.abs(n.l-.2)<a&&Math.abs(n.s-.5)<a,onClick:r,last:!0})),gt.createElement("div",{style:i.clear}))},fIe=function(){var e=Li({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return gt.createElement("div",{style:e.picker})},GN=function(e){var r=e.hsl,n=e.onChange,i=e.pointer,a=e.styles,s=a===void 0?{}:a,o=e.className,c=o===void 0?"":o,h=Li(Bc({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},s));return gt.createElement("div",{style:h.wrap||{},className:"slider-picker "+c},gt.createElement("div",{style:h.hue},gt.createElement(x_,{style:h.Hue,hsl:r,pointer:i,onChange:n})),gt.createElement("div",{style:h.swatches},gt.createElement(hIe,{hsl:r,onClick:n})))};GN.propTypes={styles:Rn.object};GN.defaultProps={pointer:fIe,styles:{}};zc(GN);var Dw={},K$;function dIe(){if(K$)return Dw;K$=1,Object.defineProperty(Dw,"__esModule",{value:!0});var t=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(s[h]=c[h])}return s},e=xx(),r=n(e);function n(s){return s&&s.__esModule?s:{default:s}}function i(s,o){var c={};for(var h in s)o.indexOf(h)>=0||Object.prototype.hasOwnProperty.call(s,h)&&(c[h]=s[h]);return c}var a=24;return Dw.default=function(s){var o=s.fill,c=o===void 0?"currentColor":o,h=s.width,d=h===void 0?a:h,m=s.height,b=m===void 0?a:m,x=s.style,E=x===void 0?{}:x,T=i(s,["fill","width","height","style"]);return r.default.createElement("svg",t({viewBox:"0 0 "+a+" "+a,style:t({fill:c,width:d,height:b},E)},T),r.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))},Dw}var pIe=dIe();const gIe=Id(pIe);var mIe=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=e.first,o=e.last,c=e.active,h=Li({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:r,marginBottom:"1px"},check:{color:NN(r),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:s,last:o,active:c,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return gt.createElement(ky,{color:r,style:h.color,onClick:i,onHover:a,focusStyle:{boxShadow:"0 0 4px "+r}},gt.createElement("div",{style:h.check},gt.createElement(gIe,null)))},yIe=function(e){var r=e.onClick,n=e.onSwatchHover,i=e.group,a=e.active,s=Li({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return gt.createElement("div",{style:s.group},Ry(i,function(o,c){return gt.createElement(mIe,{key:o,color:o,active:o.toLowerCase()===a,first:c===0,last:c===i.length-1,onClick:r,onSwatchHover:n})}))},XN=function(e){var r=e.width,n=e.height,i=e.onChange,a=e.onSwatchHover,s=e.colors,o=e.hex,c=e.styles,h=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=Li(Bc({default:{picker:{width:r,height:n},overflow:{height:n,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},h)),x=function(T,A){return i({hex:T,source:"hex"},A)};return gt.createElement("div",{style:b.picker,className:"swatches-picker "+m},gt.createElement(Xx,null,gt.createElement("div",{style:b.overflow},gt.createElement("div",{style:b.body},Ry(s,function(E){return gt.createElement(yIe,{key:E.toString(),group:E,active:o,onClick:x,onSwatchHover:a})}),gt.createElement("div",{style:b.clear})))))};XN.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),height:Rn.oneOfType([Rn.string,Rn.number]),colors:Rn.arrayOf(Rn.arrayOf(Rn.string)),styles:Rn.object};XN.defaultProps={width:320,height:240,colors:[[zv[900],zv[700],zv[500],zv[300],zv[100]],[jv[900],jv[700],jv[500],jv[300],jv[100]],[Uv[900],Uv[700],Uv[500],Uv[300],Uv[100]],[Vv[900],Vv[700],Vv[500],Vv[300],Vv[100]],[$v[900],$v[700],$v[500],$v[300],$v[100]],[qv[900],qv[700],qv[500],qv[300],qv[100]],[Hv[900],Hv[700],Hv[500],Hv[300],Hv[100]],[Wv[900],Wv[700],Wv[500],Wv[300],Wv[100]],[Gv[900],Gv[700],Gv[500],Gv[300],Gv[100]],["#194D33",H1[700],H1[500],H1[300],H1[100]],[Xv[900],Xv[700],Xv[500],Xv[300],Xv[100]],[Yv[900],Yv[700],Yv[500],Yv[300],Yv[100]],[Zv[900],Zv[700],Zv[500],Zv[300],Zv[100]],[Kv[900],Kv[700],Kv[500],Kv[300],Kv[100]],[Jv[900],Jv[700],Jv[500],Jv[300],Jv[100]],[Qv[900],Qv[700],Qv[500],Qv[300],Qv[100]],[e0[900],e0[700],e0[500],e0[300],e0[100]],[t0[900],t0[700],t0[500],t0[300],t0[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}};zc(XN);var YN=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,a=e.colors,s=e.width,o=e.triangle,c=e.styles,h=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=Li(Bc({default:{card:{width:s,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},h),{"hide-triangle":o==="hide","top-left-triangle":o==="top-left","top-right-triangle":o==="top-right"}),x=function(T,A){Ug(T)&&r({hex:T,source:"hex"},A)};return gt.createElement("div",{style:b.card,className:"twitter-picker "+m},gt.createElement("div",{style:b.triangleShadow}),gt.createElement("div",{style:b.triangle}),gt.createElement("div",{style:b.body},Ry(a,function(E,T){return gt.createElement(ky,{key:T,color:E,hex:E,style:b.swatch,onClick:x,onHover:n,focusStyle:{boxShadow:"0 0 4px "+E}})}),gt.createElement("div",{style:b.hash},"#"),gt.createElement(ya,{label:null,style:{input:b.input},value:i.replace("#",""),onChange:x}),gt.createElement("div",{style:b.clear})))};YN.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),triangle:Rn.oneOf(["hide","top-left","top-right"]),colors:Rn.arrayOf(Rn.string),styles:Rn.object};YN.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}};zc(YN);var ZN=function(e){var r=Li({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",border:"2px #fff solid",transform:"translate(-12px, -13px)",background:"hsl("+Math.round(e.hsl.h)+", "+Math.round(e.hsl.s*100)+"%, "+Math.round(e.hsl.l*100)+"%)"}}});return gt.createElement("div",{style:r.picker})};ZN.propTypes={hsl:Rn.shape({h:Rn.number,s:Rn.number,l:Rn.number,a:Rn.number})};ZN.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var KN=function(e){var r=Li({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",transform:"translate(-10px, -7px)",background:"hsl("+Math.round(e.hsl.h)+", 100%, 50%)",border:"2px white solid"}}});return gt.createElement("div",{style:r.picker})};KN.propTypes={hsl:Rn.shape({h:Rn.number,s:Rn.number,l:Rn.number,a:Rn.number})};KN.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var vIe=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,a=e.hex,s=e.hsv,o=function(x,E){if(x.hex)Ug(x.hex)&&r({hex:x.hex,source:"hex"},E);else if(x.rgb){var T=x.rgb.split(",");nP(x.rgb,"rgb")&&r({r:T[0],g:T[1],b:T[2],a:1,source:"rgb"},E)}else if(x.hsv){var A=x.hsv.split(",");nP(x.hsv,"hsv")&&(A[2]=A[2].replace("%",""),A[1]=A[1].replace("%",""),A[0]=A[0].replace("",""),A[1]==1?A[1]=.01:A[2]==1&&(A[2]=.01),r({h:Number(A[0]),s:Number(A[1]),v:Number(A[2]),source:"hsv"},E))}else if(x.hsl){var M=x.hsl.split(",");nP(x.hsl,"hsl")&&(M[2]=M[2].replace("%",""),M[1]=M[1].replace("%",""),M[0]=M[0].replace("",""),m[1]==1?m[1]=.01:m[2]==1&&(m[2]=.01),r({h:Number(M[0]),s:Number(M[1]),v:Number(M[2]),source:"hsl"},E))}},c=Li({default:{wrap:{display:"flex",height:"100px",marginTop:"4px"},fields:{width:"100%"},column:{paddingTop:"10px",display:"flex",justifyContent:"space-between"},double:{padding:"0px 4.4px",boxSizing:"border-box"},input:{width:"100%",height:"38px",boxSizing:"border-box",padding:"4px 10% 3px",textAlign:"center",border:"1px solid #dadce0",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",fontFamily:"Roboto,Arial,sans-serif"},input2:{height:"38px",width:"100%",border:"1px solid #dadce0",boxSizing:"border-box",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",paddingLeft:"10px",fontFamily:"Roboto,Arial,sans-serif"},label:{textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"35px",top:"-6px",left:"0",right:"0",marginLeft:"auto",marginRight:"auto",fontFamily:"Roboto,Arial,sans-serif"},label2:{left:"10px",textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"32px",top:"-6px",fontFamily:"Roboto,Arial,sans-serif"},single:{flexGrow:"1",margin:"0px 4.4px"}}}),h=n.r+", "+n.g+", "+n.b,d=Math.round(i.h)+", "+Math.round(i.s*100)+"%, "+Math.round(i.l*100)+"%",m=Math.round(s.h)+", "+Math.round(s.s*100)+"%, "+Math.round(s.v*100)+"%";return gt.createElement("div",{style:c.wrap,className:"flexbox-fix"},gt.createElement("div",{style:c.fields},gt.createElement("div",{style:c.double},gt.createElement(ya,{style:{input:c.input,label:c.label},label:"hex",value:a,onChange:o})),gt.createElement("div",{style:c.column},gt.createElement("div",{style:c.single},gt.createElement(ya,{style:{input:c.input2,label:c.label2},label:"rgb",value:h,onChange:o})),gt.createElement("div",{style:c.single},gt.createElement(ya,{style:{input:c.input2,label:c.label2},label:"hsv",value:m,onChange:o})),gt.createElement("div",{style:c.single},gt.createElement(ya,{style:{input:c.input2,label:c.label2},label:"hsl",value:d,onChange:o})))))},JN=function(e){var r=e.width,n=e.onChange,i=e.rgb,a=e.hsl,s=e.hsv,o=e.hex,c=e.header,h=e.styles,d=h===void 0?{}:h,m=e.className,b=m===void 0?"":m,x=Li(Bc({default:{picker:{width:r,background:"#fff",border:"1px solid #dfe1e5",boxSizing:"initial",display:"flex",flexWrap:"wrap",borderRadius:"8px 8px 0px 0px"},head:{height:"57px",width:"100%",paddingTop:"16px",paddingBottom:"16px",paddingLeft:"16px",fontSize:"20px",boxSizing:"border-box",fontFamily:"Roboto-Regular,HelveticaNeue,Arial,sans-serif"},saturation:{width:"70%",padding:"0px",position:"relative",overflow:"hidden"},swatch:{width:"30%",height:"228px",padding:"0px",background:"rgba("+i.r+", "+i.g+", "+i.b+", 1)",position:"relative",overflow:"hidden"},body:{margin:"auto",width:"95%"},controls:{display:"flex",boxSizing:"border-box",height:"52px",paddingTop:"22px"},color:{width:"32px"},hue:{height:"8px",position:"relative",margin:"0px 16px 0px 16px",width:"100%"},Hue:{radius:"2px"}}},d));return gt.createElement("div",{style:x.picker,className:"google-picker "+b},gt.createElement("div",{style:x.head},c),gt.createElement("div",{style:x.swatch}),gt.createElement("div",{style:x.saturation},gt.createElement(A3,{hsl:a,hsv:s,pointer:ZN,onChange:n})),gt.createElement("div",{style:x.body},gt.createElement("div",{style:x.controls,className:"flexbox-fix"},gt.createElement("div",{style:x.hue},gt.createElement(x_,{style:x.Hue,hsl:a,radius:"4px",pointer:KN,onChange:n}))),gt.createElement(vIe,{rgb:i,hsl:a,hex:o,hsv:s,onChange:n})))};JN.propTypes={width:Rn.oneOfType([Rn.string,Rn.number]),styles:Rn.object,header:Rn.string};JN.defaultProps={width:652,styles:{},header:"Color picker"};zc(JN);const W1={rgba:t=>`rgba(${t.rgb.r}, ${t.rgb.g}, ${t.rgb.b}, ${t.rgb.a})`,rgb:t=>`rgb(${t.rgb.r}, ${t.rgb.g}, ${t.rgb.b})`,hex:t=>t.hex,rgba_rgb:t=>t.rgb.a===1?W1.rgb(t):W1.rgba(t),rgba_hex:t=>t.rgb.a===1?W1.hex(t):W1.rgba(t)},tx=({convert:t,...e})=>{const[r,n]=te.useState(!1),i=e?.value||"";return J.jsxs(J.Fragment,{children:[J.jsx(fp,{container:!0,sx:{flexWrap:"nowrap"},children:J.jsx(fp,{size:12,children:J.jsxs(ta,{variant:"outlined",onClick:()=>n(!0),sx:{minWidth:"100%",padding:"5px",marginBottom:"10px",justifyContent:"flex-start",borderColor:a=>a.palette.text.primary,color:a=>a.palette.text.primary},children:[J.jsx("div",{style:{width:"25px",height:"25px",marginRight:"10px",backgroundColor:i}}),i]})})}),r&&J.jsx("div",{style:{position:"relative",marginTop:0},children:J.jsxs("div",{style:{position:"absolute",zIndex:1e3},children:[J.jsx("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:()=>{n(!1)}}),J.jsx(W4e,{color:i,onChange:a=>{const s=W1[t](a);e?.onChange?.(s)}})]})})]})};tx.defaultProps={convert:"rgba_hex",label:"Color",name:"color"};try{tx.displayName="ColorPicker",tx.__docgenInfo={description:"",displayName:"ColorPicker",props:{onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: string) => void) | undefined"}},convert:{defaultValue:{value:"rgba_hex"},description:"",name:"convert",required:!1,type:{name:"enum",value:[{value:'"rgb"'},{value:'"rgba"'},{value:'"rgba_hex"'},{value:'"hex"'},{value:'"rgba_rgb"'}]}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string | undefined"}}}}}catch{}function YR({propKey:t,value:e,setPaintProps:r}){return J.jsx(tx,{value:e,label:"Color",onChange:n=>{r(i=>({...i,[t]:n}))}})}try{YR.displayName="PaintPropsColorPicker",YR.__docgenInfo={description:"",displayName:"PaintPropsColorPicker",props:{key:{defaultValue:null,description:"",name:"key",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},propKey:{defaultValue:null,description:"",name:"propKey",required:!0,type:{name:"string"}},setPaintProps:{defaultValue:null,description:"",name:"setPaintProps",required:!0,type:{name:"(paintProps: paintPropsType | ((current: paintPropsType) => paintPropsType)) => void"}}}}}catch{}const _Ie=Dr(uh)({marginLeft:"-100px",marginRight:"-21px",paddingLeft:"53px",borderRadius:"0px",boxShadow:"none",backgroundColor:"rgb(0, 0, 0, 0)"}),bIe=Dr(Bo)({marginLeft:"61px"}),IQ={"circle-color":"colorpicker","circle-radius":"slider","circle-stroke-color":"colorpicker","circle-stroke-width":"slider","fill-color":"colorpicker","fill-outline-color":"colorpicker","line-color":"colorpicker","line-width":"slider","line-blur":"slider"},xIe=Object.keys(IQ),wIe={"circle-stroke-width":{step:1,min:1,max:20},"circle-radius":{step:1,min:1,max:100},"line-blur":{step:1,min:1,max:100},"line-width":{step:1,min:1,max:100}};function AE({paintProps:t={},setPaintProps:e}){const r=te.useRef(Math.round(Math.random()*1e10)),n=te.useCallback(i=>{if(xIe.indexOf(i)!==-1&&(typeof t[i]=="number"||typeof t[i]=="string")){const a=J.jsx(Ss,{id:i+"_label",gutterBottom:!0,children:i});switch(IQ[i]){case"slider":return J.jsxs(gt.Fragment,{children:[a,J.jsx(dO,{...wIe[i],value:t[i],valueLabelDisplay:"auto",onChange:(s,o)=>{o&&e(c=>({...c,[i]:o}))}})]},i);case"numberfield":return J.jsxs(gt.Fragment,{children:[a,J.jsx(QT,{inputProps:{inputMode:"decimal",pattern:"[0-9]*"},value:t[i],onChange:s=>{s?.target?.value&&e(o=>({...o,[i]:parseInt(s.target.value)}))}})]},i);case"colorpicker":return J.jsxs(gt.Fragment,{children:[a,J.jsx(Bo,{sx:{"& > div":{width:"initial !important"}},children:J.jsx(YR,{value:t[i],propKey:i,setPaintProps:e},i)})]},i)}}return null},[t]);return J.jsx(J.Fragment,{children:J.jsx(_Ie,{children:J.jsx($h,{children:J.jsx(bIe,{children:Object.keys(t).map(i=>n(i))})},r+"_paintPropForm")})})}try{AE.displayName="LayerPropertyForm",AE.__docgenInfo={description:"",displayName:"LayerPropertyForm",props:{paintProps:{defaultValue:{value:"{}"},description:"",name:"paintProps",required:!1,type:{name:"paintPropsType"}},setPaintProps:{defaultValue:null,description:"",name:"setPaintProps",required:!0,type:{name:"(paintProps: paintPropsType | ((current: paintPropsType) => paintPropsType)) => void"}},layerType:{defaultValue:null,description:"",name:"layerType",required:!0,type:{name:"string"}}}}}catch{}const IE=Dr($h)(t=>({paddingRight:t?"56px":0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"})),SIe=Dr(kc)({padding:"4px",marginTop:"-3px"}),lp=Dr(jb)({minWidth:"30px"}),up=Dr(U0)({padding:0});function PE({configurable:t,vtProps:e,setVtProps:r,id:n,...i}){const[a,s]=te.useState(!1),[o,c]=te.useState(!0),[h,d]=te.useState(e.layers[n].paint);return te.useEffect(()=>{if(!r||typeof e.layers[n]?.layout?.visibility>"u"&&o||!o&&e.layers[n]?.layout?.visibility==="none"||o&&e.layers[n]?.layout?.visibility==="visible")return;const m=[...e.layers];m[n].layout?m[n].layout.visibility=o?"visible":"none":m[n].layout={visibility:o?"visible":"none"},r({...e,layers:m})},[o,n,r,e]),te.useEffect(()=>{c(!!i.visibleMaster)},[i.visibleMaster]),te.useEffect(()=>{if(r&&JSON.stringify(h)!==JSON.stringify(e.layers[n].paint)){const m={...h},b=[...e.layers];b[n].paint=m,r({...e,layers:b})}},[h,n,r,e]),J.jsxs(J.Fragment,{children:[J.jsxs(IE,{secondaryAction:t?J.jsx(SIe,{edge:"end","aria-label":"comments",onClick:()=>{s(m=>!m)},children:J.jsx(uN,{})}):void 0,children:[J.jsx(lp,{children:J.jsx(up,{checked:o,onClick:()=>{c(m=>!m)}})}),J.jsx(Dh,{primary:e.layers[n].id,variant:"layerlist"})]},n),t&&a&&J.jsx(AE,{paintProps:h,setPaintProps:d,layerType:e.layers[n].type})]})}PE.defaultProps={configurable:!0};try{IE.displayName="ListItemStyled",IE.__docgenInfo={description:"",displayName:"ListItemStyled",props:{}}}catch{}try{lp.displayName="CheckboxListItemIcon",lp.__docgenInfo={description:"",displayName:"CheckboxListItemIcon",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<unknown> | undefined"}}}}}catch{}try{up.displayName="CheckboxStyled",up.__docgenInfo={description:"",displayName:"CheckboxStyled",props:{component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements> | undefined"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<CheckboxSlots> | undefined"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:"{ root?: SlotProps<ElementType<SwitchBaseProps, keyof IntrinsicElements>, CheckboxRootSlotPropsOverrides, CheckboxOwnerState> | undefined; input?: SlotProps<...> | undefined; } | undefined"}}}}}catch{}try{PE.displayName="LayerListItemVectorLayer",PE.__docgenInfo={description:"",displayName:"LayerListItemVectorLayer",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},configurable:{defaultValue:{value:"true"},description:"",name:"configurable",required:!1,type:{name:"boolean | undefined"}},vtProps:{defaultValue:null,description:"",name:"vtProps",required:!0,type:{name:"MlVectorTileLayerProps"}},setVtProps:{defaultValue:null,description:"",name:"setVtProps",required:!0,type:{name:"((state: unknown) => void) | undefined"}},visibleMaster:{defaultValue:null,description:"",name:"visibleMaster",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function J0(t){return J.jsx(J.Fragment,{children:J.jsxs(oO,{open:t.open,onClose:t.onCancel,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[J.jsx(by,{id:"alert-dialog-title",children:t.title}),J.jsx(sO,{children:J.jsx(mpe,{id:"alert-dialog-description",children:t.text})}),J.jsxs(Dx,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{onClick:t.onConfirm,autoFocus:!0,children:"Confirm"})]})]})})}J0.defaultProps={title:"Confirm",text:"Are you sure?"};try{J0.displayName="ConfirmDialog",J0.__docgenInfo={description:"",displayName:"ConfirmDialog",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},title:{defaultValue:{value:"Confirm"},description:"",name:"title",required:!1,type:{name:"string"}},text:{defaultValue:{value:"Are you sure?"},description:"",name:"text",required:!1,type:{name:"string"}},onConfirm:{defaultValue:null,description:"",name:"onConfirm",required:!0,type:{name:"() => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}function EIe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return te.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const k3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function S_(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function QN(t){return"nodeType"in t}function jc(t){var e,r;return t?S_(t)?t:QN(t)&&(e=(r=t.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function eL(t){const{Document:e}=jc(t);return t instanceof e}function Yx(t){return S_(t)?!1:t instanceof jc(t).HTMLElement}function PQ(t){return t instanceof jc(t).SVGElement}function E_(t){return t?S_(t)?t.document:QN(t)?eL(t)?t:Yx(t)||PQ(t)?t.ownerDocument:document:document:document}const Cd=k3?te.useLayoutEffect:te.useEffect;function tL(t){const e=te.useRef(t);return Cd(()=>{e.current=t}),te.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function TIe(){const t=te.useRef(null),e=te.useCallback((n,i)=>{t.current=setInterval(n,i)},[]),r=te.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,r]}function rx(t,e){e===void 0&&(e=[t]);const r=te.useRef(t);return Cd(()=>{r.current!==t&&(r.current=t)},e),r}function Zx(t,e){const r=te.useRef();return te.useMemo(()=>{const n=t(r.current);return r.current=n,n},[...e])}function kE(t){const e=tL(t),r=te.useRef(null),n=te.useCallback(i=>{i!==r.current&&e?.(i,r.current),r.current=i},[]);return[r,n]}function ZR(t){const e=te.useRef();return te.useEffect(()=>{e.current=t},[t]),e.current}let aP={};function Kx(t,e){return te.useMemo(()=>{if(e)return e;const r=aP[t]==null?0:aP[t]+1;return aP[t]=r,t+"-"+r},[t,e])}function kQ(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((a,s)=>{const o=Object.entries(s);for(const[c,h]of o){const d=a[c];d!=null&&(a[c]=d+t*h)}return a},{...e})}}const I0=kQ(1),RE=kQ(-1);function CIe(t){return"clientX"in t&&"clientY"in t}function rL(t){if(!t)return!1;const{KeyboardEvent:e}=jc(t.target);return e&&t instanceof e}function AIe(t){if(!t)return!1;const{TouchEvent:e}=jc(t.target);return e&&t instanceof e}function KR(t){if(AIe(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:r}=t.touches[0];return{x:e,y:r}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:r}=t.changedTouches[0];return{x:e,y:r}}}return CIe(t)?{x:t.clientX,y:t.clientY}:null}const nx=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:r}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:r}=t;return"scaleX("+e+") scaleY("+r+")"}},Transform:{toString(t){if(t)return[nx.Translate.toString(t),nx.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:r,easing:n}=t;return e+" "+r+"ms "+n}}}),J$="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function IIe(t){return t.matches(J$)?t:t.querySelector(J$)}const PIe={display:"none"};function kIe(t){let{id:e,value:r}=t;return gt.createElement("div",{id:e,style:PIe},r)}function RIe(t){let{id:e,announcement:r,ariaLiveType:n="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return gt.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function MIe(){const[t,e]=te.useState("");return{announce:te.useCallback(n=>{n!=null&&e(n)},[]),announcement:t}}const RQ=te.createContext(null);function DIe(t){const e=te.useContext(RQ);te.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function OIe(){const[t]=te.useState(()=>new Set),e=te.useCallback(n=>(t.add(n),()=>t.delete(n)),[t]);return[te.useCallback(n=>{let{type:i,event:a}=n;t.forEach(s=>{var o;return(o=s[i])==null?void 0:o.call(s,a)})},[t]),e]}const NIe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},LIe={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function FIe(t){let{announcements:e=LIe,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=NIe}=t;const{announce:a,announcement:s}=MIe(),o=Kx("DndLiveRegion"),[c,h]=te.useState(!1);if(te.useEffect(()=>{h(!0)},[]),DIe(te.useMemo(()=>({onDragStart(m){let{active:b}=m;a(e.onDragStart({active:b}))},onDragMove(m){let{active:b,over:x}=m;e.onDragMove&&a(e.onDragMove({active:b,over:x}))},onDragOver(m){let{active:b,over:x}=m;a(e.onDragOver({active:b,over:x}))},onDragEnd(m){let{active:b,over:x}=m;a(e.onDragEnd({active:b,over:x}))},onDragCancel(m){let{active:b,over:x}=m;a(e.onDragCancel({active:b,over:x}))}}),[a,e])),!c)return null;const d=gt.createElement(gt.Fragment,null,gt.createElement(kIe,{id:n,value:i.draggable}),gt.createElement(RIe,{id:o,announcement:s}));return r?hp.createPortal(d,r):d}var Ll;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Ll||(Ll={}));function ME(){}function Q$(t,e){return te.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function BIe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return te.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const If=Object.freeze({x:0,y:0});function zIe(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function jIe(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return r-n}function UIe(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return n-r}function VIe(t,e){if(!t||t.length===0)return null;const[r]=t;return r[e]}function eq(t,e,r){return e===void 0&&(e=t.left),r===void 0&&(r=t.top),{x:e+t.width*.5,y:r+t.height*.5}}const $Ie=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=eq(e,e.left,e.top),a=[];for(const s of n){const{id:o}=s,c=r.get(o);if(c){const h=zIe(eq(c),i);a.push({id:o,data:{droppableContainer:s,value:h}})}}return a.sort(jIe)};function qIe(t,e){const r=Math.max(e.top,t.top),n=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),s=i-n,o=a-r;if(n<i&&r<a){const c=e.width*e.height,h=t.width*t.height,d=s*o,m=d/(c+h-d);return Number(m.toFixed(4))}return 0}const HIe=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=[];for(const a of n){const{id:s}=a,o=r.get(s);if(o){const c=qIe(o,e);c>0&&i.push({id:s,data:{droppableContainer:a,value:c}})}}return i.sort(UIe)};function WIe(t,e,r){return{...t,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function MQ(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:If}function GIe(t){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return i.reduce((s,o)=>({...s,top:s.top+t*o.y,bottom:s.bottom+t*o.y,left:s.left+t*o.x,right:s.right+t*o.x}),{...r})}}const XIe=GIe(1);function YIe(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function ZIe(t,e,r){const n=YIe(e);if(!n)return t;const{scaleX:i,scaleY:a,x:s,y:o}=n,c=t.left-s-(1-i)*parseFloat(r),h=t.top-o-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),d=i?t.width/i:t.width,m=a?t.height/a:t.height;return{width:d,height:m,top:h,right:c+d,bottom:h+m,left:c}}const KIe={ignoreTransform:!1};function T_(t,e){e===void 0&&(e=KIe);let r=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:h,transformOrigin:d}=jc(t).getComputedStyle(t);h&&(r=ZIe(r,h,d))}const{top:n,left:i,width:a,height:s,bottom:o,right:c}=r;return{top:n,left:i,width:a,height:s,bottom:o,right:c}}function tq(t){return T_(t,{ignoreTransform:!0})}function JIe(t){const e=t.innerWidth,r=t.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function QIe(t,e){return e===void 0&&(e=jc(t).getComputedStyle(t)),e.position==="fixed"}function ePe(t,e){e===void 0&&(e=jc(t).getComputedStyle(t));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const a=e[i];return typeof a=="string"?r.test(a):!1})}function nL(t,e){const r=[];function n(i){if(e!=null&&r.length>=e||!i)return r;if(eL(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!Yx(i)||PQ(i)||r.includes(i))return r;const a=jc(t).getComputedStyle(i);return i!==t&&ePe(i,a)&&r.push(i),QIe(i,a)?r:n(i.parentNode)}return t?n(t):r}function DQ(t){const[e]=nL(t,1);return e??null}function oP(t){return!k3||!t?null:S_(t)?t:QN(t)?eL(t)||t===E_(t).scrollingElement?window:Yx(t)?t:null:null}function OQ(t){return S_(t)?t.scrollX:t.scrollLeft}function NQ(t){return S_(t)?t.scrollY:t.scrollTop}function JR(t){return{x:OQ(t),y:NQ(t)}}var iu;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(iu||(iu={}));function LQ(t){return!k3||!t?!1:t===document.scrollingElement}function FQ(t){const e={x:0,y:0},r=LQ(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},n={x:t.scrollWidth-r.width,y:t.scrollHeight-r.height},i=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,s=t.scrollTop>=n.y,o=t.scrollLeft>=n.x;return{isTop:i,isLeft:a,isBottom:s,isRight:o,maxScroll:n,minScroll:e}}const tPe={x:.2,y:.2};function rPe(t,e,r,n,i){let{top:a,left:s,right:o,bottom:c}=r;n===void 0&&(n=10),i===void 0&&(i=tPe);const{isTop:h,isBottom:d,isLeft:m,isRight:b}=FQ(t),x={x:0,y:0},E={x:0,y:0},T={height:e.height*i.y,width:e.width*i.x};return!h&&a<=e.top+T.height?(x.y=iu.Backward,E.y=n*Math.abs((e.top+T.height-a)/T.height)):!d&&c>=e.bottom-T.height&&(x.y=iu.Forward,E.y=n*Math.abs((e.bottom-T.height-c)/T.height)),!b&&o>=e.right-T.width?(x.x=iu.Forward,E.x=n*Math.abs((e.right-T.width-o)/T.width)):!m&&s<=e.left+T.width&&(x.x=iu.Backward,E.x=n*Math.abs((e.left+T.width-s)/T.width)),{direction:x,speed:E}}function nPe(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:s}=window;return{top:0,left:0,right:a,bottom:s,width:a,height:s}}const{top:e,left:r,right:n,bottom:i}=t.getBoundingClientRect();return{top:e,left:r,right:n,bottom:i,width:t.clientWidth,height:t.clientHeight}}function BQ(t){return t.reduce((e,r)=>I0(e,JR(r)),If)}function iPe(t){return t.reduce((e,r)=>e+OQ(r),0)}function aPe(t){return t.reduce((e,r)=>e+NQ(r),0)}function oPe(t,e){if(e===void 0&&(e=T_),!t)return;const{top:r,left:n,bottom:i,right:a}=e(t);DQ(t)&&(i<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const sPe=[["x",["left","right"],iPe],["y",["top","bottom"],aPe]];class iL{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=nL(r),i=BQ(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,s,o]of sPe)for(const c of s)Object.defineProperty(this,c,{get:()=>{const h=o(n),d=i[a]-h;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class _b{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=e}add(e,r,n){var i;(i=this.target)==null||i.addEventListener(e,r,n),this.listeners.push([e,r,n])}}function lPe(t){const{EventTarget:e}=jc(t);return t instanceof e?t:E_(t)}function sP(t,e){const r=Math.abs(t.x),n=Math.abs(t.y);return typeof e=="number"?Math.sqrt(r**2+n**2)>e:"x"in e&&"y"in e?r>e.x&&n>e.y:"x"in e?r>e.x:"y"in e?n>e.y:!1}var Rh;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Rh||(Rh={}));function rq(t){t.preventDefault()}function uPe(t){t.stopPropagation()}var Ga;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Ga||(Ga={}));const zQ={start:[Ga.Space,Ga.Enter],cancel:[Ga.Esc],end:[Ga.Space,Ga.Enter,Ga.Tab]},cPe=(t,e)=>{let{currentCoordinates:r}=e;switch(t.code){case Ga.Right:return{...r,x:r.x+25};case Ga.Left:return{...r,x:r.x-25};case Ga.Down:return{...r,y:r.y+25};case Ga.Up:return{...r,y:r.y-25}}};class jQ{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new _b(E_(r)),this.windowListeners=new _b(jc(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Rh.Resize,this.handleCancel),this.windowListeners.add(Rh.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Rh.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,n=e.node.current;n&&oPe(n),r(If)}handleKeyDown(e){if(rL(e)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:a=zQ,coordinateGetter:s=cPe,scrollBehavior:o="smooth"}=i,{code:c}=e;if(a.end.includes(c)){this.handleEnd(e);return}if(a.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:h}=n.current,d=h?{x:h.left,y:h.top}:If;this.referenceCoordinates||(this.referenceCoordinates=d);const m=s(e,{active:r,context:n.current,currentCoordinates:d});if(m){const b=RE(m,d),x={x:0,y:0},{scrollableAncestors:E}=n.current;for(const T of E){const A=e.code,{isTop:M,isRight:F,isLeft:N,isBottom:O,maxScroll:U,minScroll:j}=FQ(T),H=nPe(T),G={x:Math.min(A===Ga.Right?H.right-H.width/2:H.right,Math.max(A===Ga.Right?H.left:H.left+H.width/2,m.x)),y:Math.min(A===Ga.Down?H.bottom-H.height/2:H.bottom,Math.max(A===Ga.Down?H.top:H.top+H.height/2,m.y))},X=A===Ga.Right&&!F||A===Ga.Left&&!N,ae=A===Ga.Down&&!O||A===Ga.Up&&!M;if(X&&G.x!==m.x){const Q=T.scrollLeft+b.x,W=A===Ga.Right&&Q<=U.x||A===Ga.Left&&Q>=j.x;if(W&&!b.y){T.scrollTo({left:Q,behavior:o});return}W?x.x=T.scrollLeft-Q:x.x=A===Ga.Right?T.scrollLeft-U.x:T.scrollLeft-j.x,x.x&&T.scrollBy({left:-x.x,behavior:o});break}else if(ae&&G.y!==m.y){const Q=T.scrollTop+b.y,W=A===Ga.Down&&Q<=U.y||A===Ga.Up&&Q>=j.y;if(W&&!b.x){T.scrollTo({top:Q,behavior:o});return}W?x.y=T.scrollTop-Q:x.y=A===Ga.Down?T.scrollTop-U.y:T.scrollTop-j.y,x.y&&T.scrollBy({top:-x.y,behavior:o});break}}this.handleMove(e,I0(RE(m,this.referenceCoordinates),x))}}}handleMove(e,r){const{onMove:n}=this.props;e.preventDefault(),n(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}jQ.activators=[{eventName:"onKeyDown",handler:(t,e,r)=>{let{keyboardCodes:n=zQ,onActivation:i}=e,{active:a}=r;const{code:s}=t.nativeEvent;if(n.start.includes(s)){const o=a.activatorNode.current;return o&&t.target!==o?!1:(t.preventDefault(),i?.({event:t.nativeEvent}),!0)}return!1}}];function nq(t){return!!(t&&"distance"in t)}function iq(t){return!!(t&&"delay"in t)}class aL{constructor(e,r,n){var i;n===void 0&&(n=lPe(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:a}=e,{target:s}=a;this.props=e,this.events=r,this.document=E_(s),this.documentListeners=new _b(this.document),this.listeners=new _b(n),this.windowListeners=new _b(jc(s)),this.initialCoordinates=(i=KR(a))!=null?i:If,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Rh.Resize,this.handleCancel),this.windowListeners.add(Rh.DragStart,rq),this.windowListeners.add(Rh.VisibilityChange,this.handleCancel),this.windowListeners.add(Rh.ContextMenu,rq),this.documentListeners.add(Rh.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(iq(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(nq(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(Rh.Click,uPe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Rh.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:n,initialCoordinates:i,props:a}=this,{onMove:s,options:{activationConstraint:o}}=a;if(!i)return;const c=(r=KR(e))!=null?r:If,h=RE(i,c);if(!n&&o){if(nq(o)){if(o.tolerance!=null&&sP(h,o.tolerance))return this.handleCancel();if(sP(h,o.distance))return this.handleStart()}if(iq(o)&&sP(h,o.tolerance))return this.handleCancel();this.handlePending(o,h);return}e.cancelable&&e.preventDefault(),s(c)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===Ga.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const hPe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class oL extends aL{constructor(e){const{event:r}=e,n=E_(r.target);super(e,hPe,n)}}oL.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const fPe={move:{name:"mousemove"},end:{name:"mouseup"}};var QR;(function(t){t[t.RightClick=2]="RightClick"})(QR||(QR={}));class UQ extends aL{constructor(e){super(e,fPe,E_(e.event.target))}}UQ.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return r.button===QR.RightClick?!1:(n?.({event:r}),!0)}}];const lP={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class dPe extends aL{constructor(e){super(e,lP)}static setup(){return window.addEventListener(lP.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(lP.move.name,e)};function e(){}}}dPe.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;const{touches:i}=r;return i.length>1?!1:(n?.({event:r}),!0)}}];var bb;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(bb||(bb={}));var DE;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(DE||(DE={}));function pPe(t){let{acceleration:e,activator:r=bb.Pointer,canScroll:n,draggingRect:i,enabled:a,interval:s=5,order:o=DE.TreeOrder,pointerCoordinates:c,scrollableAncestors:h,scrollableAncestorRects:d,delta:m,threshold:b}=t;const x=mPe({delta:m,disabled:!a}),[E,T]=TIe(),A=te.useRef({x:0,y:0}),M=te.useRef({x:0,y:0}),F=te.useMemo(()=>{switch(r){case bb.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case bb.DraggableRect:return i}},[r,i,c]),N=te.useRef(null),O=te.useCallback(()=>{const j=N.current;if(!j)return;const H=A.current.x*M.current.x,G=A.current.y*M.current.y;j.scrollBy(H,G)},[]),U=te.useMemo(()=>o===DE.TreeOrder?[...h].reverse():h,[o,h]);te.useEffect(()=>{if(!a||!h.length||!F){T();return}for(const j of U){if(n?.(j)===!1)continue;const H=h.indexOf(j),G=d[H];if(!G)continue;const{direction:X,speed:ae}=rPe(j,G,F,e,b);for(const Q of["x","y"])x[Q][X[Q]]||(ae[Q]=0,X[Q]=0);if(ae.x>0||ae.y>0){T(),N.current=j,E(O,s),A.current=ae,M.current=X;return}}A.current={x:0,y:0},M.current={x:0,y:0},T()},[e,O,n,T,a,s,JSON.stringify(F),JSON.stringify(x),E,h,U,d,JSON.stringify(b)])}const gPe={x:{[iu.Backward]:!1,[iu.Forward]:!1},y:{[iu.Backward]:!1,[iu.Forward]:!1}};function mPe(t){let{delta:e,disabled:r}=t;const n=ZR(e);return Zx(i=>{if(r||!n||!i)return gPe;const a={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[iu.Backward]:i.x[iu.Backward]||a.x===-1,[iu.Forward]:i.x[iu.Forward]||a.x===1},y:{[iu.Backward]:i.y[iu.Backward]||a.y===-1,[iu.Forward]:i.y[iu.Forward]||a.y===1}}},[r,e,n])}function yPe(t,e){const r=e!=null?t.get(e):void 0,n=r?r.node.current:null;return Zx(i=>{var a;return e==null?null:(a=n??i)!=null?a:null},[n,e])}function vPe(t,e){return te.useMemo(()=>t.reduce((r,n)=>{const{sensor:i}=n,a=i.activators.map(s=>({eventName:s.eventName,handler:e(s.handler,n)}));return[...r,...a]},[]),[t,e])}var ix;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(ix||(ix={}));var eM;(function(t){t.Optimized="optimized"})(eM||(eM={}));const aq=new Map;function _Pe(t,e){let{dragging:r,dependencies:n,config:i}=e;const[a,s]=te.useState(null),{frequency:o,measure:c,strategy:h}=i,d=te.useRef(t),m=A(),b=rx(m),x=te.useCallback(function(M){M===void 0&&(M=[]),!b.current&&s(F=>F===null?M:F.concat(M.filter(N=>!F.includes(N))))},[b]),E=te.useRef(null),T=Zx(M=>{if(m&&!r)return aq;if(!M||M===aq||d.current!==t||a!=null){const F=new Map;for(let N of t){if(!N)continue;if(a&&a.length>0&&!a.includes(N.id)&&N.rect.current){F.set(N.id,N.rect.current);continue}const O=N.node.current,U=O?new iL(c(O),O):null;N.rect.current=U,U&&F.set(N.id,U)}return F}return M},[t,a,r,m,c]);return te.useEffect(()=>{d.current=t},[t]),te.useEffect(()=>{m||x()},[r,m]),te.useEffect(()=>{a&&a.length>0&&s(null)},[JSON.stringify(a)]),te.useEffect(()=>{m||typeof o!="number"||E.current!==null||(E.current=setTimeout(()=>{x(),E.current=null},o))},[o,m,x,...n]),{droppableRects:T,measureDroppableContainers:x,measuringScheduled:a!=null};function A(){switch(h){case ix.Always:return!1;case ix.BeforeDragging:return r;default:return!r}}}function VQ(t,e){return Zx(r=>t?r||(typeof e=="function"?e(t):t):null,[e,t])}function bPe(t,e){return VQ(t,e)}function xPe(t){let{callback:e,disabled:r}=t;const n=tL(e),i=te.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(n)},[n,r]);return te.useEffect(()=>()=>i?.disconnect(),[i]),i}function R3(t){let{callback:e,disabled:r}=t;const n=tL(e),i=te.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(n)},[r]);return te.useEffect(()=>()=>i?.disconnect(),[i]),i}function wPe(t){return new iL(T_(t),t)}function oq(t,e,r){e===void 0&&(e=wPe);const[n,i]=te.useState(null);function a(){i(c=>{if(!t)return null;if(t.isConnected===!1){var h;return(h=c??r)!=null?h:null}const d=e(t);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const s=xPe({callback(c){if(t)for(const h of c){const{type:d,target:m}=h;if(d==="childList"&&m instanceof HTMLElement&&m.contains(t)){a();break}}}}),o=R3({callback:a});return Cd(()=>{a(),t?(o?.observe(t),s?.observe(document.body,{childList:!0,subtree:!0})):(o?.disconnect(),s?.disconnect())},[t]),n}function SPe(t){const e=VQ(t);return MQ(t,e)}const sq=[];function EPe(t){const e=te.useRef(t),r=Zx(n=>t?n&&n!==sq&&t&&e.current&&t.parentNode===e.current.parentNode?n:nL(t):sq,[t]);return te.useEffect(()=>{e.current=t},[t]),r}function TPe(t){const[e,r]=te.useState(null),n=te.useRef(t),i=te.useCallback(a=>{const s=oP(a.target);s&&r(o=>o?(o.set(s,JR(s)),new Map(o)):null)},[]);return te.useEffect(()=>{const a=n.current;if(t!==a){s(a);const o=t.map(c=>{const h=oP(c);return h?(h.addEventListener("scroll",i,{passive:!0}),[h,JR(h)]):null}).filter(c=>c!=null);r(o.length?new Map(o):null),n.current=t}return()=>{s(t),s(a)};function s(o){o.forEach(c=>{const h=oP(c);h?.removeEventListener("scroll",i)})}},[i,t]),te.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,s)=>I0(a,s),If):BQ(t):If,[t,e])}function lq(t,e){e===void 0&&(e=[]);const r=te.useRef(null);return te.useEffect(()=>{r.current=null},e),te.useEffect(()=>{const n=t!==If;n&&!r.current&&(r.current=t),!n&&r.current&&(r.current=null)},[t]),r.current?RE(t,r.current):If}function CPe(t){te.useEffect(()=>{if(!k3)return;const e=t.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of e)r?.()}},t.map(e=>{let{sensor:r}=e;return r}))}function APe(t,e){return te.useMemo(()=>t.reduce((r,n)=>{let{eventName:i,handler:a}=n;return r[i]=s=>{a(s,e)},r},{}),[t,e])}function $Q(t){return te.useMemo(()=>t?JIe(t):null,[t])}const uq=[];function IPe(t,e){e===void 0&&(e=T_);const[r]=t,n=$Q(r?jc(r):null),[i,a]=te.useState(uq);function s(){a(()=>t.length?t.map(c=>LQ(c)?n:new iL(e(c),c)):uq)}const o=R3({callback:s});return Cd(()=>{o?.disconnect(),s(),t.forEach(c=>o?.observe(c))},[t]),i}function PPe(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return Yx(e)?e:t}function kPe(t){let{measure:e}=t;const[r,n]=te.useState(null),i=te.useCallback(h=>{for(const{target:d}of h)if(Yx(d)){n(m=>{const b=e(d);return m?{...m,width:b.width,height:b.height}:b});break}},[e]),a=R3({callback:i}),s=te.useCallback(h=>{const d=PPe(h);a?.disconnect(),d&&a?.observe(d),n(d?e(d):null)},[e,a]),[o,c]=kE(s);return te.useMemo(()=>({nodeRef:o,rect:r,setRef:c}),[r,o,c])}const RPe=[{sensor:oL,options:{}},{sensor:jQ,options:{}}],MPe={current:{}},wS={draggable:{measure:tq},droppable:{measure:tq,strategy:ix.WhileDragging,frequency:eM.Optimized},dragOverlay:{measure:T_}};class xb extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,n;return(r=(n=this.get(e))==null?void 0:n.node.current)!=null?r:void 0}}const DPe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new xb,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:ME},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:wS,measureDroppableContainers:ME,windowRect:null,measuringScheduled:!1},OPe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:ME,draggableNodes:new Map,over:null,measureDroppableContainers:ME},M3=te.createContext(OPe),qQ=te.createContext(DPe);function NPe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new xb}}}function LPe(t,e){switch(e.type){case Ll.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Ll.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Ll.DragEnd:case Ll.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ll.RegisterDroppable:{const{element:r}=e,{id:n}=r,i=new xb(t.droppable.containers);return i.set(n,r),{...t,droppable:{...t.droppable,containers:i}}}case Ll.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=e,a=t.droppable.containers.get(r);if(!a||n!==a.key)return t;const s=new xb(t.droppable.containers);return s.set(r,{...a,disabled:i}),{...t,droppable:{...t.droppable,containers:s}}}case Ll.UnregisterDroppable:{const{id:r,key:n}=e,i=t.droppable.containers.get(r);if(!i||n!==i.key)return t;const a=new xb(t.droppable.containers);return a.delete(r),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function FPe(t){let{disabled:e}=t;const{active:r,activatorEvent:n,draggableNodes:i}=te.useContext(M3),a=ZR(n),s=ZR(r?.id);return te.useEffect(()=>{if(!e&&!n&&a&&s!=null){if(!rL(a)||document.activeElement===a.target)return;const o=i.get(s);if(!o)return;const{activatorNode:c,node:h}=o;if(!c.current&&!h.current)return;requestAnimationFrame(()=>{for(const d of[c.current,h.current]){if(!d)continue;const m=IIe(d);if(m){m.focus();break}}})}},[n,e,i,s,a]),null}function BPe(t,e){let{transform:r,...n}=e;return t!=null&&t.length?t.reduce((i,a)=>a({transform:i,...n}),r):r}function zPe(t){return te.useMemo(()=>({draggable:{...wS.draggable,...t?.draggable},droppable:{...wS.droppable,...t?.droppable},dragOverlay:{...wS.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function jPe(t){let{activeNode:e,measure:r,initialRect:n,config:i=!0}=t;const a=te.useRef(!1),{x:s,y:o}=typeof i=="boolean"?{x:i,y:i}:i;Cd(()=>{if(!s&&!o||!e){a.current=!1;return}if(a.current||!n)return;const h=e?.node.current;if(!h||h.isConnected===!1)return;const d=r(h),m=MQ(d,n);if(s||(m.x=0),o||(m.y=0),a.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const b=DQ(h);b&&b.scrollBy({top:m.y,left:m.x})}},[e,s,o,n,r])}const HQ=te.createContext({...If,scaleX:1,scaleY:1});var og;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(og||(og={}));const UPe=te.memo(function(e){var r,n,i,a;let{id:s,accessibility:o,autoScroll:c=!0,children:h,sensors:d=RPe,collisionDetection:m=HIe,measuring:b,modifiers:x,...E}=e;const T=te.useReducer(LPe,void 0,NPe),[A,M]=T,[F,N]=OIe(),[O,U]=te.useState(og.Uninitialized),j=O===og.Initialized,{draggable:{active:H,nodes:G,translate:X},droppable:{containers:ae}}=A,Q=H!=null?G.get(H):null,W=te.useRef({initial:null,translated:null}),oe=te.useMemo(()=>{var zr;return H!=null?{id:H,data:(zr=Q?.data)!=null?zr:MPe,rect:W}:null},[H,Q]),se=te.useRef(null),[he,_e]=te.useState(null),[Ce,me]=te.useState(null),xe=rx(E,Object.values(E)),Ae=Kx("DndDescribedBy",s),De=te.useMemo(()=>ae.getEnabled(),[ae]),de=zPe(b),{droppableRects:Ee,measureDroppableContainers:we,measuringScheduled:Le}=_Pe(De,{dragging:j,dependencies:[X.x,X.y],config:de.droppable}),Fe=yPe(G,H),Xe=te.useMemo(()=>Ce?KR(Ce):null,[Ce]),Be=hn(),ot=bPe(Fe,de.draggable.measure);jPe({activeNode:H!=null?G.get(H):null,config:Be.layoutShiftCompensation,initialRect:ot,measure:de.draggable.measure});const Qe=oq(Fe,de.draggable.measure,ot),rt=oq(Fe?Fe.parentElement:null),Re=te.useRef({activatorEvent:null,active:null,activeNode:Fe,collisionRect:null,collisions:null,droppableRects:Ee,draggableNodes:G,draggingNode:null,draggingNodeRect:null,droppableContainers:ae,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),zt=ae.getNodeFor((r=Re.current.over)==null?void 0:r.id),st=kPe({measure:de.dragOverlay.measure}),$e=(n=st.nodeRef.current)!=null?n:Fe,Jt=j?(i=st.rect)!=null?i:Qe:null,Ht=!!(st.nodeRef.current&&st.rect),pr=SPe(Ht?null:Qe),_t=$Q($e?jc($e):null),vr=EPe(j?zt??Fe:null),br=IPe(vr),lr=BPe(x,{transform:{x:X.x-pr.x,y:X.y-pr.y,scaleX:1,scaleY:1},activatorEvent:Ce,active:oe,activeNodeRect:Qe,containerNodeRect:rt,draggingNodeRect:Jt,over:Re.current.over,overlayNodeRect:st.rect,scrollableAncestors:vr,scrollableAncestorRects:br,windowRect:_t}),Cr=Xe?I0(Xe,X):null,Tr=TPe(vr),Qt=lq(Tr),at=lq(Tr,[Qe]),ke=I0(lr,Qt),be=Jt?XIe(Jt,lr):null,je=oe&&be?m({active:oe,collisionRect:be,droppableRects:Ee,droppableContainers:De,pointerCoordinates:Cr}):null,qe=VIe(je,"id"),[We,Lt]=te.useState(null),Et=Ht?lr:I0(lr,at),mt=WIe(Et,(a=We?.rect)!=null?a:null,Qe),ct=te.useRef(null),Kt=te.useCallback((zr,Mt)=>{let{sensor:en,options:jn}=Mt;if(se.current==null)return;const Qr=G.get(se.current);if(!Qr)return;const nr=zr.nativeEvent,oi=new en({active:se.current,activeNode:Qr,event:nr,options:jn,context:Re,onAbort(Kn){if(!G.get(Kn))return;const{onDragAbort:He}=xe.current,Tt={id:Kn};He?.(Tt),F({type:"onDragAbort",event:Tt})},onPending(Kn,Me,He,Tt){if(!G.get(Kn))return;const{onDragPending:Ut}=xe.current,Xr={id:Kn,constraint:Me,initialCoordinates:He,offset:Tt};Ut?.(Xr),F({type:"onDragPending",event:Xr})},onStart(Kn){const Me=se.current;if(Me==null)return;const He=G.get(Me);if(!He)return;const{onDragStart:Tt}=xe.current,Wt={activatorEvent:nr,active:{id:Me,data:He.data,rect:W}};hp.unstable_batchedUpdates(()=>{Tt?.(Wt),U(og.Initializing),M({type:Ll.DragStart,initialCoordinates:Kn,active:Me}),F({type:"onDragStart",event:Wt}),_e(ct.current),me(nr)})},onMove(Kn){M({type:Ll.DragMove,coordinates:Kn})},onEnd:un(Ll.DragEnd),onCancel:un(Ll.DragCancel)});ct.current=oi;function un(Kn){return async function(){const{active:He,collisions:Tt,over:Wt,scrollAdjustedTranslate:Ut}=Re.current;let Xr=null;if(He&&Ut){const{cancelDrop:Nn}=xe.current;Xr={activatorEvent:nr,active:He,collisions:Tt,delta:Ut,over:Wt},Kn===Ll.DragEnd&&typeof Nn=="function"&&await Promise.resolve(Nn(Xr))&&(Kn=Ll.DragCancel)}se.current=null,hp.unstable_batchedUpdates(()=>{M({type:Kn}),U(og.Uninitialized),Lt(null),_e(null),me(null),ct.current=null;const Nn=Kn===Ll.DragEnd?"onDragEnd":"onDragCancel";if(Xr){const Bi=xe.current[Nn];Bi?.(Xr),F({type:Nn,event:Xr})}})}}},[G]),qt=te.useCallback((zr,Mt)=>(en,jn)=>{const Qr=en.nativeEvent,nr=G.get(jn);if(se.current!==null||!nr||Qr.dndKit||Qr.defaultPrevented)return;const oi={active:nr};zr(en,Mt.options,oi)===!0&&(Qr.dndKit={capturedBy:Mt.sensor},se.current=jn,Kt(en,Mt))},[G,Kt]),Ir=vPe(d,qt);CPe(d),Cd(()=>{Qe&&O===og.Initializing&&U(og.Initialized)},[Qe,O]),te.useEffect(()=>{const{onDragMove:zr}=xe.current,{active:Mt,activatorEvent:en,collisions:jn,over:Qr}=Re.current;if(!Mt||!en)return;const nr={active:Mt,activatorEvent:en,collisions:jn,delta:{x:ke.x,y:ke.y},over:Qr};hp.unstable_batchedUpdates(()=>{zr?.(nr),F({type:"onDragMove",event:nr})})},[ke.x,ke.y]),te.useEffect(()=>{const{active:zr,activatorEvent:Mt,collisions:en,droppableContainers:jn,scrollAdjustedTranslate:Qr}=Re.current;if(!zr||se.current==null||!Mt||!Qr)return;const{onDragOver:nr}=xe.current,oi=jn.get(qe),un=oi&&oi.rect.current?{id:oi.id,rect:oi.rect.current,data:oi.data,disabled:oi.disabled}:null,Kn={active:zr,activatorEvent:Mt,collisions:en,delta:{x:Qr.x,y:Qr.y},over:un};hp.unstable_batchedUpdates(()=>{Lt(un),nr?.(Kn),F({type:"onDragOver",event:Kn})})},[qe]),Cd(()=>{Re.current={activatorEvent:Ce,active:oe,activeNode:Fe,collisionRect:be,collisions:je,droppableRects:Ee,draggableNodes:G,draggingNode:$e,draggingNodeRect:Jt,droppableContainers:ae,over:We,scrollableAncestors:vr,scrollAdjustedTranslate:ke},W.current={initial:Jt,translated:be}},[oe,Fe,je,be,G,$e,Jt,Ee,ae,We,vr,ke]),pPe({...Be,delta:X,draggingRect:be,pointerCoordinates:Cr,scrollableAncestors:vr,scrollableAncestorRects:br});const Ar=te.useMemo(()=>({active:oe,activeNode:Fe,activeNodeRect:Qe,activatorEvent:Ce,collisions:je,containerNodeRect:rt,dragOverlay:st,draggableNodes:G,droppableContainers:ae,droppableRects:Ee,over:We,measureDroppableContainers:we,scrollableAncestors:vr,scrollableAncestorRects:br,measuringConfiguration:de,measuringScheduled:Le,windowRect:_t}),[oe,Fe,Qe,Ce,je,rt,st,G,ae,Ee,We,we,vr,br,de,Le,_t]),$r=te.useMemo(()=>({activatorEvent:Ce,activators:Ir,active:oe,activeNodeRect:Qe,ariaDescribedById:{draggable:Ae},dispatch:M,draggableNodes:G,over:We,measureDroppableContainers:we}),[Ce,Ir,oe,Qe,M,Ae,G,We,we]);return gt.createElement(RQ.Provider,{value:N},gt.createElement(M3.Provider,{value:$r},gt.createElement(qQ.Provider,{value:Ar},gt.createElement(HQ.Provider,{value:mt},h)),gt.createElement(FPe,{disabled:o?.restoreFocus===!1})),gt.createElement(FIe,{...o,hiddenTextDescribedById:Ae}));function hn(){const zr=he?.autoScrollEnabled===!1,Mt=typeof c=="object"?c.enabled===!1:c===!1,en=j&&!zr&&!Mt;return typeof c=="object"?{...c,enabled:en}:{enabled:en}}}),VPe=te.createContext(null),cq="button",$Pe="Draggable";function qPe(t){let{id:e,data:r,disabled:n=!1,attributes:i}=t;const a=Kx($Pe),{activators:s,activatorEvent:o,active:c,activeNodeRect:h,ariaDescribedById:d,draggableNodes:m,over:b}=te.useContext(M3),{role:x=cq,roleDescription:E="draggable",tabIndex:T=0}=i??{},A=c?.id===e,M=te.useContext(A?HQ:VPe),[F,N]=kE(),[O,U]=kE(),j=APe(s,e),H=rx(r);Cd(()=>(m.set(e,{id:e,key:a,node:F,activatorNode:O,data:H}),()=>{const X=m.get(e);X&&X.key===a&&m.delete(e)}),[m,e]);const G=te.useMemo(()=>({role:x,tabIndex:T,"aria-disabled":n,"aria-pressed":A&&x===cq?!0:void 0,"aria-roledescription":E,"aria-describedby":d.draggable}),[n,x,T,A,E,d.draggable]);return{active:c,activatorEvent:o,activeNodeRect:h,attributes:G,isDragging:A,listeners:n?void 0:j,node:F,over:b,setNodeRef:N,setActivatorNodeRef:U,transform:M}}function HPe(){return te.useContext(qQ)}const WPe="Droppable",GPe={timeout:25};function XPe(t){let{data:e,disabled:r=!1,id:n,resizeObserverConfig:i}=t;const a=Kx(WPe),{active:s,dispatch:o,over:c,measureDroppableContainers:h}=te.useContext(M3),d=te.useRef({disabled:r}),m=te.useRef(!1),b=te.useRef(null),x=te.useRef(null),{disabled:E,updateMeasurementsFor:T,timeout:A}={...GPe,...i},M=rx(T??n),F=te.useCallback(()=>{if(!m.current){m.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{h(Array.isArray(M.current)?M.current:[M.current]),x.current=null},A)},[A]),N=R3({callback:F,disabled:E||!s}),O=te.useCallback((G,X)=>{N&&(X&&(N.unobserve(X),m.current=!1),G&&N.observe(G))},[N]),[U,j]=kE(O),H=rx(e);return te.useEffect(()=>{!N||!U.current||(N.disconnect(),m.current=!1,N.observe(U.current))},[U,N]),te.useEffect(()=>(o({type:Ll.RegisterDroppable,element:{id:n,key:a,disabled:r,node:U,rect:b,data:H}}),()=>o({type:Ll.UnregisterDroppable,key:a,id:n})),[n]),te.useEffect(()=>{r!==d.current.disabled&&(o({type:Ll.SetDroppableDisabled,id:n,key:a,disabled:r}),d.current.disabled=r)},[n,a,r,o]),{active:s,rect:b,isOver:c?.id===n,node:U,over:c,setNodeRef:j}}function WQ(t,e,r){const n=t.slice();return n.splice(r<0?n.length+r:r,0,n.splice(e,1)[0]),n}function YPe(t,e){return t.reduce((r,n,i)=>{const a=e.get(n);return a&&(r[i]=a),r},Array(t.length))}function Ow(t){return t!==null&&t>=0}function ZPe(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function KPe(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const GQ=t=>{let{rects:e,activeIndex:r,overIndex:n,index:i}=t;const a=WQ(e,n,r),s=e[i],o=a[i];return!o||!s?null:{x:o.left-s.left,y:o.top-s.top,scaleX:o.width/s.width,scaleY:o.height/s.height}},Nw={scaleX:1,scaleY:1},JPe=t=>{var e;let{activeIndex:r,activeNodeRect:n,index:i,rects:a,overIndex:s}=t;const o=(e=a[r])!=null?e:n;if(!o)return null;if(i===r){const h=a[s];return h?{x:0,y:r<s?h.top+h.height-(o.top+o.height):h.top-o.top,...Nw}:null}const c=QPe(a,i,r);return i>r&&i<=s?{x:0,y:-o.height-c,...Nw}:i<r&&i>=s?{x:0,y:o.height+c,...Nw}:{x:0,y:0,...Nw}};function QPe(t,e,r){const n=t[e],i=t[e-1],a=t[e+1];return n?r<e?i?n.top-(i.top+i.height):a?a.top-(n.top+n.height):0:a?a.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const XQ="Sortable",YQ=gt.createContext({activeIndex:-1,containerId:XQ,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:GQ,disabled:{draggable:!1,droppable:!1}});function eke(t){let{children:e,id:r,items:n,strategy:i=GQ,disabled:a=!1}=t;const{active:s,dragOverlay:o,droppableRects:c,over:h,measureDroppableContainers:d}=HPe(),m=Kx(XQ,r),b=o.rect!==null,x=te.useMemo(()=>n.map(j=>typeof j=="object"&&"id"in j?j.id:j),[n]),E=s!=null,T=s?x.indexOf(s.id):-1,A=h?x.indexOf(h.id):-1,M=te.useRef(x),F=!ZPe(x,M.current),N=A!==-1&&T===-1||F,O=KPe(a);Cd(()=>{F&&E&&d(x)},[F,x,E,d]),te.useEffect(()=>{M.current=x},[x]);const U=te.useMemo(()=>({activeIndex:T,containerId:m,disabled:O,disableTransforms:N,items:x,overIndex:A,useDragOverlay:b,sortedRects:YPe(x,c),strategy:i}),[T,m,O.draggable,O.droppable,N,x,A,c,b,i]);return gt.createElement(YQ.Provider,{value:U},e)}const tke=t=>{let{id:e,items:r,activeIndex:n,overIndex:i}=t;return WQ(r,n,i).indexOf(e)},rke=t=>{let{containerId:e,isSorting:r,wasDragging:n,index:i,items:a,newIndex:s,previousItems:o,previousContainerId:c,transition:h}=t;return!h||!n||o!==a&&i===s?!1:r?!0:s!==i&&e===c},nke={duration:200,easing:"ease"},ZQ="transform",ike=nx.Transition.toString({property:ZQ,duration:0,easing:"linear"}),ake={roleDescription:"sortable"};function oke(t){let{disabled:e,index:r,node:n,rect:i}=t;const[a,s]=te.useState(null),o=te.useRef(r);return Cd(()=>{if(!e&&r!==o.current&&n.current){const c=i.current;if(c){const h=T_(n.current,{ignoreTransform:!0}),d={x:c.left-h.left,y:c.top-h.top,scaleX:c.width/h.width,scaleY:c.height/h.height};(d.x||d.y)&&s(d)}}r!==o.current&&(o.current=r)},[e,r,n,i]),te.useEffect(()=>{a&&s(null)},[a]),a}function ske(t){let{animateLayoutChanges:e=rke,attributes:r,disabled:n,data:i,getNewIndex:a=tke,id:s,strategy:o,resizeObserverConfig:c,transition:h=nke}=t;const{items:d,containerId:m,activeIndex:b,disabled:x,disableTransforms:E,sortedRects:T,overIndex:A,useDragOverlay:M,strategy:F}=te.useContext(YQ),N=lke(n,x),O=d.indexOf(s),U=te.useMemo(()=>({sortable:{containerId:m,index:O,items:d},...i}),[m,i,O,d]),j=te.useMemo(()=>d.slice(d.indexOf(s)),[d,s]),{rect:H,node:G,isOver:X,setNodeRef:ae}=XPe({id:s,data:U,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:j,...c}}),{active:Q,activatorEvent:W,activeNodeRect:oe,attributes:se,setNodeRef:he,listeners:_e,isDragging:Ce,over:me,setActivatorNodeRef:xe,transform:Ae}=qPe({id:s,data:U,attributes:{...ake,...r},disabled:N.draggable}),De=EIe(ae,he),de=!!Q,Ee=de&&!E&&Ow(b)&&Ow(A),we=!M&&Ce,Le=we&&Ee?Ae:null,Xe=Ee?Le??(o??F)({rects:T,activeNodeRect:oe,activeIndex:b,overIndex:A,index:O}):null,Be=Ow(b)&&Ow(A)?a({id:s,items:d,activeIndex:b,overIndex:A}):O,ot=Q?.id,Qe=te.useRef({activeId:ot,items:d,newIndex:Be,containerId:m}),rt=d!==Qe.current.items,Re=e({active:Q,containerId:m,isDragging:Ce,isSorting:de,id:s,index:O,items:d,newIndex:Qe.current.newIndex,previousItems:Qe.current.items,previousContainerId:Qe.current.containerId,transition:h,wasDragging:Qe.current.activeId!=null}),zt=oke({disabled:!Re,index:O,node:G,rect:H});return te.useEffect(()=>{de&&Qe.current.newIndex!==Be&&(Qe.current.newIndex=Be),m!==Qe.current.containerId&&(Qe.current.containerId=m),d!==Qe.current.items&&(Qe.current.items=d)},[de,Be,m,d]),te.useEffect(()=>{if(ot===Qe.current.activeId)return;if(ot!=null&&Qe.current.activeId==null){Qe.current.activeId=ot;return}const $e=setTimeout(()=>{Qe.current.activeId=ot},50);return()=>clearTimeout($e)},[ot]),{active:Q,activeIndex:b,attributes:se,data:U,rect:H,index:O,newIndex:Be,items:d,isOver:X,isSorting:de,isDragging:Ce,listeners:_e,node:G,overIndex:A,over:me,setNodeRef:De,setActivatorNodeRef:xe,setDroppableNodeRef:ae,setDraggableNodeRef:he,transform:zt??Xe,transition:st()};function st(){if(zt||rt&&Qe.current.newIndex===O)return ike;if(!(we&&!rL(W)||!h)&&(de||Re))return nx.Transition.toString({...h,property:ZQ})}}function lke(t,e){var r,n;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(r=t?.draggable)!=null?r:e.draggable,droppable:(n=t?.droppable)!=null?n:e.droppable}}Ga.Down,Ga.Right,Ga.Up,Ga.Left;function OE({children:t}){const e=te.useRef(vc()),{attributes:r,listeners:n,setNodeRef:i,transform:a}=ske({id:e.current}),s={transform:nx.Transform.toString(a)};return J.jsx("li",{ref:i,style:s,...r,...n,children:t})}try{OE.displayName="SortableContainer",OE.__docgenInfo={description:"",displayName:"SortableContainer",props:{}}}catch{}const uke=Dr(kc)({padding:"4px",marginTop:"-3px"}),cke=Dr(kc)({marginLeft:"20px"});function dp({layerComponent:t,visible:e,type:r,name:n,description:i,configurable:a,setLayerState:s,...o}){const[c,h]=te.useState(!0),[d,m]=te.useState(!1),[b,x]=te.useState(!1),E=te.useRef(!1),T=te.useRef(e),[A,M]=te.useState(t?.props?.paint||t?.props?.options?.paint||EJ(t?.props?.type||_E(t.props.geojson))),F=te.useMemo(()=>e?c:!1,[e,c]);te.useEffect(()=>{if(!s||!t?.props?.layers||F===T.current)return;T.current=F;const j={...t?.props};switch(t.type.name){case"MlWmsLayer":break;case"MlVectorTileLayer":t?.props?.layers&&!E.current&&(j.layers=t?.props?.layers.map(H=>(H.layout?H.layout.visibility=F?"visible":"none":H.layout={visibility:F?"visible":"none"},H)),console.log("setLayerState",j.layers),s(j));break}},[F,s,t]),te.useEffect(()=>{!s||E.current||!A||t?.props?.layers||JSON.stringify(A)!==JSON.stringify(t.props?.paint)&&s({...t.props,paint:A})},[A,s,t.props?.paint]);const N=te.useMemo(()=>{if(t&&r==="layer")switch(t.type.displayName){case"MlWmsLayer":return gt.cloneElement(t,{...t?.props,visible:F});case"MlVectorTileLayer":return gt.cloneElement(t,{...t?.props});default:case"MlGeoJsonLayer":return gt.cloneElement(t,{layout:{visibility:F?"visible":"none"},options:{...t?.props?.options,...s?{}:{paint:A}}})}return J.jsx(J.Fragment,{})},[r,t,A,F,t?.props?.layers,s]),O=te.useMemo(()=>{if(t&&r==="layer"){if(t.props.type)return t.props.type;if(t.props.geojson)return _E(t.props.geojson)}},[t]),U=J.jsxs(IE,{sx:{...o.listItemSx},secondaryAction:a&&Object.keys(A)?.length>0?J.jsxs(J.Fragment,{children:[o?.buttons,J.jsx(uke,{edge:"end","aria-label":"settings",onClick:()=>{m(j=>!j)},children:J.jsx(uN,{})})]}):void 0,children:[J.jsx(lp,{children:J.jsx(up,{disabled:!e,checked:c,onClick:()=>{h(j=>!j)}})}),J.jsx(Dh,{variant:"layerlist",primary:n,secondary:i,primaryTypographyProps:{overflow:"hidden"}})]});return J.jsxs(J.Fragment,{children:[o.sortable&&o.layerId&&!t?.props?.layers&&J.jsx(OE,{children:U}),!o.sortable&&!t?.props?.layers&&U,N,!t?.props?.layers&&Object.keys(A).length>0&&a&&d&&J.jsxs(J.Fragment,{children:[o.showDeleteButton&&J.jsxs(J.Fragment,{children:[J.jsx(cke,{edge:"end","aria-label":"delete",onClick:()=>{typeof s=="function"&&x(!0)},children:J.jsx(qx,{})}),b&&J.jsx(J0,{open:b,onConfirm:()=>{typeof s=="function"&&(E.current=!0,s(!1),x(!1))},onCancel:()=>{x(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]}),J.jsx(AE,{paintProps:A,setPaintProps:M,layerType:O})]}),t?.props?.layers&&J.jsx(UR,{visible:c,setVisible:h,name:n,children:t?.props?.layers?.map?.((j,H)=>J.jsx(PE,{vtProps:t?.props,setVtProps:s,id:""+H,visibleMaster:F},""+H))})]})}dp.defaultProps={type:"layer",visible:!0,showDeleteButton:!1,buttons:J.jsx(J.Fragment,{})};try{dp.displayName="LayerListItem",dp.__docgenInfo={description:"",displayName:"LayerListItem",props:{layerComponent:{defaultValue:null,description:"",name:"layerComponent",required:!0,type:{name:"Element"}},visible:{defaultValue:{value:"true"},description:"",name:"visible",required:!1,type:{name:"boolean"}},configurable:{defaultValue:null,description:"",name:"configurable",required:!0,type:{name:"boolean"}},type:{defaultValue:{value:"layer"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"layer"'},{value:'"background"'},{value:'"background-labels"'},{value:'"wms-layer"'},{value:'"vector-tile-layer"'}]}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"ReactNode"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string | undefined"}},setLayerState:{defaultValue:null,description:"",name:"setLayerState",required:!1,type:{name:"Dispatch<any> | undefined"}},showDeleteButton:{defaultValue:{value:"false"},description:"",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},listItemSx:{defaultValue:null,description:"",name:"listItemSx",required:!1,type:{name:"SxProps | undefined"}},buttons:{defaultValue:{value:"<></>"},description:"",name:"buttons",required:!1,type:{name:"Element | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}}}}}catch{}const KQ=Ji(J.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),hke=Dr("div")(()=>({display:"flex",alignItems:"center"})),fke=56,dke=Dr(Bo)(({theme:t})=>({width:30,height:6,backgroundColor:t.palette.text.primary,borderRadius:3,position:"absolute",top:8,left:"calc(50% - 15px)"}));function tM({drawerPaperProps:t,drawerHeaderProps:e,setOpen:r,...n}){const i=Ox(c=>c.breakpoints.down("sm")),[a,s]=te.useState(!1),o=n.drawerBleeding?n.drawerBleeding:fke;return J.jsxs(J.Fragment,{children:[i?J.jsxs(Bo,{sx:{display:{xs:"flex",sm:"none"}},children:[J.jsx(nX,{styles:{".MuiDrawer-root > .MuiPaper-root":{height:`calc(50% - ${o}px)`,overflow:"visible"}}}),J.jsxs(_ye,{anchor:"bottom",open:typeof n.open>"u"?a:n.open,onClose:r?()=>{r?.(!1)}:()=>{s(!1)},onOpen:r?()=>{r?.(!0)}:()=>{s(!0)},swipeAreaWidth:o,disableSwipeToOpen:!1,hideBackdrop:!0,ModalProps:{keepMounted:!0,sx:{top:"calc(90%)"}},children:[J.jsxs(uh,{sx:{position:"absolute",top:-o,borderTopLeftRadius:8,borderTopRightRadius:8,visibility:"visible",right:0,left:0},children:[J.jsx(dke,{}),J.jsx(Ss,{variant:"h6",sx:{p:"13px"},children:n.name})]}),J.jsx(uh,{sx:{px:"15px",pb:"15px",height:"100%",overflow:"auto",paddingTop:"20px"},children:n.children})]})]}):J.jsx(Bo,{sx:{display:{xs:"none",sm:"flex"},mr:1},children:J.jsxs(lO,{transitionDuration:0,variant:"persistent",anchor:"left",open:typeof n.open>"u"?a:n.open,PaperProps:{...t,sx:{maxWidth:{lg:"30%",md:"40%",sm:"50%",xs:"78%"},padding:{sm:"84px 20px 20px 20px",xs:"74px 10px 10px 10px"},width:{xs:"80%",sm:"60%",md:"350px",lg:"350px"},boxSizing:"border-box",...t?.sx}},sx:{flexGrow:1,zIndex:105,position:"absolute",bottom:0,display:"flex",flexDirection:"column",maxWidth:{lg:"30%",md:"40%",sm:"50%",xs:"78%"},...a?{}:{left:i?"-90vw":"-20vw"}},...n,children:[J.jsxs(hke,{...e,children:[J.jsx(Ss,{variant:"h6",children:n.name}),J.jsx(kc,{onClick:r?()=>{r?.(!1)}:()=>{s(!1)},sx:{position:"absolute",right:"20px"},children:J.jsx(KQ,{})})]}),J.jsx(Bo,{children:n.children})]})}),";"]})}try{tM.displayName="Sidebar",tM.__docgenInfo={description:"",displayName:"Sidebar",props:{drawerPaperProps:{defaultValue:null,description:"",name:"drawerPaperProps",required:!1,type:{name:"PaperProps | undefined"}},drawerHeaderProps:{defaultValue:null,description:"",name:"drawerHeaderProps",required:!1,type:{name:"Headers | undefined"}},children:{defaultValue:null,description:"The content of the component.",name:"children",required:!1,type:{name:"ReactNode"}},open:{defaultValue:{value:"false"},description:"If `true`, the component is shown.",name:"open",required:!1,type:{name:"boolean | undefined"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!1,type:{name:"((val: boolean) => void) | undefined"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string | undefined"}},drawerBleeding:{defaultValue:null,description:"",name:"drawerBleeding",required:!1,type:{name:"number | undefined"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements> | undefined"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<DrawerSlots> | undefined"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:"{ root?: SlotProps<ElementType<ModalProps, keyof IntrinsicElements>, DrawerRootSlotPropsOverrides, DrawerOwnerState> | undefined; backdrop?: SlotProps<...> | undefined; docked?: SlotProps<...> | undefined; paper?: SlotProps<...> | undefined; transition?: SlotProps<...> | undefined; } | undefined"}}}}}catch{}const hq=t=>{const[e,r]=te.useState(!0),[n,i]=te.useState(t.measureType),[a,s]=te.useState(),o=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[c,h]=te.useState(),[d,m]=te.useState("kilometers"),[b,x]=te.useState([]),[E,T]=te.useState(!1),A=()=>{d==="kilometers"&&m("miles"),d==="miles"&&m("kilometers")},M=N=>{x(O=>{const U=[...O];return U.splice(N,1),s(void 0),U})},F=N=>{h({measure:N.value,unit:N.unit,geojson:N.geojson})};return te.useEffect(()=>{E&&(T(!1),c&&x(N=>{const O=[...N];return O.push(c),O}))},[E]),te.useEffect(()=>{h(void 0)},[d]),J.jsx(J.Fragment,{children:J.jsxs(tM,{open:e,setOpen:r,name:"Multi Measure Tool",children:[J.jsxs(Bo,{sx:{flexGrow:1},children:[J.jsx("br",{}),J.jsxs(fp,{container:!0,spacing:4,justifyContent:"flex-start",children:[J.jsx(fp,{size:3,children:J.jsx(fg,{title:"Measure Area",children:J.jsx(ta,{variant:"outlined",sx:{backgroundColor:n==="polygon"?N=>N.palette.GPS.GPSActiveColor:N=>N.palette.GPS.GPSActiveBackgroundColor,color:n==="polygon"?N=>N.palette.GPS.GPSActiveBackgroundColor:N=>N.palette.GPS.GPSActiveColor},onClick:()=>{i("polygon"),h(void 0),T(!0)},children:J.jsx(CJ,{})})})}),J.jsx(fp,{size:3,children:J.jsx(fg,{title:"Measure Distance",children:J.jsx(ta,{variant:"outlined",sx:{backgroundColor:n==="line"?N=>N.palette.GPS.GPSActiveColor:N=>N.palette.GPS.GPSActiveBackgroundColor,color:n==="line"?N=>N.palette.GPS.GPSActiveBackgroundColor:N=>N.palette.GPS.GPSActiveColor},onClick:()=>{i("line"),h(void 0),T(!0)},children:J.jsx(TJ,{})})})})]})]}),J.jsx("br",{}),J.jsx(fp,{size:4,children:J.jsxs(ih,{children:[J.jsx(_g,{id:"unit-select-label",children:"Unit"}),J.jsxs(bg,{labelId:"unit-select-label",id:"unit-select",value:d,label:"Unit",onChange:N=>{m(N.target.value),h(void 0),T(!0)},children:[J.jsx(Fm,{value:"kilometers",children:"Kilometers"}),J.jsx(Fm,{value:"miles",children:"Miles"})]})]})}),J.jsx("br",{}),!E&&J.jsx(zR,{measureType:n,unit:d,onChange:F,...A,onFinish:()=>{T(!0)}}),J.jsxs(jR,{children:[b?.map((N,O)=>J.jsx(J.Fragment,{children:J.jsxs(Bo,{sx:{display:"flex",flexDirection:"column"},children:[J.jsx("br",{}),J.jsx(Bo,{flexDirection:"row",sx:{"&:hover":{backgroundColor:"rgb(177, 177, 177, 0.2)"},marginTop:"25px"},onMouseOver:()=>{s(N.geojson)},onMouseLeave:()=>{s(void 0)},children:J.jsxs(te.Fragment,{children:[J.jsx(dp,{layerComponent:J.jsx(Dc,{mapId:t.mapId,geojson:N.geojson}),visible:!0,configurable:!0,type:"layer",name:N.geojson.geometry?.type==="LineString"?N.measure.toFixed(3).toString()+" "+N.unit:N.measure.toFixed(3).toString()+" "+N.unit+""},N.measure),J.jsx(fg,{title:"Delete",children:J.jsxs(ta,{onClick:()=>M(O),children:[" ",J.jsx(qx,{})," "]})}),J.jsx(fg,{title:"Center Location",children:J.jsx(ta,{onClick:()=>{o?.map?.map.setCenter(N.geojson.geometry.type==="Point"?N.geojson.geometry.coordinates:oN(N.geojson).geometry.coordinates)},children:J.jsx(lN,{})})})]},N.measure+"-"+O)})]},N.measure)})),a&&J.jsx(Dc,{mapId:t.mapId,geojson:{type:"FeatureCollection",features:[a]},layerId:"highlightBorder",defaultPaintOverrides:{circle:{"circle-color":"#dd9900","circle-opacity":.4,"circle-radius":10},line:{"line-color":"#dd9900","line-opacity":.4,"line-width":10},fill:{"fill-color":"#dd9900","fill-opacity":.4}}})]})]})})};try{hq.displayName="MlMultiMeasureTool",hq.__docgenInfo={description:"",displayName:"MlMultiMeasureTool",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},buttonStyleOverride:{defaultValue:null,description:`Style attribute for the button-style
https://mui.com/system/getting-started/the-sx-prop/`,name:"buttonStyleOverride",required:!1,type:{name:"SxProps | undefined"}},measureType:{defaultValue:null,description:'String that specify if the Tool measures an area ("polygon") or length ("line")',name:"measureType",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"line"'},{value:'"polygon"'}]}},multiType:{defaultValue:null,description:"Boolean which decides if the user can switch between measure modes",name:"multiType",required:!1,type:{name:"boolean | undefined"}},unit:{defaultValue:null,description:"String that dictates which unit of measurement is used",name:"unit",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"meters"'},{value:'"metres"'},{value:'"millimeters"'},{value:'"millimetres"'},{value:'"centimeters"'},{value:'"centimetres"'},{value:'"kilometers"'},{value:'"kilometres"'},{value:'"miles"'},{value:'"nauticalmiles"'},{value:'"inches"'},{value:'"yards"'},{value:'"feet"'},{value:'"radians"'},{value:'"degrees"'}]}},onChange:{defaultValue:null,description:`Callback function that is called each time measurment geometry within has changed within MlMeasureTool.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((options: { value: number; unit?: string | undefined; geojson: Feature<Geometry, GeoJsonProperties>; geometries?: [] | undefined; }) => void) | undefined"}},onFinish:{defaultValue:null,description:"Callback function that is called by the end of drawing geometries.",name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}const pke=Ji(J.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),gke=Ji(J.jsx("path",{d:"M19 13H5v-2h14z"})),rM=({className:t="",title:e,onClick:r,style:n})=>J.jsxs("svg",{width:"52",height:"53",viewBox:"0 0 52 53",fill:"none",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,children:[e&&J.jsx("title",{children:e}),J.jsx("circle",{cx:"26.0001",cy:"26.1843",r:"24",fill:"white",stroke:"#009EE0",strokeWidth:"2"}),J.jsx("path",{d:"M26.4915 7.59161C26.3524 8.07338 25.6698 8.07338 25.5307 7.59161L24.2998 3.3276C24.2075 3.0079 24.4474 2.68893 24.7802 2.68893H27.242C27.5748 2.68893 27.8147 3.0079 27.7224 3.3276L26.4915 7.59161Z",fill:"#009EE0"}),J.jsx("path",{d:"M25.5085 44.7598C25.6476 44.278 26.3302 44.278 26.4693 44.7598L27.7002 49.0238C27.7925 49.3435 27.5526 49.6625 27.2198 49.6625H24.758C24.4252 49.6625 24.1853 49.3435 24.2776 49.0238L25.5085 44.7598Z",fill:"#009EE0"}),J.jsx("path",{d:"M44.6641 26.4915C44.1823 26.3524 44.1823 25.6698 44.6641 25.5307L48.9281 24.2998C49.2478 24.2075 49.5668 24.4474 49.5668 24.7802V27.242C49.5668 27.5747 49.2478 27.8147 48.9281 27.7224L44.6641 26.4915Z",fill:"#009EE0"}),J.jsx("path",{d:"M7.3959 25.6085C7.87766 25.7476 7.87766 26.4302 7.3959 26.5693L3.13189 27.8002C2.81218 27.8925 2.49321 27.6526 2.49321 27.3198L2.49321 24.858C2.49321 24.5253 2.81218 24.2853 3.13189 24.3776L7.3959 25.6085Z",fill:"#009EE0"})]});try{rM.displayName="CompassBackground",rM.__docgenInfo={description:"",displayName:"CompassBackground",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const nM=({className:t="",title:e,onClick:r,style:n})=>J.jsxs("svg",{width:"10",height:"40",viewBox:"0 0 10 40",fill:"none",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,children:[e&&J.jsx("title",{children:e}),J.jsxs("g",{transform:"translate(0.67544,-1.25e-5)",children:[J.jsx("path",{d:"m 3.34715,4.52028 c 0.22737,-1.05154 1.72745,-1.05154 1.95482,0 L 8.64912,20 H 0 Z",fill:"#cf003d"}),J.jsx("path",{d:"m 3.34715,35.4797 c 0.22737,1.0516 1.72745,1.0516 1.95482,0 L 8.64912,20 H 0 Z",fill:"#d3dcf0"})]})]});try{nM.displayName="CompassNeedle",nM.__docgenInfo={description:"",displayName:"CompassNeedle",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const mke=Dr(Bo)(({theme:t})=>({zIndex:1e3,cursor:"pointer",transform:"scale(1)",[t.breakpoints.down("md")]:{transform:"scale(1.6)"}})),yke=Dr(Bo)(({theme:t})=>({position:"absolute",right:"-10px",top:"-52px",width:"52px",height:"52px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",[t.breakpoints.down("md")]:{right:"0px",top:"-52px"},circle:{fill:t.palette.compass.compColor,stroke:t.palette.compass.compStroke},path:{fill:t.palette.compass.compStroke},"&:hover circle":{fill:t.palette.compass.compHover}})),vke=Dr(Bo)(({theme:t})=>({display:"flex",flexDirection:"row","path:nth-of-type(2)":{fill:t.palette.compass.compSouth},"path:nth-of-type(1)":{fill:t.palette.compass.compNorth}})),iM=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(0),i=()=>{e.map?.map?.getBearing&&n(Math.round(e.map.map.getBearing()))};te.useEffect(()=>{if(e.map)return e.map.on("rotate",i,e.componentId),i(),()=>{e.map?.map.off("rotate",i)}},[e.map,t.mapId]);const a=()=>{r==0?e.map?.map.setBearing(-90):r==-90?e.map?.map.setBearing(180):r==180?e.map?.map.setBearing(90):e.map?.map.setBearing(0)};return J.jsx(J.Fragment,{children:J.jsx(mke,{sx:{...t.style},children:J.jsxs(yke,{onClick:a,sx:{...t.backgroundStyle},children:[J.jsx(rM,{style:{position:"absolute",top:0,left:0}}),J.jsx(vke,{onClick:a,sx:{...t.needleStyle},children:J.jsx(nM,{style:{transform:"rotate("+(r>0?"-"+r:-1*r)+"deg)"}})})]})})})};try{iM.displayName="MlNavigationCompass",iM.__docgenInfo={description:`Navigation component that displays a compass component which indicates the current orientation of the map it is registered for and offers controls to turn the bearing 90 left/right or reset north to point up.

All style props are applied using`,displayName:"MlNavigationCompass",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapHook",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"Style object to adjust css definitions of the component.",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},backgroundStyle:{defaultValue:null,description:"Style object to adjust css definitions of the background.",name:"backgroundStyle",required:!1,type:{name:"CSSProperties | undefined"}},needleStyle:{defaultValue:null,description:"Style object to adjust css definitions of the compass needle.",name:"needleStyle",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const _ke=Ji(J.jsx("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M15 19l-6-2.11V5l6 2.11z"})),bke=Ji(J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),xke=Dr(ta)(({theme:t})=>({zIndex:1e3,color:t.palette.navigation.buttonColor,transform:"scale(1)"})),aM=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(t.mode||"mercator");te.useEffect(()=>{e.map?.map.getProjection?.()?.type!==r&&e.map?.setProjection({type:r})},[e.map]);const i=()=>{if(!e.map)return;const a=r==="globe"?"mercator":"globe";e.map.setProjection({type:a}),n(a)};return J.jsx(J.Fragment,{children:J.jsx(xke,{variant:"navtools",onClick:i,style:t.style,children:r==="globe"?J.jsx(bke,{"data-testid":"PublicIcon",sx:{fontSize:{xs:"1.4em",md:"1em"}}}):J.jsx(_ke,{"data-testid":"MapIcon",sx:{fontSize:{xs:"1.4em",md:"1em"}}})})})};try{aM.displayName="MlGlobeButton",aM.__docgenInfo={description:"",displayName:"MlGlobeButton",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"Style object to adjust css definitions of the component.",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},mode:{defaultValue:null,description:"Initial projection mode of the map.",name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"globe"'},{value:'"mercator"'}]}}}}}catch{}const oM=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(0),i=Ox(h=>h.breakpoints.down("md")),a=Lc();te.useEffect(()=>{e.map&&(e.map.on("pitchend",()=>{e.map&&n(e.map.getPitch())},e.componentId),n(e.map.getPitch()))},[e.map,t.mapId]);const s=te.useCallback(()=>{e.map&&e.map.easeTo({zoom:e.map.getZoom()+.5})},[e.map]),o=te.useCallback(()=>{e.map&&e.map.easeTo({zoom:e.map.getZoom()-.5})},[e.map]),c=te.useCallback(()=>{if(!e.map)return;n(e.map.getPitch());const h=e.map.getPitch()!==0?0:60;e.map.easeTo({pitch:h})},[e.map]);return J.jsxs(Bo,{sx:{zIndex:501,position:"absolute",display:"flex",flexDirection:"column",right:i?"15px":"25px",bottom:i?"20px":"40px",...i?{margin:"80px 10px 50px 10px"}:{marginTop:"50px"},...t.sx},children:[J.jsx(iM,{}),t.show3DButton&&J.jsx(ta,{variant:"navtools",onClick:c,sx:{color:h=>h.palette.navigation.buttonColor},children:r<29?"2D":"3D"}),t.showGlobeButton&&J.jsx(aM,{}),t.showFollowGpsButton&&J.jsx(BR,{}),t.showCenterLocationButton&&J.jsx(qk,{}),J.jsx(jk,{orientation:"vertical",sx:{border:"none",Button:{minWidth:"20px !important",color:a.palette.navigation.buttonColor},"Button:hover":{border:"none"}},children:t.showZoomButtons&&J.jsxs(J.Fragment,{children:[J.jsx(ta,{variant:"navtools",onClick:s,sx:{borderBottomLeftRadius:0,borderBottomRightRadius:0,position:"relative"},children:J.jsx(pke,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})}),J.jsx(uh,{sx:{backgroundColor:"#fff"},children:J.jsx(Uk,{sx:{marginLeft:"6px",marginRight:"6px"}})}),J.jsx(ta,{variant:"navtools",onClick:o,sx:{margin:0,borderTopLeftRadius:0,borderTopRightRadius:0},children:J.jsx(gke,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})]})}),t.children&&gt.cloneElement(t.children,{})]})};try{oM.displayName="MlNavigationTools",oM.__docgenInfo={description:"",displayName:"MlNavigationTools",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},show3DButton:{defaultValue:null,description:"Show 3D button",name:"show3DButton",required:!1,type:{name:"boolean | undefined"}},showGlobeButton:{defaultValue:null,description:"Show global button",name:"showGlobeButton",required:!1,type:{name:"boolean | undefined"}},showZoomButtons:{defaultValue:null,description:"Show zoom button",name:"showZoomButtons",required:!1,type:{name:"boolean | undefined"}},showFollowGpsButton:{defaultValue:null,description:"Show follow GPS button",name:"showFollowGpsButton",required:!1,type:{name:"boolean | undefined"}},showCenterLocationButton:{defaultValue:null,description:"Show center on current position button",name:"showCenterLocationButton",required:!1,type:{name:"boolean | undefined"}},children:{defaultValue:null,description:"Additional JSX Elements to be rendered below MlNavigationTools buttons",name:"children",required:!1,type:{name:"Element | undefined"}},sx:{defaultValue:null,description:"Style attribute for NavigationTools container",name:"sx",required:!1,type:{name:"SxProps | undefined"}},mediaIsMobile:{defaultValue:null,description:"Style attribute for NavigationTools container",name:"mediaIsMobile",required:!1,type:{name:"boolean | undefined"}}}}}catch{}const NE=t=>(Tp({idPrefix:"MlLayer-",layerId:t.layerId,mapId:t.mapId,geojson:t.geojson||void 0,options:{type:"background",paint:{...t?.options?.type&&t.options.type!=="background"?{}:{"background-color":"rgba(0,0,0,0)"}},...t.options},insertBeforeLayer:t.insertBeforeLayer}),J.jsx(J.Fragment,{}));try{NE.displayName="MlLayer",NE.__docgenInfo={description:"Basic layer component that create a layer in a MapLibre-gl instance and keeps it updated according to it attribute configuration.",displayName:"MlLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component to the maplibre-gl instance",name:"layerId",required:!1,type:{name:"string | undefined"}},options:{defaultValue:null,description:"Javascript object that is passed the addLayer command as first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}}}}}catch{}const fq=t=>{const e=te.useRef(0),r=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[n,i]=te.useState(0),[a,s]=te.useState(""),o=te.useCallback(()=>{if(!r.map||r.map?.map.getZoom()===e.current)return;e.current=r.map?.map.getZoom();const m=t.maxWidth||100,b=r.map.map._container.clientHeight/2,x=r.map.map.unproject([0,b]),E=r.map.map.unproject([m,b]),T=x.distanceTo(E);if(t.unit==="imperial"){const A=3.2808*T;if(A>5280){const M=A/5280;c(m,M,r.map.map._getUIString("ScaleControl.Miles"))}else c(m,A,r.map.map._getUIString("ScaleControl.Feet"))}else if(t.unit==="nautical"){const A=T/1852;c(m,A,r.map.map._getUIString("ScaleControl.NauticalMiles"))}else T>=1e3?c(m,T/1e3,r.map.map._getUIString("ScaleControl.Kilometers")):c(m,T,r.map.map._getUIString("ScaleControl.Meters"))},[r.map,t.unit,t.maxWidth]);te.useEffect(()=>{if(!r.map)return;const m=o;return r.map.on("move",m,r.componentId),o(),()=>{r.map?.map.off("move",m)}},[r.map,o]);const c=(m,b,x)=>{const E=d(b),T=E/b;i(m*T),s(E+"&nbsp;"+x)},h=m=>{const b=Math.pow(10,Math.ceil(-Math.log(m)/Math.LN10));return Math.round(m*b)/b},d=m=>{const b=Math.pow(10,`${Math.floor(m)}`.length-1);let x=m/b;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:x>=1?1:h(x),b*x};return J.jsx(J.Fragment,{children:J.jsx("div",{style:{backgroundColor:"hsla(0,0%,100%,.75)",fontSize:"10px",border:"2px solid #333",borderTop:"#333",padding:"0 5px",color:"#333",boxSizing:"border-box",width:n+"px",fontFamily:"sans-serif"},dangerouslySetInnerHTML:{__html:a}})})};try{fq.displayName="MlScaleReference",fq.__docgenInfo={description:"",displayName:"MlScaleReference",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"number | undefined"}},unit:{defaultValue:null,description:"",name:"unit",required:!1,type:{name:"string | undefined"}}}}}catch{}var uP,dq;function wke(){if(dq)return uP;dq=1;function t(r,n){var i=r.getCenter(),a=r.getZoom(),s=r.getBearing(),o=r.getPitch();n.forEach(function(c){c.jumpTo({center:i,zoom:a,bearing:s,pitch:o})})}function e(){var r,n=arguments.length;if(n===1)r=arguments[0];else{r=[];for(var i=0;i<n;i++)r.push(arguments[i])}var a=[];r.forEach(function(h,d){a[d]=c.bind(null,h,r.filter(function(m,b){return b!==d}))});function s(){r.forEach(function(h,d){h.on("move",a[d])})}function o(){r.forEach(function(h,d){h.off("move",a[d])})}function c(h,d){o(),t(h,d),s()}return s(),function(){o(),a=[],r=[]}}return uP=e,uP}var Ske=wke();const JQ=Id(Ske),pq=t=>{const e=te.useContext(Ng),r=te.useRef(!1),n=te.useRef(()=>{}),[i,a]=te.useState(50),s=te.useRef(50),[o,c]=te.useState(50),h=te.useRef(50),d=te.useMemo(()=>t.magnifierRadius||200,[t.magnifierRadius]),m=te.useCallback(()=>!(!t.map1Id||!t.map2Id||!e.getMap(t.map1Id)||!e.getMap(t.map2Id)),[t,e]),b=te.useRef(()=>{m()&&E({clientX:s.current,clientY:h.current})});te.useEffect(()=>{window.addEventListener("resize",b.current);const N=b.current;return()=>{window.removeEventListener("resize",N),n.current()}},[]);const x=te.useCallback(N=>{if(!m())return;const O=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let U=typeof N.touches<"u"&&typeof N.touches[0]<"u"?N.touches[0].clientX:0,j=typeof N.touches<"u"&&typeof N.touches[0]<"u"?N.touches[0].clientY:0;U-=O.x,j-=O.y;const H=parseFloat((U/O.width*100).toFixed(2)),G=parseFloat((j/O.height*100).toFixed(2));(s.current!==H||h.current!==G)&&(a(H),s.current=H,c(G),h.current=G,e.maps[t.map2Id].getContainer().style.clipPath=`circle(${d}px at `+s.current*O.width/100+"px "+h.current*O.height/100+"px)")},[e,m,t,d]),E=te.useCallback(N=>{if(!m())return;const O=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let U=N.clientX,j=N.clientY;U-=O.x,j-=O.y;const H=parseFloat((U/O.width*100).toFixed(2)),G=parseFloat((j/O.height*100).toFixed(2));(s.current!==H||h.current!==G)&&(a(H),s.current=H,c(G),h.current=G,e.maps[t.map2Id].getContainer().style.clipPath=`circle(${d}px at `+s.current*O.width/100+"px "+h.current*O.height/100+"px)")},[e,m,t,d]);te.useEffect(()=>{!m()||r.current||(r.current=!0,n.current=JQ(e.getMap(t.map1Id).map,e.getMap(t.map2Id).map),E({clientX:s.current,clientY:h.current}),E({clientX:e.maps[t.map1Id].getCanvas().clientWidth/2,clientY:e.maps[t.map1Id].getCanvas().clientHeight/2}))},[e.mapIds,e,m,t,E]);const T=N=>{N.nativeEvent instanceof TouchEvent?(document.addEventListener("touchmove",x),document.addEventListener("touchend",A)):(document.addEventListener("mousemove",E),document.addEventListener("mouseup",M))},A=()=>{document.removeEventListener("touchmove",x),document.removeEventListener("touchend",A)},M=()=>{document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",M)},F=N=>{const O=new WheelEvent(N.type,N);e.map?.map.getCanvas().dispatchEvent(O)};return J.jsx("div",{style:{position:"absolute",left:i+"%",top:o+"%",borderRadius:"50%",width:d*2-2+"px",height:d*2-2+"px",background:"rgba(0,0,0,0)",border:"2px solid #fafafa",boxShadow:"1px 2px 2px rgba(19, 19, 19, .5), inset 1px 1px 1px rgba(19, 19, 19, .2)",cursor:"pointer",zIndex:"110",marginLeft:d*-1-1+"px",marginTop:d*-1-1+"px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none",...t.magnifierStyle},onTouchStart:T,onMouseDown:T,onWheel:F})};try{pq.displayName="MlLayerMagnify",pq.__docgenInfo={description:`
Hides the MapLibreMap referenced by props.map2Id except for the "magnifier"-circle that reveals
the map and can be dragged around on top of the MapLibreMap referenced by props.map1Id`,displayName:"MlLayerMagnify",props:{map1Id:{defaultValue:null,description:"Id of the first MapLibre instance",name:"map1Id",required:!0,type:{name:"string"}},map2Id:{defaultValue:null,description:"Id of the second MapLibre instance",name:"map2Id",required:!0,type:{name:"string"}},magnifierRadius:{defaultValue:null,description:'Size of the "magnifier"-circle',name:"magnifierRadius",required:!1,type:{name:"number | undefined"}},magnifierStyle:{defaultValue:null,description:"object (React.CSSProperties) that is added to the magnifier default style",name:"magnifierStyle",required:!0,type:{name:"CSSProperties | undefined"}}}}}catch{}const sM=({className:t="",title:e,onClick:r,style:n,color:i})=>J.jsxs("svg",{viewBox:"0 0 47 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,color:i,children:[J.jsx("path",{d:"M29.5 21.25L35.75 15L29.5 8.75V21.25Z",fill:"#009EE0"}),J.jsx("path",{d:"M17.5 8.75L11.25 15L17.5 21.25V8.75Z",fill:"#009EE0"})]});try{sM.displayName="SwipeIcon",sM.__docgenInfo={description:"",displayName:"SwipeIcon",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},color:{defaultValue:null,description:"",name:"color",required:!1,type:{name:"string | undefined"}}}}}catch{}const gq=t=>{const e=te.useContext(Ng),r=te.useRef(!1),[n,i]=te.useState(50),a=te.useRef(0),s=te.useRef(()=>{}),o=te.useCallback(()=>!(!t.map1Id||!t.map2Id||!e.getMap(t.map1Id)||!e.getMap(t.map2Id)),[e,t.map1Id,t.map2Id]),c=()=>{s.current()},h=te.useCallback(T=>{if(!o())return;const A=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let M=typeof T.touches<"u"&&typeof T.touches[0]<"u"?T.touches[0].clientX:0;M-=A.x;const F=parseFloat((M/A.width*100).toFixed(2));if(a.current!==F){i(F),a.current=F;const N="rect(0, "+a.current*A.width/100+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=N}},[e,o,t.map1Id,t.map2Id]),d=te.useCallback(T=>{if(!o())return;const A=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let M=T.clientX;M-=A.x;const F=parseFloat((M/A.width*100).toFixed(2));if(a.current!==F){i(F),a.current=F;const N="rect(0, "+a.current*A.width/100+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=N}},[e,o,t.map1Id,t.map2Id]);te.useEffect(()=>c,[]),te.useEffect(()=>{!o()||r.current||(r.current=!0,s.current=JQ(e.getMap(t.map1Id).map,e.getMap(t.map2Id).map),d({clientX:e.maps[t.map1Id].getCanvas().clientWidth/2}))},[e.mapIds,e,t,d,o]);const m=T=>{window?.TouchEvent&&T.nativeEvent instanceof window.TouchEvent?(document.addEventListener("touchmove",h),document.addEventListener("touchend",b)):(document.addEventListener("mousemove",d),document.addEventListener("mouseup",x))},b=()=>{document.removeEventListener("touchmove",h),document.removeEventListener("touchend",b)},x=()=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",x)};function E(){const T=parseFloat(e.maps[t.map2Id].getContainer().style.clip.split(",")[1].replace("px","")),A=e.maps[t.map1Id].getCanvas().getBoundingClientRect().width;if(T<A){const M=parseFloat((T/A*100).toFixed(2));i(M)}else{const M="rect(0, "+A/2+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=M,i(50)}}return te.useEffect(()=>(window.addEventListener("resize",E),()=>{window.removeEventListener("resize",E)}),[e]),J.jsx("div",{style:{position:"absolute",left:n+"%",top:"50%",borderRadius:"50%",width:"65px",height:"65px",background:"rgba(234, 235, 241, 0.75)",border:"2px solid rgba(0, 158, 224, 0.75)",cursor:"pointer",zIndex:"110",marginLeft:"-35px",marginTop:"-50px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none",...t.buttonStyle},onTouchStart:m,onMouseDown:m,children:J.jsx(sM,{color:"#0066ff",style:{width:"65px",height:"65px",justifyContent:"center",zIndex:1100}})})};try{gq.displayName="MlLayerSwipe",gq.__docgenInfo={description:"creates a split view of 2 synchronised maplibre instances",displayName:"MlLayerSwipe",props:{map1Id:{defaultValue:null,description:"Id of the first MapLibre instance.",name:"map1Id",required:!0,type:{name:"string"}},map2Id:{defaultValue:null,description:"Id of the second MapLibre instance.",name:"map2Id",required:!0,type:{name:"string"}},buttonStyle:{defaultValue:null,description:"object (React.CSSProperties) that is added to the button default style",name:"buttonStyle",required:!0,type:{name:"CSSProperties | undefined"}}}}}catch{}const QQ=function(t,e,r,n,i,a,s,o,c){if(typeof n.current[a.current]<"u"){const h=a.current+1===n.current.length?t.geojson:Su([...i.current,...n.current[a.current].geometry.coordinates]);c(h),typeof t.onTransitionFrame=="function"&&t.onTransitionFrame(h),a.current++,r.current&&a.current<n.current.length?o.current=setTimeout(()=>QQ(...arguments),s):(typeof t.onTransitionEnd=="function"&&t.onTransitionEnd(t.geojson),r.current=!1)}},Eke=(t,e,r,n,i,a,s,o,c,h)=>{const d=[],m=[];let b=[],x=[];e.current=[];const E=i.current||{geometry:{type:"LineString",coordinates:[]},properties:{},type:"Feature"},T=t.geojson;let A=T,M=E,F=!1;if(typeof A.geometry>"u"&&typeof M.geometry<"u"&&M.geometry.coordinates.length>1)A=Su(M.geometry.coordinates.slice(0,2));else if(typeof M.geometry>"u"&&typeof A.geometry<"u"&&A.geometry.coordinates.length>1)M=Su(A.geometry.coordinates.slice(0,2));else if(typeof M.geometry>"u"&&typeof A.geometry>"u")return;if(A.geometry.coordinates.length<M.geometry.coordinates.length&&(A=E,M=T,F=!0),A&&M)for(let se=0,he=A.geometry.coordinates.length;se<he;se++)typeof M.geometry.coordinates[se]<"u"&&A.geometry.coordinates[se][0]===M.geometry.coordinates[se][0]&&A.geometry.coordinates[se][1]===M.geometry.coordinates[se][1]?e.current.push(A.geometry.coordinates[se]):(typeof A.geometry.coordinates[se]<"u"&&m.push(A.geometry.coordinates[se]),typeof M.geometry.coordinates[se]<"u"&&d.push(M.geometry.coordinates[se]));if(F?(b=d,x=m):(b=m,x=d),b.length<2&&x<2)return;const N=t.transitionTime/a,O=x.length>1?Math.round(Jb(Su(x))):0,U=b.length>1?Math.round(Jb(Su(b))):0,j=U+O,H=O/j,G=Math.round(N*H),X=Math.round(O/G*100)/100,ae=U/j,Q=Math.round(N*ae),W=Math.round(U/Q*100)/100;let oe;oe=[...mq(x,X,G)],oe.reverse(),oe=[...oe,...mq(b,W,Q)],oe.push(T),r.current=oe,s.current=1,n.current=!0,c.current=setTimeout(()=>QQ(t,o,n,r,e,s,a,c,h),a)},mq=(t,e,r)=>{const n=[];if(t.length>1){const i=Wwe(Su(t),e);let a=i.features[0];for(let s=0;s<r&&(n.push(a),typeof i.features[s]<"u");s++)a=Su([...a.geometry.coordinates,...i.features[s].geometry.coordinates])}return n},Tke=50,yq=t=>{const{geojson:e,...r}=t,n=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),i=te.useRef(!1),a=te.useRef(null),s=te.useRef(!1),o=te.useRef(void 0),c=te.useRef(!1),h=te.useRef([]),d=te.useRef([]),[m,b]=te.useState(Ep([]));te.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]);const x=te.useCallback(()=>{Eke(t,d,h,s,a,Tke,c,n.map,o,b)},[t,n.map]);te.useEffect(()=>{!n.map||!i.current||(typeof t.transitionTime<"u"&&t.type==="line"&&a.current&&(s.current=!1,c.current=!1,h.current=[],d.current=[],x()),t.geojson&&(a.current=t.geojson))},[n.map,x,t]);const E=te.useCallback(()=>{t.type==="line"&&typeof t.transitionTime<"u"&&t.transitionTime&&typeof t.geojson<"u"&&JSON.stringify(a.current)!==JSON.stringify(t.geojson)&&(x(),a.current=t.geojson)},[t,x]);return te.useEffect(()=>{!n.mapIsReady||!t.geojson||(i.current=!0,E())},[n.mapIsReady,E,t]),J.jsx(J.Fragment,{children:J.jsx(Dc,{...r,geojson:m})})};try{yq.displayName="MlTransitionGeoJsonLayer",yq.__docgenInfo={description:'Adds source and layer of types "line", "fill" or "circle" to display GeoJSON data on the map.',displayName:"MlTransitionGeoJsonLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.
This layer will not be added to the maplibre-gl instance until a layer with an
id that matches the value of insertBeforeLayer is created.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the new layer and source that are added to the MapLibre instance",name:"layerId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}},type:{defaultValue:null,description:`Type of the layer that will be added to the MapLibre instance.
All types from LayerSpecification union type are supported except the type from
RasterLayerSpecification`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"symbol"'},{value:'"fill"'},{value:'"background"'},{value:'"circle"'},{value:'"line"'},{value:'"heatmap"'},{value:'"fill-extrusion"'},{value:'"hillshade"'},{value:'"color-relief"'}]}},paint:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.paint property instead. This will be removed in the next major release.
Paint property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All paint types from LayerSpecification union type are supported except the paint type from
RasterLayerSpecification`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | ... 8 more ... | undefined'}},layout:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.layout property instead. This will be removed in the next major release.
Layout property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All layout types from LayerSpecification union type are supported except the layout type from
RasterLayerSpecification`,name:"layout",required:!1,type:{name:'{ "symbol-placement"?: PropertyValueSpecification<"line" | "point" | "line-center"> | undefined; "symbol-spacing"?: PropertyValueSpecification<number> | undefined; ... 42 more ...; visibility?: VisibilitySpecification | undefined; } | ... 9 more ... | undefined'}},options:{defaultValue:null,description:"Javascript object that is spread into the addLayer commands first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},defaultPaintOverrides:{defaultValue:null,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.',name:"defaultPaintOverrides",required:!1,type:{name:'{ circle?: { "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | undefined; fill?: { ...; } | undefined; line?: { ...; } | undefined...'}},labelProp:{defaultValue:null,description:"Property name in the GeoJSON object to be used as a label.",name:"labelProp",required:!1,type:{name:"string | undefined"}},labelOptions:{defaultValue:null,description:"Label configuration options.",name:"labelOptions",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},onHover:{defaultValue:null,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},transitionTime:{defaultValue:null,description:"",name:"transitionTime",required:!1,type:{name:"number | undefined"}}}}}catch{}const Cke=12,vq=16,eee=4,Ake=16,Ike=Ake+eee,Pke=200,kke=750,Rke=500,Mke=(t="top")=>{switch(t){case"bottom":return"translate(-50%, 0%)";case"left":return"translate(-100%, -50%)";case"right":return"translate(0%, -50%)";case"top-left":return"translate(-100%, -100%)";case"top-right":return"translate(0%, -100%)";case"bottom-left":return"translate(-100%, 0%)";case"bottom-right":return"translate(0%, 0%)";default:case"top":return"translate(-50%, -100%)"}};function Dke(t,e,r){const n=parseInt(String(r?.width||14),10),i=parseInt(String(r?.height||14),10),a={};switch(t){case"bottom":a.marginTop=`${e}px`;break;case"left":a.marginLeft=`-${e}px`;break;case"right":a.marginLeft=`${n+e}px`;break;case"top-left":a.marginTop=`-${i+e}px`,a.marginLeft=`-${e}px`;break;case"top-right":a.marginTop=`-${i+e}px`,a.marginLeft=`${n+e}px`;break;case"bottom-left":a.marginTop=`${e}px`,a.marginLeft=`-${e}px`;break;case"bottom-right":a.marginTop=`${e}px`,a.marginLeft=`${n+e}px`;break;case"top":default:a.marginTop=`-${i+e}px`;break}return a}const lM=({passEventsThrough:t=!0,contentOffset:e=5,showCloseButton:r=!0,...n})=>{const i=va({mapId:n.mapId,waitForLayer:n.insertBeforeLayer}),[a,s]=te.useState(null),[o,c]=te.useState(300),h=te.useRef(null),d=te.useRef(null),m=x=>{x.stopPropagation(),n.onClose?n.onClose():(a?.remove(),h.current?.remove())};te.useEffect(()=>{if(!i.map)return;h.current=document.createElement("div");const E={...{width:"12px",height:"12px",background:"linear-gradient(135deg, rgb(186, 208, 218) 0%, rgb(96, 209, 253) 100%)",border:"1px solid rgba(255, 255, 255, 0.7)",boxShadow:"0 2px 6px rgba(90, 0, 0, 0.2), 0 0 0 2px rgba(240, 147, 251, 0.2)",borderRadius:"50%"},...n.markerStyle},T=new mk.Marker({element:h.current,anchor:"center"}).setLngLat([n.lng,n.lat]).addTo(i.map.map);s(T);const A=document.createElement("div");return Object.entries(E).forEach(([M,F])=>{A.style.setProperty(M.replace(/([A-Z])/g,"-$1").toLowerCase(),String(F))}),h.current.appendChild(A),()=>{A.remove(),T.remove(),h.current?.remove()}},[i.map,n.lng,n.lat,n.markerStyle,n.anchor]),te.useEffect(()=>{a&&a.setLngLat([n.lng,n.lat])},[a,n.lng,n.lat]);function b(){const x=d.current?.contentWindow?.document;if(x&&d.current){const E=x.documentElement.scrollHeight,T=x.documentElement.scrollWidth;d.current.style.height=`${E}px`;const A=Math.max(Pke,Math.min(T+vq*2,kke));c(A)}}return h.current&&hp.createPortal(J.jsx(Bo,{sx:{position:"absolute",transform:Mke(n.anchor),...Dke(n.anchor,e,n.markerStyle),zIndex:-1,...n.containerStyle},children:J.jsxs(uh,{elevation:8,sx:{width:`${o}px`,maxWidth:"90vw",opacity:t?1:.85,pointerEvents:"auto",overflow:"hidden",position:"relative",transition:"opacity 0.2s ease-in-out, width 0.2s ease-in-out","&:hover":{opacity:1}},children:[r&&J.jsx(kc,{onClick:m,sx:{position:"absolute",top:eee,right:Ike,zIndex:1,padding:"4px",backgroundColor:"rgba(255, 255, 255, 0.9)","&:hover":{backgroundColor:"rgba(255, 255, 255, 1)"}},size:"small",children:J.jsx(KQ,{fontSize:"small"})}),J.jsx(Bo,{sx:{maxHeight:`${Rke}px`,overflowY:"auto",overflowX:"hidden"},children:J.jsx("iframe",{ref:d,onLoad:b,style:{width:"100%",border:"none",display:"block",...n.iframeStyle},srcDoc:`<div>
	<style>
		* {
			box-sizing: border-box;
		}
		body {
			margin: 0;
			padding: ${Cke}px ${vq}px;
			${r?"padding-top: 40px;":""}
			background: transparent;
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
			font-size: 14px;
			line-height: 1.6;
			color: rgba(0, 0, 0, 0.87);
			-webkit-font-smoothing: antialiased;
			-moz-osx-font-smoothing: grayscale;
			overflow-x: hidden;
			${Object.entries(n.iframeBodyStyle||{}).map(([x,E])=>`${x.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${E};`).join(" ")}
		}
		h1, h2, h3, h4, h5, h6 {
			margin: 0 0 8px 0;
			font-weight: 500;
		}
		p {
			margin: 0 0 8px 0;
		}
		table {
			border-collapse: collapse;
			width: 100%;
			max-width: 100%;
		}
		th, td {
			padding: 4px 8px;
			text-align: left;
			border-bottom: 1px solid rgba(0, 0, 0, 0.12);
			word-wrap: break-word;
		}
		th {
			font-weight: 500;
			color: rgba(0, 0, 0, 0.6);
		}
		img {
			max-width: 100%;
			height: auto;
		}
	</style>
	${n.content||""}
</div>`,sandbox:"allow-same-origin allow-popups-to-escape-sandbox allow-scripts",title:i.componentId})})]})}),h.current)};try{lM.displayName="MlMarker",lM.__docgenInfo={description:"",displayName:"MlMarker",props:{mapId:{defaultValue:null,description:"ID of the map to add the marker to",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"Layer ID before which to insert the marker",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},lng:{defaultValue:null,description:"Longitude of the marker position",name:"lng",required:!0,type:{name:"number"}},lat:{defaultValue:null,description:"Latitude of the marker position",name:"lat",required:!0,type:{name:"number"}},content:{defaultValue:null,description:"HTML content for the marker popup",name:"content",required:!1,type:{name:"string | undefined"}},markerStyle:{defaultValue:null,description:"CSS properties to apply to the marker dot",name:"markerStyle",required:!1,type:{name:"CSSProperties | undefined"}},containerStyle:{defaultValue:null,description:"CSS properties to apply to the content container",name:"containerStyle",required:!1,type:{name:"CSSProperties | undefined"}},iframeStyle:{defaultValue:null,description:"CSS properties to apply to the iframe element",name:"iframeStyle",required:!1,type:{name:"CSSProperties | undefined"}},iframeBodyStyle:{defaultValue:null,description:"CSS properties to apply to the body of the iframe",name:"iframeBodyStyle",required:!1,type:{name:"CSSProperties | undefined"}},contentOffset:{defaultValue:{value:"5"},description:"Offset in pixels between the marker and its content",name:"contentOffset",required:!1,type:{name:"number | undefined"}},passEventsThrough:{defaultValue:{value:"true"},description:"Whether mouse events pass through the marker content",name:"passEventsThrough",required:!1,type:{name:"boolean | undefined"}},showCloseButton:{defaultValue:{value:"true"},description:"Whether to show a close button to remove the marker",name:"showCloseButton",required:!1,type:{name:"boolean | undefined"}},onClose:{defaultValue:null,description:"Callback function when the close button is clicked",name:"onClose",required:!1,type:{name:"(() => void) | undefined"}},anchor:{defaultValue:null,description:"Anchor position of the marker relative to its coordinates",name:"anchor",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"bottom"'},{value:'"left"'},{value:'"right"'},{value:'"top"'},{value:'"top-left"'},{value:'"top-right"'},{value:'"bottom-left"'},{value:'"bottom-right"'}]}}}}}catch{}var ma={},tu={},_q;function C_(){if(_q)return tu;_q=1;function t(M,F,N){if(N===void 0&&(N=Array.prototype),M&&typeof N.find=="function")return N.find.call(M,F);for(var O=0;O<M.length;O++)if(r(M,O)){var U=M[O];if(F.call(void 0,U,O,M))return U}}function e(M,F){return F===void 0&&(F=Object),F&&typeof F.getOwnPropertyDescriptors=="function"&&(M=F.create(null,F.getOwnPropertyDescriptors(M))),F&&typeof F.freeze=="function"?F.freeze(M):M}function r(M,F){return Object.prototype.hasOwnProperty.call(M,F)}function n(M,F){if(M===null||typeof M!="object")throw new TypeError("target is not an object");for(var N in F)r(F,N)&&(M[N]=F[N]);return M}var i=e({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0});function a(M){return r(i,M.toLowerCase())}var s=e({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function o(M){return r(s,M.toLowerCase())}var c=e({script:!1,style:!1,textarea:!0,title:!0});function h(M){var F=M.toLowerCase();return r(c,F)&&!c[F]}function d(M){var F=M.toLowerCase();return r(c,F)&&c[F]}function m(M){return M===x.HTML}function b(M){return m(M)||M===x.XML_XHTML_APPLICATION}var x=e({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),E=Object.keys(x).map(function(M){return x[M]});function T(M){return E.indexOf(M)>-1}var A=e({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return tu.assign=n,tu.find=t,tu.freeze=e,tu.HTML_BOOLEAN_ATTRIBUTES=i,tu.HTML_RAW_TEXT_ELEMENTS=c,tu.HTML_VOID_ELEMENTS=s,tu.hasDefaultHTMLNamespace=b,tu.hasOwn=r,tu.isHTMLBooleanAttribute=a,tu.isHTMLRawTextElement=h,tu.isHTMLEscapableRawTextElement=d,tu.isHTMLMimeType=m,tu.isHTMLVoidElement=o,tu.isValidMimeType=T,tu.MIME_TYPE=x,tu.NAMESPACE=A,tu}var Ev={},bq;function D3(){if(bq)return Ev;bq=1;var t=C_();function e(b,x){b.prototype=Object.create(Error.prototype,{constructor:{value:b},name:{value:b.name,enumerable:!0,writable:x}})}var r=t.freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),n=Object.keys(r);function i(b){return typeof b=="number"&&b>=1&&b<=25}function a(b){return typeof b=="string"&&b.substring(b.length-r.Error.length)===r.Error}function s(b,x){i(b)?(this.name=n[b],this.message=x||""):(this.message=b,this.name=a(x)?x:r.Error),Error.captureStackTrace&&Error.captureStackTrace(this,s)}e(s,!0),Object.defineProperties(s.prototype,{code:{enumerable:!0,get:function(){var b=n.indexOf(this.name);return i(b)?b:0}}});for(var o={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},c=Object.entries(o),h=0;h<c.length;h++){var d=c[h][0];s[d]=c[h][1]}function m(b,x){this.message=b,this.locator=x,Error.captureStackTrace&&Error.captureStackTrace(this,m)}return e(m),Ev.DOMException=s,Ev.DOMExceptionName=r,Ev.ExceptionCode=o,Ev.ParseError=m,Ev}var Os={},Qi={},xq;function tee(){if(xq)return Qi;xq=1;function t(en){try{typeof en!="function"&&(en=RegExp);var jn=new en("","u").exec("");return!!jn&&jn[0].length===2}catch{}return!1}var e=t();function r(en){if(en.source[0]!=="[")throw new Error(en+" can not be used with chars");return en.source.slice(1,en.source.lastIndexOf("]"))}function n(en,jn){if(en.source[0]!=="[")throw new Error("/"+en.source+"/ can not be used with chars_without");if(!jn||typeof jn!="string")throw new Error(JSON.stringify(jn)+" is not a valid search");if(en.source.indexOf(jn)===-1)throw new Error('"'+jn+'" is not is /'+en.source+"/");if(jn==="-"&&en.source.indexOf(jn)!==1)throw new Error('"'+jn+'" is not at the first postion of /'+en.source+"/");return new RegExp(en.source.replace(jn,""),e?"u":"")}function i(en){var jn=this;return new RegExp(Array.prototype.slice.call(arguments).map(function(Qr){var nr=typeof Qr=="string";if(nr&&jn===void 0&&Qr==="|")throw new Error("use regg instead of reg to wrap expressions with `|`!");return nr?Qr:Qr.source}).join(""),e?"mu":"m")}function a(en){if(arguments.length===0)throw new Error("no parameters provided");return i.apply(a,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var s="",o=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;e&&(o=i("[",r(o),"\\u{10000}-\\u{10FFFF}","]"));var c=/[\x20\x09\x0D\x0A]/,h=r(c),d=i(c,"+"),m=i(c,"*"),b=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;e&&(b=i("[",r(b),"\\u{10000}-\\u{10FFFF}","]"));var x=r(b),E=i("[",x,r(/[-.0-9\xB7]/),r(/[\u0300-\u036F\u203F-\u2040]/),"]"),T=i(b,E,"*"),A=i(E,"+"),M=i("&",T,";"),F=a(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),N=a(M,"|",F),O=i("%",T,";"),U=a(i('"',a(/[^%&"]/,"|",O,"|",N),"*",'"'),"|",i("'",a(/[^%&']/,"|",O,"|",N),"*","'")),j=a('"',a(/[^<&"]/,"|",N),"*",'"',"|","'",a(/[^<&']/,"|",N),"*","'"),H=n(b,":"),G=n(E,":"),X=i(H,G,"*"),ae=i(X,a(":",X),"?"),Q=i("^",ae,"$"),W=i("(",ae,")"),oe=a(/"[^"]*"|'[^']*'/),se=i(/^<\?/,"(",T,")",a(d,"(",o,"*?)"),"?",/\?>/),he=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,_e=a('"',he,'*"',"|","'",n(he,"'"),"*'"),Ce="<!--",me="-->",xe=i(Ce,a(n(o,"-"),"|",i("-",n(o,"-"))),"*",me),Ae="#PCDATA",De=a(i(/\(/,m,Ae,a(m,/\|/,m,ae),"*",m,/\)\*/),"|",i(/\(/,m,Ae,m,/\)/)),de=/[?*+]?/,Ee=i(/\([^>]+\)/,de),we=a("EMPTY","|","ANY","|",De,"|",Ee),Le="<!ELEMENT",Fe=i(Le,d,a(ae,"|",O),d,a(we,"|",O),m,">"),Xe=i("NOTATION",d,/\(/,m,T,a(m,/\|/,m,T),"*",m,/\)/),Be=i(/\(/,m,A,a(m,/\|/,m,A),"*",m,/\)/),ot=a(Xe,"|",Be),Qe=a(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",ot),rt=a(/#REQUIRED|#IMPLIED/,"|",a(a("#FIXED",d),"?",j)),Re=a(d,T,d,Qe,d,rt),zt="<!ATTLIST",st=i(zt,d,T,Re,"*",m,">"),$e="about:legacy-compat",Jt=a('"'+$e+'"',"|","'"+$e+"'"),Ht="SYSTEM",pr="PUBLIC",_t=a(a(Ht,d,oe),"|",a(pr,d,_e,d,oe)),vr=i("^",a(a(Ht,d,"(?<SystemLiteralOnly>",oe,")"),"|",a(pr,d,"(?<PubidLiteral>",_e,")",d,"(?<SystemLiteral>",oe,")"))),br=a(d,"NDATA",d,T),lr=a(U,"|",a(_t,br,"?")),Cr="<!ENTITY",Tr=i(Cr,d,T,d,lr,m,">"),Qt=a(U,"|",_t),at=i(Cr,d,"%",d,T,d,Qt,m,">"),ke=a(Tr,"|",at),be=i(pr,d,_e),je=i("<!NOTATION",d,T,d,a(_t,"|",be),m,">"),qe=i(m,"=",m),We=/1[.]\d+/,Lt=i(d,"version",qe,a("'",We,"'","|",'"',We,'"')),Et=/[A-Za-z][-A-Za-z0-9._]*/,mt=a(d,"encoding",qe,a('"',Et,'"',"|","'",Et,"'")),ct=a(d,"standalone",qe,a("'",a("yes","|","no"),"'","|",'"',a("yes","|","no"),'"')),Kt=i(/^<\?xml/,Lt,mt,"?",ct,"?",m,/\?>/),qt="<!DOCTYPE",Ir="<![CDATA[",Ar="]]>",$r=/<!\[CDATA\[/,hn=/\]\]>/,zr=i(o,"*?",hn),Mt=i($r,zr);return Qi.chars=r,Qi.chars_without=n,Qi.detectUnicodeSupport=t,Qi.reg=i,Qi.regg=a,Qi.ABOUT_LEGACY_COMPAT=$e,Qi.ABOUT_LEGACY_COMPAT_SystemLiteral=Jt,Qi.AttlistDecl=st,Qi.CDATA_START=Ir,Qi.CDATA_END=Ar,Qi.CDSect=Mt,Qi.Char=o,Qi.Comment=xe,Qi.COMMENT_START=Ce,Qi.COMMENT_END=me,Qi.DOCTYPE_DECL_START=qt,Qi.elementdecl=Fe,Qi.EntityDecl=ke,Qi.EntityValue=U,Qi.ExternalID=_t,Qi.ExternalID_match=vr,Qi.Name=T,Qi.NotationDecl=je,Qi.Reference=N,Qi.PEReference=O,Qi.PI=se,Qi.PUBLIC=pr,Qi.PubidLiteral=_e,Qi.QName=ae,Qi.QName_exact=Q,Qi.QName_group=W,Qi.S=d,Qi.SChar_s=h,Qi.S_OPT=m,Qi.SYSTEM=Ht,Qi.SystemLiteral=oe,Qi.UNICODE_REPLACEMENT_CHARACTER=s,Qi.UNICODE_SUPPORT=e,Qi.XMLDecl=Kt,Qi}var wq;function ree(){if(wq)return Os;wq=1;var t=C_(),e=t.find,r=t.hasDefaultHTMLNamespace,n=t.hasOwn,i=t.isHTMLMimeType,a=t.isHTMLRawTextElement,s=t.isHTMLVoidElement,o=t.MIME_TYPE,c=t.NAMESPACE,h=Symbol(),d=D3(),m=d.DOMException,b=d.DOMExceptionName,x=tee();function E(Me){if(Me!==h)throw new TypeError("Illegal constructor")}function T(Me){return Me!==""}function A(Me){return Me?Me.split(/[\t\n\f\r ]+/).filter(T):[]}function M(Me,He){return n(Me,He)||(Me[He]=!0),Me}function F(Me){if(!Me)return[];var He=A(Me);return Object.keys(He.reduce(M,{}))}function N(Me){return function(He){return Me&&Me.indexOf(He)!==-1}}function O(Me){if(!x.QName_exact.test(Me))throw new m(m.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+Me+'"')}function U(Me,He){O(He),Me=Me||null;var Tt=null,Wt=He;if(He.indexOf(":")>=0){var Ut=He.split(":");Tt=Ut[0],Wt=Ut[1]}if(Tt!==null&&Me===null)throw new m(m.NAMESPACE_ERR,"prefix is non-null and namespace is null");if(Tt==="xml"&&Me!==t.NAMESPACE.XML)throw new m(m.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if((Tt==="xmlns"||He==="xmlns")&&Me!==t.NAMESPACE.XMLNS)throw new m(m.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(Me===t.NAMESPACE.XMLNS&&Tt!=="xmlns"&&He!=="xmlns")throw new m(m.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[Me,Tt,Wt]}function j(Me,He){for(var Tt in Me)n(Me,Tt)&&(He[Tt]=Me[Tt])}function H(Me,He){var Tt=Me.prototype;if(!(Tt instanceof He)){let Wt=function(){};Wt.prototype=He.prototype,Wt=new Wt,j(Tt,Wt),Me.prototype=Tt=Wt}Tt.constructor!=Me&&(typeof Me!="function"&&console.error("unknown Class:"+Me),Tt.constructor=Me)}var G={},X=G.ELEMENT_NODE=1,ae=G.ATTRIBUTE_NODE=2,Q=G.TEXT_NODE=3,W=G.CDATA_SECTION_NODE=4,oe=G.ENTITY_REFERENCE_NODE=5,se=G.ENTITY_NODE=6,he=G.PROCESSING_INSTRUCTION_NODE=7,_e=G.COMMENT_NODE=8,Ce=G.DOCUMENT_NODE=9,me=G.DOCUMENT_TYPE_NODE=10,xe=G.DOCUMENT_FRAGMENT_NODE=11,Ae=G.NOTATION_NODE=12,De=t.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function de(Me,He){if(He.length<Me.length)return de(He,Me);var Tt=null;for(var Wt in Me){if(Me[Wt]!==He[Wt])return Tt;Tt=Me[Wt]}return Tt}function Ee(Me){return Me.guid||(Me.guid=Math.random()),Me.guid}function we(){}we.prototype={length:0,item:function(Me){return Me>=0&&Me<this.length?this[Me]:null},toString:function(Me){for(var He=[],Tt=0;Tt<this.length;Tt++)nr(this[Tt],He,Me);return He.join("")},filter:function(Me){return Array.prototype.filter.call(this,Me)},indexOf:function(Me){return Array.prototype.indexOf.call(this,Me)}},we.prototype[Symbol.iterator]=function(){var Me=this,He=0;return{next:function(){return He<Me.length?{value:Me[He++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function Le(Me,He){this._node=Me,this._refresh=He,Fe(this)}function Fe(Me){var He=Me._node._inc||Me._node.ownerDocument._inc;if(Me._inc!==He){var Tt=Me._refresh(Me._node);if(Kn(Me,"length",Tt.length),!Me.$$length||Tt.length<Me.$$length)for(var Wt=Tt.length;Wt in Me;Wt++)n(Me,Wt)&&delete Me[Wt];j(Tt,Me),Me._inc=He}}Le.prototype.item=function(Me){return Fe(this),this[Me]||null},H(Le,we);function Xe(){}function Be(Me,He){for(var Tt=0;Tt<Me.length;){if(Me[Tt]===He)return Tt;Tt++}}function ot(Me,He,Tt,Wt){if(Wt?He[Be(He,Wt)]=Tt:(He[He.length]=Tt,He.length++),Me){Tt.ownerElement=Me;var Ut=Me.ownerDocument;Ut&&(Wt&&Ht(Ut,Me,Wt),Jt(Ut,Me,Tt))}}function Qe(Me,He,Tt){var Wt=Be(He,Tt);if(Wt>=0){for(var Ut=He.length-1;Wt<=Ut;)He[Wt]=He[++Wt];if(He.length=Ut,Me){var Xr=Me.ownerDocument;Xr&&Ht(Xr,Me,Tt),Tt.ownerElement=null}}}Xe.prototype={length:0,item:we.prototype.item,getNamedItem:function(Me){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(Me=Me.toLowerCase());for(var He=0;He<this.length;){var Tt=this[He];if(Tt.nodeName===Me)return Tt;He++}return null},setNamedItem:function(Me){var He=Me.ownerElement;if(He&&He!==this._ownerElement)throw new m(m.INUSE_ATTRIBUTE_ERR);var Tt=this.getNamedItemNS(Me.namespaceURI,Me.localName);return Tt===Me?Me:(ot(this._ownerElement,this,Me,Tt),Tt)},setNamedItemNS:function(Me){return this.setNamedItem(Me)},removeNamedItem:function(Me){var He=this.getNamedItem(Me);if(!He)throw new m(m.NOT_FOUND_ERR,Me);return Qe(this._ownerElement,this,He),He},removeNamedItemNS:function(Me,He){var Tt=this.getNamedItemNS(Me,He);if(!Tt)throw new m(m.NOT_FOUND_ERR,Me?Me+" : "+He:He);return Qe(this._ownerElement,this,Tt),Tt},getNamedItemNS:function(Me,He){Me||(Me=null);for(var Tt=0;Tt<this.length;){var Wt=this[Tt];if(Wt.localName===He&&Wt.namespaceURI===Me)return Wt;Tt++}return null}},Xe.prototype[Symbol.iterator]=function(){var Me=this,He=0;return{next:function(){return He<Me.length?{value:Me[He++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function rt(){}rt.prototype={hasFeature:function(Me,He){return!0},createDocument:function(Me,He,Tt){var Wt=o.XML_APPLICATION;Me===c.HTML?Wt=o.XML_XHTML_APPLICATION:Me===c.SVG&&(Wt=o.XML_SVG_IMAGE);var Ut=new $e(h,{contentType:Wt});if(Ut.implementation=this,Ut.childNodes=new we,Ut.doctype=Tt||null,Tt&&Ut.appendChild(Tt),He){var Xr=Ut.createElementNS(Me,He);Ut.appendChild(Xr)}return Ut},createDocumentType:function(Me,He,Tt,Wt){O(Me);var Ut=new qt(h);return Ut.name=Me,Ut.nodeName=Me,Ut.publicId=He||"",Ut.systemId=Tt||"",Ut.internalSubset=Wt||"",Ut.childNodes=new we,Ut},createHTMLDocument:function(Me){var He=new $e(h,{contentType:o.HTML});if(He.implementation=this,He.childNodes=new we,Me!==!1){He.doctype=this.createDocumentType("html"),He.doctype.ownerDocument=He,He.appendChild(He.doctype);var Tt=He.createElement("html");He.appendChild(Tt);var Wt=He.createElement("head");if(Tt.appendChild(Wt),typeof Me=="string"){var Ut=He.createElement("title");Ut.appendChild(He.createTextNode(Me)),Wt.appendChild(Ut)}Tt.appendChild(He.createElement("body"))}return He}};function Re(Me){E(Me)}Re.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var Me=this.getRootNode();return Me&&Me.nodeType===Me.DOCUMENT_NODE},contains:function(Me){if(!Me)return!1;var He=Me;do{if(this===He)return!0;He=Me.parentNode}while(He);return!1},getRootNode:function(Me){var He=this;do{if(!He.parentNode)return He;He=He.parentNode}while(He)},isEqualNode:function(Me){if(!Me||this.nodeType!==Me.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==Me.name||this.publicId!==Me.publicId||this.systemId!==Me.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==Me.namespaceURI||this.prefix!==Me.prefix||this.localName!==Me.localName||this.attributes.length!==Me.attributes.length)return!1;for(var He=0;He<this.attributes.length;He++){var Tt=this.attributes.item(He);if(!Tt.isEqualNode(Me.getAttributeNodeNS(Tt.namespaceURI,Tt.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==Me.namespaceURI||this.localName!==Me.localName||this.value!==Me.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==Me.target||this.data!==Me.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==Me.data)return!1;break}if(this.childNodes.length!==Me.childNodes.length)return!1;for(var He=0;He<this.childNodes.length;He++)if(!this.childNodes[He].isEqualNode(Me.childNodes[He]))return!1;return!0},isSameNode:function(Me){return this===Me},insertBefore:function(Me,He){return qe(this,Me,He)},replaceChild:function(Me,He){qe(this,Me,He,je),He&&this.removeChild(He)},removeChild:function(Me){return _t(this,Me)},appendChild:function(Me){return this.insertBefore(Me,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(Me){return un(this.ownerDocument||this,this,Me)},normalize:function(){for(var Me=this.firstChild;Me;){var He=Me.nextSibling;He&&He.nodeType==Q&&Me.nodeType==Q?(this.removeChild(He),Me.appendData(He.data)):(Me.normalize(),Me=He)}},isSupported:function(Me,He){return this.ownerDocument.implementation.hasFeature(Me,He)},lookupPrefix:function(Me){for(var He=this;He;){var Tt=He._nsMap;if(Tt){for(var Wt in Tt)if(n(Tt,Wt)&&Tt[Wt]===Me)return Wt}He=He.nodeType==ae?He.ownerDocument:He.parentNode}return null},lookupNamespaceURI:function(Me){for(var He=this;He;){var Tt=He._nsMap;if(Tt&&n(Tt,Me))return Tt[Me];He=He.nodeType==ae?He.ownerDocument:He.parentNode}return null},isDefaultNamespace:function(Me){var He=this.lookupPrefix(Me);return He==null},compareDocumentPosition:function(Me){if(this===Me)return 0;var He=Me,Tt=this,Wt=null,Ut=null;if(He instanceof Lt&&(Wt=He,He=Wt.ownerElement),Tt instanceof Lt&&(Ut=Tt,Tt=Ut.ownerElement,Wt&&He&&Tt===He))for(var Xr=0,Nn;Nn=Tt.attributes[Xr];Xr++){if(Nn===Wt)return De.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+De.DOCUMENT_POSITION_PRECEDING;if(Nn===Ut)return De.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+De.DOCUMENT_POSITION_FOLLOWING}if(!He||!Tt||Tt.ownerDocument!==He.ownerDocument)return De.DOCUMENT_POSITION_DISCONNECTED+De.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(Ee(Tt.ownerDocument)>Ee(He.ownerDocument)?De.DOCUMENT_POSITION_FOLLOWING:De.DOCUMENT_POSITION_PRECEDING);if(Ut&&He===Tt)return De.DOCUMENT_POSITION_CONTAINS+De.DOCUMENT_POSITION_PRECEDING;if(Wt&&He===Tt)return De.DOCUMENT_POSITION_CONTAINED_BY+De.DOCUMENT_POSITION_FOLLOWING;for(var Bi=[],Ci=He.parentNode;Ci;){if(!Ut&&Ci===Tt)return De.DOCUMENT_POSITION_CONTAINED_BY+De.DOCUMENT_POSITION_FOLLOWING;Bi.push(Ci),Ci=Ci.parentNode}Bi.reverse();for(var Fr=[],Mn=Tt.parentNode;Mn;){if(!Wt&&Mn===He)return De.DOCUMENT_POSITION_CONTAINS+De.DOCUMENT_POSITION_PRECEDING;Fr.push(Mn),Mn=Mn.parentNode}Fr.reverse();var Bn=de(Bi,Fr);for(var ei in Bn.childNodes){var ua=Bn.childNodes[ei];if(ua===Tt)return De.DOCUMENT_POSITION_FOLLOWING;if(ua===He)return De.DOCUMENT_POSITION_PRECEDING;if(Fr.indexOf(ua)>=0)return De.DOCUMENT_POSITION_FOLLOWING;if(Bi.indexOf(ua)>=0)return De.DOCUMENT_POSITION_PRECEDING}return 0}};function zt(Me){return Me=="<"&&"&lt;"||Me==">"&&"&gt;"||Me=="&"&&"&amp;"||Me=='"'&&"&quot;"||"&#"+Me.charCodeAt()+";"}j(G,Re),j(G,Re.prototype),j(De,Re),j(De,Re.prototype);function st(Me,He){if(He(Me))return!0;if(Me=Me.firstChild)do if(st(Me,He))return!0;while(Me=Me.nextSibling)}function $e(Me,He){E(Me);var Tt=He||{};this.ownerDocument=this,this.contentType=Tt.contentType||o.XML_APPLICATION,this.type=i(this.contentType)?"html":"xml"}function Jt(Me,He,Tt){Me&&Me._inc++;var Wt=Tt.namespaceURI;Wt===c.XMLNS&&(He._nsMap[Tt.prefix?Tt.localName:""]=Tt.value)}function Ht(Me,He,Tt,Wt){Me&&Me._inc++;var Ut=Tt.namespaceURI;Ut===c.XMLNS&&delete He._nsMap[Tt.prefix?Tt.localName:""]}function pr(Me,He,Tt){if(Me&&Me._inc){Me._inc++;var Wt=He.childNodes;if(Tt&&!Tt.nextSibling)Wt[Wt.length++]=Tt;else{for(var Ut=He.firstChild,Xr=0;Ut;)Wt[Xr++]=Ut,Ut=Ut.nextSibling;Wt.length=Xr,delete Wt[Wt.length]}}}function _t(Me,He){if(Me!==He.parentNode)throw new m(m.NOT_FOUND_ERR,"child's parent is not parent");var Tt=He.previousSibling,Wt=He.nextSibling;return Tt?Tt.nextSibling=Wt:Me.firstChild=Wt,Wt?Wt.previousSibling=Tt:Me.lastChild=Tt,pr(Me.ownerDocument,Me),He.parentNode=null,He.previousSibling=null,He.nextSibling=null,He}function vr(Me){return Me&&(Me.nodeType===Re.DOCUMENT_NODE||Me.nodeType===Re.DOCUMENT_FRAGMENT_NODE||Me.nodeType===Re.ELEMENT_NODE)}function br(Me){return Me&&(Me.nodeType===Re.CDATA_SECTION_NODE||Me.nodeType===Re.COMMENT_NODE||Me.nodeType===Re.DOCUMENT_FRAGMENT_NODE||Me.nodeType===Re.DOCUMENT_TYPE_NODE||Me.nodeType===Re.ELEMENT_NODE||Me.nodeType===Re.PROCESSING_INSTRUCTION_NODE||Me.nodeType===Re.TEXT_NODE)}function lr(Me){return Me&&Me.nodeType===Re.DOCUMENT_TYPE_NODE}function Cr(Me){return Me&&Me.nodeType===Re.ELEMENT_NODE}function Tr(Me){return Me&&Me.nodeType===Re.TEXT_NODE}function Qt(Me,He){var Tt=Me.childNodes||[];if(e(Tt,Cr)||lr(He))return!1;var Wt=e(Tt,lr);return!(He&&Wt&&Tt.indexOf(Wt)>Tt.indexOf(He))}function at(Me,He){var Tt=Me.childNodes||[];function Wt(Xr){return Cr(Xr)&&Xr!==He}if(e(Tt,Wt))return!1;var Ut=e(Tt,lr);return!(He&&Ut&&Tt.indexOf(Ut)>Tt.indexOf(He))}function ke(Me,He,Tt){if(!vr(Me))throw new m(m.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+Me.nodeType);if(Tt&&Tt.parentNode!==Me)throw new m(m.NOT_FOUND_ERR,"child not in parent");if(!br(He)||lr(He)&&Me.nodeType!==Re.DOCUMENT_NODE)throw new m(m.HIERARCHY_REQUEST_ERR,"Unexpected node type "+He.nodeType+" for parent node type "+Me.nodeType)}function be(Me,He,Tt){var Wt=Me.childNodes||[],Ut=He.childNodes||[];if(He.nodeType===Re.DOCUMENT_FRAGMENT_NODE){var Xr=Ut.filter(Cr);if(Xr.length>1||e(Ut,Tr))throw new m(m.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(Xr.length===1&&!Qt(Me,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Cr(He)&&!Qt(Me,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(lr(He)){if(e(Wt,lr))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var Nn=e(Wt,Cr);if(Tt&&Wt.indexOf(Nn)<Wt.indexOf(Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!Tt&&Nn)throw new m(m.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function je(Me,He,Tt){var Wt=Me.childNodes||[],Ut=He.childNodes||[];if(He.nodeType===Re.DOCUMENT_FRAGMENT_NODE){var Xr=Ut.filter(Cr);if(Xr.length>1||e(Ut,Tr))throw new m(m.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(Xr.length===1&&!at(Me,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Cr(He)&&!at(Me,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(lr(He)){if(e(Wt,function(Ci){return lr(Ci)&&Ci!==Tt}))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var Nn=e(Wt,Cr);if(Tt&&Wt.indexOf(Nn)<Wt.indexOf(Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function qe(Me,He,Tt,Wt){ke(Me,He,Tt),Me.nodeType===Re.DOCUMENT_NODE&&(Wt||be)(Me,He,Tt);var Ut=He.parentNode;if(Ut&&Ut.removeChild(He),He.nodeType===xe){var Xr=He.firstChild;if(Xr==null)return He;var Nn=He.lastChild}else Xr=Nn=He;var Bi=Tt?Tt.previousSibling:Me.lastChild;Xr.previousSibling=Bi,Nn.nextSibling=Tt,Bi?Bi.nextSibling=Xr:Me.firstChild=Xr,Tt==null?Me.lastChild=Nn:Tt.previousSibling=Nn;do Xr.parentNode=Me;while(Xr!==Nn&&(Xr=Xr.nextSibling));return pr(Me.ownerDocument||Me,Me,He),He.nodeType==xe&&(He.firstChild=He.lastChild=null),He}$e.prototype={implementation:null,nodeName:"#document",nodeType:Ce,doctype:null,documentElement:null,_inc:1,insertBefore:function(Me,He){if(Me.nodeType===xe){for(var Tt=Me.firstChild;Tt;){var Wt=Tt.nextSibling;this.insertBefore(Tt,He),Tt=Wt}return Me}return qe(this,Me,He),Me.ownerDocument=this,this.documentElement===null&&Me.nodeType===X&&(this.documentElement=Me),Me},removeChild:function(Me){var He=_t(this,Me);return He===this.documentElement&&(this.documentElement=null),He},replaceChild:function(Me,He){qe(this,Me,He,je),Me.ownerDocument=this,He&&this.removeChild(He),Cr(Me)&&(this.documentElement=Me)},importNode:function(Me,He){return oi(this,Me,He)},getElementById:function(Me){var He=null;return st(this.documentElement,function(Tt){if(Tt.nodeType==X&&Tt.getAttribute("id")==Me)return He=Tt,!0}),He},createElement:function(Me){var He=new We(h);He.ownerDocument=this,this.type==="html"&&(Me=Me.toLowerCase()),r(this.contentType)&&(He.namespaceURI=c.HTML),He.nodeName=Me,He.tagName=Me,He.localName=Me,He.childNodes=new we;var Tt=He.attributes=new Xe;return Tt._ownerElement=He,He},createDocumentFragment:function(){var Me=new hn(h);return Me.ownerDocument=this,Me.childNodes=new we,Me},createTextNode:function(Me){var He=new mt(h);return He.ownerDocument=this,He.childNodes=new we,He.appendData(Me),He},createComment:function(Me){var He=new ct(h);return He.ownerDocument=this,He.childNodes=new we,He.appendData(Me),He},createCDATASection:function(Me){var He=new Kt(h);return He.ownerDocument=this,He.childNodes=new we,He.appendData(Me),He},createProcessingInstruction:function(Me,He){var Tt=new zr(h);return Tt.ownerDocument=this,Tt.childNodes=new we,Tt.nodeName=Tt.target=Me,Tt.nodeValue=Tt.data=He,Tt},createAttribute:function(Me){if(!x.QName_exact.test(Me))throw new m(m.INVALID_CHARACTER_ERR,'invalid character in name "'+Me+'"');return this.type==="html"&&(Me=Me.toLowerCase()),this._createAttribute(Me)},_createAttribute:function(Me){var He=new Lt(h);return He.ownerDocument=this,He.childNodes=new we,He.name=Me,He.nodeName=Me,He.localName=Me,He.specified=!0,He},createEntityReference:function(Me){if(!x.Name.test(Me))throw new m(m.INVALID_CHARACTER_ERR,'not a valid xml name "'+Me+'"');if(this.type==="html")throw new m("document is an html document",b.NotSupportedError);var He=new $r(h);return He.ownerDocument=this,He.childNodes=new we,He.nodeName=Me,He},createElementNS:function(Me,He){var Tt=U(Me,He),Wt=new We(h),Ut=Wt.attributes=new Xe;return Wt.childNodes=new we,Wt.ownerDocument=this,Wt.nodeName=He,Wt.tagName=He,Wt.namespaceURI=Tt[0],Wt.prefix=Tt[1],Wt.localName=Tt[2],Ut._ownerElement=Wt,Wt},createAttributeNS:function(Me,He){var Tt=U(Me,He),Wt=new Lt(h);return Wt.ownerDocument=this,Wt.childNodes=new we,Wt.nodeName=He,Wt.name=He,Wt.specified=!0,Wt.namespaceURI=Tt[0],Wt.prefix=Tt[1],Wt.localName=Tt[2],Wt}},H($e,Re);function We(Me){E(Me),this._nsMap=Object.create(null)}We.prototype={nodeType:X,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return this.ownerDocument.type==="html"&&this.namespaceURI===c.HTML},hasAttributes:function(){return!!(this.attributes&&this.attributes.length)},hasAttribute:function(Me){return!!this.getAttributeNode(Me)},getAttribute:function(Me){var He=this.getAttributeNode(Me);return He?He.value:null},getAttributeNode:function(Me){return this._isInHTMLDocumentAndNamespace()&&(Me=Me.toLowerCase()),this.attributes.getNamedItem(Me)},setAttribute:function(Me,He){this._isInHTMLDocumentAndNamespace()&&(Me=Me.toLowerCase());var Tt=this.getAttributeNode(Me);Tt?Tt.value=Tt.nodeValue=""+He:(Tt=this.ownerDocument._createAttribute(Me),Tt.value=Tt.nodeValue=""+He,this.setAttributeNode(Tt))},removeAttribute:function(Me){var He=this.getAttributeNode(Me);He&&this.removeAttributeNode(He)},setAttributeNode:function(Me){return this.attributes.setNamedItem(Me)},setAttributeNodeNS:function(Me){return this.attributes.setNamedItemNS(Me)},removeAttributeNode:function(Me){return this.attributes.removeNamedItem(Me.nodeName)},removeAttributeNS:function(Me,He){var Tt=this.getAttributeNodeNS(Me,He);Tt&&this.removeAttributeNode(Tt)},hasAttributeNS:function(Me,He){return this.getAttributeNodeNS(Me,He)!=null},getAttributeNS:function(Me,He){var Tt=this.getAttributeNodeNS(Me,He);return Tt?Tt.value:null},setAttributeNS:function(Me,He,Tt){var Wt=U(Me,He),Ut=Wt[2],Xr=this.getAttributeNodeNS(Me,Ut);Xr?Xr.value=Xr.nodeValue=""+Tt:(Xr=this.ownerDocument.createAttributeNS(Me,He),Xr.value=Xr.nodeValue=""+Tt,this.setAttributeNode(Xr))},getAttributeNodeNS:function(Me,He){return this.attributes.getNamedItemNS(Me,He)},getElementsByClassName:function(Me){var He=F(Me);return new Le(this,function(Tt){var Wt=[];return He.length>0&&st(Tt,function(Ut){if(Ut!==Tt&&Ut.nodeType===X){var Xr=Ut.getAttribute("class");if(Xr){var Nn=Me===Xr;if(!Nn){var Bi=F(Xr);Nn=He.every(N(Bi))}Nn&&Wt.push(Ut)}}}),Wt})},getElementsByTagName:function(Me){var He=(this.nodeType===Ce?this:this.ownerDocument).type==="html",Tt=Me.toLowerCase();return new Le(this,function(Wt){var Ut=[];return st(Wt,function(Xr){if(!(Xr===Wt||Xr.nodeType!==X))if(Me==="*")Ut.push(Xr);else{var Nn=Xr.getQualifiedName(),Bi=He&&Xr.namespaceURI===c.HTML?Tt:Me;Nn===Bi&&Ut.push(Xr)}}),Ut})},getElementsByTagNameNS:function(Me,He){return new Le(this,function(Tt){var Wt=[];return st(Tt,function(Ut){Ut!==Tt&&Ut.nodeType===X&&(Me==="*"||Ut.namespaceURI===Me)&&(He==="*"||Ut.localName==He)&&Wt.push(Ut)}),Wt})}},$e.prototype.getElementsByClassName=We.prototype.getElementsByClassName,$e.prototype.getElementsByTagName=We.prototype.getElementsByTagName,$e.prototype.getElementsByTagNameNS=We.prototype.getElementsByTagNameNS,H(We,Re);function Lt(Me){E(Me),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}Lt.prototype.nodeType=ae,H(Lt,Re);function Et(Me){E(Me)}Et.prototype={data:"",substringData:function(Me,He){return this.data.substring(Me,Me+He)},appendData:function(Me){Me=this.data+Me,this.nodeValue=this.data=Me,this.length=Me.length},insertData:function(Me,He){this.replaceData(Me,0,He)},deleteData:function(Me,He){this.replaceData(Me,He,"")},replaceData:function(Me,He,Tt){var Wt=this.data.substring(0,Me),Ut=this.data.substring(Me+He);Tt=Wt+Tt+Ut,this.nodeValue=this.data=Tt,this.length=Tt.length}},H(Et,Re);function mt(Me){E(Me)}mt.prototype={nodeName:"#text",nodeType:Q,splitText:function(Me){var He=this.data,Tt=He.substring(Me);He=He.substring(0,Me),this.data=this.nodeValue=He,this.length=He.length;var Wt=this.ownerDocument.createTextNode(Tt);return this.parentNode&&this.parentNode.insertBefore(Wt,this.nextSibling),Wt}},H(mt,Et);function ct(Me){E(Me)}ct.prototype={nodeName:"#comment",nodeType:_e},H(ct,Et);function Kt(Me){E(Me)}Kt.prototype={nodeName:"#cdata-section",nodeType:W},H(Kt,mt);function qt(Me){E(Me)}qt.prototype.nodeType=me,H(qt,Re);function Ir(Me){E(Me)}Ir.prototype.nodeType=Ae,H(Ir,Re);function Ar(Me){E(Me)}Ar.prototype.nodeType=se,H(Ar,Re);function $r(Me){E(Me)}$r.prototype.nodeType=oe,H($r,Re);function hn(Me){E(Me)}hn.prototype.nodeName="#document-fragment",hn.prototype.nodeType=xe,H(hn,Re);function zr(Me){E(Me)}zr.prototype.nodeType=he,H(zr,Et);function Mt(){}Mt.prototype.serializeToString=function(Me,He){return en.call(Me,He)},Re.prototype.toString=en;function en(Me){var He=[],Tt=this.nodeType===Ce&&this.documentElement||this,Wt=Tt.prefix,Ut=Tt.namespaceURI;if(Ut&&Wt==null){var Wt=Tt.lookupPrefix(Ut);if(Wt==null)var Xr=[{namespace:Ut,prefix:null}]}return nr(this,He,Me,Xr),He.join("")}function jn(Me,He,Tt){var Wt=Me.prefix||"",Ut=Me.namespaceURI;if(!Ut||Wt==="xml"&&Ut===c.XML||Ut===c.XMLNS)return!1;for(var Xr=Tt.length;Xr--;){var Nn=Tt[Xr];if(Nn.prefix===Wt)return Nn.namespace!==Ut}return!0}function Qr(Me,He,Tt){Me.push(" ",He,'="',Tt.replace(/[<>&"\t\n\r]/g,zt),'"')}function nr(Me,He,Tt,Wt){Wt||(Wt=[]);var Ut=Me.nodeType===Ce?Me:Me.ownerDocument,Xr=Ut.type==="html";if(Tt)if(Me=Tt(Me),Me){if(typeof Me=="string"){He.push(Me);return}}else return;switch(Me.nodeType){case X:var Nn=Me.attributes,Bi=Nn.length,Ca=Me.firstChild,Ci=Me.tagName,Fr=Ci;if(!Xr&&!Me.prefix&&Me.namespaceURI){for(var Mn,Bn=0;Bn<Nn.length;Bn++)if(Nn.item(Bn).name==="xmlns"){Mn=Nn.item(Bn).value;break}if(!Mn)for(var ei=Wt.length-1;ei>=0;ei--){var ua=Wt[ei];if(ua.prefix===""&&ua.namespace===Me.namespaceURI){Mn=ua.namespace;break}}if(Mn!==Me.namespaceURI)for(var ei=Wt.length-1;ei>=0;ei--){var ua=Wt[ei];if(ua.namespace===Me.namespaceURI){ua.prefix&&(Fr=ua.prefix+":"+Ci);break}}}He.push("<",Fr);for(var fa=0;fa<Bi;fa++){var zn=Nn.item(fa);zn.prefix=="xmlns"?Wt.push({prefix:zn.localName,namespace:zn.value}):zn.nodeName=="xmlns"&&Wt.push({prefix:"",namespace:zn.value})}for(var fa=0;fa<Bi;fa++){var zn=Nn.item(fa);if(jn(zn,Xr,Wt)){var La=zn.prefix||"",Gi=zn.namespaceURI;Qr(He,La?"xmlns:"+La:"xmlns",Gi),Wt.push({prefix:La,namespace:Gi})}nr(zn,He,Tt,Wt)}if(Ci===Fr&&jn(Me,Xr,Wt)){var La=Me.prefix||"",Gi=Me.namespaceURI;Qr(He,La?"xmlns:"+La:"xmlns",Gi),Wt.push({prefix:La,namespace:Gi})}var fs=!Ca;if(fs&&(Xr||Me.namespaceURI===c.HTML)&&(fs=s(Ci)),fs)He.push("/>");else{if(He.push(">"),Xr&&a(Ci))for(;Ca;)Ca.data?He.push(Ca.data):nr(Ca,He,Tt,Wt.slice()),Ca=Ca.nextSibling;else for(;Ca;)nr(Ca,He,Tt,Wt.slice()),Ca=Ca.nextSibling;He.push("</",Fr,">")}return;case Ce:case xe:for(var Ca=Me.firstChild;Ca;)nr(Ca,He,Tt,Wt.slice()),Ca=Ca.nextSibling;return;case ae:return Qr(He,Me.name,Me.value);case Q:return He.push(Me.data.replace(/[<&>]/g,zt));case W:return He.push(x.CDATA_START,Me.data,x.CDATA_END);case _e:return He.push(x.COMMENT_START,Me.data,x.COMMENT_END);case me:var Mo=Me.publicId,Ya=Me.systemId;He.push(x.DOCTYPE_DECL_START," ",Me.name),Mo?(He.push(" ",x.PUBLIC," ",Mo),Ya&&Ya!=="."&&He.push(" ",Ya)):Ya&&Ya!=="."&&He.push(" ",x.SYSTEM," ",Ya),Me.internalSubset&&He.push(" [",Me.internalSubset,"]"),He.push(">");return;case he:return He.push("<?",Me.target," ",Me.data,"?>");case oe:return He.push("&",Me.nodeName,";");default:He.push("??",Me.nodeName)}}function oi(Me,He,Tt){var Wt;switch(He.nodeType){case X:Wt=He.cloneNode(!1),Wt.ownerDocument=Me;case xe:break;case ae:Tt=!0;break}if(Wt||(Wt=He.cloneNode(!1)),Wt.ownerDocument=Me,Wt.parentNode=null,Tt)for(var Ut=He.firstChild;Ut;)Wt.appendChild(oi(Me,Ut,Tt)),Ut=Ut.nextSibling;return Wt}function un(Me,He,Tt){var Wt=new He.constructor(h);for(var Ut in He)if(n(He,Ut)){var Xr=He[Ut];typeof Xr!="object"&&Xr!=Wt[Ut]&&(Wt[Ut]=Xr)}switch(He.childNodes&&(Wt.childNodes=new we),Wt.ownerDocument=Me,Wt.nodeType){case X:var Nn=He.attributes,Bi=Wt.attributes=new Xe,Ci=Nn.length;Bi._ownerElement=Wt;for(var Fr=0;Fr<Ci;Fr++)Wt.setAttributeNode(un(Me,Nn.item(Fr),!0));break;case ae:Tt=!0}if(Tt)for(var Mn=He.firstChild;Mn;)Wt.appendChild(un(Me,Mn,Tt)),Mn=Mn.nextSibling;return Wt}function Kn(Me,He,Tt){Me[He]=Tt}try{if(Object.defineProperty){let Me=function(He){switch(He.nodeType){case X:case xe:var Tt=[];for(He=He.firstChild;He;)He.nodeType!==7&&He.nodeType!==8&&Tt.push(Me(He)),He=He.nextSibling;return Tt.join("");default:return He.nodeValue}};Object.defineProperty(Le.prototype,"length",{get:function(){return Fe(this),this.$$length}}),Object.defineProperty(Re.prototype,"textContent",{get:function(){return Me(this)},set:function(He){switch(this.nodeType){case X:case xe:for(;this.firstChild;)this.removeChild(this.firstChild);(He||String(He))&&this.appendChild(this.ownerDocument.createTextNode(He));break;default:this.data=He,this.value=He,this.nodeValue=He}}}),Kn=function(He,Tt,Wt){He["$$"+Tt]=Wt}}}catch{}return Os._updateLiveList=Fe,Os.Attr=Lt,Os.CDATASection=Kt,Os.CharacterData=Et,Os.Comment=ct,Os.Document=$e,Os.DocumentFragment=hn,Os.DocumentType=qt,Os.DOMImplementation=rt,Os.Element=We,Os.Entity=Ar,Os.EntityReference=$r,Os.LiveNodeList=Le,Os.NamedNodeMap=Xe,Os.Node=Re,Os.NodeList=we,Os.Notation=Ir,Os.Text=mt,Os.ProcessingInstruction=zr,Os.XMLSerializer=Mt,Os}var fm={},cP={},Sq;function Oke(){return Sq||(Sq=1,(function(t){var e=C_().freeze;t.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=e({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),t.entityMap=t.HTML_ENTITIES})(cP)),cP}var f1={},Eq;function Nke(){if(Eq)return f1;Eq=1;var t=C_(),e=tee(),r=D3(),n=t.isHTMLEscapableRawTextElement,i=t.isHTMLMimeType,a=t.isHTMLRawTextElement,s=t.hasOwn,o=t.NAMESPACE,c=r.ParseError,h=r.DOMException,d=0,m=1,b=2,x=3,E=4,T=5,A=6,M=7;function F(){}F.prototype={parse:function(he,_e,Ce){var me=this.domBuilder;me.startDocument(),X(_e,_e=Object.create(null)),O(he,_e,Ce,me,this.errorHandler),me.endDocument()}};var N=/&#?\w+;?/g;function O(he,_e,Ce,me,xe){var Ae=i(me.mimeType);he.indexOf(e.UNICODE_REPLACEMENT_CHARACTER)>=0&&xe.warning("Unicode replacement character detected, source encoding issues?");function De(qe){if(qe>65535){qe-=65536;var We=55296+(qe>>10),Lt=56320+(qe&1023);return String.fromCharCode(We,Lt)}else return String.fromCharCode(qe)}function de(qe){var We=qe[qe.length-1]===";"?qe:qe+";";if(!Ae&&We!==qe)return xe.error("EntityRef: expecting ;"),qe;var Lt=e.Reference.exec(We);if(!Lt||Lt[0].length!==We.length)return xe.error("entity not matching Reference production: "+qe),qe;var Et=We.slice(1,-1);return s(Ce,Et)?Ce[Et]:Et.charAt(0)==="#"?De(parseInt(Et.substring(1).replace("x","0x"))):(xe.error("entity not found:"+qe),qe)}function Ee(qe){if(qe>rt){var We=he.substring(rt,qe).replace(N,de);Xe&&Be(rt),me.characters(We,0,qe-rt),rt=qe}}var we=0,Le=0,Fe=/\r\n?|\n|$/g,Xe=me.locator;function Be(qe,We){for(;qe>=Le&&(We=Fe.exec(he));)we=Le,Le=We.index+We[0].length,Xe.lineNumber++;Xe.columnNumber=qe-we+1}for(var ot=[{currentNSMap:_e}],Qe=[],rt=0;;){try{var Re=he.indexOf("<",rt);if(Re<0){if(!Ae&&Qe.length>0)return xe.fatalError("unclosed xml tag(s): "+Qe.join(", "));if(!he.substring(rt).match(/^\s*$/)){var zt=me.doc,st=zt.createTextNode(he.substring(rt));if(zt.documentElement)return xe.error("Extra content at the end of the document");zt.appendChild(st),me.currentElement=st}return}if(Re>rt){var $e=he.substring(rt,Re);!Ae&&Qe.length===0&&($e=$e.replace(new RegExp(e.S_OPT.source,"g"),""),$e&&xe.error("Unexpected content outside root element: '"+$e+"'")),Ee(Re)}switch(he.charAt(Re+1)){case"/":var Qt=he.indexOf(">",Re+2),Jt=he.substring(Re+2,Qt>0?Qt:void 0);if(!Jt)return xe.fatalError("end tag name missing");var Ht=Qt>0&&e.reg("^",e.QName_group,e.S_OPT,"$").exec(Jt);if(!Ht)return xe.fatalError('end tag name contains invalid characters: "'+Jt+'"');if(!me.currentElement&&!me.doc.documentElement)return;var pr=Qe[Qe.length-1]||me.currentElement.tagName||me.doc.documentElement.tagName||"";if(pr!==Ht[1]){var _t=Ht[1].toLowerCase();if(!Ae||pr.toLowerCase()!==_t)return xe.fatalError('Opening and ending tag mismatch: "'+pr+'" != "'+Jt+'"')}var vr=ot.pop();Qe.pop();var br=vr.localNSMap;if(me.endElement(vr.uri,vr.localName,pr),br)for(var lr in br)s(br,lr)&&me.endPrefixMapping(lr);Qt++;break;case"?":Xe&&Be(Re),Qt=oe(he,Re,me,xe);break;case"!":Xe&&Be(Re),Qt=W(he,Re,me,xe,Ae);break;default:Xe&&Be(Re);var Cr=new se,Tr=ot[ot.length-1].currentNSMap,Qt=j(he,Re,Cr,Tr,de,xe,Ae),at=Cr.length;if(Cr.closed||(Ae&&t.isHTMLVoidElement(Cr.tagName)?Cr.closed=!0:Qe.push(Cr.tagName)),Xe&&at){for(var ke=U(Xe,{}),be=0;be<at;be++){var je=Cr[be];Be(je.offset),je.locator=U(Xe,{})}me.locator=ke,H(Cr,me,Tr)&&ot.push(Cr),me.locator=Xe}else H(Cr,me,Tr)&&ot.push(Cr);Ae&&!Cr.closed?Qt=G(he,Qt,Cr.tagName,de,me):Qt++}}catch(qe){if(qe instanceof c)throw qe;if(qe instanceof h)throw new c(qe.name+": "+qe.message,me.locator,qe);xe.error("element parse error: "+qe),Qt=-1}Qt>rt?rt=Qt:Ee(Math.max(Re,rt)+1)}}function U(he,_e){return _e.lineNumber=he.lineNumber,_e.columnNumber=he.columnNumber,_e}function j(he,_e,Ce,me,xe,Ae,De){function de(Be,ot,Qe){if(s(Ce.attributeNames,Be))return Ae.fatalError("Attribute "+Be+" redefined");if(!De&&ot.indexOf("<")>=0)return Ae.fatalError("Unescaped '<' not allowed in attributes values");Ce.addValue(Be,ot.replace(/[\t\n\r]/g," ").replace(N,xe),Qe)}for(var Ee,we,Le=++_e,Fe=d;;){var Xe=he.charAt(Le);switch(Xe){case"=":if(Fe===m)Ee=he.slice(_e,Le),Fe=x;else if(Fe===b)Fe=x;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(Fe===x||Fe===m)if(Fe===m&&(Ae.warning('attribute value must after "="'),Ee=he.slice(_e,Le)),_e=Le+1,Le=he.indexOf(Xe,_e),Le>0)we=he.slice(_e,Le),de(Ee,we,_e-1),Fe=T;else throw new Error("attribute value no end '"+Xe+"' match");else if(Fe==E)we=he.slice(_e,Le),de(Ee,we,_e),Ae.warning('attribute "'+Ee+'" missed start quot('+Xe+")!!"),_e=Le+1,Fe=T;else throw new Error('attribute value must after "="');break;case"/":switch(Fe){case d:Ce.setTagName(he.slice(_e,Le));case T:case A:case M:Fe=M,Ce.closed=!0;case E:case m:break;case b:Ce.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return Ae.error("unexpected end of input"),Fe==d&&Ce.setTagName(he.slice(_e,Le)),Le;case">":switch(Fe){case d:Ce.setTagName(he.slice(_e,Le));case T:case A:case M:break;case E:case m:we=he.slice(_e,Le),we.slice(-1)==="/"&&(Ce.closed=!0,we=we.slice(0,-1));case b:Fe===b&&(we=Ee),Fe==E?(Ae.warning('attribute "'+we+'" missed quot(")!'),de(Ee,we,_e)):(De||Ae.warning('attribute "'+we+'" missed value!! "'+we+'" instead!!'),de(we,we,_e));break;case x:if(!De)return Ae.fatalError(`AttValue: ' or " expected`)}return Le;case"":Xe=" ";default:if(Xe<=" ")switch(Fe){case d:Ce.setTagName(he.slice(_e,Le)),Fe=A;break;case m:Ee=he.slice(_e,Le),Fe=b;break;case E:var we=he.slice(_e,Le);Ae.warning('attribute "'+we+'" missed quot(")!!'),de(Ee,we,_e);case T:Fe=A;break}else switch(Fe){case b:De||Ae.warning('attribute "'+Ee+'" missed value!! "'+Ee+'" instead2!!'),de(Ee,Ee,_e),_e=Le,Fe=m;break;case T:Ae.warning('attribute space is required"'+Ee+'"!!');case A:Fe=m,_e=Le;break;case x:Fe=E,_e=Le;break;case M:throw new Error("elements closed character '/' and '>' must be connected to")}}Le++}}function H(he,_e,Ce){for(var me=he.tagName,xe=null,Fe=he.length;Fe--;){var Ae=he[Fe],De=Ae.qName,de=Ae.value,Xe=De.indexOf(":");if(Xe>0)var Ee=Ae.prefix=De.slice(0,Xe),we=De.slice(Xe+1),Le=Ee==="xmlns"&&we;else we=De,Ee=null,Le=De==="xmlns"&&"";Ae.localName=we,Le!==!1&&(xe==null&&(xe=Object.create(null),X(Ce,Ce=Object.create(null))),Ce[Le]=xe[Le]=de,Ae.uri=o.XMLNS,_e.startPrefixMapping(Le,de))}for(var Fe=he.length;Fe--;)Ae=he[Fe],Ae.prefix&&(Ae.prefix==="xml"&&(Ae.uri=o.XML),Ae.prefix!=="xmlns"&&(Ae.uri=Ce[Ae.prefix]));var Xe=me.indexOf(":");Xe>0?(Ee=he.prefix=me.slice(0,Xe),we=he.localName=me.slice(Xe+1)):(Ee=null,we=he.localName=me);var Be=he.uri=Ce[Ee||""];if(_e.startElement(Be,we,me,he),he.closed){if(_e.endElement(Be,we,me),xe)for(Ee in xe)s(xe,Ee)&&_e.endPrefixMapping(Ee)}else return he.currentNSMap=Ce,he.localNSMap=xe,!0}function G(he,_e,Ce,me,xe){var Ae=n(Ce);if(Ae||a(Ce)){var De=he.indexOf("</"+Ce+">",_e),de=he.substring(_e+1,De);return Ae&&(de=de.replace(N,me)),xe.characters(de,0,de.length),De}return _e+1}function X(he,_e){for(var Ce in he)s(he,Ce)&&(_e[Ce]=he[Ce])}function ae(he,_e){var Ce=_e;function me(Le){return Le=Le||0,he.charAt(Ce+Le)}function xe(Le){Le=Le||1,Ce+=Le}function Ae(){for(var Le=0;Ce<he.length;){var Fe=me();if(Fe!==" "&&Fe!==`
`&&Fe!=="	"&&Fe!=="\r")return Le;Le++,xe()}return-1}function De(){return he.substring(Ce)}function de(Le){return he.substring(Ce,Ce+Le.length)===Le}function Ee(Le){return he.substring(Ce,Ce+Le.length).toUpperCase()===Le.toUpperCase()}function we(Le){var Fe=e.reg("^",Le),Xe=Fe.exec(De());return Xe?(xe(Xe[0].length),Xe[0]):null}return{char:me,getIndex:function(){return Ce},getMatch:we,getSource:function(){return he},skip:xe,skipBlanks:Ae,substringFromIndex:De,substringStartsWith:de,substringStartsWithCaseInsensitive:Ee}}function Q(he,_e){function Ce(de,Ee){var we=e.PI.exec(de.substringFromIndex());return we?we[1].toLowerCase()==="xml"?Ee.fatalError("xml declaration is only allowed at the start of the document, but found at position "+de.getIndex()):(de.skip(we[0].length),we[0]):Ee.fatalError("processing instruction is not well-formed at position "+de.getIndex())}var me=he.getSource();if(he.char()==="["){he.skip(1);for(var xe=he.getIndex();he.getIndex()<me.length;){if(he.skipBlanks(),he.char()==="]"){var Ae=me.substring(xe,he.getIndex());return he.skip(1),Ae}var De=null;if(he.char()==="<"&&he.char(1)==="!")switch(he.char(2)){case"E":he.char(3)==="L"?De=he.getMatch(e.elementdecl):he.char(3)==="N"&&(De=he.getMatch(e.EntityDecl));break;case"A":De=he.getMatch(e.AttlistDecl);break;case"N":De=he.getMatch(e.NotationDecl);break;case"-":De=he.getMatch(e.Comment);break}else if(he.char()==="<"&&he.char(1)==="?")De=Ce(he,_e);else if(he.char()==="%")De=he.getMatch(e.PEReference);else return _e.fatalError("Error detected in Markup declaration");if(!De)return _e.fatalError("Error in internal subset at position "+he.getIndex())}return _e.fatalError("doctype internal subset is not well-formed, missing ]")}}function W(he,_e,Ce,me,xe){var Ae=ae(he,_e);switch(xe?Ae.char(2).toUpperCase():Ae.char(2)){case"-":var De=Ae.getMatch(e.Comment);return De?(Ce.comment(De,e.COMMENT_START.length,De.length-e.COMMENT_START.length-e.COMMENT_END.length),Ae.getIndex()):me.fatalError("comment is not well-formed at position "+Ae.getIndex());case"[":var de=Ae.getMatch(e.CDSect);return de?!xe&&!Ce.currentElement?me.fatalError("CDATA outside of element"):(Ce.startCDATA(),Ce.characters(de,e.CDATA_START.length,de.length-e.CDATA_START.length-e.CDATA_END.length),Ce.endCDATA(),Ae.getIndex()):me.fatalError("Invalid CDATA starting at position "+_e);case"D":{if(Ce.doc&&Ce.doc.documentElement)return me.fatalError("Doctype not allowed inside or after documentElement at position "+Ae.getIndex());if(xe?!Ae.substringStartsWithCaseInsensitive(e.DOCTYPE_DECL_START):!Ae.substringStartsWith(e.DOCTYPE_DECL_START))return me.fatalError("Expected "+e.DOCTYPE_DECL_START+" at position "+Ae.getIndex());if(Ae.skip(e.DOCTYPE_DECL_START.length),Ae.skipBlanks()<1)return me.fatalError("Expected whitespace after "+e.DOCTYPE_DECL_START+" at position "+Ae.getIndex());var Ee={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(Ee.name=Ae.getMatch(e.Name),!Ee.name)return me.fatalError("doctype name missing or contains unexpected characters at position "+Ae.getIndex());if(xe&&Ee.name.toLowerCase()!=="html"&&me.warning("Unexpected DOCTYPE in HTML document at position "+Ae.getIndex()),Ae.skipBlanks(),Ae.substringStartsWith(e.PUBLIC)||Ae.substringStartsWith(e.SYSTEM)){var we=e.ExternalID_match.exec(Ae.substringFromIndex());if(!we)return me.fatalError("doctype external id is not well-formed at position "+Ae.getIndex());we.groups.SystemLiteralOnly!==void 0?Ee.systemId=we.groups.SystemLiteralOnly:(Ee.systemId=we.groups.SystemLiteral,Ee.publicId=we.groups.PubidLiteral),Ae.skip(we[0].length)}else if(xe&&Ae.substringStartsWithCaseInsensitive(e.SYSTEM)){if(Ae.skip(e.SYSTEM.length),Ae.skipBlanks()<1)return me.fatalError("Expected whitespace after "+e.SYSTEM+" at position "+Ae.getIndex());if(Ee.systemId=Ae.getMatch(e.ABOUT_LEGACY_COMPAT_SystemLiteral),!Ee.systemId)return me.fatalError("Expected "+e.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+e.SYSTEM+" at position "+Ae.getIndex())}return xe&&Ee.systemId&&!e.ABOUT_LEGACY_COMPAT_SystemLiteral.test(Ee.systemId)&&me.warning("Unexpected doctype.systemId in HTML document at position "+Ae.getIndex()),xe||(Ae.skipBlanks(),Ee.internalSubset=Q(Ae,me)),Ae.skipBlanks(),Ae.char()!==">"?me.fatalError("doctype not terminated with > at position "+Ae.getIndex()):(Ae.skip(1),Ce.startDTD(Ee.name,Ee.publicId,Ee.systemId,Ee.internalSubset),Ce.endDTD(),Ae.getIndex())}default:return me.fatalError('Not well-formed XML starting with "<!" at position '+_e)}}function oe(he,_e,Ce,me){var xe=he.substring(_e).match(e.PI);if(!xe)return me.fatalError("Invalid processing instruction starting at position "+_e);if(xe[1].toLowerCase()==="xml"){if(_e>0)return me.fatalError("processing instruction at position "+_e+" is an xml declaration which is only at the start of the document");if(!e.XMLDecl.test(he.substring(_e)))return me.fatalError("xml declaration is not well-formed")}return Ce.processingInstruction(xe[1],xe[2]),_e+xe[0].length}function se(){this.attributeNames=Object.create(null)}return se.prototype={setTagName:function(he){if(!e.QName_exact.test(he))throw new Error("invalid tagName:"+he);this.tagName=he},addValue:function(he,_e,Ce){if(!e.QName_exact.test(he))throw new Error("invalid attribute:"+he);this.attributeNames[he]=this.length,this[this.length++]={qName:he,value:_e,offset:Ce}},length:0,getLocalName:function(he){return this[he].localName},getLocator:function(he){return this[he].locator},getQName:function(he){return this[he].qName},getURI:function(he){return this[he].uri},getValue:function(he){return this[he].value}},f1.XMLReader=F,f1.parseUtils=ae,f1.parseDoctypeCommentOrCData=W,f1}var Tq;function Lke(){if(Tq)return fm;Tq=1;var t=C_(),e=ree(),r=D3(),n=Oke(),i=Nke(),a=e.DOMImplementation,s=t.hasDefaultHTMLNamespace,o=t.isHTMLMimeType,c=t.isValidMimeType,h=t.MIME_TYPE,d=t.NAMESPACE,m=r.ParseError,b=i.XMLReader;function x(j){return j.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028\u2029]/g,`
`)}function E(j){if(j=j||{},j.locator===void 0&&(j.locator=!0),this.assign=j.assign||t.assign,this.domHandler=j.domHandler||T,this.onError=j.onError||j.errorHandler,j.errorHandler&&typeof j.errorHandler!="function")throw new TypeError("errorHandler object is no longer supported, switch to onError!");j.errorHandler&&j.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=j.normalizeLineEndings||x,this.locator=!!j.locator,this.xmlns=this.assign(Object.create(null),j.xmlns)}E.prototype.parseFromString=function(j,H){if(!c(H))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+H+'" is not valid.');var G=this.assign(Object.create(null),this.xmlns),X=n.XML_ENTITIES,ae=G[""]||null;s(H)?(X=n.HTML_ENTITIES,ae=d.HTML):H===h.XML_SVG_IMAGE&&(ae=d.SVG),G[""]=ae,G.xml=G.xml||d.XML;var Q=new this.domHandler({mimeType:H,defaultNamespace:ae,onError:this.onError}),W=this.locator?{}:void 0;this.locator&&Q.setDocumentLocator(W);var oe=new b;oe.errorHandler=Q,oe.domBuilder=Q;var se=!t.isHTMLMimeType(H);return se&&typeof j!="string"&&oe.errorHandler.fatalError("source is not a string"),oe.parse(this.normalizeLineEndings(String(j)),G,X),Q.doc.documentElement||oe.errorHandler.fatalError("missing root element"),Q.doc};function T(j){var H=j||{};this.mimeType=H.mimeType||h.XML_APPLICATION,this.defaultNamespace=H.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=H.onError}function A(j,H){H.lineNumber=j.lineNumber,H.columnNumber=j.columnNumber}T.prototype={startDocument:function(){var j=new a;this.doc=o(this.mimeType)?j.createHTMLDocument(!1):j.createDocument(this.defaultNamespace,"")},startElement:function(j,H,G,X){var ae=this.doc,Q=ae.createElementNS(j,G||H),W=X.length;N(this,Q),this.currentElement=Q,this.locator&&A(this.locator,Q);for(var oe=0;oe<W;oe++){var j=X.getURI(oe),se=X.getValue(oe),G=X.getQName(oe),he=ae.createAttributeNS(j,G);this.locator&&A(X.getLocator(oe),he),he.value=he.nodeValue=se,Q.setAttributeNode(he)}},endElement:function(j,H,G){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(j,H){},endPrefixMapping:function(j){},processingInstruction:function(j,H){var G=this.doc.createProcessingInstruction(j,H);this.locator&&A(this.locator,G),N(this,G)},ignorableWhitespace:function(j,H,G){},characters:function(j,H,G){if(j=F.apply(this,arguments),j){if(this.cdata)var X=this.doc.createCDATASection(j);else var X=this.doc.createTextNode(j);this.currentElement?this.currentElement.appendChild(X):/^\s*$/.test(j)&&this.doc.appendChild(X),this.locator&&A(this.locator,X)}},skippedEntity:function(j){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(j){j&&(j.lineNumber=0),this.locator=j},comment:function(j,H,G){j=F.apply(this,arguments);var X=this.doc.createComment(j);this.locator&&A(this.locator,X),N(this,X)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(j,H,G,X){var ae=this.doc.implementation;if(ae&&ae.createDocumentType){var Q=ae.createDocumentType(j,H,G,X);this.locator&&A(this.locator,Q),N(this,Q),this.doc.doctype=Q}},reportError:function(j,H){if(typeof this.onError=="function")try{this.onError(j,H,this)}catch(G){throw new m("Reporting "+j+' "'+H+'" caused '+G,this.locator)}else console.error("[xmldom "+j+"]	"+H,M(this.locator))},warning:function(j){this.reportError("warning",j)},error:function(j){this.reportError("error",j)},fatalError:function(j){throw this.reportError("fatalError",j),new m(j,this.locator)}};function M(j){if(j)return`
@#[line:`+j.lineNumber+",col:"+j.columnNumber+"]"}function F(j,H,G){return typeof j=="string"?j.substr(H,G):j.length>=H+G||H?new java.lang.String(j,H,G)+"":j}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(j){T.prototype[j]=function(){return null}});function N(j,H){j.currentElement?j.currentElement.appendChild(H):j.doc.appendChild(H)}function O(j){if(j==="error")throw"onErrorStopParsing"}function U(){throw"onWarningStopParsing"}return fm.__DOMHandler=T,fm.DOMParser=E,fm.normalizeLineEndings=x,fm.onErrorStopParsing=O,fm.onWarningStopParsing=U,fm}var Cq;function Fke(){if(Cq)return ma;Cq=1;var t=C_();ma.assign=t.assign,ma.hasDefaultHTMLNamespace=t.hasDefaultHTMLNamespace,ma.isHTMLMimeType=t.isHTMLMimeType,ma.isValidMimeType=t.isValidMimeType,ma.MIME_TYPE=t.MIME_TYPE,ma.NAMESPACE=t.NAMESPACE;var e=D3();ma.DOMException=e.DOMException,ma.DOMExceptionName=e.DOMExceptionName,ma.ExceptionCode=e.ExceptionCode,ma.ParseError=e.ParseError;var r=ree();ma.Attr=r.Attr,ma.CDATASection=r.CDATASection,ma.CharacterData=r.CharacterData,ma.Comment=r.Comment,ma.Document=r.Document,ma.DocumentFragment=r.DocumentFragment,ma.DocumentType=r.DocumentType,ma.DOMImplementation=r.DOMImplementation,ma.Element=r.Element,ma.Entity=r.Entity,ma.EntityReference=r.EntityReference,ma.LiveNodeList=r.LiveNodeList,ma.NamedNodeMap=r.NamedNodeMap,ma.Node=r.Node,ma.NodeList=r.NodeList,ma.Notation=r.Notation,ma.ProcessingInstruction=r.ProcessingInstruction,ma.Text=r.Text,ma.XMLSerializer=r.XMLSerializer;var n=Lke();return ma.DOMParser=n.DOMParser,ma.normalizeLineEndings=n.normalizeLineEndings,ma.onErrorStopParsing=n.onErrorStopParsing,ma.onWarningStopParsing=n.onWarningStopParsing,ma}var Bke=Fke();const nee=(function(){const t=/\s*/g,e=/^\s*|\s*$/g,r=/\s+/;function n(O){if(!O||!O.length)return 0;for(var U=0,j=0;U<O.length;U++)j=(j<<5)-j+O.charCodeAt(U)|0;return j}function i(O,U){return O.getElementsByTagName(U)}function a(O,U){return O.getAttribute(U)}function s(O,U){return parseFloat(a(O,U))}function o(O,U){const j=i(O,U);return j.length?j[0]:null}function c(O){return O.normalize&&O.normalize(),O}function h(O){for(var U=0,j=[];U<O.length;U++)j[U]=parseFloat(O[U]);return j}function d(O){return O&&c(O),O&&O.textContent||""}function m(O,U){let j={},H,G;for(G=0;G<U.length;G++)H=o(O,U[G]),H&&(j[U[G]]=d(H));return j}function b(O,U){for(const j in U)O[j]=U[j]}function x(O){return h(O.replace(t,"").split(","))}function E(O){const U=O.replace(e,"").split(r),j=[];for(let H=0;H<U.length;H++)j.push(x(U[H]));return j}function T(O){let U=[s(O,"lon"),s(O,"lat")],j=o(O,"ele"),H=o(O,"gpxtpx:hr")||o(O,"hr"),G=o(O,"time"),X;return j&&(X=parseFloat(d(j)),isNaN(X)||U.push(X)),{coordinates:U,time:G?d(G):null,heartRate:H?parseFloat(d(H)):null}}function A(){return{type:"FeatureCollection",features:[]}}let M;if(typeof XMLSerializer<"u")M=new XMLSerializer;else{const O=typeof process=="object"&&!process.browser,U=typeof Titanium=="object";if(typeof exports=="object"&&(O||U))M=Bke.XMLSerializer;else throw new Error("Unable to initialize serializer")}function F(O){return O.xml!==void 0?O.xml:M.serializeToString(O)}return{kml:function(O){const U=A(),j={},H={},G={},X=["Polygon","LineString","Point","Track","gx:Track"],ae=i(O,"Placemark"),Q=i(O,"Style"),W=i(O,"StyleMap");for(let me=0;me<Q.length;me++){const xe=n(F(Q[me])).toString(16);j["#"+a(Q[me],"id")]=xe,H[xe]=Q[me]}for(let me=0;me<W.length;me++){j["#"+a(W[me],"id")]=n(F(W[me])).toString(16);const xe=i(W[me],"Pair"),Ae={};for(let De=0;De<xe.length;De++)Ae[d(o(xe[De],"key"))]=d(o(xe[De],"styleUrl"));G["#"+a(W[me],"id")]=Ae}for(let me=0;me<ae.length;me++)U.features=U.features.concat(Ce(ae[me]));function oe(me){let xe,Ae;return me=me||"",me.substr(0,1)==="#"&&(me=me.substr(1)),(me.length===6||me.length===3)&&(xe=me),me.length===8&&(Ae=parseInt(me.substr(0,2),16)/255,xe="#"+me.substr(6,2)+me.substr(4,2)+me.substr(2,2)),[xe,isNaN(Ae)?void 0:Ae]}function se(me){return h(me.split(" "))}function he(me){let xe=i(me,"coord"),Ae=[],De=[];xe.length===0&&(xe=i(me,"gx:coord"));for(let Ee=0;Ee<xe.length;Ee++)Ae.push(se(d(xe[Ee])));const de=i(me,"when");for(let Ee=0;Ee<de.length;Ee++)De.push(d(de[Ee]));return{coords:Ae,times:De}}function _e(me){let xe,Ae,De,de,Ee,we=[],Le=[];if(o(me,"MultiGeometry"))return _e(o(me,"MultiGeometry"));if(o(me,"MultiTrack"))return _e(o(me,"MultiTrack"));if(o(me,"gx:MultiTrack"))return _e(o(me,"gx:MultiTrack"));for(De=0;De<X.length;De++)if(Ae=i(me,X[De]),Ae){for(de=0;de<Ae.length;de++)if(xe=Ae[de],X[De]==="Point")we.push({type:"Point",coordinates:x(d(o(xe,"coordinates")))});else if(X[De]==="LineString")we.push({type:"LineString",coordinates:E(d(o(xe,"coordinates")))});else if(X[De]==="Polygon"){const Fe=i(xe,"LinearRing"),Xe=[];for(Ee=0;Ee<Fe.length;Ee++)Xe.push(E(d(o(Fe[Ee],"coordinates"))));we.push({type:"Polygon",coordinates:Xe})}else if(X[De]==="Track"||X[De]==="gx:Track"){const Fe=he(xe);we.push({type:"LineString",coordinates:Fe.coords}),Fe.times.length&&Le.push(Fe.times)}}return{geoms:we,coordTimes:Le}}function Ce(me){let xe=_e(me),Ae,De={},de=d(o(me,"name")),Ee=d(o(me,"address")),we=d(o(me,"styleUrl")),Le=d(o(me,"description")),Fe=o(me,"TimeSpan"),Xe=o(me,"TimeStamp"),Be=o(me,"ExtendedData"),ot=o(me,"LineStyle"),Qe=o(me,"PolyStyle"),rt=o(me,"visibility");if(!xe.geoms.length)return[];if(de&&(De.name=de),Ee&&(De.address=Ee),we){we[0]!=="#"&&(we="#"+we),De.styleUrl=we,j[we]&&(De.styleHash=j[we]),G[we]&&(De.styleMapHash=G[we],De.styleHash=j[G[we].normal]);const zt=H[De.styleHash];if(zt){ot||(ot=o(zt,"LineStyle")),Qe||(Qe=o(zt,"PolyStyle"));const st=o(zt,"IconStyle");if(st){const $e=o(st,"Icon");if($e){const Jt=d(o($e,"href"));Jt&&(De.icon=Jt)}}}}if(Le&&(De.description=Le),Fe){const zt=d(o(Fe,"begin")),st=d(o(Fe,"end"));De.timespan={begin:zt,end:st}}if(Xe&&(De.timestamp=d(o(Xe,"when"))),ot){const zt=oe(d(o(ot,"color"))),st=zt[0],$e=zt[1],Jt=parseFloat(d(o(ot,"width")));st&&(De.stroke=st),isNaN($e)||(De["stroke-opacity"]=$e),isNaN(Jt)||(De["stroke-width"]=Jt)}if(Qe){const zt=oe(d(o(Qe,"color"))),st=zt[0],$e=zt[1],Jt=d(o(Qe,"fill")),Ht=d(o(Qe,"outline"));st&&(De.fill=st),isNaN($e)||(De["fill-opacity"]=$e),Jt&&(De["fill-opacity"]=Jt==="1"?De["fill-opacity"]||1:0),Ht&&(De["stroke-opacity"]=Ht==="1"?De["stroke-opacity"]||1:0)}if(Be){const zt=i(Be,"Data"),st=i(Be,"SimpleData");for(Ae=0;Ae<zt.length;Ae++)De[zt[Ae].getAttribute("name")]=d(o(zt[Ae],"value"));for(Ae=0;Ae<st.length;Ae++)De[st[Ae].getAttribute("name")]=d(st[Ae])}rt&&(De.visibility=d(rt)),xe.coordTimes.length&&(De.coordTimes=xe.coordTimes.length===1?xe.coordTimes[0]:xe.coordTimes);const Re={type:"Feature",geometry:xe.geoms.length===1?xe.geoms[0]:{type:"GeometryCollection",geometries:xe.geoms},properties:De};return a(me,"id")&&(Re.id=a(me,"id")),[Re]}return U},gpx:function(O){let U,j=i(O,"trk"),H=i(O,"rte"),G=i(O,"wpt"),X=A(),ae;for(U=0;U<j.length;U++)ae=oe(j[U]),ae&&X.features.push(ae);for(U=0;U<H.length;U++)ae=se(H[U]),ae&&X.features.push(ae);for(U=0;U<G.length;U++)X.features.push(he(G[U]));function Q(me,xe){for(let Ae=0;Ae<xe;Ae++)me.push(null);return me}function W(me,xe){const Ae=i(me,xe),De=[],de=[],Ee=[],we=Ae.length;if(we<2)return{};for(let Le=0;Le<we;Le++){const Fe=T(Ae[Le]);De.push(Fe.coordinates),Fe.time&&de.push(Fe.time),(Fe.heartRate||Ee.length)&&(Ee.length||Q(Ee,Le),Ee.push(Fe.heartRate||null))}return{line:De,times:de,heartRates:Ee}}function oe(me){let xe=i(me,"trkseg"),Ae=[],De=[],de=[],Ee;for(let Le=0;Le<xe.length;Le++)if(Ee=W(xe[Le],"trkpt"),Ee&&(Ee.line&&Ae.push(Ee.line),Ee.times&&Ee.times.length&&De.push(Ee.times),de.length||Ee.heartRates&&Ee.heartRates.length)){if(!de.length)for(let Fe=0;Fe<Le;Fe++)de.push(Q([],Ae[Fe].length));Ee.heartRates&&Ee.heartRates.length?de.push(Ee.heartRates):de.push(Q([],Ee.line.length||0))}if(Ae.length===0)return;const we=Ce(me);return b(we,_e(o(me,"extensions"))),De.length&&(we.coordTimes=Ae.length===1?De[0]:De),de.length&&(we.heartRates=Ae.length===1?de[0]:de),{type:"Feature",properties:we,geometry:{type:Ae.length===1?"LineString":"MultiLineString",coordinates:Ae.length===1?Ae[0]:Ae}}}function se(me){const xe=W(me,"rtept");if(!xe.line)return;const Ae=Ce(me);return b(Ae,_e(o(me,"extensions"))),{type:"Feature",properties:Ae,geometry:{type:"LineString",coordinates:xe.line}}}function he(me){const xe=Ce(me);return b(xe,m(me,["sym"])),{type:"Feature",properties:xe,geometry:{type:"Point",coordinates:T(me).coordinates}}}function _e(me){const xe={};if(me){const Ae=o(me,"line");if(Ae){const De=d(o(Ae,"color")),de=parseFloat(d(o(Ae,"opacity"))),Ee=parseFloat(d(o(Ae,"width")));De&&(xe.stroke=De),isNaN(de)||(xe["stroke-opacity"]=de),isNaN(Ee)||(xe["stroke-width"]=Ee*96/25.4)}}return xe}function Ce(me){const xe=m(me,["name","cmt","desc","type","time","keywords"]),Ae=i(me,"link");Ae.length&&(xe.links=[]);for(let De=0,de;De<Ae.length;De++)de={href:a(Ae[De],"href")},b(de,m(Ae[De],["text","type"])),xe.links.push(de);return xe}return X}}})(),LE=t=>{const[e,r]=te.useState(),[n,i]=te.useState([]),a=s=>{try{i([]);const c=new DOMParser().parseFromString(s,"application/xml");c.querySelector("metadata")?.childNodes.forEach(m=>{let b=m.textContent;const x=m.nodeName;if(m.nodeName==="link"&&(b=m.getAttribute("href")??""),b?.trim().length){const E={title:x,value:b,id:new Date().getTime()};i(T=>[...T,E])}});const d=nee.gpx(c);r(d)}catch(o){console.log(o)}};return te.useEffect(()=>{t.data&&a(t.data)},[t.data]),{geojson:e,metadata:n}};LE.defaultProps={data:void 0};try{LE.displayName="useGpx",LE.__docgenInfo={description:"useGpx hook converts GPX data to GeoJSON",displayName:"useGpx",props:{data:{defaultValue:{value:"undefined"},description:"a string containing GPX data that is supposed to be parsed and converted to GeoJSON by this hook",name:"data",required:!1,type:{name:"string | undefined"}}}}}catch{}const FE=t=>{const e=va({mapId:t.mapId,waitForLayer:t.layerId}),r=te.useRef(new CT.Popup({closeButton:!1,closeOnClick:!0}));return te.useEffect(()=>{!e.map||!t.layerId||e.map.on("mouseenter",t.layerId,n=>{if(!e.map)return;const i=n?.features?.[0].geometry.coordinates.slice();let a="";if(n?.features?.[0]&&typeof t.getPopupContent=="function"&&(a=t.getPopupContent(n.features[0])),i?.[0]){for(;Math.abs(n.lngLat.lng-i[0])>180;)i[0]+=n.lngLat.lng>i[0]?360:-360;r.current.setLngLat(i).setHTML(a).addTo(e.map.map)}},e.componentId)},[e.map]),J.jsx(J.Fragment,{})};FE.defaultProps={mapId:void 0};try{FE.displayName="LayerHoverPopup",FE.__docgenInfo={description:"useLayerHoverPopup hook registers a mouseenter event to display feature properties in a MapLibre popup if a feature on the configured layer is hovered",displayName:"LayerHoverPopup",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of an existing layer in the mapLibre instance this event will be registered to",name:"layerId",required:!1,type:{name:"string | undefined"}},getPopupContent:{defaultValue:null,description:"",name:"getPopupContent",required:!0,type:{name:"(feature: Feature<Geometry, GeoJsonProperties>) => string"}}}}}catch{}const Aq=t=>{const e=LE({data:t.gpxData}),r=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),n=te.useRef("gpx-viewer-source-"+vc()),i=te.useRef("importer-layer-lines-"+vc()),a=te.useRef("importer-layer-points-"+vc());return FE({layerId:a.current,getPopupContent:s=>s?.properties?.name}),sN({mapId:t.mapId,sourceId:n.current,source:{type:"geojson",data:e.geojson||Ep([])}}),Tp({layerId:i.current,options:{type:"line",paint:{"line-width":4,"line-color":"rgba(212, 55, 23,0.5)"},source:n.current},insertBeforeLayer:t.insertBeforeLayer}),Tp({layerId:a.current,options:{type:"circle",paint:{"circle-color":"rgba(72, 77, 99,0.5)","circle-radius":7},filter:["==","$type","Point"],source:n.current},insertBeforeLayer:t.insertBeforeLayer}),te.useEffect(()=>{if(!r.map||!e.geojson)return;typeof t.onParseGpxData=="function"&&t.onParseGpxData(e);const s=dh(e.geojson);r.map.map.fitBounds(s)},[e]),J.jsx(J.Fragment,{})};try{Aq.displayName="MlGpxViewer",Aq.__docgenInfo={description:"MlGpxViewer visualizes a given GPX Track on the map",displayName:"MlGpxViewer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapHook",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},idPrefix:{defaultValue:null,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance",name:"idPrefix",required:!1,type:{name:"string | undefined"}},gpxData:{defaultValue:null,description:"",name:"gpxData",required:!0,type:{name:"string | undefined"}},onParseGpxData:{defaultValue:null,description:"",name:"onParseGpxData",required:!0,type:{name:"(arg0: { geojson: FeatureCollection<Geometry, GeoJsonProperties> | undefined; metadata: MetadataType[]; }) => void"}}}}}catch{}const zke=gt.createContext({}),jke=zke.Provider,Iq=({children:t})=>{const[e,r]=te.useState({type:"FeatureCollection",features:[]}),i={data:e,setData:r,getEmptyFeatureCollection:()=>({type:"FeatureCollection",features:[]})};return J.jsx(jke,{value:i,children:t})};try{Iq.displayName="GeoJsonProvider",Iq.__docgenInfo={description:"",displayName:"GeoJsonProvider",props:{}}}catch{}const uM=()=>{const t=Object.fromEntries(new URLSearchParams(window.location.search));return t.layers=JSON.parse(t?.layers?t.layers:"[]"),t},hP=uM(),Pq=t=>{const e=te.useContext(Ng),r=te.useRef(!1),n=te.useRef(null),[i,a]=te.useState(void 0),s=te.useRef({}),o=te.useRef((t.idPrefix?t.idPrefix:"MlShareMapState-")+vc()),c=qT({watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!1}}),h=te.useRef(!1),d=te.useRef(null),m=te.useRef({viewport:{center:!1,bearing:!1,pitch:!1,zoom:!1},layers:{...s}}),b=te.useRef({}),x=te.useCallback(()=>{if(!t.active)return;const A=[];for(const N in c.layers)A.push({id:c.layers[N]?.id,type:c.layers[N]?.type,visible:c.layers[N]?.visible});E();const M=new URLSearchParams({...uM(),...b.current,layers:JSON.stringify(A)});JSON.parse(Object.fromEntries(M).layers).forEach(N=>{s.current[N.id]=!1});const F=new URLSearchParams(window.location.search);M.toString()!==F.toString()&&window.history.pushState({...b.current},document.title,"?"+M.toString())},[c.layers,t.active]);te.useEffect(()=>{const A=o.current;return b.current=uM(),()=>{n.current&&(n.current.cleanup(A),n.current=null),r.current=!1}},[]),te.useEffect(()=>{n.current&&x()},[x]),te.useEffect(()=>{if(!n.current)return;const A=x;return n.current.on("moveend",A,o.current),()=>{n.current?.map.off("moveend",A)}},[x,i]),te.useEffect(()=>{!e?.mapExists?.(t.mapId)||r.current||(r.current=!0,n.current=e.getMap(t.mapId),a(n.current),b.current.lat&&b.current.lng&&T())},[e.mapIds,e,t.mapId,t.active]),te.useEffect(()=>{if(c?.layers?.length){typeof d.current>"u"&&(d.current=null,hP?.layers?.forEach(A=>{d.current?.[A.id]&&(d.current[A.id]=!1)}));for(const A in d.current){let M=!0;if(d.current[A]===!1&&(M=!1),M)return}hP.layers&&hP.layers.forEach(A=>{n.current?.map.getLayer(A.id)&&d.current?.[A.id]===!1&&(d.current[A.id]=!0,n.current.map?.getLayer(A.id)?.setLayoutProperty("visibility",A.visible?"visible":"none"))})}},[c.layers,t.mapId,t.active]),te.useEffect(()=>{i&&c.layers&&(t.active||i.cleanup(o.current))},[t.active,i,c.layers]);const E=()=>{b.current.lat=n.current?.map.getCenter().lat,b.current.lng=n.current?.map.getCenter().lng,b.current.zoom=n.current?.map.getZoom(),b.current.bearing=n.current?.map.getBearing(),b.current.pitch=n.current?.map.getPitch()},T=()=>{m.current.viewport.center||(m.current.viewport.center=!0,b.current.lng&&b.current.lat&&n.current?.map.setCenter([b.current.lng,b.current.lat]),b.current.zoom&&n.current?.map.setZoom(b.current.zoom),b.current.bearing&&n.current?.map.setBearing(b.current.bearing),b.current.pitch&&n.current?.map.setPitch(b.current.pitch)),h.current=!0};return window.onpopstate=A=>{A.state&&A.state.lng&&A.state.lat&&A.state.zoom&&n.current?.map.easeTo({zoom:A.state.zoom,center:[A.state.lng,A.state.lat]})},J.jsx(J.Fragment,{})};try{Pq.displayName="MlShareMapState",Pq.__docgenInfo={description:"",displayName:"MlShareMapState",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},idPrefix:{defaultValue:null,description:"",name:"idPrefix",required:!1,type:{name:"string | undefined"}},active:{defaultValue:null,description:"",name:"active",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function Uke(t,e){const r=(s,o,c,h,d)=>{const m=Su([[s,o],[h,d]]),b=eSe(m,5,{units:"meters"}),x=b.geometry.coordinates[0][0],E=b.geometry.coordinates[0][1],T=b.geometry.coordinates[1][0],A=b.geometry.coordinates[1][1];return h3([[[s,o],[h,d],[T,A],[x,E],[s,o]]],{height:c*e})},n=(s,o,c)=>s*(1-c)+o*c,i=[];return t.line.geometry.coordinates.forEach((s,o)=>{if(t.line.geometry.coordinates[o+1]&&Array.isArray(s)){let h=~~(f3([s[0],s[1]],[t.line.geometry.coordinates[o+1][0],t.line.geometry.coordinates[o+1][1]],{units:"kilometers"})*1e3/10);h=h<1?1:h;for(let d=0;d<h;d++){const m=n(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],d/h),b=n(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],d/h),x=n(t.line.geometry.coordinates[o][2]-t.min,t.line.geometry.coordinates[o+1][2]-t.min,d/h),E=n(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],(d+1)/h),T=n(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],(d+1)/h),A=r(m,b,x,E,T);i.push(A)}}}),Ep(i)}const kq=["interpolate",["linear"],["get","height"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"yellow"],Rq=t=>{const e=te.useRef("elevationprofile-"+vc()),r=te.useRef("elevationprofile-layer-"+vc()),n=t.elevationFactor||1,i=te.useMemo(()=>{if(!t?.geojson?.features)return;const o=t.geojson.features?.find(m=>m.geometry.type==="LineString");if(!o||!o.geometry)return;const c=o.geometry.coordinates.map(m=>m[2]),h=Math.min(...c);let d=Math.max(...c)-h;return d=d===0?1:d,{max:d,min:h,line:o}},[t.geojson]),a=te.useMemo(()=>i?["interpolate",["linear"],["get","height"],0,"rgb(0,255,55)",i.max*n,"rgb(255,0,0)"]:kq,[i,t.elevationFactor]),s=te.useMemo(()=>!t.geojson?.features||!i?void 0:Uke(i,n),[i,n]);return sN({mapId:t.mapId,sourceId:e.current,source:{type:"geojson",data:s||Ep([])}}),Tp({layerId:r.current,options:{source:e.current,type:"fill-extrusion",paint:{"fill-extrusion-height":["get","height"],"fill-extrusion-opacity":.9,"fill-extrusion-color":a||kq}},insertBeforeLayer:t.insertBeforeLayer}),J.jsx(J.Fragment,{})};try{Rq.displayName="MlSpatialElevationProfile",Rq.__docgenInfo={description:"",displayName:"MlSpatialElevationProfile",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties> | geojson | undefined"}},idPrefix:{defaultValue:null,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance",name:"idPrefix",required:!1,type:{name:"string | undefined"}},elevationFactor:{defaultValue:null,description:"Number describes the factor of the height of the elevation",name:"elevationFactor",required:!1,type:{name:"number | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const P0=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=te.useRef(t.layerId||"MlVectorTileLayer-"+e.componentId),n=te.useRef({}),i=te.useRef({}),a=te.useRef(!1),s=te.useCallback(()=>{e.map&&(a.current=!0,e.map.map.getSource(r.current)&&e.cleanup(),e.map.map.getSource(r.current)||e.map.addSource(r.current,{type:"vector",tiles:[t.url||""],attribution:"",minzoom:0,maxzoom:14,...t.sourceOptions},e.componentId),t.layers.forEach(c=>{e.map&&(e.map.addLayer({source:r.current,minzoom:0,maxzoom:22,layout:{},paint:{"line-opacity":.5,"line-color":"rgb(80, 80, 80)","line-width":2},...c},t.insertBeforeLayer,e.componentId),n.current[c.id]=JSON.stringify(c.paint),i.current[c.id]=JSON.stringify(c.layout),e.map.on("styledata",()=>{a.current&&!e.map?.map.getSource(r.current)&&(console.log("Recreate Layer "+r.current),s())},e.componentId))}))},[e.map,t]),o=te.useCallback(()=>{a.current&&t.layers.forEach(c=>{if(e.map&&e.map.map.getLayer(c.id)){const h=JSON.stringify(c.paint);if(h!==n.current[c.id])for(const m in c.paint)e.map.setPaintProperty(c.id,m,c.paint[m]);n.current[c.id]=h;const d=JSON.stringify(c.layout);if(d!==i.current[c.id])for(const m in c.layout)e.map.setLayoutProperty(c.id,m,c.layout[m]);i.current[c.id]=d}})},[e.map,t.layers]);return te.useEffect(()=>{a.current||s()},[s]),te.useEffect(()=>{!e.map||!a.current||s()},[t.layers.length,e.map]),te.useEffect(()=>{!e.map||!a.current||o()},[t.layers,e.map]),J.jsx(J.Fragment,{})};try{P0.displayName="MlVectorTileLayer",P0.__docgenInfo={description:`Adds a vector-tile source and 0...n vector-tile-layers to the MapLibre instance referenced by
props.mapId`,displayName:"MlVectorTileLayer",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"",name:"sourceOptions",required:!1,type:{name:"VectorSourceSpecification | undefined"}},url:{defaultValue:null,description:"",name:"url",required:!1,type:{name:"string | undefined"}},layers:{defaultValue:null,description:"",name:"layers",required:!0,type:{name:"ExtendedLayerSpecification[]"}}}}}catch{}const Mq=t=>{const[e,r]=te.useState(),n=va({mapId:t.mapId}),i=te.useRef(t.mlGeoJsonLayerProps?.layerId||"MlOgcApiFeature-"+n.componentId),a=()=>{const s=new URL(t.ogcApiUrl);if(t.ogcApiFeatureParams&&Object.entries(t.ogcApiFeatureParams).forEach(([o,c])=>{c!=null&&s.searchParams.append(o,c.toString())}),t.reloadFeaturesOnMapMove){const o=n?.map?.getBounds().getSouthWest(),c=n?.map?.getBounds().getNorthEast(),h=`${o?.lng},${o?.lat},${c?.lng},${c?.lat}`;s.searchParams.append("bbox",h)}return s.toString()};return te.useEffect(()=>{if(!n.map)return;const s=()=>{const o=a();fetch(o).then(c=>{if(!c.ok)throw new Error("Error fetching OGC features");return c.json()}).then(c=>{r(c)}).catch(c=>{console.log(c),r(void 0)})};return s(),t.reloadFeaturesOnMapMove&&n.map.on("moveend",s),()=>{n?.map?.off&&n.map.off("moveend",s)}},[n.map,t.ogcApiFeatureParams,t.ogcApiUrl]),te.useEffect(()=>{!n.map||!n.map.map.style.getLayer(i.current)||(t.visible?n.map.map.setLayoutProperty(i.current,"visibility","visible"):n.map.map.setLayoutProperty(i.current,"visibility","none"))},[t.visible,n.map]),J.jsx(J.Fragment,{children:e&&J.jsx(Dc,{geojson:e,layerId:i.current,...t.mlGeoJsonLayerProps})})};try{Mq.displayName="MlOgcApiFeatures",Mq.__docgenInfo={description:"",displayName:"MlOgcApiFeatures",props:{visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},ogcApiUrl:{defaultValue:null,description:"The url of OGC API",name:"ogcApiUrl",required:!0,type:{name:"URL"}},ogcApiFeatureParams:{defaultValue:null,description:"The additional query parameters of OGC API",name:"ogcApiFeatureParams",required:!1,type:{name:"OgcApiFeaturesParamsTypes | undefined"}},reloadFeaturesOnMapMove:{defaultValue:null,description:"Fetches the features everytime (based on the current bbox) when the map gets moved",name:"reloadFeaturesOnMapMove",required:!1,type:{name:"boolean | undefined"}},mlGeoJsonLayerProps:{defaultValue:null,description:"Geojson Layer props. But omit 'geojson' because it gets set from the OGC API Feature call",name:"mlGeoJsonLayerProps",required:!1,type:{name:'Omit<MlGeoJsonLayerProps, "geojson"> | undefined'}}}}}catch{}const Dq=t=>{const e=te.useContext(Ng),r=te.useRef(!1),n=te.useRef(void 0),i=te.useRef("MlWmsFeatureInfoPopup-"+vc());return te.useEffect(()=>{const a=i.current;return()=>{n.current&&(n.current.cleanup(a),n.current=void 0),r.current=!1}},[]),te.useEffect(()=>{!e.mapExists(t.mapId)||r.current||(r.current=!0,n.current=e.getMap(t.mapId),n.current.setCenter([7.132122000552613,50.716405378037706]))},[e.mapIds,e,t.mapId]),J.jsx(J.Fragment,{})};try{Dq.displayName="MlWmsFeatureInfoPopup",Dq.__docgenInfo={description:"TODO: Add short & useful description",displayName:"MlWmsFeatureInfoPopup",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}function cd(t,e){if(!t)return{};const r=t instanceof URLSearchParams?Array.from(t.entries()):Object.entries(t),n=e?r.filter(([i,a])=>e(i,a)):r;return Object.fromEntries(n.map(([i,a])=>[i.toUpperCase(),a]))}const Vke={urlParameters:{bbox:"{bbox-epsg-3857}",format:"image/png",service:"WMS",version:"1.1.1",request:"GetMap",srs:"EPSG:3857",crs:"EPSG:3857",width:"256",height:"256",Transparent:"true",styles:""}},BE=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=te.useRef(!1),n=te.useRef(t.layerId||"MlWmsLayer-"+e.componentId),i=te.useMemo(()=>{let s,o=t.url;t.url.indexOf("?")!==-1&&(s=t.url.split("?"),o=s[0]);const c=new URLSearchParams(s?.[1]),h={...cd(Vke.urlParameters),...cd(c),...cd(t.urlParameters)},d=new URLSearchParams(h),m=decodeURIComponent(d.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");return o+"?"+m},[t.urlParameters,t.url]),a=te.useCallback(()=>{e.map&&(r.current=!0,e.map.map.getLayer(n.current)&&e.cleanup(),e.map.addSource(n.current,{type:"raster",tiles:[i],tileSize:256,attribution:t.attribution??"",...t.sourceOptions},e.componentId),e.map.addLayer({id:n.current,type:"raster",source:n.current,...t.layerOptions},t.insertBeforeLayer,e.componentId),e.map.on("styledata",()=>{r.current&&!e.map?.map.getLayer(n.current)&&(console.log("Recreate Layer "+n.current),a())},e.componentId),t.visible===!1&&e.map.map.setLayoutProperty(n.current,"visibility","none"))},[e.map,t,i]);return te.useEffect(()=>{r.current&&e?.map?.map?.getSource?.(n.current)?.tiles?.[0]===i||a()},[a]),te.useEffect(()=>{!e.map||!r.current||(t.visible===void 0||t.visible?e.map.map.setLayoutProperty(n.current,"visibility","visible"):e.map.map.setLayoutProperty(n.current,"visibility","none"))},[t.visible,e.map]),J.jsx(J.Fragment,{})};try{BE.displayName="MlWmsLayer",BE.__docgenInfo={description:"Adds a WMS raster source & layer to the maplibre-gl instance",displayName:"MlWmsLayer",props:{urlParameters:{defaultValue:null,description:"",name:"urlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},attribution:{defaultValue:null,description:"",name:"attribution",required:!1,type:{name:"string | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"",name:"sourceOptions",required:!1,type:{name:"RasterSourceSpecification | undefined"}},layerOptions:{defaultValue:null,description:"",name:"layerOptions",required:!1,type:{name:"RasterLayerSpecification | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}}}}}catch{}/**
 * wms-capabilities @0.6.0
 * @description WMS service Capabilities > JSON, based on openlayers 
 * @license BSD-2-Clause
 * @preserve
 */var ha=t=>t!==void 0,iee=(t,e,r)=>e in t?t[e]:t[e]=r;const ax={ELEMENT:1,TEXT:3,CDATA_SECTION:4};class $ke{constructor(e){this._parser=new e}toDocument(e){return this._parser.parseFromString(e,"application/xml")}getAllTextContent(e,r){return O3(e,r).join("")}}function O3(t,e){return aee(t,e,[]).join("")}function aee(t,e,r){if(t.nodeType===ax.CDATA_SECTION||t.nodeType===ax.TEXT)e?r.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):r.push(t.nodeValue);else{var n;for(n=t.firstChild;n;n=n.nextSibling)aee(n,e,r)}return r}function qke(t,e,r,n){for(var i=Hke(e);i;i=Wke(i)){var a=i.namespaceURI||null,s=t[a];if(ha(s)){var o=s[i.localName];ha(o)&&o.call(n,i,r)}}}function Hke(t){let e=t.firstElementChild||t.firstChild;for(;e&&e.nodeType!==ax.ELEMENT;)e=e.nextSibling;return e}function Wke(t){let e=t.nextElementSibling||t.nextSibling;for(;e&&e.nodeType!==ax.ELEMENT;)e=e.nextSibling;return e}function Cu(t,e,r){return Gke(t,e,r)}function Gke(t,e,r){var n=ha(r)?r:{},i,a;for(i=0,a=t.length;i<a;++i)n[t[i]]=e;return n}function oee(t,e){return(function(r,n){var i=t.call(ha(e)?e:this,r,n);if(ha(i)){var a=n[n.length-1];a.push(i)}})}function lu(t,e,r,n,i){return n.push(t),qke(e,r,n,i),n.pop()}function si(t,e,r){return(function(n,i){let a=t.call(ha(r)?r:this,n,i);if(ha(a)){var s=i[i.length-1],o=ha(e)?e:n.localName;s[o]=a}})}function Cc(t,e,r){return(function(n,i){var a=t.call(ha(r)?r:this,n,i);if(ha(a)){var s=i[i.length-1],o=ha(e)?e:n.localName,c=iee(s,o,[]);c.push(a)}})}const Xke=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function Yke(t){return t.replace(Xke,"")}function jm(t){const e=/^\s*(true|1)|(false|0)\s*$/.exec(t);if(e)return ha(e[1])||!1}function f0(t){return pp(O3(t,!1))}function pp(t){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e)return parseFloat(e[1])}function fP(t){return zE(O3(t,!1))}function zE(t){const e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}function Na(t){return Yke(O3(t,!1))}const Zke="http://www.w3.org/1999/xlink";function sL(t){return t.getAttributeNS(Zke,"href")}function Kke(t,e){return lu({},ERe,t,e)}function see(t){return[pp(t.getAttribute("minx")),pp(t.getAttribute("miny")),pp(t.getAttribute("maxx")),pp(t.getAttribute("maxy"))]}function Jke(t,e){const r=see(t),n=[pp(t.getAttribute("resx")),pp(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS")||t.getAttribute("SRS"),extent:r,res:n}}function Qke(t,e){const r=see(t);if(!(!ha(r[0])||!ha(r[1])||!ha(r[2])||!ha(r[3])))return r}function eRe(t,e){const r=parseFloat(t.getAttribute("min")),n=parseFloat(t.getAttribute("max"));return{min:r,max:n}}function tRe(t,e){const r=lu({},TRe,t,e);if(!ha(r))return;const n=r.westBoundLongitude,i=r.southBoundLatitude,a=r.eastBoundLongitude,s=r.northBoundLatitude;if(!(!ha(n)||!ha(i)||!ha(a)||!ha(s)))return[n,i,a,s]}function rRe(t,e){return lu({},vRe,t,e)}function nRe(t,e){return lu({},_Re,t,e)}function iRe(t,e){return lu({},bRe,t,e)}function aRe(t,e){return lu({},xRe,t,e)}function oRe(t,e){return lu({},wRe,t,e)}function sRe(t,e){return lu([],SRe,t,e)}function lRe(t,e){const r=jm(t.getAttribute("queryable"));return lu({queryable:ha(r)?r:!1},cee,t,e)}function uRe(t,e){var r=e[e.length-1];const n=lu({},cee,t,e);if(!ha(n))return;let i=jm(t.getAttribute("queryable"));ha(i)||(i=r.queryable),n.queryable=ha(i)?i:!1;let a=zE(t.getAttribute("cascaded"));ha(a)||(a=r.cascaded),n.cascaded=a;let s=jm(t.getAttribute("opaque"));ha(s)||(s=r.opaque),n.opaque=ha(s)?s:!1;let o=jm(t.getAttribute("noSubsets"));ha(o)||(o=r.noSubsets),n.noSubsets=ha(o)?o:!1;let c=pp(t.getAttribute("fixedWidth"));ha(c)||(c=r.fixedWidth),n.fixedWidth=c;let h=pp(t.getAttribute("fixedHeight"));ha(h)||(h=r.fixedHeight),n.fixedHeight=h;const d=["Style","CRS","AuthorityURL"];for(let b=0,x=d.length;b<x;b++){const E=d[b],T=r[E];if(ha(T)){let A=iee(n,E,[]);A=A.concat(T),n[E]=A}}const m=["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"];for(let b=0,x=m.length;b<x;b++){const E=m[b],T=n[E];if(!ha(T)){const A=r[E];n[E]=A}}return n}function cRe(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:jm(t.getAttribute("multipleValues")),nearestValue:jm(t.getAttribute("nearestValue")),current:jm(t.getAttribute("current")),values:Na(t)}}function Cp(t,e){return lu({},RRe,t,e)}function hRe(t,e){return lu({},CRe,t,e)}function fRe(t,e){return lu({},IRe,t,e)}function dRe(t,e){return lu({},PRe,t,e)}function dP(t,e){return lu({},ARe,t,e)}function lee(t,e){var r=Cp(t,e);if(ha(r)){const n=[zE(t.getAttribute("width")),zE(t.getAttribute("height"))];return r.size=n,r}}function pRe(t,e){var r=Cp(t,e);if(ha(r))return r.name=t.getAttribute("name"),r}function gRe(t,e){var r=Cp(t,e);if(ha(r))return r.type=t.getAttribute("type"),r}function mRe(t,e){return lu({},kRe,t,e)}function uee(t,e){return lu([],MRe,t,e)}const Au=[null,"http://www.opengis.net/wms"],yRe=Cu(Au,{Service:si(nRe),Capability:si(rRe)}),vRe=Cu(Au,{Request:si(hRe),Exception:si(sRe),Layer:si(lRe)}),_Re=Cu(Au,{Name:si(Na),Title:si(Na),Abstract:si(Na),KeywordList:si(uee),OnlineResource:si(sL),ContactInformation:si(iRe),Fees:si(Na),AccessConstraints:si(Na),LayerLimit:si(fP),MaxWidth:si(fP),MaxHeight:si(fP)}),bRe=Cu(Au,{ContactPersonPrimary:si(aRe),ContactPosition:si(Na),ContactAddress:si(oRe),ContactVoiceTelephone:si(Na),ContactFacsimileTelephone:si(Na),ContactElectronicMailAddress:si(Na)}),xRe=Cu(Au,{ContactPerson:si(Na),ContactOrganization:si(Na)}),wRe=Cu(Au,{AddressType:si(Na),Address:si(Na),City:si(Na),StateOrProvince:si(Na),PostCode:si(Na),Country:si(Na)}),SRe=Cu(Au,{Format:oee(Na)}),cee=Cu(Au,{Name:si(Na),Title:si(Na),Abstract:si(Na),KeywordList:si(uee),CRS:Cc(Na),SRS:Cc(Na),EX_GeographicBoundingBox:si(tRe),LatLonBoundingBox:si(Qke),BoundingBox:Cc(Jke),Dimension:Cc(cRe),Attribution:si(Kke),AuthorityURL:Cc(pRe),Identifier:Cc(Na),MetadataURL:Cc(gRe),DataURL:Cc(Cp),FeatureListURL:Cc(Cp),Style:Cc(mRe),MinScaleDenominator:si(f0),MaxScaleDenominator:si(f0),ScaleHint:si(eRe),Layer:Cc(uRe)}),ERe=Cu(Au,{Title:si(Na),OnlineResource:si(sL),LogoURL:si(lee)}),TRe=Cu(Au,{westBoundLongitude:si(f0),eastBoundLongitude:si(f0),southBoundLatitude:si(f0),northBoundLatitude:si(f0)}),CRe=Cu(Au,{GetCapabilities:si(dP),GetMap:si(dP),GetFeatureInfo:si(dP)}),ARe=Cu(Au,{Format:Cc(Na),DCPType:Cc(fRe)}),IRe=Cu(Au,{HTTP:si(dRe)}),PRe=Cu(Au,{Get:si(Cp),Post:si(Cp)}),kRe=Cu(Au,{Name:si(Na),Title:si(Na),Abstract:si(Na),LegendURL:Cc(lee),StyleSheetURL:si(Cp),StyleURL:si(Cp)}),RRe=Cu(Au,{Format:si(Na),OnlineResource:si(sL)}),MRe=Cu(Au,{Keyword:oee(Na)});class DRe{constructor(e,r){!r&&typeof window<"u"&&(r=window.DOMParser),this.version=void 0,this._parser=new $ke(r),this._data=e}data(e){return this._data=e,this}toJSON(e){return e=e||this._data,this.parse(e)}parse(e){return this.readFromDocument(this._parser.toDocument(e))}readFromDocument(e){for(let r=e.firstChild;r;r=r.nextSibling)if(r.nodeType==ax.ELEMENT)return this.readFromNode(r);return null}readFromNode(e){return this.version=e.getAttribute("version"),lu({version:this.version},yRe,e,[])||null}}function hee(t){const[e,r]=te.useState(),[n,i]=te.useState(t.url),[a,s]=te.useState(""),[o,c]=te.useState(),[h,d]=te.useState(),m=()=>{r(void 0),c(void 0),s("")};return te.useEffect(()=>{if(m(),d(void 0),!n)return;let b,x=n;n.indexOf("?")!==-1&&(b=n.split("?"),x=b[0]);const E=new URLSearchParams(b?.[1]),T={...cd(E),...cd(t.urlParameters)},A=Object.fromEntries(Object.entries(T).map(([N,O])=>[N,String(O)])),M=new URLSearchParams(A),F=decodeURIComponent(M.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");fetch(x+"?"+F).then(N=>{if(N.ok)return N.text();throw Error(N.statusText+" ("+N.status+" - "+N.type+")")}).then(N=>{c(new DRe(N,window.DOMParser).toJSON())}).catch(N=>{m(),console.log(N),d(N.message)})},[n,t.urlParameters]),te.useEffect(()=>{o?.Service&&(s(o.Capability?.Request?.GetMap?.DCPType?.[0]?.HTTP?.Get?.OnlineResource),r(o.Capability?.Request?.GetFeatureInfo?.DCPType?.[0]?.HTTP?.Get?.OnlineResource))},[o]),{capabilities:o,getFeatureInfoUrl:e,wmsUrl:a,error:h,setUrl:i}}hee.defaultProps={url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetCapabilities"}};const Oq=Ji(J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"})),Nq=2*Math.PI*6378137/2,Lq=function(t,e={enable:!0,decimal:1}){const r=t.lng,n=t.lat;let i=r*Nq/180,a=Math.log(Math.tan((90+n)*Math.PI/360))/(Math.PI/180);return a=a*Nq/180,e.enable&&(i=Number(i.toFixed(e.decimal)),a=Number(a.toFixed(e.decimal))),[i,a]},pP={mapId:void 0,url:"",baseUrlParameters:{SERVICE:"WMS",VERSION:"1.3.0"},getCapabilitiesUrlParameters:{},getMapUrlParameters:{TRANSPARENT:"TRUE"},getFeatureInfoUrlParameters:{FEATURE_COUNT:"10",STYLES:"",WIDTH:"100",HEIGHT:"100",SRS:"EPSG:3857",CRS:"EPSG:3857",X:"50",Y:"50",I:"50",J:"50"},featureInfoEnabled:!0,featureInfoMarkerEnabled:!0,zoomToExtent:!1,showDeleteButton:!1,showLayerList:!0},cM=t=>{t={...pP,...t};const e=te.useMemo(()=>({...t.baseUrlParameters,...t.getCapabilitiesUrlParameters,REQUEST:"GetCapabilities"}),[t.baseUrlParameters,t.getCapabilitiesUrlParameters]),{capabilities:r,error:n,setUrl:i,getFeatureInfoUrl:a,wmsUrl:s}=hee({urlParameters:e}),[o,c]=te.useState(t?.config?.open||!1),[h,d]=te.useState(t?.config?.visible||!0),[m,b]=te.useState(!1),x=va({mapId:t?.mapId}),[E,T]=te.useState(t?.config?.layers||[]),[A,M]=te.useState(!1),[F,N]=te.useState(),[O,U]=te.useState(void 0);te.useEffect(()=>{t.config||i(t.url)},[t.url]);const j=te.useMemo(()=>t?.config?.wmsUrl||s,[t?.config?.wmsUrl,s]),H=te.useMemo(()=>t?.config?.getFeatureInfoUrl||a,[t?.config?.getFeatureInfoUrl,a]),G=te.useMemo(()=>r,[r]),X=te.useMemo(()=>t?.name||t?.config?.name||G?.Service?.Title,[t?.name,t?.config?.name,G?.Service?.Title]),ae=te.useMemo(()=>t?.setLayers&&t?.config?.layers||E,[t?.config?.layers,E]),Q=te.useMemo(()=>t?.setLayers||T,[t?.setLayers,T]);te.useEffect(()=>{t?.onConfigChange?.({layers:ae,getFeatureInfoUrl:H,wmsUrl:j,visible:h,open:o,name:X})},[ae,G,H,j,h,o,X]);const W=te.useMemo(()=>ae.filter(Ce=>Ce.visible&&Ce?.Attribution?.Title).map(Ce=>Ce?.Attribution?.Title).filter((Ce,me,xe)=>xe.indexOf(Ce)===me).join(" "),[ae]),oe=function(){N(void 0),U(void 0)},se=te.useCallback(Ce=>{if(!x.map)return;oe();const me=x.map.unproject([Ce.point.x,Ce.point.y]),xe=Gh([me.lng,me.lat]),Ae=wwe(xe,50,{units:"meters"}),De=Ae&&dh(Ae),de=De&&Lq({lng:De[0],lat:De[1]}),Ee=De&&Lq({lng:De[2],lat:De[3]}),Le={REQUEST:"GetFeatureInfo",BBOX:(de&&Ee&&[de[0],de[1],Ee[0],Ee[1]])?.join(","),INFO_FORMAT:G?.Capability?.Request?.GetFeatureInfo.Format.indexOf("text/html")!==-1?"text/html":"text/plain",LAYERS:ae.map(rt=>rt.visible&&rt.queryable?rt.Name:void 0).filter(rt=>rt),QUERY_LAYERS:ae.map(rt=>rt.visible&&rt.queryable?rt.Name:void 0).filter(rt=>rt)};let Fe=H,Xe;Fe?.indexOf?.("?")!==-1&&(Xe=t?.url?.split("?")||t?.config?.wmsUrl?.split("?"),Fe=Xe?.[0]);const Be=new URLSearchParams(Xe?.[1]),ot={...cd(pP.baseUrlParameters),...cd(pP.getFeatureInfoUrlParameters),...cd(Be,rt=>rt.toUpperCase()!=="REQUEST"),...cd(t.baseUrlParameters),...Le,...cd(t.getFeatureInfoUrlParameters)},Qe=new URLSearchParams(ot);fetch(Fe+"?"+Qe.toString()).then(rt=>{if(!rt.ok)throw new Error("FeatureInfo could not be fetched");return rt.text()}).then(rt=>{N(Ce.lngLat),U(rt),t.featureInfoSuccess?.(rt,Ce.lngLat)}).catch(rt=>console.log(rt))},[G,H,t,x,ae]),he=te.useMemo(()=>(typeof t?.featureInfoActive<"u"&&t.featureInfoActive||A)&&ae?.some(Ce=>Ce.visible&&Ce.queryable)&&!!x.map,[t?.featureInfoActive,A,ae,x.map]);te.useEffect(()=>{if(!he){oe();return}const Ce=se;return x.map.map.on("click",Ce),()=>{x.map?.map.off?.("click",Ce)}},[he,se,x.map]),te.useEffect(()=>{if(!G?.Service)return;let Ce=[];if(G?.Capability?.Layer?.CRS?.indexOf?.("EPSG:3857")===-1&&G?.Capability?.Layer?.CRS?.indexOf?.("CRS:84")===-1)console.log("MlWmsLoader ("+G.Service.Title+"): No WGS 84/Pseudo-Mercator support");else{console.log("MlWmsLoader ("+G.Service.Title+"): WGS 84/Pseudo-Mercator supported");let me=G?.Capability?.Layer?.Layer.filter(xe=>!xe.Layer?.length).map((xe,Ae)=>(Ae===0&&(Ce=xe.EX_GeographicBoundingBox||xe?.LatLonBoundingBox||[]),{visible:t.visibleLayersAtStart?t.visibleLayersAtStart.includes(xe.Name||""):!0,Attribution:{Title:""},...(({CRS:de,...Ee})=>Ee)(xe)}));G?.Capability?.Layer?.Layer.forEach(xe=>{const Ae=xe?.Layer?.filter(De=>De.CRS?.length).map((De,de)=>(de===0&&(Ce=De.EX_GeographicBoundingBox||De?.LatLonBoundingBox||[]),{visible:t.visibleLayersAtStart?t.visibleLayersAtStart.includes(De.Name||""):!0,Attribution:{Title:""},...(({CRS:we,...Le})=>Le)(De)}));Ae&&(me=[...me,...Ae])}),Q(me),t.zoomToExtent&&x?.map&&Ce.length>3&&x?.map.fitBounds([[Ce[0],Ce[1]],[Ce[2],Ce[3]]])}},[G,x.map]);const _e=J.jsxs($h,{secondaryAction:J.jsxs(J.Fragment,{children:[t.buttons,t.featureInfoEnabled&&J.jsx(kc,{sx:{padding:"4px",marginTop:"-3px",marginRight:"4px",background:Ce=>ae?.some(me=>me.visible&&me.queryable)?he?Ce.palette.info.light:Ce.palette.grey[300]:"initial"},"aria-label":"featureinfo",onClick:()=>{typeof t?.setFeatureInfoActive=="function"?t.setFeatureInfoActive(Ce=>!Ce):M(Ce=>!Ce)},disabled:!ae?.some(Ce=>Ce.visible&&Ce.queryable),children:J.jsx(Oq,{})}),J.jsx(kc,{edge:t.showDeleteButton?!1:"end",sx:{padding:"4px",marginTop:"-3px",...t.showDeleteButton?{marginRight:"4px"}:{}},"aria-label":"open",onClick:()=>c(Ce=>!Ce),children:o?J.jsx(AJ,{}):J.jsx(bE,{})}),t.showDeleteButton&&J.jsxs(J.Fragment,{children:[J.jsx(kc,{"aria-label":"delete",edge:"end",onClick:()=>{typeof t.onConfigChange=="function"&&b(!0)},sx:{padding:"4px",marginTop:"-3px"},children:J.jsx(qx,{})}),m&&J.jsx(J0,{open:m,onConfirm:()=>{typeof t.onConfigChange=="function"&&t.onConfigChange(!1)},onCancel:()=>{b(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]})]}),sx:{paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"},children:[J.jsx(jb,{sx:{minWidth:"30px"},children:J.jsx(U0,{sx:{padding:0},checked:h,onClick:()=>{d(Ce=>!Ce)}})}),J.jsx(Dh,{primary:X,variant:"layerlist"})]});return J.jsxs(J.Fragment,{children:[n&&J.jsx(sye,{children:J.jsx(Bo,{children:n})}),j&&J.jsxs(J.Fragment,{children:[t.showLayerList&&J.jsxs(J.Fragment,{children:[t.sortable&&J.jsx(OE,{children:_e}),!t.sortable&&_e,J.jsx(Bo,{sx:{display:o?"block":"none"},children:J.jsx(Rf,{dense:!0,component:"div",disablePadding:!0,sx:{paddingLeft:"18px"},children:j&&ae?.map?.((Ce,me)=>Ce?.Name?J.jsxs($h,{secondaryAction:J.jsx(J.Fragment,{children:Ce?.queryable&&J.jsx(Oq,{})}),children:[J.jsx(jb,{sx:{minWidth:"30px"},children:J.jsx(U0,{checked:Ce.visible,sx:{padding:0},onClick:()=>{const xe=[...ae];xe[me].visible=!xe[me].visible,Q([...xe])}})}),J.jsx(Dh,{primary:Ce?.Title,variant:"layerlist"})]},Ce.Name+me):J.jsx(J.Fragment,{}))})})]}),j&&ae?.length&&J.jsx(BE,{layerId:t.layerId||x.componentId,url:j,attribution:W,visible:h,urlParameters:{...t.baseUrlParameters,...t.getMapUrlParameters,layers:ae?.filter?.(Ce=>Ce.visible).map(Ce=>Ce.Name).reverse().join(",")},insertBeforeLayer:t?.insertBeforeLayer},x.componentId),t.featureInfoEnabled&&t.featureInfoMarkerEnabled&&F&&J.jsx(lM,{...F,content:O})]})]})};try{cM.displayName="MlWmsLoader",cM.__docgenInfo={description:`Loads a WMS getCapabilities xml document and adds a MlWmsLayer component for each layer that is
offered by the WMS.`,displayName:"MlWmsLoader",props:{url:{defaultValue:null,description:"WMS URL",name:"url",required:!1,type:{name:"string | undefined"}},mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},baseUrlParameters:{defaultValue:null,description:"Base URL parameters that will be used for all WMS requests (GetCapabilities, GetMap, GetFeatureInfo)",name:"baseUrlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},getCapabilitiesUrlParameters:{defaultValue:null,description:"URL parameters specific to GetCapabilities requests",name:"getCapabilitiesUrlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},getMapUrlParameters:{defaultValue:null,description:"URL parameters specific to GetMap requests",name:"getMapUrlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},getFeatureInfoUrlParameters:{defaultValue:null,description:"URL parameters specific to GetFeatureInfo requests",name:"getFeatureInfoUrlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},zoomToExtent:{defaultValue:null,description:"If true, zooms to the extent of the WMS layer after loading the getCapabilities response",name:"zoomToExtent",required:!1,type:{name:"boolean | undefined"}},name:{defaultValue:null,description:"The name of the ListItem element representing the WmsLoader",name:"name",required:!1,type:{name:"string | undefined"}},featureInfoEnabled:{defaultValue:null,description:"If true, enables the feature info functionality",name:"featureInfoEnabled",required:!1,type:{name:"boolean | undefined"}},featureInfoActive:{defaultValue:null,description:"If true, the feature info functionality is active",name:"featureInfoActive",required:!1,type:{name:"boolean | undefined"}},setFeatureInfoActive:{defaultValue:null,description:"A function to set the feature info active state",name:"setFeatureInfoActive",required:!1,type:{name:"((val: boolean | ((current: boolean) => boolean)) => void) | undefined"}},featureInfoSuccess:{defaultValue:null,description:"Callback function that is called after the featureInfoRequest has succeeded",name:"featureInfoSuccess",required:!1,type:{name:"((content: string, lngLat: { lng: number; lat: number; }) => void) | undefined"}},featureInfoMarkerEnabled:{defaultValue:null,description:"If true, displays a marker at the feature info location",name:"featureInfoMarkerEnabled",required:!1,type:{name:"boolean | undefined"}},config:{defaultValue:null,description:"The WMS configuration object",name:"config",required:!1,type:{name:"WmsConfig | undefined"}},onConfigChange:{defaultValue:null,description:"A function to handle changes to the WMS configuration",name:"onConfigChange",required:!1,type:{name:"((config: false | WmsConfig) => void) | undefined"}},setLayers:{defaultValue:null,description:"A function to update a LayerType config array that is passed to this component at props.config.layers",name:"setLayers",required:!1,type:{name:"((layers: LayerType[]) => void) | undefined"}},showDeleteButton:{defaultValue:null,description:"If true, shows the delete button for the WMSLoader",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},buttons:{defaultValue:null,description:"Custom buttons to display for the WMSLoader",name:"buttons",required:!1,type:{name:"Element | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},visibleLayersAtStart:{defaultValue:null,description:"Array of layer Names (IDs) that should be visible at start. If not provided, default visibility logic applies.",name:"visibleLayersAtStart",required:!1,type:{name:"string[] | undefined"}},showLayerList:{defaultValue:null,description:"If true, renders the layer list UI. If false, only the WMS layer is rendered without UI controls.",name:"showLayerList",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function hM(t){const e={"circle-color":"rgba(0,0,0,0)"},r={"fill-color":"rgba(0,0,0,0)","fill-outline-color":"rgba(0,0,0,0)"},n={"line-color":"rgba(0,0,0,0)"},i=["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,0,t.currentVal,1,t.currentVal+t.fadeOut*t.step,0],a=["interpolate",["linear"],["get",t.timeField],t.currentVal,1,t.currentVal+t.fadeOut*t.step,0],s={"fill-color":t.featuresColor,"fill-opacity":i,"fill-outline-color":["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,"rgba(255, 0, 0, 0)",t.currentVal,"rgb(0,0,0)",t.currentVal+t.fadeIn*t.step,"rgba(255, 0, 0, 0)"]},o={"circle-color":t.featuresColor,"circle-radius":["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,1,t.currentVal,20,t.currentVal+t.fadeOut*t.step,1],"circle-opacity":i},c={"line-color":t.featuresColor,"line-width":3,"line-opacity":i},h={"circle-color":t.featuresColor,"circle-radius":["interpolate",["linear"],["get",t.timeField],t.currentVal,20,t.currentVal+t.fadeOut*t.step,1],"circle-opacity":a},d={"fill-color":t.featuresColor,"fill-opacity":a,"fill-outline-color":["interpolate",["linear"],["get",t.timeField],t.currentVal,"rgb(0,0,0)",t.currentVal+t.fadeIn*t.step,"rgba(255, 0, 0, 0)"]},m={"line-color":t.featuresColor,"line-width":3,"line-opacity":a};if(t.userPaint!==void 0)return t.userPaint;switch(t.type){case"circle":return t.currentVal===t.minVal&&!t.isPlaying?e:t.accumulate?h:o;case"fill":return t.currentVal===t.minVal&&!t.isPlaying?r:t.accumulate?d:s;case"line":return t.currentVal===t.minVal&&!t.isPlaying?n:t.accumulate?m:c;case void 0:return t.currentVal===t.minVal&&!t.isPlaying?e:t.accumulate?h:o}}try{hM.displayName="paintPicker",hM.__docgenInfo={description:"",displayName:"paintPicker",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:"undefined"},{value:'"fill"'},{value:'"circle"'},{value:'"line"'}]}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},featuresColor:{defaultValue:null,description:"",name:"featuresColor",required:!0,type:{name:"string"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},userPaint:{defaultValue:null,description:"",name:"userPaint",required:!0,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | { ...; } | { ...; } | undefined'}}}}}catch{}function fM(t){const e=t.currentVal-t.fadeIn*t.step,r=t.currentVal+t.fadeIn*t.step,n={"text-color":"rgba(0,0,0,0)"},i={"text-color":t.labelColor,"text-opacity":["interpolate",["linear"],["get",t.timeField],e,0,t.currentVal,1,r,0]},a={"text-color":t.labelColor,"text-opacity":["interpolate",["linear"],["get",t.timeField],t.currentVal,1,r,0]},s=()=>t.currentVal===t.minVal&&!t.isPlaying?n:t.accumulate?a:i,o={"text-field":["get",t.labelField],"text-font":["Metropolis Regular"]};return J.jsx(NE,{options:{type:"symbol",layout:t.labelLayout||o,paint:t.labelPaint||s()},geojson:t.data,layerId:"timeControllerLabels"})}try{fM.displayName="MlTemporalControllerLabels",fM.__docgenInfo={description:"",displayName:"MlTemporalControllerLabels",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},labelField:{defaultValue:null,description:"",name:"labelField",required:!0,type:{name:"string"}},labelColor:{defaultValue:null,description:"",name:"labelColor",required:!0,type:{name:"string"}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},labelLayout:{defaultValue:null,description:"",name:"labelLayout",required:!1,type:{name:"any"}},labelPaint:{defaultValue:null,description:"",name:"labelPaint",required:!1,type:{name:"SymbolLayerSpecification | undefined"}}}}}catch{}const ORe=Ji(J.jsx("path",{d:"M8 5v14l11-7z"})),NRe=Ji(J.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"})),LRe=Ji(J.jsx("path",{d:"M6 6h12v12H6z"})),FRe=Ji(J.jsx("path",{d:"m4 18 8.5-6L4 6zm9-12v12l8.5-6z"})),BRe=Ji(J.jsx("path",{d:"M11 18V6l-8.5 6zm.5-6 8.5 6V6z"})),zRe={marginLeft:"15%",marginBottom:"3%",width:"70%",height:"90px",alignItems:"center"},jRe={top:"10%",height:"100px",alignItems:"center"};function dM(t){const[e,r]=te.useState(t.currentVal),[n,i]=te.useState(t.isPlaying),a=t.maxVal-t.minVal,s=te.useRef(null),o=Ox(E=>E.breakpoints.down("md"));te.useEffect(()=>()=>{s.current&&clearInterval(s.current)},[]),te.useEffect(()=>{t.returnCurrent(e),t.returnPlaying(n)},[e,n]);const c=gt.useCallback(()=>{let E=e-t.minVal;s.current&&clearInterval(s.current),s.current=setInterval(function(){E>=a?(s.current&&clearInterval(s.current),i(!1)):r(T=>T+t.step),E=E+t.step},t.interval)},[t.step,t.maxVal,e]),h=()=>{n?(i(!1),n&&s.current&&clearInterval(s.current)):(i(!0),c())},d=()=>{s.current&&clearInterval(s.current),r(t.minVal),i(!1)},m=()=>{n?(s.current&&clearInterval(s.current),r(e-a/10),c()):r(e-a/10)},b=()=>{n?(s.current&&clearInterval(s.current),r(e+a/10),c()):r(e+a/10)},x=(E,T)=>{n?E&&(s.current&&clearInterval(s.current),r(T),c()):r(T)};return J.jsx(J.Fragment,{children:J.jsxs(lO,{anchor:"bottom",open:t.open||!0,variant:"persistent",sx:{flexShrink:0,"& .MuiDrawer-paper":o?jRe:zRe},children:[J.jsxs(fp,{container:!0,alignItems:"center",justifyContent:"space-between",children:[J.jsxs(fp,{item:!0,xs:12,sm:10,textAlign:"center",children:[J.jsx(ta,{onClick:m,children:J.jsx(BRe,{})}),J.jsx(ta,{onClick:d,children:J.jsx(LRe,{})}),J.jsx(ta,{onClick:h,children:n?J.jsx(NRe,{}):J.jsx(ORe,{})}),J.jsx(ta,{onClick:b,children:J.jsx(FRe,{})})]}),t.display&&!o&&J.jsx(fp,{item:!0,xs:12,sm:5,textAlign:"right",children:J.jsx(Ss,{variant:"h5",sx:{paddingRight:"25px"},children:Math.floor(e)})})]}),J.jsx(dO,{sx:{position:"flex",width:"95%",paddingTop:"10px",alignSelf:"center"},"aria-label":"Custom marks",defaultValue:t.minVal,value:e,step:t.step,onChange:x,min:t.minVal,max:t.maxVal}),o&&t.display&&J.jsx(Ss,{variant:"body1",textAlign:"right",children:Math.floor(e)})]})})}try{dM.displayName="TemporalControllerPlayer",dM.__docgenInfo={description:"",displayName:"TemporalControllerPlayer",props:{currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},interval:{defaultValue:null,description:"",name:"interval",required:!0,type:{name:"number"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},maxVal:{defaultValue:null,description:"",name:"maxVal",required:!0,type:{name:"number"}},returnCurrent:{defaultValue:null,description:"",name:"returnCurrent",required:!0,type:{name:"Dispatch<SetStateAction<number>>"}},returnPlaying:{defaultValue:null,description:"",name:"returnPlaying",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},featuresColor:{defaultValue:null,description:"",name:"featuresColor",required:!0,type:{name:"string"}},labels:{defaultValue:null,description:"",name:"labels",required:!0,type:{name:"boolean"}},labelColor:{defaultValue:null,description:"",name:"labelColor",required:!0,type:{name:"string"}},labelFadeIn:{defaultValue:null,description:"",name:"labelFadeIn",required:!0,type:{name:"number"}},labelFadeOut:{defaultValue:null,description:"",name:"labelFadeOut",required:!0,type:{name:"number"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},display:{defaultValue:null,description:"",name:"display",required:!0,type:{name:"boolean"}}}}}catch{}function URe(t,e){if(t?.features){const r=[...t.features?t.features:[]];return r.sort((n,i)=>n.properties?.[e]<i.properties?.[e]?1:-1),r[r.length-1]?.properties?.[e]||0}return 0}function VRe(t,e){if(t?.features){const r=[...t?.features?t.features:[]];return r.sort((n,i)=>n.properties?.[e]<i.properties?.[e]?-1:1),r[r.length-1]?.properties?.[e]||0}return 0}function pM(t){const e=va({mapId:t.mapId}),r=te.useMemo(()=>t.minVal?t.minVal:URe(t.geojson,t.timeField),[t.minVal,t.geojson,t.timeField]),n=te.useMemo(()=>t.maxVal?t.maxVal:VRe(t.geojson,t.timeField),[t.maxVal,t.geojson,t.timeField]);return{filteredData:te.useMemo(()=>{if(t.geojson!==void 0&&e.map&&r&&n)return Ep(t.geojson.features.filter(a=>a.properties?.[t.timeField]>=r&&a.properties?.[t.timeField]<=n))},[t.geojson,e.map,t.timeField]),minVal:r,maxVal:n}}try{pM.displayName="useFilterData",pM.__docgenInfo={description:"",displayName:"useFilterData",props:{geojson:{defaultValue:null,description:"",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},initialVal:{defaultValue:null,description:"",name:"initialVal",required:!1,type:{name:"number | undefined"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!1,type:{name:"number | undefined"}},maxVal:{defaultValue:null,description:"",name:"maxVal",required:!1,type:{name:"number | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!0,type:{name:"string | undefined"}}}}}catch{}const Fq=({mapId:t=void 0,insertBeforeLayer:e,geojson:r,ownLayer:n=!0,attribution:i="",type:a="circle",timeField:s,minVal:o,maxVal:c,initialVal:h,accumulate:d=!1,fitBounds:m=!0,paint:b,featuresColor:x,step:E=1,interval:T=200,fadeIn:A=5,fadeOut:M=5,label:F=!0,labelColor:N,labelField:O=[],labelFadeIn:U=5,labelFadeOut:j=5,displayCurrentValue:H=!1,onClick:G,onHover:X,onLeave:ae,onStateChange:Q})=>{const W=va({mapId:t,waitForLayer:e}),{filteredData:oe,minVal:se,maxVal:he}=pM({geojson:r,timeField:s,minVal:o,maxVal:c,mapId:t}),_e=Lc(),[Ce,me]=te.useState(h||se),xe=x||_e.palette.primary.main,Ae=N||_e.palette.text.primary,[De,de]=te.useState(!1),Ee=hM({type:a,timeField:s,currentVal:Ce,minVal:se,isPlaying:De,fadeIn:A,fadeOut:M,step:E,featuresColor:xe,accumulate:d,userPaint:b});return te.useEffect(()=>{!h&&se?me(se):h&&me(h)},[]),te.useEffect(()=>{typeof Q=="function"&&Q({current:Ce,paint:Ee})},[Q]),te.useEffect(()=>{if(m&&typeof oe<"u"){const we=dh(oe);W.map?.map.fitBounds(we)}},[oe]),te.useEffect(()=>{if(!W.map)return;let we,Le,Fe;return G&&(we=G,W.map?.on("click","timeController",we)),X&&(Le=X,W.map?.on("mouseenter","timeController",Le)),ae&&(Fe=ae,W.map?.on("mouseleave","timeController",Fe)),()=>{we&&W.map?.off("click","timeController",we),Le&&W.map?.off("mouseenter","timeController",Le),Fe&&W.map?.off("mouseleave","timeController",Fe)}},[W.map,G,X,ae]),J.jsxs(J.Fragment,{children:[oe&&n&&J.jsx(Dc,{type:a,mapId:t,options:{source:{type:"geojson",attribution:i,data:oe},paint:{...b||Ee},layout:{visibility:"visible"}}}),oe&&F&&J.jsx(fM,{data:oe,currentVal:Ce,fadeIn:U,fadeOut:j,step:E,labelField:O,labelColor:Ae,timeField:s,minVal:se,accumulate:d,isPlaying:De}),J.jsx(dM,{currentVal:Ce,isPlaying:De,step:E,interval:T,minVal:se,maxVal:he,returnCurrent:me,returnPlaying:de,open:!1,fadeIn:A,fadeOut:M,featuresColor:xe,labels:F,labelColor:Ae,labelFadeIn:U,labelFadeOut:j,accumulate:d,display:H})]})};try{Fq.displayName="MlTemporalController",Fq.__docgenInfo={description:"",displayName:"MlTemporalController",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order.
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},ownLayer:{defaultValue:{value:"true"},description:"If true,the component creates and loads a MlGeoJsonLayer to show the data.",name:"ownLayer",required:!1,type:{name:"boolean | undefined"}},attribution:{defaultValue:{value:""},description:"MapLibre attribution shown in the bottom right of the map, if this layer is visible",name:"attribution",required:!1,type:{name:"string | undefined"}},type:{defaultValue:{value:"circle"},description:`Type of the layer that will be added to the MapLibre instance.
Possible values: "line", "circle", "fill"`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"fill"'},{value:'"circle"'},{value:'"line"'}]}},timeField:{defaultValue:null,description:"Property field where the time informations is available.",name:"timeField",required:!0,type:{name:"string"}},minVal:{defaultValue:null,description:`Lowest time value to be shown in the time line.
By default, it is set to the lowest value in the time field.`,name:"minVal",required:!1,type:{name:"number | undefined"}},label:{defaultValue:{value:"true"},description:'When true, a label layer will be added by the component. In that case, the "labelField" propertie is mandatory.',name:"label",required:!1,type:{name:"boolean | undefined"}},labelField:{defaultValue:{value:"[]"},description:"Property field where the label information is available.",name:"labelField",required:!1,type:{name:"string | undefined"}},maxVal:{defaultValue:null,description:`Highest time value to be shown in the time line.
By default, it is set to the highest value in the time field.`,name:"maxVal",required:!1,type:{name:"number | undefined"}},initialVal:{defaultValue:null,description:`the value at which the component is to be loaded.
If not specified, the component starts at the minimum value.`,name:"initialVal",required:!1,type:{name:"number | undefined"}},accumulate:{defaultValue:{value:"false"},description:`When true, the features will be accumulated in the map.
This option ist by default false.`,name:"accumulate",required:!1,type:{name:"boolean | undefined"}},fitBounds:{defaultValue:{value:"true"},description:`When true, the component will fit the map bounds to the shown features.
This option ist by default true.`,name:"fitBounds",required:!1,type:{name:"boolean | undefined"}},showControls:{defaultValue:null,description:"Boolean value that disables and enables the controls drawer.",name:"showControls",required:!1,type:{name:"boolean | undefined"}},paint:{defaultValue:null,description:`Paint property object for the features layer.
Possible props depend on the layer type.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | { ...; } | { ...; } | undefined'}},featuresColor:{defaultValue:null,description:"Sets the color of the features rendered by this component.",name:"featuresColor",required:!1,type:{name:"string | undefined"}},step:{defaultValue:{value:"1"},description:`How many units the timeline runs through at each step.
By default it is set to 1.`,name:"step",required:!1,type:{name:"number | undefined"}},interval:{defaultValue:{value:"200"},description:`The time between each addition to the counter, expressed in milliseconds.
By default, 200 ms.`,name:"interval",required:!1,type:{name:"number | undefined"}},fadeIn:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps before the feature starts to appear.
By default it is set to 5 steps.`,name:"fadeIn",required:!1,type:{name:"number | undefined"}},fadeOut:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps the feature fades out after it proper time value.
By default it is set to 5 steps.`,name:"fadeOut",required:!1,type:{name:"number | undefined"}},labelColor:{defaultValue:null,description:"Sets the color of the features rendered by this component.",name:"labelColor",required:!1,type:{name:"string | undefined"}},labelLayout:{defaultValue:null,description:`Layout property object, that is passed to the labels layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#symbol`,name:"labelLayout",required:!1,type:{name:"any"}},labelPaint:{defaultValue:null,description:`Paint property object for the features layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#symbol`,name:"labelPaint",required:!1,type:{name:"any"}},labelFadeIn:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps before the labels start to appear.
By default it is set to 5 steps.`,name:"labelFadeIn",required:!1,type:{name:"number | undefined"}},labelFadeOut:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps the labels fade out after their proper time value.
By default it is set to 5 steps.`,name:"labelFadeOut",required:!1,type:{name:"number | undefined"}},displayCurrentValue:{defaultValue:{value:"false"},description:"If true, the current time value will be displayed in the controlls panel.",name:"displayCurrentValue",required:!1,type:{name:"boolean | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onHover:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onStateChange:{defaultValue:null,description:"Callback function defined by the user to recive the current time value and paint property in the parent component.",name:"onStateChange",required:!1,type:{name:"Dispatch<SetStateAction<TemporalControllerValues | undefined>> | undefined"}}}}}catch{}const jE=t=>{const e=t?.layerIds.toReversed();return J.jsx(J.Fragment,{children:e&&e.map((r,n)=>{const i=n>0?e[n-1]:t.insertBeforeLayer;return J.jsx(NE,{layerId:r,insertBeforeLayer:i},r)})})};try{jE.displayName="MlOrderLayers",jE.__docgenInfo={description:"Creates an invisible layer for each entry in props.layerIds with the id `order-{entry}` and a reliable order",displayName:"MlOrderLayers",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerIds:{defaultValue:null,description:"",name:"layerIds",required:!0,type:{name:"string[]"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const Bq=t=>{const e=va({mapId:"map_1"});return te.useEffect(()=>{if(e.map)return e.map.map.getSource("terrain")||e.map.map.addSource("terrain",{type:"raster-dem",encoding:"mapbox",maxzoom:12,minzoom:4,...t.sourceOptions}),e.map.map.setTerrain({source:"terrain",exaggeration:1,...t.terrainOptions}),e.map.addLayer({id:"hills",type:"hillshade",source:"terrain",layout:{visibility:"visible"},paint:{"hillshade-shadow-color":"rgba(71,59,36,0.4)"}}),()=>{e.map?.map.setTerrain(null),e.map?.map.getSource("terrain")&&(e.map.map.removeLayer("hills"),e.map.map.removeSource("terrain"))}},[e.map,t.sourceOptions,t.terrainOptions]),J.jsx(J.Fragment,{})};try{Bq.displayName="MlTerrainLayer",Bq.__docgenInfo={description:"Create Terrain Layer Component",displayName:"MlTerrainLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"Source of tiles with possibles options",name:"sourceOptions",required:!1,type:{name:"object | undefined"}},terrainOptions:{defaultValue:null,description:"Options for new exaggeration value",name:"terrainOptions",required:!1,type:{name:"TerrainSpecification | undefined"}}}}}catch{}const $Re=Ji(J.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),qRe=Ji([J.jsx("circle",{cx:"7",cy:"14",r:"3"},"0"),J.jsx("circle",{cx:"11",cy:"6",r:"3"},"1"),J.jsx("circle",{cx:"16.6",cy:"17.6",r:"3"},"2")]),HRe=[{name:"Point",mode:"draw_point",icon:J.jsx(qRe,{})},{name:"LineString",mode:"draw_line_string",icon:J.jsx(TJ,{})},{name:"Polygon",mode:"draw_polygon",icon:J.jsx(CJ,{})}],zq=t=>{const e=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(),[i,a]=te.useState({activeGeometryIndex:void 0,selectedGeoJson:void 0,geometries:[],drawMode:void 0});console.log(i),te.useEffect(()=>{typeof t.onChange=="function"&&t.onChange(i)},[i,t.onChange]);const s={...t.buttonStyleOverride},o=m=>{let b;a(x=>(b=x.drawMode,{...x,drawMode:void 0,activeGeometryIndex:void 0,selectedGeoJson:void 0})),requestAnimationFrame(()=>{a(x=>(b==="draw_polygon"||b==="draw_line_string")&&m==="draw_point"?{...x,drawMode:void 0}:{...x,drawMode:m})})},c=m=>{a(b=>{const x=[...b.geometries];return x.splice(x.indexOf(m),1),{...b,drawMode:void 0,geometries:x,activeGeometryIndex:b.activeGeometryIndex?b.activeGeometryIndex-1:void 0}})},h=m=>{t.onShowInstructionChange?.(m.target.checked)},d=()=>J.jsx(J.Fragment,{children:HRe.map(m=>{const b=E=>i.drawMode===m.mode?E.palette.primary.main:E.palette.navigation.navColor,x=E=>i.drawMode!==m.mode?E.palette.primary.main:E.palette.navigation.navColor;return J.jsx(J.Fragment,{children:J.jsx(fg,{title:m.name,children:J.jsx(ta,{sx:{color:x,backgroundColor:b,"&:hover":{backgroundColor:b},...s},onClick:()=>o(m.mode),children:m.icon},m.name)})})})});return J.jsxs(J.Fragment,{children:[J.jsx(Mv,{sx:{zIndex:104},children:J.jsx(jk,{children:J.jsx(d,{})})}),J.jsx(Mv,{sx:{marginTop:"10px"},children:J.jsx(hY,{children:J.jsx(Vk,{control:J.jsx(U0,{size:"small",checked:t.showInstruction,onChange:h}),label:"Show instructions"})})}),i.drawMode&&J.jsx(vE,{mode:i.drawMode,geojson:i.selectedGeoJson,onChange:m=>{console.log("Features: ",m),m?.[0]&&a(b=>{const x=[...i.geometries];if(typeof b.activeGeometryIndex>"u"){const T=m[0];T&&T.properties?T.properties.id=T.id:console.error("tempFeature or tempFeature.properties is null or undefined"),b.activeGeometryIndex=x.length,x.push(T)}else x[b.activeGeometryIndex]=m[0];return(()=>{if(b.selectedGeoJson&&typeof b.activeGeometryIndex<"u"&&b.geometries[b.activeGeometryIndex]&&b.geometries[b.activeGeometryIndex].geometry.type==="Point"){const T=b.selectedGeoJson?.geometry?.coordinates,A=b.geometries[b.activeGeometryIndex]?.geometry?.coordinates;return JSON.stringify(T)!==JSON.stringify(A)}return!1})()&&(b.drawMode=void 0),{...b,geometries:x}})},onFinish:()=>{a(m=>({...m,drawMode:void 0,activeGeometryIndex:void 0,selectedGeoJson:void 0}))}}),J.jsxs(Rf,{sx:{zIndex:105,marginBottom:"-10px"},children:[i.geometries.map((m,b)=>J.jsxs(Mv,{sx:{display:"flex",flexDirection:"column"},children:[J.jsx("br",{}),J.jsxs(Mv,{flexDirection:"row",sx:{"&:hover":{backgroundColor:"rgb(177, 177, 177, 0.2)"},marginTop:"25px"},onMouseOver:()=>{n(m)},onMouseLeave:()=>{n(void 0)},children:[!m.properties?.customName&&J.jsx("input",{type:"text",value:m.properties?.name||"",placeholder:"Assign name",onChange:x=>{const E=x.target.value;a(T=>{const A=[...T.geometries];return A[b].properties||(A[b].properties={}),A[b].properties&&(A[b].properties.name=E),{...T,geometries:A}})},style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",outline:"none"},onFocus:x=>x.target.style.borderColor="#009ee0",onBlur:x=>{x.target.style.borderColor="#ccc",a(E=>{const T=[...E.geometries];return T[b].properties||(T[b].properties={}),T[b].properties&&(T[b].properties.customName=!0),{...E,geometries:T}})}}),J.jsx(dp,{listItemSx:s,configurable:!0,visible:!0,layerComponent:J.jsx(Dc,{mapId:t.mapId,geojson:m,layerId:String(m.id),defaultPaintOverrides:{fill:{"fill-opacity":.5}}}),type:"layer",name:J.jsx(Ss,{onClick:()=>{a(x=>{const E=[...x.geometries];return E[b].properties||(E[b].properties={}),E[b].properties&&(E[b].properties.customName=!1),{...x,geometries:E}})},sx:{cursor:"pointer",overflow:"hidden",whiteSpace:"nowrap"},children:m.properties?.name||String(m.id)}),description:m.geometry.type}),J.jsx(Mv,{sx:{padding:"3px 30px"},children:J.jsxs(jk,{size:"small",children:[J.jsx(fg,{title:"Center",children:J.jsx(ta,{sx:{color:x=>x.palette.primary.main,backgroundColor:x=>x.palette.navigation.navColor,...s},onClick:()=>{e?.map?.map.setCenter(m.geometry.type==="Point"?m.geometry.coordinates:oN(m).geometry.coordinates)},children:J.jsx(lN,{})})}),J.jsx(fg,{title:"Edit",children:J.jsx(ta,{sx:{color:x=>i.drawMode==="simple_select"&&i.selectedGeoJson?.id===m.id?x.palette.navigation.navColor:x.palette.primary.main,backgroundColor:x=>i.drawMode==="simple_select"&&i.selectedGeoJson?.id===m.id?x.palette.primary.main:x.palette.navigation.navColor,...s},onClick:()=>{a(x=>{const E=x.drawMode==="simple_select"&&x.selectedGeoJson?.id===m.id?void 0:"simple_select";return{...x,selectedGeoJson:m,activeGeometryIndex:x.geometries.indexOf(m),drawMode:E}})},children:J.jsx($Re,{})})}),J.jsx(fg,{title:"Delete",children:J.jsx(ta,{sx:{color:x=>x.palette.primary.main,backgroundColor:x=>x.palette.navigation.navColor,...s},onClick:()=>{c(m),n(void 0)},children:J.jsx(qx,{})})})]})})]})]},m.id)),r&&J.jsx(Dc,{mapId:t.mapId,geojson:{type:"FeatureCollection",features:[r]},layerId:"highlightBorder",defaultPaintOverrides:{circle:{"circle-color":"#000000","circle-opacity":.2,"circle-radius":10},line:{"line-color":"#000000","line-opacity":.2,"line-width":10},fill:{"fill-color":"#000000","fill-opacity":.2}}})]})]})};try{zq.displayName="MlSketchTool",zq.__docgenInfo={description:"Component template",displayName:"MlSketchTool",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},buttonStyleOverride:{defaultValue:null,description:`Style attribute for the button-style
https://mui.com/system/getting-started/the-sx-prop/`,name:"buttonStyleOverride",required:!1,type:{name:"SxProps | undefined"}},onChange:{defaultValue:null,description:"Callback function that is called each time GeoJson data has changed within MlSketchTool.\nFirst parameter contains all geometries in the `geometries` prop.",name:"onChange",required:!1,type:{name:"((para: SketchStateType) => void) | undefined"}},showInstruction:{defaultValue:null,description:"Determines whether the instruction text should be shown.",name:"showInstruction",required:!1,type:{name:"boolean | undefined"}},onShowInstructionChange:{defaultValue:null,description:'Callback function triggered when the "Show instructions" checkbox is toggled.',name:"onShowInstructionChange",required:!1,type:{name:"((value: boolean) => void) | undefined"}}}}}catch{}const gM=t=>{const e=te.useRef(!1),r=te.useRef(t.pause),n=te.useRef(t.zoom),i=te.useRef(t.pitch),a=te.useRef(1),s=te.useRef(t.speed),o=te.useRef(null),c=t.kmPerStep||.01,h=Jb(t.route),d=t.stepDuration||70,m=va({mapId:t.mapId,waitForLayer:t.insertBeforeLayer});te.useEffect(()=>{r.current=t.pause,r.current||T()},[t.pause]),te.useEffect(()=>{m.map&&(n.current=t.zoom,typeof n.current<"u"&&m.map.map.getZoom()!==n.current&&m.map.map.setZoom(n.current))},[m.map,t.zoom]),te.useEffect(()=>{m.map&&(i.current=t.pitch,typeof i.current<"u"&&i.current!==m.map.map.getPitch()&&m.map.map.setPitch(i.current))},[m.map,t.pitch]),te.useEffect(()=>{s.current=t.speed},[t.speed]);const b=te.useCallback(()=>{m.map&&(m.map.map.scrollZoom.disable(),m.map.map.boxZoom.disable(),m.map.map.dragRotate.disable(),m.map.map.dragPan.disable(),m.map.map.keyboard.disable(),m.map.map.doubleClickZoom.disable(),m.map.map.touchZoomRotate.disable())},[m.map]),x=te.useCallback(()=>{m.map&&(m.map.map.scrollZoom.enable(),m.map.map.boxZoom.enable(),m.map.map.dragRotate.enable(),m.map.map.dragPan.enable(),m.map.map.keyboard.enable(),m.map.map.doubleClickZoom.enable(),m.map.map.touchZoomRotate.enable())},[m.map]);function E(){if(!m.map||!t.route)return;const M=dh(t.route);let F;M&&M.length>3&&(F=[[M[0],M[1]],[M[2],M[3]]],m.map.map.fitBounds(F,{padding:100}))}function T(){if(m.map)if(r.current)x();else{b(),typeof n.current<"u"&&m.map.map.getZoom()!==n.current&&m.map.map.setZoom(n.current);const M=y2e(t.route,a.current*c).geometry.coordinates;a.current*c<h?(m.map.map.easeTo({center:M,bearing:Yb(Gh([m.map.map.getCenter().lng,m.map.map.getCenter().lat]),Gh(M)),duration:d,essential:!0}),typeof s.current<"u"?a.current=a.current+s.current:a.current++,console.log("PAN MOVE"),setTimeout(()=>{T()},100)):(m.map.map.setPitch(0),E(),x(),console.log("ENABLE CONTROLS"),a.current=1)}}function A(){m.map&&(E(),x(),a.current=1)}return te.useEffect(()=>{!m.map||e.current||(e.current=!0,E())},[m.map]),te.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]),{play:T,reset:A}};gM.defaultProps={mapId:void 0,zoom:18};try{gM.displayName="useCameraFollowPath",gM.__docgenInfo={description:"Component template",displayName:"useCameraFollowPath",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},pause:{defaultValue:null,description:"",name:"pause",required:!1,type:{name:"boolean | undefined"}},zoom:{defaultValue:{value:"18"},description:"",name:"zoom",required:!1,type:{name:"number | undefined"}},pitch:{defaultValue:null,description:"",name:"pitch",required:!1,type:{name:"number | undefined"}},speed:{defaultValue:null,description:"",name:"speed",required:!1,type:{name:"number | undefined"}},kmPerStep:{defaultValue:null,description:"",name:"kmPerStep",required:!1,type:{name:"number | undefined"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"any"}},stepDuration:{defaultValue:null,description:"",name:"stepDuration",required:!1,type:{name:"number | undefined"}},timeoutId:{defaultValue:null,description:"",name:"timeoutId",required:!1,type:{name:"number | undefined"}}}}}catch{}const WRe=()=>te.useContext(HD),UE=t=>(te.useEffect(()=>{if(!(!t.protocol||typeof t.handler!="function"))return mk.addProtocol(t.protocol,t.handler),()=>{mk.removeProtocol(t.protocol)}},[t]),{});UE.defaultProps={mapId:void 0};try{UE.displayName="useAddProtocol",UE.__docgenInfo={description:"Enables the use of custom protocols (basically custom tile load functions) in the maplibre-gl-js library.",displayName:"useAddProtocol",props:{protocol:{defaultValue:null,description:"the protocol string, for example `mbtiles`\nIn this example the handler function is called for all tile requests that start with the string `mbtiles://`",name:"protocol",required:!0,type:{name:"string"}},handler:{defaultValue:null,description:"Custom load tile function that will be called when using a source that starts with a custom url schema.",name:"handler",required:!0,type:{name:"AddProtocolAction"}}}}}catch{}function fee(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+"]"}).join(",")+"}")}function GRe(t,e){var r=fee(t);return function(n,i){return e(r(n),i,t)}}function XRe(t){var e=Object.create(null),r=[];return t.forEach(function(n){for(var i in n)i in e||r.push(e[i]=i)}),r}function lL(t){var e=new RegExp('["'+t+`
]`),r=t.charCodeAt(0);function n(h,d){var m,b,x=i(h,function(E,T){if(m)return m(E,T-1);b=E,m=d?GRe(E,d):fee(E)});return x.columns=b,x}function i(h,d){var m={},b={},x=[],E=h.length,T=0,A=0,M,F;function N(){if(T>=E)return b;if(F)return F=!1,m;var U=T,j;if(h.charCodeAt(U)===34){for(var H=U;H++<E;)if(h.charCodeAt(H)===34){if(h.charCodeAt(H+1)!==34)break;++H}return T=H+2,j=h.charCodeAt(H+1),j===13?(F=!0,h.charCodeAt(H+2)===10&&++T):j===10&&(F=!0),h.slice(U+1,H).replace(/""/g,'"')}for(;T<E;){var G=1;if(j=h.charCodeAt(T++),j===10)F=!0;else if(j===13)F=!0,h.charCodeAt(T)===10&&(++T,++G);else if(j!==r)continue;return h.slice(U,T-G)}return h.slice(U)}for(;(M=N())!==b;){for(var O=[];M!==m&&M!==b;)O.push(M),M=N();d&&(O=d(O,A++))==null||x.push(O)}return x}function a(h,d){return d==null&&(d=XRe(h)),[d.map(c).join(t)].concat(h.map(function(m){return d.map(function(b){return c(m[b])}).join(t)})).join(`
`)}function s(h){return h.map(o).join(`
`)}function o(h){return h.map(c).join(t)}function c(h){return h==null?"":e.test(h+="")?'"'+h.replace(/\"/g,'""')+'"':h}return{parse:n,parseRows:i,format:a,formatRows:s}}var N3=lL(","),YRe=N3.parse,ZRe=N3.parseRows,KRe=N3.format,JRe=N3.formatRows,L3=lL("	"),QRe=L3.parse,eMe=L3.parseRows,tMe=L3.format,rMe=L3.formatRows;const nMe=Object.freeze(Object.defineProperty({__proto__:null,csvFormat:KRe,csvFormatRows:JRe,csvParse:YRe,csvParseRows:ZRe,dsvFormat:lL,tsvFormat:tMe,tsvFormatRows:rMe,tsvParse:QRe,tsvParseRows:eMe},Symbol.toStringTag,{value:"Module"})),iMe=VG(nMe);var dm={exports:{}},jq;function aMe(){if(jq)return dm.exports;jq=1,dm.exports=t,dm.exports.pair=a,dm.exports.format=r,dm.exports.formatPair=e,dm.exports.coordToDMS=n;function t(o,c){var h=i(o,c);return h===null?null:h.val}function e(o){return r(o.lat,"lat")+" "+r(o.lon,"lon")}function r(o,c){var h=n(o,c);return h.whole+" "+(h.minutes?h.minutes+"' ":"")+(h.seconds?h.seconds+'" ':"")+h.dir}function n(o,c){var h={lat:["N","S"],lon:["E","W"]}[c]||"",d=h[o>=0?0:1],m=Math.abs(o),b=Math.floor(m),x=m-b,E=x*60,T=Math.floor(E),A=Math.floor((E-T)*60);return{whole:b,minutes:T,seconds:A,dir:d}}function i(o,c){if(c||(c="NSEW"),typeof o!="string")return null;o=o.toUpperCase();var h=/^[\s\,]*([NSEW])?\s*([\-|\|\]?[0-9.]+)[]?\s*(?:([0-9.]+)[']\s*)?(?:([0-9.]+)(?:''|"||)\s*)?([NSEW])?/,d=o.match(h);if(!d)return null;var m=d[0],b;if(d[1]&&d[5]?(b=d[1],m=m.slice(0,-1)):b=d[1]||d[5],b&&c.indexOf(b)===-1)return null;var x=d[2]?parseFloat(d[2]):0,E=d[3]?parseFloat(d[3])/60:0,T=d[4]?parseFloat(d[4])/3600:0,A=x<0?-1:1;return(b==="S"||b==="W")&&(A*=-1),{val:(Math.abs(x)+E+T)*A,dim:b,matched:m,remain:o.slice(m.length)}}function a(o,c){o=o.trim();var h=i(o,c);if(!h)return null;o=h.remain.trim();var d=i(o,c);return!d||d.remain?null:h.dim?s(h.val,d.val,h.dim):[h.val,d.val]}function s(o,c,h){if(h==="N"||h==="S")return[o,c];if(h==="W"||h==="E")return[c,o]}return dm.exports}var gP,Uq;function oMe(){if(Uq)return gP;Uq=1;var t=iMe,e=aMe(),r=/(Lat)(itude)?/gi,n=/(L)(on|ng)(gitude)?/i;function i(A,M){var F,N,O;for(var U in A)N=U.match(M),N&&(!F||N[0].length/U.length>O)&&(O=N[0].length/U.length,F=U);return F}function a(A){return i(A,r)}function s(A){return i(A,n)}function o(A){return!!A.match(r)}function c(A){return!!A.match(n)}function h(A){return typeof A=="object"?Object.keys(A).length:0}function d(A){var M=[",",";","	","|"],F=[];return M.forEach(function(N){var O=t.dsvFormat(N).parse(A);if(O.length>=1){for(var U=h(O[0]),j=0;j<O.length;j++)if(h(O[j])!==U)return;F.push({delimiter:N,arity:Object.keys(O[0]).length})}}),F.length?F.sort(function(N,O){return O.arity-N.arity})[0].delimiter:null}function m(A){return delete A.columns,A}function b(A){var M=d(A);return M?m(t.dsvFormat(M).parse(A)):null}function x(A,M,F){F||(F=M,M={}),M.delimiter=M.delimiter||",";var N=M.latfield||"",O=M.lonfield||"",U=M.crs||"",j=[],H={type:"FeatureCollection",features:j};if(U!==""&&(H.crs={type:"name",properties:{name:U}}),M.delimiter==="auto"&&typeof A=="string"&&(M.delimiter=d(A),!M.delimiter)){F({type:"Error",message:"Could not autodetect delimiter"});return}var G=M.numericFields?M.numericFields.split(","):null,X=typeof A=="string"?t.dsvFormat(M.delimiter).parse(A,function(me){if(G)for(var xe in me)G.includes(xe)&&(me[xe]=+me[xe]);return me}):A;if(!X.length){F(null,H);return}var ae=[],Q;N||(N=a(X[0])),O||(O=s(X[0]));var W=!N||!O;if(W){for(Q=0;Q<X.length;Q++)j.push({type:"Feature",properties:X[Q],geometry:null});F(ae.length?ae:null,H);return}for(Q=0;Q<X.length;Q++)if(X[Q][O]!==void 0&&X[Q][N]!==void 0){var oe=X[Q][O],se=X[Q][N],he,_e,Ce;Ce=e(oe,"EW"),Ce&&(oe=Ce),Ce=e(se,"NS"),Ce&&(se=Ce),he=parseFloat(oe),_e=parseFloat(se),isNaN(he)||isNaN(_e)?ae.push({message:"A row contained an invalid value for latitude or longitude",row:X[Q],index:Q}):(M.includeLatLon||(delete X[Q][O],delete X[Q][N]),j.push({type:"Feature",properties:X[Q],geometry:{type:"Point",coordinates:[parseFloat(he),parseFloat(_e)]}}))}F(ae.length?ae:null,H)}function E(A){for(var M=A.features,F={type:"Feature",geometry:{type:"LineString",coordinates:[]}},N=0;N<M.length;N++)F.geometry.coordinates.push(M[N].geometry.coordinates);return F.properties=M.reduce(function(O,U){for(var j in U.properties)O[j]||(O[j]=[]),O[j].push(U.properties[j]);return O},{}),{type:"FeatureCollection",features:[F]}}function T(A){for(var M=A.features,F={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},N=0;N<M.length;N++)F.geometry.coordinates[0].push(M[N].geometry.coordinates);return F.properties=M.reduce(function(O,U){for(var j in U.properties)O[j]||(O[j]=[]),O[j].push(U.properties[j]);return O},{}),{type:"FeatureCollection",features:[F]}}return gP={isLon:c,isLat:o,guessLatHeader:a,guessLonHeader:s,csv:t.csvParse,tsv:t.tsvParse,dsv:t,auto:b,csv2geojson:x,toLine:E,toPolygon:T},gP}var sMe=oMe();function F3(t){const e=t.split("?"),r=e[0].split("://"),n=r[0],s=(r.length>2?r[1]+"://"+r[2]:r[1]).split("/").join("/"),o=decodeURI(e[1]),c=Object.fromEntries(new URLSearchParams(o));return{protocolId:n,filename:s,options:c}}async function B3(t){try{return await(await fetch(t)).text()}catch(e){return console.error("File could not be loaded: ",e),e}}async function lMe(t,e){return await new Promise((n,i)=>{const a=e||{};t.substring(t.length-3)==="tsv"&&(e.delimiter="	"),B3(t).then(o=>{sMe.csv2geojson(o,a,(c,h)=>{c?i(c):n(h)})})})}const uMe=async t=>{const e=F3(t.url),r=await lMe(e.filename,e.options);if(r!==void 0)return{data:r};throw new Error("CSV not found "+e.filename)};var fc={},Vq;function Jx(){if(Vq)return fc;Vq=1,Object.defineProperty(fc,"__esModule",{value:!0}),fc.purgeProps=t,fc.first=e,fc.last=r,fc.coordsToKey=n,fc.addToMap=i,fc.removeFromMap=a,fc.getFirstFromMap=s,fc.isRing=o,fc.ringDirection=c,fc.pointInsidePolygon=h,fc.strArrayArrayToFloat=d,fc.strArrayToFloat=m;function t(b,x){if(b){const E=Object.assign({},b);if(x)for(const T of x)delete E[T];return E}return{}}function e(b){return b[0]}function r(b){return b[b.length-1]}function n(b){return b.join(",")}function i(b,x,E){const T=b[x];T?T.push(E):b[x]=[E]}function a(b,x,E){const T=b[x];let A=-1;T&&(A=T.indexOf(E)),A>=0&&T.splice(A,1)}function s(b,x){const E=b[x];return E&&E.length>0?E[0]:null}function o(b){return b.length>3&&n(e(b))===n(r(b))}function c(b,x,E){x=x||0,E=E||1;const T=b.reduce((X,ae,Q)=>b[X][x||0]>ae[x||0]?X:Q,0),A=T<=0?b.length-2:T-1,M=T>=b.length-1?1:T+1,F=b[A][x],N=b[T][x],O=b[M][x],U=b[A][E],j=b[T][E],H=b[M][E];return(N-F)*(H-U)-(O-F)*(j-U)<0?"clockwise":"counterclockwise"}function h(b,x,E,T){E=E||0,T=T||1;let A=!1;for(let M=0,F=x.length-1;M<x.length;F=M++)(x[M][E]<=b[E]&&b[E]<x[F][E]||x[F][E]<=b[E]&&b[E]<x[M][E])&&b[T]<(x[F][T]-x[M][T])*(b[E]-x[M][E])/(x[F][E]-x[M][E])+x[M][T]&&(A=!A);return A}function d(b){return b.map(m)}function m(b){return b.map(parseFloat)}return fc}var d1={},$q;function cMe(){if($q)return d1;$q=1,Object.defineProperty(d1,"__esModule",{value:!0}),d1.XmlParser=void 0;function t(i){return i.match(/^(.+?)\[(.+?)\]>$/g)!==null}function e(i){const a=/^(.+?)\[(.+?)\]>$/g.exec(i);return a?{evt:a[1]+">",exp:a[2]}:{evt:i}}function r(i){const a="return "+i.replace(/(\$.+?)(?=[=!.])/g,"node.$&")+";";return new Function("node",a)}class n{constructor(a){this.queryParent=!1,this.progressive=!1,this.parentMap=new WeakMap,a&&(this.queryParent=!!a.queryParent,this.progressive=a.progressive,this.queryParent&&(this.parentMap=new WeakMap)),this.evtListeners={}}parse(a,s,o){o=o?o+".":"";const c=/<([^ >\/]+)(.*?)>/mg,h=[];let d=c.exec(a);for(;d;){const m=d[1],b={$tag:m},x=o+m,E=d[2].trim();let T=!1;(E.endsWith("/")||m.startsWith("?")||m.startsWith("!"))&&(T=!0);const A=/([^ ]+?)="(.+?)"/g,M=/([^ ]+?)='(.+?)'/g;let F=A.exec(E),N=!1;for(;F;)N=!0,b[F[1]]=F[2],F=A.exec(E);if(!N)for(F=M.exec(E);F;)N=!0,b[F[1]]=F[2],F=M.exec(E);if(!N&&E!==""&&(b.text=E),this.progressive&&this.emit(`<${x}>`,b,s),!T){const O=new RegExp(`([^]+?)</${m}>`,"g");O.lastIndex=c.lastIndex;const U=O.exec(a);if(U&&U[1]){c.lastIndex=O.lastIndex;const j=this.parse(U[1],b,x);j.length>0?b.$innerNodes=j:b.$innerText=U[1]}}this.queryParent&&s&&this.parentMap.set(b,s),this.progressive&&this.emit(`</${x}>`,b,s),h.push(b),d=c.exec(a)}return h}getParent(a){return this.queryParent?this.parentMap.get(a):null}addListener(a,s){if(t(a)){const o=e(a);o.exp&&(s.condition=r(o.exp)),a=o.evt}this.$addListener(a,s)}removeListener(a,s){t(a)&&(a=e(a).evt),this.$removeListener(a,s)}on(a,s){this.addListener(a,s)}off(a,s){this.removeListener(a,s)}$addListener(a,s){const o=this.evtListeners[a];o?o.push(s):this.evtListeners[a]=[s]}$removeListener(a,s){const o=this.evtListeners[a];let c=-1;o&&(c=o.indexOf(s)),c>=0&&o.splice(c,1)}emit(a,...s){const o=this.evtListeners[a];if(o)for(const c of o)c.condition?c.condition.apply(null,s)===!0&&c.apply(null,s):c.apply(null,s)}}return d1.XmlParser=n,d1}var p1={},g1={},qq;function uL(){if(qq)return g1;qq=1,Object.defineProperty(g1,"__esModule",{value:!0}),g1.OsmObject=void 0;class t{constructor(r,n,i){this.type=r,this.id=n,this.refElems=i,this.tags={},this.props={id:this.getCompositeId()},this.refCount=0,this.hasTag=!1,i&&i.add(this.getCompositeId(),this)}addTags(r){this.tags=Object.assign(this.tags,r),this.hasTag=!0}addTag(r,n){this.tags[r]=n,this.hasTag=!0}addProp(r,n){this.props[r]=n}addProps(r){this.props=Object.assign(this.props,r)}getCompositeId(){return`${this.type}/${this.id}`}getProps(){return Object.assign(this.props,this.tags)}}return g1.OsmObject=t,g1}var Hq;function dee(){if(Hq)return p1;Hq=1,Object.defineProperty(p1,"__esModule",{value:!0}),p1.Node=void 0;const t=uL(),e=Jx();class r extends t.OsmObject{constructor(i,a){super("node",i,a)}setLatLng(i){this.latLng=i}toFeatureArray(){return this.latLng?[{type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"Point",coordinates:(0,e.strArrayToFloat)([this.latLng.lon,this.latLng.lat])}}]:[]}getLatLng(){return this.latLng}}return p1.Node=r,p1}var pm={},m1={},Wq;function pee(){if(Wq)return m1;Wq=1,Object.defineProperty(m1,"__esModule",{value:!0}),m1.LateBinder=void 0;class t{constructor(r,n,i,a){this.container=r,this.valueFunc=n,this.ctx=i,this.args=a}bind(){const r=this.valueFunc.apply(this.ctx,this.args),n=this.container.indexOf(this);if(n<0)return;const i=[n,1];r&&i.push(r),Array.prototype.splice.apply(this.container,i)}}return m1.LateBinder=t,m1}const hMe={},fMe={whitelist:["services","rest_area","escape","elevator"]},dMe={blacklist:["coastline","cliff","ridge","arete","tree_row"]},pMe={},gMe={whitelist:["riverbank","dock","boatyard","dam"]},mMe={},yMe={},vMe={whitelist:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},_Me={whitelist:["station","turntable","roundhouse","platform"]},bMe={},xMe={},wMe={blacklist:["cutline","embankment","pipeline"]},SMe={whitelist:["plant","substation","generator","transformer"]},EMe={},TMe={},CMe={blacklist:["taxiway"]},AMe={},IMe={},PMe={},kMe={},RMe={},MMe={},DMe={},OMe={},NMe={},LMe={building:hMe,highway:fMe,natural:dMe,landuse:pMe,waterway:gMe,amenity:mMe,leisure:yMe,barrier:vMe,railway:_Me,area:bMe,boundary:xMe,man_made:wMe,power:SMe,place:EMe,shop:TMe,aeroway:CMe,tourism:AMe,historic:IMe,public_transport:PMe,office:kMe,"building:part":{},military:RMe,ruins:MMe,"area:highway":{},craft:DMe,golf:OMe,indoor:NMe};var Gq;function gee(){if(Gq)return pm;Gq=1;var t=pm&&pm.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(pm,"__esModule",{value:!0}),pm.Way=void 0;const e=uL(),r=pee(),n=Jx(),i=t(LMe);class a extends e.OsmObject{constructor(o,c){super("way",o,c),this.latLngArray=[],this.isPolygon=!1}addLatLng(o){this.latLngArray.push(o)}setLatLngArray(o){this.latLngArray=o}addNodeRef(o){const c=new r.LateBinder(this.latLngArray,h=>{const d=this.refElems.get(`node/${h}`);if(d)return d.refCount++,d.getLatLng()},this,[o]);this.latLngArray.push(c),this.refElems.addBinder(c)}addTags(o){super.addTags(o);for(const[c,h]of Object.entries(o))this.analyzeTag(c,h)}addTag(o,c){super.addTag(o,c),this.analyzeTag(o,c)}toCoordsArray(){return this.latLngArray.map(o=>[o.lon,o.lat])}toFeatureArray(){let o=this.toCoordsArray();if(o.length>1){const c=(0,n.strArrayArrayToFloat)(o),h={type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"LineString",coordinates:c}};return this.isPolygon&&(0,n.isRing)(c)?((0,n.ringDirection)(c)!=="counterclockwise"&&c.reverse(),h.geometry={type:"Polygon",coordinates:[c]},[h]):[h]}return[]}analyzeTag(o,c){const h=i.default[o];h&&(this.isPolygon=!0,h.whitelist?this.isPolygon=h.whitelist.indexOf(c)>=0:h.blacklist&&(this.isPolygon=!(h.blacklist.indexOf(c)>=0)))}}return pm.Way=a,pm}var y1={},v1={},Xq;function FMe(){if(Xq)return v1;Xq=1,Object.defineProperty(v1,"__esModule",{value:!0}),v1.WayCollection=void 0;const t=Jx();class e extends Array{constructor(){super(),this.firstMap={},this.lastMap={}}addWay(n){const i=n.toCoordsArray();i.length>0&&(this.push(i),(0,t.addToMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(i)),i),(0,t.addToMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(i)),i))}mergeWays(){const n=[];let i=this.shift();for(;i;){(0,t.removeFromMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(i)),i),(0,t.removeFromMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(i)),i);let a=i,s;do{let o=this.getNextWay(a);s=o.next;let c=o.mergeType;if(s)switch(this.splice(this.indexOf(s),1),(0,t.removeFromMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(s)),s),(0,t.removeFromMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(s)),s),c){case 0:a=a.concat(s.slice(1));break;case 1:s.reverse(),a=a.concat(s.slice(1));break;case 2:a.reverse(),a=a.concat(s.slice(1));break;case 3:a=s.concat(a.slice(1));break}}while(s);n.push((0,t.strArrayArrayToFloat)(a)),i=this.shift()}return n}getNextWay(n){const i=(0,t.coordsToKey)((0,t.last)(n)),a=(0,t.coordsToKey)((0,t.first)(n));let s=this.length>0?this[0]:null;if(s){const o=(0,t.coordsToKey)((0,t.first)(s)),c=(0,t.coordsToKey)((0,t.last)(s));if(i===o)return{next:s,mergeType:0};if(i===c)return{next:s,mergeType:1};if(a===o)return{next:s,mergeType:2};if(a===c)return{next:s,mergeType:3}}return s=(0,t.getFirstFromMap)(this.firstMap,i),s?{next:s,mergeType:0}:(s=(0,t.getFirstFromMap)(this.lastMap,i),{next:s,mergeType:1})}toRings(n){const i=this.mergeWays(),a=[];let s=i.shift();for(;s;)(0,t.isRing)(s)&&((0,t.ringDirection)(s)!==n&&s.reverse(),a.push(s)),s=i.shift();return a}}return v1.WayCollection=e,v1}var Yq;function BMe(){if(Yq)return y1;Yq=1,Object.defineProperty(y1,"__esModule",{value:!0}),y1.Relation=void 0;const t=uL(),e=gee(),r=dee(),n=FMe(),i=pee(),a=Jx();class s extends t.OsmObject{constructor(c,h){super("relation",c,h),this.relations=[],this.nodes=[],this.bounds=void 0,this.ways=[],this.roles=[]}setBounds(c){this.bounds=c}addMember(c){switch(c.type){case"relation":let h=new i.LateBinder(this.relations,m=>{const b=this.refElems.get(`relation/${m}`);if(b)return b.refCount++,b},this,[c.ref]);this.relations.push(h),this.refElems.addBinder(h);break;case"way":if(c.role||(c.role=""),c.geometry){const m=new e.Way(c.ref,this.refElems);m.setLatLngArray(c.geometry),m.refCount++,this.ways.push(m),this.roles.push(c.role)}else if(c.nodes){const m=new e.Way(c.ref,this.refElems);for(const b of c.nodes)m.addNodeRef(b);m.refCount++,this.ways.push(m),this.roles.push(c.role)}else{let m=new i.LateBinder(this.ways,b=>{const x=this.refElems.get(`way/${b}`);if(x)return x.refCount++,x},this,[c.ref]);this.ways.push(m),this.roles.push(c.role),this.refElems.addBinder(m)}break;case"node":let d=null;if(c.lat&&c.lon){d=new r.Node(c.ref,this.refElems),d.setLatLng({lon:c.lon,lat:c.lat}),c.tags&&d.addTags(c.tags);for(const[m,b]of Object.entries(c))["id","type","lat","lon"].indexOf(m)<0&&d.addProp(m,b);d.refCount++,this.nodes.push(d)}else{let m=new i.LateBinder(this.nodes,b=>{const x=this.refElems.get(`node/${b}`);if(x)return x.refCount++,x},this,[c.ref]);this.nodes.push(m),this.refElems.addBinder(m)}break}}constructStringGeometry(c){const h=c?c.mergeWays():[];return h.length===0?null:{type:"MultiLineString",coordinates:h}}constructPolygonGeometry(c,h){const d=c?c.toRings("counterclockwise"):[],m=h?h.toRings("clockwise"):[];if(d.length>0){const b=[];let x;for(x of d)b.push([x]);for(x=m.shift();x;){for(const E in d)if((0,a.pointInsidePolygon)((0,a.first)(x),d[E])){b[E].push(x);break}x=m.shift()}return b.length===1?{type:"Polygon",coordinates:b[0]}:{type:"MultiPolygon",coordinates:b}}return null}toFeatureArray(){const c=[],h=[];let d=[];for(const b of this.relations)if(b)for(let x=0;x<b.ways.length;x++){const E=b.ways[x];this.ways.push(E),this.roles.push(b.roles[x])}let m={type:"Feature",id:this.getCompositeId(),bbox:this.bounds,properties:this.getProps(),geometry:null};if(this.bounds||delete m.bbox,this.roles.some(b=>b==="outer")){const b=new n.WayCollection,x=new n.WayCollection;for(let A=0;A<this.ways.length;A++){const M=this.ways[A],F=this.roles[A];F==="outer"?b.addWay(M):F==="inner"&&x.addWay(M)}let E=Object.assign({},m),T=this.constructPolygonGeometry(b,x);T&&(E.geometry=T,c.push(E))}else{const b=new n.WayCollection;for(let E of this.ways)b.addWay(E);let x=this.constructStringGeometry(b);if(x){let E=Object.assign({},m);E.geometry=x,h.push(E)}}for(let b of this.nodes)d=d.concat(b.toFeatureArray());return[...c,...h,...d]}}return y1.Relation=s,y1}var _1={},Zq;function zMe(){if(Zq)return _1;Zq=1,Object.defineProperty(_1,"__esModule",{value:!0}),_1.RefElements=void 0;class t extends Map{constructor(){super(),this.binders=[]}add(r,n){this.set(r,n)}addBinder(r){this.binders.push(r)}bindAll(){this.binders.forEach(r=>r.bind())}}return _1.RefElements=t,_1}var mP,Kq;function jMe(){if(Kq)return mP;Kq=1;const t=Jx(),e=cMe(),r=dee(),n=gee(),i=BMe(),a=zMe();function s(m){if(!m)return{completeFeature:!1,renderTagged:!1,excludeWay:!0};let b=m.excludeWay===void 0||m.excludeWay,x=!!m.completeFeature,E=!!m.renderTagged;return{completeFeature:x,renderTagged:E,excludeWay:b}}function o(m){return m.elements?"json":m.indexOf("<osm")>=0?"xml":m.trim().startsWith("{")?"json-raw":"invalid"}function c(m,b){for(const x of m.elements)switch(x.type){case"node":const E=new r.Node(x.id,b);x.tags&&E.addTags(x.tags),E.addProps((0,t.purgeProps)(x,["id","type","tags","lat","lon"])),E.setLatLng(x);break;case"way":const T=new n.Way(x.id,b);if(x.tags&&T.addTags(x.tags),T.addProps((0,t.purgeProps)(x,["id","type","tags","nodes","geometry"])),x.geometry)T.setLatLngArray(x.geometry);else if(x.nodes)for(const M of x.nodes)T.addNodeRef(M);break;case"relation":const A=new i.Relation(x.id,b);if(x.bounds&&A.setBounds([parseFloat(x.bounds.minlon),parseFloat(x.bounds.minlat),parseFloat(x.bounds.maxlon),parseFloat(x.bounds.maxlat)]),x.tags&&A.addTags(x.tags),A.addProps((0,t.purgeProps)(x,["id","type","tags","bounds","members"])),x.members)for(const M of x.members)A.addMember(M)}}function h(m,b){const x=new e.XmlParser({progressive:!0});x.on("</osm.node>",E=>{const T=new r.Node(E.id,b);for(const[A,M]of Object.entries(E))!A.startsWith("$")&&["id","lon","lat"].indexOf(A)<0&&T.addProp(A,M);if(T.setLatLng(E),E.$innerNodes)for(const A of E.$innerNodes)A.$tag==="tag"&&T.addTag(A.k,A.v)}),x.on("</osm.way>",E=>{const T=new n.Way(E.id,b);for(const[A,M]of Object.entries(E))!A.startsWith("$")&&["id"].indexOf(A)<0&&T.addProp(A,M);if(E.$innerNodes)for(const A of E.$innerNodes)A.$tag==="nd"?A.lon&&A.lat?T.addLatLng(A):A.ref&&T.addNodeRef(A.ref):A.$tag==="tag"&&T.addTag(A.k,A.v)}),x.on("<osm.relation>",E=>new i.Relation(E.id,b)),x.on("</osm.relation.member>",(E,T)=>{const A=b.get(`relation/${T?.id}`),M={type:E.type,role:E.role?E.role:"",ref:E.ref};if(E.lat&&E.lon){M.lat=E.lat,M.lon=E.lon,M.tags={};for(const[F,N]of Object.entries(E))!F.startsWith("$")&&["type","lat","lon"].indexOf(F)<0&&(M[F]=N)}if(E.$innerNodes){const F=[],N=[];for(const O of E.$innerNodes)O.lat&&O.lon?F.push(O):O.ref&&N.push(O.ref);F.length>0?M.geometry=F:N.length>0&&(M.nodes=N)}A.addMember(M)}),x.on("</osm.relation.bounds>",(E,T)=>{b.get(`relation/${T?.id}`).setBounds([parseFloat(E.minlon),parseFloat(E.minlat),parseFloat(E.maxlon),parseFloat(E.maxlat)])}),x.on("</osm.relation.tag>",(E,T)=>{b.get(`relation/${T?.id}`).addTag(E.k,E.v)}),x.parse(m)}function d(m,b){let{completeFeature:x,renderTagged:E,excludeWay:T}=s(b),A=o(m);const M=new a.RefElements;let F=[];A==="json-raw"&&(m=JSON.parse(m),m.elements?A="json":A="invalid"),A==="json"?c(m,M):A==="xml"&&h(m,M),M.bindAll();for(const N of M.values()){if(N.refCount>0&&(!N.hasTag||!E||N instanceof n.Way&&T))continue;const O=N.toFeatureArray();if(N instanceof i.Relation&&!x&&O.length>0)return O[0].geometry;F=F.concat(O)}return{type:"FeatureCollection",features:F}}return mP=d,mP}var UMe=jMe();const VMe=Id(UMe);async function $Me(t){const e=t.options||{};return await new Promise((n,i)=>{B3(t.filename).then(a=>{const s=VMe(a,e);s?n(s):i("Conversion failed")})})}const qMe=async t=>{const e=F3(t.url),r=await $Me(e);if(r!==void 0)return{data:r};throw new Error("OSM File not found "+e.filename)};function HMe(t){const e=[];return t.features.forEach(r=>{r.features?r.features.forEach(n=>{e.push({type:n.type,geometry:n.geometry,properties:n.properties})}):e.push({type:r.type,geometry:r.geometry,properties:r.properties})}),e}async function WMe(t){return await new Promise(r=>{let n={type:"Topology",objects:{key:""},arcs:[]};B3(t.filename).then(i=>{try{n=JSON.parse(i)}catch(s){throw console.error("Error converting topojson",s),"Invalid TopoJson"}let a={type:"FeatureCollection",features:[]};if(n.type==="Topology"&&n.objects!==void 0){const s=n.objects;Object.keys(n.objects).map(o=>{s?.[o].type==="GeometryCollection"?s?.[o].geometries?.forEach(c=>c.properties={fromObject:o,...c.properties}):s?.[o]&&s?.[o]?.type!=="GeometryCollection"&&(s[o].properties={fromObject:o,...s?.[o].properties})}),a={type:"FeatureCollection",features:Object.keys(n.objects).map(o=>Vwe(n,o))},a.features=HMe(a)}r(a)})})}const GMe=async t=>{const e=F3(t.url),r=await WMe(e);if(r!==void 0)return{data:r};throw new Error("Topojson not found "+e.filename)};function nl(t,e){return Array.from(t.getElementsByTagName(e))}function VE(t){return t[0]==="#"?t:`#${t}`}function XMe(t,e,r){return Array.from(t.getElementsByTagNameNS(r,e))}function Es(t){return t?.normalize(),t?.textContent||""}function es(t,e,r){const n=t.getElementsByTagName(e),i=n.length?n[0]:null;return i&&r&&r(i),i}function gh(t,e,r){const n={};if(!t)return n;const i=t.getElementsByTagName(e),a=i.length?i[0]:null;return a&&r?r(a,n):n}function oy(t,e,r){const n=Es(es(t,e));return n&&r?r(n)||{}:{}}function Jq(t,e,r){const n=Number.parseFloat(Es(es(t,e)));if(!Number.isNaN(n))return n&&r?r(n)||{}:{}}function Eu(t,e,r){const n=Number.parseFloat(Es(es(t,e)));if(!Number.isNaN(n))return r&&r(n),n}function sy(t,e){const r={};for(const n of e)oy(t,n,i=>{r[n]=i});return r}function Qx(t){return t?.nodeType===1}function mee(t){let e=[];if(t===null)return e;for(const r of Array.from(t.childNodes)){if(!Qx(r))continue;const n=YMe(r.nodeName);if(n==="gpxtpx:TrackPointExtension")e=e.concat(mee(r));else{const i=Es(r);e.push([n,ZMe(i)])}}return e}function YMe(t){return["heart","gpxtpx:hr","hr"].includes(t)?"heart":t}function ZMe(t){const e=Number.parseFloat(t);return Number.isNaN(e)?t:e}function yee(t){const e=[Number.parseFloat(t.getAttribute("lon")||""),Number.parseFloat(t.getAttribute("lat")||"")];if(Number.isNaN(e[0])||Number.isNaN(e[1]))return null;Eu(t,"ele",n=>{e.push(n)});const r=es(t,"time");return{coordinates:e,time:r?Es(r):null,extendedValues:mee(es(t,"extensions"))}}function vee(t){return gh(t,"line",e=>Object.assign({},oy(e,"color",n=>({stroke:`#${n}`})),Jq(e,"opacity",n=>({"stroke-opacity":n})),Jq(e,"width",n=>({"stroke-width":n*96/25.4}))))}function cL(t,e){const r=sy(e,["name","cmt","desc","type","time","keywords"]);for(const[i,a]of t)for(const s of Array.from(e.getElementsByTagNameNS(a,"*")))r[s.tagName.replace(":","_")]=Es(s)?.trim();const n=nl(e,"link");return n.length&&(r.links=n.map(i=>Object.assign({href:i.getAttribute("href")},sy(i,["text","type"])))),r}function _ee(t,e){const r=nl(t,e),n=[],i=[],a={};for(let s=0;s<r.length;s++){const o=yee(r[s]);if(o){n.push(o.coordinates),o.time&&i.push(o.time);for(const[c,h]of o.extendedValues){const d=c==="heart"?c:`${c.replace("gpxtpx:","")}s`;a[d]||(a[d]=Array(r.length).fill(null)),a[d][s]=h}}}if(!(n.length<2))return{line:n,times:i,extendedValues:a}}function KMe(t,e){const r=_ee(e,"rtept");if(r)return{type:"Feature",properties:Object.assign({_gpxType:"rte"},cL(t,e),vee(es(e,"extensions"))),geometry:{type:"LineString",coordinates:r.line}}}function JMe(t,e){const r=nl(e,"trkseg"),n=[],i=[],a=[];for(const c of r){const h=_ee(c,"trkpt");h&&(a.push(h),h.times?.length&&i.push(h.times))}if(a.length===0)return null;const s=a.length>1,o=Object.assign({_gpxType:"trk"},cL(t,e),vee(es(e,"extensions")),i.length?{coordinateProperties:{times:s?i:i[0]}}:{});for(let c=0;c<a.length;c++){const h=a[c];n.push(h.line),o.coordinateProperties||(o.coordinateProperties={});const d=o.coordinateProperties;for(const[m,b]of Object.entries(h.extendedValues))s?(d[m]||(d[m]=a.map(x=>new Array(x.line.length).fill(null))),d[m][c]=b):d[m]=b}return{type:"Feature",properties:o,geometry:s?{type:"MultiLineString",coordinates:n}:{type:"LineString",coordinates:n[0]}}}function QMe(t,e){const r=Object.assign(cL(t,e),sy(e,["sym"])),n=yee(e);return n?{type:"Feature",properties:r,geometry:{type:"Point",coordinates:n.coordinates}}:null}function*bee(t){const e=t,r="gpxx",n="http://www.garmin.com/xmlschemas/GpxExtensions/v3",i=[[r,n]],a=e.getElementsByTagName("gpx")[0]?.attributes;if(a)for(const s of Array.from(a))s.name?.startsWith("xmlns:")&&s.value!==n&&i.push([s.name,s.value]);for(const s of nl(e,"trk")){const o=JMe(i,s);o&&(yield o)}for(const s of nl(e,"rte")){const o=KMe(i,s);o&&(yield o)}for(const s of nl(e,"wpt")){const o=QMe(i,s);o&&(yield o)}}function eDe(t){return{type:"FeatureCollection",features:Array.from(bee(t))}}const tDe="http://www.garmin.com/xmlschemas/ActivityExtension/v2",rDe=[["heartRate","heartRates"],["Cadence","cadences"],["Speed","speeds"],["Watts","watts"]],nDe=[["TotalTimeSeconds","totalTimeSeconds"],["DistanceMeters","distanceMeters"],["MaximumSpeed","maxSpeed"],["AverageHeartRateBpm","avgHeartRate"],["MaximumHeartRateBpm","maxHeartRate"],["AvgSpeed","avgSpeed"],["AvgWatts","avgWatts"],["MaxWatts","maxWatts"]];function xee(t,e){const r=[];for(const[n,i]of e){let a=es(t,n);if(!a){const o=t.getElementsByTagNameNS(tDe,n);o.length&&(a=o[0])}const s=Number.parseFloat(Es(a));Number.isNaN(s)||r.push([i,s])}return r}function iDe(t){const e=[Eu(t,"LongitudeDegrees"),Eu(t,"LatitudeDegrees")];if(e[0]===void 0||Number.isNaN(e[0])||e[1]===void 0||Number.isNaN(e[1]))return null;const r=es(t,"HeartRateBpm"),n=Es(es(t,"Time"));return es(t,"AltitudeMeters",i=>{const a=Number.parseFloat(Es(i));Number.isNaN(a)||e.push(a)}),{coordinates:e,time:n||null,heartRate:r?Number.parseFloat(Es(r)):null,extensions:xee(t,rDe)}}function aDe(t){const e=nl(t,"Trackpoint"),r=[],n=[],i=[];if(e.length<2)return null;const a={},s={extendedProperties:a};for(let o=0;o<e.length;o++){const c=iDe(e[o]);if(c===null)continue;r.push(c.coordinates);const{time:h,heartRate:d,extensions:m}=c;h&&n.push(h),d&&i.push(d);for(const[b,x]of m)a[b]||(a[b]=Array(e.length).fill(null)),a[b][o]=x}return r.length<2?null:Object.assign(s,{line:r,times:n,heartRates:i})}function Qq(t){const e=nl(t,"Track"),r=[],n=[],i=[],a=[];let s;const o=Object.assign(Object.fromEntries(xee(t,nDe)),gh(t,"Name",c=>({name:Es(c)})));for(const c of e)s=aDe(c),s&&(r.push(s.line),s.times.length&&n.push(s.times),s.heartRates.length&&i.push(s.heartRates),a.push(s.extendedProperties));for(let c=0;c<a.length;c++){const h=a[c];for(const d in h)e.length===1?s&&(o[d]=s.extendedProperties[d]):(o[d]||(o[d]=r.map(m=>Array(m.length).fill(null))),o[d][c]=h[d])}return r.length===0?null:((n.length||i.length)&&(o.coordinateProperties=Object.assign(n.length?{times:r.length===1?n[0]:n}:{},i.length?{heart:r.length===1?i[0]:i}:{})),{type:"Feature",properties:o,geometry:r.length===1?{type:"LineString",coordinates:r[0]}:{type:"MultiLineString",coordinates:r}})}function*wee(t){for(const e of nl(t,"Lap")){const r=Qq(e);r&&(yield r)}for(const e of nl(t,"Courses")){const r=Qq(e);r&&(yield r)}}function oDe(t){return{type:"FeatureCollection",features:Array.from(wee(t))}}function See(t,e){const r={},n=e==="stroke"||e==="fill"?e:`${e}-color`;return t[0]==="#"&&(t=t.substring(1)),t.length===6||t.length===3?r[n]=`#${t}`:t.length===8&&(r[`${e}-opacity`]=Number.parseInt(t.substring(0,2),16)/255,r[n]=`#${t.substring(6,8)}${t.substring(4,6)}${t.substring(2,4)}`),r}function $E(t,e,r){const n={};return Eu(t,e,i=>{n[r]=i}),n}function hL(t,e){return gh(t,"color",r=>See(Es(r),e))}function fL(t){return gh(t,"Icon",(e,r)=>(oy(e,"href",n=>{r.icon=n}),r))}function sDe(t){return gh(t,"IconStyle",e=>Object.assign(hL(e,"icon"),$E(e,"scale","icon-scale"),$E(e,"heading","icon-heading"),gh(e,"hotSpot",r=>{const n=Number.parseFloat(r.getAttribute("x")||""),i=Number.parseFloat(r.getAttribute("y")||""),a=r.getAttribute("xunits")||"",s=r.getAttribute("yunits")||"";return!Number.isNaN(n)&&!Number.isNaN(i)?{"icon-offset":[n,i],"icon-offset-units":[a,s]}:{}}),fL(e)))}function lDe(t){return gh(t,"LabelStyle",e=>Object.assign(hL(e,"label"),$E(e,"scale","label-scale")))}function uDe(t){return gh(t,"LineStyle",e=>Object.assign(hL(e,"stroke"),$E(e,"width","stroke-width")))}function cDe(t){return gh(t,"PolyStyle",(e,r)=>Object.assign(r,gh(e,"color",n=>See(Es(n),"fill")),oy(e,"fill",n=>{if(n==="0")return{"fill-opacity":0}}),oy(e,"outline",n=>{if(n==="0")return{"stroke-opacity":0}})))}function z3(t){return Object.assign({},cDe(t),uDe(t),lDe(t),sDe(t))}const hDe=/\s*/g,fDe=/^\s*|\s*$/g,dDe=/\s+/;function Eee(t){return t.replace(hDe,"").split(",").map(Number.parseFloat).filter(e=>!Number.isNaN(e)).slice(0,3)}function mM(t){return t.replace(fDe,"").split(dDe).map(Eee).filter(e=>e.length>=2)}function pDe(t){let e=nl(t,"coord");e.length===0&&(e=XMe(t,"coord","*"));const r=e.map(n=>Es(n).split(" ").map(Number.parseFloat));return r.length===0?null:{geometry:r.length>2?{type:"LineString",coordinates:r}:{type:"Point",coordinates:r[0]},times:nl(t,"when").map(n=>Es(n))}}function Tee(t){if(t.length===0)return t;const e=t[0],r=t[t.length-1];let n=!0;for(let i=0;i<Math.max(e.length,r.length);i++)if(e[i]!==r[i]){n=!1;break}return n?t:t.concat([t[0]])}function SS(t){return Es(es(t,"coordinates"))}function Cee(t){let e=[],r=[];for(let n=0;n<t.childNodes.length;n++){const i=t.childNodes.item(n);if(Qx(i))switch(i.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{const a=Cee(i);e=e.concat(a.geometries),r=r.concat(a.coordTimes);break}case"Point":{const a=Eee(SS(i));a.length>=2&&e.push({type:"Point",coordinates:a});break}case"LinearRing":case"LineString":{const a=mM(SS(i));a.length>=2&&e.push({type:"LineString",coordinates:a});break}case"Polygon":{const a=[];for(const s of nl(i,"LinearRing")){const o=Tee(mM(SS(s)));o.length>=4&&a.push(o)}a.length&&e.push({type:"Polygon",coordinates:a});break}case"Track":case"gx:Track":{const a=pDe(i);if(!a)break;const{times:s,geometry:o}=a;e.push(o),s.length&&r.push(s);break}}}return{geometries:e,coordTimes:r}}const Tv=t=>Number(t),yM={string:t=>t,int:Tv,uint:Tv,short:Tv,ushort:Tv,float:Tv,double:Tv,bool:t=>!!t};function dL(t,e){return gh(t,"ExtendedData",(r,n)=>{for(const i of nl(r,"Data"))n[i.getAttribute("name")||""]=Es(es(i,"value"));for(const i of nl(r,"SimpleData")){const a=i.getAttribute("name")||"",s=e[a]||yM.string;n[a]=s(Es(i))}return n})}function pL(t){const e=es(t,"description");for(const r of Array.from(e?.childNodes||[]))if(r.nodeType===4)return{description:{"@type":"html",value:Es(r)}};return{}}function gL(t){return gh(t,"TimeSpan",e=>({timespan:{begin:Es(es(e,"begin")),end:Es(es(e,"end"))}}))}function mL(t){return gh(t,"TimeStamp",e=>({timestamp:Es(es(e,"when"))}))}function yL(t,e){return oy(t,"styleUrl",r=>(r=VE(r),e[r]?Object.assign({styleUrl:r},e[r]):{styleUrl:r}))}var Ih;(function(t){t.ABSOLUTE="absolute",t.RELATIVE_TO_GROUND="relativeToGround",t.CLAMP_TO_GROUND="clampToGround",t.CLAMP_TO_SEAFLOOR="clampToSeaFloor",t.RELATIVE_TO_SEAFLOOR="relativeToSeaFloor"})(Ih||(Ih={}));function gDe(t){switch(t?.textContent){case Ih.ABSOLUTE:return Ih.ABSOLUTE;case Ih.CLAMP_TO_GROUND:return Ih.CLAMP_TO_GROUND;case Ih.CLAMP_TO_SEAFLOOR:return Ih.CLAMP_TO_SEAFLOOR;case Ih.RELATIVE_TO_GROUND:return Ih.RELATIVE_TO_GROUND;case Ih.RELATIVE_TO_SEAFLOOR:return Ih.RELATIVE_TO_SEAFLOOR}return null}function mDe(t){return es(t,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[Tee(mM(SS(t)))]}}:_De(t)}const yDe=Math.PI/180;function vDe(t,e,r){const n=[(t[0]+t[2])/2,(t[1]+t[3])/2];return[e[0].map(i=>{const a=i[1]-n[1],s=i[0]-n[0],o=Math.sqrt(a**2+s**2),c=Math.atan2(a,s)+r*yDe;return[n[0]+Math.cos(c)*o,n[1]+Math.sin(c)*o]})]}function _De(t){const e=es(t,"LatLonBox");if(e){const r=Eu(e,"north"),n=Eu(e,"west"),i=Eu(e,"east"),a=Eu(e,"south"),s=Eu(e,"rotation");if(typeof r=="number"&&typeof a=="number"&&typeof n=="number"&&typeof i=="number"){const o=[n,a,i,r];let c=[[[n,r],[i,r],[i,a],[n,a],[n,r]]];return typeof s=="number"&&(c=vDe(o,c,s)),{bbox:o,geometry:{type:"Polygon",coordinates:c}}}}return null}function Aee(t,e,r,n){const i=mDe(t),a=i?.geometry||null;if(!a&&n.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign({"@geometry-type":"groundoverlay"},sy(t,["name","address","visibility","open","phoneNumber","description"]),pL(t),yL(t,e),z3(t),fL(t),dL(t,r),gL(t),mL(t))};i?.bbox&&(s.bbox=i.bbox),s.properties?.visibility!==void 0&&(s.properties.visibility=s.properties.visibility!=="0");const o=t.getAttribute("id");return o!==null&&o!==""&&(s.id=o),s}function bDe(t){const e=es(t,"Region");return e?{coordinateBox:wDe(e),lod:xDe(t)}:null}function xDe(t){const e=es(t,"Lod");return e?[Eu(e,"minLodPixels")??-1,Eu(e,"maxLodPixels")??-1,Eu(e,"minFadeExtent")??null,Eu(e,"maxFadeExtent")??null]:null}function wDe(t){const e=es(t,"LatLonAltBox");if(e){const r=Eu(e,"north"),n=Eu(e,"west"),i=Eu(e,"east"),a=Eu(e,"south");if(gDe(es(e,"altitudeMode")||es(e,"gx:altitudeMode"))&&console.debug("Encountered an unsupported feature of KML for togeojson: please contact developers for support of altitude mode."),typeof r=="number"&&typeof a=="number"&&typeof n=="number"&&typeof i=="number")return{bbox:[n,a,i,r],geometry:{type:"Polygon",coordinates:[[[n,r],[i,r],[i,a],[n,a],[n,r]]]}}}return null}function SDe(t){const e=es(t,"Link");return e?sy(e,["href","refreshMode","refreshInterval","viewRefreshMode","viewRefreshTime","viewBoundScale","viewFormat","httpQuery"]):{}}function Iee(t,e,r,n){const i=bDe(t),a=i?.coordinateBox?.geometry||null;if(!a&&n.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign({"@geometry-type":"networklink"},sy(t,["name","address","visibility","open","phoneNumber","styleUrl","refreshVisibility","flyToView","description"]),pL(t),yL(t,e),z3(t),fL(t),dL(t,r),gL(t),mL(t),SDe(t),i?.lod?{lod:i.lod}:{})};i?.coordinateBox?.bbox&&(s.bbox=i.coordinateBox.bbox),s.properties?.visibility!==void 0&&(s.properties.visibility=s.properties.visibility!=="0");const o=t.getAttribute("id");return o!==null&&o!==""&&(s.id=o),s}function EDe(t){return t.length===0?null:t.length===1?t[0]:{type:"GeometryCollection",geometries:t}}function Pee(t,e,r,n){const{coordTimes:i,geometries:a}=Cee(t),s=EDe(a);if(!s&&n.skipNullGeometry)return null;const o={type:"Feature",geometry:s,properties:Object.assign(sy(t,["name","address","visibility","open","phoneNumber","description"]),pL(t),yL(t,e),z3(t),dL(t,r),gL(t),mL(t),i.length?{coordinateProperties:{times:i.length===1?i[0]:i}}:{})};o.properties?.visibility!==void 0&&(o.properties.visibility=o.properties.visibility!=="0");const c=t.getAttribute("id");return c!==null&&c!==""&&(o.id=c),o}function TDe(t){let e=t.getAttribute("id");const r=t.parentNode;return!e&&Qx(r)&&r.localName==="CascadingStyle"&&(e=r.getAttribute("kml:id")||r.getAttribute("id")),VE(e||"")}function kee(t){const e={};for(const r of nl(t,"Style"))e[TDe(r)]=z3(r);for(const r of nl(t,"StyleMap")){const n=VE(r.getAttribute("id")||"");oy(r,"styleUrl",i=>{i=VE(i),e[i]&&(e[n]=e[i])})}return e}function Ree(t){const e={};for(const r of nl(t,"SimpleField"))e[r.getAttribute("name")||""]=yM[r.getAttribute("type")||""]||yM.string;return e}const CDe=["name","visibility","open","address","description","phoneNumber","visibility"];function ADe(t){const e={};for(const r of Array.from(t.childNodes))Qx(r)&&CDe.includes(r.tagName)&&(e[r.tagName]=Es(r));return{type:"folder",meta:e,children:[]}}function IDe(t,e={skipNullGeometry:!1}){const r=t,n=kee(r),i=Ree(r),a={type:"root",children:[]};function s(o,c,h){if(Qx(o))switch(o.tagName){case"GroundOverlay":{const d=Aee(o,n,i,h);d&&c.children.push(d);break}case"Placemark":{const d=Pee(o,n,i,h);d&&c.children.push(d);break}case"Folder":{const d=ADe(o);c.children.push(d),c=d;break}case"NetworkLink":{const d=Iee(o,n,i,h);d&&c.children.push(d);break}}if(o.childNodes)for(let d=0;d<o.childNodes.length;d++)s(o.childNodes[d],c,h)}return s(r,a,e),a}function*Mee(t,e={skipNullGeometry:!1}){const r=t,n=kee(r),i=Ree(r);for(const a of nl(r,"Placemark")){const s=Pee(a,n,i,e);s&&(yield s)}for(const a of nl(r,"GroundOverlay")){const s=Aee(a,n,i,e);s&&(yield s)}for(const a of nl(r,"NetworkLink")){const s=Iee(a,n,i,e);s&&(yield s)}}function PDe(t,e={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(Mee(t,e))}}const kDe=Object.freeze(Object.defineProperty({__proto__:null,gpx:eDe,gpxGen:bee,kml:PDe,kmlGen:Mee,kmlWithFolders:IDe,tcx:oDe,tcxGen:wee},Symbol.toStringTag,{value:"Module"}));async function RDe(t){return await new Promise((r,n)=>{B3(t.filename).then(i=>{const a=()=>t.protocolId==="tcx"?kDe[t.protocolId](new DOMParser().parseFromString(i,"text/xml")):nee[t.protocolId](new DOMParser().parseFromString(i,"text/xml"));a()?r(a()):n("Conversion failed")})})}const yP=async t=>{const e=F3(t.url),r=await RDe(e);if(r!==void 0)return{data:r};throw new Error("XML not found "+e.filename)},vM=t=>{const e=va({mapId:void 0}),r=te.useRef(!1);te.useEffect(()=>{if(!(!e.map||r.current))return e.map?.loadImage(t.imagePath).then(function(n){if(!n?.data){console.log("image "+t.imagePath+"could not be loaded");return}e.map?.addImage(t.imageId,n.data)}),()=>{e.map?.removeImage(t.imageId)}},[e.map,t])};vM.defaultProps={mapId:void 0};try{vM.displayName="useAddImage",vM.__docgenInfo={description:"",displayName:"useAddImage",props:{imageId:{defaultValue:null,description:"",name:"imageId",required:!0,type:{name:"string"}},imagePath:{defaultValue:null,description:"",name:"imagePath",required:!0,type:{name:"string"}}}}}catch{}const MDe=gt.createContext({}),_M=MDe.Provider;try{_M.displayName="SimpleDataContextProvider",_M.__docgenInfo={description:"",displayName:"SimpleDataContextProvider",props:{}}}catch{}var DDe={value:()=>{}};function Dee(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new ES(r)}function ES(t){this._=t}function ODe(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}ES.prototype=Dee.prototype={constructor:ES,on:function(t,e){var r=this._,n=ODe(t+"",r),i,a=-1,s=n.length;if(arguments.length<2){for(;++a<s;)if((i=(t=n[a]).type)&&(i=NDe(r[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(t=n[a]).type)r[i]=eH(r[i],t.name,e);else if(e==null)for(i in r)r[i]=eH(r[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new ES(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,a;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],n=0,i=a.length;n<i;++n)a[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,a=n.length;i<a;++i)n[i].value.apply(e,r)}};function NDe(t,e){for(var r=0,n=t.length,i;r<n;++r)if((i=t[r]).name===e)return i.value}function eH(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=DDe,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var bM="http://www.w3.org/1999/xhtml";const tH={svg:"http://www.w3.org/2000/svg",xhtml:bM,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function j3(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),tH.hasOwnProperty(e)?{space:tH[e],local:t}:t}function LDe(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===bM&&e.documentElement.namespaceURI===bM?e.createElement(t):e.createElementNS(r,t)}}function FDe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Oee(t){var e=j3(t);return(e.local?FDe:LDe)(e)}function BDe(){}function vL(t){return t==null?BDe:function(){return this.querySelector(t)}}function zDe(t){typeof t!="function"&&(t=vL(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=new Array(s),c,h,d=0;d<s;++d)(c=a[d])&&(h=t.call(c,c.__data__,d,a))&&("__data__"in c&&(h.__data__=c.__data__),o[d]=h);return new Pf(n,this._parents)}function jDe(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function UDe(){return[]}function Nee(t){return t==null?UDe:function(){return this.querySelectorAll(t)}}function VDe(t){return function(){return jDe(t.apply(this,arguments))}}function $De(t){typeof t=="function"?t=VDe(t):t=Nee(t);for(var e=this._groups,r=e.length,n=[],i=[],a=0;a<r;++a)for(var s=e[a],o=s.length,c,h=0;h<o;++h)(c=s[h])&&(n.push(t.call(c,c.__data__,h,s)),i.push(c));return new Pf(n,i)}function Lee(t){return function(){return this.matches(t)}}function Fee(t){return function(e){return e.matches(t)}}var qDe=Array.prototype.find;function HDe(t){return function(){return qDe.call(this.children,t)}}function WDe(){return this.firstElementChild}function GDe(t){return this.select(t==null?WDe:HDe(typeof t=="function"?t:Fee(t)))}var XDe=Array.prototype.filter;function YDe(){return Array.from(this.children)}function ZDe(t){return function(){return XDe.call(this.children,t)}}function KDe(t){return this.selectAll(t==null?YDe:ZDe(typeof t=="function"?t:Fee(t)))}function JDe(t){typeof t!="function"&&(t=Lee(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=[],c,h=0;h<s;++h)(c=a[h])&&t.call(c,c.__data__,h,a)&&o.push(c);return new Pf(n,this._parents)}function Bee(t){return new Array(t.length)}function QDe(){return new Pf(this._enter||this._groups.map(Bee),this._parents)}function qE(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}qE.prototype={constructor:qE,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function eOe(t){return function(){return t}}function tOe(t,e,r,n,i,a){for(var s=0,o,c=e.length,h=a.length;s<h;++s)(o=e[s])?(o.__data__=a[s],n[s]=o):r[s]=new qE(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function rOe(t,e,r,n,i,a,s){var o,c,h=new Map,d=e.length,m=a.length,b=new Array(d),x;for(o=0;o<d;++o)(c=e[o])&&(b[o]=x=s.call(c,c.__data__,o,e)+"",h.has(x)?i[o]=c:h.set(x,c));for(o=0;o<m;++o)x=s.call(t,a[o],o,a)+"",(c=h.get(x))?(n[o]=c,c.__data__=a[o],h.delete(x)):r[o]=new qE(t,a[o]);for(o=0;o<d;++o)(c=e[o])&&h.get(b[o])===c&&(i[o]=c)}function nOe(t){return t.__data__}function iOe(t,e){if(!arguments.length)return Array.from(this,nOe);var r=e?rOe:tOe,n=this._parents,i=this._groups;typeof t!="function"&&(t=eOe(t));for(var a=i.length,s=new Array(a),o=new Array(a),c=new Array(a),h=0;h<a;++h){var d=n[h],m=i[h],b=m.length,x=aOe(t.call(d,d&&d.__data__,h,n)),E=x.length,T=o[h]=new Array(E),A=s[h]=new Array(E),M=c[h]=new Array(b);r(d,m,T,A,M,x,e);for(var F=0,N=0,O,U;F<E;++F)if(O=T[F]){for(F>=N&&(N=F+1);!(U=A[N])&&++N<E;);O._next=U||null}}return s=new Pf(s,n),s._enter=o,s._exit=c,s}function aOe(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function oOe(){return new Pf(this._exit||this._groups.map(Bee),this._parents)}function sOe(t,e,r){var n=this.enter(),i=this,a=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),r==null?a.remove():r(a),n&&i?n.merge(i).order():i}function lOe(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,a=n.length,s=Math.min(i,a),o=new Array(i),c=0;c<s;++c)for(var h=r[c],d=n[c],m=h.length,b=o[c]=new Array(m),x,E=0;E<m;++E)(x=h[E]||d[E])&&(b[E]=x);for(;c<i;++c)o[c]=r[c];return new Pf(o,this._parents)}function uOe(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],i=n.length-1,a=n[i],s;--i>=0;)(s=n[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function cOe(t){t||(t=hOe);function e(m,b){return m&&b?t(m.__data__,b.__data__):!m-!b}for(var r=this._groups,n=r.length,i=new Array(n),a=0;a<n;++a){for(var s=r[a],o=s.length,c=i[a]=new Array(o),h,d=0;d<o;++d)(h=s[d])&&(c[d]=h);c.sort(e)}return new Pf(i,this._parents).order()}function hOe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function fOe(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function dOe(){return Array.from(this)}function pOe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,a=n.length;i<a;++i){var s=n[i];if(s)return s}return null}function gOe(){let t=0;for(const e of this)++t;return t}function mOe(){return!this.node()}function yOe(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i=e[r],a=0,s=i.length,o;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this}function vOe(t){return function(){this.removeAttribute(t)}}function _Oe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function bOe(t,e){return function(){this.setAttribute(t,e)}}function xOe(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function wOe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function SOe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function EOe(t,e){var r=j3(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?_Oe:vOe:typeof e=="function"?r.local?SOe:wOe:r.local?xOe:bOe)(r,e))}function zee(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function TOe(t){return function(){this.style.removeProperty(t)}}function COe(t,e,r){return function(){this.style.setProperty(t,e,r)}}function AOe(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function IOe(t,e,r){return arguments.length>1?this.each((e==null?TOe:typeof e=="function"?AOe:COe)(t,e,r??"")):Q0(this.node(),t)}function Q0(t,e){return t.style.getPropertyValue(e)||zee(t).getComputedStyle(t,null).getPropertyValue(e)}function POe(t){return function(){delete this[t]}}function kOe(t,e){return function(){this[t]=e}}function ROe(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function MOe(t,e){return arguments.length>1?this.each((e==null?POe:typeof e=="function"?ROe:kOe)(t,e)):this.node()[t]}function jee(t){return t.trim().split(/^|\s+/)}function _L(t){return t.classList||new Uee(t)}function Uee(t){this._node=t,this._names=jee(t.getAttribute("class")||"")}Uee.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Vee(t,e){for(var r=_L(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function $ee(t,e){for(var r=_L(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function DOe(t){return function(){Vee(this,t)}}function OOe(t){return function(){$ee(this,t)}}function NOe(t,e){return function(){(e.apply(this,arguments)?Vee:$ee)(this,t)}}function LOe(t,e){var r=jee(t+"");if(arguments.length<2){for(var n=_L(this.node()),i=-1,a=r.length;++i<a;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof e=="function"?NOe:e?DOe:OOe)(r,e))}function FOe(){this.textContent=""}function BOe(t){return function(){this.textContent=t}}function zOe(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function jOe(t){return arguments.length?this.each(t==null?FOe:(typeof t=="function"?zOe:BOe)(t)):this.node().textContent}function UOe(){this.innerHTML=""}function VOe(t){return function(){this.innerHTML=t}}function $Oe(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function qOe(t){return arguments.length?this.each(t==null?UOe:(typeof t=="function"?$Oe:VOe)(t)):this.node().innerHTML}function HOe(){this.nextSibling&&this.parentNode.appendChild(this)}function WOe(){return this.each(HOe)}function GOe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function XOe(){return this.each(GOe)}function YOe(t){var e=typeof t=="function"?t:Oee(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function ZOe(){return null}function KOe(t,e){var r=typeof t=="function"?t:Oee(t),n=e==null?ZOe:typeof e=="function"?e:vL(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function JOe(){var t=this.parentNode;t&&t.removeChild(this)}function QOe(){return this.each(JOe)}function eNe(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function tNe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function rNe(t){return this.select(t?tNe:eNe)}function nNe(t){return arguments.length?this.property("__data__",t):this.node().__data__}function iNe(t){return function(e){t.call(this,e,this.__data__)}}function aNe(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function oNe(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,i=e.length,a;r<i;++r)a=e[r],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++n]=a;++n?e.length=n:delete this.__on}}}function sNe(t,e,r){return function(){var n=this.__on,i,a=iNe(e);if(n){for(var s=0,o=n.length;s<o;++s)if((i=n[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=r),i.value=e;return}}this.addEventListener(t.type,a,r),i={type:t.type,name:t.name,value:e,listener:a,options:r},n?n.push(i):this.__on=[i]}}function lNe(t,e,r){var n=aNe(t+""),i,a=n.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,h=o.length,d;c<h;++c)for(i=0,d=o[c];i<a;++i)if((s=n[i]).type===d.type&&s.name===d.name)return d.value}return}for(o=e?sNe:oNe,i=0;i<a;++i)this.each(o(n[i],e,r));return this}function qee(t,e,r){var n=zee(t),i=n.CustomEvent;typeof i=="function"?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function uNe(t,e){return function(){return qee(this,t,e)}}function cNe(t,e){return function(){return qee(this,t,e.apply(this,arguments))}}function hNe(t,e){return this.each((typeof e=="function"?cNe:uNe)(t,e))}function*fNe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,a=n.length,s;i<a;++i)(s=n[i])&&(yield s)}var dNe=[null];function Pf(t,e){this._groups=t,this._parents=e}function e2(){return new Pf([[document.documentElement]],dNe)}function pNe(){return this}Pf.prototype=e2.prototype={constructor:Pf,select:zDe,selectAll:$De,selectChild:GDe,selectChildren:KDe,filter:JDe,data:iOe,enter:QDe,exit:oOe,join:sOe,merge:lOe,selection:pNe,order:uOe,sort:cOe,call:fOe,nodes:dOe,node:pOe,size:gOe,empty:mOe,each:yOe,attr:EOe,style:IOe,property:MOe,classed:LOe,text:jOe,html:qOe,raise:WOe,lower:XOe,append:YOe,insert:KOe,remove:QOe,clone:rNe,datum:nNe,on:lNe,dispatch:hNe,[Symbol.iterator]:fNe};function bL(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function Hee(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function t2(){}var ox=.7,HE=1/ox,k0="\\s*([+-]?\\d+)\\s*",sx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gNe=/^#([0-9a-f]{3,8})$/,mNe=new RegExp(`^rgb\\(${k0},${k0},${k0}\\)$`),yNe=new RegExp(`^rgb\\(${wd},${wd},${wd}\\)$`),vNe=new RegExp(`^rgba\\(${k0},${k0},${k0},${sx}\\)$`),_Ne=new RegExp(`^rgba\\(${wd},${wd},${wd},${sx}\\)$`),bNe=new RegExp(`^hsl\\(${sx},${wd},${wd}\\)$`),xNe=new RegExp(`^hsla\\(${sx},${wd},${wd},${sx}\\)$`),rH={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};bL(t2,lx,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:nH,formatHex:nH,formatHex8:wNe,formatHsl:SNe,formatRgb:iH,toString:iH});function nH(){return this.rgb().formatHex()}function wNe(){return this.rgb().formatHex8()}function SNe(){return Wee(this).formatHsl()}function iH(){return this.rgb().formatRgb()}function lx(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=gNe.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?aH(e):r===3?new Pc(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Lw(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Lw(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=mNe.exec(t))?new Pc(e[1],e[2],e[3],1):(e=yNe.exec(t))?new Pc(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=vNe.exec(t))?Lw(e[1],e[2],e[3],e[4]):(e=_Ne.exec(t))?Lw(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=bNe.exec(t))?lH(e[1],e[2]/100,e[3]/100,1):(e=xNe.exec(t))?lH(e[1],e[2]/100,e[3]/100,e[4]):rH.hasOwnProperty(t)?aH(rH[t]):t==="transparent"?new Pc(NaN,NaN,NaN,0):null}function aH(t){return new Pc(t>>16&255,t>>8&255,t&255,1)}function Lw(t,e,r,n){return n<=0&&(t=e=r=NaN),new Pc(t,e,r,n)}function ENe(t){return t instanceof t2||(t=lx(t)),t?(t=t.rgb(),new Pc(t.r,t.g,t.b,t.opacity)):new Pc}function xM(t,e,r,n){return arguments.length===1?ENe(t):new Pc(t,e,r,n??1)}function Pc(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}bL(Pc,xM,Hee(t2,{brighter(t){return t=t==null?HE:Math.pow(HE,t),new Pc(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ox:Math.pow(ox,t),new Pc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Pc(Um(this.r),Um(this.g),Um(this.b),WE(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:oH,formatHex:oH,formatHex8:TNe,formatRgb:sH,toString:sH}));function oH(){return`#${Rm(this.r)}${Rm(this.g)}${Rm(this.b)}`}function TNe(){return`#${Rm(this.r)}${Rm(this.g)}${Rm(this.b)}${Rm((isNaN(this.opacity)?1:this.opacity)*255)}`}function sH(){const t=WE(this.opacity);return`${t===1?"rgb(":"rgba("}${Um(this.r)}, ${Um(this.g)}, ${Um(this.b)}${t===1?")":`, ${t})`}`}function WE(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Um(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Rm(t){return t=Um(t),(t<16?"0":"")+t.toString(16)}function lH(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new vf(t,e,r,n)}function Wee(t){if(t instanceof vf)return new vf(t.h,t.s,t.l,t.opacity);if(t instanceof t2||(t=lx(t)),!t)return new vf;if(t instanceof vf)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),s=NaN,o=a-i,c=(a+i)/2;return o?(e===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-e)/o+2:s=(e-r)/o+4,o/=c<.5?a+i:2-a-i,s*=60):o=c>0&&c<1?0:s,new vf(s,o,c,t.opacity)}function CNe(t,e,r,n){return arguments.length===1?Wee(t):new vf(t,e,r,n??1)}function vf(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}bL(vf,CNe,Hee(t2,{brighter(t){return t=t==null?HE:Math.pow(HE,t),new vf(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ox:Math.pow(ox,t),new vf(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Pc(vP(t>=240?t-240:t+120,i,n),vP(t,i,n),vP(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new vf(uH(this.h),Fw(this.s),Fw(this.l),WE(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=WE(this.opacity);return`${t===1?"hsl(":"hsla("}${uH(this.h)}, ${Fw(this.s)*100}%, ${Fw(this.l)*100}%${t===1?")":`, ${t})`}`}}));function uH(t){return t=(t||0)%360,t<0?t+360:t}function Fw(t){return Math.max(0,Math.min(1,t||0))}function vP(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const Gee=t=>()=>t;function ANe(t,e){return function(r){return t+r*e}}function INe(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function PNe(t){return(t=+t)==1?Xee:function(e,r){return r-e?INe(e,r,t):Gee(isNaN(e)?r:e)}}function Xee(t,e){var r=e-t;return r?ANe(t,r):Gee(isNaN(t)?e:t)}const cH=(function t(e){var r=PNe(e);function n(i,a){var s=r((i=xM(i)).r,(a=xM(a)).r),o=r(i.g,a.g),c=r(i.b,a.b),h=Xee(i.opacity,a.opacity);return function(d){return i.r=s(d),i.g=o(d),i.b=c(d),i.opacity=h(d),i+""}}return n.gamma=t,n})(1);function sg(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var wM=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_P=new RegExp(wM.source,"g");function kNe(t){return function(){return t}}function RNe(t){return function(e){return t(e)+""}}function MNe(t,e){var r=wM.lastIndex=_P.lastIndex=0,n,i,a,s=-1,o=[],c=[];for(t=t+"",e=e+"";(n=wM.exec(t))&&(i=_P.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,c.push({i:s,x:sg(n,i)})),r=_P.lastIndex;return r<e.length&&(a=e.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?c[0]?RNe(c[0].x):kNe(e):(e=c.length,function(h){for(var d=0,m;d<e;++d)o[(m=c[d]).i]=m.x(h);return o.join("")})}var hH=180/Math.PI,SM={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Yee(t,e,r,n,i,a){var s,o,c;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(c=t*r+e*n)&&(r-=t*c,n-=e*c),(o=Math.sqrt(r*r+n*n))&&(r/=o,n/=o,c/=o),t*n<e*r&&(t=-t,e=-e,c=-c,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*hH,skewX:Math.atan(c)*hH,scaleX:s,scaleY:o}}var Bw;function DNe(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?SM:Yee(e.a,e.b,e.c,e.d,e.e,e.f)}function ONe(t){return t==null||(Bw||(Bw=document.createElementNS("http://www.w3.org/2000/svg","g")),Bw.setAttribute("transform",t),!(t=Bw.transform.baseVal.consolidate()))?SM:(t=t.matrix,Yee(t.a,t.b,t.c,t.d,t.e,t.f))}function Zee(t,e,r,n){function i(h){return h.length?h.pop()+" ":""}function a(h,d,m,b,x,E){if(h!==m||d!==b){var T=x.push("translate(",null,e,null,r);E.push({i:T-4,x:sg(h,m)},{i:T-2,x:sg(d,b)})}else(m||b)&&x.push("translate("+m+e+b+r)}function s(h,d,m,b){h!==d?(h-d>180?d+=360:d-h>180&&(h+=360),b.push({i:m.push(i(m)+"rotate(",null,n)-2,x:sg(h,d)})):d&&m.push(i(m)+"rotate("+d+n)}function o(h,d,m,b){h!==d?b.push({i:m.push(i(m)+"skewX(",null,n)-2,x:sg(h,d)}):d&&m.push(i(m)+"skewX("+d+n)}function c(h,d,m,b,x,E){if(h!==m||d!==b){var T=x.push(i(x)+"scale(",null,",",null,")");E.push({i:T-4,x:sg(h,m)},{i:T-2,x:sg(d,b)})}else(m!==1||b!==1)&&x.push(i(x)+"scale("+m+","+b+")")}return function(h,d){var m=[],b=[];return h=t(h),d=t(d),a(h.translateX,h.translateY,d.translateX,d.translateY,m,b),s(h.rotate,d.rotate,m,b),o(h.skewX,d.skewX,m,b),c(h.scaleX,h.scaleY,d.scaleX,d.scaleY,m,b),h=d=null,function(x){for(var E=-1,T=b.length,A;++E<T;)m[(A=b[E]).i]=A.x(x);return m.join("")}}}var NNe=Zee(DNe,"px, ","px)","deg)"),LNe=Zee(ONe,", ",")",")"),e_=0,G1=0,b1=0,Kee=1e3,GE,X1,XE=0,ly=0,U3=0,ux=typeof performance=="object"&&performance.now?performance:Date,Jee=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function xL(){return ly||(Jee(FNe),ly=ux.now()+U3)}function FNe(){ly=0}function YE(){this._call=this._time=this._next=null}YE.prototype=Qee.prototype={constructor:YE,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?xL():+r)+(e==null?0:+e),!this._next&&X1!==this&&(X1?X1._next=this:GE=this,X1=this),this._call=t,this._time=r,EM()},stop:function(){this._call&&(this._call=null,this._time=1/0,EM())}};function Qee(t,e,r){var n=new YE;return n.restart(t,e,r),n}function BNe(){xL(),++e_;for(var t=GE,e;t;)(e=ly-t._time)>=0&&t._call.call(void 0,e),t=t._next;--e_}function fH(){ly=(XE=ux.now())+U3,e_=G1=0;try{BNe()}finally{e_=0,jNe(),ly=0}}function zNe(){var t=ux.now(),e=t-XE;e>Kee&&(U3-=e,XE=t)}function jNe(){for(var t,e=GE,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:GE=r);X1=t,EM(n)}function EM(t){if(!e_){G1&&(G1=clearTimeout(G1));var e=t-ly;e>24?(t<1/0&&(G1=setTimeout(fH,t-ux.now()-U3)),b1&&(b1=clearInterval(b1))):(b1||(XE=ux.now(),b1=setInterval(zNe,Kee)),e_=1,Jee(fH))}}function dH(t,e,r){var n=new YE;return e=e==null?0:+e,n.restart(i=>{n.stop(),t(i+e)},e,r),n}var UNe=Dee("start","end","cancel","interrupt"),VNe=[],ete=0,pH=1,TM=2,TS=3,gH=4,CM=5,CS=6;function V3(t,e,r,n,i,a){var s=t.__transition;if(!s)t.__transition={};else if(r in s)return;$Ne(t,r,{name:e,index:n,group:i,on:UNe,tween:VNe,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:ete})}function wL(t,e){var r=Lf(t,e);if(r.state>ete)throw new Error("too late; already scheduled");return r}function Dd(t,e){var r=Lf(t,e);if(r.state>TS)throw new Error("too late; already running");return r}function Lf(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function $Ne(t,e,r){var n=t.__transition,i;n[e]=r,r.timer=Qee(a,0,r.time);function a(h){r.state=pH,r.timer.restart(s,r.delay,r.time),r.delay<=h&&s(h-r.delay)}function s(h){var d,m,b,x;if(r.state!==pH)return c();for(d in n)if(x=n[d],x.name===r.name){if(x.state===TS)return dH(s);x.state===gH?(x.state=CS,x.timer.stop(),x.on.call("interrupt",t,t.__data__,x.index,x.group),delete n[d]):+d<e&&(x.state=CS,x.timer.stop(),x.on.call("cancel",t,t.__data__,x.index,x.group),delete n[d])}if(dH(function(){r.state===TS&&(r.state=gH,r.timer.restart(o,r.delay,r.time),o(h))}),r.state=TM,r.on.call("start",t,t.__data__,r.index,r.group),r.state===TM){for(r.state=TS,i=new Array(b=r.tween.length),d=0,m=-1;d<b;++d)(x=r.tween[d].value.call(t,t.__data__,r.index,r.group))&&(i[++m]=x);i.length=m+1}}function o(h){for(var d=h<r.duration?r.ease.call(null,h/r.duration):(r.timer.restart(c),r.state=CM,1),m=-1,b=i.length;++m<b;)i[m].call(t,d);r.state===CM&&(r.on.call("end",t,t.__data__,r.index,r.group),c())}function c(){r.state=CS,r.timer.stop(),delete n[e];for(var h in n)return;delete t.__transition}}function qNe(t,e){var r=t.__transition,n,i,a=!0,s;if(r){e=e==null?null:e+"";for(s in r){if((n=r[s]).name!==e){a=!1;continue}i=n.state>TM&&n.state<CM,n.state=CS,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[s]}a&&delete t.__transition}}function HNe(t){return this.each(function(){qNe(this,t)})}function WNe(t,e){var r,n;return function(){var i=Dd(this,t),a=i.tween;if(a!==r){n=r=a;for(var s=0,o=n.length;s<o;++s)if(n[s].name===e){n=n.slice(),n.splice(s,1);break}}i.tween=n}}function GNe(t,e,r){var n,i;if(typeof r!="function")throw new Error;return function(){var a=Dd(this,t),s=a.tween;if(s!==n){i=(n=s).slice();for(var o={name:e,value:r},c=0,h=i.length;c<h;++c)if(i[c].name===e){i[c]=o;break}c===h&&i.push(o)}a.tween=i}}function XNe(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=Lf(this.node(),r).tween,i=0,a=n.length,s;i<a;++i)if((s=n[i]).name===t)return s.value;return null}return this.each((e==null?WNe:GNe)(r,t,e))}function SL(t,e,r){var n=t._id;return t.each(function(){var i=Dd(this,n);(i.value||(i.value={}))[e]=r.apply(this,arguments)}),function(i){return Lf(i,n).value[e]}}function tte(t,e){var r;return(typeof e=="number"?sg:e instanceof lx?cH:(r=lx(e))?(e=r,cH):MNe)(t,e)}function YNe(t){return function(){this.removeAttribute(t)}}function ZNe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function KNe(t,e,r){var n,i=r+"",a;return function(){var s=this.getAttribute(t);return s===i?null:s===n?a:a=e(n=s,r)}}function JNe(t,e,r){var n,i=r+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===n?a:a=e(n=s,r)}}function QNe(t,e,r){var n,i,a;return function(){var s,o=r(this),c;return o==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=o+"",s===c?null:s===n&&c===i?a:(i=c,a=e(n=s,o)))}}function eLe(t,e,r){var n,i,a;return function(){var s,o=r(this),c;return o==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=o+"",s===c?null:s===n&&c===i?a:(i=c,a=e(n=s,o)))}}function tLe(t,e){var r=j3(t),n=r==="transform"?LNe:tte;return this.attrTween(t,typeof e=="function"?(r.local?eLe:QNe)(r,n,SL(this,"attr."+t,e)):e==null?(r.local?ZNe:YNe)(r):(r.local?JNe:KNe)(r,n,e))}function rLe(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function nLe(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function iLe(t,e){var r,n;function i(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&nLe(t,a)),r}return i._value=e,i}function aLe(t,e){var r,n;function i(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&rLe(t,a)),r}return i._value=e,i}function oLe(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=j3(t);return this.tween(r,(n.local?iLe:aLe)(n,e))}function sLe(t,e){return function(){wL(this,t).delay=+e.apply(this,arguments)}}function lLe(t,e){return e=+e,function(){wL(this,t).delay=e}}function uLe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?sLe:lLe)(e,t)):Lf(this.node(),e).delay}function cLe(t,e){return function(){Dd(this,t).duration=+e.apply(this,arguments)}}function hLe(t,e){return e=+e,function(){Dd(this,t).duration=e}}function fLe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?cLe:hLe)(e,t)):Lf(this.node(),e).duration}function dLe(t,e){if(typeof e!="function")throw new Error;return function(){Dd(this,t).ease=e}}function pLe(t){var e=this._id;return arguments.length?this.each(dLe(e,t)):Lf(this.node(),e).ease}function gLe(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;Dd(this,t).ease=r}}function mLe(t){if(typeof t!="function")throw new Error;return this.each(gLe(this._id,t))}function yLe(t){typeof t!="function"&&(t=Lee(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=[],c,h=0;h<s;++h)(c=a[h])&&t.call(c,c.__data__,h,a)&&o.push(c);return new Ap(n,this._parents,this._name,this._id)}function vLe(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,i=r.length,a=Math.min(n,i),s=new Array(n),o=0;o<a;++o)for(var c=e[o],h=r[o],d=c.length,m=s[o]=new Array(d),b,x=0;x<d;++x)(b=c[x]||h[x])&&(m[x]=b);for(;o<n;++o)s[o]=e[o];return new Ap(s,this._parents,this._name,this._id)}function _Le(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function bLe(t,e,r){var n,i,a=_Le(e)?wL:Dd;return function(){var s=a(this,t),o=s.on;o!==n&&(i=(n=o).copy()).on(e,r),s.on=i}}function xLe(t,e){var r=this._id;return arguments.length<2?Lf(this.node(),r).on.on(t):this.each(bLe(r,t,e))}function wLe(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function SLe(){return this.on("end.remove",wLe(this._id))}function ELe(t){var e=this._name,r=this._id;typeof t!="function"&&(t=vL(t));for(var n=this._groups,i=n.length,a=new Array(i),s=0;s<i;++s)for(var o=n[s],c=o.length,h=a[s]=new Array(c),d,m,b=0;b<c;++b)(d=o[b])&&(m=t.call(d,d.__data__,b,o))&&("__data__"in d&&(m.__data__=d.__data__),h[b]=m,V3(h[b],e,r,b,h,Lf(d,r)));return new Ap(a,this._parents,e,r)}function TLe(t){var e=this._name,r=this._id;typeof t!="function"&&(t=Nee(t));for(var n=this._groups,i=n.length,a=[],s=[],o=0;o<i;++o)for(var c=n[o],h=c.length,d,m=0;m<h;++m)if(d=c[m]){for(var b=t.call(d,d.__data__,m,c),x,E=Lf(d,r),T=0,A=b.length;T<A;++T)(x=b[T])&&V3(x,e,r,T,b,E);a.push(b),s.push(d)}return new Ap(a,s,e,r)}var CLe=e2.prototype.constructor;function ALe(){return new CLe(this._groups,this._parents)}function ILe(t,e){var r,n,i;return function(){var a=Q0(this,t),s=(this.style.removeProperty(t),Q0(this,t));return a===s?null:a===r&&s===n?i:i=e(r=a,n=s)}}function rte(t){return function(){this.style.removeProperty(t)}}function PLe(t,e,r){var n,i=r+"",a;return function(){var s=Q0(this,t);return s===i?null:s===n?a:a=e(n=s,r)}}function kLe(t,e,r){var n,i,a;return function(){var s=Q0(this,t),o=r(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(t),Q0(this,t))),s===c?null:s===n&&c===i?a:(i=c,a=e(n=s,o))}}function RLe(t,e){var r,n,i,a="style."+e,s="end."+a,o;return function(){var c=Dd(this,t),h=c.on,d=c.value[a]==null?o||(o=rte(e)):void 0;(h!==r||i!==d)&&(n=(r=h).copy()).on(s,i=d),c.on=n}}function MLe(t,e,r){var n=(t+="")=="transform"?NNe:tte;return e==null?this.styleTween(t,ILe(t,n)).on("end.style."+t,rte(t)):typeof e=="function"?this.styleTween(t,kLe(t,n,SL(this,"style."+t,e))).each(RLe(this._id,t)):this.styleTween(t,PLe(t,n,e),r).on("end.style."+t,null)}function DLe(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function OLe(t,e,r){var n,i;function a(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&DLe(t,s,r)),n}return a._value=e,a}function NLe(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,OLe(t,e,r??""))}function LLe(t){return function(){this.textContent=t}}function FLe(t){return function(){var e=t(this);this.textContent=e??""}}function BLe(t){return this.tween("text",typeof t=="function"?FLe(SL(this,"text",t)):LLe(t==null?"":t+""))}function zLe(t){return function(e){this.textContent=t.call(this,e)}}function jLe(t){var e,r;function n(){var i=t.apply(this,arguments);return i!==r&&(e=(r=i)&&zLe(i)),e}return n._value=t,n}function ULe(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,jLe(t))}function VLe(){for(var t=this._name,e=this._id,r=nte(),n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,c,h=0;h<o;++h)if(c=s[h]){var d=Lf(c,e);V3(c,t,r,h,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Ap(n,this._parents,t,r)}function $Le(){var t,e,r=this,n=r._id,i=r.size();return new Promise(function(a,s){var o={value:s},c={value:function(){--i===0&&a()}};r.each(function(){var h=Dd(this,n),d=h.on;d!==t&&(e=(t=d).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(c)),h.on=e}),i===0&&a()})}var qLe=0;function Ap(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function nte(){return++qLe}var rp=e2.prototype;Ap.prototype={constructor:Ap,select:ELe,selectAll:TLe,selectChild:rp.selectChild,selectChildren:rp.selectChildren,filter:yLe,merge:vLe,selection:ALe,transition:VLe,call:rp.call,nodes:rp.nodes,node:rp.node,size:rp.size,empty:rp.empty,each:rp.each,on:xLe,attr:tLe,attrTween:oLe,style:MLe,styleTween:NLe,text:BLe,textTween:ULe,remove:SLe,tween:XNe,delay:uLe,duration:fLe,ease:pLe,easeVarying:mLe,end:$Le,[Symbol.iterator]:rp[Symbol.iterator]};function HLe(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var WLe={time:null,delay:0,duration:250,ease:HLe};function GLe(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function XLe(t){var e,r;t instanceof Ap?(e=t._id,t=t._name):(e=nte(),(r=WLe).time=xL(),t=t==null?null:t+"");for(var n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,c,h=0;h<o;++h)(c=s[h])&&V3(c,t,e,h,s,r||GLe(c,e));return new Ap(n,this._parents,t,e)}e2.prototype.interrupt=HNe;e2.prototype.transition=XLe;var mH={},bP={},xP=34,x1=10,wP=13;function ite(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+'] || ""'}).join(",")+"}")}function YLe(t,e){var r=ite(t);return function(n,i){return e(r(n),i,t)}}function yH(t){var e=Object.create(null),r=[];return t.forEach(function(n){for(var i in n)i in e||r.push(e[i]=i)}),r}function Ac(t,e){var r=t+"",n=r.length;return n<e?new Array(e-n+1).join(0)+r:r}function ZLe(t){return t<0?"-"+Ac(-t,6):t>9999?"+"+Ac(t,6):Ac(t,4)}function KLe(t){var e=t.getUTCHours(),r=t.getUTCMinutes(),n=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":ZLe(t.getUTCFullYear())+"-"+Ac(t.getUTCMonth()+1,2)+"-"+Ac(t.getUTCDate(),2)+(i?"T"+Ac(e,2)+":"+Ac(r,2)+":"+Ac(n,2)+"."+Ac(i,3)+"Z":n?"T"+Ac(e,2)+":"+Ac(r,2)+":"+Ac(n,2)+"Z":r||e?"T"+Ac(e,2)+":"+Ac(r,2)+"Z":"")}function JLe(t){var e=new RegExp('["'+t+`
\r]`),r=t.charCodeAt(0);function n(m,b){var x,E,T=i(m,function(A,M){if(x)return x(A,M-1);E=A,x=b?YLe(A,b):ite(A)});return T.columns=E||[],T}function i(m,b){var x=[],E=m.length,T=0,A=0,M,F=E<=0,N=!1;m.charCodeAt(E-1)===x1&&--E,m.charCodeAt(E-1)===wP&&--E;function O(){if(F)return bP;if(N)return N=!1,mH;var j,H=T,G;if(m.charCodeAt(H)===xP){for(;T++<E&&m.charCodeAt(T)!==xP||m.charCodeAt(++T)===xP;);return(j=T)>=E?F=!0:(G=m.charCodeAt(T++))===x1?N=!0:G===wP&&(N=!0,m.charCodeAt(T)===x1&&++T),m.slice(H+1,j-1).replace(/""/g,'"')}for(;T<E;){if((G=m.charCodeAt(j=T++))===x1)N=!0;else if(G===wP)N=!0,m.charCodeAt(T)===x1&&++T;else if(G!==r)continue;return m.slice(H,j)}return F=!0,m.slice(H,E)}for(;(M=O())!==bP;){for(var U=[];M!==mH&&M!==bP;)U.push(M),M=O();b&&(U=b(U,A++))==null||x.push(U)}return x}function a(m,b){return m.map(function(x){return b.map(function(E){return d(x[E])}).join(t)})}function s(m,b){return b==null&&(b=yH(m)),[b.map(d).join(t)].concat(a(m,b)).join(`
`)}function o(m,b){return b==null&&(b=yH(m)),a(m,b).join(`
`)}function c(m){return m.map(h).join(`
`)}function h(m){return m.map(d).join(t)}function d(m){return m==null?"":m instanceof Date?KLe(m):e.test(m+="")?'"'+m.replace(/"/g,'""')+'"':m}return{parse:n,parseRows:i,format:s,formatBody:o,formatRows:c,formatRow:h,formatValue:d}}var QLe=JLe(","),e6e=QLe.parse;function t6e(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function ate(t,e){return fetch(t,e).then(t6e)}function r6e(t){return function(e,r,n){return arguments.length===2&&typeof r=="function"&&(n=r,r=void 0),ate(e,r).then(function(i){return t(i,n)})}}var n6e=r6e(e6e);function i6e(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function a6e(t,e){return fetch(t,e).then(i6e)}function o6e(t){return(e,r)=>ate(e,r).then(n=>new DOMParser().parseFromString(n,t))}const s6e=o6e("application/xml");function Y1(t,e,r){this.k=t,this.x=e,this.y=r}Y1.prototype={constructor:Y1,scale:function(t){return t===1?this:new Y1(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Y1(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Y1.prototype;const vH=t=>{const[e,r]=te.useState();te.useEffect(()=>{if(!t.url)return;let i=null;t.format==="json"?i=a6e(t.url):t.format==="csv"?i=n6e(t.url):t.format==="xml"&&(i=s6e(t.url)),i&&i.then(a=>{if(t.format==="xml"){if(t.nodeType){const s=[];a.querySelectorAll(t.nodeType).forEach(o=>{typeof t.formatData=="function"&&s.push(t.formatData(o))}),r(s)}}else{let s=a;t.data_property&&(s=a[t.data_property]),typeof t.formatData=="function"?r(s.map(t.formatData)):r(s)}typeof t.onData=="function"&&t.onData()})},[t.url,t]);const n={data:e,setData:r};return J.jsx(_M,{value:n,children:t.children})};try{vH.displayName="SimpleDataProvider",vH.__docgenInfo={description:"",displayName:"SimpleDataProvider",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},format:{defaultValue:null,description:"",name:"format",required:!0,type:{name:"enum",value:[{value:'"json"'},{value:'"csv"'},{value:'"xml"'}]}},nodeType:{defaultValue:null,description:"",name:"nodeType",required:!0,type:{name:"string"}},data_property:{defaultValue:null,description:"",name:"data_property",required:!0,type:{name:"string"}},formatData:{defaultValue:null,description:"",name:"formatData",required:!1,type:{name:"((data: any) => any) | undefined"}},onData:{defaultValue:null,description:"",name:"onData",required:!0,type:{name:"() => void"}}}}}catch{}const AS=Ji(J.jsx("path",{d:"M12 4c4.41 0 8 3.59 8 8s-3.59 8-8 8-8-3.59-8-8 3.59-8 8-8m0-2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 10V8h-2v4H8l4 4 4-4z"})),IS=Ji(J.jsx("path",{d:"M12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0 2c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10m-1-10v4h2v-4h3l-4-4-4 4z"})),SP=Ji(J.jsx("path",{d:"M5 15H3v4c0 1.1.9 2 2 2h4v-2H5zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2m0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"})),l6e=t=>{let{transform:e}=t;return{...e,x:0}},np=Dr(kc)({padding:"4px",marginTop:"-3px",background:"none","&:hover":{background:"none"}});function AM(t){const e=WRe(),r=va({mapId:void 0});function n(m){const b=m.id&&r.map?.getLayer(m.id)?.source?r.map?.getLayer(m.id)?.source:void 0;let x=null;switch(m.type){case"geojson":if(m.config?.geojson)r.map?.fitBounds(dh(m.config?.geojson),t.fitBoundsOptions);else{if(!b)return;const E={type:"FeatureCollection",features:r.map?.querySourceFeatures(b)};E.features.length===0&&(r.map?.zoomTo(1),E.features=r.map?.querySourceFeatures(b)),x=dh(E)}break;case"vt":console.log("vt");break;case"wms":x=m?.config?.config?.layers?.[0]?.EX_GeographicBoundingBox;break;default:return}x&&r.map?.fitBounds(x,t.fitBoundsOptions)}const i=te.useMemo(()=>["order-background",...[...e.layers].map((b,x)=>"content_order_"+x),"order-labels"],[e.layers]),a=te.useMemo(()=>t.layers?t.layers:e?.layers?e.layers:[],[t.layers,e.layers]),s=te.useMemo(()=>t.setLayers?t.setLayers:e.setLayers,[t.setLayers,e.setLayers]),o=Q$(oL,{activationConstraint:{distance:5}}),c=Q$(UQ,{activationConstraint:{distance:5}}),h=BIe(c,o);function d(m){const b=m.active.id,x=m.over?.data?.current?.sortable.index;e.moveLayer(String(b),()=>x)}return J.jsxs(J.Fragment,{children:[J.jsx(jE,{layerIds:i,insertBeforeLayer:"_background"}),e?.symbolLayers?.length>0&&J.jsx(dp,{layerComponent:J.jsx(P0,{...e.vtLayerConfig,layers:e.symbolLayers,mapId:t?.mapId,insertBeforeLayer:"order-labels"}),setLayerState:m=>e.setSymbolLayers(m?.layers),visible:!0,configurable:!0,type:"layer",name:"Labels"},"background_labels"),J.jsx(UPe,{collisionDetection:$Ie,sensors:h,onDragEnd:m=>d(m),modifiers:[l6e],children:J.jsxs(eke,{items:a,strategy:JPe,children:[[...a].map((m,b)=>{if(!m?.id)return null;switch(m.type){case"geojson":return J.jsx(dp,{layerId:m.id,sortable:t.sortable,name:m?.name||m?.config?.type+" layer"||"unnamed layer",layerComponent:J.jsx(Dc,{...m.config,mapId:t?.mapId,layerId:m.id,insertBeforeLayer:"content_order_"+(a.length-1-b)}),buttons:J.jsxs(J.Fragment,{children:[J.jsx(np,{disabled:b===a.length-1,onClick:()=>{e.moveDown(m.id||"")},children:J.jsx(AS,{})}),J.jsx(np,{disabled:b===0,onClick:()=>{e.moveUp(m.id||"")},children:J.jsx(IS,{})}),J.jsx(np,{onClick:()=>n(m),children:J.jsx(SP,{})})]}),setLayerState:x=>s?.(E=>{const T=[...E];return x===!1?T.splice(b,1):T[b].config=x,T}),configurable:!0,showDeleteButton:!0},m.id);case"wms":return J.jsx(J.Fragment,{children:te.createElement(cM,{...m.config,key:m.id,layerId:m.id,sortable:t.sortable,mapId:t?.mapId,insertBeforeLayer:"content_order_"+(a.length-1-b),onConfigChange:x=>{s?.(E=>{const T=[...E];return x===!1?T.splice(b,1):T[b].config.config=x,T})},featureInfoActive:m?.config?.featureInfoActive||!1,setFeatureInfoActive:x=>{s?.(E=>{const T=[...E];return typeof x=="function"&&(T[b].config.featureInfoActive=x(T[b].config?.featureInfoActive||!1)),T})},showDeleteButton:!0,buttons:J.jsxs(J.Fragment,{children:[J.jsx(np,{disabled:b===a.length-1,onClick:()=>{e.moveDown(m.id||"")},children:J.jsx(AS,{})}),J.jsx(np,{disabled:b===0,onClick:()=>{e.moveUp(m.id||"")},children:J.jsx(IS,{})}),J.jsx(np,{onClick:()=>n(m),children:J.jsx(SP,{})})]})})});case"vt":return J.jsx(gt.Fragment,{children:J.jsx(dp,{name:m?.name||m?.type+" layer"||"unnamed layer",layerComponent:J.jsx(P0,{layers:m?.config?.layers||[],mapId:m?.config.mapId,sourceOptions:m?.config?.sourceOptions,layerId:m.id,url:m?.config?.url},m.id),buttons:J.jsxs(J.Fragment,{children:[J.jsx(np,{disabled:b===a.length-1,onClick:()=>{e.moveDown(m.id||"")},children:J.jsx(AS,{})},m.id+"_button1"),J.jsx(np,{disabled:b===0,onClick:()=>{e.moveUp(m.id||"")},children:J.jsx(IS,{})},m.id+"_button2"),J.jsx(np,{onClick:()=>n(m),children:J.jsx(SP,{})})]}),setLayerState:x=>s?.(E=>{const T=[...E];return x===!1?T.splice(b,1):T[b].config=x,T}),configurable:!0,showDeleteButton:!0},m.id)},m?.id+"_listItem");default:return null}}),e?.backgroundLayers?.length>0&&J.jsx(dp,{layerComponent:J.jsx(P0,{...e.vtLayerConfig,layers:e.backgroundLayers,mapId:t?.mapId,insertBeforeLayer:"order-background"}),setLayerState:m=>{e.setBackgroundLayers(m?.layers)},visible:!0,configurable:!0,type:"layer",name:"Background"},"background_geometry")]})})]})}AM.defaultProps={mapId:void 0};try{AM.displayName="LayerListItemFactory",AM.__docgenInfo={description:"",displayName:"LayerListItemFactory",props:{mapId:{defaultValue:{value:"undefined"},description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},layers:{defaultValue:null,description:"",name:"layers",required:!0,type:{name:"LayerConfig[]"}},setLayers:{defaultValue:null,description:"",name:"setLayers",required:!1,type:{name:"((layers: LayerConfig[] | ((state: LayerConfig[]) => LayerConfig[])) => void) | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},fitBoundsOptions:{defaultValue:null,description:"",name:"fitBoundsOptions",required:!1,type:{name:"FitBoundsOptions | undefined"}}}}}catch{}const u6e=Ji(J.jsx("path",{d:"M14 10H3v2h11zm0-4H3v2h11zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2zM3 16h7v-2H3z"})),c6e=["fill","line","circle"];function IM(t){const[e,r]=gt.useState({type:"circle"}),n=te.useMemo(()=>!(!e?.type||!e?.geojson),[e]);return J.jsxs(J.Fragment,{children:[J.jsx(by,{children:"GeoJSON layer"}),J.jsxs(ih,{fullWidth:!0,children:[J.jsx(_g,{id:"type-label",children:"Type"}),J.jsx(bg,{labelId:"type-label",value:e.type,label:"Type",onChange:i=>r(a=>({...a,type:i.target.value})),children:c6e.map(i=>J.jsx(Fm,{value:i,children:i},i))})]}),J.jsx(ih,{fullWidth:!0,children:J.jsxs(ta,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Upload File",J.jsx("input",{type:"file",hidden:!0,onChange:i=>{i.target.files?.[0].text().then(a=>r(s=>({...s,geojson:JSON.parse(a)})))}})]})}),J.jsxs(Dx,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!n,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{IM.displayName="GeoJsonLayerForm",IM.__docgenInfo={description:"",displayName:"GeoJsonLayerForm",props:{config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"MlGeoJsonLayerProps | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlGeoJsonLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const h6e=Ji([J.jsx("path",{d:"M8 8H6v7c0 1.1.9 2 2 2h9v-2H8z"},"0"),J.jsx("path",{d:"M20 3h-8c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 8h-8V7h8zM4 12H2v7c0 1.1.9 2 2 2h9v-2H4z"},"1")]),ZE=t=>J.jsxs(J.Fragment,{children:[J.jsx(by,{children:t.layerTypes.length>1?"Select a layer type":"Load new layer"}),J.jsx(Rf,{children:t.layerTypes.map((e,r)=>J.jsx($h,{disableGutters:!0,children:J.jsxs(dY,{autoFocus:!0,onClick:()=>{t.onSelect(e)},children:[J.jsx(gY,{children:J.jsx(tY,{children:J.jsx(h6e,{})})}),J.jsx(Dh,{primary:e})]})},r))})]});ZE.defaultProps={};try{ZE.displayName="LayerTypeForm",ZE.__docgenInfo={description:"",displayName:"LayerTypeForm",props:{onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(type: string) => void"}},layerTypes:{defaultValue:null,description:"",name:"layerTypes",required:!0,type:{name:"string[]"}}}}}catch{}function PM(t){const[e,r]=gt.useState({url:""}),n=te.useMemo(()=>!!e?.url,[e]);return J.jsxs(J.Fragment,{children:[J.jsx(by,{children:"WMS layer"}),J.jsx(sO,{children:J.jsxs(ih,{fullWidth:!0,sx:{marginTop:"10px"},children:[J.jsx(_g,{htmlFor:"wms-url-input",children:"WMS URL"}),J.jsx(JT,{id:"wms-url-input",label:"WMS URL",value:e.url,onChange:i=>r({...e,url:i.target.value})})]})}),J.jsxs(Dx,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!n,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{PM.displayName="WmsLayerForm",PM.__docgenInfo={description:"",displayName:"WmsLayerForm",props:{onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: wmsConfig) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const ote=Ji(J.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),ste=Ji(J.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10H7v-2h10z"})),f6e=["latfield","lonfield","delimiter"];function kM(t){const[e,r]=te.useState(!1);return J.jsxs(J.Fragment,{children:[J.jsx(Ss,{children:" Options "}),J.jsx(ta,{onClick:()=>r(!e),children:e?J.jsx(ste,{}):J.jsx(ote,{})}),J.jsx(Rf,{children:e&&f6e?.map(n=>J.jsxs(J.Fragment,{children:[J.jsx($h,{children:J.jsxs(Ss,{children:[" ",n," "]})}),J.jsx($h,{children:J.jsx(QT,{size:"small",onChange:i=>{const a={};a[n]=i.target.value,t.setter(a)}})})]}))})]})}try{kM.displayName="CSVOptionsFormular",kM.__docgenInfo={description:"",displayName:"CSVOptionsFormular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"any"}}}}}catch{}const d6e=["completeFeature","allFeatures","renderTagged","excludeWay","suppressWay"];function RM(t){const[e,r]=te.useState(!1);return J.jsxs(J.Fragment,{children:[J.jsx(Ss,{children:" Options "}),J.jsx(ta,{onClick:()=>r(!e),children:e?J.jsx(ste,{}):J.jsx(ote,{})}),J.jsx(Rf,{children:e&&d6e?.map(n=>J.jsx(J.Fragment,{children:J.jsxs($h,{children:[J.jsxs(Ss,{children:[" ",n," "]}),J.jsx(U0,{onChange:i=>{const a={};a[n]=i.target.value==="on",t.setter(a)}})]})}))})]})}try{RM.displayName="OsmOptionsFomular",RM.__docgenInfo={description:"",displayName:"OsmOptionsFomular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"any"}}}}}catch{}const p6e={csv:uMe,topojson:GMe,osm:qMe,gpx:yP,kml:yP,tcx:yP},g6e=["fill","line","circle"];function MM(t){const[e,r]=te.useState({type:"circle"}),[n,i]=te.useState(),[a,s]=te.useState(),[o,c]=te.useState({}),h=va({mapId:t.mapId}),d="?"+new URLSearchParams(o).toString();UE({protocol:t.originType,handler:p6e[t.originType]});const m=te.useMemo(()=>e?.type?!!(a&&n):!1,[e,a,n]);te.useEffect(()=>(typeof n<"u"&&typeof a<"u"&&(h.map?.getSource(n)||h.map?.addSource(n,{type:"geojson",data:o?t.originType+"://"+a+d:t.originType+"://"+a}),e.options={source:n}),()=>{}),[n,h.map,a]),te.useEffect(()=>{a&&n&&h.map?.getLayer(n)&&URL.revokeObjectURL(a)},[n,a,h.map]);function b(x){const E={...o,...x};return c(E)}return J.jsxs(J.Fragment,{children:[J.jsxs(by,{children:["Layer from ",t.originType]}),J.jsxs(ih,{fullWidth:!0,children:[J.jsx(_g,{id:"type-label",children:"Type"}),J.jsx(bg,{labelId:"type-label",value:e.type,label:"Type",onChange:x=>r(E=>({...E,type:x.target.value})),children:g6e.map(x=>J.jsx(Fm,{value:x,children:x},x))})]}),J.jsxs(ih,{fullWidth:!0,children:[J.jsxs(ta,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Select origin file",J.jsx("input",{type:"file",hidden:!0,accept:t.originType,onChange:x=>{if(i(x.target.files?.[0].name),x.target.files?.[0]){const E=URL.createObjectURL(x.target.files?.[0]);s(E)}}})]}),t.originType==="csv"&&J.jsx(kM,{setter:b}),t.originType==="osm"&&J.jsx(RM,{setter:b})]}),J.jsxs(Dx,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!m,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{MM.displayName="ProtocolHandlerLayerForm",MM.__docgenInfo={description:"",displayName:"ProtocolHandlerLayerForm",props:{originType:{defaultValue:null,description:"",name:"originType",required:!0,type:{name:"string"}},config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"MlGeoJsonLayerProps | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlGeoJsonLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const m6e=["id","type","metadata","source","source-layer","layout","paint","options"];function DM(t){const[e,r]=te.useState([]),n={},i=["paint","layout","options","metadata"];te.useEffect(()=>{t.setter(e)},[e]);const a=()=>J.jsx(J.Fragment,{children:m6e.map(o=>J.jsx(gt.Fragment,{children:J.jsx(QT,{label:o,onChange:c=>n[o]=c.target.value})},o+"_fragment"))});function s(){i.map(o=>{if(typeof n[o]<"u")try{n[o]=JSON.parse(n[o])}catch{alert("Invalid JSON format, try again")}}),r(o=>o.length>0?[n,...o]:[n])}return J.jsxs(J.Fragment,{children:[J.jsx(ih,{fullWidth:!0,children:J.jsx(a,{})}),J.jsx(ta,{onClick:s,children:" Add"})]})}try{DM.displayName="MbtilesLayerPropFormular",DM.__docgenInfo={description:"",displayName:"MbtilesLayerPropFormular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"Dispatch<SetStateAction<LayerSpecification[]>>"}}}}}catch{}const y6e=Ji(J.jsx("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"})),v6e=Ji(J.jsx("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}));function OM(t){const[e,r]=gt.useState(t.config),[n,i]=te.useState(),[a,s]=te.useState(),[o,c]=te.useState([]),h=va({mapId:t.mapId}),[d,m]=te.useState(!1);console.log(o);const b=()=>J.jsx(J.Fragment,{children:o.map((E,T)=>J.jsxs(Ss,{variant:"body2",children:[T+1,": ",JSON.stringify(E)]},T))}),x=te.useMemo(()=>!!n,[n]);return te.useEffect(()=>{typeof n<"u"&&typeof a<"u"&&r({url:"mbtiles://"+a+"/{z}/{x}/{y}",layers:o,layerId:n,sourceOptions:{type:"vector",minzoom:0,maxzoom:1}})},[n,h.map,a,o]),J.jsxs(J.Fragment,{children:[J.jsx(by,{children:" Layer from mbtiles file"}),J.jsxs(sO,{children:[J.jsxs(ta,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Select origin file",J.jsx("input",{type:"file",hidden:!0,accept:t.originType,onChange:E=>{if(i(E.target.files?.[0].name),E.target.files?.[0]){const T=URL.createObjectURL(E.target.files?.[0]);s(T)}}})]}),J.jsxs(Nce,{expanded:d,children:[J.jsxs(the,{"aria-controls":"panel1d-content",id:"panel1d-header",children:[J.jsx(Ss,{children:"MB-Tile Layer properties"}),J.jsx(ta,{onClick:()=>m(!d),children:d?J.jsx(v6e,{}):J.jsx(y6e,{})})]}),J.jsx(Ss,{variant:"body1",children:" Layers"}),o.length>0?J.jsx(b,{}):J.jsx(Ss,{variant:"body2",children:" 0 "}),J.jsx(DM,{setter:c})]})]}),J.jsxs(Dx,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!x,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{OM.displayName="MbtilesLayerForm",OM.__docgenInfo={description:"",displayName:"MbtilesLayerForm",props:{originType:{defaultValue:null,description:"",name:"originType",required:!0,type:{name:"string"}},config:{defaultValue:null,description:"",name:"config",required:!0,type:{name:"MlVectorTileLayerProps"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlVectorTileLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const KE=t=>{const[e,r]=te.useState(t?.config),[n,i]=te.useState(),a=t.layerTypes,s=a.filter(m=>m!=="wms"&&m!=="geojson"&&m!=="mbtiles"),o=["wms","geojson","vt","csv","mbtiles","topojson","osm","gpx","kml","tcx"],c=m=>{i(m),s.includes(m)?r({type:"geojson",config:{}}):r(m==="mbtiles"?{type:"vt",config:{layers:[]}}:{type:m,config:{}})},h=()=>{t.setOpen(!1),r(void 0)},d=()=>J.jsx(J.Fragment,{children:s.map((m,b)=>J.jsx(J.Fragment,{children:e?.type==="geojson"&&n===m&&J.jsx(MM,{originType:m,onSubmit:x=>{t?.onComplete?.({...e,config:x,type:"geojson"}),h()},onCancel:h},b)}))});return J.jsxs(oO,{open:t.open,onClose:h,children:[!e?.type&&J.jsx(ZE,{onSelect:m=>{o.includes(m)&&c(m)},layerTypes:a}),e?.type==="geojson"&&n==="geojson"&&J.jsx(IM,{onSubmit:m=>{t?.onComplete?.({...e,config:m}),h()},onCancel:h}),e?.type==="wms"&&J.jsx(PM,{onSubmit:m=>{t?.onComplete?.({...e,config:m}),h()},onCancel:h}),e?.type==="vt"&&n!==void 0&&J.jsx(OM,{config:e,originType:n,onSubmit:m=>{e&&(t?.onComplete?.({...e,config:m}),h())},onCancel:h}),J.jsx(d,{},"protocol")]})};KE.defaultProps={};try{KE.displayName="AddLayerPopup",KE.__docgenInfo={description:"",displayName:"AddLayerPopup",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"LayerConfig | undefined"}},layerTypes:{defaultValue:null,description:"",name:"layerTypes",required:!0,type:{name:"string[]"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!0,type:{name:"(open: boolean) => void"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}}}}}catch{}const NM=t=>{const[e,r]=gt.useState(!1),n=t.layerTypes||["geojson","wms","csv","topojson","osm","gpx","kml","tcx"];return J.jsxs(J.Fragment,{children:[J.jsx(ta,{variant:"contained",sx:{marginTop:"10px",...t.sx},onClick:()=>r(!0),children:J.jsx(u6e,{})}),J.jsx(KE,{open:e,setOpen:r,onComplete:t?.onComplete,layerTypes:n})]})};NM.defaultProps={};try{NM.displayName="AddLayerButton",NM.__docgenInfo={description:"",displayName:"AddLayerButton",props:{sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps | undefined"}},layerTypes:{defaultValue:null,description:`An string array, to filter the supported file types that would be shown to the user
Default is: ['geojson', 'wms', 'csv', 'topojson', 'osm', 'gpx', 'kml', 'tcx']`,name:"layerTypes",required:!1,type:{name:"string[] | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}}}}}catch{}const _6e=Ji(J.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"})),EL="https://mapcomponents.github.io/react-map-components-maplibre/react-maplibre/",b6e=EL+"assets/WG-MapComponents-Logo_rgb.svg",x6e=EL+"assets/WG-MapComponents-Logo_rgb-weisse-schrift.svg",w6e=EL+"assets/mapcomponents_logo.png";function _H(t){const e=Lc(),[r,n]=te.useState(null),i=s=>{n(s.currentTarget)},a=()=>{n(null)};return J.jsx(She,{sx:{minHeight:"62px",position:"absolute",zIndex:1300,top:0},children:J.jsxs(Sye,{disableGutters:!0,children:[t.logo||J.jsxs(J.Fragment,{children:[J.jsx(Bo,{sx:{marginLeft:"25px",display:{xs:"none",md:"flex"},flexGrow:{md:"30"}},children:J.jsx("img",{src:e.palette.mode==="dark"?x6e:b6e,style:{width:"100%",maxWidth:"250px"}})}),J.jsx(Bo,{sx:{marginLeft:"25px",display:{xs:"flex",sm:"flex",md:"none"},flexGrow:{xs:"500"},mr:{sm:"0px"}},children:J.jsx("img",{src:w6e,width:"50px",height:"50px"})})]}),J.jsx(Bo,{sx:{flexGrow:1,display:{xs:"flex"}},children:t.unmovableButtons}),t.buttons?J.jsxs(Bo,{sx:{flexGrow:22,display:{xs:"flex",sm:"none"}},children:[J.jsx(kc,{onClick:i,children:J.jsx(_6e,{})}),J.jsx(vY,{id:"menu-appbar",anchorEl:r,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:!!r,onClose:a,PaperProps:{elevation:24,sx:{overflow:"visible",mt:"15px"}},sx:{display:{xs:"block",sm:"none"}},children:J.jsx(Bo,{sx:{paddingLeft:"10px",paddingRight:"10px"},onClick:a,children:t.buttons})})]}):"",J.jsx(Bo,{sx:{marginRight:"25px",display:{xs:"none",sm:"flex"}},children:t.buttons})]})})}try{_H.displayName="TopToolbar",_H.__docgenInfo={description:"",displayName:"TopToolbar",props:{unmovableButtons:{defaultValue:null,description:"",name:"unmovableButtons",required:!1,type:{name:"ReactNode"}},buttons:{defaultValue:null,description:"",name:"buttons",required:!1,type:{name:"ReactNode"}},logo:{defaultValue:null,description:"",name:"logo",required:!1,type:{name:"ReactNode"}}}}}catch{}const S6e=Ji(J.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2zm-1 7h5.5L14 6.5z"}));function bH(t){const e=te.useRef(null),r=()=>{if(!e.current)return!1;const i=e.current?.files?.[0];if(!i)return!1;const a=new FileReader;a.onload=s=>{s&&typeof t.setData=="function"&&t.setData(s.currentTarget?.result)},a.readAsText(i)},n=()=>{e.current&&e.current.click()};return J.jsxs(J.Fragment,{children:[t.buttonComponent?gt.cloneElement(t.buttonComponent,{onClick:n}):J.jsx(ta,{onClick:n,children:J.jsx(S6e,{})}),J.jsx("input",{ref:e,onChange:r,type:"file",accept:t.accept,id:"input",multiple:!0,style:{display:"none"}})]})}try{bH.displayName="UploadButton",bH.__docgenInfo={description:"",displayName:"UploadButton",props:{setData:{defaultValue:null,description:"",name:"setData",required:!0,type:{name:"(data: string) => void"}},buttonComponent:{defaultValue:null,description:"",name:"buttonComponent",required:!0,type:{name:"any"}},accept:{defaultValue:null,description:"",name:"accept",required:!1,type:{name:"string | undefined"}}}}}catch{}const JE=t=>{const e=()=>{t.setOpen(!1)};return J.jsxs(oO,{open:t.open,onClose:e,PaperProps:{sx:{padding:"20px"}},children:[J.jsx(by,{children:"Select a style"}),J.jsx(Rf,{children:t?.styles?.map(r=>J.jsx($h,{disableGutters:!0,children:J.jsxs(dY,{autoFocus:!0,onClick:()=>{t?.onSelect?.(r)},children:[J.jsx(gY,{children:J.jsx(tY,{sx:{width:"50px",height:"50px"},alt:r.name,src:r?.name&&t?.styleThumbnailPaths?.[r.name]})}),J.jsx(Dh,{primary:r.name})]})},r.name))})]})};JE.defaultProps={styleThumbnailPaths:{}};try{JE.displayName="SelectStylePopup",JE.__docgenInfo={description:"",displayName:"SelectStylePopup",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!0,type:{name:"(open: boolean) => void"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"StyleSpecification[] | undefined"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!1,type:{name:"((style: StyleSpecification) => void) | undefined"}},styleThumbnailPaths:{defaultValue:{value:"{}"},description:"",name:"styleThumbnailPaths",required:!1,type:{name:"{ [key: string]: string; } | undefined"}}}}}catch{}const E6e=Ji(J.jsx("path",{d:"M4 4h7V2H4c-1.1 0-2 .9-2 2v7h2zm6 9-4 5h12l-3-4-2.03 2.71zm7-4.5c0-.83-.67-1.5-1.5-1.5S14 7.67 14 8.5s.67 1.5 1.5 1.5S17 9.33 17 8.5M20 2h-7v2h7v7h2V4c0-1.1-.9-2-2-2m0 18h-7v2h7c1.1 0 2-.9 2-2v-7h-2zM4 13H2v7c0 1.1.9 2 2 2h7v-2H4z"})),T6e={version:8,name:"Monokai",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:ec.source_openmaptiles_url}},sprite:ec.sprite,glyphs:ec.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#AE81FF","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#75715E"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#837f6e"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#918d7e"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#A6C22E","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(166,194,46,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#e0ebad"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#FD971F"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(253,151,31,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(18,5,68,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#A6E22E","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#A6C22E","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#A6C22E","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#66D9EF","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#21c8e8"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#AE81FF","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#E6DB74","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#eee69f","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#fa5892","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#fa5892","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#fa5892","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#fb70a2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(249,38,114,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#b40544","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#b40544","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(249,38,114,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#fb70a2","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#fb70a2","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#e60657","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(249,38,114,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#F8F8F2","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fc89b2","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(18,5,68,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(18,5,68,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#b40544","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#fa5892","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#F8F8F2","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#b40544","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#E69F66","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#E69F66","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},C6e={version:8,name:"Solarized",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:ec.source_openmaptiles_url}},sprite:ec.sprite,glyphs:ec.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#073642"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#2aa198","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#657b83"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#74888f"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#84959c"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#859900","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(133,153,0,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#f2ff99"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#d30102"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(211,1,2,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(58,63,144,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#2aa198","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#859900","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#859900","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#268bd2","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#1a6091"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#2aa198","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#eee8d5","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#fdfcf9","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#9094d3","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#9094d3","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#9094d3","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#a3a6da","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(108,113,196,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#3a3f90","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#3a3f90","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(108,113,196,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#a3a6da","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#a3a6da","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#484fb5","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(108,113,196,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#cb4b16","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e58ab6","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(58,63,144,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(58,63,144,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#3a3f90","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#9094d3","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#cb4b16","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#268bd2","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#268bd2","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#268bd2","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},A6e={version:8,name:"Oceanic Next",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:ec.source_openmaptiles_url}},sprite:ec.sprite,glyphs:ec.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#81a1c1","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#a3be8c"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#acc598"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#b5cba3"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#a3be8c","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(163,19,14,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#cbdabe"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#b48ead"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(18,142,173,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(118,51,8,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#81a1c1","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#a3be8c","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#a3be8c","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#8fbcbb","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#5f9f9e"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#81a1c1","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#65737e","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#7e8d98","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#f17626","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#f2853e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(235,219,178,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(214,93,14,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#a6480b","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(214,93,14,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#b48ead","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f49456","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(118,51,8,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(118,51,8,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#b48ead","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#8fbcbb","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},I6e={version:8,name:"Medieval Kingdom",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:ec.source_openmaptiles_url}},sprite:ec.sprite,glyphs:ec.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#ffd1a8"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#228B22","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#bfa677"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#c5af85"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#ccb892"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#556B2F","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(85,107,47,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#d1e0b8"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#FFC0CB"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(255,192,203,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(149,46,46,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#228B22","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#556B2F","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#556B2F","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#1E90FF","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#006ad1"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#228B22","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#f9e9cb","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#fefcf9","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#d98383","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d98383","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#d98383","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#df9797","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(139,94,6,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#952e2e","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#952e2e","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(205,92,92,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#df9797","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#df9797","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#bc3a3a","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(205,92,92,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#FFC0CB","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e5aaaa","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(149,46,46,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(149,46,46,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#952e2e","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#d98383","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#FFC0CB","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#A0522D","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#A0522D","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},P6e={version:8,name:"Gruvbox",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:ec.source_openmaptiles_url}},sprite:ec.sprite,glyphs:ec.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#83a598","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#b8bb26"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#bfc23c"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#c6c951"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#b8bb26","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(184,187,38,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#eceeaa"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#fe8019"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(254,128,25,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(118,51,8,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#83a598","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#b8bb26","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#b8bb26","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#83a598","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#5c7f72"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#83a598","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#928374","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#a89c91","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#f17626","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#f2853e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(235,219,178,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(214,93,14,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#a6480b","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(214,93,14,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#fe8019","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f49456","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(118,51,8,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(118,51,8,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#fe8019","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#fb4934","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fb4934","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#83a598","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},w1="https://mapcomponents.github.io/react-map-components-maplibre/assets/style_thumbnails/",xH=({sx:t,styles:e=[],defaultStyles:r=!0,styleThumbnailPaths:n})=>{const i=gt.useContext(HD),[a,s]=gt.useState(!1);return J.jsxs(J.Fragment,{children:[J.jsx(ta,{variant:"contained",sx:{marginTop:"10px",...t},onClick:()=>s(!0),children:J.jsx(E6e,{})}),J.jsx(JE,{styles:[...r?[T6e,C6e,A6e,I6e,P6e]:[],...e||[]],styleThumbnailPaths:{...n,...r?{Monokai:w1+"monokai.png",Gruvbox:w1+"gruvbox.png","Oceanic Next":w1+"oceanic_next.png",Solarized:w1+"solarized.png","Medieval Kingdom":w1+"medieval_kingdom.png"}:{}},open:a,setOpen:s,onSelect:o=>{i.setBackgroundLayers([]),setTimeout(()=>{i.updateStyle(o)},100),s(!1)}})]})};try{xH.displayName="SelectStyleButton",xH.__docgenInfo={description:"",displayName:"SelectStyleButton",props:{sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: StyleSpecification[]) => void) | undefined"}},styles:{defaultValue:{value:"[]"},description:"",name:"styles",required:!1,type:{name:"StyleSpecification[] | undefined"}},defaultStyles:{defaultValue:{value:"true"},description:"",name:"defaultStyles",required:!1,type:{name:"boolean | undefined"}},styleThumbnailPaths:{defaultValue:null,description:"",name:"styleThumbnailPaths",required:!1,type:{name:"{ [key: string]: string; } | undefined"}}}}}catch{}var EP={exports:{}},TP={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wH;function k6e(){if(wH)return TP;wH=1;var t=xx();function e(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,i=t.useRef,a=t.useEffect,s=t.useMemo,o=t.useDebugValue;return TP.useSyncExternalStoreWithSelector=function(c,h,d,m,b){var x=i(null);if(x.current===null){var E={hasValue:!1,value:null};x.current=E}else E=x.current;x=s(function(){function A(U){if(!M){if(M=!0,F=U,U=m(U),b!==void 0&&E.hasValue){var j=E.value;if(b(j,U))return N=j}return N=U}if(j=N,r(F,U))return j;var H=m(U);return b!==void 0&&b(j,H)?(F=U,j):(F=U,N=H)}var M=!1,F,N,O=d===void 0?null:d;return[function(){return A(h())},O===null?void 0:function(){return A(O())}]},[h,d,m,b]);var T=n(c,x[0],x[1]);return a(function(){E.hasValue=!0,E.value=T},[T]),o(T),T},TP}var SH;function R6e(){return SH||(SH=1,EP.exports=k6e()),EP.exports}var M6e=R6e(),D6e=Symbol.for("react-redux-context"),O6e=typeof globalThis<"u"?globalThis:{};function N6e(){if(!te.createContext)return{};const t=O6e[D6e]??=new Map;let e=t.get(te.createContext);return e||(e=te.createContext(null),t.set(te.createContext,e)),e}var uy=N6e();function TL(t=uy){return function(){return te.useContext(t)}}var lte=TL();function ute(t=uy){const e=t===uy?lte:TL(t),r=()=>{const{store:n}=e();return n};return Object.assign(r,{withTypes:()=>r}),r}var L6e=ute();function F6e(t=uy){const e=t===uy?L6e:ute(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var cte=F6e(),B6e=(t,e)=>t===e;function z6e(t=uy){const e=t===uy?lte:TL(t),r=(n,i={})=>{const{equalityFn:a=B6e}=typeof i=="function"?{equalityFn:i}:i,s=e(),{store:o,subscription:c,getServerState:h}=s;te.useRef(!0);const d=te.useCallback({[n.name](b){return n(b)}}[n.name],[n]),m=M6e.useSyncExternalStoreWithSelector(c.addNestedSub,o.getState,h||o.getState,d,a);return te.useDebugValue(m),m};return Object.assign(r,{withTypes:()=>r}),r}var Vm=z6e();function xu(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var j6e=typeof Symbol=="function"&&Symbol.observable||"@@observable",EH=j6e,CP=()=>Math.random().toString(36).substring(7).split("").join("."),U6e={INIT:`@@redux/INIT${CP()}`,REPLACE:`@@redux/REPLACE${CP()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${CP()}`},QE=U6e;function CL(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function hte(t,e,r){if(typeof t!="function")throw new Error(xu(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(xu(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(xu(1));return r(hte)(t,e)}let n=t,i=e,a=new Map,s=a,o=0,c=!1;function h(){s===a&&(s=new Map,a.forEach((A,M)=>{s.set(M,A)}))}function d(){if(c)throw new Error(xu(3));return i}function m(A){if(typeof A!="function")throw new Error(xu(4));if(c)throw new Error(xu(5));let M=!0;h();const F=o++;return s.set(F,A),function(){if(M){if(c)throw new Error(xu(6));M=!1,h(),s.delete(F),a=null}}}function b(A){if(!CL(A))throw new Error(xu(7));if(typeof A.type>"u")throw new Error(xu(8));if(typeof A.type!="string")throw new Error(xu(17));if(c)throw new Error(xu(9));try{c=!0,i=n(i,A)}finally{c=!1}return(a=s).forEach(F=>{F()}),A}function x(A){if(typeof A!="function")throw new Error(xu(10));n=A,b({type:QE.REPLACE})}function E(){const A=m;return{subscribe(M){if(typeof M!="object"||M===null)throw new Error(xu(11));function F(){const O=M;O.next&&O.next(d())}return F(),{unsubscribe:A(F)}},[EH](){return this}}}return b({type:QE.INIT}),{dispatch:b,subscribe:m,getState:d,replaceReducer:x,[EH]:E}}function V6e(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:QE.INIT})>"u")throw new Error(xu(12));if(typeof r(void 0,{type:QE.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(xu(13))})}function $6e(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const s=e[a];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let i;try{V6e(r)}catch(a){i=a}return function(s={},o){if(i)throw i;let c=!1;const h={};for(let d=0;d<n.length;d++){const m=n[d],b=r[m],x=s[m],E=b(x,o);if(typeof E>"u")throw o&&o.type,new Error(xu(14));h[m]=E,c=c||E!==x}return c=c||n.length!==Object.keys(s).length,c?h:s}}function eT(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function q6e(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error(xu(15))};const s={getState:i.getState,dispatch:(c,...h)=>a(c,...h)},o=t.map(c=>c(s));return a=eT(...o)(i.dispatch),{...i,dispatch:a}}}function H6e(t){return CL(t)&&"type"in t&&typeof t.type=="string"}var fte=Symbol.for("immer-nothing"),TH=Symbol.for("immer-draftable"),mh=Symbol.for("immer-state");function _f(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var t_=Object.getPrototypeOf;function cy(t){return!!t&&!!t[mh]}function Ip(t){return t?dte(t)||Array.isArray(t)||!!t[TH]||!!t.constructor?.[TH]||r2(t)||q3(t):!1}var W6e=Object.prototype.constructor.toString();function dte(t){if(!t||typeof t!="object")return!1;const e=t_(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===W6e}function tT(t,e){$3(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function $3(t){const e=t[mh];return e?e.type_:Array.isArray(t)?1:r2(t)?2:q3(t)?3:0}function LM(t,e){return $3(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function pte(t,e,r){const n=$3(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function G6e(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function r2(t){return t instanceof Map}function q3(t){return t instanceof Set}function bm(t){return t.copy_||t.base_}function FM(t,e){if(r2(t))return new Map(t);if(q3(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=dte(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[mh];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(t_(t),n)}else{const n=t_(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function AL(t,e=!1){return H3(t)||cy(t)||!Ip(t)||($3(t)>1&&Object.defineProperties(t,{set:{value:zw},add:{value:zw},clear:{value:zw},delete:{value:zw}}),Object.freeze(t),e&&Object.values(t).forEach(r=>AL(r,!0))),t}function zw(){_f(2)}function H3(t){return Object.isFrozen(t)}var X6e={};function hy(t){const e=X6e[t];return e||_f(0,t),e}var cx;function gte(){return cx}function Y6e(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function CH(t,e){e&&(hy("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function BM(t){zM(t),t.drafts_.forEach(Z6e),t.drafts_=null}function zM(t){t===cx&&(cx=t.parent_)}function AH(t){return cx=Y6e(cx,t)}function Z6e(t){const e=t[mh];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function IH(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[mh].modified_&&(BM(e),_f(4)),Ip(t)&&(t=rT(e,t),e.parent_||nT(e,t)),e.patches_&&hy("Patches").generateReplacementPatches_(r[mh].base_,t,e.patches_,e.inversePatches_)):t=rT(e,r,[]),BM(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==fte?t:void 0}function rT(t,e,r){if(H3(e))return e;const n=e[mh];if(!n)return tT(e,(i,a)=>PH(t,n,e,i,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return nT(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),tT(a,(o,c)=>PH(t,n,i,o,c,r,s)),nT(t,i,!1),r&&t.patches_&&hy("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function PH(t,e,r,n,i,a,s){if(cy(i)){const o=a&&e&&e.type_!==3&&!LM(e.assigned_,n)?a.concat(n):void 0,c=rT(t,i,o);if(pte(r,n,c),cy(c))t.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Ip(i)&&!H3(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;rT(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(r2(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&nT(t,i)}}function nT(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&AL(e,r)}function K6e(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:gte(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=IL;r&&(i=[n],a=hx);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var IL={get(t,e){if(e===mh)return t;const r=bm(t);if(!LM(r,e))return J6e(t,r,e);const n=r[e];return t.finalized_||!Ip(n)?n:n===AP(t.base_,e)?(IP(t),t.copy_[e]=UM(n,t)):n},has(t,e){return e in bm(t)},ownKeys(t){return Reflect.ownKeys(bm(t))},set(t,e,r){const n=mte(bm(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=AP(bm(t),e),a=i?.[mh];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(G6e(r,i)&&(r!==void 0||LM(t.base_,e)))return!0;IP(t),jM(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return AP(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,IP(t),jM(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=bm(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){_f(11)},getPrototypeOf(t){return t_(t.base_)},setPrototypeOf(){_f(12)}},hx={};tT(IL,(t,e)=>{hx[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});hx.deleteProperty=function(t,e){return hx.set.call(this,t,e,void 0)};hx.set=function(t,e,r){return IL.set.call(this,t[0],e,r,t[0])};function AP(t,e){const r=t[mh];return(r?bm(r):t)[e]}function J6e(t,e,r){const n=mte(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function mte(t,e){if(!(e in t))return;let r=t_(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=t_(r)}}function jM(t){t.modified_||(t.modified_=!0,t.parent_&&jM(t.parent_))}function IP(t){t.copy_||(t.copy_=FM(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Q6e=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const s=this;return function(c=a,...h){return s.produce(c,d=>r.call(this,d,...h))}}typeof r!="function"&&_f(6),n!==void 0&&typeof n!="function"&&_f(7);let i;if(Ip(e)){const a=AH(this),s=UM(e,void 0);let o=!0;try{i=r(s),o=!1}finally{o?BM(a):zM(a)}return CH(a,n),IH(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===fte&&(i=void 0),this.autoFreeze_&&AL(i,!0),n){const a=[],s=[];hy("Patches").generateReplacementPatches_(e,i,a,s),n(a,s)}return i}else _f(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,c=>e(c,...o));let n,i;return[this.produce(e,r,(s,o)=>{n=s,i=o}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Ip(t)||_f(8),cy(t)&&(t=eFe(t));const e=AH(this),r=UM(t,void 0);return r[mh].isManual_=!0,zM(e),r}finishDraft(t,e){const r=t&&t[mh];(!r||!r.isManual_)&&_f(9);const{scope_:n}=r;return CH(n,e),IH(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=hy("Patches").applyPatches_;return cy(t)?n(t,e):this.produce(t,i=>n(i,e))}};function UM(t,e){const r=r2(t)?hy("MapSet").proxyMap_(t,e):q3(t)?hy("MapSet").proxySet_(t,e):K6e(t,e);return(e?e.scope_:gte()).drafts_.push(r),r}function eFe(t){return cy(t)||_f(10,t),yte(t)}function yte(t){if(!Ip(t)||H3(t))return t;const e=t[mh];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=FM(t,e.scope_.immer_.useStrictShallowCopy_)}else r=FM(t,!0);return tT(r,(n,i)=>{pte(r,n,yte(i))}),e&&(e.finalized_=!1),r}var tFe=new Q6e,vte=tFe.produce;function _te(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var rFe=_te(),nFe=_te,iFe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?eT:eT.apply(null,arguments)};function kH(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(vp(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>H6e(n)&&n.type===t,r}var bte=class Z1 extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Z1.prototype)}static get[Symbol.species](){return Z1}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Z1(...e[0].concat(this)):new Z1(...e.concat(this))}};function RH(t){return Ip(t)?vte(t,()=>{}):t}function jw(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function aFe(t){return typeof t=="boolean"}var oFe=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let s=new bte;return r&&(aFe(r)?s.push(rFe):s.push(nFe(r.extraArgument))),s},sFe="RTK_autoBatch",MH=t=>e=>{setTimeout(e,t)},lFe=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,s=!1;const o=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:MH(10):t.type==="callback"?t.queueNotification:MH(t.timeout),h=()=>{s=!1,a&&(a=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const m=()=>i&&d(),b=n.subscribe(m);return o.add(d),()=>{b(),o.delete(d)}},dispatch(d){try{return i=!d?.meta?.[sFe],a=!i,a&&(s||(s=!0,c(h))),n.dispatch(d)}finally{i=!0}}})},uFe=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new bte(t);return n&&i.push(lFe(typeof n=="object"?n:void 0)),i};function cFe(t){const e=oFe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(CL(r))o=$6e(r);else throw new Error(vp(1));let c;typeof n=="function"?c=n(e):c=e();let h=eT;i&&(h=iFe({trace:!1,...typeof i=="object"&&i}));const d=q6e(...c),m=uFe(d);let b=typeof s=="function"?s(m):m();const x=h(...b);return hte(o,a,x)}function xte(t){const e={},r=[];let n;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(vp(28));if(o in e)throw new Error(vp(29));return e[o]=s,i},addAsyncThunk(a,s){return s.pending&&(e[a.pending.type]=s.pending),s.rejected&&(e[a.rejected.type]=s.rejected),s.fulfilled&&(e[a.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:a.settled,reducer:s.settled}),i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function hFe(t){return typeof t=="function"}function fFe(t,e){let[r,n,i]=xte(e),a;if(hFe(t))a=()=>RH(t());else{const o=RH(t);a=()=>o}function s(o=a(),c){let h=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return h.filter(d=>!!d).length===0&&(h=[i]),h.reduce((d,m)=>{if(m)if(cy(d)){const x=m(d,c);return x===void 0?d:x}else{if(Ip(d))return vte(d,b=>m(b,c));{const b=m(d,c);if(b===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return b}}return d},o)}return s.getInitialState=a,s}var dFe=Symbol.for("rtk-slice-createasyncthunk");function pFe(t,e){return`${t}/${e}`}function gFe({creators:t}={}){const e=t?.asyncThunk?.[dFe];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(vp(11));const s=(typeof n.reducers=="function"?n.reducers(vFe()):n.reducers)||{},o=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(N,O){const U=typeof N=="string"?N:N.type;if(!U)throw new Error(vp(12));if(U in c.sliceCaseReducersByType)throw new Error(vp(13));return c.sliceCaseReducersByType[U]=O,h},addMatcher(N,O){return c.sliceMatchers.push({matcher:N,reducer:O}),h},exposeAction(N,O){return c.actionCreators[N]=O,h},exposeCaseReducer(N,O){return c.sliceCaseReducersByName[N]=O,h}};o.forEach(N=>{const O=s[N],U={reducerName:N,type:pFe(i,N),createNotation:typeof n.reducers=="function"};bFe(O)?wFe(U,O,h,e):_Fe(U,O,h)});function d(){const[N={},O=[],U=void 0]=typeof n.extraReducers=="function"?xte(n.extraReducers):[n.extraReducers],j={...N,...c.sliceCaseReducersByType};return fFe(n.initialState,H=>{for(let G in j)H.addCase(G,j[G]);for(let G of c.sliceMatchers)H.addMatcher(G.matcher,G.reducer);for(let G of O)H.addMatcher(G.matcher,G.reducer);U&&H.addDefaultCase(U)})}const m=N=>N,b=new Map,x=new WeakMap;let E;function T(N,O){return E||(E=d()),E(N,O)}function A(){return E||(E=d()),E.getInitialState()}function M(N,O=!1){function U(H){let G=H[N];return typeof G>"u"&&O&&(G=jw(x,U,A)),G}function j(H=m){const G=jw(b,O,()=>new WeakMap);return jw(G,H,()=>{const X={};for(const[ae,Q]of Object.entries(n.selectors??{}))X[ae]=mFe(Q,H,()=>jw(x,H,A),O);return X})}return{reducerPath:N,getSelectors:j,get selectors(){return j(U)},selectSlice:U}}const F={name:i,reducer:T,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:A,...M(a),injectInto(N,{reducerPath:O,...U}={}){const j=O??a;return N.inject({reducerPath:j,reducer:T},U),{...F,...M(j,!0)}}};return F}}function mFe(t,e,r,n){function i(a,...s){let o=e(a);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return i.unwrapped=t,i}var yFe=gFe();function vFe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function _Fe({type:t,reducerName:e,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!xFe(n))throw new Error(vp(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,s?kH(t,s):kH(t))}function bFe(t){return t._reducerDefinitionType==="asyncThunk"}function xFe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function wFe({type:t,reducerName:e},r,n,i){if(!i)throw new Error(vp(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:c,settled:h,options:d}=r,m=i(t,a,d);n.exposeAction(e,m),s&&n.addCase(m.fulfilled,s),o&&n.addCase(m.pending,o),c&&n.addCase(m.rejected,c),h&&n.addMatcher(m.settled,h),n.exposeCaseReducer(e,{fulfilled:s||Uw,pending:o||Uw,rejected:c||Uw,settled:h||Uw})}function Uw(){}function vp(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}function wte(t,e,r){e.forEach(n=>{t(n,r),n.layers&&n.layers.length>0&&wte(t,n.layers,n)})}const SFe={mapConfigs:{}},Ste=yFe({name:"mapConfig",initialState:SFe,reducers:{setMapConfig:(t,e)=>{const r=e.payload.mapConfig,n=e.payload.key;t.mapConfigs[n]=r},removeMapConfig:(t,e)=>{delete t.mapConfigs[e.payload.key]},setLayerInMapConfig:(t,e)=>{const{mapConfigKey:r,layer:n}=e.payload,i=t.mapConfigs[r];if(i){for(let a=0;a<i.layers.length;a++)if(i.layers[a].uuid===n.uuid){i.layers[a]=n;break}}},removeLayerFromMapConfig:(t,e)=>{const{mapConfigKey:r,layerUuid:n}=e.payload,i=t.mapConfigs[r];if(i){const a=i.layers.findIndex(s=>s.uuid===n);a!==-1&&(delete i.layers[a],wte(function(s,o){o&&o.layers&&(o.layers=o.layers.filter(c=>c.uuid!==n))},i.layerOrder))}},updateLayerOrder:(t,e)=>{const{mapConfigKey:r,newOrder:n}=e.payload,i=t.mapConfigs[r];i&&(i.layerOrder=n)},setMasterVisible(t,e){const{mapConfigKey:r,layerId:n,masterVisible:i}=e.payload,a=t.mapConfigs[r];if(a){const s=a.layers.findIndex(o=>o.uuid===n);if(s!==-1){const o=a.layers[s];if(o){const c=[...a.layers];o.type==="folder"&&a.layerOrder.forEach(h=>{h.uuid===n&&h.layers?.forEach(d=>{const m=a.layers.findIndex(x=>x.uuid===d.uuid),b=c[m];c[m]={...b,masterVisible:i},b?.type==="vt"&&b?.config?.layers&&(b.config.layers=b.config.layers.map(x=>({...x,masterVisible:i})))})}),o.type==="vt"&&o?.config?.layers&&(o.config.layers=o.config.layers.map(h=>({...h,masterVisible:i}))),t.mapConfigs[r].layers=c}}}}}}),Ete=(t,e)=>{const r=t.mapConfigs;for(const n in r){const i=r[n],a=i.layers.findIndex(o=>o.uuid===e),s=i.layers[a];if(s)return s}return null},EFe=(t,e)=>{const r=t.mapConfig.mapConfigs[e];if(!r)return[];const n=r.layerOrder,i=[];function a(s){s.forEach(o=>{i.push(o.uuid),o.layers&&o.layers.length>0&&a(o.layers)})}return a(n),i};cFe({reducer:{mapConfig:Ste.reducer}});const{setMapConfig:TGe,removeMapConfig:CGe,setLayerInMapConfig:Tte,removeLayerFromMapConfig:AGe,updateLayerOrder:TFe,setMasterVisible:CFe}=Ste.actions,DH=Ji(J.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}));function VM(t){return J.jsx(tx,{value:t.value,label:"Color",onChange:e=>{typeof t.onChange=="function"&&t.onChange(e)}})}try{VM.displayName="PaintPropsColorPicker",VM.__docgenInfo={description:"",displayName:"PaintPropsColorPicker",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}}}catch{}const AFe=Dr(uh)({marginLeft:"-100px",marginRight:"-21px",paddingLeft:"53px",borderRadius:"0px",boxShadow:"none",backgroundColor:"rgb(0, 0, 0, 0)"}),IFe=Dr(Bo)({marginLeft:"61px"}),Cte={"circle-color":"colorpicker","circle-radius":"slider","circle-stroke-color":"colorpicker","circle-stroke-width":"slider","fill-color":"colorpicker","fill-outline-color":"colorpicker","line-color":"colorpicker","line-width":"slider","line-blur":"slider"},PFe=Object.keys(Cte),kFe={"circle-stroke-width":{step:1,min:1,max:20},"circle-radius":{step:1,min:1,max:100},"line-blur":{step:1,min:1,max:100},"line-width":{step:1,min:1,max:100}};function $M(t){const e=te.useRef(Math.round(Math.random()*1e10)),r=Ete(Vm(o=>o.mapConfig),t.layerUuid),n=cte(),i=te.useMemo(()=>r?.config?.options?.paint?r?.config?.options?.paint:{},[r?.config?.options?.paint]),a=(o,c)=>{const h={...r,config:{...r?.config,options:{...r?.config?.options,paint:{...r?.config?.options?.paint,[o]:c}}}};n(Tte({mapConfigKey:t.mapConfigKey,layer:h}))},s=te.useCallback(o=>{if(i?.[o]&&PFe.indexOf(o)!==-1&&(typeof i[o]=="number"||typeof i[o]=="string")){const c=J.jsx(Ss,{id:o+"_label",gutterBottom:!0,children:o});switch(Cte[o]){case"slider":return J.jsxs(gt.Fragment,{children:[c,J.jsx(dO,{...kFe[o],value:i[o],valueLabelDisplay:"auto",onChange:(h,d)=>{d&&typeof d=="number"&&a(o,d)}})]},o);case"numberfield":return J.jsxs(gt.Fragment,{children:[c,J.jsx(QT,{inputProps:{inputMode:"decimal",pattern:"[0-9]*"},value:i[o],onChange:h=>{h?.target?.value&&a(o,parseInt(h.target.value))}})]},o);case"colorpicker":return J.jsxs(gt.Fragment,{children:[c,J.jsx(Bo,{sx:{"& > div":{width:"initial !important"}},children:J.jsx(VM,{value:i[o],onChange:h=>{a(o,h)}},o)})]},o)}}return null},[i]);return J.jsx(J.Fragment,{children:J.jsx(AFe,{children:J.jsx($h,{children:J.jsx(IFe,{children:i&&Object.keys(i).map(o=>s(o))})},e.current+"_paintPropForm")})})}try{$M.displayName="LayerPropertyForm",$M.__docgenInfo={description:"",displayName:"LayerPropertyForm",props:{layerUuid:{defaultValue:null,description:"",name:"layerUuid",required:!0,type:{name:"string"}},mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}}}}}catch{}const RFe=Dr(kc)({padding:"4px",marginTop:"-3px"}),MFe=Dr(kc)({marginLeft:"20px"}),S1=Dr($h)({paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"}),PP=Dr(jb)({minWidth:"30px"}),Vw=Dr(kc)({marginRight:"0px",padding:"0px"}),OH=Dr(Bo)(({open:t})=>({display:t?"block":"none"})),NH=Dr(Rf)({marginLeft:"50px"});function iT(t){const[e,r]=te.useState(!1),[n,i]=te.useState(!1),a=Ete(Vm(A=>A.mapConfig),t.layerOrderConfig.uuid),[s,o]=te.useState(!1),c=cte(),h=Vm(A=>A.mapConfig.mapConfigs[t.mapConfigKey]);function d(A,M){const F=JSON.parse(JSON.stringify(h.layerOrder)),N=O=>{let U=!1;return O.forEach((j,H)=>{if(!U)if(j.uuid===A){const G=M(H);if(G<0||G>=O.length)throw new Error("New position is out of bounds");const[X]=O.splice(H,1);O.splice(G,0,X),U=!0}else j.layers&&N(j.layers)&&(U=!0)}),U};N(F),c(TFe({mapConfigKey:t.mapConfigKey,newOrder:F}))}const m=A=>{d(A,M=>M+1)},b=A=>{d(A,M=>M-1)};function x(A,M=""){const F=!A;a&&(E(a,F,M),(a.type==="folder"||a.type==="vt"&&M==="")&&c(CFe({mapConfigKey:t.mapConfigKey,layerId:a.uuid,masterVisible:F})))}function E(A,M,F){let N={...A};if(A?.type==="folder")N={...A,visible:!A.visible};else switch(A?.type){case"geojson":{N={...A,config:{...A.config,options:{...A?.config?.options,layout:{...A?.config?.options?.layout,visibility:M?"visible":"none"}}}};break}case"vt":{let O=!1;const U=A.config.layers.map(j=>j.id===F?(O=!0,{...j,layout:{...j.layout,visibility:M?"visible":"none"}}):j);O?N={...A,config:{...A.config,layers:U}}:N={...A,visible:M,config:{...A.config,layers:U}};break}case"wms":{N={...A,visible:M,config:{...A.config,visible:M}};break}}return c(Tte({mapConfigKey:t.mapConfigKey,layer:N})),N}function T(A){let M=!0;if(A?.type==="geojson")return M=A?.config?.options?.layout?.visibility!=="none",J.jsxs(J.Fragment,{children:[J.jsxs(S1,{sx:{...t.listItemSx},secondaryAction:J.jsxs(J.Fragment,{children:[t?.buttons,J.jsx(Vw,{disabled:!1,onClick:()=>{m(A.uuid)},children:J.jsx(AS,{})}),J.jsx(Vw,{disabled:!1,onClick:()=>{b(A.uuid)},children:J.jsx(IS,{})}),A.configurable&&J.jsx(J.Fragment,{children:J.jsx(RFe,{edge:"end","aria-label":"settings",onClick:()=>{r(F=>!F)},children:J.jsx(uN,{})})})]}),children:[J.jsx(lp,{children:J.jsx(up,{checked:M,disabled:A.masterVisible===!1,onClick:()=>x(M)})}),J.jsx(Dh,{variant:"layerlist",primary:A.name||"",secondary:t.description,primaryTypographyProps:{overflow:"hidden"}}),t.buttons]},A.uuid),A.configurable&&e&&J.jsxs(J.Fragment,{children:[t.showDeleteButton&&J.jsxs(J.Fragment,{children:[J.jsx(MFe,{edge:"end","aria-label":"delete",onClick:()=>{},children:J.jsx(qx,{})}),n&&J.jsx(J0,{open:n,onConfirm:()=>{i(!1)},onCancel:()=>{i(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]}),J.jsx($M,{layerUuid:A.uuid,mapConfigKey:t.mapConfigKey})]})]});if(A?.type==="vt")return J.jsxs(J.Fragment,{children:[J.jsxs(S1,{sx:{...t.listItemSx},secondaryAction:void 0,children:[J.jsxs(PP,{children:[J.jsx(Vw,{edge:"end","aria-label":"open",onClick:()=>o(!s),children:s?J.jsx(bE,{}):J.jsx(DH,{})}),J.jsx(lp,{children:J.jsx(up,{checked:A.visible,disabled:A.masterVisible===!1,onClick:()=>x(A.visible??!1)})})]}),J.jsx(Dh,{primary:A.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},A.uuid),J.jsx(OH,{open:s,children:J.jsx(NH,{disablePadding:!0,children:A.config?.layers?.map(F=>J.jsxs(S1,{sx:{...t.listItemSx},secondaryAction:void 0,children:[" ",J.jsx(PP,{children:J.jsx(lp,{children:J.jsx(up,{checked:(F?.layout?.visibility??"visible")==="visible",disabled:F?.masterVisible===!1,onClick:()=>x(F?.layout?.visibility==="visible",F.id)})})}),J.jsx(Dh,{variant:"layerlist",primary:F["source-layer"],primaryTypographyProps:{overflow:"hidden"}},F.id)]},F.id))})},A.uuid+"_list")]});if(A?.type==="wms"){const F=A.config?.visible??!0;return J.jsx(J.Fragment,{children:J.jsxs(S1,{sx:{...t.listItemSx},secondaryAction:void 0,children:[J.jsx(lp,{children:J.jsx(up,{checked:F,disabled:A.masterVisible===!1,onClick:()=>x(F)})}),J.jsx(Dh,{primary:A.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},A.uuid)})}return A.type==="folder"?J.jsxs(J.Fragment,{children:[J.jsxs(S1,{sx:{...t.listItemSx},children:[J.jsxs(PP,{children:[J.jsx(Vw,{edge:"end","aria-label":"open",onClick:()=>o(!s),children:s?J.jsx(bE,{}):J.jsx(DH,{})}),J.jsx(lp,{children:J.jsx(up,{checked:A.visible,disabled:A.masterVisible,onClick:()=>x(A.visible?A.visible:!1)})})]}),J.jsx(Dh,{primary:A.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},A.uuid),J.jsx(OH,{open:s,children:J.jsx(NH,{disablePadding:!0,children:t?.layerOrderConfig?.layers?.map(F=>J.jsx(iT,{layerOrderConfig:F,mapConfigKey:t.mapConfigKey},F.uuid))})},A.uuid+"_list")]}):J.jsx(J.Fragment,{})}return J.jsx(J.Fragment,{children:a&&T(a)})}try{iT.displayName="LayerTreeListItem",iT.__docgenInfo={description:"",displayName:"LayerTreeListItem",props:{visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"layer"'},{value:'"background"'},{value:'"background-labels"'},{value:'"wms-layer"'},{value:'"vector-tile-layer"'}]}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string | undefined"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string | undefined"}},setLayerState:{defaultValue:null,description:"",name:"setLayerState",required:!1,type:{name:"((state: unknown) => void) | undefined"}},showDeleteButton:{defaultValue:null,description:"",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},listItemSx:{defaultValue:null,description:"",name:"listItemSx",required:!1,type:{name:"SxProps | undefined"}},buttons:{defaultValue:null,description:"",name:"buttons",required:!1,type:{name:"Element | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}},layerOrderConfig:{defaultValue:null,description:"",name:"layerOrderConfig",required:!0,type:{name:"LayerOrderItem"}}}}}catch{}const DFe=Dr(Rf)({marginTop:"15px"});function LH(t){const e=Vm(r=>r.mapConfig.mapConfigs?.[t.mapConfigKey]?.layerOrder);return J.jsx(DFe,{children:e?.map?.(r=>J.jsx(iT,{layerOrderConfig:r,mapConfigKey:t.mapConfigKey},r.uuid))})}try{LH.displayName="LayerTree",LH.__docgenInfo={description:"",displayName:"LayerTree",props:{mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}}}}}catch{}function FH(t){const e=Vm(c=>c.mapConfig.mapConfigs?.[t.mapConfigKey]?.layers),r=Vm(c=>c.mapConfig.mapConfigs?.[t.mapConfigKey]?.layerOrder),n=va({mapId:t?.mapId}),i=Vm(c=>EFe(c,t.mapConfigKey)),a=te.useRef([]);te.useEffect(()=>{if(!n.map||!r)return;const c=(d,m,b)=>{for(let x=0;x<d.length;x++){const E=d[x],T=m?m[x]:null;if(E.uuid!==T?.uuid&&b.getLayer(E.uuid)){const A=x>0?d[x-1].uuid:void 0;b.moveLayer(E.uuid,A)}if(E.layers&&E.layers.length>0){const A=T?.layers||[];c(E.layers,A,b)}}},h=a.current;c(r,h,n.map),a.current=r},[r,n.map]);const s=te.useMemo(()=>["order-background",...i.map(h=>"layer_id_"+h),"order-labels"],[i]);function o(c){const h=e.findIndex(m=>m.uuid===c.uuid),d=e[h];switch(d?.type){case"geojson":return J.jsx(Dc,{layerId:d.uuid,insertBeforeLayer:"layer_id_"+d.uuid,...d.config,options:{...d.config.options,layout:{...d?.config?.options?.layout,visibility:d.masterVisible===!1?"none":d?.config?.options?.layout?.visibility?d?.config?.options?.layout?.visibility:"visible"}}},d.uuid);case"vt":{const m=d.config.layers.map(b=>{const x={...b};return x.layout&&(x.layout={...x.layout,visibility:x.masterVisible===!1?"none":x.layout.visibility??"visible"}),x});return J.jsx(P0,{layerId:d.uuid,insertBeforeLayer:"layer_id_"+d.uuid,url:d.config.url,layers:m},d.uuid)}case"wms":{const m=d.masterVisible===!1?!1:d.config?.visible;return J.jsx(BE,{layerId:d.uuid,insertBeforeLayer:"layer_id_"+d.uuid,url:d.config?.url||"",urlParameters:d.config?.urlParameters,visible:m},d.uuid)}case"folder":return c?.layers?c.layers.map(m=>o(m)):J.jsx(J.Fragment,{});default:return null}}return J.jsxs(J.Fragment,{children:[J.jsx(jE,{layerIds:s}),r?.map?.(c=>o(c))]})}try{FH.displayName="LayerOnMap",FH.__docgenInfo={description:"",displayName:"LayerOnMap",props:{mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}function aT(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const PL=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),BH=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);BH&&parseFloat(BH[1]);const zH=globalThis,jH=globalThis.process||{},OFe=globalThis.navigator||{};function Ate(t){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;const r=typeof navigator<"u"&&navigator.userAgent;return!!(r&&r.indexOf("Electron")>=0)}function My(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||Ate()}function NFe(t){return My()?Ate()?"Electron":(OFe.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const Ite="4.1.0";function LFe(t){try{const e=window[t],r="__storage_test__";return e.setItem(r,r),e.removeItem(r),e}catch{return null}}class FFe{constructor(e,r,n="sessionStorage"){this.storage=LFe(n),this.id=e,this.config=r,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}}_loadConfiguration(){let e={};if(this.storage){const r=this.storage.getItem(this.id);e=r?JSON.parse(r):{}}return Object.assign(this.config,e),this}}function BFe(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function zFe(t,e=8){const r=Math.max(e-t.length,0);return`${" ".repeat(r)}${t}`}var oT;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(oT||(oT={}));const jFe=10;function UH(t){return typeof t!="string"?t:(t=t.toUpperCase(),oT[t]||oT.WHITE)}function UFe(t,e,r){return!My&&typeof t=="string"&&(e&&(t=`\x1B[${UH(e)}m${t}\x1B[39m`),r&&(t=`\x1B[${UH(r)+jFe}m${t}\x1B[49m`)),t}function VFe(t,e=["constructor"]){const r=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(r),i=t;for(const a of n){const s=i[a];typeof s=="function"&&(e.find(o=>a===o)||(i[a]=s.bind(t)))}}function kL(t,e){if(!t)throw new Error("Assertion failed")}function Cv(){let t;if(My()&&zH.performance)t=zH?.performance?.now?.();else if("hrtime"in jH){const e=jH?.hrtime?.();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}const Av={debug:My()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},$Fe={enabled:!0,level:0};function Iv(){}const VH={},$H={once:!0};class n2{constructor({id:e}={id:""}){this.VERSION=Ite,this._startTs=Cv(),this._deltaTs=Cv(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new FFe(`__probe-${this.id}__`,$Fe),this.timeStamp(`${this.id} started`),VFe(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Cv()-this._startTs).toPrecision(10))}getDelta(){return Number((Cv()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,r){this._storage.setConfiguration({[e]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,r){if(!e)throw new Error(r||"Assertion failed")}warn(e){return this._getLogFunction(0,e,Av.warn,arguments,$H)}error(e){return this._getLogFunction(0,e,Av.error,arguments)}deprecated(e,r){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${r}\` instead`)}removed(e,r){return this.error(`\`${e}\` has been removed. Use \`${r}\` instead`)}probe(e,r){return this._getLogFunction(e,r,Av.log,arguments,{time:!0,once:!0})}log(e,r){return this._getLogFunction(e,r,Av.debug,arguments)}info(e,r){return this._getLogFunction(e,r,console.info,arguments)}once(e,r){return this._getLogFunction(e,r,Av.debug||Av.info,arguments,$H)}table(e,r,n){return r?this._getLogFunction(e,r,console.table||Iv,n&&[n],{tag:HFe(r)}):Iv}time(e,r){return this._getLogFunction(e,r,console.time?console.time:console.info)}timeEnd(e,r){return this._getLogFunction(e,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,r){return this._getLogFunction(e,r,console.timeStamp||Iv)}group(e,r,n={collapsed:!1}){const i=qH({logLevel:e,message:r,opts:n}),{collapsed:a}=n;return i.method=(a?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,r,n={}){return this.group(e,r,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Iv)}withGroup(e,r,n){this.group(e,r)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Pte(e)}_getLogFunction(e,r,n,i,a){if(this._shouldLog(e)){a=qH({logLevel:e,message:r,args:i,opts:a}),n=n||a.method,kL(n),a.total=this.getTotal(),a.delta=this.getDelta(),this._deltaTs=Cv();const s=a.tag||a.message;if(a.once&&s)if(!VH[s])VH[s]=Cv();else return Iv;return r=qFe(this.id,a.message,a),n.bind(console,r,...a.args)}return Iv}}n2.VERSION=Ite;function Pte(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return kL(Number.isFinite(e)&&e>=0),e}function qH(t){const{logLevel:e,message:r}=t;t.logLevel=Pte(e);const n=t.args?Array.from(t.args):[];for(;n.length&&n.shift()!==r;);switch(typeof e){case"string":case"function":r!==void 0&&n.unshift(r),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return kL(i==="string"||i==="object"),Object.assign(t,{args:n},t.opts)}function qFe(t,e,r){if(typeof e=="string"){const n=r.time?zFe(BFe(r.total)):"";e=r.time?`${t}: ${n}  ${e}`:`${t}: ${e}`,e=UFe(e,r.color,r.background)}return e}function HFe(t){for(const e in t)for(const r in t[e])return r||"untitled";return"empty"}const kP="4.3.3",WFe=kP[0]>="0"&&kP[0]<="9"?`v${kP}`:"";function GFe(){const t=new n2({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=WFe,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}const XFe=GFe();function YFe(t,e){return kte(t||{},e)}function kte(t,e,r=0){if(r>3)return e;const n={...t};for(const[i,a]of Object.entries(e))a&&typeof a=="object"&&!Array.isArray(a)?n[i]=kte(n[i]||{},e[i],r+1):n[i]=e[i];return n}const ZFe="latest";function KFe(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}const JFe=KFe();function Mg(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const $m=typeof process!="object"||String(process)!=="[object process]"||process.browser,IGe=typeof importScripts=="function",QFe=typeof window<"u"&&typeof window.orientation<"u",HH=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);HH&&parseFloat(HH[1]);class e8e{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,r){this.name=e,this.workerThread=r,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(e,r){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:r})}done(e){Mg(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Mg(this.isRunning),this.isRunning=!1,this._reject(e)}}class RP{terminate(){}}const MP=new Map;function t8e(t){Mg(t.source&&!t.url||!t.source&&t.url);let e=MP.get(t.source||t.url);return e||(t.url&&(e=r8e(t.url),MP.set(t.url,e)),t.source&&(e=Rte(t.source),MP.set(t.source,e))),Mg(e),e}function r8e(t){if(!t.startsWith("http"))return t;const e=n8e(t);return Rte(e)}function Rte(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function n8e(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function Mte(t,e=!0,r){const n=r||new Set;if(t){if(WH(t))n.add(t);else if(WH(t.buffer))n.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)Mte(t[i],e,n)}}return r===void 0?Array.from(n):[]}function WH(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const DP=()=>{};class qM{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&$m||typeof RP<"u"&&!$m}constructor(e){const{name:r,source:n,url:i}=e;Mg(n||i),this.name=r,this.source=n,this.url=i,this.onMessage=DP,this.onError=a=>console.log(a),this.worker=$m?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=DP,this.onError=DP,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,r){r=r||Mte(e),this.worker.postMessage(e,r)}_getErrorFromErrorEvent(e){let r="Failed to load ";return r+=`worker ${this.name} from ${this.url}. `,e.message&&(r+=`${e.message} in `),e.lineno&&(r+=`:${e.lineno}:${e.colno}`),new Error(r)}_createBrowserWorker(){this._loadableURL=t8e({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=r=>{r.data?this.onMessage(r.data):this.onError(new Error("No data received"))},e.onerror=r=>{this.onError(this._getErrorFromErrorEvent(r)),this.terminated=!0},e.onmessageerror=r=>console.error(r),e}_createNodeWorker(){let e;if(this.url){const n=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new RP(n,{eval:!1})}else if(this.source)e=new RP(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",r=>{this.onMessage(r)}),e.on("error",r=>{this.onError(r)}),e.on("exit",r=>{}),e}}class i8e{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return qM.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,r=(i,a,s)=>i.done(s),n=(i,a)=>i.error(a)){const i=new Promise(a=>(this.jobQueue.push({name:e,onMessage:r,onError:n,onStart:a}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const r=this.jobQueue.shift();if(r){this.onDebug({message:"Starting job",name:r.name,workerThread:e,backlog:this.jobQueue.length});const n=new e8e(r.name,e);e.onMessage=i=>r.onMessage(n,i.type,i.payload),e.onError=i=>r.onError(n,i),r.onStart(n);try{await n.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!$m||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new qM({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return QFe?this.maxMobileConcurrency:this.maxConcurrency}}const a8e={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class ug{props;workerPools=new Map;static _workerFarm;static isSupported(){return qM.isSupported()}static getWorkerFarm(e={}){return ug._workerFarm=ug._workerFarm||new ug({}),ug._workerFarm.setProps(e),ug._workerFarm}constructor(e){this.props={...a8e},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const r of this.workerPools.values())r.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:r,source:n,url:i}=e;let a=this.workerPools.get(r);return a||(a=new i8e({name:r,source:n,url:i}),a.setProps(this._getWorkerPoolProps()),this.workerPools.set(r,a)),a}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function o8e(t,e={}){const r=e[t.id]||{},n=$m?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=r.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&($m?i=`modules/${t.module}/dist/${n}`:i=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let a=t.version;a==="latest"&&(a=ZFe);const s=a?`@${a}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${s}/dist/${n}`}return Mg(i),i}function s8e(t,e=JFe){Mg(t,"no worker provided");const r=t.version;return!(!e||!r)}function l8e(t,e){return!ug.isSupported()||!$m&&!e?._nodeWorkers?!1:t.worker&&e?.worker}async function u8e(t,e,r,n,i){const a=t.id,s=o8e(t,r),c=ug.getWorkerFarm(r).getWorkerPool({name:a,url:s});r=JSON.parse(JSON.stringify(r)),n=JSON.parse(JSON.stringify(n||{}));const h=await c.startJob("process-on-worker",c8e.bind(null,i));return h.postMessage("process",{input:e,options:r,context:n}),await(await h.result).result}async function c8e(t,e,r,n){switch(r){case"done":e.done(n);break;case"error":e.error(new Error(n.error));break;case"process":const{id:i,input:a,options:s}=n;try{const o=await t(a,s);e.postMessage("done",{id:i,result:o})}catch(o){const c=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:c})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function h8e(t,e,r){if(r=r||t.byteLength,t.byteLength<r||e.byteLength<r)return!1;const n=new Uint8Array(t),i=new Uint8Array(e);for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}function f8e(...t){return d8e(t)}function d8e(t){const e=t.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),r=e.reduce((a,s)=>a+s.byteLength,0),n=new Uint8Array(r);let i=0;for(const a of e)n.set(a,i),i+=a.byteLength;return n.buffer}function PGe(t,e,r){const n=r!==void 0?new Uint8Array(t).subarray(e,e+r):new Uint8Array(t).subarray(e);return new Uint8Array(n).buffer}async function p8e(t){const e=[];for await(const r of t)e.push(r);return f8e(...e)}function GH(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class XH{constructor(e,r){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=r,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=GH(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(GH()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class W3{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,r="count"){return this._getOrCreate({name:e,type:r})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const r of Object.values(this.stats))e(r)}getTable(){const e={};return this.forEach(r=>{e[r.name]={time:r.time||0,count:r.count||0,average:r.getAverageTime()||0,hz:r.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(r=>this._getOrCreate(r))}_getOrCreate(e){const{name:r,type:n}=e;let i=this.stats[r];return i||(e instanceof XH?i=e:i=new XH(r,n),this.stats[r]=i),i}}let g8e="";const YH={};function m8e(t){for(const e in YH)if(t.startsWith(e)){const r=YH[e];t=t.replace(e,r)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${g8e}${t}`),t}function y8e(t){return t&&typeof t=="object"&&t.isBuffer}function Dte(t){if(y8e(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function v8e(){if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();const t=window.location?.pathname;return t?.slice(0,t.lastIndexOf("/")+1)||""}function Ote(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function _8e(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}function kGe(...t){const e=[];for(let a=0;a<t.length;a++)e[a]=t[a];let r="",n=!1,i;for(let a=e.length-1;a>=-1&&!n;a--){let s;a>=0?s=e[a]:(i===void 0&&(i=v8e()),s=i),s.length!==0&&(r=`${s}/${r}`,n=s.charCodeAt(0)===K1)}return r=b8e(r,!n),n?`/${r}`:r.length>0?r:"."}const K1=47,OP=46;function b8e(t,e){let r="",n=-1,i=0,a,s=!1;for(let o=0;o<=t.length;++o){if(o<t.length)a=t.charCodeAt(o);else{if(a===K1)break;a=K1}if(a===K1){if(!(n===o-1||i===1))if(n!==o-1&&i===2){if(r.length<2||!s||r.charCodeAt(r.length-1)!==OP||r.charCodeAt(r.length-2)!==OP){if(r.length>2){const c=r.length-1;let h=c;for(;h>=0&&r.charCodeAt(h)!==K1;--h);if(h!==c){r=h===-1?"":r.slice(0,h),n=o,i=0,s=!1;continue}}else if(r.length===2||r.length===1){r="",n=o,i=0,s=!1;continue}}e&&(r.length>0?r+="/..":r="..",s=!0)}else{const c=t.slice(n+1,o);r.length>0?r+=`/${c}`:r=c,s=!1}n=o,i=0}else a===OP&&i!==-1?++i:i=-1}return r}const x8e=t=>typeof t=="boolean",wb=t=>typeof t=="function",i2=t=>t!==null&&typeof t=="object",ZH=t=>i2(t)&&t.constructor==={}.constructor,w8e=t=>!!t&&typeof t[Symbol.iterator]=="function",S8e=t=>t&&typeof t[Symbol.asyncIterator]=="function",Dy=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Oy=t=>typeof Blob<"u"&&t instanceof Blob,E8e=t=>t&&typeof t=="object"&&t.isBuffer,T8e=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||i2(t)&&wb(t.tee)&&wb(t.cancel)&&wb(t.getReader),C8e=t=>i2(t)&&wb(t.read)&&wb(t.pipe)&&x8e(t.readable),Nte=t=>T8e(t)||C8e(t);class A8e extends Error{constructor(e,r){super(e),this.reason=r.reason,this.url=r.url,this.response=r.response}reason;url;response}const I8e=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,P8e=/^([-\w.]+\/[-\w.+]+)/;function KH(t,e){return t.toLowerCase()===e.toLowerCase()}function k8e(t){const e=P8e.exec(t);return e?e[1]:t}function JH(t){const e=I8e.exec(t);return e?e[1]:""}const Lte=/\?.*/;function R8e(t){const e=t.match(Lte);return e&&e[0]}function RL(t){return t.replace(Lte,"")}function M8e(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function G3(t){return Dy(t)?t.url:Oy(t)?t.name||"":typeof t=="string"?t:""}function ML(t){if(Dy(t)){const e=t,r=e.headers.get("content-type")||"",n=RL(e.url);return k8e(r)||JH(n)}return Oy(t)?t.type||"":typeof t=="string"?JH(t):""}function D8e(t){return Dy(t)?t.headers["content-length"]||-1:Oy(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function Fte(t){if(Dy(t))return t;const e={},r=D8e(t);r>=0&&(e["content-length"]=String(r));const n=G3(t),i=ML(t);i&&(e["content-type"]=i);const a=await L8e(t);a&&(e["x-first-bytes"]=a),typeof t=="string"&&(t=new TextEncoder().encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:n}),s}async function O8e(t){if(!t.ok)throw await N8e(t)}async function N8e(t){const e=M8e(t.url);let r=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;r=r.length>100?`${r.slice(0,100)}...`:r;const n={reason:t.statusText,url:t.url,response:t};try{const i=t.headers.get("Content-Type");n.reason=!t.bodyUsed&&i?.includes("application/json")?await t.json():await t.text()}catch{}return new A8e(r,n)}async function L8e(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const r=t.slice(0,5);return await new Promise(n=>{const i=new FileReader;i.onload=a=>n(a?.target?.result),i.readAsDataURL(r)})}if(t instanceof ArrayBuffer){const r=t.slice(0,5);return`data:base64,${F8e(r)}`}return null}function F8e(t){let e="";const r=new Uint8Array(t);for(let n=0;n<r.byteLength;n++)e+=String.fromCharCode(r[n]);return btoa(e)}function B8e(t){return!z8e(t)&&!j8e(t)}function z8e(t){return t.startsWith("http:")||t.startsWith("https:")}function j8e(t){return t.startsWith("data:")}async function QH(t,e){if(typeof t=="string"){const r=m8e(t);return B8e(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,e):await fetch(r,e)}return await Fte(t)}const eW=new n2({id:"loaders.gl"});class U8e{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class V8e{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const Bte={fetch:null,mimeType:void 0,nothrow:!1,log:new V8e,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:PL,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},$8e={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function zte(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function jte(){const t=zte();return t.globalOptions=t.globalOptions||{...Bte},t.globalOptions}function q8e(t,e,r,n){return r=r||[],r=Array.isArray(r)?r:[r],H8e(t,r),G8e(e,t,n)}function H8e(t,e){tW(t,null,Bte,$8e,e);for(const r of e){const n=t&&t[r.id]||{},i=r.options&&r.options[r.id]||{},a=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};tW(n,r.id,i,a,e)}}function tW(t,e,r,n,i){const a=e||"Top level",s=e?`${e}.`:"";for(const o in t){const c=!e&&i2(t[o]),h=o==="baseUri"&&!e,d=o==="workerUrl"&&e;if(!(o in r)&&!h&&!d){if(o in n)eW.warn(`${a} loader option '${s}${o}' no longer supported, use '${n[o]}'`)();else if(!c){const m=W8e(o,i);eW.warn(`${a} loader option '${s}${o}' not recognized. ${m}`)()}}}}function W8e(t,e){const r=t.toLowerCase();let n="";for(const i of e)for(const a in i.options){if(t===a)return`Did you mean '${i.id}.${a}'?`;const s=a.toLowerCase();(r.startsWith(s)||s.startsWith(r))&&(n=n||`Did you mean '${i.id}.${a}'?`)}return n}function G8e(t,e,r){const i={...t.options||{}};return X8e(i,r),i.log===null&&(i.log=new U8e),rW(i,jte()),rW(i,e),i}function rW(t,e){for(const r in e)if(r in e){const n=e[r];ZH(n)&&ZH(t[r])?t[r]={...t[r],...e[r]}:t[r]=e[r]}}function X8e(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function DL(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t?.extensions)):!1}function OL(t){aT(t,"null loader"),aT(DL(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t?.parseTextSync||t?.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Ute=()=>{const t=zte();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function Y8e(t){const e=Ute();t=Array.isArray(t)?t:[t];for(const r of t){const n=OL(r);e.find(i=>n===i)||e.unshift(n)}}function Z8e(){return Ute()}const K8e=/\.([^.]+)$/;async function J8e(t,e=[],r,n){if(!Vte(t))return null;let i=nW(t,e,{...r,nothrow:!0},n);if(i)return i;if(Oy(t)&&(t=await t.slice(0,10).arrayBuffer(),i=nW(t,e,r,n)),!i&&!r?.nothrow)throw new Error($te(t));return i}function nW(t,e=[],r,n){if(!Vte(t))return null;if(e&&!Array.isArray(e))return OL(e);let i=[];e&&(i=i.concat(e)),r?.ignoreRegisteredLoaders||i.push(...Z8e()),eBe(i);const a=Q8e(t,i,r,n);if(!a&&!r?.nothrow)throw new Error($te(t));return a}function Q8e(t,e,r,n){const i=G3(t),a=ML(t),s=RL(i)||n?.url;let o=null,c="";return r?.mimeType&&(o=NP(e,r?.mimeType),c=`match forced by supplied MIME type ${r?.mimeType}`),o=o||tBe(e,s),c=c||(o?`matched url ${s}`:""),o=o||NP(e,a),c=c||(o?`matched MIME type ${a}`:""),o=o||nBe(e,t),c=c||(o?`matched initial data ${qte(t)}`:""),r?.fallbackMimeType&&(o=o||NP(e,r?.fallbackMimeType),c=c||(o?`matched fallback MIME type ${a}`:"")),c&&XFe.log(1,`selectLoader selected ${o?.name}: ${c}.`),o}function Vte(t){return!(t instanceof Response&&t.status===204)}function $te(t){const e=G3(t),r=ML(t);let n="No valid loader found (";n+=e?`${Ote(e)}, `:"no url provided, ",n+=`MIME type: ${r?`"${r}"`:"not provided"}, `;const i=t?qte(t):"";return n+=i?` first bytes: "${i}"`:"first bytes: not available",n+=")",n}function eBe(t){for(const e of t)OL(e)}function tBe(t,e){const r=e&&K8e.exec(e),n=r&&r[1];return n?rBe(t,n):null}function rBe(t,e){e=e.toLowerCase();for(const r of t)for(const n of r.extensions)if(n.toLowerCase()===e)return r;return null}function NP(t,e){for(const r of t)if(r.mimeTypes?.some(n=>KH(e,n))||KH(e,`application/x.${r.id}`))return r;return null}function nBe(t,e){if(!e)return null;for(const r of t)if(typeof e=="string"){if(iBe(e,r))return r}else if(ArrayBuffer.isView(e)){if(iW(e.buffer,e.byteOffset,r))return r}else if(e instanceof ArrayBuffer&&iW(e,0,r))return r;return null}function iBe(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(n=>t.startsWith(n))}function iW(t,e,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(i=>aBe(t,e,r,i))}function aBe(t,e,r,n){if(n instanceof ArrayBuffer)return h8e(n,t,n.byteLength);switch(typeof n){case"function":return n(t);case"string":const i=HM(t,e,n.length);return n===i;default:return!1}}function qte(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?HM(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?HM(t,0,e):""}function HM(t,e,r){if(t.byteLength<e+r)return"";const n=new DataView(t);let i="";for(let a=0;a<r;a++)i+=String.fromCharCode(n.getUint8(e+a));return i}const oBe=256*1024;function*sBe(t,e){const r=e?.chunkSize||oBe;let n=0;const i=new TextEncoder;for(;n<t.length;){const a=Math.min(t.length-n,r),s=t.slice(n,n+a);n+=a,yield i.encode(s)}}const lBe=256*1024;function*uBe(t,e={}){const{chunkSize:r=lBe}=e;let n=0;for(;n<t.byteLength;){const i=Math.min(t.byteLength-n,r),a=new ArrayBuffer(i),s=new Uint8Array(t,n,i);new Uint8Array(a).set(s),n+=i,yield a}}const cBe=1024*1024;async function*hBe(t,e){const r=e?.chunkSize||cBe;let n=0;for(;n<t.size;){const i=n+r,a=await t.slice(n,i).arrayBuffer();n=i,yield a}}function aW(t,e){return PL?fBe(t,e):dBe(t)}async function*fBe(t,e){const r=t.getReader();let n;try{for(;;){const i=n||r.read();e?._streamReadAhead&&(n=r.read());const{done:a,value:s}=await i;if(a)return;yield Dte(s)}}catch{r.releaseLock()}}async function*dBe(t,e){for await(const r of t)yield Dte(r)}function pBe(t,e){if(typeof t=="string")return sBe(t,e);if(t instanceof ArrayBuffer)return uBe(t,e);if(Oy(t))return hBe(t,e);if(Nte(t))return aW(t,e);if(Dy(t))return aW(t.body,e);throw new Error("makeIterator")}const Hte="Cannot convert supplied data type";function gBe(t,e,r){if(e.text&&typeof t=="string")return t;if(E8e(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(t.byteOffset,t.byteOffset+i)),n}throw new Error(Hte)}async function mBe(t,e,r){const n=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||n)return gBe(t,e);if(Oy(t)&&(t=await Fte(t)),Dy(t)){const i=t;return await O8e(i),e.binary?await i.arrayBuffer():await i.text()}if(Nte(t)&&(t=pBe(t,r)),w8e(t)||S8e(t))return p8e(t);throw new Error(Hte)}function Wte(t,e){const r=jte(),n=t||r;return typeof n.fetch=="function"?n.fetch:i2(n.fetch)?i=>QH(i,n.fetch):e?.fetch?e?.fetch:QH}function yBe(t,e,r){if(r)return r;const n={fetch:Wte(e,t),...t};if(n.url){const i=RL(n.url);n.baseUrl=i,n.queryString=R8e(n.url),n.filename=Ote(i),n.baseUrl=_8e(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function vBe(t,e){if(t&&!Array.isArray(t))return t;let r;if(t&&(r=Array.isArray(t)?t:[t]),e&&e.loaders){const n=Array.isArray(e.loaders)?e.loaders:[e.loaders];r=r?[...r,...n]:n}return r&&r.length?r:void 0}async function sT(t,e,r,n){e&&!Array.isArray(e)&&!DL(e)&&(n=void 0,r=e,e=void 0),t=await t,r=r||{};const i=G3(t),s=vBe(e,n),o=await J8e(t,s,r);return o?(r=q8e(r,o,s,i),n=yBe({url:i,_parse:sT,loaders:s},r,n||null),await _Be(o,t,r,n)):null}async function _Be(t,e,r,n){if(s8e(t),r=YFe(t.options,r),Dy(e)){const a=e,{ok:s,redirected:o,status:c,statusText:h,type:d,url:m}=a,b=Object.fromEntries(a.headers.entries());n.response={headers:b,ok:s,redirected:o,status:c,statusText:h,type:d,url:m}}e=await mBe(e,t,r);const i=t;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,r,n);if(l8e(t,r))return await u8e(t,e,r,n,sT);if(i.parseText&&typeof e=="string")return await i.parseText(e,r,n);if(i.parse)return await i.parse(e,r,n);throw Mg(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}async function WM(t,e,r,n){let i,a;!Array.isArray(e)&&!DL(e)?(i=[],a=e):(i=e,a=r);const s=Wte(a);let o=t;return typeof t=="string"&&(o=await s(t)),Oy(t)&&(o=await s(t)),Array.isArray(i)?await sT(o,i,a):await sT(o,i,a)}const bBe="4.3.3",xBe=globalThis.loaders?.parseImageNode,GM=typeof Image<"u",XM=typeof ImageBitmap<"u",wBe=!!xBe,YM=PL?!0:wBe;function SBe(t){switch(t){case"auto":return XM||GM||YM;case"imagebitmap":return XM;case"image":return GM;case"data":return YM;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function EBe(){if(XM)return"imagebitmap";if(GM)return"image";if(YM)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function TBe(t){const e=ABe(t);if(!e)throw new Error("Not an image");return e}function CBe(t){switch(TBe(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),r=e.getContext("2d");if(!r)throw new Error("getImageData");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0),r.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function ABe(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const IBe=/^data:image\/svg\+xml/,PBe=/\.svg((\?|#).*)?$/;function NL(t){return t&&(IBe.test(t)||PBe.test(t))}function kBe(t,e){if(NL(e)){let n=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(a){throw new Error(a.message)}return`data:image/svg+xml;base64,${btoa(n)}`}return Gte(t,e)}function Gte(t,e){if(NL(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Xte(t,e,r){const n=kBe(t,r),i=self.URL||self.webkitURL,a=typeof n!="string"&&i.createObjectURL(n);try{return await RBe(a||n,e)}finally{a&&i.revokeObjectURL(a)}}async function RBe(t,e){const r=new Image;return r.src=t,e.image&&e.image.decode&&r.decode?(await r.decode(),r):await new Promise((n,i)=>{try{r.onload=()=>n(r),r.onerror=a=>{const s=a instanceof Error?a.message:"error";i(new Error(s))}}catch(a){i(a)}})}const MBe={};let oW=!0;async function DBe(t,e,r){let n;NL(r)?n=await Xte(t,e,r):n=Gte(t,r);const i=e&&e.imagebitmap;return await OBe(n,i)}async function OBe(t,e=null){if((NBe(e)||!oW)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(r){console.warn(r),oW=!1}return await createImageBitmap(t)}function NBe(t){for(const e in t||MBe)return!1;return!0}function LBe(t){return!jBe(t,"ftyp",4)||(t[8]&96)===0?null:FBe(t)}function FBe(t){switch(BBe(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function BBe(t,e,r){return String.fromCharCode(...t.slice(e,r))}function zBe(t){return[...t].map(e=>e.charCodeAt(0))}function jBe(t,e,r=0){const n=zBe(e);for(let i=0;i<n.length;++i)if(n[i]!==t[i+r])return!1;return!0}const hd=!1,Sb=!0;function Yte(t){const e=a2(t);return VBe(e)||HBe(e)||$Be(e)||qBe(e)||UBe(e)}function UBe(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),r=LBe(e);return r?{mimeType:r.mimeType,width:0,height:0}:null}function VBe(t){const e=a2(t);return e.byteLength>=24&&e.getUint32(0,hd)===2303741511?{mimeType:"image/png",width:e.getUint32(16,hd),height:e.getUint32(20,hd)}:null}function $Be(t){const e=a2(t);return e.byteLength>=10&&e.getUint32(0,hd)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Sb),height:e.getUint16(8,Sb)}:null}function qBe(t){const e=a2(t);return e.byteLength>=14&&e.getUint16(0,hd)===16973&&e.getUint32(2,Sb)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Sb),height:e.getUint32(22,Sb)}:null}function HBe(t){const e=a2(t);if(!(e.byteLength>=3&&e.getUint16(0,hd)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:n,sofMarkers:i}=WBe();let a=2;for(;a+9<e.byteLength;){const s=e.getUint16(a,hd);if(i.has(s))return{mimeType:"image/jpeg",height:e.getUint16(a+5,hd),width:e.getUint16(a+7,hd)};if(!n.has(s))return null;a+=2,a+=e.getUint16(a,hd)}return null}function WBe(){const t=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)t.add(r);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function a2(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function GBe(t,e){const{mimeType:r}=Yte(t)||{},n=globalThis.loaders?.parseImageNode;return aT(n),await n(t,r)}async function XBe(t,e,r){e=e||{};const i=(e.image||{}).type||"auto",{url:a}=r||{},s=YBe(i);let o;switch(s){case"imagebitmap":o=await DBe(t,e,a);break;case"image":o=await Xte(t,e,a);break;case"data":o=await GBe(t);break;default:aT(!1)}return i==="data"&&(o=CBe(o)),o}function YBe(t){switch(t){case"auto":case"data":return EBe();default:return SBe(t),t}}const ZBe=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],KBe=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],JBe={image:{type:"auto",decode:!0}},QBe={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:bBe,mimeTypes:KBe,extensions:ZBe,parse:XBe,tests:[t=>!!Yte(new DataView(t))],options:JBe},po=new n2({id:"deck"});let ZM={};function eze(t){ZM=t}function mc(t,e,r,n){po.level>0&&ZM[t]&&ZM[t].call(null,e,r,n)}function tze(t){const e=t[0],r=t[t.length-1];return e==="{"&&r==="}"||e==="["&&r==="]"}const rze={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:tze,parseTextSync:JSON.parse};function nze(){const t="9.2.6",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(po.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:po,_registerLoggers:eze},Y8e([rze,[QBe,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const ize=nze();function LL(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const LP={number:{type:"number",validate(t,e){return Number.isFinite(t)&&typeof e=="object"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:"array",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function aze(t){const e={};for(const[r,n]of Object.entries(t))e[r]=oze(n);return e}function oze(t){let e=sW(t);if(e!=="object")return{value:t,...LP[e],type:e};if(typeof t=="object")return t?t.type!==void 0?{...t,...LP[t.type],type:t.type}:t.value===void 0?{type:"object",value:t}:(e=sW(t.value),{...t,...LP[e],type:e}):{type:"object",value:null};throw new Error("props")}function sW(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const sze=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,lze=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,uze={vertex:sze,fragment:lze},lW=/void\s+main\s*\([^)]*\)\s*\{\n?/,uW=/}\n?[^{}]*$/,FP=[],PS="__LUMA_INJECT_DECLARATIONS__";function cze(t){const e={vertex:{},fragment:{}};for(const r in t){let n=t[r];const i=hze(r);typeof n=="string"&&(n={order:0,injection:n}),e[i][r]=n}return e}function hze(t){const e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function lT(t,e,r,n=!1){const i=e==="vertex";for(const a in r){const s=r[a];s.sort((c,h)=>c.order-h.order),FP.length=s.length;for(let c=0,h=s.length;c<h;++c)FP[c]=s[c].injection;const o=`${FP.join(`
`)}
`;switch(a){case"vs:#decl":i&&(t=t.replace(PS,o));break;case"vs:#main-start":i&&(t=t.replace(lW,c=>c+o));break;case"vs:#main-end":i&&(t=t.replace(uW,c=>o+c));break;case"fs:#decl":i||(t=t.replace(PS,o));break;case"fs:#main-start":i||(t=t.replace(lW,c=>c+o));break;case"fs:#main-end":i||(t=t.replace(uW,c=>o+c));break;default:t=t.replace(a,c=>c+o)}}return t=t.replace(PS,""),n&&(t=t.replace(/\}\s*$/,a=>a+uze[e])),t}function uT(t){t.map(e=>fze(e))}function fze(t){if(t.instance)return;uT(t.dependencies||[]);const{propTypes:e={},deprecations:r=[],inject:n={}}=t,i={normalizedInjections:cze(n),parsedDeprecations:dze(r)};e&&(i.propValidators=aze(e)),t.instance=i;let a={};e&&(a=Object.entries(e).reduce((s,[o,c])=>{const h=c?.value;return h&&(s[o]=h),s},{})),t.defaultUniforms={...t.defaultUniforms,...a}}function Zte(t,e,r){t.deprecations?.forEach(n=>{n.regex?.test(e)&&(n.deprecated?r.deprecated(n.old,n.new)():r.removed(n.old,n.new)())})}function dze(t){return t.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),t}function FL(t){uT(t);const e={},r={};Kte({modules:t,level:0,moduleMap:e,moduleDepth:r});const n=Object.keys(r).sort((i,a)=>r[a]-r[i]).map(i=>e[i]);return uT(n),n}function Kte(t){const{modules:e,level:r,moduleMap:n,moduleDepth:i}=t;if(r>=5)throw new Error("Possible loop in shader dependency graph");for(const a of e)n[a.name]=a,(i[a.name]===void 0||i[a.name]<r)&&(i[a.name]=r);for(const a of e)a.dependencies&&Kte({modules:a.dependencies,level:r+1,moduleMap:n,moduleDepth:i})}function pze(t){switch(t?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function gze(t,e){if(Number(t.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return t=cW(t,mze),t;case"fragment":return t=cW(t,yze),t;default:throw new Error(e)}}const Jte=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],mze=[...Jte,[KM("attribute"),"in $1"],[KM("varying"),"out $1"]],yze=[...Jte,[KM("varying"),"in $1"]];function cW(t,e){for(const[r,n]of e)t=t.replace(r,n);return t}function KM(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function Qte(t,e){let r="";for(const n in t){const i=t[n];if(r+=`void ${i.signature} {
`,i.header&&(r+=`  ${i.header}`),e[n]){const a=e[n];a.sort((s,o)=>s.order-o.order);for(const s of a)r+=`  ${s.injection}
`}i.footer&&(r+=`  ${i.footer}`),r+=`}
`}return r}function ere(t){const e={vertex:{},fragment:{}};for(const r of t){let n,i;typeof r!="string"?(n=r,i=n.hook):(n={},i=r),i=i.trim();const[a,s]=i.split(":"),o=i.replace(/\(.+/,""),c=Object.assign(n,{signature:s});switch(a){case"vs":e.vertex[o]=c;break;case"fs":e.fragment[o]=c;break;default:throw new Error(a)}}return e}function vze(t,e){return{name:_ze(t,e),language:"glsl",version:bze(t)}}function _ze(t,e="unnamed"){const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return n?n[1]:e}function bze(t){let e=100;const r=t.match(/[^\s]+/g);if(r&&r.length>=2&&r[0]==="#version"){const n=parseInt(r[1],10);Number.isFinite(n)&&(e=n)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const tre=`

${PS}
`,xze=`precision highp float;
`;function wze(t){const e=FL(t.modules||[]);return{source:Eze(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:rre(e)}}function Sze(t){const{vs:e,fs:r}=t,n=FL(t.modules||[]);return{vs:hW(t.platformInfo,{...t,source:e,stage:"vertex",modules:n}),fs:hW(t.platformInfo,{...t,source:r,stage:"fragment",modules:n}),getUniforms:rre(n)}}function Eze(t,e){const{source:r,stage:n,modules:i,hookFunctions:a=[],inject:s={},log:o}=e;LL(typeof r=="string","shader source must be a string");const c=r;let h="";const d=ere(a),m={},b={},x={};for(const T in s){const A=typeof s[T]=="string"?{injection:s[T],order:0}:s[T],M=/^(v|f)s:(#)?([\w-]+)$/.exec(T);if(M){const F=M[2],N=M[3];F?N==="decl"?b[T]=[A]:x[T]=[A]:m[T]=[A]}else x[T]=[A]}const E=i;for(const T of E){o&&Zte(T,c,o);const A=nre(T,"wgsl");h+=A;const M=T.injections?.[n]||{};for(const F in M){const N=/^(v|f)s:#([\w-]+)$/.exec(F);if(N){const U=N[2]==="decl"?b:x;U[F]=U[F]||[],U[F].push(M[F])}else m[F]=m[F]||[],m[F].push(M[F])}}return h+=tre,h=lT(h,n,b),h+=Qte(d[n],m),h+=c,h=lT(h,n,x),h}function hW(t,e){const{source:r,stage:n,language:i="glsl",modules:a,defines:s={},hookFunctions:o=[],inject:c={},prologue:h=!0,log:d}=e;LL(typeof r=="string","shader source must be a string");const m=i==="glsl"?vze(r).version:-1,b=t.shaderLanguageVersion,x=m===100?"#version 100":"#version 300 es",T=r.split(`
`).slice(1).join(`
`),A={};a.forEach(j=>{Object.assign(A,j.defines)}),Object.assign(A,s);let M="";switch(i){case"wgsl":break;case"glsl":M=h?`${x}

// ----- PROLOGUE -------------------------
${`#define SHADER_TYPE_${n.toUpperCase()}`}

${pze(t)}
${n==="fragment"?xze:""}

// ----- APPLICATION DEFINES -------------------------

${Tze(A)}

`:`${x}
`;break}const F=ere(o),N={},O={},U={};for(const j in c){const H=typeof c[j]=="string"?{injection:c[j],order:0}:c[j],G=/^(v|f)s:(#)?([\w-]+)$/.exec(j);if(G){const X=G[2],ae=G[3];X?ae==="decl"?O[j]=[H]:U[j]=[H]:N[j]=[H]}else U[j]=[H]}for(const j of a){d&&Zte(j,T,d);const H=nre(j,n);M+=H;const G=j.instance?.normalizedInjections[n]||{};for(const X in G){const ae=/^(v|f)s:#([\w-]+)$/.exec(X);if(ae){const W=ae[2]==="decl"?O:U;W[X]=W[X]||[],W[X].push(G[X])}else N[X]=N[X]||[],N[X].push(G[X])}}return M+="// ----- MAIN SHADER SOURCE -------------------------",M+=tre,M=lT(M,n,O),M+=Qte(F[n],N),M+=T,M=lT(M,n,U),i==="glsl"&&m!==b&&(M=gze(M,n)),M.trim()}function rre(t){return function(r){const n={};for(const i of t){const a=i.getUniforms?.(r,n);Object.assign(n,a)}return n}}function Tze(t={}){let e="";for(const r in t){const n=t[r];(n||Number.isFinite(n))&&(e+=`#define ${r.toUpperCase()} ${t[r]}
`)}return e}function nre(t,e){let r;switch(e){case"vertex":r=t.vs||"";break;case"fragment":r=t.fs||"";break;case"wgsl":r=t.source||"";break;default:LL(!1)}if(!t.name)throw new Error("Shader module must have a name");const n=t.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let i=`// ----- MODULE ${t.name} ---------------

`;return e!=="wgsl"&&(i+=`#define MODULE_${n}
`),i+=`${r}
`,i}const Cze=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,Aze=/^\s*\#\s*endif\s*$/;function Ize(t,e){const r=t.split(`
`),n=[];let i=!0,a=null;for(const s of r){const o=s.match(Cze),c=s.match(Aze);o?(a=o[1],i=!!e?.defines?.[a]):c?i=!0:i&&n.push(s)}return n.join(`
`)}class Mm{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return Mm.defaultShaderAssembler=Mm.defaultShaderAssembler||new Mm,Mm.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(r=>r.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const r=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==r)}addShaderHook(e,r){r&&(e=Object.assign(r,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const r=this._getModuleList(e.modules),n=this._hookFunctions,{source:i,getUniforms:a}=wze({...e,source:e.source,modules:r,hookFunctions:n});return{source:e.platformInfo.shaderLanguage==="wgsl"?Ize(i):i,getUniforms:a,modules:r}}assembleGLSLShaderPair(e){const r=this._getModuleList(e.modules),n=this._hookFunctions;return{...Sze({...e,vs:e.vs,fs:e.fs,modules:r,hookFunctions:n}),modules:r}}_getModuleList(e=[]){const r=new Array(this._defaultModules.length+e.length),n={};let i=0;for(let a=0,s=this._defaultModules.length;a<s;++a){const o=this._defaultModules[a],c=o.name;r[i++]=o,n[c]=!0}for(let a=0,s=e.length;a<s;++a){const o=e[a],c=o.name;n[c]||(r[i++]=o,n[c]=!0)}return r.length=i,uT(r),r}}const Pze=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,kze=`#version 300 es
${Pze}`;function Rze(t){const{input:e,inputChannels:r,output:n}={};if(!e)return kze;if(!r)throw new Error("inputChannels");const i=Mze(r),a=Dze(e,r);return`#version 300 es
in ${i} ${e};
out vec4 ${n};
void main() {
  ${n} = ${a};
}`}function Mze(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}function Dze(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}class Oze{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new W3({id:e})),this.stats.get(e)}}const ire=new Oze,rn=new n2({id:"luma.gl"}),BP={};function X3(t="id"){BP[t]=BP[t]||1;const e=BP[t]++;return`${t}-${e}`}let So=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,r,n){if(!e)throw new Error("no device");this._device=e,this.props=Nze(r,n);const i=this.props.id!=="undefined"?this.props.id:X3(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get(`${r}s Active`).decrementCount()}trackAllocatedMemory(e,r=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get(`${r} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").subtractCount(this.allocatedBytes),r.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${r}s Created`).incrementCount(),e.get(`${r}s Active`).incrementCount()}};function Nze(t,e){const r={...e};for(const n in t)t[n]!==void 0&&(r[n]=t[n]);return r}class jo extends So{static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,r){const n={...r};(r.usage||0)&jo.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?n.indexType="uint32":r.data instanceof Uint16Array?n.indexType="uint16":r.data instanceof Uint8Array&&(n.indexType="uint8")),delete n.data,super(e,n,jo.defaultProps),this.usage=n.usage||0,this.indexType=n.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,r,n){const i=ArrayBuffer.isView(e)?e.buffer:e,a=Math.min(e?e.byteLength:n,jo.DEBUG_DATA_MAX_LENGTH);i===null?this.debugData=new ArrayBuffer(a):r===0&&n===i.byteLength?this.debugData=i.slice(0,a):this.debugData=i.slice(r,r+a)}static defaultProps={...So.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",onMapped:void 0}}function are(t){const[e,r,n]=jL[t],i=t.includes("norm"),a=!i&&!t.startsWith("float"),s=t.startsWith("s");return{signedType:e,primitiveType:r,byteLength:n,normalized:i,integer:a,signed:s}}function Lze(t){const e=t;switch(e){case"uint8":return"unorm8";case"sint8":return"snorm8";case"uint16":return"unorm16";case"sint16":return"snorm16";default:return e}}function Fze(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}function BL(t){const e=ArrayBuffer.isView(t)?t.constructor:t;if(e===Uint8ClampedArray)return"uint8";const r=Object.values(jL).find(n=>e===n[4]);if(!r)throw new Error(e.name);return r[0]}function zL(t){const[,,,,e]=jL[t];return e}const jL={uint8:["uint8","u32",1,!1,Uint8Array],sint8:["sint8","i32",1,!1,Int8Array],unorm8:["uint8","f32",1,!0,Uint8Array],snorm8:["sint8","f32",1,!0,Int8Array],uint16:["uint16","u32",2,!1,Uint16Array],sint16:["sint16","i32",2,!1,Int16Array],unorm16:["uint16","u32",2,!0,Uint16Array],snorm16:["sint16","i32",2,!0,Int16Array],float16:["float16","f16",2,!1,Uint16Array],float32:["float32","f32",4,!1,Float32Array],uint32:["uint32","u32",4,!1,Uint32Array],sint32:["sint32","i32",4,!1,Int32Array]};function UL(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);const[r,n]=t.split("x"),i=r,a=n?parseInt(n):1,s=are(i),o={type:i,components:a,byteLength:s.byteLength*a,integer:s.integer,signed:s.signed,normalized:s.normalized};return e&&(o.webglOnly=!0),o}function Bze(t,e,r){const n=r?Lze(t):t;switch(n){case"unorm8":return e===1?"unorm8":e===3?"unorm8x3-webgl":`${n}x${e}`;case"snorm8":case"uint8":case"sint8":case"uint16":case"sint16":case"unorm16":case"snorm16":case"float16":if(e===1||e===3)throw new Error(`size: ${e}`);return`${n}x${e}`;default:return e===1?n:`${n}x${e}`}}function zze(t,e,r){if(!e||e>4)throw new Error(`size ${e}`);const n=e,i=BL(t);return Bze(i,n,r)}function jze(t){let e;switch(t.primitiveType){case"f32":e="float32";break;case"i32":e="sint32";break;case"u32":e="uint32";break;case"f16":return t.components<=2?"float16x2":"float16x4"}return t.components===1?e:`${e}x${t.components}`}const Xu="texture-compression-bc",bo="texture-compression-astc",rd="texture-compression-etc2",Uze="texture-compression-etc1-webgl",$w="texture-compression-pvrtc-webgl",zP="texture-compression-atc-webgl",qw="float32-renderable-webgl",jP="float16-renderable-webgl",Vze="rgb9e5ufloat-renderable-webgl",UP="snorm8-renderable-webgl",E1="norm16-renderable-webgl",VP="snorm16-renderable-webgl",Hw="float32-filterable",fW="float16-filterable-webgl";function ore(t){const e=Hze[t];if(!e)throw new Error(`Unsupported texture format ${t}`);return e}const $ze={r8unorm:{},rg8unorm:{},"rgb8unorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},r8snorm:{render:UP},rg8snorm:{render:UP},"rgb8snorm-webgl":{},rgba8snorm:{render:UP},r8uint:{},rg8uint:{},rgba8uint:{},r8sint:{},rg8sint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},r16unorm:{f:E1},rg16unorm:{render:E1},"rgb16unorm-webgl":{f:E1},rgba16unorm:{render:E1},r16snorm:{f:VP},rg16snorm:{render:VP},"rgb16snorm-webgl":{f:E1},rgba16snorm:{render:VP},r16uint:{},rg16uint:{},rgba16uint:{},r16sint:{},rg16sint:{},rgba16sint:{},r16float:{render:jP,filter:"float16-filterable-webgl"},rg16float:{render:jP,filter:fW},rgba16float:{render:jP,filter:fW},r32uint:{},rg32uint:{},rgba32uint:{},r32sint:{},rg32sint:{},rgba32sint:{},r32float:{render:qw,filter:Hw},rg32float:{render:!1,filter:Hw},"rgb32float-webgl":{render:qw,filter:Hw},rgba32float:{render:qw,filter:Hw},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},rgb9e5ufloat:{channels:"rgb",packed:!0,render:Vze},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:qw},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},rgb10a2uint:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0}},qze={"bc1-rgb-unorm-webgl":{f:Xu},"bc1-rgb-unorm-srgb-webgl":{f:Xu},"bc1-rgba-unorm":{f:Xu},"bc1-rgba-unorm-srgb":{f:Xu},"bc2-rgba-unorm":{f:Xu},"bc2-rgba-unorm-srgb":{f:Xu},"bc3-rgba-unorm":{f:Xu},"bc3-rgba-unorm-srgb":{f:Xu},"bc4-r-unorm":{f:Xu},"bc4-r-snorm":{f:Xu},"bc5-rg-unorm":{f:Xu},"bc5-rg-snorm":{f:Xu},"bc6h-rgb-ufloat":{f:Xu},"bc6h-rgb-float":{f:Xu},"bc7-rgba-unorm":{f:Xu},"bc7-rgba-unorm-srgb":{f:Xu},"etc2-rgb8unorm":{f:rd},"etc2-rgb8unorm-srgb":{f:rd},"etc2-rgb8a1unorm":{f:rd},"etc2-rgb8a1unorm-srgb":{f:rd},"etc2-rgba8unorm":{f:rd},"etc2-rgba8unorm-srgb":{f:rd},"eac-r11unorm":{f:rd},"eac-r11snorm":{f:rd},"eac-rg11unorm":{f:rd},"eac-rg11snorm":{f:rd},"astc-4x4-unorm":{f:bo},"astc-4x4-unorm-srgb":{f:bo},"astc-5x4-unorm":{f:bo},"astc-5x4-unorm-srgb":{f:bo},"astc-5x5-unorm":{f:bo},"astc-5x5-unorm-srgb":{f:bo},"astc-6x5-unorm":{f:bo},"astc-6x5-unorm-srgb":{f:bo},"astc-6x6-unorm":{f:bo},"astc-6x6-unorm-srgb":{f:bo},"astc-8x5-unorm":{f:bo},"astc-8x5-unorm-srgb":{f:bo},"astc-8x6-unorm":{f:bo},"astc-8x6-unorm-srgb":{f:bo},"astc-8x8-unorm":{f:bo},"astc-8x8-unorm-srgb":{f:bo},"astc-10x5-unorm":{f:bo},"astc-10x5-unorm-srgb":{f:bo},"astc-10x6-unorm":{f:bo},"astc-10x6-unorm-srgb":{f:bo},"astc-10x8-unorm":{f:bo},"astc-10x8-unorm-srgb":{f:bo},"astc-10x10-unorm":{f:bo},"astc-10x10-unorm-srgb":{f:bo},"astc-12x10-unorm":{f:bo},"astc-12x10-unorm-srgb":{f:bo},"astc-12x12-unorm":{f:bo},"astc-12x12-unorm-srgb":{f:bo},"pvrtc-rgb4unorm-webgl":{f:$w},"pvrtc-rgba4unorm-webgl":{f:$w},"pvrtc-rbg2unorm-webgl":{f:$w},"pvrtc-rgba2unorm-webgl":{f:$w},"etc1-rbg-unorm-webgl":{f:Uze},"atc-rgb-unorm-webgl":{f:zP},"atc-rgba-unorm-webgl":{f:zP},"atc-rgbai-unorm-webgl":{f:zP}},Hze={...$ze,...qze},Wze=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],Gze=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;class Xze{getInfo(e){return dW(e)}isColor(e){return e.startsWith("rgba")||e.startsWith("bgra")||e.startsWith("rgb")}isDepthStencil(e){return e.startsWith("depth")||e.startsWith("stencil")}isCompressed(e){return Wze.some(r=>e.startsWith(r))}getCapabilities(e){const r=ore(e),n={format:e,create:r.f??!0,render:r.render??!0,filter:r.filter??!0,blend:r.blend??!0,store:r.store??!0},i=dW(e),a=e.startsWith("depth")||e.startsWith("stencil"),s=i?.signed,o=i?.integer,c=i?.webgl;return n.render&&=!s,n.filter&&=!a&&!s&&!o&&!c,n}}const R0=new Xze;function dW(t){let e=Yze(t);if(R0.isCompressed(t)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;const n=Zze(t);n&&(e.blockWidth=n.blockWidth,e.blockHeight=n.blockHeight)}const r=Gze.exec(t);if(r){const[,n,i,a,s,o]=r,c=`${a}${i}`,h=are(c),d=h.byteLength*8,m=n.length,b=[d,m>=2?d:0,m>=3?d:0,m>=4?d:0];e={format:t,attachment:e.attachment,dataType:h.signedType,components:m,channels:n,integer:h.integer,signed:h.signed,normalized:h.normalized,bitsPerChannel:b,bytesPerPixel:h.byteLength*n.length,packed:e.packed,srgb:e.srgb},o==="-webgl"&&(e.webgl=!0),s==="-srgb"&&(e.srgb=!0)}return t.endsWith("-webgl")&&(e.webgl=!0),t.endsWith("-srgb")&&(e.srgb=!0),e}function Yze(t){const e=ore(t),r=e.bytesPerPixel||1,n=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:t,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||e.channels?.length||1,bytesPerPixel:r,bitsPerChannel:n,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function Zze(t){const r=/.*-(\d+)x(\d+)-.*/.exec(t);if(r){const[,n,i]=r;return{blockWidth:Number(n),blockHeight:Number(i)}}return null}function Kze(t){return typeof ImageData<"u"&&t instanceof ImageData||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement||typeof VideoFrame<"u"&&t instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}function Jze(t){if(typeof ImageData<"u"&&t instanceof ImageData||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height};if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)return{width:t.naturalWidth,height:t.naturalHeight};if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)return{width:t.videoWidth,height:t.videoHeight};if(typeof VideoFrame<"u"&&t instanceof VideoFrame)return{width:t.displayWidth,height:t.displayHeight};throw new Error("Unknown image type")}class Qze{}class e9e{features;disabledFeatures;constructor(e=[],r){this.features=new Set(e),this.disabledFeatures=r||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class fy{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,webgl:{},onError:(e,r)=>{},onResize:(e,r)=>{const[n,i]=e.getDevicePixelSize();rn.log(1,`${e} resized => ${n}x${i}px`)()},onPositionChange:(e,r)=>{const[n,i]=e.getPosition();rn.log(1,`${e} repositioned => ${n},${i}`)()},onVisibilityChange:e=>rn.log(1,`${e} Visibility changed ${e.isVisible}`)(),onDevicePixelRatioChange:(e,r)=>rn.log(1,`${e} DPR changed ${r.oldRatio} => ${e.devicePixelRatio}`)(),debug:rn.get("debug")||void 0,debugShaders:rn.get("debug-shaders")||void 0,debugFramebuffers:!!rn.get("debug-framebuffers"),debugFactories:!!rn.get("debug-factories"),debugWebGL:!!rn.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_reuseDevices:!1,_requestMaxLimits:!0,_cacheShaders:!1,_cachePipelines:!1,_cacheDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_handle:void 0};get[Symbol.toStringTag](){return"Device"}toString(){return`Device(${this.id})`}id;props;userData={};statsManager=ire;timestamp=0;_reused=!1;_lumaData={};_textureCaps={};constructor(e){this.props={...fy.defaultProps,...e},this.id=this.props.id||X3(this[Symbol.toStringTag].toLowerCase())}getVertexFormatInfo(e){return UL(e)}isVertexFormatSupported(e){return!0}getTextureFormatInfo(e){return R0.getInfo(e)}getTextureFormatCapabilities(e){let r=this._textureCaps[e];if(!r){const n=this._getDeviceTextureFormatCapabilities(e);r=this._getDeviceSpecificTextureFormatCapabilities(n),this._textureCaps[e]=r}return r}getMipLevelCount(e,r,n=1){const i=Math.max(e,r,n);return 1+Math.floor(Math.log2(i))}isExternalImage(e){return Kze(e)}getExternalImageSize(e){return Jze(e)}isTextureFormatSupported(e){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return R0.isCompressed(e)}pushDebugGroup(e){this.commandEncoder.pushDebugGroup(e)}popDebugGroup(){this.commandEncoder?.popDebugGroup()}insertDebugMarker(e){this.commandEncoder?.insertDebugMarker(e)}loseDevice(){return!1}incrementTimestamp(){return this.timestamp++}reportError(e,r,...n){return this.props.onError(e,r)?()=>{}:rn.error(e.message,r,...n)}debug(){if(this.props.debug)debugger;else rn.once(0,`'Type luma.log.set({debug: true}) in console to enable debug breakpoints',
or create a device with the 'debug: true' prop.`)()}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}beginRenderPass(e){return this.commandEncoder.beginRenderPass(e)}beginComputePass(e){return this.commandEncoder.beginComputePass(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,r){throw new Error("not implemented")}readPixelsToBufferWebGL(e,r){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,r){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_getDeviceTextureFormatCapabilities(e){const r=R0.getCapabilities(e),n=a=>(typeof a=="string"?this.features.has(a):a)??!0,i=n(r.create);return{format:e,create:i,render:i&&n(r.render),filter:i&&n(r.filter),blend:i&&n(r.blend),store:i&&n(r.store)}}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const r={...e};if((e.usage||0)&jo.INDEX&&(e.indexType||(e.data instanceof Uint32Array?r.indexType="uint32":e.data instanceof Uint16Array?r.indexType="uint16":e.data instanceof Uint8Array&&(r.data=new Uint16Array(e.data),r.indexType="uint16")),!r.indexType))throw new Error("indices buffer content must be of type uint16 or uint32");return r}}const t9e="set luma.log.level=1 (or higher) to trace rendering",pW="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class cT{static defaultProps={...fy.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};stats=ire;log=rn;VERSION="9.2.6";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw rn.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),rn.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");rn.error("This version of luma.gl has already been initialized")()}rn.log(1,`${this.VERSION} - ${t9e}`)(),globalThis.luma=this}async createDevice(e={}){const r={...cT.defaultProps,...e},n=this.selectAdapter(r.type,r.adapters);if(!n)throw new Error(pW);return r.waitForPageLoad&&await n.pageLoaded,await n.create(r)}async attachDevice(e,r){const n=this._getTypeFromHandle(e,r.adapters),i=n&&this.selectAdapter(n,r.adapters);if(!i)throw new Error(pW);return await i?.attach?.(e,r)}registerAdapters(e){for(const r of e)this.preregisteredAdapters.set(r.type,r)}getSupportedAdapters(e=[]){const r=this._getAdapterMap(e);return Array.from(r).map(([,n])=>n).filter(n=>n.isSupported?.()).map(n=>n.type)}getBestAvailableAdapterType(e=[]){const r=["webgpu","webgl","null"],n=this._getAdapterMap(e);for(const i of r)if(n.get(i)?.isSupported?.())return i;return null}selectAdapter(e,r=[]){let n=e;e==="best-available"&&(n=this.getBestAvailableAdapterType(r));const i=this._getAdapterMap(r);return n&&i.get(n)||null}enforceWebGL2(e=!0,r=[]){const i=this._getAdapterMap(r).get("webgl");i||rn.warn("enforceWebGL2: webgl adapter not found")(),i?.enforceWebGL2?.(e)}setDefaultDeviceProps(e){Object.assign(cT.defaultProps,e)}_getAdapterMap(e=[]){const r=new Map(this.preregisteredAdapters);for(const n of e)r.set(n.type,n);return r}_getTypeFromHandle(e,r=[]){return e instanceof WebGL2RenderingContext?"webgl":typeof GPUDevice<"u"&&e instanceof GPUDevice||e?.queue?"webgpu":e===null?"null":(e instanceof WebGLRenderingContext?rn.warn("WebGL1 is not supported",e)():rn.warn("Unknown handle type",e)(),null)}}const JM=new cT;class r9e{get pageLoaded(){return a9e()}}const n9e=My()&&typeof document<"u",i9e=()=>n9e&&document.readyState==="complete";let Ww=null;function a9e(){return Ww||(i9e()||typeof window>"u"?Ww=Promise.resolve():Ww=new Promise(t=>window.addEventListener("load",()=>t()))),Ww}function o9e(){let t,e;return{promise:new Promise((n,i)=>{t=n,e=i}),resolve:t,reject:e}}class Dm{static isHTMLCanvas(e){return typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement}static isOffscreenCanvas(e){return typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas}static defaultProps={id:void 0,canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb",trackPosition:!1};id;props;canvas;htmlCanvas;offscreenCanvas;type;initialized;isInitialized=!1;isVisible=!0;cssWidth;cssHeight;devicePixelRatio;devicePixelWidth;devicePixelHeight;drawingBufferWidth;drawingBufferHeight;_initializedResolvers=o9e();_resizeObserver;_intersectionObserver;_position;destroyed=!1;toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...Dm.defaultProps,...e},e=this.props,this.initialized=this._initializedResolvers.promise,My()?e.canvas?typeof e.canvas=="string"?this.canvas=l9e(e.canvas):this.canvas=e.canvas:this.canvas=u9e(e):this.canvas={width:e.width||1,height:e.height||1},Dm.isHTMLCanvas(this.canvas)?(this.id=e.id||this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):Dm.isOffscreenCanvas(this.canvas)?(this.id=e.id||"offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas):(this.id=e.id||"node-canvas-context",this.type="node"),this.cssWidth=this.htmlCanvas?.clientWidth||this.canvas.width,this.cssHeight=this.htmlCanvas?.clientHeight||this.canvas.height,this.devicePixelWidth=this.canvas.width,this.devicePixelHeight=this.canvas.height,this.drawingBufferWidth=this.canvas.width,this.drawingBufferHeight=this.canvas.height,this.devicePixelRatio=globalThis.devicePixelRatio||1,this._position=[0,0],Dm.isHTMLCanvas(this.canvas)){this._intersectionObserver=new IntersectionObserver(r=>this._handleIntersection(r)),this._intersectionObserver.observe(this.canvas),this._resizeObserver=new ResizeObserver(r=>this._handleResize(r));try{this._resizeObserver.observe(this.canvas,{box:"device-pixel-content-box"})}catch{this._resizeObserver.observe(this.canvas,{box:"content-box"})}setTimeout(()=>this._observeDevicePixelRatio(),0),this.props.trackPosition&&this._trackPosition()}}destroy(){this.destroyed=!0}setProps(e){return"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1,this._updateDrawingBufferSize()),this}getCSSSize(){return[this.cssWidth,this.cssHeight]}getPosition(){return this._position}getDevicePixelSize(){return[this.devicePixelWidth,this.devicePixelHeight]}getDrawingBufferSize(){return[this.drawingBufferWidth,this.drawingBufferHeight]}getMaxDrawingBufferSize(){const e=this.device.limits.maxTextureDimension2D;return[e,e]}setDrawingBufferSize(e,r){this.canvas.width=e,this.canvas.height=r,this.drawingBufferWidth=e,this.drawingBufferHeight=r}getDevicePixelRatio(){return typeof window<"u"&&window.devicePixelRatio||1}cssToDevicePixels(e,r=!0){const n=this.cssToDeviceRatio(),[i,a]=this.getDrawingBufferSize();return c9e(e,n,i,a,r)}getPixelSize(){return this.getDevicePixelSize()}getAspect(){const[e,r]=this.getDevicePixelSize();return e/r}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),[r]=this.getCSSSize();return r?e/r:1}catch{return 1}}resize(e){this.setDrawingBufferSize(e.width,e.height)}_setAutoCreatedCanvasId(e){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}_handleIntersection(e){const r=e.find(i=>i.target===this.canvas);if(!r)return;const n=r.isIntersecting;this.isVisible!==n&&(this.isVisible=n,this.device.props.onVisibilityChange(this))}_handleResize(e){const r=e.find(c=>c.target===this.canvas);if(!r)return;this.cssWidth=r.contentBoxSize[0].inlineSize,this.cssHeight=r.contentBoxSize[0].blockSize;const n=this.getDevicePixelSize(),i=r.devicePixelContentBoxSize?.[0].inlineSize||r.contentBoxSize[0].inlineSize*devicePixelRatio,a=r.devicePixelContentBoxSize?.[0].blockSize||r.contentBoxSize[0].blockSize*devicePixelRatio,[s,o]=this.getMaxDrawingBufferSize();this.devicePixelWidth=Math.max(1,Math.min(i,s)),this.devicePixelHeight=Math.max(1,Math.min(a,o)),this._updateDrawingBufferSize(),this.device.props.onResize(this,{oldPixelSize:n})}_updateDrawingBufferSize(){if(this.props.autoResize){if(typeof this.props.useDevicePixels=="number"){const e=this.props.useDevicePixels;this.setDrawingBufferSize(this.cssWidth*e,this.cssHeight*e)}else this.props.useDevicePixels?this.setDrawingBufferSize(this.devicePixelWidth,this.devicePixelHeight):this.setDrawingBufferSize(this.cssWidth,this.cssHeight);this._updateDevice()}this._initializedResolvers.resolve(),this.isInitialized=!0,this.updatePosition()}_observeDevicePixelRatio(){const e=this.devicePixelRatio;this.devicePixelRatio=window.devicePixelRatio,this.updatePosition(),this.device.props.onDevicePixelRatioChange(this,{oldRatio:e}),matchMedia(`(resolution: ${this.devicePixelRatio}dppx)`).addEventListener("change",()=>this._observeDevicePixelRatio(),{once:!0})}_trackPosition(e=100){const r=setInterval(()=>{this.destroyed?clearInterval(r):this.updatePosition()},e)}updatePosition(){const e=this.htmlCanvas?.getBoundingClientRect();if(e){const r=[e.left,e.top];if(this._position??=r,r[0]!==this._position[0]||r[1]!==this._position[1]){const i=this._position;this._position=r,this.device.props.onPositionChange?.(this,{oldPosition:i})}}}}function s9e(t){if(typeof t=="string"){const e=document.getElementById(t);if(!e)throw new Error(`${t} is not an HTML element`);return e}return t||document.body}function l9e(t){const e=document.getElementById(t);if(!Dm.isHTMLCanvas(e))throw new Error("Object is not a canvas element");return e}function u9e(t){const{width:e,height:r}=t,n=document.createElement("canvas");n.id=X3("lumagl-auto-created-canvas"),n.width=e||1,n.height=r||1,n.style.width=Number.isFinite(e)?`${e}px`:"100%",n.style.height=Number.isFinite(r)?`${r}px`:"100%",t?.visible||(n.style.visibility="hidden");const i=s9e(t?.container||null);return i.insertBefore(n,i.firstChild),n}function c9e(t,e,r,n,i){const a=t,s=gW(a[0],e,r);let o=mW(a[1],e,n,i),c=gW(a[0]+1,e,r);const h=c===r-1?c:c-1;c=mW(a[1]+1,e,n,i);let d;return i?(c=c===0?c:c+1,d=o,o=c):d=c===n-1?c:c-1,{x:s,y:o,width:Math.max(h-s+1,1),height:Math.max(d-o+1,1)}}function gW(t,e,r){return Math.min(Math.round(t*e),r-1)}function mW(t,e,r,n){return n?Math.max(0,r-1-Math.round(t*e)):Math.min(Math.round(t*e),r-1)}class dy extends So{static defaultProps={...So.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,r){r=dy.normalizeProps(e,r),super(e,r,dy.defaultProps)}static normalizeProps(e,r){return r}}const h9e={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"};class Fl extends So{static SAMPLE=4;static STORAGE=8;static RENDER=16;static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static RENDER_ATTACHMENT=16;dimension;baseDimension;format;width;height;depth;mipLevels;updateTimestamp;get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}constructor(e,r){if(r=Fl.normalizeProps(e,r),super(e,r,Fl.defaultProps),this.dimension=this.props.dimension,this.baseDimension=h9e[this.dimension],this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.mipLevels=this.props.mipLevels,this.props.width===void 0||this.props.height===void 0)if(e.isExternalImage(r.data)){const n=e.getExternalImageSize(r.data);this.width=n?.width||1,this.height=n?.height||1}else this.width=1,this.height=1,(this.props.width===void 0||this.props.height===void 0)&&rn.warn(`${this} created with undefined width or height. This is deprecated. Use AsyncTexture instead.`)();this.updateTimestamp=e.incrementTimestamp()}setSampler(e){this.sampler=e instanceof dy?e:this.device.createSampler(e)}clone(e){return this.device.createTexture({...this.props,...e})}static normalizeProps(e,r){const n={...r},{width:i,height:a}=n;return typeof i=="number"&&(n.width=Math.max(1,Math.ceil(i))),typeof a=="number"&&(n.height=Math.max(1,Math.ceil(a))),n}_initializeData(e){this.device.isExternalImage(e)?this.copyExternalImage({image:e,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}):e&&this.copyImageData({data:e,mipLevel:0,x:0,y:0,z:0,aspect:"all"})}_normalizeCopyImageDataOptions(e){const{width:r,height:n,depth:i}=this,a={...Fl.defaultCopyDataOptions,width:r,height:n,depth:i,...e},s=this.device.getTextureFormatInfo(this.format);if(!e.bytesPerRow&&!s.bytesPerPixel)throw new Error(`bytesPerRow must be provided for texture format ${this.format}`);return a.bytesPerRow=e.bytesPerRow||r*(s.bytesPerPixel||4),a.rowsPerImage=e.rowsPerImage||n,a}_normalizeCopyExternalImageOptions(e){const r=this.device.getExternalImageSize(e.image),n={...Fl.defaultCopyExternalImageOptions,...r,...e};return n.width=Math.min(n.width,this.width-n.x),n.height=Math.min(n.height,this.height-n.y),n}static defaultProps={...So.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",usage:Fl.TEXTURE|Fl.RENDER_ATTACHMENT|Fl.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0};static defaultCopyDataOptions={data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:"all"};static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}}class Y3 extends So{get[Symbol.toStringTag](){return"TextureView"}constructor(e,r){super(e,r,Y3.defaultProps)}static defaultProps={...So.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}}function f9e(t,e,r){let n="";const i=e.split(/\r?\n/),a=t.slice().sort((s,o)=>s.lineNum-o.lineNum);switch(r?.showSourceCode||"no"){case"all":let s=0;for(let o=1;o<=i.length;o++)for(n+=sre(i[o-1],o,r);a.length>s&&a[s].lineNum===o;){const c=a[s++];n+=$P(c,i,c.lineNum,{...r,inlineSource:!1})}for(;a.length>s;){const o=a[s++];n+=$P(o,[],0,{...r,inlineSource:!1})}return n;case"issues":case"no":for(const o of t)n+=$P(o,i,o.lineNum,{inlineSource:r?.showSourceCode!=="no"});return n}}function $P(t,e,r,n){if(n?.inlineSource){const a=d9e(e,r),s=t.linePos>0?`${" ".repeat(t.linePos+5)}^^^
`:"";return`
${a}${s}${t.type.toUpperCase()}: ${t.message}

`}const i=t.type==="error"?"red":"#8B4000";return n?.html?`<div class='luma-compiler-log-error' style="color:${i};"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function d9e(t,e,r){let n="";for(let i=e-2;i<=e;i++){const a=t[i-1];a!==void 0&&(n+=sre(a,e,r))}return n}function sre(t,e,r){const n=r?.html?g9e(t):t;return`${p9e(String(e),4)}: ${n}${r?.html?"<br/>":`
`}`}function p9e(t,e){let r="";for(let n=t.length;n<e;++n)r+=" ";return r+t}function g9e(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}class Z3 extends So{get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,r){r={...r,debugShaders:r.debugShaders||e.props.debugShaders||"errors"},super(e,{id:m9e(r),...r},Z3.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const r=await this.getCompilationInfo();e==="warnings"&&r?.length===0||this._displayShaderLog(r,this.id)}_displayShaderLog(e,r){if(typeof document>"u"||!document?.createElement)return;const n=r,i=`${this.stage} shader "${n}"`;let a=f9e(e,this.source,{showSourceCode:"all",html:!0});const s=this.getTranslatedSource();s&&(a+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${s}</pre></code>`);const o=document.createElement("Button");o.innerHTML=`
<h1>Compilation error in ${i}</h1><br /><br />
<code style="user-select:text;"><pre>
${a}
</pre></code>`,o.style.top="10px",o.style.left="10px",o.style.position="absolute",o.style.zIndex="9999",o.style.width="100%",o.style.textAlign="left",document.body.appendChild(o),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),o.onclick=()=>{const h=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(h)}}static defaultProps={...So.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0}}function m9e(t){return y9e(t.source)||t.id||X3(`unnamed ${t.stage}-shader`)}function y9e(t,e="unnamed"){const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return n?n[1]:e}class K3 extends So{get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,r={}){super(e,r,K3.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const r=this.colorAttachments.map(i=>i.texture.clone(e)),n=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:r,depthStencilAttachment:n})}resize(e){let r=!e;if(e){const[n,i]=Array.isArray(e)?e:[e.width,e.height];r=r||i!==this.height||n!==this.width,this.width=n,this.height=i}r&&(rn.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((r,n)=>{if(typeof r=="string"){const i=this.createColorTexture(r,n);return this.attachResource(i),i.view}return r instanceof Fl?r.view:r});const e=this.props.depthStencilAttachment;if(e)if(typeof e=="string"){const r=this.createDepthStencilTexture(e);this.attachResource(r),this.depthStencilAttachment=r.view}else e instanceof Fl?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,r){return this.device.createTexture({id:`${this.id}-color-attachment-${r}`,usage:Fl.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:Fl.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})}resizeAttachments(e,r){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){const i=this.colorAttachments[n].texture.clone({width:e,height:r});this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=i.view,this.attachResource(i.view)}if(this.depthStencilAttachment){const n=this.depthStencilAttachment.texture.clone({width:e,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}this.updateAttachments()}static defaultProps={...So.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null}}class qm extends So{get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,r){super(e,r,qm.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}static defaultProps={...So.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}}}class Am extends So{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;get[Symbol.toStringTag](){return"RenderPass"}constructor(e,r){r=Am.normalizeProps(e,r),super(e,r,Am.defaultProps)}static normalizeProps(e,r){return r}static defaultProps={...So.defaultProps,framebuffer:null,parameters:void 0,clearColor:Am.defaultClearColor,clearColors:void 0,clearDepth:Am.defaultClearDepth,clearStencil:Am.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}}class hT extends So{get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,r){super(e,r,hT.defaultProps),this.shaderLayout=r.shaderLayout}static defaultProps={...So.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}}class VL extends So{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,r){super(e,r,VL.defaultProps)}static defaultProps={...So.defaultProps,measureExecutionTime:void 0}}class $L extends So{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,r){super(e,r,$L.defaultProps)}static defaultProps={...So.defaultProps}}function lre(t){return x9e[t]}function v9e(t){const[e,r]=b9e[t],n=e==="i32"||e==="u32",i=e!=="u32",a=_9e[e]*r;return{primitiveType:e,components:r,byteLength:a,integer:n,signed:i}}const _9e={f32:4,f16:2,i32:4,u32:4},b9e={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},x9e={f32:{type:"f32",components:1},f16:{type:"f16",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<f16>":{type:"f16",components:2},"vec3<f16>":{type:"f16",components:3},"vec4<f16>":{type:"f16",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16},"mat2x2<f16>":{type:"f16",components:4},"mat2x3<f16>":{type:"f16",components:6},"mat2x4<f16>":{type:"f16",components:8},"mat3x2<f16>":{type:"f16",components:6},"mat3x3<f16>":{type:"f16",components:9},"mat3x4<f16>":{type:"f16",components:12},"mat4x2<f16>":{type:"f16",components:8},"mat4x3<f16>":{type:"f16",components:12},"mat4x4<f16>":{type:"f16",components:16},"mat2x2<i32>":{type:"i32",components:4},"mat2x3<i32>":{type:"i32",components:6},"mat2x4<i32>":{type:"i32",components:8},"mat3x2<i32>":{type:"i32",components:6},"mat3x3<i32>":{type:"i32",components:9},"mat3x4<i32>":{type:"i32",components:12},"mat4x2<i32>":{type:"i32",components:8},"mat4x3<i32>":{type:"i32",components:12},"mat4x4<i32>":{type:"i32",components:16},"mat2x2<u32>":{type:"u32",components:4},"mat2x3<u32>":{type:"u32",components:6},"mat2x4<u32>":{type:"u32",components:8},"mat3x2<u32>":{type:"u32",components:6},"mat3x3<u32>":{type:"u32",components:9},"mat3x4<u32>":{type:"u32",components:12},"mat4x2<u32>":{type:"u32",components:8},"mat4x3<u32>":{type:"u32",components:12},"mat4x4<u32>":{type:"u32",components:16}};function ure(t,e){const r={};for(const n of t.attributes){const i=S9e(t,e,n.name);i&&(r[n.name]=i)}return r}function w9e(t,e,r=16){const n=ure(t,e),i=new Array(r).fill(null);for(const a of Object.values(n))i[a.location]=a;return i}function S9e(t,e,r){const n=E9e(t,r),i=T9e(e,r);if(!n)return null;const a=v9e(n.type),s=jze(a),o=i?.vertexFormat||s,c=UL(o);return{attributeName:i?.attributeName||n.name,bufferName:i?.bufferName||n.name,location:n.location,shaderType:n.type,primitiveType:a.primitiveType,shaderComponents:a.components,vertexFormat:o,bufferDataType:c.type,bufferComponents:c.components,normalized:c.normalized,integer:a.integer,stepMode:i?.stepMode||n.stepMode||"vertex",byteOffset:i?.byteOffset||0,byteStride:i?.byteStride||0}}function E9e(t,e){const r=t.attributes.find(n=>n.name===e);return r||rn.warn(`shader layout attribute "${e}" not present in shader`),r||null}function T9e(t,e){C9e(t);let r=A9e(t,e);return r||(r=I9e(t,e),r)?r:(rn.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function C9e(t){for(const e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&rn.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function A9e(t,e){for(const r of t)if(r.format&&r.name===e)return{attributeName:r.name,bufferName:e,stepMode:r.stepMode,vertexFormat:r.format,byteOffset:0,byteStride:r.byteStride||0};return null}function I9e(t,e){for(const r of t){let n=r.byteStride;if(typeof r.byteStride!="number")for(const a of r.attributes||[]){const s=UL(a.format);n+=s.byteLength}const i=r.attributes?.find(a=>a.attribute===e);if(i)return{attributeName:i.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:n}}return null}class qL extends So{static defaultProps={...So.defaultProps,shaderLayout:void 0,bufferLayout:[]};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,r){super(e,r,qL.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=w9e(r.shaderLayout,r.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(e,r){this.device.reportError(new Error("constant attributes not supported"),this)()}}class HL extends So{static defaultProps={...So.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,r){super(e,r,HL.defaultProps)}}class WL extends So{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,r){super(e,r,WL.defaultProps)}static defaultProps={...So.defaultProps,type:void 0,count:void 0}}let Gw;function cre(t){return(!Gw||Gw.byteLength<t)&&(Gw=new ArrayBuffer(t)),Gw}function P9e(t,e){const r=cre(t.BYTES_PER_ELEMENT*e);return new t(r,0,e)}function k9e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function fT(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":k9e(t)}const R9e=1024;class M9e{layout={};byteLength;constructor(e,r={}){let n=0;for(const[a,s]of Object.entries(e)){const o=lre(s),{type:c,components:h}=o,d=h*(r?.[a]??1);n=Fze(n,d);const m=n;n+=d,this.layout[a]={type:c,size:d,offset:m}}n+=(4-n%4)%4;const i=n*4;this.byteLength=Math.max(i,R9e)}getData(e){const r=cre(this.byteLength),n={i32:new Int32Array(r),u32:new Uint32Array(r),f32:new Float32Array(r),f16:new Uint16Array(r)};for(const[i,a]of Object.entries(e)){const s=this.layout[i];if(!s){rn.warn(`Supplied uniform value ${i} not present in uniform block layout`)();continue}const{type:o,size:c,offset:h}=s,d=n[o];if(c===1){if(typeof a!="number"&&typeof a!="boolean"){rn.warn(`Supplied value for single component uniform ${i} is not a number: ${a}`)();continue}d[h]=Number(a)}else{if(!fT(a)){rn.warn(`Supplied value for multi component / array uniform ${i} is not a numeric array: ${a}`)();continue}d.set(a,h)}}return new Uint8Array(r,0,this.byteLength)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function D9e(t,e,r=16){if(t!==e)return!1;const n=t,i=e;if(!fT(n))return!1;if(fT(i)&&n.length===i.length){for(let a=0;a<n.length;++a)if(i[a]!==n[a])return!1}return!0}function O9e(t){return fT(t)?t.slice():t}class N9e{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const r=e?.shaderLayout.bindings?.find(i=>i.type==="uniform"&&i.name===e?.name);if(!r)throw new Error(e?.name);const n=r;for(const i of n.uniforms||[])this.bindingLayout[i.name]=i}}setUniforms(e){for(const[r,n]of Object.entries(e))this._setUniform(r,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${r}=${n}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,r){D9e(this.uniforms[e],r)||(this.uniforms[e]=O9e(r),this.modifiedUniforms[e]=!0,this.modified=!0)}}class L9e{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(const[r,n]of Object.entries(e)){const i=r,a=new M9e(n.uniformTypes??{},n.uniformSizes??{});this.uniformBufferLayouts.set(i,a);const s=new N9e({name:r});s.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(i,s)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[r,n]of Object.entries(e))this.uniformBlocks.get(r)?.setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const r=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(r)}createUniformBuffer(e,r,n){n&&this.setUniforms(n);const i=this.getUniformBufferByteLength(r),a=e.createBuffer({usage:jo.UNIFORM|jo.COPY_DST,byteLength:i}),s=this.getUniformBufferData(r);return a.write(s),a}getManagedUniformBuffer(e,r){if(!this.uniformBuffers.get(r)){const n=this.getUniformBufferByteLength(r),i=e.createBuffer({usage:jo.UNIFORM|jo.COPY_DST,byteLength:n});this.uniformBuffers.set(r,i)}return this.uniformBuffers.get(r)}updateUniformBuffers(){let e=!1;for(const r of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(r);e||=n}return e&&rn.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const r=this.uniformBlocks.get(e);let n=this.uniformBuffers.get(e),i=!1;if(n&&r?.needsRedraw){i||=r.needsRedraw;const a=this.getUniformBufferData(e);n=this.uniformBuffers.get(e),n?.write(a);const s=this.uniformBlocks.get(e)?.getAllUniforms();rn.log(4,`Writing to uniform buffer ${String(e)}`,a,s)()}return i}}class zh{constructor(e,r){this.name=e,this.attributes=r,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class yW{constructor(e,r,n){this.name=e,this.type=r,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class mg extends zh{constructor(e,r){super(e,r),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class wg extends zh{constructor(e,r){super(e,r),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}}class QM extends zh{constructor(e,r,n){super(e,n),this.format=r}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}}class py extends zh{constructor(e,r,n,i){super(e,n),this.format=r,this.access=i}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}var lg;(t=>{t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"})(lg||(lg={}));class Xw{constructor(e,r,n,i,a,s,o){this.name=e,this.type=r,this.group=n,this.binding=i,this.attributes=a,this.resourceType=s,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class F9e{constructor(e,r){this.name=e,this.type=r}}class B9e{constructor(e,r,n,i){this.name=e,this.type=r,this.locationType=n,this.location=i,this.interpolation=null}}class vW{constructor(e,r,n,i){this.name=e,this.type=r,this.locationType=n,this.location=i}}class z9e{constructor(e,r,n,i){this.name=e,this.type=r,this.attributes=n,this.id=i}}class j9e{constructor(e,r,n){this.name=e,this.type=r,this.attributes=n}}class U9e{constructor(e,r=null,n){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=r,this.attributes=n}}class V9e{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function $9e(t){var e=(32768&t)>>15,r=(31744&t)>>10,n=1023&t;return r==0?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r==31?n?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}const hre=new Float32Array(1),q9e=new Int32Array(hre.buffer),Yu=new Uint16Array(1);function H9e(t){hre[0]=t;const e=q9e[0],r=e>>31&1;let n=e>>23&255,i=8388607&e;if(n===255)return Yu[0]=r<<15|31744|(i!==0?512:0),Yu[0];if(n===0){if(i===0)return Yu[0]=r<<15,Yu[0];i|=8388608;let a=113;for(;!(8388608&i);)i<<=1,a--;return n=127-a,i&=8388607,n>0?(i=(i>>126-n)+(i>>127-n&1),Yu[0]=r<<15|n<<10|i>>13,Yu[0]):(Yu[0]=r<<15,Yu[0])}return n=n-127+15,n>=31?(Yu[0]=r<<15|31744,Yu[0]):n<=0?n<-10?(Yu[0]=r<<15,Yu[0]):(i=(8388608|i)>>1-n,Yu[0]=r<<15|i>>13,Yu[0]):(i>>=13,Yu[0]=r<<15|n<<10|i,Yu[0])}const GL=new Uint32Array(1),fre=new Float32Array(GL.buffer,0,1);function _W(t){const e=112+(t>>6&31)<<23|(63&t)<<17;return GL[0]=e,fre[0]}function W9e(t,e,r,n,i,a,s,o,c){const h=n*(s>>=i)*(a>>=i)+r*s+e*o;switch(c){case"r8unorm":return[qa(t,h,"8unorm",1)[0]];case"r8snorm":return[qa(t,h,"8snorm",1)[0]];case"r8uint":return[qa(t,h,"8uint",1)[0]];case"r8sint":return[qa(t,h,"8sint",1)[0]];case"rg8unorm":{const d=qa(t,h,"8unorm",2);return[d[0],d[1]]}case"rg8snorm":{const d=qa(t,h,"8snorm",2);return[d[0],d[1]]}case"rg8uint":{const d=qa(t,h,"8uint",2);return[d[0],d[1]]}case"rg8sint":{const d=qa(t,h,"8sint",2);return[d[0],d[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const d=qa(t,h,"8unorm",4);return[d[0],d[1],d[2],d[3]]}case"rgba8snorm":{const d=qa(t,h,"8snorm",4);return[d[0],d[1],d[2],d[3]]}case"rgba8uint":{const d=qa(t,h,"8uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba8sint":{const d=qa(t,h,"8sint",4);return[d[0],d[1],d[2],d[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const d=qa(t,h,"8unorm",4);return[d[2],d[1],d[0],d[3]]}case"r16uint":return[qa(t,h,"16uint",1)[0]];case"r16sint":return[qa(t,h,"16sint",1)[0]];case"r16float":return[qa(t,h,"16float",1)[0]];case"rg16uint":{const d=qa(t,h,"16uint",2);return[d[0],d[1]]}case"rg16sint":{const d=qa(t,h,"16sint",2);return[d[0],d[1]]}case"rg16float":{const d=qa(t,h,"16float",2);return[d[0],d[1]]}case"rgba16uint":{const d=qa(t,h,"16uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba16sint":{const d=qa(t,h,"16sint",4);return[d[0],d[1],d[2],d[3]]}case"rgba16float":{const d=qa(t,h,"16float",4);return[d[0],d[1],d[2],d[3]]}case"r32uint":return[qa(t,h,"32uint",1)[0]];case"r32sint":return[qa(t,h,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[qa(t,h,"32float",1)[0]];case"rg32uint":{const d=qa(t,h,"32uint",2);return[d[0],d[1]]}case"rg32sint":{const d=qa(t,h,"32sint",2);return[d[0],d[1]]}case"rg32float":{const d=qa(t,h,"32float",2);return[d[0],d[1]]}case"rgba32uint":{const d=qa(t,h,"32uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba32sint":{const d=qa(t,h,"32sint",4);return[d[0],d[1],d[2],d[3]]}case"rgba32float":{const d=qa(t,h,"32float",4);return[d[0],d[1],d[2],d[3]]}case"rg11b10ufloat":{const d=new Uint32Array(t.buffer,h,1)[0],m=(4192256&d)>>11,b=(4290772992&d)>>22;return[_W(2047&d),_W(m),(function(x){const E=112+(x>>5&31)<<23|(31&x)<<18;return GL[0]=E,fre[0]})(b),1]}}return null}function qa(t,e,r,n){const i=[0,0,0,0];for(let a=0;a<n;++a)switch(r){case"8unorm":i[a]=t[e]/255,e++;break;case"8snorm":i[a]=t[e]/255*2-1,e++;break;case"8uint":i[a]=t[e],e++;break;case"8sint":i[a]=t[e]-127,e++;break;case"16uint":i[a]=t[e]|t[e+1]<<8,e+=2;break;case"16sint":i[a]=(t[e]|t[e+1]<<8)-32768,e+=2;break;case"16float":i[a]=$9e(t[e]|t[e+1]<<8),e+=2;break;case"32uint":case"32sint":i[a]=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24,e+=4;break;case"32float":i[a]=new Float32Array(t.buffer,e,1)[0],e+=4}return i}function ao(t,e,r,n,i){for(let a=0;a<n;++a)switch(r){case"8unorm":t[e]=255*i[a],e++;break;case"8snorm":t[e]=.5*(i[a]+1)*255,e++;break;case"8uint":t[e]=i[a],e++;break;case"8sint":t[e]=i[a]+127,e++;break;case"16uint":new Uint16Array(t.buffer,e,1)[0]=i[a],e+=2;break;case"16sint":new Int16Array(t.buffer,e,1)[0]=i[a],e+=2;break;case"16float":{const s=H9e(i[a]);new Uint16Array(t.buffer,e,1)[0]=s,e+=2;break}case"32uint":new Uint32Array(t.buffer,e,1)[0]=i[a],e+=4;break;case"32sint":new Int32Array(t.buffer,e,1)[0]=i[a],e+=4;break;case"32float":new Float32Array(t.buffer,e,1)[0]=i[a],e+=4}return i}const qP={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class Jh{constructor(){this.id=Jh._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,r){if(e){r(dT.instance);for(const n of e)n instanceof Array?this.searchBlock(n,r):n.search(r);r(pT.instance)}}constEvaluate(e,r){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}Jh._id=0;class dT extends Jh{}dT.instance=new dT;class pT extends Jh{}pT.instance=new pT;const dre=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class hs extends Jh{constructor(){super()}}class fx extends hs{constructor(e,r,n,i,a,s){super(),this.calls=new Set,this.name=e,this.args=r,this.returnType=n,this.body=i,this.startLine=a,this.endLine=s}get astNodeType(){return"function"}search(e){if(this.attributes)for(const r of this.attributes)e(r);e(this);for(const r of this.args)e(r);this.searchBlock(this.body,e)}}class G9e extends hs{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class pre extends hs{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class eD extends hs{constructor(e,r){super(),this.body=e,this.loopId=r}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class gre extends hs{constructor(e,r,n,i){super(),this.init=e,this.condition=r,this.increment=n,this.body=i}get astNodeType(){return"for"}search(e){var r,n,i;(r=this.init)===null||r===void 0||r.search(e),(n=this.condition)===null||n===void 0||n.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}}class cp extends hs{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"var"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}class XL extends hs{constructor(e,r,n){super(),this.attributes=null,this.name=e,this.type=r,this.value=n}get astNodeType(){return"override"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}}class Eb extends hs{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"let"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}class kS extends hs{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"const"}constEvaluate(e,r){return this.value.constEvaluate(e,r)}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}var d0,J1,wr,ar;(t=>{t.increment="++",t.decrement="--"})(d0||(d0={})),(t=>{t.parse=function(e){const r=e;if(r=="parse")throw new Error("Invalid value for IncrementOperator");return t[r]}})(d0||(d0={}));class mre extends hs{constructor(e,r){super(),this.operator=e,this.variable=r}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(t=>{t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="})(J1||(J1={})),(t=>{t.parse=function(e){const r=e;if(r=="parse")throw new Error("Invalid value for AssignOperator");return r}})(J1||(J1={}));class yre extends hs{constructor(e,r,n){super(),this.operator=e,this.variable=r,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class YL extends hs{constructor(e,r){super(),this.name=e,this.args=r}get astNodeType(){return"call"}isBuiltin(){return dre.has(this.name)}search(e){for(const r of this.args)r.search(e);e(this)}}class vre extends hs{constructor(e,r){super(),this.body=e,this.continuing=r}get astNodeType(){return"loop"}search(e){var r;this.searchBlock(this.body,e),(r=this.continuing)===null||r===void 0||r.search(e)}}class _re extends hs{constructor(e,r){super(),this.condition=e,this.cases=r}get astNodeType(){return"switch"}search(e){e(this);for(const r of this.cases)r.search(e)}}class bre extends hs{constructor(e,r,n,i){super(),this.condition=e,this.body=r,this.elseif=n,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class xre extends hs{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}}class X9e extends hs{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class Y9e extends hs{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class wre extends hs{constructor(e,r){super(),this.severity=e,this.rule=r}get astNodeType(){return"diagnostic"}}class ZL extends hs{constructor(e,r){super(),this.name=e,this.type=r}get astNodeType(){return"alias"}}class Z9e extends hs{constructor(){super()}get astNodeType(){return"discard"}}class Sre extends hs{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class Ere extends hs{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class Kr extends hs{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let r=e[0];if(r.name==="f32")return r;for(let n=1;n<e.length;++n){const i=Kr._priority.get(r.name);Kr._priority.get(e[n].name)<i&&(r=e[n])}return r.name==="x32"?Kr.i32:r}getTypeName(){return this.name}}Kr.x32=new Kr("x32"),Kr.f32=new Kr("f32"),Kr.i32=new Kr("i32"),Kr.u32=new Kr("u32"),Kr.f16=new Kr("f16"),Kr.bool=new Kr("bool"),Kr.void=new Kr("void"),Kr._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class bW extends Kr{constructor(e){super(e)}}class op extends Kr{constructor(e,r,n,i){super(e),this.members=r,this.startLine=n,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let r=0;r<this.members.length;r++)if(this.members[r].name==e)return r;return-1}search(e){for(const r of this.members)e(r)}}class cr extends Kr{constructor(e,r,n){super(e),this.format=r,this.access=n}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}cr.vec2f=new cr("vec2",Kr.f32,null),cr.vec3f=new cr("vec3",Kr.f32,null),cr.vec4f=new cr("vec4",Kr.f32,null),cr.vec2i=new cr("vec2",Kr.i32,null),cr.vec3i=new cr("vec3",Kr.i32,null),cr.vec4i=new cr("vec4",Kr.i32,null),cr.vec2u=new cr("vec2",Kr.u32,null),cr.vec3u=new cr("vec3",Kr.u32,null),cr.vec4u=new cr("vec4",Kr.u32,null),cr.vec2h=new cr("vec2",Kr.f16,null),cr.vec3h=new cr("vec3",Kr.f16,null),cr.vec4h=new cr("vec4",Kr.f16,null),cr.vec2b=new cr("vec2",Kr.bool,null),cr.vec3b=new cr("vec3",Kr.bool,null),cr.vec4b=new cr("vec4",Kr.bool,null),cr.mat2x2f=new cr("mat2x2",Kr.f32,null),cr.mat2x3f=new cr("mat2x3",Kr.f32,null),cr.mat2x4f=new cr("mat2x4",Kr.f32,null),cr.mat3x2f=new cr("mat3x2",Kr.f32,null),cr.mat3x3f=new cr("mat3x3",Kr.f32,null),cr.mat3x4f=new cr("mat3x4",Kr.f32,null),cr.mat4x2f=new cr("mat4x2",Kr.f32,null),cr.mat4x3f=new cr("mat4x3",Kr.f32,null),cr.mat4x4f=new cr("mat4x4",Kr.f32,null),cr.mat2x2h=new cr("mat2x2",Kr.f16,null),cr.mat2x3h=new cr("mat2x3",Kr.f16,null),cr.mat2x4h=new cr("mat2x4",Kr.f16,null),cr.mat3x2h=new cr("mat3x2",Kr.f16,null),cr.mat3x3h=new cr("mat3x3",Kr.f16,null),cr.mat3x4h=new cr("mat3x4",Kr.f16,null),cr.mat4x2h=new cr("mat4x2",Kr.f16,null),cr.mat4x3h=new cr("mat4x3",Kr.f16,null),cr.mat4x4h=new cr("mat4x4",Kr.f16,null),cr.mat2x2i=new cr("mat2x2",Kr.i32,null),cr.mat2x3i=new cr("mat2x3",Kr.i32,null),cr.mat2x4i=new cr("mat2x4",Kr.i32,null),cr.mat3x2i=new cr("mat3x2",Kr.i32,null),cr.mat3x3i=new cr("mat3x3",Kr.i32,null),cr.mat3x4i=new cr("mat3x4",Kr.i32,null),cr.mat4x2i=new cr("mat4x2",Kr.i32,null),cr.mat4x3i=new cr("mat4x3",Kr.i32,null),cr.mat4x4i=new cr("mat4x4",Kr.i32,null),cr.mat2x2u=new cr("mat2x2",Kr.u32,null),cr.mat2x3u=new cr("mat2x3",Kr.u32,null),cr.mat2x4u=new cr("mat2x4",Kr.u32,null),cr.mat3x2u=new cr("mat3x2",Kr.u32,null),cr.mat3x3u=new cr("mat3x3",Kr.u32,null),cr.mat3x4u=new cr("mat3x4",Kr.u32,null),cr.mat4x2u=new cr("mat4x2",Kr.u32,null),cr.mat4x3u=new cr("mat4x3",Kr.u32,null),cr.mat4x4u=new cr("mat4x4",Kr.u32,null);class RS extends Kr{constructor(e,r,n,i){super(e),this.storage=r,this.type=n,this.access=i}get astNodeType(){return"pointer"}}class Tb extends Kr{constructor(e,r,n,i){super(e),this.attributes=r,this.format=n,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class Q1 extends Kr{constructor(e,r,n){super(e),this.format=r,this.access=n}get astNodeType(){return"sampler"}}class Ff extends Jh{constructor(){super(),this.postfix=null}}class gy extends Ff{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class od extends Ff{constructor(e,r){super(),this.type=e,this.args=r}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const r of this.args)r.search(e)}constEvaluate(e,r){return r&&(r[0]=this.type),e.evalExpression(this,e.context)}}class KL extends Ff{constructor(e,r){super(),this.cachedReturnValue=null,this.name=e,this.args=r}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return dre.has(this.name)}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){for(const r of this.args)r.search(e);e(this)}}class rh extends Ff{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,r){return e.evalExpression(this,e.context)}}class Tre extends Ff{constructor(e,r){super(),this.name=e,this.initializer=r}get astNodeType(){return"constExpr"}constEvaluate(e,r){if(this.initializer){const n=e.evalExpression(this.initializer,e.context);return n!==null&&this.postfix?n.getSubData(e,this.postfix,e.context):n}return null}search(e){this.initializer.search(e)}}class Ol extends Ff{constructor(e,r){super(),this.value=e,this.type=r}get astNodeType(){return"literalExpr"}constEvaluate(e,r){return r!==void 0&&(r[0]=this.type),this.value}get isScalar(){return this.value instanceof ir}get isVector(){return this.value instanceof kt||this.value instanceof Ii}get scalarValue(){return this.value instanceof ir?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof kt||this.value instanceof Ii?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class Cre extends Ff{constructor(e,r){super(),this.type=e,this.value=r}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class r_ extends Ff{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Are extends Ff{constructor(){super()}}class wl extends Are{constructor(e,r){super(),this.operator=e,this.right=r}get astNodeType(){return"unaryOp"}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class mf extends Are{constructor(e,r,n){super(),this.operator=e,this.left=r,this.right=n}get astNodeType(){return"binaryOp"}_getPromotedType(e,r){return e.name===r.name?e:e.name==="f32"||r.name==="f32"?Kr.f32:e.name==="u32"||r.name==="u32"?Kr.u32:Kr.i32}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class Ire extends Jh{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class MS extends Ff{constructor(){super()}get astNodeType(){return"default"}}class Pre extends Ire{constructor(e,r){super(r),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class kre extends Ire{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class xW extends Jh{constructor(e,r,n){super(),this.name=e,this.type=r,this.attributes=n}get astNodeType(){return"argument"}}class K9e extends Jh{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class wW extends Jh{constructor(e,r,n){super(),this.name=e,this.type=r,this.attributes=n}get astNodeType(){return"member"}}class Rre extends Jh{constructor(e,r){super(),this.name=e,this.value=r}get astNodeType(){return"attribute"}}class Yh{constructor(e,r){this.parent=null,this.typeInfo=e,this.parent=r,this.id=Yh._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,r,n,i){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,r,n){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}}Yh._id=0;class tD extends Yh{constructor(){super(new zh("void",null),null)}toString(){return"void"}}tD.void=new tD;class Pv extends Yh{constructor(e){super(new QM("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,r,n,i){this.reference.setDataValue(e,r,n,i)}getSubData(e,r,n){return r?this.reference.getSubData(e,r,n):this}toString(){return`&${this.reference.toString()}`}}class ir extends Yh{constructor(e,r,n=null){super(r,n),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",r)}clone(){if(this.data instanceof Float32Array)return new ir(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new ir(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new ir(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,r,n,i){if(n)return void console.error("SetDataValue: Scalar data does not support postfix",n);if(!(r instanceof ir))return void console.error("SetDataValue: Invalid value",r);let a=r.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?a=Math.floor(a):this.typeInfo.name==="bool"&&(a=a?1:0),this.data[0]=a}getSubData(e,r,n){return r?(console.error("getSubData: Scalar data does not support postfix",r),null):this}toString(){return`${this.value}`}}function J9e(t,e,r){const n=e.length;return n===2?r==="f32"?new kt(new Float32Array(e),t.getTypeInfo("vec2f")):r==="i32"||r==="bool"?new kt(new Int32Array(e),t.getTypeInfo("vec2i")):r==="u32"?new kt(new Uint32Array(e),t.getTypeInfo("vec2u")):r==="f16"?new kt(new Float32Array(e),t.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${r}`),null):n===3?r==="f32"?new kt(new Float32Array(e),t.getTypeInfo("vec3f")):r==="i32"||r==="bool"?new kt(new Int32Array(e),t.getTypeInfo("vec3i")):r==="u32"?new kt(new Uint32Array(e),t.getTypeInfo("vec3u")):r==="f16"?new kt(new Float32Array(e),t.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${r}`),null):n===4?r==="f32"?new kt(new Float32Array(e),t.getTypeInfo("vec4f")):r==="i32"||r==="bool"?new kt(new Int32Array(e),t.getTypeInfo("vec4i")):r==="u32"?new kt(new Uint32Array(e),t.getTypeInfo("vec4u")):r==="f16"?new kt(new Float32Array(e),t.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${r}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}class kt extends Yh{constructor(e,r,n=null){if(super(r,n),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const i=this.typeInfo.name;i==="vec2f"||i==="vec3f"||i==="vec4f"?this.data=new Float32Array(e):i==="vec2i"||i==="vec3i"||i==="vec4i"?this.data=new Int32Array(e):i==="vec2u"||i==="vec3u"||i==="vec4u"?this.data=new Uint32Array(e):i==="vec2h"||i==="vec3h"||i==="vec4h"?this.data=new Float32Array(e):i==="vec2b"||i==="vec3b"||i==="vec4b"?this.data=new Int32Array(e):i==="vec2"||i==="vec3"||i==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${i}`)}}clone(){if(this.data instanceof Float32Array)return new kt(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new kt(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new kt(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,r,n,i){n instanceof gy?console.error("TODO: Set vector postfix"):r instanceof kt?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,n){if(r===null)return this;let i=e.getTypeInfo("f32");if(this.typeInfo instanceof py)i=this.typeInfo.format||i;else{const s=this.typeInfo.name;s==="vec2f"||s==="vec3f"||s==="vec4f"?i=e.getTypeInfo("f32"):s==="vec2i"||s==="vec3i"||s==="vec4i"?i=e.getTypeInfo("i32"):s==="vec2b"||s==="vec3b"||s==="vec4b"?i=e.getTypeInfo("bool"):s==="vec2u"||s==="vec3u"||s==="vec4u"?i=e.getTypeInfo("u32"):s==="vec2h"||s==="vec3h"||s==="vec4h"?i=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${s}`)}let a=this;for(;r!==null&&a!==null;){if(r instanceof r_){const s=r.index;let o=-1;if(s instanceof Ol){if(!(s.value instanceof ir))return console.error(`GetSubData: Invalid array index ${s.value}`),null;o=s.value.value}else{const c=e.evalExpression(s,n);if(!(c instanceof ir))return console.error("GetSubData: Unknown index type",s),null;o=c.value}if(o<0||o>=a.data.length)return console.error("GetSubData: Index out of range",o),null;if(a.data instanceof Float32Array){const c=new Float32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new ir(c,i)}if(a.data instanceof Int32Array){const c=new Int32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new ir(c,i)}if(a.data instanceof Uint32Array){const c=new Uint32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new ir(c,i)}throw"GetSubData: Invalid data type"}if(!(r instanceof gy))return console.error("GetSubData: Unknown postfix",r),null;{const s=r.value.toLowerCase();if(s.length===1){let c=0;if(s==="x"||s==="r")c=0;else if(s==="y"||s==="g")c=1;else if(s==="z"||s==="b")c=2;else{if(s!=="w"&&s!=="a")return console.error(`GetSubData: Unknown member ${s}`),null;c=3}if(this.data instanceof Float32Array){let h=new Float32Array(this.data.buffer,this.data.byteOffset+4*c,1);return new ir(h,i,this)}if(this.data instanceof Int32Array){let h=new Int32Array(this.data.buffer,this.data.byteOffset+4*c,1);return new ir(h,i,this)}if(this.data instanceof Uint32Array){let h=new Uint32Array(this.data.buffer,this.data.byteOffset+4*c,1);return new ir(h,i,this)}}const o=[];for(const c of s)c==="x"||c==="r"?o.push(this.data[0]):c==="y"||c==="g"?o.push(this.data[1]):c==="z"||c==="b"?o.push(this.data[2]):c==="w"||c==="a"?o.push(this.data[3]):console.error(`GetDataValue: Unknown member ${c}`);a=J9e(e,o,i.name)}r=r.postfix}return a}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}}class Ii extends Yh{constructor(e,r,n=null){super(r,n),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new Ii(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,r,n,i){n instanceof gy?console.error("TODO: Set matrix postfix"):r instanceof Ii?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,n){if(r===null)return this;const i=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof py)this.typeInfo.format;else if(i.endsWith("f"))e.getTypeInfo("f32");else if(i.endsWith("i"))e.getTypeInfo("i32");else if(i.endsWith("u"))e.getTypeInfo("u32");else{if(!i.endsWith("h"))return console.error(`GetDataValue: Unknown type ${i}`),null;e.getTypeInfo("f16")}if(r instanceof r_){const a=r.index;let s=-1;if(a instanceof Ol){if(!(a.value instanceof ir))return console.error(`GetDataValue: Invalid array index ${a.value}`),null;s=a.value.value}else{const h=e.evalExpression(a,n);if(!(h instanceof ir))return console.error("GetDataValue: Unknown index type",a),null;s=h.value}if(s<0||s>=this.data.length)return console.error("GetDataValue: Index out of range",s),null;const o=i.endsWith("h")?"h":"f";let c;if(i==="mat2x2"||i==="mat2x2f"||i==="mat2x2h"||i==="mat3x2"||i==="mat3x2f"||i==="mat3x2h"||i==="mat4x2"||i==="mat4x2f"||i==="mat4x2h")c=new kt(new Float32Array(this.data.buffer,this.data.byteOffset+2*s*4,2),e.getTypeInfo(`vec2${o}`));else if(i==="mat2x3"||i==="mat2x3f"||i==="mat2x3h"||i==="mat3x3"||i==="mat3x3f"||i==="mat3x3h"||i==="mat4x3"||i==="mat4x3f"||i==="mat4x3h")c=new kt(new Float32Array(this.data.buffer,this.data.byteOffset+3*s*4,3),e.getTypeInfo(`vec3${o}`));else{if(i!=="mat2x4"&&i!=="mat2x4f"&&i!=="mat2x4h"&&i!=="mat3x4"&&i!=="mat3x4f"&&i!=="mat3x4h"&&i!=="mat4x4"&&i!=="mat4x4f"&&i!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${i}`),null;c=new kt(new Float32Array(this.data.buffer,this.data.byteOffset+4*s*4,4),e.getTypeInfo(`vec4${o}`))}return r.postfix?c.getSubData(e,r.postfix,n):c}return console.error("GetDataValue: Invalid postfix",r),null}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}}class js extends Yh{constructor(e,r,n=0,i=null){super(r,i),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=n}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new js(e.buffer,this.typeInfo,0,null)}setDataValue(e,r,n,i){if(r===null)return void console.log("setDataValue: NULL data.");let a=this.offset,s=this.typeInfo;for(;n;){if(n instanceof r_)if(s instanceof wg){const o=n.index;if(o instanceof Ol){if(!(o.value instanceof ir))return void console.error(`SetDataValue: Invalid index type ${o.value}`);a+=o.value.value*s.stride}else{const c=e.evalExpression(o,i);if(!(c instanceof ir))return void console.error("SetDataValue: Unknown index type",o);a+=c.value*s.stride}s=s.format}else console.error(`SetDataValue: Type ${s.getTypeName()} is not an array`);else{if(!(n instanceof gy))return void console.error("SetDataValue: Unknown postfix type",n);{const o=n.value;if(s instanceof mg){let c=!1;for(const h of s.members)if(h.name===o){a+=h.offset,s=h.type,c=!0;break}if(!c)return void console.error(`SetDataValue: Member ${o} not found`)}else if(s instanceof zh){const c=s.getTypeName();let h=0;if(o==="x"||o==="r")h=0;else if(o==="y"||o==="g")h=1;else if(o==="z"||o==="b")h=2;else{if(o!=="w"&&o!=="a")return void console.error(`SetDataValue: Unknown member ${o}`);h=3}if(!(r instanceof ir))return void console.error("SetDataValue: Invalid value",r);const d=r.value;return c==="vec2f"?void(new Float32Array(this.buffer,a,2)[h]=d):c==="vec3f"?void(new Float32Array(this.buffer,a,3)[h]=d):c==="vec4f"?void(new Float32Array(this.buffer,a,4)[h]=d):c==="vec2i"?void(new Int32Array(this.buffer,a,2)[h]=d):c==="vec3i"?void(new Int32Array(this.buffer,a,3)[h]=d):c==="vec4i"?void(new Int32Array(this.buffer,a,4)[h]=d):c==="vec2u"?void(new Uint32Array(this.buffer,a,2)[h]=d):c==="vec3u"?void(new Uint32Array(this.buffer,a,3)[h]=d):c==="vec4u"?void(new Uint32Array(this.buffer,a,4)[h]=d):void console.error(`SetDataValue: Type ${c} is not a struct`)}}}n=n.postfix}this.setData(e,r,s,a,i)}setData(e,r,n,i,a){const s=n.getTypeName();if(s!=="f32"&&s!=="f16")if(s!=="i32"&&s!=="atomic<i32>"&&s!=="x32")if(s!=="u32"&&s!=="atomic<u32>")if(s!=="bool"){if(s==="vec2f"||s==="vec2h"){const o=new Float32Array(this.buffer,i,2);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3f"||s==="vec3h"){const o=new Float32Array(this.buffer,i,3);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4f"||s==="vec4h"){const o=new Float32Array(this.buffer,i,4);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2i"){const o=new Int32Array(this.buffer,i,2);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3i"){const o=new Int32Array(this.buffer,i,3);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4i"){const o=new Int32Array(this.buffer,i,4);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2u"){const o=new Uint32Array(this.buffer,i,2);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3u"){const o=new Uint32Array(this.buffer,i,3);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4u"){const o=new Uint32Array(this.buffer,i,4);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2b"){const o=new Uint32Array(this.buffer,i,2);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3b"){const o=new Uint32Array(this.buffer,i,3);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4b"){const o=new Uint32Array(this.buffer,i,4);return void(r instanceof kt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="mat2x2f"||s==="mat2x2h"){const o=new Float32Array(this.buffer,i,4);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="mat2x3f"||s==="mat2x3h"){const o=new Float32Array(this.buffer,i,6);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5]))}if(s==="mat2x4f"||s==="mat2x4h"){const o=new Float32Array(this.buffer,i,8);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7]))}if(s==="mat3x2f"||s==="mat3x2h"){const o=new Float32Array(this.buffer,i,6);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5]))}if(s==="mat3x3f"||s==="mat3x3h"){const o=new Float32Array(this.buffer,i,9);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8]))}if(s==="mat3x4f"||s==="mat3x4h"){const o=new Float32Array(this.buffer,i,12);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11]))}if(s==="mat4x2f"||s==="mat4x2h"){const o=new Float32Array(this.buffer,i,8);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7]))}if(s==="mat4x3f"||s==="mat4x3h"){const o=new Float32Array(this.buffer,i,12);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11]))}if(s==="mat4x4f"||s==="mat4x4h"){const o=new Float32Array(this.buffer,i,16);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11],o[12]=r.data[12],o[13]=r.data[13],o[14]=r.data[14],o[15]=r.data[15]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]))}if(r instanceof js){if(n===r.typeInfo)return void new Uint8Array(this.buffer,i,r.buffer.byteLength).set(new Uint8Array(r.buffer));console.error("SetDataValue: Type mismatch",s,r.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${s}`)}else r instanceof ir&&(new Int32Array(this.buffer,i,1)[0]=r.value);else r instanceof ir&&(new Uint32Array(this.buffer,i,1)[0]=r.value);else r instanceof ir&&(new Int32Array(this.buffer,i,1)[0]=r.value);else r instanceof ir&&(new Float32Array(this.buffer,i,1)[0]=r.value)}getSubData(e,r,n){var i,a,s;if(r===null)return this;let o=this.offset,c=this.typeInfo;for(;r;){if(r instanceof r_){const d=r.index,m=d instanceof Ff?e.evalExpression(d,n):d;let b=0;if(m instanceof ir?b=m.value:typeof m=="number"?b=m:console.error("GetDataValue: Invalid index type",d),c instanceof wg)o+=b*c.stride,c=c.format;else{const x=c.getTypeName();x==="mat4x4"||x==="mat4x4f"||x==="mat4x4h"?(o+=16*b,c=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${c.getTypeName()} is not an array`)}}else{if(!(r instanceof gy))return console.error("GetDataValue: Unknown postfix type",r),null;{const d=r.value;if(c instanceof mg){let m=!1;for(const b of c.members)if(b.name===d){o+=b.offset,c=b.type,m=!0;break}if(!m)return console.error(`GetDataValue: Member ${d} not found`),null}else if(c instanceof zh){const m=c.getTypeName();if(m==="vec2f"||m==="vec3f"||m==="vec4f"||m==="vec2i"||m==="vec3i"||m==="vec4i"||m==="vec2u"||m==="vec3u"||m==="vec4u"||m==="vec2b"||m==="vec3b"||m==="vec4b"||m==="vec2h"||m==="vec3h"||m==="vec4h"||m==="vec2"||m==="vec3"||m==="vec4"){if(d.length>0&&d.length<5){let b="f";const x=[];for(let E=0;E<d.length;++E){const T=d[E].toLowerCase();let A=0;if(T==="x"||T==="r")A=0;else if(T==="y"||T==="g")A=1;else if(T==="z"||T==="b")A=2;else{if(T!=="w"&&T!=="a")return console.error(`Unknown member ${d}`),null;A=3}if(d.length===1){if(m.endsWith("f"))return this.buffer.byteLength<o+4*A+4?(console.log("Insufficient buffer data"),null):new ir(new Float32Array(this.buffer,o+4*A,1),e.getTypeInfo("f32"),this);if(m.endsWith("h"))return new ir(new Float32Array(this.buffer,o+4*A,1),e.getTypeInfo("f16"),this);if(m.endsWith("i"))return new ir(new Int32Array(this.buffer,o+4*A,1),e.getTypeInfo("i32"),this);if(m.endsWith("b"))return new ir(new Int32Array(this.buffer,o+4*A,1),e.getTypeInfo("bool"),this);if(m.endsWith("u"))return new ir(new Uint32Array(this.buffer,o+4*A,1),e.getTypeInfo("i32"),this)}if(m==="vec2f")x.push(new Float32Array(this.buffer,o,2)[A]);else if(m==="vec3f"){if(o+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const M=new Float32Array(this.buffer,o,3);x.push(M[A])}else if(m==="vec4f")x.push(new Float32Array(this.buffer,o,4)[A]);else if(m==="vec2i")b="i",x.push(new Int32Array(this.buffer,o,2)[A]);else if(m==="vec3i")b="i",x.push(new Int32Array(this.buffer,o,3)[A]);else if(m==="vec4i")b="i",x.push(new Int32Array(this.buffer,o,4)[A]);else if(m==="vec2u"){b="u";const M=new Uint32Array(this.buffer,o,2);x.push(M[A])}else m==="vec3u"?(b="u",x.push(new Uint32Array(this.buffer,o,3)[A])):m==="vec4u"&&(b="u",x.push(new Uint32Array(this.buffer,o,4)[A]))}return x.length===2?c=e.getTypeInfo(`vec2${b}`):x.length===3?c=e.getTypeInfo(`vec3${b}`):x.length===4?c=e.getTypeInfo(`vec4${b}`):console.error(`GetDataValue: Invalid vector length ${x.length}`),new kt(x,c,null)}return console.error(`GetDataValue: Unknown member ${d}`),null}return console.error(`GetDataValue: Type ${m} is not a struct`),null}}}r=r.postfix}const h=c.getTypeName();return h==="f32"?new ir(new Float32Array(this.buffer,o,1),c,this):h==="i32"?new ir(new Int32Array(this.buffer,o,1),c,this):h==="u32"?new ir(new Uint32Array(this.buffer,o,1),c,this):h==="vec2f"?new kt(new Float32Array(this.buffer,o,2),c,this):h==="vec3f"?new kt(new Float32Array(this.buffer,o,3),c,this):h==="vec4f"?new kt(new Float32Array(this.buffer,o,4),c,this):h==="vec2i"?new kt(new Int32Array(this.buffer,o,2),c,this):h==="vec3i"?new kt(new Int32Array(this.buffer,o,3),c,this):h==="vec4i"?new kt(new Int32Array(this.buffer,o,4),c,this):h==="vec2u"?new kt(new Uint32Array(this.buffer,o,2),c,this):h==="vec3u"?new kt(new Uint32Array(this.buffer,o,3),c,this):h==="vec4u"?new kt(new Uint32Array(this.buffer,o,4),c,this):c instanceof py&&c.name==="atomic"?((i=c.format)===null||i===void 0?void 0:i.name)==="u32"?new ir(new Uint32Array(this.buffer,o,1)[0],c.format,this):((a=c.format)===null||a===void 0?void 0:a.name)==="i32"?new ir(new Int32Array(this.buffer,o,1)[0],c.format,this):(console.error(`GetDataValue: Invalid atomic format ${(s=c.format)===null||s===void 0?void 0:s.name}`),null):new js(this.buffer,c,o,this)}toString(){let e="";if(this.typeInfo instanceof wg)if(this.typeInfo.format.name==="f32"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="i32"){const r=new Int32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="u32"){const r=new Uint32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="vec2f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}]`;for(let n=1;n<r.length/2;++n)e+=`, [${r[2*n]}, ${r[2*n+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}]`;for(let n=4;n<r.length;n+=4)e+=`, [${r[n]}, ${r[n+1]}, ${r[n+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}, ${r[3]}]`;for(let n=4;n<r.length;n+=4)e+=`, [${r[n]}, ${r[n+1]}, ${r[n+2]}, ${r[n+3]}]`}else e="[...]";else this.typeInfo instanceof mg?e+="{...}":e="[...]";return e}}class sp extends Yh{constructor(e,r,n,i){super(r,null),this.data=e,this.descriptor=n,this.view=i}clone(){return new sp(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>0?(e=n[0])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.width)!==null&&r!==void 0?r:0}get height(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>1?(e=n[1])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.height)!==null&&r!==void 0?r:0}get depthOrArrayLayers(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>2?(e=n[2])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.depthOrArrayLayers)!==null&&r!==void 0?r:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const r=[this.width,this.height,this.depthOrArrayLayers];for(let n=0;n<r.length;++n)r[n]=Math.max(1,r[n]>>e);return r}get texelByteSize(){const e=this.format,r=qP[e];return r?r.isDepthStencil?4:r.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,r=qP[e];return!!r&&r.isDepthStencil}getGpuSize(){const e=this.format,r=qP[e],n=this.width;if(!e||n<=0||!r)return-1;const i=this.height,a=this.depthOrArrayLayers,s=this.dimension;return n/r.blockWidth*(s==="1d"?1:i/r.blockHeight)*r.bytesPerBlock*a}getPixel(e,r,n=0,i=0){const a=this.texelByteSize,s=this.bytesPerRow,o=this.height,c=this.data[i];return W9e(new Uint8Array(c),e,r,n,i,o,s,a,this.format)}setPixel(e,r,n,i,a){const s=this.texelByteSize,o=this.bytesPerRow,c=this.height,h=this.data[i];(function(d,m,b,x,E,T,A,M,F,N){const O=x*(A>>=E)*(T>>=E)+b*A+m*M;switch(F){case"r8unorm":return void ao(d,O,"8unorm",1,N);case"r8snorm":return void ao(d,O,"8snorm",1,N);case"r8uint":return void ao(d,O,"8uint",1,N);case"r8sint":return void ao(d,O,"8sint",1,N);case"rg8unorm":return void ao(d,O,"8unorm",2,N);case"rg8snorm":return void ao(d,O,"8snorm",2,N);case"rg8uint":return void ao(d,O,"8uint",2,N);case"rg8sint":return void ao(d,O,"8sint",2,N);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void ao(d,O,"8unorm",4,N);case"rgba8snorm":return void ao(d,O,"8snorm",4,N);case"rgba8uint":return void ao(d,O,"8uint",4,N);case"rgba8sint":return void ao(d,O,"8sint",4,N);case"r16uint":return void ao(d,O,"16uint",1,N);case"r16sint":return void ao(d,O,"16sint",1,N);case"r16float":return void ao(d,O,"16float",1,N);case"rg16uint":return void ao(d,O,"16uint",2,N);case"rg16sint":return void ao(d,O,"16sint",2,N);case"rg16float":return void ao(d,O,"16float",2,N);case"rgba16uint":return void ao(d,O,"16uint",4,N);case"rgba16sint":return void ao(d,O,"16sint",4,N);case"rgba16float":return void ao(d,O,"16float",4,N);case"r32uint":return void ao(d,O,"32uint",1,N);case"r32sint":return void ao(d,O,"32sint",1,N);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void ao(d,O,"32float",1,N);case"rg32uint":return void ao(d,O,"32uint",2,N);case"rg32sint":return void ao(d,O,"32sint",2,N);case"rg32float":return void ao(d,O,"32float",2,N);case"rgba32uint":return void ao(d,O,"32uint",4,N);case"rgba32sint":return void ao(d,O,"32sint",4,N);case"rgba32float":return void ao(d,O,"32float",4,N);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(h),e,r,n,i,c,o,s,this.format,a)}}(t=>{t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"})(ar||(ar={}));class or{constructor(e,r,n){this.name=e,this.type=r,this.rule=n}toString(){return this.name}}class vt{}wr=vt,vt.none=new or("",ar.reserved,""),vt.eof=new or("EOF",ar.token,""),vt.reserved={asm:new or("asm",ar.reserved,"asm"),bf16:new or("bf16",ar.reserved,"bf16"),do:new or("do",ar.reserved,"do"),enum:new or("enum",ar.reserved,"enum"),f16:new or("f16",ar.reserved,"f16"),f64:new or("f64",ar.reserved,"f64"),handle:new or("handle",ar.reserved,"handle"),i8:new or("i8",ar.reserved,"i8"),i16:new or("i16",ar.reserved,"i16"),i64:new or("i64",ar.reserved,"i64"),mat:new or("mat",ar.reserved,"mat"),premerge:new or("premerge",ar.reserved,"premerge"),regardless:new or("regardless",ar.reserved,"regardless"),typedef:new or("typedef",ar.reserved,"typedef"),u8:new or("u8",ar.reserved,"u8"),u16:new or("u16",ar.reserved,"u16"),u64:new or("u64",ar.reserved,"u64"),unless:new or("unless",ar.reserved,"unless"),using:new or("using",ar.reserved,"using"),vec:new or("vec",ar.reserved,"vec"),void:new or("void",ar.reserved,"void")},vt.keywords={array:new or("array",ar.keyword,"array"),atomic:new or("atomic",ar.keyword,"atomic"),bool:new or("bool",ar.keyword,"bool"),f32:new or("f32",ar.keyword,"f32"),i32:new or("i32",ar.keyword,"i32"),mat2x2:new or("mat2x2",ar.keyword,"mat2x2"),mat2x3:new or("mat2x3",ar.keyword,"mat2x3"),mat2x4:new or("mat2x4",ar.keyword,"mat2x4"),mat3x2:new or("mat3x2",ar.keyword,"mat3x2"),mat3x3:new or("mat3x3",ar.keyword,"mat3x3"),mat3x4:new or("mat3x4",ar.keyword,"mat3x4"),mat4x2:new or("mat4x2",ar.keyword,"mat4x2"),mat4x3:new or("mat4x3",ar.keyword,"mat4x3"),mat4x4:new or("mat4x4",ar.keyword,"mat4x4"),ptr:new or("ptr",ar.keyword,"ptr"),sampler:new or("sampler",ar.keyword,"sampler"),sampler_comparison:new or("sampler_comparison",ar.keyword,"sampler_comparison"),struct:new or("struct",ar.keyword,"struct"),texture_1d:new or("texture_1d",ar.keyword,"texture_1d"),texture_2d:new or("texture_2d",ar.keyword,"texture_2d"),texture_2d_array:new or("texture_2d_array",ar.keyword,"texture_2d_array"),texture_3d:new or("texture_3d",ar.keyword,"texture_3d"),texture_cube:new or("texture_cube",ar.keyword,"texture_cube"),texture_cube_array:new or("texture_cube_array",ar.keyword,"texture_cube_array"),texture_multisampled_2d:new or("texture_multisampled_2d",ar.keyword,"texture_multisampled_2d"),texture_storage_1d:new or("texture_storage_1d",ar.keyword,"texture_storage_1d"),texture_storage_2d:new or("texture_storage_2d",ar.keyword,"texture_storage_2d"),texture_storage_2d_array:new or("texture_storage_2d_array",ar.keyword,"texture_storage_2d_array"),texture_storage_3d:new or("texture_storage_3d",ar.keyword,"texture_storage_3d"),texture_depth_2d:new or("texture_depth_2d",ar.keyword,"texture_depth_2d"),texture_depth_2d_array:new or("texture_depth_2d_array",ar.keyword,"texture_depth_2d_array"),texture_depth_cube:new or("texture_depth_cube",ar.keyword,"texture_depth_cube"),texture_depth_cube_array:new or("texture_depth_cube_array",ar.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new or("texture_depth_multisampled_2d",ar.keyword,"texture_depth_multisampled_2d"),texture_external:new or("texture_external",ar.keyword,"texture_external"),u32:new or("u32",ar.keyword,"u32"),vec2:new or("vec2",ar.keyword,"vec2"),vec3:new or("vec3",ar.keyword,"vec3"),vec4:new or("vec4",ar.keyword,"vec4"),bitcast:new or("bitcast",ar.keyword,"bitcast"),block:new or("block",ar.keyword,"block"),break:new or("break",ar.keyword,"break"),case:new or("case",ar.keyword,"case"),continue:new or("continue",ar.keyword,"continue"),continuing:new or("continuing",ar.keyword,"continuing"),default:new or("default",ar.keyword,"default"),diagnostic:new or("diagnostic",ar.keyword,"diagnostic"),discard:new or("discard",ar.keyword,"discard"),else:new or("else",ar.keyword,"else"),enable:new or("enable",ar.keyword,"enable"),fallthrough:new or("fallthrough",ar.keyword,"fallthrough"),false:new or("false",ar.keyword,"false"),fn:new or("fn",ar.keyword,"fn"),for:new or("for",ar.keyword,"for"),function:new or("function",ar.keyword,"function"),if:new or("if",ar.keyword,"if"),let:new or("let",ar.keyword,"let"),const:new or("const",ar.keyword,"const"),loop:new or("loop",ar.keyword,"loop"),while:new or("while",ar.keyword,"while"),private:new or("private",ar.keyword,"private"),read:new or("read",ar.keyword,"read"),read_write:new or("read_write",ar.keyword,"read_write"),return:new or("return",ar.keyword,"return"),requires:new or("requires",ar.keyword,"requires"),storage:new or("storage",ar.keyword,"storage"),switch:new or("switch",ar.keyword,"switch"),true:new or("true",ar.keyword,"true"),alias:new or("alias",ar.keyword,"alias"),type:new or("type",ar.keyword,"type"),uniform:new or("uniform",ar.keyword,"uniform"),var:new or("var",ar.keyword,"var"),override:new or("override",ar.keyword,"override"),workgroup:new or("workgroup",ar.keyword,"workgroup"),write:new or("write",ar.keyword,"write"),r8unorm:new or("r8unorm",ar.keyword,"r8unorm"),r8snorm:new or("r8snorm",ar.keyword,"r8snorm"),r8uint:new or("r8uint",ar.keyword,"r8uint"),r8sint:new or("r8sint",ar.keyword,"r8sint"),r16uint:new or("r16uint",ar.keyword,"r16uint"),r16sint:new or("r16sint",ar.keyword,"r16sint"),r16float:new or("r16float",ar.keyword,"r16float"),rg8unorm:new or("rg8unorm",ar.keyword,"rg8unorm"),rg8snorm:new or("rg8snorm",ar.keyword,"rg8snorm"),rg8uint:new or("rg8uint",ar.keyword,"rg8uint"),rg8sint:new or("rg8sint",ar.keyword,"rg8sint"),r32uint:new or("r32uint",ar.keyword,"r32uint"),r32sint:new or("r32sint",ar.keyword,"r32sint"),r32float:new or("r32float",ar.keyword,"r32float"),rg16uint:new or("rg16uint",ar.keyword,"rg16uint"),rg16sint:new or("rg16sint",ar.keyword,"rg16sint"),rg16float:new or("rg16float",ar.keyword,"rg16float"),rgba8unorm:new or("rgba8unorm",ar.keyword,"rgba8unorm"),rgba8unorm_srgb:new or("rgba8unorm_srgb",ar.keyword,"rgba8unorm_srgb"),rgba8snorm:new or("rgba8snorm",ar.keyword,"rgba8snorm"),rgba8uint:new or("rgba8uint",ar.keyword,"rgba8uint"),rgba8sint:new or("rgba8sint",ar.keyword,"rgba8sint"),bgra8unorm:new or("bgra8unorm",ar.keyword,"bgra8unorm"),bgra8unorm_srgb:new or("bgra8unorm_srgb",ar.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new or("rgb10a2unorm",ar.keyword,"rgb10a2unorm"),rg11b10float:new or("rg11b10float",ar.keyword,"rg11b10float"),rg32uint:new or("rg32uint",ar.keyword,"rg32uint"),rg32sint:new or("rg32sint",ar.keyword,"rg32sint"),rg32float:new or("rg32float",ar.keyword,"rg32float"),rgba16uint:new or("rgba16uint",ar.keyword,"rgba16uint"),rgba16sint:new or("rgba16sint",ar.keyword,"rgba16sint"),rgba16float:new or("rgba16float",ar.keyword,"rgba16float"),rgba32uint:new or("rgba32uint",ar.keyword,"rgba32uint"),rgba32sint:new or("rgba32sint",ar.keyword,"rgba32sint"),rgba32float:new or("rgba32float",ar.keyword,"rgba32float"),static_assert:new or("static_assert",ar.keyword,"static_assert")},vt.tokens={decimal_float_literal:new or("decimal_float_literal",ar.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new or("hex_float_literal",ar.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new or("int_literal",ar.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new or("uint_literal",ar.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new or("name",ar.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new or("ident",ar.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new or("and",ar.token,"&"),and_and:new or("and_and",ar.token,"&&"),arrow:new or("arrow ",ar.token,"->"),attr:new or("attr",ar.token,"@"),forward_slash:new or("forward_slash",ar.token,"/"),bang:new or("bang",ar.token,"!"),bracket_left:new or("bracket_left",ar.token,"["),bracket_right:new or("bracket_right",ar.token,"]"),brace_left:new or("brace_left",ar.token,"{"),brace_right:new or("brace_right",ar.token,"}"),colon:new or("colon",ar.token,":"),comma:new or("comma",ar.token,","),equal:new or("equal",ar.token,"="),equal_equal:new or("equal_equal",ar.token,"=="),not_equal:new or("not_equal",ar.token,"!="),greater_than:new or("greater_than",ar.token,">"),greater_than_equal:new or("greater_than_equal",ar.token,">="),shift_right:new or("shift_right",ar.token,">>"),less_than:new or("less_than",ar.token,"<"),less_than_equal:new or("less_than_equal",ar.token,"<="),shift_left:new or("shift_left",ar.token,"<<"),modulo:new or("modulo",ar.token,"%"),minus:new or("minus",ar.token,"-"),minus_minus:new or("minus_minus",ar.token,"--"),period:new or("period",ar.token,"."),plus:new or("plus",ar.token,"+"),plus_plus:new or("plus_plus",ar.token,"++"),or:new or("or",ar.token,"|"),or_or:new or("or_or",ar.token,"||"),paren_left:new or("paren_left",ar.token,"("),paren_right:new or("paren_right",ar.token,")"),semicolon:new or("semicolon",ar.token,";"),star:new or("star",ar.token,"*"),tilde:new or("tilde",ar.token,"~"),underscore:new or("underscore",ar.token,"_"),xor:new or("xor",ar.token,"^"),plus_equal:new or("plus_equal",ar.token,"+="),minus_equal:new or("minus_equal",ar.token,"-="),times_equal:new or("times_equal",ar.token,"*="),division_equal:new or("division_equal",ar.token,"/="),modulo_equal:new or("modulo_equal",ar.token,"%="),and_equal:new or("and_equal",ar.token,"&="),or_equal:new or("or_equal",ar.token,"|="),xor_equal:new or("xor_equal",ar.token,"^="),shift_right_equal:new or("shift_right_equal",ar.token,">>="),shift_left_equal:new or("shift_left_equal",ar.token,"<<=")},vt.simpleTokens={"@":wr.tokens.attr,"{":wr.tokens.brace_left,"}":wr.tokens.brace_right,":":wr.tokens.colon,",":wr.tokens.comma,"(":wr.tokens.paren_left,")":wr.tokens.paren_right,";":wr.tokens.semicolon},vt.literalTokens={"&":wr.tokens.and,"&&":wr.tokens.and_and,"->":wr.tokens.arrow,"/":wr.tokens.forward_slash,"!":wr.tokens.bang,"[":wr.tokens.bracket_left,"]":wr.tokens.bracket_right,"=":wr.tokens.equal,"==":wr.tokens.equal_equal,"!=":wr.tokens.not_equal,">":wr.tokens.greater_than,">=":wr.tokens.greater_than_equal,">>":wr.tokens.shift_right,"<":wr.tokens.less_than,"<=":wr.tokens.less_than_equal,"<<":wr.tokens.shift_left,"%":wr.tokens.modulo,"-":wr.tokens.minus,"--":wr.tokens.minus_minus,".":wr.tokens.period,"+":wr.tokens.plus,"++":wr.tokens.plus_plus,"|":wr.tokens.or,"||":wr.tokens.or_or,"*":wr.tokens.star,"~":wr.tokens.tilde,_:wr.tokens.underscore,"^":wr.tokens.xor,"+=":wr.tokens.plus_equal,"-=":wr.tokens.minus_equal,"*=":wr.tokens.times_equal,"/=":wr.tokens.division_equal,"%=":wr.tokens.modulo_equal,"&=":wr.tokens.and_equal,"|=":wr.tokens.or_equal,"^=":wr.tokens.xor_equal,">>=":wr.tokens.shift_right_equal,"<<=":wr.tokens.shift_left_equal},vt.regexTokens={decimal_float_literal:wr.tokens.decimal_float_literal,hex_float_literal:wr.tokens.hex_float_literal,int_literal:wr.tokens.int_literal,uint_literal:wr.tokens.uint_literal,ident:wr.tokens.ident},vt.storage_class=[wr.keywords.function,wr.keywords.private,wr.keywords.workgroup,wr.keywords.uniform,wr.keywords.storage],vt.access_mode=[wr.keywords.read,wr.keywords.write,wr.keywords.read_write],vt.sampler_type=[wr.keywords.sampler,wr.keywords.sampler_comparison],vt.sampled_texture_type=[wr.keywords.texture_1d,wr.keywords.texture_2d,wr.keywords.texture_2d_array,wr.keywords.texture_3d,wr.keywords.texture_cube,wr.keywords.texture_cube_array],vt.multisampled_texture_type=[wr.keywords.texture_multisampled_2d],vt.storage_texture_type=[wr.keywords.texture_storage_1d,wr.keywords.texture_storage_2d,wr.keywords.texture_storage_2d_array,wr.keywords.texture_storage_3d],vt.depth_texture_type=[wr.keywords.texture_depth_2d,wr.keywords.texture_depth_2d_array,wr.keywords.texture_depth_cube,wr.keywords.texture_depth_cube_array,wr.keywords.texture_depth_multisampled_2d],vt.texture_external_type=[wr.keywords.texture_external],vt.any_texture_type=[...wr.sampled_texture_type,...wr.multisampled_texture_type,...wr.storage_texture_type,...wr.depth_texture_type,...wr.texture_external_type],vt.texel_format=[wr.keywords.r8unorm,wr.keywords.r8snorm,wr.keywords.r8uint,wr.keywords.r8sint,wr.keywords.r16uint,wr.keywords.r16sint,wr.keywords.r16float,wr.keywords.rg8unorm,wr.keywords.rg8snorm,wr.keywords.rg8uint,wr.keywords.rg8sint,wr.keywords.r32uint,wr.keywords.r32sint,wr.keywords.r32float,wr.keywords.rg16uint,wr.keywords.rg16sint,wr.keywords.rg16float,wr.keywords.rgba8unorm,wr.keywords.rgba8unorm_srgb,wr.keywords.rgba8snorm,wr.keywords.rgba8uint,wr.keywords.rgba8sint,wr.keywords.bgra8unorm,wr.keywords.bgra8unorm_srgb,wr.keywords.rgb10a2unorm,wr.keywords.rg11b10float,wr.keywords.rg32uint,wr.keywords.rg32sint,wr.keywords.rg32float,wr.keywords.rgba16uint,wr.keywords.rgba16sint,wr.keywords.rgba16float,wr.keywords.rgba32uint,wr.keywords.rgba32sint,wr.keywords.rgba32float],vt.const_literal=[wr.tokens.int_literal,wr.tokens.uint_literal,wr.tokens.decimal_float_literal,wr.tokens.hex_float_literal,wr.keywords.true,wr.keywords.false],vt.literal_or_ident=[wr.tokens.ident,wr.tokens.int_literal,wr.tokens.uint_literal,wr.tokens.decimal_float_literal,wr.tokens.hex_float_literal,wr.tokens.name],vt.element_count_expression=[wr.tokens.int_literal,wr.tokens.uint_literal,wr.tokens.ident],vt.template_types=[wr.keywords.vec2,wr.keywords.vec3,wr.keywords.vec4,wr.keywords.mat2x2,wr.keywords.mat2x3,wr.keywords.mat2x4,wr.keywords.mat3x2,wr.keywords.mat3x3,wr.keywords.mat3x4,wr.keywords.mat4x2,wr.keywords.mat4x3,wr.keywords.mat4x4,wr.keywords.atomic,wr.keywords.bitcast,...wr.any_texture_type],vt.attribute_name=[wr.tokens.ident,wr.keywords.block,wr.keywords.diagnostic],vt.assignment_operators=[wr.tokens.equal,wr.tokens.plus_equal,wr.tokens.minus_equal,wr.tokens.times_equal,wr.tokens.division_equal,wr.tokens.modulo_equal,wr.tokens.and_equal,wr.tokens.or_equal,wr.tokens.xor_equal,wr.tokens.shift_right_equal,wr.tokens.shift_left_equal],vt.increment_operators=[wr.tokens.plus_plus,wr.tokens.minus_minus];class SW{constructor(e,r,n,i,a){this.type=e,this.lexeme=r,this.line=n,this.start=i,this.end=a}toString(){return this.lexeme}isTemplateType(){return vt.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==vt.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class Q9e{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new SW(vt.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let s=1;for(;s>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),s--,s==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),s++)}return!0}}const r=vt.simpleTokens[e];if(r)return this._addToken(r),!0;let n=vt.none;const i=this._isAlpha(e),a=e==="_";if(this._isAlphaNumeric(e)){let s=this._peekAhead();for(;this._isAlphaNumeric(s);)e+=this._advance(),s=this._peekAhead()}if(i){const s=vt.keywords[e];if(s)return this._addToken(s),!0}if(i||a)return this._addToken(vt.tokens.ident),!0;for(;;){let s=this._findType(e);const o=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(o=="=")return this._current++,e+=o,this._addToken(vt.tokens.minus_equal),!0;if(o=="-")return this._current++,e+=o,this._addToken(vt.tokens.minus_minus),!0;const c=this._tokens.length-1;if((vt.literal_or_ident.indexOf(this._tokens[c].type)!=-1||this._tokens[c].type==vt.tokens.paren_right)&&o!=">")return this._addToken(s),!0}if(e==">"&&(o==">"||o=="=")){let c=!1,h=this._tokens.length-1;for(let d=0;d<5&&h>=0&&vt.assignment_operators.indexOf(this._tokens[h].type)===-1;++d,--h)if(this._tokens[h].type===vt.tokens.less_than){h>0&&this._tokens[h-1].isArrayOrTemplateType()&&(c=!0);break}if(c)return this._addToken(s),!0}if(s===vt.none){let c=e,h=0;const d=2;for(let m=0;m<d;++m)if(c+=this._peekAhead(m),s=this._findType(c),s!==vt.none){h=m;break}if(s===vt.none)return n!==vt.none&&(this._current--,this._addToken(n),!0);e=c,this._current+=h+1}if(n=s,this._isAtEnd())break;e+=this._advance()}return n!==vt.none&&(this._addToken(n),!0)}_findType(e){for(const n in vt.regexTokens){const i=vt.regexTokens[n];if(this._match(e,i.rule))return i}return vt.literalTokens[e]||vt.none}_match(e,r){const n=r.exec(e);return n&&n.index==0&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let r=this._source[this._current];return e=e||0,e++,this._current+=e,r}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const r=this._source.substring(this._start,this._current);this._tokens.push(new SW(e,r,this._line,this._start,this._current))}}function On(t){return Array.isArray(t)||t?.buffer instanceof ArrayBuffer}const gT=new Float32Array(1),e7e=new Uint32Array(gT.buffer),t7e=new Uint32Array(gT.buffer),mT=new Int32Array(1),r7e=new Float32Array(mT.buffer),n7e=new Uint32Array(mT.buffer),yT=new Uint32Array(1),i7e=new Float32Array(yT.buffer),a7e=new Int32Array(yT.buffer);function EW(t,e,r){if(e===r)return t;if(e==="f32"){if(r==="i32"||r==="x32")return gT[0]=t,e7e[0];if(r==="u32")return gT[0]=t,t7e[0]}else if(e==="i32"||e==="x32"){if(r==="f32")return mT[0]=t,r7e[0];if(r==="u32")return mT[0]=t,n7e[0]}else if(e==="u32"){if(r==="f32")return yT[0]=t,i7e[0];if(r==="i32"||r==="x32")return yT[0]=t,a7e[0]}return console.error(`Unsupported cast from ${e} to ${r}`),t}class o7e{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class Yw{constructor(e,r){this.align=e,this.size=r}}class pd{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new V9e,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const r of e)r instanceof fx&&this._functions.set(r.name,new o7e(r));for(const r of e)if(r instanceof op){const n=this.getTypeInfo(r,null);n instanceof mg&&this.structs.push(n)}for(const r of e)if(r instanceof ZL)this.aliases.push(this._getAliasInfo(r));else{if(r instanceof XL){const n=r,i=this._getAttributeNum(n.attributes,"id",0),a=n.type!=null?this.getTypeInfo(n.type,n.attributes):null;this.overrides.push(new z9e(n.name,a,n.attributes,i));continue}if(this._isUniformVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=new Xw(n.name,s,i,a,n.attributes,lg.Uniform,n.access);o.access||(o.access="read"),this.uniforms.push(o);continue}if(this._isStorageVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(s),c=new Xw(n.name,s,i,a,n.attributes,o?lg.StorageTexture:lg.Storage,n.access);c.access||(c.access="read"),this.storage.push(c);continue}if(this._isTextureVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(s),c=new Xw(n.name,s,i,a,n.attributes,o?lg.StorageTexture:lg.Texture,n.access);c.access||(c.access="read"),o?this.storage.push(c):this.textures.push(c);continue}if(this._isSamplerVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=new Xw(n.name,s,i,a,n.attributes,lg.Sampler,n.access);this.samplers.push(o);continue}}for(const r of e)if(r instanceof fx){const n=this._getAttribute(r,"vertex"),i=this._getAttribute(r,"fragment"),a=this._getAttribute(r,"compute"),s=n||i||a,o=new U9e(r.name,s?.name,r.attributes);o.attributes=r.attributes,o.startLine=r.startLine,o.endLine=r.endLine,this.functions.push(o),this._functions.get(r.name).info=o,s&&(this._functions.get(r.name).inUse=!0,o.inUse=!0,o.resources=this._findResources(r,!!s),o.inputs=this._getInputs(r.args),o.outputs=this._getOutputs(r.returnType),this.entry[s.name].push(o)),o.arguments=r.args.map(c=>new j9e(c.name,this.getTypeInfo(c.type,c.attributes),c.attributes)),o.returnType=r.returnType?this.getTypeInfo(r.returnType,r.attributes):null;continue}for(const r of this._functions.values())r.info&&(r.info.inUse=r.inUse,this._addCalls(r.node,r.info.calls));for(const r of this._functions.values())r.node.search(n=>{var i,a,s;if(n instanceof Rre){if(n.value)if(On(n.value))for(const o of n.value)for(const c of this.overrides)o===c.name&&((i=r.info)===null||i===void 0||i.overrides.push(c));else for(const o of this.overrides)n.value===o.name&&((a=r.info)===null||a===void 0||a.overrides.push(o))}else if(n instanceof rh)for(const o of this.overrides)n.name===o.name&&((s=r.info)===null||s===void 0||s.overrides.push(o))});for(const r of this.uniforms)this._markStructsInUse(r.type);for(const r of this.storage)this._markStructsInUse(r.type)}getFunctionInfo(e){for(const r of this.functions)if(r.name==e)return r;return null}getStructInfo(e){for(const r of this.structs)if(r.name==e)return r;return null}getOverrideInfo(e){for(const r of this.overrides)if(r.name==e)return r;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const r of e.members)this._markStructsInUse(r.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const r=this._getAlias(e.name);r&&this._markStructsInUse(r)}}_addCalls(e,r){var n;for(const i of e.calls){const a=(n=this._functions.get(i.name))===null||n===void 0?void 0:n.info;a&&r.add(a)}}findResource(e,r,n){if(n){for(const i of this.entry.compute)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}for(const i of this.entry.vertex)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}for(const i of this.entry.fragment)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}}for(const i of this.uniforms)if(i.group==e&&i.binding==r)return i;for(const i of this.storage)if(i.group==e&&i.binding==r)return i;for(const i of this.textures)if(i.group==e&&i.binding==r)return i;for(const i of this.samplers)if(i.group==e&&i.binding==r)return i;return null}_findResource(e){for(const r of this.uniforms)if(r.name==e)return r;for(const r of this.storage)if(r.name==e)return r;for(const r of this.textures)if(r.name==e)return r;for(const r of this.samplers)if(r.name==e)return r;return null}_markStructsFromAST(e){const r=this.getTypeInfo(e,null);this._markStructsInUse(r)}_findResources(e,r){const n=[],i=this,a=[];return e.search(s=>{if(s instanceof dT)a.push({});else if(s instanceof pT)a.pop();else if(s instanceof cp){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type),a.length>0&&(a[a.length-1][o.name]=o)}else if(s instanceof od){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type)}else if(s instanceof Eb){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type),a.length>0&&(a[a.length-1][o.name]=o)}else if(s instanceof rh){const o=s;if(a.length>0&&a[a.length-1][o.name])return;const c=i._findResource(o.name);c&&n.push(c)}else if(s instanceof KL){const o=s,c=i._functions.get(o.name);c&&(r&&(c.inUse=!0),e.calls.add(c.node),c.resources===null&&(c.resources=i._findResources(c.node,r)),n.push(...c.resources))}else if(s instanceof YL){const o=s,c=i._functions.get(o.name);c&&(r&&(c.inUse=!0),e.calls.add(c.node),c.resources===null&&(c.resources=i._findResources(c.node,r)),n.push(...c.resources))}}),[...new Map(n.map(s=>[s.name,s])).values()]}getBindGroups(){const e=[];function r(n,i){n>=e.length&&(e.length=n+1),e[n]===void 0&&(e[n]=[]),i>=e[n].length&&(e[n].length=i+1)}for(const n of this.uniforms)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.storage)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.textures)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.samplers)r(n.group,n.binding),e[n.group][n.binding]=n;return e}_getOutputs(e,r=void 0){if(r===void 0&&(r=[]),e instanceof op)this._getStructOutputs(e,r);else{const n=this._getOutputInfo(e);n!==null&&r.push(n)}return r}_getStructOutputs(e,r){for(const n of e.members)if(n.type instanceof op)this._getStructOutputs(n.type,r);else{const i=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(i!==null){const a=this.getTypeInfo(n.type,n.type.attributes),s=this._parseInt(i.value),o=new vW(n.name,a,i.name,s);r.push(o)}}}_getOutputInfo(e){const r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){const n=this.getTypeInfo(e,e.attributes),i=this._parseInt(r.value);return new vW("",n,r.name,i)}return null}_getInputs(e,r=void 0){r===void 0&&(r=[]);for(const n of e)if(n.type instanceof op)this._getStructInputs(n.type,r);else{const i=this._getInputInfo(n);i!==null&&r.push(i)}return r}_getStructInputs(e,r){for(const n of e.members)if(n.type instanceof op)this._getStructInputs(n.type,r);else{const i=this._getInputInfo(n);i!==null&&r.push(i)}}_getInputInfo(e){const r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){const n=this._getAttribute(e,"interpolation"),i=this.getTypeInfo(e.type,e.attributes),a=this._parseInt(r.value),s=new B9e(e.name,i,r.name,a);return n!==null&&(s.interpolation=this._parseString(n.value)),s}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const r=parseInt(e);return isNaN(r)?e:r}_getAlias(e){for(const r of this.aliases)if(r.name==e)return r.type;return null}_getAliasInfo(e){return new F9e(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const r of this.structs)if(r.name==e)return r;for(const r of this.aliases)if(r.name==e)return r.type;return null}getTypeInfo(e,r=null){if(this._types.has(e))return this._types.get(e);if(e instanceof RS){const i=e.type?this.getTypeInfo(e.type,e.attributes):null,a=new QM(e.name,i,r);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof Tb){const i=e,a=i.format?this.getTypeInfo(i.format,i.attributes):null,s=new wg(i.name,r);return s.format=a,s.count=i.count,this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof op){const i=e,a=new mg(i.name,r);a.startLine=i.startLine,a.endLine=i.endLine;for(const s of i.members){const o=this.getTypeInfo(s.type,s.attributes);a.members.push(new yW(s.name,o,s.attributes))}return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof Q1){const i=e,a=i.format instanceof Kr,s=i.format?a?this.getTypeInfo(i.format,null):new zh(i.format,null):null,o=new py(i.name,s,r,i.access);return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof cr){const i=e,a=i.format?this.getTypeInfo(i.format,null):null,s=new py(i.name,a,r,i.access);return this._types.set(e,s),this._updateTypeInfo(s),s}const n=new zh(e.name,r);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var r,n,i;const a=this._getTypeSize(e);if(e.size=(r=a?.size)!==null&&r!==void 0?r:0,e instanceof wg&&e.format){const s=this._getTypeSize(e.format);e.stride=Math.max((n=s?.size)!==null&&n!==void 0?n:0,(i=s?.align)!==null&&i!==void 0?i:0),this._updateTypeInfo(e.format)}e instanceof QM&&this._updateTypeInfo(e.format),e instanceof mg&&this._updateStructInfo(e)}_updateStructInfo(e){var r;let n=0,i=0,a=0,s=0;for(let o=0,c=e.members.length;o<c;++o){const h=e.members[o],d=this._getTypeSize(h);if(!d)continue;(r=this._getAlias(h.type.name))!==null&&r!==void 0||h.type;const m=d.align,b=d.size;n=this._roundUp(m,n+i),i=b,a=n,s=Math.max(s,m),h.offset=n,h.size=b,this._updateTypeInfo(h.type)}e.size=this._roundUp(s,a+i),e.align=s}_getTypeSize(e){var r,n;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),a=this._getAttributeNum(e.attributes,"align",0);if(e instanceof yW&&(e=e.type),e instanceof zh){const s=this._getAlias(e.name);s!==null&&(e=s)}{const s=pd._typeInfo[e.name];if(s!==void 0){const o=((r=e.format)===null||r===void 0?void 0:r.name)==="f16"?2:1;return new Yw(Math.max(a,s.align/o),Math.max(i,s.size/o))}}{const s=pd._typeInfo[e.name.substring(0,e.name.length-1)];if(s){const o=e.name[e.name.length-1]==="h"?2:1;return new Yw(Math.max(a,s.align/o),Math.max(i,s.size/o))}}if(e instanceof wg){let s=e,o=8,c=8;const h=this._getTypeSize(s.format);return h!==null&&(c=h.size,o=h.align),c=s.count*this._getAttributeNum((n=e?.attributes)!==null&&n!==void 0?n:null,"stride",this._roundUp(o,c)),i&&(c=i),new Yw(Math.max(a,o),Math.max(i,c))}if(e instanceof mg){let s=0,o=0,c=0,h=0,d=0;for(const m of e.members){const b=this._getTypeSize(m.type);b!==null&&(s=Math.max(b.align,s),c=this._roundUp(b.align,c+h),h=b.size,d=c)}return o=this._roundUp(s,d+h),new Yw(Math.max(a,s),Math.max(i,o))}return null}_isUniformVar(e){return e instanceof cp&&e.storage=="uniform"}_isStorageVar(e){return e instanceof cp&&e.storage=="storage"}_isTextureVar(e){return e instanceof cp&&e.type!==null&&pd._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof cp&&e.type!==null&&pd._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,r){const n=e;if(!n||!n.attributes)return null;const i=n.attributes;for(let a of i)if(a.name==r)return a;return null}_getAttributeNum(e,r,n){if(e===null)return n;for(let i of e)if(i.name==r){let a=i!==null&&i.value!==null?i.value:n;return a instanceof Array&&(a=a[0]),typeof a=="number"?a:typeof a=="string"?parseInt(a):n}return n}_roundUp(e,r){return Math.ceil(r/e)*e}}pd._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},pd._textureTypes=vt.any_texture_type.map(t=>t.name),pd._samplerTypes=vt.sampler_type.map(t=>t.name);let JL=0;class QL{constructor(e,r,n){this.id=JL++,this.name=e,this.value=r,this.node=n}clone(){return new QL(this.name,this.value,this.node)}}class e6{constructor(e){this.id=JL++,this.name=e.name,this.node=e}clone(){return new e6(this.node)}}class t6{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=JL++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var r;return this.variables.has(e)?(r=this.variables.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var r;return this.functions.has(e)?(r=this.functions.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getFunction(e):null}createVariable(e,r,n){this.variables.set(e,new QL(e,r,n??null))}setVariable(e,r,n){const i=this.getVariable(e);i!==null?i.value=r:this.createVariable(e,r,n)}getVariableValue(e){var r;const n=this.getVariable(e);return(r=n?.value)!==null&&r!==void 0?r:null}clone(){return new t6(this)}}class s7e{evalExpression(e,r){return null}getTypeInfo(e){return null}getVariableName(e,r){return""}}class l7e{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,r){const n=this.exec.evalExpression(e.args[0],r);let i=!0;if(n instanceof kt)return n.data.forEach(a=>{a||(i=!1)}),new ir(i?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt){const i=n.data.some(a=>a);return new ir(i?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,r){const n=this.exec.evalExpression(e.args[2],r);if(!(n instanceof ir))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return n.value?this.exec.evalExpression(e.args[1],r):this.exec.evalExpression(e.args[0],r)}ArrayLength(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.evalExpression(n,r);if(i instanceof js&&i.typeInfo.size===0){const a=i.typeInfo,s=i.buffer.byteLength/a.stride;return new ir(s,this.getTypeInfo("u32"))}return new ir(i.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.abs(a)),n.typeInfo);const i=n;return new ir(Math.abs(i.value),i.typeInfo)}Acos(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.acos(a)),n.typeInfo);const i=n;return new ir(Math.acos(i.value),n.typeInfo)}Acosh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.acosh(a)),n.typeInfo);const i=n;return new ir(Math.acosh(i.value),n.typeInfo)}Asin(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.asin(a)),n.typeInfo);const i=n;return new ir(Math.asin(i.value),n.typeInfo)}Asinh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.asinh(a)),n.typeInfo);const i=n;return new ir(Math.asinh(i.value),n.typeInfo)}Atan(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.atan(a)),n.typeInfo);const i=n;return new ir(Math.atan(i.value),n.typeInfo)}Atanh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.atanh(a)),n.typeInfo);const i=n;return new ir(Math.atanh(i.value),n.typeInfo)}Atan2(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((o,c)=>Math.atan2(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.atan2(a.value,s.value),n.typeInfo)}Ceil(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.ceil(a)),n.typeInfo);const i=n;return new ir(Math.ceil(i.value),n.typeInfo)}_clamp(e,r,n){return Math.min(Math.max(e,r),n)}Clamp(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof kt&&i instanceof kt&&a instanceof kt)return new kt(n.data.map((h,d)=>this._clamp(h,i.data[d],a.data[d])),n.typeInfo);const s=n,o=i,c=a;return new ir(this._clamp(s.value,o.value,c.value),n.typeInfo)}Cos(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.cos(a)),n.typeInfo);const i=n;return new ir(Math.cos(i.value),n.typeInfo)}Cosh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.cosh(a)),n.typeInfo);const i=n;return new ir(Math.cos(i.value),n.typeInfo)}CountLeadingZeros(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.clz32(a)),n.typeInfo);const i=n;return new ir(Math.clz32(i.value),n.typeInfo)}_countOneBits(e){let r=0;for(;e!==0;)1&e&&r++,e>>=1;return r}CountOneBits(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>this._countOneBits(a)),n.typeInfo);const i=n;return new ir(this._countOneBits(i.value),n.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let r=0;for(;!(1&e);)e>>=1,r++;return r}CountTrailingZeros(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>this._countTrailingZeros(a)),n.typeInfo);const i=n;return new ir(this._countTrailingZeros(i.value),n.typeInfo)}Cross(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt){if(n.data.length!==3||i.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const a=n.data,s=i.data;return new kt([a[1]*s[2]-s[1]*a[2],a[2]*s[0]-s[2]*a[0],a[0]*s[1]-s[0]*a[1]],n.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,r){const n=this.exec.evalExpression(e.args[0],r),i=180/Math.PI;return n instanceof kt?new kt(n.data.map(a=>a*i),n.typeInfo):new ir(n.value*i,this.getTypeInfo("f32"))}Determinant(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Ii){const i=n.data,a=n.typeInfo.getTypeName(),s=a.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(a==="mat2x2"||a==="mat2x2f"||a==="mat2x2h")return new ir(i[0]*i[3]-i[1]*i[2],s);if(a==="mat2x3"||a==="mat2x3f"||a==="mat2x3h")return new ir(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);if(a==="mat2x4"||a==="mat2x4f"||a==="mat2x4h")console.error(`TODO: Determinant for ${a}`);else if(a==="mat3x2"||a==="mat3x2f"||a==="mat3x2h")console.error(`TODO: Determinant for ${a}`);else{if(a==="mat3x3"||a==="mat3x3f"||a==="mat3x3h")return new ir(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);a==="mat3x4"||a==="mat3x4f"||a==="mat3x4h"||a==="mat4x2"||a==="mat4x2f"||a==="mat4x2h"||a==="mat4x3"||a==="mat4x3f"||a==="mat4x3h"?console.error(`TODO: Determinant for ${a}`):a!=="mat4x4"&&a!=="mat4x4f"&&a!=="mat4x4h"||console.error(`TODO: Determinant for ${a}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt){let o=0;for(let c=0;c<n.data.length;++c)o+=(n.data[c]-i.data[c])*(n.data[c]-i.data[c]);return new ir(Math.sqrt(o),this.getTypeInfo("f32"))}const a=n,s=i;return new ir(Math.abs(a.value-s.value),n.typeInfo)}_dot(e,r){let n=0;for(let i=0;i<e.length;++i)n+=r[i]*e[i];return n}Dot(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);return n instanceof kt&&i instanceof kt?new ir(this._dot(n.data,i.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,r){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,r){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.exp(a)),n.typeInfo);const i=n;return new ir(Math.exp(i.value),n.typeInfo)}Exp2(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.pow(2,a)),n.typeInfo);const i=n;return new ir(Math.pow(2,i.value),n.typeInfo)}ExtractBits(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(i.typeInfo.name!=="u32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const s=i.value,o=a.value;if(n instanceof kt)return new kt(n.data.map(h=>h>>s&(1<<o)-1),n.typeInfo);if(n.typeInfo.name!=="i32"&&n.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const c=n.value;return new ir(c>>s&(1<<o)-1,this.getTypeInfo("i32"))}FaceForward(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof kt&&i instanceof kt&&a instanceof kt){const s=this._dot(i.data,a.data);return new kt(s<0?Array.from(n.data):n.data.map(o=>-o),n.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>this._firstLeadingBit(a)),n.typeInfo);const i=n;return new ir(this._firstLeadingBit(i.value),n.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>this._firstTrailingBit(a)),n.typeInfo);const i=n;return new ir(this._firstTrailingBit(i.value),n.typeInfo)}Floor(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.floor(a)),n.typeInfo);const i=n;return new ir(Math.floor(i.value),n.typeInfo)}Fma(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof kt&&i instanceof kt&&a instanceof kt)return n.data.length!==i.data.length||n.data.length!==a.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new kt(n.data.map((h,d)=>h*i.data[d]+a.data[d]),n.typeInfo);const s=n,o=i,c=a;return new ir(s.value*o.value+c.value,s.typeInfo)}Fract(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>a-Math.floor(a)),n.typeInfo);const i=n;return new ir(i.value-Math.floor(i.value),n.typeInfo)}Frexp(e,r){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r),s=this.exec.evalExpression(e.args[3],r);if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const o=a.value,c=(1<<s.value)-1<<o,h=~c;if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((b,x)=>b&h|i.data[x]<<o&c),n.typeInfo);const d=n.value,m=i.value;return new ir(d&h|m<<o&c,n.typeInfo)}InverseSqrt(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>1/Math.sqrt(a)),n.typeInfo);const i=n;return new ir(1/Math.sqrt(i.value),n.typeInfo)}Ldexp(e,r){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt){let a=0;return n.data.forEach(s=>{a+=s*s}),new ir(Math.sqrt(a),this.getTypeInfo("f32"))}const i=n;return new ir(Math.abs(i.value),n.typeInfo)}Log(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.log(a)),n.typeInfo);const i=n;return new ir(Math.log(i.value),n.typeInfo)}Log2(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.log2(a)),n.typeInfo);const i=n;return new ir(Math.log2(i.value),n.typeInfo)}Max(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((o,c)=>Math.max(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.max(a.value,s.value),n.typeInfo)}Min(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((o,c)=>Math.min(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.min(a.value,s.value),n.typeInfo)}Mix(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof kt&&i instanceof kt&&a instanceof kt)return new kt(n.data.map((c,h)=>n.data[h]*(1-a.data[h])+i.data[h]*a.data[h]),n.typeInfo);const s=i,o=a;return new ir(n.value*(1-o.value)+s.value*o.value,n.typeInfo)}Modf(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((s,o)=>s%i.data[o]),n.typeInfo);const a=i;return new ir(n.value%a.value,n.typeInfo)}Normalize(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt){const i=this.Length(e,r).value;return new kt(n.data.map(a=>a/i),n.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt)return new kt(n.data.map((o,c)=>Math.pow(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.pow(a.value,s.value),n.typeInfo)}QuantizeToF16(e,r){const n=this.exec.evalExpression(e.args[0],r);return n instanceof kt?new kt(n.data.map(i=>i),n.typeInfo):new ir(n.value,n.typeInfo)}Radians(e,r){const n=this.exec.evalExpression(e.args[0],r);return n instanceof kt?new kt(n.data.map(i=>i*Math.PI/180),n.typeInfo):new ir(n.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,r){let n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof kt&&i instanceof kt){const a=this._dot(n.data,i.data);return new kt(n.data.map((s,o)=>s-2*a*i.data[o]),n.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,r){let n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof kt&&i instanceof kt&&a instanceof ir){const s=this._dot(i.data,n.data);return new kt(n.data.map((o,c)=>{const h=1-a.value*a.value*(1-s*s);if(h<0)return 0;const d=Math.sqrt(h);return a.value*o-(a.value*s+d)*i.data[c]}),n.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,r){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.round(a)),n.typeInfo);const i=n;return new ir(Math.round(i.value),n.typeInfo)}Saturate(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.min(Math.max(a,0),1)),n.typeInfo);const i=n;return new ir(Math.min(Math.max(i.value,0),1),n.typeInfo)}Sign(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.sign(a)),n.typeInfo);const i=n;return new ir(Math.sign(i.value),n.typeInfo)}Sin(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.sin(a)),n.typeInfo);const i=n;return new ir(Math.sin(i.value),n.typeInfo)}Sinh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.sinh(a)),n.typeInfo);const i=n;return new ir(Math.sinh(i.value),n.typeInfo)}_smoothstep(e,r,n){const i=Math.min(Math.max((n-e)/(r-e),0),1);return i*i*(3-2*i)}SmoothStep(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(a instanceof kt&&n instanceof kt&&i instanceof kt)return new kt(a.data.map((h,d)=>this._smoothstep(n.data[d],i.data[d],h)),a.typeInfo);const s=n,o=i,c=a;return new ir(this._smoothstep(s.value,o.value,c.value),a.typeInfo)}Sqrt(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.sqrt(a)),n.typeInfo);const i=n;return new ir(Math.sqrt(i.value),n.typeInfo)}Step(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(i instanceof kt&&n instanceof kt)return new kt(i.data.map((s,o)=>s<n.data[o]?0:1),i.typeInfo);const a=n;return new ir(i.value<a.value?0:1,a.typeInfo)}Tan(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.tan(a)),n.typeInfo);const i=n;return new ir(Math.tan(i.value),n.typeInfo)}Tanh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.tanh(a)),n.typeInfo);const i=n;return new ir(Math.tanh(i.value),n.typeInfo)}_getTransposeType(e){const r=e.getTypeName();return r==="mat2x2f"||r==="mat2x2h"?e:r==="mat2x3f"?this.getTypeInfo("mat3x2f"):r==="mat2x3h"?this.getTypeInfo("mat3x2h"):r==="mat2x4f"?this.getTypeInfo("mat4x2f"):r==="mat2x4h"?this.getTypeInfo("mat4x2h"):r==="mat3x2f"?this.getTypeInfo("mat2x3f"):r==="mat3x2h"?this.getTypeInfo("mat2x3h"):r==="mat3x3f"||r==="mat3x3h"?e:r==="mat3x4f"?this.getTypeInfo("mat4x3f"):r==="mat3x4h"?this.getTypeInfo("mat4x3h"):r==="mat4x2f"?this.getTypeInfo("mat2x4f"):r==="mat4x2h"?this.getTypeInfo("mat2x4h"):r==="mat4x3f"?this.getTypeInfo("mat3x4f"):r==="mat4x3h"?this.getTypeInfo("mat3x4h"):(r==="mat4x4f"||r==="mat4x4h"||console.error(`Invalid matrix type ${r}`),e)}Transpose(e,r){const n=this.exec.evalExpression(e.args[0],r);if(!(n instanceof Ii))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const i=this._getTransposeType(n.typeInfo);if(n.typeInfo.name==="mat2x2"||n.typeInfo.name==="mat2x2f"||n.typeInfo.name==="mat2x2h"){const a=n.data;return new Ii([a[0],a[2],a[1],a[3]],i)}if(n.typeInfo.name==="mat2x3"||n.typeInfo.name==="mat2x3f"||n.typeInfo.name==="mat2x3h"){const a=n.data;return new Ii([a[0],a[3],a[6],a[1],a[4],a[7]],i)}if(n.typeInfo.name==="mat2x4"||n.typeInfo.name==="mat2x4f"||n.typeInfo.name==="mat2x4h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13]],i)}if(n.typeInfo.name==="mat3x2"||n.typeInfo.name==="mat3x2f"||n.typeInfo.name==="mat3x2h"){const a=n.data;return new Ii([a[0],a[3],a[1],a[4],a[2],a[5]],i)}if(n.typeInfo.name==="mat3x3"||n.typeInfo.name==="mat3x3f"||n.typeInfo.name==="mat3x3h"){const a=n.data;return new Ii([a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]],i)}if(n.typeInfo.name==="mat3x4"||n.typeInfo.name==="mat3x4f"||n.typeInfo.name==="mat3x4h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14]],i)}if(n.typeInfo.name==="mat4x2"||n.typeInfo.name==="mat4x2f"||n.typeInfo.name==="mat4x2h"){const a=n.data;return new Ii([a[0],a[4],a[1],a[5],a[2],a[6]],i)}if(n.typeInfo.name==="mat4x3"||n.typeInfo.name==="mat4x3f"||n.typeInfo.name==="mat4x3h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]],i)}if(n.typeInfo.name==="mat4x4"||n.typeInfo.name==="mat4x4f"||n.typeInfo.name==="mat4x4h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]],i)}return console.error(`Invalid matrix type ${n.typeInfo.name}`),null}Trunc(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof kt)return new kt(n.data.map(a=>Math.trunc(a)),n.typeInfo);const i=n;return new ir(Math.trunc(i.value),n.typeInfo)}Dpdx(e,r){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,r){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,r){return console.error("TODO: dpdxFine"),null}Dpdy(e,r){return console.error("TODO: dpdy"),null}DpdyCoarse(e,r){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,r){return console.error("TODO: dpdyFine"),null}Fwidth(e,r){return console.error("TODO: fwidth"),null}FwidthCoarse(e,r){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,r){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,r){const n=e.args[0],i=e.args.length>1?this.exec.evalExpression(e.args[1],r).value:0;if(n instanceof rh){const a=n.name,s=r.getVariableValue(a);if(s instanceof sp){if(i<0||i>=s.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const o=s.getMipLevelSize(i),c=s.dimension;return c==="1d"?new ir(o[0],this.getTypeInfo("u32")):c==="3d"?new kt(o,this.getTypeInfo("vec3u")):c==="2d"?new kt(o.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${c} not found. Line ${e.line}`),null)}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,r){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,r){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,r){const n=e.args[0],i=this.exec.evalExpression(e.args[1],r),a=e.args.length>2?this.exec.evalExpression(e.args[2],r).value:0;if(!(i instanceof kt)||i.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(n instanceof rh){const s=n.name,o=r.getVariableValue(s);if(o instanceof sp){const c=Math.floor(i.data[0]),h=Math.floor(i.data[1]);if(c<0||c>=o.width||h<0||h>=o.height)return console.error(`Texture ${s} out of bounds. Line ${e.line}`),null;const d=o.getPixel(c,h,0,a);return d===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new kt(d,this.getTypeInfo("vec4f"))}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,r){const n=e.args[0];if(n instanceof rh){const i=n.name,a=r.getVariableValue(i);return a instanceof sp?new ir(a.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,r){const n=e.args[0];if(n instanceof rh){const i=n.name,a=r.getVariableValue(i);return a instanceof sp?new ir(a.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,r){const n=e.args[0];if(n instanceof rh){const i=n.name,a=r.getVariableValue(i);return a instanceof sp?new ir(a.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,r){return console.error("TODO: textureSample"),null}TextureSampleBias(e,r){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,r){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,r){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,r){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,r){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,r){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,r){const n=e.args[0],i=this.exec.evalExpression(e.args[1],r),a=e.args.length===4?this.exec.evalExpression(e.args[2],r).value:0,s=e.args.length===4?this.exec.evalExpression(e.args[3],r).data:this.exec.evalExpression(e.args[2],r).data;if(s.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(i instanceof kt)||i.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(n instanceof rh){const o=n.name,c=r.getVariableValue(o);if(c instanceof sp){const h=c.getMipLevelSize(0),d=Math.floor(i.data[0]),m=Math.floor(i.data[1]);return d<0||d>=h[0]||m<0||m>=h[1]?(console.error(`Texture ${o} out of bounds. Line ${e.line}`),null):(c.setPixel(d,m,0,a,Array.from(s)),null)}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r);return r.getVariable(i).value.getSubData(this.exec,n.postfix,r)}AtomicStore(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r);return c instanceof ir&&o instanceof ir&&(c.value=o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),null}AtomicAdd(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),h=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value+=o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),h}AtomicSub(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),h=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value-=o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),h}AtomicMax(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),h=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=Math.max(c.value,o.value)),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),h}AtomicMin(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),h=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=Math.min(c.value,o.value)),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),h}AtomicAnd(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),h=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=c.value&o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),h}AtomicOr(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),h=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=c.value|o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),h}AtomicXor(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),h=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=c.value^o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),h}AtomicExchange(e,r){let n=e.args[0];n instanceof wl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),h=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=o.value),a.value instanceof js&&a.value.setDataValue(this.exec,c,n.postfix,r),h}AtomicCompareExchangeWeak(e,r){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,r){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,r){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,r){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,r){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,r){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,r){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,r){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,r){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,r){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,r){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,r){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,r){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,r){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,r){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,r){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,r){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,r){return null}TextureBarrier(e,r){return null}WorkgroupBarrier(e,r){return null}WorkgroupUniformLoad(e,r){return null}SubgroupAdd(e,r){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,r){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,r){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,r){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,r){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,r){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,r){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,r){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,r){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,r){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,r){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,r){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,r){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,r){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,r){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,r){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,r){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,r){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,r){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,r){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,r){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,r){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,r){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,r){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,r){return console.error("TODO: quadSwapY"),null}}const HP={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},dc={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class Ju extends s7e{constructor(e,r){var n;super(),this.ast=e??[],this.reflection=new pd,this.reflection.updateAST(this.ast),this.context=(n=r?.clone())!==null&&n!==void 0?n:new t6,this.builtins=new l7e(this),this.typeInfo={bool:this.getTypeInfo(Kr.bool),i32:this.getTypeInfo(Kr.i32),u32:this.getTypeInfo(Kr.u32),f32:this.getTypeInfo(Kr.f32),f16:this.getTypeInfo(Kr.f16),vec2f:this.getTypeInfo(cr.vec2f),vec2u:this.getTypeInfo(cr.vec2u),vec2i:this.getTypeInfo(cr.vec2i),vec2h:this.getTypeInfo(cr.vec2h),vec3f:this.getTypeInfo(cr.vec3f),vec3u:this.getTypeInfo(cr.vec3u),vec3i:this.getTypeInfo(cr.vec3i),vec3h:this.getTypeInfo(cr.vec3h),vec4f:this.getTypeInfo(cr.vec4f),vec4u:this.getTypeInfo(cr.vec4u),vec4i:this.getTypeInfo(cr.vec4i),vec4h:this.getTypeInfo(cr.vec4h),mat2x2f:this.getTypeInfo(cr.mat2x2f),mat2x3f:this.getTypeInfo(cr.mat2x3f),mat2x4f:this.getTypeInfo(cr.mat2x4f),mat3x2f:this.getTypeInfo(cr.mat3x2f),mat3x3f:this.getTypeInfo(cr.mat3x3f),mat3x4f:this.getTypeInfo(cr.mat3x4f),mat4x2f:this.getTypeInfo(cr.mat4x2f),mat4x3f:this.getTypeInfo(cr.mat4x3f),mat4x4f:this.getTypeInfo(cr.mat4x4f)}}getVariableValue(e){var r,n;const i=(n=(r=this.context.getVariable(e))===null||r===void 0?void 0:r.value)!==null&&n!==void 0?n:null;if(i===null)return null;if(i instanceof ir)return i.value;if(i instanceof kt||i instanceof Ii)return Array.from(i.data);if(i instanceof js&&i.typeInfo instanceof wg){if(i.typeInfo.format.name==="u32")return Array.from(new Uint32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="i32")return Array.from(new Int32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="f32")return Array.from(new Float32Array(i.buffer,i.offset,i.typeInfo.count))}return console.error(`Unsupported return variable type ${i.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,r,n,i){const a=this.context.clone();(i=i??{}).constants&&this._setOverrides(i.constants,a),this._execStatements(this.ast,a);const s=a.getFunction(e);if(!s)return void console.error(`Function ${e} not found`);if(typeof r=="number")r=[r,1,1];else{if(r.length===0)return void console.error("Invalid dispatch count");r.length===1?r=[r[0],1,1]:r.length===2?r=[r[0],r[1],1]:r.length>3&&(r=[r[0],r[1],r[2]])}const o=r[0],c=r[1],h=r[2],d=this.getTypeInfo("vec3u");a.setVariable("@num_workgroups",new kt(r,d));const m=this.reflection.getFunctionInfo(e);m===null&&console.error(`Function ${e} not found in reflection data`);for(const b in n)for(const x in n[b]){const E=n[b][x];a.variables.forEach(T=>{var A;const M=T.node;if(M?.attributes){let F=null,N=null;for(const O of M.attributes)O.name==="binding"?F=O.value:O.name==="group"&&(N=O.value);if(x==F&&b==N){let O=!1;for(const U of m.resources)if(U.name===T.name&&U.group===parseInt(b)&&U.binding===parseInt(x)){O=!0;break}if(O)if(E.texture!==void 0&&E.descriptor!==void 0){const U=new sp(E.texture,this.getTypeInfo(M.type),E.descriptor,(A=E.texture.view)!==null&&A!==void 0?A:null);T.value=U}else E.uniform!==void 0?T.value=new js(E.uniform,this.getTypeInfo(M.type)):T.value=new js(E,this.getTypeInfo(M.type))}}})}for(let b=0;b<h;++b)for(let x=0;x<c;++x)for(let E=0;E<o;++E)a.setVariable("@workgroup_id",new kt([E,x,b],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(s,[E,x,b],a)}execStatement(e,r){if(e instanceof xre)return this.evalExpression(e.value,r);if(e instanceof Sre){if(e.condition){const n=this.evalExpression(e.condition,r);if(!(n instanceof ir))throw new Error("Invalid break-if condition");if(!n.value)return null}return Ju._breakObj}if(e instanceof Ere)return Ju._continueObj;if(e instanceof Eb)this._let(e,r);else if(e instanceof cp)this._var(e,r);else if(e instanceof kS)this._const(e,r);else if(e instanceof fx)this._function(e,r);else{if(e instanceof bre)return this._if(e,r);if(e instanceof _re)return this._switch(e,r);if(e instanceof gre)return this._for(e,r);if(e instanceof pre)return this._while(e,r);if(e instanceof vre)return this._loop(e,r);if(e instanceof eD){const n=r.clone();return n.currentFunctionName=r.currentFunctionName,this._execStatements(e.body,n)}if(e instanceof yre)this._assign(e,r);else if(e instanceof mre)this._increment(e,r);else{if(e instanceof op)return null;if(e instanceof XL){const n=e.name;r.getVariable(n)===null&&r.setVariable(n,new ir(0,this.getTypeInfo("u32")))}else if(e instanceof YL)this._call(e,r);else{if(e instanceof wre||e instanceof ZL)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,r){return e instanceof mf?this._evalBinaryOp(e,r):e instanceof Ol?this._evalLiteral(e,r):e instanceof rh?this._evalVariable(e,r):e instanceof KL?this._evalCall(e,r):e instanceof od?this._evalCreate(e,r):e instanceof Tre?this._evalConst(e,r):e instanceof Cre?this._evalBitcast(e,r):e instanceof wl?this._evalUnaryOp(e,r):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var r;if(e instanceof Kr){const i=this.reflection.getTypeInfo(e);if(i!==null)return i}let n=(r=this.typeInfo[e])!==null&&r!==void 0?r:null;return n!==null||(n=this.reflection.getTypeInfoByName(e)),n}_setOverrides(e,r){for(const n in e){const i=e[n],a=this.reflection.getOverrideInfo(n);a!==null?(a.type===null&&(a.type=this.getTypeInfo("u32")),a.type.name==="u32"||a.type.name==="i32"||a.type.name==="f32"||a.type.name==="f16"?r.setVariable(n,new ir(i,a.type)):a.type.name==="bool"?r.setVariable(n,new ir(i?1:0,a.type)):a.type.name==="vec2"||a.type.name==="vec3"||a.type.name==="vec4"||a.type.name==="vec2f"||a.type.name==="vec3f"||a.type.name==="vec4f"||a.type.name==="vec2i"||a.type.name==="vec3i"||a.type.name==="vec4i"||a.type.name==="vec2u"||a.type.name==="vec3u"||a.type.name==="vec4u"||a.type.name==="vec2h"||a.type.name==="vec3h"||a.type.name==="vec4h"?r.setVariable(n,new kt(i,a.type)):console.error(`Invalid constant type for ${n}`)):console.error(`Override ${n} does not exist in the shader.`)}}_dispatchWorkgroup(e,r,n){const i=[1,1,1];for(const d of e.node.attributes)if(d.name==="workgroup_size"){if(d.value.length>0){const m=n.getVariableValue(d.value[0]);i[0]=m instanceof ir?m.value:parseInt(d.value[0])}if(d.value.length>1){const m=n.getVariableValue(d.value[1]);i[1]=m instanceof ir?m.value:parseInt(d.value[1])}if(d.value.length>2){const m=n.getVariableValue(d.value[2]);i[2]=m instanceof ir?m.value:parseInt(d.value[2])}}const a=this.getTypeInfo("vec3u"),s=this.getTypeInfo("u32");n.setVariable("@workgroup_size",new kt(i,a));const o=i[0],c=i[1],h=i[2];for(let d=0,m=0;d<h;++d)for(let b=0;b<c;++b)for(let x=0;x<o;++x,++m){const E=[x,b,d],T=[x+r[0]*i[0],b+r[1]*i[1],d+r[2]*i[2]];n.setVariable("@local_invocation_id",new kt(E,a)),n.setVariable("@global_invocation_id",new kt(T,a)),n.setVariable("@local_invocation_index",new ir(m,s)),this._dispatchExec(e,n)}}_dispatchExec(e,r){for(const n of e.node.args)for(const i of n.attributes)if(i.name==="builtin"){const a=`@${i.value}`,s=r.getVariable(a);s!==void 0&&r.variables.set(n.name,s)}this._execStatements(e.node.body,r)}getVariableName(e,r){for(;e instanceof wl;)e=e.right;return e instanceof rh?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,r){for(const n of e){if(n instanceof Array){const a=r.clone(),s=this._execStatements(n,a);if(s)return s;continue}const i=this.execStatement(n,r);if(i)return i}return null}_call(e,r){const n=r.clone();n.currentFunctionName=e.name;const i=r.getFunction(e.name);if(i){for(let a=0;a<i.node.args.length;++a){const s=i.node.args[a],o=this.evalExpression(e.args[a],n);n.setVariable(s.name,o,s)}this._execStatements(i.node.body,n)}else e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)&&this._evalCreate(e,r)}_increment(e,r){const n=this.getVariableName(e.variable,r),i=r.getVariable(n);i?e.operator==="++"?i.value instanceof ir?i.value.value++:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):e.operator==="--"?i.value instanceof ir?i.value.value--:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${n} not found. Line ${e.line}`)}_getVariableData(e,r){if(e instanceof rh){const n=this.getVariableName(e,r),i=r.getVariable(n);return i===null?(console.error(`Variable ${n} not found. Line ${e.line}`),null):i.value.getSubData(this,e.postfix,r)}if(e instanceof wl){if(e.operator==="*"){const n=this._getVariableData(e.right,r);return n instanceof Pv?n.reference.getSubData(this,e.postfix,r):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const n=this._getVariableData(e.right,r);return new Pv(n)}}return null}_assign(e,r){let n=null,i="<var>",a=null;if(e.variable instanceof wl){const c=this._getVariableData(e.variable,r),h=this.evalExpression(e.value,r),d=e.operator;if(d==="="){if(c instanceof ir||c instanceof kt||c instanceof Ii){if(h instanceof ir||h instanceof kt||h instanceof Ii&&c.data.length===h.data.length)return void c.data.set(h.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(c instanceof js&&h instanceof js&&c.buffer.byteLength-c.offset>=h.buffer.byteLength-h.offset)return void(c.buffer.byteLength%4==0?new Uint32Array(c.buffer,c.offset,c.typeInfo.size/4).set(new Uint32Array(h.buffer,h.offset,h.typeInfo.size/4)):new Uint8Array(c.buffer,c.offset,c.typeInfo.size).set(new Uint8Array(h.buffer,h.offset,h.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(d==="+=")return c instanceof ir||c instanceof kt||c instanceof Ii?h instanceof ir||h instanceof kt||h instanceof Ii?void c.data.set(h.data.map((m,b)=>c.data[b]+m)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(d==="-=")return(c instanceof ir||c instanceof kt||c instanceof Ii)&&(h instanceof ir||h instanceof kt||h instanceof Ii)?void c.data.set(h.data.map((m,b)=>c.data[b]-m)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof wl){if(e.variable.operator==="*"){i=this.getVariableName(e.variable.right,r);const c=r.getVariable(i);if(!(c&&c.value instanceof Pv))return void console.error(`Variable ${i} is not a pointer. Line ${e.line}`);n=c.value.reference;let h=e.variable.postfix;if(!h){let d=e.variable.right;for(;d instanceof wl;){if(d.postfix){h=d.postfix;break}d=d.right}}h&&(n=n.getSubData(this,h,r))}}else{a=e.variable.postfix,i=this.getVariableName(e.variable,r);const c=r.getVariable(i);if(c===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);n=c.value}if(n instanceof Pv&&(n=n.reference),n===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);const s=this.evalExpression(e.value,r),o=e.operator;if(o!=="="){const c=n.getSubData(this,a,r);if(c instanceof kt&&s instanceof ir){const h=c.data,d=s.value;if(o==="+=")for(let m=0;m<h.length;++m)h[m]+=d;else if(o==="-=")for(let m=0;m<h.length;++m)h[m]-=d;else if(o==="*=")for(let m=0;m<h.length;++m)h[m]*=d;else if(o==="/=")for(let m=0;m<h.length;++m)h[m]/=d;else if(o==="%=")for(let m=0;m<h.length;++m)h[m]%=d;else if(o==="&=")for(let m=0;m<h.length;++m)h[m]&=d;else if(o==="|=")for(let m=0;m<h.length;++m)h[m]|=d;else if(o==="^=")for(let m=0;m<h.length;++m)h[m]^=d;else if(o==="<<=")for(let m=0;m<h.length;++m)h[m]<<=d;else if(o===">>=")for(let m=0;m<h.length;++m)h[m]>>=d;else console.error(`Invalid operator ${o}. Line ${e.line}`)}else if(c instanceof kt&&s instanceof kt){const h=c.data,d=s.data;if(h.length!==d.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(o==="+=")for(let m=0;m<h.length;++m)h[m]+=d[m];else if(o==="-=")for(let m=0;m<h.length;++m)h[m]-=d[m];else if(o==="*=")for(let m=0;m<h.length;++m)h[m]*=d[m];else if(o==="/=")for(let m=0;m<h.length;++m)h[m]/=d[m];else if(o==="%=")for(let m=0;m<h.length;++m)h[m]%=d[m];else if(o==="&=")for(let m=0;m<h.length;++m)h[m]&=d[m];else if(o==="|=")for(let m=0;m<h.length;++m)h[m]|=d[m];else if(o==="^=")for(let m=0;m<h.length;++m)h[m]^=d[m];else if(o==="<<=")for(let m=0;m<h.length;++m)h[m]<<=d[m];else if(o===">>=")for(let m=0;m<h.length;++m)h[m]>>=d[m];else console.error(`Invalid operator ${o}. Line ${e.line}`)}else{if(!(c instanceof ir&&s instanceof ir))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);o==="+="?c.value+=s.value:o==="-="?c.value-=s.value:o==="*="?c.value*=s.value:o==="/="?c.value/=s.value:o==="%="?c.value%=s.value:o==="&="?c.value&=s.value:o==="|="?c.value|=s.value:o==="^="?c.value^=s.value:o==="<<="?c.value<<=s.value:o===">>="?c.value>>=s.value:console.error(`Invalid operator ${o}. Line ${e.line}`)}return void(n instanceof js&&n.setDataValue(this,c,a,r))}if(n instanceof js)n.setDataValue(this,s,a,r);else if(a){if(!(n instanceof kt||n instanceof Ii))return void console.error(`Variable ${i} is not a vector or matrix. Line ${e.line}`);if(a instanceof r_){const c=this.evalExpression(a.index,r).value;if(n instanceof kt){if(!(s instanceof ir))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[c]=s.value}else{if(!(n instanceof Ii))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const h=this.evalExpression(a.index,r).value;if(h<0)return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(s instanceof kt))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const d=n.typeInfo.getTypeName();if(d==="mat2x2"||d==="mat2x2f"||d==="mat2x2h"){if(!(h<2&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*h]=s.data[0],n.data[2*h+1]=s.data[1]}else if(d==="mat2x3"||d==="mat2x3f"||d==="mat2x3h"){if(!(h<2&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*h]=s.data[0],n.data[3*h+1]=s.data[1],n.data[3*h+2]=s.data[2]}else if(d==="mat2x4"||d==="mat2x4f"||d==="mat2x4h"){if(!(h<2&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*h]=s.data[0],n.data[4*h+1]=s.data[1],n.data[4*h+2]=s.data[2],n.data[4*h+3]=s.data[3]}else if(d==="mat3x2"||d==="mat3x2f"||d==="mat3x2h"){if(!(h<3&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*h]=s.data[0],n.data[2*h+1]=s.data[1]}else if(d==="mat3x3"||d==="mat3x3f"||d==="mat3x3h"){if(!(h<3&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*h]=s.data[0],n.data[3*h+1]=s.data[1],n.data[3*h+2]=s.data[2]}else if(d==="mat3x4"||d==="mat3x4f"||d==="mat3x4h"){if(!(h<3&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*h]=s.data[0],n.data[4*h+1]=s.data[1],n.data[4*h+2]=s.data[2],n.data[4*h+3]=s.data[3]}else if(d==="mat4x2"||d==="mat4x2f"||d==="mat4x2h"){if(!(h<4&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*h]=s.data[0],n.data[2*h+1]=s.data[1]}else if(d==="mat4x3"||d==="mat4x3f"||d==="mat4x3h"){if(!(h<4&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*h]=s.data[0],n.data[3*h+1]=s.data[1],n.data[3*h+2]=s.data[2]}else{if(d!=="mat4x4"&&d!=="mat4x4f"&&d!=="mat4x4h")return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(h<4&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*h]=s.data[0],n.data[4*h+1]=s.data[1],n.data[4*h+2]=s.data[2],n.data[4*h+3]=s.data[3]}}}}}else if(a instanceof gy){const c=a.value;if(!(n instanceof kt))return void console.error(`Invalid assignment to ${c}. Variable ${i} is not a vector. Line ${e.line}`);if(s instanceof ir){if(c.length>1)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);if(c==="x")n.data[0]=s.value;else if(c==="y"){if(n.data.length<2)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);n.data[1]=s.value}else if(c==="z"){if(n.data.length<3)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);n.data[2]=s.value}else if(c==="w"){if(n.data.length<4)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);n.data[3]=s.value}}else{if(!(s instanceof kt))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(c.length!==s.data.length)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);for(let h=0;h<c.length;++h){const d=c[h];if(d==="x"||d==="r")n.data[0]=s.data[h];else if(d==="y"||d==="g"){if(s.data.length<2)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);n.data[1]=s.data[h]}else if(d==="z"||d==="b"){if(s.data.length<3)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);n.data[2]=s.data[h]}else{if(d!=="w"&&d!=="a")return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);if(s.data.length<4)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);n.data[3]=s.data[h]}}}}}else n instanceof ir&&s instanceof ir?n.value=s.value:n instanceof kt&&s instanceof kt||n instanceof Ii&&s instanceof Ii?n.data.set(s.data):console.error(`Invalid assignment to ${i}. Line ${e.line}`)}_function(e,r){const n=new e6(e);r.functions.set(e.name,n)}_const(e,r){let n=null;e.value!==null&&(n=this.evalExpression(e.value,r)),r.createVariable(e.name,n,e)}_let(e,r){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,r),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof wl||(n=n.clone())}else{const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||i==="array"){const a=new od(e.type,[]);n=this._evalCreate(a,r)}}r.createVariable(e.name,n,e)}_var(e,r){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,r),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof wl||(n=n.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||e.type instanceof Tb||e.type instanceof op||e.type instanceof cr){const a=new od(e.type,[]);n=this._evalCreate(a,r)}}r.createVariable(e.name,n,e)}_switch(e,r){r=r.clone();const n=this.evalExpression(e.condition,r);if(!(n instanceof ir))return console.error(`Invalid if condition. Line ${e.line}`),null;let i=null;for(const a of e.cases)if(a instanceof Pre)for(const s of a.selectors){if(s instanceof MS){i=a;continue}const o=this.evalExpression(s,r);if(!(o instanceof ir))return console.error(`Invalid case selector. Line ${e.line}`),null;if(o.value===n.value)return this._execStatements(a.body,r)}else a instanceof kre&&(i=a);return i?this._execStatements(i.body,r):null}_if(e,r){r=r.clone();const n=this.evalExpression(e.condition,r);if(!(n instanceof ir))return console.error(`Invalid if condition. Line ${e.line}`),null;if(n.value)return this._execStatements(e.body,r);for(const i of e.elseif){const a=this.evalExpression(i.condition,r);if(!(a instanceof ir))return console.error(`Invalid if condition. Line ${e.line}`),null;if(a.value)return this._execStatements(i.body,r)}return e.else?this._execStatements(e.else,r):null}_getScalarValue(e){return e instanceof ir?e.value:(console.error("Expected scalar value.",e),0)}_for(e,r){for(r=r.clone(),this.execStatement(e.init,r);this._getScalarValue(this.evalExpression(e.condition,r));){const n=this._execStatements(e.body,r);if(n===Ju._breakObj)break;if(n!==null&&n!==Ju._continueObj)return n;this.execStatement(e.increment,r)}return null}_loop(e,r){for(r=r.clone();;){const n=this._execStatements(e.body,r);if(n===Ju._breakObj)break;if(n===Ju._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,r)===Ju._breakObj)break}else if(n!==null)return n}return null}_while(e,r){for(r=r.clone();this._getScalarValue(this.evalExpression(e.condition,r));){const n=this._execStatements(e.body,r);if(n===Ju._breakObj)break;if(n!==Ju._continueObj&&n!==null)return n}return null}_evalBitcast(e,r){const n=this.evalExpression(e.value,r),i=e.type;if(n instanceof ir){const a=EW(n.value,n.typeInfo.name,i.name);return new ir(a,this.getTypeInfo(i))}if(n instanceof kt){const a=n.typeInfo.getTypeName();let s="";if(a.endsWith("f"))s="f32";else if(a.endsWith("i"))s="i32";else if(a.endsWith("u"))s="u32";else if(a.endsWith("b"))s="bool";else{if(!a.endsWith("h"))return console.error(`Unknown vector type ${a}. Line ${e.line}`),null;s="f16"}const o=i.getTypeName();let c="";if(o.endsWith("f"))c="f32";else if(o.endsWith("i"))c="i32";else if(o.endsWith("u"))c="u32";else if(o.endsWith("b"))c="bool";else{if(!o.endsWith("h"))return console.error(`Unknown vector type ${c}. Line ${e.line}`),null;c="f16"}const h=(function(d,m,b){if(m===b)return d;const x=new Array(d.length);for(let E=0;E<d.length;E++)x[E]=EW(d[E],m,b);return x})(Array.from(n.data),s,c);return new kt(h,this.getTypeInfo(i))}return console.error(`TODO: bitcast for ${n.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,r){return r.getVariableValue(e.name).clone().getSubData(this,e.postfix,r)}_evalCreate(e,r){var n;if(e instanceof od){if(e.type===null)return tD.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,r);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,r);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,r)}}const i=e instanceof od?e.type.name:e.name,a=e instanceof od?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(a===null)return console.error(`Unknown type ${i}. Line ${e.line}`),null;if(a.size===0)return null;const s=new js(new ArrayBuffer(a.size),a,0);if(a instanceof mg){if(e.args)for(let o=0;o<e.args.length;++o){const c=a.members[o],h=e.args[o],d=this.evalExpression(h,r);s.setData(this,d,c.type,c.offset,r)}}else if(a instanceof wg){let o=0;if(e.args)for(let c=0;c<e.args.length;++c){const h=e.args[c],d=this.evalExpression(h,r);a.format===null&&(((n=d.typeInfo)===null||n===void 0?void 0:n.name)==="x32"?a.format=this.getTypeInfo("i32"):a.format=d.typeInfo),s.setData(this,d,a.format,o,r),o+=a.stride}}else console.error(`Unknown type "${i}". Line ${e.line}`);return e instanceof od?s.getSubData(this,e.postfix,r):s}_evalLiteral(e,r){const n=this.getTypeInfo(e.type),i=n.name;return i==="x32"||i==="u32"||i==="f32"||i==="f16"||i==="i32"||i==="bool"?new ir(e.scalarValue,n):i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"?this._callConstructorVec(e,r):i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"?this._callConstructorMatrix(e,r):e.value}_evalVariable(e,r){const n=r.getVariableValue(e.name);return n===null?n:n.getSubData(this,e.postfix,r)}_maxFormatTypeInfo(e){let r=e[0];if(r.name==="f32")return r;for(let n=1;n<e.length;++n){const i=Ju._priority.get(r.name);Ju._priority.get(e[n].name)<i&&(r=e[n])}return r.name==="x32"?this.getTypeInfo("i32"):r}_evalUnaryOp(e,r){const n=this.evalExpression(e.right,r);if(e.operator==="&")return new Pv(n);if(e.operator==="*")return n instanceof Pv?n.reference.getSubData(this,e.postfix,r):(console.error(`Invalid dereference. Line ${e.line}`),null);const i=n instanceof ir?n.value:n instanceof kt?Array.from(n.data):null;switch(e.operator){case"+":{if(On(i)){const o=i.map((c,h)=>+c);return new kt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(+a,s)}case"-":{if(On(i)){const o=i.map((c,h)=>-c);return new kt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(-a,s)}case"!":{if(On(i)){const o=i.map((c,h)=>c?0:1);return new kt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(a?0:1,s)}case"~":{if(On(i)){const o=i.map((c,h)=>~c);return new kt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(~a,s)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,r){const n=this.evalExpression(e.left,r),i=this.evalExpression(e.right,r),a=n instanceof ir?n.value:n instanceof kt||n instanceof Ii?Array.from(n.data):null,s=i instanceof ir?i.value:i instanceof kt||i instanceof Ii?Array.from(i.data):null;switch(e.operator){case"+":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x+m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b+d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d+b);return new kt(m,i.typeInfo)}const o=a,c=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o+c,h)}case"-":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x-m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b-d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d-b);return new kt(m,i.typeInfo)}const o=a,c=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o-c,h)}case"*":{if(On(a)&&On(s)){const d=a,m=s;if(n instanceof Ii&&i instanceof Ii){const b=(function(A,M,F,N){if(dc[M.name]===void 0||dc[N.name]===void 0)return null;const O=dc[M.name][0],U=dc[M.name][1],j=dc[N.name][0];if(O!==dc[N.name][1])return null;const H=new Array(j*U);for(let G=0;G<U;G++)for(let X=0;X<j;X++){let ae=0;for(let Q=0;Q<O;Q++)ae+=A[Q*U+G]*F[X*O+Q];H[G*j+X]=ae}return H})(d,n.typeInfo,m,i.typeInfo);if(b===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const x=dc[i.typeInfo.name][0],E=dc[n.typeInfo.name][1],T=this.getTypeInfo(`mat${x}x${E}f`);return new Ii(b,T)}if(n instanceof Ii&&i instanceof kt){const b=(function(x,E,T,A){if(dc[E.name]===void 0||HP[A.name]===void 0)return null;const M=dc[E.name][0],F=dc[E.name][1];if(M!==T.length)return null;const N=new Array(F);for(let O=0;O<F;O++){let U=0;for(let j=0;j<M;j++)U+=x[j*F+O]*T[j];N[O]=U}return N})(d,n.typeInfo,m,i.typeInfo);return b===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new kt(b,i.typeInfo)}if(n instanceof kt&&i instanceof Ii){const b=(function(x,E,T,A){if(HP[E.name]===void 0||dc[A.name]===void 0)return null;const M=dc[A.name][0],F=dc[A.name][1];if(F!==x.length)return null;const N=[];for(let O=0;O<M;O++){let U=0;for(let j=0;j<F;j++)U+=x[j]*T[j*M+O];N[O]=U}return N})(d,n.typeInfo,m,i.typeInfo);return b===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new kt(b,n.typeInfo)}{if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x*m[E]);return new kt(b,n.typeInfo)}}if(On(a)){const d=s,m=a.map((b,x)=>b*d);return n instanceof Ii?new Ii(m,n.typeInfo):new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d*b);return i instanceof Ii?new Ii(m,i.typeInfo):new kt(m,i.typeInfo)}const o=a,c=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o*c,h)}case"%":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x%m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b%d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d%b);return new kt(m,i.typeInfo)}const o=a,c=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o%c,h)}case"/":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x/m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b/d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d/b);return new kt(m,i.typeInfo)}const o=a,c=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o/c,h)}case"&":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x&m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b&d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d&b);return new kt(m,i.typeInfo)}const o=a,c=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o&c,h)}case"|":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x|m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b|d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d|b);return new kt(m,i.typeInfo)}const o=a,c=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o|c,h)}case"^":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x^m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b^d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d^b);return new kt(m,i.typeInfo)}const o=a,c=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o^c,h)}case"<<":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x<<m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b<<d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d<<b);return new kt(m,i.typeInfo)}const o=a,c=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o<<c,h)}case">>":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x>>m[E]);return new kt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b>>d);return new kt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d>>b);return new kt(m,i.typeInfo)}const o=a,c=s,h=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o>>c,h)}case">":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((d,m)=>d>c[m]?1:0);return new kt(h,n.typeInfo)}if(On(a)){const o=s,c=a.map((h,d)=>h>o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((h,d)=>o>h?1:0);return new kt(c,i.typeInfo)}return new ir(a>s?1:0,this.getTypeInfo("bool"));case"<":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((d,m)=>d<c[m]?1:0);return new kt(h,n.typeInfo)}if(On(a)){const o=s,c=a.map((h,d)=>h<o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((h,d)=>o<h?1:0);return new kt(c,i.typeInfo)}return new ir(a<s?1:0,this.getTypeInfo("bool"));case"==":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((d,m)=>d===c[m]?1:0);return new kt(h,n.typeInfo)}if(On(a)){const o=s,c=a.map((h,d)=>h==o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((h,d)=>o==h?1:0);return new kt(c,i.typeInfo)}return new ir(a===s?1:0,this.getTypeInfo("bool"));case"!=":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((d,m)=>d!==c[m]?1:0);return new kt(h,n.typeInfo)}if(On(a)){const o=s,c=a.map((h,d)=>h!==o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((h,d)=>o!==h?1:0);return new kt(c,i.typeInfo)}return new ir(a!==s?1:0,this.getTypeInfo("bool"));case">=":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((d,m)=>d>=c[m]?1:0);return new kt(h,n.typeInfo)}if(On(a)){const o=s,c=a.map((h,d)=>h>=o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((h,d)=>o>=h?1:0);return new kt(c,i.typeInfo)}return new ir(a>=s?1:0,this.getTypeInfo("bool"));case"<=":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((d,m)=>d<=c[m]?1:0);return new kt(h,n.typeInfo)}if(On(a)){const o=s,c=a.map((h,d)=>h<=o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((h,d)=>o<=h?1:0);return new kt(c,i.typeInfo)}return new ir(a<=s?1:0,this.getTypeInfo("bool"));case"&&":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((d,m)=>d&&c[m]?1:0);return new kt(h,n.typeInfo)}if(On(a)){const o=s,c=a.map((h,d)=>h&&o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((h,d)=>o&&h?1:0);return new kt(c,i.typeInfo)}return new ir(a&&s?1:0,this.getTypeInfo("bool"));case"||":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const h=o.map((d,m)=>d||c[m]?1:0);return new kt(h,n.typeInfo)}if(On(a)){const o=s,c=a.map((h,d)=>h||o?1:0);return new kt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((h,d)=>o||h?1:0);return new kt(c,i.typeInfo)}return new ir(a||s?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,r){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const n=r.clone();n.currentFunctionName=e.name;const i=r.getFunction(e.name);if(!i)return e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)?this._evalCreate(e,r):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let a=0;a<i.node.args.length;++a){const s=i.node.args[a],o=this.evalExpression(e.args[a],n);n.createVariable(s.name,o,s)}return this._execStatements(i.node.body,n)}_callBuiltinFunction(e,r){switch(e.name){case"all":return this.builtins.All(e,r);case"any":return this.builtins.Any(e,r);case"select":return this.builtins.Select(e,r);case"arrayLength":return this.builtins.ArrayLength(e,r);case"abs":return this.builtins.Abs(e,r);case"acos":return this.builtins.Acos(e,r);case"acosh":return this.builtins.Acosh(e,r);case"asin":return this.builtins.Asin(e,r);case"asinh":return this.builtins.Asinh(e,r);case"atan":return this.builtins.Atan(e,r);case"atanh":return this.builtins.Atanh(e,r);case"atan2":return this.builtins.Atan2(e,r);case"ceil":return this.builtins.Ceil(e,r);case"clamp":return this.builtins.Clamp(e,r);case"cos":return this.builtins.Cos(e,r);case"cosh":return this.builtins.Cosh(e,r);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,r);case"countOneBits":return this.builtins.CountOneBits(e,r);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,r);case"cross":return this.builtins.Cross(e,r);case"degrees":return this.builtins.Degrees(e,r);case"determinant":return this.builtins.Determinant(e,r);case"distance":return this.builtins.Distance(e,r);case"dot":return this.builtins.Dot(e,r);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,r);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,r);case"exp":return this.builtins.Exp(e,r);case"exp2":return this.builtins.Exp2(e,r);case"extractBits":return this.builtins.ExtractBits(e,r);case"faceForward":return this.builtins.FaceForward(e,r);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,r);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,r);case"floor":return this.builtins.Floor(e,r);case"fma":return this.builtins.Fma(e,r);case"fract":return this.builtins.Fract(e,r);case"frexp":return this.builtins.Frexp(e,r);case"insertBits":return this.builtins.InsertBits(e,r);case"inverseSqrt":return this.builtins.InverseSqrt(e,r);case"ldexp":return this.builtins.Ldexp(e,r);case"length":return this.builtins.Length(e,r);case"log":return this.builtins.Log(e,r);case"log2":return this.builtins.Log2(e,r);case"max":return this.builtins.Max(e,r);case"min":return this.builtins.Min(e,r);case"mix":return this.builtins.Mix(e,r);case"modf":return this.builtins.Modf(e,r);case"normalize":return this.builtins.Normalize(e,r);case"pow":return this.builtins.Pow(e,r);case"quantizeToF16":return this.builtins.QuantizeToF16(e,r);case"radians":return this.builtins.Radians(e,r);case"reflect":return this.builtins.Reflect(e,r);case"refract":return this.builtins.Refract(e,r);case"reverseBits":return this.builtins.ReverseBits(e,r);case"round":return this.builtins.Round(e,r);case"saturate":return this.builtins.Saturate(e,r);case"sign":return this.builtins.Sign(e,r);case"sin":return this.builtins.Sin(e,r);case"sinh":return this.builtins.Sinh(e,r);case"smoothstep":return this.builtins.SmoothStep(e,r);case"sqrt":return this.builtins.Sqrt(e,r);case"step":return this.builtins.Step(e,r);case"tan":return this.builtins.Tan(e,r);case"tanh":return this.builtins.Tanh(e,r);case"transpose":return this.builtins.Transpose(e,r);case"trunc":return this.builtins.Trunc(e,r);case"dpdx":return this.builtins.Dpdx(e,r);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,r);case"dpdxFine":return this.builtins.DpdxFine(e,r);case"dpdy":return this.builtins.Dpdy(e,r);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,r);case"dpdyFine":return this.builtins.DpdyFine(e,r);case"fwidth":return this.builtins.Fwidth(e,r);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,r);case"fwidthFine":return this.builtins.FwidthFine(e,r);case"textureDimensions":return this.builtins.TextureDimensions(e,r);case"textureGather":return this.builtins.TextureGather(e,r);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,r);case"textureLoad":return this.builtins.TextureLoad(e,r);case"textureNumLayers":return this.builtins.TextureNumLayers(e,r);case"textureNumLevels":return this.builtins.TextureNumLevels(e,r);case"textureNumSamples":return this.builtins.TextureNumSamples(e,r);case"textureSample":return this.builtins.TextureSample(e,r);case"textureSampleBias":return this.builtins.TextureSampleBias(e,r);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,r);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,r);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,r);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,r);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,r);case"textureStore":return this.builtins.TextureStore(e,r);case"atomicLoad":return this.builtins.AtomicLoad(e,r);case"atomicStore":return this.builtins.AtomicStore(e,r);case"atomicAdd":return this.builtins.AtomicAdd(e,r);case"atomicSub":return this.builtins.AtomicSub(e,r);case"atomicMax":return this.builtins.AtomicMax(e,r);case"atomicMin":return this.builtins.AtomicMin(e,r);case"atomicAnd":return this.builtins.AtomicAnd(e,r);case"atomicOr":return this.builtins.AtomicOr(e,r);case"atomicXor":return this.builtins.AtomicXor(e,r);case"atomicExchange":return this.builtins.AtomicExchange(e,r);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,r);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,r);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,r);case"pack4xI8":return this.builtins.Pack4xI8(e,r);case"pack4xU8":return this.builtins.Pack4xU8(e,r);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,r);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,r);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,r);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,r);case"pack2x16float":return this.builtins.Pack2x16float(e,r);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,r);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,r);case"unpack4xI8":return this.builtins.Unpack4xI8(e,r);case"unpack4xU8":return this.builtins.Unpack4xU8(e,r);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,r);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,r);case"unpack2x16float":return this.builtins.Unpack2x16float(e,r);case"storageBarrier":return this.builtins.StorageBarrier(e,r);case"textureBarrier":return this.builtins.TextureBarrier(e,r);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,r);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,r);case"subgroupAdd":return this.builtins.SubgroupAdd(e,r);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,r);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,r);case"subgroupAll":return this.builtins.SubgroupAll(e,r);case"subgroupAnd":return this.builtins.SubgroupAnd(e,r);case"subgroupAny":return this.builtins.SubgroupAny(e,r);case"subgroupBallot":return this.builtins.SubgroupBallot(e,r);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,r);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,r);case"subgroupElect":return this.builtins.SubgroupElect(e,r);case"subgroupMax":return this.builtins.SubgroupMax(e,r);case"subgroupMin":return this.builtins.SubgroupMin(e,r);case"subgroupMul":return this.builtins.SubgroupMul(e,r);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,r);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,r);case"subgroupOr":return this.builtins.SubgroupOr(e,r);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,r);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,r);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,r);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,r);case"subgroupXor":return this.builtins.SubgroupXor(e,r);case"quadBroadcast":return this.builtins.QuadBroadcast(e,r);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,r);case"quadSwapX":return this.builtins.QuadSwapX(e,r);case"quadSwapY":return this.builtins.QuadSwapY(e,r)}const n=r.getFunction(e.name);if(n){const i=r.clone();for(let a=0;a<n.node.args.length;++a){const s=n.node.args[a],o=this.evalExpression(e.args[a],i);i.setVariable(s.name,o,s)}return this._execStatements(n.node.body,i)}return null}_callConstructorValue(e,r){if(!e.args||e.args.length===0)return new ir(0,this.getTypeInfo(e.type));const n=this.evalExpression(e.args[0],r);return n.typeInfo=this.getTypeInfo(e.type),n.getSubData(this,e.postfix,r).clone()}_callConstructorVec(e,r){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=HP[i];if(a===void 0)return console.error(`Invalid vec constructor ${i}. Line ${e.line}`),null;const s=[];if(e instanceof Ol)if(e.isVector){const o=e.vectorValue;for(const c of o)s.push(c)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const c=this.evalExpression(o,r);if(c instanceof kt){const h=c.data;for(let d=0;d<h.length;++d){let m=h[d];s.push(m)}}else if(c instanceof ir){let h=c.value;s.push(h)}}if(e.type instanceof cr&&e.type.format===null&&(e.type.format=cr.f32),s.length===0){const o=new Array(a).fill(0);return new kt(o,n).getSubData(this,e.postfix,r)}if(s.length===1)for(;s.length<a;)s.push(s[0]);return s.length<a?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new kt(s.length>a?s.slice(0,a):s,n).getSubData(this,e.postfix,r)}_callConstructorMatrix(e,r){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=dc[i];if(a===void 0)return console.error(`Invalid matrix constructor ${i}. Line ${e.line}`),null;const s=[];if(e instanceof Ol)if(e.isVector){const o=e.vectorValue;for(const c of o)s.push(c)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const c=this.evalExpression(o,r);c instanceof kt?s.push(...c.data):c instanceof ir?s.push(c.value):c instanceof Ii&&s.push(...c.data)}if(n instanceof py&&n.format===null&&(n.format=this.getTypeInfo("f32")),s.length===0){const o=new Array(a[2]).fill(0);return new Ii(o,n).getSubData(this,e.postfix,r)}return s.length!==a[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new Ii(s,n).getSubData(this,e.postfix,r)}}Ju._breakObj=new Yh(new zh("BREAK",null),null),Ju._continueObj=new Yh(new zh("CONTINUE",null),null),Ju._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class u7e{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class c7e{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new u7e,this._exec=new Ju,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const r=[];for(;!this._isAtEnd();){const n=this._global_decl_or_directive();if(!n)break;r.push(n)}if(this._deferArrayCountEval.length>0){for(const n of this._deferArrayCountEval){const i=n.arrayType,a=n.countNode;if(a instanceof rh){const s=a.name,o=this._context.constants.get(s);if(o)try{const c=o.constEvaluate(this._exec);i.count=c}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const n of r)n.search(i=>{i instanceof wW||i instanceof RS?i.type=this._forwardType(i.type):i instanceof Tb?i.format=this._forwardType(i.format):i instanceof cp||i instanceof Eb||i instanceof kS?i.type=this._forwardType(i.type):i instanceof fx?i.returnType=this._forwardType(i.returnType):i instanceof xW&&(i.type=this._forwardType(i.type))});return r}_forwardType(e){if(e instanceof bW){const r=this._getType(e.name);if(r)return r}else e instanceof RS?e.type=this._forwardType(e.type):e instanceof Tb&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const r=new Q9e(e);this._tokens=r.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,r){return e.line=r??this._currentLine,e}_error(e,r){return{token:e,message:r,toString:()=>`${r}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==vt.eof}_match(e){if(e instanceof or)return!!this._check(e)&&(this._advance(),!0);for(let r=0,n=e.length;r<n;++r){const i=e[r];if(this._check(i))return this._advance(),!0}return!1}_consume(e,r){if(this._check(e))return this._advance();throw this._error(this._peek(),`${r}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const r=this._peek();if(e instanceof Array){const n=r.type;let i=!1;for(const a of e){if(n===a)return!0;a===vt.tokens.name&&(i=!0)}if(i){const a=vt.tokens.name.rule.exec(r.lexeme);if(a&&a.index==0&&a[0]==r.lexeme)return!0}return!1}if(r.type===e)return!0;if(e===vt.tokens.name){const n=vt.tokens.name.rule.exec(r.lexeme);return n&&n.index==0&&n[0]==r.lexeme}return!1}_advance(){var e,r;return this._currentLine=(r=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&r!==void 0?r:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(vt.tokens.semicolon)&&!this._isAtEnd(););if(this._match(vt.keywords.alias)){const r=this._type_alias();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(vt.keywords.diagnostic)){const r=this._diagnostic();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(vt.keywords.requires)){const r=this._requires_directive();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(vt.keywords.enable)){const r=this._enable_directive();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}const e=this._attribute();if(this._check(vt.keywords.var)){const r=this._global_variable_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.override)){const r=this._override_variable_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.let)){const r=this._global_let_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.const)){const r=this._global_const_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.struct)){const r=this._struct_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.fn)){const r=this._function_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}return null}_function_decl(){if(!this._match(vt.keywords.fn))return null;const e=this._currentLine,r=this._consume(vt.tokens.ident,"Expected function name.").toString();this._consume(vt.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(vt.tokens.paren_right))do{if(this._check(vt.tokens.paren_right))break;const o=this._attribute(),c=this._consume(vt.tokens.name,"Expected argument name.").toString();this._consume(vt.tokens.colon,"Expected ':' for argument type.");const h=this._attribute(),d=this._type_decl();d!=null&&(d.attributes=h,n.push(this._updateNode(new xW(c,d,o))))}while(this._match(vt.tokens.comma));this._consume(vt.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(vt.tokens.arrow)){const o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}const a=this._compound_statement(),s=this._currentLine;return this._updateNode(new fx(r,n,i,a,e,s),e)}_compound_statement(){const e=[];for(this._consume(vt.tokens.brace_left,"Expected '{' for block.");!this._check(vt.tokens.brace_right);){const r=this._statement();r!==null&&e.push(r)}return this._consume(vt.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(vt.tokens.semicolon)&&!this._isAtEnd(););if(this._check(vt.tokens.attr)&&this._attribute(),this._check(vt.keywords.if))return this._if_statement();if(this._check(vt.keywords.switch))return this._switch_statement();if(this._check(vt.keywords.loop))return this._loop_statement();if(this._check(vt.keywords.for))return this._for_statement();if(this._check(vt.keywords.while))return this._while_statement();if(this._check(vt.keywords.continuing))return this._continuing_statement();if(this._check(vt.keywords.static_assert))return this._static_assert_statement();if(this._check(vt.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(vt.keywords.return))e=this._return_statement();else if(this._check([vt.keywords.var,vt.keywords.let,vt.keywords.const]))e=this._variable_statement();else if(this._match(vt.keywords.discard))e=this._updateNode(new Z9e);else if(this._match(vt.keywords.break)){const r=this._updateNode(new Sre);if(this._currentLoop.length>0){const n=this._currentLoop[this._currentLoop.length-1];r.loopId=n.id}e=r,this._check(vt.keywords.if)&&(this._advance(),r.condition=this._optional_paren_expression())}else if(this._match(vt.keywords.continue)){const r=this._updateNode(new Ere);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${r.line}`);{const n=this._currentLoop[this._currentLoop.length-1];r.loopId=n.id}e=r}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(vt.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(vt.keywords.static_assert))return null;const e=this._currentLine,r=this._optional_paren_expression();return this._updateNode(new G9e(r),e)}_while_statement(){if(!this._match(vt.keywords.while))return null;const e=this._updateNode(new pre(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(vt.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(vt.keywords.continuing))return null;const r=this._currentLine,n=this._compound_statement();return this._updateNode(new eD(n,e),r)}_for_statement(){if(!this._match(vt.keywords.for))return null;this._consume(vt.tokens.paren_left,"Expected '('.");const e=this._updateNode(new gre(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(vt.tokens.semicolon)?null:this._for_init(),this._consume(vt.tokens.semicolon,"Expected ';'."),e.condition=this._check(vt.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(vt.tokens.semicolon,"Expected ';'."),e.increment=this._check(vt.tokens.paren_right)?null:this._for_increment(),this._consume(vt.tokens.paren_right,"Expected ')'."),this._check(vt.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(vt.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let r=null;return this._match(vt.tokens.equal)&&(r=this._short_circuit_or_expression()),this._updateNode(new cp(e.name,e.type,e.storage,e.access,r),e.line)}if(this._match(vt.keywords.let)){const e=this._currentLine,r=this._consume(vt.tokens.name,"Expected name for let.").toString();let n=null;if(this._match(vt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}this._consume(vt.tokens.equal,"Expected '=' for let.");const i=this._short_circuit_or_expression();return this._updateNode(new Eb(r,n,null,null,i),e)}if(this._match(vt.keywords.const)){const e=this._currentLine,r=this._consume(vt.tokens.name,"Expected name for const.").toString();let n=null;if(this._match(vt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}this._consume(vt.tokens.equal,"Expected '=' for const.");const i=this._short_circuit_or_expression();return n===null&&i instanceof Ol&&(n=i.type),this._updateNode(new kS(r,n,null,null,i),e)}return null}_increment_decrement_statement(){const e=this._current,r=this._unary_expression();if(r==null)return null;if(!this._check(vt.increment_operators))return this._current=e,null;const n=this._consume(vt.increment_operators,"Expected increment operator");return this._updateNode(new mre(n.type===vt.tokens.plus_plus?d0.increment:d0.decrement,r))}_assignment_statement(){let e=null;const r=this._currentLine;if(this._check(vt.tokens.brace_right))return null;let n=this._match(vt.tokens.underscore);if(n||(e=this._unary_expression()),!n&&e==null)return null;const i=this._consume(vt.assignment_operators,"Expected assignment operator."),a=this._short_circuit_or_expression();return this._updateNode(new yre(J1.parse(i.lexeme),e,a),r)}_func_call_statement(){if(!this._check(vt.tokens.ident))return null;const e=this._currentLine,r=this._current,n=this._consume(vt.tokens.ident,"Expected function name."),i=this._argument_expression_list();return i===null?(this._current=r,null):this._updateNode(new YL(n.lexeme,i),e)}_loop_statement(){if(!this._match(vt.keywords.loop))return null;this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new vre([],null));this._currentLoop.push(e);let r=this._statement();for(;r!==null;){if(Array.isArray(r))for(let n of r)e.body.push(n);else e.body.push(r);if(r instanceof eD){e.continuing=r;break}r=this._statement()}return this._currentLoop.pop(),this._consume(vt.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(vt.keywords.switch))return null;const e=this._updateNode(new _re(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(vt.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let r=!1;for(;this._check([vt.keywords.default,vt.keywords.case]);){if(this._match(vt.keywords.case)){const n=this._case_selectors();for(const a of n)if(a instanceof MS){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");r=!0;break}this._match(vt.tokens.colon),this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Exected '{' for switch case.");const i=this._case_body();this._consume(vt.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new Pre(n,i)))}if(this._match(vt.keywords.default)){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(vt.tokens.colon),this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(vt.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new kre(n)))}}return e}_case_selectors(){const e=[];for(this._match(vt.keywords.default)?e.push(this._updateNode(new MS)):e.push(this._shift_expression());this._match(vt.tokens.comma);)this._match(vt.keywords.default)?e.push(this._updateNode(new MS)):e.push(this._shift_expression());return e}_case_body(){if(this._match(vt.keywords.fallthrough))return this._consume(vt.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const r=this._case_body();return r.length==0?e:[...e,r[0]]}_if_statement(){if(!this._match(vt.keywords.if))return null;const e=this._currentLine,r=this._optional_paren_expression();this._check(vt.tokens.attr)&&this._attribute();const n=this._compound_statement();let i=[];this._match_elseif()&&(this._check(vt.tokens.attr)&&this._attribute(),i=this._elseif_statement(i));let a=null;return this._match(vt.keywords.else)&&(this._check(vt.tokens.attr)&&this._attribute(),a=this._compound_statement()),this._updateNode(new bre(r,n,i,a),e)}_match_elseif(){return this._tokens[this._current].type===vt.keywords.else&&this._tokens[this._current+1].type===vt.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const r=this._optional_paren_expression(),n=this._compound_statement();return e.push(this._updateNode(new K9e(r,n))),this._match_elseif()&&(this._check(vt.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(vt.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new xre(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(vt.tokens.or_or);)e=this._updateNode(new mf(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(vt.tokens.and_and);)e=this._updateNode(new mf(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(vt.tokens.or);)e=this._updateNode(new mf(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(vt.tokens.xor);)e=this._updateNode(new mf(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(vt.tokens.and);)e=this._updateNode(new mf(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([vt.tokens.equal_equal,vt.tokens.not_equal])?this._updateNode(new mf(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([vt.tokens.less_than,vt.tokens.greater_than,vt.tokens.less_than_equal,vt.tokens.greater_than_equal]);)e=this._updateNode(new mf(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([vt.tokens.shift_left,vt.tokens.shift_right]);)e=this._updateNode(new mf(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([vt.tokens.plus,vt.tokens.minus]);)e=this._updateNode(new mf(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([vt.tokens.star,vt.tokens.forward_slash,vt.tokens.modulo]);)e=this._updateNode(new mf(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([vt.tokens.minus,vt.tokens.bang,vt.tokens.tilde,vt.tokens.star,vt.tokens.and])?this._updateNode(new wl(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),r=this._postfix_expression();return r&&(e.postfix=r),e}_postfix_expression(){if(this._match(vt.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(vt.tokens.bracket_right,"Expected ']'.");const r=this._updateNode(new r_(e)),n=this._postfix_expression();return n&&(r.postfix=n),r}if(this._match(vt.tokens.period)){const e=this._consume(vt.tokens.name,"Expected member name."),r=this._postfix_expression(),n=this._updateNode(new gy(e.lexeme));return r&&(n.postfix=r),n}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const r=this._getStruct(e);if(r!==null)return r;switch(e){case"void":return Kr.void;case"bool":return Kr.bool;case"i32":return Kr.i32;case"u32":return Kr.u32;case"f32":return Kr.f32;case"f16":return Kr.f16;case"vec2f":return cr.vec2f;case"vec3f":return cr.vec3f;case"vec4f":return cr.vec4f;case"vec2i":return cr.vec2i;case"vec3i":return cr.vec3i;case"vec4i":return cr.vec4i;case"vec2u":return cr.vec2u;case"vec3u":return cr.vec3u;case"vec4u":return cr.vec4u;case"vec2h":return cr.vec2h;case"vec3h":return cr.vec3h;case"vec4h":return cr.vec4h;case"mat2x2f":return cr.mat2x2f;case"mat2x3f":return cr.mat2x3f;case"mat2x4f":return cr.mat2x4f;case"mat3x2f":return cr.mat3x2f;case"mat3x3f":return cr.mat3x3f;case"mat3x4f":return cr.mat3x4f;case"mat4x2f":return cr.mat4x2f;case"mat4x3f":return cr.mat4x3f;case"mat4x4f":return cr.mat4x4f;case"mat2x2h":return cr.mat2x2h;case"mat2x3h":return cr.mat2x3h;case"mat2x4h":return cr.mat2x4h;case"mat3x2h":return cr.mat3x2h;case"mat3x3h":return cr.mat3x3h;case"mat3x4h":return cr.mat3x4h;case"mat4x2h":return cr.mat4x2h;case"mat4x3h":return cr.mat4x3h;case"mat4x4h":return cr.mat4x4h;case"mat2x2i":return cr.mat2x2i;case"mat2x3i":return cr.mat2x3i;case"mat2x4i":return cr.mat2x4i;case"mat3x2i":return cr.mat3x2i;case"mat3x3i":return cr.mat3x3i;case"mat3x4i":return cr.mat3x4i;case"mat4x2i":return cr.mat4x2i;case"mat4x3i":return cr.mat4x3i;case"mat4x4i":return cr.mat4x4i;case"mat2x2u":return cr.mat2x2u;case"mat2x3u":return cr.mat2x3u;case"mat2x4u":return cr.mat2x4u;case"mat3x2u":return cr.mat3x2u;case"mat3x3u":return cr.mat3x3u;case"mat3x4u":return cr.mat3x4u;case"mat4x2u":return cr.mat4x2u;case"mat4x3u":return cr.mat4x3u;case"mat4x4u":return cr.mat4x4u}return null}_validateTypeRange(e,r){if(r.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(r.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(vt.tokens.ident)){const n=this._previous().toString();if(this._check(vt.tokens.paren_left)){const i=this._argument_expression_list(),a=this._getType(n);return a!==null?this._updateNode(new od(a,i)):this._updateNode(new KL(n,i))}if(this._context.constants.has(n)){const i=this._context.constants.get(n);return this._updateNode(new Tre(n,i.value))}return this._updateNode(new rh(n))}if(this._match(vt.tokens.int_literal)){const n=this._previous().toString();let i=n.endsWith("i")||n.endsWith("i")?Kr.i32:n.endsWith("u")||n.endsWith("U")?Kr.u32:Kr.x32;const a=parseInt(n);return this._validateTypeRange(a,i),this._updateNode(new Ol(new ir(a,this._exec.getTypeInfo(i)),i))}if(this._match(vt.tokens.uint_literal)){const n=parseInt(this._previous().toString());return this._validateTypeRange(n,Kr.u32),this._updateNode(new Ol(new ir(n,this._exec.getTypeInfo(Kr.u32)),Kr.u32))}if(this._match([vt.tokens.decimal_float_literal,vt.tokens.hex_float_literal])){let n=this._previous().toString(),i=n.endsWith("h");i&&(n=n.substring(0,n.length-1));const a=parseFloat(n);this._validateTypeRange(a,i?Kr.f16:Kr.f32);const s=i?Kr.f16:Kr.f32;return this._updateNode(new Ol(new ir(a,this._exec.getTypeInfo(s)),s))}if(this._match([vt.keywords.true,vt.keywords.false])){let n=this._previous().toString()===vt.keywords.true.rule;return this._updateNode(new Ol(new ir(n?1:0,this._exec.getTypeInfo(Kr.bool)),Kr.bool))}if(this._check(vt.tokens.paren_left))return this._paren_expression();if(this._match(vt.keywords.bitcast)){this._consume(vt.tokens.less_than,"Expected '<'.");const n=this._type_decl();this._consume(vt.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return this._updateNode(new Cre(n,i))}const e=this._type_decl(),r=this._argument_expression_list();return this._updateNode(new od(e,r))}_argument_expression_list(){if(!this._match(vt.tokens.paren_left))return null;const e=[];do{if(this._check(vt.tokens.paren_right))break;const r=this._short_circuit_or_expression();e.push(r)}while(this._match(vt.tokens.comma));return this._consume(vt.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(vt.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(vt.tokens.paren_right),e}_paren_expression(){this._consume(vt.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(vt.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(vt.keywords.struct))return null;const e=this._currentLine,r=this._consume(vt.tokens.ident,"Expected name for struct.").toString();this._consume(vt.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(vt.tokens.brace_right);){const s=this._attribute(),o=this._consume(vt.tokens.name,"Expected variable name.").toString();this._consume(vt.tokens.colon,"Expected ':' for struct member type.");const c=this._attribute(),h=this._type_decl();h!=null&&(h.attributes=c),this._check(vt.tokens.brace_right)?this._match(vt.tokens.comma):this._consume(vt.tokens.comma,"Expected ',' for struct member."),n.push(this._updateNode(new wW(o,h,s)))}this._consume(vt.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,a=this._updateNode(new op(r,n,e,i),e);return this._context.structs.set(r,a),a}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(vt.tokens.equal)){const r=this._const_expression();e.value=r}if(e.type!==null&&e.value instanceof Ol){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof Ol&&(e.type=e.value.type.name==="x32"?Kr.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(vt.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(vt.keywords.const))return null;const r=this._consume(vt.tokens.name,"Expected variable name"),n=this._currentLine;let i=null;if(this._match(vt.tokens.colon)){const c=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=c)}let a=null;this._consume(vt.tokens.equal,"const declarations require an assignment");const s=this._short_circuit_or_expression();try{let c=[Kr.f32],h=s.constEvaluate(this._exec,c);h instanceof ir&&this._validateTypeRange(h.value,c[0]),c[0]instanceof cr&&c[0].format===null&&h.typeInfo instanceof py&&h.typeInfo.format!==null&&(h.typeInfo.format.name==="f16"?c[0].format=Kr.f16:h.typeInfo.format.name==="f32"?c[0].format=Kr.f32:h.typeInfo.format.name==="i32"?c[0].format=Kr.i32:h.typeInfo.format.name==="u32"?c[0].format=Kr.u32:h.typeInfo.format.name==="bool"?c[0].format=Kr.bool:console.error(`TODO: impelement template format type ${h.typeInfo.format.name}`)),a=this._updateNode(new Ol(h,c[0])),this._exec.context.setVariable(r.toString(),h)}catch{a=s}if(i!==null&&a instanceof Ol){if(a.type.name!=="x32"&&i.getTypeName()!==a.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${a.type.name} to ${i.name}. Line:${this._currentLine}`);a.type=i,a.isScalar&&this._validateTypeRange(a.scalarValue,a.type)}else i===null&&a instanceof Ol&&(i=(e=a?.type)!==null&&e!==void 0?e:Kr.f32,i===Kr.x32&&(i=Kr.i32));const o=this._updateNode(new kS(r.toString(),i,"","",a),n);return this._context.constants.set(o.name,o),o}_global_let_decl(){if(!this._match(vt.keywords.let))return null;const e=this._currentLine,r=this._consume(vt.tokens.name,"Expected variable name");let n=null;if(this._match(vt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}let i=null;if(this._match(vt.tokens.equal)&&(i=this._const_expression()),n!==null&&i instanceof Ol){if(i.type.name!=="x32"&&n.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${n.name}. Line:${this._currentLine}`);i.type=n}else n===null&&i instanceof Ol&&(n=i.type.name==="x32"?Kr.i32:i.type);return i instanceof Ol&&i.isScalar&&this._validateTypeRange(i.scalarValue,n),this._updateNode(new Eb(r.toString(),n,"","",i),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(vt.keywords.var))return null;const e=this._currentLine;let r="",n="";this._match(vt.tokens.less_than)&&(r=this._consume(vt.storage_class,"Expected storage_class.").toString(),this._match(vt.tokens.comma)&&(n=this._consume(vt.access_mode,"Expected access_mode.").toString()),this._consume(vt.tokens.greater_than,"Expected '>'."));const i=this._consume(vt.tokens.name,"Expected variable name");let a=null;if(this._match(vt.tokens.colon)){const s=this._attribute();a=this._type_decl(),a!=null&&(a.attributes=s)}return this._updateNode(new cp(i.toString(),a,r,n,null),e)}_override_decl(){if(!this._match(vt.keywords.override))return null;const e=this._consume(vt.tokens.name,"Expected variable name");let r=null;if(this._match(vt.tokens.colon)){const n=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=n)}return this._updateNode(new XL(e.toString(),r,null))}_diagnostic(){this._consume(vt.tokens.paren_left,"Expected '('");const e=this._consume(vt.tokens.ident,"Expected severity control name.");this._consume(vt.tokens.comma,"Expected ','");let r=this._consume(vt.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(vt.tokens.period)&&(r+=`.${this._consume(vt.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(vt.tokens.paren_right,"Expected ')'"),this._updateNode(new wre(e.toString(),r))}_enable_directive(){const e=this._consume(vt.tokens.ident,"identity expected.");return this._updateNode(new X9e(e.toString()))}_requires_directive(){const e=[this._consume(vt.tokens.ident,"identity expected.").toString()];for(;this._match(vt.tokens.comma);){const r=this._consume(vt.tokens.ident,"identity expected.");e.push(r.toString())}return this._updateNode(new Y9e(e))}_type_alias(){const e=this._consume(vt.tokens.ident,"identity expected.");this._consume(vt.tokens.equal,"Expected '=' for type alias.");let r=this._type_decl();if(r===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);const n=this._updateNode(new ZL(e.toString(),r));return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([vt.tokens.ident,...vt.texel_format,vt.keywords.bool,vt.keywords.f32,vt.keywords.i32,vt.keywords.u32])){const n=this._advance().toString();if(this._context.structs.has(n))return this._context.structs.get(n);if(this._context.aliases.has(n))return this._context.aliases.get(n).type;if(!this._getType(n)){const i=this._updateNode(new bW(n));return this._forwardTypeCount++,i}return this._updateNode(new Kr(n))}let e=this._texture_sampler_types();if(e)return e;if(this._check(vt.template_types)){let n=this._advance().toString(),i=null,a=null;return this._match(vt.tokens.less_than)&&(i=this._type_decl(),a=null,this._match(vt.tokens.comma)&&(a=this._consume(vt.access_mode,"Expected access_mode for pointer").toString()),this._consume(vt.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new cr(n,i,a))}if(this._match(vt.keywords.ptr)){let n=this._previous().toString();this._consume(vt.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(vt.storage_class,"Expected storage_class for pointer");this._consume(vt.tokens.comma,"Expected ',' for pointer.");const a=this._type_decl();let s=null;return this._match(vt.tokens.comma)&&(s=this._consume(vt.access_mode,"Expected access_mode for pointer").toString()),this._consume(vt.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new RS(n,i.toString(),a,s))}const r=this._attribute();if(this._match(vt.keywords.array)){let n=null,i=-1;const a=this._previous();let s=null;if(this._match(vt.tokens.less_than)){n=this._type_decl(),this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);let c="";if(this._match(vt.tokens.comma)){s=this._shift_expression();try{c=s.constEvaluate(this._exec).toString(),s=null}catch{c="1"}}this._consume(vt.tokens.greater_than,"Expected '>' for array."),i=c?parseInt(c):0}const o=this._updateNode(new Tb(a.toString(),r,n,i));return s&&this._deferArrayCountEval.push({arrayType:o,countNode:s}),o}return null}_texture_sampler_types(){if(this._match(vt.sampler_type))return this._updateNode(new Q1(this._previous().toString(),null,null));if(this._match(vt.depth_texture_type))return this._updateNode(new Q1(this._previous().toString(),null,null));if(this._match(vt.sampled_texture_type)||this._match(vt.multisampled_texture_type)){const e=this._previous();this._consume(vt.tokens.less_than,"Expected '<' for sampler type.");const r=this._type_decl();return this._consume(vt.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new Q1(e.toString(),r,null))}if(this._match(vt.storage_texture_type)){const e=this._previous();this._consume(vt.tokens.less_than,"Expected '<' for sampler type.");const r=this._consume(vt.texel_format,"Invalid texel format.").toString();this._consume(vt.tokens.comma,"Expected ',' after texel format.");const n=this._consume(vt.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(vt.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new Q1(e.toString(),r,n))}return null}_attribute(){let e=[];for(;this._match(vt.tokens.attr);){const r=this._consume(vt.attribute_name,"Expected attribute name"),n=this._updateNode(new Rre(r.toString(),null));if(this._match(vt.tokens.paren_left)){if(n.value=this._consume(vt.literal_or_ident,"Expected attribute value").toString(),this._check(vt.tokens.comma)){this._advance();do{const i=this._consume(vt.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(i)}while(this._match(vt.tokens.comma))}this._consume(vt.tokens.paren_right,"Expected ')'")}e.push(n)}return e.length==0?null:e}}class h7e extends pd{constructor(e){super(),e&&this.update(e)}update(e){const r=new c7e().parse(e);this.updateAST(r)}}function f7e(t){const e={attributes:[],bindings:[]};let r;try{r=d7e(t)}catch(a){return rn.error(a.message)(),e}for(const a of r.uniforms){const s=[];for(const o of a.type?.members||[])s.push({name:o.name,type:TW(o.type)});e.bindings.push({type:"uniform",name:a.name,group:a.group,location:a.binding,members:s})}for(const a of r.textures)e.bindings.push({type:"texture",name:a.name,group:a.group,location:a.binding});for(const a of r.samplers)e.bindings.push({type:"sampler",name:a.name,group:a.group,location:a.binding});const n=r.entry.vertex[0],i=n?.inputs.length||0;for(let a=0;a<i;a++){const s=n.inputs[a];if(s.locationType==="location"){const o=TW(s.type);e.attributes.push({name:s.name,location:Number(s.location),type:o})}}return e}function TW(t){return t?.format?`${t.name}<${t.format.name}>`:t.name}function d7e(t){try{return new h7e(t)}catch(e){if(e instanceof Error)throw e;let r="WGSL parse error";throw typeof e=="object"&&e?.message&&(r+=`: ${e.message} `),typeof e=="object"&&e?.token&&(r+=e.token.line||""),new Error(r,{cause:e})}}const p7e=1/Math.PI*180,g7e=1/180*Math.PI,m7e={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...m7e}};const oh=globalThis.mathgl.config;function y7e(t,{precision:e=oh.precision}={}){return t=b7e(t),`${parseFloat(t.toPrecision(e))}`}function n_(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function MGe(t){return v7e(t)}function DGe(t){return _7e(t)}function v7e(t,e){return r6(t,r=>r*g7e,e)}function _7e(t,e){return r6(t,r=>r*p7e,e)}function gd(t,e,r){return r6(t,n=>Math.max(e,Math.min(r,n)))}function vT(t,e,r){return n_(t)?t.map((n,i)=>vT(n,e[i],r)):r*e+(1-r)*t}function dx(t,e,r){const n=oh.EPSILON;r&&(oh.EPSILON=r);try{if(t===e)return!0;if(n_(t)&&n_(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!dx(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=oh.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{oh.EPSILON=n}}function b7e(t){return Math.round(t/oh.EPSILON)*oh.EPSILON}function x7e(t){return t.clone?t.clone():new Array(t.length)}function r6(t,e,r){if(n_(t)){const n=t;r=r||x7e(n);for(let i=0;i<r.length&&i<n.length;++i){const a=typeof t=="number"?t:t[i];r[i]=e(a,i,r)}return r}return e(t)}class Mre extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+r];return this.check()}toArray(e=[],r=0){for(let n=0;n<this.ELEMENTS;++n)e[r+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:n_(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(oh)}formatString(e){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+y7e(this[n],e);return`${e.printTypes?this.constructor.name:""}[${r}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!dx(this[r],e[r]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==e[r])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,r,n){if(n===void 0)return this.lerp(this,e,r);for(let i=0;i<this.ELEMENTS;++i){const a=e[i],s=typeof r=="number"?r:r[i];this[i]=a+n*(s-a)}return this.check()}min(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(e[r],this[r]);return this.check()}max(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(e[r],this[r]);return this.check()}clamp(e,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),r[n]);return this.check()}add(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(e){if(typeof e=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;else for(let r=0;r<this.ELEMENTS&&r<e.length;++r)this[r]*=e[r];return this.check()}multiplyByScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}check(){if(oh.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)e=e&&Number.isFinite(this[r]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=e;return this.check()}addScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),r);return this.check()}get elements(){return this}}function w7e(t,e){if(t.length!==e)return!1;for(let r=0;r<t.length;++r)if(!Number.isFinite(t[r]))return!1;return!0}function th(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function WP(t,e,r=""){if(oh.debug&&!w7e(t,e))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return t}function CW(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}class S7e extends Mre{get x(){return this[0]}set x(e){this[0]=th(e)}get y(){return this[1]}set y(e){this[1]=th(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let r=0;r<this.ELEMENTS;++r)e+=this[r]*this[r];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let r=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-e[n];r+=i*i}return th(r)}dot(e){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*e[n];return th(r)}normalize(){const e=this.magnitude();if(e!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=e;return this.check()}multiply(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return CW(e>=0&&e<this.ELEMENTS,"index is out of range"),th(this[e])}setComponent(e,r){return CW(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=r,this.check()}addVectors(e,r){return this.copy(e).add(r)}subVectors(e,r){return this.copy(e).subtract(r)}multiplyVectors(e,r){return this.copy(e).multiply(r)}addScaledVector(e,r){return this.add(new this.constructor(e).multiplyScalar(r))}}const DS=1e-6;let my=typeof Float32Array<"u"?Float32Array:Array;function E7e(){const t=new my(2);return my!=Float32Array&&(t[0]=0,t[1]=0),t}function AW(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function T7e(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Dre(t,e,r,n){const i=e[0],a=e[1];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t}function OGe(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t}function NGe(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t}function LGe(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t}function C7e(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}(function(){const t=E7e();return function(e,r,n,i,a,s){let o,c;for(r||(r=2),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],a(t,t,s),e[o]=t[0],e[o+1]=t[1];return e}})();function A7e(t,e,r){const n=e[0],i=e[1],a=r[3]*n+r[7]*i||1;return t[0]=(r[0]*n+r[4]*i)/a,t[1]=(r[1]*n+r[5]*i)/a,t}function Ore(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[3]*n+r[7]*i+r[11]*a||1;return t[0]=(r[0]*n+r[4]*i+r[8]*a)/s,t[1]=(r[1]*n+r[5]*i+r[9]*a)/s,t[2]=(r[2]*n+r[6]*i+r[10]*a)/s,t}function I7e(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t[2]=e[2],t}function FGe(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t[2]=e[2],t[3]=e[3],t}function BGe(t,e,r){const n=e[0],i=e[1],a=e[2];return t[0]=r[0]*n+r[3]*i+r[6]*a,t[1]=r[1]*n+r[4]*i+r[7]*a,t[2]=r[2]*n+r[5]*i+r[8]*a,t[3]=e[3],t}function P7e(){const t=new my(3);return my!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function k7e(t){const e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}function zGe(t,e,r){const n=new my(3);return n[0]=t,n[1]=e,n[2]=r,n}function R7e(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function M7e(t){const e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function D7e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function jGe(t,e){const r=e[0],n=e[1],i=e[2];let a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function O7e(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function N7e(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[0],o=r[1],c=r[2];return t[0]=i*c-a*o,t[1]=a*s-n*c,t[2]=n*o-i*s,t}function L7e(t,e,r,n){const i=e[0],a=e[1],s=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=s+n*(r[2]-s),t}function Nre(t,e,r){const n=e[0],i=e[1],a=e[2];let s=r[3]*n+r[7]*i+r[11]*a+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/s,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/s,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/s,t}function F7e(t,e,r){const n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t}function B7e(t,e,r){const n=r[0],i=r[1],a=r[2],s=r[3],o=e[0],c=e[1],h=e[2];let d=i*h-a*c,m=a*o-n*h,b=n*c-i*o,x=i*b-a*m,E=a*d-n*b,T=n*m-i*d;const A=s*2;return d*=A,m*=A,b*=A,x*=2,E*=2,T*=2,t[0]=o+d+x,t[1]=c+m+E,t[2]=h+b+T,t}function z7e(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function j7e(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function U7e(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function V7e(t,e){const r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],c=Math.sqrt((r*r+n*n+i*i)*(a*a+s*s+o*o)),h=c&&O7e(t,e)/c;return Math.acos(Math.min(Math.max(h,-1),1))}const Lre=R7e,$7e=k7e,GP=M7e;(function(){const t=P7e();return function(e,r,n,i,a,s){let o,c;for(r||(r=3),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const XP=[0,0,0];let Zw;class Ad extends S7e{static get ZERO(){return Zw||(Zw=new Ad(0,0,0),Object.freeze(Zw)),Zw}constructor(e=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&n_(e)?this.copy(e):(oh.debug&&(th(e),th(r),th(n)),this[0]=e,this[1]=r,this[2]=n)}set(e,r,n){return this[0]=e,this[1]=r,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return oh.debug&&(th(e.x),th(e.y),th(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=th(e)}angle(e){return V7e(this,e)}cross(e){return N7e(this,this,e),this.check()}rotateX({radians:e,origin:r=XP}){return z7e(this,this,r,e),this.check()}rotateY({radians:e,origin:r=XP}){return j7e(this,this,r,e),this.check()}rotateZ({radians:e,origin:r=XP}){return U7e(this,this,r,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Nre(this,this,e),this.check()}transformAsVector(e){return Ore(this,this,e),this.check()}transformByMatrix3(e){return F7e(this,this,e),this.check()}transformByMatrix2(e){return I7e(this,this,e),this.check()}transformByQuaternion(e){return B7e(this,this,e),this.check()}}class q7e extends Mre{toString(){let e="[";if(oh.printRowMajor){e+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)e+=` ${this[n*this.RANK+r]}`}else{e+="column-major:";for(let r=0;r<this.ELEMENTS;++r)e+=` ${this[r]}`}return e+="]",e}getElementIndex(e,r){return r*this.RANK+e}getElement(e,r){return this[r*this.RANK+e]}setElement(e,r,n){return this[r*this.RANK+e]=th(n),this}getColumn(e,r=new Array(this.RANK).fill(-0)){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[n+i];return r}setColumn(e,r){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=r[i];return this}}function H7e(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function W7e(t,e){if(t===e){const r=e[1],n=e[2],i=e[3],a=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function rD(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],c=e[6],h=e[7],d=e[8],m=e[9],b=e[10],x=e[11],E=e[12],T=e[13],A=e[14],M=e[15],F=r*o-n*s,N=r*c-i*s,O=r*h-a*s,U=n*c-i*o,j=n*h-a*o,H=i*h-a*c,G=d*T-m*E,X=d*A-b*E,ae=d*M-x*E,Q=m*A-b*T,W=m*M-x*T,oe=b*M-x*A;let se=F*oe-N*W+O*Q+U*ae-j*X+H*G;return se?(se=1/se,t[0]=(o*oe-c*W+h*Q)*se,t[1]=(i*W-n*oe-a*Q)*se,t[2]=(T*H-A*j+M*U)*se,t[3]=(b*j-m*H-x*U)*se,t[4]=(c*ae-s*oe-h*X)*se,t[5]=(r*oe-i*ae+a*X)*se,t[6]=(A*O-E*H-M*N)*se,t[7]=(d*H-b*O+x*N)*se,t[8]=(s*W-o*ae+h*G)*se,t[9]=(n*ae-r*W-a*G)*se,t[10]=(E*j-T*O+M*F)*se,t[11]=(m*O-d*j-x*F)*se,t[12]=(o*X-s*Q-c*G)*se,t[13]=(r*Q-n*X+i*G)*se,t[14]=(T*N-E*U-A*F)*se,t[15]=(d*U-m*N+b*F)*se,t):null}function G7e(t){const e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],s=t[5],o=t[6],c=t[7],h=t[8],d=t[9],m=t[10],b=t[11],x=t[12],E=t[13],T=t[14],A=t[15],M=e*s-r*a,F=e*o-n*a,N=r*o-n*s,O=h*E-d*x,U=h*T-m*x,j=d*T-m*E,H=e*j-r*U+n*O,G=a*j-s*U+o*O,X=h*N-d*F+m*M,ae=x*N-E*F+T*M;return c*H-i*G+A*X-b*ae}function Hm(t,e,r){const n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],c=e[5],h=e[6],d=e[7],m=e[8],b=e[9],x=e[10],E=e[11],T=e[12],A=e[13],M=e[14],F=e[15];let N=r[0],O=r[1],U=r[2],j=r[3];return t[0]=N*n+O*o+U*m+j*T,t[1]=N*i+O*c+U*b+j*A,t[2]=N*a+O*h+U*x+j*M,t[3]=N*s+O*d+U*E+j*F,N=r[4],O=r[5],U=r[6],j=r[7],t[4]=N*n+O*o+U*m+j*T,t[5]=N*i+O*c+U*b+j*A,t[6]=N*a+O*h+U*x+j*M,t[7]=N*s+O*d+U*E+j*F,N=r[8],O=r[9],U=r[10],j=r[11],t[8]=N*n+O*o+U*m+j*T,t[9]=N*i+O*c+U*b+j*A,t[10]=N*a+O*h+U*x+j*M,t[11]=N*s+O*d+U*E+j*F,N=r[12],O=r[13],U=r[14],j=r[15],t[12]=N*n+O*o+U*m+j*T,t[13]=N*i+O*c+U*b+j*A,t[14]=N*a+O*h+U*x+j*M,t[15]=N*s+O*d+U*E+j*F,t}function _T(t,e,r){const n=r[0],i=r[1],a=r[2];let s,o,c,h,d,m,b,x,E,T,A,M;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*a+e[12],t[13]=e[1]*n+e[5]*i+e[9]*a+e[13],t[14]=e[2]*n+e[6]*i+e[10]*a+e[14],t[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(s=e[0],o=e[1],c=e[2],h=e[3],d=e[4],m=e[5],b=e[6],x=e[7],E=e[8],T=e[9],A=e[10],M=e[11],t[0]=s,t[1]=o,t[2]=c,t[3]=h,t[4]=d,t[5]=m,t[6]=b,t[7]=x,t[8]=E,t[9]=T,t[10]=A,t[11]=M,t[12]=s*n+d*i+E*a+e[12],t[13]=o*n+m*i+T*a+e[13],t[14]=c*n+b*i+A*a+e[14],t[15]=h*n+x*i+M*a+e[15]),t}function n6(t,e,r){const n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function X7e(t,e,r,n){let i=n[0],a=n[1],s=n[2],o=Math.sqrt(i*i+a*a+s*s),c,h,d,m,b,x,E,T,A,M,F,N,O,U,j,H,G,X,ae,Q,W,oe,se,he;return o<DS?null:(o=1/o,i*=o,a*=o,s*=o,h=Math.sin(r),c=Math.cos(r),d=1-c,m=e[0],b=e[1],x=e[2],E=e[3],T=e[4],A=e[5],M=e[6],F=e[7],N=e[8],O=e[9],U=e[10],j=e[11],H=i*i*d+c,G=a*i*d+s*h,X=s*i*d-a*h,ae=i*a*d-s*h,Q=a*a*d+c,W=s*a*d+i*h,oe=i*s*d+a*h,se=a*s*d-i*h,he=s*s*d+c,t[0]=m*H+T*G+N*X,t[1]=b*H+A*G+O*X,t[2]=x*H+M*G+U*X,t[3]=E*H+F*G+j*X,t[4]=m*ae+T*Q+N*W,t[5]=b*ae+A*Q+O*W,t[6]=x*ae+M*Q+U*W,t[7]=E*ae+F*Q+j*W,t[8]=m*oe+T*se+N*he,t[9]=b*oe+A*se+O*he,t[10]=x*oe+M*se+U*he,t[11]=E*oe+F*se+j*he,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Fre(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[4],s=e[5],o=e[6],c=e[7],h=e[8],d=e[9],m=e[10],b=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+h*n,t[5]=s*i+d*n,t[6]=o*i+m*n,t[7]=c*i+b*n,t[8]=h*i-a*n,t[9]=d*i-s*n,t[10]=m*i-o*n,t[11]=b*i-c*n,t}function Y7e(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],c=e[3],h=e[8],d=e[9],m=e[10],b=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-h*n,t[1]=s*i-d*n,t[2]=o*i-m*n,t[3]=c*i-b*n,t[8]=a*n+h*i,t[9]=s*n+d*i,t[10]=o*n+m*i,t[11]=c*n+b*i,t}function Bre(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],c=e[3],h=e[4],d=e[5],m=e[6],b=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+h*n,t[1]=s*i+d*n,t[2]=o*i+m*n,t[3]=c*i+b*n,t[4]=h*i-a*n,t[5]=d*i-s*n,t[6]=m*i-o*n,t[7]=b*i-c*n,t}function UGe(t,e){const r=e[0],n=e[1],i=e[2],a=e[4],s=e[5],o=e[6],c=e[8],h=e[9],d=e[10];return t[0]=Math.sqrt(r*r+n*n+i*i),t[1]=Math.sqrt(a*a+s*s+o*o),t[2]=Math.sqrt(c*c+h*h+d*d),t}function Z7e(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],s=r+r,o=n+n,c=i+i,h=r*s,d=n*s,m=n*o,b=i*s,x=i*o,E=i*c,T=a*s,A=a*o,M=a*c;return t[0]=1-m-E,t[1]=d+M,t[2]=b-A,t[3]=0,t[4]=d-M,t[5]=1-h-E,t[6]=x+T,t[7]=0,t[8]=b+A,t[9]=x-T,t[10]=1-h-m,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function K7e(t,e,r,n,i,a,s){const o=1/(r-e),c=1/(i-n),h=1/(a-s);return t[0]=a*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*c,t[6]=0,t[7]=0,t[8]=(r+e)*o,t[9]=(i+n)*c,t[10]=(s+a)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*a*2*h,t[15]=0,t}function J7e(t,e,r,n,i){const a=1/Math.tan(e/2);if(t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){const s=1/(n-i);t[10]=(i+n)*s,t[14]=2*i*n*s}else t[10]=-1,t[14]=-2*n;return t}const Q7e=J7e;function eje(t,e,r,n,i,a,s){const o=1/(e-r),c=1/(n-i),h=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+r)*o,t[13]=(i+n)*c,t[14]=(s+a)*h,t[15]=1,t}const tje=eje;function rje(t,e,r,n){let i,a,s,o,c,h,d,m,b,x;const E=e[0],T=e[1],A=e[2],M=n[0],F=n[1],N=n[2],O=r[0],U=r[1],j=r[2];return Math.abs(E-O)<DS&&Math.abs(T-U)<DS&&Math.abs(A-j)<DS?H7e(t):(m=E-O,b=T-U,x=A-j,i=1/Math.sqrt(m*m+b*b+x*x),m*=i,b*=i,x*=i,a=F*x-N*b,s=N*m-M*x,o=M*b-F*m,i=Math.sqrt(a*a+s*s+o*o),i?(i=1/i,a*=i,s*=i,o*=i):(a=0,s=0,o=0),c=b*o-x*s,h=x*a-m*o,d=m*s-b*a,i=Math.sqrt(c*c+h*h+d*d),i?(i=1/i,c*=i,h*=i,d*=i):(c=0,h=0,d=0),t[0]=a,t[1]=c,t[2]=m,t[3]=0,t[4]=s,t[5]=h,t[6]=b,t[7]=0,t[8]=o,t[9]=d,t[10]=x,t[11]=0,t[12]=-(a*E+s*T+o*A),t[13]=-(c*E+h*T+d*A),t[14]=-(m*E+b*T+x*A),t[15]=1,t)}function nje(){const t=new my(4);return my!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function VGe(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function zre(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function $Ge(t){const e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)}function qGe(t){const e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function HGe(t,e){const r=e[0],n=e[1],i=e[2],a=e[3];let s=r*r+n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),t[0]=r*s,t[1]=n*s,t[2]=i*s,t[3]=a*s,t}function WGe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function GGe(t,e,r,n){const i=e[0],a=e[1],s=e[2],o=e[3];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=s+n*(r[2]-s),t[3]=o+n*(r[3]-o),t}function A_(t,e,r){const n=e[0],i=e[1],a=e[2],s=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*s,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*s,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*s,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*s,t}function XGe(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[0],o=r[1],c=r[2],h=r[3],d=h*n+o*a-c*i,m=h*i+c*n-s*a,b=h*a+s*i-o*n,x=-s*n-o*i-c*a;return t[0]=d*h+x*-s+m*-c-b*-o,t[1]=m*h+x*-o+b*-s-d*-c,t[2]=b*h+x*-c+d*-o-m*-s,t[3]=e[3],t}(function(){const t=nje();return function(e,r,n,i,a,s){let o,c;for(r||(r=4),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var nD;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(nD||(nD={}));const ije=45*Math.PI/180,aje=1,YP=.1,ZP=500,oje=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class kf extends q7e{static get IDENTITY(){return lje()}static get ZERO(){return sje()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return nD}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,r,n,i,a,s,o,c,h,d,m,b,x,E,T,A){return this[0]=e,this[1]=r,this[2]=n,this[3]=i,this[4]=a,this[5]=s,this[6]=o,this[7]=c,this[8]=h,this[9]=d,this[10]=m,this[11]=b,this[12]=x,this[13]=E,this[14]=T,this[15]=A,this.check()}setRowMajor(e,r,n,i,a,s,o,c,h,d,m,b,x,E,T,A){return this[0]=e,this[1]=a,this[2]=h,this[3]=x,this[4]=r,this[5]=s,this[6]=d,this[7]=E,this[8]=n,this[9]=o,this[10]=m,this[11]=T,this[12]=i,this[13]=c,this[14]=b,this[15]=A,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(oje)}fromObject(e){return this.check()}fromQuaternion(e){return Z7e(this,e),this.check()}frustum(e){const{left:r,right:n,bottom:i,top:a,near:s=YP,far:o=ZP}=e;return o===1/0?uje(this,r,n,i,a,s):K7e(this,r,n,i,a,s,o),this.check()}lookAt(e){const{eye:r,center:n=[0,0,0],up:i=[0,1,0]}=e;return rje(this,r,n,i),this.check()}ortho(e){const{left:r,right:n,bottom:i,top:a,near:s=YP,far:o=ZP}=e;return tje(this,r,n,i,a,s,o),this.check()}orthographic(e){const{fovy:r=ije,aspect:n=aje,focalDistance:i=1,near:a=YP,far:s=ZP}=e;IW(r);const o=r/2,c=i*Math.tan(o),h=c*n;return this.ortho({left:-h,right:h,bottom:-c,top:c,near:a,far:s})}perspective(e){const{fovy:r=45*Math.PI/180,aspect:n=1,near:i=.1,far:a=500}=e;return IW(r),Q7e(this,r,n,i,a),this.check()}determinant(){return G7e(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),i=1/n[0],a=1/n[1],s=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*a,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*a,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),i=1/n[0],a=1/n[1],s=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*s,e[3]=this[4]*i,e[4]=this[5]*a,e[5]=this[6]*s,e[6]=this[8]*i,e[7]=this[9]*a,e[8]=this[10]*s,e}transpose(){return W7e(this,this),this.check()}invert(){return rD(this,this),this.check()}multiplyLeft(e){return Hm(this,e,this),this.check()}multiplyRight(e){return Hm(this,this,e),this.check()}rotateX(e){return Fre(this,this,e),this.check()}rotateY(e){return Y7e(this,this,e),this.check()}rotateZ(e){return Bre(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,r){return X7e(this,this,e,r),this.check()}scale(e){return n6(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return _T(this,this,e),this.check()}transform(e,r){return e.length===4?(r=A_(r||[-0,-0,-0,-0],e,this),WP(r,4),r):this.transformAsPoint(e,r)}transformAsPoint(e,r){const{length:n}=e;let i;switch(n){case 2:i=C7e(r||[-0,-0],e,this);break;case 3:i=Nre(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return WP(i,e.length),i}transformAsVector(e,r){let n;switch(e.length){case 2:n=A7e(r||[-0,-0],e,this);break;case 3:n=Ore(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return WP(n,e.length),n}transformPoint(e,r){return this.transformAsPoint(e,r)}transformVector(e,r){return this.transformAsPoint(e,r)}transformDirection(e,r){return this.transformAsVector(e,r)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,r,n){return this.identity().translate([e,r,n])}}let Kw,Jw;function sje(){return Kw||(Kw=new kf([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Kw)),Kw}function lje(){return Jw||(Jw=new kf,Object.freeze(Jw)),Jw}function IW(t){if(t>Math.PI*2)throw Error("expected radians")}function uje(t,e,r,n,i,a){const s=2*a/(r-e),o=2*a/(i-n),c=(r+e)/(r-e),h=(i+n)/(i-n),d=-1,m=-1,b=-2*a;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=m,t[12]=0,t[13]=0,t[14]=b,t[15]=0,t}function jre(t,e=[],r=0){const n=Math.fround(t),i=t-n;return e[r]=n,e[r+1]=i,e}function cje(t){return t-Math.fround(t)}function hje(t){const e=new Float32Array(32);for(let r=0;r<4;++r)for(let n=0;n<4;++n){const i=r*4+n;jre(t[n*4+r],e,i*2)}return e}const fje=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,dje={name:"fp32",vs:fje},pje=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,gje={ONE:1},mje={name:"fp64arithmetic",vs:pje,defaultUniforms:gje,uniformTypes:{ONE:"f32"},fp64ify:jre,fp64LowPart:cje,fp64ifyMatrix4:hje},yje=[0,1,1,1],vje=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,_je=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,PW={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:yje},vs:vje,fs:_je,getUniforms:bje};function bje(t={},e){const r={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)r.isHighlightActive=!1;else{r.isHighlightActive=!0;const n=t.highlightedObjectColor.slice(0,3);r.highlightedObjectColor=n}if(t.highlightColor){const n=Array.from(t.highlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),r.highlightColor=n}return t.isActive!==void 0&&(r.isActive=!!t.isActive,r.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(r.useFloatColors=!!t.useFloatColors),r}const kW=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,xje={name:"layer",vs:kW,fs:kW,getUniforms:t=>({opacity:Math.pow(t.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},wje=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,Ure="#define SMOOTH_EDGE_RADIUS 0.5",Sje=`${Ure}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,Eje=`${Ure}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,Vre={name:"geometry",source:wje,vs:Sje,fs:Eje},Tje=25;var Cl;(function(t){t[t.Start=1]="Start",t[t.Move=2]="Move",t[t.End=4]="End",t[t.Cancel=8]="Cancel"})(Cl||(Cl={}));var Nl;(function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Up=4]="Up",t[t.Down=8]="Down",t[t.Horizontal=3]="Horizontal",t[t.Vertical=12]="Vertical",t[t.All=15]="All"})(Nl||(Nl={}));var Wi;(function(t){t[t.Possible=1]="Possible",t[t.Began=2]="Began",t[t.Changed=4]="Changed",t[t.Ended=8]="Ended",t[t.Recognized=8]="Recognized",t[t.Cancelled=16]="Cancelled",t[t.Failed=32]="Failed"})(Wi||(Wi={}));const Cje="compute",Aje="auto",iD="manipulation",OS="none",aD="pan-x",oD="pan-y";function Ije(t){if(t.includes(OS))return OS;const e=t.includes(aD),r=t.includes(oD);return e&&r?OS:e||r?e?aD:oD:t.includes(iD)?iD:Aje}class Pje{constructor(e,r){this.actions="",this.manager=e,this.set(r)}set(e){e===Cje&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const r of this.manager.recognizers)r.options.enable&&(e=e.concat(r.getTouchAction()));return Ije(e.join(" "))}}function bT(t){return t.trim().split(/\s+/g)}function KP(t,e,r){if(t)for(const n of bT(e))t.addEventListener(n,r,!1)}function JP(t,e,r){if(t)for(const n of bT(e))t.removeEventListener(n,r,!1)}function RW(t){return(t.ownerDocument||t).defaultView}function kje(t,e){let r=t;for(;r;){if(r===e)return!0;r=r.parentNode}return!1}function $re(t){const e=t.length;if(e===1)return{x:Math.round(t[0].clientX),y:Math.round(t[0].clientY)};let r=0,n=0,i=0;for(;i<e;)r+=t[i].clientX,n+=t[i].clientY,i++;return{x:Math.round(r/e),y:Math.round(n/e)}}function MW(t){const e=[];let r=0;for(;r<t.pointers.length;)e[r]={clientX:Math.round(t.pointers[r].clientX),clientY:Math.round(t.pointers[r].clientY)},r++;return{timeStamp:Date.now(),pointers:e,center:$re(e),deltaX:t.deltaX,deltaY:t.deltaY}}function qre(t,e){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}function DW(t,e){const r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.sqrt(r*r+n*n)}function Rje(t,e){const r=e.x-t.x,n=e.y-t.y;return Math.atan2(n,r)*180/Math.PI}function OW(t,e){const r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.atan2(n,r)*180/Math.PI}function Hre(t,e){return t===e?Nl.None:Math.abs(t)>=Math.abs(e)?t<0?Nl.Left:Nl.Right:e<0?Nl.Up:Nl.Down}function Mje(t,e){const r=e.center;let n=t.offsetDelta,i=t.prevDelta;const a=t.prevInput;return(e.eventType===Cl.Start||a?.eventType===Cl.End)&&(i=t.prevDelta={x:a?.deltaX||0,y:a?.deltaY||0},n=t.offsetDelta={x:r.x,y:r.y}),{deltaX:i.x+(r.x-n.x),deltaY:i.y+(r.y-n.y)}}function Wre(t,e,r){return{x:e/t||0,y:r/t||0}}function Dje(t,e){return DW(e[0],e[1])/DW(t[0],t[1])}function Oje(t,e){return OW(e[1],e[0])-OW(t[1],t[0])}function Nje(t,e){const r=t.lastInterval||e,n=e.timeStamp-r.timeStamp;let i,a,s,o;if(e.eventType!==Cl.Cancel&&(n>Tje||r.velocity===void 0)){const c=e.deltaX-r.deltaX,h=e.deltaY-r.deltaY,d=Wre(n,c,h);a=d.x,s=d.y,i=Math.abs(d.x)>Math.abs(d.y)?d.x:d.y,o=Hre(c,h),t.lastInterval=e}else i=r.velocity,a=r.velocityX,s=r.velocityY,o=r.direction;e.velocity=i,e.velocityX=a,e.velocityY=s,e.direction=o}function Lje(t,e){const{session:r}=t,{pointers:n}=e,{length:i}=n;r.firstInput||(r.firstInput=MW(e)),i>1&&!r.firstMultiple?r.firstMultiple=MW(e):i===1&&(r.firstMultiple=!1);const{firstInput:a,firstMultiple:s}=r,o=s?s.center:a.center,c=e.center=$re(n);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=Rje(o,c),e.distance=qre(o,c);const{deltaX:h,deltaY:d}=Mje(r,e);e.deltaX=h,e.deltaY=d,e.offsetDirection=Hre(e.deltaX,e.deltaY);const m=Wre(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=m.x,e.overallVelocityY=m.y,e.overallVelocity=Math.abs(m.x)>Math.abs(m.y)?m.x:m.y,e.scale=s?Dje(s.pointers,n):1,e.rotation=s?Oje(s.pointers,n):0,e.maxPointers=r.prevInput?e.pointers.length>r.prevInput.maxPointers?e.pointers.length:r.prevInput.maxPointers:e.pointers.length;let b=t.element;return kje(e.srcEvent.target,b)&&(b=e.srcEvent.target),e.target=b,Nje(r,e),e}function Fje(t,e,r){const n=r.pointers.length,i=r.changedPointers.length,a=e&Cl.Start&&n-i===0,s=e&(Cl.End|Cl.Cancel)&&n-i===0;r.isFirst=!!a,r.isFinal=!!s,a&&(t.session={}),r.eventType=e;const o=Lje(t,r);t.emit("hammer.input",o),t.recognize(o),t.session.prevInput=o}let Bje=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=r=>{this.manager.options.enable&&this.handler(r)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,r){Fje(this.manager,e,r)}init(){KP(this.element,this.evEl,this.domHandler),KP(this.target,this.evTarget,this.domHandler),KP(RW(this.element),this.evWin,this.domHandler)}destroy(){JP(this.element,this.evEl,this.domHandler),JP(this.target,this.evTarget,this.domHandler),JP(RW(this.element),this.evWin,this.domHandler)}};const zje={pointerdown:Cl.Start,pointermove:Cl.Move,pointerup:Cl.End,pointercancel:Cl.Cancel,pointerout:Cl.Cancel},jje="pointerdown",Uje="pointermove pointerup pointercancel";class Vje extends Bje{constructor(e){super(e),this.evEl=jje,this.evWin=Uje,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:r}=this;let n=!1;const i=zje[e.type],a=e.pointerType,s=a==="touch";let o=r.findIndex(c=>c.pointerId===e.pointerId);i&Cl.Start&&(e.buttons||s)?o<0&&(r.push(e),o=r.length-1):i&(Cl.End|Cl.Cancel)&&(n=!0),!(o<0)&&(r[o]=e,this.callback(i,{pointers:r,changedPointers:[e],eventType:i,pointerType:a,srcEvent:e}),n&&r.splice(o,1))}}const $je=["","webkit","Moz","MS","ms","o"];function qje(t,e){const r=e[0].toUpperCase()+e.slice(1);for(const n of $je){const i=n?n+r:e;if(i in t)return i}}const Hje=1,NW=2,LW={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class Wje{constructor(e,r){this.options={...LW,...r,cssProps:{...LW.cssProps,...r.cssProps},inputTarget:r.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new Vje(this),this.touchAction=new Pje(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?NW:Hje}recognize(e){const{session:r}=this;if(r.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let n;const{recognizers:i}=this;let{curRecognizer:a}=r;(!a||a&&a.state&Wi.Recognized)&&(a=r.curRecognizer=null);let s=0;for(;s<i.length;)n=i[s],r.stopped!==NW&&(!a||n===a||n.canRecognizeWith(a))?n.recognize(e):n.reset(),!a&&n.state&(Wi.Began|Wi.Changed|Wi.Ended)&&(a=r.curRecognizer=n),s++}get(e){const{recognizers:r}=this;for(let n=0;n<r.length;n++)if(r[n].options.event===e)return r[n];return null}add(e){if(Array.isArray(e)){for(const n of e)this.add(n);return this}const r=this.get(e.options.event);return r&&this.remove(r),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const n of e)this.remove(n);return this}const r=typeof e=="string"?this.get(e):e;if(r){const{recognizers:n}=this,i=n.indexOf(r);i!==-1&&(n.splice(i,1),this.touchAction.update())}return this}on(e,r){if(!e||!r)return;const{handlers:n}=this;for(const i of bT(e))n[i]=n[i]||[],n[i].push(r)}off(e,r){if(!e)return;const{handlers:n}=this;for(const i of bT(e))r?n[i]&&n[i].splice(n[i].indexOf(r),1):delete n[i]}emit(e,r){const n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;const i=r;i.type=e,i.preventDefault=function(){r.srcEvent.preventDefault()};let a=0;for(;a<n.length;)n[a](i),a++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:r}=this;if(r){for(const[n,i]of Object.entries(this.options.cssProps)){const a=qje(r.style,n);e?(this.oldCssProps[a]=r.style[a],r.style[a]=i):r.style[a]=this.oldCssProps[a]||""}e||(this.oldCssProps={})}}}let Gje=1;function Xje(){return Gje++}function FW(t){return t&Wi.Cancelled?"cancel":t&Wi.Ended?"end":t&Wi.Changed?"move":t&Wi.Began?"start":""}class Gre{constructor(e){this.options=e,this.id=Xje(),this.state=Wi.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const i of e)this.recognizeWith(i);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;const{simultaneous:n}=this;return n[r.id]||(n[r.id]=r,r.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const n of e)this.dropRecognizeWith(n);return this}let r;return typeof e=="string"?r=this.manager.get(e):r=e,r&&delete this.simultaneous[r.id],this}requireFailure(e){if(Array.isArray(e)){for(const i of e)this.requireFailure(i);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;const{requireFail:n}=this;return n.indexOf(r)===-1&&(n.push(r),r.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const n of e)this.dropRequireFailure(n);return this}let r;if(typeof e=="string"?r=this.manager.get(e):r=e,r){const n=this.requireFail.indexOf(r);n>-1&&this.requireFail.splice(n,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;const{state:r}=this;r<Wi.Ended&&this.manager.emit(this.options.event+FW(r),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),r>=Wi.Ended&&this.manager.emit(this.options.event+FW(r),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Wi.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Wi.Failed|Wi.Possible)))return!1;e++}return!0}recognize(e){const r={...e};if(!this.options.enable){this.reset(),this.state=Wi.Failed;return}this.state&(Wi.Recognized|Wi.Cancelled|Wi.Failed)&&(this.state=Wi.Possible),this.state=this.process(r),this.state&(Wi.Began|Wi.Changed|Wi.Ended|Wi.Cancelled)&&this.tryEmit(r)}getEventNames(){return[this.options.event]}reset(){}}class Xre extends Gre{attrTest(e){const r=this.options.pointers;return r===0||e.pointers.length===r}process(e){const{state:r}=this,{eventType:n}=e,i=r&(Wi.Began|Wi.Changed),a=this.attrTest(e);return i&&(n&Cl.Cancel||!a)?r|Wi.Cancelled:i||a?n&Cl.End?r|Wi.Ended:r&Wi.Began?r|Wi.Changed:Wi.Began:Wi.Failed}}class BW extends Gre{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[iD]}process(e){const{options:r}=this,n=e.pointers.length===r.pointers,i=e.distance<r.threshold,a=e.deltaTime<r.time;if(this.reset(),e.eventType&Cl.Start&&this.count===0)return this.failTimeout();if(i&&a&&n){if(e.eventType!==Cl.End)return this.failTimeout();const s=this.pTime?e.timeStamp-this.pTime<r.interval:!0,o=!this.pCenter||qre(this.pCenter,e.center)<r.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!o||!s?this.count=1:this.count+=1,this._input=e,this.count%r.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Wi.Recognized,this.tryEmit(this._input)},r.interval),Wi.Began):Wi.Recognized}return Wi.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Wi.Failed},this.options.interval),Wi.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Wi.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const Yje=["","start","move","end","cancel","up","down","left","right"];class zW extends Xre{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:Nl.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,r=[];return e&Nl.Horizontal&&r.push(oD),e&Nl.Vertical&&r.push(aD),r}getEventNames(){return Yje.map(e=>this.options.event+e)}directionTest(e){const{options:r}=this;let n=!0,{distance:i}=e,{direction:a}=e;const s=e.deltaX,o=e.deltaY;return a&r.direction||(r.direction&Nl.Horizontal?(a=s===0?Nl.None:s<0?Nl.Left:Nl.Right,n=s!==this.pX,i=Math.abs(e.deltaX)):(a=o===0?Nl.None:o<0?Nl.Up:Nl.Down,n=o!==this.pY,i=Math.abs(e.deltaY))),e.direction=a,n&&i>r.threshold&&!!(a&r.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&Wi.Began)||!(this.state&Wi.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const r=Nl[e.direction].toLowerCase();r&&(e.additionalEvent=this.options.event+r),super.emit(e)}}const Zje=["","start","move","end","cancel","in","out"];class Kje extends Xre{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[OS]}getEventNames(){return Zje.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&Wi.Began))}emit(e){if(e.scale!==1){const r=e.scale<1?"in":"out";e.additionalEvent=this.options.event+r}super.emit(e)}}class J3{constructor(e,r,n){this.element=e,this.callback=r,this.options=n}}const Jje=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Qje=Jje.indexOf("firefox")!==-1,jW=4.000244140625,eUe=40,tUe=.25;class rUe extends J3{constructor(e,r,n){super(e,r,{enable:!0,...n}),this.handleEvent=i=>{if(!this.options.enable)return;let a=i.deltaY;globalThis.WheelEvent&&(Qje&&i.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(a/=globalThis.devicePixelRatio),i.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(a*=eUe)),a!==0&&a%jW===0&&(a=Math.floor(a/jW)),i.shiftKey&&a&&(a=a*tUe),this.callback({type:"wheel",center:{x:i.clientX,y:i.clientY},delta:-a,srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,r){e==="wheel"&&(this.options.enable=r)}}const UW=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class nUe extends J3{constructor(e,r,n){super(e,r,{enable:!0,...n}),this.handleEvent=a=>{this.handleOverEvent(a),this.handleOutEvent(a),this.handleEnterEvent(a),this.handleLeaveEvent(a),this.handleMoveEvent(a)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,UW.forEach(a=>e.addEventListener(a,this.handleEvent))}destroy(){UW.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){switch(e){case"pointermove":this.enableMoveEvent=r;break;case"pointerover":this.enableOverEvent=r;break;case"pointerout":this.enableOutEvent=r;break;case"pointerenter":this.enableEnterEvent=r;break;case"pointerleave":this.enableLeaveEvent=r;break}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break}}_emit(e,r){this.callback({type:e,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})}}const VW=["keydown","keyup"];class iUe extends J3{constructor(e,r,n){super(e,r,{enable:!0,tabIndex:0,...n}),this.handleEvent=i=>{const a=i.target||i.srcElement;a.tagName==="INPUT"&&a.type==="text"||a.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:"keydown",srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:"keyup",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",VW.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){VW.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){e==="keydown"&&(this.enableDownEvent=r),e==="keyup"&&(this.enableUpEvent=r)}}class aUe extends J3{constructor(e,r,n){super(e,r,n),this.handleEvent=i=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,r){e==="contextmenu"&&(this.options.enable=r)}}const $W=1,sD=2,qW=4,oUe={pointerdown:$W,pointermove:sD,pointerup:qW,mousedown:$W,mousemove:sD,mouseup:qW},sUe=0,lUe=1,uUe=2,cUe=1,hUe=2,fUe=4;function dUe(t){const e=oUe[t.srcEvent.type];if(!e)return null;const{buttons:r,button:n}=t.srcEvent;let i=!1,a=!1,s=!1;return e===sD?(i=!!(r&cUe),a=!!(r&fUe),s=!!(r&hUe)):(i=n===sUe,a=n===lUe,s=n===uUe),{leftButton:i,middleButton:a,rightButton:s}}function pUe(t,e){const r=t.center;if(!r)return null;const n=e.getBoundingClientRect(),i=n.width/e.offsetWidth||1,a=n.height/e.offsetHeight||1,s={x:(r.x-n.left-e.clientLeft)/i,y:(r.y-n.top-e.clientTop)/a};return{center:r,offsetCenter:s}}const gUe={srcElement:"root",priority:0};class mUe{constructor(e,r){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let a=n.srcEvent.target;for(;a&&a!==i.rootElement;){if(this._emit(i,a),i.handled)return;a=a.parentNode}this._emit(i,"root")},this.eventManager=e,this.recognizerName=r,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,r,n,i=!1,a=!1){const{handlers:s,handlersByElement:o}=this,c={...gUe,...n};let h=o.get(c.srcElement);h||(h=[],o.set(c.srcElement,h));const d={type:e,handler:r,srcElement:c.srcElement,priority:c.priority};i&&(d.once=!0),a&&(d.passive=!0),s.push(d),this._active=this._active||!d.passive;let m=h.length-1;for(;m>=0&&!(h[m].priority>=d.priority);)m--;h.splice(m+1,0,d)}remove(e,r){const{handlers:n,handlersByElement:i}=this;for(let a=n.length-1;a>=0;a--){const s=n[a];if(s.type===e&&s.handler===r){n.splice(a,1);const o=i.get(s.srcElement);o.splice(o.indexOf(s),1),o.length===0&&i.delete(s.srcElement)}}this._active=n.some(a=>!a.passive)}_emit(e,r){const n=this.handlersByElement.get(r);if(n){let i=!1;const a=()=>{e.handled=!0},s=()=>{e.handled=!0,i=!0},o=[];for(let c=0;c<n.length;c++){const{type:h,handler:d,once:m}=n[c];if(d({...e,type:h,stopPropagation:a,stopImmediatePropagation:s}),m&&o.push(n[c]),i)break}for(let c=0;c<o.length;c++){const{type:h,handler:d}=o[c];this.remove(h,d)}}}_normalizeEvent(e){const r=this.eventManager.getElement();return{...e,...dUe(e),...pUe(e,r),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:r}}}function yUe(t){if("recognizer"in t)return t;let e;const r=Array.isArray(t)?[...t]:[t];if(typeof r[0]=="function"){const n=r.shift(),i=r.shift()||{};e=new n(i)}else e=r.shift();return{recognizer:e,recognizeWith:typeof r[0]=="string"?[r[0]]:r[0],requireFailure:typeof r[1]=="string"?[r[1]]:r[1]}}class vUe{constructor(e=null,r={}){if(this._onBasicInput=n=>{this.manager.emit(n.srcEvent.type,n)},this._onOtherEvent=n=>{this.manager.emit(n.type,n)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...r},this.events=new Map,this.element=e,!!e){this.manager=new Wje(e,this.options);for(const n of this.options.recognizers){const{recognizer:i,recognizeWith:a,requireFailure:s}=yUe(n);this.manager.add(i),a&&i.recognizeWith(a),s&&i.requireFailure(s)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new rUe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new nUe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new iUe(e,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new aUe(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,r,n){this._addEventHandler(e,r,n,!1)}once(e,r,n){this._addEventHandler(e,r,n,!0)}watch(e,r,n){this._addEventHandler(e,r,n,!1,!0)}off(e,r){this._removeEventHandler(e,r)}_toggleRecognizer(e,r){const{manager:n}=this;if(!n)return;const i=n.get(e);i&&(i.set({enable:r}),n.touchAction.update()),this.wheelInput?.enableEventType(e,r),this.moveInput?.enableEventType(e,r),this.keyInput?.enableEventType(e,r),this.contextmenuInput?.enableEventType(e,r)}_addEventHandler(e,r,n,i,a){if(typeof e!="string"){n=r;for(const[h,d]of Object.entries(e))this._addEventHandler(h,d,n,i,a);return}const{manager:s,events:o}=this;if(!s)return;let c=o.get(e);if(!c){const h=this._getRecognizerName(e)||e;c=new mUe(this,h),o.set(e,c),s&&s.on(e,c.handleEvent)}c.add(e,r,n,i,a),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,r){if(typeof e!="string"){for(const[a,s]of Object.entries(e))this._removeEventHandler(a,s);return}const{events:n}=this,i=n.get(e);if(i&&(i.remove(e,r),i.isEmpty())){const{recognizerName:a}=i;let s=!1;for(const o of n.values())if(o.recognizerName===a&&!o.isEmpty()){s=!0;break}s||this._toggleRecognizer(a,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(r=>r.getEventNames().includes(e))?.options.event}}const Xa={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Xa,"IDENTITY",{get:()=>(po.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const sh={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},xT={common:0,meters:1,pixels:2},lD={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},HW={multipan:[zW,{threshold:10,direction:Nl.Vertical,pointers:2}],pinch:[Kje,{},null,["multipan"]],pan:[zW,{threshold:1},["pinch"],["multipan"]],dblclick:[BW,{event:"dblclick",taps:2}],click:[BW,{event:"click"},null,["dblclick"]]};function _Ue(t,e){if(t===e)return!0;if(Array.isArray(t)){const r=t.length;if(!e||e.length!==r)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}return!1}function o2(t){let e={},r;return n=>{for(const i in n)if(!_Ue(n[i],e[i])){r=t(n),e=n;break}return r}}const WW=[0,0,0,0],bUe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Yre=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],xUe=[0,0,0],Zre=[0,0,0],wUe=o2(TUe);function Kre(t,e,r=Zre){r.length<3&&(r=[r[0],r[1],0]);let n=r,i,a=!0;switch(e===Xa.LNGLAT_OFFSETS||e===Xa.METER_OFFSETS?i=r:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case sh.WEB_MERCATOR:(e===Xa.LNGLAT||e===Xa.CARTESIAN)&&(i=[0,0,0],a=!1);break;case sh.WEB_MERCATOR_AUTO_OFFSET:e===Xa.LNGLAT?n=i:e===Xa.CARTESIAN&&(n=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(n),n[0]-=r[0],n[1]-=r[1],n[2]-=r[2]);break;case sh.IDENTITY:n=t.position.map(Math.fround),n[2]=n[2]||0;break;case sh.GLOBE:a=!1,i=null;break;default:a=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:a}}function SUe(t,e,r){const{viewMatrixUncentered:n,projectionMatrix:i}=t;let{viewMatrix:a,viewProjectionMatrix:s}=t,o=WW,c=WW,h=t.cameraPosition;const{geospatialOrigin:d,shaderCoordinateOrigin:m,offsetMode:b}=Kre(t,e,r);return b&&(c=t.projectPosition(d||m),h=[h[0]-c[0],h[1]-c[1],h[2]-c[2]],c[3]=1,o=A_([],c,s),a=n||a,s=Hm([],i,a),s=Hm([],s,bUe)),{viewMatrix:a,viewProjectionMatrix:s,projectionCenter:o,originCommon:c,cameraPosCommon:h,shaderCoordinateOrigin:m,geospatialOrigin:d}}function EUe({viewport:t,devicePixelRatio:e=1,modelMatrix:r=null,coordinateSystem:n=Xa.DEFAULT,coordinateOrigin:i=Zre,autoWrapLongitude:a=!1}){n===Xa.DEFAULT&&(n=t.isGeospatial?Xa.LNGLAT:Xa.CARTESIAN);const s=wUe({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i});return s.wrapLongitude=a,s.modelMatrix=r||Yre,s}function TUe({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:n}){const{projectionCenter:i,viewProjectionMatrix:a,originCommon:s,cameraPosCommon:o,shaderCoordinateOrigin:c,geospatialOrigin:h}=SUe(t,r,n),d=t.getDistanceScales(),m=[t.width*e,t.height*e],b=A_([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,x={coordinateSystem:r,projectionMode:t.projectionMode,coordinateOrigin:c,commonOrigin:s.slice(0,3),center:i,pseudoMeters:!!t._pseudoMeters,viewportSize:m,devicePixelRatio:e,focalDistance:b,commonUnitsPerMeter:d.unitsPerMeter,commonUnitsPerWorldUnit:d.unitsPerMeter,commonUnitsPerWorldUnit2:xUe,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:a,modelMatrix:Yre,cameraPosition:o};if(h){const E=t.getDistanceScales(h);switch(r){case Xa.METER_OFFSETS:x.commonUnitsPerWorldUnit=E.unitsPerMeter,x.commonUnitsPerWorldUnit2=E.unitsPerMeter2;break;case Xa.LNGLAT:case Xa.LNGLAT_OFFSETS:t._pseudoMeters||(x.commonUnitsPerMeter=E.unitsPerMeter),x.commonUnitsPerWorldUnit=E.unitsPerDegree,x.commonUnitsPerWorldUnit2=E.unitsPerDegree2;break;case Xa.CARTESIAN:x.commonUnitsPerWorldUnit=[1,1,E.unitsPerMeter[2]],x.commonUnitsPerWorldUnit2=[0,0,E.unitsPerMeter2[2]];break}}return x}const CUe=Object.keys(Xa).map(t=>`const COORDINATE_SYSTEM_${t}: i32 = ${Xa[t]};`).join(""),AUe=Object.keys(sh).map(t=>`const PROJECTION_MODE_${t}: i32 = ${sh[t]};`).join(""),IUe=Object.keys(xT).map(t=>`const UNIT_${t.toUpperCase()}: i32 = ${xT[t]};`).join(""),PUe=`${CUe}
${AUe}
${IUe}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,kUe=`${PUe}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the zaxis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`,RUe=Object.keys(Xa).map(t=>`const int COORDINATE_SYSTEM_${t} = ${Xa[t]};`).join(""),MUe=Object.keys(sh).map(t=>`const int PROJECTION_MODE_${t} = ${sh[t]};`).join(""),DUe=Object.keys(xT).map(t=>`const int UNIT_${t.toUpperCase()} = ${xT[t]};`).join(""),OUe=`${RUe}
${MUe}
${DUe}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`,NUe={};function LUe(t=NUe){return"viewport"in t?EUe(t):{}}const i6={name:"project",dependencies:[dje,Vre],source:kUe,vs:OUe,getUniforms:LUe,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},FUe=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,BUe=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,ZGe={name:"project32",dependencies:[i6],source:FUe,vs:BUe};function zUe(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function M0(t,e){const r=A_([],e,t);return zre(r,r,1/r[3]),r}function GW(t,e){const r=t%e;return r<0?e+r:r}function uD(t,e,r){return t<e?e:t>r?r:t}function jUe(t){return Math.log(t)*Math.LOG2E}const a6=Math.log2||jUe;function Pp(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const wf=Math.PI,Jre=wf/4,jh=wf/180,cD=180/wf,i_=512,wT=4003e4,md=85.051129,UUe=1.5;function VUe(t){return a6(t)}function px(t){const[e,r]=t;Pp(Number.isFinite(e)),Pp(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");const n=e*jh,i=r*jh,a=i_*(n+wf)/(2*wf),s=i_*(wf+Math.log(Math.tan(Jre+i*.5)))/(2*wf);return[a,s]}function a_(t){const[e,r]=t,n=e/i_*(2*wf)-wf,i=2*(Math.atan(Math.exp(r/i_*(2*wf)-wf))-Jre);return[n*cD,i*cD]}function $Ue(t){const{latitude:e}=t;Pp(Number.isFinite(e));const r=Math.cos(e*jh);return VUe(wT*r)-9}function NS(t){const e=Math.cos(t*jh);return i_/wT/e}function hD(t){const{latitude:e,longitude:r,highPrecision:n=!1}=t;Pp(Number.isFinite(e)&&Number.isFinite(r));const i=i_,a=Math.cos(e*jh),s=i/360,o=s/a,c=i/wT/a,h={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[s,o,c],degreesPerUnit:[1/s,1/o,1/c]};if(n){const d=jh*Math.tan(e*jh)/a,m=s*d/2,b=i/wT*d,x=b/o*c;h.unitsPerDegree2=[0,m,b],h.unitsPerMeter2=[x,0,x]}return h}function Qre(t,e){const[r,n,i]=t,[a,s,o]=e,{unitsPerMeter:c,unitsPerMeter2:h}=hD({longitude:r,latitude:n,highPrecision:!0}),d=px(t);d[0]+=a*(c[0]+h[0]*s),d[1]+=s*(c[1]+h[1]*s);const m=a_(d),b=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[m[0],m[1],b]:m}function qUe(t){const{height:e,pitch:r,bearing:n,altitude:i,scale:a,center:s}=t,o=zUe();_T(o,o,[0,0,-i]),Fre(o,o,-r*jh),Bre(o,o,n*jh);const c=a/e;return n6(o,o,[c,c,c]),s&&_T(o,o,D7e([],s)),o}function HUe(t){const{width:e,height:r,altitude:n,pitch:i=0,offset:a,center:s,scale:o,nearZMultiplier:c=1,farZMultiplier:h=1}=t;let{fovy:d=gx(UUe)}=t;n!==void 0&&(d=gx(n));const m=d*jh,b=i*jh,x=o6(d);let E=x;s&&(E+=s[2]*o/Math.cos(b)/r);const T=m*(.5+(a?a[1]:0)/r),A=Math.sin(T)*E/Math.sin(uD(Math.PI/2-b-T,.01,Math.PI-.01)),M=Math.sin(b)*A+E,F=E*10,N=Math.min(M*h,F);return{fov:m,aspect:e/r,focalDistance:x,near:c,far:N}}function gx(t){return 2*Math.atan(.5/t)*cD}function o6(t){return .5/Math.tan(.5*t*jh)}function ene(t,e){const[r,n,i=0]=t;return Pp(Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)),M0(e,[r,n,i,1])}function s6(t,e,r=0){const[n,i,a]=t;if(Pp(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(a))return M0(e,[n,i,a,1]);const s=M0(e,[n,i,0,1]),o=M0(e,[n,i,1,1]),c=s[2],h=o[2],d=c===h?0:((r||0)-c)/(h-c);return Dre([],s,o,d)}function WUe(t){const{width:e,height:r,bounds:n,minExtent:i=0,maxZoom:a=24,offset:s=[0,0]}=t,[[o,c],[h,d]]=n,m=GUe(t.padding),b=px([o,uD(d,-md,md)]),x=px([h,uD(c,-md,md)]),E=[Math.max(Math.abs(x[0]-b[0]),i),Math.max(Math.abs(x[1]-b[1]),i)],T=[e-m.left-m.right-Math.abs(s[0])*2,r-m.top-m.bottom-Math.abs(s[1])*2];Pp(T[0]>0&&T[1]>0);const A=T[0]/E[0],M=T[1]/E[1],F=(m.right-m.left)/2/A,N=(m.top-m.bottom)/2/M,O=[(x[0]+b[0])/2+F,(x[1]+b[1])/2+N],U=a_(O),j=Math.min(a,a6(Math.abs(Math.min(A,M))));return Pp(Number.isFinite(j)),{longitude:U[0],latitude:U[1],zoom:j}}function GUe(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Pp(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const XW=Math.PI/180;function XUe(t,e=0){const{width:r,height:n,unproject:i}=t,a={targetZ:e},s=i([0,n],a),o=i([r,n],a);let c,h;const d=t.fovy?.5*t.fovy*XW:Math.atan(.5/t.altitude),m=(90-t.pitch)*XW;return d>m-.01?(c=YW(t,0,e),h=YW(t,r,e)):(c=i([0,0],a),h=i([r,0],a)),[s,o,h,c]}function YW(t,e,r){const{pixelUnprojectionMatrix:n}=t,i=M0(n,[e,0,1,1]),a=M0(n,[e,t.height,1,1]),o=(r*t.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),c=Dre([],i,a,o),h=a_(c);return h.push(r),h}const ZW=512;function YUe(t){const{width:e,height:r,pitch:n=0}=t;let{longitude:i,latitude:a,zoom:s,bearing:o=0}=t;(i<-180||i>180)&&(i=GW(i+180,360)-180),(o<-180||o>180)&&(o=GW(o+180,360)-180);const c=a6(r/ZW);if(s<=c)s=c,a=0;else{const h=r/2/Math.pow(2,s),d=a_([0,h])[1];if(a<d)a=d;else{const m=a_([0,ZW-h])[1];a>m&&(a=m)}}return{width:e,height:r,longitude:i,latitude:a,zoom:s,pitch:n,bearing:o}}const tne=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,ZUe=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,KUe=`
${tne}
${ZUe}
`,JUe=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,QUe=`
${tne}
${JUe}
`,eVe=o2(aVe),tVe=o2(oVe),rVe=[0,0,0,1],nVe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function iVe(t,e){const[r,n,i]=t,a=s6([r,n,i],e);return Number.isFinite(i)?a:[a[0],a[1],0]}function aVe({viewport:t,center:e}){return new kf(t.viewProjectionMatrix).invert().transform(e)}function oVe({viewport:t,shadowMatrices:e}){const r=[],n=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,a=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(s=>iVe(s,n));for(const s of e){const o=s.clone().translate(new Ad(t.center).negate()),c=a.map(d=>o.transform(d)),h=new kf().ortho({left:Math.min(...c.map(d=>d[0])),right:Math.max(...c.map(d=>d[0])),bottom:Math.min(...c.map(d=>d[1])),top:Math.max(...c.map(d=>d[1])),near:Math.min(...c.map(d=>-d[2])),far:Math.max(...c.map(d=>-d[2]))});r.push(h.multiplyRight(s))}return r}function sVe(t){const{shadowEnabled:e=!0,project:r}=t;if(!e||!r||!t.shadowMatrices||!t.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};const n=i6.getUniforms(r),i=eVe({viewport:r.viewport,center:n.center}),a=[],s=tVe({shadowMatrices:t.shadowMatrices,viewport:r.viewport}).slice();for(let c=0;c<t.shadowMatrices.length;c++){const h=s[c],d=h.clone().translate(new Ad(r.viewport.center).negate());n.coordinateSystem===Xa.LNGLAT&&n.projectionMode===sh.WEB_MERCATOR?(s[c]=d,a[c]=i):(s[c]=h.clone().multiplyRight(nVe),a[c]=d.transform(i))}const o={drawShadowMap:!!t.drawToShadowMap,useShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,color:t.shadowColor||rVe,lightId:t.shadowLightId||0,lightCount:t.shadowMatrices.length,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};for(let c=0;c<s.length;c++)o[`viewProjectionMatrix${c}`]=s[c],o[`projectCenter${c}`]=a[c];for(let c=0;c<2;c++)o[`shadow_uShadowMap${c}`]=t.shadowMaps&&t.shadowMaps[c]||t.dummyShadowMap;return o}const KW={name:"shadow",dependencies:[i6],vs:KUe,fs:QUe,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:sVe,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},KGe={...PW,defaultUniforms:{...PW.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},lVe=[Vre],uVe=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],cVe=[];function hVe(t){const e=Mm.getDefaultShaderAssembler();for(const n of lVe)e.addDefaultModule(n);e._hookFunctions.length=0;const r=t==="glsl"?uVe:cVe;for(const n of r)e.addShaderHook(n);return e}const fVe=[255,255,255],dVe=1;let pVe=0;class gVe{constructor(e={}){this.type="ambient";const{color:r=fVe}=e,{intensity:n=dVe}=e;this.id=e.id||`ambient-${pVe++}`,this.color=r,this.intensity=n}}const mVe=[255,255,255],yVe=1,vVe=[0,0,-1];let _Ve=0;class JW{constructor(e={}){this.type="directional";const{color:r=mVe}=e,{intensity:n=yVe}=e,{direction:i=vVe}=e,{_shadow:a=!1}=e;this.id=e.id||`directional-${_Ve++}`,this.color=r,this.intensity=n,this.type="directional",this.direction=new Ad(i).normalize().toArray(),this.shadow=a}getProjectedLight(e){return this}}class bVe{constructor(e,r={id:"pass"}){const{id:n}=r;this.id=n,this.device=e,this.props={...r}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class l6 extends bVe{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[r,n]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,a=e.clearColor??(i?[0,0,0,0]:!1),s=i?1:!1,o=i?0:!1,c=e.colorMask??15,h={viewport:[0,0,r,n]};e.colorMask&&(h.colorMask=c),e.scissorRect&&(h.scissorRect=e.scissorRect);const d=this.device.beginRenderPass({framebuffer:e.target,parameters:h,clearColor:a,clearDepth:s,clearStencil:o});try{return this._drawLayers(d,e)}finally{d.end(),this.device.submit()}}_drawLayers(e,r){const{target:n,shaderModuleProps:i,viewports:a,views:s,onViewportActive:o,clearStack:c=!0}=r;r.pass=r.pass||"unknown",c&&(this._lastRenderIndex=-1);const h=[];for(const d of a){const m=s&&s[d.id];o?.(d);const b=this._getDrawLayerParams(d,r),x=d.subViewports||[d];for(const E of x){const T=this._drawLayersInViewport(e,{target:n,shaderModuleProps:i,viewport:E,view:m,pass:r.pass,layers:r.layers},b);h.push(T)}}return h}_getDrawLayerParams(e,{layers:r,pass:n,isPicking:i=!1,layerFilter:a,cullRect:s,effects:o,shaderModuleProps:c},h=!1){const d=[],m=rne(this._lastRenderIndex+1),b={layer:r[0],viewport:e,isPicking:i,renderPass:n,cullRect:s},x={};for(let E=0;E<r.length;E++){const T=r[E],A=this._shouldDrawLayer(T,b,a,x),M={shouldDrawLayer:A};A&&!h&&(M.shouldDrawLayer=!0,M.layerRenderIndex=m(T,A),M.shaderModuleProps=this._getShaderModuleProps(T,o,n,c),M.layerParameters={...T.context.deck?.props.parameters,...this.getLayerParameters(T,E,e)}),d[E]=M}return d}_drawLayersInViewport(e,{layers:r,shaderModuleProps:n,pass:i,target:a,viewport:s,view:o},c){const h=xVe(this.device,{shaderModuleProps:n,target:a,viewport:s});if(o){const{clear:m,clearColor:b,clearDepth:x,clearStencil:E}=o.props;if(m){let T=[0,0,0,0],A=1,M=0;Array.isArray(b)?T=[...b.slice(0,3),b[3]||255].map(N=>N/255):b===!1&&(T=!1),x!==void 0&&(A=x),E!==void 0&&(M=E),this.device.beginRenderPass({framebuffer:a,parameters:{viewport:h,scissorRect:h},clearColor:T,clearDepth:A,clearStencil:M}).end()}}const d={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:h});for(let m=0;m<r.length;m++){const b=r[m],x=c[m],{shouldDrawLayer:E}=x;if(E&&b.props.pickable&&d.pickableCount++,b.isComposite&&d.compositeCount++,b.isDrawable&&x.shouldDrawLayer){const{layerRenderIndex:T,shaderModuleProps:A,layerParameters:M}=x;d.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,T),A.project&&(A.project.viewport=s),b.context.renderPass=e;try{b._drawLayer({renderPass:e,shaderModuleProps:A,uniforms:{layerIndex:T},parameters:M})}catch(F){b.raiseError(F,`drawing ${b} to ${i}`)}}}return d}shouldDrawLayer(e){return!0}getShaderModuleProps(e,r,n){return null}getLayerParameters(e,r,n){return e.props.parameters}_shouldDrawLayer(e,r,n,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;r.layer=e;let s=e.parent;for(;s;){if(!s.props.visible||!s.filterSubLayer(r))return!1;r.layer=s,s=s.parent}if(n){const o=r.layer.id;if(o in i||(i[o]=n(r)),!i[o])return!1}return e.activateViewport(r.viewport),!0}_getShaderModuleProps(e,r,n,i){const a=this.device.canvasContext.cssToDeviceRatio(),s=e.internalState?.propsInTransition||e.props,o={layer:s,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:a,modelMatrix:s.modelMatrix,coordinateSystem:s.coordinateSystem,coordinateOrigin:s.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(r)for(const c of r)QW(o,c.getShaderModuleProps?.(e,o));return QW(o,this.getShaderModuleProps(e,r,o),i)}}function rne(t=0,e={}){const r={},n=(i,a)=>{const s=i.props._offset,o=i.id,c=i.parent&&i.parent.id;let h;if(c&&!(c in e)&&n(i.parent,!1),c in r){const d=r[c]=r[c]||rne(e[c],e);h=d(i,a),r[o]=d}else Number.isFinite(s)?(h=s+(e[c]||0),r[o]=null):h=t;return a&&h>=t&&(t=h+1),e[o]=h,h};return n}function xVe(t,{shaderModuleProps:e,target:r,viewport:n}){const i=e?.project?.devicePixelRatio??t.canvasContext.cssToDeviceRatio(),[,a]=t.canvasContext.getDrawingBufferSize(),s=r?r.height:a,o=n;return[o.x*i,s-(o.y+o.height)*i,o.width*i,o.height*i]}function QW(t,...e){for(const r of e)if(r)for(const n in r)t[n]?Object.assign(t[n],r[n]):t[n]=r[n];return t}class wVe extends l6{constructor(e,r){super(e,r);const n=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),i=e.createTexture({format:"depth16unorm",width:1,height:1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[n],depthStencilAttachment:i})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const r=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],a=i.width*n,s=i.height*n,o=[1,1,1,1];(a!==r.width||s!==r.height)&&r.resize({width:a,height:s}),super.render({...e,clearColor:o,target:r,pass:"shadow"})}getLayerParameters(e,r,n){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,r,n){return{shadow:{project:n.project,drawToShadowMap:!0}}}}const SVe={color:[255,255,255],intensity:1},eG=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],EVe=[0,0,0,200/255];class nne{constructor(e={}){this.id="lighting-effect",this.shadowColor=EVe,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:r,deck:n}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(r),n._addDefaultShaderModule(KW),this.dummyShadowMap=r.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const r in e){const n=e[r];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(r=>r.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:a}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let s=0;s<this.shadowPasses.length;s++)this.shadowPasses[s].render({layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:a,shaderModuleProps:{shadow:{shadowLightId:s,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,r){const n=this.shadow?{project:r.project,shadowMaps:this.shadowPasses.map(s=>s.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},i={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(s=>s.getProjectedLight({layer:e})),pointLights:this.pointLights.map(s=>s.getProjectedLight({layer:e}))},a=e.props.material;return{shadow:n,lighting:i,phongMaterial:a,gouraudMaterial:a}}cleanup(e){for(const r of this.shadowPasses)r.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(KW))}_calculateMatrices(){const e=[];for(const r of this.directionalLights){const n=new kf().lookAt({eye:new Ad(r.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let r=0;r<this.directionalLights.length;r++){const n=new wVe(e);this.shadowPasses[r]=n}}_applyDefaultLights(){const{ambientLight:e,pointLights:r,directionalLights:n}=this;!e&&r.length===0&&n.length===0&&(this.ambientLight=new gVe(SVe),this.directionalLights.push(new JW(eG[0]),new JW(eG[1])))}}class TVe{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,r,{size:n=1,type:i,padding:a=0,copy:s=!1,initialize:o=!1,maxCount:c}){const h=i||e&&e.constructor||Float32Array,d=r*n+a;if(ArrayBuffer.isView(e)){if(d<=e.length)return e;if(d*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new h(e.buffer,0,d)}let m=1/0;c&&(m=c*n+a);const b=this._allocate(h,d,o,m);return e&&s?b.set(e):o||b.fill(0,0,4),this._release(e),b}release(e){this._release(e)}_allocate(e,r,n,i){let a=Math.max(Math.ceil(r*this.opts.overAlloc),1);a>i&&(a=i);const s=this._pool,o=e.BYTES_PER_ELEMENT*a,c=s.findIndex(h=>h.byteLength>=o);if(c>=0){const h=new e(s.splice(c,1)[0],0,a);return n&&h.fill(0),h}return new e(a)}_release(e){if(!ArrayBuffer.isView(e))return;const r=this._pool,{buffer:n}=e,{byteLength:i}=n,a=r.findIndex(s=>s.byteLength>=i);a<0?r.push(n):(a>0||r.length<this.opts.poolSize)&&r.splice(a,0,n),r.length>this.opts.poolSize&&r.shift()}}const mx=new TVe;function eb(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function CVe(t,e){const r=t%e;return r<0?e+r:r}function AVe(t){return[t[12],t[13],t[14]]}function IVe(t){return{left:kv(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:kv(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:kv(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:kv(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:kv(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:kv(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const tG=new Ad;function kv(t,e,r,n){tG.set(t,e,r);const i=tG.len();return{distance:n/i,normal:new Ad(-t/i,-e/i,-r/i)}}function PVe(t){return t-Math.fround(t)}let T1;function QP(t,e){const{size:r=1,startIndex:n=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,a=(i-n)/r;T1=mx.allocate(T1,a,{type:Float32Array,size:r*2});let s=n,o=0;for(;s<i;){for(let c=0;c<r;c++){const h=t[s++];T1[o+c]=h,T1[o+c+r]=PVe(h)}o+=r*2}return T1.subarray(0,a*r*2)}function kVe(t){let e=null,r=!1;for(const n of t)n&&(e?(r||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],r=!0),e[0][0]=Math.min(e[0][0],n[0][0]),e[0][1]=Math.min(e[0][1],n[0][1]),e[1][0]=Math.max(e[1][0],n[1][0]),e[1][1]=Math.max(e[1][1],n[1][1])):e=n);return e}const RVe=Math.PI/180,MVe=eb(),rG=[0,0,0],DVe={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function OVe({width:t,height:e,orthographic:r,fovyRadians:n,focalDistance:i,padding:a,near:s,far:o}){const c=t/e,h=r?new kf().orthographic({fovy:n,aspect:c,focalDistance:i,near:s,far:o}):new kf().perspective({fovy:n,aspect:c,near:s,far:o});if(a){const{left:d=0,right:m=0,top:b=0,bottom:x=0}=a,E=gd((d+t-m)/2,0,t)-t/2,T=gd((b+e-x)/2,0,e)-e/2;h[8]-=E*2/t,h[9]+=T*2/e}return h}class I_{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||DVe,this.focalDistance=e.focalDistance||1,this.position=e.position||rG,this.modelMatrix=e.modelMatrix||null;const{longitude:r,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(r),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?sh.WEB_MERCATOR:sh.WEB_MERCATOR_AUTO_OFFSET:sh.IDENTITY}equals(e){return e instanceof I_?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&dx(e.projectionMatrix,this.projectionMatrix)&&dx(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:r=!0}={}){const n=this.projectPosition(e),i=ene(n,this.pixelProjectionMatrix),[a,s]=i,o=r?s:this.height-s;return e.length===2?[a,o]:[a,o,i[2]]}unproject(e,{topLeft:r=!0,targetZ:n}={}){const[i,a,s]=e,o=r?a:this.height-a,c=n&&n*this.distanceScales.unitsPerMeter[2],h=s6([i,o,s],this.pixelUnprojectionMatrix,c),[d,m,b]=this.unprojectPosition(h);return Number.isFinite(s)?[d,m,b]:Number.isFinite(n)?[d,m,n]:[d,m]}projectPosition(e){const[r,n]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[r,n,i]}unprojectPosition(e){const[r,n]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[r,n,i]}projectFlat(e){if(this.isGeospatial){const r=px(e);return r[1]=gd(r[1],-318,830),r}return e}unprojectFlat(e){return this.isGeospatial?a_(e):e}getBounds(e={}){const r={targetZ:e.z||0},n=this.unproject([0,0],r),i=this.unproject([this.width,0],r),a=this.unproject([0,this.height],r),s=this.unproject([this.width,this.height],r);return[Math.min(n[0],i[0],a[0],s[0]),Math.min(n[1],i[1],a[1],s[1]),Math.max(n[0],i[0],a[0],s[0]),Math.max(n[1],i[1],a[1],s[1])]}getDistanceScales(e){return e&&this.isGeospatial?hD({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:r,width:n=1,height:i=1}){return e<this.x+this.width&&this.x<e+n&&r<this.y+this.height&&this.y<r+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,IVe(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,r,n){return null}_initProps(e){const r=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=$Ue({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||hD({latitude:n,longitude:r}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:a,modelMatrix:s}=e;let o=rG;if(a&&(o=s?new kf(s).transformAsVector(a,[]):a),this.isGeospatial){const c=this.projectPosition([r,n,0]);this.center=new Ad(o).scale(this.distanceScales.unitsPerMeter).add(c)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:r=MVe,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:a,fovy:s=75,near:o=.1,far:c=1e3,padding:h=null,focalDistance:d=1}=e;this.viewMatrixUncentered=r,this.viewMatrix=new kf().multiplyRight(r).translate(new Ad(this.center).negate()),this.projectionMatrix=n||OVe({width:this.width,height:this.height,orthographic:i,fovyRadians:a||s*RVe,focalDistance:d,padding:h,near:o,far:c});const m=eb();Hm(m,m,this.projectionMatrix),Hm(m,m,this.viewMatrix),this.viewProjectionMatrix=m,this.viewMatrixInverse=rD([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=AVe(this.viewMatrixInverse);const b=eb(),x=eb();n6(b,b,[this.width/2,-this.height/2,1]),_T(b,b,[1,-1,0]),Hm(x,b,this.viewProjectionMatrix),this.pixelProjectionMatrix=x,this.pixelUnprojectionMatrix=rD(eb(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||po.warn("Pixel project matrix not invertible")()}}I_.displayName="Viewport";class yy extends I_{constructor(e={}){const{latitude:r=0,longitude:n=0,zoom:i=0,pitch:a=0,bearing:s=0,nearZMultiplier:o=.1,farZMultiplier:c=1.01,nearZ:h,farZ:d,orthographic:m=!1,projectionMatrix:b,repeat:x=!1,worldOffset:E=0,position:T,padding:A,legacyMeterSizes:M=!1}=e;let{width:F,height:N,altitude:O=1.5}=e;const U=Math.pow(2,i);F=F||1,N=N||1;let j,H=null;if(b)O=b[5]/2,j=gx(O);else{e.fovy?(j=e.fovy,O=o6(j)):j=gx(O);let X;if(A){const{top:ae=0,bottom:Q=0}=A;X=[0,gd((ae+N-Q)/2,0,N)-N/2]}H=HUe({width:F,height:N,scale:U,center:T&&[0,0,T[2]*NS(r)],offset:X,pitch:a,fovy:j,nearZMultiplier:o,farZMultiplier:c}),Number.isFinite(h)&&(H.near=h),Number.isFinite(d)&&(H.far=d)}let G=qUe({height:N,pitch:a,bearing:s,scale:U,altitude:O});E&&(G=new kf().translate([512*E,0,0]).multiplyLeft(G)),super({...e,width:F,height:N,viewMatrix:G,longitude:n,latitude:r,zoom:i,...H,fovy:j,focalDistance:O}),this.latitude=r,this.longitude=n,this.zoom=i,this.pitch=a,this.bearing=s,this.altitude=O,this.fovy=j,this.orthographic=m,this._subViewports=x?[]:null,this._pseudoMeters=M,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),r=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let i=r;i<=n;i++){const a=i?new yy({...this,worldOffset:i}):this;this._subViewports.push(a)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[r,n]=this.projectFlat(e),i=(e[2]||0)*NS(e[1]);return[r,n,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[r,n]=this.unprojectFlat(e),i=(e[2]||0)/NS(n);return[r,n,i]}addMetersToLngLat(e,r){return Qre(e,r)}panByPosition(e,r,n){const i=s6(r,this.pixelUnprojectionMatrix),a=this.projectFlat(e),s=AW([],a,T7e([],i)),o=AW([],this.center,s),[c,h]=this.unprojectFlat(o);return{longitude:c,latitude:h}}getBounds(e={}){const r=XUe(this,e.z||0);return[Math.min(r[0][0],r[1][0],r[2][0],r[3][0]),Math.min(r[0][1],r[1][1],r[2][1],r[3][1]),Math.max(r[0][0],r[1][0],r[2][0],r[3][0]),Math.max(r[0][1],r[1][1],r[2][1],r[3][1])]}fitBounds(e,r={}){const{width:n,height:i}=this,{longitude:a,latitude:s,zoom:o}=WUe({width:n,height:i,bounds:e,...r});return new yy({width:n,height:i,longitude:a,latitude:s,zoom:o})}}yy.displayName="WebMercatorViewport";const nG=[0,0,0];function ek(t,e,r=!1){const n=e.projectPosition(t);if(r&&e instanceof yy){const[i,a,s=0]=t,o=e.getDistanceScales([i,a]);n[2]=s*o.unitsPerMeter[2]}return n}function NVe(t){const{viewport:e,modelMatrix:r,coordinateOrigin:n}=t;let{coordinateSystem:i,fromCoordinateSystem:a,fromCoordinateOrigin:s}=t;return i===Xa.DEFAULT&&(i=e.isGeospatial?Xa.LNGLAT:Xa.CARTESIAN),a===void 0&&(a=i),s===void 0&&(s=n),{viewport:e,coordinateSystem:i,coordinateOrigin:n,modelMatrix:r,fromCoordinateSystem:a,fromCoordinateOrigin:s}}function ine(t,{viewport:e,modelMatrix:r,coordinateSystem:n,coordinateOrigin:i,offsetMode:a}){let[s,o,c=0]=t;switch(r&&([s,o,c]=A_([],[s,o,c,1],r)),n){case Xa.LNGLAT:return ek([s,o,c],e,a);case Xa.LNGLAT_OFFSETS:return ek([s+i[0],o+i[1],c+(i[2]||0)],e,a);case Xa.METER_OFFSETS:return ek(Qre(i,[s,o,c]),e,a);case Xa.CARTESIAN:default:return e.isGeospatial?[s+i[0],o+i[1],c+i[2]]:e.projectPosition([s,o,c])}}function LVe(t,e){const{viewport:r,coordinateSystem:n,coordinateOrigin:i,modelMatrix:a,fromCoordinateSystem:s,fromCoordinateOrigin:o}=NVe(e),{autoOffset:c=!0}=e,{geospatialOrigin:h=nG,shaderCoordinateOrigin:d=nG,offsetMode:m=!1}=c?Kre(r,n,i):{},b=ine(t,{viewport:r,modelMatrix:a,coordinateSystem:s,coordinateOrigin:o,offsetMode:m});if(m){const x=r.projectPosition(h||d);Lre(b,b,x)}return b}let FVe=1,BVe=1;class ane{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:r=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:a=1}=e,s=FVe++,o={time:0,delay:r,duration:n,rate:i,repeat:a};return this._setChannelTime(o,this.time),this.channels.set(s,o),s}removeChannel(e){this.channels.delete(e);for(const[r,n]of this.animations)n.channel===e&&this.detachAnimation(r)}isFinished(e){const r=this.channels.get(e);return r===void 0?!1:this.time>=r.delay+r.duration*r.repeat}getTime(e){if(e===void 0)return this.time;const r=this.channels.get(e);return r===void 0?-1:r.time}setTime(e){this.time=Math.max(0,e);const r=this.channels.values();for(const i of r)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:a,channel:s}=i;a.setTime(this.getTime(s))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,r){const n=BVe++;return this.animations.set(n,{animation:e,channel:r}),e.setTime(this.getTime(r)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,r){const n=r-e.delay,i=e.duration*e.repeat;n>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}function zVe(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function jVe(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}let UVe=0;class u6{static defaultAnimationLoopProps={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:JM.stats.get(`animation-loop-${UVe++}`),autoResizeViewport:!1};device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...u6.defaultAnimationLoopProps,...e},e=this.props,!e.device)throw new Error("No device provided");this.stats=e.stats||new W3({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}reportError(e){this.props.onError(e),this._error=e}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const r=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(r),r}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=zVe(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(jVe(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.getDefaultCanvasContext();if(!this.device||!e)throw new Error("loop");const r=e?.canvas,n=e.props.useDevicePixels;this.animationProps={animationLoop:this,device:this.device,canvasContext:e,canvas:r,useDevicePixels:n,timeline:this.timeline,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:r,aspect:n}=this._getSizeAndAspect();(e!==this.animationProps.width||r!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=r,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.getDefaultCanvasContext().canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const r=document.createElement("div");r.style.position="absolute",r.style.left="10px",r.style.bottom="10px",r.style.width="300px",r.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(r);const n=this.props.onAddHTML(r);n&&(r.innerHTML=n)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,r]=this.device?.getDefaultCanvasContext().getDevicePixelSize()||[1,1];let n=1;const i=this.device?.getDefaultCanvasContext().canvas;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:e>0&&r>0&&(n=e/r),{width:e,height:r,aspect:n}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}const tk={};function s2(t="id"){tk[t]=tk[t]||1;const e=tk[t]++;return`${t}-${e}`}class iG{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||s2("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&jo.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function VVe(t,e){if(e instanceof iG)return e;const r=$Ve(t,e),{attributes:n,bufferLayout:i}=qVe(t,e);return new iG({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:r,attributes:n})}function $Ve(t,e){if(!e.indices)return;const r=e.indices.value;return t.createBuffer({usage:jo.INDEX,data:r})}function qVe(t,e){const r=[],n={};for(const[a,s]of Object.entries(e.attributes)){let o=a;switch(a){case"POSITION":o="positions";break;case"NORMAL":o="normals";break;case"TEXCOORD_0":o="texCoords";break;case"COLOR_0":o="colors";break}if(s){n[o]=t.createBuffer({data:s.value,id:`${a}-buffer`});const{value:c,size:h,normalized:d}=s;r.push({name:o,format:zze(c,h,d)})}}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:n,bufferLayout:r,vertexCount:i}}class c6{static defaultProps={...qm.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new c6(e),e._lumaData.defaultPipelineFactory}device;cachingEnabled;destroyPolicy;debug;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};get[Symbol.toStringTag](){return"PipelineFactory"}toString(){return`PipelineFactory(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cachePipelines,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=e.props.debugFactories}createRenderPipeline(e){if(!this.cachingEnabled)return this.device.createRenderPipeline(e);const r={...qm.defaultProps,...e},n=this._renderPipelineCache,i=this._hashRenderPipeline(r);let a=n[i]?.pipeline;return a?(n[i].useCount++,this.debug&&rn.log(3,`${this}: ${n[i].pipeline} reused, count=${n[i].useCount}, (id=${e.id})`)()):(a=this.device.createRenderPipeline({...r,id:r.id?`${r.id}-cached`:s2("unnamed-cached")}),a.hash=i,n[i]={pipeline:a,useCount:1},this.debug&&rn.log(3,`${this}: ${a} created, count=${n[i].useCount}`)()),a}createComputePipeline(e){if(!this.cachingEnabled)return this.device.createComputePipeline(e);const r={...hT.defaultProps,...e},n=this._computePipelineCache,i=this._hashComputePipeline(r);let a=n[i]?.pipeline;return a?(n[i].useCount++,this.debug&&rn.log(3,`${this}: ${n[i].pipeline} reused, count=${n[i].useCount}, (id=${e.id})`)()):(a=this.device.createComputePipeline({...r,id:r.id?`${r.id}-cached`:void 0}),a.hash=i,n[i]={pipeline:a,useCount:1},this.debug&&rn.log(3,`${this}: ${a} created, count=${n[i].useCount}`)()),a}release(e){if(!this.cachingEnabled){e.destroy();return}const r=this._getCache(e),n=e.hash;r[n].useCount--,r[n].useCount===0?(this._destroyPipeline(e),this.debug&&rn.log(3,`${this}: ${e} released and destroyed`)()):r[n].useCount<0?(rn.error(`${this}: ${e} released, useCount < 0, resetting`)(),r[n].useCount=0):this.debug&&rn.log(3,`${this}: ${e} released, count=${r[n].useCount}`)()}_destroyPipeline(e){const r=this._getCache(e);switch(this.destroyPolicy){case"never":return!1;case"unused":return delete r[e.hash],e.destroy(),!0}}_getCache(e){let r;if(e instanceof hT&&(r=this._computePipelineCache),e instanceof qm&&(r=this._renderPipelineCache),!r)throw new Error(`${this}`);if(!r[e.hash])throw new Error(`${this}: ${e} matched incorrect entry`);return r}_hashComputePipeline(e){const{type:r}=this.device,n=this._getHash(e.shader.source);return`${r}/C/${n}`}_hashRenderPipeline(e){const r=e.vs?this._getHash(e.vs.source):0,n=e.fs?this._getHash(e.fs.source):0,i="-",a=this._getHash(JSON.stringify(e.bufferLayout)),{type:s}=this.device;switch(s){case"webgl":return`${s}/R/${r}/${n}V${i}BL${a}`;case"webgpu":default:const o=this._getHash(JSON.stringify(e.parameters));return`${s}/R/${r}/${n}V${i}T${e.topology}P${o}BL${a}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}class h6{static defaultProps={...Z3.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new h6(e),e._lumaData.defaultShaderFactory}device;cachingEnabled;destroyPolicy;debug;_cache={};get[Symbol.toStringTag](){return"ShaderFactory"}toString(){return`${this[Symbol.toStringTag]}(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cacheShaders,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=!0}createShader(e){if(!this.cachingEnabled)return this.device.createShader(e);const r=this._hashShader(e);let n=this._cache[r];if(n)n.useCount++,this.debug&&rn.log(3,`${this}: Reusing shader ${n.shader.id} count=${n.useCount}`)();else{const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[r]=n={shader:i,useCount:1},this.debug&&rn.log(3,`${this}: Created new shader ${i.id}`)()}return n.shader}release(e){if(!this.cachingEnabled){e.destroy();return}const r=this._hashShader(e),n=this._cache[r];if(n)if(n.useCount--,n.useCount===0)this.destroyPolicy==="unused"&&(delete this._cache[r],n.shader.destroy(),this.debug&&rn.log(3,`${this}: Releasing shader ${e.id}, destroyed`)());else{if(n.useCount<0)throw new Error(`ShaderFactory: Shader ${e.id} released too many times`);this.debug&&rn.log(3,`${this}: Releasing shader ${e.id} count=${n.useCount}`)()}}_hashShader(e){return`${e.stage}:${e.source}`}}function HVe(t,e){const r={},n="Values";if(t.attributes.length===0&&!t.varyings?.length)return{"No attributes or varyings":{[n]:"N/A"}};for(const i of t.attributes)if(i){const a=`${i.location} ${i.name}: ${i.type}`;r[`in ${a}`]={[n]:i.stepMode||"vertex"}}for(const i of t.varyings||[]){const a=`${i.location} ${i.name}`;r[`out ${a}`]={[n]:JSON.stringify(i)}}return r}let ru=null,rk=null;function WVe(t,{id:e,minimap:r,opaque:n,top:i="0",left:a="0",rgbaScale:s=1}){ru||(ru=document.createElement("canvas"),ru.id=e,ru.title=e,ru.style.zIndex="100",ru.style.position="absolute",ru.style.top=i,ru.style.left=a,ru.style.border="blue 5px solid",ru.style.transform="scaleY(-1)",document.body.appendChild(ru),rk=ru.getContext("2d")),(ru.width!==t.width||ru.height!==t.height)&&(ru.width=t.width/2,ru.height=t.height/2,ru.style.width="400px",ru.style.height="400px");const o=t.device.readPixelsToArrayWebGL(t),c=rk?.createImageData(t.width,t.height);if(c){for(let d=0;d<o.length;d+=4)c.data[0+d+0]=o[d+0]*s,c.data[0+d+1]=o[d+1]*s,c.data[0+d+2]=o[d+2]*s,c.data[0+d+3]=n?255:o[d+3]*s;rk?.putImageData(c,0,0)}}function fD(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!fD(t[n],e[n],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const a of n)if(!e.hasOwnProperty(a)||!fD(t[a],e[a],r-1))return!1;return!0}return!1}class nk{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(r=>r.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(r=>r.attribute):[e.name]}mergeBufferLayouts(e,r){const n=[...e];for(const i of r){const a=n.findIndex(s=>s.name===i.name);a<0?n.push(i):n[a]=i}return n}getBufferIndex(e){const r=this.bufferLayouts.findIndex(n=>n.name===e);return r===-1&&rn.warn(`BufferLayout: Missing buffer for "${e}".`)(),r}}function GVe(t,e){const r=Object.fromEntries(t.attributes.map(i=>[i.name,i.location])),n=e.slice();return n.sort((i,a)=>{const s=i.attributes?i.attributes.map(d=>d.attribute):[i.name],o=a.attributes?a.attributes.map(d=>d.attribute):[a.name],c=Math.min(...s.map(d=>r[d])),h=Math.min(...o.map(d=>r[d]));return c-h}),n}function XVe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function YVe(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":!1}function ZVe(t){return XVe(t)||YVe(t)}function KVe(t){return ZVe(t)||typeof t=="number"||typeof t=="boolean"}function JVe(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(r=>{const n=t[r];KVe(n)?e.uniforms[r]=n:e.bindings[r]=n}),e}class QVe{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,r){Object.assign(this.options,r);const n=FL(Object.values(e).filter(i=>i.dependencies));for(const i of n)e[i.name]=i;rn.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[i,a]of Object.entries(e))this._addModule(a),a.name&&i!==a.name&&!this.options.disableWarnings&&rn.warn(`Module name: ${i} vs ${a.name}`)()}destroy(){}setProps(e){for(const r of Object.keys(e)){const n=r,i=e[n]||{},a=this.modules[n];if(!a){this.options.disableWarnings||rn.warn(`Module ${r} not found`)();continue}const s=this.moduleUniforms[n],o=this.moduleBindings[n],c=a.getUniforms?.(i,s)||i,{uniforms:h,bindings:d}=JVe(c);this.moduleUniforms[n]={...s,...h},this.moduleBindings[n]={...o,...d}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const r of Object.values(this.moduleBindings))Object.assign(e,r);return e}getDebugTable(){const e={};for(const[r,n]of Object.entries(this.moduleUniforms))for(const[i,a]of Object.entries(n))e[`${r}.${i}`]={type:this.modules[r].uniformTypes?.[i],value:String(a)};return e}_addModule(e){const r=e.name;this.moduleUniforms[r]=e.defaultUniforms||{},this.moduleBindings[r]={}}}let e$e="";async function t$e(t,e){const r=new Image;return r.crossOrigin="anonymous",r.src=t.startsWith("http")?t:e$e+t,await r.decode(),e?await createImageBitmap(r,e):await createImageBitmap(r)}const r$e=["+X","-X","+Y","-Y","+Z","-Z"],n$e=["+X","-X","+Y","-Y","+Z","-Z"];class Cb{device;id;props;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,r){this.device=e;const n=s2("async-texture");this.props={...Cb.defaultProps,id:n,...r},this.id=this.props.id,r={...r},typeof r?.data=="string"&&r.dimension==="2d"&&(r.data=t$e(r.data)),r.mipmaps&&(r.mipLevels="auto"),this.ready=new Promise((i,a)=>{this.resolveReady=()=>{this.isReady=!0,i()},this.rejectReady=a}),this.initAsync(r)}async initAsync(e){const r=e.data,n=await one(r).then(void 0,this.rejectReady);if(this.destroyed)return;const i=this.props.width&&this.props.height?{width:this.props.width,height:this.props.height}:this.getTextureDataSize(n);if(!i)throw new Error("Texture size could not be determined");const a={...i,...e,data:void 0,mipLevels:1},s=this.device.getMipLevelCount(a.width,a.height);if(a.mipLevels=this.props.mipLevels==="auto"?s:Math.min(s,this.props.mipLevels),this.texture=this.device.createTexture(a),this.sampler=this.texture.sampler,this.view=this.texture.view,e.data)switch(this.props.dimension){case"1d":this._setTexture1DData(this.texture,n);break;case"2d":this._setTexture2DData(n);break;case"3d":this._setTexture3DData(this.texture,n);break;case"2d-array":this._setTextureArrayData(this.texture,n);break;case"cube":this._setTextureCubeData(this.texture,n);break;case"cube-array":this._setTextureCubeArrayData(this.texture,n);break}this.props.mipmaps&&this.generateMipmaps(),rn.info(1,`${this} loaded`),this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}generateMipmaps(){this.texture.generateMipmapsWebGL()}setSampler(e={}){this.texture.setSampler(e instanceof dy?e:this.device.createSampler(e))}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const r=this.texture;this.texture=r.clone(e),r.destroy()}return!0}isTextureLevelData(e){const r=e?.data;return ArrayBuffer.isView(r)}getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return this.getTextureDataSize(e[0]);if(this.device.isExternalImage(e))return this.device.getExternalImageSize(e);if(e&&typeof e=="object"&&e.constructor===Object){const n=Object.values(e)[0];return{width:n.width,height:n.height}}throw new Error("texture size deduction failed")}getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}setTextureData(e){}_setTexture1DData(e,r){throw new Error("setTexture1DData not supported in WebGL.")}_setTexture2DData(e,r=0){if(!this.texture)throw new Error("Texture not initialized");const n=this._normalizeTextureData(e);n.length>1&&this.props.mipmaps!==!1&&rn.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let i=0;i<n.length;i++){const a=n[i];this.device.isExternalImage(a)?this.texture.copyExternalImage({image:a,depth:r,mipLevel:i,flipY:!0}):this.texture.copyImageData({data:a.data,mipLevel:i})}}_setTexture3DData(e,r){if(this.texture?.props.dimension!=="3d")throw new Error(this.id);for(let n=0;n<r.length;n++)this._setTexture2DData(r[n],n)}_setTextureCubeData(e,r){if(this.texture?.props.dimension!=="cube")throw new Error(this.id);for(const[n,i]of Object.entries(r)){const a=n$e.indexOf(n);this._setTexture2DData(i,a)}}_setTextureArrayData(e,r){if(this.texture?.props.dimension!=="2d-array")throw new Error(this.id);for(let n=0;n<r.length;n++)this._setTexture2DData(r[n],n)}_setTextureCubeArrayData(e,r){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}_setTextureCubeFaceData(e,r,n,i=0){Array.isArray(r)&&r.length>1&&this.props.mipmaps!==!1&&rn.warn(`${this.id} has mipmap and multiple LODs.`)();const a=r$e.indexOf(n);this._setTexture2DData(r,a)}_normalizeTextureData(e){const r=this.texture;let n;return ArrayBuffer.isView(e)?n=[{data:e,width:r.width,height:r.height}]:Array.isArray(e)?n=e:n=[e],n}static defaultProps={...Fl.defaultProps,data:null,mipmaps:!1}}async function one(t){if(t=await t,Array.isArray(t))return await Promise.all(t.map(one));if(t&&typeof t=="object"&&t.constructor===Object){const e=t,r=await Promise.all(Object.values(e)),n=Object.keys(e),i={};for(let a=0;a<n.length;a++)i[n[a]]=r[a];return i}return t}const gm=2,i$e=1e4;class ST{static defaultProps={...qm.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Mm.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,r){this.props={...ST.defaultProps,...r},r=this.props,this.id=r.id||s2("model"),this.device=e,Object.assign(this.userData,r.userData);const n=Object.fromEntries(this.props.modules?.map(c=>[c.name,c])||[]),i=r.shaderInputs||new QVe(n,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(i);const a=o$e(e),s=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){const{source:c,getUniforms:h}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:a,...this.props,modules:s});this.source=c,this._getModuleUniforms=h,this.props.shaderLayout||=f7e(this.source)}else{const{vs:c,fs:h,getUniforms:d}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:a,...this.props,modules:s});this.vs=c,this.fs=h,this._getModuleUniforms=d}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,r.geometry&&this.setGeometry(r.geometry),this.pipelineFactory=r.pipelineFactory||c6.getDefaultPipelineFactory(this.device),this.shaderFactory=r.shaderFactory||h6.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in r&&(this.isInstanced=r.isInstanced),r.instanceCount&&this.setInstanceCount(r.instanceCount),r.vertexCount&&this.setVertexCount(r.vertexCount),r.indexBuffer&&this.setIndexBuffer(r.indexBuffer),r.attributes&&this.setAttributes(r.attributes),r.constantAttributes&&this.setConstantAttributes(r.constantAttributes),r.bindings&&this.setBindings(r.bindings),r.transformFeedback&&(this.transformFeedback=r.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const r=this._areBindingsLoading();if(r)return rn.info(gm,`>>> DRAWING ABORTED ${this.id}: ${r} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let n;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const i=this._getBindings();this.pipeline.setBindings(i,{disableWarnings:this.props.disableWarnings});const{indexBuffer:a}=this.vertexArray,s=a?a.byteLength/(a.indexType==="uint32"?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){this._gpuGeometry?.destroy();const r=e&&VVe(this.device,e);if(r){this.setTopology(r.topology||"triangle-list");const n=new nk(this.bufferLayout);this.bufferLayout=n.mergeBufferLayouts(r.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(r)}this._gpuGeometry=r}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const r=new nk(this.bufferLayout);this.bufferLayout=this._gpuGeometry?r.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){fD(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new L9e(this.shaderInputs.modules);for(const[r,n]of Object.entries(this.shaderInputs.modules))if(a$e(n)){const i=this._uniformStore.getManagedUniformBuffer(this.device,r);this.bindings[`${r}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,r){const n=r?.disableWarnings??this.props.disableWarnings;e.indices&&rn.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=GVe(this.pipeline.shaderLayout,this.bufferLayout);const i=new nk(this.bufferLayout);for(const[a,s]of Object.entries(e)){const o=i.getBufferLayout(a);if(!o){n||rn.warn(`Model(${this.id}): Missing layout for buffer "${a}".`)();continue}const c=i.getAttributeNamesForBuffer(o);let h=!1;for(const d of c){const m=this._attributeInfos[d];if(m){const b=this.device.type==="webgpu"?i.getBufferIndex(m.bufferName):m.location;this.vertexArray.setBuffer(b,s),h=!0}}!h&&!n&&rn.warn(`Model(${this.id}): Ignoring buffer "${s.id}" for unknown attribute "${a}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,r){for(const[n,i]of Object.entries(e)){const a=this._attributeInfos[n];a?this.vertexArray.setConstantWebGL(a.location,i):(r?.disableWarnings??this.props.disableWarnings)||rn.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof Cb&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[r,n]of Object.entries(this.bindings))n instanceof Cb?n.isReady&&(e[r]=n.texture):e[r]=n;return e}_getBindingsUpdateTimestamp(){let e=0;for(const r of Object.values(this.bindings))r instanceof Y3?e=Math.max(e,r.texture.updateTimestamp):r instanceof jo||r instanceof Fl?e=Math.max(e,r.updateTimestamp):r instanceof Cb?e=r.texture?Math.max(e,r.texture.updateTimestamp):1/0:r instanceof dy||(e=Math.max(e,r.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const r={...e.attributes};for(const[n]of Object.entries(r))!this.pipeline.shaderLayout.attributes.find(i=>i.name===n)&&n!=="positions"&&delete r[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(r,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,r=null;this.pipeline&&(rn.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,r=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let i=null;this.source?i=n:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:i}),this._attributeInfos=ure(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),r&&this.shaderFactory.release(r)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=rn.level>3?0:i$e;rn.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,rn.group(gm,`>>> DRAWING MODEL ${this.id}`,{collapsed:rn.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=HVe(this.pipeline.shaderLayout,this.id);rn.table(gm,e)();const r=this.shaderInputs.getDebugTable();rn.table(gm,r)();const n=this._getAttributeDebugTable();rn.table(gm,this._attributeInfos)(),rn.table(gm,n)(),rn.groupEnd(gm)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const r=this.device.props.debugFramebuffers;if(this._drawCount++,!r)return;const n=e.props.framebuffer;n&&WVe(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[r,n]of Object.entries(this._attributeInfos)){const i=this.vertexArray.attributes[n.location];e[n.location]={name:r,type:n.shaderType,values:i?this._getBufferOrConstantValues(i,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:r}=this.vertexArray,n=r.indexType==="uint32"?new Uint32Array(r.debugData):new Uint16Array(r.debugData);e.indices={name:"indices",type:r.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,r){const n=zL(r);return(e instanceof jo?new n(e.debugData):e).toString()}}function a$e(t){return!!(t.uniformTypes&&!s$e(t.uniformTypes))}function o$e(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function s$e(t){for(const e in t)return!1;return!0}class o_{device;model;transformFeedback;static defaultProps={...ST.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return e?.info?.type==="webgl"}constructor(e,r=o_.defaultProps){if(!o_.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new ST(this.device,{id:r.id||"buffer-transform-model",fs:r.fs||Rze(),topology:r.topology||"point-list",varyings:r.outputs||r.varyings,...r}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:r.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const r=this.device.beginRenderPass(e);this.model.draw(r),r.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const r=this.getBuffer(e);if(!r)throw new Error("BufferTransform#getBuffer");if(r instanceof jo)return r.readAsync();const{buffer:n,byteOffset:i=0,byteLength:a=n.byteLength}=r;return n.readAsync(i,a)}}class JGe{id;topology;vertexCount;indices;attributes;userData={};constructor(e){const{attributes:r={},indices:n=null,vertexCount:i=null}=e;this.id=e.id||s2("geometry"),this.topology=e.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[a,s]of Object.entries(r)){const o=ArrayBuffer.isView(s)?{value:s}:s;if(!ArrayBuffer.isView(o.value))throw new Error(`${this._print(a)}: must be typed array or object with value as typed array`);if((a==="POSITION"||a==="positions")&&!o.size&&(o.size=3),a==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=o}else this.attributes[a]=o}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,r){return this}_calculateVertexCount(e,r){if(r)return r.value.length;let n=1/0;for(const i of Object.values(e)){const{value:a,size:s,constant:o}=i;!o&&a&&s!==void 0&&s>=1&&(n=Math.min(n,a.length/s))}return n}}const l$e={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant",blendAlphaDstFactor:"zero"};class sne extends l6{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:r,views:n,viewports:i,onViewportActive:a,pickingFBO:s,deviceRect:{x:o,y:c,width:h,height:d},cullRect:m,effects:b,pass:x="picking",pickZ:E,shaderModuleProps:T}){this.pickZ=E;const A=this._resetColorEncoder(E),M=[o,c,h,d],F=super.render({target:s,layers:e,layerFilter:r,views:n,viewports:i,onViewportActive:a,cullRect:m,effects:b?.filter(O=>O.useInPicking),pass:x,isPicking:!0,shaderModuleProps:T,clearColor:[0,0,0,0],colorMask:15,scissorRect:M});return this._colorEncoderState=null,{decodePickingColor:A&&c$e.bind(null,A),stats:F}}shouldDrawLayer(e){const{pickable:r,operation:n}=e.props;return r&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getShaderModuleProps(e,r,n){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,r,n){const i={...e.props.parameters},{pickable:a,operation:s}=e.props;return!this._colorEncoderState||s.includes("terrain")?i.blend=!1:a&&s.includes("draw")&&(Object.assign(i,l$e),i.blend=!0,i.blendColor=u$e(this._colorEncoderState,e,n)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function u$e(t,e,r){const{byLayer:n,byAlpha:i}=t;let a,s=n.get(e);return s?(s.viewports.push(r),a=s.a):(a=n.size+1,a<=255?(s={a,layer:e,viewports:[r]},n.set(e,s),i[a]=s):(po.warn("Too many pickable layers, only picking the first 255")(),a=0)),[0,0,0,a/255]}function c$e(t,e){const r=t.byAlpha[e[3]];return r&&{pickedLayer:r.layer,pickedViewports:r.viewports,pickedObjectIndex:r.layer.decodePickingColor(e)}}const r0={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},ET=Symbol.for("component"),Wm=Symbol.for("propTypes"),ik=Symbol.for("deprecatedProps"),D0=Symbol.for("asyncPropDefaults"),vy=Symbol.for("asyncPropOriginal"),yg=Symbol.for("asyncPropResolved");function Dg(t,e=()=>!0){return Array.isArray(t)?lne(t,e,[]):e(t)?[t]:[]}function lne(t,e,r){let n=-1;for(;++n<t.length;){const i=t[n];Array.isArray(i)?lne(i,e,r):e(i)&&r.push(i)}return r}function h$e({target:t,source:e,start:r=0,count:n=1}){const i=e.length,a=n*i;let s=0;for(let o=r;s<i;s++)t[o++]=e[s];for(;s<a;)s<a-s?(t.copyWithin(r+s,r,r+s),s*=2):(t.copyWithin(r+s,r,r+a-s),s=a);return t}class f$e{constructor(e,r,n){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=n,this.setData(r)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,r){if(e===this._data&&!r)return;this._data=e;const n=++this._loadCount;let i=e;typeof e=="string"&&(i=WM(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(a=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=a)}).catch(a=>{this._loadCount===n&&(this.isLoaded=!0,this._error=a||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const a of this._subscribers)a.onChange(this.getData())}}class d$e{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:r,forceUpdate:n=!1,persistent:i=!0}){let a=this._resources[e];a?a.setData(r,n):(a=new f$e(e,r,this._context),this._resources[e]=a),a.persistent=i}remove(e){const r=this._resources[e];r&&(r.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const r=this._consumers[e];if(r){for(const n in r){const i=r[n],a=this._resources[i.resourceId];a&&a.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:r,consumerId:n,requestId:i="default"}){const{_resources:a,protocol:s}=this;e.startsWith(s)&&(e=e.replace(s,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=a[e];if(this._track(n,i,o,r),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,r,n,i){const a=this._consumers,s=a[e]=a[e]||{};let o=s[r];const c=o&&o.resourceId&&this._resources[o.resourceId];c&&(c.unsubscribe(o),this.prune()),n&&(o?(o.onChange=i,o.resourceId=n.id):o={onChange:i,resourceId:n.id},s[r]=o,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const r=this._resources[e];!r.persistent&&!r.inUse()&&(r.delete(),delete this._resources[e])}}}const p$e="layerManager.setLayers",g$e="layerManager.activateViewport";class m$e{constructor(e,r){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=o=>{mc(g$e,this,o),o&&(this.context.viewport=o)};const{deck:n,stats:i,viewport:a,timeline:s}=r||{};this.layers=[],this.resourceManager=new d$e({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:n,shaderAssembler:hVe(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[xje],renderPass:void 0,stats:i||new W3({id:"deck.gl"}),viewport:a||new I_({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new ane,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(e);r=r||i}return r}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(r=>e.find(n=>r.id.indexOf(n)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,r){mc(p$e,this,r,e),this._lastRenderedLayers=e;const n=Dg(e,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:r}=this.context;r.find(n=>n.name===e.name)||(r.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:r}=this.context,n=r.findIndex(i=>i.name===e.name);n>=0&&(r.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(e,r,n){n.raiseError(r,`${e} of ${n}`)}_updateLayers(e,r){const n={};for(const s of e)n[s.id]?po.warn(`Multiple old layers with same id ${s.id}`)():n[s.id]=s;if(this._defaultShaderModulesChanged){for(const s of e)s.setNeedsUpdate(),s.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(r,n,i),this._finalizeOldLayers(n);let a=!1;for(const s of i)if(s.hasUniformTransition()){a=`Uniform transition in ${s}`;break}this._needsUpdate=a,this.layers=i}_updateSublayersRecursively(e,r,n){for(const i of e){i.context=this.context;const a=r[i.id];a===null&&po.warn(`Multiple new layers with same id ${i.id}`)(),r[i.id]=null;let s=null;try{this._debug&&a!==i&&i.validateProps(),a?(this._transferLayerState(a,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),s=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}s&&this._updateSublayersRecursively(s,r,n)}}_finalizeOldLayers(e){for(const r in e){const n=e[r];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=r0.INITIALIZED}catch(r){this._handleError("initialization",r,e)}}_transferLayerState(e,r){r._transferState(e),r.lifecycle=r0.MATCHED,r!==e&&(e.lifecycle=r0.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(r){this._handleError("update",r,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=r0.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=r0.FINALIZED}catch(r){this._handleError("finalization",r,e)}}}function Nh(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Nh(t[n],e[n],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const a of n)if(!e.hasOwnProperty(a)||!Nh(t[a],e[a],r-1))return!1;return!0}return!1}class y$e{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const r=this.controllers[e];r&&r.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const r=this.controllers[e];r&&r.updateTransition()}}getViewports(e){return e?this._viewports.filter(r=>r.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(r=>{e[r.id]=r}),e}getView(e){return this.views.find(r=>r.id===e)}getViewState(e){const r=typeof e=="string"?this.getView(e):e,n=r&&this.viewState[r.getViewStateId()]||this.viewState;return r?r.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,r){const n=this.getViewports(),i={x:e[0],y:e[1]};for(let a=n.length-1;a>=0;--a){const s=n[a];if(s.containsPixel(i)){const o=e.slice();return o[0]-=s.x,o[1]-=s.y,s.unproject(o,r)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,r){(e!==this.width||r!==this.height)&&(this.width=e,this.height=r,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Dg(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Nh(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):po.warn("missing `viewState` or `initialViewState`")()}_createController(e,r){const n=r.type;return new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:a=>this.getView(e.id)?.makeViewport({viewState:a,width:this.width,height:this.height})})}_updateController(e,r,n,i){const a=e.controller;if(a&&n){const s={...r,...a,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!i||i.constructor!==a.type)&&(i=this._createController(e,s)),i&&i.setProps(s),i}return null}_rebuildViewports(){const{views:e}=this,r=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=e.length;i--;){const a=e[i],s=this.getViewState(a),o=a.makeViewport({viewState:s,width:this.width,height:this.height});let c=r[a.id];const h=!!a.controller;h&&!c&&(n=!0),(n||!h)&&c&&(c.finalize(),c=null),this.controllers[a.id]=this._updateController(a,s,o,c),o&&this._viewports.unshift(o)}for(const i in r){const a=r[i];a&&!this.controllers[i]&&a.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,r){return e.length!==r.length?!0:e.some((n,i)=>!e[i].equals(r[i]))}}const v$e=/([0-9]+\.?[0-9]*)(%|px)/;function rg(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=v$e.exec(t);if(e&&e.length>=3){const r=e[2]==="%",n=parseFloat(e[1]);return{position:r?n/100:n,relative:r}}default:throw new Error(`Could not parse position string ${t}`)}}function ng(t,e){return t.relative?Math.round(t.position*e):t.position}class une{constructor(e){const{id:r,x:n=0,y:i=0,width:a="100%",height:s="100%",padding:o=null}=e;this.id=r||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=rg(n),this._y=rg(i),this._width=rg(a),this._height=rg(s),this._padding=o&&{left:rg(o.left||0),right:rg(o.right||0),top:rg(o.top||0),bottom:rg(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&Nh(this.props,e.props,2)}clone(e){const r=this.constructor;return new r({...this.props,...e})}makeViewport({width:e,height:r,viewState:n}){n=this.filterViewState(n);const i=this.getDimensions({width:e,height:r});if(!i.height||!i.width)return null;const a=this.getViewportType(n);return new a({...n,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const r={...e};for(const n in this.props.viewState)n!=="id"&&(r[n]=this.props.viewState[n]);return r}return e}getDimensions({width:e,height:r}){const n={x:ng(this._x,e),y:ng(this._y,r),width:ng(this._width,e),height:ng(this._height,r)};return this._padding&&(n.padding={left:ng(this._padding.left,e),top:ng(this._padding.top,r),right:ng(this._padding.right,e),bottom:ng(this._padding.bottom,r)}),n}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class Q3{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:e,settings:r}=this;this._handle=e.addChannel({delay:e.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const aG=()=>{},dD={BREAK:1,SNAP_TO_END:2,IGNORE:3},_$e=t=>t,b$e=dD.BREAK;class x$e{constructor(e){this._onTransitionUpdate=r=>{const{time:n,settings:{interpolator:i,startProps:a,endProps:s,duration:o,easing:c}}=r,h=c(n/o),d=i.interpolateProps(a,s,h);this.propsInTransition=this.getControllerState({...this.props,...d}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Q3(e.timeline),this.onViewStateChange=e.onViewStateChange||aG,this.onStateChange=e.onStateChange||aG}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let r=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let i=n;if(this.transition.inProgress){const{interruption:a,endProps:s}=this.transition.settings;i={...n,...a===dD.SNAP_TO_END?s:this.propsInTransition||n}}this._triggerTransition(i,e),r=!0}else this.transition.cancel();return r}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:r,transitionInterpolator:n}=e;return(r>0||r==="auto")&&!!n}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,r){return this.transition.inProgress?this.transition.settings.interruption===dD.IGNORE||this._isUpdateDueToCurrentTransition(r):this._isTransitionEnabled(r)?r.transitionInterpolator.arePropsEqual(e,r):!0}_triggerTransition(e,r){const n=this.getControllerState(e),i=this.getControllerState(r).shortestPathFrom(n),a=r.transitionInterpolator,s=a.getDuration?a.getDuration(e,r):r.transitionDuration;if(s===0)return;const o=a.initializeProps(e,i);this.propsInTransition={};const c={duration:s,easing:r.transitionEasing||_$e,interpolator:a,interruption:r.transitionInterruption||b$e,startProps:o.start,endProps:o.end,onStart:r.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(r.onTransitionInterrupt),onEnd:this._onTransitionEnd(r.onTransitionEnd)};this.transition.start(c),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return r=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(r)}}}function El(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class w$e{constructor(e){const{compare:r,extract:n,required:i}=e;this._propsToCompare=r,this._propsToExtract=n||r,this._requiredProps=i}arePropsEqual(e,r){for(const n of this._propsToCompare)if(!(n in e)||!(n in r)||!dx(e[n],r[n]))return!1;return!0}initializeProps(e,r){const n={},i={};for(const a of this._propsToExtract)(a in e||a in r)&&(n[a]=e[a],i[a]=r[a]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(e,r){return r.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(r=>{const n=e[r];El(Number.isFinite(n)||Array.isArray(n),`${r} is required for transition`)})}}const Qw=Math.PI/180,oG=180/Math.PI,LS=6370972,p0=256;function S$e(){const t=p0/LS,e=Math.PI/180*p0;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class f6 extends I_{constructor(e={}){const{longitude:r=0,zoom:n=0,nearZMultiplier:i=.5,farZMultiplier:a=1,resolution:s=10}=e;let{latitude:o=0,height:c,altitude:h=1.5,fovy:d}=e;o=Math.max(Math.min(o,md),-md),c=c||1,d?h=o6(d):d=gx(h);const m=Math.pow(2,n-g0(o)),b=e.nearZ??i,x=e.farZ??(h+p0*2*m/c)*a,E=new kf().lookAt({eye:[0,-h,0],up:[0,0,1]});E.rotateX(o*Qw),E.rotateZ(-r*Qw),E.scale(m/c),super({...e,height:c,viewMatrix:E,longitude:r,latitude:o,zoom:n,distanceScales:S$e(),fovy:d,focalDistance:h,near:b,far:x}),this.scale=m,this.latitude=o,this.longitude=r,this.fovy=d,this.resolution=s}get projectionMode(){return sh.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const r={targetZ:e.z||0},n=this.unproject([0,this.height/2],r),i=this.unproject([this.width/2,0],r),a=this.unproject([this.width,this.height/2],r),s=this.unproject([this.width/2,this.height],r);return a[0]<this.longitude&&(a[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],a[0],i[0],s[0]),Math.min(n[1],a[1],i[1],s[1]),Math.max(n[0],a[0],i[0],s[0]),Math.max(n[1],a[1],i[1],s[1])]}unproject(e,{topLeft:r=!0,targetZ:n}={}){const[i,a,s]=e,o=r?a:this.height-a,{pixelUnprojectionMatrix:c}=this;let h;if(Number.isFinite(s))h=ak(c,[i,o,s,1]);else{const x=ak(c,[i,o,-1,1]),E=ak(c,[i,o,1,1]),T=((n||0)/LS+1)*p0,A=GP(Lre([],x,E)),M=GP(x),F=GP(E),O=4*((4*M*F-(A-M-F)**2)/16)/A,U=Math.sqrt(M-O),j=Math.sqrt(Math.max(0,T*T-O)),H=(U-j)/Math.sqrt(A);h=L7e([],x,E,H)}const[d,m,b]=this.unprojectPosition(h);return Number.isFinite(s)?[d,m,b]:Number.isFinite(n)?[d,m,n]:[d,m]}projectPosition(e){const[r,n,i=0]=e,a=r*Qw,s=n*Qw,o=Math.cos(s),c=(i/LS+1)*p0;return[Math.sin(a)*o*c,-Math.cos(a)*o*c,Math.sin(s)*c]}unprojectPosition(e){const[r,n,i]=e,a=$7e(e),s=Math.asin(i/a),c=Math.atan2(r,-n)*oG,h=s*oG,d=(a/p0-1)*LS;return[c,h,d]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition([e,r,n],i,a){const o=.25/Math.pow(2,this.zoom-g0(this.latitude)),c=e+o*(a[0]-i[0]);let h=r-o*(a[1]-i[1]);h=Math.max(Math.min(h,md),-md);const d={longitude:c,latitude:h,zoom:n-g0(r)};return d.zoom+=g0(d.latitude),d}}f6.displayName="GlobeViewport";function g0(t){const e=Math.PI*Math.cos(t*Math.PI/180);return Math.log2(e)}function ak(t,e){const r=A_([],e,t);return zre(r,r,1/r[3]),r}const E$e=["longitude","latitude","zoom","bearing","pitch"],T$e=["longitude","latitude","zoom"];class d6 extends w$e{constructor(e={}){const r=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(r)?{compare:r,required:r}:r||{compare:E$e,required:T$e},super(n.transitionProps),this.opts=n}initializeProps(e,r){const n=super.initializeProps(e,r),{makeViewport:i,around:a}=this.opts;if(i&&a)if(i(e)instanceof f6)po.warn("around not supported in GlobeView")();else{const o=i(e),c=i(r),h=o.unproject(a);n.start.around=a,Object.assign(n.end,{around:c.project(h),aroundPosition:h,width:r.width,height:r.height})}return n}interpolateProps(e,r,n){const i={};for(const a of this._propsToExtract)i[a]=vT(e[a]||0,r[a]||0,n);if(r.aroundPosition&&this.opts.makeViewport){const a=this.opts.makeViewport({...r,...i});Object.assign(i,a.panByPosition(r.aroundPosition,vT(e.around,r.around,n)))}return i}}const ip={transitionDuration:0},C$e=300,eS=t=>1-(1-t)*(1-t),Rv={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},mm={};class cne{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new x$e({...e,getControllerState:r=>new this.ControllerState(r),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const r=this._eventStartBlocked;switch(e.type){case"panstart":return r?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return r?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return r?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:r,y:n}=this.props,{offsetCenter:i}=e;return[i.x-r,i.y-n]}isPointInBounds(e,r){const{width:n,height:i}=this.props;if(r&&r.handled)return!1;const a=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=i;return a&&r&&r.stopPropagation(),a}isFunctionKeyPressed(e){const{srcEvent:r}=e;return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const r=setTimeout(()=>{this._eventStartBlocked===r&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=r}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:r}=e;this.inertia=Number.isFinite(r)?r:r===!0?C$e:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:a=!0,doubleClickZoom:s=!0,touchZoom:o=!0,touchRotate:c=!1,keyboard:h=!0}=e,d=!!this.onViewStateChange;this.toggleEvents(Rv.WHEEL,d&&n),this.toggleEvents(Rv.PAN,d),this.toggleEvents(Rv.PINCH,d&&(o||c)),this.toggleEvents(Rv.MULTI_PAN,d&&c),this.toggleEvents(Rv.DOUBLE_CLICK,d&&s),this.toggleEvents(Rv.KEYBOARD,d&&h),this.scrollZoom=n,this.dragPan=i,this.dragRotate=a,this.doubleClickZoom=s,this.touchZoom=o,this.touchRotate=c,this.keyboard=h}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,r){this.eventManager&&e.forEach(n=>{this._events[n]!==r&&(this._events[n]=r,r?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(e,r=null,n={}){const i={...e.getViewportProps(),...r},a=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),a){const s=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:s,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:r});return this._panMove=n,this.updateViewport(i,ip,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const r=this.getCenter(e),n=this.controllerState.pan({pos:r});return this.updateViewport(n,ip,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:r}=this;if(this.dragPan&&r&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:eS},{isDragging:!1,isPanning:!0})}else{const n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const r=this.getCenter(e),n=this.controllerState.rotate({pos:r});return this.updateViewport(n,ip,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:r}=this;if(this.dragRotate&&r&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:eS},{isDragging:!1,isRotating:!0})}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:a}=e;let s=2/(1+Math.exp(-Math.abs(a*n)));a<0&&s!==0&&(s=1/s);const o=i?{...this._getTransitionProps({around:r}),transitionDuration:250}:ip,c=this.controllerState.zoom({pos:r,scale:s});return this.updateViewport(c,o,{isZooming:!0,isPanning:!0}),i||this._setInteractionState({isZooming:!1,isPanning:!1}),!0}_onMultiPanStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.controllerState.rotateStart({pos:r});return this.updateViewport(n,ip,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;const r=this.getCenter(e);r[0]-=e.deltaX;const n=this.controllerState.rotate({pos:r});return this.updateViewport(n,ip,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:r}=this;if(this.touchRotate&&r&&e.velocityY){const n=this.getCenter(e),i=[n[0],n[1]+=e.velocityY*r/2],a=this.controllerState.rotate({pos:i});this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:eS},{isDragging:!1,isRotating:!0}),this.blockEvents(r)}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.controllerState.zoomStart({pos:r}).rotateStart({pos:r});return mm._startPinchRotation=e.rotation,mm._lastPinchEvent=e,this.updateViewport(n,ip,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let r=this.controllerState;if(this.touchZoom){const{scale:n}=e,i=this.getCenter(e);r=r.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=e;r=r.rotate({deltaAngleX:mm._startPinchRotation-n})}return this.updateViewport(r,ip,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),mm._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:r}=this,{_lastPinchEvent:n}=mm;if(this.touchZoom&&r&&n&&e.scale!==n.scale){const i=this.getCenter(e);let a=this.controllerState.rotateEnd();const s=Math.log2(e.scale),o=(s-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),c=Math.pow(2,s+o*r/2);a=a.zoom({pos:i,scale:c}).zoomEnd(),this.updateViewport(a,{...this._getTransitionProps({around:i}),transitionDuration:r,transitionEasing:eS},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(r)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return mm._startPinchRotation=null,mm._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:r,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:r}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const r=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:a,rotateSpeedY:s}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let c;const h={};switch(e.srcEvent.code){case"Minus":c=r?o.zoomOut(n).zoomOut(n):o.zoomOut(n),h.isZooming=!0;break;case"Equal":c=r?o.zoomIn(n).zoomIn(n):o.zoomIn(n),h.isZooming=!0;break;case"ArrowLeft":r?(c=o.rotateLeft(a),h.isRotating=!0):(c=o.moveLeft(i),h.isPanning=!0);break;case"ArrowRight":r?(c=o.rotateRight(a),h.isRotating=!0):(c=o.moveRight(i),h.isPanning=!0);break;case"ArrowUp":r?(c=o.rotateUp(s),h.isRotating=!0):(c=o.moveUp(i),h.isPanning=!0);break;case"ArrowDown":r?(c=o.rotateDown(s),h.isRotating=!0):(c=o.moveDown(i),h.isPanning=!0);break;default:return!1}return this.updateViewport(c,this._getTransitionProps(),h),!0}_getTransitionProps(e){const{transition:r}=this;return!r||!r.transitionInterpolator?ip:e?{...r,transitionInterpolator:new d6({...e,...r.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:r}}class A$e{constructor(e,r){this._viewportProps=this.applyConstraints(e),this._state=r}getViewportProps(){return this._viewportProps}getState(){return this._state}}const sG=5,I$e=1.2;class hne extends A$e{constructor(e){const{width:r,height:n,latitude:i,longitude:a,zoom:s,bearing:o=0,pitch:c=0,altitude:h=1.5,position:d=[0,0,0],maxZoom:m=20,minZoom:b=0,maxPitch:x=60,minPitch:E=0,startPanLngLat:T,startZoomLngLat:A,startRotatePos:M,startBearing:F,startPitch:N,startZoom:O,normalize:U=!0}=e;El(Number.isFinite(a)),El(Number.isFinite(i)),El(Number.isFinite(s)),super({width:r,height:n,latitude:i,longitude:a,zoom:s,bearing:o,pitch:c,altitude:h,maxZoom:m,minZoom:b,maxPitch:x,minPitch:E,normalize:U,position:d},{startPanLngLat:T,startZoomLngLat:A,startRotatePos:M,startBearing:F,startPitch:N,startZoom:O}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:r}){const n=this.getState().startPanLngLat||this._unproject(r);if(!n)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(n,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:r=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:a,startPitch:s}=this.getState();if(!i||a===void 0||s===void 0)return this;let o;return e?o=this._getNewRotation(e,i,s,a):o={bearing:a+r,pitch:s+n},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:r,scale:n}){let{startZoom:i,startZoomLngLat:a}=this.getState();if(a||(i=this.getViewportProps().zoom,a=this._unproject(r)||this._unproject(e)),!a)return this;const{maxZoom:s,minZoom:o}=this.getViewportProps();let c=i+Math.log2(n);c=gd(c,o,s);const h=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...h.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const r=e.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:a}=n;return Math.abs(i-r.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(a-r.longitude)>180&&(n.longitude=a<0?a+360:a-360),n}applyConstraints(e){const{maxZoom:r,minZoom:n,zoom:i}=e;e.zoom=gd(i,n,r);const{maxPitch:a,minPitch:s,pitch:o}=e;e.pitch=gd(o,s,a);const{normalize:c=!0}=e;return c&&Object.assign(e,YUe(e)),e}_zoomFromCenter(e){const{width:r,height:n}=this.getViewportProps();return this.zoom({pos:[r/2,n/2],scale:e})}_panFromCenter(e){const{width:r,height:n}=this.getViewportProps();return this.pan({startPos:[r/2,n/2],pos:[r/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const r=this.makeViewport(this.getViewportProps());return e&&r.unproject(e)}_getNewRotation(e,r,n,i){const a=e[0]-r[0],s=e[1]-r[1],o=e[1],c=r[1],{width:h,height:d}=this.getViewportProps(),m=a/h;let b=0;s>0?Math.abs(d-c)>sG&&(b=s/(c-d)*I$e):s<0&&c>sG&&(b=1-o/c),b=gd(b,-1,1);const{minPitch:x,maxPitch:E}=this.getViewportProps(),T=i+180*m;let A=n;return b>0?A=n+b*(E-n):b<0&&(A=n-b*(x-n)),{pitch:A,bearing:T}}}class P$e extends cne{constructor(){super(...arguments),this.ControllerState=hne,this.transition={transitionDuration:300,transitionInterpolator:new d6({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const r=this.props;super.setProps(e),(!r||r.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class p6 extends une{constructor(e={}){super(e)}getViewportType(){return yy}get ControllerType(){return P$e}}p6.displayName="MapView";const k$e=new nne;function R$e(t,e){const r=t.order??1/0,n=e.order??1/0;return r-n}class M$e{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const r=this._defaultEffects;if(!r.find(n=>n.id===e.id)){const n=r.findIndex(i=>R$e(i,e)>0);n<0?r.push(e):r.splice(n,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Nh(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}getEffects(){return this._resolvedEffects}_setEffects(e){const r={};for(const i of this.effects)r[i.id]=i;const n=[];for(const i of e){const a=r[i.id];let s=i;a&&a!==i?a.setProps?(a.setProps(i.props),s=a):a.cleanup(this._context):a||i.setup(this._context),n.push(s),delete r[i.id]}for(const i in r)r[i].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some(i=>i instanceof nne)||this._resolvedEffects.push(k$e),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class D$e extends l6{shouldDrawLayer(e){const{operation:r}=e.props;return r.includes("draw")||r.includes("terrain")}}const O$e="deckRenderer.renderLayers";class N$e{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new D$e(e),this.pickLayersPass=new sne(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const r=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const a=r.render({...n,target:i});n.effects&&(this.lastPostProcessEffect&&(n.clearCanvas=e.clearCanvas===void 0?!0:e.clearCanvas),this._postRender(n.effects,n)),this.renderCount++,mc(O$e,this,a,e)}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}finalize(){const{renderBuffers:e}=this;for(const r of e)r.delete();e.length=0}_preRender(e,r){this.lastPostProcessEffect=null,r.preRenderStats=r.preRenderStats||{};for(const n of e)r.preRenderStats[n.id]=n.preRender(r),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,r=this.device.canvasContext.getDrawingBufferSize(),[n,i]=r;e.length===0&&[0,1].map(a=>{const s=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"},width:n,height:i});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${a}`,colorAttachments:[s]}))});for(const a of e)a.resize(r)}_postRender(e,r){const{renderBuffers:n}=this,i={...r,inputBuffer:n[0],swapBuffer:n[1]};for(const a of e)if(a.postRender){i.target=a.id===this.lastPostProcessEffect?r.target:void 0;const s=a.postRender(i);i.inputBuffer=s,i.swapBuffer=s===n[0]?n[1]:n[0]}}}const L$e={pickedColor:null,pickedObjectIndex:-1};function lG({pickedColors:t,decodePickingColor:e,deviceX:r,deviceY:n,deviceRadius:i,deviceRect:a}){const{x:s,y:o,width:c,height:h}=a;let d=i*i,m=-1,b=0;for(let x=0;x<h;x++){const E=x+o-n,T=E*E;if(T>d)b+=4*c;else for(let A=0;A<c;A++){if(t[b+3]-1>=0){const F=A+s-r,N=F*F+T;N<=d&&(d=N,m=b)}b+=4}}if(m>=0){const x=t.slice(m,m+4),E=e(x);if(E){const T=Math.floor(m/4/c),A=m/4-T*c;return{...E,pickedColor:x,pickedX:s+A,pickedY:o+T}}po.error("Picked non-existent layer. Is picking buffer corrupt?")()}return L$e}function uG({pickedColors:t,decodePickingColor:e}){const r=new Map;if(t){for(let n=0;n<t.length;n+=4)if(t[n+3]-1>=0){const a=t.slice(n,n+4),s=a.join(",");if(!r.has(s)){const o=e(a);o?r.set(s,{...o,color:a}):po.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}function pD({pickInfo:t,viewports:e,pixelRatio:r,x:n,y:i,z:a}){let s=e[0];e.length>1&&(s=F$e(t?.pickedViewports||e,{x:n,y:i}));let o;if(s){const c=[n-s.x,i-s.y];a!==void 0&&(c[2]=a),o=s.unproject(c)}return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:n,y:i,pixel:[n,i],coordinate:o,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:r}}function cG(t){const{pickInfo:e,lastPickedInfo:r,mode:n,layers:i}=t,{pickedColor:a,pickedLayer:s,pickedObjectIndex:o}=e,c=s?[s]:[];if(n==="hover"){const m=r.index,b=r.layerId,x=s?s.props.id:null;if(x!==b||o!==m){if(x!==b){const E=i.find(T=>T.props.id===b);E&&c.unshift(E)}r.layerId=x,r.index=o,r.info=null}}const h=pD(t),d=new Map;return d.set(null,h),c.forEach(m=>{let b={...h};m===s&&(b.color=a,b.index=o,b.picked=!0),b=gD({layer:m,info:b,mode:n});const x=b.layer;m===s&&n==="hover"&&(r.info=b),d.set(x.id,b),n==="hover"&&x.updateAutoHighlight(b)}),d}function gD({layer:t,info:e,mode:r}){for(;t&&e;){const n=e.layer||null;e.sourceLayer=n,e.layer=t,e=t.getPickingInfo({info:e,mode:r,sourceLayer:n}),t=t.parent}return e}function F$e(t,e){for(let r=t.length-1;r>=0;r--){const n=t[r];if(n.containsPixel(e))return n}return t[0]}class B$e{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new sne(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObjectAsync(e){return this._pickClosestObjectAsync(e)}pickObjectsAsync(e){return this._pickVisibleObjectsAsync(e)}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:r,layers:n,viewports:i},a=this.lastPickedInfo.info){const s=a&&a.layer&&a.layer.id,o=a&&a.viewport&&a.viewport.id,c=s?n.find(b=>b.id===s):null,h=o&&i.find(b=>b.id===o)||i[0],d=h&&h.unproject([e-h.x,r-h.y]);return{...a,...{x:e,y:r,viewport:h,coordinate:d,layer:c}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const r=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=r}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const r=e.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return r.length?r:null}async _pickClosestObjectAsync({layers:e,views:r,viewports:n,x:i,y:a,radius:s=0,depth:o=1,mode:c="query",unproject3D:h,onViewportActive:d,effects:m}){const b=this.device.canvasContext.cssToDeviceRatio(),x=this._getPickable(e);if(!x||n.length===0)return{result:[],emptyInfo:pD({viewports:n,x:i,y:a,pixelRatio:b})};this._resizeBuffer();const E=this.device.canvasContext.cssToDevicePixels([i,a],!0),T=[E.x+Math.floor(E.width/2),E.y+Math.floor(E.height/2)],A=Math.round(s*b),{width:M,height:F}=this.pickingFBO,N=this._getPickingRect({deviceX:T[0],deviceY:T[1],deviceRadius:A,deviceWidth:M,deviceHeight:F}),O={x:i-s,y:a-s,width:s*2+1,height:s*2+1};let U;const j=[],H=new Set;for(let G=0;G<o;G++){let X;if(N){const Q=this._drawAndSample({layers:x,views:r,viewports:n,onViewportActive:d,deviceRect:N,cullRect:O,effects:m,pass:`picking:${c}`});X=lG({...Q,deviceX:T[0],deviceY:T[1],deviceRadius:A,deviceRect:N})}else X={pickedColor:null,pickedObjectIndex:-1};let ae;if(X.pickedLayer&&h&&this.depthFBO){const{pickedColors:Q}=this._drawAndSample({layers:[X.pickedLayer],views:r,viewports:n,onViewportActive:d,deviceRect:{x:X.pickedX,y:X.pickedY,width:1,height:1},cullRect:O,effects:m,pass:`picking:${c}:z`},!0);Q[3]&&(ae=Q[0])}X.pickedLayer&&G+1<o&&(H.add(X.pickedLayer),X.pickedLayer.disablePickingIndex(X.pickedObjectIndex)),U=cG({pickInfo:X,lastPickedInfo:this.lastPickedInfo,mode:c,layers:x,viewports:n,x:i,y:a,z:ae,pixelRatio:b});for(const Q of U.values())Q.layer&&j.push(Q);if(!X.pickedColor)break}for(const G of H)G.restorePickingColors();return{result:j,emptyInfo:U.get(null)}}_pickClosestObject({layers:e,views:r,viewports:n,x:i,y:a,radius:s=0,depth:o=1,mode:c="query",unproject3D:h,onViewportActive:d,effects:m}){const b=this.device.canvasContext.cssToDeviceRatio(),x=this._getPickable(e);if(!x||n.length===0)return{result:[],emptyInfo:pD({viewports:n,x:i,y:a,pixelRatio:b})};this._resizeBuffer();const E=this.device.canvasContext.cssToDevicePixels([i,a],!0),T=[E.x+Math.floor(E.width/2),E.y+Math.floor(E.height/2)],A=Math.round(s*b),{width:M,height:F}=this.pickingFBO,N=this._getPickingRect({deviceX:T[0],deviceY:T[1],deviceRadius:A,deviceWidth:M,deviceHeight:F}),O={x:i-s,y:a-s,width:s*2+1,height:s*2+1};let U;const j=[],H=new Set;for(let G=0;G<o;G++){let X;if(N){const Q=this._drawAndSample({layers:x,views:r,viewports:n,onViewportActive:d,deviceRect:N,cullRect:O,effects:m,pass:`picking:${c}`});X=lG({...Q,deviceX:T[0],deviceY:T[1],deviceRadius:A,deviceRect:N})}else X={pickedColor:null,pickedObjectIndex:-1};let ae;if(X.pickedLayer&&h&&this.depthFBO){const{pickedColors:Q}=this._drawAndSample({layers:[X.pickedLayer],views:r,viewports:n,onViewportActive:d,deviceRect:{x:X.pickedX,y:X.pickedY,width:1,height:1},cullRect:O,effects:m,pass:`picking:${c}:z`},!0);Q[3]&&(ae=Q[0])}X.pickedLayer&&G+1<o&&(H.add(X.pickedLayer),X.pickedLayer.disablePickingIndex(X.pickedObjectIndex)),U=cG({pickInfo:X,lastPickedInfo:this.lastPickedInfo,mode:c,layers:x,viewports:n,x:i,y:a,z:ae,pixelRatio:b});for(const Q of U.values())Q.layer&&j.push(Q);if(!X.pickedColor)break}for(const G of H)G.restorePickingColors();return{result:j,emptyInfo:U.get(null)}}async _pickVisibleObjectsAsync({layers:e,views:r,viewports:n,x:i,y:a,width:s=1,height:o=1,mode:c="query",maxObjects:h=null,onViewportActive:d,effects:m}){const b=this._getPickable(e);if(!b||n.length===0)return[];this._resizeBuffer();const x=this.device.canvasContext.cssToDeviceRatio(),E=this.device.canvasContext.cssToDevicePixels([i,a],!0),T=E.x,A=E.y+E.height,M=this.device.canvasContext.cssToDevicePixels([i+s,a+o],!0),F=M.x+M.width,N=M.y,O={x:T,y:N,width:F-T,height:A-N},U=this._drawAndSample({layers:b,views:r,viewports:n,onViewportActive:d,deviceRect:O,cullRect:{x:i,y:a,width:s,height:o},effects:m,pass:`picking:${c}`}),j=uG(U),H=new Map,G=[],X=Number.isFinite(h);for(let ae=0;ae<j.length&&!(X&&G.length>=h);ae++){const Q=j[ae];let W={color:Q.pickedColor,layer:null,index:Q.pickedObjectIndex,picked:!0,x:i,y:a,pixelRatio:x};W=gD({layer:Q.pickedLayer,info:W,mode:c});const oe=W.layer.id;H.has(oe)||H.set(oe,new Set);const se=H.get(oe),he=W.object??W.index;se.has(he)||(se.add(he),G.push(W))}return G}_pickVisibleObjects({layers:e,views:r,viewports:n,x:i,y:a,width:s=1,height:o=1,mode:c="query",maxObjects:h=null,onViewportActive:d,effects:m}){const b=this._getPickable(e);if(!b||n.length===0)return[];this._resizeBuffer();const x=this.device.canvasContext.cssToDeviceRatio(),E=this.device.canvasContext.cssToDevicePixels([i,a],!0),T=E.x,A=E.y+E.height,M=this.device.canvasContext.cssToDevicePixels([i+s,a+o],!0),F=M.x+M.width,N=M.y,O={x:T,y:N,width:F-T,height:A-N},U=this._drawAndSample({layers:b,views:r,viewports:n,onViewportActive:d,deviceRect:O,cullRect:{x:i,y:a,width:s,height:o},effects:m,pass:`picking:${c}`}),j=uG(U),H=new Map,G=[],X=Number.isFinite(h);for(let ae=0;ae<j.length&&!(X&&G.length>=h);ae++){const Q=j[ae];let W={color:Q.pickedColor,layer:null,index:Q.pickedObjectIndex,picked:!0,x:i,y:a,pixelRatio:x};W=gD({layer:Q.pickedLayer,info:W,mode:c});const oe=W.layer.id;H.has(oe)||H.set(oe,new Set);const se=H.get(oe),he=W.object??W.index;se.has(he)||(se.add(he),G.push(W))}return G}async _drawAndSampleAsync({layers:e,views:r,viewports:n,onViewportActive:i,deviceRect:a,cullRect:s,effects:o,pass:c},h=!1){const d=h?this.depthFBO:this.pickingFBO,m={layers:e,layerFilter:this.layerFilter,views:r,viewports:n,onViewportActive:i,pickingFBO:d,deviceRect:a,cullRect:s,effects:o,pass:c,pickZ:h,preRenderStats:{},isPicking:!0};for(const F of o)F.useInPicking&&(m.preRenderStats[F.id]=F.preRender(m));const{decodePickingColor:b}=this.pickLayersPass.render(m),{x,y:E,width:T,height:A}=a,M=new(h?Float32Array:Uint8Array)(T*A*4);return this.device.readPixelsToArrayWebGL(d,{sourceX:x,sourceY:E,sourceWidth:T,sourceHeight:A,target:M}),{pickedColors:M,decodePickingColor:b}}_drawAndSample({layers:e,views:r,viewports:n,onViewportActive:i,deviceRect:a,cullRect:s,effects:o,pass:c},h=!1){const d=h?this.depthFBO:this.pickingFBO,m={layers:e,layerFilter:this.layerFilter,views:r,viewports:n,onViewportActive:i,pickingFBO:d,deviceRect:a,cullRect:s,effects:o,pass:c,pickZ:h,preRenderStats:{},isPicking:!0};for(const F of o)F.useInPicking&&(m.preRenderStats[F.id]=F.preRender(m));const{decodePickingColor:b}=this.pickLayersPass.render(m),{x,y:E,width:T,height:A}=a,M=new(h?Float32Array:Uint8Array)(T*A*4);return this.device.readPixelsToArrayWebGL(d,{sourceX:x,sourceY:E,sourceWidth:T,sourceHeight:A,target:M}),{pickedColors:M,decodePickingColor:b}}_getPickingRect({deviceX:e,deviceY:r,deviceRadius:n,deviceWidth:i,deviceHeight:a}){const s=Math.max(0,e-n),o=Math.max(0,r-n),c=Math.min(i,e+n+1)-s,h=Math.min(a,r+n+1)-o;return c<=0||h<=0?null:{x:s,y:o,width:c,height:h}}}const z$e={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},j$e="top-left",hG="root";class U$e{constructor({deck:e,parentElement:r}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,r?.classList.add("deck-widget-container"),this.parentElement=r}getWidgets(){return this.resolvedWidgets}setProps(e){if(e.widgets&&!Nh(e.widgets,this.widgets,1)){const r=e.widgets.filter(Boolean);this._setWidgets(r)}}finalize(){for(const e of this.getWidgets())this._removeWidget(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(r=>r.id===e.id)||(this._addWidget(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}onRedraw({viewports:e,layers:r}){const n=e.reduce((i,a)=>(i[a.id]=a,i),{});for(const i of this.getWidgets()){const{viewId:a}=i;if(a){const s=n[a];s&&(i.onViewportChange&&i.onViewportChange(s),i.onRedraw?.({viewports:[s],layers:r}))}else{if(i.onViewportChange)for(const s of e)i.onViewportChange(s);i.onRedraw?.({viewports:e,layers:r})}}this.lastViewports=n,this._updateContainers()}onHover(e,r){for(const n of this.getWidgets()){const{viewId:i}=n;(!i||i===e.viewport?.id)&&n.onHover?.(e,r)}}onEvent(e,r){const n=lD[r.type];if(n)for(const i of this.getWidgets()){const{viewId:a}=i;(!a||a===e.viewport?.id)&&i[n]?.(e,r)}}_setWidgets(e){const r={};for(const n of this.resolvedWidgets)r[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)r[n.id]=null,this.resolvedWidgets.push(n);for(let n of e){const i=r[n.id];i?i.viewId!==n.viewId||i.placement!==n.placement?(this._removeWidget(i),this._addWidget(n)):n!==i&&(i.setProps(n.props),n=i):this._addWidget(n),r[n.id]=null,this.resolvedWidgets.push(n)}for(const n in r){const i=r[n];i&&this._removeWidget(i)}this.widgets=e}_addWidget(e){const{viewId:r=null,placement:n=j$e}=e,i=e.props._container??r;e.widgetManager=this,e.deck=this.deck,e.rootElement=e._onAdd({deck:this.deck,viewId:r}),e.rootElement&&this._getContainer(i,n).append(e.rootElement),e.updateHTML()}_removeWidget(e){e.onRemove?.(),e.rootElement&&e.rootElement.remove(),e.rootElement=void 0,e.deck=void 0,e.widgetManager=void 0}_getContainer(e,r){if(e&&typeof e!="string")return e;const n=e||hG;let i=this.containers[n];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",this.parentElement?.append(i),this.containers[n]=i);let a=i.querySelector(`.${r}`);return a||(a=globalThis.document.createElement("div"),a.className=r,a.style.position="absolute",a.style.zIndex="2",Object.assign(a.style,z$e[r]),i.append(a)),a}_updateContainers(){const e=this.deck.width,r=this.deck.height;for(const n in this.containers){const i=this.lastViewports[n]||null,a=n===hG||i,s=this.containers[n];a?(s.style.display="block",s.style.left=`${i?i.x:0}px`,s.style.top=`${i?i.y:0}px`,s.style.width=`${i?i.width:e}px`,s.style.height=`${i?i.height:r}px`):s.style.display="none"}}}function fG(t,e){e&&Object.entries(e).map(([r,n])=>{r.startsWith("--")?t.style.setProperty(r,n):t.style[r]=n})}function V$e(t,e){e&&Object.keys(e).map(r=>{r.startsWith("--")?t.style.removeProperty(r):t.style[r]=""})}class g6{constructor(e){this.viewId=null,this.props={...this.constructor.defaultProps,...e},this.id=this.props.id}setProps(e){const r=this.props,n=this.rootElement;n&&r.className!==e.className&&(r.className&&n.classList.remove(r.className),e.className&&n.classList.add(e.className)),n&&!Nh(r.style,e.style,1)&&(V$e(n,r.style),fG(n,e.style)),Object.assign(this.props,e),this.updateHTML()}updateHTML(){this.rootElement&&this.onRenderHTML(this.rootElement)}onCreateRootElement(){const e=["deck-widget",this.className,this.props.className],r=document.createElement("div");return e.filter(n=>typeof n=="string"&&n.length>0).forEach(n=>r.classList.add(n)),fG(r,this.props.style),r}_onAdd(e){return this.onAdd(e)??this.onCreateRootElement()}onAdd(e){}onRemove(){}onViewportChange(e){}onRedraw(e){}onHover(e,r){}onClick(e,r){}onDrag(e,r){}onDragStart(e,r){}onDragEnd(e,r){}}g6.defaultProps={id:"widget",style:{},_container:null,className:""};const $$e={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class fne extends g6{constructor(e={}){super(e),this.id="default-tooltip",this.placement="fill",this.className="deck-tooltip",this.isVisible=!1,this.setProps(e)}onCreateRootElement(){const e=document.createElement("div");return e.className=this.className,Object.assign(e.style,$$e),e}onRenderHTML(e){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&!e.equals(this.lastViewport)&&this.setTooltip(null),this.lastViewport=e}onHover(e){const{deck:r}=this,n=r&&r.props.getTooltip;if(!n)return;const i=n(e);this.setTooltip(i,e.x,e.y)}setTooltip(e,r,n){const i=this.rootElement;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${r}px, ${n}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}fne.defaultProps={...g6.defaultProps};var m0;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(m0||(m0={}));const q$e={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},H$e=t=>({drawBuffersWEBGL(e){return t.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),W$e=t=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return t.createVertexArray()},deleteVertexArrayOES(e){return t.deleteVertexArray(e)},isVertexArrayOES(e){return t.isVertexArray(e)},bindVertexArrayOES(e){return t.bindVertexArray(e)}}),G$e=t=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return t.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return t.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return t.vertexAttribDivisor(...e)}});function X$e(t=!0){const e=HTMLCanvasElement.prototype;if(!t&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(r,n){if(r==="webgl"||r==="experimental-webgl"){const i=this.originalGetContext("webgl2",n);return i instanceof HTMLElement&&Y$e(i),i}return this.originalGetContext(r,n)}}function Y$e(t){t.getExtension("EXT_color_buffer_float");const e={...q$e,WEBGL_disjoint_timer_query:t.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:H$e(t),OES_vertex_array_object:W$e(t),ANGLE_instanced_arrays:G$e(t)},r=t.getExtension;t.getExtension=function(i){const a=r.call(t,i);return a||(i in e?e[i]:null)};const n=t.getSupportedExtensions;t.getSupportedExtensions=function(){return(n.apply(t)||[])?.concat(Object.keys(e))}}async function dne(t,e){const r=document.getElementsByTagName("head")[0];if(!r)throw new Error("loadScript");const n=document.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src",t),new Promise((i,a)=>{n.onload=i,n.onerror=s=>a(new Error(`Unable to load script '${t}': ${s}`)),r.appendChild(n)})}const Z$e=1;let Jc=null,dG=!1;const m6={debugSpectorJS:rn.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function K$e(t){if(!globalThis.SPECTOR)try{await dne(t.debugSpectorJSUrl||m6.debugSpectorJSUrl)}catch(e){rn.warn(String(e))}}function J$e(t){if(t={...m6,...t},!t.debugSpectorJS)return null;if(!Jc&&globalThis.SPECTOR&&!globalThis.luma?.spector){rn.probe(Z$e,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;Jc=new e,globalThis.luma&&(globalThis.luma.spector=Jc)}if(!Jc)return null;if(dG||(dG=!0,Jc.spyCanvases(),Jc?.onCaptureStarted.add(e=>rn.info("Spector capture started:",e)()),Jc?.onCapture.add(e=>{rn.info("Spector capture complete:",e)(),Jc?.getResultUI(),Jc?.resultView.display(),Jc?.resultView.addCapture(e)})),t.gl){const e=t.gl,r=e.device;Jc?.startCapture(t.gl,500),e.device=r,new Promise(n=>setTimeout(n,2e3)).then(n=>{rn.info("Spector capture stopped after 2 seconds")(),Jc?.stopCapture()})}return Jc}const Q$e="https://unpkg.com/webgl-debug@2.0.1/index.js";function pne(t){return t.luma=t.luma||{},t.luma}async function eqe(){My()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await dne(Q$e))}function tqe(t,e={}){return e.debugWebGL||e.traceWebGL?nqe(t,e):rqe(t)}function rqe(t){const e=pne(t);return e.realContext?e.realContext:t}function nqe(t,e){if(!globalThis.WebGLDebugUtils)return rn.warn("webgl-debug not loaded")(),t;const r=pne(t);if(r.debugContext)return r.debugContext;globalThis.WebGLDebugUtils.init({...m0,...t});const n=globalThis.WebGLDebugUtils.makeDebugContext(t,iqe.bind(null,e),aqe.bind(null,e));for(const s in m0)!(s in n)&&typeof m0[s]=="number"&&(n[s]=m0[s]);class i{}Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.setPrototypeOf(i,n);const a=Object.create(i);return r.realContext=t,r.debugContext=a,a.debug=!0,a}function pG(t,e){e=Array.from(e).map(n=>n===void 0?"undefined":n);let r=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return r=`${r.slice(0,100)}${r.length>100?"...":""}`,`gl.${t}(${r})`}function iqe(t,e,r,n){n=Array.from(n).map(o=>o===void 0?"undefined":o);const i=globalThis.WebGLDebugUtils.glEnumToString(e),a=globalThis.WebGLDebugUtils.glFunctionArgsToString(r,n),s=`${i} in gl.${r}(${a})`;rn.error(s)();debugger}function aqe(t,e,r){let n="";rn.level>=1&&(n=pG(e,r),t.traceWebGL&&rn.log(1,n)());for(const i of r)if(i===void 0){n=n||pG(e,r);debugger}}const tS=1;class oqe extends r9e{type="webgl";constructor(){super(),fy.defaultProps={...fy.defaultProps,...m6}}enforceWebGL2(e){X$e(e)}isSupported(){return typeof WebGL2RenderingContext<"u"}isDeviceHandle(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:(typeof WebGLRenderingContext<"u"&&e instanceof WebGLRenderingContext&&rn.warn("WebGL1 is not supported",e)(),!1)}async attach(e,r={}){const{WebGLDevice:n}=await nb(async()=>{const{WebGLDevice:a}=await Promise.resolve().then(()=>kG);return{WebGLDevice:a}},void 0,import.meta.url);if(e instanceof n)return e;if(e?.device instanceof n)return e.device;if(!sqe(e))throw new Error("Invalid WebGL2RenderingContext");const i=r.createCanvasContext===!0?{}:r.createCanvasContext;return new n({...r,_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1,...i}})}async create(e={}){const{WebGLDevice:r}=await nb(async()=>{const{WebGLDevice:n}=await Promise.resolve().then(()=>kG);return{WebGLDevice:n}},void 0,import.meta.url);rn.groupCollapsed(tS,"WebGLDevice created")();try{const n=[];(e.debugWebGL||e.debug)&&n.push(eqe()),e.debugSpectorJS&&n.push(K$e(e));const i=await Promise.allSettled(n);for(const o of i)o.status==="rejected"&&rn.error(`Failed to initialize debug libraries ${o.reason}`)();const a=new r(e),s=`${a._reused?"Reusing":"Created"} device with WebGL2 ${a.props.debug?"debug ":""}context: ${a.info.vendor}, ${a.info.renderer} for canvas: ${a.canvasContext.id}`;return rn.probe(tS,s)(),rn.table(tS,a.info)(),a}finally{rn.groupEnd(tS)()}}}function sqe(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}const ok=new oqe,y6={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},bl=(t,e,r)=>e?t.enable(r):t.disable(r),gG=(t,e,r)=>t.hint(r,e),Qc=(t,e,r)=>t.pixelStorei(r,e),mG=(t,e,r)=>{const n=r===36006?36009:36008;return t.bindFramebuffer(n,e)},C1=(t,e,r)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[r];t.bindBuffer(i,e)};function sk(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}const lqe={3042:bl,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:bl,2885:(t,e)=>t.cullFace(e),2929:bl,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:bl,35723:gG,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>t.bindTransformFeedback?.(36386,e),34229:(t,e)=>t.bindVertexArray(e),36006:mG,36010:mG,34964:C1,36662:C1,36663:C1,35053:C1,35055:C1,2886:(t,e)=>t.frontFace(e),33170:gG,2849:(t,e)=>t.lineWidth(e),32823:bl,32824:"polygonOffset",10752:"polygonOffset",35977:bl,32926:bl,32928:bl,32938:"sampleCoverage",32939:"sampleCoverage",3089:bl,3088:(t,e)=>t.scissor(...e),2960:bl,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:bl,10754:bl,12288:bl,12289:bl,12290:bl,12291:bl,12292:bl,12293:bl,12294:bl,12295:bl,3333:Qc,3317:Qc,37440:Qc,37441:Qc,37443:Qc,3330:Qc,3332:Qc,3331:Qc,3314:Qc,32878:Qc,3316:Qc,3315:Qc,32877:Qc,framebuffer:(t,e)=>{const r=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,r)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{const r=typeof e=="number"?[e,e]:e;t.blendEquationSeparate(...r)},blendFunc:(t,e)=>{const r=e?.length===2?[...e,...e]:e;t.blendFuncSeparate(...r)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(e[0],e[1]||!1),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=sk(e)?e:[e,e];const[r,n]=e;t.stencilMaskSeparate(1028,r),t.stencilMaskSeparate(1029,n)},stencilFunc:(t,e)=>{e=sk(e)&&e.length===3?[...e,...e]:e;const[r,n,i,a,s,o]=e;t.stencilFuncSeparate(1028,r,n,i),t.stencilFuncSeparate(1029,a,s,o)},stencilOp:(t,e)=>{e=sk(e)&&e.length===3?[...e,...e]:e;const[r,n,i,a,s,o]=e;t.stencilOpSeparate(1028,r,n,i),t.stencilOpSeparate(1029,a,s,o)},viewport:(t,e)=>t.viewport(...e)};function Ns(t,e,r){return e[t]!==void 0?e[t]:r[t]}const uqe={blendEquation:(t,e,r)=>t.blendEquationSeparate(Ns(32777,e,r),Ns(34877,e,r)),blendFunc:(t,e,r)=>t.blendFuncSeparate(Ns(32969,e,r),Ns(32968,e,r),Ns(32971,e,r),Ns(32970,e,r)),polygonOffset:(t,e,r)=>t.polygonOffset(Ns(32824,e,r),Ns(10752,e,r)),sampleCoverage:(t,e,r)=>t.sampleCoverage(Ns(32938,e,r),Ns(32939,e,r)),stencilFuncFront:(t,e,r)=>t.stencilFuncSeparate(1028,Ns(2962,e,r),Ns(2967,e,r),Ns(2963,e,r)),stencilFuncBack:(t,e,r)=>t.stencilFuncSeparate(1029,Ns(34816,e,r),Ns(36003,e,r),Ns(36004,e,r)),stencilOpFront:(t,e,r)=>t.stencilOpSeparate(1028,Ns(2964,e,r),Ns(2965,e,r),Ns(2966,e,r)),stencilOpBack:(t,e,r)=>t.stencilOpSeparate(1029,Ns(34817,e,r),Ns(34818,e,r),Ns(34819,e,r))},yG={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,r)=>t({[e]:r}),hint:(t,e,r)=>t({[e]:r}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,r)=>t({36007:r}),bindTransformFeedback:(t,e,r)=>t({36389:r}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,r)=>{switch(e){case 36160:return t({36006:r,36010:r});case 36009:return t({36006:r});case 36008:return t({36010:r});default:return null}},bindBuffer:(t,e,r)=>{const n={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return n?t({[n]:r}):{valueChanged:!0}},blendColor:(t,e,r,n,i)=>t({32773:new Float32Array([e,r,n,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,r)=>t({32777:e,34877:r}),blendFunc:(t,e,r)=>t({32969:e,32968:r,32971:e,32970:r}),blendFuncSeparate:(t,e,r,n,i)=>t({32969:e,32968:r,32971:n,32970:i}),clearColor:(t,e,r,n,i)=>t({3106:new Float32Array([e,r,n,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,r,n,i)=>t({3107:[e,r,n,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,r)=>t({2928:new Float32Array([e,r])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,r)=>t({32824:e,10752:r}),sampleCoverage:(t,e,r)=>t({32938:e,32939:r}),scissor:(t,e,r,n,i)=>t({3088:new Int32Array([e,r,n,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,r)=>t({[e===1028?2968:36005]:r}),stencilFunc:(t,e,r,n)=>t({2962:e,2967:r,2963:n,34816:e,36003:r,36004:n}),stencilFuncSeparate:(t,e,r,n,i)=>t({[e===1028?2962:34816]:r,[e===1028?2967:36003]:n,[e===1028?2963:36004]:i}),stencilOp:(t,e,r,n)=>t({2964:e,2965:r,2966:n,34817:e,34818:r,34819:n}),stencilOpSeparate:(t,e,r,n,i)=>t({[e===1028?2964:34817]:r,[e===1028?2965:34818]:n,[e===1028?2966:34819]:i}),viewport:(t,e,r,n,i)=>t({2978:[e,r,n,i]})},nd=(t,e)=>t.isEnabled(e),vG={3042:nd,2884:nd,2929:nd,3024:nd,32823:nd,32926:nd,32928:nd,3089:nd,2960:nd,35977:nd},cqe=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function P_(t,e){if(fqe(e))return;const r={};for(const i in e){const a=Number(i),s=lqe[i];s&&(typeof s=="string"?r[s]=!0:s(t,e[i],a))}const n=t.state&&t.state.cache;if(n)for(const i in r){const a=uqe[i];a(t,e,n)}}function gne(t,e=y6){if(typeof e=="number"){const i=e,a=vG[i];return a?a(t,i):t.getParameter(i)}const r=Array.isArray(e)?e:Object.keys(e),n={};for(const i of r){const a=vG[i];n[i]=a?a(t,Number(i)):t.getParameter(Number(i))}return n}function hqe(t){P_(t,y6)}function fqe(t){for(const e in t)return!1;return!0}function dqe(t,e){if(t===e)return!0;if(_G(t)&&_G(e)&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function _G(t){return Array.isArray(t)||ArrayBuffer.isView(t)}class Gm{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,r){this.gl=e,this.log=r?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];P_(this.gl,e),this.stateStack.pop()}trackState(e,r){if(this.cache=r?.copyState?gne(e):Object.assign({},y6),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,gqe(e);for(const n in yG){const i=yG[n];pqe(e,n,i)}bG(e,"getParameter"),bG(e,"isEnabled")}_updateCache(e){let r=!1,n;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const a in e){const s=e[a],o=this.cache[a];dqe(s,o)||(r=!0,n=o,i&&!(a in i)&&(i[a]=o),this.cache[a]=s)}return{valueChanged:r,oldValue:n}}}function bG(t,e){const r=t[e].bind(t);t[e]=function(i){if(i===void 0||cqe.has(i))return r(i);const a=Gm.get(t);return i in a.cache||(a.cache[i]=r(i)),a.enable?a.cache[i]:r(i)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function pqe(t,e,r){if(!t[e])return;const n=t[e].bind(t);t[e]=function(...a){const s=Gm.get(t),{valueChanged:o,oldValue:c}=r(s._updateCache,...a);return o&&n(...a),c},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function gqe(t){const e=t.useProgram.bind(t);t.useProgram=function(n){const i=Gm.get(t);i.program!==n&&(e(n),i.program=n)}}function mqe(t,e,r){let n="";const i={preserveDrawingBuffer:!0,...r};let a=null;if(a||=t.getContext("webgl2",i),i.failIfMajorPerformanceCaveat&&(n||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),!a&&!r.failIfMajorPerformanceCaveat&&(i.failIfMajorPerformanceCaveat=!1,a=t.getContext("webgl2",i),a.luma||={},a.luma.softwareRenderer=!0),a||(a=t.getContext("webgl",{}),a&&(a=null,n||="Your browser only supports WebGL1")),!a)throw n||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${n}`);const{onContextLost:s,onContextRestored:o}=e;return t.addEventListener("webglcontextlost",c=>s(c),!1),t.addEventListener("webglcontextrestored",c=>o(c),!1),a.luma||={},a}function s_(t,e,r){return r[e]===void 0&&(r[e]=t.getExtension(e)||null),r[e]}function yqe(t,e){const r=t.getParameter(7936),n=t.getParameter(7937);s_(t,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,a=t.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),s=t.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),o=a||r,c=s||n,h=t.getParameter(7938),d=mne(o,c),m=vqe(o,c),b=_qe(o,c);return{type:"webgl",gpu:d,gpuType:b,gpuBackend:m,vendor:o,renderer:c,version:h,shadingLanguage:"glsl",shadingLanguageVersion:300}}function mne(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function vqe(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?"opengl":"unknown"}function _qe(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(mne(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function yne(t){switch(t){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}const tb="WEBGL_compressed_texture_s3tc",rb="WEBGL_compressed_texture_s3tc_srgb",y0="EXT_texture_compression_rgtc",v0="EXT_texture_compression_bptc",bqe="WEBGL_compressed_texture_etc",xqe="WEBGL_compressed_texture_astc",wqe="WEBGL_compressed_texture_etc1",Sqe="WEBGL_compressed_texture_pvrtc",Eqe="WEBGL_compressed_texture_atc",xG="EXT_texture_norm16",wG="EXT_render_snorm",Tqe="EXT_color_buffer_float",v6={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[wG],"norm16-renderable-webgl":[xG],"snorm16-renderable-webgl":[xG,wG],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[tb,rb,y0,v0],"texture-compression-bc5-webgl":[y0],"texture-compression-bc7-webgl":[v0],"texture-compression-etc2":[bqe],"texture-compression-astc":[xqe],"texture-compression-etc1-webgl":[wqe],"texture-compression-pvrtc-webgl":[Sqe],"texture-compression-atc-webgl":[Eqe]};function Cqe(t){return t in v6}function Aqe(t,e,r){return(v6[e]||[]).every(i=>s_(t,i,r))}const _6={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},r16unorm:{gl:33322,rb:!0},r16snorm:{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},rg16unorm:{gl:33324},rg16snorm:{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},rgb10a2uint:{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},rgba16unorm:{gl:32859,rb:!0},rgba16snorm:{gl:36763},"rgb32float-webgl":{gl:34837,x:Tqe,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:tb},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:rb},"bc1-rgba-unorm":{gl:33777,x:tb},"bc1-rgba-unorm-srgb":{gl:35916,x:rb},"bc2-rgba-unorm":{gl:33778,x:tb},"bc2-rgba-unorm-srgb":{gl:35918,x:rb},"bc3-rgba-unorm":{gl:33779,x:tb},"bc3-rgba-unorm-srgb":{gl:35919,x:rb},"bc4-r-unorm":{gl:36283,x:y0},"bc4-r-snorm":{gl:36284,x:y0},"bc5-rg-unorm":{gl:36285,x:y0},"bc5-rg-snorm":{gl:36286,x:y0},"bc6h-rgb-ufloat":{gl:36495,x:v0},"bc6h-rgb-float":{gl:36494,x:v0},"bc7-rgba-unorm":{gl:36492,x:v0},"bc7-rgba-unorm-srgb":{gl:36493,x:v0},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function Iqe(t,e,r){let n=e.create;const i=_6[e.format];return i?.gl===void 0&&(n=!1),i?.x&&(n=n&&!!s_(t,i.x,r)),{format:e.format,create:n&&e.create,render:n&&e.render,filter:n&&e.filter,blend:n&&e.blend,store:n&&e.store}}function vne(t){const e=_6[t],r=Rqe(t),n=R0.getInfo(t);return n.compressed&&(e.dataFormat=r),{internalFormat:r,format:e?.dataFormat||kqe(n.channels,n.integer,n.normalized,r),type:n.dataType?yne(n.dataType):e?.types?.[0]||5121,compressed:n.compressed||!1}}function Pqe(t){switch(R0.getInfo(t).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${t}`)}}function kqe(t,e,r,n){if(n===6408||n===6407)return n;switch(t){case"r":return e&&!r?36244:6403;case"rg":return e&&!r?33320:33319;case"rgb":return e&&!r?36248:6407;case"rgba":return e&&!r?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function Rqe(t){const r=_6[t]?.gl;if(r===void 0)throw new Error(`Unsupported texture format ${t}`);return r}const SG={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class Mqe extends e9e{gl;extensions;testedFeatures=new Set;constructor(e,r,n){super([],n),this.gl=e,this.extensions=r,s_(e,"EXT_color_buffer_float",r)}*[Symbol.iterator](){const e=this.getFeatures();for(const r of e)this.has(r)&&(yield r);return[]}has(e){return this.disabledFeatures?.[e]?!1:(this.testedFeatures.has(e)||(this.testedFeatures.add(e),Cqe(e)&&Aqe(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(const r of e)this.has(r)}getFeatures(){return[...Object.keys(SG),...Object.keys(v6)]}getWebGLFeature(e){const r=SG[e];return typeof r=="string"?!!s_(this.gl,r,this.extensions):!!r}}class Dqe extends Qze{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderVariables(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return this.limits[e]===void 0&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class Ab extends K3{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,r){super(e,r);const n=r.handle===null;this.device=e,this.gl=e.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),n||(e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let r=0;r<this.colorAttachments.length;++r){const n=this.colorAttachments[r];if(n){const i=36064+r;this._attachTextureView(i,n)}}if(this.depthStencilAttachment){const r=Pqe(this.depthStencilAttachment.props.format);this._attachTextureView(r,this.depthStencilAttachment)}if(this.device.props.debug){const r=this.gl.checkFramebufferStatus(36160);if(r!==36053)throw new Error(`Framebuffer ${Nqe(r)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,r){const{gl:n}=this.device,{texture:i}=r,a=r.props.baseMipLevel,s=r.props.baseArrayLayer;switch(n.bindTexture(i.glTarget,i.handle),i.glTarget){case 35866:case 32879:n.framebufferTextureLayer(36160,e,i.handle,a,s);break;case 34067:const o=Oqe(s);n.framebufferTexture2D(36160,e,o,i.handle,a);break;case 3553:n.framebufferTexture2D(36160,e,3553,i.handle,a);break;default:throw new Error("Illegal texture type")}n.bindTexture(i.glTarget,null)}}function Oqe(t){return t<34069?t+34069:t}function Nqe(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}class Lqe extends Dm{device;handle=null;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,r){super(r),this.device=e,this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this._updateDevice()}getCurrentFramebuffer(){return this._framebuffer=this._framebuffer||new Ab(this.device,{handle:null}),this._framebuffer}_updateDevice(){}}const lk={};function Fqe(t="id"){lk[t]=lk[t]||1;const e=lk[t]++;return`${t}-${e}`}class Ib extends jo{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength=0;bytesUsed=0;constructor(e,r={}){super(e,r),this.device=e,this.gl=this.device.gl;const n=typeof r=="object"?r.handle:void 0;this.handle=n||this.gl.createBuffer(),e._setWebGLDebugMetadata(this.handle,this,{spector:{...this.props,data:typeof this.props.data}}),this.glTarget=Bqe(this.props.usage),this.glUsage=zqe(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}_initWithData(e,r=0,n=e.byteLength+r){const i=this.glTarget;this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.glUsage),this.gl.bufferSubData(i,r,e),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(e,r,n),this.trackAllocatedMemory(n)}_initWithByteLength(e){let r=e;e===0&&(r=new Float32Array(0));const n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}write(e,r=0){const n=ArrayBuffer.isView(e)?e:new Uint8Array(e),i=36663;this.gl.bindBuffer(i,this.handle),this.gl.bufferSubData(i,r,n),this.gl.bindBuffer(i,null),this._setDebugData(e,r,e.byteLength)}async mapAndWriteAsync(e,r=0,n=this.byteLength-r){const i=new ArrayBuffer(n);await e(i,"copied"),this.write(i,r)}async readAsync(e=0,r){return this.readSyncWebGL(e,r)}async mapAndReadAsync(e,r=0,n){const i=await this.readAsync(r,n);return await e(i.buffer,"copied")}readSyncWebGL(e=0,r){r=r??this.byteLength-e;const n=new Uint8Array(r),i=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,n,i,r),this.gl.bindBuffer(36662,null),this._setDebugData(n,e,r),n}}function Bqe(t){return t&jo.INDEX?34963:t&jo.VERTEX?34962:t&jo.UNIFORM?35345:34962}function zqe(t){return t&jo.INDEX||t&jo.VERTEX?35044:t&jo.UNIFORM?35048:35044}function jqe(t){const e=t.split(/\r?\n/),r=[];for(const n of e){if(n.length<=1)continue;const i=n.split(":");if(i.length===2){const[m,b]=i;r.push({message:b.trim(),type:EG(m),lineNum:0,linePos:0});continue}const[a,s,o,...c]=i;let h=parseInt(o,10);isNaN(h)&&(h=0);let d=parseInt(s,10);isNaN(d)&&(d=0),r.push({message:c.join(":").trim(),type:EG(a),lineNum:h,linePos:d})}return r}function EG(t){const e=["warning","error","info"],r=t.toLowerCase();return e.includes(r)?r:"info"}class Uqe extends Z3{device;handle;constructor(e,r){switch(super(e,r),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0,this.handle.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>(this._getCompilationStatus(),this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?jqe(e):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es
${e}`;const{gl:r}=this.device;if(r.shaderSource(this.handle,e),r.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}rn.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),rn.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const e=async i=>await new Promise(a=>setTimeout(a,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:n}=this.device;for(;;){if(n.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function Vqe(t,e,r,n){if(Wqe(e))return n(t);const i=t;i.pushState();try{return $qe(t,e),P_(i.gl,r),n(t)}finally{i.popState()}}function $qe(t,e){const r=t,{gl:n}=r;if(e.cullMode)switch(e.cullMode){case"none":n.disable(2884);break;case"front":n.enable(2884),n.cullFace(1028);break;case"back":n.enable(2884),n.cullFace(1029);break}if(e.frontFace&&n.frontFace(Xm("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&n.enable(34383),e.depthBias!==void 0&&(n.enable(32823),n.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){const a=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,s=Xm("provokingVertex",e.provokingVertex,{first:36429,last:36430});a?.provokingVertexWEBGL(s)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){const a=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,s=Xm("polygonMode",e.polygonMode,{fill:6914,line:6913});a?.polygonModeWEBGL(1028,s),a?.polygonModeWEBGL(1029,s)}e.polygonOffsetLine&&n.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&n.enable(12288),e.clipDistance1&&n.enable(12289),e.clipDistance2&&n.enable(12290),e.clipDistance3&&n.enable(12291),e.clipDistance4&&n.enable(12292),e.clipDistance5&&n.enable(12293),e.clipDistance6&&n.enable(12294),e.clipDistance7&&n.enable(12295)),e.depthWriteEnabled!==void 0&&n.depthMask(Hqe("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?n.enable(2929):n.disable(2929),n.depthFunc(mD("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;n.stencilMaskSeparate(1028,i),n.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&rn.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,a=mD("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?n.enable(2960):n.disable(2960),n.stencilFuncSeparate(1028,a,0,i),n.stencilFuncSeparate(1029,a,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=uk("stencilPassOperation",e.stencilPassOperation),a=uk("stencilFailOperation",e.stencilFailOperation),s=uk("stencilDepthFailOperation",e.stencilDepthFailOperation);n.stencilOpSeparate(1028,a,s,i),n.stencilOpSeparate(1029,a,s,i)}switch(e.blend){case!0:n.enable(3042);break;case!1:n.disable(3042);break}if(e.blendColorOperation||e.blendAlphaOperation){const i=TG("blendColorOperation",e.blendColorOperation||"add"),a=TG("blendAlphaOperation",e.blendAlphaOperation||"add");n.blendEquationSeparate(i,a);const s=rS("blendColorSrcFactor",e.blendColorSrcFactor||"one"),o=rS("blendColorDstFactor",e.blendColorDstFactor||"zero"),c=rS("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),h=rS("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");n.blendFuncSeparate(s,o,c,h)}}function mD(t,e){return Xm(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function uk(t,e){return Xm(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function TG(t,e){return Xm(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function rS(t,e,r="color"){return Xm(t,e,{one:1,zero:0,src:768,"one-minus-src":769,dst:774,"one-minus-dst":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,constant:r==="color"?32769:32771,"one-minus-constant":r==="color"?32770:32772,src1:768,"one-minus-src1":769,"src1-alpha":770,"one-minus-src1-alpha":771})}function qqe(t,e){return`Illegal parameter ${e} for ${t}`}function Xm(t,e,r){if(!(e in r))throw new Error(qqe(t,e));return r[e]}function Hqe(t,e){return e}function Wqe(t){let e=!0;for(const r in t){e=!1;break}return e}function _ne(t){const e={};return t.addressModeU&&(e[10242]=ck(t.addressModeU)),t.addressModeV&&(e[10243]=ck(t.addressModeV)),t.addressModeW&&(e[32882]=ck(t.addressModeW)),t.magFilter&&(e[10240]=yD(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=Gqe(t.minFilter||"linear",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type==="comparison-sampler"&&(e[34892]=34894),t.compare&&(e[34893]=mD("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function ck(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function yD(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}function Gqe(t,e="none"){if(!e)return yD(t);switch(e){case"none":return yD(t);case"nearest":switch(t){case"nearest":return 9984;case"linear":return 9985}break;case"linear":switch(t){case"nearest":return 9986;case"linear":return 9987}}}class Xqe extends dy{device;handle;parameters;constructor(e,r){super(e,r),this.device=e,this.parameters=_ne(r),this.handle=r.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[r,n]of Object.entries(e)){const i=Number(r);switch(i){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,i,n);break;default:this.device.gl.samplerParameteri(this.handle,i,n);break}}}}function yx(t,e,r){if(Yqe(e))return r(t);const{nocatch:n=!0}=e,i=Gm.get(t);i.push(),P_(t,e);let a;if(n)a=r(t),i.pop();else try{a=r(t)}finally{i.pop()}return a}function Yqe(t){for(const e in t)return!1;return!0}class _0 extends Y3{device;gl;handle;texture;constructor(e,r){super(e,{...Fl.defaultProps,...r}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}class Pb extends Fl{device;gl;handle;sampler=void 0;view;glTarget;glFormat;glType;glInternalFormat;compressed;_textureUnit=0;constructor(e,r){super(e,r),this.device=e,this.gl=this.device.gl;const n=vne(this.props.format);this.glTarget=Zqe(this.props.dimension),this.glInternalFormat=n.internalFormat,this.glFormat=n.format,this.glType=n.type,this.compressed=n.compressed,this.handle=this.props.handle||this.gl.createTexture(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.gl.bindTexture(this.glTarget,this.handle);const{dimension:i,width:a,height:s,depth:o,mipLevels:c,glTarget:h,glInternalFormat:d}=this;switch(i){case"2d":case"cube":this.gl.texStorage2D(h,c,d,a,s);break;case"2d-array":case"3d":this.gl.texStorage3D(h,c,d,a,s,o);break;default:throw new Error(i)}this.gl.bindTexture(this.glTarget,null),this._initializeData(r.data),this.setSampler(this.props.sampler),this.view=new _0(this.device,{...this.props,texture:this}),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new _0(this.device,{...e,texture:this})}setSampler(e={}){super.setSampler(e);const r=_ne(this.sampler.props);this._setSamplerParameters(r)}copyImageData(e){const r=this._normalizeCopyImageDataOptions(e),n=r.data,{width:i,height:a,depth:s}=this,{mipLevel:o=0,byteOffset:c=0,x:h=0,y:d=0,z:m=0}=r,{glFormat:b,glType:x,compressed:E}=this,T=CG(this.glTarget,this.dimension,m);let A;if(!this.compressed){const{bytesPerPixel:F}=this.device.getTextureFormatInfo(this.format);if(F){if(r.bytesPerRow%F!==0)throw new Error(`bytesPerRow (${r.bytesPerRow}) must be a multiple of bytesPerPixel (${F}) for ${this.format}`);A=r.bytesPerRow/F}}const M=this.compressed?{}:{...A!==void 0?{3314:A}:{},32878:r.rowsPerImage};this.gl.bindTexture(T,this.handle),yx(this.gl,M,()=>{switch(this.dimension){case"2d":case"cube":E?this.gl.compressedTexSubImage2D(T,o,h,d,i,a,b,n,c):this.gl.texSubImage2D(T,o,h,d,i,a,b,x,n,c);break;case"2d-array":case"3d":E?this.gl.compressedTexSubImage3D(T,o,h,d,m,i,a,s,b,n,c):this.gl.texSubImage3D(T,o,h,d,m,i,a,s,b,x,n,c);break;default:}}),this.gl.bindTexture(T,null)}copyExternalImage(e){const r=this._normalizeCopyExternalImageOptions(e);if(r.sourceX||r.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");const{glFormat:n,glType:i}=this,{image:a,depth:s,mipLevel:o,x:c,y:h,z:d,width:m,height:b}=r,x=CG(this.glTarget,this.dimension,s),E=r.flipY?{37440:!0}:{};return this.gl.bindTexture(this.glTarget,this.handle),yx(this.gl,E,()=>{switch(this.dimension){case"2d":case"cube":this.gl.texSubImage2D(x,o,c,h,m,b,n,i,a);break;case"2d-array":case"3d":this.gl.texSubImage3D(x,o,c,h,d,m,b,s,n,i,a);break;default:}}),this.gl.bindTexture(this.glTarget,null),{width:r.width,height:r.height}}generateMipmapsWebGL(e){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(rn.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!e?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(n){rn.warn(`Error generating mipmap for ${this}: ${n.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}_setSamplerParameters(e){rn.log(2,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[r,n]of Object.entries(e)){const i=Number(r),a=n;switch(i){case 33082:case 33083:this.gl.texParameterf(this.glTarget,i,a);break;case 10240:case 10241:this.gl.texParameteri(this.glTarget,i,a);break;case 10242:case 10243:case 32882:this.gl.texParameteri(this.glTarget,i,a);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,i,a);break;case 34892:case 34893:this.gl.texParameteri(this.glTarget,i,a);break}}this.gl.bindTexture(this.glTarget,null)}_getActiveUnit(){return this.gl.getParameter(34016)-33984}_bind(e){const{gl:r}=this;return e!==void 0&&(this._textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,this.handle),e}_unbind(e){const{gl:r}=this;return e!==void 0&&(this._textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,null),e}}function Zqe(t){switch(t){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(t)}function CG(t,e,r){return e==="cube"?34069+r:t}function Kqe(t){return tHe[t]}function b6(t){return eHe[t]}function Jqe(t){return!!bne[t]}function Qqe(t){return bne[t]}const eHe={5126:"f32",35664:"vec2<f32>",35665:"vec3<f32>",35666:"vec4<f32>",5124:"i32",35667:"vec2<i32>",35668:"vec3<i32>",35669:"vec4<i32>",5125:"u32",36294:"vec2<u32>",36295:"vec3<u32>",36296:"vec4<u32>",35670:"f32",35671:"vec2<f32>",35672:"vec3<f32>",35673:"vec4<f32>",35674:"mat2x2<f32>",35685:"mat2x3<f32>",35686:"mat2x4<f32>",35687:"mat3x2<f32>",35675:"mat3x3<f32>",35688:"mat3x4<f32>",35689:"mat4x2<f32>",35690:"mat4x3<f32>",35676:"mat4x4<f32>"},bne={35678:{viewDimension:"2d",sampleType:"float"},35680:{viewDimension:"cube",sampleType:"float"},35679:{viewDimension:"3d",sampleType:"float"},35682:{viewDimension:"3d",sampleType:"depth"},36289:{viewDimension:"2d-array",sampleType:"float"},36292:{viewDimension:"2d-array",sampleType:"depth"},36293:{viewDimension:"cube",sampleType:"float"},36298:{viewDimension:"2d",sampleType:"sint"},36299:{viewDimension:"3d",sampleType:"sint"},36300:{viewDimension:"cube",sampleType:"sint"},36303:{viewDimension:"2d-array",sampleType:"uint"},36306:{viewDimension:"2d",sampleType:"uint"},36307:{viewDimension:"3d",sampleType:"uint"},36308:{viewDimension:"cube",sampleType:"uint"},36311:{viewDimension:"2d-array",sampleType:"uint"}},tHe={uint8:5121,sint8:5120,unorm8:5121,snorm8:5120,uint16:5123,sint16:5122,unorm16:5123,snorm16:5122,uint32:5125,sint32:5124,float16:5131,float32:5126};function rHe(t,e){const r={attributes:[],bindings:[]};r.attributes=nHe(t,e);const n=oHe(t,e);for(const o of n){const c=o.uniforms.map(h=>({name:h.name,format:h.format,byteOffset:h.byteOffset,byteStride:h.byteStride,arrayLength:h.arrayLength}));r.bindings.push({type:"uniform",name:o.name,group:0,location:o.location,visibility:(o.vertex?1:0)&(o.fragment?2:0),minBindingSize:o.byteLength,uniforms:c})}const i=aHe(t,e);let a=0;for(const o of i)if(Jqe(o.type)){const{viewDimension:c,sampleType:h}=Qqe(o.type);r.bindings.push({type:"texture",name:o.name,group:0,location:a,viewDimension:c,sampleType:h}),o.textureUnit=a,a+=1}i.length&&(r.uniforms=i);const s=iHe(t,e);return s?.length&&(r.varyings=s),r}function nHe(t,e){const r=[],n=t.getProgramParameter(e,35721);for(let i=0;i<n;i++){const a=t.getActiveAttrib(e,i);if(!a)throw new Error("activeInfo");const{name:s,type:o}=a,c=t.getAttribLocation(e,s);if(c>=0){const h=b6(o),d=/instance/i.test(s)?"instance":"vertex";r.push({name:s,location:c,stepMode:d,type:h})}}return r.sort((i,a)=>i.location-a.location),r}function iHe(t,e){const r=[],n=t.getProgramParameter(e,35971);for(let i=0;i<n;i++){const a=t.getTransformFeedbackVarying(e,i);if(!a)throw new Error("activeInfo");const{name:s,type:o,size:c}=a,h=b6(o),{type:d,components:m}=lre(h);r.push({location:i,name:s,type:d,size:c*m})}return r.sort((i,a)=>i.location-a.location),r}function aHe(t,e){const r=[],n=t.getProgramParameter(e,35718);for(let i=0;i<n;i++){const a=t.getActiveUniform(e,i);if(!a)throw new Error("activeInfo");const{name:s,size:o,type:c}=a,{name:h,isArray:d}=sHe(s);let m=t.getUniformLocation(e,h);const b={location:m,name:h,size:o,type:c,isArray:d};if(r.push(b),b.size>1)for(let x=0;x<b.size;x++){const E=`${h}[${x}]`;m=t.getUniformLocation(e,E);const T={...b,name:E,location:m};r.push(T)}}return r}function oHe(t,e){const r=(a,s)=>t.getActiveUniformBlockParameter(e,a,s),n=[],i=t.getProgramParameter(e,35382);for(let a=0;a<i;a++){const s={name:t.getActiveUniformBlockName(e,a)||"",location:r(a,35391),byteLength:r(a,35392),vertex:r(a,35396),fragment:r(a,35398),uniformCount:r(a,35394),uniforms:[]},o=r(a,35395)||[],c=t.getActiveUniforms(e,o,35383),h=t.getActiveUniforms(e,o,35384),d=t.getActiveUniforms(e,o,35387),m=t.getActiveUniforms(e,o,35388);for(let b=0;b<s.uniformCount;++b){const x=t.getActiveUniform(e,o[b]);if(!x)throw new Error("activeInfo");const E=b6(c[b]);s.uniforms.push({name:x.name,format:E,type:c[b],arrayLength:h[b],byteOffset:d[b],byteStride:m[b]})}n.push(s)}return n.sort((a,s)=>a.location-s.location),n}function sHe(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const r=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!r||r.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:r[1],length:r[2]?1:0,isArray:!!r[2]}}function lHe(t,e,r,n){const i=t;let a=n;a===!0&&(a=1),a===!1&&(a=0);const s=typeof a=="number"?[a]:a;switch(r){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof n!="number")throw new Error("samplers must be set to integers");return t.uniform1i(e,n);case 5126:return t.uniform1fv(e,s);case 35664:return t.uniform2fv(e,s);case 35665:return t.uniform3fv(e,s);case 35666:return t.uniform4fv(e,s);case 5124:return t.uniform1iv(e,s);case 35667:return t.uniform2iv(e,s);case 35668:return t.uniform3iv(e,s);case 35669:return t.uniform4iv(e,s);case 35670:return t.uniform1iv(e,s);case 35671:return t.uniform2iv(e,s);case 35672:return t.uniform3iv(e,s);case 35673:return t.uniform4iv(e,s);case 5125:return i.uniform1uiv(e,s,1);case 36294:return i.uniform2uiv(e,s,2);case 36295:return i.uniform3uiv(e,s,3);case 36296:return i.uniform4uiv(e,s,4);case 35674:return t.uniformMatrix2fv(e,!1,s);case 35675:return t.uniformMatrix3fv(e,!1,s);case 35676:return t.uniformMatrix4fv(e,!1,s);case 35685:return i.uniformMatrix2x3fv(e,!1,s);case 35686:return i.uniformMatrix2x4fv(e,!1,s);case 35687:return i.uniformMatrix3x2fv(e,!1,s);case 35688:return i.uniformMatrix3x4fv(e,!1,s);case 35689:return i.uniformMatrix4x2fv(e,!1,s);case 35690:return i.uniformMatrix4x3fv(e,!1,s)}throw new Error("Illegal uniform")}function uHe(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(t)}}function cHe(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(t)}}const AG=4;class hHe extends qm{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};get[Symbol.toStringTag](){return"WEBGLRenderPipeline"}constructor(e,r){super(e,r),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:{id:this.props.id}}),this.vs=r.vs,this.fs=r.fs;const{varyings:n,bufferMode:i=35981}=r;n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,i)),this._linkShaders(),rn.time(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=rHe(this.device.gl,this.handle),rn.timeEnd(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=r.shaderLayout?fHe(this.introspectedLayout,r.shaderLayout):this.introspectedLayout}destroy(){this.handle&&(this.device.gl.useProgram(null),this.device.gl.deleteProgram(this.handle),this.destroyed=!0,this.handle.destroyed=!0,this.handle=null)}setBindings(e,r){for(const[n,i]of Object.entries(e)){const a=this.shaderLayout.bindings.find(s=>s.name===n)||this.shaderLayout.bindings.find(s=>s.name===`${n}Uniforms`);if(!a){const s=this.shaderLayout.bindings.map(o=>`"${o.name}"`).join(", ");r?.disableWarnings||rn.warn(`No binding "${n}" in render pipeline "${this.id}", expected one of ${s}`,i)();continue}switch(i||rn.warn(`Unsetting binding "${n}" in render pipeline "${this.id}"`)(),a.type){case"uniform":if(!(i instanceof Ib)&&!(i.buffer instanceof Ib))throw new Error("buffer value");break;case"texture":if(!(i instanceof _0||i instanceof Pb||i instanceof Ab))throw new Error(`${this} Bad texture binding for ${n}`);break;case"sampler":rn.warn(`Ignoring sampler ${n}`)();break;default:throw new Error(a.type)}this.bindings[n]=i}}draw(e){const{renderPass:r,parameters:n=this.props.parameters,topology:i=this.props.topology,vertexArray:a,vertexCount:s,instanceCount:o,isInstanced:c=!1,firstVertex:h=0,transformFeedback:d}=e,m=uHe(i),b=!!a.indexBuffer,x=a.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return rn.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return rn.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),a.bindBeforeRender(r),d&&d.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const E=r;return Vqe(this.device,n,E.glParameters,()=>{b&&c?this.device.gl.drawElementsInstanced(m,s||0,x,h,o||0):b?this.device.gl.drawElements(m,s||0,x,h):c?this.device.gl.drawArraysInstanced(m,h,s||0,o||0):this.device.gl.drawArrays(m,h,s||0),d&&d.end()}),a.unbindAfterRender(r),!0}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),rn.time(AG,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),rn.timeEnd(AG,`linkProgram for ${this.id}`)(),rn.level,!this.device.features.has("compilation-status-async-webgl")){const n=this._getLinkStatus();this._reportLinkStatus(n);return}rn.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),rn.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const r=this._getLinkStatus();this._reportLinkStatus(r)}async _reportLinkStatus(e){switch(e){case"success":return;default:const r=e==="link-error"?"Link error":"Validation error";switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`${this} ${r} during compilation of ${this.vs}`);case"pending":await this.vs.asyncCompilationStatus,this.vs.debugShader();break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`${this} ${r} during compilation of ${this.fs}`);case"pending":await this.fs.asyncCompilationStatus,this.fs.debugShader();break}const n=this.device.gl.getProgramInfoLog(this.handle);this.device.reportError(new Error(`${r} during ${e}: ${n}`),this)(),this.device.debug()}}_getLinkStatus(){const{gl:e}=this.device;return e.getProgramParameter(this.handle,35714)?(e.validateProgram(this.handle),e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation-error")):(this.linkStatus="error","link-error")}async _waitForLinkComplete(){const e=async i=>await new Promise(a=>setTimeout(a,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:n}=this.device;for(;;){if(n.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const r of this.shaderLayout.bindings)!this.bindings[r.name]&&!this.bindings[r.name.replace(/Uniforms$/,"")]&&(rn.warn(`Binding ${r.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:e}=this.device;e.useProgram(this.handle);let r=0,n=0;for(const i of this.shaderLayout.bindings){const a=this.bindings[i.name]||this.bindings[i.name.replace(/Uniforms$/,"")];if(!a)throw new Error(`No value for binding ${i.name} in ${this.id}`);switch(i.type){case"uniform":const{name:s}=i,o=e.getUniformBlockIndex(this.handle,s);if(o===4294967295)throw new Error(`Invalid uniform block name ${s}`);e.uniformBlockBinding(this.handle,n,o),a instanceof Ib?e.bindBufferBase(35345,n,a.handle):e.bindBufferRange(35345,n,a.buffer.handle,a.offset||0,a.size||a.buffer.byteLength-a.offset),n+=1;break;case"texture":if(!(a instanceof _0||a instanceof Pb||a instanceof Ab))throw new Error("texture");let c;if(a instanceof _0)c=a.texture;else if(a instanceof Pb)c=a;else if(a instanceof Ab&&a.colorAttachments[0]instanceof _0)rn.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),c=a.colorAttachments[0].texture;else throw new Error("No texture");e.activeTexture(33984+r),e.bindTexture(c.glTarget,c.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${i.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:r,location:n,type:i,textureUnit:a}=e,s=this.uniforms[r]??a;s!==void 0&&lHe(this.device.gl,n,i,s)}}}function fHe(t,e){const r={...t,attributes:t.attributes.map(n=>({...n}))};for(const n of e?.attributes||[]){const i=r.attributes.find(a=>a.name===n.name);i?(i.type=n.type||i.type,i.stepMode=n.stepMode||i.stepMode):rn.warn(`shader layout attribute ${n.name} not present in shader`)}return r}class dHe extends $L{device;handle=null;commands=[];constructor(e){super(e,{}),this.device=e}_executeCommands(e=this.commands){for(const r of e)switch(r.name){case"copy-buffer-to-buffer":pHe(this.device,r.options);break;case"copy-buffer-to-texture":gHe(this.device,r.options);break;case"copy-texture-to-buffer":mHe(this.device,r.options);break;case"copy-texture-to-texture":yHe(this.device,r.options);break;default:throw new Error(r.name)}}}function pHe(t,e){const r=e.sourceBuffer,n=e.destinationBuffer;t.gl.bindBuffer(36662,r.handle),t.gl.bindBuffer(36663,n.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function gHe(t,e){throw new Error("Not implemented")}function mHe(t,e){const{sourceTexture:r,mipLevel:n=0,aspect:i="all",width:a=e.sourceTexture.width,height:s=e.sourceTexture.height,depthOrArrayLayers:o=0,origin:c=[0,0],destinationBuffer:h,byteOffset:d=0,bytesPerRow:m,rowsPerImage:b}=e;if(i!=="all")throw new Error("aspect not supported in WebGL");if(n!==0||o!==0||m||b)throw new Error("not implemented");const{framebuffer:x,destroyFramebuffer:E}=xne(r);let T;try{const A=h,M=a||x.width,F=s||x.height,N=vne(x.colorAttachments[0].texture.props.format),O=N.format,U=N.type;t.gl.bindBuffer(35051,A.handle),T=t.gl.bindFramebuffer(36160,x.handle),t.gl.readPixels(c[0],c[1],M,F,O,U,d)}finally{t.gl.bindBuffer(35051,null),T!==void 0&&t.gl.bindFramebuffer(36160,T),E&&x.destroy()}}function yHe(t,e){const{sourceTexture:r,destinationMipLevel:n=0,origin:i=[0,0],destinationOrigin:a=[0,0],destinationTexture:s}=e;let{width:o=e.destinationTexture.width,height:c=e.destinationTexture.height}=e;const{framebuffer:h,destroyFramebuffer:d}=xne(r),[m,b]=i,[x,E,T]=a,A=t.gl.bindFramebuffer(36160,h.handle);let M,F;if(s instanceof Pb)M=s,o=Number.isFinite(o)?o:M.width,c=Number.isFinite(c)?c:M.height,M._bind(0),F=M.glTarget;else throw new Error("invalid destination");switch(F){case 3553:case 34067:t.gl.copyTexSubImage2D(F,n,x,E,m,b,o,c);break;case 35866:case 32879:t.gl.copyTexSubImage3D(F,n,x,E,T,m,b,o,c);break}M&&M._unbind(),t.gl.bindFramebuffer(36160,A),d&&h.destroy()}function xne(t){if(t instanceof Fl){const{width:e,height:r,id:n}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${n}`,width:e,height:r,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}const vHe=[1,2,4,8];class _He extends Am{device;handle=null;glParameters={};constructor(e,r){super(e,r),this.device=e;let n;if(!r?.parameters?.viewport)if(r?.framebuffer){const{width:a,height:s}=r.framebuffer;n=[0,0,a,s]}else{const[a,s]=e.getDefaultCanvasContext().getDrawingBufferSize();n=[0,0,a,s]}this.device.pushState(),this.setParameters({viewport:n,...this.props.parameters});const i=this.props.framebuffer;if(this.props.framebuffer&&i?.handle){const a=this.props.framebuffer.colorAttachments.map((s,o)=>36064+o);this.device.gl.drawBuffers(a)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){const r={...this.glParameters};r.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(r.viewport=e.viewport.slice(0,4),r.depthRange=[e.viewport[4],e.viewport[5]]):r.viewport=e.viewport),e.scissorRect&&(r.scissorTest=!0,r.scissor=e.scissorRect),e.blendConstant&&(r.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),r[2967]=e.stencilReference),"colorMask"in e&&(r.colorMask=vHe.map(n=>!!(n&e.colorMask))),this.glParameters=r,P_(this.device.gl,r)}beginOcclusionQuery(e){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){const e={...this.glParameters};let r=0;this.props.clearColors&&this.props.clearColors.forEach((n,i)=>{n&&this.clearColorBuffer(i,n)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(r|=16384,e.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=256,e.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=1024,e.clearStencil=this.props.clearStencil),r!==0&&yx(this.device.gl,e,()=>{this.device.gl.clear(r)})}clearColorBuffer(e=0,r=[0,0,0,0]){yx(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,r);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,r);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,r);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}class IG extends VL{device;handle=null;commandBuffer;constructor(e,r){super(e,r),this.device=e,this.commandBuffer=new dHe(e)}destroy(){}finish(){return this.commandBuffer}beginRenderPass(e){return new _He(this.device,e)}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,r,n){}}function bHe(t){const{target:e,source:r,start:n=0,count:i=1}=t,a=r.length,s=i*a;let o=0;for(let c=n;o<a;o++)e[c++]=r[o];for(;o<s;)o<s-o?(e.copyWithin(n+o,n,n+o),o*=2):(e.copyWithin(n+o,n,n+s-o),o=s);return t.target}class x6 extends qL{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return NFe()==="Chrome"}constructor(e,r){super(e,r),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const r=e;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(e,r){const n=r;if(n.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:i,type:a,stride:s,offset:o,normalized:c,integer:h,divisor:d}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),h?this.device.gl.vertexAttribIPointer(e,i,a,s,o):this.device.gl.vertexAttribPointer(e,i,a,c,s,o),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,d||0),this.attributes[e]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,r){this._enable(e,!1),this.attributes[e]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const r=this.attributes[e];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(e,r)}}_getAccessor(e){const r=this.attributeInfos[e];if(!r)throw new Error(`Unknown attribute location ${e}`);const n=yne(r.bufferDataType);return{size:r.bufferComponents,type:n,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(e,r=!0){const i=x6.isConstantAttributeZeroSupported(this.device)||e!==0;(r||i)&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,r){const n=xHe(r),i=n.byteLength*e,a=n.length*e;if(this.buffer&&i!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${i} !== ${this.buffer.byteLength}.`);let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:i}),s||=!wHe(n,this.bufferValue),s){const o=P9e(r.constructor,a);bHe({target:o,source:n,start:0,count:a}),this.buffer.write(o),this.bufferValue=r}return this.buffer}}function xHe(t){return Array.isArray(t)?new Float32Array(t):t}function wHe(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}class SHe extends HL{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,r){super(e,r),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(cHe(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const r in e)this.setBuffer(r,e[r])})}setBuffer(e,r){const n=this._getVaryingIndex(e),{buffer:i,byteLength:a,byteOffset:s}=this._getBufferRange(r);if(n<0){this.unusedBuffers[e]=i,rn.warn(`${this.id} unusedBuffers varying buffer ${e}`)();return}this.buffers[n]={buffer:i,byteLength:a,byteOffset:s},this.bindOnUse||this._bindBuffer(n,i,s,a)}getBuffer(e){if(PG(e))return this.buffers[e]||null;const r=this._getVaryingIndex(e);return r>=0?this.buffers[r]:null}bind(e=this.handle){if(typeof e!="function")return this.gl.bindTransformFeedback(36386,e),this;let r;return this._bound?r=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof Ib)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:r,byteOffset:n=0,byteLength:i=e.buffer.byteLength}=e;return{buffer:r,byteOffset:n,byteLength:i}}_getVaryingIndex(e){if(PG(e))return Number(e);for(const r of this.layout.varyings||[])if(e===r.name)return r.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:r,byteLength:n,byteOffset:i}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),r,i,n)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,r,n=0,i){const a=r&&r.handle;!a||i===void 0?this.gl.bindBufferBase(35982,e,a):this.gl.bindBufferRange(35982,e,a,n,i)}}function PG(t){return typeof t=="number"?Number.isInteger(t):/^\d+$/.test(t)}class EHe extends WL{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,r){if(super(e,r),this.device=e,r.count>1)throw new Error("WebGL QuerySet can only have one value");const n=this.device.gl.createQuery();if(!n)throw new Error("WebGL query not supported");this.handle=n,Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((n,i)=>{const a=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):r++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(a)};requestAnimationFrame(a)}),this._pollingPromise}}function wne(t){switch(t){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function THe(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function CHe(t){return AHe[t]}const AHe={5124:"sint32",5125:"uint32",5122:"sint16",5123:"uint16",5120:"sint8",5121:"uint8",5126:"float32",5131:"float16",33635:"uint16",32819:"uint16",32820:"uint16",33640:"uint32",35899:"uint32",35902:"uint32",34042:"uint32",36269:"uint32"};function IHe(t,e){const{sourceX:r=0,sourceY:n=0,sourceAttachment:i=0}=e||{};let{target:a=null,sourceWidth:s,sourceHeight:o,sourceDepth:c,sourceFormat:h,sourceType:d}=e||{};const{framebuffer:m,deleteFramebuffer:b}=Sne(t),{gl:x,handle:E}=m;s||=m.width,o||=m.height;const T=m.colorAttachments[i]?.texture;if(!T)throw new Error(`Invalid framebuffer attachment ${i}`);c=T?.depth||1,h||=T?.glFormat||6408,d||=T?.glType||5121,a=RHe(a,d,h,s,o);const A=BL(a);d=d||Kqe(A);const M=x.bindFramebuffer(36160,E);return x.readBuffer(36064+i),x.readPixels(r,n,s,o,h,d,a),x.readBuffer(36064),x.bindFramebuffer(36160,M||null),b&&m.destroy(),a}function PHe(t,e){const{target:r,sourceX:n=0,sourceY:i=0,sourceFormat:a=6408,targetByteOffset:s=0}=e||{};let{sourceWidth:o,sourceHeight:c,sourceType:h}=e||{};const{framebuffer:d,deleteFramebuffer:m}=Sne(t);o=o||d.width,c=c||d.height;const b=d;h=h||5121;let x=r;if(!x){const T=wne(a),A=THe(h),M=s+o*c*T*A;x=b.device.createBuffer({byteLength:M})}const E=t.device.createCommandEncoder();return E.copyTextureToBuffer({sourceTexture:t,width:o,height:c,origin:[n,i],destinationBuffer:x,byteOffset:s}),E.destroy(),m&&d.destroy(),x}function Sne(t){return t instanceof K3?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:kHe(t),deleteFramebuffer:!0}}function kHe(t,e){const{device:r,width:n,height:i,id:a}=t;return r.createFramebuffer({...e,id:`framebuffer-for-${a}`,width:n,height:i,colorAttachments:[t]})}function RHe(t,e,r,n,i,a){if(t)return t;e||=5121;const s=CHe(e),o=zL(s),c=wne(r);return new o(n*i*c)}class vD extends fy{type="webgl";handle;features;limits;info;canvasContext;preferredColorFormat="rgba8unorm";preferredDepthFormat="depth24plus";commandEncoder;lost;_resolveContextLost;gl;_constants;_extensions={};_polyfilled=!1;spectorJS;get[Symbol.toStringTag](){return"WebGLDevice"}toString(){return`${this[Symbol.toStringTag]}(${this.id})`}isVertexFormatSupported(e){switch(e){case"unorm8x4-bgra":return!1;default:return!0}}constructor(e){super({...e,id:e.id||Fqe("webgl-device")});const r=fy._getCanvasContextProps(e);if(!r)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let n=r.canvas?.gl?.device;if(n)throw new Error(`WebGL context already attached to device ${n.id}`);this.canvasContext=new Lqe(this,r),this.lost=new Promise(d=>{this._resolveContextLost=d});const i={...e.webgl};r.alphaMode==="premultiplied"&&(i.premultipliedAlpha=!0),e.powerPreference!==void 0&&(i.powerPreference=e.powerPreference);const s=this.props._handle||mqe(this.canvasContext.canvas,{onContextLost:d=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:d=>console.log("WebGL context restored")},i);if(!s)throw new Error("WebGL context creation failed");if(n=s.device,n){if(e._reuseDevices)return rn.log(1,`Not creating a new Device, instead returning a reference to Device ${n.id} already attached to WebGL context`,n)(),n._reused=!0,n;throw new Error(`WebGL context already attached to device ${n.id}`)}this.handle=s,this.gl=s,this.spectorJS=J$e({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=yqe(this.gl,this._extensions),this.limits=new Dqe(this.gl),this.features=new Mqe(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),new Gm(this.gl,{log:(...d)=>rn.log(1,...d)()}).trackState(this.gl,{copyState:!1});const c=e.debugWebGL||e.debug,h=e.debugWebGL;c&&(this.gl=tqe(this.gl,{debugWebGL:c,traceWebGL:h}),rn.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(rn.level=Math.max(rn.level,1))),this.commandEncoder=new IG(this,{id:`${this}-command-encoder`})}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}getTextureByteAlignment(){return 4}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const r=this._normalizeBufferProps(e);return new Ib(this,r)}createTexture(e){return new Pb(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new Xqe(this,e)}createShader(e){return new Uqe(this,e)}createFramebuffer(e){return new Ab(this,e)}createVertexArray(e){return new x6(this,e)}createTransformFeedback(e){return new SHe(this,e)}createQuerySet(e){return new EHe(this,e)}createRenderPipeline(e){return new hHe(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}createCommandEncoder(e={}){return new IG(this,e)}submit(e){e||(e=this.commandEncoder.finish(),this.commandEncoder.destroy(),this.commandEncoder=this.createCommandEncoder({id:`${this.id}-default-encoder`})),e._executeCommands()}readPixelsToArrayWebGL(e,r){return IHe(e,r)}readPixelsToBufferWebGL(e,r){return PHe(e,r)}setParametersWebGL(e){P_(this.gl,e)}getParametersWebGL(e){return gne(this.gl,e)}withParametersWebGL(e,r){return yx(this.gl,e,r)}resetWebGL(){rn.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),hqe(this.gl)}_getDeviceSpecificTextureFormatCapabilities(e){return Iqe(this.gl,e,this._extensions)}loseDevice(){let e=!1;const n=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return n&&(e=!0,n.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){Gm.get(this.gl).push()}popState(){Gm.get(this.gl).pop()}getGLKey(e,r){const n=Number(e);for(const i in this.gl)if(this.gl[i]===n)return`GL.${i}`;return r?.emptyIfUnknown?"":String(e)}getGLKeys(e){const r={emptyIfUnknown:!0};return Object.entries(e).reduce((n,[i,a])=>(n[`${i}:${this.getGLKey(i,r)}`]=`${a}:${this.getGLKey(a,r)}`,n),{})}setConstantAttributeWebGL(e,r){const n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);const i=this._constants[e];switch(i&&NHe(i,r)&&rn.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=r,r.constructor){case Float32Array:MHe(this,e,r);break;case Int32Array:DHe(this,e,r);break;case Uint32Array:OHe(this,e,r);break;default:throw new Error("constant")}}getExtension(e){return s_(this.gl,e,this._extensions),this._extensions}_setWebGLDebugMetadata(e,r,n){e.luma=r;const i={props:n.spector,id:n.spector.id};e.__SPECTOR_Metadata=i}}function MHe(t,e,r){switch(r.length){case 1:t.gl.vertexAttrib1fv(e,r);break;case 2:t.gl.vertexAttrib2fv(e,r);break;case 3:t.gl.vertexAttrib3fv(e,r);break;case 4:t.gl.vertexAttrib4fv(e,r);break}}function DHe(t,e,r){t.gl.vertexAttribI4iv(e,r)}function OHe(t,e,r){t.gl.vertexAttribI4uiv(e,r)}function NHe(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}const kG=Object.freeze(Object.defineProperty({__proto__:null,WebGLDevice:vD},Symbol.toStringTag,{value:"Module"}));function ig(){}const LHe=({isDragging:t})=>t?"grabbing":"grab",Ene={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:ig,onWebGLInitialized:ig,onResize:ig,onViewStateChange:ig,onInteractionStateChange:ig,onBeforeRender:ig,onAfterRender:ig,onLoad:ig,onError:t=>po.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:LHe,getTooltip:null,debug:!1,drawPickingColors:!1};class vx{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new W3({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const a=n.offsetCenter;if(!a)return;i.x=a.x,i.y=a.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n},this._onEvent=n=>{const i=lD[n.type],a=n.offsetCenter;if(!i||!a||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:a.x,y:a.y,layers:s,viewports:this.getViewports(a)},this._lastPointerDownInfo),{layer:c}=o,h=c&&(c[i]||c.props[i]),d=this.props[i];let m=!1;h&&(m=h.call(c,o,n)),m||(d?.(o,n),this.widgetManager.onEvent(o,n))},this._onPointerDown=n=>{if(this.device?.type==="webgpu")return;const i=n.offsetCenter,a=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=a.result[0]||a.emptyInfo},this.props={...Ene,...e},e=this.props,e.viewState&&e.initialViewState&&po.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let r=this.device;if(!r&&e.gl){e.gl instanceof WebGLRenderingContext&&po.error("WebGL1 context not supported.")();const n=this.props.deviceProps?.onResize;r=ok.attach(e.gl,{...this.props.deviceProps,onResize:(i,a)=>{const{width:s,height:o}=i.canvas;i.drawingBufferWidth=s,i.drawingBufferHeight=o,this._needsRedraw="Canvas resized",n?.(i,a)}})}r||(r=this._createDevice(e)),this.animationLoop=this._createAnimationLoop(r,e),this.setProps(e),e._typedArrayManagerProps&&mx.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&po.removed("onLayerHover","onHover")(),"onLayerClick"in e&&po.removed("onLayerClick","onClick")(),e.initialViewState&&!Nh(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const r=Object.create(this.props);Object.assign(r,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),e.device&&e.device.id!==this.device?.id&&(this.animationLoop?.stop(),this.canvas!==e.device.canvasContext?.canvas&&(this.canvas?.remove(),this.eventManager?.destroy(),this.canvas=null),po.log(`recreating animation loop for new device! id=${e.device.id}`)(),this.animationLoop=this._createAnimationLoop(e.device,e),this.animationLoop.start()),this.animationLoop?.setProps(r),e.useDevicePixels!==void 0&&this.device?.canvasContext&&this.device.canvasContext.setProps({useDevicePixels:e.useDevicePixels}),this.layerManager&&(this.viewManager.setProps(r),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(r),this.effectManager.setProps(r),this.deckRenderer.setProps(r),this.deckPicker.setProps(r),this.widgetManager.setProps(r)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),a=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return r=r||n||i||a||s,r}redraw(e){if(!this.layerManager)return;let r=this.needsRedraw({clearRedrawFlags:!0});r=e||r,r&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(r):this._drawLayers(r))}get isInitialized(){return this.viewManager!==null}getViews(){return El(this.viewManager),this.viewManager.views}getViewports(e){return El(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const r=this._pick("pickObject","pickObject Time",e).result;return r.length?r[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,r=!1){for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:r})}_removeResources(e){for(const r of e)this.layerManager.resourceManager.remove(r)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,r,n){El(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(r).timeStart();const a=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(r).timeEnd(),a}_createCanvas(e){let r=e.canvas;return typeof r=="string"&&(r=document.getElementById(r),El(r)),r||(r=document.createElement("canvas"),r.id=e.id||"deckgl-overlay",e.width&&typeof e.width=="number"&&(r.width=e.width),e.height&&typeof e.height=="number"&&(r.height=e.height),(e.parent||document.body).appendChild(r)),Object.assign(r.style,e.style),r}_setCanvasSize(e){if(!this.canvas)return;const{width:r,height:n}=e;if(r||r===0){const i=Number.isFinite(r)?`${r}px`:r;this.canvas.style.width=i}if(n||n===0){const i=Number.isFinite(n)?`${n}px`:n;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=i}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const r=e.clientWidth??e.width,n=e.clientHeight??e.height;(r!==this.width||n!==this.height)&&(this.width=r,this.height=n,this.viewManager?.setProps({width:r,height:n}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:n}))}_createAnimationLoop(e,r){const{gl:n,onError:i}=r;return new u6({device:e,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:a=>this._setDevice(a.device),onRender:this._onRenderFrame.bind(this),onError:i})}_createDevice(e){const r=this.props.deviceProps?.createCanvasContext,n=typeof r=="object"?r:void 0,i={adapters:[],_cacheShaders:!0,_cachePipelines:!0,...e.deviceProps};i.adapters.includes(ok)||i.adapters.push(ok);const a={alphaMode:this.props.deviceProps?.type==="webgpu"?"premultiplied":void 0},s=this.props.deviceProps?.onResize;return JM.createDevice({_reuseDevices:!0,type:"webgl",...i,createCanvasContext:{...a,...n,canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!0},onResize:(o,c)=>{this._needsRedraw="Canvas resized",s?.(o,c)}})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,r=Array.isArray(e)?e:e?[e]:[new p6({id:"default-view"})];return r.length&&this.props.controller&&(r[0].props.controller=this.props.controller),r}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if(this.device?.type==="webgpu")return;const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:n}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let i=n,a=!1;for(const s of r)i=s,a=s.layer?.onHover(s,e.event)||a;a||(this.props.onHover?.(i,e.event),this.widgetManager.onHover(i,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas,!this.canvas.isConnected&&this.props.parent&&this.props.parent.insertBefore(this.canvas,this.props.parent.firstChild)),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);const r=new ane;r.play(),this.animationLoop.attachTimeline(r),this.eventManager=new vUe(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(HW).map(i=>{const[a,s,o,c]=HW[i],h=this.props.eventRecognizerOptions?.[i],d={...s,...h,event:i};return{recognizer:new a(d),recognizeWith:o,requestFailure:c}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in lD)this.eventManager.on(i,this._onEvent);this.viewManager=new y$e({timeline:r,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new m$e(this.device,{deck:this,stats:this.stats,viewport:n,timeline:r}),this.effectManager=new M$e({deck:this,device:this.device}),this.deckRenderer=new N$e(this.device),this.deckPicker=new B$e(this.device),this.widgetManager=new U$e({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new fne),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,r){const{device:n,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:i});const a={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...r};this.deckRenderer?.renderLayers(a),a.pass==="screen"&&this.widgetManager.onRedraw({viewports:a.viewports,layers:a.layers}),this.props.onAfterRender({device:n,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),po.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const r=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:r},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const r=this.animationLoop.stats;e.get("GPU Time").addTime(r.get("GPU Time").lastTiming),e.get("CPU Time").addTime(r.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:r}=this;e.fps=r.get("frameRate").getHz(),e.setPropsTime=r.get("setProps Time").time,e.updateAttributesTime=r.get("Update Attributes").time,e.framesRedrawn=r.get("Redraw Count").count,e.pickTime=r.get("pickObject Time").time+r.get("pickMultipleObjects Time").time+r.get("pickObjects Time").time,e.pickCount=r.get("Pick Count").count,e.gpuTime=r.get("GPU Time").time,e.cpuTime=r.get("CPU Time").time,e.gpuTimePerFrame=r.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=r.get("CPU Time").getAverageTime();const n=JM.stats.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}vx.defaultProps=Ene;vx.VERSION=ize;function FHe(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return zL(t)}}const BHe=BL;function nS(t,e,r){const n=r==="webgpu"&&e.type==="uint8"?"unorm8":e.type;return{attribute:t,format:e.size>1?`${n}x${e.size}`:e.type,byteOffset:e.offset||0}}function Om(t){return t.stride||t.size*t.bytesPerElement}function zHe(t,e){return t.type===e.type&&t.size===e.size&&Om(t)===Om(e)&&(t.offset||0)===(e.offset||0)}function _D(t,e){e.offset&&po.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const r=Om(t),n=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,a=n*r+i*t.bytesPerElement+(t.offset||0);return{...e,offset:a,stride:r}}function jHe(t,e){const r=_D(t,e);return{high:r,low:{...r,offset:r.offset+t.size*4}}}class UHe{constructor(e,r,n){this._buffer=null,this.device=e,this.id=r.id||"",this.size=r.size||1;const i=r.logicalType||r.type,a=i==="float64";let{defaultValue:s}=r;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0);let o;a?o="float32":!i&&r.isIndexed?o="uint32":o=i||"float32";let c=FHe(i||o);this.doublePrecision=a,a&&r.fp64===!1&&(c=Float32Array),this.value=null,this.settings={...r,defaultType:c,defaultValue:s,logicalType:i,type:o,normalized:o.includes("norm"),size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Om(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),mx.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,r=null){const n={};if(this.state.constant){const i=this.value;if(r){const a=_D(this.getAccessor(),r),s=a.offset/i.BYTES_PER_ELEMENT,o=a.size||this.size;n[e]=i.subarray(s,s+o)}else n[e]=i}else n[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n[`${e}64Low`]=n[e]:n[`${e}64Low`]=new Float32Array(this.size)),n}_getBufferLayout(e=this.id,r=null){const n=this.getAccessor(),i=[],a={name:this.id,byteStride:Om(n),attributes:i};if(this.doublePrecision){const s=jHe(n,r||{});i.push(nS(e,{...n,...s.high},this.device.type),nS(`${e}64Low`,{...n,...s.low},this.device.type))}else if(r){const s=_D(n,r);i.push(nS(e,{...n,...s},this.device.type))}else i.push(nS(e,n,this.device.type));return a}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const r=Array.from(this.value);e=[r,r]}else{const{value:r,numInstances:n,size:i}=this,a=n*i;if(r&&a&&r.length>=a){const s=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let c=0;c<a;)for(let h=0;h<i;h++){const d=r[c++];d<s[h]&&(s[h]=d),d>o[h]&&(o[h]=d)}e=[s,o]}}return this.state.bounds=e,e}setData(e){const{state:r}=this;let n;ArrayBuffer.isView(e)?n={value:e}:e instanceof jo?n={buffer:e}:n=e;const i={...this.settings,...n};if(ArrayBuffer.isView(n.value)){if(!n.type)if(this.doublePrecision&&n.value instanceof Float64Array)i.type="float32";else{const s=BHe(n.value);i.type=i.normalized?s.replace("int","norm"):s}i.bytesPerElement=n.value.BYTES_PER_ELEMENT,i.stride=Om(i)}if(r.bounds=null,n.constant){let a=n.value;if(a=this._normalizeValue(a,[],0),this.settings.normalized&&(a=this.normalizeConstant(a)),!(!r.constant||!this._areValuesEqual(a,this.value)))return!1;r.externalBuffer=null,r.constant=!0,this.value=ArrayBuffer.isView(a)?a:new Float32Array(a)}else if(n.buffer){const a=n.buffer;r.externalBuffer=a,r.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let a=n.value;r.externalBuffer=null,r.constant=!1,this.value=a;let{buffer:s}=this;const o=Om(i),c=(i.vertexOffset||0)*o;if(this.doublePrecision&&a instanceof Float64Array&&(a=QP(a,i)),this.settings.isIndexed){const d=this.settings.defaultType;a.constructor!==d&&(a=new d(a))}const h=a.byteLength+c+o*2;(!s||s.byteLength<h)&&(s=this._createBuffer(h)),s.write(a,c)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const r=this.value,{startOffset:n=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&r instanceof Float64Array?QP(r,{size:this.size,startIndex:n,endIndex:i}):r.subarray(n,i),n*r.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,r=!1){const{state:n}=this,i=n.allocatedValue,a=mx.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:r});this.value=a;const{byteOffset:s}=this;let{buffer:o}=this;return(!o||o.byteLength<a.byteLength+s)&&(o=this._createBuffer(a.byteLength+s),r&&i&&o.write(i instanceof Float64Array?QP(i,this):i,s)),n.allocatedValue=a,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:r}=e;if(!ArrayBuffer.isView(r))throw new Error(`Attribute ${this.id} value is not TypedArray`);const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=r.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${r.constructor.name}`);!(r instanceof n)&&this.settings.normalized&&!("normalized"in e)&&po.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(r=>(r+128)/255*2-1);case"snorm16":return new Float32Array(e).map(r=>(r+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(r=>r/255);case"unorm16":return new Float32Array(e).map(r=>r/65535);default:return e}}_normalizeValue(e,r,n){const{defaultValue:i,size:a}=this.settings;if(Number.isFinite(e))return r[n]=e,r;if(!e){let s=a;for(;--s>=0;)r[n+s]=i[s];return r}switch(a){case 4:r[n+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:r[n+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:r[n+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:r[n+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let s=a;for(;--s>=0;)r[n+s]=Number.isFinite(e[s])?e[s]:i[s]}return r}_areValuesEqual(e,r){if(!e||!r)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(e[i]!==r[i])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:r,type:n}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(r?jo.INDEX:jo.VERTEX)|jo.COPY_DST,indexType:r?n:void 0,byteLength:e}),this._buffer}}const RG=[],MG=[];function VHe(t,e=0,r=1/0){let n=RG;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?n=t:t.length>0&&(MG.length=t.length,n=MG):n=RG,(e>0||Number.isFinite(r))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(e,r),i.index=e-1),{iterable:n,objectInfo:i}}function Tne(t){return t&&t[Symbol.asyncIterator]}function $He(t,e){const{size:r,stride:n,offset:i,startIndices:a,nested:s}=e,o=t.BYTES_PER_ELEMENT,c=n?n/o:r,h=i?i/o:0,d=Math.floor((t.length-h)/c);return(m,{index:b,target:x})=>{if(!a){const M=b*c+h;for(let F=0;F<r;F++)x[F]=t[M+F];return x}const E=a[b],T=a[b+1]||d;let A;if(s){A=new Array(T-E);for(let M=E;M<T;M++){const F=M*c+h;x=new Array(r);for(let N=0;N<r;N++)x[N]=t[F+N];A[M-E]=x}}else if(c===r)A=t.subarray(E*r+h,T*r+h);else{A=new t.constructor((T-E)*r);let M=0;for(let F=E;F<T;F++){const N=F*c+h;for(let O=0;O<r;O++)A[M++]=t[N+O]}}return A}}const qHe=[],FS=[[0,1/0]];function HHe(t,e){if(t===FS||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const r=[],n=t.length;let i=0;for(let a=0;a<n;a++){const s=t[a];s[1]<e[0]?(r.push(s),i=a+1):s[0]>e[1]?r.push(s):e=[Math.min(s[0],e[0]),Math.max(s[1],e[1])]}return r.splice(i,0,e),r}const WHe={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Cne(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const r=t.type||"interpolation";return{...WHe[r],...e,...t,type:r}}class Ane extends UHe{constructor(e,r){super(e,r,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:FS}),this.constant=!1,this.settings.update=r.update||(r.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const r=this.state.needsRedraw;return this.state.needsRedraw=r&&!e,r}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var r;(r=this.state).layoutChanged||(r.layoutChanged=!zHe(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:r}=this.settings,n=this.settings.transition,i=Array.isArray(r)?e[r.find(a=>e[a])]:e[r];return Cne(i,n)}setNeedsUpdate(e=this.id,r){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),r){const{startRow:n=0,endRow:i=1/0}=r;this.state.updateRanges=HHe(this.state.updateRanges,[n,i])}else this.state.updateRanges=FS}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=qHe}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:r,settings:n}=this;return n.noAlloc?!1:n.update?(super.allocate(e,r.updateRanges!==FS),!0):!1}updateBuffer({numInstances:e,data:r,props:n,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:s,noAlloc:o}}=this;let c=!0;if(s){for(const[h,d]of a)s.call(i,this,{data:r,startRow:h,endRow:d,props:n,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[h,d]of a){const m=Number.isFinite(h)?this.getVertexOffset(h):0,b=Number.isFinite(d)?this.getVertexOffset(d):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:m,endOffset:b})}this._checkAttributeArray()}else c=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),c}setConstantValue(e,r){const n=this.device.type==="webgpu";if(n||r===void 0||typeof r=="function"){if(n&&typeof r!="function"){const s=this._normalizeValue(r,[],0);this._areValuesEqual(s,this.value)||this.setNeedsUpdate("WebGPU constant updated")}return!1}const i=this.settings.transform&&e?this.settings.transform.call(e,r):r;return this.setData({constant:!0,value:i})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:r}=this;return e?(this.clearNeedsUpdate(),r.lastExternalBuffer===e||(r.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(r.lastExternalBuffer=null,!1)}setBinaryValue(e,r=null){const{state:n,settings:i}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;if(n.binaryValue=e,this.setNeedsRedraw(),i.transform||r!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const s=e;El(ArrayBuffer.isView(s.value),`invalid ${i.accessor}`);const o=!!s.size&&s.size!==this.size;return n.binaryAccessor=$He(s.value,{size:s.size||this.size,stride:s.stride,offset:s.offset,startIndices:r,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:r}=this;return(r?e<r.length?r[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,r=super.getValue();if(!e)return r;for(const n in e)Object.assign(r,super.getValue(n,e[n]));return r}getBufferLayout(e){this.state.layoutChanged=!1;const r=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?n.stepMode=e?e.isInstanced?"instance":"vertex":"instance":n.stepMode=i??"vertex",!r)return n;for(const a in r){const s=super._getBufferLayout(a,r[a]);n.attributes.push(...s.attributes)}return n}_autoUpdater(e,{data:r,startRow:n,endRow:i,props:a,numInstances:s}){if(e.constant&&this.context.device.type!=="webgpu")return;const{settings:o,state:c,value:h,size:d,startIndices:m}=e,{accessor:b,transform:x}=o;let E=c.binaryAccessor||(typeof b=="function"?b:a[b]);typeof E!="function"&&typeof b=="string"&&(E=()=>a[b]),El(typeof E=="function",`accessor "${b}" is not a function`);let T=e.getVertexOffset(n);const{iterable:A,objectInfo:M}=VHe(r,n,i);for(const F of A){M.index++;let N=E(F,M);if(x&&(N=x.call(this,N)),m){const O=(M.index<m.length-1?m[M.index+1]:s)-m[M.index];if(N&&Array.isArray(N[0])){let U=T;for(const j of N)e._normalizeValue(j,h,U),U+=d}else N&&N.length>d?h.set(N,T):(e._normalizeValue(N,M.target,0),h$e({target:h,source:M.target,start:T,count:O}));T+=O*d}else e._normalizeValue(N,h,T),T+=d}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,r=Math.min(4,this.size);if(e&&e.length>=r){let n=!0;switch(r){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function hk(t){const{source:e,target:r,start:n=0,size:i,getData:a}=t,s=t.end||r.length,o=e.length,c=s-n;if(o>c){r.set(e.subarray(0,c),n);return}if(r.set(e,n),!a)return;let h=o;for(;h<c;){const d=a(h,e);for(let m=0;m<i;m++)r[n+h]=d[m]||0,h++}}function GHe({source:t,target:e,size:r,getData:n,sourceStartIndices:i,targetStartIndices:a}){if(!i||!a)return hk({source:t,target:e,size:r,getData:n}),e;let s=0,o=0;const c=n&&((d,m)=>n(d+o,m)),h=Math.min(i.length,a.length);for(let d=1;d<h;d++){const m=i[d]*r,b=a[d]*r;hk({source:t.subarray(s,m),target:e,start:o,end:b,size:r,getData:c}),s=m,o=b}return o<e.length&&hk({source:[],target:e,start:o,size:r,getData:c}),e}function XHe(t){const{device:e,settings:r,value:n}=t,i=new Ane(e,r);return i.setData({value:n instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:r.normalized}),i}function Ine(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function Pne(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function kne(t){t.push(t.shift())}function YHe(t,e){const{doublePrecision:r,settings:n,value:i,size:a}=t,s=r&&i instanceof Float64Array?2:1;let o=0;const{shaderAttributes:c}=t.settings;if(c)for(const h of Object.values(c))o=Math.max(o,h.vertexOffset??0);return(n.noAlloc?i.length:(e+o)*a)*s}function Rne({device:t,source:e,target:r}){return(!r||r.byteLength<e.byteLength)&&(r?.destroy(),r=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),r}function Mne({device:t,buffer:e,attribute:r,fromLength:n,toLength:i,fromStartIndices:a,getData:s=o=>o}){const o=r.doublePrecision&&r.value instanceof Float64Array?2:1,c=r.size*o,h=r.byteOffset,d=r.settings.bytesPerElement<4?h/r.settings.bytesPerElement*4:h,m=r.startIndices,b=a&&m,x=r.isConstant;if(!b&&e&&n>=i)return e;const E=r.value instanceof Float64Array?Float32Array:r.value.constructor,T=x?r.value:new E(r.getBuffer().readSyncWebGL(h,i*E.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!x){const N=s;s=(O,U)=>r.normalizeConstant(N(O,U))}const A=x?(N,O)=>s(T,O):(N,O)=>s(T.subarray(N+h,N+h+c),O),M=e?new Float32Array(e.readSyncWebGL(d,n*4).buffer):new Float32Array(0),F=new Float32Array(i);return GHe({source:M,target:F,sourceStartIndices:a,targetStartIndices:m,size:c,getData:A}),(!e||e.byteLength<F.byteLength+d)&&(e?.destroy(),e=t.createBuffer({byteLength:F.byteLength+d,usage:35050})),e.write(F,d),e}class Dne{constructor({device:e,attribute:r,timeline:n}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new Q3(n),this.attribute=r,this.attributeInTransition=XHe(r),this.currentStartIndices=r.startIndices}get inProgress(){return this.transition.inProgress}start(e,r,n=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=YHe(this.attribute,r),this.transition.start({...e,duration:n})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class ZHe extends Dne{constructor({device:e,attribute:r,timeline:n}){super({device:e,attribute:r,timeline:n}),this.type="interpolation",this.transform=eWe(e,r)}start(e,r){const n=this.currentLength,i=this.currentStartIndices;if(super.start(e,r,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:a,attribute:s}=this;kne(a),a[0]=Mne({device:this.device,buffer:a[0],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),a[1]=Rne({device:this.device,source:a[0],target:a[1]}),this.setBuffer(a[1]);const{transform:o}=this,c=o.model;let h=Math.floor(this.currentLength/s.size);One(s)&&(h/=2),c.setVertexCount(h),s.isConstant?(c.setAttributes({aFrom:a[0]}),c.setConstantAttributes({aTo:s.value})):c.setAttributes({aFrom:a[0],aTo:s.getBuffer()}),o.transformFeedback.setBuffers({vCurrent:a[1]})}onUpdate(){const{duration:e,easing:r}=this.settings,{time:n}=this.transition;let i=n/e;r&&(i=r(i));const{model:a}=this.transform,s={time:i};a.shaderInputs.setProps({interpolation:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const KHe=`uniform interpolationUniforms {
  float time;
} interpolation;
`,DG={name:"interpolation",vs:KHe,uniformTypes:{time:"f32"}},JHe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,QHe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function One(t){return t.doublePrecision&&t.value instanceof Float64Array}function eWe(t,e){const r=e.size,n=Ine(r),i=Pne(r),a=e.getBufferLayout();return One(e)?new o_(t,{vs:QHe,bufferLayout:[{name:"aFrom",byteStride:8*r,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*r}]},{name:"aTo",byteStride:8*r,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*r}]}],modules:[mje,DG],defines:{ATTRIBUTE_TYPE:n,ATTRIBUTE_SIZE:r},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new o_(t,{vs:JHe,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:a.attributes[0].format}],modules:[DG],defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"],disableWarnings:!0})}class tWe extends Dne{constructor({device:e,attribute:r,timeline:n}){super({device:e,attribute:r,timeline:n}),this.type="spring",this.texture=sWe(e),this.framebuffer=lWe(e,this.texture),this.transform=oWe(e,r)}start(e,r){const n=this.currentLength,i=this.currentStartIndices;super.start(e,r);const{buffers:a,attribute:s}=this;for(let c=0;c<2;c++)a[c]=Mne({device:this.device,buffer:a[c],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});a[2]=Rne({device:this.device,source:a[0],target:a[2]}),this.setBuffer(a[1]);const{model:o}=this.transform;o.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?o.setConstantAttributes({aTo:s.value}):o.setAttributes({aTo:s.getBuffer()})}onUpdate(){const{buffers:e,transform:r,framebuffer:n,transition:i}=this,a=this.settings;r.model.setAttributes({aPrev:e[0],aCur:e[1]}),r.transformFeedback.setBuffers({vNext:e[2]});const s={stiffness:a.stiffness,damping:a.damping};r.model.shaderInputs.setProps({spring:s}),r.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),kne(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(n)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const rWe=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,nWe={name:"spring",vs:rWe,uniformTypes:{damping:"f32",stiffness:"f32"}},iWe=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,aWe=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function oWe(t,e){const r=Ine(e.size),n=Pne(e.size);return new o_(t,{vs:iWe,fs:aWe,bufferLayout:[{name:"aPrev",format:n},{name:"aCur",format:n},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[nWe],defines:{ATTRIBUTE_TYPE:r},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function sWe(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",width:1,height:1})}function lWe(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const uWe={interpolation:ZHe,spring:tWe};class cWe{constructor(e,{id:r,timeline:n}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=r,this.device=e,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:r,numInstances:n}){this.numInstances=n||1;for(const i in e){const a=e[i],s=a.getTransitionSetting(r);s&&this._updateAttribute(i,a,s)}for(const i in this.transitions){const a=e[i];(!a||!a.getTransitionSetting(r))&&this._removeTransition(i)}}hasAttribute(e){const r=this.transitions[e];return r&&r.inProgress}getAttributes(){const e={};for(const r in this.transitions){const n=this.transitions[r];n.inProgress&&(e[r]=n.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const r in this.transitions)this.transitions[r].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,r,n){const i=this.transitions[e];let a=!i||i.type!==n.type;if(a){i&&this._removeTransition(e);const s=uWe[n.type];s?this.transitions[e]=new s({attribute:r,timeline:this.timeline,device:this.device}):(po.error(`unsupported transition type '${n.type}'`)(),a=!1)}(a||r.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const OG="attributeManager.invalidate",hWe="attributeManager.updateStart",fWe="attributeManager.updateEnd",dWe="attribute.updateStart",pWe="attribute.allocate",gWe="attribute.updateEnd";class mWe{constructor(e,{id:r="attribute-manager",stats:n,timeline:i}={}){this.mergeBoundsMemoized=o2(kVe),this.id=r,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new cWe(e,{id:`${r}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const r=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,r&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const r of e)this.attributes[r]!==void 0&&(this.attributes[r].delete(),delete this.attributes[r])}invalidate(e,r){const n=this._invalidateTrigger(e,r);mc(OG,this,e,n)}invalidateAll(e){for(const r in this.attributes)this.attributes[r].setNeedsUpdate(r,e);mc(OG,this,"all")}update({data:e,numInstances:r,startIndices:n=null,transitions:i,props:a={},buffers:s={},context:o={}}){let c=!1;mc(hWe,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const h in this.attributes){const d=this.attributes[h],m=d.settings.accessor;d.startIndices=n,d.numInstances=r,a[h]&&po.removed(`props.${h}`,`data.attributes.${h}`)(),d.setExternalBuffer(s[h])||d.setBinaryValue(typeof m=="string"?s[m]:void 0,e.startIndices)||typeof m=="string"&&!s[m]&&d.setConstantValue(o,a[m])||d.needsUpdate()&&(c=!0,this._updateAttribute({attribute:d,numInstances:r,data:e,props:a,context:o})),this.needsRedraw=this.needsRedraw||d.needsRedraw()}c&&mc(fWe,this,r),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:r,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,r=e.run();return this.needsRedraw=this.needsRedraw||r,r}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const r=e.map(n=>this.attributes[n]?.getBounds());return this.mergeBoundsMemoized(r)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:r,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const a in r){const s=r[a];s.needsRedraw(e)&&!n.hasAttribute(a)&&(i[a]=s)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(r=>r.getBufferLayout(e))}_add(e,r){for(const n in e){const i=e[n],a={...i,id:n,size:i.isIndexed&&1||i.size||1,...r};this.attributes[n]=new Ane(this.device,a)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const r in this.attributes)this.attributes[r].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(r)});this.updateTriggers=e}_invalidateTrigger(e,r){const{attributes:n,updateTriggers:i}=this,a=i[e];return a&&a.forEach(s=>{const o=n[s];o&&o.setNeedsUpdate(o.id,r)}),a}_updateAttribute(e){const{attribute:r,numInstances:n}=e;if(mc(dWe,r),r.constant){r.setConstantValue(e.context,r.value);return}r.allocate(n)&&mc(pWe,r,n),r.updateBuffer(e)&&(this.needsRedraw=!0,mc(gWe,r,n))}}class yWe extends Q3{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:r,toValue:n,duration:i,easing:a}}=this,s=a(e/i);this._value=vT(r,n,s)}}const NG=1e-5;function LG(t,e,r,n,i){const a=e-t,o=(r-e)*i,c=-a*n;return o+c+a+e}function vWe(t,e,r,n,i){if(Array.isArray(r)){const a=[];for(let s=0;s<r.length;s++)a[s]=LG(t[s],e[s],r[s],n,i);return a}return LG(t,e,r,n,i)}function FG(t,e){if(Array.isArray(t)){let r=0;for(let n=0;n<t.length;n++){const i=t[n]-e[n];r+=i*i}return Math.sqrt(r)}return Math.abs(t-e)}class _We extends Q3{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:r,damping:n,stiffness:i}=this.settings,{_prevValue:a=e,_currValue:s=e}=this;let o=vWe(a,s,r,n,i);const c=FG(o,r),h=FG(o,s);c<NG&&h<NG&&(o=r,this.end()),this._prevValue=s,this._currValue=o}}const bWe={interpolation:yWe,spring:_We};class xWe{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,r,n,i){const{transitions:a}=this;if(a.has(e)){const c=a.get(e),{value:h=c.settings.fromValue}=c;r=h,this.remove(e)}if(i=Cne(i),!i)return;const s=bWe[i.type];if(!s){po.error(`unsupported transition type '${i.type}'`)();return}const o=new s(this.timeline);o.start({...i,fromValue:r,toValue:n}),a.set(e,o)}remove(e){const{transitions:r}=this;r.has(e)&&(r.get(e).cancel(),r.delete(e))}update(){const e={};for(const[r,n]of this.transitions)n.update(),e[r]=n.value,n.inProgress||this.remove(r);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function wWe(t){const e=t[Wm];for(const r in e){const n=e[r],{validate:i}=n;if(i&&!i(t[r],n))throw new Error(`Invalid prop ${r}: ${t[r]}`)}}function SWe(t,e){const r=Nne({newProps:t,oldProps:e,propTypes:t[Wm],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=TWe(t,e);let i=!1;return n||(i=CWe(t,e)),{dataChanged:n,propsChanged:r,updateTriggersChanged:i,extensionsChanged:AWe(t,e),transitionsChanged:EWe(t,e)}}function EWe(t,e){if(!t.transitions)return!1;const r={},n=t[Wm];let i=!1;for(const a in t.transitions){const s=n[a],o=s&&s.type;(o==="number"||o==="color"||o==="array")&&bD(t[a],e[a],s)&&(r[a]=!0,i=!0)}return i?r:!1}function Nne({newProps:t,oldProps:e,ignoreProps:r={},propTypes:n={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const a of Object.keys(t))if(!(a in r)){if(!(a in e))return`${i}.${a} added`;const s=bD(t[a],e[a],n[a]);if(s)return`${i}.${a} ${s}`}for(const a of Object.keys(e))if(!(a in r)){if(!(a in t))return`${i}.${a} dropped`;if(!Object.hasOwnProperty.call(t,a)){const s=bD(t[a],e[a],n[a]);if(s)return`${i}.${a} ${s}`}}return!1}function bD(t,e,r){let n=r&&r.equal;return n&&!n(t,e,r)||!n&&(n=t&&e&&t.equals,n&&!n.call(t,e))?"changed deeply":!n&&e!==t?"changed shallowly":null}function TWe(t,e){if(e===null)return"oldProps is null, initial diff";let r=!1;const{dataComparator:n,_dataDiff:i}=t;return n?n(t.data,e.data)||(r="Data comparator detected a change"):t.data!==e.data&&(r="A new data container was supplied"),r&&i&&(r=i(t.data,e.data)||r),r}function CWe(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&BG(t,e,"all"))return{all:!0};const r={};let n=!1;for(const i in t.updateTriggers)i!=="all"&&BG(t,e,i)&&(r[i]=!0,n=!0);return n?r:!1}function AWe(t,e){if(e===null)return!0;const r=e.extensions,{extensions:n}=t;if(n===r)return!1;if(!r||!n||n.length!==r.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(r[i]))return!0;return!1}function BG(t,e,r){let n=t.updateTriggers[r];n=n??{};let i=e.updateTriggers[r];return i=i??{},Nne({oldProps:i,newProps:n,triggerName:r})}const IWe="count(): argument not an object",PWe="count(): argument not a container";function kWe(t){if(!MWe(t))throw new Error(IWe);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(RWe(t))return Object.keys(t).length;throw new Error(PWe)}function RWe(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function MWe(t){return t!==null&&typeof t=="object"}function zG(t,e){if(!e)return t;const r={...t,...e};if("defines"in e&&(r.defines={...t.defines,...e.defines}),"modules"in e&&(r.modules=(t.modules||[]).concat(e.modules),e.modules.some(n=>n.name==="project64"))){const n=r.modules.findIndex(i=>i.name==="project32");n>=0&&r.modules.splice(n,1)}if("inject"in e)if(!t.inject)r.inject=e.inject;else{const n={...t.inject};for(const i in e.inject)n[i]=(n[i]||"")+e.inject[i];r.inject=n}return r}const DWe={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},xD={};function OWe(t,e,r,n){if(r instanceof Fl)return r;r.constructor&&r.constructor.name!=="Object"&&(r={data:r});let i=null;r.compressed&&(i={minFilter:"linear",mipmapFilter:r.data.length>1?"nearest":"linear"});const{width:a,height:s}=r.data,o=e.createTexture({...r,sampler:{...DWe,...i,...n},mipLevels:e.getMipLevelCount(a,s)});return o.generateMipmapsWebGL(),xD[o.id]=t,o}function NWe(t,e){!e||!(e instanceof Fl)||xD[e.id]===t&&(e.delete(),delete xD[e.id])}const LWe={boolean:{validate(t,e){return!0},equal(t,e,r){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||wD(t)&&(t.length===3||t.length===4)},equal(t,e,r){return Nh(t,e,1)}},accessor:{validate(t,e){const r=TT(t);return r==="function"||r===TT(e.value)},equal(t,e,r){return typeof e=="function"?!0:Nh(t,e,1)}},array:{validate(t,e){return e.optional&&!t||wD(t)},equal(t,e,r){const{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?Nh(t,e,i):t===e}},object:{equal(t,e,r){if(r.ignore)return!0;const{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?Nh(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,r){return!r.compare&&r.ignore!==!1||t===e}},data:{transform:(t,e,r)=>{if(!t)return t;const{dataTransform:n}=r.props;return n?n(t):typeof t.shape=="string"&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,r)=>{const n=r.context;return!n||!n.device?null:OWe(r.id,n.device,t,{...e.parameters,...r.props.textureParameters})},release:(t,e,r)=>{NWe(r.id,t)}}};function FWe(t){const e={},r={},n={};for(const[i,a]of Object.entries(t)){const s=a?.deprecatedFor;if(s)n[i]=Array.isArray(s)?s:[s];else{const o=BWe(i,a);e[i]=o,r[i]=o.value}}return{propTypes:e,defaultProps:r,deprecatedProps:n}}function BWe(t,e){switch(TT(e)){case"object":return A1(t,e);case"array":return A1(t,{type:"array",value:e,compare:!1});case"boolean":return A1(t,{type:"boolean",value:e});case"number":return A1(t,{type:"number",value:e});case"function":return A1(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function A1(t,e){return"type"in e?{name:t,...LWe[e.type],...e}:"value"in e?{name:t,type:TT(e.value),...e}:{name:t,type:"object",value:e}}function wD(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function TT(t){return wD(t)?"array":t===null?"null":typeof t}function zWe(t,e){let r;for(let a=e.length-1;a>=0;a--){const s=e[a];"extensions"in s&&(r=s.extensions)}const n=SD(t.constructor,r),i=Object.create(n);i[ET]=t,i[vy]={},i[yg]={};for(let a=0;a<e.length;++a){const s=e[a];for(const o in s)i[o]=s[o]}return Object.freeze(i),i}const jWe="_mergedDefaultProps";function SD(t,e){if(!(t instanceof eC.constructor))return{};let r=jWe;if(e)for(const i of e){const a=i.constructor;a&&(r+=`:${a.extensionName||a.name}`)}const n=Lne(t,r);return n||(t[r]=UWe(t,e||[]))}function UWe(t,e){if(!t.prototype)return null;const n=Object.getPrototypeOf(t),i=SD(n),a=Lne(t,"defaultProps")||{},s=FWe(a),o=Object.assign(Object.create(null),i,s.defaultProps),c=Object.assign(Object.create(null),i?.[Wm],s.propTypes),h=Object.assign(Object.create(null),i?.[ik],s.deprecatedProps);for(const d of e){const m=SD(d.constructor);m&&(Object.assign(o,m),Object.assign(c,m[Wm]),Object.assign(h,m[ik]))}return VWe(o,t),qWe(o,c),$We(o,h),o[Wm]=c,o[ik]=h,e.length===0&&!w6(t,"_propTypes")&&(t._propTypes=c),o}function VWe(t,e){const r=WWe(e);Object.defineProperties(t,{id:{writable:!0,value:r}})}function $We(t,e){for(const r in e)Object.defineProperty(t,r,{enumerable:!1,set(n){const i=`${this.id}: ${r}`;for(const a of e[r])w6(this,a)||(this[a]=n);po.deprecated(i,e[r].join("/"))()}})}function qWe(t,e){const r={},n={};for(const i in e){const a=e[i],{name:s,value:o}=a;a.async&&(r[s]=o,n[s]=HWe(s))}t[D0]=r,t[vy]={},Object.defineProperties(t,n)}function HWe(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||Tne(e)?this[vy][t]=e:this[yg][t]=e},get(){if(this[yg]){if(t in this[yg])return this[yg][t]||this[D0][t];if(t in this[vy]){const e=this[ET]&&this[ET].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[D0][t]}}return this[D0][t]}}}function w6(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Lne(t,e){return w6(t,e)&&t[e]}function WWe(t){const e=t.componentName;return e||po.warn(`${t.name}.componentName not specified`)(),e||t.name}let GWe=0;class eC{constructor(...e){this.props=zWe(this,e),this.id=this.props.id,this.count=GWe++}clone(e){const{props:r}=this,n={};for(const i in r[D0])i in r[yg]?n[i]=r[yg][i]:i in r[vy]&&(n[i]=r[vy][i]);return new this.constructor({...r,...n,...e})}}eC.componentName="Component";eC.defaultProps={};const XWe=Object.freeze({});class YWe{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const r=this.asyncProps[e];r&&r.type&&r.type.release&&r.type.release(r.resolvedValue,r.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||XWe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const r=this.asyncProps[e];return r&&r.resolvedValue}isAsyncPropLoading(e){if(e){const r=this.asyncProps[e];return!!(r&&r.pendingLoadCount>0&&r.pendingLoadCount!==r.resolvedLoadCount)}for(const r in this.asyncProps)if(this.isAsyncPropLoading(r))return!0;return!1}reloadAsyncProp(e,r){this._watchPromise(e,Promise.resolve(r))}setAsyncProps(e){this.component=e[ET]||this.component;const r=e[yg]||{},n=e[vy]||e,i=e[D0]||{};for(const a in r){const s=r[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,s),r[a]=this.getAsyncProp(a)}for(const a in n){const s=n[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,s)}}_fetch(e,r){return null}_onResolve(e,r){}_onError(e,r){}_updateAsyncProp(e,r){if(this._didAsyncInputValueChange(e,r)){if(typeof r=="string"&&(r=this._fetch(e,r)),r instanceof Promise){this._watchPromise(e,r);return}if(Tne(r)){this._resolveAsyncIterable(e,r);return}this._setPropValue(e,r)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,r){const n=this.asyncProps[e];return r===n.resolvedValue||r===n.lastValue?!1:(n.lastValue=r,!0)}_setPropValue(e,r){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(r=this._postProcessValue(n,r),n.resolvedValue=r,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,r,n){const i=this.asyncProps[e];i&&n>=i.resolvedLoadCount&&r!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=r,i.resolvedLoadCount=n,this.onAsyncPropUpdated(e,r))}_watchPromise(e,r){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;r.then(a=>{this.component&&(a=this._postProcessValue(n,a),this._setAsyncPropValue(e,a,i),this._onResolve(e,a))}).catch(a=>{this._onError(e,a)})}}async _resolveAsyncIterable(e,r){if(e!=="data"){this._setPropValue(e,r);return}const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let a=[],s=0;for await(const o of r){if(!this.component)return;const{dataTransform:c}=this.component.props;c?a=c(o,a):a=a.concat(o),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:s,endRow:a.length}]}),s=a.length,this._setAsyncPropValue(e,a,i)}this._onResolve(e,a)}_postProcessValue(e,r){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(r,n,this.component):r}_createAsyncPropData(e,r){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Wm];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:r,pendingLoadCount:0,resolvedLoadCount:0}}}}class ZWe extends YWe{constructor({attributeManager:e,layer:r}){super(r),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,r){const n=this.layer,i=n?.props.fetch;return i?i(r,{propName:e,layer:n}):super._fetch(e,r)}_onResolve(e,r){const n=this.layer;if(n){const i=n.props.onDataLoad;e==="data"&&i&&i(r,{propName:e,layer:n})}}_onError(e,r){const n=this.layer;n&&n.raiseError(r,`loading ${e} of ${this.layer}`)}}const KWe="layer.changeFlag",JWe="layer.initialize",QWe="layer.update",eGe="layer.finalize",tGe="layer.matched",jG=2**24-1,rGe=Object.freeze([]),nGe=o2(({oldViewport:t,viewport:e})=>t.equals(e));let pf=new Uint8ClampedArray(0);const iGe={data:{type:"data",value:rGe,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:r,loaders:n,loadOptions:i,signal:a})=>{const{resourceManager:s}=r.context;i=i||r.getLoadOptions(),n=n||r.props.loaders,a&&(i={...i,fetch:{...i?.fetch,signal:a}});let o=s.contains(t);return!o&&!i&&(s.add({resourceId:t,data:WM(t,n),persistent:!1}),o=!0),o?s.subscribe({resourceId:t,onChange:c=>r.internalState?.reloadAsyncProp(e,c),consumerId:r.id,requestId:e}):WM(t,n,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Xa.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Fne extends eC{constructor(){super(...arguments),this.internalState=null,this.lifecycle=r0.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){El(this.internalState);const r=this.internalState.viewport||this.context.viewport,n=ine(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,a,s]=ene(n,r.pixelProjectionMatrix);return e.length===2?[i,a]:[i,a,s]}unproject(e){return El(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,r){El(this.internalState);const n=this.internalState.viewport||this.context.viewport;return LVe(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...r})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const r of this.getModels())r.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Xa.DEFAULT||e===Xa.LNGLAT||e===Xa.CARTESIAN}onHover(e,r){return this.props.onHover&&this.props.onHover(e,r)||!1}onClick(e,r){return this.props.onClick&&this.props.onClick(e,r)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,r=[]){return r[0]=e+1&255,r[1]=e+1>>8&255,r[2]=e+1>>8>>8&255,r}decodePickingColor(e){El(e instanceof Uint8Array);const[r,n,i]=e;return r+n*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:kWe(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=zG(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const r of this.props.extensions)e=zG(e,r.getShaders.call(this,r));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const r=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&r)if(Array.isArray(n))for(const i of n)r.invalidateAll(i);else r.invalidateAll();if(r){const{props:i}=e,a=this.internalState.hasPickingBuffer,s=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(a!==s){this.internalState.hasPickingBuffer=s;const{pickingColors:o,instancePickingColors:c}=r.attributes,h=o||c;h&&(s&&h.constant&&(h.constant=!1,r.invalidate(h.id)),!h.value&&!s&&(h.constant=!0,h.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.destroy();const r=this.getAttributeManager();r&&r.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const r of this.getModels())r.draw(e.renderPass)}getPickingInfo({info:e,mode:r,sourceLayer:n}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,r){r&&(e=new Error(`${r}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const r=this.internalState.viewport;this.internalState.viewport=e,(!r||!nGe({oldViewport:r,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const r=this.getAttributeManager();r&&(e==="all"?r.invalidateAll():r.invalidate(e))}updateAttributes(e){let r=!1;for(const n in e)e[n].layoutChanged()&&(r=!0);for(const n of this.getModels())this._setModelAttributes(n,e,r)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const r=this.props,n=this.getNumInstances(),i=this.getStartIndices();e.update({data:r.data,numInstances:n,startIndices:i,props:r,transitions:r.transitions,buffers:r.data.attributes,context:this});const a=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(a)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const r=e.update(),n=Object.create(this.props);for(const i in r)Object.defineProperty(n,i,{value:r[i]});return n}return this.props}calculateInstancePickingColors(e,{numInstances:r}){if(e.constant)return;const n=Math.floor(pf.length/4);if(this.internalState.usesPickingColorCache=!0,n<r){r>jG&&po.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),pf=mx.allocate(pf,r,{size:4,copy:!0,maxCount:Math.max(r,jG)});const i=Math.floor(pf.length/4),a=[0,0,0];for(let s=n;s<i;s++)this.encodePickingColor(s,a),pf[s*4+0]=a[0],pf[s*4+1]=a[1],pf[s*4+2]=a[2],pf[s*4+3]=0}e.value=pf.subarray(0,r*4)}_setModelAttributes(e,r,n=!1){if(!Object.keys(r).length)return;if(n){const o=this.getAttributeManager();e.setBufferLayout(o.getBufferLayouts(e)),r=o.getAttributes()}const i=e.userData?.excludeAttributes||{},a={},s={};for(const o in r){if(i[o])continue;const c=r[o].getValue();for(const h in c){const d=c[h];d instanceof jo?r[o].settings.isIndexed?e.setIndexBuffer(d):a[h]=d:d&&(s[h]=d)}}e.setAttributes(a),e.setConstantAttributes(s)}disablePickingIndex(e){const r=this.props.data;if(!("attributes"in r)){this._disablePickingIndex(e);return}const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,a=n||i,s=a&&r.attributes&&r.attributes[a.id];if(s&&s.value){const o=s.value,c=this.encodePickingColor(e);for(let h=0;h<r.length;h++){const d=a.getVertexOffset(h);o[d]===c[0]&&o[d+1]===c[1]&&o[d+2]===c[2]&&this._disablePickingIndex(h)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:r,instancePickingColors:n}=this.getAttributeManager().attributes,i=r||n;if(!i)return;const a=i.getVertexOffset(e),s=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(s-a),a)}restorePickingColors(){const{pickingColors:e,instancePickingColors:r}=this.getAttributeManager().attributes,n=e||r;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==pf.buffer&&(n.value=pf.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){El(!this.internalState),El(Number.isFinite(this.props.coordinateSystem)),mc(JWe,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new ZWe({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(po.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new xWe(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const r of this.props.extensions)r.initializeState.call(this,this.context,r);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){mc(tGe,this,this===e);const{state:r,internalState:n}=e;this!==e&&(this.internalState=n,this.state=r,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(mc(QWe,this,e),!e)return;const r=this.props,n=this.context,i=this.internalState,a=n.viewport,s=this._updateUniformTransition();i.propsInTransition=s,n.viewport=i.viewport||a,this.props=s;try{const o=this._getUpdateParams(),c=this.getModels();if(n.device)this.updateState(o);else try{this.updateState(o)}catch{}for(const d of this.props.extensions)d.updateState.call(this,o,d);this.setNeedsRedraw(),this._updateAttributes();const h=this.getModels()[0]!==c[0];this._postUpdate(o,h)}finally{n.viewport=a,this.props=r,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){mc(eGe,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:r=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const a=this.props,s=this.context;this.props=this.internalState.propsInTransition||a;try{r&&this.setShaderModuleProps(r);const{getPolygonOffset:o}=this.props,c=o&&o(n)||[0,0];s.device instanceof vD&&s.device.setParametersWebGL({polygonOffset:c});for(const h of this.getModels())h.device.type==="webgpu"?h.setParameters({...h.parameters,...i}):h.setParameters(i);if(s.device instanceof vD)s.device.withParametersWebGL(i,()=>{const h={renderPass:e,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(const d of this.props.extensions)d.draw.call(this,h,d);this.draw(h)});else{const h={renderPass:e,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(const d of this.props.extensions)d.draw.call(this,h,d);this.draw(h)}}finally{this.props=a}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:r}=this.internalState;for(const i in e)if(e[i]){let a=!1;switch(i){case"dataChanged":const s=e[i],o=r[i];s&&Array.isArray(o)&&(r.dataChanged=Array.isArray(s)?o.concat(s):s,a=!0);default:r[i]||(r[i]=e[i],a=!0)}a&&mc(KWe,this,i,e)}const n=!!(r.dataChanged||r.updateTriggersChanged||r.propsChanged||r.extensionsChanged);r.propsOrDataChanged=n,r.somethingChanged=n||r.viewportChanged||r.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,r){const n=SWe(e,r);if(n.updateTriggersChanged)for(const i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(const i in n.transitionsChanged)this.internalState.uniformTransitions.add(i,r[i],e[i],e.transitions?.[i]);return this.setChangeFlags(n)}validateProps(){wWe(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const r={highlightedObjectColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&typeof n=="function"&&(r.highlightColor=n(e)),this.setShaderModuleProps({picking:r}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new mWe(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,r){const{props:n,oldProps:i}=e,a=this.state.model;a?.isInstanced&&a.setInstanceCount(this.getNumInstances());const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:c}=n;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==c){const h={};Array.isArray(c)&&(h.highlightColor=c),(r||i.autoHighlight!==s||o!==i.highlightedObjectIndex)&&(h.highlightedObjectColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setShaderModuleProps({picking:h})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let r=!1;r=r||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=n?n.getNeedsRedraw(e):!1;if(r=r||i,r)for(const a of this.props.extensions)a.onNeedsRedraw.call(this,a);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,r}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}Fne.defaultProps=iGe;Fne.layerName="Layer";class aGe extends hne{constructor(e){const{startPanPos:r,...n}=e;super(n),r!==void 0&&(this._state.startPanPos=r)}panStart({pos:e}){const{latitude:r,longitude:n,zoom:i}=this.getViewportProps();return this._getUpdatedState({startPanLngLat:[n,r],startPanPos:e,startZoom:i})}pan({pos:e,startPos:r}){const n=this.getState(),i=n.startPanLngLat||this._unproject(r);if(!i)return this;const a=n.startZoom??this.getViewportProps().zoom,s=n.startPanPos||r,o=[i[0],i[1],a],h=this.makeViewport(this.getViewportProps()).panByPosition(o,e,s);return this._getUpdatedState(h)}panEnd(){return this._getUpdatedState({startPanLngLat:null,startPanPos:null,startZoom:null})}zoom({scale:e}){const n=(this.getState().startZoom||this.getViewportProps().zoom)+Math.log2(e);return this._getUpdatedState({zoom:n})}applyConstraints(e){const{longitude:r,latitude:n,maxZoom:i,minZoom:a,zoom:s}=e,o=g0(0),c=g0(n)-o;return e.zoom=gd(s,a+c,i+c),(r<-180||r>180)&&(e.longitude=CVe(r+180,360)-180),e.latitude=gd(n,-md,md),e}}class oGe extends cne{constructor(){super(...arguments),this.ControllerState=aGe,this.transition={transitionDuration:300,transitionInterpolator:new d6(["longitude","latitude","zoom"])},this.dragMode="pan"}setProps(e){super.setProps(e),this.dragRotate=!1,this.touchRotate=!1}}class Bne extends une{constructor(e={}){super(e)}getViewportType(e){return e.zoom>12?yy:f6}get ControllerType(){return oGe}}Bne.displayName="GlobeView";const _x="mapbox",fk=512,sGe=Math.PI/180;function S6({map:t,gl:e,deck:r}){if(t.__deck)return t.__deck;const n=r?.props._customRender,i=r?.props.onLoad,a={...r?.props,_customRender:()=>{t.triggerRepaint(),n?.("")}};a.parameters={...BS(t,!0),...a.parameters},a.views||(a.views=kb(t));let s;return(!r||r.props.gl===e)&&(Object.assign(a,{gl:e,width:null,height:null,touchAction:"unset",viewState:bx(t)}),r?.isInitialized?UG(r,t):a.onLoad=()=>{i?.(),UG(s,t)}),r?(s=r,r.setProps(a),r.userData.isExternal=!0):(s=new vx(a),t.on("remove",()=>{zne(t)})),s.userData.mapboxLayers=new Set,t.__deck=s,t.on("render",()=>{s.isInitialized&&pGe(s,t)}),s}function UG(t,e){const r=()=>{t.isInitialized?gGe(t,e):e.off("move",r)};e.on("move",r)}function zne(t){t.__deck?.finalize(),t.__deck=null}function BS(t,e){const r=e?{depthWriteEnabled:!0,depthCompare:"less-equal",depthBias:0,blend:!0,blendColorSrcFactor:"src-alpha",blendColorDstFactor:"one-minus-src-alpha",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one-minus-src-alpha",blendColorOperation:"add",blendAlphaOperation:"add"}:{};return E6(t)==="globe"&&(r.cullMode="back"),r}function lGe(t,e){t.userData.mapboxLayers.add(e),C6(t)}function uGe(t,e){t.userData.mapboxLayers.delete(e),C6(t)}function cGe(t,e){C6(t)}function hGe(t,e,r,n){let{currentViewport:i}=t.userData,a=!1;i||(i=T6(t,e,n),t.userData.currentViewport=i,a=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[i],layerFilter:s=>(!t.props.layerFilter||t.props.layerFilter(s))&&(r.id===s.layer.id||s.layer.props.operation.includes("terrain")),clearStack:a,clearCanvas:!1})}function fGe(t,e,r,n){let{currentViewport:i}=t.userData,a=!1;i||(i=T6(t,e,n),t.userData.currentViewport=i,a=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[i],layerFilter:s=>{if(t.props.layerFilter&&!t.props.layerFilter(s))return!1;const o=s.layer;return o.props.beforeId===r.beforeId&&o.props.slot===r.slot},clearStack:a,clearCanvas:!1})}function E6(t){const e=t.getProjection?.(),r=e?.type||e?.name;if(r==="globe")return"globe";if(r&&r!=="mercator")throw new Error("Unsupported projection");return"mercator"}function kb(t){return E6(t)==="globe"?new Bne({id:_x}):new p6({id:_x})}function bx(t){const{lng:e,lat:r}=t.getCenter(),n={longitude:(e+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return t.getTerrain?.()&&dGe(t,n),n}function dGe(t,e){if(t.getFreeCameraOptions){const{position:r}=t.getFreeCameraOptions();if(!r||r.z===void 0)return;const n=t.transform.height,{longitude:i,latitude:a,pitch:s}=e,o=r.x*fk,c=(1-r.y)*fk,h=r.z*fk,d=px([i,a]),m=o-d[0],b=c-d[1],x=Math.sqrt(m*m+b*b),E=s*sGe,T=1.5*n,A=E<.001?T*Math.cos(E)/h:T*Math.sin(E)/x;e.zoom=Math.log2(A);const M=T*Math.cos(E)/A,F=h-M;e.position=[0,0,F/NS(a)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function T6(t,e,r){const n=bx(e),{views:i}=t.props,a=i&&Dg(i).find(c=>c.id===_x)||kb(e);r&&(a.props.nearZMultiplier=.2);const s=r?.nearZ??e.transform._nearZ,o=r?.farZ??e.transform._farZ;return Number.isFinite(s)&&(n.nearZ=s/e.transform.height,n.farZ=o/e.transform.height),a.makeViewport({width:t.width,height:t.height,viewState:n})}function pGe(t,e){const{mapboxLayers:r,isExternal:n}=t.userData;if(n){const i=Array.from(r,d=>d.id),s=Dg(t.props.layers,Boolean).some(d=>d&&!i.includes(d.id));let o=t.getViewports();const c=o.findIndex(d=>d.id===_x),h=o.length>1||c<0;(s||h)&&(c>=0&&(o=o.slice(),o[c]=T6(t,e)),t._drawLayers("mapbox-repaint",{viewports:o,layerFilter:d=>(!t.props.layerFilter||t.props.layerFilter(d))&&(d.viewport.id!==_x||!i.includes(d.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function gGe(t,e){t.setProps({viewState:bx(e)}),t.needsRedraw({clearRedrawFlags:!0})}function C6(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(r=>{const n=r.props.type,i=new n(r.props);e.push(i)}),t.setProps({layers:e})}class mGe{constructor(e){if(!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.slot=e.slot,this.map=null,this.deck=null,this.props=e}onAdd(e,r){this.map=e,this.deck=S6({map:e,gl:r,deck:this.props.deck}),lGe(this.deck,this)}onRemove(){this.deck&&uGe(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&cGe(this.deck)}render(e,r){hGe(this.deck,this.map,this,r)}}const dk="__UNDEFINED__";function yGe(t,e,r,n){if(!t||!e||!t.style||!t.style._loaded)return;const i=Dg(n,Boolean);if(r!==n){const o=Dg(r,Boolean),c=new Set(o.map(h=>h.id));for(const h of i)c.delete(h.id);for(const h of c)t.getLayer(h)&&t.removeLayer(h)}for(const o of i){const c=t.getLayer(o.id);c?(c.implementation||c).setProps(o.props):t.addLayer(new mGe({id:o.id,deck:e,slot:o.props.slot}),o.props.beforeId)}const a=t.style._order,s={};for(const o of i){let{beforeId:c}=o.props;(!c||!a.includes(c))&&(c=dk),s[c]=s[c]||[],s[c].push(o.id)}for(const o in s){const c=s[o];let h=o===dk?a.length:a.indexOf(o),d=o===dk?void 0:o;for(let m=c.length-1;m>=0;m--){const b=c[m],x=a.indexOf(b);x!==h-1&&(t.moveLayer(b,d),x>h&&h++),h--,d=b}}}class vGe{constructor(e){El(e.id,"id is required"),this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.slot=e.slot,this.beforeId=e.beforeId,this.map=null,this.deck=null}onAdd(e,r){this.map=e,this.deck=S6({map:e,gl:r})}render(e,r){!this.deck||!this.map||fGe(this.deck,this.map,this,r)}}const pk="__UNDEFINED__";function gk(t){return t.props.beforeId?`deck-layer-group-before:${t.props.beforeId}`:t.props.slot?`deck-layer-group-slot:${t.props.slot}`:"deck-layer-group-last"}function _Ge(t,e,r){if(!t||!t.style||!t.style._loaded)return;const n=Dg(r,Boolean);if(e!==r){const s=Dg(e,Boolean),o=new Set(s.map(h=>gk(h))),c=new Set(n.map(h=>gk(h)));for(const h of o)c.has(h)||t.getLayer(h)&&t.removeLayer(h)}const i={};for(const s of n){const o=gk(s),c=t.getLayer(o);if(c){const h=c.implementation||c;i[o]=h}else{const h=new vGe({id:o,slot:s.props.slot,beforeId:s.props.beforeId});i[o]=h,t.addLayer(h,s.props.beforeId)}}const a=t.style._order;for(const[s,o]of Object.entries(i)){const c=o.beforeId||pk,h=c===pk?a.length:a.indexOf(c);if(a.indexOf(s)!==h-1){const m=c===pk?void 0:c;t.moveLayer(s,m)}}}class bGe{constructor(e){this._handleStyleChange=()=>{if(this._resolveLayers(this._map,this._deck,this._props.layers,this._props.layers),!this._map)return;E6(this._map)&&!this._props.views&&this._deck?.setProps({views:kb(this._map)})},this._updateContainerSize=()=>{if(this._map&&this._container){const{clientWidth:n,clientHeight:i}=this._map.getContainer();Object.assign(this._container.style,{width:`${n}px`,height:`${i}px`})}},this._updateViewState=()=>{const n=this._deck,i=this._map;n&&i&&(n.setProps({views:this._props.views||kb(i),viewState:bx(i)}),n.isInitialized&&n.redraw())},this._handleMouseEvent=n=>{const i=this._deck;if(!i||!i.isInitialized)return;const a={type:n.type,offsetCenter:n.point,srcEvent:n},s=this._lastMouseDownPoint;switch(!n.point&&s&&(a.deltaX=n.originalEvent.clientX-s.clientX,a.deltaY=n.originalEvent.clientY-s.clientY,a.offsetCenter={x:s.x+a.deltaX,y:s.y+a.deltaY}),a.type){case"mousedown":i._onPointerDown(a),this._lastMouseDownPoint={...n.point,clientX:n.originalEvent.clientX,clientY:n.originalEvent.clientY};break;case"dragstart":a.type="panstart",i._onEvent(a);break;case"drag":a.type="panmove",i._onEvent(a);break;case"dragend":a.type="panend",i._onEvent(a);break;case"click":a.tapCount=1,i._onEvent(a);break;case"dblclick":a.type="click",a.tapCount=2,i._onEvent(a);break;case"mousemove":a.type="pointermove",i._onPointerMove(a);break;case"mouseout":a.type="pointerleave",i._onPointerMove(a);break;default:return}};const{interleaved:r=!1}=e;this._interleaved=r,this._renderLayersInGroups=e._renderLayersInGroups||!1,this._props=this.filterProps(e)}filterProps(e){const{interleaved:r=!1,useDevicePixels:n,...i}=e;return!r&&n!==void 0&&(i.useDevicePixels=n),i}setProps(e){this._interleaved&&e.layers&&this._resolveLayers(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,this.filterProps(e)),this._deck&&this._map&&this._deck.setProps({...this._props,parameters:{...BS(this._map,this._interleaved),...this._props.parameters}})}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const r=document.createElement("div");return Object.assign(r.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=r,this._deck=new vx({...this._props,parent:r,parameters:{...BS(e,!1),...this._props.parameters},views:this._props.views||kb(e),viewState:bx(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),r}_onAddInterleaved(e){const r=e.painter.context.gl;return r instanceof WebGLRenderingContext&&po.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=S6({map:e,gl:r,deck:new vx({...this._props,gl:r,parameters:{...BS(e,!0),...this._props.parameters}})}),e.on("styledata",this._handleStyleChange),this._resolveLayers(e,this._deck,[],this._props.layers),document.createElement("div")}_resolveLayers(e,r,n,i){this._renderLayersInGroups?_Ge(e,n,i):yGe(e,r,n,i)}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),this._deck?.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),this._resolveLayers(e,this._deck,this._props.layers,[]),zne(e)}getDefaultPosition(){return"top-left"}pickObject(e){return El(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return El(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return El(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const xGe="deckgl-layer",jne=gt.createContext({}),ED=({mapId:t,children:e})=>{const r=va({mapId:t}),n=te.useRef(void 0),[i,a]=te.useState([]),[s,o]=te.useState([]);te.useEffect(()=>{if(r.map)return n.current=new bGe({id:xGe,interleaved:!0}),r.map.addControl(n.current),()=>{n.current&&r.map?.removeControl(n.current),n.current=void 0}},[r.map]),te.useEffect(()=>{n.current&&n.current.setProps({layers:[...i],effects:[...s]})},[i,s]);const c={deckGlLayerArray:i,setDeckGlLayerArray:a,deckGlEffectArray:s,setDeckGlEffectArray:o};return J.jsx(jne.Provider,{value:c,children:e})};try{ED.displayName="DeckGlContextProvider",ED.__docgenInfo={description:"",displayName:"DeckGlContextProvider",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!0,type:{name:"string"}}}}}catch{}const QGe=[(t,e)=>{const r=te.useMemo(()=>OX(e?.globals?.theme),[e?.globals?.theme]);return J.jsx("div",{className:"fullscreen_map",children:J.jsx(Ak,{children:J.jsxs(DX,{theme:r,children:[J.jsx(ED,{mapId:e.mapId,children:J.jsx(t,{})}),J.jsx(LX,{options:e?.parameters?.mapOptions?{style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",...e.parameters.mapOptions}:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[7.0851268,50.73884]},mapId:"map_1"}),J.jsx(oM,{showZoomButtons:!1,mapId:"map_1"})]})})})}];function eXe(){const t=te.useContext(jne);function e(a){t.setDeckGlEffectArray(s=>[...s,a])}function r(a){t.setDeckGlEffectArray(s=>s.filter(o=>o!==a))}function n(a){t.setDeckGlLayerArray(s=>[...s,a])}function i(a){t.setDeckGlLayerArray(s=>s.filter(o=>o!==a))}return{addEffect:e,removeEffect:r,addLayer:n,removeLayer:i}}export{Nre as $,PGe as A,kGe as B,Xa as C,va as D,eXe as E,QGe as F,JGe as G,Nh as H,o_ as I,mWe as J,VHe as K,n2 as L,ST as M,I_ as N,Dg as O,Wm as P,mc as Q,rn as R,W3 as S,Fl as T,xT as U,S7e as V,$m as W,Mg as X,JFe as Y,IGe as Z,PL as _,th as a,BGe as a0,FGe as a1,B7e as a2,my as a3,q7e as a4,F7e as a5,WP as a6,$Ge as a7,qGe as a8,WGe as a9,VGe as aa,GGe as ab,zre as ac,P7e as ad,zGe as ae,N7e as af,$7e as ag,jGe as ah,HGe as ai,DS as aj,Mre as ak,XGe as al,s2 as am,Yte as an,CBe as ao,QBe as ap,fo as aq,LGe as b,oh as c,NGe as d,OGe as e,Fne as f,KGe as g,Ad as h,n_ as i,UGe as j,CW as k,dx as l,po as m,DGe as n,MGe as o,ZGe as p,O7e as q,k7e as r,kf as s,C7e as t,aT as u,A7e as v,_7e as w,WM as x,_8e as y,gd as z};
