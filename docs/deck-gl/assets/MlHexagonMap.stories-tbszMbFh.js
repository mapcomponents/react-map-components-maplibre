const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index.es-BZy0QKLz.js","./iframe-MHXTm_pQ.js","./preload-helper-D9Z9MdNV.js","./iframe-DG6F43G8.css","./index-CJyM06DL.js","./index-DBQyMQ1Q.js"])))=>i.map(i=>d[i]);
import{j as J,P as I1,r as lp}from"./index-CJyM06DL.js";import{g as Cd,V as LS,r as te,R as gt,a as jW,c as lg,b as vx}from"./iframe-MHXTm_pQ.js";import{_ as nA}from"./preload-helper-D9Z9MdNV.js";var eS={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.16.0/LICENSE.txt
 */var Ooe=eS.exports,MB;function Loe(){return MB||(MB=1,(function(t,e){(function(r,n){t.exports=n()})(Ooe,(function(){var r={},n={};function i(s,o,c){if(n[s]=c,s==="index"){var f="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",d={};return n.shared(d),n.index(r,d),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([f],{type:"text/javascript"}))),r}}i("shared",["exports"],(function(s){function o(p,l,h,v){return new(h||(h=Promise))((function(S,M){function k(Z){try{V(v.next(Z))}catch(ie){M(ie)}}function B(Z){try{V(v.throw(Z))}catch(ie){M(ie)}}function V(Z){var ie;Z.done?S(Z.value):(ie=Z.value,ie instanceof h?ie:new h((function(ce){ce(ie)}))).then(k,B)}V((v=v.apply(p,l||[])).next())}))}function c(p,l){this.x=p,this.y=l}function f(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var d,m;typeof SuppressedError=="function"&&SuppressedError,c.prototype={clone(){return new c(this.x,this.y)},add(p){return this.clone()._add(p)},sub(p){return this.clone()._sub(p)},multByPoint(p){return this.clone()._multByPoint(p)},divByPoint(p){return this.clone()._divByPoint(p)},mult(p){return this.clone()._mult(p)},div(p){return this.clone()._div(p)},rotate(p){return this.clone()._rotate(p)},rotateAround(p,l){return this.clone()._rotateAround(p,l)},matMult(p){return this.clone()._matMult(p)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(p){return this.x===p.x&&this.y===p.y},dist(p){return Math.sqrt(this.distSqr(p))},distSqr(p){const l=p.x-this.x,h=p.y-this.y;return l*l+h*h},angle(){return Math.atan2(this.y,this.x)},angleTo(p){return Math.atan2(this.y-p.y,this.x-p.x)},angleWith(p){return this.angleWithSep(p.x,p.y)},angleWithSep(p,l){return Math.atan2(this.x*l-this.y*p,this.x*p+this.y*l)},_matMult(p){const l=p[2]*this.x+p[3]*this.y;return this.x=p[0]*this.x+p[1]*this.y,this.y=l,this},_add(p){return this.x+=p.x,this.y+=p.y,this},_sub(p){return this.x-=p.x,this.y-=p.y,this},_mult(p){return this.x*=p,this.y*=p,this},_div(p){return this.x/=p,this.y/=p,this},_multByPoint(p){return this.x*=p.x,this.y*=p.y,this},_divByPoint(p){return this.x/=p.x,this.y/=p.y,this},_unit(){return this._div(this.mag()),this},_perp(){const p=this.y;return this.y=this.x,this.x=-p,this},_rotate(p){const l=Math.cos(p),h=Math.sin(p),v=h*this.x+l*this.y;return this.x=l*this.x-h*this.y,this.y=v,this},_rotateAround(p,l){const h=Math.cos(p),v=Math.sin(p),S=l.y+v*(this.x-l.x)+h*(this.y-l.y);return this.x=l.x+h*(this.x-l.x)-v*(this.y-l.y),this.y=S,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:c},c.convert=function(p){if(p instanceof c)return p;if(Array.isArray(p))return new c(+p[0],+p[1]);if(p.x!==void 0&&p.y!==void 0)return new c(+p.x,+p.y);throw new Error("Expected [x, y] or {x, y} point format")};var b=(function(){if(m)return d;function p(l,h,v,S){this.cx=3*l,this.bx=3*(v-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(S-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=h,this.p2x=v,this.p2y=S}return m=1,d=p,p.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,h){if(h===void 0&&(h=1e-6),l<0)return 0;if(l>1)return 1;for(var v=l,S=0;S<8;S++){var M=this.sampleCurveX(v)-l;if(Math.abs(M)<h)return v;var k=this.sampleCurveDerivativeX(v);if(Math.abs(k)<1e-6)break;v-=M/k}var B=0,V=1;for(v=l,S=0;S<20&&(M=this.sampleCurveX(v),!(Math.abs(M-l)<h));S++)l>M?B=v:V=v,v=.5*(V-B)+B;return v},solve:function(l,h){return this.sampleCurveY(this.solveCurveX(l,h))}},d})(),x=f(b);let E,T;function A(){return E==null&&(E=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),E}function R(){if(T==null&&(T=!1,A())){const l=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(l){for(let v=0;v<25;v++){const S=4*v;l.fillStyle=`rgb(${S},${S+1},${S+2})`,l.fillRect(v%5,Math.floor(v/5),1,1)}const h=l.getImageData(0,0,5,5).data;for(let v=0;v<100;v++)if(v%4!=3&&h[v]!==v){T=!0;break}}}return T||!1}var F=1e-6,N=typeof Float32Array<"u"?Float32Array:Array;function O(){var p=new N(9);return N!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[5]=0,p[6]=0,p[7]=0),p[0]=1,p[4]=1,p[8]=1,p}function U(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function j(){var p=new N(3);return N!=Float32Array&&(p[0]=0,p[1]=0,p[2]=0),p}function H(p){var l=p[0],h=p[1],v=p[2];return Math.sqrt(l*l+h*h+v*v)}function W(p,l,h){var v=new N(3);return v[0]=p,v[1]=l,v[2]=h,v}function X(p,l,h){return p[0]=l[0]+h[0],p[1]=l[1]+h[1],p[2]=l[2]+h[2],p}function oe(p,l,h){return p[0]=l[0]*h,p[1]=l[1]*h,p[2]=l[2]*h,p}function ee(p,l,h){var v=l[0],S=l[1],M=l[2],k=h[0],B=h[1],V=h[2];return p[0]=S*V-M*B,p[1]=M*k-v*V,p[2]=v*B-S*k,p}var G,ae=H;function se(p,l,h){var v=l[0],S=l[1],M=l[2],k=l[3];return p[0]=h[0]*v+h[4]*S+h[8]*M+h[12]*k,p[1]=h[1]*v+h[5]*S+h[9]*M+h[13]*k,p[2]=h[2]*v+h[6]*S+h[10]*M+h[14]*k,p[3]=h[3]*v+h[7]*S+h[11]*M+h[15]*k,p}function fe(){var p=new N(4);return N!=Float32Array&&(p[0]=0,p[1]=0,p[2]=0),p[3]=1,p}function pe(p,l,h,v){var S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",M=Math.PI/360;l*=M,v*=M,h*=M;var k=Math.sin(l),B=Math.cos(l),V=Math.sin(h),Z=Math.cos(h),ie=Math.sin(v),ce=Math.cos(v);switch(S){case"xyz":p[0]=k*Z*ce+B*V*ie,p[1]=B*V*ce-k*Z*ie,p[2]=B*Z*ie+k*V*ce,p[3]=B*Z*ce-k*V*ie;break;case"xzy":p[0]=k*Z*ce-B*V*ie,p[1]=B*V*ce-k*Z*ie,p[2]=B*Z*ie+k*V*ce,p[3]=B*Z*ce+k*V*ie;break;case"yxz":p[0]=k*Z*ce+B*V*ie,p[1]=B*V*ce-k*Z*ie,p[2]=B*Z*ie-k*V*ce,p[3]=B*Z*ce+k*V*ie;break;case"yzx":p[0]=k*Z*ce+B*V*ie,p[1]=B*V*ce+k*Z*ie,p[2]=B*Z*ie-k*V*ce,p[3]=B*Z*ce-k*V*ie;break;case"zxy":p[0]=k*Z*ce-B*V*ie,p[1]=B*V*ce+k*Z*ie,p[2]=B*Z*ie+k*V*ce,p[3]=B*Z*ce-k*V*ie;break;case"zyx":p[0]=k*Z*ce-B*V*ie,p[1]=B*V*ce+k*Z*ie,p[2]=B*Z*ie-k*V*ce,p[3]=B*Z*ce+k*V*ie;break;default:throw new Error("Unknown angle order "+S)}return p}function De(){var p=new N(2);return N!=Float32Array&&(p[0]=0,p[1]=0),p}function ye(p,l){var h=new N(2);return h[0]=p,h[1]=l,h}j(),G=new N(4),N!=Float32Array&&(G[0]=0,G[1]=0,G[2]=0,G[3]=0),j(),W(1,0,0),W(0,1,0),fe(),fe(),O(),De();const we=8192;function Te(p,l,h){return l*(we/(p.tileSize*Math.pow(2,h-p.tileID.overscaledZ)))}function Re(p,l){return(p%l+l)%l}function de(p,l,h){return p*(1-h)+l*h}function Ee(p){if(p<=0)return 0;if(p>=1)return 1;const l=p*p,h=l*p;return 4*(p<.5?h:3*(p-l)+h-.75)}function xe(p,l,h,v){const S=new x(p,l,h,v);return M=>S.solve(M)}const Ne=xe(.25,.1,.25,1);function Fe(p,l,h){return Math.min(h,Math.max(l,p))}function Xe(p,l,h){const v=h-l,S=((p-l)%v+v)%v+l;return S===l?h:S}function Be(p,...l){for(const h of l)for(const v in h)p[v]=h[v];return p}let ot=1;function Ke(p,l,h){const v={};for(const S in p)v[S]=l.call(this,p[S],S,p);return v}function it(p,l,h){const v={};for(const S in p)l.call(this,p[S],S,p)&&(v[S]=p[S]);return v}function Me(p){return Array.isArray(p)?p.map(Me):typeof p=="object"&&p?Ke(p,Me):p}const zt={};function st(p){zt[p]||(typeof console<"u"&&console.warn(p),zt[p]=!0)}function $e(p,l,h){return(h.y-p.y)*(l.x-p.x)>(l.y-p.y)*(h.x-p.x)}function Jt(p){return typeof WorkerGlobalScope<"u"&&p!==void 0&&p instanceof WorkerGlobalScope}let Ht=null;function pr(p){return typeof ImageBitmap<"u"&&p instanceof ImageBitmap}const _t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function vr(p,l,h,v,S){return o(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const M=new VideoFrame(p,{timestamp:0});try{const k=M?.format;if(!k||!k.startsWith("BGR")&&!k.startsWith("RGB"))throw new Error(`Unrecognized format ${k}`);const B=k.startsWith("BGR"),V=new Uint8ClampedArray(v*S*4);if(yield M.copyTo(V,(function(Z,ie,ce,_e,Se){const Le=4*Math.max(-ie,0),ze=(Math.max(0,ce)-ce)*_e*4+Le,Ve=4*_e,et=Math.max(0,ie),Ct=Math.max(0,ce);return{rect:{x:et,y:Ct,width:Math.min(Z.width,ie+_e)-et,height:Math.min(Z.height,ce+Se)-Ct},layout:[{offset:ze,stride:Ve}]}})(p,l,h,v,S)),B)for(let Z=0;Z<V.length;Z+=4){const ie=V[Z];V[Z]=V[Z+2],V[Z+2]=ie}return V}finally{M.close()}}))}let br,lr;function Cr(p,l,h,v){return p.addEventListener(l,h,v),{unsubscribe:()=>{p.removeEventListener(l,h,v)}}}function Tr(p){return p*Math.PI/180}function Qt(p){return p/Math.PI*180}const at={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Pe={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},be="AbortError";class je extends Error{constructor(l=be){super(l instanceof Error?l.message:l),this.name=be,l instanceof Error&&l.stack&&(this.stack=l.stack)}}function qe(p){return p.name===be}const Ge={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Nt(p){return Ge.REGISTERED_PROTOCOLS[p.substring(0,p.indexOf("://"))]}const Et="global-dispatcher";class mt extends Error{constructor(l,h,v,S){super(`AJAXError: ${h} (${l}): ${v}`),this.status=l,this.statusText=h,this.url=v,this.body=S}}const ct=()=>Jt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Kt=function(p,l){if(/:\/\//.test(p.url)&&!/^https?:|^file:/.test(p.url)){const v=Nt(p.url);if(v)return v(p,l);if(Jt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:p,targetMapId:Et},l)}if(!(/^file:/.test(h=p.url)||/^file:/.test(ct())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(v,S){return o(this,void 0,void 0,(function*(){const M=new Request(v.url,{method:v.method||"GET",body:v.body,credentials:v.credentials,headers:v.headers,cache:v.cache,referrer:ct(),signal:S.signal});let k,B;v.type!=="json"||M.headers.has("Accept")||M.headers.set("Accept","application/json");try{k=yield fetch(M)}catch(Z){throw qe(Z)?Z:new mt(0,Z.message,v.url,new Blob)}if(!k.ok){const Z=yield k.blob();throw new mt(k.status,k.statusText,v.url,Z)}B=v.type==="arrayBuffer"||v.type==="image"?k.arrayBuffer():v.type==="json"?k.json():k.text();const V=yield B;return S.signal.throwIfAborted(),{data:V,cacheControl:k.headers.get("Cache-Control"),expires:k.headers.get("Expires")}}))})(p,l);if(Jt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:p,mustQueue:!0,targetMapId:Et},l)}var h;return(function(v,S){return new Promise(((M,k)=>{var B;const V=new XMLHttpRequest;V.open(v.method||"GET",v.url,!0),v.type!=="arrayBuffer"&&v.type!=="image"||(V.responseType="arraybuffer");for(const Z in v.headers)V.setRequestHeader(Z,v.headers[Z]);v.type==="json"&&(V.responseType="text",!((B=v.headers)===null||B===void 0)&&B.Accept||V.setRequestHeader("Accept","application/json")),V.withCredentials=v.credentials==="include",V.onerror=()=>{k(new Error(V.statusText))},V.onload=()=>{if(!S.signal.aborted)if((V.status>=200&&V.status<300||V.status===0)&&V.response!==null){let Z=V.response;if(v.type==="json")try{Z=JSON.parse(V.response)}catch(ie){return void k(ie)}M({data:Z,cacheControl:V.getResponseHeader("Cache-Control"),expires:V.getResponseHeader("Expires")})}else{const Z=new Blob([V.response],{type:V.getResponseHeader("Content-Type")});k(new mt(V.status,V.statusText,v.url,Z))}},S.signal.addEventListener("abort",(()=>{V.abort(),k(new je(S.signal.reason))})),V.send(v.body)}))})(p,l)};function qt(p){if(!p||p.indexOf("://")<=0||p.indexOf("data:image/")===0||p.indexOf("blob:")===0)return!0;const l=new URL(p),h=window.location;return l.protocol===h.protocol&&l.host===h.host}function Ir(p,l,h){h[p]&&h[p].indexOf(l)!==-1||(h[p]=h[p]||[],h[p].push(l))}function Ar(p,l,h){if(h&&h[p]){const v=h[p].indexOf(l);v!==-1&&h[p].splice(v,1)}}class $r{constructor(l,h={}){Be(this,h),this.type=l}}class cn extends $r{constructor(l,h={}){super("error",Be({error:l},h))}}class zr{on(l,h){return this._listeners=this._listeners||{},Ir(l,h,this._listeners),{unsubscribe:()=>{this.off(l,h)}}}off(l,h){return Ar(l,h,this._listeners),Ar(l,h,this._oneTimeListeners),this}once(l,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Ir(l,h,this._oneTimeListeners),this):new Promise((v=>this.once(l,v)))}fire(l,h){typeof l=="string"&&(l=new $r(l,h||{}));const v=l.type;if(this.listens(v)){l.target=this;const S=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];for(const B of S)B.call(this,l);const M=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];for(const B of M)Ar(v,B,this._oneTimeListeners),B.call(this,l);const k=this._eventedParent;k&&(Be(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),k.fire(l))}else l instanceof cn&&console.error(l.error);return this}listens(l){return this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l)}setEventedParent(l,h){return this._eventedParent=l,this._eventedParentData=h,this}}var Rt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const en=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function jn(p,l){const h={};for(const v in p)v!=="ref"&&(h[v]=p[v]);return en.forEach((v=>{v in l&&(h[v]=l[v])})),h}function Qr(p,l){if(Array.isArray(p)){if(!Array.isArray(l)||p.length!==l.length)return!1;for(let h=0;h<p.length;h++)if(!Qr(p[h],l[h]))return!1;return!0}if(typeof p=="object"&&p!==null&&l!==null){if(typeof l!="object"||Object.keys(p).length!==Object.keys(l).length)return!1;for(const h in p)if(!Qr(p[h],l[h]))return!1;return!0}return p===l}function nr(p,l){p.push(l)}function oi(p,l,h){nr(h,{command:"addSource",args:[p,l[p]]})}function ln(p,l,h){nr(l,{command:"removeSource",args:[p]}),h[p]=!0}function Kn(p,l,h,v){ln(p,h,v),oi(p,l,h)}function ke(p,l,h){let v;for(v in p[h])if(Object.prototype.hasOwnProperty.call(p[h],v)&&v!=="data"&&!Qr(p[h][v],l[h][v]))return!1;for(v in l[h])if(Object.prototype.hasOwnProperty.call(l[h],v)&&v!=="data"&&!Qr(p[h][v],l[h][v]))return!1;return!0}function He(p,l,h,v,S,M){p=p||{},l=l||{};for(const k in p)Object.prototype.hasOwnProperty.call(p,k)&&(Qr(p[k],l[k])||h.push({command:M,args:[v,k,l[k],S]}));for(const k in l)Object.prototype.hasOwnProperty.call(l,k)&&!Object.prototype.hasOwnProperty.call(p,k)&&(Qr(p[k],l[k])||h.push({command:M,args:[v,k,l[k],S]}))}function Tt(p){return p.id}function Gt(p,l){return p[l.id]=l,p}class Ut{constructor(l,h,v,S){this.message=(l?`${l}: `:"")+v,S&&(this.identifier=S),h!=null&&h.__line__&&(this.line=h.__line__)}}function Xr(p,...l){for(const h of l)for(const v in h)p[v]=h[v];return p}class Ln extends Error{constructor(l,h){super(h),this.message=h,this.key=l}}class Bi{constructor(l,h=[]){this.parent=l,this.bindings={};for(const[v,S]of h)this.bindings[v]=S}concat(l){return new Bi(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}const Ci={kind:"null"},Fr={kind:"number"},Rn={kind:"string"},Bn={kind:"boolean"},ei={kind:"color"},ua={kind:"projectionDefinition"},ha={kind:"object"},zn={kind:"value"},Na={kind:"collator"},Wi={kind:"formatted"},ds={kind:"padding"},Ca={kind:"colorArray"},Do={kind:"numberArray"},Ya={kind:"resolvedImage"},sl={kind:"variableAnchorOffsetCollection"};function xi(p,l){return{kind:"array",itemType:p,N:l}}function zi(p){if(p.kind==="array"){const l=zi(p.itemType);return typeof p.N=="number"?`array<${l}, ${p.N}>`:p.itemType.kind==="value"?"array":`array<${l}>`}return p.kind}const Iu=[Ci,Fr,Rn,Bn,ei,ua,Wi,ha,xi(zn),ds,Do,Ca,Ya,sl];function ma(p,l){if(l.kind==="error")return null;if(p.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!ma(p.itemType,l.itemType))&&(typeof p.N!="number"||p.N===l.N))return null}else{if(p.kind===l.kind)return null;if(p.kind==="value"){for(const h of Iu)if(!ma(h,l))return null}}return`Expected ${zi(p)} but found ${zi(l)} instead.`}function Za(p,l){return l.some((h=>h.kind===p.kind))}function ps(p,l){return l.some((h=>h==="null"?p===null:h==="array"?Array.isArray(p):h==="object"?p&&!Array.isArray(p)&&typeof p=="object":h===typeof p))}function Aa(p,l){return p.kind==="array"&&l.kind==="array"?p.itemType.kind===l.itemType.kind&&typeof p.N=="number":p.kind===l.kind}const gs=.96422,Ul=.82521,Fa=4/29,_a=6/29,xc=3*_a*_a,ll=_a*_a*_a,rs=Math.PI/180,so=180/Math.PI;function ns(p){return(p%=360)<0&&(p+=360),p}function Ba([p,l,h,v]){let S,M;const k=Uc((.2225045*(p=Vs(p))+.7168786*(l=Vs(l))+.0606169*(h=Vs(h)))/1);p===l&&l===h?S=M=k:(S=Uc((.4360747*p+.3850649*l+.1430804*h)/gs),M=Uc((.0139322*p+.0971045*l+.7141733*h)/Ul));const B=116*k-16;return[B<0?0:B,500*(S-k),200*(k-M),v]}function Vs(p){return p<=.04045?p/12.92:Math.pow((p+.055)/1.055,2.4)}function Uc(p){return p>ll?Math.pow(p,1/3):p/xc+Fa}function Pu([p,l,h,v]){let S=(p+16)/116,M=isNaN(l)?S:S+l/500,k=isNaN(h)?S:S-h/200;return S=1*ge(S),M=gs*ge(M),k=Ul*ge(k),[Q(3.1338561*M-1.6168667*S-.4906146*k),Q(-.9787684*M+1.9161415*S+.033454*k),Q(.0719453*M-.2289914*S+1.4052427*k),v]}function Q(p){return(p=p<=.00304?12.92*p:1.055*Math.pow(p,1/2.4)-.055)<0?0:p>1?1:p}function ge(p){return p>_a?p*p*p:xc*(p-Fa)}const Je=Object.hasOwn||function(p,l){return Object.prototype.hasOwnProperty.call(p,l)};function It(p,l){return Je(p,l)?p[l]:void 0}function Vt(p){return parseInt(p.padEnd(2,p),16)/255}function $t(p,l){return er(l?p/100:p,0,1)}function er(p,l,h){return Math.min(Math.max(l,p),h)}function Yr(p){return!p.some(Number.isNaN)}const tn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Gr(p,l,h){return p+h*(l-p)}function an(p,l,h){return p.map(((v,S)=>Gr(v,l[S],h)))}class Mr{constructor(l,h,v,S=1,M=!0){this.r=l,this.g=h,this.b=v,this.a=S,M||(this.r*=S,this.g*=S,this.b*=S,S||this.overwriteGetter("rgb",[l,h,v,S]))}static parse(l){if(l instanceof Mr)return l;if(typeof l!="string")return;const h=(function(v){if((v=v.toLowerCase().trim())==="transparent")return[0,0,0,0];const S=It(tn,v);if(S){const[k,B,V]=S;return[k/255,B/255,V/255,1]}if(v.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(v)){const k=v.length<6?1:2;let B=1;return[Vt(v.slice(B,B+=k)),Vt(v.slice(B,B+=k)),Vt(v.slice(B,B+=k)),Vt(v.slice(B,B+k)||"ff")]}if(v.startsWith("rgb")){const k=v.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(k){const[B,V,Z,ie,ce,_e,Se,Le,ze,Ve,et,Ct]=k,rt=[ie||" ",Se||" ",Ve].join("");if(rt==="  "||rt==="  /"||rt===",,"||rt===",,,"){const ut=[Z,_e,ze].join(""),kt=ut==="%%%"?100:ut===""?255:0;if(kt){const Ft=[er(+V/kt,0,1),er(+ce/kt,0,1),er(+Le/kt,0,1),et?$t(+et,Ct):1];if(Yr(Ft))return Ft}}return}}const M=v.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(M){const[k,B,V,Z,ie,ce,_e,Se,Le]=M,ze=[V||" ",ie||" ",_e].join("");if(ze==="  "||ze==="  /"||ze===",,"||ze===",,,"){const Ve=[+B,er(+Z,0,100),er(+ce,0,100),Se?$t(+Se,Le):1];if(Yr(Ve))return(function([et,Ct,rt,ut]){function kt(Ft){const hr=(Ft+et/30)%12,Or=Ct*Math.min(rt,1-rt);return rt-Or*Math.max(-1,Math.min(hr-3,9-hr,1))}return et=ns(et),Ct/=100,rt/=100,[kt(0),kt(8),kt(4),ut]})(Ve)}}})(l);return h?new Mr(...h,!1):void 0}get rgb(){const{r:l,g:h,b:v,a:S}=this,M=S||1/0;return this.overwriteGetter("rgb",[l/M,h/M,v/M,S])}get hcl(){return this.overwriteGetter("hcl",(function(l){const[h,v,S,M]=Ba(l),k=Math.sqrt(v*v+S*S);return[Math.round(1e4*k)?ns(Math.atan2(S,v)*so):NaN,k,h,M]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Ba(this.rgb))}overwriteGetter(l,h){return Object.defineProperty(this,l,{value:h}),h}toString(){const[l,h,v,S]=this.rgb;return`rgba(${[l,h,v].map((M=>Math.round(255*M))).join(",")},${S})`}static interpolate(l,h,v,S="rgb"){switch(S){case"rgb":{const[M,k,B,V]=an(l.rgb,h.rgb,v);return new Mr(M,k,B,V,!1)}case"hcl":{const[M,k,B,V]=l.hcl,[Z,ie,ce,_e]=h.hcl;let Se,Le;if(isNaN(M)||isNaN(Z))isNaN(M)?isNaN(Z)?Se=NaN:(Se=Z,B!==1&&B!==0||(Le=ie)):(Se=M,ce!==1&&ce!==0||(Le=k));else{let rt=Z-M;Z>M&&rt>180?rt-=360:Z<M&&M-Z>180&&(rt+=360),Se=M+v*rt}const[ze,Ve,et,Ct]=(function([rt,ut,kt,Ft]){return rt=isNaN(rt)?0:rt*rs,Pu([kt,Math.cos(rt)*ut,Math.sin(rt)*ut,Ft])})([Se,Le??Gr(k,ie,v),Gr(B,ce,v),Gr(V,_e,v)]);return new Mr(ze,Ve,et,Ct,!1)}case"lab":{const[M,k,B,V]=Pu(an(l.lab,h.lab,v));return new Mr(M,k,B,V,!1)}}}}Mr.black=new Mr(0,0,0,1),Mr.white=new Mr(1,1,1,1),Mr.transparent=new Mr(0,0,0,0),Mr.red=new Mr(1,0,0,1);class ti{constructor(l,h,v){this.sensitivity=l?h?"variant":"case":h?"accent":"base",this.locale=v,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,h){return this.collator.compare(l,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const ki=["bottom","center","top"];class $n{constructor(l,h,v,S,M,k){this.text=l,this.image=h,this.scale=v,this.fontStack=S,this.textColor=M,this.verticalAlign=k}}class _n{constructor(l){this.sections=l}static fromString(l){return new _n([new $n(l,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((l=>l.text.length!==0||l.image&&l.image.name.length!==0))}static factory(l){return l instanceof _n?l:_n.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map((l=>l.text)).join("")}}class Rr{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Rr)return l;if(typeof l=="number")return new Rr([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const h of l)if(typeof h!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]]}return new Rr(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,v){return new Rr(an(l.values,h.values,v))}}class fn{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof fn)return l;if(typeof l=="number")return new fn([l]);if(Array.isArray(l)){for(const h of l)if(typeof h!="number")return;return new fn(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,v){return new fn(an(l.values,h.values,v))}}class mn{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof mn)return l;if(typeof l=="string"){const v=Mr.parse(l);return v?new mn([v]):void 0}if(!Array.isArray(l))return;const h=[];for(const v of l){if(typeof v!="string")return;const S=Mr.parse(v);if(!S)return;h.push(S)}return new mn(h)}toString(){return JSON.stringify(this.values)}static interpolate(l,h,v,S="rgb"){const M=[];if(l.values.length!=h.values.length)throw new Error(`colorArray: Arrays have mismatched length (${l.values.length} vs. ${h.values.length}), cannot interpolate.`);for(let k=0;k<l.values.length;k++)M.push(Mr.interpolate(l.values[k],h.values[k],v,S));return new mn(M)}}class fi extends Error{constructor(l){super(l),this.name="RuntimeError"}toJSON(){return this.message}}const $i=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ba{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof ba)return l;if(Array.isArray(l)&&!(l.length<1)&&l.length%2==0){for(let h=0;h<l.length;h+=2){const v=l[h],S=l[h+1];if(typeof v!="string"||!$i.has(v)||!Array.isArray(S)||S.length!==2||typeof S[0]!="number"||typeof S[1]!="number")return}return new ba(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,v){const S=l.values,M=h.values;if(S.length!==M.length)throw new fi(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${h.toString()}`);const k=[];for(let B=0;B<S.length;B+=2){if(S[B]!==M[B])throw new fi(`Cannot interpolate values containing mismatched anchors. from[${B}]: ${S[B]}, to[${B}]: ${M[B]}`);k.push(S[B]);const[V,Z]=S[B+1],[ie,ce]=M[B+1];k.push([Gr(V,ie,v),Gr(Z,ce,v)])}return new ba(k)}}class wi{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new wi({name:l,available:!1}):null}}class hi{constructor(l,h,v){this.from=l,this.to=h,this.transition=v}static interpolate(l,h,v){return new hi(l,h,v)}static parse(l){return l instanceof hi?l:Array.isArray(l)&&l.length===3&&typeof l[0]=="string"&&typeof l[1]=="string"&&typeof l[2]=="number"?new hi(l[0],l[1],l[2]):typeof l=="object"&&typeof l.from=="string"&&typeof l.to=="string"&&typeof l.transition=="number"?new hi(l.from,l.to,l.transition):typeof l=="string"?new hi(l,l,1):void 0}}function Cs(p,l,h,v){return typeof p=="number"&&p>=0&&p<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof h=="number"&&h>=0&&h<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:`Invalid rgba value [${[p,l,h,v].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof v=="number"?[p,l,h,v]:[p,l,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function $s(p){if(p===null||typeof p=="string"||typeof p=="boolean"||typeof p=="number"||p instanceof hi||p instanceof Mr||p instanceof ti||p instanceof _n||p instanceof Rr||p instanceof fn||p instanceof mn||p instanceof ba||p instanceof wi)return!0;if(Array.isArray(p)){for(const l of p)if(!$s(l))return!1;return!0}if(typeof p=="object"){for(const l in p)if(!$s(p[l]))return!1;return!0}return!1}function Ri(p){if(p===null)return Ci;if(typeof p=="string")return Rn;if(typeof p=="boolean")return Bn;if(typeof p=="number")return Fr;if(p instanceof Mr)return ei;if(p instanceof hi)return ua;if(p instanceof ti)return Na;if(p instanceof _n)return Wi;if(p instanceof Rr)return ds;if(p instanceof fn)return Do;if(p instanceof mn)return Ca;if(p instanceof ba)return sl;if(p instanceof wi)return Ya;if(Array.isArray(p)){const l=p.length;let h;for(const v of p){const S=Ri(v);if(h){if(h===S)continue;h=zn;break}h=S}return xi(h||zn,l)}return ha}function As(p){const l=typeof p;return p===null?"":l==="string"||l==="number"||l==="boolean"?String(p):p instanceof Mr||p instanceof hi||p instanceof _n||p instanceof Rr||p instanceof fn||p instanceof mn||p instanceof ba||p instanceof wi?p.toString():JSON.stringify(p)}class oa{constructor(l,h){this.type=l,this.value=h}static parse(l,h){if(l.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!$s(l[1]))return h.error("invalid value");const v=l[1];let S=Ri(v);const M=h.expectedType;return S.kind!=="array"||S.N!==0||!M||M.kind!=="array"||typeof M.N=="number"&&M.N!==0||(S=M),new oa(S,v)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Mu={string:Rn,number:Fr,boolean:Bn,object:ha};class Ka{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");let v,S=1;const M=l[0];if(M==="array"){let B,V;if(l.length>2){const Z=l[1];if(typeof Z!="string"||!(Z in Mu)||Z==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);B=Mu[Z],S++}else B=zn;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return h.error('The length argument to "array" must be a positive integer literal',2);V=l[2],S++}v=xi(B,V)}else{if(!Mu[M])throw new Error(`Types doesn't contain name = ${M}`);v=Mu[M]}const k=[];for(;S<l.length;S++){const B=h.parse(l[S],S,zn);if(!B)return null;k.push(B)}return new Ka(v,k)}evaluate(l){for(let h=0;h<this.args.length;h++){const v=this.args[h].evaluate(l);if(!ma(this.type,Ri(v)))return v;if(h===this.args.length-1)throw new fi(`Expected value to be of type ${zi(this.type)}, but found ${zi(Ri(v))} instead.`)}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every((l=>l.outputDefined()))}}const qs={"to-boolean":Bn,"to-color":ei,"to-number":Fr,"to-string":Rn};class Vo{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const v=l[0];if(!qs[v])throw new Error(`Can't parse ${v} as it is not part of the known types`);if((v==="to-boolean"||v==="to-string")&&l.length!==2)return h.error("Expected one argument.");const S=qs[v],M=[];for(let k=1;k<l.length;k++){const B=h.parse(l[k],k,zn);if(!B)return null;M.push(B)}return new Vo(S,M)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let h,v;for(const S of this.args){if(h=S.evaluate(l),v=null,h instanceof Mr)return h;if(typeof h=="string"){const M=l.parseColor(h);if(M)return M}else if(Array.isArray(h)&&(v=h.length<3||h.length>4?`Invalid rgba value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Cs(h[0],h[1],h[2],h[3]),!v))return new Mr(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new fi(v||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const v of this.args){h=v.evaluate(l);const S=Rr.parse(h);if(S)return S}throw new fi(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"numberArray":{let h;for(const v of this.args){h=v.evaluate(l);const S=fn.parse(h);if(S)return S}throw new fi(`Could not parse numberArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"colorArray":{let h;for(const v of this.args){h=v.evaluate(l);const S=mn.parse(h);if(S)return S}throw new fi(`Could not parse colorArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const v of this.args){h=v.evaluate(l);const S=ba.parse(h);if(S)return S}throw new fi(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const v of this.args){if(h=v.evaluate(l),h===null)return 0;const S=Number(h);if(!isNaN(S))return S}throw new fi(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return _n.fromString(As(this.args[0].evaluate(l)));case"resolvedImage":return wi.fromString(As(this.args[0].evaluate(l)));case"projectionDefinition":return this.args[0].evaluate(l);default:return As(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every((l=>l.outputDefined()))}}const ku=["Unknown","Point","LineString","Polygon"];class Ru{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ku[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let h=this._parseColorCache.get(l);return h||(h=Mr.parse(l),this._parseColorCache.set(l,h)),h}}class go{constructor(l,h,v=[],S,M=new Bi,k=[]){this.registry=l,this.path=v,this.key=v.map((B=>`[${B}]`)).join(""),this.scope=M,this.errors=k,this.expectedType=S,this._isConstant=h}parse(l,h,v,S,M={}){return h?this.concat(h,v,S)._parse(l,M):this._parse(l,M)}_parse(l,h){function v(S,M,k){return k==="assert"?new Ka(M,[S]):k==="coerce"?new Vo(M,[S]):S}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const S=l[0];if(typeof S!="string")return this.error(`Expression name must be a string, but found ${typeof S} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const M=this.registry[S];if(M){let k=M.parse(l,this);if(!k)return null;if(this.expectedType){const B=this.expectedType,V=k.type;if(B.kind!=="string"&&B.kind!=="number"&&B.kind!=="boolean"&&B.kind!=="object"&&B.kind!=="array"||V.kind!=="value"){if(B.kind==="projectionDefinition"&&["string","array"].includes(V.kind)||["color","formatted","resolvedImage"].includes(B.kind)&&["value","string"].includes(V.kind)||["padding","numberArray"].includes(B.kind)&&["value","number","array"].includes(V.kind)||B.kind==="colorArray"&&["value","string","array"].includes(V.kind)||B.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(V.kind))k=v(k,B,h.typeAnnotation||"coerce");else if(this.checkSubtype(B,V))return null}else k=v(k,B,h.typeAnnotation||"assert")}if(!(k instanceof oa)&&k.type.kind!=="resolvedImage"&&this._isConstant(k)){const B=new Ru;try{k=new oa(k.type,k.evaluate(B))}catch(V){return this.error(V.message),null}}return k}return this.error(`Unknown expression "${S}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,h,v){const S=typeof l=="number"?this.path.concat(l):this.path,M=v?this.scope.concat(v):this.scope;return new go(this.registry,this._isConstant,S,h||null,M,this.errors)}error(l,...h){const v=`${this.key}${h.map((S=>`[${S}]`)).join("")}`;this.errors.push(new Ln(v,l))}checkSubtype(l,h){const v=ma(l,h);return v&&this.error(v),v}}class ji{constructor(l,h){this.type=h.type,this.bindings=[].concat(l),this.result=h}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const h of this.bindings)l(h[1]);l(this.result)}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const v=[];for(let M=1;M<l.length-1;M+=2){const k=l[M];if(typeof k!="string")return h.error(`Expected string, but found ${typeof k} instead.`,M);if(/[^a-zA-Z0-9_]/.test(k))return h.error("Variable names must contain only alphanumeric characters or '_'.",M);const B=h.parse(l[M+1],M+1);if(!B)return null;v.push([k,B])}const S=h.parse(l[l.length-1],l.length-1,h.expectedType,v);return S?new ji(v,S):null}outputDefined(){return this.result.outputDefined()}}class Hs{constructor(l,h){this.type=h.type,this.name=l,this.boundExpression=h}static parse(l,h){if(l.length!==2||typeof l[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const v=l[1];return h.scope.has(v)?new Hs(v,h.scope.get(v)):h.error(`Unknown variable "${v}". Make sure "${v}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class ii{constructor(l,h,v){this.type=l,this.index=h,this.input=v}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const v=h.parse(l[1],1,Fr),S=h.parse(l[2],2,xi(h.expectedType||zn));return v&&S?new ii(S.type.itemType,v,S):null}evaluate(l){const h=this.index.evaluate(l),v=this.input.evaluate(l);if(h<0)throw new fi(`Array index out of bounds: ${h} < 0.`);if(h>=v.length)throw new fi(`Array index out of bounds: ${h} > ${v.length-1}.`);if(h!==Math.floor(h))throw new fi(`Array index must be an integer, but found ${h} instead.`);return v[h]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class ri{constructor(l,h){this.type=Bn,this.needle=l,this.haystack=h}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const v=h.parse(l[1],1,zn),S=h.parse(l[2],2,zn);return v&&S?Za(v.type,[Bn,Rn,Fr,Ci,zn])?new ri(v,S):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(v.type)} instead`):null}evaluate(l){const h=this.needle.evaluate(l),v=this.haystack.evaluate(l);if(!v)return!1;if(!ps(h,["boolean","string","number","null"]))throw new fi(`Expected first argument to be of type boolean, string, number or null, but found ${zi(Ri(h))} instead.`);if(!ps(v,["string","array"]))throw new fi(`Expected second argument to be of type array or string, but found ${zi(Ri(v))} instead.`);return v.indexOf(h)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class Oo{constructor(l,h,v){this.type=Fr,this.needle=l,this.haystack=h,this.fromIndex=v}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 2 or 3 arguments, but found ${l.length-1} instead.`);const v=h.parse(l[1],1,zn),S=h.parse(l[2],2,zn);if(!v||!S)return null;if(!Za(v.type,[Bn,Rn,Fr,Ci,zn]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(v.type)} instead`);if(l.length===4){const M=h.parse(l[3],3,Fr);return M?new Oo(v,S,M):null}return new Oo(v,S)}evaluate(l){const h=this.needle.evaluate(l),v=this.haystack.evaluate(l);if(!ps(h,["boolean","string","number","null"]))throw new fi(`Expected first argument to be of type boolean, string, number or null, but found ${zi(Ri(h))} instead.`);let S;if(this.fromIndex&&(S=this.fromIndex.evaluate(l)),ps(v,["string"])){const M=v.indexOf(h,S);return M===-1?-1:[...v.slice(0,M)].length}if(ps(v,["array"]))return v.indexOf(h,S);throw new fi(`Expected second argument to be of type array or string, but found ${zi(Ri(v))} instead.`)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class ai{constructor(l,h,v,S,M,k){this.inputType=l,this.type=h,this.input=v,this.cases=S,this.outputs=M,this.otherwise=k}static parse(l,h){if(l.length<5)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return h.error("Expected an even number of arguments.");let v,S;h.expectedType&&h.expectedType.kind!=="value"&&(S=h.expectedType);const M={},k=[];for(let Z=2;Z<l.length-1;Z+=2){let ie=l[Z];const ce=l[Z+1];Array.isArray(ie)||(ie=[ie]);const _e=h.concat(Z);if(ie.length===0)return _e.error("Expected at least one branch label.");for(const Le of ie){if(typeof Le!="number"&&typeof Le!="string")return _e.error("Branch labels must be numbers or strings.");if(typeof Le=="number"&&Math.abs(Le)>Number.MAX_SAFE_INTEGER)return _e.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Le=="number"&&Math.floor(Le)!==Le)return _e.error("Numeric branch labels must be integer values.");if(v){if(_e.checkSubtype(v,Ri(Le)))return null}else v=Ri(Le);if(M[String(Le)]!==void 0)return _e.error("Branch labels must be unique.");M[String(Le)]=k.length}const Se=h.parse(ce,Z,S);if(!Se)return null;S=S||Se.type,k.push(Se)}const B=h.parse(l[1],1,zn);if(!B)return null;const V=h.parse(l[l.length-1],l.length-1,S);return V?B.type.kind!=="value"&&h.concat(1).checkSubtype(v,B.type)?null:new ai(v,S,B,M,k,V):null}evaluate(l){const h=this.input.evaluate(l);return(Ri(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every((l=>l.outputDefined()))&&this.otherwise.outputDefined()}}class ue{constructor(l,h,v){this.type=l,this.branches=h,this.otherwise=v}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return h.error("Expected an odd number of arguments.");let v;h.expectedType&&h.expectedType.kind!=="value"&&(v=h.expectedType);const S=[];for(let k=1;k<l.length-1;k+=2){const B=h.parse(l[k],k,Bn);if(!B)return null;const V=h.parse(l[k+1],k+1,v);if(!V)return null;S.push([B,V]),v=v||V.type}const M=h.parse(l[l.length-1],l.length-1,v);if(!M)return null;if(!v)throw new Error("Can't infer output type");return new ue(v,S,M)}evaluate(l){for(const[h,v]of this.branches)if(h.evaluate(l))return v.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[h,v]of this.branches)l(h),l(v);l(this.otherwise)}outputDefined(){return this.branches.every((([l,h])=>h.outputDefined()))&&this.otherwise.outputDefined()}}class We{constructor(l,h,v,S){this.type=l,this.input=h,this.beginIndex=v,this.endIndex=S}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 2 or 3 arguments, but found ${l.length-1} instead.`);const v=h.parse(l[1],1,zn),S=h.parse(l[2],2,Fr);if(!v||!S)return null;if(!Za(v.type,[xi(zn),Rn,zn]))return h.error(`Expected first argument to be of type array or string, but found ${zi(v.type)} instead`);if(l.length===4){const M=h.parse(l[3],3,Fr);return M?new We(v.type,v,S,M):null}return new We(v.type,v,S)}evaluate(l){const h=this.input.evaluate(l),v=this.beginIndex.evaluate(l);let S;if(this.endIndex&&(S=this.endIndex.evaluate(l)),ps(h,["string"]))return[...h].slice(v,S).join("");if(ps(h,["array"]))return h.slice(v,S);throw new fi(`Expected first argument to be of type array or string, but found ${zi(Ri(h))} instead.`)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function bt(p,l){const h=p.length-1;let v,S,M=0,k=h,B=0;for(;M<=k;)if(B=Math.floor((M+k)/2),v=p[B],S=p[B+1],v<=l){if(B===h||l<S)return B;M=B+1}else{if(!(v>l))throw new fi("Input is not a number.");k=B-1}return 0}class Bt{constructor(l,h,v){this.type=l,this.input=h,this.labels=[],this.outputs=[];for(const[S,M]of v)this.labels.push(S),this.outputs.push(M)}static parse(l,h){if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");const v=h.parse(l[1],1,Fr);if(!v)return null;const S=[];let M=null;h.expectedType&&h.expectedType.kind!=="value"&&(M=h.expectedType);for(let k=1;k<l.length;k+=2){const B=k===1?-1/0:l[k],V=l[k+1],Z=k,ie=k+1;if(typeof B!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(S.length&&S[S.length-1][0]>=B)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Z);const ce=h.parse(V,ie,M);if(!ce)return null;M=M||ce.type,S.push([B,ce])}return new Bt(M,v,S)}evaluate(l){const h=this.labels,v=this.outputs;if(h.length===1)return v[0].evaluate(l);const S=this.input.evaluate(l);if(S<=h[0])return v[0].evaluate(l);const M=h.length;return S>=h[M-1]?v[M-1].evaluate(l):v[bt(h,S)].evaluate(l)}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every((l=>l.outputDefined()))}}function sr(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var Lr,Zr,Nn=(function(){if(Zr)return Lr;function p(l,h,v,S){this.cx=3*l,this.bx=3*(v-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(S-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=h,this.p2x=v,this.p2y=S}return Zr=1,Lr=p,p.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,h){if(h===void 0&&(h=1e-6),l<0)return 0;if(l>1)return 1;for(var v=l,S=0;S<8;S++){var M=this.sampleCurveX(v)-l;if(Math.abs(M)<h)return v;var k=this.sampleCurveDerivativeX(v);if(Math.abs(k)<1e-6)break;v-=M/k}var B=0,V=1;for(v=l,S=0;S<20&&(M=this.sampleCurveX(v),!(Math.abs(M-l)<h));S++)l>M?B=v:V=v,v=.5*(V-B)+B;return v},solve:function(l,h){return this.sampleCurveY(this.solveCurveX(l,h))}},Lr})(),qn=sr(Nn);class Un{constructor(l,h,v,S,M){this.type=l,this.operator=h,this.interpolation=v,this.input=S,this.labels=[],this.outputs=[];for(const[k,B]of M)this.labels.push(k),this.outputs.push(B)}static interpolationFactor(l,h,v,S){let M=0;if(l.name==="exponential")M=ui(h,l.base,v,S);else if(l.name==="linear")M=ui(h,1,v,S);else if(l.name==="cubic-bezier"){const k=l.controlPoints;M=new qn(k[0],k[1],k[2],k[3]).solve(ui(h,1,v,S))}return M}static parse(l,h){let[v,S,M,...k]=l;if(!Array.isArray(S)||S.length===0)return h.error("Expected an interpolation type expression.",1);if(S[0]==="linear")S={name:"linear"};else if(S[0]==="exponential"){const Z=S[1];if(typeof Z!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);S={name:"exponential",base:Z}}else{if(S[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(S[0])}`,1,0);{const Z=S.slice(1);if(Z.length!==4||Z.some((ie=>typeof ie!="number"||ie<0||ie>1)))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);S={name:"cubic-bezier",controlPoints:Z}}}if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(M=h.parse(M,2,Fr),!M)return null;const B=[];let V=null;v!=="interpolate-hcl"&&v!=="interpolate-lab"||h.expectedType==Ca?h.expectedType&&h.expectedType.kind!=="value"&&(V=h.expectedType):V=ei;for(let Z=0;Z<k.length;Z+=2){const ie=k[Z],ce=k[Z+1],_e=Z+3,Se=Z+4;if(typeof ie!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',_e);if(B.length&&B[B.length-1][0]>=ie)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',_e);const Le=h.parse(ce,Se,V);if(!Le)return null;V=V||Le.type,B.push([ie,Le])}return Aa(V,Fr)||Aa(V,ua)||Aa(V,ei)||Aa(V,ds)||Aa(V,Do)||Aa(V,Ca)||Aa(V,sl)||Aa(V,xi(Fr))?new Un(V,v,S,M,B):h.error(`Type ${zi(V)} is not interpolatable.`)}evaluate(l){const h=this.labels,v=this.outputs;if(h.length===1)return v[0].evaluate(l);const S=this.input.evaluate(l);if(S<=h[0])return v[0].evaluate(l);const M=h.length;if(S>=h[M-1])return v[M-1].evaluate(l);const k=bt(h,S),B=Un.interpolationFactor(this.interpolation,S,h[k],h[k+1]),V=v[k].evaluate(l),Z=v[k+1].evaluate(l);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Gr(V,Z,B);case"color":return Mr.interpolate(V,Z,B);case"padding":return Rr.interpolate(V,Z,B);case"colorArray":return mn.interpolate(V,Z,B);case"numberArray":return fn.interpolate(V,Z,B);case"variableAnchorOffsetCollection":return ba.interpolate(V,Z,B);case"array":return an(V,Z,B);case"projectionDefinition":return hi.interpolate(V,Z,B)}case"interpolate-hcl":switch(this.type.kind){case"color":return Mr.interpolate(V,Z,B,"hcl");case"colorArray":return mn.interpolate(V,Z,B,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Mr.interpolate(V,Z,B,"lab");case"colorArray":return mn.interpolate(V,Z,B,"lab")}}}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every((l=>l.outputDefined()))}}function ui(p,l,h,v){const S=v-h,M=p-h;return S===0?0:l===1?M/S:(Math.pow(l,M)-1)/(Math.pow(l,S)-1)}const Hn={color:Mr.interpolate,number:Gr,padding:Rr.interpolate,numberArray:fn.interpolate,colorArray:mn.interpolate,variableAnchorOffsetCollection:ba.interpolate,array:an};class Ui{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");let v=null;const S=h.expectedType;S&&S.kind!=="value"&&(v=S);const M=[];for(const B of l.slice(1)){const V=h.parse(B,1+M.length,v,void 0,{typeAnnotation:"omit"});if(!V)return null;v=v||V.type,M.push(V)}if(!v)throw new Error("No output type");const k=S&&M.some((B=>ma(S,B.type)));return new Ui(k?zn:v,M)}evaluate(l){let h,v=null,S=0;for(const M of this.args)if(S++,v=M.evaluate(l),v&&v instanceof wi&&!v.available&&(h||(h=v.name),v=null,S===this.args.length&&(v=h)),v!==null)break;return v}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every((l=>l.outputDefined()))}}function Xi(p,l){return p==="=="||p==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function ra(p,l,h,v){return v.compare(l,h)===0}function Si(p,l,h){const v=p!=="=="&&p!=="!=";return class UW{constructor(M,k,B){this.type=Bn,this.lhs=M,this.rhs=k,this.collator=B,this.hasUntypedArgument=M.type.kind==="value"||k.type.kind==="value"}static parse(M,k){if(M.length!==3&&M.length!==4)return k.error("Expected two or three arguments.");const B=M[0];let V=k.parse(M[1],1,zn);if(!V)return null;if(!Xi(B,V.type))return k.concat(1).error(`"${B}" comparisons are not supported for type '${zi(V.type)}'.`);let Z=k.parse(M[2],2,zn);if(!Z)return null;if(!Xi(B,Z.type))return k.concat(2).error(`"${B}" comparisons are not supported for type '${zi(Z.type)}'.`);if(V.type.kind!==Z.type.kind&&V.type.kind!=="value"&&Z.type.kind!=="value")return k.error(`Cannot compare types '${zi(V.type)}' and '${zi(Z.type)}'.`);v&&(V.type.kind==="value"&&Z.type.kind!=="value"?V=new Ka(Z.type,[V]):V.type.kind!=="value"&&Z.type.kind==="value"&&(Z=new Ka(V.type,[Z])));let ie=null;if(M.length===4){if(V.type.kind!=="string"&&Z.type.kind!=="string"&&V.type.kind!=="value"&&Z.type.kind!=="value")return k.error("Cannot use collator to compare non-string types.");if(ie=k.parse(M[3],3,Na),!ie)return null}return new UW(V,Z,ie)}evaluate(M){const k=this.lhs.evaluate(M),B=this.rhs.evaluate(M);if(v&&this.hasUntypedArgument){const V=Ri(k),Z=Ri(B);if(V.kind!==Z.kind||V.kind!=="string"&&V.kind!=="number")throw new fi(`Expected arguments for "${p}" to be (string, string) or (number, number), but found (${V.kind}, ${Z.kind}) instead.`)}if(this.collator&&!v&&this.hasUntypedArgument){const V=Ri(k),Z=Ri(B);if(V.kind!=="string"||Z.kind!=="string")return l(M,k,B)}return this.collator?h(M,k,B,this.collator.evaluate(M)):l(M,k,B)}eachChild(M){M(this.lhs),M(this.rhs),this.collator&&M(this.collator)}outputDefined(){return!0}}}const Ia=Si("==",(function(p,l,h){return l===h}),ra),za=Si("!=",(function(p,l,h){return l!==h}),(function(p,l,h,v){return!ra(0,l,h,v)})),Gs=Si("<",(function(p,l,h){return l<h}),(function(p,l,h,v){return v.compare(l,h)<0})),ul=Si(">",(function(p,l,h){return l>h}),(function(p,l,h,v){return v.compare(l,h)>0})),Ws=Si("<=",(function(p,l,h){return l<=h}),(function(p,l,h,v){return v.compare(l,h)<=0})),$o=Si(">=",(function(p,l,h){return l>=h}),(function(p,l,h,v){return v.compare(l,h)>=0}));class Xs{constructor(l,h,v){this.type=Na,this.locale=v,this.caseSensitive=l,this.diacriticSensitive=h}static parse(l,h){if(l.length!==2)return h.error("Expected one argument.");const v=l[1];if(typeof v!="object"||Array.isArray(v))return h.error("Collator options argument must be an object.");const S=h.parse(v["case-sensitive"]!==void 0&&v["case-sensitive"],1,Bn);if(!S)return null;const M=h.parse(v["diacritic-sensitive"]!==void 0&&v["diacritic-sensitive"],1,Bn);if(!M)return null;let k=null;return v.locale&&(k=h.parse(v.locale,1,Rn),!k)?null:new Xs(S,M,k)}evaluate(l){return new ti(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class Pa{constructor(l,h,v,S,M){this.type=Rn,this.number=l,this.locale=h,this.currency=v,this.minFractionDigits=S,this.maxFractionDigits=M}static parse(l,h){if(l.length!==3)return h.error("Expected two arguments.");const v=h.parse(l[1],1,Fr);if(!v)return null;const S=l[2];if(typeof S!="object"||Array.isArray(S))return h.error("NumberFormat options argument must be an object.");let M=null;if(S.locale&&(M=h.parse(S.locale,1,Rn),!M))return null;let k=null;if(S.currency&&(k=h.parse(S.currency,1,Rn),!k))return null;let B=null;if(S["min-fraction-digits"]&&(B=h.parse(S["min-fraction-digits"],1,Fr),!B))return null;let V=null;return S["max-fraction-digits"]&&(V=h.parse(S["max-fraction-digits"],1,Fr),!V)?null:new Pa(v,M,k,B,V)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class Ys{constructor(l){this.type=Wi,this.sections=l}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const v=l[1];if(!Array.isArray(v)&&typeof v=="object")return h.error("First argument must be an image or text section.");const S=[];let M=!1;for(let k=1;k<=l.length-1;++k){const B=l[k];if(M&&typeof B=="object"&&!Array.isArray(B)){M=!1;let V=null;if(B["font-scale"]&&(V=h.parse(B["font-scale"],1,Fr),!V))return null;let Z=null;if(B["text-font"]&&(Z=h.parse(B["text-font"],1,xi(Rn)),!Z))return null;let ie=null;if(B["text-color"]&&(ie=h.parse(B["text-color"],1,ei),!ie))return null;let ce=null;if(B["vertical-align"]){if(typeof B["vertical-align"]=="string"&&!ki.includes(B["vertical-align"]))return h.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${B["vertical-align"]}' instead.`);if(ce=h.parse(B["vertical-align"],1,Rn),!ce)return null}const _e=S[S.length-1];_e.scale=V,_e.font=Z,_e.textColor=ie,_e.verticalAlign=ce}else{const V=h.parse(l[k],1,zn);if(!V)return null;const Z=V.type.kind;if(Z!=="string"&&Z!=="value"&&Z!=="null"&&Z!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");M=!0,S.push({content:V,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Ys(S)}evaluate(l){return new _n(this.sections.map((h=>{const v=h.content.evaluate(l);return Ri(v)===Ya?new $n("",v,null,null,null,h.verticalAlign?h.verticalAlign.evaluate(l):null):new $n(As(v),null,h.scale?h.scale.evaluate(l):null,h.font?h.font.evaluate(l).join(","):null,h.textColor?h.textColor.evaluate(l):null,h.verticalAlign?h.verticalAlign.evaluate(l):null)})))}eachChild(l){for(const h of this.sections)l(h.content),h.scale&&l(h.scale),h.font&&l(h.font),h.textColor&&l(h.textColor),h.verticalAlign&&l(h.verticalAlign)}outputDefined(){return!1}}class Il{constructor(l){this.type=Ya,this.input=l}static parse(l,h){if(l.length!==2)return h.error("Expected two arguments.");const v=h.parse(l[1],1,Rn);return v?new Il(v):h.error("No image name provided.")}evaluate(l){const h=this.input.evaluate(l),v=wi.fromString(h);return v&&l.availableImages&&(v.available=l.availableImages.indexOf(h)>-1),v}eachChild(l){l(this.input)}outputDefined(){return!1}}class ms{constructor(l){this.type=Fr,this.input=l}static parse(l,h){if(l.length!==2)return h.error(`Expected 1 argument, but found ${l.length-1} instead.`);const v=h.parse(l[1],1);return v?v.type.kind!=="array"&&v.type.kind!=="string"&&v.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${zi(v.type)} instead.`):new ms(v):null}evaluate(l){const h=this.input.evaluate(l);if(typeof h=="string")return[...h].length;if(Array.isArray(h))return h.length;throw new fi(`Expected value to be of type string or array, but found ${zi(Ri(h))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const Di=8192;function qo(p,l){const h=(180+p[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+p[1]*Math.PI/360)))/360,S=Math.pow(2,l.z);return[Math.round(h*S*Di),Math.round(v*S*Di)]}function Da(p,l){const h=Math.pow(2,l.z);return[(S=(p[0]/Di+l.x)/h,360*S-180),(v=(p[1]/Di+l.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*v)*Math.PI/180))-90)];var v,S}function is(p,l){p[0]=Math.min(p[0],l[0]),p[1]=Math.min(p[1],l[1]),p[2]=Math.max(p[2],l[0]),p[3]=Math.max(p[3],l[1])}function Is(p,l){return!(p[0]<=l[0]||p[2]>=l[2]||p[1]<=l[1]||p[3]>=l[3])}function Ja(p,l,h){const v=p[0]-l[0],S=p[1]-l[1],M=p[0]-h[0],k=p[1]-h[1];return v*k-M*S==0&&v*M<=0&&S*k<=0}function nc(p,l,h,v){return(S=[v[0]-h[0],v[1]-h[1]])[0]*(M=[l[0]-p[0],l[1]-p[1]])[1]-S[1]*M[0]!=0&&!(!ac(p,l,h,v)||!ac(h,v,p,l));var S,M}function uu(p,l,h){for(const v of h)for(let S=0;S<v.length-1;++S)if(nc(p,l,v[S],v[S+1]))return!0;return!1}function Zs(p,l,h=!1){let v=!1;for(const B of l)for(let V=0;V<B.length-1;V++){if(Ja(p,B[V],B[V+1]))return h;(M=B[V])[1]>(S=p)[1]!=(k=B[V+1])[1]>S[1]&&S[0]<(k[0]-M[0])*(S[1]-M[1])/(k[1]-M[1])+M[0]&&(v=!v)}var S,M,k;return v}function ja(p,l){for(const h of l)if(Zs(p,h))return!0;return!1}function Ps(p,l){for(const h of p)if(!Zs(h,l))return!1;for(let h=0;h<p.length-1;++h)if(uu(p[h],p[h+1],l))return!1;return!0}function ic(p,l){for(const h of l)if(Ps(p,h))return!0;return!1}function ac(p,l,h,v){const S=v[0]-h[0],M=v[1]-h[1],k=(p[0]-h[0])*M-S*(p[1]-h[1]),B=(l[0]-h[0])*M-S*(l[1]-h[1]);return k>0&&B<0||k<0&&B>0}function cl(p,l,h){const v=[];for(let S=0;S<p.length;S++){const M=[];for(let k=0;k<p[S].length;k++){const B=qo(p[S][k],h);is(l,B),M.push(B)}v.push(M)}return v}function cu(p,l,h){const v=[];for(let S=0;S<p.length;S++){const M=cl(p[S],l,h);v.push(M)}return v}function Lo(p,l,h,v){if(p[0]<h[0]||p[0]>h[2]){const S=.5*v;let M=p[0]-h[0]>S?-v:h[0]-p[0]>S?v:0;M===0&&(M=p[0]-h[2]>S?-v:h[2]-p[0]>S?v:0),p[0]+=M}is(l,p)}function mo(p,l,h,v){const S=Math.pow(2,v.z)*Di,M=[v.x*Di,v.y*Di],k=[];for(const B of p)for(const V of B){const Z=[V.x+M[0],V.y+M[1]];Lo(Z,l,h,S),k.push(Z)}return k}function Du(p,l,h,v){const S=Math.pow(2,v.z)*Di,M=[v.x*Di,v.y*Di],k=[];for(const V of p){const Z=[];for(const ie of V){const ce=[ie.x+M[0],ie.y+M[1]];is(l,ce),Z.push(ce)}k.push(Z)}if(l[2]-l[0]<=S/2){(B=l)[0]=B[1]=1/0,B[2]=B[3]=-1/0;for(const V of k)for(const Z of V)Lo(Z,l,h,S)}var B;return k}class Ua{constructor(l,h){this.type=Bn,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if($s(l[1])){const v=l[1];if(v.type==="FeatureCollection"){const S=[];for(const M of v.features){const{type:k,coordinates:B}=M.geometry;k==="Polygon"&&S.push(B),k==="MultiPolygon"&&S.push(...B)}if(S.length)return new Ua(v,{type:"MultiPolygon",coordinates:S})}else if(v.type==="Feature"){const S=v.geometry.type;if(S==="Polygon"||S==="MultiPolygon")return new Ua(v,v.geometry)}else if(v.type==="Polygon"||v.type==="MultiPolygon")return new Ua(v,v)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return(function(h,v){const S=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(v.type==="Polygon"){const B=cl(v.coordinates,M,k),V=mo(h.geometry(),S,M,k);if(!Is(S,M))return!1;for(const Z of V)if(!Zs(Z,B))return!1}if(v.type==="MultiPolygon"){const B=cu(v.coordinates,M,k),V=mo(h.geometry(),S,M,k);if(!Is(S,M))return!1;for(const Z of V)if(!ja(Z,B))return!1}return!0})(l,this.geometries);if(l.geometryType()==="LineString")return(function(h,v){const S=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(v.type==="Polygon"){const B=cl(v.coordinates,M,k),V=Du(h.geometry(),S,M,k);if(!Is(S,M))return!1;for(const Z of V)if(!Ps(Z,B))return!1}if(v.type==="MultiPolygon"){const B=cu(v.coordinates,M,k),V=Du(h.geometry(),S,M,k);if(!Is(S,M))return!1;for(const Z of V)if(!ic(Z,B))return!1}return!0})(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let fu=class{constructor(p=[],l=(h,v)=>h<v?-1:h>v?1:0){if(this.data=p,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(p){this.data.push(p),this._up(this.length++)}pop(){if(this.length===0)return;const p=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),p}peek(){return this.data[0]}_up(p){const{data:l,compare:h}=this,v=l[p];for(;p>0;){const S=p-1>>1,M=l[S];if(h(v,M)>=0)break;l[p]=M,p=S}l[p]=v}_down(p){const{data:l,compare:h}=this,v=this.length>>1,S=l[p];for(;p<v;){let M=1+(p<<1);const k=M+1;if(k<this.length&&h(l[k],l[M])<0&&(M=k),h(l[M],S)>=0)break;l[p]=l[M],p=M}l[p]=S}};function Ks(p,l,h=0,v=p.length-1,S=Va){for(;v>h;){if(v-h>600){const V=v-h+1,Z=l-h+1,ie=Math.log(V),ce=.5*Math.exp(2*ie/3),_e=.5*Math.sqrt(ie*ce*(V-ce)/V)*(Z-V/2<0?-1:1);Ks(p,l,Math.max(h,Math.floor(l-Z*ce/V+_e)),Math.min(v,Math.floor(l+(V-Z)*ce/V+_e)),S)}const M=p[l];let k=h,B=v;for(ys(p,h,l),S(p[v],M)>0&&ys(p,h,v);k<B;){for(ys(p,k,B),k++,B--;S(p[k],M)<0;)k++;for(;S(p[B],M)>0;)B--}S(p[h],M)===0?ys(p,h,B):(B++,ys(p,B,v)),B<=l&&(h=B+1),l<=B&&(v=B-1)}}function ys(p,l,h){const v=p[l];p[l]=p[h],p[h]=v}function Va(p,l){return p<l?-1:p>l?1:0}function Vl(p,l){if(p.length<=1)return[p];const h=[];let v,S;for(const M of p){const k=hl(M);k!==0&&(M.area=Math.abs(k),S===void 0&&(S=k<0),S===k<0?(v&&h.push(v),v=[M]):v.push(M))}if(v&&h.push(v),l>1)for(let M=0;M<h.length;M++)h[M].length<=l||(Ks(h[M],l,1,h[M].length-1,fl),h[M]=h[M].slice(0,l));return h}function fl(p,l){return l.area-p.area}function hl(p){let l=0;for(let h,v,S=0,M=p.length,k=M-1;S<M;k=S++)h=p[S],v=p[k],l+=(v.x-h.x)*(h.y+v.y);return l}const $l=1/298.257223563,ql=$l*(2-$l),dl=Math.PI/180;class Hl{constructor(l){const h=6378.137*dl*1e3,v=Math.cos(l*dl),S=1/(1-ql*(1-v*v)),M=Math.sqrt(S);this.kx=h*M*v,this.ky=h*M*S*(1-ql)}distance(l,h){const v=this.wrap(l[0]-h[0])*this.kx,S=(l[1]-h[1])*this.ky;return Math.sqrt(v*v+S*S)}pointOnLine(l,h){let v,S,M,k,B=1/0;for(let V=0;V<l.length-1;V++){let Z=l[V][0],ie=l[V][1],ce=this.wrap(l[V+1][0]-Z)*this.kx,_e=(l[V+1][1]-ie)*this.ky,Se=0;ce===0&&_e===0||(Se=(this.wrap(h[0]-Z)*this.kx*ce+(h[1]-ie)*this.ky*_e)/(ce*ce+_e*_e),Se>1?(Z=l[V+1][0],ie=l[V+1][1]):Se>0&&(Z+=ce/this.kx*Se,ie+=_e/this.ky*Se)),ce=this.wrap(h[0]-Z)*this.kx,_e=(h[1]-ie)*this.ky;const Le=ce*ce+_e*_e;Le<B&&(B=Le,v=Z,S=ie,M=V,k=Se)}return{point:[v,S],index:M,t:Math.max(0,Math.min(1,k))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}function Ou(p,l){return l[0]-p[0]}function tr(p){return p[1]-p[0]+1}function mr(p,l){return p[1]>=p[0]&&p[1]<l}function hn(p,l){if(p[0]>p[1])return[null,null];const h=tr(p);if(l){if(h===2)return[p,null];const S=Math.floor(h/2);return[[p[0],p[0]+S],[p[0]+S,p[1]]]}if(h===1)return[p,null];const v=Math.floor(h/2)-1;return[[p[0],p[0]+v],[p[0]+v+1,p[1]]]}function In(p,l){if(!mr(l,p.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let v=l[0];v<=l[1];++v)is(h,p[v]);return h}function vi(p){const l=[1/0,1/0,-1/0,-1/0];for(const h of p)for(const v of h)is(l,v);return l}function Pn(p){return p[0]!==-1/0&&p[1]!==-1/0&&p[2]!==1/0&&p[3]!==1/0}function I(p,l,h){if(!Pn(p)||!Pn(l))return NaN;let v=0,S=0;return p[2]<l[0]&&(v=l[0]-p[2]),p[0]>l[2]&&(v=p[0]-l[2]),p[1]>l[3]&&(S=p[1]-l[3]),p[3]<l[1]&&(S=l[1]-p[3]),h.distance([0,0],[v,S])}function y(p,l,h){const v=h.pointOnLine(l,p);return h.distance(p,v.point)}function _(p,l,h,v,S){const M=Math.min(y(p,[h,v],S),y(l,[h,v],S)),k=Math.min(y(h,[p,l],S),y(v,[p,l],S));return Math.min(M,k)}function P(p,l,h,v,S){if(!mr(l,p.length)||!mr(v,h.length))return 1/0;let M=1/0;for(let k=l[0];k<l[1];++k){const B=p[k],V=p[k+1];for(let Z=v[0];Z<v[1];++Z){const ie=h[Z],ce=h[Z+1];if(nc(B,V,ie,ce))return 0;M=Math.min(M,_(B,V,ie,ce,S))}}return M}function $(p,l,h,v,S){if(!mr(l,p.length)||!mr(v,h.length))return NaN;let M=1/0;for(let k=l[0];k<=l[1];++k)for(let B=v[0];B<=v[1];++B)if(M=Math.min(M,S.distance(p[k],h[B])),M===0)return M;return M}function ne(p,l,h){if(Zs(p,l,!0))return 0;let v=1/0;for(const S of l){const M=S[0],k=S[S.length-1];if(M!==k&&(v=Math.min(v,y(p,[k,M],h)),v===0))return v;const B=h.pointOnLine(S,p);if(v=Math.min(v,h.distance(p,B.point)),v===0)return v}return v}function ve(p,l,h,v){if(!mr(l,p.length))return NaN;for(let M=l[0];M<=l[1];++M)if(Zs(p[M],h,!0))return 0;let S=1/0;for(let M=l[0];M<l[1];++M){const k=p[M],B=p[M+1];for(const V of h)for(let Z=0,ie=V.length,ce=ie-1;Z<ie;ce=Z++){const _e=V[ce],Se=V[Z];if(nc(k,B,_e,Se))return 0;S=Math.min(S,_(k,B,_e,Se,v))}}return S}function Oe(p,l){for(const h of p)for(const v of h)if(Zs(v,l,!0))return!0;return!1}function tt(p,l,h,v=1/0){const S=vi(p),M=vi(l);if(v!==1/0&&I(S,M,h)>=v)return v;if(Is(S,M)){if(Oe(p,l))return 0}else if(Oe(l,p))return 0;let k=1/0;for(const B of p)for(let V=0,Z=B.length,ie=Z-1;V<Z;ie=V++){const ce=B[ie],_e=B[V];for(const Se of l)for(let Le=0,ze=Se.length,Ve=ze-1;Le<ze;Ve=Le++){const et=Se[Ve],Ct=Se[Le];if(nc(ce,_e,et,Ct))return 0;k=Math.min(k,_(ce,_e,et,Ct,h))}}return k}function ft(p,l,h,v,S,M){if(!M)return;const k=I(In(v,M),S,h);k<l&&p.push([k,M,[0,0]])}function rr(p,l,h,v,S,M,k){if(!M||!k)return;const B=I(In(v,M),In(S,k),h);B<l&&p.push([B,M,k])}function ur(p,l,h,v,S=1/0){let M=Math.min(v.distance(p[0],h[0][0]),S);if(M===0)return M;const k=new fu([[0,[0,p.length-1],[0,0]]],Ou),B=vi(h);for(;k.length>0;){const V=k.pop();if(V[0]>=M)continue;const Z=V[1],ie=l?50:100;if(tr(Z)<=ie){if(!mr(Z,p.length))return NaN;if(l){const ce=ve(p,Z,h,v);if(isNaN(ce)||ce===0)return ce;M=Math.min(M,ce)}else for(let ce=Z[0];ce<=Z[1];++ce){const _e=ne(p[ce],h,v);if(M=Math.min(M,_e),M===0)return 0}}else{const ce=hn(Z,l);ft(k,M,v,p,B,ce[0]),ft(k,M,v,p,B,ce[1])}}return M}function qr(p,l,h,v,S,M=1/0){let k=Math.min(M,S.distance(p[0],h[0]));if(k===0)return k;const B=new fu([[0,[0,p.length-1],[0,h.length-1]]],Ou);for(;B.length>0;){const V=B.pop();if(V[0]>=k)continue;const Z=V[1],ie=V[2],ce=l?50:100,_e=v?50:100;if(tr(Z)<=ce&&tr(ie)<=_e){if(!mr(Z,p.length)&&mr(ie,h.length))return NaN;let Se;if(l&&v)Se=P(p,Z,h,ie,S),k=Math.min(k,Se);else if(l&&!v){const Le=p.slice(Z[0],Z[1]+1);for(let ze=ie[0];ze<=ie[1];++ze)if(Se=y(h[ze],Le,S),k=Math.min(k,Se),k===0)return k}else if(!l&&v){const Le=h.slice(ie[0],ie[1]+1);for(let ze=Z[0];ze<=Z[1];++ze)if(Se=y(p[ze],Le,S),k=Math.min(k,Se),k===0)return k}else Se=$(p,Z,h,ie,S),k=Math.min(k,Se)}else{const Se=hn(Z,l),Le=hn(ie,v);rr(B,k,S,p,h,Se[0],Le[0]),rr(B,k,S,p,h,Se[0],Le[1]),rr(B,k,S,p,h,Se[1],Le[0]),rr(B,k,S,p,h,Se[1],Le[1])}}return k}function bn(p){return p.type==="MultiPolygon"?p.coordinates.map((l=>({type:"Polygon",coordinates:l}))):p.type==="MultiLineString"?p.coordinates.map((l=>({type:"LineString",coordinates:l}))):p.type==="MultiPoint"?p.coordinates.map((l=>({type:"Point",coordinates:l}))):[p]}class Dn{constructor(l,h){this.type=Fr,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if($s(l[1])){const v=l[1];if(v.type==="FeatureCollection")return new Dn(v,v.features.map((S=>bn(S.geometry))).flat());if(v.type==="Feature")return new Dn(v,bn(v.geometry));if("type"in v&&"coordinates"in v)return new Dn(v,bn(v))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return(function(h,v){const S=h.geometry(),M=S.flat().map((V=>Da([V.x,V.y],h.canonical)));if(S.length===0)return NaN;const k=new Hl(M[0][1]);let B=1/0;for(const V of v){switch(V.type){case"Point":B=Math.min(B,qr(M,!1,[V.coordinates],!1,k,B));break;case"LineString":B=Math.min(B,qr(M,!1,V.coordinates,!0,k,B));break;case"Polygon":B=Math.min(B,ur(M,!1,V.coordinates,k,B))}if(B===0)return B}return B})(l,this.geometries);if(l.geometryType()==="LineString")return(function(h,v){const S=h.geometry(),M=S.flat().map((V=>Da([V.x,V.y],h.canonical)));if(S.length===0)return NaN;const k=new Hl(M[0][1]);let B=1/0;for(const V of v){switch(V.type){case"Point":B=Math.min(B,qr(M,!0,[V.coordinates],!1,k,B));break;case"LineString":B=Math.min(B,qr(M,!0,V.coordinates,!0,k,B));break;case"Polygon":B=Math.min(B,ur(M,!0,V.coordinates,k,B))}if(B===0)return B}return B})(l,this.geometries);if(l.geometryType()==="Polygon")return(function(h,v){const S=h.geometry();if(S.length===0||S[0].length===0)return NaN;const M=Vl(S,0).map((V=>V.map((Z=>Z.map((ie=>Da([ie.x,ie.y],h.canonical))))))),k=new Hl(M[0][0][0][1]);let B=1/0;for(const V of v)for(const Z of M){switch(V.type){case"Point":B=Math.min(B,ur([V.coordinates],!1,Z,k,B));break;case"LineString":B=Math.min(B,ur(V.coordinates,!0,Z,k,B));break;case"Polygon":B=Math.min(B,tt(Z,V.coordinates,k,B))}if(B===0)return B}return B})(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Xn{constructor(l){this.type=zn,this.key=l}static parse(l,h){if(l.length!==2)return h.error(`Expected 1 argument, but found ${l.length-1} instead.`);const v=l[1];return v==null?h.error("Global state property must be defined."):typeof v!="string"?h.error(`Global state property must be string, but found ${typeof l[1]} instead.`):new Xn(v)}evaluate(l){var h;const v=(h=l.globals)===null||h===void 0?void 0:h.globalState;return v&&Object.keys(v).length!==0?It(v,this.key):null}eachChild(){}outputDefined(){return!1}}const Fn={"==":Ia,"!=":za,">":ul,"<":Gs,">=":$o,"<=":Ws,array:Ka,at:ii,boolean:Ka,case:ue,coalesce:Ui,collator:Xs,format:Ys,image:Il,in:ri,"index-of":Oo,interpolate:Un,"interpolate-hcl":Un,"interpolate-lab":Un,length:ms,let:ji,literal:oa,match:ai,number:Ka,"number-format":Pa,object:Ka,slice:We,step:Bt,string:Ka,"to-boolean":Vo,"to-color":Vo,"to-number":Vo,"to-string":Vo,var:Hs,within:Ua,distance:Dn,"global-state":Xn};class En{constructor(l,h,v,S){this.name=l,this.type=h,this._evaluate=v,this.args=S}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,h){const v=l[0],S=En.definitions[v];if(!S)return h.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0);const M=Array.isArray(S)?S[0]:S.type,k=Array.isArray(S)?[[S[1],S[2]]]:S.overloads,B=k.filter((([Z])=>!Array.isArray(Z)||Z.length===l.length-1));let V=null;for(const[Z,ie]of B){V=new go(h.registry,Ho,h.path,null,h.scope);const ce=[];let _e=!1;for(let Se=1;Se<l.length;Se++){const Le=l[Se],ze=Array.isArray(Z)?Z[Se-1]:Z.type,Ve=V.parse(Le,1+ce.length,ze);if(!Ve){_e=!0;break}ce.push(Ve)}if(!_e)if(Array.isArray(Z)&&Z.length!==ce.length)V.error(`Expected ${Z.length} arguments, but found ${ce.length} instead.`);else{for(let Se=0;Se<ce.length;Se++){const Le=Array.isArray(Z)?Z[Se]:Z.type,ze=ce[Se];V.concat(Se+1).checkSubtype(Le,ze.type)}if(V.errors.length===0)return new En(v,M,ie,ce)}}if(B.length===1)h.errors.push(...V.errors);else{const Z=(B.length?B:k).map((([ce])=>{return _e=ce,Array.isArray(_e)?`(${_e.map(zi).join(", ")})`:`(${zi(_e.type)}...)`;var _e})).join(" | "),ie=[];for(let ce=1;ce<l.length;ce++){const _e=h.parse(l[ce],1+ie.length);if(!_e)return null;ie.push(zi(_e.type))}h.error(`Expected arguments of type ${Z}, but found (${ie.join(", ")}) instead.`)}return null}static register(l,h){En.definitions=h;for(const v in h)l[v]=En}}function na(p,[l,h,v,S]){l=l.evaluate(p),h=h.evaluate(p),v=v.evaluate(p);const M=S?S.evaluate(p):1,k=Cs(l,h,v,M);if(k)throw new fi(k);return new Mr(l/255,h/255,v/255,M,!1)}function ca(p,l){return p in l}function lo(p,l){const h=l[p];return h===void 0?null:h}function Ma(p){return{type:p}}function Ho(p){if(p instanceof Hs)return Ho(p.boundExpression);if(p instanceof En&&p.name==="error"||p instanceof Xs||p instanceof Ua||p instanceof Dn||p instanceof Xn)return!1;const l=p instanceof Vo||p instanceof Ka;let h=!0;return p.eachChild((v=>{h=l?h&&Ho(v):h&&v instanceof oa})),!!h&&Js(p)&&hu(p,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Js(p){if(p instanceof En&&(p.name==="get"&&p.args.length===1||p.name==="feature-state"||p.name==="has"&&p.args.length===1||p.name==="properties"||p.name==="geometry-type"||p.name==="id"||/^filter-/.test(p.name))||p instanceof Ua||p instanceof Dn)return!1;let l=!0;return p.eachChild((h=>{l&&!Js(h)&&(l=!1)})),l}function Pl(p){if(p instanceof En&&p.name==="feature-state")return!1;let l=!0;return p.eachChild((h=>{l&&!Pl(h)&&(l=!1)})),l}function hu(p,l){if(p instanceof En&&l.indexOf(p.name)>=0)return!1;let h=!0;return p.eachChild((v=>{h&&!hu(v,l)&&(h=!1)})),h}function du(p){return{result:"success",value:p}}function Ms(p){return{result:"error",value:p}}function Gl(p){return p["property-type"]==="data-driven"||p["property-type"]==="cross-faded-data-driven"}function Wl(p){return!!p.expression&&p.expression.parameters.indexOf("zoom")>-1}function To(p){return!!p.expression&&p.expression.interpolated}function ni(p){return p instanceof Number?"number":p instanceof String?"string":p instanceof Boolean?"boolean":Array.isArray(p)?"array":p===null?"null":typeof p}function Lu(p){return typeof p=="object"&&p!==null&&!Array.isArray(p)&&Ri(p)===ha}function eh(p){return p}function yf(p,l){const h=p.stops&&typeof p.stops[0][0]=="object",v=h||!(h||p.property!==void 0),S=p.type||(To(l)?"exponential":"interval"),M=(function(ie){switch(ie.type){case"color":return Mr.parse;case"padding":return Rr.parse;case"numberArray":return fn.parse;case"colorArray":return mn.parse;default:return null}})(l);if(M&&((p=Xr({},p)).stops&&(p.stops=p.stops.map((ie=>[ie[0],M(ie[1])]))),p.default=M(p.default?p.default:l.default)),p.colorSpace&&(k=p.colorSpace)!=="rgb"&&k!=="hcl"&&k!=="lab")throw new Error(`Unknown color space: "${p.colorSpace}"`);var k;const B=(function(ie){switch(ie){case"exponential":return $g;case"interval":return Vg;case"categorical":return kp;case"identity":return qg;default:throw new Error(`Unknown function type "${ie}"`)}})(S);let V,Z;if(S==="categorical"){V=Object.create(null);for(const ie of p.stops)V[ie[0]]=ie[1];Z=typeof p.stops[0][0]}if(h){const ie={},ce=[];for(let Le=0;Le<p.stops.length;Le++){const ze=p.stops[Le],Ve=ze[0].zoom;ie[Ve]===void 0&&(ie[Ve]={zoom:Ve,type:p.type,property:p.property,default:p.default,stops:[]},ce.push(Ve)),ie[Ve].stops.push([ze[0].value,ze[1]])}const _e=[];for(const Le of ce)_e.push([ie[Le].zoom,yf(ie[Le],l)]);const Se={name:"linear"};return{kind:"composite",interpolationType:Se,interpolationFactor:Un.interpolationFactor.bind(void 0,Se),zoomStops:_e.map((Le=>Le[0])),evaluate:({zoom:Le},ze)=>$g({stops:_e,base:p.base},l,Le).evaluate(Le,ze)}}if(v){const ie=S==="exponential"?{name:"exponential",base:p.base!==void 0?p.base:1}:null;return{kind:"camera",interpolationType:ie,interpolationFactor:Un.interpolationFactor.bind(void 0,ie),zoomStops:p.stops.map((ce=>ce[0])),evaluate:({zoom:ce})=>B(p,l,ce,V,Z)}}return{kind:"source",evaluate(ie,ce){const _e=ce&&ce.properties?ce.properties[p.property]:void 0;return _e===void 0?pu(p.default,l.default):B(p,l,_e,V,Z)}}}function pu(p,l,h){return p!==void 0?p:l!==void 0?l:h!==void 0?h:void 0}function kp(p,l,h,v,S){return pu(typeof h===S?v[h]:void 0,p.default,l.default)}function Vg(p,l,h){if(ni(h)!=="number")return pu(p.default,l.default);const v=p.stops.length;if(v===1||h<=p.stops[0][0])return p.stops[0][1];if(h>=p.stops[v-1][0])return p.stops[v-1][1];const S=bt(p.stops.map((M=>M[0])),h);return p.stops[S][1]}function $g(p,l,h){const v=p.base!==void 0?p.base:1;if(ni(h)!=="number")return pu(p.default,l.default);const S=p.stops.length;if(S===1||h<=p.stops[0][0])return p.stops[0][1];if(h>=p.stops[S-1][0])return p.stops[S-1][1];const M=bt(p.stops.map((ie=>ie[0])),h),k=(function(ie,ce,_e,Se){const Le=Se-_e,ze=ie-_e;return Le===0?0:ce===1?ze/Le:(Math.pow(ce,ze)-1)/(Math.pow(ce,Le)-1)})(h,v,p.stops[M][0],p.stops[M+1][0]),B=p.stops[M][1],V=p.stops[M+1][1],Z=Hn[l.type]||eh;return typeof B.evaluate=="function"?{evaluate(...ie){const ce=B.evaluate.apply(void 0,ie),_e=V.evaluate.apply(void 0,ie);if(ce!==void 0&&_e!==void 0)return Z(ce,_e,k,p.colorSpace)}}:Z(B,V,k,p.colorSpace)}function qg(p,l,h){switch(l.type){case"color":h=Mr.parse(h);break;case"formatted":h=_n.fromString(h.toString());break;case"resolvedImage":h=wi.fromString(h.toString());break;case"padding":h=Rr.parse(h);break;case"colorArray":h=mn.parse(h);break;case"numberArray":h=fn.parse(h);break;default:ni(h)===l.type||l.type==="enum"&&l.values[h]||(h=void 0)}return pu(h,p.default,l.default)}En.register(Fn,{error:[{kind:"error"},[Rn],(p,[l])=>{throw new fi(l.evaluate(p))}],typeof:[Rn,[zn],(p,[l])=>zi(Ri(l.evaluate(p)))],"to-rgba":[xi(Fr,4),[ei],(p,[l])=>{const[h,v,S,M]=l.evaluate(p).rgb;return[255*h,255*v,255*S,M]}],rgb:[ei,[Fr,Fr,Fr],na],rgba:[ei,[Fr,Fr,Fr,Fr],na],has:{type:Bn,overloads:[[[Rn],(p,[l])=>ca(l.evaluate(p),p.properties())],[[Rn,ha],(p,[l,h])=>ca(l.evaluate(p),h.evaluate(p))]]},get:{type:zn,overloads:[[[Rn],(p,[l])=>lo(l.evaluate(p),p.properties())],[[Rn,ha],(p,[l,h])=>lo(l.evaluate(p),h.evaluate(p))]]},"feature-state":[zn,[Rn],(p,[l])=>lo(l.evaluate(p),p.featureState||{})],properties:[ha,[],p=>p.properties()],"geometry-type":[Rn,[],p=>p.geometryType()],id:[zn,[],p=>p.id()],zoom:[Fr,[],p=>p.globals.zoom],"heatmap-density":[Fr,[],p=>p.globals.heatmapDensity||0],elevation:[Fr,[],p=>p.globals.elevation||0],"line-progress":[Fr,[],p=>p.globals.lineProgress||0],accumulated:[zn,[],p=>p.globals.accumulated===void 0?null:p.globals.accumulated],"+":[Fr,Ma(Fr),(p,l)=>{let h=0;for(const v of l)h+=v.evaluate(p);return h}],"*":[Fr,Ma(Fr),(p,l)=>{let h=1;for(const v of l)h*=v.evaluate(p);return h}],"-":{type:Fr,overloads:[[[Fr,Fr],(p,[l,h])=>l.evaluate(p)-h.evaluate(p)],[[Fr],(p,[l])=>-l.evaluate(p)]]},"/":[Fr,[Fr,Fr],(p,[l,h])=>l.evaluate(p)/h.evaluate(p)],"%":[Fr,[Fr,Fr],(p,[l,h])=>l.evaluate(p)%h.evaluate(p)],ln2:[Fr,[],()=>Math.LN2],pi:[Fr,[],()=>Math.PI],e:[Fr,[],()=>Math.E],"^":[Fr,[Fr,Fr],(p,[l,h])=>Math.pow(l.evaluate(p),h.evaluate(p))],sqrt:[Fr,[Fr],(p,[l])=>Math.sqrt(l.evaluate(p))],log10:[Fr,[Fr],(p,[l])=>Math.log(l.evaluate(p))/Math.LN10],ln:[Fr,[Fr],(p,[l])=>Math.log(l.evaluate(p))],log2:[Fr,[Fr],(p,[l])=>Math.log(l.evaluate(p))/Math.LN2],sin:[Fr,[Fr],(p,[l])=>Math.sin(l.evaluate(p))],cos:[Fr,[Fr],(p,[l])=>Math.cos(l.evaluate(p))],tan:[Fr,[Fr],(p,[l])=>Math.tan(l.evaluate(p))],asin:[Fr,[Fr],(p,[l])=>Math.asin(l.evaluate(p))],acos:[Fr,[Fr],(p,[l])=>Math.acos(l.evaluate(p))],atan:[Fr,[Fr],(p,[l])=>Math.atan(l.evaluate(p))],min:[Fr,Ma(Fr),(p,l)=>Math.min(...l.map((h=>h.evaluate(p))))],max:[Fr,Ma(Fr),(p,l)=>Math.max(...l.map((h=>h.evaluate(p))))],abs:[Fr,[Fr],(p,[l])=>Math.abs(l.evaluate(p))],round:[Fr,[Fr],(p,[l])=>{const h=l.evaluate(p);return h<0?-Math.round(-h):Math.round(h)}],floor:[Fr,[Fr],(p,[l])=>Math.floor(l.evaluate(p))],ceil:[Fr,[Fr],(p,[l])=>Math.ceil(l.evaluate(p))],"filter-==":[Bn,[Rn,zn],(p,[l,h])=>p.properties()[l.value]===h.value],"filter-id-==":[Bn,[zn],(p,[l])=>p.id()===l.value],"filter-type-==":[Bn,[Rn],(p,[l])=>p.geometryType()===l.value],"filter-<":[Bn,[Rn,zn],(p,[l,h])=>{const v=p.properties()[l.value],S=h.value;return typeof v==typeof S&&v<S}],"filter-id-<":[Bn,[zn],(p,[l])=>{const h=p.id(),v=l.value;return typeof h==typeof v&&h<v}],"filter->":[Bn,[Rn,zn],(p,[l,h])=>{const v=p.properties()[l.value],S=h.value;return typeof v==typeof S&&v>S}],"filter-id->":[Bn,[zn],(p,[l])=>{const h=p.id(),v=l.value;return typeof h==typeof v&&h>v}],"filter-<=":[Bn,[Rn,zn],(p,[l,h])=>{const v=p.properties()[l.value],S=h.value;return typeof v==typeof S&&v<=S}],"filter-id-<=":[Bn,[zn],(p,[l])=>{const h=p.id(),v=l.value;return typeof h==typeof v&&h<=v}],"filter->=":[Bn,[Rn,zn],(p,[l,h])=>{const v=p.properties()[l.value],S=h.value;return typeof v==typeof S&&v>=S}],"filter-id->=":[Bn,[zn],(p,[l])=>{const h=p.id(),v=l.value;return typeof h==typeof v&&h>=v}],"filter-has":[Bn,[zn],(p,[l])=>l.value in p.properties()],"filter-has-id":[Bn,[],p=>p.id()!==null&&p.id()!==void 0],"filter-type-in":[Bn,[xi(Rn)],(p,[l])=>l.value.indexOf(p.geometryType())>=0],"filter-id-in":[Bn,[xi(zn)],(p,[l])=>l.value.indexOf(p.id())>=0],"filter-in-small":[Bn,[Rn,xi(zn)],(p,[l,h])=>h.value.indexOf(p.properties()[l.value])>=0],"filter-in-large":[Bn,[Rn,xi(zn)],(p,[l,h])=>(function(v,S,M,k){for(;M<=k;){const B=M+k>>1;if(S[B]===v)return!0;S[B]>v?k=B-1:M=B+1}return!1})(p.properties()[l.value],h.value,0,h.value.length-1)],all:{type:Bn,overloads:[[[Bn,Bn],(p,[l,h])=>l.evaluate(p)&&h.evaluate(p)],[Ma(Bn),(p,l)=>{for(const h of l)if(!h.evaluate(p))return!1;return!0}]]},any:{type:Bn,overloads:[[[Bn,Bn],(p,[l,h])=>l.evaluate(p)||h.evaluate(p)],[Ma(Bn),(p,l)=>{for(const h of l)if(h.evaluate(p))return!0;return!1}]]},"!":[Bn,[Bn],(p,[l])=>!l.evaluate(p)],"is-supported-script":[Bn,[Rn],(p,[l])=>{const h=p.globals&&p.globals.isSupportedScript;return!h||h(l.evaluate(p))}],upcase:[Rn,[Rn],(p,[l])=>l.evaluate(p).toUpperCase()],downcase:[Rn,[Rn],(p,[l])=>l.evaluate(p).toLowerCase()],concat:[Rn,Ma(zn),(p,l)=>l.map((h=>As(h.evaluate(p)))).join("")],"resolved-locale":[Rn,[Na],(p,[l])=>l.evaluate(p).resolvedLocale()]});class Rd{constructor(l,h,v){this.expression=l,this._warningHistory={},this._evaluator=new Ru,this._defaultValue=h?(function(S){if(S.type==="color"&&Lu(S.default))return new Mr(0,0,0,0);switch(S.type){case"color":return Mr.parse(S.default)||null;case"padding":return Rr.parse(S.default)||null;case"numberArray":return fn.parse(S.default)||null;case"colorArray":return mn.parse(S.default)||null;case"variableAnchorOffsetCollection":return ba.parse(S.default)||null;case"projectionDefinition":return hi.parse(S.default)||null;default:return S.default===void 0?null:S.default}})(h):null,this._enumValues=h&&h.type==="enum"?h.values:null,this._globalState=v}evaluateWithoutErrorHandling(l,h,v,S,M,k){return this._globalState&&(l=rh(l,this._globalState)),this._evaluator.globals=l,this._evaluator.feature=h,this._evaluator.featureState=v,this._evaluator.canonical=S,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=k,this.expression.evaluate(this._evaluator)}evaluate(l,h,v,S,M,k){this._globalState&&(l=rh(l,this._globalState)),this._evaluator.globals=l,this._evaluator.feature=h||null,this._evaluator.featureState=v||null,this._evaluator.canonical=S,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=k||null;try{const B=this.expression.evaluate(this._evaluator);if(B==null||typeof B=="number"&&B!=B)return this._defaultValue;if(this._enumValues&&!(B in this._enumValues))throw new fi(`Expected value to be one of ${Object.keys(this._enumValues).map((V=>JSON.stringify(V))).join(", ")}, but found ${JSON.stringify(B)} instead.`);return B}catch(B){return this._warningHistory[B.message]||(this._warningHistory[B.message]=!0,typeof console<"u"&&console.warn(B.message)),this._defaultValue}}}function Vc(p){return Array.isArray(p)&&p.length>0&&typeof p[0]=="string"&&p[0]in Fn}function th(p,l,h){const v=new go(Fn,Ho,[],l?(function(M){const k={color:ei,string:Rn,number:Fr,enum:Rn,boolean:Bn,formatted:Wi,padding:ds,numberArray:Do,colorArray:Ca,projectionDefinition:ua,resolvedImage:Ya,variableAnchorOffsetCollection:sl};return M.type==="array"?xi(k[M.value]||zn,M.length):k[M.type]})(l):void 0),S=v.parse(p,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return S?du(new Rd(S,l,h)):Ms(v.errors)}class Rp{constructor(l,h,v){this.kind=l,this._styleExpression=h,this.isStateDependent=l!=="constant"&&!Pl(h.expression),this.globalStateRefs=vf(h.expression),this._globalState=v}evaluateWithoutErrorHandling(l,h,v,S,M,k){return this._globalState&&(l=rh(l,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(l,h,v,S,M,k)}evaluate(l,h,v,S,M,k){return this._globalState&&(l=rh(l,this._globalState)),this._styleExpression.evaluate(l,h,v,S,M,k)}}class Hg{constructor(l,h,v,S,M){this.kind=l,this.zoomStops=v,this._styleExpression=h,this.isStateDependent=l!=="camera"&&!Pl(h.expression),this.globalStateRefs=vf(h.expression),this.interpolationType=S,this._globalState=M}evaluateWithoutErrorHandling(l,h,v,S,M,k){return this._globalState&&(l=rh(l,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(l,h,v,S,M,k)}evaluate(l,h,v,S,M,k){return this._globalState&&(l=rh(l,this._globalState)),this._styleExpression.evaluate(l,h,v,S,M,k)}interpolationFactor(l,h,v){return this.interpolationType?Un.interpolationFactor(this.interpolationType,l,h,v):0}}function Dp(p,l,h){const v=th(p,l,h);if(v.result==="error")return v;const S=v.value.expression,M=Js(S);if(!M&&!Gl(l))return Ms([new Ln("","data expressions not supported")]);const k=hu(S,["zoom"]);if(!k&&!Wl(l))return Ms([new Ln("","zoom expressions not supported")]);const B=Lp(S);return B||k?B instanceof Ln?Ms([B]):B instanceof Un&&!To(l)?Ms([new Ln("",'"interpolate" expressions cannot be used with this property')]):du(B?new Hg(M?"camera":"composite",v.value,B.labels,B instanceof Un?B.interpolation:void 0,h):new Rp(M?"constant":"source",v.value,h)):Ms([new Ln("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Op{constructor(l,h){this._parameters=l,this._specification=h,Xr(this,yf(this._parameters,this._specification))}static deserialize(l){return new Op(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function Lp(p){let l=null;if(p instanceof ji)l=Lp(p.result);else if(p instanceof Ui){for(const h of p.args)if(l=Lp(h),l)break}else(p instanceof Bt||p instanceof Un)&&p.input instanceof En&&p.input.name==="zoom"&&(l=p);return l instanceof Ln||p.eachChild((h=>{const v=Lp(h);v instanceof Ln?l=v:!l&&v?l=new Ln("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&v&&l!==v&&(l=new Ln("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),l}function vf(p,l=new Set){return p instanceof Xn&&l.add(p.key),p.eachChild((h=>{vf(h,l)})),l}function rh(p,l){const{zoom:h,heatmapDensity:v,elevation:S,lineProgress:M,isSupportedScript:k,accumulated:B}=p??{};return{zoom:h,heatmapDensity:v,elevation:S,lineProgress:M,isSupportedScript:k,accumulated:B,globalState:l}}function Gg(p){if(p===!0||p===!1)return!0;if(!Array.isArray(p)||p.length===0)return!1;switch(p[0]){case"has":return p.length>=2&&p[1]!=="$id"&&p[1]!=="$type";case"in":return p.length>=3&&(typeof p[1]!="string"||Array.isArray(p[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return p.length!==3||Array.isArray(p[1])||Array.isArray(p[2]);case"any":case"all":for(const l of p.slice(1))if(!Gg(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}const Wg={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function nh(p,l){if(p==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Gg(p)||(p=Od(p));const h=th(p,Wg,l);if(h.result==="error")throw new Error(h.value.map((v=>`${v.key}: ${v.message}`)).join(", "));return{filter:(v,S,M)=>h.value.evaluate(v,S,{},M),needGeometry:Dy(p),getGlobalStateRefs:()=>vf(h.value.expression)}}function Dd(p,l){return p<l?-1:p>l?1:0}function Dy(p){if(!Array.isArray(p))return!1;if(p[0]==="within"||p[0]==="distance")return!0;for(let l=1;l<p.length;l++)if(Dy(p[l]))return!0;return!1}function Od(p){if(!p)return!0;const l=p[0];return p.length<=1?l!=="any":l==="=="?Ld(p[1],p[2],"=="):l==="!="?Nd(Ld(p[1],p[2],"==")):l==="<"||l===">"||l==="<="||l===">="?Ld(p[1],p[2],l):l==="any"?(h=p.slice(1),["any"].concat(h.map(Od))):l==="all"?["all"].concat(p.slice(1).map(Od)):l==="none"?["all"].concat(p.slice(1).map(Od).map(Nd)):l==="in"?Oy(p[1],p.slice(2)):l==="!in"?Nd(Oy(p[1],p.slice(2))):l==="has"?Ly(p[1]):l!=="!has"||Nd(Ly(p[1]));var h}function Ld(p,l,h){switch(p){case"$type":return[`filter-type-${h}`,l];case"$id":return[`filter-id-${h}`,l];default:return[`filter-${h}`,p,l]}}function Oy(p,l){if(l.length===0)return!1;switch(p){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some((h=>typeof h!=typeof l[0]))?["filter-in-large",p,["literal",l.sort(Dd)]]:["filter-in-small",p,["literal",l]]}}function Ly(p){switch(p){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",p]}}function Nd(p){return["!",p]}function Np(p){const l=typeof p;if(l==="number"||l==="boolean"||l==="string"||p==null)return JSON.stringify(p);if(Array.isArray(p)){let S="[";for(const M of p)S+=`${Np(M)},`;return`${S}]`}const h=Object.keys(p).sort();let v="{";for(let S=0;S<h.length;S++)v+=`${JSON.stringify(h[S])}:${Np(p[h[S]])},`;return`${v}}`}function $c(p){let l="";for(const h of en)l+=`/${Np(p[h])}`;return l}function Nu(p){const l=p.value;return l?[new Ut(p.key,l,"constants have been deprecated as of v8")]:[]}function xa(p){return p instanceof Number||p instanceof String||p instanceof Boolean?p.valueOf():p}function ih(p){if(Array.isArray(p))return p.map(ih);if(p instanceof Object&&!(p instanceof Number||p instanceof String||p instanceof Boolean)){const l={};for(const h in p)l[h]=ih(p[h]);return l}return xa(p)}function Xl(p){const l=p.key,h=p.value,v=p.valueSpec||{},S=p.objectElementValidators||{},M=p.style,k=p.styleSpec,B=p.validateSpec;let V=[];const Z=ni(h);if(Z!=="object")return[new Ut(l,h,`object expected, ${Z} found`)];for(const ie in h){const ce=ie.split(".")[0],_e=It(v,ce)||v["*"];let Se;if(It(S,ce))Se=S[ce];else if(It(v,ce)){if(h[ie]===void 0)continue;Se=B}else if(S["*"])Se=S["*"];else{if(!v["*"]){V.push(new Ut(l,h[ie],`unknown property "${ie}"`));continue}Se=B}V=V.concat(Se({key:(l&&`${l}.`)+ie,value:h[ie],valueSpec:_e,style:M,styleSpec:k,object:h,objectKey:ie,validateSpec:B},h))}for(const ie in v)S[ie]||v[ie].required&&v[ie].default===void 0&&h[ie]===void 0&&V.push(new Ut(l,h,`missing required property "${ie}"`));return V}function oc(p){const l=p.value,h=p.valueSpec,v=p.style,S=p.styleSpec,M=p.key,k=p.arrayElementValidator||p.validateSpec;if(ni(l)!=="array")return[new Ut(M,l,`array expected, ${ni(l)} found`)];if(h.length&&l.length!==h.length)return[new Ut(M,l,`array length ${h.length} expected, length ${l.length} found`)];let B={type:h.value,values:h.values};S.$version<7&&(B.function=h.function),ni(h.value)==="object"&&(B=h.value);let V=[];for(let Z=0;Z<l.length;Z++)V=V.concat(k({array:l,arrayIndex:Z,value:l[Z],valueSpec:B,validateSpec:p.validateSpec,style:v,styleSpec:S,key:`${M}[${Z}]`}));return V}function pl(p){const l=p.key,h=p.value,v=p.valueSpec;let S=ni(h);return S==="number"&&h!=h&&(S="NaN"),S!=="number"?[new Ut(l,h,`number expected, ${S} found`)]:"minimum"in v&&h<v.minimum?[new Ut(l,h,`${h} is less than the minimum value ${v.minimum}`)]:"maximum"in v&&h>v.maximum?[new Ut(l,h,`${h} is greater than the maximum value ${v.maximum}`)]:[]}function Fp(p){const l=p.valueSpec,h=xa(p.value.type);let v,S,M,k={};const B=h!=="categorical"&&p.value.property===void 0,V=!B,Z=ni(p.value.stops)==="array"&&ni(p.value.stops[0])==="array"&&ni(p.value.stops[0][0])==="object",ie=Xl({key:p.key,value:p.value,valueSpec:p.styleSpec.function,validateSpec:p.validateSpec,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(Se){if(h==="identity")return[new Ut(Se.key,Se.value,'identity function may not have a "stops" property')];let Le=[];const ze=Se.value;return Le=Le.concat(oc({key:Se.key,value:ze,valueSpec:Se.valueSpec,validateSpec:Se.validateSpec,style:Se.style,styleSpec:Se.styleSpec,arrayElementValidator:ce})),ni(ze)==="array"&&ze.length===0&&Le.push(new Ut(Se.key,ze,"array must have at least one stop")),Le},default:function(Se){return Se.validateSpec({key:Se.key,value:Se.value,valueSpec:l,validateSpec:Se.validateSpec,style:Se.style,styleSpec:Se.styleSpec})}}});return h==="identity"&&B&&ie.push(new Ut(p.key,p.value,'missing required property "property"')),h==="identity"||p.value.stops||ie.push(new Ut(p.key,p.value,'missing required property "stops"')),h==="exponential"&&p.valueSpec.expression&&!To(p.valueSpec)&&ie.push(new Ut(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(V&&!Gl(p.valueSpec)?ie.push(new Ut(p.key,p.value,"property functions not supported")):B&&!Wl(p.valueSpec)&&ie.push(new Ut(p.key,p.value,"zoom functions not supported"))),h!=="categorical"&&!Z||p.value.property!==void 0||ie.push(new Ut(p.key,p.value,'"property" property is required')),ie;function ce(Se){let Le=[];const ze=Se.value,Ve=Se.key;if(ni(ze)!=="array")return[new Ut(Ve,ze,`array expected, ${ni(ze)} found`)];if(ze.length!==2)return[new Ut(Ve,ze,`array length 2 expected, length ${ze.length} found`)];if(Z){if(ni(ze[0])!=="object")return[new Ut(Ve,ze,`object expected, ${ni(ze[0])} found`)];if(ze[0].zoom===void 0)return[new Ut(Ve,ze,"object stop key must have zoom")];if(ze[0].value===void 0)return[new Ut(Ve,ze,"object stop key must have value")];if(M&&M>xa(ze[0].zoom))return[new Ut(Ve,ze[0].zoom,"stop zoom values must appear in ascending order")];xa(ze[0].zoom)!==M&&(M=xa(ze[0].zoom),S=void 0,k={}),Le=Le.concat(Xl({key:`${Ve}[0]`,value:ze[0],valueSpec:{zoom:{}},validateSpec:Se.validateSpec,style:Se.style,styleSpec:Se.styleSpec,objectElementValidators:{zoom:pl,value:_e}}))}else Le=Le.concat(_e({key:`${Ve}[0]`,value:ze[0],validateSpec:Se.validateSpec,style:Se.style,styleSpec:Se.styleSpec},ze));return Vc(ih(ze[1]))?Le.concat([new Ut(`${Ve}[1]`,ze[1],"expressions are not allowed in function stops.")]):Le.concat(Se.validateSpec({key:`${Ve}[1]`,value:ze[1],valueSpec:l,validateSpec:Se.validateSpec,style:Se.style,styleSpec:Se.styleSpec}))}function _e(Se,Le){const ze=ni(Se.value),Ve=xa(Se.value),et=Se.value!==null?Se.value:Le;if(v){if(ze!==v)return[new Ut(Se.key,et,`${ze} stop domain type must match previous stop domain type ${v}`)]}else v=ze;if(ze!=="number"&&ze!=="string"&&ze!=="boolean")return[new Ut(Se.key,et,"stop domain value must be a number, string, or boolean")];if(ze!=="number"&&h!=="categorical"){let Ct=`number expected, ${ze} found`;return Gl(l)&&h===void 0&&(Ct+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ut(Se.key,et,Ct)]}return h!=="categorical"||ze!=="number"||isFinite(Ve)&&Math.floor(Ve)===Ve?h!=="categorical"&&ze==="number"&&S!==void 0&&Ve<S?[new Ut(Se.key,et,"stop domain values must appear in ascending order")]:(S=Ve,h==="categorical"&&Ve in k?[new Ut(Se.key,et,"stop domain values must be unique")]:(k[Ve]=!0,[])):[new Ut(Se.key,et,`integer expected, found ${Ve}`)]}}function _f(p){const l=(p.expressionContext==="property"?Dp:th)(ih(p.value),p.valueSpec);if(l.result==="error")return l.value.map((v=>new Ut(`${p.key}${v.key}`,p.value,v.message)));const h=l.value.expression||l.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!h.outputDefined())return[new Ut(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!Pl(h))return[new Ut(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter"&&!Pl(h))return[new Ut(p.key,p.value,'"feature-state" data expressions are not supported with filters.')];if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!hu(h,["zoom","feature-state"]))return[new Ut(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!Js(h))return[new Ut(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Bh(p){const l=p.key,h=p.value,v=ni(h);return v!=="string"?[new Ut(l,h,`color expected, ${v} found`)]:Mr.parse(String(h))?[]:[new Ut(l,h,`color expected, "${h}" found`)]}function bf(p){const l=p.key,h=p.value,v=p.valueSpec,S=[];return Array.isArray(v.values)?v.values.indexOf(xa(h))===-1&&S.push(new Ut(l,h,`expected one of [${v.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(v.values).indexOf(xa(h))===-1&&S.push(new Ut(l,h,`expected one of [${Object.keys(v.values).join(", ")}], ${JSON.stringify(h)} found`)),S}function ah(p){return Gg(ih(p.value))?_f(Xr({},p,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Xg(p)}function Xg(p){const l=p.value,h=p.key;if(ni(l)!=="array")return[new Ut(h,l,`array expected, ${ni(l)} found`)];const v=p.styleSpec;let S,M=[];if(l.length<1)return[new Ut(h,l,"filter array must have at least 1 element")];switch(M=M.concat(bf({key:`${h}[0]`,value:l[0],valueSpec:v.filter_operator,style:p.style,styleSpec:p.styleSpec})),xa(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&xa(l[1])==="$type"&&M.push(new Ut(h,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&M.push(new Ut(h,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(S=ni(l[1]),S!=="string"&&M.push(new Ut(`${h}[1]`,l[1],`string expected, ${S} found`)));for(let k=2;k<l.length;k++)S=ni(l[k]),xa(l[1])==="$type"?M=M.concat(bf({key:`${h}[${k}]`,value:l[k],valueSpec:v.geometry_type,style:p.style,styleSpec:p.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&M.push(new Ut(`${h}[${k}]`,l[k],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let k=1;k<l.length;k++)M=M.concat(Xg({key:`${h}[${k}]`,value:l[k],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":S=ni(l[1]),l.length!==2?M.push(new Ut(h,l,`filter array for "${l[0]}" operator must have 2 elements`)):S!=="string"&&M.push(new Ut(`${h}[1]`,l[1],`string expected, ${S} found`))}return M}function Ny(p,l){const h=p.key,v=p.validateSpec,S=p.style,M=p.styleSpec,k=p.value,B=p.objectKey,V=M[`${l}_${p.layerType}`];if(!V)return[];const Z=B.match(/^(.*)-transition$/);if(l==="paint"&&Z&&V[Z[1]]&&V[Z[1]].transition)return v({key:h,value:k,valueSpec:M.transition,style:S,styleSpec:M});const ie=p.valueSpec||V[B];if(!ie)return[new Ut(h,k,`unknown property "${B}"`)];let ce;if(ni(k)==="string"&&Gl(ie)&&!ie.tokens&&(ce=/^{([^}]+)}$/.exec(k)))return[new Ut(h,k,`"${B}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(ce[1])} }\`.`)];const _e=[];return p.layerType==="symbol"&&B==="text-font"&&Lu(ih(k))&&xa(k.type)==="identity"&&_e.push(new Ut(h,k,'"text-font" does not support identity functions')),_e.concat(v({key:p.key,value:k,valueSpec:ie,style:S,styleSpec:M,expressionContext:"property",propertyType:l,propertyKey:B}))}function Fd(p){return Ny(p,"paint")}function Bd(p){return Ny(p,"layout")}function zh(p){let l=[];const h=p.value,v=p.key,S=p.style,M=p.styleSpec;if(ni(h)!=="object")return[new Ut(v,h,`object expected, ${ni(h)} found`)];h.type||h.ref||l.push(new Ut(v,h,'either "type" or "ref" is required'));let k=xa(h.type);const B=xa(h.ref);if(h.id){const V=xa(h.id);for(let Z=0;Z<p.arrayIndex;Z++){const ie=S.layers[Z];xa(ie.id)===V&&l.push(new Ut(v,h.id,`duplicate layer id "${h.id}", previously used at line ${ie.id.__line__}`))}}if("ref"in h){let V;["type","source","source-layer","filter","layout"].forEach((Z=>{Z in h&&l.push(new Ut(v,h[Z],`"${Z}" is prohibited for ref layers`))})),S.layers.forEach((Z=>{xa(Z.id)===B&&(V=Z)})),V?V.ref?l.push(new Ut(v,h.ref,"ref cannot reference another ref layer")):k=xa(V.type):l.push(new Ut(v,h.ref,`ref layer "${B}" not found`))}else if(k!=="background")if(h.source){const V=S.sources&&S.sources[h.source],Z=V&&xa(V.type);V?Z==="vector"&&k==="raster"?l.push(new Ut(v,h.source,`layer "${h.id}" requires a raster source`)):Z!=="raster-dem"&&k==="hillshade"||Z!=="raster-dem"&&k==="color-relief"?l.push(new Ut(v,h.source,`layer "${h.id}" requires a raster-dem source`)):Z==="raster"&&k!=="raster"?l.push(new Ut(v,h.source,`layer "${h.id}" requires a vector source`)):Z!=="vector"||h["source-layer"]?Z==="raster-dem"&&k!=="hillshade"&&k!=="color-relief"?l.push(new Ut(v,h.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):k!=="line"||!h.paint||!h.paint["line-gradient"]||Z==="geojson"&&V.lineMetrics||l.push(new Ut(v,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new Ut(v,h,`layer "${h.id}" must specify a "source-layer"`)):l.push(new Ut(v,h.source,`source "${h.source}" not found`))}else l.push(new Ut(v,h,'missing required property "source"'));return l=l.concat(Xl({key:v,value:h,valueSpec:M.layer,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,objectElementValidators:{"*":()=>[],type:()=>p.validateSpec({key:`${v}.type`,value:h.type,valueSpec:M.layer.type,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,object:h,objectKey:"type"}),filter:ah,layout:V=>Xl({layer:h,key:V.key,value:V.value,style:V.style,styleSpec:V.styleSpec,validateSpec:V.validateSpec,objectElementValidators:{"*":Z=>Bd(Xr({layerType:k},Z))}}),paint:V=>Xl({layer:h,key:V.key,value:V.value,style:V.style,styleSpec:V.styleSpec,validateSpec:V.validateSpec,objectElementValidators:{"*":Z=>Fd(Xr({layerType:k},Z))}})}})),l}function wc(p){const l=p.value,h=p.key,v=ni(l);return v!=="string"?[new Ut(h,l,`string expected, ${v} found`)]:[]}const Yg={promoteId:function({key:p,value:l}){if(ni(l)==="string")return wc({key:p,value:l});{const h=[];for(const v in l)h.push(...wc({key:`${p}.${v}`,value:l[v]}));return h}}};function Bp(p){const l=p.value,h=p.key,v=p.styleSpec,S=p.style,M=p.validateSpec;if(!l.type)return[new Ut(h,l,'"type" is required')];const k=xa(l.type);let B;switch(k){case"vector":case"raster":return B=Xl({key:h,value:l,valueSpec:v[`source_${k.replace("-","_")}`],style:p.style,styleSpec:v,objectElementValidators:Yg,validateSpec:M}),B;case"raster-dem":return B=(function(V){var Z;const ie=(Z=V.sourceName)!==null&&Z!==void 0?Z:"",ce=V.value,_e=V.styleSpec,Se=_e.source_raster_dem,Le=V.style;let ze=[];const Ve=ni(ce);if(ce===void 0)return ze;if(Ve!=="object")return ze.push(new Ut("source_raster_dem",ce,`object expected, ${Ve} found`)),ze;const et=xa(ce.encoding)==="custom",Ct=["redFactor","greenFactor","blueFactor","baseShift"],rt=V.value.encoding?`"${V.value.encoding}"`:"Default";for(const ut in ce)!et&&Ct.includes(ut)?ze.push(new Ut(ut,ce[ut],`In "${ie}": "${ut}" is only valid when "encoding" is set to "custom". ${rt} encoding found`)):Se[ut]?ze=ze.concat(V.validateSpec({key:ut,value:ce[ut],valueSpec:Se[ut],validateSpec:V.validateSpec,style:Le,styleSpec:_e})):ze.push(new Ut(ut,ce[ut],`unknown property "${ut}"`));return ze})({sourceName:h,value:l,style:p.style,styleSpec:v,validateSpec:M}),B;case"geojson":if(B=Xl({key:h,value:l,valueSpec:v.source_geojson,style:S,styleSpec:v,validateSpec:M,objectElementValidators:Yg}),l.cluster)for(const V in l.clusterProperties){const[Z,ie]=l.clusterProperties[V],ce=typeof Z=="string"?[Z,["accumulated"],["get",V]]:Z;B.push(..._f({key:`${h}.${V}.map`,value:ie,expressionContext:"cluster-map"})),B.push(..._f({key:`${h}.${V}.reduce`,value:ce,expressionContext:"cluster-reduce"}))}return B;case"video":return Xl({key:h,value:l,valueSpec:v.source_video,style:S,validateSpec:M,styleSpec:v});case"image":return Xl({key:h,value:l,valueSpec:v.source_image,style:S,validateSpec:M,styleSpec:v});case"canvas":return[new Ut(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return bf({key:`${h}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function zd(p){const l=p.value,h=p.styleSpec,v=h.light,S=p.style;let M=[];const k=ni(l);if(l===void 0)return M;if(k!=="object")return M=M.concat([new Ut("light",l,`object expected, ${k} found`)]),M;for(const B in l){const V=B.match(/^(.*)-transition$/);M=M.concat(V&&v[V[1]]&&v[V[1]].transition?p.validateSpec({key:B,value:l[B],valueSpec:h.transition,validateSpec:p.validateSpec,style:S,styleSpec:h}):v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],validateSpec:p.validateSpec,style:S,styleSpec:h}):[new Ut(B,l[B],`unknown property "${B}"`)])}return M}function Fy(p){const l=p.value,h=p.styleSpec,v=h.sky,S=p.style,M=ni(l);if(l===void 0)return[];if(M!=="object")return[new Ut("sky",l,`object expected, ${M} found`)];let k=[];for(const B in l)k=k.concat(v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],style:S,styleSpec:h}):[new Ut(B,l[B],`unknown property "${B}"`)]);return k}function Zg(p){const l=p.value,h=p.styleSpec,v=h.terrain,S=p.style;let M=[];const k=ni(l);if(l===void 0)return M;if(k!=="object")return M=M.concat([new Ut("terrain",l,`object expected, ${k} found`)]),M;for(const B in l)M=M.concat(v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],validateSpec:p.validateSpec,style:S,styleSpec:h}):[new Ut(B,l[B],`unknown property "${B}"`)]);return M}function Kg(p){let l=[];const h=p.value,v=p.key;if(Array.isArray(h)){const S=[],M=[];for(const k in h)h[k].id&&S.includes(h[k].id)&&l.push(new Ut(v,h,`all the sprites' ids must be unique, but ${h[k].id} is duplicated`)),S.push(h[k].id),h[k].url&&M.includes(h[k].url)&&l.push(new Ut(v,h,`all the sprites' URLs must be unique, but ${h[k].url} is duplicated`)),M.push(h[k].url),l=l.concat(Xl({key:`${v}[${k}]`,value:h[k],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:p.validateSpec}));return l}return wc({key:v,value:h})}function By(p){return!!p&&p.constructor===Object}function Jg(p){return By(p.value)?[]:[new Ut(p.key,p.value,`object expected, ${ni(p.value)} found`)]}const zp={"*":()=>[],array:oc,boolean:function(p){const l=p.value,h=p.key,v=ni(l);return v!=="boolean"?[new Ut(h,l,`boolean expected, ${v} found`)]:[]},number:pl,color:Bh,constants:Nu,enum:bf,filter:ah,function:Fp,layer:zh,object:Xl,source:Bp,light:zd,sky:Fy,terrain:Zg,projection:function(p){const l=p.value,h=p.styleSpec,v=h.projection,S=p.style,M=ni(l);if(l===void 0)return[];if(M!=="object")return[new Ut("projection",l,`object expected, ${M} found`)];let k=[];for(const B in l)k=k.concat(v[B]?p.validateSpec({key:B,value:l[B],valueSpec:v[B],style:S,styleSpec:h}):[new Ut(B,l[B],`unknown property "${B}"`)]);return k},projectionDefinition:function(p){const l=p.key;let h=p.value;h=h instanceof String?h.valueOf():h;const v=ni(h);return v!=="array"||(function(S){return Array.isArray(S)&&S.length===3&&typeof S[0]=="string"&&typeof S[1]=="string"&&typeof S[2]=="number"})(h)||(function(S){return!!["interpolate","step","literal"].includes(S[0])})(h)?["array","string"].includes(v)?[]:[new Ut(l,h,`projection expected, invalid type "${v}" found`)]:[new Ut(l,h,`projection expected, invalid array ${JSON.stringify(h)} found`)]},string:wc,formatted:function(p){return wc(p).length===0?[]:_f(p)},resolvedImage:function(p){return wc(p).length===0?[]:_f(p)},padding:function(p){const l=p.key,h=p.value;if(ni(h)==="array"){if(h.length<1||h.length>4)return[new Ut(l,h,`padding requires 1 to 4 values; ${h.length} values found`)];const v={type:"number"};let S=[];for(let M=0;M<h.length;M++)S=S.concat(p.validateSpec({key:`${l}[${M}]`,value:h[M],validateSpec:p.validateSpec,valueSpec:v}));return S}return pl({key:l,value:h,valueSpec:{}})},numberArray:function(p){const l=p.key,h=p.value;if(ni(h)==="array"){const v={type:"number"};if(h.length<1)return[new Ut(l,h,"array length at least 1 expected, length 0 found")];let S=[];for(let M=0;M<h.length;M++)S=S.concat(p.validateSpec({key:`${l}[${M}]`,value:h[M],validateSpec:p.validateSpec,valueSpec:v}));return S}return pl({key:l,value:h,valueSpec:{}})},colorArray:function(p){const l=p.key,h=p.value;if(ni(h)==="array"){if(h.length<1)return[new Ut(l,h,"array length at least 1 expected, length 0 found")];let v=[];for(let S=0;S<h.length;S++)v=v.concat(Bh({key:`${l}[${S}]`,value:h[S]}));return v}return Bh({key:l,value:h})},variableAnchorOffsetCollection:function(p){const l=p.key,h=p.value,v=ni(h),S=p.styleSpec;if(v!=="array"||h.length<1||h.length%2!=0)return[new Ut(l,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let M=[];for(let k=0;k<h.length;k+=2)M=M.concat(bf({key:`${l}[${k}]`,value:h[k],valueSpec:S.layout_symbol["text-anchor"]})),M=M.concat(oc({key:`${l}[${k+1}]`,value:h[k+1],valueSpec:{length:2,value:"number"},validateSpec:p.validateSpec,style:p.style,styleSpec:S}));return M},sprite:Kg,state:Jg,fontFaces:function(p){const l=p.key,h=p.value,v=p.validateSpec,S=p.styleSpec,M=p.style;if(!By(h))return[new Ut(l,h,`object expected, ${ni(h)} found`)];const k=[];for(const B in h){const V=h[B],Z=ni(V);if(Z==="string")k.push(...wc({key:`${l}.${B}`,value:V}));else if(Z==="array"){const ie={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[ce,_e]of V.entries())k.push(...Xl({key:`${l}.${B}[${ce}]`,value:_e,valueSpec:ie,styleSpec:S,style:M,validateSpec:v}))}else k.push(new Ut(`${l}.${B}`,V,`string or array expected, ${Z} found`))}return k}};function sc(p){const l=p.value,h=p.valueSpec,v=p.styleSpec;return p.validateSpec=sc,h.expression&&Lu(xa(l))?Fp(p):h.expression&&Vc(ih(l))?_f(p):h.type&&zp[h.type]?zp[h.type](p):Xl(Xr({},p,{valueSpec:h.type?v[h.type]:h}))}function zy(p){const l=p.value,h=p.key,v=wc(p);return v.length||(l.indexOf("{fontstack}")===-1&&v.push(new Ut(h,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&v.push(new Ut(h,l,'"glyphs" url must include a "{range}" token'))),v}function Fu(p,l=Rt){let h=[];return h=h.concat(sc({key:"",value:p,valueSpec:l.$root,styleSpec:l,style:p,validateSpec:sc,objectElementValidators:{glyphs:zy,"*":()=>[]}})),p.constants&&(h=h.concat(Nu({key:"constants",value:p.constants}))),q(h)}function Bu(p){return function(l){return p(Object.assign({},l,{validateSpec:sc}))}}function q(p){return[].concat(p).sort(((l,h)=>l.line-h.line))}function K(p){return function(...l){return q(p.apply(this,l))}}Fu.source=K(Bu(Bp)),Fu.sprite=K(Bu(Kg)),Fu.glyphs=K(Bu(zy)),Fu.light=K(Bu(zd)),Fu.sky=K(Bu(Fy)),Fu.terrain=K(Bu(Zg)),Fu.state=K(Bu(Jg)),Fu.layer=K(Bu(zh)),Fu.filter=K(Bu(ah)),Fu.paintProperty=K(Bu(Fd)),Fu.layoutProperty=K(Bu(Bd));const me={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class Ie{constructor(l,h){this._globalState=h,this.setValue(l)}evaluate(){var l;return(l=this._literalValue)!==null&&l!==void 0?l:this._compiledValue.evaluate({})}setValue(l){if(l==null||l==="visible"||l==="none")return this._literalValue=l==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const h=th(l,me,this._globalState);if(h.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(h.value.map((v=>`${v.key}: ${v.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=h.value,this._globalStateRefs=vf(h.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const Ye=Rt,Qe=Fu,nt=Qe.light,lt=Qe.sky,yt=Qe.paintProperty,At=Qe.layoutProperty;function Xt(p,l){let h=!1;if(l&&l.length)for(const v of l)p.fire(new cn(new Error(v.message))),h=!0;return h}class _r{constructor(l,h,v){const S=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;const k=new Int32Array(this.arrayBuffer);l=k[0],this.d=(h=k[1])+2*(v=k[2]);for(let V=0;V<this.d*this.d;V++){const Z=k[3+V],ie=k[3+V+1];S.push(Z===ie?null:k.subarray(Z,ie))}const B=k[3+S.length+1];this.keys=k.subarray(k[3+S.length],B),this.bboxes=k.subarray(B),this.insert=this._insertReadonly}else{this.d=h+2*v;for(let k=0;k<this.d*this.d;k++)S.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=l,this.padding=v,this.scale=h/l,this.uid=0;const M=v/h*l;this.min=-M,this.max=l+M}insert(l,h,v,S,M){this._forEachCell(h,v,S,M,this._insertCell,this.uid++,void 0,void 0),this.keys.push(l),this.bboxes.push(h),this.bboxes.push(v),this.bboxes.push(S),this.bboxes.push(M)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(l,h,v,S,M,k){this.cells[M].push(k)}query(l,h,v,S,M){const k=this.min,B=this.max;if(l<=k&&h<=k&&B<=v&&B<=S&&!M)return Array.prototype.slice.call(this.keys);{const V=[];return this._forEachCell(l,h,v,S,this._queryCell,V,{},M),V}}_queryCell(l,h,v,S,M,k,B,V){const Z=this.cells[M];if(Z!==null){const ie=this.keys,ce=this.bboxes;for(let _e=0;_e<Z.length;_e++){const Se=Z[_e];if(B[Se]===void 0){const Le=4*Se;(V?V(ce[Le+0],ce[Le+1],ce[Le+2],ce[Le+3]):l<=ce[Le+2]&&h<=ce[Le+3]&&v>=ce[Le+0]&&S>=ce[Le+1])?(B[Se]=!0,k.push(ie[Se])):B[Se]=!1}}}}_forEachCell(l,h,v,S,M,k,B,V){const Z=this._convertToCellCoord(l),ie=this._convertToCellCoord(h),ce=this._convertToCellCoord(v),_e=this._convertToCellCoord(S);for(let Se=Z;Se<=ce;Se++)for(let Le=ie;Le<=_e;Le++){const ze=this.d*Le+Se;if((!V||V(this._convertFromCellCoord(Se),this._convertFromCellCoord(Le),this._convertFromCellCoord(Se+1),this._convertFromCellCoord(Le+1)))&&M.call(this,l,h,v,S,ze,k,B,V))return}}_convertFromCellCoord(l){return(l-this.padding)/this.scale}_convertToCellCoord(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const l=this.cells,h=3+this.cells.length+1+1;let v=0;for(let k=0;k<this.cells.length;k++)v+=this.cells[k].length;const S=new Int32Array(h+v+this.keys.length+this.bboxes.length);S[0]=this.extent,S[1]=this.n,S[2]=this.padding;let M=h;for(let k=0;k<l.length;k++){const B=l[k];S[3+k]=M,S.set(B,M),M+=B.length}return S[3+l.length]=M,S.set(this.keys,M),M+=this.keys.length,S[3+l.length+1]=M,S.set(this.bboxes,M),M+=this.bboxes.length,S.buffer}static serialize(l,h){const v=l.toArrayBuffer();return h&&h.push(v),{buffer:v}}static deserialize(l){return new _r(l.buffer)}}const St={};function Pt(p,l,h={}){if(St[p])throw new Error(`${p} is already registered.`);Object.defineProperty(l,"_classRegistryKey",{value:p,writeable:!1}),St[p]={klass:l,omit:h.omit||[],shallow:h.shallow||[]}}Pt("Object",Object),Pt("Set",Set),Pt("TransferableGridIndex",_r),Pt("Color",Mr),Pt("Error",Error),Pt("AJAXError",mt),Pt("ResolvedImage",wi),Pt("StylePropertyFunction",Op),Pt("StyleExpression",Rd,{omit:["_evaluator"]}),Pt("ZoomDependentExpression",Hg),Pt("ZoomConstantExpression",Rp),Pt("CompoundExpression",En,{omit:["_evaluate"]});for(const p in Fn)Fn[p]._classRegistryKey||Pt(`Expression_${p}`,Fn[p]);function fr(p){return p&&typeof ArrayBuffer<"u"&&(p instanceof ArrayBuffer||p.constructor&&p.constructor.name==="ArrayBuffer")}function Nr(p){return p.$name||p.constructor._classRegistryKey}function gr(p){return!(function(l){if(l===null||typeof l!="object")return!1;const h=Nr(l);return!(!h||h==="Object")})(p)&&(p==null||typeof p=="boolean"||typeof p=="number"||typeof p=="string"||p instanceof Boolean||p instanceof Number||p instanceof String||p instanceof Date||p instanceof RegExp||p instanceof Blob||p instanceof Error||fr(p)||pr(p)||ArrayBuffer.isView(p)||p instanceof ImageData)}function Br(p,l){if(gr(p))return(fr(p)||pr(p))&&l&&l.push(p),ArrayBuffer.isView(p)&&l&&l.push(p.buffer),p instanceof ImageData&&l&&l.push(p.data.buffer),p;if(Array.isArray(p)){const M=[];for(const k of p)M.push(Br(k,l));return M}if(typeof p!="object")throw new Error("can't serialize object of type "+typeof p);const h=Nr(p);if(!h)throw new Error(`can't serialize object of unregistered class ${p.constructor.name}`);if(!St[h])throw new Error(`${h} is not registered.`);const{klass:v}=St[h],S=v.serialize?v.serialize(p,l):{};if(v.serialize){if(l&&S===l[l.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const M in p){if(!p.hasOwnProperty(M)||St[h].omit.indexOf(M)>=0)continue;const k=p[M];S[M]=St[h].shallow.indexOf(M)>=0?k:Br(k,l)}p instanceof Error&&(S.message=p.message)}if(S.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(S.$name=h),S}function jr(p){if(gr(p))return p;if(Array.isArray(p))return p.map(jr);if(typeof p!="object")throw new Error("can't deserialize object of type "+typeof p);const l=Nr(p)||"Object";if(!St[l])throw new Error(`can't deserialize unregistered class ${l}`);const{klass:h}=St[l];if(!h)throw new Error(`can't deserialize unregistered class ${l}`);if(h.deserialize)return h.deserialize(p);const v=Object.create(h.prototype);for(const S of Object.keys(p)){if(S==="$name")continue;const M=p[S];v[S]=St[l].shallow.indexOf(S)>=0?M:jr(M)}return v}class on{constructor(){this.first=!0}update(l,h){const v=Math.floor(l);return this.first?(this.first=!1,this.lastIntegerZoom=v,this.lastIntegerZoomTime=0,this.lastZoom=l,this.lastFloorZoom=v,!0):(this.lastFloorZoom>v?(this.lastIntegerZoom=v+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<v&&(this.lastIntegerZoom=v,this.lastIntegerZoomTime=h),l!==this.lastZoom&&(this.lastZoom=l,this.lastFloorZoom=v,!0))}}function Jr(p){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(p))}function Jn(p){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(p))}function Vn(p){return/\s/u.test(String.fromCodePoint(p))}function Ai(p){for(const l of p)if(Jn(l.codePointAt(0)))return!0;return!1}function Zn(p){for(const l of p)if(!Li(l.codePointAt(0)))return!1;return!0}function Yi(p){const l=p.map((h=>{try{return new RegExp(`\\p{sc=${h}}`,"u").source}catch{return null}})).filter((h=>h));return new RegExp(l.join("|"),"u")}const No=Yi(["Arab","Dupl","Mong","Ougr","Syrc"]);function Li(p){return!No.test(String.fromCodePoint(p))}function Yn(p){return!(Jn(p)||(l=p,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(l))));var l}const wn=Yi(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Co(p){return wn.test(String.fromCodePoint(p))}function Pi(p,l){return!(!l&&Co(p)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(p)))}function aa(p){for(const l of p)if(Co(l.codePointAt(0)))return!0;return!1}const da=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(p){this.pluginStatus=p.pluginStatus,this.pluginURL=p.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(p){if(da.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=p.applyArabicShaping,this.processBidirectionalText=p.processBidirectionalText,this.processStyledBidirectionalText=p.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(p,l){return o(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(p.pluginStatus!=="loading")return this.setState(p),p;const h=p.pluginURL,v=new Promise((M=>{this.loadScriptResolve=M}));l(h);const S=new Promise((M=>setTimeout((()=>M()),this.TIMEOUT)));if(yield Promise.race([v,S]),this.isParsed()){const M={pluginStatus:"loaded",pluginURL:h};return this.setState(M),M}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${h}`)}))}};class Mi{constructor(l,h){this.isSupportedScript=Ml,this.zoom=l,h?(this.now=h.now||0,this.fadeDuration=h.fadeDuration||0,this.zoomHistory=h.zoomHistory||new on,this.transition=h.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new on,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const l=this.zoom,h=l-Math.floor(l),v=this.crossFadingFactor();return l>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*v}:{fromScale:.5,toScale:1,t:1-(1-v)*h}}}function Ml(p){return(function(l,h){for(const v of l)if(!Pi(v.codePointAt(0),h))return!1;return!0})(p,da.getRTLTextPluginStatus()==="loaded")}const Qa="-transition";class vs{constructor(l,h,v){this.property=l,this.value=h,this.expression=(function(S,M,k){if(Lu(S))return new Op(S,M);if(Vc(S)){const B=Dp(S,M,k);if(B.result==="error")throw new Error(B.value.map((V=>`${V.key}: ${V.message}`)).join(", "));return B.value}{let B=S;return M.type==="color"&&typeof S=="string"?B=Mr.parse(S):M.type!=="padding"||typeof S!="number"&&!Array.isArray(S)?M.type!=="numberArray"||typeof S!="number"&&!Array.isArray(S)?M.type!=="colorArray"||typeof S!="string"&&!Array.isArray(S)?M.type==="variableAnchorOffsetCollection"&&Array.isArray(S)?B=ba.parse(S):M.type==="projectionDefinition"&&typeof S=="string"&&(B=hi.parse(S)):B=mn.parse(S):B=fn.parse(S):B=Rr.parse(S),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>B}}})(h===void 0?l.specification.default:h,l.specification,v)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(l,h,v){return this.property.possiblyEvaluate(this,l,h,v)}}class ks{constructor(l,h){this.property=l,this.value=new vs(l,void 0,h)}transitioned(l,h){return new sa(this.property,this.value,h,Be({},l.transition,this.transition),l.now)}untransitioned(){return new sa(this.property,this.value,null,{},0)}}class Go{constructor(l,h){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues),this._globalState=h}getValue(l){return Me(this._values[l].value.value)}setValue(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new ks(this._values[l].property,this._globalState)),this._values[l].value=new vs(this._values[l].property,h===null?void 0:Me(h),this._globalState)}getTransition(l){return Me(this._values[l].transition)}setTransition(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new ks(this._values[l].property,this._globalState)),this._values[l].transition=Me(h)||void 0}serialize(){const l={};for(const h of Object.keys(this._values)){const v=this.getValue(h);v!==void 0&&(l[h]=v);const S=this.getTransition(h);S!==void 0&&(l[`${h}${Qa}`]=S)}return l}transitioned(l,h){const v=new wa(this._properties);for(const S of Object.keys(this._values))v._values[S]=this._values[S].transitioned(l,h._values[S]);return v}untransitioned(){const l=new wa(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].untransitioned();return l}}class sa{constructor(l,h,v,S,M){this.property=l,this.value=h,this.begin=M+S.delay||0,this.end=this.begin+S.duration||0,l.specification.transition&&(S.delay||S.duration)&&(this.prior=v)}possiblyEvaluate(l,h,v){const S=l.now||0,M=this.value.possiblyEvaluate(l,h,v),k=this.prior;if(k){if(S>this.end)return this.prior=null,M;if(this.value.isDataDriven())return this.prior=null,M;if(S<this.begin)return k.possiblyEvaluate(l,h,v);{const B=(S-this.begin)/(this.end-this.begin);return this.property.interpolate(k.possiblyEvaluate(l,h,v),M,Ee(B))}}return M}}class wa{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,h,v){const S=new Wo(this._properties);for(const M of Object.keys(this._values))S._values[M]=this._values[M].possiblyEvaluate(l,h,v);return S}hasTransition(){for(const l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class Ao{constructor(l,h){this._properties=l,this._values=Object.create(l.defaultPropertyValues),this._globalState=h}hasValue(l){return this._values[l].value!==void 0}getValue(l){return Me(this._values[l].value)}setValue(l,h){this._values[l]=new vs(this._values[l].property,h===null?void 0:Me(h),this._globalState)}serialize(){const l={};for(const h of Object.keys(this._values)){const v=this.getValue(h);v!==void 0&&(l[h]=v)}return l}possiblyEvaluate(l,h,v){const S=new Wo(this._properties);for(const M of Object.keys(this._values))S._values[M]=this._values[M].possiblyEvaluate(l,h,v);return S}}class qi{constructor(l,h,v){this.property=l,this.value=h,this.parameters=v}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,h,v,S){return this.property.evaluate(this.value,this.parameters,l,h,v,S)}}class Wo{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class Tn{constructor(l){this.specification=l}possiblyEvaluate(l,h){if(l.isDataDriven())throw new Error("Value should not be data driven");return l.expression.evaluate(h)}interpolate(l,h,v){const S=Hn[this.specification.type];return S?S(l,h,v):l}}class Sn{constructor(l,h){this.specification=l,this.overrides=h}possiblyEvaluate(l,h,v,S){return new qi(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(h,null,{},v,S)}:l.expression,h)}interpolate(l,h,v){if(l.value.kind!=="constant"||h.value.kind!=="constant")return l;if(l.value.value===void 0||h.value.value===void 0)return new qi(this,{kind:"constant",value:void 0},l.parameters);const S=Hn[this.specification.type];if(S){const M=S(l.value.value,h.value.value,v);return new qi(this,{kind:"constant",value:M},l.parameters)}return l}evaluate(l,h,v,S,M,k){return l.kind==="constant"?l.value:l.evaluate(h,v,S,M,k)}}class Rs extends Sn{possiblyEvaluate(l,h,v,S){if(l.value===void 0)return new qi(this,{kind:"constant",value:void 0},h);if(l.expression.kind==="constant"){const M=l.expression.evaluate(h,null,{},v,S),k=l.property.specification.type==="resolvedImage"&&typeof M!="string"?M.name:M,B=this._calculate(k,k,k,h);return new qi(this,{kind:"constant",value:B},h)}if(l.expression.kind==="camera"){const M=this._calculate(l.expression.evaluate({zoom:h.zoom-1}),l.expression.evaluate({zoom:h.zoom}),l.expression.evaluate({zoom:h.zoom+1}),h);return new qi(this,{kind:"constant",value:M},h)}return new qi(this,l.expression,h)}evaluate(l,h,v,S,M,k){if(l.kind==="source"){const B=l.evaluate(h,v,S,M,k);return this._calculate(B,B,B,h)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(h.zoom)-1},v,S),l.evaluate({zoom:Math.floor(h.zoom)},v,S),l.evaluate({zoom:Math.floor(h.zoom)+1},v,S),h):l.value}_calculate(l,h,v,S){return S.zoom>S.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:v,to:h}}interpolate(l){return l}}class Sa{constructor(l){this.specification=l}possiblyEvaluate(l,h,v,S){if(l.value!==void 0){if(l.expression.kind==="constant"){const M=l.expression.evaluate(h,null,{},v,S);return this._calculate(M,M,M,h)}return this._calculate(l.expression.evaluate(new Mi(Math.floor(h.zoom-1),h)),l.expression.evaluate(new Mi(Math.floor(h.zoom),h)),l.expression.evaluate(new Mi(Math.floor(h.zoom+1),h)),h)}}_calculate(l,h,v,S){return S.zoom>S.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:v,to:h}}interpolate(l){return l}}class Fo{constructor(l){this.specification=l}possiblyEvaluate(l,h,v,S){return!!l.expression.evaluate(h,null,{},v,S)}interpolate(){return!1}}class $a{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in l){const v=l[h];v.specification.overridable&&this.overridableProperties.push(h);const S=this.defaultPropertyValues[h]=new vs(v,void 0,void 0),M=this.defaultTransitionablePropertyValues[h]=new ks(v,void 0);this.defaultTransitioningPropertyValues[h]=M.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=S.possiblyEvaluate({})}}}Pt("DataDrivenProperty",Sn),Pt("DataConstantProperty",Tn),Pt("CrossFadedDataDrivenProperty",Rs),Pt("CrossFadedProperty",Sa),Pt("ColorRampProperty",Fo);class eo extends zr{constructor(l,h,v){if(super(),this.id=l.id,this.type=l.type,this._globalState=v,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=(function(S,M){return new Ie(S,M)})(this.visibility,v),l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter,this._featureFilter=nh(l.filter,v)),h.layout&&(this._unevaluatedLayout=new Ao(h.layout,v)),h.paint)){this._transitionablePaint=new Go(h.paint,v);for(const S in l.paint)this.setPaintProperty(S,l.paint[S],{validate:!1});for(const S in l.layout)this.setLayoutProperty(S,l.layout[S],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wo(h.paint)}}setFilter(l){this.filter=l,this._featureFilter=nh(l,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}getLayoutAffectingGlobalStateRefs(){const l=new Set;for(const h of this._visibilityExpression.getGlobalStateRefs())l.add(h);if(this._unevaluatedLayout)for(const h in this._unevaluatedLayout._values){const v=this._unevaluatedLayout._values[h];for(const S of v.getGlobalStateRefs())l.add(S)}for(const h of this._featureFilter.getGlobalStateRefs())l.add(h);return l}getPaintAffectingGlobalStateRefs(){var l;const h=new globalThis.Map;if(this._transitionablePaint)for(const v in this._transitionablePaint._values){const S=this._transitionablePaint._values[v].value;for(const M of S.getGlobalStateRefs()){const k=(l=h.get(M))!==null&&l!==void 0?l:[];k.push({name:v,value:S.value}),h.set(M,k)}}return h}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(l,h,v={}){if(h==null||!this._validate(At,`layers.${this.id}.layout.${l}`,l,h,v))return l==="visibility"?(this.visibility=h,this._visibilityExpression.setValue(h),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(l,h)}getPaintProperty(l){return l.endsWith(Qa)?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)}setPaintProperty(l,h,v={}){if(h!=null&&this._validate(yt,`layers.${this.id}.paint.${l}`,l,h,v))return!1;if(l.endsWith(Qa))return this._transitionablePaint.setTransition(l.slice(0,-11),h||void 0),!1;{const S=this._transitionablePaint._values[l],M=S.property.specification["property-type"]==="cross-faded-data-driven",k=S.value.isDataDriven(),B=S.value;this._transitionablePaint.setValue(l,h),this._handleSpecialPaintPropertyUpdate(l);const V=this._transitionablePaint._values[l].value;return V.isDataDriven()||k||M||this._handleOverridablePaintPropertyUpdate(l,B,V)}}_handleSpecialPaintPropertyUpdate(l){}_handleOverridablePaintPropertyUpdate(l,h,v){return!1}isHidden(l=this.minzoom,h=!1){return!!(this.minzoom&&l<(h?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&l>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(l,h){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,h)}serialize(){const l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),it(l,((h,v)=>!(h===void 0||v==="layout"&&!Object.keys(h).length||v==="paint"&&!Object.keys(h).length)))}_validate(l,h,v,S,M={}){return(!M||M.validate!==!1)&&Xt(this,l.call(Qe,{key:h,layerType:this.type,objectKey:v,value:S,styleSpec:Rt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const l in this.paint._values){const h=this.paint.get(l);if(h instanceof qi&&Gl(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}let kl;var Yl={get paint(){return kl=kl||new $a({"raster-opacity":new Tn(Rt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Tn(Rt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Tn(Rt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Tn(Rt.paint_raster["raster-brightness-max"]),"raster-saturation":new Tn(Rt.paint_raster["raster-saturation"]),"raster-contrast":new Tn(Rt.paint_raster["raster-contrast"]),"raster-resampling":new Tn(Rt.paint_raster["raster-resampling"]),"raster-fade-duration":new Tn(Rt.paint_raster["raster-fade-duration"])})}};class Zl extends eo{constructor(l,h){super(l,Yl,h)}}const gu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ea{constructor(l,h){this._structArray=l,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ia{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,h){return l._trim(),h&&(l.isTransferred=!0,h.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){const h=Object.create(this.prototype);return h.arrayBuffer=l.arrayBuffer,h.length=l.length,h.capacity=l.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function pa(p,l=1){let h=0,v=0;return{members:p.map((S=>{const M=gu[S.type].BYTES_PER_ELEMENT,k=h=mu(h,Math.max(l,M)),B=S.components||1;return v=Math.max(v,M),h+=M*B,{name:S.name,type:S.type,components:B,offset:k}})),size:mu(h,Math.max(v,l)),alignment:l}}function mu(p,l){return Math.ceil(p/l)*l}class yu extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h){const v=this.length;return this.resize(v+1),this.emplace(v,l,h)}emplace(l,h,v){const S=2*l;return this.int16[S+0]=h,this.int16[S+1]=v,l}}yu.prototype.bytesPerElement=4,Pt("StructArrayLayout2i4",yu);class as extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,v)}emplace(l,h,v,S){const M=3*l;return this.int16[M+0]=h,this.int16[M+1]=v,this.int16[M+2]=S,l}}as.prototype.bytesPerElement=6,Pt("StructArrayLayout3i6",as);class jh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S){const M=this.length;return this.resize(M+1),this.emplace(M,l,h,v,S)}emplace(l,h,v,S,M){const k=4*l;return this.int16[k+0]=h,this.int16[k+1]=v,this.int16[k+2]=S,this.int16[k+3]=M,l}}jh.prototype.bytesPerElement=8,Pt("StructArrayLayout4i8",jh);class Uh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,M,k){const B=this.length;return this.resize(B+1),this.emplace(B,l,h,v,S,M,k)}emplace(l,h,v,S,M,k,B){const V=6*l;return this.int16[V+0]=h,this.int16[V+1]=v,this.int16[V+2]=S,this.int16[V+3]=M,this.int16[V+4]=k,this.int16[V+5]=B,l}}Uh.prototype.bytesPerElement=12,Pt("StructArrayLayout2i4i12",Uh);class Vh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,M,k){const B=this.length;return this.resize(B+1),this.emplace(B,l,h,v,S,M,k)}emplace(l,h,v,S,M,k,B){const V=4*l,Z=8*l;return this.int16[V+0]=h,this.int16[V+1]=v,this.uint8[Z+4]=S,this.uint8[Z+5]=M,this.uint8[Z+6]=k,this.uint8[Z+7]=B,l}}Vh.prototype.bytesPerElement=8,Pt("StructArrayLayout2i4ub8",Vh);class qc extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h){const v=this.length;return this.resize(v+1),this.emplace(v,l,h)}emplace(l,h,v){const S=2*l;return this.float32[S+0]=h,this.float32[S+1]=v,l}}qc.prototype.bytesPerElement=8,Pt("StructArrayLayout2f8",qc);class Hc extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,M,k,B,V,Z,ie){const ce=this.length;return this.resize(ce+1),this.emplace(ce,l,h,v,S,M,k,B,V,Z,ie)}emplace(l,h,v,S,M,k,B,V,Z,ie,ce){const _e=10*l;return this.uint16[_e+0]=h,this.uint16[_e+1]=v,this.uint16[_e+2]=S,this.uint16[_e+3]=M,this.uint16[_e+4]=k,this.uint16[_e+5]=B,this.uint16[_e+6]=V,this.uint16[_e+7]=Z,this.uint16[_e+8]=ie,this.uint16[_e+9]=ce,l}}Hc.prototype.bytesPerElement=20,Pt("StructArrayLayout10ui20",Hc);class jp extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,M,k,B,V){const Z=this.length;return this.resize(Z+1),this.emplace(Z,l,h,v,S,M,k,B,V)}emplace(l,h,v,S,M,k,B,V,Z){const ie=8*l;return this.uint16[ie+0]=h,this.uint16[ie+1]=v,this.uint16[ie+2]=S,this.uint16[ie+3]=M,this.uint16[ie+4]=k,this.uint16[ie+5]=B,this.uint16[ie+6]=V,this.uint16[ie+7]=Z,l}}jp.prototype.bytesPerElement=16,Pt("StructArrayLayout8ui16",jp);class oh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,M,k,B,V,Z,ie,ce,_e){const Se=this.length;return this.resize(Se+1),this.emplace(Se,l,h,v,S,M,k,B,V,Z,ie,ce,_e)}emplace(l,h,v,S,M,k,B,V,Z,ie,ce,_e,Se){const Le=12*l;return this.int16[Le+0]=h,this.int16[Le+1]=v,this.int16[Le+2]=S,this.int16[Le+3]=M,this.uint16[Le+4]=k,this.uint16[Le+5]=B,this.uint16[Le+6]=V,this.uint16[Le+7]=Z,this.int16[Le+8]=ie,this.int16[Le+9]=ce,this.int16[Le+10]=_e,this.int16[Le+11]=Se,l}}oh.prototype.bytesPerElement=24,Pt("StructArrayLayout4i4ui4i24",oh);class lc extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,v)}emplace(l,h,v,S){const M=3*l;return this.float32[M+0]=h,this.float32[M+1]=v,this.float32[M+2]=S,l}}lc.prototype.bytesPerElement=12,Pt("StructArrayLayout3f12",lc);class jd extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint32[1*l+0]=h,l}}jd.prototype.bytesPerElement=4,Pt("StructArrayLayout1ul4",jd);class Qg extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,M,k,B,V,Z){const ie=this.length;return this.resize(ie+1),this.emplace(ie,l,h,v,S,M,k,B,V,Z)}emplace(l,h,v,S,M,k,B,V,Z,ie){const ce=10*l,_e=5*l;return this.int16[ce+0]=h,this.int16[ce+1]=v,this.int16[ce+2]=S,this.int16[ce+3]=M,this.int16[ce+4]=k,this.int16[ce+5]=B,this.uint32[_e+3]=V,this.uint16[ce+8]=Z,this.uint16[ce+9]=ie,l}}Qg.prototype.bytesPerElement=20,Pt("StructArrayLayout6i1ul2ui20",Qg);class $h extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,M,k){const B=this.length;return this.resize(B+1),this.emplace(B,l,h,v,S,M,k)}emplace(l,h,v,S,M,k,B){const V=6*l;return this.int16[V+0]=h,this.int16[V+1]=v,this.int16[V+2]=S,this.int16[V+3]=M,this.int16[V+4]=k,this.int16[V+5]=B,l}}$h.prototype.bytesPerElement=12,Pt("StructArrayLayout2i2i2i12",$h);class xf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,M){const k=this.length;return this.resize(k+1),this.emplace(k,l,h,v,S,M)}emplace(l,h,v,S,M,k){const B=4*l,V=8*l;return this.float32[B+0]=h,this.float32[B+1]=v,this.float32[B+2]=S,this.int16[V+6]=M,this.int16[V+7]=k,l}}xf.prototype.bytesPerElement=16,Pt("StructArrayLayout2f1f2i16",xf);class qh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,v,S,M,k){const B=this.length;return this.resize(B+1),this.emplace(B,l,h,v,S,M,k)}emplace(l,h,v,S,M,k,B){const V=16*l,Z=4*l,ie=8*l;return this.uint8[V+0]=h,this.uint8[V+1]=v,this.float32[Z+1]=S,this.float32[Z+2]=M,this.int16[ie+6]=k,this.int16[ie+7]=B,l}}qh.prototype.bytesPerElement=16,Pt("StructArrayLayout2ub2f2i16",qh);class Hh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,v)}emplace(l,h,v,S){const M=3*l;return this.uint16[M+0]=h,this.uint16[M+1]=v,this.uint16[M+2]=S,l}}Hh.prototype.bytesPerElement=6,Pt("StructArrayLayout3ui6",Hh);class wf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,v,S,M,k,B,V,Z,ie,ce,_e,Se,Le,ze,Ve,et){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,l,h,v,S,M,k,B,V,Z,ie,ce,_e,Se,Le,ze,Ve,et)}emplace(l,h,v,S,M,k,B,V,Z,ie,ce,_e,Se,Le,ze,Ve,et,Ct){const rt=24*l,ut=12*l,kt=48*l;return this.int16[rt+0]=h,this.int16[rt+1]=v,this.uint16[rt+2]=S,this.uint16[rt+3]=M,this.uint32[ut+2]=k,this.uint32[ut+3]=B,this.uint32[ut+4]=V,this.uint16[rt+10]=Z,this.uint16[rt+11]=ie,this.uint16[rt+12]=ce,this.float32[ut+7]=_e,this.float32[ut+8]=Se,this.uint8[kt+36]=Le,this.uint8[kt+37]=ze,this.uint8[kt+38]=Ve,this.uint32[ut+10]=et,this.int16[rt+22]=Ct,l}}wf.prototype.bytesPerElement=48,Pt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",wf);class Gh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,v,S,M,k,B,V,Z,ie,ce,_e,Se,Le,ze,Ve,et,Ct,rt,ut,kt,Ft,hr,Or,Pr,Vr,dn,Wr){const kr=this.length;return this.resize(kr+1),this.emplace(kr,l,h,v,S,M,k,B,V,Z,ie,ce,_e,Se,Le,ze,Ve,et,Ct,rt,ut,kt,Ft,hr,Or,Pr,Vr,dn,Wr)}emplace(l,h,v,S,M,k,B,V,Z,ie,ce,_e,Se,Le,ze,Ve,et,Ct,rt,ut,kt,Ft,hr,Or,Pr,Vr,dn,Wr,kr){const Er=32*l,Cn=16*l;return this.int16[Er+0]=h,this.int16[Er+1]=v,this.int16[Er+2]=S,this.int16[Er+3]=M,this.int16[Er+4]=k,this.int16[Er+5]=B,this.int16[Er+6]=V,this.int16[Er+7]=Z,this.uint16[Er+8]=ie,this.uint16[Er+9]=ce,this.uint16[Er+10]=_e,this.uint16[Er+11]=Se,this.uint16[Er+12]=Le,this.uint16[Er+13]=ze,this.uint16[Er+14]=Ve,this.uint16[Er+15]=et,this.uint16[Er+16]=Ct,this.uint16[Er+17]=rt,this.uint16[Er+18]=ut,this.uint16[Er+19]=kt,this.uint16[Er+20]=Ft,this.uint16[Er+21]=hr,this.uint16[Er+22]=Or,this.uint32[Cn+12]=Pr,this.float32[Cn+13]=Vr,this.float32[Cn+14]=dn,this.uint16[Er+30]=Wr,this.uint16[Er+31]=kr,l}}Gh.prototype.bytesPerElement=64,Pt("StructArrayLayout8i15ui1ul2f2ui64",Gh);class Wh extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.float32[1*l+0]=h,l}}Wh.prototype.bytesPerElement=4,Pt("StructArrayLayout1f4",Wh);class Sf extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,v)}emplace(l,h,v,S){const M=3*l;return this.uint16[6*l+0]=h,this.float32[M+1]=v,this.float32[M+2]=S,l}}Sf.prototype.bytesPerElement=12,Pt("StructArrayLayout1ui2f12",Sf);class Up extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,v){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,v)}emplace(l,h,v,S){const M=4*l;return this.uint32[2*l+0]=h,this.uint16[M+2]=v,this.uint16[M+3]=S,l}}Up.prototype.bytesPerElement=8,Pt("StructArrayLayout1ul2ui8",Up);class D extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h){const v=this.length;return this.resize(v+1),this.emplace(v,l,h)}emplace(l,h,v){const S=2*l;return this.uint16[S+0]=h,this.uint16[S+1]=v,l}}D.prototype.bytesPerElement=4,Pt("StructArrayLayout2ui4",D);class u extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint16[1*l+0]=h,l}}u.prototype.bytesPerElement=2,Pt("StructArrayLayout1ui2",u);class g extends ia{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,v,S){const M=this.length;return this.resize(M+1),this.emplace(M,l,h,v,S)}emplace(l,h,v,S,M){const k=4*l;return this.float32[k+0]=h,this.float32[k+1]=v,this.float32[k+2]=S,this.float32[k+3]=M,l}}g.prototype.bytesPerElement=16,Pt("StructArrayLayout4f16",g);class w extends Ea{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new c(this.anchorPointX,this.anchorPointY)}}w.prototype.size=20;class C extends Qg{get(l){return new w(this,l)}}Pt("CollisionBoxArray",C);class L extends Ea{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(l){this._structArray.uint8[this._pos1+37]=l}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(l){this._structArray.uint8[this._pos1+38]=l}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(l){this._structArray.uint32[this._pos4+10]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}L.prototype.size=48;class z extends wf{get(l){return new L(this,l)}}Pt("PlacedSymbolArray",z);class Y extends Ea{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(l){this._structArray.uint32[this._pos4+12]=l}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Y.prototype.size=64;class re extends Gh{get(l){return new Y(this,l)}}Pt("SymbolInstanceArray",re);class le extends Wh{getoffsetX(l){return this.float32[1*l+0]}}Pt("GlyphOffsetArray",le);class he extends as{getx(l){return this.int16[3*l+0]}gety(l){return this.int16[3*l+1]}gettileUnitDistanceFromAnchor(l){return this.int16[3*l+2]}}Pt("SymbolLineVertexArray",he);class Ae extends Ea{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ae.prototype.size=12;class Ce extends Sf{get(l){return new Ae(this,l)}}Pt("TextAnchorOffsetArray",Ce);class Ue extends Ea{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ue.prototype.size=8;class Ze extends Up{get(l){return new Ue(this,l)}}Pt("FeatureIndexArray",Ze);class ht extends yu{}class pt extends yu{}class dt extends yu{}class xt extends Uh{}class Ot extends Vh{}class wt extends qc{}class Lt extends Hc{}class jt extends jp{}class Dt extends oh{}class Yt extends lc{}class Sr extends jd{}class dr extends $h{}class yr extends qh{}class xr extends Hh{}class nn extends D{}const sn=pa([{name:"a_pos",components:2,type:"Int16"}],4),{members:Hr}=sn;class pn{constructor(l=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=l}prepareSegment(l,h,v,S){const M=this.segments[this.segments.length-1];return l>pn.MAX_VERTEX_ARRAY_LENGTH&&st(`Max vertices per segment is ${pn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${pn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!M||M.vertexLength+l>pn.MAX_VERTEX_ARRAY_LENGTH||M.sortKey!==S?this.createNewSegment(h,v,S):M}createNewSegment(l,h,v){const S={vertexOffset:l.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0,vaos:{}};return v!==void 0&&(S.sortKey=v),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(S),S}getOrCreateLatestSegment(l,h,v){return this.prepareSegment(0,l,h,v)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const l of this.segments)for(const h in l.vaos)l.vaos[h].destroy()}static simpleSegment(l,h,v,S){return new pn([{vertexOffset:l,primitiveOffset:h,vertexLength:v,primitiveLength:S,vaos:{},sortKey:0}])}}function Ti(p,l){return 256*(p=Fe(Math.floor(p),0,255))+Fe(Math.floor(l),0,255)}pn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pt("SegmentVector",pn);const ka=pa([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),yo=pa([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var to,Io,ro,Xo={exports:{}},Po={exports:{}},gl={exports:{}},_s=(function(){if(ro)return Xo.exports;ro=1;var p=(to||(to=1,Po.exports=function(h,v){var S,M,k,B,V,Z,ie,ce;for(M=h.length-(S=3&h.length),k=v,V=3432918353,Z=461845907,ce=0;ce<M;)ie=255&h.charCodeAt(ce)|(255&h.charCodeAt(++ce))<<8|(255&h.charCodeAt(++ce))<<16|(255&h.charCodeAt(++ce))<<24,++ce,k=27492+(65535&(B=5*(65535&(k=(k^=ie=(65535&(ie=(ie=(65535&ie)*V+(((ie>>>16)*V&65535)<<16)&4294967295)<<15|ie>>>17))*Z+(((ie>>>16)*Z&65535)<<16)&4294967295)<<13|k>>>19))+((5*(k>>>16)&65535)<<16)&4294967295))+((58964+(B>>>16)&65535)<<16);switch(ie=0,S){case 3:ie^=(255&h.charCodeAt(ce+2))<<16;case 2:ie^=(255&h.charCodeAt(ce+1))<<8;case 1:k^=ie=(65535&(ie=(ie=(65535&(ie^=255&h.charCodeAt(ce)))*V+(((ie>>>16)*V&65535)<<16)&4294967295)<<15|ie>>>17))*Z+(((ie>>>16)*Z&65535)<<16)&4294967295}return k^=h.length,k=2246822507*(65535&(k^=k>>>16))+((2246822507*(k>>>16)&65535)<<16)&4294967295,k=3266489909*(65535&(k^=k>>>13))+((3266489909*(k>>>16)&65535)<<16)&4294967295,(k^=k>>>16)>>>0}),Po.exports),l=(Io||(Io=1,gl.exports=function(h,v){for(var S,M=h.length,k=v^M,B=0;M>=4;)S=1540483477*(65535&(S=255&h.charCodeAt(B)|(255&h.charCodeAt(++B))<<8|(255&h.charCodeAt(++B))<<16|(255&h.charCodeAt(++B))<<24))+((1540483477*(S>>>16)&65535)<<16),k=1540483477*(65535&k)+((1540483477*(k>>>16)&65535)<<16)^(S=1540483477*(65535&(S^=S>>>24))+((1540483477*(S>>>16)&65535)<<16)),M-=4,++B;switch(M){case 3:k^=(255&h.charCodeAt(B+2))<<16;case 2:k^=(255&h.charCodeAt(B+1))<<8;case 1:k=1540483477*(65535&(k^=255&h.charCodeAt(B)))+((1540483477*(k>>>16)&65535)<<16)}return k=1540483477*(65535&(k^=k>>>13))+((1540483477*(k>>>16)&65535)<<16),(k^=k>>>15)>>>0}),gl.exports);return Xo.exports=p,Xo.exports.murmur3=p,Xo.exports.murmur2=l,Xo.exports})(),os=f(_s);class Rl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,h,v,S){this.ids.push(Xh(l)),this.positions.push(h,v,S)}getPositions(l){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=Xh(l);let v=0,S=this.ids.length-1;for(;v<S;){const k=v+S>>1;this.ids[k]>=h?S=k:v=k+1}const M=[];for(;this.ids[v]===h;)M.push({index:this.positions[3*v],start:this.positions[3*v+1],end:this.positions[3*v+2]}),v++;return M}static serialize(l,h){const v=new Float64Array(l.ids),S=new Uint32Array(l.positions);return sh(v,S,0,v.length-1),h&&h.push(v.buffer,S.buffer),{ids:v,positions:S}}static deserialize(l){const h=new Rl;return h.ids=l.ids,h.positions=l.positions,h.indexed=!0,h}}function Xh(p){const l=+p;return!isNaN(l)&&l<=Number.MAX_SAFE_INTEGER?l:os(String(p))}function sh(p,l,h,v){for(;h<v;){const S=p[h+v>>1];let M=h-1,k=v+1;for(;;){do M++;while(p[M]<S);do k--;while(p[k]>S);if(M>=k)break;Ef(p,M,k),Ef(l,3*M,3*k),Ef(l,3*M+1,3*k+1),Ef(l,3*M+2,3*k+2)}k-h<v-k?(sh(p,l,h,k),h=k+1):(sh(p,l,k+1,v),v=k)}}function Ef(p,l,h){const v=p[l];p[l]=p[h],p[h]=v}Pt("FeaturePositionMap",Rl);class zu{constructor(l,h){this.gl=l.gl,this.location=h}}class Ud extends zu{constructor(l,h){super(l,h),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class em extends zu{constructor(l,h){super(l,h),this.current=[0,0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))}}class Vd extends zu{constructor(l,h){super(l,h),this.current=Mr.transparent}set(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))}}const Sc=new Float32Array(16);function Tf(p){return[Ti(255*p.r,255*p.g),Ti(255*p.b,255*p.a)]}class Gc{constructor(l,h,v){this.value=l,this.uniformNames=h.map((S=>`u_${S}`)),this.type=v}setUniform(l,h,v){l.set(v.constantOr(this.value))}getBinding(l,h,v){return this.type==="color"?new Vd(l,h):new Ud(l,h)}}class Wc{constructor(l,h){this.uniformNames=h.map((v=>`u_${v}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(l,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=l.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=l.tlbr}setConstantDashPositions(l,h){this.dashTo=[0,l.y,l.height,l.width],this.dashFrom=[0,h.y,h.height,h.width]}setUniform(l,h,v,S){let M=null;S==="u_pattern_to"?M=this.patternTo:S==="u_pattern_from"?M=this.patternFrom:S==="u_dasharray_to"?M=this.dashTo:S==="u_dasharray_from"?M=this.dashFrom:S==="u_pixel_ratio_to"?M=this.pixelRatioTo:S==="u_pixel_ratio_from"&&(M=this.pixelRatioFrom),M!==null&&l.set(M)}getBinding(l,h,v){return v.substr(0,9)==="u_pattern"||v.substr(0,12)==="u_dasharray_"?new em(l,h):new Ud(l,h)}}class uo{constructor(l,h,v,S){this.expression=l,this.type=v,this.maxValue=0,this.paintVertexAttributes=h.map((M=>({name:`a_${M}`,type:"Float32",components:v==="color"?2:1,offset:0}))),this.paintVertexArray=new S}populatePaintArray(l,h,v){const S=this.paintVertexArray.length,M=this.expression.evaluate(new Mi(0,v),h,{},v.canonical,[],v.formattedSection);this.paintVertexArray.resize(l),this._setPaintValue(S,l,M)}updatePaintArray(l,h,v,S,M){const k=this.expression.evaluate(new Mi(0,M),v,S);this._setPaintValue(l,h,k)}_setPaintValue(l,h,v){if(this.type==="color"){const S=Tf(v);for(let M=l;M<h;M++)this.paintVertexArray.emplace(M,S[0],S[1])}else{for(let S=l;S<h;S++)this.paintVertexArray.emplace(S,v);this.maxValue=Math.max(this.maxValue,Math.abs(v))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class no{constructor(l,h,v,S,M,k){this.expression=l,this.uniformNames=h.map((B=>`u_${B}_t`)),this.type=v,this.useIntegerZoom=S,this.zoom=M,this.maxValue=0,this.paintVertexAttributes=h.map((B=>({name:`a_${B}`,type:"Float32",components:v==="color"?4:2,offset:0}))),this.paintVertexArray=new k}populatePaintArray(l,h,v){const S=this.expression.evaluate(new Mi(this.zoom,v),h,{},v.canonical,[],v.formattedSection),M=this.expression.evaluate(new Mi(this.zoom+1,v),h,{},v.canonical,[],v.formattedSection),k=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(k,l,S,M)}updatePaintArray(l,h,v,S,M){const k=this.expression.evaluate(new Mi(this.zoom,M),v,S),B=this.expression.evaluate(new Mi(this.zoom+1,M),v,S);this._setPaintValue(l,h,k,B)}_setPaintValue(l,h,v,S){if(this.type==="color"){const M=Tf(v),k=Tf(S);for(let B=l;B<h;B++)this.paintVertexArray.emplace(B,M[0],M[1],k[0],k[1])}else{for(let M=l;M<h;M++)this.paintVertexArray.emplace(M,v,S);this.maxValue=Math.max(this.maxValue,Math.abs(v),Math.abs(S))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,h){const v=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,S=Fe(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);l.set(S)}getBinding(l,h,v){return new Ud(l,h)}}class Qs{constructor(l,h,v,S,M,k){this.expression=l,this.type=h,this.useIntegerZoom=v,this.zoom=S,this.layerId=k,this.zoomInPaintVertexArray=new M,this.zoomOutPaintVertexArray=new M}populatePaintArray(l,h,v){const S=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(l),this.zoomOutPaintVertexArray.resize(l),this._setPaintValues(S,l,this.getPositionIds(h),v)}updatePaintArray(l,h,v,S,M){this._setPaintValues(l,h,this.getPositionIds(v),M)}_setPaintValues(l,h,v,S){const M=this.getPositions(S);if(!M||!v)return;const k=M[v.min],B=M[v.mid],V=M[v.max];if(k&&B&&V)for(let Z=l;Z<h;Z++)this.emplace(this.zoomInPaintVertexArray,Z,B,k),this.emplace(this.zoomOutPaintVertexArray,Z,B,V)}upload(l){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const h=this.getVertexAttributes();this.zoomInPaintVertexBuffer=l.createVertexBuffer(this.zoomInPaintVertexArray,h,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=l.createVertexBuffer(this.zoomOutPaintVertexArray,h,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class el extends Qs{getPositions(l){return l.imagePositions}getPositionIds(l){return l.patterns&&l.patterns[this.layerId]}getVertexAttributes(){return ka.members}emplace(l,h,v,S){l.emplace(h,v.tlbr[0],v.tlbr[1],v.tlbr[2],v.tlbr[3],S.tlbr[0],S.tlbr[1],S.tlbr[2],S.tlbr[3],v.pixelRatio,S.pixelRatio)}}class i2 extends Qs{getPositions(l){return l.dashPositions}getPositionIds(l){return l.dashes&&l.dashes[this.layerId]}getVertexAttributes(){return yo.members}emplace(l,h,v,S){l.emplace(h,0,v.y,v.height,v.width,0,S.y,S.height,S.width)}}class a2{constructor(l,h,v){this.binders={},this._buffers=[];const S=[];for(const M in l.paint._values){if(!v(M))continue;const k=l.paint.get(M);if(!(k instanceof qi&&Gl(k.property.specification)))continue;const B=iC(M,l.type),V=k.value,Z=k.property.specification.type,ie=k.property.useIntegerZoom,ce=k.property.specification["property-type"],_e=ce==="cross-faded"||ce==="cross-faded-data-driven";if(V.kind==="constant")this.binders[M]=_e?new Wc(V.value,B):new Gc(V.value,B,Z),S.push(`/u_${M}`);else if(V.kind==="source"||_e){const Se=o2(M,Z,"source");this.binders[M]=_e?M==="line-dasharray"?new i2(V,Z,ie,h,Se,l.id):new el(V,Z,ie,h,Se,l.id):new uo(V,B,Z,Se),S.push(`/a_${M}`)}else{const Se=o2(M,Z,"composite");this.binders[M]=new no(V,B,Z,ie,h,Se),S.push(`/z_${M}`)}}this.cacheKey=S.sort().join("")}getMaxValue(l){const h=this.binders[l];return h instanceof uo||h instanceof no?h.maxValue:0}populatePaintArrays(l,h,v){for(const S in this.binders){const M=this.binders[S];(M instanceof uo||M instanceof no||M instanceof Qs)&&M.populatePaintArray(l,h,v)}}setConstantPatternPositions(l,h){for(const v in this.binders){const S=this.binders[v];S instanceof Wc&&S.setConstantPatternPositions(l,h)}}setConstantDashPositions(l,h){for(const v in this.binders){const S=this.binders[v];S instanceof Wc&&S.setConstantDashPositions(l,h)}}updatePaintArrays(l,h,v,S,M){let k=!1;for(const B in l){const V=h.getPositions(B);for(const Z of V){const ie=v.feature(Z.index);for(const ce in this.binders){const _e=this.binders[ce];if((_e instanceof uo||_e instanceof no||_e instanceof Qs)&&_e.expression.isStateDependent===!0){const Se=S.paint.get(ce);_e.expression=Se.value,_e.updatePaintArray(Z.start,Z.end,ie,l[B],M),k=!0}}}}return k}defines(){const l=[];for(const h in this.binders){const v=this.binders[h];(v instanceof Gc||v instanceof Wc)&&l.push(...v.uniformNames.map((S=>`#define HAS_UNIFORM_${S}`)))}return l}getBinderAttributes(){const l=[];for(const h in this.binders){const v=this.binders[h];if(v instanceof uo||v instanceof no)for(let S=0;S<v.paintVertexAttributes.length;S++)l.push(v.paintVertexAttributes[S].name);else if(v instanceof Qs){const S=v.getVertexAttributes();for(const M of S)l.push(M.name)}}return l}getBinderUniforms(){const l=[];for(const h in this.binders){const v=this.binders[h];if(v instanceof Gc||v instanceof Wc||v instanceof no)for(const S of v.uniformNames)l.push(S)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l,h){const v=[];for(const S in this.binders){const M=this.binders[S];if(M instanceof Gc||M instanceof Wc||M instanceof no){for(const k of M.uniformNames)if(h[k]){const B=M.getBinding(l,h[k],k);v.push({name:k,property:S,binding:B})}}}return v}setUniforms(l,h,v,S){for(const{name:M,property:k,binding:B}of h)this.binders[k].setUniform(B,S,v.get(k),M)}updatePaintBuffers(l){this._buffers=[];for(const h in this.binders){const v=this.binders[h];if(l&&v instanceof Qs){const S=l.fromScale===2?v.zoomInPaintVertexBuffer:v.zoomOutPaintVertexBuffer;S&&this._buffers.push(S)}else(v instanceof uo||v instanceof no)&&v.paintVertexBuffer&&this._buffers.push(v.paintVertexBuffer)}}upload(l){for(const h in this.binders){const v=this.binders[h];(v instanceof uo||v instanceof no||v instanceof Qs)&&v.upload(l)}this.updatePaintBuffers()}destroy(){for(const l in this.binders){const h=this.binders[l];(h instanceof uo||h instanceof no||h instanceof Qs)&&h.destroy()}}}class $d{constructor(l,h,v=()=>!0){this.programConfigurations={};for(const S of l)this.programConfigurations[S.id]=new a2(S,h,v);this.needsUpload=!1,this._featureMap=new Rl,this._bufferOffset=0}populatePaintArrays(l,h,v,S){for(const M in this.programConfigurations)this.programConfigurations[M].populatePaintArrays(l,h,S);h.id!==void 0&&this._featureMap.add(h.id,v,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,h,v,S){for(const M of v)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(l,this._featureMap,h,M,S)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(l);this.needsUpload=!1}}destroy(){for(const l in this.programConfigurations)this.programConfigurations[l].destroy()}}function iC(p,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[p]||[p.replace(`${l}-`,"").replace(/-/g,"_")]}function o2(p,l,h){const v={color:{source:qc,composite:g},number:{source:Wh,composite:qc}},S=(function(M){return{"line-pattern":{source:Lt,composite:Lt},"fill-pattern":{source:Lt,composite:Lt},"fill-extrusion-pattern":{source:Lt,composite:Lt},"line-dasharray":{source:jt,composite:jt}}[M]})(p);return S&&S[h]||v[l][h]}Pt("ConstantBinder",Gc),Pt("CrossFadedConstantBinder",Wc),Pt("SourceExpressionBinder",uo),Pt("CrossFadedPatternBinder",el),Pt("CrossFadedDasharrayBinder",i2),Pt("CompositeExpressionBinder",no),Pt("ProgramConfiguration",a2,{omit:["_buffers"]}),Pt("ProgramConfigurationSet",$d);const M_=Math.pow(2,14)-1,Yh=-M_-1;function Zh(p){const l=we/p.extent,h=p.loadGeometry();for(let v=0;v<h.length;v++){const S=h[v];for(let M=0;M<S.length;M++){const k=S[M],B=Math.round(k.x*l),V=Math.round(k.y*l);k.x=Fe(B,Yh,M_),k.y=Fe(V,Yh,M_),(B<k.x||B>k.x+1||V<k.y||V>k.y+1)&&st("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Kh(p,l){return{type:p.type,id:p.id,properties:p.properties,geometry:l?Zh(p):[]}}const k_=-32768;function R_(p,l,h,v,S){p.emplaceBack(k_+8*l+v,k_+8*h+S)}class jy{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=l.index,this.hasDependencies=!1,this.layoutVertexArray=new pt,this.indexArray=new xr,this.segments=new pn,this.programConfigurations=new $d(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(l,h,v){const S=this.layers[0],M=[];let k=null,B=!1,V=S.type==="heatmap";if(S.type==="circle"){const ie=S;k=ie.layout.get("circle-sort-key"),B=!k.isConstant(),V=V||ie.paint.get("circle-pitch-alignment")==="map"}const Z=V?h.subdivisionGranularity.circle:1;for(const{feature:ie,id:ce,index:_e,sourceLayerIndex:Se}of l){const Le=this.layers[0]._featureFilter.needGeometry,ze=Kh(ie,Le);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),ze,v))continue;const Ve=B?k.evaluate(ze,{},v):void 0,et={id:ce,properties:ie.properties,type:ie.type,sourceLayerIndex:Se,index:_e,geometry:Le?ze.geometry:Zh(ie),patterns:{},sortKey:Ve};M.push(et)}B&&M.sort(((ie,ce)=>ie.sortKey-ce.sortKey));for(const ie of M){const{geometry:ce,index:_e,sourceLayerIndex:Se}=ie,Le=l[_e].feature;this.addFeature(ie,ce,_e,v,Z),h.featureIndex.insert(Le,ce,_e,Se,this.index)}}update(l,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:v})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Hr),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,h,v,S,M=1){let k;switch(M){case 1:k=[0,7];break;case 3:k=[0,2,5,7];break;case 5:k=[0,1,3,4,6,7];break;case 7:k=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${M}; valid values are 1, 3, 5, 7.`)}const B=k.length;for(const V of h)for(const Z of V){const ie=Z.x,ce=Z.y;if(ie<0||ie>=we||ce<0||ce>=we)continue;const _e=this.segments.prepareSegment(B*B,this.layoutVertexArray,this.indexArray,l.sortKey),Se=_e.vertexLength;for(let Le=0;Le<B;Le++)for(let ze=0;ze<B;ze++)R_(this.layoutVertexArray,ie,ce,k[ze],k[Le]);for(let Le=0;Le<B-1;Le++)for(let ze=0;ze<B-1;ze++){const Ve=Se+Le*B+ze,et=Se+(Le+1)*B+ze;this.indexArray.emplaceBack(Ve,et+1,Ve+1),this.indexArray.emplaceBack(Ve,et,et+1)}_e.vertexLength+=B*B,_e.primitiveLength+=(B-1)*(B-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:{},canonical:S})}}function Uy(p,l){for(let h=0;h<p.length;h++)if(Vy(l,p[h]))return!0;for(let h=0;h<l.length;h++)if(Vy(p,l[h]))return!0;return!!aC(p,l)}function s2(p,l,h){return!!Vy(p,l)||!!oC(l,p,h)}function _6(p,l){if(p.length===1)return x6(l,p[0]);for(let h=0;h<l.length;h++){const v=l[h];for(let S=0;S<v.length;S++)if(Vy(p,v[S]))return!0}for(let h=0;h<p.length;h++)if(x6(l,p[h]))return!0;for(let h=0;h<l.length;h++)if(aC(p,l[h]))return!0;return!1}function cie(p,l,h){if(p.length>1){if(aC(p,l))return!0;for(let v=0;v<l.length;v++)if(oC(l[v],p,h))return!0}for(let v=0;v<p.length;v++)if(oC(p[v],l,h))return!0;return!1}function aC(p,l){if(p.length===0||l.length===0)return!1;for(let h=0;h<p.length-1;h++){const v=p[h],S=p[h+1];for(let M=0;M<l.length-1;M++)if(fie(v,S,l[M],l[M+1]))return!0}return!1}function fie(p,l,h,v){return $e(p,h,v)!==$e(l,h,v)&&$e(p,l,h)!==$e(p,l,v)}function oC(p,l,h){const v=h*h;if(l.length===1)return p.distSqr(l[0])<v;for(let S=1;S<l.length;S++)if(b6(p,l[S-1],l[S])<v)return!0;return!1}function b6(p,l,h){const v=l.distSqr(h);if(v===0)return p.distSqr(l);const S=((p.x-l.x)*(h.x-l.x)+(p.y-l.y)*(h.y-l.y))/v;return p.distSqr(S<0?l:S>1?h:h.sub(l)._mult(S)._add(l))}function x6(p,l){let h,v,S,M=!1;for(let k=0;k<p.length;k++){h=p[k];for(let B=0,V=h.length-1;B<h.length;V=B++)v=h[B],S=h[V],v.y>l.y!=S.y>l.y&&l.x<(S.x-v.x)*(l.y-v.y)/(S.y-v.y)+v.x&&(M=!M)}return M}function Vy(p,l){let h=!1;for(let v=0,S=p.length-1;v<p.length;S=v++){const M=p[v],k=p[S];M.y>l.y!=k.y>l.y&&l.x<(k.x-M.x)*(l.y-M.y)/(k.y-M.y)+M.x&&(h=!h)}return h}function hie(p,l,h){const v=h[0],S=h[2];if(p.x<v.x&&l.x<v.x||p.x>S.x&&l.x>S.x||p.y<v.y&&l.y<v.y||p.y>S.y&&l.y>S.y)return!1;const M=$e(p,l,h[0]);return M!==$e(p,l,h[1])||M!==$e(p,l,h[2])||M!==$e(p,l,h[3])}function $y(p,l,h){const v=l.paint.get(p).value;return v.kind==="constant"?v.value:h.programConfigurations.get(l.id).getMaxValue(p)}function l2(p){return Math.sqrt(p[0]*p[0]+p[1]*p[1])}function u2(p,l,h,v,S){if(!l[0]&&!l[1])return p;const M=c.convert(l)._mult(S);h==="viewport"&&M._rotate(-v);const k=[];for(let B=0;B<p.length;B++)k.push(p[B].sub(M));return k}function die(p){const l=[];for(let h=0;h<p.length;h++){const v=p[h],S=l.at(-1);(h===0||S&&!v.equals(S))&&l.push(v)}return l}function pie({queryGeometry:p,size:l},h){return s2(p,h,l)}function gie({queryGeometry:p,size:l,transform:h,unwrappedTileID:v,getElevation:S},M){return s2(p,M,l*(h.projectTileCoordinates(M.x,M.y,v,S).signedDistanceFromCamera/h.cameraToCenterDistance))}function mie({queryGeometry:p,size:l,transform:h,unwrappedTileID:v,getElevation:S},M){const k=h.projectTileCoordinates(M.x,M.y,v,S).signedDistanceFromCamera,B=l*(h.cameraToCenterDistance/k);return s2(p,sC(M,h,v,S),B)}function yie({queryGeometry:p,size:l,transform:h,unwrappedTileID:v,getElevation:S},M){return s2(p,sC(M,h,v,S),l)}function w6({queryGeometry:p,size:l,transform:h,unwrappedTileID:v,getElevation:S,pitchAlignment:M="map",pitchScale:k="map"},B){const V=M==="map"?k==="map"?pie:gie:k==="map"?mie:yie,Z={queryGeometry:p,size:l,transform:h,unwrappedTileID:v,getElevation:S};for(const ie of B)for(const ce of ie)if(V(Z,ce))return!0;return!1}function sC(p,l,h,v){const S=l.projectTileCoordinates(p.x,p.y,h,v).point;return new c((.5*S.x+.5)*l.width,(.5*-S.y+.5)*l.height)}let S6,E6;Pt("CircleBucket",jy,{omit:["layers"]});var vie={get paint(){return E6=E6||new $a({"circle-radius":new Sn(Rt.paint_circle["circle-radius"]),"circle-color":new Sn(Rt.paint_circle["circle-color"]),"circle-blur":new Sn(Rt.paint_circle["circle-blur"]),"circle-opacity":new Sn(Rt.paint_circle["circle-opacity"]),"circle-translate":new Tn(Rt.paint_circle["circle-translate"]),"circle-translate-anchor":new Tn(Rt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Tn(Rt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Tn(Rt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Sn(Rt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Sn(Rt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Sn(Rt.paint_circle["circle-stroke-opacity"])})},get layout(){return S6=S6||new $a({"circle-sort-key":new Sn(Rt.layout_circle["circle-sort-key"])})}};class _ie extends eo{constructor(l,h){super(l,vie,h)}createBucket(l){return new jy(l)}queryRadius(l){const h=l;return $y("circle-radius",this,h)+$y("circle-stroke-width",this,h)+l2(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:v,geometry:S,transform:M,pixelsToTileUnits:k,unwrappedTileID:B,getElevation:V}){const Z=u2(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-M.bearingInRadians,k),ie=this.paint.get("circle-radius").evaluate(h,v)+this.paint.get("circle-stroke-width").evaluate(h,v),ce=this.paint.get("circle-pitch-scale"),_e=this.paint.get("circle-pitch-alignment");let Se,Le;return _e==="map"?(Se=Z,Le=ie*k):(Se=(function(ze,Ve,et,Ct){return ze.map((rt=>sC(rt,Ve,et,Ct)))})(Z,M,B,V),Le=ie),w6({queryGeometry:Se,size:Le,transform:M,unwrappedTileID:B,getElevation:V,pitchAlignment:_e,pitchScale:ce},S)}}class T6 extends jy{}let C6;Pt("HeatmapBucket",T6,{omit:["layers"]});var bie={get paint(){return C6=C6||new $a({"heatmap-radius":new Sn(Rt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Sn(Rt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Tn(Rt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Fo(Rt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Tn(Rt.paint_heatmap["heatmap-opacity"])})}};function lC(p,{width:l,height:h},v,S){if(S){if(S instanceof Uint8ClampedArray)S=new Uint8Array(S.buffer);else if(S.length!==l*h*v)throw new RangeError(`mismatched image size. expected: ${S.length} but got: ${l*h*v}`)}else S=new Uint8Array(l*h*v);return p.width=l,p.height=h,p.data=S,p}function A6(p,{width:l,height:h},v){if(l===p.width&&h===p.height)return;const S=lC({},{width:l,height:h},v);uC(p,S,{x:0,y:0},{x:0,y:0},{width:Math.min(p.width,l),height:Math.min(p.height,h)},v),p.width=l,p.height=h,p.data=S.data}function uC(p,l,h,v,S,M){if(S.width===0||S.height===0)return l;if(S.width>p.width||S.height>p.height||h.x>p.width-S.width||h.y>p.height-S.height)throw new RangeError("out of range source coordinates for image copy");if(S.width>l.width||S.height>l.height||v.x>l.width-S.width||v.y>l.height-S.height)throw new RangeError("out of range destination coordinates for image copy");const k=p.data,B=l.data;if(k===B)throw new Error("srcData equals dstData, so image is already copied");for(let V=0;V<S.height;V++){const Z=((h.y+V)*p.width+h.x)*M,ie=((v.y+V)*l.width+v.x)*M;for(let ce=0;ce<S.width*M;ce++)B[ie+ce]=k[Z+ce]}return l}class D_{constructor(l,h){lC(this,l,1,h)}resize(l){A6(this,l,1)}clone(){return new D_({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,v,S,M){uC(l,h,v,S,M,1)}}class uc{constructor(l,h){lC(this,l,4,h)}resize(l){A6(this,l,4)}replace(l,h){h?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new uc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,v,S,M){uC(l,h,v,S,M,4)}setPixel(l,h,v){const S=4*(l*this.width+h);this.data[S+0]=Math.round(255*v.r/v.a),this.data[S+1]=Math.round(255*v.g/v.a),this.data[S+2]=Math.round(255*v.b/v.a),this.data[S+3]=Math.round(255*v.a)}}function I6(p){const l={},h=p.resolution||256,v=p.clips?p.clips.length:1,S=p.image||new uc({width:h,height:v});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const M=(k,B,V)=>{l[p.evaluationKey]=V;const Z=p.expression.evaluate(l);S.setPixel(k/4/h,B/4,Z)};if(p.clips)for(let k=0,B=0;k<v;++k,B+=4*h)for(let V=0,Z=0;V<h;V++,Z+=4){const ie=V/(h-1),{start:ce,end:_e}=p.clips[k];M(B,Z,ce*(1-ie)+_e*ie)}else for(let k=0,B=0;k<h;k++,B+=4)M(0,B,k/(h-1));return S}Pt("AlphaImage",D_),Pt("RGBAImage",uc);const cC="big-fb";class xie extends eo{createBucket(l){return new T6(l)}constructor(l,h){super(l,bie,h),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=I6({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(cC)&&this.heatmapFbos.delete(cC)}queryRadius(l){return $y("heatmap-radius",this,l)}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:v,geometry:S,transform:M,pixelsToTileUnits:k,unwrappedTileID:B,getElevation:V}){return w6({queryGeometry:l,size:this.paint.get("heatmap-radius").evaluate(h,v)*k,transform:M,unwrappedTileID:B,getElevation:V},S)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let P6;var wie={get paint(){return P6=P6||new $a({"hillshade-illumination-direction":new Tn(Rt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Tn(Rt.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Tn(Rt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Tn(Rt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Tn(Rt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Tn(Rt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Tn(Rt.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Tn(Rt.paint_hillshade["hillshade-method"])})}};class Sie extends eo{constructor(l,h){super(l,wie,h),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let l=this.paint.get("hillshade-illumination-direction").values,h=this.paint.get("hillshade-illumination-altitude").values,v=this.paint.get("hillshade-highlight-color").values,S=this.paint.get("hillshade-shadow-color").values;const M=Math.max(l.length,h.length,v.length,S.length);l=l.concat(Array(M-l.length).fill(l.at(-1))),h=h.concat(Array(M-h.length).fill(h.at(-1))),v=v.concat(Array(M-v.length).fill(v.at(-1))),S=S.concat(Array(M-S.length).fill(S.at(-1)));const k=h.map(Tr);return{directionRadians:l.map(Tr),altitudeRadians:k,shadowColor:S,highlightColor:v}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let M6;var Eie={get paint(){return M6=M6||new $a({"color-relief-opacity":new Tn(Rt["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Fo(Rt["paint_color-relief"]["color-relief-color"])})}};class fC{constructor(l,h,v,S){this.context=l,this.format=v,this.texture=l.gl.createTexture(),this.update(h,S)}update(l,h,v){const{width:S,height:M}=l,k=!(this.size&&this.size[0]===S&&this.size[1]===M||v),{context:B}=this,{gl:V}=B;if(this.useMipmap=!!(h&&h.useMipmap),V.bindTexture(V.TEXTURE_2D,this.texture),B.pixelStoreUnpackFlipY.set(!1),B.pixelStoreUnpack.set(1),B.pixelStoreUnpackPremultiplyAlpha.set(this.format===V.RGBA&&(!h||h.premultiply!==!1)),k)this.size=[S,M],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||pr(l)?V.texImage2D(V.TEXTURE_2D,0,this.format,this.format,V.UNSIGNED_BYTE,l):V.texImage2D(V.TEXTURE_2D,0,this.format,S,M,0,this.format,V.UNSIGNED_BYTE,l.data);else{const{x:Z,y:ie}=v||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||pr(l)?V.texSubImage2D(V.TEXTURE_2D,0,Z,ie,V.RGBA,V.UNSIGNED_BYTE,l):V.texSubImage2D(V.TEXTURE_2D,0,Z,ie,S,M,V.RGBA,V.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&V.generateMipmap(V.TEXTURE_2D),B.pixelStoreUnpackFlipY.setDefault(),B.pixelStoreUnpack.setDefault(),B.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(l,h,v){const{context:S}=this,{gl:M}=S;M.bindTexture(M.TEXTURE_2D,this.texture),v!==M.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(v=M.LINEAR),l!==this.filter&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,l),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,v||l),this.filter=l),h!==this.wrap&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,h),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}class k6{constructor(l,h,v,S=1,M=1,k=1,B=0){if(this.uid=l,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(v&&!["mapbox","terrarium","custom"].includes(v))return void st(`"${v}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const V=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),v){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=S,this.greenFactor=M,this.blueFactor=k,this.baseShift=B;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Z=0;Z<V;Z++)this.data[this._idx(-1,Z)]=this.data[this._idx(0,Z)],this.data[this._idx(V,Z)]=this.data[this._idx(V-1,Z)],this.data[this._idx(Z,-1)]=this.data[this._idx(Z,0)],this.data[this._idx(Z,V)]=this.data[this._idx(Z,V-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(V,-1)]=this.data[this._idx(V-1,0)],this.data[this._idx(-1,V)]=this.data[this._idx(0,V-1)],this.data[this._idx(V,V)]=this.data[this._idx(V-1,V-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Z=0;Z<V;Z++)for(let ie=0;ie<V;ie++){const ce=this.get(Z,ie);ce>this.max&&(this.max=ce),ce<this.min&&(this.min=ce)}}get(l,h){const v=new Uint8Array(this.data.buffer),S=4*this._idx(l,h);return this.unpack(v[S],v[S+1],v[S+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(l,h){if(l<-1||l>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${l}, y: ${h}, dim: ${this.dim}`);return(h+1)*this.stride+(l+1)}unpack(l,h,v){return l*this.redFactor+h*this.greenFactor+v*this.blueFactor-this.baseShift}pack(l){return R6(l,this.getUnpackVector())}getPixels(){return new uc({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(l,h,v){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let S=h*this.dim,M=h*this.dim+this.dim,k=v*this.dim,B=v*this.dim+this.dim;switch(h){case-1:S=M-1;break;case 1:M=S+1}switch(v){case-1:k=B-1;break;case 1:B=k+1}const V=-h*this.dim,Z=-v*this.dim;for(let ie=k;ie<B;ie++)for(let ce=S;ce<M;ce++)this.data[this._idx(ce,ie)]=l.data[this._idx(ce+V,ie+Z)]}}function R6(p,l){const h=l[0],v=l[1],S=l[2],M=l[3],k=Math.min(h,v,S),B=Math.round((p+M)/k);return{r:Math.floor(B*k/h)%256,g:Math.floor(B*k/v)%256,b:Math.floor(B*k/S)%256}}Pt("DEMData",k6);class Tie extends eo{constructor(l,h){super(l,Eie,h)}_createColorRamp(l){const h={elevationStops:[],colorStops:[]},v=this._transitionablePaint._values["color-relief-color"].value.expression;if(v instanceof Rp&&v._styleExpression.expression instanceof Un){this.colorRampExpression=v;const k=v._styleExpression.expression;h.elevationStops=k.labels,h.colorStops=[];for(const B of h.elevationStops)h.colorStops.push(k.evaluate({globals:{elevation:B}}))}if(h.elevationStops.length<1&&(h.elevationStops=[0],h.colorStops=[Mr.transparent]),h.elevationStops.length<2&&(h.elevationStops.push(h.elevationStops[0]+1),h.colorStops.push(h.colorStops[0])),h.elevationStops.length<=l)return h;const S={elevationStops:[],colorStops:[]},M=(h.elevationStops.length-1)/(l-1);for(let k=0;k<h.elevationStops.length-.5;k+=M)S.elevationStops.push(h.elevationStops[Math.round(k)]),S.colorStops.push(h.colorStops[Math.round(k)]);return st(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${l}, provided: ${h.elevationStops.length}`),S}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(l,h,v){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const S=this._createColorRamp(h),M=new uc({width:S.colorStops.length,height:1}),k=new uc({width:S.colorStops.length,height:1});for(let B=0;B<S.elevationStops.length;B++){const V=R6(S.elevationStops[B],v);k.setPixel(0,B,new Mr(V.r/255,V.g/255,V.b/255,1)),M.setPixel(0,B,S.colorStops[B])}return this.colorRampTextures={elevationTexture:new fC(l,k,l.gl.RGBA),colorTexture:new fC(l,M,l.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const Cie=pa([{name:"a_pos",components:2,type:"Int16"}],4),{members:Aie}=Cie;function c2(p,l,h){const v=h.patternDependencies;let S=!1;for(const M of l){const k=M.paint.get(`${p}-pattern`);k.isConstant()||(S=!0);const B=k.constantOr(null);B&&(S=!0,v[B.to]=!0,v[B.from]=!0)}return S}function hC(p,l,h,v,S){const{zoom:M}=v,k=S.patternDependencies;for(const B of l){const V=B.paint.get(`${p}-pattern`).value;if(V.kind!=="constant"){let Z=V.evaluate({zoom:M-1},h,{},S.availableImages),ie=V.evaluate({zoom:M},h,{},S.availableImages),ce=V.evaluate({zoom:M+1},h,{},S.availableImages);Z=Z&&Z.name?Z.name:Z,ie=ie&&ie.name?ie.name:ie,ce=ce&&ce.name?ce.name:ce,k[Z]=!0,k[ie]=!0,k[ce]=!0,h.patterns[B.id]={min:Z,mid:ie,max:ce}}}return h}function D6(p,l,h,v,S){let M;if(S===(function(k,B,V,Z){let ie=0;for(let ce=B,_e=V-Z;ce<V;ce+=Z)ie+=(k[_e]-k[ce])*(k[ce+1]+k[_e+1]),_e=ce;return ie})(p,l,h,v)>0)for(let k=l;k<h;k+=v)M=F6(k/v|0,p[k],p[k+1],M);else for(let k=h-v;k>=l;k-=v)M=F6(k/v|0,p[k],p[k+1],M);return M&&qy(M,M.next)&&(F_(M),M=M.next),M}function tm(p,l){if(!p)return p;l||(l=p);let h,v=p;do if(h=!1,v.steiner||!qy(v,v.next)&&bs(v.prev,v,v.next)!==0)v=v.next;else{if(F_(v),v=l=v.prev,v===v.next)break;h=!0}while(h||v!==l);return l}function O_(p,l,h,v,S,M,k){if(!p)return;!k&&M&&(function(V,Z,ie,ce){let _e=V;do _e.z===0&&(_e.z=dC(_e.x,_e.y,Z,ie,ce)),_e.prevZ=_e.prev,_e.nextZ=_e.next,_e=_e.next;while(_e!==V);_e.prevZ.nextZ=null,_e.prevZ=null,(function(Se){let Le,ze=1;do{let Ve,et=Se;Se=null;let Ct=null;for(Le=0;et;){Le++;let rt=et,ut=0;for(let Ft=0;Ft<ze&&(ut++,rt=rt.nextZ,rt);Ft++);let kt=ze;for(;ut>0||kt>0&&rt;)ut!==0&&(kt===0||!rt||et.z<=rt.z)?(Ve=et,et=et.nextZ,ut--):(Ve=rt,rt=rt.nextZ,kt--),Ct?Ct.nextZ=Ve:Se=Ve,Ve.prevZ=Ct,Ct=Ve;et=rt}Ct.nextZ=null,ze*=2}while(Le>1)})(_e)})(p,v,S,M);let B=p;for(;p.prev!==p.next;){const V=p.prev,Z=p.next;if(M?Pie(p,v,S,M):Iie(p))l.push(V.i,p.i,Z.i),F_(p),p=Z.next,B=Z.next;else if((p=Z)===B){k?k===1?O_(p=Mie(tm(p),l),l,h,v,S,M,2):k===2&&kie(p,l,h,v,S,M):O_(tm(p),l,h,v,S,M,1);break}}}function Iie(p){const l=p.prev,h=p,v=p.next;if(bs(l,h,v)>=0)return!1;const S=l.x,M=h.x,k=v.x,B=l.y,V=h.y,Z=v.y,ie=Math.min(S,M,k),ce=Math.min(B,V,Z),_e=Math.max(S,M,k),Se=Math.max(B,V,Z);let Le=v.next;for(;Le!==l;){if(Le.x>=ie&&Le.x<=_e&&Le.y>=ce&&Le.y<=Se&&L_(S,B,M,V,k,Z,Le.x,Le.y)&&bs(Le.prev,Le,Le.next)>=0)return!1;Le=Le.next}return!0}function Pie(p,l,h,v){const S=p.prev,M=p,k=p.next;if(bs(S,M,k)>=0)return!1;const B=S.x,V=M.x,Z=k.x,ie=S.y,ce=M.y,_e=k.y,Se=Math.min(B,V,Z),Le=Math.min(ie,ce,_e),ze=Math.max(B,V,Z),Ve=Math.max(ie,ce,_e),et=dC(Se,Le,l,h,v),Ct=dC(ze,Ve,l,h,v);let rt=p.prevZ,ut=p.nextZ;for(;rt&&rt.z>=et&&ut&&ut.z<=Ct;){if(rt.x>=Se&&rt.x<=ze&&rt.y>=Le&&rt.y<=Ve&&rt!==S&&rt!==k&&L_(B,ie,V,ce,Z,_e,rt.x,rt.y)&&bs(rt.prev,rt,rt.next)>=0||(rt=rt.prevZ,ut.x>=Se&&ut.x<=ze&&ut.y>=Le&&ut.y<=Ve&&ut!==S&&ut!==k&&L_(B,ie,V,ce,Z,_e,ut.x,ut.y)&&bs(ut.prev,ut,ut.next)>=0))return!1;ut=ut.nextZ}for(;rt&&rt.z>=et;){if(rt.x>=Se&&rt.x<=ze&&rt.y>=Le&&rt.y<=Ve&&rt!==S&&rt!==k&&L_(B,ie,V,ce,Z,_e,rt.x,rt.y)&&bs(rt.prev,rt,rt.next)>=0)return!1;rt=rt.prevZ}for(;ut&&ut.z<=Ct;){if(ut.x>=Se&&ut.x<=ze&&ut.y>=Le&&ut.y<=Ve&&ut!==S&&ut!==k&&L_(B,ie,V,ce,Z,_e,ut.x,ut.y)&&bs(ut.prev,ut,ut.next)>=0)return!1;ut=ut.nextZ}return!0}function Mie(p,l){let h=p;do{const v=h.prev,S=h.next.next;!qy(v,S)&&L6(v,h,h.next,S)&&N_(v,S)&&N_(S,v)&&(l.push(v.i,h.i,S.i),F_(h),F_(h.next),h=p=S),h=h.next}while(h!==p);return tm(h)}function kie(p,l,h,v,S,M){let k=p;do{let B=k.next.next;for(;B!==k.prev;){if(k.i!==B.i&&Nie(k,B)){let V=N6(k,B);return k=tm(k,k.next),V=tm(V,V.next),O_(k,l,h,v,S,M,0),void O_(V,l,h,v,S,M,0)}B=B.next}k=k.next}while(k!==p)}function Rie(p,l){let h=p.x-l.x;return h===0&&(h=p.y-l.y,h===0)&&(h=(p.next.y-p.y)/(p.next.x-p.x)-(l.next.y-l.y)/(l.next.x-l.x)),h}function Die(p,l){const h=(function(S,M){let k=M;const B=S.x,V=S.y;let Z,ie=-1/0;if(qy(S,k))return k;do{if(qy(S,k.next))return k.next;if(V<=k.y&&V>=k.next.y&&k.next.y!==k.y){const ze=k.x+(V-k.y)*(k.next.x-k.x)/(k.next.y-k.y);if(ze<=B&&ze>ie&&(ie=ze,Z=k.x<k.next.x?k:k.next,ze===B))return Z}k=k.next}while(k!==M);if(!Z)return null;const ce=Z,_e=Z.x,Se=Z.y;let Le=1/0;k=Z;do{if(B>=k.x&&k.x>=_e&&B!==k.x&&O6(V<Se?B:ie,V,_e,Se,V<Se?ie:B,V,k.x,k.y)){const ze=Math.abs(V-k.y)/(B-k.x);N_(k,S)&&(ze<Le||ze===Le&&(k.x>Z.x||k.x===Z.x&&Oie(Z,k)))&&(Z=k,Le=ze)}k=k.next}while(k!==ce);return Z})(p,l);if(!h)return l;const v=N6(h,p);return tm(v,v.next),tm(h,h.next)}function Oie(p,l){return bs(p.prev,p,l.prev)<0&&bs(l.next,p,p.next)<0}function dC(p,l,h,v,S){return(p=1431655765&((p=858993459&((p=252645135&((p=16711935&((p=(p-h)*S|0)|p<<8))|p<<4))|p<<2))|p<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-v)*S|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function Lie(p){let l=p,h=p;do(l.x<h.x||l.x===h.x&&l.y<h.y)&&(h=l),l=l.next;while(l!==p);return h}function O6(p,l,h,v,S,M,k,B){return(S-k)*(l-B)>=(p-k)*(M-B)&&(p-k)*(v-B)>=(h-k)*(l-B)&&(h-k)*(M-B)>=(S-k)*(v-B)}function L_(p,l,h,v,S,M,k,B){return!(p===k&&l===B)&&O6(p,l,h,v,S,M,k,B)}function Nie(p,l){return p.next.i!==l.i&&p.prev.i!==l.i&&!(function(h,v){let S=h;do{if(S.i!==h.i&&S.next.i!==h.i&&S.i!==v.i&&S.next.i!==v.i&&L6(S,S.next,h,v))return!0;S=S.next}while(S!==h);return!1})(p,l)&&(N_(p,l)&&N_(l,p)&&(function(h,v){let S=h,M=!1;const k=(h.x+v.x)/2,B=(h.y+v.y)/2;do S.y>B!=S.next.y>B&&S.next.y!==S.y&&k<(S.next.x-S.x)*(B-S.y)/(S.next.y-S.y)+S.x&&(M=!M),S=S.next;while(S!==h);return M})(p,l)&&(bs(p.prev,p,l.prev)||bs(p,l.prev,l))||qy(p,l)&&bs(p.prev,p,p.next)>0&&bs(l.prev,l,l.next)>0)}function bs(p,l,h){return(l.y-p.y)*(h.x-l.x)-(l.x-p.x)*(h.y-l.y)}function qy(p,l){return p.x===l.x&&p.y===l.y}function L6(p,l,h,v){const S=h2(bs(p,l,h)),M=h2(bs(p,l,v)),k=h2(bs(h,v,p)),B=h2(bs(h,v,l));return S!==M&&k!==B||!(S!==0||!f2(p,h,l))||!(M!==0||!f2(p,v,l))||!(k!==0||!f2(h,p,v))||!(B!==0||!f2(h,l,v))}function f2(p,l,h){return l.x<=Math.max(p.x,h.x)&&l.x>=Math.min(p.x,h.x)&&l.y<=Math.max(p.y,h.y)&&l.y>=Math.min(p.y,h.y)}function h2(p){return p>0?1:p<0?-1:0}function N_(p,l){return bs(p.prev,p,p.next)<0?bs(p,l,p.next)>=0&&bs(p,p.prev,l)>=0:bs(p,l,p.prev)<0||bs(p,p.next,l)<0}function N6(p,l){const h=pC(p.i,p.x,p.y),v=pC(l.i,l.x,l.y),S=p.next,M=l.prev;return p.next=l,l.prev=p,h.next=S,S.prev=h,v.next=h,h.prev=v,M.next=v,v.prev=M,v}function F6(p,l,h,v){const S=pC(p,l,h);return v?(S.next=v.next,S.prev=v,v.next.prev=S,v.next=S):(S.prev=S,S.next=S),S}function F_(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function pC(p,l,h){return{i:p,x:l,y:h,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Hy{constructor(l,h){if(h>l)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=l,this._minGranularity=h}getGranularityForZoomLevel(l){return Math.max(Math.floor(this._baseZoomGranularity/(1<<l)),this._minGranularity,1)}}class d2{constructor(l){this.fill=l.fill,this.line=l.line,this.tile=l.tile,this.stencil=l.stencil,this.circle=l.circle}}d2.noSubdivision=new d2({fill:new Hy(0,0),line:new Hy(0,0),tile:new Hy(0,0),stencil:new Hy(0,0),circle:1}),Pt("SubdivisionGranularityExpression",Hy),Pt("SubdivisionGranularitySetting",d2);const Gy=-32768,B_=32767;class Fie{constructor(l,h){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=l,this._granularityCellSize=we/l,this._canonical=h}_getKey(l,h){return(l+=32768)<<16|h+32768}_vertexToIndex(l,h){if(l<-32768||h<-32768||l>32767||h>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const v=0|Math.round(l),S=0|Math.round(h),M=this._getKey(v,S);if(this._vertexDictionary.has(M))return this._vertexDictionary.get(M);const k=this._vertexBuffer.length/2;return this._vertexDictionary.set(M,k),this._vertexBuffer.push(v,S),k}_subdivideTrianglesScanline(l){if(this._granularity<2)return(function(S,M){const k=[];for(let B=0;B<M.length;B+=3){const V=M[B],Z=M[B+1],ie=M[B+2],ce=S[2*V],_e=S[2*V+1];(S[2*Z]-ce)*(S[2*ie+1]-_e)-(S[2*Z+1]-_e)*(S[2*ie]-ce)>0?(k.push(V),k.push(ie),k.push(Z)):(k.push(V),k.push(Z),k.push(ie))}return k})(this._vertexBuffer,l);const h=[],v=l.length;for(let S=0;S<v;S+=3){const M=[l[S+0],l[S+1],l[S+2]],k=[this._vertexBuffer[2*l[S+0]+0],this._vertexBuffer[2*l[S+0]+1],this._vertexBuffer[2*l[S+1]+0],this._vertexBuffer[2*l[S+1]+1],this._vertexBuffer[2*l[S+2]+0],this._vertexBuffer[2*l[S+2]+1]];let B=1/0,V=1/0,Z=-1/0,ie=-1/0;for(let ze=0;ze<3;ze++){const Ve=k[2*ze],et=k[2*ze+1];B=Math.min(B,Ve),Z=Math.max(Z,Ve),V=Math.min(V,et),ie=Math.max(ie,et)}if(B===Z||V===ie)continue;const ce=Math.floor(B/this._granularityCellSize),_e=Math.ceil(Z/this._granularityCellSize),Se=Math.floor(V/this._granularityCellSize),Le=Math.ceil(ie/this._granularityCellSize);if(ce!==_e||Se!==Le)for(let ze=Se;ze<Le;ze++){const Ve=this._scanlineGenerateVertexRingForCellRow(ze,k,M);Bie(this._vertexBuffer,Ve,h)}else h.push(...M)}return h}_scanlineGenerateVertexRingForCellRow(l,h,v){const S=l*this._granularityCellSize,M=S+this._granularityCellSize,k=[];for(let B=0;B<3;B++){const V=h[2*B],Z=h[2*B+1],ie=h[2*(B+1)%6],ce=h[(2*(B+1)+1)%6],_e=h[2*(B+2)%6],Se=h[(2*(B+2)+1)%6],Le=ie-V,ze=ce-Z,Ve=Le===0,et=ze===0,Ct=(S-Z)/ze,rt=(M-Z)/ze,ut=Math.min(Ct,rt),kt=Math.max(Ct,rt);if(!et&&(ut>=1||kt<=0)||et&&(Z<S||Z>M)){ce>=S&&ce<=M&&k.push(v[(B+1)%3]);continue}!et&&ut>0&&k.push(this._vertexToIndex(V+Le*ut,Z+ze*ut));const Ft=V+Le*Math.max(ut,0),hr=V+Le*Math.min(kt,1);Ve||this._generateIntraEdgeVertices(k,V,Z,ie,ce,Ft,hr),!et&&kt<1&&k.push(this._vertexToIndex(V+Le*kt,Z+ze*kt)),(et||ce>=S&&ce<=M)&&k.push(v[(B+1)%3]),!et&&(ce<=S||ce>=M)&&this._generateInterEdgeVertices(k,V,Z,ie,ce,_e,Se,hr,S,M)}return k}_generateIntraEdgeVertices(l,h,v,S,M,k,B){const V=S-h,Z=M-v,ie=Z===0,ce=ie?Math.min(h,S):Math.min(k,B),_e=ie?Math.max(h,S):Math.max(k,B),Se=Math.floor(ce/this._granularityCellSize)+1,Le=Math.ceil(_e/this._granularityCellSize)-1;if(ie?h<S:k<B)for(let ze=Se;ze<=Le;ze++){const Ve=ze*this._granularityCellSize;l.push(this._vertexToIndex(Ve,v+Z*(Ve-h)/V))}else for(let ze=Le;ze>=Se;ze--){const Ve=ze*this._granularityCellSize;l.push(this._vertexToIndex(Ve,v+Z*(Ve-h)/V))}}_generateInterEdgeVertices(l,h,v,S,M,k,B,V,Z,ie){const ce=M-v,_e=k-S,Se=B-M,Le=(Z-M)/Se,ze=(ie-M)/Se,Ve=Math.min(Le,ze),et=Math.max(Le,ze),Ct=S+_e*Ve;let rt=Math.floor(Math.min(Ct,V)/this._granularityCellSize)+1,ut=Math.ceil(Math.max(Ct,V)/this._granularityCellSize)-1,kt=V<Ct;const Ft=Se===0;if(Ft&&(B===Z||B===ie))return;if(Ft||Ve>=1||et<=0){const Or=v-B,Pr=k+(h-k)*Math.min((Z-B)/Or,(ie-B)/Or);rt=Math.floor(Math.min(Pr,V)/this._granularityCellSize)+1,ut=Math.ceil(Math.max(Pr,V)/this._granularityCellSize)-1,kt=V<Pr}const hr=ce>0?ie:Z;if(kt)for(let Or=rt;Or<=ut;Or++)l.push(this._vertexToIndex(Or*this._granularityCellSize,hr));else for(let Or=ut;Or>=rt;Or--)l.push(this._vertexToIndex(Or*this._granularityCellSize,hr))}_generateOutline(l){const h=[];for(const v of l){const S=rm(v,this._granularity,!0),M=this._pointArrayToIndices(S),k=[];for(let B=1;B<M.length;B++)k.push(M[B-1]),k.push(M[B]);h.push(k)}return h}_handlePoles(l){let h=!1,v=!1;this._canonical&&(this._canonical.y===0&&(h=!0),this._canonical.y===(1<<this._canonical.z)-1&&(v=!0)),(h||v)&&this._fillPoles(l,h,v)}_ensureNoPoleVertices(){const l=this._vertexBuffer;for(let h=0;h<l.length;h+=2){const v=l[h+1];v===Gy&&(l[h+1]=-32767),v===B_&&(l[h+1]=32766)}}_generatePoleQuad(l,h,v,S,M,k){S>M!=(k===Gy)?(l.push(h),l.push(v),l.push(this._vertexToIndex(S,k)),l.push(v),l.push(this._vertexToIndex(M,k)),l.push(this._vertexToIndex(S,k))):(l.push(v),l.push(h),l.push(this._vertexToIndex(S,k)),l.push(this._vertexToIndex(M,k)),l.push(v),l.push(this._vertexToIndex(S,k)))}_fillPoles(l,h,v){const S=this._vertexBuffer,M=we,k=l.length;for(let B=2;B<k;B+=3){const V=l[B-2],Z=l[B-1],ie=l[B],ce=S[2*V],_e=S[2*V+1],Se=S[2*Z],Le=S[2*Z+1],ze=S[2*ie],Ve=S[2*ie+1];h&&(_e===0&&Le===0&&this._generatePoleQuad(l,V,Z,ce,Se,Gy),Le===0&&Ve===0&&this._generatePoleQuad(l,Z,ie,Se,ze,Gy),Ve===0&&_e===0&&this._generatePoleQuad(l,ie,V,ze,ce,Gy)),v&&(_e===M&&Le===M&&this._generatePoleQuad(l,V,Z,ce,Se,B_),Le===M&&Ve===M&&this._generatePoleQuad(l,Z,ie,Se,ze,B_),Ve===M&&_e===M&&this._generatePoleQuad(l,ie,V,ze,ce,B_))}}_initializeVertices(l){for(let h=0;h<l.length;h+=2)this._vertexToIndex(l[h],l[h+1])}subdividePolygonInternal(l,h){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:v,holeIndices:S}=(function(B){const V=[],Z=[];for(const ie of B)if(ie.length!==0){ie!==B[0]&&V.push(Z.length/2);for(let ce=0;ce<ie.length;ce++)Z.push(ie[ce].x),Z.push(ie[ce].y)}return{flattened:Z,holeIndices:V}})(l);let M;this._initializeVertices(v);try{const B=(function(Z,ie,ce=2){const _e=ie&&ie.length,Se=_e?ie[0]*ce:Z.length;let Le=D6(Z,0,Se,ce,!0);const ze=[];if(!Le||Le.next===Le.prev)return ze;let Ve,et,Ct;if(_e&&(Le=(function(rt,ut,kt,Ft){const hr=[];for(let Or=0,Pr=ut.length;Or<Pr;Or++){const Vr=D6(rt,ut[Or]*Ft,Or<Pr-1?ut[Or+1]*Ft:rt.length,Ft,!1);Vr===Vr.next&&(Vr.steiner=!0),hr.push(Lie(Vr))}hr.sort(Rie);for(let Or=0;Or<hr.length;Or++)kt=Die(hr[Or],kt);return kt})(Z,ie,Le,ce)),Z.length>80*ce){Ve=Z[0],et=Z[1];let rt=Ve,ut=et;for(let kt=ce;kt<Se;kt+=ce){const Ft=Z[kt],hr=Z[kt+1];Ft<Ve&&(Ve=Ft),hr<et&&(et=hr),Ft>rt&&(rt=Ft),hr>ut&&(ut=hr)}Ct=Math.max(rt-Ve,ut-et),Ct=Ct!==0?32767/Ct:0}return O_(Le,ze,ce,Ve,et,Ct,0),ze})(v,S),V=this._convertIndices(v,B);M=this._subdivideTrianglesScanline(V)}catch(B){console.error(B)}let k=[];return h&&(k=this._generateOutline(l)),this._ensureNoPoleVertices(),this._handlePoles(M),{verticesFlattened:this._vertexBuffer,indicesTriangles:M,indicesLineList:k}}_convertIndices(l,h){const v=[];for(let S=0;S<h.length;S++)v.push(this._vertexToIndex(l[2*h[S]],l[2*h[S]+1]));return v}_pointArrayToIndices(l){const h=[];for(let v=0;v<l.length;v++){const S=l[v];h.push(this._vertexToIndex(S.x,S.y))}return h}}function B6(p,l,h,v=!0){return new Fie(h,l).subdividePolygonInternal(p,v)}function rm(p,l,h=!1){if(!p||p.length<1)return[];if(p.length<2)return[];const v=p[0],S=p[p.length-1],M=h&&(v.x!==S.x||v.y!==S.y);if(l<2)return M?[...p,p[0]]:[...p];const k=Math.floor(we/l),B=[];B.push(new c(p[0].x,p[0].y));const V=p.length,Z=M?V:V-1;for(let ie=0;ie<Z;ie++){const ce=p[ie],_e=ie<V-1?p[ie+1]:p[0],Se=ce.x,Le=ce.y,ze=_e.x,Ve=_e.y,et=Se!==ze,Ct=Le!==Ve;if(!et&&!Ct)continue;const rt=ze-Se,ut=Ve-Le,kt=Math.abs(rt),Ft=Math.abs(ut);let hr=Se,Or=Le;for(;;){const Vr=rt>0?(Math.floor(hr/k)+1)*k:(Math.ceil(hr/k)-1)*k,dn=ut>0?(Math.floor(Or/k)+1)*k:(Math.ceil(Or/k)-1)*k,Wr=Math.abs(hr-Vr),kr=Math.abs(Or-dn),Er=Math.abs(hr-ze),Cn=Math.abs(Or-Ve),xn=et?Wr/kt:Number.POSITIVE_INFINITY,Mn=Ct?kr/Ft:Number.POSITIVE_INFINITY;if((Er<=Wr||!et)&&(Cn<=kr||!Ct))break;if(xn<Mn&&et||!Ct){hr=Vr,Or+=ut*xn;const vn=new c(hr,Math.round(Or));B[B.length-1].x===vn.x&&B[B.length-1].y===vn.y||B.push(vn)}else{hr+=rt*Mn,Or=dn;const vn=new c(Math.round(hr),Or);B[B.length-1].x===vn.x&&B[B.length-1].y===vn.y||B.push(vn)}}const Pr=new c(ze,Ve);B[B.length-1].x===Pr.x&&B[B.length-1].y===Pr.y||B.push(Pr)}return B}function Bie(p,l,h){if(l.length===0)throw new Error("Subdivision vertex ring is empty.");let v=0,S=p[2*l[0]];for(let V=1;V<l.length;V++){const Z=p[2*l[V]];Z<S&&(S=Z,v=V)}const M=l.length;let k=v,B=(k+1)%M;for(;;){const V=k-1>=0?k-1:M-1,Z=(B+1)%M,ie=p[2*l[V]],ce=p[2*l[Z]],_e=p[2*l[k]],Se=p[2*l[k]+1],Le=p[2*l[B]+1];let ze=!1;if(ie<ce)ze=!0;else if(ie>ce)ze=!1;else{const Ve=Le-Se,et=-(p[2*l[B]]-_e),Ct=Se<Le?1:-1;((ie-_e)*Ve+(p[2*l[V]+1]-Se)*et)*Ct>((ce-_e)*Ve+(p[2*l[Z]+1]-Se)*et)*Ct&&(ze=!0)}if(ze){const Ve=l[V],et=l[k],Ct=l[B];Ve!==et&&Ve!==Ct&&et!==Ct&&h.push(Ct,et,Ve),k--,k<0&&(k=M-1)}else{const Ve=l[Z],et=l[k],Ct=l[B];Ve!==et&&Ve!==Ct&&et!==Ct&&h.push(Ct,et,Ve),B++,B>=M&&(B=0)}if(V===Z)break}}function z6(p,l,h,v,S,M,k,B,V){const Z=S.length/2,ie=k&&B&&V;if(Z<pn.MAX_VERTEX_ARRAY_LENGTH){const ce=l.prepareSegment(Z,h,v),_e=ce.vertexLength;for(let ze=0;ze<M.length;ze+=3)v.emplaceBack(_e+M[ze],_e+M[ze+1],_e+M[ze+2]);let Se,Le;ce.vertexLength+=Z,ce.primitiveLength+=M.length/3,ie&&(Le=k.prepareSegment(Z,h,B),Se=Le.vertexLength,Le.vertexLength+=Z);for(let ze=0;ze<S.length;ze+=2)p(S[ze],S[ze+1]);if(ie)for(let ze=0;ze<V.length;ze++){const Ve=V[ze];for(let et=1;et<Ve.length;et+=2)B.emplaceBack(Se+Ve[et-1],Se+Ve[et]);Le.primitiveLength+=Ve.length/2}}else(function(ce,_e,Se,Le,ze,Ve){const et=[];for(let Ft=0;Ft<Le.length/2;Ft++)et.push(-1);const Ct={count:0};let rt=0,ut=ce.getOrCreateLatestSegment(_e,Se),kt=ut.vertexLength;for(let Ft=2;Ft<ze.length;Ft+=3){const hr=ze[Ft-2],Or=ze[Ft-1],Pr=ze[Ft];let Vr=et[hr]<rt,dn=et[Or]<rt,Wr=et[Pr]<rt;ut.vertexLength+((Vr?1:0)+(dn?1:0)+(Wr?1:0))>pn.MAX_VERTEX_ARRAY_LENGTH&&(ut=ce.createNewSegment(_e,Se),rt=Ct.count,Vr=!0,dn=!0,Wr=!0,kt=0);const kr=z_(et,Le,Ve,Ct,hr,Vr,ut),Er=z_(et,Le,Ve,Ct,Or,dn,ut),Cn=z_(et,Le,Ve,Ct,Pr,Wr,ut);Se.emplaceBack(kt+kr-rt,kt+Er-rt,kt+Cn-rt),ut.primitiveLength++}})(l,h,v,S,M,p),ie&&(function(ce,_e,Se,Le,ze,Ve){const et=[];for(let Ft=0;Ft<Le.length/2;Ft++)et.push(-1);const Ct={count:0};let rt=0,ut=ce.getOrCreateLatestSegment(_e,Se),kt=ut.vertexLength;for(let Ft=0;Ft<ze.length;Ft++){const hr=ze[Ft];for(let Or=1;Or<ze[Ft].length;Or+=2){const Pr=hr[Or-1],Vr=hr[Or];let dn=et[Pr]<rt,Wr=et[Vr]<rt;ut.vertexLength+((dn?1:0)+(Wr?1:0))>pn.MAX_VERTEX_ARRAY_LENGTH&&(ut=ce.createNewSegment(_e,Se),rt=Ct.count,dn=!0,Wr=!0,kt=0);const kr=z_(et,Le,Ve,Ct,Pr,dn,ut),Er=z_(et,Le,Ve,Ct,Vr,Wr,ut);Se.emplaceBack(kt+kr-rt,kt+Er-rt),ut.primitiveLength++}}})(k,h,B,S,V,p),l.forceNewSegmentOnNextPrepare(),k?.forceNewSegmentOnNextPrepare()}function z_(p,l,h,v,S,M,k){if(M){const B=v.count;return h(l[2*S],l[2*S+1]),p[S]=v.count,v.count++,k.vertexLength++,B}return p[S]}class gC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=l.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new dt,this.indexArray=new xr,this.indexArray2=new nn,this.programConfigurations=new $d(l.layers,l.zoom),this.segments=new pn,this.segments2=new pn,this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(l,h,v){this.hasDependencies=c2("fill",this.layers,h);const S=this.layers[0].layout.get("fill-sort-key"),M=!S.isConstant(),k=[];for(const{feature:B,id:V,index:Z,sourceLayerIndex:ie}of l){const ce=this.layers[0]._featureFilter.needGeometry,_e=Kh(B,ce);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),_e,v))continue;const Se=M?S.evaluate(_e,{},v,h.availableImages):void 0,Le={id:V,properties:B.properties,type:B.type,sourceLayerIndex:ie,index:Z,geometry:ce?_e.geometry:Zh(B),patterns:{},sortKey:Se};k.push(Le)}M&&k.sort(((B,V)=>B.sortKey-V.sortKey));for(const B of k){const{geometry:V,index:Z,sourceLayerIndex:ie}=B;if(this.hasDependencies){const ce=hC("fill",this.layers,B,{zoom:this.zoom},h);this.patternFeatures.push(ce)}else this.addFeature(B,V,Z,v,{},h.subdivisionGranularity);h.featureIndex.insert(l[Z].feature,V,Z,ie,this.index)}}update(l,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:v})}addFeatures(l,h,v){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,h,v,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Aie),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,h,v,S,M,k){for(const B of Vl(h,500)){const V=B6(B,S,k.fill.getGranularityForZoomLevel(S.z)),Z=this.layoutVertexArray;z6(((ie,ce)=>{Z.emplaceBack(ie,ce)}),this.segments,this.layoutVertexArray,this.indexArray,V.verticesFlattened,V.indicesTriangles,this.segments2,this.indexArray2,V.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:M,canonical:S})}}let j6,U6;Pt("FillBucket",gC,{omit:["layers","patternFeatures"]});var zie={get paint(){return U6=U6||new $a({"fill-antialias":new Tn(Rt.paint_fill["fill-antialias"]),"fill-opacity":new Sn(Rt.paint_fill["fill-opacity"]),"fill-color":new Sn(Rt.paint_fill["fill-color"]),"fill-outline-color":new Sn(Rt.paint_fill["fill-outline-color"]),"fill-translate":new Tn(Rt.paint_fill["fill-translate"]),"fill-translate-anchor":new Tn(Rt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Rs(Rt.paint_fill["fill-pattern"])})},get layout(){return j6=j6||new $a({"fill-sort-key":new Sn(Rt.layout_fill["fill-sort-key"])})}};class jie extends eo{constructor(l,h){super(l,zie,h)}recalculate(l,h){super.recalculate(l,h);const v=this.paint._values["fill-outline-color"];v.value.kind==="constant"&&v.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new gC(l)}queryRadius(){return l2(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:l,geometry:h,transform:v,pixelsToTileUnits:S}){return _6(u2(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-v.bearingInRadians,S),h)}isTileClipped(){return!0}}const Uie=pa([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Vie=pa([{name:"a_centroid",components:2,type:"Int16"}],4),{members:$ie}=Uie;class j_{constructor(l,h,v,S,M){this.properties={},this.extent=v,this.type=0,this.id=void 0,this._pbf=l,this._geometry=-1,this._keys=S,this._values=M,l.readFields(qie,this,h)}loadGeometry(){const l=this._pbf;l.pos=this._geometry;const h=l.readVarint()+l.pos,v=[];let S,M=1,k=0,B=0,V=0;for(;l.pos<h;){if(k<=0){const Z=l.readVarint();M=7&Z,k=Z>>3}if(k--,M===1||M===2)B+=l.readSVarint(),V+=l.readSVarint(),M===1&&(S&&v.push(S),S=[]),S&&S.push(new c(B,V));else{if(M!==7)throw new Error(`unknown command ${M}`);S&&S.push(S[0].clone())}}return S&&v.push(S),v}bbox(){const l=this._pbf;l.pos=this._geometry;const h=l.readVarint()+l.pos;let v=1,S=0,M=0,k=0,B=1/0,V=-1/0,Z=1/0,ie=-1/0;for(;l.pos<h;){if(S<=0){const ce=l.readVarint();v=7&ce,S=ce>>3}if(S--,v===1||v===2)M+=l.readSVarint(),k+=l.readSVarint(),M<B&&(B=M),M>V&&(V=M),k<Z&&(Z=k),k>ie&&(ie=k);else if(v!==7)throw new Error(`unknown command ${v}`)}return[B,Z,V,ie]}toGeoJSON(l,h,v){const S=this.extent*Math.pow(2,v),M=this.extent*l,k=this.extent*h,B=this.loadGeometry();function V(_e){return[360*(_e.x+M)/S-180,360/Math.PI*Math.atan(Math.exp((1-2*(_e.y+k)/S)*Math.PI))-90]}function Z(_e){return _e.map(V)}let ie;if(this.type===1){const _e=[];for(const Le of B)_e.push(Le[0]);const Se=Z(_e);ie=_e.length===1?{type:"Point",coordinates:Se[0]}:{type:"MultiPoint",coordinates:Se}}else if(this.type===2){const _e=B.map(Z);ie=_e.length===1?{type:"LineString",coordinates:_e[0]}:{type:"MultiLineString",coordinates:_e}}else{if(this.type!==3)throw new Error("unknown feature type");{const _e=V6(B),Se=[];for(const Le of _e)Se.push(Le.map(Z));ie=Se.length===1?{type:"Polygon",coordinates:Se[0]}:{type:"MultiPolygon",coordinates:Se}}}const ce={type:"Feature",geometry:ie,properties:this.properties};return this.id!=null&&(ce.id=this.id),ce}}function qie(p,l,h){p===1?l.id=h.readVarint():p===2?(function(v,S){const M=v.readVarint()+v.pos;for(;v.pos<M;){const k=S._keys[v.readVarint()],B=S._values[v.readVarint()];S.properties[k]=B}})(h,l):p===3?l.type=h.readVarint():p===4&&(l._geometry=h.pos)}function V6(p){const l=p.length;if(l<=1)return[p];const h=[];let v,S;for(let M=0;M<l;M++){const k=Hie(p[M]);k!==0&&(S===void 0&&(S=k<0),S===k<0?(v&&h.push(v),v=[p[M]]):v&&v.push(p[M]))}return v&&h.push(v),h}function Hie(p){let l=0;for(let h,v,S=0,M=p.length,k=M-1;S<M;k=S++)h=p[S],v=p[k],l+=(v.x-h.x)*(h.y+v.y);return l}j_.types=["Unknown","Point","LineString","Polygon"];class Gie{constructor(l,h){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(Wie,this,h),this.length=this._features.length}feature(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];const h=this._pbf.readVarint()+this._pbf.pos;return new j_(this._pbf,h,this.extent,this._keys,this._values)}}function Wie(p,l,h){p===15?l.version=h.readVarint():p===1?l.name=h.readString():p===5?l.extent=h.readVarint():p===2?l._features.push(h.pos):p===3?l._keys.push(h.readString()):p===4&&l._values.push((function(v){let S=null;const M=v.readVarint()+v.pos;for(;v.pos<M;){const k=v.readVarint()>>3;S=k===1?v.readString():k===2?v.readFloat():k===3?v.readDouble():k===4?v.readVarint64():k===5?v.readVarint():k===6?v.readSVarint():k===7?v.readBoolean():null}if(S==null)throw new Error("unknown feature value");return S})(h))}class $6{constructor(l,h){this.layers=l.readFields(Xie,{},h)}}function Xie(p,l,h){if(p===3){const v=new Gie(h,h.readVarint()+h.pos);v.length&&(l[v.name]=v)}}const mC=Math.pow(2,13);function U_(p,l,h,v,S,M,k,B){p.emplaceBack(l,h,2*Math.floor(v*mC)+k,S*mC*2,M*mC*2,Math.round(B))}class yC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=l.index,this.hasDependencies=!1,this.layoutVertexArray=new xt,this.centroidVertexArray=new ht,this.indexArray=new xr,this.programConfigurations=new $d(l.layers,l.zoom),this.segments=new pn,this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(l,h,v){this.features=[],this.hasDependencies=c2("fill-extrusion",this.layers,h);for(const{feature:S,id:M,index:k,sourceLayerIndex:B}of l){const V=this.layers[0]._featureFilter.needGeometry,Z=Kh(S,V);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),Z,v))continue;const ie={id:M,sourceLayerIndex:B,index:k,geometry:V?Z.geometry:Zh(S),properties:S.properties,type:S.type,patterns:{}};this.hasDependencies?this.features.push(hC("fill-extrusion",this.layers,ie,{zoom:this.zoom},h)):this.addFeature(ie,ie.geometry,k,v,{},h.subdivisionGranularity),h.featureIndex.insert(S,ie.geometry,k,B,this.index,!0)}}addFeatures(l,h,v){for(const S of this.features){const{geometry:M}=S;this.addFeature(S,M,S.index,h,v,l.subdivisionGranularity)}}update(l,h,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:v})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,$ie),this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,Vie.members,!0),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(l,h,v,S,M,k){for(const B of Vl(h,500)){const V={x:0,y:0,sampleCount:0},Z=this.layoutVertexArray.length;this.processPolygon(V,S,l,B,k);const ie=this.layoutVertexArray.length-Z,ce=Math.floor(V.x/V.sampleCount),_e=Math.floor(V.y/V.sampleCount);for(let Se=0;Se<ie;Se++)this.centroidVertexArray.emplaceBack(ce,_e)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:M,canonical:S})}processPolygon(l,h,v,S,M){if(S.length<1||q6(S[0]))return;for(const ce of S)ce.length!==0&&Yie(l,ce);const k={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},B=M.fill.getGranularityForZoomLevel(h.z),V=j_.types[v.type]==="Polygon";for(const ce of S){if(ce.length===0||q6(ce))continue;const _e=rm(ce,B,V);this._generateSideFaces(_e,k)}if(!V)return;const Z=B6(S,h,B,!1),ie=this.layoutVertexArray;z6(((ce,_e)=>{U_(ie,ce,_e,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,Z.verticesFlattened,Z.indicesTriangles)}_generateSideFaces(l,h){let v=0;for(let S=1;S<l.length;S++){const M=l[S],k=l[S-1];if(Zie(M,k))continue;h.segment.vertexLength+4>pn.MAX_VERTEX_ARRAY_LENGTH&&(h.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const B=M.sub(k)._perp()._unit(),V=k.dist(M);v+V>32768&&(v=0),U_(this.layoutVertexArray,M.x,M.y,B.x,B.y,0,0,v),U_(this.layoutVertexArray,M.x,M.y,B.x,B.y,0,1,v),v+=V,U_(this.layoutVertexArray,k.x,k.y,B.x,B.y,0,0,v),U_(this.layoutVertexArray,k.x,k.y,B.x,B.y,0,1,v);const Z=h.segment.vertexLength;this.indexArray.emplaceBack(Z,Z+2,Z+1),this.indexArray.emplaceBack(Z+1,Z+2,Z+3),h.segment.vertexLength+=4,h.segment.primitiveLength+=2}}}function Yie(p,l){for(let h=0;h<l.length;h++){const v=l[h];h===l.length-1&&l[0].x===v.x&&l[0].y===v.y||(p.x+=v.x,p.y+=v.y,p.sampleCount++)}}function Zie(p,l){return p.x===l.x&&(p.x<0||p.x>we)||p.y===l.y&&(p.y<0||p.y>we)}function q6(p){return p.every((l=>l.x<0))||p.every((l=>l.x>we))||p.every((l=>l.y<0))||p.every((l=>l.y>we))}let H6;Pt("FillExtrusionBucket",yC,{omit:["layers","features"]});var Kie={get paint(){return H6=H6||new $a({"fill-extrusion-opacity":new Tn(Rt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Sn(Rt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Tn(Rt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Tn(Rt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Rs(Rt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Sn(Rt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Sn(Rt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Tn(Rt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Jie extends eo{constructor(l,h){super(l,Kie,h)}createBucket(l){return new yC(l)}queryRadius(){return l2(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:v,geometry:S,transform:M,pixelsToTileUnits:k,pixelPosMatrix:B}){const V=u2(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-M.bearingInRadians,k),Z=this.paint.get("fill-extrusion-height").evaluate(h,v),ie=this.paint.get("fill-extrusion-base").evaluate(h,v),ce=(function(Se,Le){const ze=[];for(const Ve of Se){const et=[Ve.x,Ve.y,0,1];se(et,et,Le),ze.push(new c(et[0]/et[3],et[1]/et[3]))}return ze})(V,B),_e=(function(Se,Le,ze,Ve){const et=[],Ct=[],rt=Ve[8]*Le,ut=Ve[9]*Le,kt=Ve[10]*Le,Ft=Ve[11]*Le,hr=Ve[8]*ze,Or=Ve[9]*ze,Pr=Ve[10]*ze,Vr=Ve[11]*ze;for(const dn of Se){const Wr=[],kr=[];for(const Er of dn){const Cn=Er.x,xn=Er.y,Mn=Ve[0]*Cn+Ve[4]*xn+Ve[12],vn=Ve[1]*Cn+Ve[5]*xn+Ve[13],Gn=Ve[2]*Cn+Ve[6]*xn+Ve[14],la=Ve[3]*Cn+Ve[7]*xn+Ve[15],Hi=Gn+kt,Mo=la+Ft,Ql=Mn+hr,Ds=vn+Or,ko=Gn+Pr,vo=la+Vr,Ta=new c((Mn+rt)/Mo,(vn+ut)/Mo);Ta.z=Hi/Mo,Wr.push(Ta);const Yo=new c(Ql/vo,Ds/vo);Yo.z=ko/vo,kr.push(Yo)}et.push(Wr),Ct.push(kr)}return[et,Ct]})(S,ie,Z,B);return(function(Se,Le,ze){let Ve=1/0;_6(ze,Le)&&(Ve=G6(ze,Le[0]));for(let et=0;et<Le.length;et++){const Ct=Le[et],rt=Se[et];for(let ut=0;ut<Ct.length-1;ut++){const kt=Ct[ut],Ft=[kt,Ct[ut+1],rt[ut+1],rt[ut],kt];Uy(ze,Ft)&&(Ve=Math.min(Ve,G6(ze,Ft)))}}return Ve!==1/0&&Ve})(_e[0],_e[1],ce)}}function V_(p,l){return p.x*l.x+p.y*l.y}function G6(p,l){if(p.length===1){let h=0;const v=l[h++];let S;for(;!S||v.equals(S);)if(S=l[h++],!S)return 1/0;for(;h<l.length;h++){const M=l[h],k=p[0],B=S.sub(v),V=M.sub(v),Z=k.sub(v),ie=V_(B,B),ce=V_(B,V),_e=V_(V,V),Se=V_(Z,B),Le=V_(Z,V),ze=ie*_e-ce*ce,Ve=(_e*Se-ce*Le)/ze,et=(ie*Le-ce*Se)/ze,Ct=v.z*(1-Ve-et)+S.z*Ve+M.z*et;if(isFinite(Ct))return Ct}return 1/0}{let h=1/0;for(const v of l)h=Math.min(h,v.z);return h}}const Qie=pa([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:eae}=Qie,tae=pa([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:rae}=tae,nae=Math.cos(Math.PI/180*37.5),W6=Math.pow(2,14)/.5;class vC{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((h=>h.id)),this.index=l.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((h=>{this.gradients[h.id]={}})),this.layoutVertexArray=new Ot,this.layoutVertexArray2=new wt,this.indexArray=new xr,this.programConfigurations=new $d(l.layers,l.zoom),this.segments=new pn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((h=>h.isStateDependent())).map((h=>h.id))}populate(l,h,v){this.hasDependencies=c2("line",this.layers,h)||this.hasLineDasharray(this.layers);const S=this.layers[0].layout.get("line-sort-key"),M=!S.isConstant(),k=[];for(const{feature:B,id:V,index:Z,sourceLayerIndex:ie}of l){const ce=this.layers[0]._featureFilter.needGeometry,_e=Kh(B,ce);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),_e,v))continue;const Se=M?S.evaluate(_e,{},v):void 0,Le={id:V,properties:B.properties,type:B.type,sourceLayerIndex:ie,index:Z,geometry:ce?_e.geometry:Zh(B),patterns:{},dashes:{},sortKey:Se};k.push(Le)}M&&k.sort(((B,V)=>B.sortKey-V.sortKey));for(const B of k){const{geometry:V,index:Z,sourceLayerIndex:ie}=B;this.hasDependencies?(c2("line",this.layers,h)?hC("line",this.layers,B,{zoom:this.zoom},h):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,B,this.zoom,h),this.patternFeatures.push(B)):this.addFeature(B,V,Z,v,{},{},h.subdivisionGranularity),h.featureIndex.insert(l[Z].feature,V,Z,ie,this.index)}}update(l,h,v,S){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:v,dashPositions:S})}addFeatures(l,h,v,S){for(const M of this.patternFeatures)this.addFeature(M,M.geometry,M.index,h,v,S,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,rae)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,eae),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,h,v,S,M,k,B){const V=this.layers[0].layout,Z=V.get("line-join").evaluate(l,{}),ie=V.get("line-cap"),ce=V.get("line-miter-limit"),_e=V.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(const Se of h)this.addLine(Se,l,Z,ie,ce,_e,S,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{imagePositions:M,dashPositions:k,canonical:S})}addLine(l,h,v,S,M,k,B,V){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,l=rm(l,B?V.line.getGranularityForZoomLevel(B.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let rt=0;rt<l.length-1;rt++)this.totalDistance+=l[rt].dist(l[rt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const Z=j_.types[h.type]==="Polygon";let ie=l.length;for(;ie>=2&&l[ie-1].equals(l[ie-2]);)ie--;let ce=0;for(;ce<ie-1&&l[ce].equals(l[ce+1]);)ce++;if(ie<(Z?3:2))return;v==="bevel"&&(M=1.05);const _e=this.overscaling<=16?122880/(512*this.overscaling):0,Se=this.segments.prepareSegment(10*ie,this.layoutVertexArray,this.indexArray);let Le,ze,Ve,et,Ct;this.e1=this.e2=-1,Z&&(Le=l[ie-2],Ct=l[ce].sub(Le)._unit()._perp());for(let rt=ce;rt<ie;rt++){if(Ve=rt===ie-1?Z?l[ce+1]:void 0:l[rt+1],Ve&&l[rt].equals(Ve))continue;Ct&&(et=Ct),Le&&(ze=Le),Le=l[rt],Ct=Ve?Ve.sub(Le)._unit()._perp():et,et=et||Ct;let ut=et.add(Ct);ut.x===0&&ut.y===0||ut._unit();const kt=et.x*Ct.x+et.y*Ct.y,Ft=ut.x*Ct.x+ut.y*Ct.y,hr=Ft!==0?1/Ft:1/0,Or=2*Math.sqrt(2-2*Ft),Pr=Ft<nae&&ze&&Ve,Vr=et.x*Ct.y-et.y*Ct.x>0;if(Pr&&rt>ce){const kr=Le.dist(ze);if(kr>2*_e){const Er=Le.sub(Le.sub(ze)._mult(_e/kr)._round());this.updateDistance(ze,Er),this.addCurrentVertex(Er,et,0,0,Se),ze=Er}}const dn=ze&&Ve;let Wr=dn?v:Z?"butt":S;if(dn&&Wr==="round"&&(hr<k?Wr="miter":hr<=2&&(Wr="fakeround")),Wr==="miter"&&hr>M&&(Wr="bevel"),Wr==="bevel"&&(hr>2&&(Wr="flipbevel"),hr<M&&(Wr="miter")),ze&&this.updateDistance(ze,Le),Wr==="miter")ut._mult(hr),this.addCurrentVertex(Le,ut,0,0,Se);else if(Wr==="flipbevel"){if(hr>100)ut=Ct.mult(-1);else{const kr=hr*et.add(Ct).mag()/et.sub(Ct).mag();ut._perp()._mult(kr*(Vr?-1:1))}this.addCurrentVertex(Le,ut,0,0,Se),this.addCurrentVertex(Le,ut.mult(-1),0,0,Se)}else if(Wr==="bevel"||Wr==="fakeround"){const kr=-Math.sqrt(hr*hr-1),Er=Vr?kr:0,Cn=Vr?0:kr;if(ze&&this.addCurrentVertex(Le,et,Er,Cn,Se),Wr==="fakeround"){const xn=Math.round(180*Or/Math.PI/20);for(let Mn=1;Mn<xn;Mn++){let vn=Mn/xn;if(vn!==.5){const la=vn-.5;vn+=vn*la*(vn-1)*((1.0904+kt*(kt*(3.55645-1.43519*kt)-3.2452))*la*la+(.848013+kt*(.215638*kt-1.06021)))}const Gn=Ct.sub(et)._mult(vn)._add(et)._unit()._mult(Vr?-1:1);this.addHalfVertex(Le,Gn.x,Gn.y,!1,Vr,0,Se)}}Ve&&this.addCurrentVertex(Le,Ct,-Er,-Cn,Se)}else if(Wr==="butt")this.addCurrentVertex(Le,ut,0,0,Se);else if(Wr==="square"){const kr=ze?1:-1;this.addCurrentVertex(Le,ut,kr,kr,Se)}else Wr==="round"&&(ze&&(this.addCurrentVertex(Le,et,0,0,Se),this.addCurrentVertex(Le,et,1,1,Se,!0)),Ve&&(this.addCurrentVertex(Le,Ct,-1,-1,Se,!0),this.addCurrentVertex(Le,Ct,0,0,Se)));if(Pr&&rt<ie-1){const kr=Le.dist(Ve);if(kr>2*_e){const Er=Le.add(Ve.sub(Le)._mult(_e/kr)._round());this.updateDistance(Le,Er),this.addCurrentVertex(Er,Ct,0,0,Se),Le=Er}}}}addCurrentVertex(l,h,v,S,M,k=!1){const B=h.y*S-h.x,V=-h.y-h.x*S;this.addHalfVertex(l,h.x+h.y*v,h.y-h.x*v,k,!1,v,M),this.addHalfVertex(l,B,V,k,!0,-S,M),this.distance>W6/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(l,h,v,S,M,k))}addHalfVertex({x:l,y:h},v,S,M,k,B,V){const Z=.5*(this.lineClips?this.scaledDistance*(W6-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((l<<1)+(M?1:0),(h<<1)+(k?1:0),Math.round(63*v)+128,Math.round(63*S)+128,1+(B===0?0:B<0?-1:1)|(63&Z)<<2,Z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const ie=V.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,ie,this.e2),V.primitiveLength++),k?this.e2=ie:this.e1=ie}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(l,h){this.distance+=l.dist(h),this.updateScaledDistance()}hasLineDasharray(l){for(const h of l){const v=h.paint.get("line-dasharray");if(v&&!v.isConstant())return!0}return!1}addLineDashDependencies(l,h,v,S){for(const M of l){const k=M.paint.get("line-dasharray");if(!k||k.value.kind==="constant")continue;const B=M.layout.get("line-cap")==="round",V={dasharray:k.value.evaluate({zoom:v-1},h,{}),round:B},Z={dasharray:k.value.evaluate({zoom:v},h,{}),round:B},ie={dasharray:k.value.evaluate({zoom:v+1},h,{}),round:B},ce=`${V.dasharray.join(",")},${V.round}`,_e=`${Z.dasharray.join(",")},${Z.round}`,Se=`${ie.dasharray.join(",")},${ie.round}`;S.dashDependencies[ce]=V,S.dashDependencies[_e]=Z,S.dashDependencies[Se]=ie,h.dashes[M.id]={min:ce,mid:_e,max:Se}}}}let X6,Y6;Pt("LineBucket",vC,{omit:["layers","patternFeatures"]});var Z6={get paint(){return Y6=Y6||new $a({"line-opacity":new Sn(Rt.paint_line["line-opacity"]),"line-color":new Sn(Rt.paint_line["line-color"]),"line-translate":new Tn(Rt.paint_line["line-translate"]),"line-translate-anchor":new Tn(Rt.paint_line["line-translate-anchor"]),"line-width":new Sn(Rt.paint_line["line-width"]),"line-gap-width":new Sn(Rt.paint_line["line-gap-width"]),"line-offset":new Sn(Rt.paint_line["line-offset"]),"line-blur":new Sn(Rt.paint_line["line-blur"]),"line-dasharray":new Rs(Rt.paint_line["line-dasharray"]),"line-pattern":new Rs(Rt.paint_line["line-pattern"]),"line-gradient":new Fo(Rt.paint_line["line-gradient"])})},get layout(){return X6=X6||new $a({"line-cap":new Tn(Rt.layout_line["line-cap"]),"line-join":new Sn(Rt.layout_line["line-join"]),"line-miter-limit":new Tn(Rt.layout_line["line-miter-limit"]),"line-round-limit":new Tn(Rt.layout_line["line-round-limit"]),"line-sort-key":new Sn(Rt.layout_line["line-sort-key"])})}};class iae extends Sn{possiblyEvaluate(l,h){return h=new Mi(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(l,h)}evaluate(l,h,v,S){return h=Be({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(l,h,v,S)}}let p2;class aae extends eo{constructor(l,h){super(l,Z6,h),this.gradientVersion=0,p2||(p2=new iae(Z6.paint.properties["line-width"].specification),p2.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!(function(v){return v._styleExpression!==void 0})(h)&&h._styleExpression.expression instanceof Bt,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,h){super.recalculate(l,h),this.paint._values["line-floorwidth"]=p2.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new vC(l)}queryRadius(l){const h=l,v=K6($y("line-width",this,h),$y("line-gap-width",this,h)),S=$y("line-offset",this,h);return v/2+Math.abs(S)+l2(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:v,geometry:S,transform:M,pixelsToTileUnits:k}){const B=u2(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-M.bearingInRadians,k),V=k/2*K6(this.paint.get("line-width").evaluate(h,v),this.paint.get("line-gap-width").evaluate(h,v)),Z=this.paint.get("line-offset").evaluate(h,v);return Z&&(S=(function(ie,ce){const _e=[];for(let Se=0;Se<ie.length;Se++){const Le=die(ie[Se]),ze=[];for(let Ve=0;Ve<Le.length;Ve++){const et=Le[Ve],Ct=Le[Ve-1],rt=Le[Ve+1],ut=Ve===0?new c(0,0):et.sub(Ct)._unit()._perp(),kt=Ve===Le.length-1?new c(0,0):rt.sub(et)._unit()._perp(),Ft=ut._add(kt)._unit(),hr=Ft.x*kt.x+Ft.y*kt.y;hr!==0&&Ft._mult(1/hr),ze.push(Ft._mult(ce)._add(et))}_e.push(ze)}return _e})(S,Z*k)),(function(ie,ce,_e){for(let Se=0;Se<ce.length;Se++){const Le=ce[Se];if(ie.length>=3){for(let ze=0;ze<Le.length;ze++)if(Vy(ie,Le[ze]))return!0}if(cie(ie,Le,_e))return!0}return!1})(B,S,V)}isTileClipped(){return!0}}function K6(p,l){return l>0?l+2*p:p}const oae=pa([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),sae=pa([{name:"a_projected_pos",components:3,type:"Float32"}],4);pa([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const lae=pa([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);pa([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const J6=pa([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),uae=pa([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function cae(p,l,h){return p.sections.forEach((v=>{v.text=(function(S,M,k){const B=M.layout.get("text-transform").evaluate(k,{});return B==="uppercase"?S=S.toLocaleUpperCase():B==="lowercase"&&(S=S.toLocaleLowerCase()),da.applyArabicShaping&&(S=da.applyArabicShaping(S)),S})(v.text,l,h)})),p}pa([{name:"triangle",components:3,type:"Uint16"}]),pa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),pa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),pa([{type:"Float32",name:"offsetX"}]),pa([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),pa([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var ml=24;const $_={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},fae={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},hae={40:!0};function Q6(p,l,h,v,S,M){if("fontStack"in l){const k=h[l.fontStack],B=k&&k[p];return B?B.metrics.advance*l.scale+S:0}{const k=v[l.imageName];return k?k.displaySize[0]*l.scale*ml/M+S:0}}function eF(p,l,h,v){const S=Math.pow(p-l,2);return v?p<l?S/2:2*S:S+Math.abs(h)*h}function dae(p,l,h){let v=0;return p===10&&(v-=1e4),h&&(v+=150),p!==40&&p!==65288||(v+=50),l!==41&&l!==65289||(v+=50),v}function tF(p,l,h,v,S,M){let k=null,B=eF(l,h,S,M);for(const V of v){const Z=eF(l-V.x,h,S,M)+V.badness;Z<=B&&(k=V,B=Z)}return{index:p,x:l,priorBreak:k,badness:B}}function rF(p){return p?rF(p.priorBreak).concat(p.index):[]}class Wy{constructor(l="",h=[],v=[]){this.text=l,this.sections=h,this.sectionIndex=v,this.imageSectionID=null}static fromFeature(l,h){const v=new Wy;for(let S=0;S<l.sections.length;S++){const M=l.sections[S];M.image?v.addImageSection(M):v.addTextSection(M,h)}return v}length(){return[...this.text].length}getSection(l){return this.sections[this.sectionIndex[l]]}getSectionIndex(l){return this.sectionIndex[l]}verticalizePunctuation(){this.text=(function(l){let h="",v={premature:!0,value:void 0};const S=l[Symbol.iterator]();let M=S.next();const k=l[Symbol.iterator]();k.next();let B=k.next();for(;!M.done;)h+=!B.done&&Yn(B.value.codePointAt(0))&&!$_[B.value]||!v.premature&&Yn(v.value.codePointAt(0))&&!$_[v.value]||!$_[M.value]?M.value:$_[M.value],v={value:M.value,premature:!1},M=S.next(),B=k.next();return h})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const l=this.text.match(/^\s*/),h=l?l[0].length:0,v=this.text.match(/\S\s*$/),S=v?v[0].length-1:0;this.text=this.text.substring(h,this.text.length-S),this.sectionIndex=this.sectionIndex.slice(h,this.sectionIndex.length-S)}substring(l,h){const v=[...this.text].slice(l,h).join(""),S=this.sectionIndex.slice(l,h);return new Wy(v,this.sections,S)}toCodeUnitIndex(l){return[...this.text].slice(0,l).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((l,h)=>Math.max(l,this.sections[h].scale)),0)}getMaxImageSize(l){let h=0,v=0;for(let S=0;S<this.length();S++){const M=this.getSection(S);if("imageName"in M){const k=l[M.imageName];if(!k)continue;const B=k.displaySize;h=Math.max(h,B[0]),v=Math.max(v,B[1])}}return{maxImageWidth:h,maxImageHeight:v}}addTextSection(l,h){this.text+=l.text,this.sections.push({scale:l.scale||1,verticalAlign:l.verticalAlign||"bottom",fontStack:l.fontStack||h});const v=this.sections.length-1;this.sectionIndex.push(...[...l.text].map((()=>v)))}addImageSection(l){const h=l.image?l.image.name:"";if(h.length===0)return void st("Can't add FormattedSection with an empty image.");const v=this.getNextImageSectionCharCode();v?(this.text+=String.fromCharCode(v),this.sections.push({scale:1,verticalAlign:l.verticalAlign||"bottom",imageName:h}),this.sectionIndex.push(this.sections.length-1)):st("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(l,h,v,S,M){const k=[],B=this.determineAverageLineWidth(l,h,v,S,M),V=this.hasZeroWidthSpaces();let Z=0,ie=0;const ce=this.text[Symbol.iterator]();let _e=ce.next();const Se=this.text[Symbol.iterator]();Se.next();let Le=Se.next();const ze=this.text[Symbol.iterator]();ze.next(),ze.next();let Ve=ze.next();for(;!_e.done;){const et=this.getSection(ie),Ct=_e.value.codePointAt(0);if(Vn(Ct)||(Z+=Q6(Ct,et,v,S,l,M)),!Le.done){const rt=Jr(Ct),ut=Le.value.codePointAt(0);(fae[Ct]||rt||"imageName"in et||!Ve.done&&hae[ut])&&k.push(tF(ie+1,Z,B,k,dae(Ct,ut,rt&&V),!1))}ie++,_e=ce.next(),Le=Se.next(),Ve=ze.next()}return rF(tF(this.length(),Z,B,k,0,!0))}determineAverageLineWidth(l,h,v,S,M){let k=0,B=0;for(const V of this.text){const Z=this.getSection(B);k+=Q6(V.codePointAt(0),Z,v,S,l,M),B++}return k/Math.max(1,Math.ceil(k/h))}}const _C=4294967296,nF=1/_C,iF=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class g2{constructor(l=new Uint8Array(16)){this.buf=ArrayBuffer.isView(l)?l:new Uint8Array(l),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(l,h,v=this.length){for(;this.pos<v;){const S=this.readVarint(),M=S>>3,k=this.pos;this.type=7&S,l(M,h,this),this.pos===k&&this.skip(S)}return h}readMessage(l,h){return this.readFields(l,h,this.readVarint()+this.pos)}readFixed32(){const l=this.dataView.getUint32(this.pos,!0);return this.pos+=4,l}readSFixed32(){const l=this.dataView.getInt32(this.pos,!0);return this.pos+=4,l}readFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*_C;return this.pos+=8,l}readSFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*_C;return this.pos+=8,l}readFloat(){const l=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,l}readDouble(){const l=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,l}readVarint(l){const h=this.buf;let v,S;return S=h[this.pos++],v=127&S,S<128?v:(S=h[this.pos++],v|=(127&S)<<7,S<128?v:(S=h[this.pos++],v|=(127&S)<<14,S<128?v:(S=h[this.pos++],v|=(127&S)<<21,S<128?v:(S=h[this.pos],v|=(15&S)<<28,(function(M,k,B){const V=B.buf;let Z,ie;if(ie=V[B.pos++],Z=(112&ie)>>4,ie<128||(ie=V[B.pos++],Z|=(127&ie)<<3,ie<128)||(ie=V[B.pos++],Z|=(127&ie)<<10,ie<128)||(ie=V[B.pos++],Z|=(127&ie)<<17,ie<128)||(ie=V[B.pos++],Z|=(127&ie)<<24,ie<128)||(ie=V[B.pos++],Z|=(1&ie)<<31,ie<128))return Xy(M,Z,k);throw new Error("Expected varint not more than 10 bytes")})(v,l,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const l=this.readVarint();return l%2==1?(l+1)/-2:l/2}readBoolean(){return!!this.readVarint()}readString(){const l=this.readVarint()+this.pos,h=this.pos;return this.pos=l,l-h>=12&&iF?iF.decode(this.buf.subarray(h,l)):(function(v,S,M){let k="",B=S;for(;B<M;){const V=v[B];let Z,ie,ce,_e=null,Se=V>239?4:V>223?3:V>191?2:1;if(B+Se>M)break;Se===1?V<128&&(_e=V):Se===2?(Z=v[B+1],(192&Z)==128&&(_e=(31&V)<<6|63&Z,_e<=127&&(_e=null))):Se===3?(Z=v[B+1],ie=v[B+2],(192&Z)==128&&(192&ie)==128&&(_e=(15&V)<<12|(63&Z)<<6|63&ie,(_e<=2047||_e>=55296&&_e<=57343)&&(_e=null))):Se===4&&(Z=v[B+1],ie=v[B+2],ce=v[B+3],(192&Z)==128&&(192&ie)==128&&(192&ce)==128&&(_e=(15&V)<<18|(63&Z)<<12|(63&ie)<<6|63&ce,(_e<=65535||_e>=1114112)&&(_e=null))),_e===null?(_e=65533,Se=1):_e>65535&&(_e-=65536,k+=String.fromCharCode(_e>>>10&1023|55296),_e=56320|1023&_e),k+=String.fromCharCode(_e),B+=Se}return k})(this.buf,h,l)}readBytes(){const l=this.readVarint()+this.pos,h=this.buf.subarray(this.pos,l);return this.pos=l,h}readPackedVarint(l=[],h){const v=this.readPackedEnd();for(;this.pos<v;)l.push(this.readVarint(h));return l}readPackedSVarint(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readSVarint());return l}readPackedBoolean(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readBoolean());return l}readPackedFloat(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readFloat());return l}readPackedDouble(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readDouble());return l}readPackedFixed32(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readFixed32());return l}readPackedSFixed32(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readSFixed32());return l}readPackedFixed64(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readFixed64());return l}readPackedSFixed64(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readSFixed64());return l}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(l){const h=7&l;if(h===0)for(;this.buf[this.pos++]>127;);else if(h===2)this.pos=this.readVarint()+this.pos;else if(h===5)this.pos+=4;else{if(h!==1)throw new Error(`Unimplemented type: ${h}`);this.pos+=8}}writeTag(l,h){this.writeVarint(l<<3|h)}realloc(l){let h=this.length||16;for(;h<this.pos+l;)h*=2;if(h!==this.length){const v=new Uint8Array(h);v.set(this.buf),this.buf=v,this.dataView=new DataView(v.buffer),this.length=h}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeSFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*nF),!0),this.pos+=8}writeSFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*nF),!0),this.pos+=8}writeVarint(l){(l=+l||0)>268435455||l<0?(function(h,v){let S,M;if(h>=0?(S=h%4294967296|0,M=h/4294967296|0):(S=~(-h%4294967296),M=~(-h/4294967296),4294967295^S?S=S+1|0:(S=0,M=M+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");v.realloc(10),(function(k,B,V){V.buf[V.pos++]=127&k|128,k>>>=7,V.buf[V.pos++]=127&k|128,k>>>=7,V.buf[V.pos++]=127&k|128,k>>>=7,V.buf[V.pos++]=127&k|128,V.buf[V.pos]=127&(k>>>=7)})(S,0,v),(function(k,B){const V=(7&k)<<4;B.buf[B.pos++]|=V|((k>>>=3)?128:0),k&&(B.buf[B.pos++]=127&k|((k>>>=7)?128:0),k&&(B.buf[B.pos++]=127&k|((k>>>=7)?128:0),k&&(B.buf[B.pos++]=127&k|((k>>>=7)?128:0),k&&(B.buf[B.pos++]=127&k|((k>>>=7)?128:0),k&&(B.buf[B.pos++]=127&k)))))})(M,v)})(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))}writeSVarint(l){this.writeVarint(l<0?2*-l-1:2*l)}writeBoolean(l){this.writeVarint(+l)}writeString(l){l=String(l),this.realloc(4*l.length),this.pos++;const h=this.pos;this.pos=(function(S,M,k){for(let B,V,Z=0;Z<M.length;Z++){if(B=M.charCodeAt(Z),B>55295&&B<57344){if(!V){B>56319||Z+1===M.length?(S[k++]=239,S[k++]=191,S[k++]=189):V=B;continue}if(B<56320){S[k++]=239,S[k++]=191,S[k++]=189,V=B;continue}B=V-55296<<10|B-56320|65536,V=null}else V&&(S[k++]=239,S[k++]=191,S[k++]=189,V=null);B<128?S[k++]=B:(B<2048?S[k++]=B>>6|192:(B<65536?S[k++]=B>>12|224:(S[k++]=B>>18|240,S[k++]=B>>12&63|128),S[k++]=B>>6&63|128),S[k++]=63&B|128)}return k})(this.buf,l,this.pos);const v=this.pos-h;v>=128&&aF(h,v,this),this.pos=h-1,this.writeVarint(v),this.pos+=v}writeFloat(l){this.realloc(4),this.dataView.setFloat32(this.pos,l,!0),this.pos+=4}writeDouble(l){this.realloc(8),this.dataView.setFloat64(this.pos,l,!0),this.pos+=8}writeBytes(l){const h=l.length;this.writeVarint(h),this.realloc(h);for(let v=0;v<h;v++)this.buf[this.pos++]=l[v]}writeRawMessage(l,h){this.pos++;const v=this.pos;l(h,this);const S=this.pos-v;S>=128&&aF(v,S,this),this.pos=v-1,this.writeVarint(S),this.pos+=S}writeMessage(l,h,v){this.writeTag(l,2),this.writeRawMessage(h,v)}writePackedVarint(l,h){h.length&&this.writeMessage(l,pae,h)}writePackedSVarint(l,h){h.length&&this.writeMessage(l,gae,h)}writePackedBoolean(l,h){h.length&&this.writeMessage(l,vae,h)}writePackedFloat(l,h){h.length&&this.writeMessage(l,mae,h)}writePackedDouble(l,h){h.length&&this.writeMessage(l,yae,h)}writePackedFixed32(l,h){h.length&&this.writeMessage(l,_ae,h)}writePackedSFixed32(l,h){h.length&&this.writeMessage(l,bae,h)}writePackedFixed64(l,h){h.length&&this.writeMessage(l,xae,h)}writePackedSFixed64(l,h){h.length&&this.writeMessage(l,wae,h)}writeBytesField(l,h){this.writeTag(l,2),this.writeBytes(h)}writeFixed32Field(l,h){this.writeTag(l,5),this.writeFixed32(h)}writeSFixed32Field(l,h){this.writeTag(l,5),this.writeSFixed32(h)}writeFixed64Field(l,h){this.writeTag(l,1),this.writeFixed64(h)}writeSFixed64Field(l,h){this.writeTag(l,1),this.writeSFixed64(h)}writeVarintField(l,h){this.writeTag(l,0),this.writeVarint(h)}writeSVarintField(l,h){this.writeTag(l,0),this.writeSVarint(h)}writeStringField(l,h){this.writeTag(l,2),this.writeString(h)}writeFloatField(l,h){this.writeTag(l,5),this.writeFloat(h)}writeDoubleField(l,h){this.writeTag(l,1),this.writeDouble(h)}writeBooleanField(l,h){this.writeVarintField(l,+h)}}function Xy(p,l,h){return h?4294967296*l+(p>>>0):4294967296*(l>>>0)+(p>>>0)}function aF(p,l,h){const v=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));h.realloc(v);for(let S=h.pos-1;S>=p;S--)h.buf[S+v]=h.buf[S]}function pae(p,l){for(let h=0;h<p.length;h++)l.writeVarint(p[h])}function gae(p,l){for(let h=0;h<p.length;h++)l.writeSVarint(p[h])}function mae(p,l){for(let h=0;h<p.length;h++)l.writeFloat(p[h])}function yae(p,l){for(let h=0;h<p.length;h++)l.writeDouble(p[h])}function vae(p,l){for(let h=0;h<p.length;h++)l.writeBoolean(p[h])}function _ae(p,l){for(let h=0;h<p.length;h++)l.writeFixed32(p[h])}function bae(p,l){for(let h=0;h<p.length;h++)l.writeSFixed32(p[h])}function xae(p,l){for(let h=0;h<p.length;h++)l.writeFixed64(p[h])}function wae(p,l){for(let h=0;h<p.length;h++)l.writeSFixed64(p[h])}function Sae(p,l,h){p===1&&h.readMessage(Eae,l)}function Eae(p,l,h){if(p===3){const{id:v,bitmap:S,width:M,height:k,left:B,top:V,advance:Z}=h.readMessage(Tae,{});l.push({id:v,bitmap:new D_({width:M+6,height:k+6},S),metrics:{width:M,height:k,left:B,top:V,advance:Z}})}}function Tae(p,l,h){p===1?l.id=h.readVarint():p===2?l.bitmap=h.readBytes():p===3?l.width=h.readVarint():p===4?l.height=h.readVarint():p===5?l.left=h.readSVarint():p===6?l.top=h.readSVarint():p===7&&(l.advance=h.readVarint())}function oF(p){let l=0,h=0;for(const k of p)l+=k.w*k.h,h=Math.max(h,k.w);p.sort(((k,B)=>B.h-k.h));const v=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),h),h:1/0}];let S=0,M=0;for(const k of p)for(let B=v.length-1;B>=0;B--){const V=v[B];if(!(k.w>V.w||k.h>V.h)){if(k.x=V.x,k.y=V.y,M=Math.max(M,k.y+k.h),S=Math.max(S,k.x+k.w),k.w===V.w&&k.h===V.h){const Z=v.pop();Z&&B<v.length&&(v[B]=Z)}else k.h===V.h?(V.x+=k.w,V.w-=k.w):k.w===V.w?(V.y+=k.h,V.h-=k.h):(v.push({x:V.x+k.w,y:V.y,w:V.w-k.w,h:k.h}),V.y+=k.h,V.h-=k.h);break}}return{w:S,h:M,fill:l/(S*M)||0}}class bC{constructor(l,{pixelRatio:h,version:v,stretchX:S,stretchY:M,content:k,textFitWidth:B,textFitHeight:V}){this.paddedRect=l,this.pixelRatio=h,this.stretchX=S,this.stretchY=M,this.content=k,this.version=v,this.textFitWidth=B,this.textFitHeight=V}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class sF{constructor(l,h){const v={},S={};this.haveRenderCallbacks=[];const M=[];this.addImages(l,v,M),this.addImages(h,S,M);const{w:k,h:B}=oF(M),V=new uc({width:k||1,height:B||1});for(const Z in l){const ie=l[Z],ce=v[Z].paddedRect;uc.copy(ie.data,V,{x:0,y:0},{x:ce.x+1,y:ce.y+1},ie.data)}for(const Z in h){const ie=h[Z],ce=S[Z].paddedRect,_e=ce.x+1,Se=ce.y+1,Le=ie.data.width,ze=ie.data.height;uc.copy(ie.data,V,{x:0,y:0},{x:_e,y:Se},ie.data),uc.copy(ie.data,V,{x:0,y:ze-1},{x:_e,y:Se-1},{width:Le,height:1}),uc.copy(ie.data,V,{x:0,y:0},{x:_e,y:Se+ze},{width:Le,height:1}),uc.copy(ie.data,V,{x:Le-1,y:0},{x:_e-1,y:Se},{width:1,height:ze}),uc.copy(ie.data,V,{x:0,y:0},{x:_e+Le,y:Se},{width:1,height:ze})}this.image=V,this.iconPositions=v,this.patternPositions=S}addImages(l,h,v){for(const S in l){const M=l[S],k={x:0,y:0,w:M.data.width+2,h:M.data.height+2};v.push(k),h[S]=new bC(k,M),M.hasRenderCallback&&this.haveRenderCallbacks.push(S)}}patchUpdatedImages(l,h){l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const v in l.updatedImages)this.patchUpdatedImage(this.iconPositions[v],l.getImage(v),h),this.patchUpdatedImage(this.patternPositions[v],l.getImage(v),h)}patchUpdatedImage(l,h,v){if(!l||!h||l.version===h.version)return;l.version=h.version;const[S,M]=l.tl;v.update(h.data,void 0,{x:S,y:M})}}var Vp;function m2(p,l,h,v,S,M,k,B,V,Z,ie,ce,_e,Se,Le){const ze=Wy.fromFeature(p,S);let Ve;ce===s.az.vertical&&ze.verticalizePunctuation();let et=ze.determineLineBreaks(Z,M,l,v,Se);const{processBidirectionalText:Ct,processStyledBidirectionalText:rt}=da;if(Ct&&ze.sections.length===1){Ve=[],et=et.map((hr=>ze.toCodeUnitIndex(hr)));const Ft=Ct(ze.toString(),et);for(const hr of Ft){const Or=[...hr].map((()=>0));Ve.push(new Wy(hr,ze.sections,Or))}}else if(rt){Ve=[],et=et.map((Pr=>ze.toCodeUnitIndex(Pr)));let Ft=0;const hr=[];for(const Pr of ze.text)hr.push(...Array(Pr.length).fill(ze.sectionIndex[Ft])),Ft++;const Or=rt(ze.text,hr,et);for(const Pr of Or){const Vr=[];let dn="";for(const Wr of Pr[0])Vr.push(Pr[1][dn.length]),dn+=Wr;Ve.push(new Wy(Pr[0],ze.sections,Vr))}}else Ve=(function(Ft,hr){const Or=[];let Pr=0;for(const Vr of hr)Or.push(Ft.substring(Pr,Vr)),Pr=Vr;return Pr<Ft.length()&&Or.push(Ft.substring(Pr,Ft.length())),Or})(ze,et);const ut=[],kt={positionedLines:ut,text:ze.toString(),top:ie[1],bottom:ie[1],left:ie[0],right:ie[0],writingMode:ce,iconsInText:!1,verticalizable:!1};return(function(Ft,hr,Or,Pr,Vr,dn,Wr,kr,Er,Cn,xn,Mn){let vn=0,Gn=0,la=0,Hi=0;const Mo=kr==="right"?1:kr==="left"?0:.5,Ql=ml/Mn;let Ds=0;for(const Ta of Vr){Ta.trim();const Yo=Ta.getMaxScale(),ss={positionedGlyphs:[],lineOffset:0};Ft.positionedLines[Ds]=ss;const co=ss.positionedGlyphs;let cc=0;if(!Ta.length()){Gn+=dn,++Ds;continue}const eu=Cae(Pr,Ta,Ql);let fc=0;for(const _l of Ta.text){const Bo=Ta.getSection(fc),Os=_l.codePointAt(0),Zo=Aae(Er,xn,Os),bl={glyph:Os,imageName:null,x:vn,y:Gn+-17,vertical:Zo,scale:1,fontStack:"",sectionIndex:Ta.getSectionIndex(fc),metrics:null,rect:null};let Gd;if("fontStack"in Bo){if(Gd=Iae(Bo,Os,Zo,eu,hr,Or),!Gd)continue;bl.fontStack=Bo.fontStack}else{if(Ft.iconsInText=!0,Bo.scale*=Ql,Gd=Pae(Bo,Zo,Yo,eu,Pr),!Gd)continue;cc=Math.max(cc,Gd.imageOffset),bl.imageName=Bo.imageName}const{rect:ch,metrics:Z_,baselineOffset:Wp}=Gd;bl.y+=Wp,bl.scale=Bo.scale,bl.metrics=Z_,bl.rect=ch,co.push(bl),Zo?(Ft.verticalizable=!0,vn+=("imageName"in Bo?Z_.advance:ml)*Bo.scale+Cn):vn+=Z_.advance*Bo.scale+Cn,fc++}co.length!==0&&(la=Math.max(vn-Cn,la),Mae(co,0,co.length-1,Mo)),vn=0,ss.lineOffset=Math.max(cc,(Yo-1)*ml);const Cf=dn*Yo+cc;Gn+=Cf,Hi=Math.max(Cf,Hi),++Ds}const{horizontalAlign:ko,verticalAlign:vo}=xC(Wr);(function(Ta,Yo,ss,co,cc,eu,fc,Cf,_l){const Bo=(Yo-ss)*cc;let Os=0;Os=eu!==fc?-Cf*co- -17:-co*_l*fc+.5*fc;for(const Zo of Ta)for(const bl of Zo.positionedGlyphs)bl.x+=Bo,bl.y+=Os})(Ft.positionedLines,Mo,ko,vo,la,Hi,dn,Gn,Vr.length),Ft.top+=-vo*Gn,Ft.bottom=Ft.top+Gn,Ft.left+=-ko*la,Ft.right=Ft.left+la})(kt,l,h,v,Ve,k,B,V,ce,Z,_e,Le),!(function(Ft){for(const hr of Ft)if(hr.positionedGlyphs.length!==0)return!1;return!0})(ut)&&kt}function xC(p){let l=.5,h=.5;switch(p){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(p){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:l,verticalAlign:h}}function Cae(p,l,h){const v=l.getMaxScale()*ml,{maxImageWidth:S,maxImageHeight:M}=l.getMaxImageSize(p),k=Math.max(v,M*h);return{verticalLineContentWidth:Math.max(v,S*h),horizontalLineContentHeight:k}}function lF(p){switch(p){case"top":return 0;case"center":return .5;default:return 1}}function Aae(p,l,h){return!(p===s.az.horizontal||!l&&!Jn(h)||l&&(Vn(h)||(v=h,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(v)))));var v}function Iae(p,l,h,v,S,M){const k=M[p.fontStack],B=(function(Z,ie,ce,_e){if(Z&&Z.rect)return Z;const Se=ie[ce.fontStack],Le=Se&&Se[_e];return Le?{rect:null,metrics:Le.metrics}:null})(k&&k[l],S,p,l);if(B===null)return null;let V;if(h)V=v.verticalLineContentWidth-p.scale*ml;else{const Z=lF(p.verticalAlign);V=(v.horizontalLineContentHeight-p.scale*ml)*Z}return{rect:B.rect,metrics:B.metrics,baselineOffset:V}}function Pae(p,l,h,v,S){const M=S[p.imageName];if(!M)return null;const k=M.paddedRect,B=M.displaySize,V={width:B[0],height:B[1],left:1,top:-3,advance:l?B[1]:B[0]};let Z;if(l)Z=v.verticalLineContentWidth-B[1]*p.scale;else{const ie=lF(p.verticalAlign);Z=(v.horizontalLineContentHeight-B[1]*p.scale)*ie}return{rect:k,metrics:V,baselineOffset:Z,imageOffset:(l?B[0]:B[1])*p.scale-ml*h}}function Mae(p,l,h,v){if(v===0)return;const S=p[h],M=(p[h].x+S.metrics.advance*S.scale)*v;for(let k=l;k<=h;k++)p[k].x-=M}function kae(p,l,h){const{horizontalAlign:v,verticalAlign:S}=xC(h),M=l[0]-p.displaySize[0]*v,k=l[1]-p.displaySize[1]*S;return{image:p,top:k,bottom:k+p.displaySize[1],left:M,right:M+p.displaySize[0]}}function uF(p){var l,h;let v=p.left,S=p.top,M=p.right-v,k=p.bottom-S;const B=(l=p.image.textFitWidth)!==null&&l!==void 0?l:"stretchOrShrink",V=(h=p.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",Z=(p.image.content[2]-p.image.content[0])/(p.image.content[3]-p.image.content[1]);if(V==="proportional"){if(B==="stretchOnly"&&M/k<Z||B==="proportional"){const ie=Math.ceil(k*Z);v*=ie/M,M=ie}}else if(B==="proportional"&&V==="stretchOnly"&&Z!==0&&M/k>Z){const ie=Math.ceil(M/Z);S*=ie/k,k=ie}return{x1:v,y1:S,x2:v+M,y2:S+k}}function cF(p,l,h,v,S,M){const k=p.image;let B;if(k.content){const Ve=k.content,et=k.pixelRatio||1;B=[Ve[0]/et,Ve[1]/et,k.displaySize[0]-Ve[2]/et,k.displaySize[1]-Ve[3]/et]}const V=l.left*M,Z=l.right*M;let ie,ce,_e,Se;h==="width"||h==="both"?(Se=S[0]+V-v[3],ce=S[0]+Z+v[1]):(Se=S[0]+(V+Z-k.displaySize[0])/2,ce=Se+k.displaySize[0]);const Le=l.top*M,ze=l.bottom*M;return h==="height"||h==="both"?(ie=S[1]+Le-v[0],_e=S[1]+ze+v[2]):(ie=S[1]+(Le+ze-k.displaySize[1])/2,_e=ie+k.displaySize[1]),{image:k,top:ie,right:ce,bottom:_e,left:Se,collisionPadding:B}}Pt("ImagePosition",bC),Pt("ImageAtlas",sF),s.az=void 0,(Vp=s.az||(s.az={}))[Vp.none=0]="none",Vp[Vp.horizontal=1]="horizontal",Vp[Vp.vertical=2]="vertical",Vp[Vp.horizontalOnly=3]="horizontalOnly";const qd=128,$p=32640;function fF(p,l){const{expression:h}=l;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Mi(p+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:v,interpolationType:S}=h;let M=0;for(;M<v.length&&v[M]<=p;)M++;M=Math.max(0,M-1);let k=M;for(;k<v.length&&v[k]<p+1;)k++;k=Math.min(v.length-1,k);const B=v[M],V=v[k];return h.kind==="composite"?{kind:"composite",minZoom:B,maxZoom:V,interpolationType:S}:{kind:"camera",minZoom:B,maxZoom:V,minSize:h.evaluate(new Mi(B)),maxSize:h.evaluate(new Mi(V)),interpolationType:S}}}function wC(p,l,h){let v="never";const S=p.get(l);return S?v=S:p.get(h)&&(v="always"),v}const Rae=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function y2(p,l,h,v,S,M,k,B,V,Z,ie,ce,_e){const Se=B?Math.min($p,Math.round(B[0])):0,Le=B?Math.min($p,Math.round(B[1])):0;p.emplaceBack(l,h,Math.round(32*v),Math.round(32*S),M,k,(Se<<1)+(V?1:0),Le,16*Z,16*ie,256*ce,256*_e)}function SC(p,l,h){p.emplaceBack(l.x,l.y,h),p.emplaceBack(l.x,l.y,h),p.emplaceBack(l.x,l.y,h),p.emplaceBack(l.x,l.y,h)}function Dae(p){for(const l of p.sections)if(aa(l.text))return!0;return!1}class EC{constructor(l){this.layoutVertexArray=new Dt,this.indexArray=new xr,this.programConfigurations=l,this.segments=new pn,this.dynamicLayoutVertexArray=new Yt,this.opacityVertexArray=new Sr,this.hasVisibleVertices=!1,this.placedSymbolArray=new z}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,h,v,S){this.isEmpty()||(v&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,oae.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,sae.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,Rae,!0),this.opacityVertexBuffer.itemSize=1),(v||S)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Pt("SymbolBuffers",EC);class TC{constructor(l,h,v){this.layoutVertexArray=new l,this.layoutAttributes=h,this.indexArray=new v,this.segments=new pn,this.collisionVertexArray=new yr}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,lae.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Pt("CollisionBuffers",TC);class Yy{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map((k=>k.id)),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=fF(this.zoom,h["text-size"]),this.iconSizeData=fF(this.zoom,h["icon-size"]);const v=this.layers[0].layout,S=v.get("symbol-sort-key"),M=v.get("symbol-z-order");this.canOverlap=wC(v,"text-overlap","text-allow-overlap")!=="never"||wC(v,"icon-overlap","icon-allow-overlap")!=="never"||v.get("text-ignore-placement")||v.get("icon-ignore-placement"),this.sortFeaturesByKey=M!=="viewport-y"&&!S.isConstant(),this.sortFeaturesByY=(M==="viewport-y"||M==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,v.get("symbol-placement")==="point"&&(this.writingModes=v.get("text-writing-mode").map((k=>s.az[k]))),this.stateDependentLayerIds=this.layers.filter((k=>k.isStateDependent())).map((k=>k.id)),this.sourceID=l.sourceID}createArrays(){this.text=new EC(new $d(this.layers,this.zoom,(l=>/^text/.test(l)))),this.icon=new EC(new $d(this.layers,this.zoom,(l=>/^icon/.test(l)))),this.glyphOffsetArray=new le,this.lineVertexArray=new he,this.symbolInstances=new re,this.textAnchorOffsets=new Ce}calculateGlyphDependencies(l,h,v,S,M){for(const k of l)if(h[k.codePointAt(0)]=!0,(v||S)&&M){const B=$_[k];B&&(h[B.codePointAt(0)]=!0)}}populate(l,h,v){const S=this.layers[0],M=S.layout,k=M.get("text-font"),B=M.get("text-field"),V=M.get("icon-image"),Z=(B.value.kind!=="constant"||B.value.value instanceof _n&&!B.value.value.isEmpty()||B.value.value.toString().length>0)&&(k.value.kind!=="constant"||k.value.value.length>0),ie=V.value.kind!=="constant"||!!V.value.value||Object.keys(V.parameters).length>0,ce=M.get("symbol-sort-key");if(this.features=[],!Z&&!ie)return;const _e=h.iconDependencies,Se=h.glyphDependencies,Le=h.availableImages,ze=new Mi(this.zoom);for(const{feature:Ve,id:et,index:Ct,sourceLayerIndex:rt}of l){const ut=S._featureFilter.needGeometry,kt=Kh(Ve,ut);if(!S._featureFilter.filter(ze,kt,v))continue;let Ft,hr;if(ut||(kt.geometry=Zh(Ve)),Z){const Pr=S.getValueAndResolveTokens("text-field",kt,v,Le),Vr=_n.factory(Pr),dn=this.hasRTLText=this.hasRTLText||Dae(Vr);(!dn||da.getRTLTextPluginStatus()==="unavailable"||dn&&da.isParsed())&&(Ft=cae(Vr,S,kt))}if(ie){const Pr=S.getValueAndResolveTokens("icon-image",kt,v,Le);hr=Pr instanceof wi?Pr:wi.fromString(Pr)}if(!Ft&&!hr)continue;const Or=this.sortFeaturesByKey?ce.evaluate(kt,{},v):void 0;if(this.features.push({id:et,text:Ft,icon:hr,index:Ct,sourceLayerIndex:rt,geometry:kt.geometry,properties:Ve.properties,type:j_.types[Ve.type],sortKey:Or}),hr&&(_e[hr.name]=!0),Ft){const Pr=k.evaluate(kt,{},v).join(","),Vr=M.get("text-rotation-alignment")!=="viewport"&&M.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(s.az.vertical)>=0;for(const dn of Ft.sections)if(dn.image)_e[dn.image.name]=!0;else{const Wr=Ai(Ft.toString()),kr=dn.fontStack||Pr,Er=Se[kr]=Se[kr]||{};this.calculateGlyphDependencies(dn.text,Er,Vr,this.allowVerticalPlacement,Wr)}}}M.get("symbol-placement")==="line"&&(this.features=(function(Ve){const et={},Ct={},rt=[];let ut=0;function kt(Pr){rt.push(Ve[Pr]),ut++}function Ft(Pr,Vr,dn){const Wr=Ct[Pr];return delete Ct[Pr],Ct[Vr]=Wr,rt[Wr].geometry[0].pop(),rt[Wr].geometry[0]=rt[Wr].geometry[0].concat(dn[0]),Wr}function hr(Pr,Vr,dn){const Wr=et[Vr];return delete et[Vr],et[Pr]=Wr,rt[Wr].geometry[0].shift(),rt[Wr].geometry[0]=dn[0].concat(rt[Wr].geometry[0]),Wr}function Or(Pr,Vr,dn){const Wr=dn?Vr[0][Vr[0].length-1]:Vr[0][0];return`${Pr}:${Wr.x}:${Wr.y}`}for(let Pr=0;Pr<Ve.length;Pr++){const Vr=Ve[Pr],dn=Vr.geometry,Wr=Vr.text?Vr.text.toString():null;if(!Wr){kt(Pr);continue}const kr=Or(Wr,dn),Er=Or(Wr,dn,!0);if(kr in Ct&&Er in et&&Ct[kr]!==et[Er]){const Cn=hr(kr,Er,dn),xn=Ft(kr,Er,rt[Cn].geometry);delete et[kr],delete Ct[Er],Ct[Or(Wr,rt[xn].geometry,!0)]=xn,rt[Cn].geometry=null}else kr in Ct?Ft(kr,Er,dn):Er in et?hr(kr,Er,dn):(kt(Pr),et[kr]=ut-1,Ct[Er]=ut-1)}return rt.filter((Pr=>Pr.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Ve,et)=>Ve.sortKey-et.sortKey))}update(l,h,v){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,h,this.layers,{imagePositions:v}),this.icon.programConfigurations.updatePaintArrays(l,h,this.layers,{imagePositions:v}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,h){const v=this.lineVertexArray.length;if(l.segment!==void 0){let S=l.dist(h[l.segment+1]),M=l.dist(h[l.segment]);const k={};for(let B=l.segment+1;B<h.length;B++)k[B]={x:h[B].x,y:h[B].y,tileUnitDistanceFromAnchor:S},B<h.length-1&&(S+=h[B+1].dist(h[B]));for(let B=l.segment||0;B>=0;B--)k[B]={x:h[B].x,y:h[B].y,tileUnitDistanceFromAnchor:M},B>0&&(M+=h[B-1].dist(h[B]));for(let B=0;B<h.length;B++){const V=k[B];this.lineVertexArray.emplaceBack(V.x,V.y,V.tileUnitDistanceFromAnchor)}}return{lineStartIndex:v,lineLength:this.lineVertexArray.length-v}}addSymbols(l,h,v,S,M,k,B,V,Z,ie,ce,_e){const Se=l.indexArray,Le=l.layoutVertexArray,ze=l.segments.prepareSegment(4*h.length,Le,Se,this.canOverlap?k.sortKey:void 0),Ve=this.glyphOffsetArray.length,et=ze.vertexLength,Ct=this.allowVerticalPlacement&&B===s.az.vertical?Math.PI/2:0,rt=k.text&&k.text.sections;for(let ut=0;ut<h.length;ut++){const{tl:kt,tr:Ft,bl:hr,br:Or,tex:Pr,pixelOffsetTL:Vr,pixelOffsetBR:dn,minFontScaleX:Wr,minFontScaleY:kr,glyphOffset:Er,isSDF:Cn,sectionIndex:xn}=h[ut],Mn=ze.vertexLength,vn=Er[1];y2(Le,V.x,V.y,kt.x,vn+kt.y,Pr.x,Pr.y,v,Cn,Vr.x,Vr.y,Wr,kr),y2(Le,V.x,V.y,Ft.x,vn+Ft.y,Pr.x+Pr.w,Pr.y,v,Cn,dn.x,Vr.y,Wr,kr),y2(Le,V.x,V.y,hr.x,vn+hr.y,Pr.x,Pr.y+Pr.h,v,Cn,Vr.x,dn.y,Wr,kr),y2(Le,V.x,V.y,Or.x,vn+Or.y,Pr.x+Pr.w,Pr.y+Pr.h,v,Cn,dn.x,dn.y,Wr,kr),SC(l.dynamicLayoutVertexArray,V,Ct),Se.emplaceBack(Mn,Mn+2,Mn+1),Se.emplaceBack(Mn+1,Mn+2,Mn+3),ze.vertexLength+=4,ze.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Er[0]),ut!==h.length-1&&xn===h[ut+1].sectionIndex||l.programConfigurations.populatePaintArrays(Le.length,k,k.index,{imagePositions:{},canonical:_e,formattedSection:rt&&rt[xn]})}l.placedSymbolArray.emplaceBack(V.x,V.y,Ve,this.glyphOffsetArray.length-Ve,et,Z,ie,V.segment,v?v[0]:0,v?v[1]:0,S[0],S[1],B,0,!1,0,ce)}_addCollisionDebugVertex(l,h,v,S,M,k){return h.emplaceBack(0,0),l.emplaceBack(v.x,v.y,S,M,Math.round(k.x),Math.round(k.y))}addCollisionDebugVertices(l,h,v,S,M,k,B){const V=M.segments.prepareSegment(4,M.layoutVertexArray,M.indexArray),Z=V.vertexLength,ie=M.layoutVertexArray,ce=M.collisionVertexArray,_e=B.anchorX,Se=B.anchorY;this._addCollisionDebugVertex(ie,ce,k,_e,Se,new c(l,h)),this._addCollisionDebugVertex(ie,ce,k,_e,Se,new c(v,h)),this._addCollisionDebugVertex(ie,ce,k,_e,Se,new c(v,S)),this._addCollisionDebugVertex(ie,ce,k,_e,Se,new c(l,S)),V.vertexLength+=4;const Le=M.indexArray;Le.emplaceBack(Z,Z+1),Le.emplaceBack(Z+1,Z+2),Le.emplaceBack(Z+2,Z+3),Le.emplaceBack(Z+3,Z),V.primitiveLength+=4}addDebugCollisionBoxes(l,h,v,S){for(let M=l;M<h;M++){const k=this.collisionBoxArray.get(M);this.addCollisionDebugVertices(k.x1,k.y1,k.x2,k.y2,S?this.textCollisionBox:this.iconCollisionBox,k.anchorPoint,v)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new TC(dr,J6.members,nn),this.iconCollisionBox=new TC(dr,J6.members,nn);for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(l,h,v,S,M,k,B,V,Z){const ie={};for(let ce=h;ce<v;ce++){const _e=l.get(ce);ie.textBox={x1:_e.x1,y1:_e.y1,x2:_e.x2,y2:_e.y2,anchorPointX:_e.anchorPointX,anchorPointY:_e.anchorPointY},ie.textFeatureIndex=_e.featureIndex;break}for(let ce=S;ce<M;ce++){const _e=l.get(ce);ie.verticalTextBox={x1:_e.x1,y1:_e.y1,x2:_e.x2,y2:_e.y2,anchorPointX:_e.anchorPointX,anchorPointY:_e.anchorPointY},ie.verticalTextFeatureIndex=_e.featureIndex;break}for(let ce=k;ce<B;ce++){const _e=l.get(ce);ie.iconBox={x1:_e.x1,y1:_e.y1,x2:_e.x2,y2:_e.y2,anchorPointX:_e.anchorPointX,anchorPointY:_e.anchorPointY},ie.iconFeatureIndex=_e.featureIndex;break}for(let ce=V;ce<Z;ce++){const _e=l.get(ce);ie.verticalIconBox={x1:_e.x1,y1:_e.y1,x2:_e.x2,y2:_e.y2,anchorPointX:_e.anchorPointX,anchorPointY:_e.anchorPointY},ie.verticalIconFeatureIndex=_e.featureIndex;break}return ie}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const v=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,v.textBoxStartIndex,v.textBoxEndIndex,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v.iconBoxStartIndex,v.iconBoxEndIndex,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,h){const v=l.placedSymbolArray.get(h),S=v.vertexStartIndex+4*v.numGlyphs;for(let M=v.vertexStartIndex;M<S;M+=4)l.indexArray.emplaceBack(M,M+2,M+1),l.indexArray.emplaceBack(M+1,M+2,M+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(l),v=Math.cos(l),S=[],M=[],k=[];for(let B=0;B<this.symbolInstances.length;++B){k.push(B);const V=this.symbolInstances.get(B);S.push(0|Math.round(h*V.anchorX+v*V.anchorY)),M.push(V.featureIndex)}return k.sort(((B,V)=>S[B]-S[V]||M[V]-M[B])),k}addToSortKeyRanges(l,h){const v=this.sortKeyRanges[this.sortKeyRanges.length-1];v&&v.sortKey===h?v.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const v=this.symbolInstances.get(h);this.featureSortOrder.push(v.featureIndex),[v.rightJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.leftJustifiedTextSymbolIndex].forEach(((S,M,k)=>{S>=0&&k.indexOf(S)===M&&this.addIndicesForPlacedSymbol(this.text,S)})),v.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,v.verticalPlacedTextSymbolIndex),v.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.placedIconSymbolIndex),v.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,v.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let hF,dF;Pt("SymbolBucket",Yy,{omit:["layers","collisionBoxArray","features","compareText"]}),Yy.MAX_GLYPHS=65535,Yy.addDynamicAttributes=SC;var CC={get paint(){return dF=dF||new $a({"icon-opacity":new Sn(Rt.paint_symbol["icon-opacity"]),"icon-color":new Sn(Rt.paint_symbol["icon-color"]),"icon-halo-color":new Sn(Rt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Sn(Rt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Sn(Rt.paint_symbol["icon-halo-blur"]),"icon-translate":new Tn(Rt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Tn(Rt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Sn(Rt.paint_symbol["text-opacity"]),"text-color":new Sn(Rt.paint_symbol["text-color"],{runtimeType:ei,getOverride:p=>p.textColor,hasOverride:p=>!!p.textColor}),"text-halo-color":new Sn(Rt.paint_symbol["text-halo-color"]),"text-halo-width":new Sn(Rt.paint_symbol["text-halo-width"]),"text-halo-blur":new Sn(Rt.paint_symbol["text-halo-blur"]),"text-translate":new Tn(Rt.paint_symbol["text-translate"]),"text-translate-anchor":new Tn(Rt.paint_symbol["text-translate-anchor"])})},get layout(){return hF=hF||new $a({"symbol-placement":new Tn(Rt.layout_symbol["symbol-placement"]),"symbol-spacing":new Tn(Rt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Tn(Rt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Sn(Rt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Tn(Rt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Tn(Rt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Tn(Rt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Tn(Rt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Tn(Rt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Tn(Rt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Sn(Rt.layout_symbol["icon-size"]),"icon-text-fit":new Tn(Rt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Tn(Rt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Sn(Rt.layout_symbol["icon-image"]),"icon-rotate":new Sn(Rt.layout_symbol["icon-rotate"]),"icon-padding":new Sn(Rt.layout_symbol["icon-padding"]),"icon-keep-upright":new Tn(Rt.layout_symbol["icon-keep-upright"]),"icon-offset":new Sn(Rt.layout_symbol["icon-offset"]),"icon-anchor":new Sn(Rt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Tn(Rt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Tn(Rt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Tn(Rt.layout_symbol["text-rotation-alignment"]),"text-field":new Sn(Rt.layout_symbol["text-field"]),"text-font":new Sn(Rt.layout_symbol["text-font"]),"text-size":new Sn(Rt.layout_symbol["text-size"]),"text-max-width":new Sn(Rt.layout_symbol["text-max-width"]),"text-line-height":new Tn(Rt.layout_symbol["text-line-height"]),"text-letter-spacing":new Sn(Rt.layout_symbol["text-letter-spacing"]),"text-justify":new Sn(Rt.layout_symbol["text-justify"]),"text-radial-offset":new Sn(Rt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Tn(Rt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Sn(Rt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Sn(Rt.layout_symbol["text-anchor"]),"text-max-angle":new Tn(Rt.layout_symbol["text-max-angle"]),"text-writing-mode":new Tn(Rt.layout_symbol["text-writing-mode"]),"text-rotate":new Sn(Rt.layout_symbol["text-rotate"]),"text-padding":new Tn(Rt.layout_symbol["text-padding"]),"text-keep-upright":new Tn(Rt.layout_symbol["text-keep-upright"]),"text-transform":new Sn(Rt.layout_symbol["text-transform"]),"text-offset":new Sn(Rt.layout_symbol["text-offset"]),"text-allow-overlap":new Tn(Rt.layout_symbol["text-allow-overlap"]),"text-overlap":new Tn(Rt.layout_symbol["text-overlap"]),"text-ignore-placement":new Tn(Rt.layout_symbol["text-ignore-placement"]),"text-optional":new Tn(Rt.layout_symbol["text-optional"])})}};class pF{constructor(l){if(l.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=l.property.overrides?l.property.overrides.runtimeType:Ci,this.defaultValue=l}evaluate(l){if(l.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(l.formattedSection))return h.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pt("FormatSectionOverride",pF,{omit:["defaultValue"]});class v2 extends eo{constructor(l,h){super(l,CC,h)}recalculate(l,h){if(super.recalculate(l,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const v=this.layout.get("text-writing-mode");if(v){const S=[];for(const M of v)S.indexOf(M)<0&&S.push(M);this.layout._values["text-writing-mode"]=S}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(l,h,v,S){const M=this.layout.get(l).evaluate(h,{},v,S),k=this._unevaluatedLayout._values[l];return k.isDataDriven()||Vc(k.value)||!M?M:(function(B,V){return V.replace(/{([^{}]+)}/g,((Z,ie)=>B&&ie in B?String(B[ie]):""))})(h.properties,M)}createBucket(l){return new Yy(l)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const l of CC.paint.overridableProperties){if(!v2.hasPaintOverride(this.layout,l))continue;const h=this.paint.get(l),v=new pF(h),S=new Rd(v,h.property.specification);let M=null;M=h.value.kind==="constant"||h.value.kind==="source"?new Rp("source",S):new Hg("composite",S,h.value.zoomStops),this.paint._values[l]=new qi(h.property,M,h.parameters)}}_handleOverridablePaintPropertyUpdate(l,h,v){return!(!this.layout||h.isDataDriven()||v.isDataDriven())&&v2.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,h){const v=l.get("text-field"),S=CC.paint.properties[h];let M=!1;const k=B=>{for(const V of B)if(S.overrides&&S.overrides.hasOverride(V))return void(M=!0)};if(v.value.kind==="constant"&&v.value.value instanceof _n)k(v.value.value.sections);else if(v.value.kind==="source"||v.value.kind==="composite"){const B=Z=>{M||(Z instanceof oa&&Ri(Z.value)===Wi?k(Z.value.sections):Z instanceof Ys?k(Z.sections):Z.eachChild(B))},V=v.value;V._styleExpression&&B(V._styleExpression.expression)}return M}}let gF;var Oae={get paint(){return gF=gF||new $a({"background-color":new Tn(Rt.paint_background["background-color"]),"background-pattern":new Sa(Rt.paint_background["background-pattern"]),"background-opacity":new Tn(Rt.paint_background["background-opacity"])})}};class Lae extends eo{constructor(l,h){super(l,Oae,h)}}class Nae extends eo{constructor(l,h){super(l,{},h),this.onAdd=v=>{this.implementation.onAdd&&this.implementation.onAdd(v,v.painter.context.gl)},this.onRemove=v=>{this.implementation.onRemove&&this.implementation.onRemove(v,v.painter.context.gl)},this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Fae{constructor(l){this._methodToThrottle=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Bae={once:!0},AC=63710088e-1;class qp{constructor(l,h){if(isNaN(l)||isNaN(h))throw new Error(`Invalid LngLat object: (${l}, ${h})`);if(this.lng=+l,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new qp(Xe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){const h=Math.PI/180,v=this.lat*h,S=l.lat*h,M=Math.sin(v)*Math.sin(S)+Math.cos(v)*Math.cos(S)*Math.cos((l.lng-this.lng)*h);return AC*Math.acos(Math.min(M,1))}static convert(l){if(l instanceof qp)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new qp(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new qp(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const mF=2*Math.PI*AC;function yF(p){return mF*Math.cos(p*Math.PI/180)}function vF(p){return(180+p)/360}function _F(p){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+p*Math.PI/360)))/360}function bF(p,l){return p/yF(l)}function xF(p){return 360*p-180}function _2(p){return 360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90}function wF(p,l){return p*yF(_2(l))}class q_{constructor(l,h,v=0){this.x=+l,this.y=+h,this.z=+v}static fromLngLat(l,h=0){const v=qp.convert(l);return new q_(vF(v.lng),_F(v.lat),bF(h,v.lat))}toLngLat(){return new qp(xF(this.x),_2(this.y))}toAltitude(){return wF(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/mF*(l=_2(this.y),1/Math.cos(l*Math.PI/180));var l}}function SF(p,l,h){var v=2*Math.PI*6378137/256/Math.pow(2,h);return[p*v-2*Math.PI*6378137/2,l*v-2*Math.PI*6378137/2]}class IC{constructor(l,h,v){if(!(function(S,M,k){return!(S<0||S>25||k<0||k>=Math.pow(2,S)||M<0||M>=Math.pow(2,S))})(l,h,v))throw new Error(`x=${h}, y=${v}, z=${l} outside of bounds. 0<=x<${Math.pow(2,l)}, 0<=y<${Math.pow(2,l)} 0<=z<=25 `);this.z=l,this.x=h,this.y=v,this.key=Zy(0,l,l,h,v)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,h,v){const S=(function(k,B,V){var Z=SF(256*k,256*(B=Math.pow(2,V)-B-1),V),ie=SF(256*(k+1),256*(B+1),V);return Z[0]+","+Z[1]+","+ie[0]+","+ie[1]})(this.x,this.y,this.z),M=(function(k,B,V){let Z,ie="";for(let ce=k;ce>0;ce--)Z=1<<ce-1,ie+=(B&Z?1:0)+(V&Z?2:0);return ie})(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(v==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,S)}isChildOf(l){const h=this.z-l.z;return h>0&&l.x===this.x>>h&&l.y===this.y>>h}getTilePoint(l){const h=Math.pow(2,this.z);return new c((l.x*h-this.x)*we,(l.y*h-this.y)*we)}toString(){return`${this.z}/${this.x}/${this.y}`}}class EF{constructor(l,h){this.wrap=l,this.canonical=h,this.key=Zy(l,h.z,h.z,h.x,h.y)}}class Xc{constructor(l,h,v,S,M){if(this.terrainRttPosMatrix32f=null,l<v)throw new Error(`overscaledZ should be >= z; overscaledZ = ${l}; z = ${v}`);this.overscaledZ=l,this.wrap=h,this.canonical=new IC(v,+S,+M),this.key=Zy(h,l,v,S,M)}clone(){return new Xc(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-l;return l>this.canonical.z?new Xc(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Xc(l,this.wrap,l,this.canonical.x>>h,this.canonical.y>>h)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(l,h){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const v=this.canonical.z-l;return l>this.canonical.z?Zy(this.wrap*+h,l,this.canonical.z,this.canonical.x,this.canonical.y):Zy(this.wrap*+h,l,l,this.canonical.x>>v,this.canonical.y>>v)}isChildOf(l){if(l.wrap!==this.wrap||this.overscaledZ-l.overscaledZ<=0)return!1;if(l.overscaledZ===0)return this.overscaledZ>0;const h=this.canonical.z-l.canonical.z;return!(h<0)&&l.canonical.x===this.canonical.x>>h&&l.canonical.y===this.canonical.y>>h}children(l){if(this.overscaledZ>=l)return[new Xc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,v=2*this.canonical.x,S=2*this.canonical.y;return[new Xc(h,this.wrap,h,v,S),new Xc(h,this.wrap,h,v+1,S),new Xc(h,this.wrap,h,v,S+1),new Xc(h,this.wrap,h,v+1,S+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new Xc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new Xc(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new EF(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(l){return this.canonical.getTilePoint(new q_(l.x-this.wrap,l.y))}}function Zy(p,l,h,v,S){(p*=2)<0&&(p=-1*p-1);const M=1<<h;return(M*M*p+M*S+v).toString(36)+h.toString(36)+l.toString(36)}function PC(p,l){return l?p.properties[l]:p.id}function zae(p,l){const h={id:p.id};if(l.removeAllProperties&&(delete p.removeProperties,delete p.addOrUpdateProperties,delete l.removeProperties),l.removeProperties)for(const v of l.removeProperties){const S=p.addOrUpdateProperties.findIndex((M=>M.key===v));S>-1&&p.addOrUpdateProperties.splice(S,1)}return(p.removeAllProperties||l.removeAllProperties)&&(h.removeAllProperties=!0),(p.removeProperties||l.removeProperties)&&(h.removeProperties=[...p.removeProperties||[],...l.removeProperties||[]]),(p.addOrUpdateProperties||l.addOrUpdateProperties)&&(h.addOrUpdateProperties=[...p.addOrUpdateProperties||[],...l.addOrUpdateProperties||[]]),(p.newGeometry||l.newGeometry)&&(h.newGeometry=l.newGeometry||p.newGeometry),h}function TF(p){var l,h;if(!p)return{};const v={};return v.removeAll=p.removeAll,v.remove=new Set(p.remove||[]),v.add=new Map((l=p.add)===null||l===void 0?void 0:l.map((S=>[S.id,S]))),v.update=new Map((h=p.update)===null||h===void 0?void 0:h.map((S=>[S.id,S]))),v}Pt("CanonicalTileID",IC),Pt("OverscaledTileID",Xc,{omit:["terrainRttPosMatrix32f"]});class nm{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(l){return this.minX=Math.min(this.minX,l.x),this.minY=Math.min(this.minY,l.y),this.maxX=Math.max(this.maxX,l.x),this.maxY=Math.max(this.maxY,l.y),this}expandBy(l){return this.minX-=l,this.minY-=l,this.maxX+=l,this.maxY+=l,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(l){return this.expandBy(-l)}map(l){const h=new nm;return h.extend(l(new c(this.minX,this.minY))),h.extend(l(new c(this.maxX,this.minY))),h.extend(l(new c(this.minX,this.maxY))),h.extend(l(new c(this.maxX,this.maxY))),h}static fromPoints(l){const h=new nm;for(const v of l)h.extend(v);return h}contains(l){return l.x>=this.minX&&l.x<=this.maxX&&l.y>=this.minY&&l.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(l){return!this.empty()&&!l.empty()&&l.minX>=this.minX&&l.maxX<=this.maxX&&l.minY>=this.minY&&l.maxY<=this.maxY}intersects(l){return!this.empty()&&!l.empty()&&l.minX<=this.maxX&&l.maxX>=this.minX&&l.minY<=this.maxY&&l.maxY>=this.minY}}class CF{constructor(l){this._stringToNumber={},this._numberToString=[];for(let h=0;h<l.length;h++){const v=l[h];this._stringToNumber[v]=h,this._numberToString[h]=v}}encode(l){return this._stringToNumber[l]}decode(l){if(l>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${l} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[l]}}class AF{constructor(l,h,v,S,M){this.type="Feature",this._vectorTileFeature=l,this._x=v,this._y=S,this._z=h,this.properties=l.properties,this.id=M}projectPoint(l,h,v,S){return[360*(l.x+h)/S-180,360/Math.PI*Math.atan(Math.exp((1-2*(l.y+v)/S)*Math.PI))-90]}projectLine(l,h,v,S){return l.map((M=>this.projectPoint(M,h,v,S)))}get geometry(){if(this._geometry)return this._geometry;const l=this._vectorTileFeature,h=l.extent*Math.pow(2,this._z),v=l.extent*this._x,S=l.extent*this._y,M=l.loadGeometry();switch(l.type){case 1:{const k=[];for(const V of M)k.push(V[0]);const B=this.projectLine(k,v,S,h);this._geometry=k.length===1?{type:"Point",coordinates:B[0]}:{type:"MultiPoint",coordinates:B};break}case 2:{const k=M.map((B=>this.projectLine(B,v,S,h)));this._geometry=k.length===1?{type:"LineString",coordinates:k[0]}:{type:"MultiLineString",coordinates:k};break}case 3:{const k=V6(M),B=[];for(const V of k)B.push(V.map((Z=>this.projectLine(Z,v,S,h))));this._geometry=B.length===1?{type:"Polygon",coordinates:B[0]}:{type:"MultiPolygon",coordinates:B};break}default:throw new Error(`unknown feature type: ${l.type}`)}return this._geometry}set geometry(l){this._geometry=l}toJSON(){const l={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&h!=="_x"&&h!=="_y"&&h!=="_z"&&(l[h]=this[h]);return l}}class Ky{_name;dataBuffer;nullabilityBuffer;_size;constructor(l,h,v){this._name=l,this.dataBuffer=h,typeof v=="number"?this._size=v:(this.nullabilityBuffer=v,this._size=v.size())}getValue(l){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(l)?null:this.getValueFromBuffer(l)}has(l){return this.nullabilityBuffer&&this.nullabilityBuffer.get(l)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class b2 extends Ky{}class MC extends b2{getValueFromBuffer(l){return this.dataBuffer[l]}}class kC extends b2{getValueFromBuffer(l){return this.dataBuffer[l]}}class IF extends Ky{delta;constructor(l,h,v,S){super(l,h,S),this.delta=v}}class RC extends IF{constructor(l,h,v,S){super(l,Int32Array.of(h),v,S)}getValueFromBuffer(l){return this.dataBuffer[0]+l*this.delta}}class DC extends Ky{constructor(l,h,v){super(l,Int32Array.of(h),v)}getValueFromBuffer(l){return this.dataBuffer[0]}}class jae{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(l,h,v,S,M=4096){this._name=l,this._geometryVector=h,this._idVector=v,this._propertyVectors=S,this._extent=M}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(l){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((h=>[h.name,h])))),this.propertyVectorsMap.get(l)}*[Symbol.iterator](){const l=this.geometryVector[Symbol.iterator]();let h=0;for(;h<this.numFeatures;){let v;this.idVector&&(v=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(h)):this.idVector.getValue(h));const S=l?.next().value,M={};for(const k of this.propertyVectors){if(!k)continue;const B=k.name,V=k.getValue(h);V!==null&&(M[B]=V)}h++,yield{id:v,geometry:S,properties:M}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const l=[],h=this.geometryVector.getGeometries();for(let v=0;v<this.numFeatures;v++){let S;this.idVector&&(S=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(v)):this.idVector.getValue(v));const M={coordinates:h[v],type:this.geometryVector.geometryType(v)},k={};for(const B of this.propertyVectors){if(!B)continue;const V=B.name,Z=B.getValue(v);Z!==null&&(k[V]=Z)}l.push({id:S,geometry:M,properties:k})}return l}containsMaxSaveIntegerValues(l){return l instanceof MC||l instanceof DC&&l instanceof RC||l instanceof kC}}class Uae{value;constructor(l){this.value=l}get(){return this.value}set(l){this.value=l}increment(){return this.value++}add(l){this.value+=l}}var Zi,Hd,Kl,lh,im,Ec,yl,vl,PF,Yc;function Dl(p,l,h){const v=new Int32Array(h);let S=0,M=l.get();for(let k=0;k<v.length;k++){let B=p[M++],V=127&B;B<128||(B=p[M++],V|=(127&B)<<7,B<128||(B=p[M++],V|=(127&B)<<14,B<128||(B=p[M++],V|=(127&B)<<21,B<128||(B=p[M++],V|=(15&B)<<28)))),v[S++]=V}return l.set(M),v}function x2(p,l,h){const v=new BigInt64Array(h);for(let S=0;S<v.length;S++)v[S]=$ae(p,l);return v}function Vae(p,l){let h,v;return v=p[l.get()],l.increment(),h=127&v,v<128?h:(v=p[l.get()],l.increment(),h|=(127&v)<<7,v<128?h:(v=p[l.get()],l.increment(),h|=(127&v)<<14,v<128?h:(v=p[l.get()],l.increment(),h|=(127&v)<<21,v<128?h:(v=p[l.get()],h|=(15&v)<<28,(function(S,M,k){let B,V;if(V=M[k.get()],k.increment(),B=(112&V)>>4,V<128||(V=M[k.get()],k.increment(),B|=(127&V)<<3,V<128)||(V=M[k.get()],k.increment(),B|=(127&V)<<10,V<128)||(V=M[k.get()],k.increment(),B|=(127&V)<<17,V<128)||(V=M[k.get()],k.increment(),B|=(127&V)<<24,V<128)||(V=M[k.get()],k.increment(),B|=(1&V)<<31,V<128))return 4294967296*B+(S>>>0);throw new Error("Expected varint not more than 10 bytes")})(h,p,l)))))}function MF(p,l,h,v){throw new Error("FastPFor is not implemented yet.")}function am(p){return p>>>1^-(1&p)}function Jy(p){return p>>1n^-(1n&p)}function $ae(p,l){let h=0n,v=0,S=l.get();for(;S<p.length;){const M=p[S++];if(h|=BigInt(127&M)<<BigInt(v),!(128&M))break;if(v+=7,v>=64)throw new Error("Varint too long")}return l.set(S),h}function kF(p,l,h){const v=new Int32Array(h);let S=0;for(let M=0;M<l;M++){const k=p[M];v.fill(p[M+l],S,S+k),S+=k}return v}function RF(p,l,h){const v=new BigInt64Array(h);let S=0;for(let M=0;M<l;M++){const k=Number(p[M]);v.fill(p[M+l],S,S+k),S+=k}return v}function DF(p,l,h){const v=new Float64Array(h);let S=0;for(let M=0;M<l;M++){const k=p[M];v.fill(p[M+l],S,S+k),S+=k}return v}function OC(p){const l=p.length/4*4;let h=1;if(l>=4)for(let v=p[0];h<l-4;h+=4)v=p[h]+=v,v=p[h+1]+=v,v=p[h+2]+=v,v=p[h+3]+=v;for(;h!=p.length;)p[h]+=p[h-1],++h}function OF(p){p[0]=p[0]>>>1^-(1&p[0]),p[1]=p[1]>>>1^-(1&p[1]);const l=p.length/4*4;let h=2;if(l>=4)for(;h<l-4;h+=4){const v=p[h],S=p[h+1],M=p[h+2],k=p[h+3];p[h]=(v>>>1^-(1&v))+p[h-2],p[h+1]=(S>>>1^-(1&S))+p[h-1],p[h+2]=(M>>>1^-(1&M))+p[h],p[h+3]=(k>>>1^-(1&k))+p[h+1]}for(;h!=p.length;h+=2)p[h]=(p[h]>>>1^-(1&p[h]))+p[h-2],p[h+1]=(p[h+1]>>>1^-(1&p[h+1]))+p[h-1]}(function(p){p.NONE="NONE",p.DELTA="DELTA",p.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",p.RLE="RLE",p.MORTON="MORTON",p.PDE="PDE"})(Zi||(Zi={})),(function(p){p.NONE="NONE",p.FAST_PFOR="FAST_PFOR",p.VARINT="VARINT",p.ALP="ALP"})(Hd||(Hd={})),(function(p){p.PRESENT="PRESENT",p.DATA="DATA",p.OFFSET="OFFSET",p.LENGTH="LENGTH"})(Kl||(Kl={}));class LC{_dictionaryType;_offsetType;_lengthType;constructor(l,h,v){this._dictionaryType=l,this._offsetType=h,this._lengthType=v}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function ju(p,l){const h=(function(v,S){const M=v[S.get()],k=Object.values(Kl)[M>>4];let B=null;switch(k){case Kl.DATA:B=new LC(Object.values(lh)[15&M]);break;case Kl.OFFSET:B=new LC(null,Object.values(im)[15&M]);break;case Kl.LENGTH:B=new LC(null,null,Object.values(Ec)[15&M])}S.increment();const V=v[S.get()],Z=Object.values(Zi)[V>>5],ie=Object.values(Zi)[V>>2&7],ce=Object.values(Hd)[3&V];S.increment();const _e=Dl(v,S,2),Se=_e[0];return{physicalStreamType:k,logicalStreamType:B,logicalLevelTechnique1:Z,logicalLevelTechnique2:ie,physicalLevelTechnique:ce,numValues:Se,byteLength:_e[1],decompressedCount:Se}})(p,l);return h.logicalLevelTechnique1===Zi.MORTON?(function(v,S,M){const k=Dl(S,M,2);return{physicalStreamType:v.physicalStreamType,logicalStreamType:v.logicalStreamType,logicalLevelTechnique1:v.logicalLevelTechnique1,logicalLevelTechnique2:v.logicalLevelTechnique2,physicalLevelTechnique:v.physicalLevelTechnique,numValues:v.numValues,byteLength:v.byteLength,decompressedCount:v.decompressedCount,numBits:k[0],coordinateShift:k[1]}})(h,p,l):Zi.RLE!==h.logicalLevelTechnique1&&Zi.RLE!==h.logicalLevelTechnique2||Hd.NONE===h.physicalLevelTechnique?h:(function(v,S,M){const k=Dl(S,M,2);return{physicalStreamType:v.physicalStreamType,logicalStreamType:v.logicalStreamType,logicalLevelTechnique1:v.logicalLevelTechnique1,logicalLevelTechnique2:v.logicalLevelTechnique2,physicalLevelTechnique:v.physicalLevelTechnique,numValues:v.numValues,byteLength:v.byteLength,decompressedCount:k[1],runs:k[0],numRleValues:k[1]}})(h,p,l)}(function(p){p.NONE="NONE",p.SINGLE="SINGLE",p.SHARED="SHARED",p.VERTEX="VERTEX",p.MORTON="MORTON",p.FSST="FSST"})(lh||(lh={})),(function(p){p.VERTEX="VERTEX",p.INDEX="INDEX",p.STRING="STRING",p.KEY="KEY"})(im||(im={})),(function(p){p.VAR_BINARY="VAR_BINARY",p.GEOMETRIES="GEOMETRIES",p.PARTS="PARTS",p.RINGS="RINGS",p.TRIANGLES="TRIANGLES",p.SYMBOL="SYMBOL",p.DICTIONARY="DICTIONARY"})(Ec||(Ec={})),(function(p){p[p.FLAT=0]="FLAT",p[p.CONST=1]="CONST",p[p.SEQUENCE=2]="SEQUENCE",p[p.DICTIONARY=3]="DICTIONARY",p[p.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(yl||(yl={}));class uh{values;_size;constructor(l,h){this.values=l,this._size=h}get(l){const h=Math.floor(l/8);return(this.values[h]>>l%8&1)==1}set(l,h){const v=Math.floor(l/8);this.values[v]=this.values[v]|(h?1:0)<<l%8}getInt(l){const h=Math.floor(l/8);return this.values[h]>>l%8&1}size(){return this._size}getBuffer(){return this.values}}function Uu(p,l,h,v,S){return(function(M,k,B){switch(k.logicalLevelTechnique1){case Zi.DELTA:return k.logicalLevelTechnique2===Zi.RLE?(function(V,Z,ie){const ce=new Int32Array(ie);let _e=0,Se=0;for(let Le=0;Le<Z;Le++){const ze=V[Le],Ve=am(V[Le+Z]);for(let et=0;et<ze;et++)Se+=Ve,ce[_e++]=Se}return ce})(M,k.runs,k.numRleValues):((function(V){V[0]=V[0]>>>1^-(1&V[0]);const Z=V.length/4*4;let ie=1;if(Z>=4)for(;ie<Z-4;ie+=4){const ce=V[ie],_e=V[ie+1],Se=V[ie+2],Le=V[ie+3];V[ie]=(ce>>>1^-(1&ce))+V[ie-1],V[ie+1]=(_e>>>1^-(1&_e))+V[ie],V[ie+2]=(Se>>>1^-(1&Se))+V[ie+1],V[ie+3]=(Le>>>1^-(1&Le))+V[ie+2]}for(;ie!=V.length;++ie)V[ie]=(V[ie]>>>1^-(1&V[ie]))+V[ie-1]})(M),M);case Zi.RLE:return(function(V,Z,ie){return ie?(function(ce,_e,Se){const Le=new Int32Array(Se);let ze=0;for(let Ve=0;Ve<_e;Ve++){const et=ce[Ve];let Ct=ce[Ve+_e];Ct=Ct>>>1^-(1&Ct),Le.fill(Ct,ze,ze+et),ze+=et}return Le})(V,Z.runs,Z.numRleValues):kF(V,Z.runs,Z.numRleValues)})(M,k,B);case Zi.MORTON:return OC(M),M;case Zi.COMPONENTWISE_DELTA:return OF(M),M;case Zi.NONE:return B&&(function(V){for(let Z=0;Z<V.length;Z++){const ie=V[Z];V[Z]=ie>>>1^-(1&ie)}})(M),M;default:throw new Error(`The specified Logical level technique is not supported: ${k.logicalLevelTechnique1}`)}})(w2(p,l,h),h,v)}function Hp(p,l,h){return(function(v,S){if(S.logicalLevelTechnique1===Zi.DELTA&&S.logicalLevelTechnique2===Zi.NONE)return(function(k){const B=new Int32Array(k.length+1);B[0]=0,B[1]=am(k[0]);let V=B[1],Z=2;for(;Z!=B.length;++Z){const ie=k[Z-1];V+=ie>>>1^-(1&ie),B[Z]=B[Z-1]+V}return B})(v);if(S.logicalLevelTechnique1===Zi.RLE&&S.logicalLevelTechnique2===Zi.NONE)return(function(k,B,V){const Z=new Int32Array(V+1);Z[0]=0;let ie=1,ce=Z[0];for(let _e=0;_e<B;_e++){const Se=k[_e],Le=k[_e+B];for(let ze=ie;ze<ie+Se;ze++)Z[ze]=Le+ce,ce=Z[ze];ie+=Se}return Z})(v,S.runs,S.numRleValues);if(S.logicalLevelTechnique1===Zi.NONE&&S.logicalLevelTechnique2===Zi.NONE){(function(k){let B=0;for(let V=0;V<k.length;V++)k[V]+=B,B=k[V]})(v);const M=new Int32Array(S.numValues+1);return M[0]=0,M.set(v,1),M}if(S.logicalLevelTechnique1===Zi.DELTA&&S.logicalLevelTechnique2===Zi.RLE){const M=(function(k,B,V){const Z=new Int32Array(V+1);Z[0]=0;let ie=1,ce=Z[0];for(let _e=0;_e<B;_e++){const Se=k[_e];let Le=k[_e+B];Le=Le>>>1^-(1&Le);for(let ze=ie;ze<ie+Se;ze++)Z[ze]=Le+ce,ce=Z[ze];ie+=Se}return Z})(v,S.runs,S.numRleValues);return OC(M),M}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(w2(p,l,h),h)}function w2(p,l,h){const v=h.physicalLevelTechnique;if(v===Hd.FAST_PFOR)return MF();if(v===Hd.VARINT)return Dl(p,l,h.numValues);if(v===Hd.NONE){const S=l.get();l.add(h.byteLength);const M=p.subarray(S,l.get());return new Int32Array(M)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function NC(p,l,h,v){const S=w2(p,l,h);if(S.length===1){const M=S[0];return v?am(M):M}return v?(function(M){return am(M[1])})(S):(function(M){return M[1]})(S)}function LF(p,l,h){return(function(v){if(v.length==2){const S=am(v[1]);return[S,S]}return[am(v[2]),am(v[3])]})(w2(p,l,h))}function NF(p,l,h){return(function(v){if(v.length==2){const S=Jy(v[1]);return[S,S]}return[Jy(v[2]),Jy(v[3])]})(x2(p,l,h.numValues))}function FF(p,l,h,v){return(function(S,M,k){switch(M.logicalLevelTechnique1){case Zi.DELTA:return M.logicalLevelTechnique2===Zi.RLE?(function(B,V,Z){const ie=new BigInt64Array(Z);let ce=0,_e=0n;for(let Se=0;Se<V;Se++){const Le=Number(B[Se]),ze=Jy(B[Se+V]);for(let Ve=0;Ve<Le;Ve++)_e+=ze,ie[ce++]=_e}return ie})(S,M.runs,M.numRleValues):((function(B){B[0]=B[0]>>1n^-(1n&B[0]);const V=B.length/4*4;let Z=1;if(V>=4)for(;Z<V-4;Z+=4){const ie=B[Z],ce=B[Z+1],_e=B[Z+2],Se=B[Z+3];B[Z]=(ie>>1n^-(1n&ie))+B[Z-1],B[Z+1]=(ce>>1n^-(1n&ce))+B[Z],B[Z+2]=(_e>>1n^-(1n&_e))+B[Z+1],B[Z+3]=(Se>>1n^-(1n&Se))+B[Z+2]}for(;Z!=B.length;++Z)B[Z]=(B[Z]>>1n^-(1n&B[Z]))+B[Z-1]})(S),S);case Zi.RLE:return(function(B,V,Z){return Z?(function(ie,ce,_e){const Se=new BigInt64Array(_e);let Le=0;for(let ze=0;ze<ce;ze++){const Ve=Number(ie[ze]);let et=ie[ze+ce];et=et>>1n^-(1n&et),Se.fill(et,Le,Le+Ve),Le+=Ve}return Se})(B,V.runs,V.numRleValues):RF(B,V.runs,V.numRleValues)})(S,M,k);case Zi.NONE:return k&&(function(B){for(let V=0;V<B.length;V++){const Z=B[V];B[V]=Z>>1n^-(1n&Z)}})(S),S;default:throw new Error(`The specified Logical level technique is not supported: ${M.logicalLevelTechnique1}`)}})(x2(p,l,h.numValues),h,v)}function BF(p,l,h,v){const S=x2(p,l,h.numValues);if(S.length===1){const M=S[0];return v?Jy(M):M}return v?(function(M){return Jy(M[1])})(S):(function(M){return M[1]})(S)}function FC(p,l,h,v,S){return(function(M,k,B,V){switch(k.logicalLevelTechnique1){case Zi.DELTA:return k.logicalLevelTechnique2===Zi.RLE&&(M=kF(M,k.runs,k.numRleValues)),(function(Z,ie){const ce=new Int32Array(Z.size());let _e=0;Z.get(0)?(ce[0]=Z.get(0)?ie[0]>>>1^-(1&ie[0]):0,_e=1):ce[0]=0;let Se=1;for(;Se!=ce.length;++Se)ce[Se]=Z.get(Se)?ce[Se-1]+(ie[_e]>>>1^-(1&ie[_e++])):ce[Se-1];return ce})(V,M);case Zi.RLE:return(function(Z,ie,ce,_e){const Se=ie;return ce?(function(Le,ze,Ve){const et=new Int32Array(Le.size());let Ct=0;for(let rt=0;rt<Ve;rt++){const ut=ze[rt];let kt=ze[rt+Ve];kt=kt>>>1^-(1&kt);for(let Ft=Ct;Ft<Ct+ut;Ft++)Le.get(Ft)?et[Ft]=kt:(et[Ft]=0,Ct++);Ct+=ut}return et})(_e,Z,Se.runs):(function(Le,ze,Ve){const et=new Int32Array(Le.size());let Ct=0;for(let rt=0;rt<Ve;rt++){const ut=ze[rt],kt=ze[rt+Ve];for(let Ft=Ct;Ft<Ct+ut;Ft++)Le.get(Ft)?et[Ft]=kt:(et[Ft]=0,Ct++);Ct+=ut}return et})(_e,Z,Se.runs)})(M,k,B,V);case Zi.MORTON:return OC(M),M;case Zi.COMPONENTWISE_DELTA:return OF(M),M;case Zi.NONE:return M=B?(function(Z,ie){const ce=new Int32Array(Z.size());let _e=0,Se=0;for(;Se!=ce.length;++Se)if(Z.get(Se)){const Le=ie[_e++];ce[Se]=Le>>>1^-(1&Le)}else ce[Se]=0;return ce})(V,M):(function(Z,ie){const ce=new Int32Array(Z.size());let _e=0,Se=0;for(;Se!=ce.length;++Se)ce[Se]=Z.get(Se)?ie[_e++]:0;return ce})(V,M),M;default:throw new Error("The specified Logical level technique is not supported")}})(h.physicalLevelTechnique===Hd.FAST_PFOR?MF():Dl(p,l,h.numValues),h,v,S)}function S2(p,l,h,v){const S=p.logicalLevelTechnique1;if(S===Zi.RLE)return p.runs===1?yl.CONST:yl.FLAT;const M=l instanceof uh?l.size():l;if(S===Zi.DELTA&&p.logicalLevelTechnique2===Zi.RLE){const k=p.runs,B=2;if(p.numRleValues!==M)return yl.FLAT;if(k===1)return yl.SEQUENCE;if(k===2){const V=v.get();let Z;if(p.physicalLevelTechnique===Hd.VARINT)Z=Dl(h,v,4);else{const ie=v.get();Z=new Int32Array(h.buffer,h.byteOffset+ie,4)}if(v.set(V),Z[2]===B&&Z[3]===B)return yl.SEQUENCE}}return p.numValues===1?yl.CONST:yl.FLAT}class zF extends b2{getValueFromBuffer(l){return this.dataBuffer[l]}}class jF extends IF{constructor(l,h,v,S){super(l,BigInt64Array.of(h),v,S)}getValueFromBuffer(l){return this.dataBuffer[0]+BigInt(l)*this.delta}}class Qy{_geometryOffsets;_partOffsets;_ringOffsets;constructor(l,h,v){this._geometryOffsets=l,this._partOffsets=h,this._ringOffsets=v}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function BC(p,l,h){return{x:UF(p,l)-h,y:UF(p>>1,l)-h}}function UF(p,l){let h=0;for(let v=0;v<l;v++)h|=(p&1<<2*v)>>v;return h}(function(p){p[p.POINT=0]="POINT",p[p.LINESTRING=1]="LINESTRING",p[p.POLYGON=2]="POLYGON",p[p.MULTIPOINT=3]="MULTIPOINT",p[p.MULTILINESTRING=4]="MULTILINESTRING",p[p.MULTIPOLYGON=5]="MULTIPOLYGON"})(vl||(vl={})),(function(p){p[p.POINT=0]="POINT",p[p.LINESTRING=1]="LINESTRING",p[p.POLYGON=2]="POLYGON"})(PF||(PF={})),(function(p){p[p.MORTON=0]="MORTON",p[p.VEC_2=1]="VEC_2",p[p.VEC_3=2]="VEC_3"})(Yc||(Yc={}));class qae{createPoint(l){return[[l]]}createMultiPoint(l){return l.map((h=>[h]))}createLineString(l){return[l]}createMultiLineString(l){return l}createPolygon(l,h){return[l].concat(h)}createMultiPolygon(l){return l.flat()}}function VF(p){const l=new Array(p.numGeometries);let h=1,v=1,S=1,M=0;const k=new qae;let B=0,V=0;const Z=p.mortonSettings,ie=p.topologyVector,ce=ie.geometryOffsets,_e=ie.partOffsets,Se=ie.ringOffsets,Le=p.vertexOffsets,ze=p.containsPolygonGeometry(),Ve=p.vertexBuffer;for(let et=0;et<p.numGeometries;et++){const Ct=p.geometryType(et);if(Ct===vl.POINT){if(Le&&Le.length!==0)if(p.vertexBufferType===Yc.VEC_2){const rt=2*Le[V++],ut=new c(Ve[rt],Ve[rt+1]);l[M++]=k.createPoint(ut)}else{const rt=BC(Ve[Le[V++]],Z.numBits,Z.coordinateShift),ut=new c(rt.x,rt.y);l[M++]=k.createPoint(ut)}else{const rt=new c(Ve[B++],Ve[B++]);l[M++]=k.createPoint(rt)}ce&&S++,_e&&h++,Se&&v++}else if(Ct===vl.MULTIPOINT){const rt=ce[S]-ce[S-1];S++;const ut=new Array(rt);if(Le&&Le.length!==0){for(let kt=0;kt<rt;kt++){const Ft=2*Le[V++];ut[kt]=new c(Ve[Ft],Ve[Ft+1])}l[M++]=k.createMultiPoint(ut)}else{for(let kt=0;kt<rt;kt++){const Ft=Ve[B++],hr=Ve[B++];ut[kt]=new c(Ft,hr)}l[M++]=k.createMultiPoint(ut)}}else if(Ct===vl.LINESTRING){let rt,ut=0;ze?(ut=Se[v]-Se[v-1],v++):ut=_e[h]-_e[h-1],h++,Le&&Le.length!==0?(rt=p.vertexBufferType===Yc.VEC_2?jC(Ve,Le,V,ut,!1):UC(Ve,Le,V,ut,!1,Z),V+=ut):(rt=zC(Ve,B,ut,!1),B+=2*ut),l[M++]=k.createLineString(rt),ce&&S++}else if(Ct===vl.POLYGON){const rt=_e[h]-_e[h-1];h++;const ut=new Array(rt-1);let kt=Se[v]-Se[v-1];if(v++,Le&&Le.length!==0){const Ft=p.vertexBufferType===Yc.VEC_2?T2(Ve,Le,V,kt):C2(Ve,Le,V,kt,0,Z);V+=kt;for(let hr=0;hr<ut.length;hr++)kt=Se[v]-Se[v-1],v++,ut[hr]=p.vertexBufferType===Yc.VEC_2?T2(Ve,Le,V,kt):C2(Ve,Le,V,kt,0,Z),V+=kt;l[M++]=k.createPolygon(Ft,ut)}else{const Ft=E2(Ve,B,kt);B+=2*kt;for(let hr=0;hr<ut.length;hr++)kt=Se[v]-Se[v-1],v++,ut[hr]=E2(Ve,B,kt),B+=2*kt;l[M++]=k.createPolygon(Ft,ut)}ce&&S++}else if(Ct===vl.MULTILINESTRING){const rt=ce[S]-ce[S-1];S++;const ut=new Array(rt);if(Le&&Le.length!==0){for(let kt=0;kt<rt;kt++){let Ft=0;ze?(Ft=Se[v]-Se[v-1],v++):Ft=_e[h]-_e[h-1],h++;const hr=p.vertexBufferType===Yc.VEC_2?jC(Ve,Le,V,Ft,!1):UC(Ve,Le,V,Ft,!1,Z);ut[kt]=hr,V+=Ft}l[M++]=k.createMultiLineString(ut)}else{for(let kt=0;kt<rt;kt++){let Ft=0;ze?(Ft=Se[v]-Se[v-1],v++):Ft=_e[h]-_e[h-1],h++,ut[kt]=zC(Ve,B,Ft,!1),B+=2*Ft}l[M++]=k.createMultiLineString(ut)}}else{if(Ct!==vl.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const rt=ce[S]-ce[S-1];S++;const ut=new Array(rt);let kt=0;if(Le&&Le.length!==0){for(let Ft=0;Ft<rt;Ft++){const hr=_e[h]-_e[h-1];h++;const Or=new Array(hr-1);kt=Se[v]-Se[v-1],v++;const Pr=p.vertexBufferType===Yc.VEC_2?T2(Ve,Le,V,kt):C2(Ve,Le,V,kt,0,Z);V+=kt;for(let Vr=0;Vr<Or.length;Vr++)kt=Se[v]-Se[v-1],v++,Or[Vr]=p.vertexBufferType===Yc.VEC_2?T2(Ve,Le,V,kt):C2(Ve,Le,V,kt,0,Z),V+=kt;ut[Ft]=k.createPolygon(Pr,Or)}l[M++]=k.createMultiPolygon(ut)}else{for(let Ft=0;Ft<rt;Ft++){const hr=_e[h]-_e[h-1];h++;const Or=new Array(hr-1);kt=Se[v]-Se[v-1],v++;const Pr=E2(Ve,B,kt);B+=2*kt;for(let Vr=0;Vr<Or.length;Vr++){const dn=Se[v]-Se[v-1];v++,Or[Vr]=E2(Ve,B,dn),B+=2*dn}ut[Ft]=k.createPolygon(Pr,Or)}l[M++]=k.createMultiPolygon(ut)}}}}return l}function E2(p,l,h){return zC(p,l,h,!0)}function T2(p,l,h,v){return jC(p,l,h,v,!0)}function C2(p,l,h,v,S,M){return UC(p,l,h,v,!0,M)}function zC(p,l,h,v){const S=new Array(v?h+1:h);for(let M=0;M<2*h;M+=2)S[M/2]=new c(p[l+M],p[l+M+1]);return v&&(S[S.length-1]=S[0]),S}function jC(p,l,h,v,S){const M=new Array(S?v+1:v);for(let k=0;k<2*v;k+=2){const B=2*l[h+k/2];M[k/2]=new c(p[B],p[B+1])}return S&&(M[M.length-1]=M[0]),M}function UC(p,l,h,v,S,M){const k=new Array(S?v+1:v);for(let B=0;B<v;B++){const V=BC(p[l[h+B]],M.numBits,M.coordinateShift);k[B]=new c(V.x,V.y)}return S&&(k[k.length-1]=k[0]),k}class $F{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(l,h,v,S,M){this._vertexBufferType=l,this._topologyVector=h,this._vertexOffsets=v,this._vertexBuffer=S,this._mortonSettings=M}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const l=VF(this);let h=0;for(;h<this.numGeometries;)yield{coordinates:l[h],type:this.geometryType(h)},h++}getSimpleEncodedVertex(l){const h=this.vertexOffsets?2*this.vertexOffsets[l]:2*l;return[this.vertexBuffer[h],this.vertexBuffer[h+1]]}getVertex(l){if(this.vertexOffsets&&this.mortonSettings){const v=BC(this.vertexBuffer[this.vertexOffsets[l]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[v.x,v.y]}const h=this.vertexOffsets?2*this.vertexOffsets[l]:2*l;return[this.vertexBuffer[h],this.vertexBuffer[h+1]]}getGeometries(){return VF(this)}get mortonSettings(){return this._mortonSettings}}class qF extends $F{_numGeometries;_geometryType;constructor(l,h,v,S,M,k,B){super(v,S,M,k,B),this._numGeometries=l,this._geometryType=h}geometryType(l){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===vl.POLYGON||this._geometryType===vl.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class HF extends $F{_geometryTypes;constructor(l,h,v,S,M,k){super(l,v,S,M,k),this._geometryTypes=h}geometryType(l){return this._geometryTypes[l]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let l=0;l<this.numGeometries;l++)if(this.geometryType(l)===vl.POLYGON||this.geometryType(l)===vl.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class GF{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(l,h,v,S){this._triangleOffsets=l,this._indexBuffer=h,this._vertexBuffer=v,this._topologyVector=S}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const l=new Array(this.numGeometries),h=this._topologyVector,v=h.partOffsets,S=h.ringOffsets,M=h.geometryOffsets;let k=0,B=1,V=1,Z=1;for(let ie=0;ie<this.numGeometries;ie++)switch(this.geometryType(ie)){case vl.POLYGON:{const ce=v[B]-v[B-1];B++;const _e=[];for(let Se=0;Se<ce;Se++){const Le=S[V]-S[V-1];V++;const ze=[];for(let Ve=0;Ve<Le;Ve++){const et=this._vertexBuffer[k++],Ct=this._vertexBuffer[k++];ze.push(new c(et,Ct))}ze.length>0&&ze.push(ze[0]),_e.push(ze)}l[ie]=_e,M&&Z++}break;case vl.MULTIPOLYGON:{const ce=M[Z]-M[Z-1];Z++;const _e=[];for(let Se=0;Se<ce;Se++){const Le=v[B]-v[B-1];B++;for(let ze=0;ze<Le;ze++){const Ve=S[V]-S[V-1];V++;const et=[];for(let Ct=0;Ct<Ve;Ct++){const rt=this._vertexBuffer[k++],ut=this._vertexBuffer[k++];et.push(new c(rt,ut))}et.length>0&&et.push(et[0]),_e.push(et)}}l[ie]=_e}}return l}[Symbol.iterator](){return null}}function WF(p,l,h,v,S,M){return new Hae(p,l,h,v,S,M)}class Hae extends GF{_numGeometries;_geometryType;constructor(l,h,v,S,M,k){super(v,S,M,k),this._numGeometries=l,this._geometryType=h}geometryType(l){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function XF(p,l,h,v,S){return new Gae(p,l,h,v,S)}class Gae extends GF{_geometryTypes;constructor(l,h,v,S,M){super(h,v,S,M),this._geometryTypes=l}geometryType(l){return this._geometryTypes[l]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function Wae(p,l,h,v,S){const M=ju(p,h);let k=null,B=null,V=null,Z=null,ie=null,ce=null,_e=null,Se=null;if(S2(M,v,p,h)===yl.CONST){const ze=NC(p,h,M,!1);for(let Ve=0;Ve<l-1;Ve++){const et=ju(p,h);switch(et.physicalStreamType){case Kl.LENGTH:switch(et.logicalStreamType.lengthType){case Ec.GEOMETRIES:k=Hp(p,h,et);break;case Ec.PARTS:B=Hp(p,h,et);break;case Ec.RINGS:V=Hp(p,h,et);break;case Ec.TRIANGLES:_e=Hp(p,h,et)}break;case Kl.OFFSET:switch(et.logicalStreamType.offsetType){case im.VERTEX:Z=Uu(p,h,et,!1);break;case im.INDEX:Se=Uu(p,h,et,!1)}break;case Kl.DATA:lh.VERTEX===et.logicalStreamType.dictionaryType?ie=Uu(p,h,et,!0):(ce={numBits:et.numBits,coordinateShift:et.coordinateShift},ie=Uu(p,h,et,!1))}}return Se!==null?k!=null||B!=null?WF(v,ze,_e,Se,ie,new Qy(k,B,V)):WF(v,ze,_e,Se,ie):ce===null?(function(Ve,et,Ct,rt,ut){return new qF(Ve,et,Yc.VEC_2,Ct,rt,ut)})(v,ze,new Qy(k,B,V),Z,ie):(function(Ve,et,Ct,rt,ut,kt){return new qF(Ve,et,Yc.MORTON,Ct,rt,ut,kt)})(v,ze,new Qy(k,B,V),Z,ie,ce)}const Le=Uu(p,h,M,!1);for(let ze=0;ze<l-1;ze++){const Ve=ju(p,h);switch(Ve.physicalStreamType){case Kl.LENGTH:switch(Ve.logicalStreamType.lengthType){case Ec.GEOMETRIES:k=Uu(p,h,Ve,!1);break;case Ec.PARTS:B=Uu(p,h,Ve,!1);break;case Ec.RINGS:V=Uu(p,h,Ve,!1);break;case Ec.TRIANGLES:_e=Hp(p,h,Ve)}break;case Kl.OFFSET:switch(Ve.logicalStreamType.offsetType){case im.VERTEX:Z=Uu(p,h,Ve,!1);break;case im.INDEX:Se=Uu(p,h,Ve,!1)}break;case Kl.DATA:lh.VERTEX===Ve.logicalStreamType.dictionaryType?ie=Uu(p,h,Ve,!0):(ce={numBits:Ve.numBits,coordinateShift:Ve.coordinateShift},ie=Uu(p,h,Ve,!1))}}return Se!==null&&B===null?XF(Le,_e,Se,ie):(k!==null?(k=VC(Le,k,2),B!==null&&V!==null?(B=YF(Le,k,B,!1),V=(function(ze,Ve,et,Ct){const rt=new Int32Array(et[et.length-1]+1);let ut=0;rt[0]=ut;let kt=1,Ft=1,hr=0;for(let Or=0;Or<ze.length;Or++){const Pr=ze[Or],Vr=Ve[Or+1]-Ve[Or];if(Pr!==0&&Pr!==3)for(let dn=0;dn<Vr;dn++){const Wr=et[kt]-et[kt-1];kt++;for(let kr=0;kr<Wr;kr++)ut=rt[Ft++]=ut+Ct[hr++]}else for(let dn=0;dn<Vr;dn++)rt[Ft++]=++ut,kt++}return rt})(Le,k,B,V)):B!==null&&(B=(function(ze,Ve,et){const Ct=new Int32Array(Ve[Ve.length-1]+1);let rt=0;Ct[0]=rt;let ut=1,kt=0;for(let Ft=0;Ft<ze.length;Ft++){const hr=ze[Ft],Or=Ve[Ft+1]-Ve[Ft];if(hr===4||hr===1)for(let Pr=0;Pr<Or;Pr++)rt=Ct[ut++]=rt+et[kt++];else for(let Pr=0;Pr<Or;Pr++)Ct[ut++]=++rt}return Ct})(Le,k,B))):B!==null&&V!==null?(B=VC(Le,B,1),V=YF(Le,B,V,!0)):B!==null&&(B=VC(Le,B,0)),Se!==null?XF(Le,_e,Se,ie,new Qy(k,B,V)):ce===null?(function(ze,Ve,et,Ct){return new HF(Yc.VEC_2,ze,Ve,et,Ct)})(Le,new Qy(k,B,V),Z,ie):(function(ze,Ve,et,Ct,rt){return new HF(Yc.MORTON,ze,Ve,et,Ct,rt)})(Le,new Qy(k,B,V),Z,ie,ce))}function VC(p,l,h){const v=new Int32Array(p.length+1);let S=0;v[0]=S;let M=0;for(let k=0;k<p.length;k++)S=v[k+1]=S+(p[k]>h?l[M++]:1);return v}function YF(p,l,h,v){const S=new Int32Array(l[l.length-1]+1);let M=0;S[0]=M;let k=1,B=0;for(let V=0;V<p.length;V++){const Z=p[V],ie=l[V+1]-l[V];if(Z===5||Z===2||v&&(Z===4||Z===1))for(let ce=0;ce<ie;ce++)M=S[k++]=M+h[B++];else for(let ce=0;ce<ie;ce++)S[k++]=++M}return S}class Xae extends Ky{dataVector;constructor(l,h,v){super(l,h.getBuffer(),v),this.dataVector=h}getValueFromBuffer(l){return this.dataVector.get(l)}}class Yae extends b2{getValueFromBuffer(l){return this.dataBuffer[l]}}class ZF extends Ky{constructor(l,h,v){super(l,BigInt64Array.of(h),v)}getValueFromBuffer(l){return this.dataBuffer[0]}}function H_(p,l,h){return KF(p,Math.ceil(l/8),h)}function KF(p,l,h){const v=new Uint8Array(l);let S=0;for(;S<l;){const M=p[h.increment()];if(M<=127){const k=M+3,B=p[h.increment()],V=S+k;v.fill(B,S,V),S=V}else{const k=256-M;for(let B=0;B<k;B++)v[S++]=p[h.increment()]}}return v}const Zae=new TextDecoder;function $C(p,l,h){return h-l>=12?Zae.decode(p.subarray(l,h)):(function(v,S,M){let k="",B=S;for(;B<M;){const V=v[B];let Z,ie,ce,_e=null,Se=V>239?4:V>223?3:V>191?2:1;if(B+Se>M)break;Se===1?V<128&&(_e=V):Se===2?(Z=v[B+1],(192&Z)==128&&(_e=(31&V)<<6|63&Z,_e<=127&&(_e=null))):Se===3?(Z=v[B+1],ie=v[B+2],(192&Z)==128&&(192&ie)==128&&(_e=(15&V)<<12|(63&Z)<<6|63&ie,(_e<=2047||_e>=55296&&_e<=57343)&&(_e=null))):Se===4&&(Z=v[B+1],ie=v[B+2],ce=v[B+3],(192&Z)==128&&(192&ie)==128&&(192&ce)==128&&(_e=(15&V)<<18|(63&Z)<<12|(63&ie)<<6|63&ce,(_e<=65535||_e>=1114112)&&(_e=null))),_e===null?(_e=65533,Se=1):_e>65535&&(_e-=65536,k+=String.fromCharCode(_e>>>10&1023|55296),_e=56320|1023&_e),k+=String.fromCharCode(_e),B+=Se}return k})(p,l,h)}class qC extends Ky{offsetBuffer;constructor(l,h,v,S){super(l,v,S),this.offsetBuffer=h}}class JF extends qC{textEncoder;constructor(l,h,v,S){super(l,h,v,S??h.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(l){return $C(this.dataBuffer,this.offsetBuffer[l],this.offsetBuffer[l+1])}}class ev extends qC{indexBuffer;textEncoder;constructor(l,h,v,S,M){super(l,v,S,M??h.length),this.indexBuffer=h,this.indexBuffer=h,this.textEncoder=new TextEncoder}getValueFromBuffer(l){const h=this.indexBuffer[l];return $C(this.dataBuffer,this.offsetBuffer[h],this.offsetBuffer[h+1])}}class QF extends qC{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(l,h,v,S,M,k,B){super(l,v,S,B),this.indexBuffer=h,this.symbolOffsetBuffer=M,this.symbolTableBuffer=k,this.textEncoder=new TextEncoder}getValueFromBuffer(l){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(v,S,M){const k=[],B=new Array(S.length).fill(0);for(let V=1;V<S.length;V++)B[V]=B[V-1]+S[V-1];for(let V=0;V<M.length;V++)if(M[V]===255)k.push(M[++V]);else{const Z=S[M[V]],ie=B[M[V]];for(let ce=0;ce<Z;ce++)k.push(v[ie+ce])}return new Uint8Array(k)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const h=this.indexBuffer[l];return $C(this.decodedDictionary,this.offsetBuffer[h],this.offsetBuffer[h+1])}offsetToLengthBuffer(l){const h=new Uint32Array(l.length-1);let v=l[0];for(let S=1;S<l.length;S++){const M=l[S];h[S-1]=M-v,v=M}return h}}function Kae(p,l,h,v,S,M){return h.type==="scalarType"?(function(k,B,V,Z,ie,ce){let _e=null,Se=0;if(k===0)return null;if(ce.nullable){const ze=ju(B,V);Se=ze.numValues;const Ve=V.get(),et=H_(B,Se,V);V.set(Ve+ze.byteLength),_e=new uh(et,ze.numValues)}const Le=_e??Z;switch(ie.physicalType){case 4:case 3:return(function(ze,Ve,et,Ct,rt){const ut=ju(ze,Ve),kt=S2(ut,rt,ze,Ve),Ft=Ct.physicalType===3;if(kt===yl.FLAT){const hr=G_(rt)?FC(ze,Ve,ut,Ft,rt):Uu(ze,Ve,ut,Ft);return new MC(et.name,hr,rt)}if(kt===yl.SEQUENCE){const hr=LF(ze,Ve,ut);return new RC(et.name,hr[0],hr[1],ut.numRleValues)}{const hr=NC(ze,Ve,ut,Ft);return new DC(et.name,hr,rt)}})(B,V,ce,ie,Le);case 9:return(function(ze,Ve,et,Ct,rt){let ut=null,kt=null,Ft=null,hr=null,Or=null,Pr=null,Vr=null,dn=null;for(let Wr=0;Wr<Ct;Wr++){const kr=ju(Ve,et);if(kr.byteLength!==0)switch(kr.physicalStreamType){case Kl.PRESENT:{const Er=H_(Ve,kr.numValues,et);Pr=new uh(Er,kr.numValues);break}case Kl.OFFSET:kt=rt!=null||Pr!=null?FC(Ve,et,kr,!1,rt??Pr):Uu(Ve,et,kr,!1);break;case Kl.LENGTH:{const Er=Hp(Ve,et,kr);Ec.DICTIONARY===kr.logicalStreamType.lengthType?ut=Er:Ec.SYMBOL===kr.logicalStreamType.lengthType?hr=Er:Vr=Er;break}case Kl.DATA:{const Er=Ve.subarray(et.get(),et.get()+kr.byteLength);et.add(kr.byteLength);const Cn=kr.logicalStreamType.dictionaryType;lh.FSST===Cn?Or=Er:lh.SINGLE===Cn||lh.SHARED===Cn?Ft=Er:lh.NONE===Cn&&(dn=Er);break}}}return(function(Wr,kr,Er,Cn,xn,Mn,vn){return kr?new QF(Wr,Er,Cn,xn,Mn,kr,vn):null})(ze,Or,kt,ut,Ft,hr,rt??Pr)??(function(Wr,kr,Er,Cn,xn){return kr?xn?new ev(Wr,Er,Cn,kr,xn):new ev(Wr,Er,Cn,kr):null})(ze,Ft,kt,ut,rt??Pr)??(function(Wr,kr,Er,Cn,xn){if(!kr||!Er)return null;if(Cn)return xn?new ev(Wr,Cn,kr,Er,xn):new ev(Wr,Cn,kr,Er);if(xn&&xn.size()!==kr.length-1){const Mn=new Int32Array(xn.size());let vn=0;for(let Gn=0;Gn<xn.size();Gn++)Mn[Gn]=xn.get(Gn)?vn++:0;return new ev(Wr,Mn,kr,Er,xn)}return xn?new JF(Wr,kr,Er,xn):new JF(Wr,kr,Er)})(ze,Vr,dn,kt,rt??Pr)})(ce.name,B,V,ce.nullable?k-1:k,_e);case 0:return(function(ze,Ve,et,Ct,rt){const ut=ju(ze,Ve),kt=ut.numValues,Ft=Ve.get(),hr=G_(rt)?(function(Pr,Vr,dn,Wr){const kr=KF(Pr,Math.ceil(Vr/8),dn),Er=new uh(kr,Vr),Cn=Wr.size(),xn=new uh(new Uint8Array(Cn),Cn);let Mn=0;for(let vn=0;vn<Wr.size();vn++){const Gn=!!Wr.get(vn)&&Er.get(Mn++);xn.set(vn,Gn)}return xn.getBuffer()})(ze,kt,Ve,rt):H_(ze,kt,Ve);Ve.set(Ft+ut.byteLength);const Or=new uh(hr,kt);return new Xae(et.name,Or,rt)})(B,V,ce,0,Le);case 6:case 5:return(function(ze,Ve,et,Ct,rt){const ut=ju(ze,Ve),kt=S2(ut,Ct,ze,Ve),Ft=rt.physicalType===5;if(kt===yl.FLAT){const hr=G_(Ct)?(function(Or,Pr,Vr,dn,Wr){return(function(kr,Er,Cn,xn){switch(Er.logicalLevelTechnique1){case Zi.DELTA:return Er.logicalLevelTechnique2===Zi.RLE&&(kr=RF(kr,Er.runs,Er.numRleValues)),(function(Mn,vn){const Gn=new BigInt64Array(Mn.size());let la=0;Mn.get(0)?(Gn[0]=Mn.get(0)?vn[0]>>1n^-(1n&vn[0]):0n,la=1):Gn[0]=0n;let Hi=1;for(;Hi!=Gn.length;++Hi)Gn[Hi]=Mn.get(Hi)?Gn[Hi-1]+(vn[la]>>1n^-(1n&vn[la++])):Gn[Hi-1];return Gn})(xn,kr);case Zi.RLE:return(function(Mn,vn,Gn,la){const Hi=vn;return Gn?(function(Mo,Ql,Ds){const ko=new BigInt64Array(Mo.size());let vo=0;for(let Ta=0;Ta<Ds;Ta++){const Yo=Number(Ql[Ta]);let ss=Ql[Ta+Ds];ss=ss>>1n^-(1n&ss);for(let co=vo;co<vo+Yo;co++)Mo.get(co)?ko[co]=ss:(ko[co]=0n,vo++);vo+=Yo}return ko})(la,Mn,Hi.runs):(function(Mo,Ql,Ds){const ko=new BigInt64Array(Mo.size());let vo=0;for(let Ta=0;Ta<Ds;Ta++){const Yo=Number(Ql[Ta]),ss=Ql[Ta+Ds];for(let co=vo;co<vo+Yo;co++)Mo.get(co)?ko[co]=ss:(ko[co]=0n,vo++);vo+=Yo}return ko})(la,Mn,Hi.runs)})(kr,Er,Cn,xn);case Zi.NONE:return kr=Cn?(function(Mn,vn){const Gn=new BigInt64Array(Mn.size());let la=0,Hi=0;for(;Hi!=Gn.length;++Hi)if(Mn.get(Hi)){const Mo=vn[la++];Gn[Hi]=Mo>>1n^-(1n&Mo)}else Gn[Hi]=0n;return Gn})(xn,kr):(function(Mn,vn){const Gn=new BigInt64Array(Mn.size());let la=0,Hi=0;for(;Hi!=Gn.length;++Hi)Gn[Hi]=Mn.get(Hi)?vn[la++]:0n;return Gn})(xn,kr),kr;default:throw new Error("The specified Logical level technique is not supported")}})(x2(Or,Pr,Vr.numValues),Vr,dn,Wr)})(ze,Ve,ut,Ft,Ct):FF(ze,Ve,ut,Ft);return new zF(et.name,hr,Ct)}if(kt===yl.SEQUENCE){const hr=NF(ze,Ve,ut);return new jF(et.name,hr[0],hr[1],ut.numRleValues)}{const hr=BF(ze,Ve,ut,Ft);return new ZF(et.name,hr,Ct)}})(B,V,ce,Le,ie);case 7:return(function(ze,Ve,et,Ct){const rt=ju(ze,Ve),ut=G_(Ct)?(function(kt,Ft,hr,Or){const Pr=Ft.get(),Vr=Pr+Or*Float32Array.BYTES_PER_ELEMENT,dn=new Uint8Array(kt.subarray(Pr,Vr)).buffer,Wr=new Float32Array(dn);Ft.set(Vr);const kr=hr.size(),Er=new Float32Array(kr);let Cn=0;for(let xn=0;xn<kr;xn++)Er[xn]=hr.get(xn)?Wr[Cn++]:0;return Er})(ze,Ve,Ct,rt.numValues):(function(kt,Ft,hr){const Or=Ft.get(),Pr=Or+hr*Float32Array.BYTES_PER_ELEMENT,Vr=new Uint8Array(kt.subarray(Or,Pr)).buffer,dn=new Float32Array(Vr);return Ft.set(Pr),dn})(ze,Ve,rt.numValues);return new Yae(et.name,ut,Ct)})(B,V,ce,Le);case 8:return(function(ze,Ve,et,Ct){const rt=ju(ze,Ve),ut=G_(Ct)?(function(kt,Ft,hr,Or){const Pr=Ft.get(),Vr=Pr+Or*Float64Array.BYTES_PER_ELEMENT,dn=new Uint8Array(kt.subarray(Pr,Vr)).buffer,Wr=new Float64Array(dn);Ft.set(Vr);const kr=hr.size(),Er=new Float64Array(kr);let Cn=0;for(let xn=0;xn<kr;xn++)Er[xn]=hr.get(xn)?Wr[Cn++]:0;return Er})(ze,Ve,Ct,rt.numValues):(function(kt,Ft,hr){const Or=Ft.get(),Pr=Or+hr*Float64Array.BYTES_PER_ELEMENT,Vr=new Uint8Array(kt.subarray(Or,Pr)).buffer,dn=new Float64Array(Vr);return Ft.set(Pr),dn})(ze,Ve,rt.numValues);return new kC(et.name,ut,Ct)})(B,V,ce,Le);default:throw new Error(`The specified data type for the field is currently not supported: ${ie}`)}})(v,p,l,S,h.scalarType,h):v!=1?null:(function(k,B,V,Z){let ie=null,ce=null,_e=null,Se=null,Le=!1;for(;!Le;){const Ct=ju(k,B);switch(Ct.physicalStreamType){case Kl.LENGTH:Ec.DICTIONARY===Ct.logicalStreamType.lengthType?ie=Hp(k,B,Ct):_e=Hp(k,B,Ct);break;case Kl.DATA:lh.SINGLE===Ct.logicalStreamType.dictionaryType||lh.SHARED===Ct.logicalStreamType.dictionaryType?(ce=k.subarray(B.get(),B.get()+Ct.byteLength),Le=!0):Se=k.subarray(B.get(),B.get()+Ct.byteLength),B.add(Ct.byteLength)}}const ze=V.complexType.children,Ve=[];let et=0;for(const Ct of ze){const rt=Dl(k,B,1)[0];if(rt==0)continue;const ut=`${V.name}${Ct.name==="default"?"":":"+Ct.name}`;if(rt!==2||Ct.type!=="scalarField"||Ct.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const kt=ju(k,B),Ft=H_(k,kt.numValues,B),hr=ju(k,B),Or=hr.decompressedCount!==Z?FC(k,B,hr,!1,new uh(Ft,kt.numValues)):Uu(k,B,hr,!1);Ve[et++]=Se?new QF(ut,Or,ie,ce,_e,Se,new uh(Ft,kt.numValues)):new ev(ut,Or,ie,ce,new uh(Ft,kt.numValues))}return Ve})(p,l,h,S)}function G_(p){return p instanceof uh}function Jae(p){if(p.name==="id")return!1;if(p.type==="scalarType"){const l=p.scalarType;if(l.type==="physicalType")switch(l.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(l.type==="logicalType")return!1}else if(p.type==="complexType"){const l=p.complexType;if(l.type==="physicalType")switch(l.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",p),!1}const Qae=new TextDecoder;function eB(p,l){const h=Dl(p,l,1)[0];if(h===0)return"";const v=l.get(),S=p.subarray(v,v+h);return l.add(h),Qae.decode(S)}function tB(p,l){const h=Dl(p,l,1)[0]>>>0,v=!!(4&h),S=!!(2&h),M=Dl(p,l,1)[0]>>>0,k={};if(1&h&&(k.nullable=!0),S){const B={};if(v?(B.type="logicalType",B.logicalType=M):(B.type="physicalType",B.physicalType=M),8&h){const V=Dl(p,l,1)[0]>>>0;B.children=new Array(V);for(let Z=0;Z<V;Z++)B.children[Z]=tB(p,l)}k.type="complexField",k.complexField=B}else{const B={};v?(B.type="logicalType",B.logicalType=M):(B.type="physicalType",B.physicalType=M),k.type="scalarField",k.scalarField=B}return k}function eoe(p,l){const h=Dl(p,l,1)[0]>>>0,v=(function(S){switch(S){case 0:case 1:case 2:case 3:{const M={};M.nullable=!!(1&S),M.columnScope=0;const k={};return k.physicalType=S>1?6:4,k.type="physicalType",M.scalarType=k,M.type="scalarType",M}case 4:{const M={nullable:!1,columnScope:0},k={type:"physicalType",physicalType:0};return M.type="complexType",M.complexType=k,M}case 30:{const M={nullable:!1,columnScope:0},k={type:"physicalType",physicalType:1};return M.type="complexType",M.complexType=k,M}default:return(function(M){let k=null;switch(M){case 10:case 11:k=0;break;case 12:case 13:k=1;break;case 14:case 15:k=2;break;case 16:case 17:k=3;break;case 18:case 19:k=4;break;case 20:case 21:k=5;break;case 22:case 23:k=6;break;case 24:case 25:k=7;break;case 26:case 27:k=8;break;case 28:case 29:k=9;break;default:return null}const B={};B.nullable=!!(1&M),B.columnScope=0;const V={type:"physicalType"};return V.physicalType=k,B.type="scalarType",B.scalarType=V,B})(S)}})(h);if(!v)throw new Error(`Unsupported column type code: ${h}`);if((function(S){return S>=10})(h)?v.name=eB(p,l):h>=0&&h<=3?v.name="id":h===4&&(v.name="geometry"),(function(S){return S===30})(h)){const S=Dl(p,l,1)[0]>>>0,M=v.complexType;M.children=new Array(S);for(let k=0;k<S;k++)M.children[k]=tB(p,l)}return v}function toe(p,l){const h={featureTables:[]},v={};v.name=eB(p,l);const S=Dl(p,l,1)[0]>>>0,M=Dl(p,l,1)[0]>>>0;v.columns=new Array(M);for(let k=0;k<M;k++)v.columns[k]=eoe(p,l);return h.featureTables.push(v),[h,S]}function roe(p,l,h,v,S,M,k=!1){const B=l.scalarType.physicalType,V=S2(S,M,p,h);if(B===4)switch(V){case yl.FLAT:{const Z=Uu(p,h,S,!1);return new MC(v,Z,M)}case yl.SEQUENCE:{const Z=LF(p,h,S);return new RC(v,Z[0],Z[1],S.numRleValues)}case yl.CONST:{const Z=NC(p,h,S,!1);return new DC(v,Z,M)}}else switch(V){case yl.FLAT:{if(k){const ie=(function(ce,_e,Se,Le){const ze=(function(Ve,et,Ct){const rt=new Float64Array(et);for(let ut=0;ut<et;ut++)rt[ut]=Vae(Ve,Ct);return rt})(ce,Se.numValues,_e);return(function(Ve,et,Ct){switch(et.logicalLevelTechnique1){case Zi.DELTA:return et.logicalLevelTechnique2===Zi.RLE&&(Ve=DF(Ve,et.runs,et.numRleValues)),(function(rt){rt[0]=rt[0]%2==1?(rt[0]+1)/-2:rt[0]/2;const ut=rt.length/4*4;let kt=1;if(ut>=4)for(;kt<ut-4;kt+=4){const Ft=rt[kt],hr=rt[kt+1],Or=rt[kt+2],Pr=rt[kt+3];rt[kt]=(Ft%2==1?(Ft+1)/-2:Ft/2)+rt[kt-1],rt[kt+1]=(hr%2==1?(hr+1)/-2:hr/2)+rt[kt],rt[kt+2]=(Or%2==1?(Or+1)/-2:Or/2)+rt[kt+1],rt[kt+3]=(Pr%2==1?(Pr+1)/-2:Pr/2)+rt[kt+2]}for(;kt!=rt.length;++kt)rt[kt]=(rt[kt]%2==1?(rt[kt]+1)/-2:rt[kt]/2)+rt[kt-1]})(Ve),Ve;case Zi.RLE:return(function(rt,ut,kt){return DF(rt,ut.runs,ut.numRleValues)})(Ve,et);case Zi.NONE:return Ve;default:throw new Error(`The specified Logical level technique is not supported: ${et.logicalLevelTechnique1}`)}})(ze,Se)})(p,h,S);return new kC(v,ie,M)}const Z=FF(p,h,S,!1);return new zF(v,Z,M)}case yl.SEQUENCE:{const Z=NF(p,h,S);return new jF(v,Z[0],Z[1],S.numRleValues)}case yl.CONST:{const Z=BF(p,h,S,!1);return new ZF(v,Z,M)}}throw new Error("Vector type not supported for id column.")}class noe{constructor(l,h){var v;switch(this._featureData=l,this.properties=this._featureData.properties||{},(v=this._featureData.geometry)===null||v===void 0?void 0:v.type){case vl.POINT:case vl.MULTIPOINT:this.type=1;break;case vl.LINESTRING:case vl.MULTILINESTRING:this.type=2;break;case vl.POLYGON:case vl.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=h,this.id=Number(this._featureData.id)}loadGeometry(){const l=[];for(const h of this._featureData.geometry.coordinates){const v=[];for(const S of h)v.push(new c(S.x,S.y));l.push(v)}return l}}class ioe{constructor(l){this.features=[],this.featureTable=l,this.name=l.name,this.extent=l.extent,this.version=2,this.features=l.getFeatures(),this.length=this.features.length}feature(l){return new noe(this.features[l],this.extent)}}class rB{constructor(l){this.layers={};const h=(function(v,S,M=!0){const k=new Uae(0),B=[];for(;k.get()<v.length;){const V=Dl(v,k,1)[0]>>>0,Z=k.get()+V;if(Z>v.length)throw new Error(`Block overruns tile: ${Z} > ${v.length}`);if(Dl(v,k,1)[0]>>>0!=1){k.set(Z);continue}const ie=toe(v,k),ce=ie[1],_e=ie[0].featureTables[0];let Se=null,Le=null;const ze=[];let Ve=0;for(const Ct of _e.columns){const rt=Ct.name;if(rt==="id"){let ut=null;if(Ct.nullable){const Ft=ju(v,k),hr=k.get(),Or=H_(v,Ft.numValues,k);k.set(hr+Ft.byteLength),ut=new uh(Or,Ft.numValues)}const kt=ju(v,k);Ve=kt.decompressedCount,Se=roe(v,Ct,k,rt,kt,ut??Ve,M)}else if(rt==="geometry"){const ut=Dl(v,k,1)[0];if(Ve===0){const kt=k.get();Ve=ju(v,k).decompressedCount,k.set(kt)}Le=Wae(v,ut,k,Ve)}else{const ut=Jae(Ct)?Dl(v,k,1)[0]:1;if(ut===0&&Ct.type==="scalarType")continue;const kt=Kae(v,k,Ct,ut,Ve);if(kt)if(Array.isArray(kt))for(const Ft of kt)ze.push(Ft);else ze.push(kt)}}const et=new jae(_e.name,Le,Se,ze,ce);B.push(et),k.set(Z)}return B})(new Uint8Array(l));this.layers=h.reduce(((v,S)=>Object.assign(Object.assign({},v),{[S.name]:new ioe(S)})),{})}}class aoe{constructor(l,h){this.feature=l,this.type=l.type,this.properties=l.tags?l.tags:{},this.extent=h,"id"in l&&(typeof l.id=="string"?this.id=parseInt(l.id,10):typeof l.id!="number"||isNaN(l.id)||(this.id=l.id))}loadGeometry(){const l=[],h=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const v of h){const S=[];for(const M of v)S.push(new c(M[0],M[1]));l.push(S)}return l}}const W_="_geojsonTileLayer";function ooe(p,l){l.writeVarintField(15,p.version||1),l.writeStringField(1,p.name||""),l.writeVarintField(5,p.extent||4096);const h={keys:[],values:[],keycache:{},valuecache:{}};for(let M=0;M<p.length;M++)h.feature=p.feature(M),l.writeMessage(2,soe,h);const v=h.keys;for(const M of v)l.writeStringField(3,M);const S=h.values;for(const M of S)l.writeMessage(4,coe,M)}function soe(p,l){if(!p.feature)return;const h=p.feature;h.id!==void 0&&l.writeVarintField(1,h.id),l.writeMessage(2,loe,p),l.writeVarintField(3,h.type),l.writeMessage(4,uoe,h)}function loe(p,l){for(const h in p.feature?.properties){let v=p.feature.properties[h],S=p.keycache[h];if(v==null)continue;S===void 0&&(p.keys.push(h),S=p.keys.length-1,p.keycache[h]=S),l.writeVarint(S),typeof v!="string"&&typeof v!="boolean"&&typeof v!="number"&&(v=JSON.stringify(v));const M=typeof v+":"+v;let k=p.valuecache[M];k===void 0&&(p.values.push(v),k=p.values.length-1,p.valuecache[M]=k),l.writeVarint(k)}}function HC(p,l){return(l<<3)+(7&p)}function nB(p){return p<<1^p>>31}function uoe(p,l){const h=p.loadGeometry(),v=p.type;let S=0,M=0;for(const k of h){let B=1;v===1&&(B=k.length),l.writeVarint(HC(1,B));const V=v===3?k.length-1:k.length;for(let Z=0;Z<V;Z++){Z===1&&v!==1&&l.writeVarint(HC(2,V-1));const ie=k[Z].x-S,ce=k[Z].y-M;l.writeVarint(nB(ie)),l.writeVarint(nB(ce)),S+=ie,M+=ce}p.type===3&&l.writeVarint(HC(7,1))}}function coe(p,l){const h=typeof p;h==="string"?l.writeStringField(1,p):h==="boolean"?l.writeBooleanField(7,p):h==="number"&&(p%1!=0?l.writeDoubleField(3,p):p<0?l.writeSVarintField(6,p):l.writeVarintField(5,p))}class iB{constructor(l,h){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new _r(we,16,0),this.grid3D=new _r(we,16,0),this.featureIndexArray=new Ze,this.promoteId=h}insert(l,h,v,S,M,k){const B=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(v,S,M);const V=k?this.grid3D:this.grid;for(let Z=0;Z<h.length;Z++){const ie=h[Z],ce=[1/0,1/0,-1/0,-1/0];for(let _e=0;_e<ie.length;_e++){const Se=ie[_e];ce[0]=Math.min(ce[0],Se.x),ce[1]=Math.min(ce[1],Se.y),ce[2]=Math.max(ce[2],Se.x),ce[3]=Math.max(ce[3],Se.y)}ce[0]<we&&ce[1]<we&&ce[2]>=0&&ce[3]>=0&&V.insert(B,ce[0],ce[1],ce[2],ce[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new $6(new g2(this.rawTileData)).layers:new rB(this.rawTileData).layers,this.sourceLayerCoder=new CF(this.vtLayers?Object.keys(this.vtLayers).sort():[W_])),this.vtLayers}query(l,h,v,S){this.loadVTLayers();const M=l.params,k=we/l.tileSize/l.scale,B=nh(M.filter,M.globalState),V=l.queryGeometry,Z=l.queryPadding*k,ie=nm.fromPoints(V),ce=this.grid.query(ie.minX-Z,ie.minY-Z,ie.maxX+Z,ie.maxY+Z),_e=nm.fromPoints(l.cameraQueryGeometry).expandBy(Z),Se=this.grid3D.query(_e.minX,_e.minY,_e.maxX,_e.maxY,((Ve,et,Ct,rt)=>(function(ut,kt,Ft,hr,Or){for(const Vr of ut)if(kt<=Vr.x&&Ft<=Vr.y&&hr>=Vr.x&&Or>=Vr.y)return!0;const Pr=[new c(kt,Ft),new c(kt,Or),new c(hr,Or),new c(hr,Ft)];if(ut.length>2){for(const Vr of Pr)if(Vy(ut,Vr))return!0}for(let Vr=0;Vr<ut.length-1;Vr++)if(hie(ut[Vr],ut[Vr+1],Pr))return!0;return!1})(l.cameraQueryGeometry,Ve-Z,et-Z,Ct+Z,rt+Z)));for(const Ve of Se)ce.push(Ve);ce.sort(foe);const Le={};let ze;for(let Ve=0;Ve<ce.length;Ve++){const et=ce[Ve];if(et===ze)continue;ze=et;const Ct=this.featureIndexArray.get(et);let rt=null;this.loadMatchingFeature(Le,Ct.bucketIndex,Ct.sourceLayerIndex,Ct.featureIndex,B,M.layers,M.availableImages,h,v,S,((ut,kt,Ft)=>(rt||(rt=Zh(ut)),kt.queryIntersectsFeature({queryGeometry:V,feature:ut,featureState:Ft,geometry:rt,zoom:this.z,transform:l.transform,pixelsToTileUnits:k,pixelPosMatrix:l.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:l.getElevation}))))}return Le}loadMatchingFeature(l,h,v,S,M,k,B,V,Z,ie,ce){const _e=this.bucketLayerIDs[h];if(k&&!_e.some((Ve=>k.has(Ve))))return;const Se=this.sourceLayerCoder.decode(v),Le=this.vtLayers[Se].feature(S);if(M.needGeometry){const Ve=Kh(Le,!0);if(!M.filter(new Mi(this.tileID.overscaledZ),Ve,this.tileID.canonical))return}else if(!M.filter(new Mi(this.tileID.overscaledZ),Le))return;const ze=this.getId(Le,Se);for(let Ve=0;Ve<_e.length;Ve++){const et=_e[Ve];if(k&&!k.has(et))continue;const Ct=V[et];if(!Ct)continue;let rt={};ze&&ie&&(rt=ie.getState(Ct.sourceLayer||W_,ze));const ut=Be({},Z[et]);ut.paint=aB(ut.paint,Ct.paint,Le,rt,B),ut.layout=aB(ut.layout,Ct.layout,Le,rt,B);const kt=!ce||ce(Le,Ct,rt);if(!kt)continue;const Ft=new AF(Le,this.z,this.x,this.y,ze);Ft.layer=ut;let hr=l[et];hr===void 0&&(hr=l[et]=[]),hr.push({featureIndex:S,feature:Ft,intersectionZ:kt})}}lookupSymbolFeatures(l,h,v,S,M,k,B,V){const Z={};this.loadVTLayers();const ie=nh(M.filterSpec,M.globalState);for(const ce of l)this.loadMatchingFeature(Z,v,S,ce,ie,k,B,V,h);return Z}hasLayer(l){for(const h of this.bucketLayerIDs)for(const v of h)if(l===v)return!0;return!1}getId(l,h){var v;let S=l.id;return this.promoteId&&(S=l.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof S=="boolean"&&(S=Number(S)),S===void 0&&(!((v=l.properties)===null||v===void 0)&&v.cluster)&&this.promoteId&&(S=Number(l.properties.cluster_id))),S}}function aB(p,l,h,v,S){return Ke(p,((M,k)=>{const B=l instanceof Wo?l.get(k):null;return B&&B.evaluate?B.evaluate(h,v,S):B}))}function foe(p,l){return l-p}function oB(p,l,h,v,S){const M=[];for(let k=0;k<p.length;k++){const B=p[k];let V;for(let Z=0;Z<B.length-1;Z++){let ie=B[Z],ce=B[Z+1];ie.x<l&&ce.x<l||(ie.x<l?ie=new c(l,ie.y+(l-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round():ce.x<l&&(ce=new c(l,ie.y+(l-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round()),ie.y<h&&ce.y<h||(ie.y<h?ie=new c(ie.x+(h-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),h)._round():ce.y<h&&(ce=new c(ie.x+(h-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),h)._round()),ie.x>=v&&ce.x>=v||(ie.x>=v?ie=new c(v,ie.y+(v-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round():ce.x>=v&&(ce=new c(v,ie.y+(v-ie.x)/(ce.x-ie.x)*(ce.y-ie.y))._round()),ie.y>=S&&ce.y>=S||(ie.y>=S?ie=new c(ie.x+(S-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),S)._round():ce.y>=S&&(ce=new c(ie.x+(S-ie.y)/(ce.y-ie.y)*(ce.x-ie.x),S)._round()),V&&ie.equals(V[V.length-1])||(V=[ie],M.push(V)),V.push(ce)))))}}return M}function sB(p,l,h,v,S){switch(l){case 1:return(function(M,k,B,V){const Z=[];for(const ie of M)for(const ce of ie){const _e=V===0?ce.x:ce.y;_e>=k&&_e<=B&&Z.push([ce])}return Z})(p,h,v,S);case 2:return lB(p,h,v,S,!1);case 3:return lB(p,h,v,S,!0)}return[]}function hoe(p,l,h,v,S){const M=v===0?doe:poe;let k=[];const B=[];for(let ie=0;ie<p.length-1;ie++){const ce=p[ie],_e=p[ie+1],Se=v===0?ce.x:ce.y,Le=v===0?_e.x:_e.y;let ze=!1;Se<l?Le>l&&k.push(M(ce,_e,l)):Se>h?Le<h&&k.push(M(ce,_e,h)):k.push(ce),Le<l&&Se>=l&&(k.push(M(ce,_e,l)),ze=!0),Le>h&&Se<=h&&(k.push(M(ce,_e,h)),ze=!0),!S&&ze&&(B.push(k),k=[])}const V=p.length-1,Z=v===0?p[V].x:p[V].y;return Z>=l&&Z<=h&&k.push(p[V]),S&&k.length>0&&!k[0].equals(k[k.length-1])&&k.push(new c(k[0].x,k[0].y)),k.length>0&&B.push(k),B}function lB(p,l,h,v,S){const M=[];for(const k of p){const B=hoe(k,l,h,v,S);B.length>0&&M.push(...B)}return M}function doe(p,l,h){return new c(h,p.y+(h-p.x)/(l.x-p.x)*(l.y-p.y))}function poe(p,l,h){return new c(p.x+(h-p.y)/(l.y-p.y)*(l.x-p.x),h)}Pt("FeatureIndex",iB,{omit:["rawTileData","sourceLayerCoder"]});class Gp extends c{constructor(l,h,v,S){super(l,h),this.angle=v,S!==void 0&&(this.segment=S)}clone(){return new Gp(this.x,this.y,this.angle,this.segment)}}function uB(p,l,h,v,S){if(l.segment===void 0||h===0)return!0;let M=l,k=l.segment+1,B=0;for(;B>-h/2;){if(k--,k<0)return!1;B-=p[k].dist(M),M=p[k]}B+=p[k].dist(p[k+1]),k++;const V=[];let Z=0;for(;B<h/2;){const ie=p[k],ce=p[k+1];if(!ce)return!1;let _e=p[k-1].angleTo(ie)-ie.angleTo(ce);for(_e=Math.abs((_e+3*Math.PI)%(2*Math.PI)-Math.PI),V.push({distance:B,angleDelta:_e}),Z+=_e;B-V[0].distance>v;)Z-=V.shift().angleDelta;if(Z>S)return!1;k++,B+=ie.dist(ce)}return!0}function cB(p){let l=0;for(let h=0;h<p.length-1;h++)l+=p[h].dist(p[h+1]);return l}function fB(p,l,h){return p?.6*l*h:0}function hB(p,l){return Math.max(p?p.right-p.left:0,l?l.right-l.left:0)}function goe(p,l,h,v,S,M){const k=fB(h,S,M),B=hB(h,v)*M;let V=0;const Z=cB(p)/2;for(let ie=0;ie<p.length-1;ie++){const ce=p[ie],_e=p[ie+1],Se=ce.dist(_e);if(V+Se>Z){const Le=(Z-V)/Se,ze=Hn.number(ce.x,_e.x,Le),Ve=Hn.number(ce.y,_e.y,Le),et=new Gp(ze,Ve,_e.angleTo(ce),ie);return et._round(),!k||uB(p,et,B,k,l)?et:void 0}V+=Se}}function moe(p,l,h,v,S,M,k,B,V){const Z=fB(v,M,k),ie=hB(v,S),ce=ie*k,_e=p[0].x===0||p[0].x===V||p[0].y===0||p[0].y===V;return l-ce<l/4&&(l=ce+l/4),dB(p,_e?l/2*B%l:(ie/2+2*M)*k*B%l,l,Z,h,ce,_e,!1,V)}function dB(p,l,h,v,S,M,k,B,V){const Z=M/2,ie=cB(p);let ce=0,_e=l-h,Se=[];for(let Le=0;Le<p.length-1;Le++){const ze=p[Le],Ve=p[Le+1],et=ze.dist(Ve),Ct=Ve.angleTo(ze);for(;_e+h<ce+et;){_e+=h;const rt=(_e-ce)/et,ut=Hn.number(ze.x,Ve.x,rt),kt=Hn.number(ze.y,Ve.y,rt);if(ut>=0&&ut<V&&kt>=0&&kt<V&&_e-Z>=0&&_e+Z<=ie){const Ft=new Gp(ut,kt,Ct,Le);Ft._round(),v&&!uB(p,Ft,M,v,S)||Se.push(Ft)}}ce+=et}return B||Se.length||k||(Se=dB(p,ce/2,h,v,S,M,k,!0,V)),Se}function pB(p,l,h,v){const S=[],M=p.image,k=M.pixelRatio,B=M.paddedRect.w-2,V=M.paddedRect.h-2;let Z={x1:p.left,y1:p.top,x2:p.right,y2:p.bottom};const ie=M.stretchX||[[0,B]],ce=M.stretchY||[[0,V]],_e=(Er,Cn)=>Er+Cn[1]-Cn[0],Se=ie.reduce(_e,0),Le=ce.reduce(_e,0),ze=B-Se,Ve=V-Le;let et=0,Ct=Se,rt=0,ut=Le,kt=0,Ft=ze,hr=0,Or=Ve;if(M.content&&v){const Er=M.content,Cn=Er[2]-Er[0],xn=Er[3]-Er[1];(M.textFitWidth||M.textFitHeight)&&(Z=uF(p)),et=A2(ie,0,Er[0]),rt=A2(ce,0,Er[1]),Ct=A2(ie,Er[0],Er[2]),ut=A2(ce,Er[1],Er[3]),kt=Er[0]-et,hr=Er[1]-rt,Ft=Cn-Ct,Or=xn-ut}const Pr=Z.x1,Vr=Z.y1,dn=Z.x2-Pr,Wr=Z.y2-Vr,kr=(Er,Cn,xn,Mn)=>{const vn=I2(Er.stretch-et,Ct,dn,Pr),Gn=P2(Er.fixed-kt,Ft,Er.stretch,Se),la=I2(Cn.stretch-rt,ut,Wr,Vr),Hi=P2(Cn.fixed-hr,Or,Cn.stretch,Le),Mo=I2(xn.stretch-et,Ct,dn,Pr),Ql=P2(xn.fixed-kt,Ft,xn.stretch,Se),Ds=I2(Mn.stretch-rt,ut,Wr,Vr),ko=P2(Mn.fixed-hr,Or,Mn.stretch,Le),vo=new c(vn,la),Ta=new c(Mo,la),Yo=new c(Mo,Ds),ss=new c(vn,Ds),co=new c(Gn/k,Hi/k),cc=new c(Ql/k,ko/k),eu=l*Math.PI/180;if(eu){const _l=Math.sin(eu),Bo=Math.cos(eu),Os=[Bo,-_l,_l,Bo];vo._matMult(Os),Ta._matMult(Os),ss._matMult(Os),Yo._matMult(Os)}const fc=Er.stretch+Er.fixed,Cf=Cn.stretch+Cn.fixed;return{tl:vo,tr:Ta,bl:ss,br:Yo,tex:{x:M.paddedRect.x+1+fc,y:M.paddedRect.y+1+Cf,w:xn.stretch+xn.fixed-fc,h:Mn.stretch+Mn.fixed-Cf},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:co,pixelOffsetBR:cc,minFontScaleX:Ft/k/dn,minFontScaleY:Or/k/Wr,isSDF:h}};if(v&&(M.stretchX||M.stretchY)){const Er=gB(ie,ze,Se),Cn=gB(ce,Ve,Le);for(let xn=0;xn<Er.length-1;xn++){const Mn=Er[xn],vn=Er[xn+1];for(let Gn=0;Gn<Cn.length-1;Gn++)S.push(kr(Mn,Cn[Gn],vn,Cn[Gn+1]))}}else S.push(kr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:B+1},{fixed:0,stretch:V+1}));return S}function A2(p,l,h){let v=0;for(const S of p)v+=Math.max(l,Math.min(h,S[1]))-Math.max(l,Math.min(h,S[0]));return v}function gB(p,l,h){const v=[{fixed:-1,stretch:0}];for(const[S,M]of p){const k=v[v.length-1];v.push({fixed:S-k.stretch,stretch:k.stretch}),v.push({fixed:S-k.stretch,stretch:k.stretch+(M-S)})}return v.push({fixed:l+1,stretch:h}),v}function I2(p,l,h,v){return p/l*h+v}function P2(p,l,h,v){return p-l*h/v}Pt("Anchor",Gp);class M2{constructor(l,h,v,S,M,k,B,V,Z,ie){var ce;if(this.boxStartIndex=l.length,Z){let _e=k.top,Se=k.bottom;const Le=k.collisionPadding;Le&&(_e-=Le[1],Se+=Le[3]);let ze=Se-_e;ze>0&&(ze=Math.max(10,ze),this.circleDiameter=ze)}else{const _e=!((ce=k.image)===null||ce===void 0)&&ce.content&&(k.image.textFitWidth||k.image.textFitHeight)?uF(k):{x1:k.left,y1:k.top,x2:k.right,y2:k.bottom};_e.y1=_e.y1*B-V[0],_e.y2=_e.y2*B+V[2],_e.x1=_e.x1*B-V[3],_e.x2=_e.x2*B+V[1];const Se=k.collisionPadding;if(Se&&(_e.x1-=Se[0]*B,_e.y1-=Se[1]*B,_e.x2+=Se[2]*B,_e.y2+=Se[3]*B),ie){const Le=new c(_e.x1,_e.y1),ze=new c(_e.x2,_e.y1),Ve=new c(_e.x1,_e.y2),et=new c(_e.x2,_e.y2),Ct=ie*Math.PI/180;Le._rotate(Ct),ze._rotate(Ct),Ve._rotate(Ct),et._rotate(Ct),_e.x1=Math.min(Le.x,ze.x,Ve.x,et.x),_e.x2=Math.max(Le.x,ze.x,Ve.x,et.x),_e.y1=Math.min(Le.y,ze.y,Ve.y,et.y),_e.y2=Math.max(Le.y,ze.y,Ve.y,et.y)}l.emplaceBack(h.x,h.y,_e.x1,_e.y1,_e.x2,_e.y2,v,S,M)}this.boxEndIndex=l.length}}class yoe{constructor(l=[],h=(v,S)=>v<S?-1:v>S?1:0){if(this.data=l,this.length=this.data.length,this.compare=h,this.length>0)for(let v=(this.length>>1)-1;v>=0;v--)this._down(v)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:h,compare:v}=this,S=h[l];for(;l>0;){const M=l-1>>1,k=h[M];if(v(S,k)>=0)break;h[l]=k,l=M}h[l]=S}_down(l){const{data:h,compare:v}=this,S=this.length>>1,M=h[l];for(;l<S;){let k=1+(l<<1);const B=k+1;if(B<this.length&&v(h[B],h[k])<0&&(k=B),v(h[k],M)>=0)break;h[l]=h[k],l=k}h[l]=M}}function voe(p,l=1,h=!1){const v=nm.fromPoints(p[0]),S=Math.min(v.width(),v.height());let M=S/2;const k=new yoe([],_oe),{minX:B,minY:V,maxX:Z,maxY:ie}=v;if(S===0)return new c(B,V);for(let Se=B;Se<Z;Se+=S)for(let Le=V;Le<ie;Le+=S)k.push(new tv(Se+M,Le+M,M,p));let ce=(function(Se){let Le=0,ze=0,Ve=0;const et=Se[0];for(let Ct=0,rt=et.length,ut=rt-1;Ct<rt;ut=Ct++){const kt=et[Ct],Ft=et[ut],hr=kt.x*Ft.y-Ft.x*kt.y;ze+=(kt.x+Ft.x)*hr,Ve+=(kt.y+Ft.y)*hr,Le+=3*hr}return new tv(ze/Le,Ve/Le,0,Se)})(p),_e=k.length;for(;k.length;){const Se=k.pop();(Se.d>ce.d||!ce.d)&&(ce=Se,h&&console.log("found best %d after %d probes",Math.round(1e4*Se.d)/1e4,_e)),Se.max-ce.d<=l||(M=Se.h/2,k.push(new tv(Se.p.x-M,Se.p.y-M,M,p)),k.push(new tv(Se.p.x+M,Se.p.y-M,M,p)),k.push(new tv(Se.p.x-M,Se.p.y+M,M,p)),k.push(new tv(Se.p.x+M,Se.p.y+M,M,p)),_e+=4)}return h&&(console.log(`num probes: ${_e}`),console.log(`best distance: ${ce.d}`)),ce.p}function _oe(p,l){return l.max-p.max}function tv(p,l,h,v){this.p=new c(p,l),this.h=h,this.d=(function(S,M){let k=!1,B=1/0;for(let V=0;V<M.length;V++){const Z=M[V];for(let ie=0,ce=Z.length,_e=ce-1;ie<ce;_e=ie++){const Se=Z[ie],Le=Z[_e];Se.y>S.y!=Le.y>S.y&&S.x<(Le.x-Se.x)*(S.y-Se.y)/(Le.y-Se.y)+Se.x&&(k=!k),B=Math.min(B,b6(S,Se,Le))}}return(k?1:-1)*Math.sqrt(B)})(this.p,v),this.max=this.d+this.h*Math.SQRT2}var Jl;s.aP=void 0,(Jl=s.aP||(s.aP={}))[Jl.center=1]="center",Jl[Jl.left=2]="left",Jl[Jl.right=3]="right",Jl[Jl.top=4]="top",Jl[Jl.bottom=5]="bottom",Jl[Jl["top-left"]=6]="top-left",Jl[Jl["top-right"]=7]="top-right",Jl[Jl["bottom-left"]=8]="bottom-left",Jl[Jl["bottom-right"]=9]="bottom-right";const GC=Number.POSITIVE_INFINITY;function mB(p,l){return l[1]!==GC?(function(h,v,S){let M=0,k=0;switch(v=Math.abs(v),S=Math.abs(S),h){case"top-right":case"top-left":case"top":k=S-7;break;case"bottom-right":case"bottom-left":case"bottom":k=7-S}switch(h){case"top-right":case"bottom-right":case"right":M=-v;break;case"top-left":case"bottom-left":case"left":M=v}return[M,k]})(p,l[0],l[1]):(function(h,v){let S=0,M=0;v<0&&(v=0);const k=v/Math.SQRT2;switch(h){case"top-right":case"top-left":M=k-7;break;case"bottom-right":case"bottom-left":M=7-k;break;case"bottom":M=7-v;break;case"top":M=v-7}switch(h){case"top-right":case"bottom-right":S=-k;break;case"top-left":case"bottom-left":S=k;break;case"left":S=v;break;case"right":S=-v}return[S,M]})(p,l[0])}function yB(p,l,h){var v;const S=p.layout,M=(v=S.get("text-variable-anchor-offset"))===null||v===void 0?void 0:v.evaluate(l,{},h);if(M){const B=M.values,V=[];for(let Z=0;Z<B.length;Z+=2){const ie=V[Z]=B[Z],ce=B[Z+1].map((_e=>_e*ml));ie.startsWith("top")?ce[1]-=7:ie.startsWith("bottom")&&(ce[1]+=7),V[Z+1]=ce}return new ba(V)}const k=S.get("text-variable-anchor");if(k){let B;B=p._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[S.get("text-radial-offset").evaluate(l,{},h)*ml,GC]:S.get("text-offset").evaluate(l,{},h).map((Z=>Z*ml));const V=[];for(const Z of k)V.push(Z,mB(Z,B));return new ba(V)}return null}function WC(p){switch(p){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function boe(p,l,h,v,S,M,k,B,V,Z,ie,ce){let _e=M.textMaxSize.evaluate(l,{});_e===void 0&&(_e=k);const Se=p.layers[0].layout,Le=Se.get("icon-offset").evaluate(l,{},ie),ze=_B(h.horizontal),Ve=k/24,et=p.tilePixelRatio*Ve,Ct=p.tilePixelRatio*_e/24,rt=p.tilePixelRatio*B,ut=p.tilePixelRatio*Se.get("symbol-spacing"),kt=Se.get("text-padding")*p.tilePixelRatio,Ft=(function(xn,Mn,vn,Gn=1){const la=xn.get("icon-padding").evaluate(Mn,{},vn),Hi=la&&la.values;return[Hi[0]*Gn,Hi[1]*Gn,Hi[2]*Gn,Hi[3]*Gn]})(Se,l,ie,p.tilePixelRatio),hr=Se.get("text-max-angle")/180*Math.PI,Or=Se.get("text-rotation-alignment")!=="viewport"&&Se.get("symbol-placement")!=="point",Pr=Se.get("icon-rotation-alignment")==="map"&&Se.get("symbol-placement")!=="point",Vr=Se.get("symbol-placement"),dn=ut/2,Wr=Se.get("icon-text-fit");let kr;v&&Wr!=="none"&&(p.allowVerticalPlacement&&h.vertical&&(kr=cF(v,h.vertical,Wr,Se.get("icon-text-fit-padding"),Le,Ve)),ze&&(v=cF(v,ze,Wr,Se.get("icon-text-fit-padding"),Le,Ve)));const Er=ie?ce.line.getGranularityForZoomLevel(ie.z):1,Cn=(xn,Mn)=>{Mn.x<0||Mn.x>=we||Mn.y<0||Mn.y>=we||(function(vn,Gn,la,Hi,Mo,Ql,Ds,ko,vo,Ta,Yo,ss,co,cc,eu,fc,Cf,_l,Bo,Os,Zo,bl,Gd,ch,Z_){const Wp=vn.addToLineVertexArray(Gn,la);let om,rv,nv,iv,SB=0,EB=0,TB=0,CB=0,tA=-1,rA=-1;const Wd={};let AB=os("");if(vn.allowVerticalPlacement&&Hi.vertical){const vu=ko.layout.get("text-rotate").evaluate(Zo,{},ch)+90;nv=new M2(vo,Gn,Ta,Yo,ss,Hi.vertical,co,cc,eu,vu),Ds&&(iv=new M2(vo,Gn,Ta,Yo,ss,Ds,Cf,_l,eu,vu))}if(Mo){const vu=ko.layout.get("icon-rotate").evaluate(Zo,{}),Zc=ko.layout.get("icon-text-fit")!=="none",sm=pB(Mo,vu,Gd,Zc),hh=Ds?pB(Ds,vu,Gd,Zc):void 0;rv=new M2(vo,Gn,Ta,Yo,ss,Mo,Cf,_l,!1,vu),SB=4*sm.length;const lm=vn.iconSizeData;let Jh=null;lm.kind==="source"?(Jh=[qd*ko.layout.get("icon-size").evaluate(Zo,{})],Jh[0]>$p&&st(`${vn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):lm.kind==="composite"&&(Jh=[qd*bl.compositeIconSizes[0].evaluate(Zo,{},ch),qd*bl.compositeIconSizes[1].evaluate(Zo,{},ch)],(Jh[0]>$p||Jh[1]>$p)&&st(`${vn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),vn.addSymbols(vn.icon,sm,Jh,Os,Bo,Zo,s.az.none,Gn,Wp.lineStartIndex,Wp.lineLength,-1,ch),tA=vn.icon.placedSymbolArray.length-1,hh&&(EB=4*hh.length,vn.addSymbols(vn.icon,hh,Jh,Os,Bo,Zo,s.az.vertical,Gn,Wp.lineStartIndex,Wp.lineLength,-1,ch),rA=vn.icon.placedSymbolArray.length-1)}const IB=Object.keys(Hi.horizontal);for(const vu of IB){const Zc=Hi.horizontal[vu];if(!om){AB=os(Zc.text);const hh=ko.layout.get("text-rotate").evaluate(Zo,{},ch);om=new M2(vo,Gn,Ta,Yo,ss,Zc,co,cc,eu,hh)}const sm=Zc.positionedLines.length===1;if(TB+=vB(vn,Gn,Zc,Ql,ko,eu,Zo,fc,Wp,Hi.vertical?s.az.horizontal:s.az.horizontalOnly,sm?IB:[vu],Wd,tA,bl,ch),sm)break}Hi.vertical&&(CB+=vB(vn,Gn,Hi.vertical,Ql,ko,eu,Zo,fc,Wp,s.az.vertical,["vertical"],Wd,rA,bl,ch));const Soe=om?om.boxStartIndex:vn.collisionBoxArray.length,Eoe=om?om.boxEndIndex:vn.collisionBoxArray.length,Toe=nv?nv.boxStartIndex:vn.collisionBoxArray.length,Coe=nv?nv.boxEndIndex:vn.collisionBoxArray.length,Aoe=rv?rv.boxStartIndex:vn.collisionBoxArray.length,Ioe=rv?rv.boxEndIndex:vn.collisionBoxArray.length,Poe=iv?iv.boxStartIndex:vn.collisionBoxArray.length,Moe=iv?iv.boxEndIndex:vn.collisionBoxArray.length;let fh=-1;const R2=(vu,Zc)=>vu&&vu.circleDiameter?Math.max(vu.circleDiameter,Zc):Zc;fh=R2(om,fh),fh=R2(nv,fh),fh=R2(rv,fh),fh=R2(iv,fh);const PB=fh>-1?1:0;PB&&(fh*=Z_/ml),vn.glyphOffsetArray.length>=Yy.MAX_GLYPHS&&st("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Zo.sortKey!==void 0&&vn.addToSortKeyRanges(vn.symbolInstances.length,Zo.sortKey);const koe=yB(ko,Zo,ch),[Roe,Doe]=(function(vu,Zc){const sm=vu.length,hh=Zc?.values;if(hh?.length>0)for(let lm=0;lm<hh.length;lm+=2){const Jh=hh[lm+1];vu.emplaceBack(s.aP[hh[lm]],Jh[0],Jh[1])}return[sm,vu.length]})(vn.textAnchorOffsets,koe);vn.symbolInstances.emplaceBack(Gn.x,Gn.y,Wd.right>=0?Wd.right:-1,Wd.center>=0?Wd.center:-1,Wd.left>=0?Wd.left:-1,Wd.vertical||-1,tA,rA,AB,Soe,Eoe,Toe,Coe,Aoe,Ioe,Poe,Moe,Ta,TB,CB,SB,EB,PB,0,co,fh,Roe,Doe)})(p,Mn,xn,h,v,S,kr,p.layers[0],p.collisionBoxArray,l.index,l.sourceLayerIndex,p.index,et,[kt,kt,kt,kt],Or,V,rt,Ft,Pr,Le,l,M,Z,ie,k)};if(Vr==="line")for(const xn of oB(l.geometry,0,0,we,we)){const Mn=rm(xn,Er),vn=moe(Mn,ut,hr,h.vertical||ze,v,24,Ct,p.overscaling,we);for(const Gn of vn)ze&&xoe(p,ze.text,dn,Gn)||Cn(Mn,Gn)}else if(Vr==="line-center"){for(const xn of l.geometry)if(xn.length>1){const Mn=rm(xn,Er),vn=goe(Mn,hr,h.vertical||ze,v,24,Ct);vn&&Cn(Mn,vn)}}else if(l.type==="Polygon")for(const xn of Vl(l.geometry,0)){const Mn=voe(xn,16);Cn(rm(xn[0],Er,!0),new Gp(Mn.x,Mn.y,0))}else if(l.type==="LineString")for(const xn of l.geometry){const Mn=rm(xn,Er);Cn(Mn,new Gp(Mn[0].x,Mn[0].y,0))}else if(l.type==="Point")for(const xn of l.geometry)for(const Mn of xn)Cn([Mn],new Gp(Mn.x,Mn.y,0))}function vB(p,l,h,v,S,M,k,B,V,Z,ie,ce,_e,Se,Le){const ze=(function(Ct,rt,ut,kt,Ft,hr,Or,Pr){const Vr=kt.layout.get("text-rotate").evaluate(hr,{})*Math.PI/180,dn=[];for(const Wr of rt.positionedLines)for(const kr of Wr.positionedGlyphs){if(!kr.rect)continue;const Er=kr.rect||{};let Cn=4,xn=!0,Mn=1,vn=0;const Gn=(Ft||Pr)&&kr.vertical,la=kr.metrics.advance*kr.scale/2;if(Pr&&rt.verticalizable&&(vn=Wr.lineOffset/2-(kr.imageName?-(ml-kr.metrics.width*kr.scale)/2:(kr.scale-1)*ml)),kr.imageName){const _l=Or[kr.imageName];xn=_l.sdf,Mn=_l.pixelRatio,Cn=1/Mn}const Hi=Ft?[kr.x+la,kr.y]:[0,0];let Mo=Ft?[0,0]:[kr.x+la+ut[0],kr.y+ut[1]-vn],Ql=[0,0];Gn&&(Ql=Mo,Mo=[0,0]);const Ds=kr.metrics.isDoubleResolution?2:1,ko=(kr.metrics.left-Cn)*kr.scale-la+Mo[0],vo=(-kr.metrics.top-Cn)*kr.scale+Mo[1],Ta=ko+Er.w/Ds*kr.scale/Mn,Yo=vo+Er.h/Ds*kr.scale/Mn,ss=new c(ko,vo),co=new c(Ta,vo),cc=new c(ko,Yo),eu=new c(Ta,Yo);if(Gn){const _l=new c(-la,la- -17),Bo=-Math.PI/2,Os=12-la,Zo=new c(22-Os,-(kr.imageName?Os:0)),bl=new c(...Ql);ss._rotateAround(Bo,_l)._add(Zo)._add(bl),co._rotateAround(Bo,_l)._add(Zo)._add(bl),cc._rotateAround(Bo,_l)._add(Zo)._add(bl),eu._rotateAround(Bo,_l)._add(Zo)._add(bl)}if(Vr){const _l=Math.sin(Vr),Bo=Math.cos(Vr),Os=[Bo,-_l,_l,Bo];ss._matMult(Os),co._matMult(Os),cc._matMult(Os),eu._matMult(Os)}const fc=new c(0,0),Cf=new c(0,0);dn.push({tl:ss,tr:co,bl:cc,br:eu,tex:Er,writingMode:rt.writingMode,glyphOffset:Hi,sectionIndex:kr.sectionIndex,isSDF:xn,pixelOffsetTL:fc,pixelOffsetBR:Cf,minFontScaleX:0,minFontScaleY:0})}return dn})(0,h,B,S,M,k,v,p.allowVerticalPlacement),Ve=p.textSizeData;let et=null;Ve.kind==="source"?(et=[qd*S.layout.get("text-size").evaluate(k,{})],et[0]>$p&&st(`${p.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Ve.kind==="composite"&&(et=[qd*Se.compositeTextSizes[0].evaluate(k,{},Le),qd*Se.compositeTextSizes[1].evaluate(k,{},Le)],(et[0]>$p||et[1]>$p)&&st(`${p.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),p.addSymbols(p.text,ze,et,B,M,k,Z,l,V.lineStartIndex,V.lineLength,_e,Le);for(const Ct of ie)ce[Ct]=p.text.placedSymbolArray.length-1;return 4*ze.length}function _B(p){for(const l in p)return p[l];return null}function xoe(p,l,h,v){const S=p.compareText;if(l in S){const M=S[l];for(let k=M.length-1;k>=0;k--)if(v.dist(M[k])<h)return!0}else S[l]=[];return S[l].push(v),!1}const bB=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class XC{static from(l){if(!(l instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,v]=new Uint8Array(l,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const S=v>>4;if(S!==1)throw new Error(`Got v${S} data when expected v1.`);const M=bB[15&v];if(!M)throw new Error("Unrecognized array type.");const[k]=new Uint16Array(l,2,1),[B]=new Uint32Array(l,4,1);return new XC(B,k,M,l)}constructor(l,h=64,v=Float64Array,S){if(isNaN(l)||l<0)throw new Error(`Unpexpected numItems value: ${l}.`);this.numItems=+l,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=v,this.IndexArrayType=l<65536?Uint16Array:Uint32Array;const M=bB.indexOf(this.ArrayType),k=2*l*this.ArrayType.BYTES_PER_ELEMENT,B=l*this.IndexArrayType.BYTES_PER_ELEMENT,V=(8-B%8)%8;if(M<0)throw new Error(`Unexpected typed array class: ${v}.`);S&&S instanceof ArrayBuffer?(this.data=S,this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+B+V,2*l),this._pos=2*l,this._finished=!0):(this.data=new ArrayBuffer(8+k+B+V),this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+B+V,2*l),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+M]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=l)}add(l,h){const v=this._pos>>1;return this.ids[v]=v,this.coords[this._pos++]=l,this.coords[this._pos++]=h,v}finish(){const l=this._pos>>1;if(l!==this.numItems)throw new Error(`Added ${l} items when expected ${this.numItems}.`);return YC(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(l,h,v,S){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:M,coords:k,nodeSize:B}=this,V=[0,M.length-1,0],Z=[];for(;V.length;){const ie=V.pop()||0,ce=V.pop()||0,_e=V.pop()||0;if(ce-_e<=B){for(let Ve=_e;Ve<=ce;Ve++){const et=k[2*Ve],Ct=k[2*Ve+1];et>=l&&et<=v&&Ct>=h&&Ct<=S&&Z.push(M[Ve])}continue}const Se=_e+ce>>1,Le=k[2*Se],ze=k[2*Se+1];Le>=l&&Le<=v&&ze>=h&&ze<=S&&Z.push(M[Se]),(ie===0?l<=Le:h<=ze)&&(V.push(_e),V.push(Se-1),V.push(1-ie)),(ie===0?v>=Le:S>=ze)&&(V.push(Se+1),V.push(ce),V.push(1-ie))}return Z}within(l,h,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:S,coords:M,nodeSize:k}=this,B=[0,S.length-1,0],V=[],Z=v*v;for(;B.length;){const ie=B.pop()||0,ce=B.pop()||0,_e=B.pop()||0;if(ce-_e<=k){for(let Ve=_e;Ve<=ce;Ve++)wB(M[2*Ve],M[2*Ve+1],l,h)<=Z&&V.push(S[Ve]);continue}const Se=_e+ce>>1,Le=M[2*Se],ze=M[2*Se+1];wB(Le,ze,l,h)<=Z&&V.push(S[Se]),(ie===0?l-v<=Le:h-v<=ze)&&(B.push(_e),B.push(Se-1),B.push(1-ie)),(ie===0?l+v>=Le:h+v>=ze)&&(B.push(Se+1),B.push(ce),B.push(1-ie))}return V}}function YC(p,l,h,v,S,M){if(S-v<=h)return;const k=v+S>>1;xB(p,l,k,v,S,M),YC(p,l,h,v,k-1,1-M),YC(p,l,h,k+1,S,1-M)}function xB(p,l,h,v,S,M){for(;S>v;){if(S-v>600){const Z=S-v+1,ie=h-v+1,ce=Math.log(Z),_e=.5*Math.exp(2*ce/3),Se=.5*Math.sqrt(ce*_e*(Z-_e)/Z)*(ie-Z/2<0?-1:1);xB(p,l,h,Math.max(v,Math.floor(h-ie*_e/Z+Se)),Math.min(S,Math.floor(h+(Z-ie)*_e/Z+Se)),M)}const k=l[2*h+M];let B=v,V=S;for(X_(p,l,v,h),l[2*S+M]>k&&X_(p,l,v,S);B<V;){for(X_(p,l,B,V),B++,V--;l[2*B+M]<k;)B++;for(;l[2*V+M]>k;)V--}l[2*v+M]===k?X_(p,l,v,V):(V++,X_(p,l,V,S)),V<=h&&(v=V+1),h<=V&&(S=V-1)}}function X_(p,l,h,v){ZC(p,h,v),ZC(l,2*h,2*v),ZC(l,2*h+1,2*v+1)}function ZC(p,l,h){const v=p[l];p[l]=p[h],p[h]=v}function wB(p,l,h,v){const S=p-h,M=l-v;return S*S+M*M}var KC;s.cH=void 0,(KC=s.cH||(s.cH={})).create="create",KC.load="load",KC.fullLoad="fullLoad";let k2=null,Y_=[];const JC=1e3/60,QC="loadTime",eA="fullLoadTime",woe={mark(p){performance.mark(p)},frame(p){const l=p;k2!=null&&Y_.push(l-k2),k2=l},clearMetrics(){k2=null,Y_=[],performance.clearMeasures(QC),performance.clearMeasures(eA);for(const p in s.cH)performance.clearMarks(s.cH[p])},getPerformanceMetrics(){performance.measure(QC,s.cH.create,s.cH.load),performance.measure(eA,s.cH.create,s.cH.fullLoad);const p=performance.getEntriesByName(QC)[0].duration,l=performance.getEntriesByName(eA)[0].duration,h=Y_.length,v=1/(Y_.reduce(((M,k)=>M+k),0)/h/1e3),S=Y_.filter((M=>M>JC)).reduce(((M,k)=>M+(k-JC)/JC),0);return{loadTime:p,fullLoadTime:l,fps:v,percentDroppedFrames:S/(h+S)*100,totalFrames:h}}};s.$=A,s.A=N,s.B=Xt,s.C=Qe,s.D=Tn,s.E=zr,s.F=function([p,l,h]){return l+=90,l*=Math.PI/180,h*=Math.PI/180,{x:p*Math.cos(l)*Math.sin(h),y:p*Math.sin(l)*Math.sin(h),z:p*Math.cos(h)}},s.G=Hn,s.H=Mi,s.I=bC,s.J=lt,s.K=function(p){if(Ht==null){const l=p.navigator?p.navigator.userAgent:null;Ht=!!p.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return Ht},s.L=class{constructor(p,l){this.target=p,this.mapId=l,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Fae((()=>this.process())),this.subscription=Cr(this.target,"message",(h=>this.receive(h)),!1),this.globalScope=Jt(self)?p:window}registerMessageHandler(p,l){this.messageHandlers[p]=l}unregisterMessageHandler(p){delete this.messageHandlers[p]}sendAsync(p,l){return new Promise(((h,v)=>{const S=Math.round(1e18*Math.random()).toString(36).substring(0,10),M=l?Cr(l.signal,"abort",(()=>{M?.unsubscribe(),delete this.resolveRejects[S];const V={id:S,type:"<cancel>",origin:location.origin,targetMapId:p.targetMapId,sourceMapId:this.mapId};this.target.postMessage(V)}),Bae):null;this.resolveRejects[S]={resolve:V=>{M?.unsubscribe(),h(V)},reject:V=>{M?.unsubscribe(),v(V)}};const k=[],B=Object.assign(Object.assign({},p),{id:S,sourceMapId:this.mapId,origin:location.origin,data:Br(p.data,k)});this.target.postMessage(B,{transfer:k})}))}receive(p){const l=p.data,h=l.id;if(!(l.origin!=="file://"&&location.origin!=="file://"&&l.origin!=="resource://android"&&location.origin!=="resource://android"&&l.origin!==location.origin||l.targetMapId&&this.mapId!==l.targetMapId)){if(l.type==="<cancel>"){delete this.tasks[h];const v=this.abortControllers[h];return delete this.abortControllers[h],void(v&&v.abort())}if(Jt(self)||l.mustQueue)return this.tasks[h]=l,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,l)}}process(){if(this.taskQueue.length===0)return;const p=this.taskQueue.shift(),l=this.tasks[p];delete this.tasks[p],this.taskQueue.length>0&&this.invoker.trigger(),l&&this.processTask(p,l)}processTask(p,l){return o(this,void 0,void 0,(function*(){if(l.type==="<response>"){const S=this.resolveRejects[p];return delete this.resolveRejects[p],S?void(l.error?S.reject(jr(l.error)):S.resolve(jr(l.data))):void 0}if(!this.messageHandlers[l.type])return void this.completeTask(p,new Error(`Could not find a registered handler for ${l.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=jr(l.data),v=new AbortController;this.abortControllers[p]=v;try{const S=yield this.messageHandlers[l.type](l.sourceMapId,h,v);this.completeTask(p,null,S)}catch(S){this.completeTask(p,S)}}))}completeTask(p,l,h){const v=[];delete this.abortControllers[p];const S={id:p,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:l?Br(l):null,data:Br(h,v)};this.target.postMessage(S,{transfer:v})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},s.M=Et,s.N=function(){var p=new N(16);return N!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=0,p[12]=0,p[13]=0,p[14]=0),p[0]=1,p[5]=1,p[10]=1,p[15]=1,p},s.O=function(p,l,h){var v,S,M,k,B,V,Z,ie,ce,_e,Se,Le,ze=h[0],Ve=h[1],et=h[2];return l===p?(p[12]=l[0]*ze+l[4]*Ve+l[8]*et+l[12],p[13]=l[1]*ze+l[5]*Ve+l[9]*et+l[13],p[14]=l[2]*ze+l[6]*Ve+l[10]*et+l[14],p[15]=l[3]*ze+l[7]*Ve+l[11]*et+l[15]):(S=l[1],M=l[2],k=l[3],B=l[4],V=l[5],Z=l[6],ie=l[7],ce=l[8],_e=l[9],Se=l[10],Le=l[11],p[0]=v=l[0],p[1]=S,p[2]=M,p[3]=k,p[4]=B,p[5]=V,p[6]=Z,p[7]=ie,p[8]=ce,p[9]=_e,p[10]=Se,p[11]=Le,p[12]=v*ze+B*Ve+ce*et+l[12],p[13]=S*ze+V*Ve+_e*et+l[13],p[14]=M*ze+Z*Ve+Se*et+l[14],p[15]=k*ze+ie*Ve+Le*et+l[15]),p},s.P=c,s.Q=function(p,l,h){var v=h[0],S=h[1],M=h[2];return p[0]=l[0]*v,p[1]=l[1]*v,p[2]=l[2]*v,p[3]=l[3]*v,p[4]=l[4]*S,p[5]=l[5]*S,p[6]=l[6]*S,p[7]=l[7]*S,p[8]=l[8]*M,p[9]=l[9]*M,p[10]=l[10]*M,p[11]=l[11]*M,p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15],p},s.R=uc,s.S=function(p,l,h){var v=l[0],S=l[1],M=l[2],k=l[3],B=l[4],V=l[5],Z=l[6],ie=l[7],ce=l[8],_e=l[9],Se=l[10],Le=l[11],ze=l[12],Ve=l[13],et=l[14],Ct=l[15],rt=h[0],ut=h[1],kt=h[2],Ft=h[3];return p[0]=rt*v+ut*B+kt*ce+Ft*ze,p[1]=rt*S+ut*V+kt*_e+Ft*Ve,p[2]=rt*M+ut*Z+kt*Se+Ft*et,p[3]=rt*k+ut*ie+kt*Le+Ft*Ct,p[4]=(rt=h[4])*v+(ut=h[5])*B+(kt=h[6])*ce+(Ft=h[7])*ze,p[5]=rt*S+ut*V+kt*_e+Ft*Ve,p[6]=rt*M+ut*Z+kt*Se+Ft*et,p[7]=rt*k+ut*ie+kt*Le+Ft*Ct,p[8]=(rt=h[8])*v+(ut=h[9])*B+(kt=h[10])*ce+(Ft=h[11])*ze,p[9]=rt*S+ut*V+kt*_e+Ft*Ve,p[10]=rt*M+ut*Z+kt*Se+Ft*et,p[11]=rt*k+ut*ie+kt*Le+Ft*Ct,p[12]=(rt=h[12])*v+(ut=h[13])*B+(kt=h[14])*ce+(Ft=h[15])*ze,p[13]=rt*S+ut*V+kt*_e+Ft*Ve,p[14]=rt*M+ut*Z+kt*Se+Ft*et,p[15]=rt*k+ut*ie+kt*Le+Ft*Ct,p},s.T=fC,s.U=function(p,l){const h={};for(let v=0;v<l.length;v++){const S=l[v];S in p&&(h[S]=p[S])}return h},s.V=qp,s.W=Xe,s.X=_F,s.Y=vF,s.Z=qe,s._=o,s.a=je,s.a$=oe,s.a0=R,s.a1=vr,s.a2=Xc,s.a3=xF,s.a4=_2,s.a5=we,s.a6=function(p,l,h){if(!p)return l||{};if(!l)return p||{};const v=TF(p),S=TF(l);(function(k,B){B.removeAll&&(k.add.clear(),k.update.clear(),k.remove.clear(),B.remove.clear());for(const V of B.remove)k.add.delete(V),k.update.delete(V);for(const[V,Z]of B.update){const ie=k.update.get(V);ie&&(B.update.set(V,zae(ie,Z)),k.update.delete(V))}})(v,S);const M={};if((v.removeAll||S.removeAll)&&(M.removeAll=!0),M.remove=new Set([...v.remove,...S.remove]),M.add=new Map([...v.add,...S.add]),M.update=new Map([...v.update,...S.update]),M.remove.size&&M.add.size)for(const k of M.add.keys())M.remove.delete(k);return(function(k){const B={};return k.removeAll&&(B.removeAll=k.removeAll),k.remove&&(B.remove=Array.from(k.remove)),k.add&&(B.add=Array.from(k.add.values())),k.update&&(B.update=Array.from(k.update.values())),B})(M)},s.a7=function(p,l){const h=new Map;if(p==null||p.type==null)return h;if(p.type==="Feature"){const v=PC(p,l);return v==null?void 0:(h.set(v,p),h)}if(p.type==="FeatureCollection"){const v=new Set;for(const S of p.features){const M=PC(S,l);if(M==null||v.has(M))return;v.add(M),h.set(M,S)}return h}},s.a8=function(p,l,h){var v,S;const M=[];if(l.removeAll)p.clear();else if(l.remove)for(const k of l.remove){const B=p.get(k);B&&(M.push(B.geometry),p.delete(k))}if(l.add)for(const k of l.add){const B=PC(k,h);if(B==null)continue;const V=p.get(B);V&&M.push(V.geometry),M.push(k.geometry),p.set(B,k)}if(l.update)for(const k of l.update){const B=p.get(k.id);if(!B)continue;const V=!!k.newGeometry,Z=k.removeAllProperties||((v=k.removeProperties)===null||v===void 0?void 0:v.length)>0||((S=k.addOrUpdateProperties)===null||S===void 0?void 0:S.length)>0;if(!V&&!Z)continue;M.push(B.geometry);const ie=Object.assign({},B);if(p.set(k.id,ie),V&&(M.push(k.newGeometry),ie.geometry=k.newGeometry),Z){if(ie.properties=k.removeAllProperties?{}:Object.assign({},ie.properties||{}),k.removeProperties)for(const ce of k.removeProperties)delete ie.properties[ce];if(k.addOrUpdateProperties)for(const{key:ce,value:_e}of k.addOrUpdateProperties)ie.properties[ce]=_e}}return M},s.a9=q_,s.aA=function(p,{uSize:l,uSizeT:h},{lowerSize:v,upperSize:S}){return p.kind==="source"?v/qd:p.kind==="composite"?Hn.number(v/qd,S/qd,h):l},s.aB=function(p,l){var h=l[0],v=l[1],S=l[2],M=l[3],k=l[4],B=l[5],V=l[6],Z=l[7],ie=l[8],ce=l[9],_e=l[10],Se=l[11],Le=l[12],ze=l[13],Ve=l[14],et=l[15],Ct=h*B-v*k,rt=h*V-S*k,ut=h*Z-M*k,kt=v*V-S*B,Ft=v*Z-M*B,hr=S*Z-M*V,Or=ie*ze-ce*Le,Pr=ie*Ve-_e*Le,Vr=ie*et-Se*Le,dn=ce*Ve-_e*ze,Wr=ce*et-Se*ze,kr=_e*et-Se*Ve,Er=Ct*kr-rt*Wr+ut*dn+kt*Vr-Ft*Pr+hr*Or;return Er?(p[0]=(B*kr-V*Wr+Z*dn)*(Er=1/Er),p[1]=(S*Wr-v*kr-M*dn)*Er,p[2]=(ze*hr-Ve*Ft+et*kt)*Er,p[3]=(_e*Ft-ce*hr-Se*kt)*Er,p[4]=(V*Vr-k*kr-Z*Pr)*Er,p[5]=(h*kr-S*Vr+M*Pr)*Er,p[6]=(Ve*ut-Le*hr-et*rt)*Er,p[7]=(ie*hr-_e*ut+Se*rt)*Er,p[8]=(k*Wr-B*Vr+Z*Or)*Er,p[9]=(v*Vr-h*Wr-M*Or)*Er,p[10]=(Le*Ft-ze*ut+et*Ct)*Er,p[11]=(ce*ut-ie*Ft-Se*Ct)*Er,p[12]=(B*Pr-k*dn-V*Or)*Er,p[13]=(h*dn-v*Pr+S*Or)*Er,p[14]=(ze*rt-Le*kt-Ve*Ct)*Er,p[15]=(ie*kt-ce*rt+_e*Ct)*Er,p):null},s.aC=De,s.aD=function(p){var l=p[0],h=p[1];return Math.sqrt(l*l+h*h)},s.aE=function(p){return p[0]=0,p[1]=0,p},s.aF=function(p,l,h){return p[0]=l[0]*h,p[1]=l[1]*h,p},s.aG=SC,s.aH=se,s.aI=function(p,l,h,v){const S=l.y-p.y,M=l.x-p.x,k=v.y-h.y,B=v.x-h.x,V=k*M-B*S;if(V===0)return null;const Z=(B*(p.y-h.y)-k*(p.x-h.x))/V;return new c(p.x+Z*M,p.y+Z*S)},s.aJ=oB,s.aK=Uy,s.aL=function(p){let l=1/0,h=1/0,v=-1/0,S=-1/0;for(const M of p)l=Math.min(l,M.x),h=Math.min(h,M.y),v=Math.max(v,M.x),S=Math.max(S,M.y);return[l,h,v,S]},s.aM=ml,s.aN=Te,s.aO=function(p,l,h,v,S=!1){if(!h[0]&&!h[1])return[0,0];const M=S?v==="map"?-p.bearingInRadians:0:v==="viewport"?p.bearingInRadians:0;if(M){const k=Math.sin(M),B=Math.cos(M);h=[h[0]*B-h[1]*k,h[0]*k+h[1]*B]}return[S?h[0]:Te(l,h[0],p.zoom),S?h[1]:Te(l,h[1],p.zoom)]},s.aQ=wC,s.aR=WC,s.aS=xC,s.aT=XC,s.aU=pa,s.aV=d2,s.aW=ht,s.aX=pn,s.aY=xr,s.aZ=Qt,s.a_=wF,s.aa=nm,s.ab=25,s.ac=IC,s.ad=p=>{const l=window.document.createElement("video");return l.muted=!0,new Promise((h=>{l.onloadstart=()=>{h(l)};for(const v of p){const S=window.document.createElement("source");qt(v)||(l.crossOrigin="Anonymous"),S.src=v,l.appendChild(S)}}))},s.ae=Ut,s.af=function(){return ot++},s.ag=C,s.ah=Yy,s.ai=W_,s.aj=nh,s.ak=Kh,s.al=AF,s.am=function(p){const l={};if(p.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((h,v,S,M)=>{const k=S||M;return l[v]=!k||k.toLowerCase(),""})),l["max-age"]){const h=parseInt(l["max-age"],10);isNaN(h)?delete l["max-age"]:l["max-age"]=h}return l},s.an=Fe,s.ao=85.051129,s.ap=Tr,s.aq=function(p){return Math.pow(2,p)},s.ar=U,s.as=bF,s.at=function(p){return Math.log(p)/Math.LN2},s.au=function(p){var l=p[0],h=p[1];return l*l+h*h},s.av=function(p){if(!p.length)return new Set;const l=Math.max(...p.map((V=>V.canonical.z)));let h=1/0,v=-1/0,S=1/0,M=-1/0;const k=[];for(const V of p){const{x:Z,y:ie,z:ce}=V.canonical,_e=Math.pow(2,l-ce),Se=Z*_e,Le=ie*_e;k.push({id:V,x:Se,y:Le}),Se<h&&(h=Se),Se>v&&(v=Se),Le<S&&(S=Le),Le>M&&(M=Le)}const B=new Set;for(const V of k)V.x!==h&&V.x!==v&&V.y!==S&&V.y!==M||B.add(V.id);return B},s.aw=function(p,l){const h=Math.abs(2*p.wrap)-+(p.wrap<0),v=Math.abs(2*l.wrap)-+(l.wrap<0);return p.overscaledZ-l.overscaledZ||v-h||l.canonical.y-p.canonical.y||l.canonical.x-p.canonical.x},s.ax=class{constructor(p,l){this.max=p,this.onRemove=l,this.reset()}reset(){for(const p in this.data)for(const l of this.data[p])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(p,l,h){const v=p.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const S={value:l,timeout:void 0};if(h!==void 0&&(S.timeout=setTimeout((()=>{this.remove(p,S)}),h)),this.data[v].push(S),this.order.push(v),this.order.length>this.max){const M=this._getAndRemoveByKey(this.order[0]);M&&this.onRemove(M)}return this}has(p){return p.wrapped().key in this.data}getAndRemove(p){return this.has(p)?this._getAndRemoveByKey(p.wrapped().key):null}_getAndRemoveByKey(p){const l=this.data[p].shift();return l.timeout&&clearTimeout(l.timeout),this.data[p].length===0&&delete this.data[p],this.order.splice(this.order.indexOf(p),1),l.value}getByKey(p){const l=this.data[p];return l?l[0].value:null}get(p){return this.has(p)?this.data[p.wrapped().key][0].value:null}remove(p,l){if(!this.has(p))return this;const h=p.wrapped().key,v=l===void 0?0:this.data[h].indexOf(l),S=this.data[h][v];return this.data[h].splice(v,1),S.timeout&&clearTimeout(S.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(S.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(p){for(this.max=p;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(p){const l=[];for(const h in this.data)for(const v of this.data[h])p(v.value)||l.push(v);for(const h of l)this.remove(h.value.tileID,h)}},s.ay=function(p,l){let h=0,v=0;if(p.kind==="constant")v=p.layoutSize;else if(p.kind!=="source"){const{interpolationType:S,minZoom:M,maxZoom:k}=p,B=S?Fe(Un.interpolationFactor(S,l,M,k),0,1):0;p.kind==="camera"?v=Hn.number(p.minSize,p.maxSize,B):h=B}return{uSizeT:h,uSize:v}},s.b=pr,s.b$=Vd,s.b0=X,s.b1=function(p){var l=new N(3);return l[0]=p[0],l[1]=p[1],l[2]=p[2],l},s.b2=function(p,l,h){return p[0]=l[0]-h[0],p[1]=l[1]-h[1],p[2]=l[2]-h[2],p},s.b3=function(p,l){var h=l[0],v=l[1],S=l[2],M=h*h+v*v+S*S;return M>0&&(M=1/Math.sqrt(M)),p[0]=l[0]*M,p[1]=l[1]*M,p[2]=l[2]*M,p},s.b4=ee,s.b5=function(p,l){return p[0]*l[0]+p[1]*l[1]+p[2]*l[2]},s.b6=function(p,l,h){return p[0]=l[0]*h[0],p[1]=l[1]*h[1],p[2]=l[2]*h[2],p[3]=l[3]*h[3],p},s.b7=H,s.b8=function(p,l,h){const v=l[0]*h[0]+l[1]*h[1]+l[2]*h[2];return v===0?null:(-(p[0]*h[0]+p[1]*h[1]+p[2]*h[2])-h[3])/v},s.b9=ae,s.bA=function(p,l,h,v){return p[0]=l[0]+h[0]*v,p[1]=l[1]+h[1]*v,p[2]=l[2]+h[2]*v,p},s.bB=pe,s.bC=function(p,l,h){var v=h[0],S=h[1],M=h[2],k=h[3],B=l[0],V=l[1],Z=l[2],ie=S*Z-M*V,ce=M*B-v*Z,_e=v*V-S*B;return p[0]=B+k*(ie+=ie)+S*(_e+=_e)-M*(ce+=ce),p[1]=V+k*ce+M*ie-v*_e,p[2]=Z+k*_e+v*ce-S*ie,p},s.bD=function(p,l,h){const v=(function(V){var Z=V[3],ie=V[4],ce=V[5],_e=V[6],Se=V[7],Le=V[8];return V[0]*(Le*ie-ce*Se)+V[1]*(-Le*Z+ce*_e)+V[2]*(Se*Z-ie*_e)})([p[0],p[1],p[2],l[0],l[1],l[2],h[0],h[1],h[2]]);if(v===0)return null;const S=ee([],[l[0],l[1],l[2]],[h[0],h[1],h[2]]),M=ee([],[h[0],h[1],h[2]],[p[0],p[1],p[2]]),k=ee([],[p[0],p[1],p[2]],[l[0],l[1],l[2]]),B=oe([],S,-p[3]);return X(B,B,oe([],M,-l[3])),X(B,B,oe([],k,-h[3])),oe(B,B,1/v),B},s.bE=AC,s.bF=function(){return new Float64Array(4)},s.bG=function(p,l,h,v){var S=[],M=[];return S[0]=l[0]-h[0],S[1]=l[1]-h[1],S[2]=l[2]-h[2],M[0]=S[0]*Math.cos(v)-S[1]*Math.sin(v),M[1]=S[0]*Math.sin(v)+S[1]*Math.cos(v),M[2]=S[2],p[0]=M[0]+h[0],p[1]=M[1]+h[1],p[2]=M[2]+h[2],p},s.bH=function(p,l,h,v){var S=[],M=[];return S[0]=l[0]-h[0],S[1]=l[1]-h[1],S[2]=l[2]-h[2],M[0]=S[0],M[1]=S[1]*Math.cos(v)-S[2]*Math.sin(v),M[2]=S[1]*Math.sin(v)+S[2]*Math.cos(v),p[0]=M[0]+h[0],p[1]=M[1]+h[1],p[2]=M[2]+h[2],p},s.bI=function(p,l,h,v){var S=[],M=[];return S[0]=l[0]-h[0],S[1]=l[1]-h[1],S[2]=l[2]-h[2],M[0]=S[2]*Math.sin(v)+S[0]*Math.cos(v),M[1]=S[1],M[2]=S[2]*Math.cos(v)-S[0]*Math.sin(v),p[0]=M[0]+h[0],p[1]=M[1]+h[1],p[2]=M[2]+h[2],p},s.bJ=function(p,l,h){var v=Math.sin(h),S=Math.cos(h),M=l[0],k=l[1],B=l[2],V=l[3],Z=l[8],ie=l[9],ce=l[10],_e=l[11];return l!==p&&(p[4]=l[4],p[5]=l[5],p[6]=l[6],p[7]=l[7],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15]),p[0]=M*S-Z*v,p[1]=k*S-ie*v,p[2]=B*S-ce*v,p[3]=V*S-_e*v,p[8]=M*v+Z*S,p[9]=k*v+ie*S,p[10]=B*v+ce*S,p[11]=V*v+_e*S,p},s.bK=function(p,l){const h=Re(p,360),v=Re(l,360),S=v-h,M=v>h?S-360:S+360;return Math.abs(S)<Math.abs(M)?S:M},s.bL=function(p){return p[0]=0,p[1]=0,p[2]=0,p},s.bM=function(p,l,h,v){const S=Math.sqrt(p*p+l*l),M=Math.sqrt(h*h+v*v);p/=S,l/=S,h/=M,v/=M;const k=Math.acos(p*h+l*v);return-l*h+p*v>0?k:-k},s.bN=function(p,l){const h=Re(p,2*Math.PI),v=Re(l,2*Math.PI);return Math.min(Math.abs(h-v),Math.abs(h-v+2*Math.PI),Math.abs(h-v-2*Math.PI))},s.bO=function(){const p={},l=Rt.$version;for(const h in Rt.$root){const v=Rt.$root[h];if(v.required){let S=null;S=h==="version"?l:v.type==="array"?[]:{},S!=null&&(p[h]=S)}}return p},s.bP=ct,s.bQ=on,s.bR=function p(l,h){if(Array.isArray(l)){if(!Array.isArray(h)||l.length!==h.length)return!1;for(let v=0;v<l.length;v++)if(!p(l[v],h[v]))return!1;return!0}if(typeof l=="object"&&l!==null&&h!==null){if(typeof h!="object"||Object.keys(l).length!==Object.keys(h).length)return!1;for(const v in l)if(!p(l[v],h[v]))return!1;return!0}return l===h},s.bS=function(p){p=p.slice();const l=Object.create(null);for(let h=0;h<p.length;h++)l[p[h].id]=p[h];for(let h=0;h<p.length;h++)"ref"in p[h]&&(p[h]=jn(p[h],l[p[h].ref]));return p},s.bT=function(p,l){if(p.type==="custom")return new Nae(p,l);switch(p.type){case"background":return new Lae(p,l);case"circle":return new _ie(p,l);case"color-relief":return new Tie(p,l);case"fill":return new jie(p,l);case"fill-extrusion":return new Jie(p,l);case"heatmap":return new xie(p,l);case"hillshade":return new Sie(p,l);case"line":return new aae(p,l);case"raster":return new Zl(p,l);case"symbol":return new v2(p,l)}},s.bU=p=>p.type==="raster",s.bV=Me,s.bW=function(p,l){if(!p)return[{command:"setStyle",args:[l]}];let h=[];try{if(!Qr(p.version,l.version))return[{command:"setStyle",args:[l]}];Qr(p.center,l.center)||h.push({command:"setCenter",args:[l.center]}),Qr(p.state,l.state)||h.push({command:"setGlobalState",args:[l.state]}),Qr(p.centerAltitude,l.centerAltitude)||h.push({command:"setCenterAltitude",args:[l.centerAltitude]}),Qr(p.zoom,l.zoom)||h.push({command:"setZoom",args:[l.zoom]}),Qr(p.bearing,l.bearing)||h.push({command:"setBearing",args:[l.bearing]}),Qr(p.pitch,l.pitch)||h.push({command:"setPitch",args:[l.pitch]}),Qr(p.roll,l.roll)||h.push({command:"setRoll",args:[l.roll]}),Qr(p.sprite,l.sprite)||h.push({command:"setSprite",args:[l.sprite]}),Qr(p.glyphs,l.glyphs)||h.push({command:"setGlyphs",args:[l.glyphs]}),Qr(p.transition,l.transition)||h.push({command:"setTransition",args:[l.transition]}),Qr(p.light,l.light)||h.push({command:"setLight",args:[l.light]}),Qr(p.terrain,l.terrain)||h.push({command:"setTerrain",args:[l.terrain]}),Qr(p.sky,l.sky)||h.push({command:"setSky",args:[l.sky]}),Qr(p.projection,l.projection)||h.push({command:"setProjection",args:[l.projection]});const v={},S=[];(function(k,B,V,Z){let ie;for(ie in B=B||{},k=k||{})Object.prototype.hasOwnProperty.call(k,ie)&&(Object.prototype.hasOwnProperty.call(B,ie)||ln(ie,V,Z));for(ie in B)Object.prototype.hasOwnProperty.call(B,ie)&&(Object.prototype.hasOwnProperty.call(k,ie)?Qr(k[ie],B[ie])||(k[ie].type==="geojson"&&B[ie].type==="geojson"&&ke(k,B,ie)?nr(V,{command:"setGeoJSONSourceData",args:[ie,B[ie].data]}):Kn(ie,B,V,Z)):oi(ie,B,V))})(p.sources,l.sources,S,v);const M=[];p.layers&&p.layers.forEach((k=>{"source"in k&&v[k.source]?h.push({command:"removeLayer",args:[k.id]}):M.push(k)})),h=h.concat(S),(function(k,B,V){B=B||[];const Z=(k=k||[]).map(Tt),ie=B.map(Tt),ce=k.reduce(Gt,{}),_e=B.reduce(Gt,{}),Se=Z.slice(),Le=Object.create(null);let ze,Ve,et,Ct,rt;for(let ut=0,kt=0;ut<Z.length;ut++)ze=Z[ut],Object.prototype.hasOwnProperty.call(_e,ze)?kt++:(nr(V,{command:"removeLayer",args:[ze]}),Se.splice(Se.indexOf(ze,kt),1));for(let ut=0,kt=0;ut<ie.length;ut++)ze=ie[ie.length-1-ut],Se[Se.length-1-ut]!==ze&&(Object.prototype.hasOwnProperty.call(ce,ze)?(nr(V,{command:"removeLayer",args:[ze]}),Se.splice(Se.lastIndexOf(ze,Se.length-kt),1)):kt++,Ct=Se[Se.length-ut],nr(V,{command:"addLayer",args:[_e[ze],Ct]}),Se.splice(Se.length-ut,0,ze),Le[ze]=!0);for(let ut=0;ut<ie.length;ut++)if(ze=ie[ut],Ve=ce[ze],et=_e[ze],!Le[ze]&&!Qr(Ve,et))if(Qr(Ve.source,et.source)&&Qr(Ve["source-layer"],et["source-layer"])&&Qr(Ve.type,et.type)){for(rt in He(Ve.layout,et.layout,V,ze,null,"setLayoutProperty"),He(Ve.paint,et.paint,V,ze,null,"setPaintProperty"),Qr(Ve.filter,et.filter)||nr(V,{command:"setFilter",args:[ze,et.filter]}),Qr(Ve.minzoom,et.minzoom)&&Qr(Ve.maxzoom,et.maxzoom)||nr(V,{command:"setLayerZoomRange",args:[ze,et.minzoom,et.maxzoom]}),Ve)Object.prototype.hasOwnProperty.call(Ve,rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&(rt.indexOf("paint.")===0?He(Ve[rt],et[rt],V,ze,rt.slice(6),"setPaintProperty"):Qr(Ve[rt],et[rt])||nr(V,{command:"setLayerProperty",args:[ze,rt,et[rt]]}));for(rt in et)Object.prototype.hasOwnProperty.call(et,rt)&&!Object.prototype.hasOwnProperty.call(Ve,rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&(rt.indexOf("paint.")===0?He(Ve[rt],et[rt],V,ze,rt.slice(6),"setPaintProperty"):Qr(Ve[rt],et[rt])||nr(V,{command:"setLayerProperty",args:[ze,rt,et[rt]]}))}else nr(V,{command:"removeLayer",args:[ze]}),Ct=Se[Se.lastIndexOf(ze)+1],nr(V,{command:"addLayer",args:[et,Ct]})})(M,l.layers,h)}catch(v){console.warn("Unable to compute style diff:",v),h=[{command:"setStyle",args:[l]}]}return h},s.bX=function(p){const l=[],h=p.id;return h===void 0&&l.push({message:`layers.${h}: missing required property "id"`}),p.render===void 0&&l.push({message:`layers.${h}: missing required method "render"`}),p.renderingMode&&p.renderingMode!=="2d"&&p.renderingMode!=="3d"&&l.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),l},s.bY=Ke,s.bZ=it,s.b_=class extends zu{constructor(p,l){super(p,l),this.current=0}set(p){this.current!==p&&(this.current=p,this.gl.uniform1i(this.location,p))}},s.ba=function(p,l,h){return p[0]=l[0]*h,p[1]=l[1]*h,p[2]=l[2]*h,p[3]=l[3]*h,p},s.bb=function(p,l){return p[0]*l[0]+p[1]*l[1]+p[2]*l[2]+p[3]},s.bc=EF,s.bd=Zy,s.be=function(p,l,h,v,S){var M=1/Math.tan(l/2);if(p[0]=M/h,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=M,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=-1,p[12]=0,p[13]=0,p[15]=0,S!=null&&S!==1/0){var k=1/(v-S);p[10]=(S+v)*k,p[14]=2*S*v*k}else p[10]=-1,p[14]=-2*v;return p},s.bf=function(p){var l=new N(16);return l[0]=p[0],l[1]=p[1],l[2]=p[2],l[3]=p[3],l[4]=p[4],l[5]=p[5],l[6]=p[6],l[7]=p[7],l[8]=p[8],l[9]=p[9],l[10]=p[10],l[11]=p[11],l[12]=p[12],l[13]=p[13],l[14]=p[14],l[15]=p[15],l},s.bg=function(p,l,h){var v=Math.sin(h),S=Math.cos(h),M=l[0],k=l[1],B=l[2],V=l[3],Z=l[4],ie=l[5],ce=l[6],_e=l[7];return l!==p&&(p[8]=l[8],p[9]=l[9],p[10]=l[10],p[11]=l[11],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15]),p[0]=M*S+Z*v,p[1]=k*S+ie*v,p[2]=B*S+ce*v,p[3]=V*S+_e*v,p[4]=Z*S-M*v,p[5]=ie*S-k*v,p[6]=ce*S-B*v,p[7]=_e*S-V*v,p},s.bh=function(p,l,h){var v=Math.sin(h),S=Math.cos(h),M=l[4],k=l[5],B=l[6],V=l[7],Z=l[8],ie=l[9],ce=l[10],_e=l[11];return l!==p&&(p[0]=l[0],p[1]=l[1],p[2]=l[2],p[3]=l[3],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15]),p[4]=M*S+Z*v,p[5]=k*S+ie*v,p[6]=B*S+ce*v,p[7]=V*S+_e*v,p[8]=Z*S-M*v,p[9]=ie*S-k*v,p[10]=ce*S-B*v,p[11]=_e*S-V*v,p},s.bi=function(){const p=new Float32Array(16);return U(p),p},s.bj=function(){const p=new Float64Array(16);return U(p),p},s.bk=function(){return new Float64Array(16)},s.bl=function(p,l,h){const v=new Float64Array(4);return pe(v,p,l-90,h),v},s.bm=function(p,l,h,v){var S,M,k,B,V,Z=l[0],ie=l[1],ce=l[2],_e=l[3],Se=h[0],Le=h[1],ze=h[2],Ve=h[3];return(M=Z*Se+ie*Le+ce*ze+_e*Ve)<0&&(M=-M,Se=-Se,Le=-Le,ze=-ze,Ve=-Ve),1-M>F?(S=Math.acos(M),k=Math.sin(S),B=Math.sin((1-v)*S)/k,V=Math.sin(v*S)/k):(B=1-v,V=v),p[0]=B*Z+V*Se,p[1]=B*ie+V*Le,p[2]=B*ce+V*ze,p[3]=B*_e+V*Ve,p},s.bn=function(p){const l=new Float64Array(9);(function(M,k){var B=k[0],V=k[1],Z=k[2],ie=k[3],ce=B+B,_e=V+V,Se=Z+Z,Le=B*ce,ze=V*ce,Ve=V*_e,et=Z*ce,Ct=Z*_e,rt=Z*Se,ut=ie*ce,kt=ie*_e,Ft=ie*Se;M[0]=1-Ve-rt,M[3]=ze-Ft,M[6]=et+kt,M[1]=ze+Ft,M[4]=1-Le-rt,M[7]=Ct-ut,M[2]=et-kt,M[5]=Ct+ut,M[8]=1-Le-Ve})(l,p);const h=Qt(-Math.asin(Fe(l[2],-1,1)));let v,S;return Math.hypot(l[5],l[8])<.001?(v=0,S=-Qt(Math.atan2(l[3],l[4]))):(v=Qt(l[5]===0&&l[8]===0?0:Math.atan2(l[5],l[8])),S=Qt(l[1]===0&&l[0]===0?0:Math.atan2(l[1],l[0]))),{roll:v,pitch:h+90,bearing:S}},s.bo=function(p,l){return p.roll==l.roll&&p.pitch==l.pitch&&p.bearing==l.bearing},s.bp=Mr,s.bq=Ud,s.br=Gy,s.bs=B_,s.bt=Hy,s.bu=de,s.bv=Ee,s.bw=hi,s.bx=function(p,l,h,v,S){return de(v,S,Fe((p-l)/(h-l),0,1))},s.by=Re,s.bz=function(){return new Float64Array(3)},s.c=Ge,s.c$=function(p,l,h,v,S){return o(this,void 0,void 0,(function*(){if(R())try{return yield vr(p,l,h,v,S)}catch{}return(function(M,k,B,V,Z){const ie=M.width,ce=M.height;br&&lr||(br=new OffscreenCanvas(ie,ce),lr=br.getContext("2d",{willReadFrequently:!0})),br.width=ie,br.height=ce,lr.drawImage(M,0,0,ie,ce);const _e=lr.getImageData(k,B,V,Z);return lr.clearRect(0,0,ie,ce),_e.data})(p,l,h,v,S)}))},s.c0=class extends zu{constructor(p,l){super(p,l),this.current=Sc}set(p){if(p[12]!==this.current[12]||p[0]!==this.current[0])return this.current=p,void this.gl.uniformMatrix4fv(this.location,!1,p);for(let l=1;l<16;l++)if(p[l]!==this.current[l]){this.current=p,this.gl.uniformMatrix4fv(this.location,!1,p);break}}},s.c1=em,s.c2=class extends zu{constructor(p,l){super(p,l),this.current=[0,0,0]}set(p){p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]||(this.current=p,this.gl.uniform3f(this.location,p[0],p[1],p[2]))}},s.c3=class extends zu{constructor(p,l){super(p,l),this.current=[0,0]}set(p){p[0]===this.current[0]&&p[1]===this.current[1]||(this.current=p,this.gl.uniform2f(this.location,p[0],p[1]))}},s.c4=O,s.c5=function(p,l){var h=Math.sin(l),v=Math.cos(l);return p[0]=v,p[1]=h,p[2]=0,p[3]=-h,p[4]=v,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},s.c6=function(p,l,h){var v=l[0],S=l[1],M=l[2];return p[0]=v*h[0]+S*h[3]+M*h[6],p[1]=v*h[1]+S*h[4]+M*h[7],p[2]=v*h[2]+S*h[5]+M*h[8],p},s.c7=function(p,l,h,v,S,M,k){var B=1/(l-h),V=1/(v-S),Z=1/(M-k);return p[0]=-2*B,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=-2*V,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=2*Z,p[11]=0,p[12]=(l+h)*B,p[13]=(S+v)*V,p[14]=(k+M)*Z,p[15]=1,p},s.c8=class extends zu{constructor(p,l){super(p,l),this.current=new Array}set(p){if(p!=this.current){this.current=p;const l=new Float32Array(4*p.length);for(let h=0;h<p.length;h++)l[4*h]=p[h].r,l[4*h+1]=p[h].g,l[4*h+2]=p[h].b,l[4*h+3]=p[h].a;this.gl.uniform4fv(this.location,l)}}},s.c9=class extends zu{constructor(p,l){super(p,l),this.current=new Array}set(p){if(p!=this.current){this.current=p;const l=new Float32Array(p);this.gl.uniform1fv(this.location,l)}}},s.cA=function(p,l){return at[l]&&"touches"in p},s.cB=function(p){return at[p]||Pe[p]},s.cC=function(p,l,h){var v=l[0],S=l[1];return p[0]=h[0]*v+h[4]*S+h[12],p[1]=h[1]*v+h[5]*S+h[13],p},s.cD=function(p,l){const{x:h,y:v}=q_.fromLngLat(l);return!(p<0||p>25||v<0||v>=1||h<0||h>=1)},s.cE=function(p,l){return p[0]=l[0],p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=l[1],p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=l[2],p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},s.cF=class extends as{},s.cG=woe,s.cI=mt,s.cJ=function(p,l){Ge.REGISTERED_PROTOCOLS[p]=l},s.cK=function(p){delete Ge.REGISTERED_PROTOCOLS[p]},s.cL=function(p,l){const h={};for(let S=0;S<p.length;S++){const M=l&&l[p[S].id]||$c(p[S]);l&&(l[p[S].id]=M);let k=h[M];k||(k=h[M]=[]),k.push(p[S])}const v=[];for(const S in h)v.push(h[S]);return v},s.cM=Pt,s.cN=CF,s.cO=iB,s.cP=sF,s.cQ=function(p){p.bucket.createArrays(),p.bucket.tilePixelRatio=we/(512*p.bucket.overscaling),p.bucket.compareText={},p.bucket.iconsNeedLinear=!1;const l=p.bucket.layers[0],h=l.layout,v=l._unevaluatedLayout._values,S={layoutIconSize:v["icon-size"].possiblyEvaluate(new Mi(p.bucket.zoom+1),p.canonical),layoutTextSize:v["text-size"].possiblyEvaluate(new Mi(p.bucket.zoom+1),p.canonical),textMaxSize:v["text-size"].possiblyEvaluate(new Mi(18))};if(p.bucket.textSizeData.kind==="composite"){const{minZoom:Z,maxZoom:ie}=p.bucket.textSizeData;S.compositeTextSizes=[v["text-size"].possiblyEvaluate(new Mi(Z),p.canonical),v["text-size"].possiblyEvaluate(new Mi(ie),p.canonical)]}if(p.bucket.iconSizeData.kind==="composite"){const{minZoom:Z,maxZoom:ie}=p.bucket.iconSizeData;S.compositeIconSizes=[v["icon-size"].possiblyEvaluate(new Mi(Z),p.canonical),v["icon-size"].possiblyEvaluate(new Mi(ie),p.canonical)]}const M=h.get("text-line-height")*ml,k=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",B=h.get("text-keep-upright"),V=h.get("text-size");for(const Z of p.bucket.features){const ie=h.get("text-font").evaluate(Z,{},p.canonical).join(","),ce=V.evaluate(Z,{},p.canonical),_e=S.layoutTextSize.evaluate(Z,{},p.canonical),Se=S.layoutIconSize.evaluate(Z,{},p.canonical),Le={horizontal:{},vertical:void 0},ze=Z.text;let Ve,et=[0,0];if(ze){const ut=ze.toString(),kt=h.get("text-letter-spacing").evaluate(Z,{},p.canonical)*ml,Ft=Zn(ut)?kt:0,hr=h.get("text-anchor").evaluate(Z,{},p.canonical),Or=yB(l,Z,p.canonical);if(!Or){const Wr=h.get("text-radial-offset").evaluate(Z,{},p.canonical);et=Wr?mB(hr,[Wr*ml,GC]):h.get("text-offset").evaluate(Z,{},p.canonical).map((kr=>kr*ml))}let Pr=k?"center":h.get("text-justify").evaluate(Z,{},p.canonical);const Vr=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate(Z,{},p.canonical)*ml:1/0,dn=()=>{p.bucket.allowVerticalPlacement&&Ai(ut)&&(Le.vertical=m2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,M,hr,"left",Ft,et,s.az.vertical,!0,_e,ce))};if(!k&&Or){const Wr=new Set;if(Pr==="auto")for(let Er=0;Er<Or.values.length;Er+=2)Wr.add(WC(Or.values[Er]));else Wr.add(Pr);let kr=!1;for(const Er of Wr)if(!Le.horizontal[Er])if(kr)Le.horizontal[Er]=Le.horizontal[0];else{const Cn=m2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,M,"center",Er,Ft,et,s.az.horizontal,!1,_e,ce);Cn&&(Le.horizontal[Er]=Cn,kr=Cn.positionedLines.length===1)}dn()}else{Pr==="auto"&&(Pr=WC(hr));const Wr=m2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,M,hr,Pr,Ft,et,s.az.horizontal,!1,_e,ce);Wr&&(Le.horizontal[Pr]=Wr),dn(),Ai(ut)&&k&&B&&(Le.vertical=m2(ze,p.glyphMap,p.glyphPositions,p.imagePositions,ie,Vr,M,hr,Pr,Ft,et,s.az.vertical,!1,_e,ce))}}let Ct=!1;if(Z.icon&&Z.icon.name){const ut=p.imageMap[Z.icon.name];ut&&(Ve=kae(p.imagePositions[Z.icon.name],h.get("icon-offset").evaluate(Z,{},p.canonical),h.get("icon-anchor").evaluate(Z,{},p.canonical)),Ct=!!ut.sdf,p.bucket.sdfIcons===void 0?p.bucket.sdfIcons=Ct:p.bucket.sdfIcons!==Ct&&st("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ut.pixelRatio!==p.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(p.bucket.iconsNeedLinear=!0))}const rt=_B(Le.horizontal)||Le.vertical;p.bucket.iconsInText=!!rt&&rt.iconsInText,(rt||Ve)&&boe(p.bucket,Z,Le,Ve,p.imageMap,S,_e,Se,et,Ct,p.canonical,p.subdivisionGranularity)}p.showCollisionBoxes&&p.bucket.generateCollisionDebugBuffers()},s.cR=gC,s.cS=yC,s.cT=vC,s.cU=function(p){const l=new g2;return(function(h,v){for(const S in h.layers)v.writeMessage(3,ooe,h.layers[S])})(p,l),l.finish()},s.cV=function(p,l,h,v,S,M){let k=sB(p,l,h,S,0);return k=sB(k,l,v,M,1),k},s.cW=class{constructor(p){this.maxEntries=p,this.map=new Map}get(p){const l=this.map.get(p);return l!==void 0&&(this.map.delete(p),this.map.set(p,l)),l}set(p,l){if(this.map.has(p))this.map.delete(p);else if(this.map.size>=this.maxEntries){const h=this.map.keys().next().value;this.map.delete(h)}this.map.set(p,l)}clear(){this.map.clear()}},s.cX=$6,s.cY=g2,s.cZ=rB,s.c_=class{constructor(p){this._marks={start:[p.url,"start"].join("#"),end:[p.url,"end"].join("#"),measure:p.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let p=performance.getEntriesByName(this._marks.measure);return p.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),p=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),p}},s.ca=class extends xf{},s.cb=uae,s.cc=class extends Hh{},s.cd=cC,s.ce=function(p){return p<=1?1:Math.pow(2,Math.ceil(Math.log(p)/Math.LN2))},s.cf=I6,s.cg=function(p,l,h){var v=l[0],S=l[1],M=l[2],k=h[3]*v+h[7]*S+h[11]*M+h[15];return p[0]=(h[0]*v+h[4]*S+h[8]*M+h[12])/(k=k||1),p[1]=(h[1]*v+h[5]*S+h[9]*M+h[13])/k,p[2]=(h[2]*v+h[6]*S+h[10]*M+h[14])/k,p},s.ch=class extends jh{},s.ci=class extends u{},s.cj=function(p,l){return p[0]===l[0]&&p[1]===l[1]&&p[2]===l[2]&&p[3]===l[3]&&p[4]===l[4]&&p[5]===l[5]&&p[6]===l[6]&&p[7]===l[7]&&p[8]===l[8]&&p[9]===l[9]&&p[10]===l[10]&&p[11]===l[11]&&p[12]===l[12]&&p[13]===l[13]&&p[14]===l[14]&&p[15]===l[15]},s.ck=function(p,l){var h=p[0],v=p[1],S=p[2],M=p[3],k=p[4],B=p[5],V=p[6],Z=p[7],ie=p[8],ce=p[9],_e=p[10],Se=p[11],Le=p[12],ze=p[13],Ve=p[14],et=p[15],Ct=l[0],rt=l[1],ut=l[2],kt=l[3],Ft=l[4],hr=l[5],Or=l[6],Pr=l[7],Vr=l[8],dn=l[9],Wr=l[10],kr=l[11],Er=l[12],Cn=l[13],xn=l[14],Mn=l[15];return Math.abs(h-Ct)<=F*Math.max(1,Math.abs(h),Math.abs(Ct))&&Math.abs(v-rt)<=F*Math.max(1,Math.abs(v),Math.abs(rt))&&Math.abs(S-ut)<=F*Math.max(1,Math.abs(S),Math.abs(ut))&&Math.abs(M-kt)<=F*Math.max(1,Math.abs(M),Math.abs(kt))&&Math.abs(k-Ft)<=F*Math.max(1,Math.abs(k),Math.abs(Ft))&&Math.abs(B-hr)<=F*Math.max(1,Math.abs(B),Math.abs(hr))&&Math.abs(V-Or)<=F*Math.max(1,Math.abs(V),Math.abs(Or))&&Math.abs(Z-Pr)<=F*Math.max(1,Math.abs(Z),Math.abs(Pr))&&Math.abs(ie-Vr)<=F*Math.max(1,Math.abs(ie),Math.abs(Vr))&&Math.abs(ce-dn)<=F*Math.max(1,Math.abs(ce),Math.abs(dn))&&Math.abs(_e-Wr)<=F*Math.max(1,Math.abs(_e),Math.abs(Wr))&&Math.abs(Se-kr)<=F*Math.max(1,Math.abs(Se),Math.abs(kr))&&Math.abs(Le-Er)<=F*Math.max(1,Math.abs(Le),Math.abs(Er))&&Math.abs(ze-Cn)<=F*Math.max(1,Math.abs(ze),Math.abs(Cn))&&Math.abs(Ve-xn)<=F*Math.max(1,Math.abs(Ve),Math.abs(xn))&&Math.abs(et-Mn)<=F*Math.max(1,Math.abs(et),Math.abs(Mn))},s.cl=function(p,l){return p[0]=l[0],p[1]=l[1],p[2]=l[2],p[3]=l[3],p[4]=l[4],p[5]=l[5],p[6]=l[6],p[7]=l[7],p[8]=l[8],p[9]=l[9],p[10]=l[10],p[11]=l[11],p[12]=l[12],p[13]=l[13],p[14]=l[14],p[15]=l[15],p},s.cm=p=>p.type==="symbol",s.cn=p=>p.type==="circle",s.co=p=>p.type==="heatmap",s.cp=p=>p.type==="line",s.cq=p=>p.type==="fill",s.cr=p=>p.type==="fill-extrusion",s.cs=p=>p.type==="hillshade",s.ct=p=>p.type==="color-relief",s.cu=p=>p.type==="background",s.cv=p=>p.type==="custom",s.cw=xe,s.cx=function(p,l,h){const v=ye(l.x-h.x,l.y-h.y),S=ye(p.x-h.x,p.y-h.y),M=Math.atan2(v[0]*S[1]-v[1]*S[0],(function(k,B){return k[0]*B[0]+k[1]*B[1]})(v,S));return Qt(M)},s.cy=Ne,s.cz=function(p,l){return Pe[l]&&(p instanceof MouseEvent||p instanceof WheelEvent)},s.d=qt,s.d0=k6,s.d1=f,s.d2=class{constructor(p,l){this.layers={[W_]:this},this.name=W_,this.version=l?l.version:1,this.extent=l?l.extent:4096,this.length=p.length,this.features=p}feature(p){return new aoe(this.features[p],this.extent)}},s.d3=th,s.d4=da,s.e=Be,s.f=p=>o(void 0,void 0,void 0,(function*(){if(p.byteLength===0)return createImageBitmap(new ImageData(1,1));const l=new Blob([new Uint8Array(p)],{type:"image/png"});try{return createImageBitmap(l)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),s.g=Nt,s.h=p=>new Promise(((l,h)=>{const v=new Image;v.onload=()=>{l(v),URL.revokeObjectURL(v.src),v.onload=null,window.requestAnimationFrame((()=>{v.src=_t}))},v.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const S=new Blob([new Uint8Array(p)],{type:"image/png"});v.src=p.byteLength?URL.createObjectURL(S):_t})),s.i=Jt,s.j=(p,l)=>Kt(Be(p,{type:"json"}),l),s.k=cn,s.l=$r,s.m=Kt,s.n=(p,l)=>Kt(Be(p,{type:"arrayBuffer"}),l),s.o=function(p){return new g2(p).readFields(Sae,[])},s.p=oF,s.q=function(p){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(p))},s.r=D_,s.s=Cr,s.t=$a,s.u=Rt,s.v=Ye,s.w=st,s.x=Go,s.y=nt,s.z=Qa})),i("worker",["./shared"],(function(s){class o{constructor(Pe,be){this.keyCache={},Pe&&this.replace(Pe,be)}replace(Pe,be){this._layerConfigs={},this._layers={},this.update(Pe,[],be)}update(Pe,be,je){for(const Ge of Pe){this._layerConfigs[Ge.id]=Ge;const Nt=this._layers[Ge.id]=s.bT(Ge,je);Nt._featureFilter=s.aj(Nt.filter,je),this.keyCache[Ge.id]&&delete this.keyCache[Ge.id]}for(const Ge of be)delete this.keyCache[Ge],delete this._layerConfigs[Ge],delete this._layers[Ge];this.familiesBySource={};const qe=s.cL(Object.values(this._layerConfigs),this.keyCache);for(const Ge of qe){const Nt=Ge.map((Ir=>this._layers[Ir.id])),Et=Nt[0];if(Et.isHidden())continue;const mt=Et.source||"";let ct=this.familiesBySource[mt];ct||(ct=this.familiesBySource[mt]={});const Kt=Et.sourceLayer||s.ai;let qt=ct[Kt];qt||(qt=ct[Kt]=[]),qt.push(Nt)}}}class c{constructor(Pe){const be={},je=[];for(const Et in Pe){const mt=Pe[Et],ct=be[Et]={};for(const Kt in mt){const qt=mt[+Kt];if(!qt||qt.bitmap.width===0||qt.bitmap.height===0)continue;const Ir={x:0,y:0,w:qt.bitmap.width+2,h:qt.bitmap.height+2};je.push(Ir),ct[Kt]={rect:Ir,metrics:qt.metrics}}}const{w:qe,h:Ge}=s.p(je),Nt=new s.r({width:qe||1,height:Ge||1});for(const Et in Pe){const mt=Pe[Et];for(const ct in mt){const Kt=mt[+ct];if(!Kt||Kt.bitmap.width===0||Kt.bitmap.height===0)continue;const qt=be[Et][ct].rect;s.r.copy(Kt.bitmap,Nt,{x:0,y:0},{x:qt.x+1,y:qt.y+1},Kt.bitmap)}}this.image=Nt,this.positions=be}}s.cM("GlyphAtlas",c);class f{constructor(Pe){this.tileID=new s.a2(Pe.tileID.overscaledZ,Pe.tileID.wrap,Pe.tileID.canonical.z,Pe.tileID.canonical.x,Pe.tileID.canonical.y),this.uid=Pe.uid,this.zoom=Pe.zoom,this.pixelRatio=Pe.pixelRatio,this.tileSize=Pe.tileSize,this.source=Pe.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Pe.showCollisionBoxes,this.collectResourceTiming=!!Pe.collectResourceTiming,this.returnDependencies=!!Pe.returnDependencies,this.promoteId=Pe.promoteId,this.inFlightDependencies=[]}parse(Pe,be,je,qe,Ge){return s._(this,void 0,void 0,(function*(){this.status="parsing",this.data=Pe,this.collisionBoxArray=new s.ag;const Nt=new s.cN(Object.keys(Pe.layers).sort()),Et=new s.cO(this.tileID,this.promoteId);Et.bucketLayerIDs=[];const mt={},ct={featureIndex:Et,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:je,subdivisionGranularity:Ge},Kt=be.familiesBySource[this.source];for(const ke in Kt){const He=Pe.layers[ke];if(!He)continue;He.version===1&&s.w(`Vector tile source "${this.source}" layer "${ke}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Tt=Nt.encode(ke),Gt=[];for(let Ut=0;Ut<He.length;Ut++){const Xr=He.feature(Ut),Ln=Et.getId(Xr,ke);Gt.push({feature:Xr,id:Ln,index:Ut,sourceLayerIndex:Tt})}for(const Ut of Kt[ke]){const Xr=Ut[0];Xr.source!==this.source&&s.w(`layer.source = ${Xr.source} does not equal this.source = ${this.source}`),Xr.isHidden(this.zoom,!0)||(d(Ut,this.zoom,je),(mt[Xr.id]=Xr.createBucket({index:Et.bucketLayerIDs.length,layers:Ut,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Tt,sourceID:this.source})).populate(Gt,ct,this.tileID.canonical),Et.bucketLayerIDs.push(Ut.map((Ln=>Ln.id))))}}const qt=s.bY(ct.glyphDependencies,(ke=>Object.keys(ke).map(Number)));this.inFlightDependencies.forEach((ke=>ke?.abort())),this.inFlightDependencies=[];let Ir=Promise.resolve({});if(Object.keys(qt).length){const ke=new AbortController;this.inFlightDependencies.push(ke),Ir=qe.sendAsync({type:"GG",data:{stacks:qt,source:this.source,tileID:this.tileID,type:"glyphs"}},ke)}const Ar=Object.keys(ct.iconDependencies);let $r=Promise.resolve({});if(Ar.length){const ke=new AbortController;this.inFlightDependencies.push(ke),$r=qe.sendAsync({type:"GI",data:{icons:Ar,source:this.source,tileID:this.tileID,type:"icons"}},ke)}const cn=Object.keys(ct.patternDependencies);let zr=Promise.resolve({});if(cn.length){const ke=new AbortController;this.inFlightDependencies.push(ke),zr=qe.sendAsync({type:"GI",data:{icons:cn,source:this.source,tileID:this.tileID,type:"patterns"}},ke)}const Rt=ct.dashDependencies;let en=Promise.resolve({});if(Object.keys(Rt).length){const ke=new AbortController;this.inFlightDependencies.push(ke),en=qe.sendAsync({type:"GDA",data:{dashes:Rt}},ke)}const[jn,Qr,nr,oi]=yield Promise.all([Ir,$r,zr,en]),ln=new c(jn),Kn=new s.cP(Qr,nr);for(const ke in mt){const He=mt[ke];He instanceof s.ah?(d(He.layers,this.zoom,je),s.cQ({bucket:He,glyphMap:jn,glyphPositions:ln.positions,imageMap:Qr,imagePositions:Kn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ct.subdivisionGranularity})):He.hasDependencies&&(He instanceof s.cR||He instanceof s.cS||He instanceof s.cT)&&(d(He.layers,this.zoom,je),He.addFeatures(ct,this.tileID.canonical,Kn.patternPositions,oi))}return this.status="done",{buckets:Object.values(mt).filter((ke=>!ke.isEmpty())),featureIndex:Et,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ln.image,imageAtlas:Kn,dashPositions:oi,glyphMap:this.returnDependencies?jn:null,iconMap:this.returnDependencies?Qr:null,glyphPositions:this.returnDependencies?ln.positions:null}}))}}function d(at,Pe,be){const je=new s.H(Pe);for(const qe of at)qe.recalculate(je,be)}class m{constructor(Pe,be,je,qe,Ge){this.type=Pe,this.properties=je||{},this.extent=Ge,this.pointsArray=be,this.id=qe}loadGeometry(){return this.pointsArray.map((Pe=>Pe.map((be=>new s.P(be.x,be.y)))))}}class b{constructor(Pe,be,je){this.version=2,this._myFeatures=Pe,this.name=be,this.length=Pe.length,this.extent=je}feature(Pe){return this._myFeatures[Pe]}}class x{constructor(){this.layers={}}addLayer(Pe){this.layers[Pe.name]=Pe}}function E(at){let Pe=s.cU(at);return Pe.byteOffset===0&&Pe.byteLength===Pe.buffer.byteLength||(Pe=new Uint8Array(Pe)),{vectorTile:at,rawData:Pe.buffer}}function T(at,Pe,be){const{extent:je}=at,qe=Math.pow(2,be.z-Pe.z),Ge=(be.x-Pe.x*qe)*je,Nt=(be.y-Pe.y*qe)*je,Et=[];for(let mt=0;mt<at.length;mt++){const ct=at.feature(mt);let Kt=ct.loadGeometry();for(const Ir of Kt)for(const Ar of Ir)Ar.x=Ar.x*qe-Ge,Ar.y=Ar.y*qe-Nt;const qt=128;Kt=s.cV(Kt,ct.type,-qt,-qt,je+qt,je+qt),Kt.length!==0&&Et.push(new m(ct.type,Kt,ct.properties,ct.id,je))}return new b(Et,at.name,je)}class A{constructor(Pe,be,je){this.actor=Pe,this.layerIndex=be,this.availableImages=je,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new s.cW(1e3)}loadVectorTile(Pe,be){return s._(this,void 0,void 0,(function*(){const je=yield s.n(Pe.request,be);try{return{vectorTile:Pe.encoding!=="mlt"?new s.cX(new s.cY(je.data)):new s.cZ(je.data),rawData:je.data,cacheControl:je.cacheControl,expires:je.expires}}catch(qe){const Ge=new Uint8Array(je.data);let Nt=`Unable to parse the tile at ${Pe.request.url}, `;throw Nt+=Ge[0]===31&&Ge[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${qe.message}`,new Error(Nt)}}))}loadTile(Pe){return s._(this,void 0,void 0,(function*(){const{uid:be,overzoomParameters:je}=Pe;je&&(Pe.request=je.overzoomRequest);const qe=!!(Pe&&Pe.request&&Pe.request.collectResourceTiming)&&new s.c_(Pe.request),Ge=new f(Pe);this.loading[be]=Ge;const Nt=new AbortController;Ge.abort=Nt;try{const Et=yield this.loadVectorTile(Pe,Nt);if(delete this.loading[be],!Et)return null;if(je){const Ir=this._getOverzoomTile(Pe,Et.vectorTile);Et.rawData=Ir.rawData,Et.vectorTile=Ir.vectorTile}const mt=Et.rawData,ct={};Et.expires&&(ct.expires=Et.expires),Et.cacheControl&&(ct.cacheControl=Et.cacheControl);const Kt={};if(qe){const Ir=qe.finish();Ir&&(Kt.resourceTiming=JSON.parse(JSON.stringify(Ir)))}Ge.vectorTile=Et.vectorTile;const qt=Ge.parse(Et.vectorTile,this.layerIndex,this.availableImages,this.actor,Pe.subdivisionGranularity);this.loaded[be]=Ge,this.fetching[be]={rawTileData:mt,cacheControl:ct,resourceTiming:Kt};try{const Ir=yield qt;return s.e({rawTileData:mt.slice(0),encoding:Pe.encoding},Ir,ct,Kt)}finally{delete this.fetching[be]}}catch(Et){throw delete this.loading[be],Ge.status="done",this.loaded[be]=Ge,Et}}))}_getOverzoomTile(Pe,be){const{tileID:je,source:qe,overzoomParameters:Ge}=Pe,{maxZoomTileID:Nt}=Ge,Et=`${Nt.key}_${je.key}`,mt=this.overzoomedTileResultCache.get(Et);if(mt)return mt;const ct=new x,Kt=this.layerIndex.familiesBySource[qe];for(const Ir in Kt){const Ar=be.layers[Ir];if(!Ar)continue;const $r=T(Ar,Nt,je.canonical);$r.length>0&&ct.addLayer($r)}const qt=E(ct);return this.overzoomedTileResultCache.set(Et,qt),qt}reloadTile(Pe){return s._(this,void 0,void 0,(function*(){const be=Pe.uid;if(!this.loaded||!this.loaded[be])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const je=this.loaded[be];if(je.showCollisionBoxes=Pe.showCollisionBoxes,je.status==="parsing"){const qe=yield je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,Pe.subdivisionGranularity);let Ge;if(this.fetching[be]){const{rawTileData:Nt,cacheControl:Et,resourceTiming:mt}=this.fetching[be];delete this.fetching[be],Ge=s.e({rawTileData:Nt.slice(0),encoding:Pe.encoding},qe,Et,mt)}else Ge=qe;return Ge}if(je.status==="done"&&je.vectorTile)return je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,Pe.subdivisionGranularity)}))}abortTile(Pe){return s._(this,void 0,void 0,(function*(){const be=this.loading,je=Pe.uid;be&&be[je]&&be[je].abort&&(be[je].abort.abort(),delete be[je])}))}removeTile(Pe){return s._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[Pe.uid]&&delete this.loaded[Pe.uid]}))}}class R{constructor(){this.loaded={}}loadTile(Pe){return s._(this,void 0,void 0,(function*(){const{uid:be,encoding:je,rawImageData:qe,redFactor:Ge,greenFactor:Nt,blueFactor:Et,baseShift:mt}=Pe,ct=qe.width+2,Kt=qe.height+2,qt=s.b(qe)?new s.R({width:ct,height:Kt},yield s.c$(qe,-1,-1,ct,Kt)):qe,Ir=new s.d0(be,qt,je,Ge,Nt,Et,mt);return this.loaded=this.loaded||{},this.loaded[be]=Ir,Ir}))}removeTile(Pe){const be=this.loaded,je=Pe.uid;be&&be[je]&&delete be[je]}}var F,N,O=(function(){if(N)return F;function at(be,je){if(be.length!==0){Pe(be[0],je);for(var qe=1;qe<be.length;qe++)Pe(be[qe],!je)}}function Pe(be,je){for(var qe=0,Ge=0,Nt=0,Et=be.length,mt=Et-1;Nt<Et;mt=Nt++){var ct=(be[Nt][0]-be[mt][0])*(be[mt][1]+be[Nt][1]),Kt=qe+ct;Ge+=Math.abs(qe)>=Math.abs(ct)?qe-Kt+ct:ct-Kt+qe,qe=Kt}qe+Ge>=0!=!!je&&be.reverse()}return N=1,F=function be(je,qe){var Ge,Nt=je&&je.type;if(Nt==="FeatureCollection")for(Ge=0;Ge<je.features.length;Ge++)be(je.features[Ge],qe);else if(Nt==="GeometryCollection")for(Ge=0;Ge<je.geometries.length;Ge++)be(je.geometries[Ge],qe);else if(Nt==="Feature")be(je.geometry,qe);else if(Nt==="Polygon")at(je.coordinates,qe);else if(Nt==="MultiPolygon")for(Ge=0;Ge<je.coordinates.length;Ge++)at(je.coordinates[Ge],qe);return je}})(),U=s.d1(O);const j={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:at=>at},H=Math.fround||(W=new Float32Array(1),at=>(W[0]=+at,W[0]));var W;class X{constructor(Pe){this.options=Object.assign(Object.create(j),Pe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Pe){const{log:be,minZoom:je,maxZoom:qe}=this.options;be&&console.time("total time");const Ge=`prepare ${Pe.length} points`;be&&console.time(Ge),this.points=Pe;const Nt=[];for(let mt=0;mt<Pe.length;mt++){const ct=Pe[mt];if(!ct.geometry)continue;const[Kt,qt]=ct.geometry.coordinates,Ir=H(G(Kt)),Ar=H(ae(qt));Nt.push(Ir,Ar,1/0,mt,-1,1),this.options.reduce&&Nt.push(0)}let Et=this.trees[qe+1]=this._createTree(Nt);be&&console.timeEnd(Ge);for(let mt=qe;mt>=je;mt--){const ct=+Date.now();Et=this.trees[mt]=this._createTree(this._cluster(Et,mt)),be&&console.log("z%d: %d clusters in %dms",mt,Et.numItems,+Date.now()-ct)}return be&&console.timeEnd("total time"),this}getClusters(Pe,be){let je=((Pe[0]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,Pe[1]));let Ge=Pe[2]===180?180:((Pe[2]+180)%360+360)%360-180;const Nt=Math.max(-90,Math.min(90,Pe[3]));if(Pe[2]-Pe[0]>=360)je=-180,Ge=180;else if(je>Ge){const qt=this.getClusters([je,qe,180,Nt],be),Ir=this.getClusters([-180,qe,Ge,Nt],be);return qt.concat(Ir)}const Et=this.trees[this._limitZoom(be)],mt=Et.range(G(je),ae(Nt),G(Ge),ae(qe)),ct=Et.data,Kt=[];for(const qt of mt){const Ir=this.stride*qt;Kt.push(ct[Ir+5]>1?oe(ct,Ir,this.clusterProps):this.points[ct[Ir+3]])}return Kt}getChildren(Pe){const be=this._getOriginId(Pe),je=this._getOriginZoom(Pe),qe="No cluster with the specified id.",Ge=this.trees[je];if(!Ge)throw new Error(qe);const Nt=Ge.data;if(be*this.stride>=Nt.length)throw new Error(qe);const Et=this.options.radius/(this.options.extent*Math.pow(2,je-1)),mt=Ge.within(Nt[be*this.stride],Nt[be*this.stride+1],Et),ct=[];for(const Kt of mt){const qt=Kt*this.stride;Nt[qt+4]===Pe&&ct.push(Nt[qt+5]>1?oe(Nt,qt,this.clusterProps):this.points[Nt[qt+3]])}if(ct.length===0)throw new Error(qe);return ct}getLeaves(Pe,be,je){const qe=[];return this._appendLeaves(qe,Pe,be=be||10,je=je||0,0),qe}getTile(Pe,be,je){const qe=this.trees[this._limitZoom(Pe)],Ge=Math.pow(2,Pe),{extent:Nt,radius:Et}=this.options,mt=Et/Nt,ct=(je-mt)/Ge,Kt=(je+1+mt)/Ge,qt={features:[]};return this._addTileFeatures(qe.range((be-mt)/Ge,ct,(be+1+mt)/Ge,Kt),qe.data,be,je,Ge,qt),be===0&&this._addTileFeatures(qe.range(1-mt/Ge,ct,1,Kt),qe.data,Ge,je,Ge,qt),be===Ge-1&&this._addTileFeatures(qe.range(0,ct,mt/Ge,Kt),qe.data,-1,je,Ge,qt),qt.features.length?qt:null}getClusterExpansionZoom(Pe){let be=this._getOriginZoom(Pe)-1;for(;be<=this.options.maxZoom;){const je=this.getChildren(Pe);if(be++,je.length!==1)break;Pe=je[0].properties.cluster_id}return be}_appendLeaves(Pe,be,je,qe,Ge){const Nt=this.getChildren(be);for(const Et of Nt){const mt=Et.properties;if(mt&&mt.cluster?Ge+mt.point_count<=qe?Ge+=mt.point_count:Ge=this._appendLeaves(Pe,mt.cluster_id,je,qe,Ge):Ge<qe?Ge++:Pe.push(Et),Pe.length===je)break}return Ge}_createTree(Pe){const be=new s.aT(Pe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let je=0;je<Pe.length;je+=this.stride)be.add(Pe[je],Pe[je+1]);return be.finish(),be.data=Pe,be}_addTileFeatures(Pe,be,je,qe,Ge,Nt){for(const Et of Pe){const mt=Et*this.stride,ct=be[mt+5]>1;let Kt,qt,Ir;if(ct)Kt=ee(be,mt,this.clusterProps),qt=be[mt],Ir=be[mt+1];else{const cn=this.points[be[mt+3]];Kt=cn.properties;const[zr,Rt]=cn.geometry.coordinates;qt=G(zr),Ir=ae(Rt)}const Ar={type:1,geometry:[[Math.round(this.options.extent*(qt*Ge-je)),Math.round(this.options.extent*(Ir*Ge-qe))]],tags:Kt};let $r;$r=ct||this.options.generateId?be[mt+3]:this.points[be[mt+3]].id,$r!==void 0&&(Ar.id=$r),Nt.features.push(Ar)}}_limitZoom(Pe){return Math.max(this.options.minZoom,Math.min(Math.floor(+Pe),this.options.maxZoom+1))}_cluster(Pe,be){const{radius:je,extent:qe,reduce:Ge,minPoints:Nt}=this.options,Et=je/(qe*Math.pow(2,be)),mt=Pe.data,ct=[],Kt=this.stride;for(let qt=0;qt<mt.length;qt+=Kt){if(mt[qt+2]<=be)continue;mt[qt+2]=be;const Ir=mt[qt],Ar=mt[qt+1],$r=Pe.within(mt[qt],mt[qt+1],Et),cn=mt[qt+5];let zr=cn;for(const Rt of $r){const en=Rt*Kt;mt[en+2]>be&&(zr+=mt[en+5])}if(zr>cn&&zr>=Nt){let Rt,en=Ir*cn,jn=Ar*cn,Qr=-1;const nr=(qt/Kt<<5)+(be+1)+this.points.length;for(const oi of $r){const ln=oi*Kt;if(mt[ln+2]<=be)continue;mt[ln+2]=be;const Kn=mt[ln+5];en+=mt[ln]*Kn,jn+=mt[ln+1]*Kn,mt[ln+4]=nr,Ge&&(Rt||(Rt=this._map(mt,qt,!0),Qr=this.clusterProps.length,this.clusterProps.push(Rt)),Ge(Rt,this._map(mt,ln)))}mt[qt+4]=nr,ct.push(en/zr,jn/zr,1/0,nr,-1,zr),Ge&&ct.push(Qr)}else{for(let Rt=0;Rt<Kt;Rt++)ct.push(mt[qt+Rt]);if(zr>1)for(const Rt of $r){const en=Rt*Kt;if(!(mt[en+2]<=be)){mt[en+2]=be;for(let jn=0;jn<Kt;jn++)ct.push(mt[en+jn])}}}}return ct}_getOriginId(Pe){return Pe-this.points.length>>5}_getOriginZoom(Pe){return(Pe-this.points.length)%32}_map(Pe,be,je){if(Pe[be+5]>1){const Nt=this.clusterProps[Pe[be+6]];return je?Object.assign({},Nt):Nt}const qe=this.points[Pe[be+3]].properties,Ge=this.options.map(qe);return je&&Ge===qe?Object.assign({},Ge):Ge}}function oe(at,Pe,be){return{type:"Feature",id:at[Pe+3],properties:ee(at,Pe,be),geometry:{type:"Point",coordinates:[(je=at[Pe],360*(je-.5)),se(at[Pe+1])]}};var je}function ee(at,Pe,be){const je=at[Pe+5],qe=je>=1e4?`${Math.round(je/1e3)}k`:je>=1e3?Math.round(je/100)/10+"k":je,Ge=at[Pe+6],Nt=Ge===-1?{}:Object.assign({},be[Ge]);return Object.assign(Nt,{cluster:!0,cluster_id:at[Pe+3],point_count:je,point_count_abbreviated:qe})}function G(at){return at/360+.5}function ae(at){const Pe=Math.sin(at*Math.PI/180),be=.5-.25*Math.log((1+Pe)/(1-Pe))/Math.PI;return be<0?0:be>1?1:be}function se(at){const Pe=(180-360*at)*Math.PI/180;return 360*Math.atan(Math.exp(Pe))/Math.PI-90}function fe(at,Pe,be,je){let qe=je;const Ge=Pe+(be-Pe>>1);let Nt,Et=be-Pe;const mt=at[Pe],ct=at[Pe+1],Kt=at[be],qt=at[be+1];for(let Ir=Pe+3;Ir<be;Ir+=3){const Ar=pe(at[Ir],at[Ir+1],mt,ct,Kt,qt);if(Ar>qe)Nt=Ir,qe=Ar;else if(Ar===qe){const $r=Math.abs(Ir-Ge);$r<Et&&(Nt=Ir,Et=$r)}}qe>je&&(Nt-Pe>3&&fe(at,Pe,Nt,je),at[Nt+2]=qe,be-Nt>3&&fe(at,Nt,be,je))}function pe(at,Pe,be,je,qe,Ge){let Nt=qe-be,Et=Ge-je;if(Nt!==0||Et!==0){const mt=((at-be)*Nt+(Pe-je)*Et)/(Nt*Nt+Et*Et);mt>1?(be=qe,je=Ge):mt>0&&(be+=Nt*mt,je+=Et*mt)}return Nt=at-be,Et=Pe-je,Nt*Nt+Et*Et}function De(at,Pe,be,je){const qe={id:at??null,type:Pe,geometry:be,tags:je,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Pe==="Point"||Pe==="MultiPoint"||Pe==="LineString")ye(qe,be);else if(Pe==="Polygon")ye(qe,be[0]);else if(Pe==="MultiLineString")for(const Ge of be)ye(qe,Ge);else if(Pe==="MultiPolygon")for(const Ge of be)ye(qe,Ge[0]);return qe}function ye(at,Pe){for(let be=0;be<Pe.length;be+=3)at.minX=Math.min(at.minX,Pe[be]),at.minY=Math.min(at.minY,Pe[be+1]),at.maxX=Math.max(at.maxX,Pe[be]),at.maxY=Math.max(at.maxY,Pe[be+1])}function we(at,Pe,be,je){if(!Pe.geometry)return;const qe=Pe.geometry.coordinates;if(qe&&qe.length===0)return;const Ge=Pe.geometry.type,Nt=Math.pow(be.tolerance/((1<<be.maxZoom)*be.extent),2);let Et=[],mt=Pe.id;if(be.promoteId?mt=Pe.properties[be.promoteId]:be.generateId&&(mt=je||0),Ge==="Point")Te(qe,Et);else if(Ge==="MultiPoint")for(const ct of qe)Te(ct,Et);else if(Ge==="LineString")Re(qe,Et,Nt,!1);else if(Ge==="MultiLineString"){if(be.lineMetrics){for(const ct of qe)Et=[],Re(ct,Et,Nt,!1),at.push(De(mt,"LineString",Et,Pe.properties));return}de(qe,Et,Nt,!1)}else if(Ge==="Polygon")de(qe,Et,Nt,!0);else{if(Ge!=="MultiPolygon"){if(Ge==="GeometryCollection"){for(const ct of Pe.geometry.geometries)we(at,{id:mt,geometry:ct,properties:Pe.properties},be,je);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ct of qe){const Kt=[];de(ct,Kt,Nt,!0),Et.push(Kt)}}at.push(De(mt,Ge,Et,Pe.properties))}function Te(at,Pe){Pe.push(Ee(at[0]),xe(at[1]),0)}function Re(at,Pe,be,je){let qe,Ge,Nt=0;for(let mt=0;mt<at.length;mt++){const ct=Ee(at[mt][0]),Kt=xe(at[mt][1]);Pe.push(ct,Kt,0),mt>0&&(Nt+=je?(qe*Kt-ct*Ge)/2:Math.sqrt(Math.pow(ct-qe,2)+Math.pow(Kt-Ge,2))),qe=ct,Ge=Kt}const Et=Pe.length-3;Pe[2]=1,fe(Pe,0,Et,be),Pe[Et+2]=1,Pe.size=Math.abs(Nt),Pe.start=0,Pe.end=Pe.size}function de(at,Pe,be,je){for(let qe=0;qe<at.length;qe++){const Ge=[];Re(at[qe],Ge,be,je),Pe.push(Ge)}}function Ee(at){return at/360+.5}function xe(at){const Pe=Math.sin(at*Math.PI/180),be=.5-.25*Math.log((1+Pe)/(1-Pe))/Math.PI;return be<0?0:be>1?1:be}function Ne(at,Pe,be,je,qe,Ge,Nt,Et){if(je/=Pe,Ge>=(be/=Pe)&&Nt<je)return at;if(Nt<be||Ge>=je)return null;const mt=[];for(const ct of at){const Kt=ct.geometry;let qt=ct.type;const Ir=qe===0?ct.minX:ct.minY,Ar=qe===0?ct.maxX:ct.maxY;if(Ir>=be&&Ar<je){mt.push(ct);continue}if(Ar<be||Ir>=je)continue;let $r=[];if(qt==="Point"||qt==="MultiPoint")Fe(Kt,$r,be,je,qe);else if(qt==="LineString")Xe(Kt,$r,be,je,qe,!1,Et.lineMetrics);else if(qt==="MultiLineString")ot(Kt,$r,be,je,qe,!1);else if(qt==="Polygon")ot(Kt,$r,be,je,qe,!0);else if(qt==="MultiPolygon")for(const cn of Kt){const zr=[];ot(cn,zr,be,je,qe,!0),zr.length&&$r.push(zr)}if($r.length){if(Et.lineMetrics&&qt==="LineString"){for(const cn of $r)mt.push(De(ct.id,qt,cn,ct.tags));continue}qt!=="LineString"&&qt!=="MultiLineString"||($r.length===1?(qt="LineString",$r=$r[0]):qt="MultiLineString"),qt!=="Point"&&qt!=="MultiPoint"||(qt=$r.length===3?"Point":"MultiPoint"),mt.push(De(ct.id,qt,$r,ct.tags))}}return mt.length?mt:null}function Fe(at,Pe,be,je,qe){for(let Ge=0;Ge<at.length;Ge+=3){const Nt=at[Ge+qe];Nt>=be&&Nt<=je&&Ke(Pe,at[Ge],at[Ge+1],at[Ge+2])}}function Xe(at,Pe,be,je,qe,Ge,Nt){let Et=Be(at);const mt=qe===0?it:Me;let ct,Kt,qt=at.start;for(let zr=0;zr<at.length-3;zr+=3){const Rt=at[zr],en=at[zr+1],jn=at[zr+2],Qr=at[zr+3],nr=at[zr+4],oi=qe===0?Rt:en,ln=qe===0?Qr:nr;let Kn=!1;Nt&&(ct=Math.sqrt(Math.pow(Rt-Qr,2)+Math.pow(en-nr,2))),oi<be?ln>be&&(Kt=mt(Et,Rt,en,Qr,nr,be),Nt&&(Et.start=qt+ct*Kt)):oi>je?ln<je&&(Kt=mt(Et,Rt,en,Qr,nr,je),Nt&&(Et.start=qt+ct*Kt)):Ke(Et,Rt,en,jn),ln<be&&oi>=be&&(Kt=mt(Et,Rt,en,Qr,nr,be),Kn=!0),ln>je&&oi<=je&&(Kt=mt(Et,Rt,en,Qr,nr,je),Kn=!0),!Ge&&Kn&&(Nt&&(Et.end=qt+ct*Kt),Pe.push(Et),Et=Be(at)),Nt&&(qt+=ct)}let Ir=at.length-3;const Ar=at[Ir],$r=at[Ir+1],cn=qe===0?Ar:$r;cn>=be&&cn<=je&&Ke(Et,Ar,$r,at[Ir+2]),Ir=Et.length-3,Ge&&Ir>=3&&(Et[Ir]!==Et[0]||Et[Ir+1]!==Et[1])&&Ke(Et,Et[0],Et[1],Et[2]),Et.length&&Pe.push(Et)}function Be(at){const Pe=[];return Pe.size=at.size,Pe.start=at.start,Pe.end=at.end,Pe}function ot(at,Pe,be,je,qe,Ge){for(const Nt of at)Xe(Nt,Pe,be,je,qe,Ge,!1)}function Ke(at,Pe,be,je){at.push(Pe,be,je)}function it(at,Pe,be,je,qe,Ge){const Nt=(Ge-Pe)/(je-Pe);return Ke(at,Ge,be+(qe-be)*Nt,1),Nt}function Me(at,Pe,be,je,qe,Ge){const Nt=(Ge-be)/(qe-be);return Ke(at,Pe+(je-Pe)*Nt,Ge,1),Nt}function zt(at,Pe){const be=[];for(let je=0;je<at.length;je++){const qe=at[je],Ge=qe.type;let Nt;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")Nt=st(qe.geometry,Pe);else if(Ge==="MultiLineString"||Ge==="Polygon"){Nt=[];for(const Et of qe.geometry)Nt.push(st(Et,Pe))}else if(Ge==="MultiPolygon"){Nt=[];for(const Et of qe.geometry){const mt=[];for(const ct of Et)mt.push(st(ct,Pe));Nt.push(mt)}}be.push(De(qe.id,Ge,Nt,qe.tags))}return be}function st(at,Pe){const be=[];be.size=at.size,at.start!==void 0&&(be.start=at.start,be.end=at.end);for(let je=0;je<at.length;je+=3)be.push(at[je]+Pe,at[je+1],at[je+2]);return be}function $e(at,Pe){if(at.transformed)return at;const be=1<<at.z,je=at.x,qe=at.y;for(const Ge of at.features){const Nt=Ge.geometry,Et=Ge.type;if(Ge.geometry=[],Et===1)for(let mt=0;mt<Nt.length;mt+=2)Ge.geometry.push(Jt(Nt[mt],Nt[mt+1],Pe,be,je,qe));else for(let mt=0;mt<Nt.length;mt++){const ct=[];for(let Kt=0;Kt<Nt[mt].length;Kt+=2)ct.push(Jt(Nt[mt][Kt],Nt[mt][Kt+1],Pe,be,je,qe));Ge.geometry.push(ct)}}return at.transformed=!0,at}function Jt(at,Pe,be,je,qe,Ge){return[Math.round(be*(at*je-qe)),Math.round(be*(Pe*je-Ge))]}function Ht(at,Pe,be,je,qe){const Ge=Pe===qe.maxZoom?0:qe.tolerance/((1<<Pe)*qe.extent),Nt={features:[],numPoints:0,numSimplified:0,numFeatures:at.length,source:null,x:be,y:je,z:Pe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Et of at)pr(Nt,Et,Ge,qe);return Nt}function pr(at,Pe,be,je){const qe=Pe.geometry,Ge=Pe.type,Nt=[];if(at.minX=Math.min(at.minX,Pe.minX),at.minY=Math.min(at.minY,Pe.minY),at.maxX=Math.max(at.maxX,Pe.maxX),at.maxY=Math.max(at.maxY,Pe.maxY),Ge==="Point"||Ge==="MultiPoint")for(let Et=0;Et<qe.length;Et+=3)Nt.push(qe[Et],qe[Et+1]),at.numPoints++,at.numSimplified++;else if(Ge==="LineString")_t(Nt,qe,at,be,!1,!1);else if(Ge==="MultiLineString"||Ge==="Polygon")for(let Et=0;Et<qe.length;Et++)_t(Nt,qe[Et],at,be,Ge==="Polygon",Et===0);else if(Ge==="MultiPolygon")for(let Et=0;Et<qe.length;Et++){const mt=qe[Et];for(let ct=0;ct<mt.length;ct++)_t(Nt,mt[ct],at,be,!0,ct===0)}if(Nt.length){let Et=Pe.tags||null;if(Ge==="LineString"&&je.lineMetrics){Et={};for(const ct in Pe.tags)Et[ct]=Pe.tags[ct];Et.mapbox_clip_start=qe.start/qe.size,Et.mapbox_clip_end=qe.end/qe.size}const mt={geometry:Nt,type:Ge==="Polygon"||Ge==="MultiPolygon"?3:Ge==="LineString"||Ge==="MultiLineString"?2:1,tags:Et};Pe.id!==null&&(mt.id=Pe.id),at.features.push(mt)}}function _t(at,Pe,be,je,qe,Ge){const Nt=je*je;if(je>0&&Pe.size<(qe?Nt:je))return void(be.numPoints+=Pe.length/3);const Et=[];for(let mt=0;mt<Pe.length;mt+=3)(je===0||Pe[mt+2]>Nt)&&(be.numSimplified++,Et.push(Pe[mt],Pe[mt+1])),be.numPoints++;qe&&(function(mt,ct){let Kt=0;for(let qt=0,Ir=mt.length,Ar=Ir-2;qt<Ir;Ar=qt,qt+=2)Kt+=(mt[qt]-mt[Ar])*(mt[qt+1]+mt[Ar+1]);if(Kt>0===ct)for(let qt=0,Ir=mt.length;qt<Ir/2;qt+=2){const Ar=mt[qt],$r=mt[qt+1];mt[qt]=mt[Ir-2-qt],mt[qt+1]=mt[Ir-1-qt],mt[Ir-2-qt]=Ar,mt[Ir-1-qt]=$r}})(Et,Ge),at.push(Et)}const vr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class br{constructor(Pe,be){const je=(be=this.options=(function(Ge,Nt){for(const Et in Nt)Ge[Et]=Nt[Et];return Ge})(Object.create(vr),be)).debug;if(je&&console.time("preprocess data"),be.maxZoom<0||be.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(be.promoteId&&be.generateId)throw new Error("promoteId and generateId cannot be used together.");let qe=(function(Ge,Nt){const Et=[];if(Ge.type==="FeatureCollection")for(let mt=0;mt<Ge.features.length;mt++)we(Et,Ge.features[mt],Nt,mt);else we(Et,Ge.type==="Feature"?Ge:{geometry:Ge},Nt);return Et})(Pe,be);this.tiles={},this.tileCoords=[],je&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",be.indexMaxZoom,be.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),qe=(function(Ge,Nt){const Et=Nt.buffer/Nt.extent;let mt=Ge;const ct=Ne(Ge,1,-1-Et,Et,0,-1,2,Nt),Kt=Ne(Ge,1,1-Et,2+Et,0,-1,2,Nt);return(ct||Kt)&&(mt=Ne(Ge,1,-Et,1+Et,0,-1,2,Nt)||[],ct&&(mt=zt(ct,1).concat(mt)),Kt&&(mt=mt.concat(zt(Kt,-1)))),mt})(qe,be),qe.length&&this.splitTile(qe,0,0,0),je&&(qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Pe,be,je,qe,Ge,Nt,Et){const mt=[Pe,be,je,qe],ct=this.options,Kt=ct.debug;for(;mt.length;){qe=mt.pop(),je=mt.pop(),be=mt.pop(),Pe=mt.pop();const qt=1<<be,Ir=lr(be,je,qe);let Ar=this.tiles[Ir];if(!Ar&&(Kt>1&&console.time("creation"),Ar=this.tiles[Ir]=Ht(Pe,be,je,qe,ct),this.tileCoords.push({z:be,x:je,y:qe}),Kt)){Kt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",be,je,qe,Ar.numFeatures,Ar.numPoints,Ar.numSimplified),console.timeEnd("creation"));const Kn=`z${be}`;this.stats[Kn]=(this.stats[Kn]||0)+1,this.total++}if(Ar.source=Pe,Ge==null){if(be===ct.indexMaxZoom||Ar.numPoints<=ct.indexMaxPoints)continue}else{if(be===ct.maxZoom||be===Ge)continue;if(Ge!=null){const Kn=Ge-be;if(je!==Nt>>Kn||qe!==Et>>Kn)continue}}if(Ar.source=null,Pe.length===0)continue;Kt>1&&console.time("clipping");const $r=.5*ct.buffer/ct.extent,cn=.5-$r,zr=.5+$r,Rt=1+$r;let en=null,jn=null,Qr=null,nr=null,oi=Ne(Pe,qt,je-$r,je+zr,0,Ar.minX,Ar.maxX,ct),ln=Ne(Pe,qt,je+cn,je+Rt,0,Ar.minX,Ar.maxX,ct);Pe=null,oi&&(en=Ne(oi,qt,qe-$r,qe+zr,1,Ar.minY,Ar.maxY,ct),jn=Ne(oi,qt,qe+cn,qe+Rt,1,Ar.minY,Ar.maxY,ct),oi=null),ln&&(Qr=Ne(ln,qt,qe-$r,qe+zr,1,Ar.minY,Ar.maxY,ct),nr=Ne(ln,qt,qe+cn,qe+Rt,1,Ar.minY,Ar.maxY,ct),ln=null),Kt>1&&console.timeEnd("clipping"),mt.push(en||[],be+1,2*je,2*qe),mt.push(jn||[],be+1,2*je,2*qe+1),mt.push(Qr||[],be+1,2*je+1,2*qe),mt.push(nr||[],be+1,2*je+1,2*qe+1)}}getTile(Pe,be,je){Pe=+Pe,be=+be,je=+je;const qe=this.options,{extent:Ge,debug:Nt}=qe;if(Pe<0||Pe>24)return null;const Et=1<<Pe,mt=lr(Pe,be=be+Et&Et-1,je);if(this.tiles[mt])return $e(this.tiles[mt],Ge);Nt>1&&console.log("drilling down to z%d-%d-%d",Pe,be,je);let ct,Kt=Pe,qt=be,Ir=je;for(;!ct&&Kt>0;)Kt--,qt>>=1,Ir>>=1,ct=this.tiles[lr(Kt,qt,Ir)];return ct&&ct.source?(Nt>1&&(console.log("found parent tile z%d-%d-%d",Kt,qt,Ir),console.time("drilling down")),this.splitTile(ct.source,Kt,qt,Ir,Pe,be,je),Nt>1&&console.timeEnd("drilling down"),this.tiles[mt]?$e(this.tiles[mt],Ge):null):null}}function lr(at,Pe,be){return 32*((1<<at)*be+Pe)+at}class Cr extends A{constructor(Pe,be,je,qe=Tr){super(Pe,be,je),this._dataUpdateable=new Map,this._createGeoJSONIndex=qe}loadVectorTile(Pe,be){return s._(this,void 0,void 0,(function*(){const je=Pe.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const qe=this._geoJSONIndex.getTile(je.z,je.x,je.y);return qe?E(new s.d2(qe.features,{version:2,extent:s.a5})):null}))}loadData(Pe){return s._(this,void 0,void 0,(function*(){var be;(be=this._pendingRequest)===null||be===void 0||be.abort();const je=this._startPerformance(Pe);this._pendingRequest=new AbortController;try{(!this._pendingData||Pe.request||Pe.data||Pe.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(Pe,this._pendingRequest));const qe=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(qe,Pe),this.loaded={};const Ge={};return Pe.request&&(Ge.data=qe),this._finishPerformance(je,Pe,Ge),Ge}catch(qe){if(delete this._pendingRequest,s.Z(qe))return{abandoned:!0};throw qe}}))}_startPerformance(Pe){var be;if(!((be=Pe?.request)===null||be===void 0)&&be.collectResourceTiming)return new s.c_(Pe.request)}_finishPerformance(Pe,be,je){if(!Pe)return;const qe=Pe.finish();qe&&(je.resourceTiming={},je.resourceTiming[be.source]=JSON.parse(JSON.stringify(qe)))}getData(){return s._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(Pe){const be=this.loaded;return be&&be[Pe.uid]?super.reloadTile(Pe):this.loadTile(Pe)}loadAndProcessGeoJSON(Pe,be){return s._(this,void 0,void 0,(function*(){let je;if(Pe.request?je=yield this.loadGeoJSONFromUrl(Pe.request,Pe.promoteId,be):Pe.data?je=this._loadGeoJSONFromObject(Pe.data,Pe.promoteId):Pe.dataDiff&&(je=this._loadGeoJSONFromDiff(Pe.dataDiff,Pe.promoteId,Pe.source)),delete this._pendingRequest,typeof je!="object")throw new Error(`Input data given to '${Pe.source}' is not a valid GeoJSON object.`);return U(je,!0),Pe.filter&&(je=this._filterGeoJSON(je,Pe.filter)),je}))}loadGeoJSONFromUrl(Pe,be,je){return s._(this,void 0,void 0,(function*(){const qe=yield s.j(Pe,je);return this._dataUpdateable=s.a7(qe.data,be),qe.data}))}_loadGeoJSONFromObject(Pe,be){return this._dataUpdateable=s.a7(Pe,be),Pe}_loadGeoJSONFromDiff(Pe,be,je){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${je}`);s.a8(this._dataUpdateable,Pe,be);const qe=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(qe)}_filterGeoJSON(Pe,be){const je=s.d3(be,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(je.result==="error")throw new Error(je.value.map((Ge=>`${Ge.key}: ${Ge.message}`)).join(", "));const qe=Pe.features.filter((Ge=>je.value.evaluate({zoom:0},Ge)));return this._toFeatureCollection(qe)}_toFeatureCollection(Pe){return{type:"FeatureCollection",features:Pe}}removeSource(Pe){return s._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(Pe){return this._geoJSONIndex.getClusterExpansionZoom(Pe.clusterId)}getClusterChildren(Pe){return this._geoJSONIndex.getChildren(Pe.clusterId)}getClusterLeaves(Pe){return this._geoJSONIndex.getLeaves(Pe.clusterId,Pe.limit,Pe.offset)}}function Tr(at,Pe){return Pe.cluster?new X((function({superclusterOptions:be,clusterProperties:je}){if(!je||!be)return be;const qe={},Ge={},Nt={accumulated:null,zoom:0},Et={properties:null},mt=Object.keys(je);for(const ct of mt){const[Kt,qt]=je[ct],Ir=s.d3(qt),Ar=s.d3(typeof Kt=="string"?[Kt,["accumulated"],["get",ct]]:Kt);qe[ct]=Ir.value,Ge[ct]=Ar.value}return be.map=ct=>{Et.properties=ct;const Kt={};for(const qt of mt)Kt[qt]=qe[qt].evaluate(Nt,Et);return Kt},be.reduce=(ct,Kt)=>{Et.properties=Kt;for(const qt of mt)Nt.accumulated=ct[qt],ct[qt]=Ge[qt].evaluate(Nt,Et)},be})(Pe)).load(at.features):(function(be,je){return new br(be,je)})(at,Pe.geojsonVtOptions)}class Qt{constructor(Pe){this.self=Pe,this.actor=new s.L(Pe),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(be,je)=>{if(this.externalWorkerSourceTypes[be])throw new Error(`Worker source with name "${be}" already registered.`);this.externalWorkerSourceTypes[be]=je},this.self.addProtocol=s.cJ,this.self.removeProtocol=s.cK,this.self.registerRTLTextPlugin=be=>{s.d4.setMethods(be)},this.actor.registerMessageHandler("LDT",((be,je)=>this._getDEMWorkerSource(be,je.source).loadTile(je))),this.actor.registerMessageHandler("RDT",((be,je)=>s._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(be,je.source).removeTile(je)})))),this.actor.registerMessageHandler("GCEZ",((be,je)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(be,je.type,je.source).getClusterExpansionZoom(je)})))),this.actor.registerMessageHandler("GCC",((be,je)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(be,je.type,je.source).getClusterChildren(je)})))),this.actor.registerMessageHandler("GCL",((be,je)=>s._(this,void 0,void 0,(function*(){return this._getWorkerSource(be,je.type,je.source).getClusterLeaves(je)})))),this.actor.registerMessageHandler("LD",((be,je)=>this._getWorkerSource(be,je.type,je.source).loadData(je))),this.actor.registerMessageHandler("GD",((be,je)=>this._getWorkerSource(be,je.type,je.source).getData())),this.actor.registerMessageHandler("LT",((be,je)=>this._getWorkerSource(be,je.type,je.source).loadTile(je))),this.actor.registerMessageHandler("RT",((be,je)=>this._getWorkerSource(be,je.type,je.source).reloadTile(je))),this.actor.registerMessageHandler("AT",((be,je)=>this._getWorkerSource(be,je.type,je.source).abortTile(je))),this.actor.registerMessageHandler("RMT",((be,je)=>this._getWorkerSource(be,je.type,je.source).removeTile(je))),this.actor.registerMessageHandler("RS",((be,je)=>s._(this,void 0,void 0,(function*(){if(!this.workerSources[be]||!this.workerSources[be][je.type]||!this.workerSources[be][je.type][je.source])return;const qe=this.workerSources[be][je.type][je.source];delete this.workerSources[be][je.type][je.source],qe.removeSource!==void 0&&qe.removeSource(je)})))),this.actor.registerMessageHandler("RM",(be=>s._(this,void 0,void 0,(function*(){delete this.layerIndexes[be],delete this.availableImages[be],delete this.workerSources[be],delete this.demWorkerSources[be],this.globalStates.delete(be)})))),this.actor.registerMessageHandler("SR",((be,je)=>s._(this,void 0,void 0,(function*(){this.referrer=je})))),this.actor.registerMessageHandler("SRPS",((be,je)=>this._syncRTLPluginState(be,je))),this.actor.registerMessageHandler("IS",((be,je)=>s._(this,void 0,void 0,(function*(){this.self.importScripts(je)})))),this.actor.registerMessageHandler("SI",((be,je)=>this._setImages(be,je))),this.actor.registerMessageHandler("UL",((be,je)=>s._(this,void 0,void 0,(function*(){this._getLayerIndex(be).update(je.layers,je.removedIds,this._getGlobalState(be))})))),this.actor.registerMessageHandler("UGS",((be,je)=>s._(this,void 0,void 0,(function*(){const qe=this._getGlobalState(be);for(const Ge in je)qe[Ge]=je[Ge]})))),this.actor.registerMessageHandler("SL",((be,je)=>s._(this,void 0,void 0,(function*(){this._getLayerIndex(be).replace(je,this._getGlobalState(be))}))))}_getGlobalState(Pe){let be=this.globalStates.get(Pe);return be||(be={},this.globalStates.set(Pe,be)),be}_setImages(Pe,be){return s._(this,void 0,void 0,(function*(){this.availableImages[Pe]=be;for(const je in this.workerSources[Pe]){const qe=this.workerSources[Pe][je];for(const Ge in qe)qe[Ge].availableImages=be}}))}_syncRTLPluginState(Pe,be){return s._(this,void 0,void 0,(function*(){return yield s.d4.syncState(be,this.self.importScripts)}))}_getAvailableImages(Pe){let be=this.availableImages[Pe];return be||(be=[]),be}_getLayerIndex(Pe){let be=this.layerIndexes[Pe];return be||(be=this.layerIndexes[Pe]=new o),be}_getWorkerSource(Pe,be,je){if(this.workerSources[Pe]||(this.workerSources[Pe]={}),this.workerSources[Pe][be]||(this.workerSources[Pe][be]={}),!this.workerSources[Pe][be][je]){const qe={sendAsync:(Ge,Nt)=>(Ge.targetMapId=Pe,this.actor.sendAsync(Ge,Nt))};switch(be){case"vector":this.workerSources[Pe][be][je]=new A(qe,this._getLayerIndex(Pe),this._getAvailableImages(Pe));break;case"geojson":this.workerSources[Pe][be][je]=new Cr(qe,this._getLayerIndex(Pe),this._getAvailableImages(Pe));break;default:this.workerSources[Pe][be][je]=new this.externalWorkerSourceTypes[be](qe,this._getLayerIndex(Pe),this._getAvailableImages(Pe))}}return this.workerSources[Pe][be][je]}_getDEMWorkerSource(Pe,be){return this.demWorkerSources[Pe]||(this.demWorkerSources[Pe]={}),this.demWorkerSources[Pe][be]||(this.demWorkerSources[Pe][be]=new R),this.demWorkerSources[Pe][be]}}return s.i(self)&&(self.worker=new Qt(self)),Qt})),i("index",["exports","./shared"],(function(s,o){var c="5.16.0";function f(){var D=new o.A(4);return o.A!=Float32Array&&(D[1]=0,D[2]=0),D[0]=1,D[3]=1,D}let d,m,b;const x={frame(D,u,g){const w=requestAnimationFrame((L=>{C(),u(L)})),{unsubscribe:C}=o.s(D.signal,"abort",(()=>{C(),cancelAnimationFrame(w),g(new o.a(D.signal.reason))}),!1)},frameAsync(D){return new Promise(((u,g)=>{this.frame(D,u,g)}))},getImageData(D,u=0){return this.getImageCanvasContext(D).getImageData(-u,-u,D.width+2*u,D.height+2*u)},getImageCanvasContext(D){const u=window.document.createElement("canvas"),g=u.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return u.width=D.width,u.height=D.height,g.drawImage(D,0,0,D.width,D.height),g},resolveURL:D=>(d||(d=document.createElement("a")),d.href=D,d.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return b!==void 0?b:!!matchMedia&&(m==null&&(m=matchMedia("(prefers-reduced-motion: reduce)")),m.matches)},set prefersReducedMotion(D){b=D}},E=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(D){this._frozenAt=D}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function T(){return E.getCurrentTime()}class A{static testProp(u){if(!A.docStyle)return u[0];for(let g=0;g<u.length;g++)if(u[g]in A.docStyle)return u[g];return u[0]}static create(u,g,w){const C=window.document.createElement(u);return g!==void 0&&(C.className=g),w&&w.appendChild(C),C}static createNS(u,g){return window.document.createElementNS(u,g)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(u,g){u.style[A.transformProp]=g}static addEventListener(u,g,w,C={}){u.addEventListener(g,w,"passive"in C?C:C.capture)}static removeEventListener(u,g,w,C={}){u.removeEventListener(g,w,"passive"in C?C:C.capture)}static suppressClickInternal(u){u.preventDefault(),u.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",A.suppressClickInternal,!0)}),0)}static getScale(u){const g=u.getBoundingClientRect();return{x:g.width/u.offsetWidth||1,y:g.height/u.offsetHeight||1,boundingClientRect:g}}static getPoint(u,g,w){const C=g.boundingClientRect;return new o.P((w.clientX-C.left)/g.x-u.clientLeft,(w.clientY-C.top)/g.y-u.clientTop)}static mousePos(u,g){const w=A.getScale(u);return A.getPoint(u,w,g)}static touchPos(u,g){const w=[],C=A.getScale(u);for(let L=0;L<g.length;L++)w.push(A.getPoint(u,C,g[L]));return w}static mouseButton(u){return u.button}static remove(u){u.parentNode&&u.parentNode.removeChild(u)}static sanitize(u){const g=new DOMParser().parseFromString(u,"text/html").body||document.createElement("body"),w=g.querySelectorAll("script");for(const C of w)C.remove();return A.clean(g),g.innerHTML}static isPossiblyDangerous(u,g){const w=g.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(u)||!w.includes("javascript:")&&!w.includes("data:"))||!!u.startsWith("on")||void 0}static clean(u){const g=u.children;for(const w of g)A.removeAttributes(w),A.clean(w)}static removeAttributes(u){for(const{name:g,value:w}of u.attributes)A.isPossiblyDangerous(g,w)&&u.removeAttribute(g)}}A.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);const R={supported:!1,testSupport:function(D){!O&&N&&(U?j(D):F=D)}};let F,N,O=!1,U=!1;function j(D){const u=D.createTexture();D.bindTexture(D.TEXTURE_2D,u);try{if(D.texImage2D(D.TEXTURE_2D,0,D.RGBA,D.RGBA,D.UNSIGNED_BYTE,N),D.isContextLost())return;R.supported=!0}catch{}D.deleteTexture(u),O=!0}var H;typeof document<"u"&&(N=document.createElement("img"),N.onload=()=>{F&&j(F),F=null,U=!0},N.onerror=()=>{O=!0,F=null},N.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(D){let u,g,w,C;D.resetRequestQueue=()=>{u=[],g=0,w=0,C={}},D.addThrottleControl=re=>{const le=w++;return C[le]=re,le},D.removeThrottleControl=re=>{delete C[re],z()},D.getImage=(re,le,he=!0)=>new Promise(((Ae,Ce)=>{R.supported&&(re.headers||(re.headers={}),re.headers.accept="image/webp,*/*"),o.e(re,{type:"image"}),u.push({abortController:le,requestParameters:re,supportImageRefresh:he,state:"queued",onError:Ue=>{Ce(Ue)},onSuccess:Ue=>{Ae(Ue)}}),z()}));const L=re=>o._(this,void 0,void 0,(function*(){re.state="running";const{requestParameters:le,supportImageRefresh:he,onError:Ae,onSuccess:Ce,abortController:Ue}=re,Ze=he===!1&&!o.i(self)&&!o.g(le.url)&&(!le.headers||Object.keys(le.headers).reduce(((dt,xt)=>dt&&xt==="accept"),!0));g++;const ht=Ze?Y(le,Ue):o.m(le,Ue);try{const dt=yield ht;delete re.abortController,re.state="completed",dt.data instanceof HTMLImageElement||o.b(dt.data)?Ce(dt):dt.data&&Ce({data:yield(pt=dt.data,typeof createImageBitmap=="function"?o.f(pt):o.h(pt)),cacheControl:dt.cacheControl,expires:dt.expires})}catch(dt){delete re.abortController,Ae(dt)}finally{g--,z()}var pt})),z=()=>{const re=(()=>{for(const le of Object.keys(C))if(C[le]())return!0;return!1})()?o.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let le=g;le<re&&u.length>0;le++){const he=u.shift();he.abortController.signal.aborted?le--:L(he)}},Y=(re,le)=>new Promise(((he,Ae)=>{const Ce=new Image,Ue=re.url,Ze=re.credentials;Ze&&Ze==="include"?Ce.crossOrigin="use-credentials":(Ze&&Ze==="same-origin"||!o.d(Ue))&&(Ce.crossOrigin="anonymous"),le.signal.addEventListener("abort",(()=>{Ce.src="",Ae(new o.a(le.signal.reason))})),Ce.fetchPriority="high",Ce.onload=()=>{Ce.onerror=Ce.onload=null,he({data:Ce})},Ce.onerror=()=>{Ce.onerror=Ce.onload=null,le.signal.aborted||Ae(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Ce.src=Ue}))})(H||(H={})),H.resetRequestQueue();class W{constructor(u){this._transformRequestFn=u??null}transformRequest(u,g){return this._transformRequestFn&&this._transformRequestFn(u,g)||{url:u}}setTransformRequest(u){this._transformRequestFn=u}}function X(D){const u=[];if(typeof D=="string")u.push({id:"default",url:D});else if(D&&D.length>0){const g=[];for(const{id:w,url:C}of D){const L=`${w}${C}`;g.indexOf(L)===-1&&(g.push(L),u.push({id:w,url:C}))}}return u}function oe(D,u,g){try{const w=new URL(D);return w.pathname+=`${u}${g}`,w.toString()}catch{throw new Error(`Invalid sprite URL "${D}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ee(D){const{userImage:u}=D;return!!(u&&u.render&&u.render())&&(D.data.replace(new Uint8Array(u.data.buffer)),!0)}class G extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const u of Object.keys(this.images))this.removeImage(u);this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(u){if(this.loaded!==u&&(this.loaded=u,u)){for(const{ids:g,promiseResolve:w}of this.requestors)w(this._getImagesForIds(g));this.requestors=[]}}getImage(u){const g=this.images[u];if(g&&!g.data&&g.spriteData){const w=g.spriteData;g.data=new o.R({width:w.width,height:w.height},w.context.getImageData(w.x,w.y,w.width,w.height).data),g.spriteData=null}return g}addImage(u,g){if(this.images[u])throw new Error(`Image id ${u} already exist, use updateImage instead`);this._validate(u,g)&&(this.images[u]=g)}_validate(u,g){let w=!0;const C=g.data||g.spriteData;return this._validateStretch(g.stretchX,C&&C.width)||(this.fire(new o.k(new Error(`Image "${u}" has invalid "stretchX" value`))),w=!1),this._validateStretch(g.stretchY,C&&C.height)||(this.fire(new o.k(new Error(`Image "${u}" has invalid "stretchY" value`))),w=!1),this._validateContent(g.content,g)||(this.fire(new o.k(new Error(`Image "${u}" has invalid "content" value`))),w=!1),w}_validateStretch(u,g){if(!u)return!0;let w=0;for(const C of u){if(C[0]<w||C[1]<C[0]||g<C[1])return!1;w=C[1]}return!0}_validateContent(u,g){if(!u)return!0;if(u.length!==4)return!1;const w=g.spriteData,C=w&&w.width||g.data.width,L=w&&w.height||g.data.height;return!(u[0]<0||C<u[0]||u[1]<0||L<u[1]||u[2]<0||C<u[2]||u[3]<0||L<u[3]||u[2]<u[0]||u[3]<u[1])}updateImage(u,g,w=!0){const C=this.getImage(u);if(w&&(C.data.width!==g.data.width||C.data.height!==g.data.height))throw new Error(`size mismatch between old image (${C.data.width}x${C.data.height}) and new image (${g.data.width}x${g.data.height}).`);g.version=C.version+1,this.images[u]=g,this.updatedImages[u]=!0}removeImage(u){const g=this.images[u];delete this.images[u],delete this.patterns[u],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(u){return new Promise(((g,w)=>{let C=!0;if(!this.isLoaded())for(const L of u)this.images[L]||(C=!1);this.isLoaded()||C?g(this._getImagesForIds(u)):this.requestors.push({ids:u,promiseResolve:g})}))}_getImagesForIds(u){const g={};for(const w of u){let C=this.getImage(w);C||(this.fire(new o.l("styleimagemissing",{id:w})),C=this.getImage(w)),C?g[w]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,textFitWidth:C.textFitWidth,textFitHeight:C.textFitHeight,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:o.w(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return g}getPixelSize(){const{width:u,height:g}=this.atlasImage;return{width:u,height:g}}getPattern(u){const g=this.patterns[u],w=this.getImage(u);if(!w)return null;if(g&&g.position.version===w.version)return g.position;if(g)g.position.version=w.version;else{const C={w:w.data.width+2,h:w.data.height+2,x:0,y:0},L=new o.I(C,w);this.patterns[u]={bin:C,position:L}}return this._updatePatternAtlas(),this.patterns[u].position}bind(u){const g=u.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(u,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(){const u=[];for(const L in this.patterns)u.push(this.patterns[L].bin);const{w:g,h:w}=o.p(u),C=this.atlasImage;C.resize({width:g||1,height:w||1});for(const L in this.patterns){const{bin:z}=this.patterns[L],Y=z.x+1,re=z.y+1,le=this.getImage(L).data,he=le.width,Ae=le.height;o.R.copy(le,C,{x:0,y:0},{x:Y,y:re},{width:he,height:Ae}),o.R.copy(le,C,{x:0,y:Ae-1},{x:Y,y:re-1},{width:he,height:1}),o.R.copy(le,C,{x:0,y:0},{x:Y,y:re+Ae},{width:he,height:1}),o.R.copy(le,C,{x:he-1,y:0},{x:Y-1,y:re},{width:1,height:Ae}),o.R.copy(le,C,{x:0,y:0},{x:Y+he,y:re},{width:1,height:Ae})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(u){for(const g of u){if(this.callbackDispatchedThisFrame[g])continue;this.callbackDispatchedThisFrame[g]=!0;const w=this.getImage(g);w||o.w(`Image with ID: "${g}" was not found`),ee(w)&&this.updateImage(g,w)}}cloneImages(){const u={};for(const g in this.images){const w=this.images[g];u[g]=Object.assign(Object.assign({},w),{data:w.data?w.data.clone():null})}return u}}const ae=1e20;function se(D,u,g,w,C,L,z,Y,re){for(let le=u;le<u+w;le++)fe(D,g*L+le,L,C,z,Y,re);for(let le=g;le<g+C;le++)fe(D,le*L+u,1,w,z,Y,re)}function fe(D,u,g,w,C,L,z){L[0]=0,z[0]=-ae,z[1]=ae,C[0]=D[u];for(let Y=1,re=0,le=0;Y<w;Y++){C[Y]=D[u+Y*g];const he=Y*Y;do{const Ae=L[re];le=(C[Y]-C[Ae]+he-Ae*Ae)/(Y-Ae)/2}while(le<=z[re]&&--re>-1);re++,L[re]=Y,z[re]=le,z[re+1]=ae}for(let Y=0,re=0;Y<w;Y++){for(;z[re+1]<Y;)re++;const le=L[re],he=Y-le;D[u+Y*g]=C[le]+he*he}}const pe=o.v.layout_symbol["text-font"].default.join(",");class De{constructor(u,g,w){this.requestManager=u,this.localIdeographFontFamily=g,this.entries={},this.lang=w}setURL(u){this.url=u}getGlyphs(u){return o._(this,void 0,void 0,(function*(){const g=[];for(const L in u)for(const z of u[L])g.push(this._getAndCacheGlyphsPromise(L,z));const w=yield Promise.all(g),C={};for(const{stack:L,id:z,glyph:Y}of w)C[L]||(C[L]={}),C[L][z]=Y&&{id:Y.id,bitmap:Y.bitmap.clone(),metrics:Y.metrics};return C}))}_getAndCacheGlyphsPromise(u,g){return o._(this,void 0,void 0,(function*(){let w=this.entries[u];w||(w=this.entries[u]={glyphs:{},requests:{},ranges:{}});let C=w.glyphs[g];return C!==void 0?{stack:u,id:g,glyph:C}:!this.url||this._charUsesLocalIdeographFontFamily(g)?(C=w.glyphs[g]=this._drawGlyph(w,u,g),{stack:u,id:g,glyph:C}):yield this._downloadAndCacheRangePromise(u,g)}))}_downloadAndCacheRangePromise(u,g){return o._(this,void 0,void 0,(function*(){const w=this.entries[u],C=Math.floor(g/256);if(w.ranges[C])return{stack:u,id:g,glyph:null};if(!w.requests[C]){const L=De.loadGlyphRange(u,C,this.url,this.requestManager);w.requests[C]=L}try{const L=yield w.requests[C];for(const z in L)w.glyphs[+z]=L[+z];return w.ranges[C]=!0,{stack:u,id:g,glyph:L[g]||null}}catch(L){const z=w.glyphs[g]=this._drawGlyph(w,u,g);return this._warnOnMissingGlyphRange(z,C,g,L),{stack:u,id:g,glyph:z}}}))}_warnOnMissingGlyphRange(u,g,w,C){const L=256*g,z=L+255,Y=w.toString(16).padStart(4,"0").toUpperCase();o.w(`Unable to load glyph range ${g}, ${L}-${z}. Rendering codepoint U+${Y} locally instead. ${C}`)}_charUsesLocalIdeographFontFamily(u){return!!this.localIdeographFontFamily&&o.q(u)}_drawGlyph(u,g,w){const C=g===pe&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(w),L=C?"ideographTinySDF":"tinySDF";u[L]||(u[L]=this._createTinySDF(C?this.localIdeographFontFamily:g));const z=u[L].draw(String.fromCodePoint(w)),Y=new RegExp("^\\p{gc=Cf}+$","u").test(String.fromCodePoint(w));return{id:w,bitmap:new o.r({width:z.width||60,height:z.height||60},z.data),metrics:{width:Y?0:z.glyphWidth/2||24,height:z.glyphHeight/2||24,left:z.glyphLeft/2+.5||0,top:z.glyphTop/2-27.5||-8,advance:Y?0:z.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(u){const g=u?u.split(","):[];g.push("sans-serif");const w=g.map((C=>/[-\w]+/.test(C)?C:`'${CSS.escape(C)}'`)).join(",");return new De.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:w,fontWeight:this._fontWeight(g[0]),fontStyle:this._fontStyle(g[0]),lang:this.lang})}_fontStyle(u){return/italic/i.test(u)?"italic":/oblique/i.test(u)?"oblique":"normal"}_fontWeight(u){const g={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let w;for(const[C,L]of Object.entries(g))new RegExp(`\\b${C}\\b`,"i").test(u)&&(w=`${L}`);return w}destroy(){for(const u in this.entries){const g=this.entries[u];g.tinySDF&&(g.tinySDF=null),g.ideographTinySDF&&(g.ideographTinySDF=null),g.glyphs={},g.requests={},g.ranges={}}this.entries={}}}De.loadGlyphRange=function(D,u,g,w){return o._(this,void 0,void 0,(function*(){const C=256*u,L=C+255,z=w.transformRequest(g.replace("{fontstack}",D).replace("{range}",`${C}-${L}`),"Glyphs"),Y=yield o.n(z,new AbortController);if(!Y||!Y.data)throw new Error(`Could not load glyph range. range: ${u}, ${C}-${L}`);const re={};for(const le of o.o(Y.data))re[le.id]=le;return re}))},De.TinySDF=class{constructor({fontSize:D=24,buffer:u=3,radius:g=8,cutoff:w=.25,fontFamily:C="sans-serif",fontWeight:L="normal",fontStyle:z="normal",lang:Y=null}={}){this.buffer=u,this.cutoff=w,this.radius=g,this.lang=Y;const re=this.size=D+4*u,le=this._createCanvas(re),he=this.ctx=le.getContext("2d",{willReadFrequently:!0});he.font=`${z} ${L} ${D}px ${C}`,he.textBaseline="alphabetic",he.textAlign="left",he.fillStyle="black",this.gridOuter=new Float64Array(re*re),this.gridInner=new Float64Array(re*re),this.f=new Float64Array(re),this.z=new Float64Array(re+1),this.v=new Uint16Array(re)}_createCanvas(D){const u=document.createElement("canvas");return u.width=u.height=D,u}draw(D){const{width:u,actualBoundingBoxAscent:g,actualBoundingBoxDescent:w,actualBoundingBoxLeft:C,actualBoundingBoxRight:L}=this.ctx.measureText(D),z=Math.ceil(g),Y=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(L-C))),re=Math.min(this.size-this.buffer,z+Math.ceil(w)),le=Y+2*this.buffer,he=re+2*this.buffer,Ae=Math.max(le*he,0),Ce=new Uint8ClampedArray(Ae),Ue={data:Ce,width:le,height:he,glyphWidth:Y,glyphHeight:re,glyphTop:z,glyphLeft:0,glyphAdvance:u};if(Y===0||re===0)return Ue;const{ctx:Ze,buffer:ht,gridInner:pt,gridOuter:dt}=this;this.lang&&(Ze.lang=this.lang),Ze.clearRect(ht,ht,Y,re),Ze.fillText(D,ht,ht+z);const xt=Ze.getImageData(ht,ht,Y,re);dt.fill(ae,0,Ae),pt.fill(0,0,Ae);for(let Ot=0;Ot<re;Ot++)for(let wt=0;wt<Y;wt++){const Lt=xt.data[4*(Ot*Y+wt)+3]/255;if(Lt===0)continue;const jt=(Ot+ht)*le+wt+ht;if(Lt===1)dt[jt]=0,pt[jt]=ae;else{const Dt=.5-Lt;dt[jt]=Dt>0?Dt*Dt:0,pt[jt]=Dt<0?Dt*Dt:0}}se(dt,0,0,le,he,le,this.f,this.v,this.z),se(pt,ht,ht,Y,re,le,this.f,this.v,this.z);for(let Ot=0;Ot<Ae;Ot++){const wt=Math.sqrt(dt[Ot])-Math.sqrt(pt[Ot]);Ce[Ot]=Math.round(255-255*(wt/this.radius+this.cutoff))}return Ue}};class ye{constructor(){this.specification=o.u.light.position}possiblyEvaluate(u,g){return o.F(u.expression.evaluate(g))}interpolate(u,g,w){return{x:o.G.number(u.x,g.x,w),y:o.G.number(u.y,g.y,w),z:o.G.number(u.z,g.z,w)}}}let we;class Te extends o.E{constructor(u){super(),we=we||new o.t({anchor:new o.D(o.u.light.anchor),position:new ye,color:new o.D(o.u.light.color),intensity:new o.D(o.u.light.intensity)}),this._transitionable=new o.x(we,void 0),this.setLight(u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(u,g={}){if(!this._validate(o.y,u,g))for(const w in u){const C=u[w];w.endsWith(o.z)?this._transitionable.setTransition(w.slice(0,-o.z.length),C):this._transitionable.setValue(w,C)}}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,g,w){return(!w||w.validate!==!1)&&o.B(this,u.call(o.C,{value:g,style:{glyphs:!0,sprite:!0},styleSpec:o.u}))}}const Re=new o.t({"sky-color":new o.D(o.u.sky["sky-color"]),"horizon-color":new o.D(o.u.sky["horizon-color"]),"fog-color":new o.D(o.u.sky["fog-color"]),"fog-ground-blend":new o.D(o.u.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.u.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.u.sky["atmosphere-blend"])});class de extends o.E{constructor(u){super(),this._transitionable=new o.x(Re,void 0),this.setSky(u),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0))}setSky(u,g={}){if(!this._validate(o.J,u,g)){u||(u={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const w in u){const C=u[w];w.endsWith(o.z)?this._transitionable.setTransition(w.slice(0,-o.z.length),C):this._transitionable.setValue(w,C)}}}getSky(){return this._transitionable.serialize()}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,g,w={}){return w?.validate!==!1&&o.B(this,u.call(o.C,o.e({value:g,style:{glyphs:!0,sprite:!0},styleSpec:o.u})))}calculateFogBlendOpacity(u){return u<60?0:u<70?(u-60)/10:1}}class Ee{constructor(u,g){this.width=u,this.height=g,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(u,g){const w=u.join(",")+String(g);return this.dashEntry[w]||(this.dashEntry[w]=this.addDash(u,g)),this.dashEntry[w]}getDashRanges(u,g,w){const C=[];let L=u.length%2==1?-u[u.length-1]*w:0,z=u[0]*w,Y=!0;C.push({left:L,right:z,isDash:Y,zeroLength:u[0]===0});let re=u[0];for(let le=1;le<u.length;le++){Y=!Y;const he=u[le];L=re*w,re+=he,z=re*w,C.push({left:L,right:z,isDash:Y,zeroLength:he===0})}return C}addRoundDash(u,g,w){const C=g/2;for(let L=-w;L<=w;L++){const z=this.width*(this.nextRow+w+L);let Y=0,re=u[Y];for(let le=0;le<this.width;le++){le/re.right>1&&(re=u[++Y]);const he=Math.abs(le-re.left),Ae=Math.abs(le-re.right),Ce=Math.min(he,Ae);let Ue;const Ze=L/w*(C+1);if(re.isDash){const ht=C-Math.abs(Ze);Ue=Math.sqrt(Ce*Ce+ht*ht)}else Ue=C-Math.sqrt(Ce*Ce+Ze*Ze);this.data[z+le]=Math.max(0,Math.min(255,Ue+128))}}}addRegularDash(u){for(let Y=u.length-1;Y>=0;--Y){const re=u[Y],le=u[Y+1];re.zeroLength?u.splice(Y,1):le&&le.isDash===re.isDash&&(le.left=re.left,u.splice(Y,1))}const g=u[0],w=u[u.length-1];g.isDash===w.isDash&&(g.left=w.left-this.width,w.right=g.right+this.width);const C=this.width*this.nextRow;let L=0,z=u[L];for(let Y=0;Y<this.width;Y++){Y/z.right>1&&(z=u[++L]);const re=Math.abs(Y-z.left),le=Math.abs(Y-z.right),he=Math.min(re,le);this.data[C+Y]=Math.max(0,Math.min(255,(z.isDash?he:-he)+128))}}addDash(u,g){const w=g?7:0,C=2*w+1;if(this.nextRow+C>this.height)return o.w("LineAtlas out of space"),null;let L=0;for(let Y=0;Y<u.length;Y++)L+=u[Y];if(L!==0){const Y=this.width/L,re=this.getDashRanges(u,this.width,Y);g?this.addRoundDash(re,Y,w):this.addRegularDash(re)}const z={y:this.nextRow+w,height:2*w,width:L};return this.nextRow+=C,this.dirty=!0,z}bind(u){const g=u.gl;this.texture?(g.bindTexture(g.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,g.texSubImage2D(g.TEXTURE_2D,0,0,0,this.width,this.height,g.ALPHA,g.UNSIGNED_BYTE,this.data))):(this.texture=g.createTexture(),g.bindTexture(g.TEXTURE_2D,this.texture),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texImage2D(g.TEXTURE_2D,0,g.ALPHA,this.width,this.height,0,g.ALPHA,g.UNSIGNED_BYTE,this.data))}}const xe="maplibre_preloaded_worker_pool";class Ne{constructor(){this.active={}}acquire(u){if(!this.workers)for(this.workers=[];this.workers.length<Ne.workerCount;)this.workers.push(new Worker(o.c.WORKER_URL));return this.active[u]=!0,this.workers.slice()}release(u){delete this.active[u],this.numActive()===0&&(this.workers.forEach((g=>{g.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[xe]}numActive(){return Object.keys(this.active).length}}const Fe=Math.floor(x.hardwareConcurrency/2);let Xe,Be;function ot(){return Xe||(Xe=new Ne),Xe}Ne.workerCount=o.K(globalThis)?Math.max(Math.min(Fe,3),1):1;class Ke{constructor(u,g){this.workerPool=u,this.actors=[],this.currentActor=0,this.id=g;const w=this.workerPool.acquire(g);for(let C=0;C<w.length;C++){const L=new o.L(w[C],g);L.name=`Worker ${C}`,this.actors.push(L)}if(!this.actors.length)throw new Error("No actors found")}broadcast(u,g){const w=[];for(const C of this.actors)w.push(C.sendAsync({type:u,data:g}));return Promise.all(w)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(u=!0){this.actors.forEach((g=>{g.remove()})),this.actors=[],u&&this.workerPool.release(this.id)}registerMessageHandler(u,g){for(const w of this.actors)w.registerMessageHandler(u,g)}unregisterMessageHandler(u){for(const g of this.actors)g.unregisterMessageHandler(u)}}function it(){return Be||(Be=new Ke(ot(),o.M),Be.registerMessageHandler("GR",((D,u,g)=>o.m(u,g)))),Be}function Me(D,u){const g=o.N();return o.O(g,g,[1,1,0]),o.Q(g,g,[.5*D.width,.5*D.height,1]),D.calculatePosMatrix?o.S(g,g,D.calculatePosMatrix(u.toUnwrapped())):g}function zt(D,u,g,w,C,L,z){var Y;const re=(function(Ce,Ue,Ze){if(Ce)for(const ht of Ce){const pt=Ue[ht];if(pt&&pt.source===Ze&&pt.type==="fill-extrusion")return!0}else for(const ht in Ue){const pt=Ue[ht];if(pt.source===Ze&&pt.type==="fill-extrusion")return!0}return!1})((Y=C?.layers)!==null&&Y!==void 0?Y:null,u,D.id),le=L.maxPitchScaleFactor(),he=D.tilesIn(w,le,re);he.sort(st);const Ae=[];for(const Ce of he)Ae.push({wrappedTileID:Ce.tileID.wrapped().key,queryResults:Ce.tile.queryRenderedFeatures(u,g,D.getState(),Ce.queryGeometry,Ce.cameraQueryGeometry,Ce.scale,C,L,le,Me(L,Ce.tileID),z?(Ue,Ze)=>z(Ce.tileID,Ue,Ze):void 0)});return(function(Ce,Ue){for(const Ze in Ce)for(const ht of Ce[Ze])$e(ht,Ue);return Ce})((function(Ce){const Ue={},Ze={};for(const ht of Ce){const pt=ht.queryResults,dt=ht.wrappedTileID,xt=Ze[dt]=Ze[dt]||{};for(const Ot in pt){const wt=pt[Ot],Lt=xt[Ot]=xt[Ot]||{},jt=Ue[Ot]=Ue[Ot]||[];for(const Dt of wt)Lt[Dt.featureIndex]||(Lt[Dt.featureIndex]=!0,jt.push(Dt))}}return Ue})(Ae),D)}function st(D,u){const g=D.tileID,w=u.tileID;return g.overscaledZ-w.overscaledZ||g.canonical.y-w.canonical.y||g.wrap-w.wrap||g.canonical.x-w.canonical.x}function $e(D,u){const g=D.feature,w=u.getFeatureState(g.layer["source-layer"],g.id);g.source=g.layer.source,g.layer["source-layer"]&&(g.sourceLayer=g.layer["source-layer"]),g.state=w}function Jt(D,u,g){return o._(this,void 0,void 0,(function*(){let w=D;if(D.url?w=(yield o.j(u.transformRequest(D.url,"Source"),g)).data:yield x.frameAsync(g),!w)return null;const C=o.U(o.e(w,D),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in w&&w.vector_layers&&(C.vectorLayerIds=w.vector_layers.map((L=>L.id))),C}))}class Ht{constructor(u,g){u&&(g?this.setSouthWest(u).setNorthEast(g):Array.isArray(u)&&(u.length===4?this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]]):this.setSouthWest(u[0]).setNorthEast(u[1])))}setNorthEast(u){return this._ne=u instanceof o.V?new o.V(u.lng,u.lat):o.V.convert(u),this}setSouthWest(u){return this._sw=u instanceof o.V?new o.V(u.lng,u.lat):o.V.convert(u),this}extend(u){const g=this._sw,w=this._ne;let C,L;if(u instanceof o.V)C=u,L=u;else{if(!(u instanceof Ht))return Array.isArray(u)?u.length===4||u.every(Array.isArray)?this.extend(Ht.convert(u)):this.extend(o.V.convert(u)):u&&("lng"in u||"lon"in u)&&"lat"in u?this.extend(o.V.convert(u)):this;if(C=u._sw,L=u._ne,!C||!L)return this}return g||w?(g.lng=Math.min(C.lng,g.lng),g.lat=Math.min(C.lat,g.lat),w.lng=Math.max(L.lng,w.lng),w.lat=Math.max(L.lat,w.lat)):(this._sw=new o.V(C.lng,C.lat),this._ne=new o.V(L.lng,L.lat)),this}getCenter(){return new o.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.V(this.getWest(),this.getNorth())}getSouthEast(){return new o.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(u){const{lng:g,lat:w}=o.V.convert(u);let C=this._sw.lng<=g&&g<=this._ne.lng;return this._sw.lng>this._ne.lng&&(C=this._sw.lng>=g&&g>=this._ne.lng),this._sw.lat<=w&&w<=this._ne.lat&&C}intersects(u){if(!((u=Ht.convert(u)).getNorth()>=this.getSouth()&&u.getSouth()<=this.getNorth()))return!1;const g=Math.abs(this.getEast()-this.getWest()),w=Math.abs(u.getEast()-u.getWest());if(g>=360||w>=360)return!0;const C=o.W(this.getWest(),-180,180),L=o.W(this.getEast(),-180,180),z=o.W(u.getWest(),-180,180),Y=o.W(u.getEast(),-180,180),re=C>=L,le=z>=Y;return!(!re||!le)||(re?Y>=C||z<=L:le?L>=z||C<=Y:z<=L&&Y>=C)}static convert(u){return u instanceof Ht?u:u&&new Ht(u)}static fromLngLat(u,g=0){const w=360*g/40075017,C=w/Math.cos(Math.PI/180*u.lat);return new Ht(new o.V(u.lng-C,u.lat-w),new o.V(u.lng+C,u.lat+w))}adjustAntiMeridian(){const u=new o.V(this._sw.lng,this._sw.lat),g=new o.V(this._ne.lng,this._ne.lat);return new Ht(u,u.lng>g.lng?new o.V(g.lng+360,g.lat):g)}}class pr{constructor(u,g,w){this.bounds=Ht.convert(this.validateBounds(u)),this.minzoom=g||0,this.maxzoom=w||24}validateBounds(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]}contains(u){const g=Math.pow(2,u.z),w=Math.floor(o.Y(this.bounds.getWest())*g),C=Math.floor(o.X(this.bounds.getNorth())*g),L=Math.ceil(o.Y(this.bounds.getEast())*g),z=Math.ceil(o.X(this.bounds.getSouth())*g);return u.x>=w&&u.x<L&&u.y>=C&&u.y<z}}class _t extends o.E{constructor(u,g,w,C){if(super(),this.id=u,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.U(g,["url","scheme","tileSize","promoteId","encoding"])),this._options=o.e({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield Jt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),u&&(o.e(this,u),u.bounds&&(this.tileBounds=new pr(u.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(u){this._tileJSONRequest=null,this._loaded=!0,o.Z(u)||this.fire(new o.k(u))}}))}loaded(){return this._loaded}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}onAdd(u){this.map=u,this.load()}setSourceProperty(u){this._tileJSONRequest&&this._tileJSONRequest.abort(),u(),this.load()}setTiles(u){return this.setSourceProperty((()=>{this._options.tiles=u})),this}setUrl(u){return this.setSourceProperty((()=>{this.url=u,this._options.url=u})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w={request:this.map._requestManager.transformRequest(g,"Tile"),uid:u.uid,tileID:u.tileID,zoom:u.tileID.overscaledZ,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(u)};w.request.collectResourceTiming=this._collectResourceTiming;let C="RT";if(u.actor&&u.state!=="expired"){if(u.state==="loading")return new Promise(((L,z)=>{u.reloadPromise={resolve:L,reject:z}}))}else u.actor=this.dispatcher.getActor(),C="LT";u.abortController=new AbortController;try{const L=yield u.actor.sendAsync({type:C,data:w},u.abortController);if(delete u.abortController,u.aborted)return;this._afterTileLoadWorkerResponse(u,L)}catch(L){if(delete u.abortController,u.aborted)return;if(L&&L.status!==404)throw L;this._afterTileLoadWorkerResponse(u,null)}}))}_getOverzoomParameters(u){if(u.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const g=u.tileID.scaledTo(this.maxzoom).canonical,w=g.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:g,overzoomRequest:this.map._requestManager.transformRequest(w,"Tile")}}_afterTileLoadWorkerResponse(u,g){if(g&&g.resourceTiming&&(u.resourceTiming=g.resourceTiming),g&&this.map._refreshExpiredTiles&&u.setExpiryData(g),u.loadVectorData(g,this.map.painter),u.reloadPromise){const w=u.reloadPromise;u.reloadPromise=null,this.loadTile(u).then(w.resolve).catch(w.reject)}}abortTile(u){return o._(this,void 0,void 0,(function*(){u.abortController&&(u.abortController.abort(),delete u.abortController),u.actor&&(yield u.actor.sendAsync({type:"AT",data:{uid:u.uid,type:this.type,source:this.id}}))}))}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.unloadVectorData(),u.actor&&(yield u.actor.sendAsync({type:"RMT",data:{uid:u.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class vr extends o.E{constructor(u,g,w,C){super(),this.id=u,this.dispatcher=w,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},g),o.e(this,o.U(g,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,(function*(u=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const g=yield Jt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,g&&(o.e(this,g),g.bounds&&(this.tileBounds=new pr(g.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:u})))}catch(g){this._tileJSONRequest=null,this._loaded=!0,o.Z(g)||this.fire(new o.k(g))}}))}loaded(){return this._loaded}onAdd(u){this.map=u,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(u){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),u(),this.load(!0)}setTiles(u){return this.setSourceProperty((()=>{this._options.tiles=u})),this}setUrl(u){return this.setSourceProperty((()=>{this.url=u,this._options.url=u})),this}serialize(){return o.e({},this._options)}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);u.abortController=new AbortController;try{const w=yield H.getImage(this.map._requestManager.transformRequest(g,"Tile"),u.abortController,this.map._refreshExpiredTiles);if(delete u.abortController,u.aborted)return void(u.state="unloaded");if(w&&w.data){this.map._refreshExpiredTiles&&(w.cacheControl||w.expires)&&u.setExpiryData({cacheControl:w.cacheControl,expires:w.expires});const C=this.map.painter.context,L=C.gl,z=w.data;u.texture=this.map.painter.getTileTexture(z.width),u.texture?u.texture.update(z,{useMipmap:!0}):(u.texture=new o.T(C,z,L.RGBA,{useMipmap:!0}),u.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST)),u.state="loaded"}}catch(w){if(delete u.abortController,u.aborted)u.state="unloaded";else if(w)throw u.state="errored",w}}))}abortTile(u){return o._(this,void 0,void 0,(function*(){u.abortController&&(u.abortController.abort(),delete u.abortController)}))}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.texture&&this.map.painter.saveTileTexture(u.texture)}))}hasTransition(){return!1}}class br extends vr{constructor(u,g,w,C){super(u,g,w,C),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},g),this.encoding=g.encoding||"mapbox",this.redFactor=g.redFactor,this.greenFactor=g.greenFactor,this.blueFactor=g.blueFactor,this.baseShift=g.baseShift}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w=this.map._requestManager.transformRequest(g,"Tile");u.neighboringTiles=this._getNeighboringTiles(u.tileID),u.abortController=new AbortController;try{const C=yield H.getImage(w,u.abortController,this.map._refreshExpiredTiles);if(delete u.abortController,u.aborted)return void(u.state="unloaded");if(C&&C.data){const L=C.data;this.map._refreshExpiredTiles&&(C.cacheControl||C.expires)&&u.setExpiryData({cacheControl:C.cacheControl,expires:C.expires});const z=o.b(L)&&o.$()?L:yield this.readImageNow(L),Y={type:this.type,uid:u.uid,source:this.id,rawImageData:z,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!u.actor||u.state==="expired"){u.actor=this.dispatcher.getActor();const re=yield u.actor.sendAsync({type:"LDT",data:Y});u.dem=re,u.needsHillshadePrepare=!0,u.needsTerrainPrepare=!0,u.state="loaded"}}}catch(C){if(delete u.abortController,u.aborted)u.state="unloaded";else if(C)throw u.state="errored",C}}))}readImageNow(u){return o._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&o.a0()){const g=u.width+2,w=u.height+2;try{return new o.R({width:g,height:w},yield o.a1(u,-1,-1,g,w))}catch{}}return x.getImageData(u,1)}))}_getNeighboringTiles(u){const g=u.canonical,w=Math.pow(2,g.z),C=(g.x-1+w)%w,L=g.x===0?u.wrap-1:u.wrap,z=(g.x+1+w)%w,Y=g.x+1===w?u.wrap+1:u.wrap,re={};return re[new o.a2(u.overscaledZ,L,g.z,C,g.y).key]={backfilled:!1},re[new o.a2(u.overscaledZ,Y,g.z,z,g.y).key]={backfilled:!1},g.y>0&&(re[new o.a2(u.overscaledZ,L,g.z,C,g.y-1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,u.wrap,g.z,g.x,g.y-1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,Y,g.z,z,g.y-1).key]={backfilled:!1}),g.y+1<w&&(re[new o.a2(u.overscaledZ,L,g.z,C,g.y+1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,u.wrap,g.z,g.x,g.y+1).key]={backfilled:!1},re[new o.a2(u.overscaledZ,Y,g.z,z,g.y+1).key]={backfilled:!1}),re}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.demTexture&&this.map.painter.saveTileTexture(u.demTexture),u.fbo&&(u.fbo.destroy(),delete u.fbo),u.dem&&delete u.dem,delete u.neighboringTiles,u.state="unloaded",u.actor&&(yield u.actor.sendAsync({type:"RDT",data:{type:this.type,uid:u.uid,source:this.id}}))}))}}function lr(D){return D.type==="GeometryCollection"?D.geometries.map((u=>u.coordinates)).flat(1/0):D.coordinates.flat(1/0)}function Cr(D){const u=new Ht;let g;switch(D.type){case"FeatureCollection":g=D.features.map((w=>lr(w.geometry))).flat(1/0);break;case"Feature":g=lr(D.geometry);break;default:g=lr(D)}if(g.length==0)return u;for(let w=0;w<g.length-1;w+=2)u.extend([g[w],g[w+1]]);return u}class Tr extends o.E{constructor(u,g,w,C){super(),this.id=u,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:g.data},this.actor=w.getActor(),this.setEventedParent(C),this._data=typeof g.data=="string"?{url:g.data}:{geojson:g.data},this._options=o.e({},g),this._collectResourceTiming=g.collectResourceTiming,g.maxzoom!==void 0&&(this.maxzoom=g.maxzoom),g.type&&(this.type=g.type),g.attribution&&(this.attribution=g.attribution),this.promoteId=g.promoteId,g.clusterMaxZoom!==void 0&&this.maxzoom<=g.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${g.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:g.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(g.buffer!==void 0?g.buffer:128),tolerance:this._pixelsToTileUnits(g.tolerance!==void 0?g.tolerance:.375),extent:o.a5,maxZoom:this.maxzoom,lineMetrics:g.lineMetrics||!1,generateId:g.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(g.clusterMaxZoom),minPoints:Math.max(2,g.clusterMinPoints||2),extent:o.a5,radius:this._pixelsToTileUnits(g.clusterRadius||50),log:!1,generateId:g.generateId||!1},clusterProperties:g.clusterProperties,filter:g.filter},g.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(u){return u*(o.a5/this.tileSize)}_getClusterMaxZoom(u){const g=u?Math.round(u):this.maxzoom-1;return Number.isInteger(u)||u===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${u}" rounded to "${g}"`),g}load(){return o._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(u){this.map=u,this.load()}setData(u,g){this._data=typeof u=="string"?{url:u}:{geojson:u},this._pendingWorkerUpdate={data:u};const w=this._updateWorkerData();return g?w:this}updateData(u,g){this._pendingWorkerUpdate.diff=o.a6(this._pendingWorkerUpdate.diff,u);const w=this._updateWorkerData();return g?w:this}getData(){return o._(this,void 0,void 0,(function*(){const u=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:u})}))}getBounds(){return o._(this,void 0,void 0,(function*(){return Cr(yield this.getData())}))}setClusterOptions(u){return this.workerOptions.cluster=u.cluster,u.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(u.clusterRadius)),u.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(u.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(u){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:u,source:this.id}})}getClusterChildren(u){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:u,source:this.id}})}getClusterLeaves(u,g,w){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:u,limit:g,offset:w}})}_updateWorkerData(){return o._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void o.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:u,diff:g}=this._pendingWorkerUpdate,w=o.e({type:this.type},this.workerOptions);u!==void 0?(typeof u=="string"?(w.request=this.map._requestManager.transformRequest(x.resolveURL(u),"Source"),w.request.collectResourceTiming=this._collectResourceTiming):w.data=u,this._pendingWorkerUpdate.data=void 0):g&&(w.dataDiff=g,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new o.l("dataloading",{dataType:"source"}));try{const C=yield this.actor.sendAsync({type:"LD",data:w});if(this._isUpdatingWorker=!1,this._removed||C.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));C.data&&(this._data={geojson:C.data});const L=this._applyDiffToSource(g),z=this._getShouldReloadTileOptions(L);let Y=null;C.resourceTiming&&C.resourceTiming[this.id]&&(Y=C.resourceTiming[this.id].slice(0));const re={dataType:"source"};this._collectResourceTiming&&Y&&Y.length>0&&o.e(re,{resourceTiming:Y}),this.fire(new o.l("data",Object.assign(Object.assign({},re),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},re),{sourceDataType:"content",shouldReloadTileOptions:z})))}catch(C){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(C))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyDiffToSource(u){if(!u)return;const g=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const C=o.a7(this._data.geojson,g);if(!C)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:C}}if(!this._data.updateable)return;const w=o.a8(this._data.updateable,u,g);return u.removeAll||this._options.cluster?void 0:w}_getShouldReloadTileOptions(u){if(u)return{affectedBounds:u.filter(Boolean).map((g=>Cr(g)))}}shouldReloadTile(u,{affectedBounds:g}){if(u.state==="loading")return!0;if(u.state==="unloaded")return!1;const{buffer:w,extent:C}=this.workerOptions.geojsonVtOptions,L=(function({x:z,y:Y,z:re},le=0){const he=o.a3((z-le)/Math.pow(2,re)),Ae=o.a4((Y+1+le)/Math.pow(2,re)),Ce=o.a3((z+1+le)/Math.pow(2,re)),Ue=o.a4((Y-le)/Math.pow(2,re));return new Ht([he,Ae],[Ce,Ue])})(u.tileID.canonical,w/C);for(const z of g)if(L.intersects(z))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(u){return o._(this,void 0,void 0,(function*(){const g=u.actor?"RT":"LT";u.actor=this.actor;const w={type:this.type,uid:u.uid,tileID:u.tileID,zoom:u.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};u.abortController=new AbortController;const C=yield this.actor.sendAsync({type:g,data:w},u.abortController);delete u.abortController,u.unloadVectorData(),u.aborted||u.loadVectorData(C,this.map.painter,g==="RT")}))}abortTile(u){return o._(this,void 0,void 0,(function*(){u.abortController&&(u.abortController.abort(),delete u.abortController),u.aborted=!0}))}unloadTile(u){return o._(this,void 0,void 0,(function*(){u.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:u.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class Qt extends o.E{constructor(u,g,w,C){super(),this.flippedWindingOrder=!1,this.id=u,this.dispatcher=w,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=g}load(u){return o._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const g=yield H.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,g&&g.data&&(this.image=g.data,u&&(this.coordinates=u),this._finishLoading())}catch(g){this._request=null,this._loaded=!0,o.Z(g)||this.fire(new o.k(g))}}))}loaded(){return this._loaded}updateImage(u){return u.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=u.url,this.load(u.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(u){this.map=u,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(u){this.coordinates=u;const g=u.map(o.a9.fromLngLat);var w;return this.tileID=(function(C){const L=o.aa.fromPoints(C),z=L.width(),Y=L.height(),re=Math.max(z,Y),le=Math.max(0,Math.floor(-Math.log(re)/Math.LN2)),he=Math.pow(2,le);return new o.ac(le,Math.floor((L.minX+L.maxX)/2*he),Math.floor((L.minY+L.maxY)/2*he))})(g),this.terrainTileRanges=this._getOverlappingTileRanges(g),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=g.map((C=>this.tileID.getTilePoint(C)._round())),this.flippedWindingOrder=((w=this.tileCoords)[1].x-w[0].x)*(w[2].y-w[0].y)-(w[1].y-w[0].y)*(w[2].x-w[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const u=this.map.painter.context,g=u.gl;this.texture||(this.texture=new o.T(u,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE));let w=!1;for(const C in this.tiles){const L=this.tiles[C];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture,w=!0)}w&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(u){return o._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(u.tileID.canonical)?(this.tiles[String(u.tileID.wrap)]=u,u.buckets={}):u.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(u){const{minX:g,minY:w,maxX:C,maxY:L}=o.aa.fromPoints(u),z={};for(let Y=0;Y<=o.ab;Y++){const re=Math.pow(2,Y),le=Math.floor(g*re),he=Math.floor(w*re),Ae=Math.floor(C*re),Ce=Math.floor(L*re),Ue=(le%re+re)%re,Ze=Ae%re,ht=Math.floor(le/re),pt=Math.floor(Ae/re);z[Y]={minWrap:ht,maxWrap:pt,minTileXWrapped:Ue,maxTileXWrapped:Ze,minTileY:he,maxTileY:Ce}}return z}}class at extends Qt{constructor(u,g,w,C){super(u,g,w,C),this.roundZoom=!0,this.type="video",this.options=g}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!1;const u=this.options;this.urls=[];for(const g of u.urls)this.urls.push(this.map._requestManager.transformRequest(g,"Source").url);try{const g=yield o.ad(this.urls);if(this._loaded=!0,!g)return;this.video=g,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(g){this.fire(new o.k(g))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(u){if(this.video){const g=this.video.seekable;u<g.start(0)||u>g.end(0)?this.fire(new o.k(new o.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${g.start(0)} and ${g.end(0)}-second mark.`))):this.video.currentTime=u}}getVideo(){return this.video}onAdd(u){this.map||(this.map=u,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const u=this.map.painter.context,g=u.gl;this.texture?this.video.paused||(this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(u,this.video,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE));let w=!1;for(const C in this.tiles){const L=this.tiles[C];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture,w=!0)}w&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Pe extends Qt{constructor(u,g,w,C){super(u,g,w,C),g.coordinates?Array.isArray(g.coordinates)&&g.coordinates.length===4&&!g.coordinates.some((L=>!Array.isArray(L)||L.length!==2||L.some((z=>typeof z!="number"))))||this.fire(new o.k(new o.ae(`sources.${u}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.ae(`sources.${u}`,null,'missing required property "coordinates"'))),g.animate&&typeof g.animate!="boolean"&&this.fire(new o.k(new o.ae(`sources.${u}`,null,'optional "animate" property must be a boolean value'))),g.canvas?typeof g.canvas=="string"||g.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.ae(`sources.${u}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.ae(`sources.${u}`,null,'missing required property "canvas"'))),this.options=g,this.animate=g.animate===void 0||g.animate}load(){return o._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(u){this.map=u,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let u=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,u=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,u=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const g=this.map.painter.context,w=g.gl;this.texture?(u||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new o.T(g,this.canvas,w.RGBA,{premultiply:!0}),this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE));let C=!1;for(const L in this.tiles){const z=this.tiles[L];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture,C=!0)}C&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const u of[this.canvas.width,this.canvas.height])if(isNaN(u)||u<=0)return!0;return!1}}const be={},je=D=>{switch(D){case"geojson":return Tr;case"image":return Qt;case"raster":return vr;case"raster-dem":return br;case"vector":return _t;case"video":return at;case"canvas":return Pe}return be[D]},qe="RTLPluginLoaded";class Ge extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=it()}_syncState(u){return this.status=u,this.dispatcher.broadcast("SRPS",{pluginStatus:u,pluginURL:this.url}).catch((g=>{throw this.status="error",g}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(u){return o._(this,arguments,void 0,(function*(g,w=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=x.resolveURL(g),!this.url)throw new Error(`requested url ${g} is invalid`);if(this.status==="unavailable"){if(!w)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return o._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(qe))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Nt=null;function Et(){return Nt||(Nt=new Ge),Nt}var mt,ct;(function(D){D[D.Base=0]="Base",D[D.Parent=1]="Parent"})(mt||(mt={})),(function(D){D[D.Departing=0]="Departing",D[D.Incoming=1]="Incoming"})(ct||(ct={}));class Kt{constructor(u,g){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=u,this.uid=o.af(),this.uses=0,this.tileSize=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(u){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(u||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:u,fadingDirection:g,fadingParentID:w,fadeEndTime:C}){this.resetFadeLogic(),this.fadingRole=u,this.fadingDirection=g,this.fadingParentID=w,this.fadeEndTime=C}setSelfFadeLogic(u){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=u}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=T(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(u){this.demTexture&&u.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(u,g,w){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",u){u.featureIndex&&(this.latestFeatureIndex=u.featureIndex,u.rawTileData?(this.latestRawTileData=u.rawTileData,this.latestFeatureIndex.rawTileData=u.rawTileData,this.latestFeatureIndex.encoding=u.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=u.collisionBoxArray,this.buckets=(function(C,L){const z={};if(!L)return z;for(const Y of C){const re=Y.layerIds.map((le=>L.getLayer(le))).filter(Boolean);if(re.length!==0){Y.layers=re,Y.stateDependentLayerIds&&(Y.stateDependentLayers=Y.stateDependentLayerIds.map((le=>re.filter((he=>he.id===le))[0])));for(const le of re)z[le.id]=Y}}return z})(u.buckets,g?.style),this.hasSymbolBuckets=!1;for(const C in this.buckets){const L=this.buckets[C];if(L instanceof o.ah){if(this.hasSymbolBuckets=!0,!w)break;L.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const C in this.buckets){const L=this.buckets[C];if(L instanceof o.ah&&L.hasRTLText){this.hasRTLText=!0,Et().lazyLoad();break}}this.queryPadding=0;for(const C in this.buckets){const L=this.buckets[C];this.queryPadding=Math.max(this.queryPadding,g.style.getLayer(C).queryRadius(L))}u.imageAtlas&&(this.imageAtlas=u.imageAtlas),u.glyphAtlasImage&&(this.glyphAtlasImage=u.glyphAtlasImage),this.dashPositions=u.dashPositions}else this.collisionBoxArray=new o.ag}unloadVectorData(){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(u){return this.buckets[u.id]}upload(u){for(const w in this.buckets){const C=this.buckets[w];C.uploadPending()&&C.upload(u)}const g=u.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(u,this.imageAtlas.image,g.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(u,this.glyphAtlasImage,g.ALPHA),this.glyphAtlasImage=null)}prepare(u){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(u,this.imageAtlasTexture)}queryRenderedFeatures(u,g,w,C,L,z,Y,re,le,he,Ae){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:C,cameraQueryGeometry:L,scale:z,tileSize:this.tileSize,pixelPosMatrix:he,transform:re,params:Y,queryPadding:this.queryPadding*le,getElevation:Ae},u,g,w):{}}querySourceFeatures(u,g){const w=this.latestFeatureIndex;if(!w||!w.rawTileData)return;const C=w.loadVTLayers(),L=g&&g.sourceLayer?g.sourceLayer:"",z=C[o.ai]||C[L];if(!z)return;const Y=o.aj(g?.filter,g?.globalState),{z:re,x:le,y:he}=this.tileID.canonical,Ae={z:re,x:le,y:he};for(let Ce=0;Ce<z.length;Ce++){const Ue=z.feature(Ce);if(Y.needGeometry){const pt=o.ak(Ue,!0);if(!Y.filter(new o.H(this.tileID.overscaledZ),pt,this.tileID.canonical))continue}else if(!Y.filter(new o.H(this.tileID.overscaledZ),Ue))continue;const Ze=w.getId(Ue,L),ht=new o.al(Ue,re,le,he,Ze);ht.tile=Ae,u.push(ht)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(u){const g=this.expirationTime;if(u.cacheControl){const w=o.am(u.cacheControl);w["max-age"]&&(this.expirationTime=Date.now()+1e3*w["max-age"])}else u.expires&&(this.expirationTime=new Date(u.expires).getTime());if(this.expirationTime){const w=Date.now();let C=!1;if(this.expirationTime>w)C=!1;else if(g)if(this.expirationTime<g)C=!0;else{const L=this.expirationTime-g;L?this.expirationTime=w+Math.max(L,3e4):C=!0}else C=!0;C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(u,g){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(u).length===0)return;const w=this.latestFeatureIndex.loadVTLayers();for(const C in this.buckets){if(!g.style.hasLayer(C))continue;const L=this.buckets[C],z=L.layers[0].sourceLayer||o.ai,Y=w[z],re=u[z];if(!Y||!re||Object.keys(re).length===0)continue;L.update(re,Y,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const le=g&&g.style&&g.style.getLayer(C);le&&(this.queryPadding=Math.max(this.queryPadding,le.queryRadius(L)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<T()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(u){this.symbolFadeHoldUntil=T()+u}setDependencies(u,g){const w={};for(const C of g)w[C]=!0;this.dependencies[u]=w}hasDependency(u,g){for(const w of u){const C=this.dependencies[w];if(C){for(const L of g)if(C[L])return!0}}return!1}}class qt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(u,g,w){const C=String(g);if(this.stateChanges[u]=this.stateChanges[u]||{},this.stateChanges[u][C]=this.stateChanges[u][C]||{},o.e(this.stateChanges[u][C],w),this.deletedStates[u]===null){this.deletedStates[u]={};for(const L in this.state[u])L!==C&&(this.deletedStates[u][L]=null)}else if(this.deletedStates[u]&&this.deletedStates[u][C]===null){this.deletedStates[u][C]={};for(const L in this.state[u][C])w[L]||(this.deletedStates[u][C][L]=null)}else for(const L in w)this.deletedStates[u]&&this.deletedStates[u][C]&&this.deletedStates[u][C][L]===null&&delete this.deletedStates[u][C][L]}removeFeatureState(u,g,w){if(this.deletedStates[u]===null)return;const C=String(g);if(this.deletedStates[u]=this.deletedStates[u]||{},w&&g!==void 0)this.deletedStates[u][C]!==null&&(this.deletedStates[u][C]=this.deletedStates[u][C]||{},this.deletedStates[u][C][w]=null);else if(g!==void 0)if(this.stateChanges[u]&&this.stateChanges[u][C])for(w in this.deletedStates[u][C]={},this.stateChanges[u][C])this.deletedStates[u][C][w]=null;else this.deletedStates[u][C]=null;else this.deletedStates[u]=null}getState(u,g){const w=String(g),C=o.e({},(this.state[u]||{})[w],(this.stateChanges[u]||{})[w]);if(this.deletedStates[u]===null)return{};if(this.deletedStates[u]){const L=this.deletedStates[u][g];if(L===null)return{};for(const z in L)delete C[z]}return C}initializeTileState(u,g){u.setFeatureState(this.state,g)}coalesceChanges(u,g){const w={};for(const C in this.stateChanges){this.state[C]=this.state[C]||{};const L={};for(const z in this.stateChanges[C])this.state[C][z]||(this.state[C][z]={}),o.e(this.state[C][z],this.stateChanges[C][z]),L[z]=this.state[C][z];w[C]=L}for(const C in this.deletedStates){this.state[C]=this.state[C]||{};const L={};if(this.deletedStates[C]===null)for(const z in this.state[C])L[z]={},this.state[C][z]={};else for(const z in this.deletedStates[C]){if(this.deletedStates[C][z]===null)this.state[C][z]={};else for(const Y of Object.keys(this.deletedStates[C][z]))delete this.state[C][z][Y];L[z]=this.state[C][z]}w[C]=w[C]||{},o.e(w[C],L)}this.stateChanges={},this.deletedStates={},Object.keys(w).length!==0&&u.setFeatureState(w,g)}}const Ir=89.25;function Ar(D,u){const g=o.an(u.lat,-o.ao,o.ao);return new o.P(o.Y(u.lng)*D,o.X(g)*D)}function $r(D,u){return new o.a9(u.x/D,u.y/D).toLngLat()}function cn(D){return D.cameraToCenterDistance*Math.min(.85*Math.tan(o.ap(90-D.pitch)),Math.tan(o.ap(Ir-D.pitch)))}function zr(D,u){const g=D.canonical,w=u/o.aq(g.z),C=g.x+Math.pow(2,g.z)*D.wrap,L=o.ar(new Float64Array(16));return o.O(L,L,[C*w,g.y*w,0]),o.Q(L,L,[w/o.a5,w/o.a5,1]),L}function Rt(D,u,g,w,C){const L=o.a9.fromLngLat(D,u),z=C*o.as(1,D.lat),{x:Y,y:re,z:le}=en(g,w);return new o.a9(L.x+z*-Y,L.y+z*-re,L.z+z*-le)}function en(D,u){const g=o.ap(D),w=o.ap(u),C=Math.cos(-g),L=Math.sin(g);return{x:L*Math.sin(w),y:-L*Math.cos(w),z:C}}function jn(D,u,g){const w=u.intersectsFrustum(D);if(!g||w===0)return w;const C=u.intersectsPlane(g);return C===0?0:w===2&&C===2?2:1}function Qr(D,u,g){let w=0;const C=(g-u)/10;for(let L=0;L<10;L++)w+=C*Math.pow(Math.cos(u+(L+.5)/10*(g-u)),D);return w}function nr(D,u){return function(g,w,C,L,z){const Y=2*((D-1)/o.at(Math.cos(o.ap(Ir-z))/Math.cos(o.ap(Ir)))-1),re=Math.acos(C/L),le=2*Qr(Y-1,0,o.ap(z/2)),he=Math.min(o.ap(Ir),re+o.ap(z/2)),Ae=Qr(Y-1,Math.min(he,re-o.ap(z/2)),he),Ce=Math.atan(w/C),Ue=Math.hypot(w,C);let Ze=g;return Ze+=o.at(L/Ue/Math.max(.5,Math.cos(o.ap(z/2)))),Ze+=Y*o.at(Math.cos(Ce))/2,Ze-=o.at(Math.max(1,Ae/le/u))/2,Ze}}const oi=nr(9.314,3);function ln(D,u){const g=(u.roundZoom?Math.round:Math.floor)(D.zoom+o.at(D.tileSize/u.tileSize));return Math.max(0,g)}function Kn(D,u){const g=D.getCameraFrustum(),w=D.getClippingPlane(),C=D.screenPointToMercatorCoordinate(D.getCameraPoint()),L=o.a9.fromLngLat(D.center,D.elevation);C.z=L.z+Math.cos(D.pitchInRadians)*D.cameraToCenterDistance/D.worldSize;const z=D.getCoveringTilesDetailsProvider(),Y=z.allowVariableZoom(D,u),re=ln(D,u),le=u.minzoom||0,he=u.maxzoom!==void 0?u.maxzoom:D.maxZoom,Ae=Math.min(Math.max(0,re),he),Ce=Math.pow(2,Ae),Ue=[Ce*C.x,Ce*C.y,0],Ze=[Ce*L.x,Ce*L.y,0],ht=Math.hypot(L.x-C.x,L.y-C.y),pt=Math.abs(L.z-C.z),dt=Math.hypot(ht,pt),xt=Lt=>({zoom:0,x:0,y:0,wrap:Lt,fullyVisible:!1}),Ot=[],wt=[];if(D.renderWorldCopies&&z.allowWorldCopies())for(let Lt=1;Lt<=3;Lt++)Ot.push(xt(-Lt)),Ot.push(xt(Lt));for(Ot.push(xt(0));Ot.length>0;){const Lt=Ot.pop(),jt=Lt.x,Dt=Lt.y;let Yt=Lt.fullyVisible;const Sr={x:jt,y:Dt,z:Lt.zoom},dr=z.getTileBoundingVolume(Sr,Lt.wrap,D.elevation,u);if(!Yt){const sn=jn(g,dr,w);if(sn===0)continue;Yt=sn===2}const yr=z.distanceToTile2d(C.x,C.y,Sr,dr);let xr=re;Y&&(xr=(u.calculateTileZoom||oi)(D.zoom+o.at(D.tileSize/u.tileSize),yr,pt,dt,D.fov)),xr=(u.roundZoom?Math.round:Math.floor)(xr),xr=Math.max(0,xr);const nn=Math.min(xr,he);if(Lt.wrap=z.getWrap(L,Sr,Lt.wrap),Lt.zoom>=nn){if(Lt.zoom<le)continue;const sn=Ae-Lt.zoom,Hr=Ue[0]-.5-(jt<<sn),pn=Ue[1]-.5-(Dt<<sn),Ti=u.reparseOverscaled?Math.max(Lt.zoom,xr):Lt.zoom;wt.push({tileID:new o.a2(Lt.zoom===he?Ti:Lt.zoom,Lt.wrap,Lt.zoom,jt,Dt),distanceSq:o.au([Ze[0]-.5-jt,Ze[1]-.5-Dt]),tileDistanceToCamera:Math.sqrt(Hr*Hr+pn*pn)})}else for(let sn=0;sn<4;sn++)Ot.push({zoom:Lt.zoom+1,x:(jt<<1)+sn%2,y:(Dt<<1)+(sn>>1),wrap:Lt.wrap,fullyVisible:Yt})}return wt.sort(((Lt,jt)=>Lt.distanceSq-jt.distanceSq)).map((Lt=>Lt.tileID))}const ke=o.aa.fromPoints([new o.P(0,0),new o.P(o.a5,o.a5)]);function He(D){return D==="raster"||D==="image"||D==="video"}function Tt(D,u,g,w,C,L,z){if(!u.hasData())return!1;const{tileID:Y,fadingRole:re,fadingDirection:le,fadingParentID:he}=u;if(re===mt.Base&&le===ct.Incoming&&he)return g[he.key]=he,!0;const Ae=Math.max(Y.overscaledZ-C,L);for(let Ce=Y.overscaledZ-1;Ce>=Ae;Ce--){const Ue=Y.scaledTo(Ce),Ze=D.getLoadedTile(Ue);if(Ze)return u.setCrossFadeLogic({fadingRole:mt.Base,fadingDirection:ct.Incoming,fadingParentID:Ze.tileID,fadeEndTime:w+z}),Ze.setCrossFadeLogic({fadingRole:mt.Parent,fadingDirection:ct.Departing,fadeEndTime:w+z}),g[Ue.key]=Ue,!0}return!1}function Gt(D,u,g,w,C,L){if(!u.hasData())return!1;const z=u.tileID.children(C);let Y=Ut(D,u,z,g,w,C,L);if(Y)return!0;for(const re of z)Ut(D,u,re.children(C),g,w,C,L)&&(Y=!0);return Y}function Ut(D,u,g,w,C,L,z){if(g[0].overscaledZ>=L)return!1;let Y=!1;for(const re of g){const le=D.getLoadedTile(re);if(!le)continue;const{fadingRole:he,fadingDirection:Ae,fadingParentID:Ce}=le;he===mt.Base&&Ae===ct.Departing&&Ce||(le.setCrossFadeLogic({fadingRole:mt.Base,fadingDirection:ct.Departing,fadingParentID:u.tileID,fadeEndTime:C+z}),u.setCrossFadeLogic({fadingRole:mt.Parent,fadingDirection:ct.Incoming,fadeEndTime:C+z})),w[re.key]=re,Y=!0}return Y}function Xr(D,u,g,w){const C=D.tileID;return!!D.selfFading||!D.hasData()&&!!u.has(C)&&(D.setSelfFadeLogic(g+w),!0)}function Ln(D,u){var g;D.needsHillshadePrepare=!0,D.needsTerrainPrepare=!0;let w=u.tileID.canonical.x-D.tileID.canonical.x;const C=u.tileID.canonical.y-D.tileID.canonical.y,L=Math.pow(2,D.tileID.canonical.z),z=u.tileID.key;w===0&&C===0||Math.abs(C)>1||(Math.abs(w)>1&&(Math.abs(w+L)===1?w+=L:Math.abs(w-L)===1&&(w-=L)),u.dem&&D.dem&&(D.dem.backfillBorder(u.dem,w,C),!((g=D.neighboringTiles)===null||g===void 0)&&g[z]&&(D.neighboringTiles[z].backfilled=!0)))}class Bi{constructor(){this._tiles={}}handleWrapJump(u){const g={};for(const w in this._tiles){const C=this._tiles[w];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+u),g[C.tileID.key]=C}this._tiles=g}setFeatureState(u,g){for(const w in this._tiles)this._tiles[w].setFeatureState(u,g)}getAllTiles(){return Object.values(this._tiles)}getAllIds(u=!1){return u?Object.values(this._tiles).map((g=>g.tileID)).sort(o.aw).map((g=>g.key)):Object.keys(this._tiles)}getTileById(u){return this._tiles[u]}setTile(u,g){this._tiles[u]=g}deleteTileById(u){delete this._tiles[u]}getLoadedTile(u){const g=this.getTileById(u.key);return g?.hasData()?g:null}isIdRenderable(u,g=!1){var w;return(w=this.getTileById(u))===null||w===void 0?void 0:w.isRenderable(g)}getRenderableIds(u=0,g){const w=[];for(const C of this.getAllIds())this.isIdRenderable(C,g)&&w.push(this.getTileById(C));return g?w.sort(((C,L)=>{const z=C.tileID,Y=L.tileID,re=new o.P(z.canonical.x,z.canonical.y)._rotate(-u),le=new o.P(Y.canonical.x,Y.canonical.y)._rotate(-u);return z.overscaledZ-Y.overscaledZ||le.y-re.y||le.x-re.x})).map((C=>C.tileID.key)):w.map((C=>C.tileID)).sort(o.aw).map((C=>C.key))}}class Ci extends o.E{constructor(u,g,w){super(),this.id=u,this.dispatcher=w,this.on("data",(C=>this._dataHandler(C))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((C,L,z,Y)=>{const re=new(je(L.type))(C,L,z,Y);if(re.id!==C)throw new Error(`Expected Source id to be ${C} instead of ${re.id}`);return re})(u,g,w,this),this._inViewTiles=new Bi,this._outOfViewCache=new o.ax(0,(C=>this._unloadTile(C))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new qt,this._didEmitContent=!1,this._updated=!1}onAdd(u){this.map=u,this._maxTileCacheSize=u?u._maxTileCacheSize:null,this._maxTileCacheZoomLevels=u?u._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(u)}onRemove(u){for(const g of this._inViewTiles.getAllTiles())g.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(u),this._inViewTiles=new Bi}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const u of this._inViewTiles.getAllTiles())if(u.state!=="loaded"&&u.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const u=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,u&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(u,g,w){return o._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(u),this._tileLoaded(u,g,w)}catch(C){u.state="errored",C.status!==404?this._source.fire(new o.k(C,{tile:u})):this.update(this.transform,this.terrain)}}))}_unloadTile(u){this._source.unloadTile&&this._source.unloadTile(u)}_abortTile(u){this._source.abortTile&&this._source.abortTile(u),this._source.fire(new o.l("dataabort",{tile:u,coord:u.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(u){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const g of this._inViewTiles.getAllTiles())g.upload(u),g.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(u){var g;return this._inViewTiles.getRenderableIds((g=this.transform)===null||g===void 0?void 0:g.bearingInRadians,u)}hasRenderableParent(u){const g=u.overscaledZ-1;if(g>=this._source.minzoom){const w=this.getLoadedTile(u.scaledTo(g));if(w)return this._inViewTiles.isIdRenderable(w.tileID.key)}return!1}reload(u,g=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const w of this._inViewTiles.getAllIds()){const C=this._inViewTiles.getTileById(w);g&&!this._source.shouldReloadTile(C,g)||(u?this._reloadTile(w,"expired"):C.state!=="errored"&&this._reloadTile(w,"reloading"))}}}_reloadTile(u,g){return o._(this,void 0,void 0,(function*(){const w=this._inViewTiles.getTileById(u);w&&(w.state!=="loading"&&(w.state=g),yield this._loadTile(w,u,g))}))}_tileLoaded(u,g,w){u.timeAdded=T(),u.selfFading&&(u.fadeEndTime=u.timeAdded+this._rasterFadeDuration),w==="expired"&&(u.refreshedUponExpiration=!0),this._setTileReloadTimer(g,u),this.getSource().type==="raster-dem"&&u.dem&&(function(C,L){var z,Y;const re=L.getRenderableIds();for(const le of re){if(!C.neighboringTiles||!C.neighboringTiles[le])continue;const he=L.getTileById(le);C.neighboringTiles[le].backfilled||Ln(C,he),!((Y=(z=he.neighboringTiles)===null||z===void 0?void 0:z[C.tileID.key])===null||Y===void 0)&&Y.backfilled||Ln(he,C)}})(u,this._inViewTiles),this._state.initializeTileState(u,this.map?this.map.painter:null),u.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:u,coord:u.tileID}))}getTile(u){return this.getTileByID(u.key)}getTileByID(u){return this._inViewTiles.getTileById(u)}_retainLoadedChildren(u,g){const w=this._getLoadedDescendents(g),C=new Set;for(const L of g){const z=w[L.key];if(!z?.length){C.add(L);continue}const Y=L.overscaledZ+Ci.maxOverzooming,re=z.filter((Ae=>Ae.tileID.overscaledZ<=Y));if(!re.length){C.add(L);continue}const le=Math.min(...re.map((Ae=>Ae.tileID.overscaledZ))),he=re.filter((Ae=>Ae.tileID.overscaledZ===le)).map((Ae=>Ae.tileID));for(const Ae of he)u[Ae.key]=Ae;this._areDescendentsComplete(he,le,L.overscaledZ)||C.add(L)}return C}_getLoadedDescendents(u){var g;const w={};for(const C of this._inViewTiles.getAllTiles().filter((L=>L.hasData())))for(const L of u)C.tileID.isChildOf(L)&&(w[g=L.key]||(w[g]=[])).push(C);return w}_areDescendentsComplete(u,g,w){return u.length===1&&u[0].isOverscaled()?u[0].overscaledZ===g:Math.pow(4,g-w)===u.length}getLoadedTile(u){return this._inViewTiles.getLoadedTile(u)}updateCacheSize(u){const g=Math.ceil(u.width/this._source.tileSize)+1,w=Math.ceil(u.height/this._source.tileSize)+1,C=Math.floor(g*w*(this._maxTileCacheZoomLevels===null?o.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._outOfViewCache.setMaxSize(L)}handleWrapJump(u){const g=Math.round((u-(this._prevLng===void 0?u:this._prevLng))/360);this._prevLng=u,g&&(this._inViewTiles.handleWrapJump(g),this._resetTileReloadTimers())}update(u,g){if(!this._sourceLoaded||this._paused)return;let w;this.transform=u,this.terrain=g,this.updateCacheSize(u),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?w=u.getVisibleUnwrappedCoordinates(this._source.tileID).map((re=>new o.a2(re.canonical.z,re.wrap,re.canonical.z,re.canonical.x,re.canonical.y))):(w=Kn(u,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?u.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:g,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(w=w.filter((re=>this._source.hasTile(re))))):w=[],this.usedForTerrain&&(w=this._addTerrainIdealTiles(w));const C=w.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const L=ln(u,this._source),z=this._updateRetainedTiles(w,L),Y=He(this._source.type);Y&&this._rasterFadeDuration>0&&!g&&(function(re,le,he,Ae,Ce,Ue,Ze){const ht=T(),pt=o.av(le);for(const dt of le){const xt=re.getTileById(dt.key);xt.fadingDirection!==ct.Departing&&xt.fadeOpacity!==0||xt.resetFadeLogic(),Tt(re,xt,he,ht,Ae,Ce,Ze)||Gt(re,xt,he,ht,Ue,Ze)||Xr(xt,pt,ht,Ze)||xt.resetFadeLogic()}})(this._inViewTiles,w,z,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),Y?this._cleanUpRasterTiles(z):this._cleanUpVectorTiles(z)}_cleanUpRasterTiles(u){for(const g of this._inViewTiles.getAllIds())u[g]||this._removeTile(g)}_cleanUpVectorTiles(u){for(const g of this._inViewTiles.getAllIds()){const w=this._inViewTiles.getTileById(g);u[g]?w.clearSymbolFadeHold():w.hasSymbolBuckets?w.holdingForSymbolFade()?w.symbolFadeFinished()&&this._removeTile(g):w.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(g)}}_addTerrainIdealTiles(u){const g=[];for(const w of u)if(w.canonical.z>this._source.minzoom){const C=w.scaledTo(w.canonical.z-1);g.push(C);const L=w.scaledTo(Math.max(this._source.minzoom,Math.min(w.canonical.z,5)));g.push(L)}return u.concat(g)}releaseSymbolFadeTiles(){for(const u of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(u).holdingForSymbolFade()&&this._removeTile(u)}_updateRetainedTiles(u,g){var w;const C=new Set;for(const le of u)this._addTile(le).hasData()||C.add(le);const L=u.reduce(((le,he)=>(le[he.key]=he,le)),{}),z=this._retainLoadedChildren(L,C),Y={},re=Math.max(g-Ci.maxUnderzooming,this._source.minzoom);for(const le of z){let he=this._inViewTiles.getTileById(le.key),Ae=he?.wasRequested();for(let Ce=le.overscaledZ-1;Ce>=re;--Ce){const Ue=le.scaledTo(Ce);if(Y[Ue.key])break;if(Y[Ue.key]=!0,he=this.getTile(Ue),!he&&Ae&&(he=this._addTile(Ue)),he){const Ze=he.hasData();if((Ze||!(!((w=this.map)===null||w===void 0)&&w.cancelPendingTileRequestsWhileZooming)||Ae)&&(L[Ue.key]=Ue),Ae=he.wasRequested(),Ze)break}}}return L}_addTile(u){let g=this._inViewTiles.getTileById(u.key);if(g)return g;g=this._outOfViewCache.getAndRemove(u),g&&(g.resetFadeLogic(),this._setTileReloadTimer(u.key,g),g.tileID=u,this._state.initializeTileState(g,this.map?this.map.painter:null));const w=g;return g||(g=new Kt(u,this._source.tileSize*u.overscaleFactor()),this._loadTile(g,u.key,g.state)),g.uses++,this._inViewTiles.setTile(u.key,g),w||this._source.fire(new o.l("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g}_setTileReloadTimer(u,g){this._clearTileReloadTimer(u);const w=g.getExpiryTimeout();w&&(this._timers[u]=setTimeout((()=>{this._reloadTile(u,"expired"),delete this._timers[u]}),w))}_clearTileReloadTimer(u){const g=this._timers[u];g&&(clearTimeout(g),delete this._timers[u])}_resetTileReloadTimers(){for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u of this._inViewTiles.getAllIds()){const g=this._inViewTiles.getTileById(u);this._setTileReloadTimer(u,g)}}refreshTiles(u){for(const g of this._inViewTiles.getAllIds()){const w=this._inViewTiles.getTileById(g);(this._inViewTiles.isIdRenderable(g)||w.state=="errored")&&u.some((C=>C.equals(w.tileID.canonical)))&&this._reloadTile(g,"expired")}}_removeTile(u){const g=this._inViewTiles.getTileById(u);g&&(g.uses--,this._inViewTiles.deleteTileById(u),this._clearTileReloadTimer(u),g.uses>0||(g.hasData()&&g.state!=="reloading"?this._outOfViewCache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))}_dataHandler(u){u.dataType==="source"&&(u.sourceDataType!=="metadata"?u.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(u.sourceDataChanged,u.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const u of this._inViewTiles.getAllIds())this._removeTile(u);this._outOfViewCache.reset()}tilesIn(u,g,w){const C=[],L=this.transform;if(!L)return C;const z=L.getCoveringTilesDetailsProvider().allowWorldCopies(),Y=w?L.getCameraQueryGeometry(u):u,re=Ue=>L.screenPointToMercatorCoordinate(Ue,this.terrain),le=this.transformBbox(u,re,!z),he=this.transformBbox(Y,re,!z),Ae=this.getIds(),Ce=o.aa.fromPoints(he);for(let Ue=0;Ue<Ae.length;Ue++){const Ze=this._inViewTiles.getTileById(Ae[Ue]);if(Ze.holdingForSymbolFade())continue;const ht=z?[Ze.tileID]:[Ze.tileID.unwrapTo(-1),Ze.tileID.unwrapTo(0)],pt=Math.pow(2,L.zoom-Ze.tileID.overscaledZ),dt=g*Ze.queryPadding*o.a5/Ze.tileSize/pt;for(const xt of ht){const Ot=Ce.map((wt=>xt.getTilePoint(new o.a9(wt.x,wt.y))));if(Ot.expandBy(dt),Ot.intersects(ke)){const wt=le.map((jt=>xt.getTilePoint(jt))),Lt=he.map((jt=>xt.getTilePoint(jt)));C.push({tile:Ze,tileID:z?xt:xt.unwrapTo(0),queryGeometry:wt,cameraQueryGeometry:Lt,scale:pt})}}}return C}transformBbox(u,g,w){let C=u.map(g);if(w){const L=o.aa.fromPoints(u);L.shrinkBy(.001*Math.min(L.width(),L.height()));const z=L.map(g);o.aa.fromPoints(C).covers(z)||(C=C.map((Y=>Y.x>.5?new o.a9(Y.x-1,Y.y,Y.z):Y)))}return C}getVisibleCoordinates(u){const g=this.getRenderableIds(u).map((w=>this._inViewTiles.getTileById(w).tileID));return this.transform&&this.transform.populateCache(g),g}hasTransition(){return!!this._source.hasTransition()||!(!He(this._source.type)||!(function(u,g){if(g<=0)return!1;const w=T();for(const C of u.getAllTiles())if(C.fadeEndTime>=w)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(u){this._rasterFadeDuration=u}setFeatureState(u,g,w){this._state.updateState(u=u||o.ai,g,w)}removeFeatureState(u,g,w){this._state.removeFeatureState(u=u||o.ai,g,w)}getFeatureState(u,g){return this._state.getState(u=u||o.ai,g)}setDependencies(u,g,w){const C=this._inViewTiles.getTileById(u);C&&C.setDependencies(g,w)}reloadTilesForDependencies(u,g){for(const w of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(w).hasDependency(u,g)&&this._reloadTile(w,"reloading");this._outOfViewCache.filter((w=>!w.hasDependency(u,g)))}areTilesLoaded(){for(const u of this._inViewTiles.getAllTiles())if(u.state!=="loaded"&&u.state!=="errored")return!1;return!0}}Ci.maxUnderzooming=10,Ci.maxOverzooming=3;class Fr{constructor(u,g){this.reset(u,g)}reset(u,g){this.points=u||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(g||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(u){if(this.points.length===1)return this.points[0];u=o.an(u,0,1);let g=1,w=this._distances[g];const C=u*this.paddedLength+this.padding;for(;w<C&&g<this._distances.length;)w=this._distances[++g];const L=g-1,z=this._distances[L],Y=w-z,re=Y>0?(C-z)/Y:0;return this.points[L].mult(1-re).add(this.points[g].mult(re))}}function Rn(D,u){let g=!0;return D==="always"||D!=="never"&&u!=="never"||(g=!1),g}class Bn{constructor(u,g,w){const C=this.boxCells=[],L=this.circleCells=[];this.xCellCount=Math.ceil(u/w),this.yCellCount=Math.ceil(g/w);for(let z=0;z<this.xCellCount*this.yCellCount;z++)C.push([]),L.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=g,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/g,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(u,g,w,C,L){this._forEachCell(g,w,C,L,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(g),this.bboxes.push(w),this.bboxes.push(C),this.bboxes.push(L)}insertCircle(u,g,w,C){this._forEachCell(g-C,w-C,g+C,w+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(g),this.circles.push(w),this.circles.push(C)}_insertBoxCell(u,g,w,C,L,z){this.boxCells[L].push(z)}_insertCircleCell(u,g,w,C,L,z){this.circleCells[L].push(z)}_query(u,g,w,C,L,z,Y){if(w<0||u>this.width||C<0||g>this.height)return[];const re=[];if(u<=0&&g<=0&&this.width<=w&&this.height<=C){if(L)return[{key:null,x1:u,y1:g,x2:w,y2:C}];for(let le=0;le<this.boxKeys.length;le++)re.push({key:this.boxKeys[le],x1:this.bboxes[4*le],y1:this.bboxes[4*le+1],x2:this.bboxes[4*le+2],y2:this.bboxes[4*le+3]});for(let le=0;le<this.circleKeys.length;le++){const he=this.circles[3*le],Ae=this.circles[3*le+1],Ce=this.circles[3*le+2];re.push({key:this.circleKeys[le],x1:he-Ce,y1:Ae-Ce,x2:he+Ce,y2:Ae+Ce})}}else this._forEachCell(u,g,w,C,this._queryCell,re,{hitTest:L,overlapMode:z,seenUids:{box:{},circle:{}}},Y);return re}query(u,g,w,C){return this._query(u,g,w,C,!1,null)}hitTest(u,g,w,C,L,z){return this._query(u,g,w,C,!0,L,z).length>0}hitTestCircle(u,g,w,C,L){const z=u-w,Y=u+w,re=g-w,le=g+w;if(Y<0||z>this.width||le<0||re>this.height)return!1;const he=[];return this._forEachCell(z,re,Y,le,this._queryCellCircle,he,{hitTest:!0,overlapMode:C,circle:{x:u,y:g,radius:w},seenUids:{box:{},circle:{}}},L),he.length>0}_queryCell(u,g,w,C,L,z,Y,re){const{seenUids:le,hitTest:he,overlapMode:Ae}=Y,Ce=this.boxCells[L];if(Ce!==null){const Ze=this.bboxes;for(const ht of Ce)if(!le.box[ht]){le.box[ht]=!0;const pt=4*ht,dt=this.boxKeys[ht];if(u<=Ze[pt+2]&&g<=Ze[pt+3]&&w>=Ze[pt+0]&&C>=Ze[pt+1]&&(!re||re(dt))&&(!he||!Rn(Ae,dt.overlapMode))&&(z.push({key:dt,x1:Ze[pt],y1:Ze[pt+1],x2:Ze[pt+2],y2:Ze[pt+3]}),he))return!0}}const Ue=this.circleCells[L];if(Ue!==null){const Ze=this.circles;for(const ht of Ue)if(!le.circle[ht]){le.circle[ht]=!0;const pt=3*ht,dt=this.circleKeys[ht];if(this._circleAndRectCollide(Ze[pt],Ze[pt+1],Ze[pt+2],u,g,w,C)&&(!re||re(dt))&&(!he||!Rn(Ae,dt.overlapMode))){const xt=Ze[pt],Ot=Ze[pt+1],wt=Ze[pt+2];if(z.push({key:dt,x1:xt-wt,y1:Ot-wt,x2:xt+wt,y2:Ot+wt}),he)return!0}}}return!1}_queryCellCircle(u,g,w,C,L,z,Y,re){const{circle:le,seenUids:he,overlapMode:Ae}=Y,Ce=this.boxCells[L];if(Ce!==null){const Ze=this.bboxes;for(const ht of Ce)if(!he.box[ht]){he.box[ht]=!0;const pt=4*ht,dt=this.boxKeys[ht];if(this._circleAndRectCollide(le.x,le.y,le.radius,Ze[pt+0],Ze[pt+1],Ze[pt+2],Ze[pt+3])&&(!re||re(dt))&&!Rn(Ae,dt.overlapMode))return z.push(!0),!0}}const Ue=this.circleCells[L];if(Ue!==null){const Ze=this.circles;for(const ht of Ue)if(!he.circle[ht]){he.circle[ht]=!0;const pt=3*ht,dt=this.circleKeys[ht];if(this._circlesCollide(Ze[pt],Ze[pt+1],Ze[pt+2],le.x,le.y,le.radius)&&(!re||re(dt))&&!Rn(Ae,dt.overlapMode))return z.push(!0),!0}}}_forEachCell(u,g,w,C,L,z,Y,re){const le=this._convertToXCellCoord(u),he=this._convertToYCellCoord(g),Ae=this._convertToXCellCoord(w),Ce=this._convertToYCellCoord(C);for(let Ue=le;Ue<=Ae;Ue++)for(let Ze=he;Ze<=Ce;Ze++)if(L.call(this,u,g,w,C,this.xCellCount*Ze+Ue,z,Y,re))return}_convertToXCellCoord(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))}_convertToYCellCoord(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))}_circlesCollide(u,g,w,C,L,z){const Y=C-u,re=L-g,le=w+z;return le*le>Y*Y+re*re}_circleAndRectCollide(u,g,w,C,L,z,Y){const re=(z-C)/2,le=Math.abs(u-(C+re));if(le>re+w)return!1;const he=(Y-L)/2,Ae=Math.abs(g-(L+he));if(Ae>he+w)return!1;if(le<=re||Ae<=he)return!0;const Ce=le-re,Ue=Ae-he;return Ce*Ce+Ue*Ue<=w*w}}function ei(D,u,g){const w=o.N();if(!D){const{vecSouth:Ae,vecEast:Ce}=ha(u),Ue=f();Ue[0]=Ce[0],Ue[1]=Ce[1],Ue[2]=Ae[0],Ue[3]=Ae[1],C=Ue,(he=(z=(L=Ue)[0])*(le=L[3])-(re=L[2])*(Y=L[1]))&&(C[0]=le*(he=1/he),C[1]=-Y*he,C[2]=-re*he,C[3]=z*he),w[0]=Ue[0],w[1]=Ue[1],w[4]=Ue[2],w[5]=Ue[3]}var C,L,z,Y,re,le,he;return o.Q(w,w,[1/g,1/g,1]),w}function ua(D,u,g,w){if(D){const C=o.N();if(!u){const{vecSouth:L,vecEast:z}=ha(g);C[0]=z[0],C[1]=z[1],C[4]=L[0],C[5]=L[1]}return o.Q(C,C,[w,w,1]),C}return g.pixelsToClipSpaceMatrix}function ha(D){const u=Math.cos(D.rollInRadians),g=Math.sin(D.rollInRadians),w=Math.cos(D.pitchInRadians),C=Math.cos(D.bearingInRadians),L=Math.sin(D.bearingInRadians),z=o.aC();z[0]=-C*w*g-L*u,z[1]=-L*w*g+C*u;const Y=o.aD(z);Y<1e-9?o.aE(z):o.aF(z,z,1/Y);const re=o.aC();re[0]=C*w*u-L*g,re[1]=L*w*u+C*g;const le=o.aD(re);return le<1e-9?o.aE(re):o.aF(re,re,1/le),{vecEast:re,vecSouth:z}}function zn(D,u,g,w){let C;w?(C=[D,u,w(D,u),1],o.aH(C,C,g)):(C=[D,u,0,1],Fa(C,C,g));const L=C[3];return{point:new o.P(C[0]/L,C[1]/L),signedDistanceFromCamera:L,isOccluded:!1}}function Na(D,u){return .5+D/u*.5}function Wi(D,u){return D.x>=-u[0]&&D.x<=u[0]&&D.y>=-u[1]&&D.y<=u[1]}function ds(D,u,g,w,C,L,z,Y,re,le,he,Ae,Ce){const Ue=g?D.textSizeData:D.iconSizeData,Ze=o.ay(Ue,u.transform.zoom),ht=[256/u.width*2+1,256/u.height*2+1],pt=g?D.text.dynamicLayoutVertexArray:D.icon.dynamicLayoutVertexArray;pt.clear();const dt=D.lineVertexArray,xt=g?D.text.placedSymbolArray:D.icon.placedSymbolArray,Ot=u.transform.width/u.transform.height;let wt=!1;for(let Lt=0;Lt<xt.length;Lt++){const jt=xt.get(Lt);if(jt.hidden||jt.writingMode===o.az.vertical&&!wt){Ul(jt.numGlyphs,pt);continue}wt=!1;const Dt=new o.P(jt.anchorX,jt.anchorY),Yt={getElevation:Ce,pitchedLabelPlaneMatrix:w,lineVertexArray:dt,pitchWithMap:L,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:u.transform,tileAnchorPoint:Dt,unwrappedTileID:re,width:le,height:he,translation:Ae},Sr=ma(jt.anchorX,jt.anchorY,Yt);if(!Wi(Sr.point,ht)){Ul(jt.numGlyphs,pt);continue}const dr=Na(u.transform.cameraToCenterDistance,Sr.signedDistanceFromCamera),yr=o.aA(Ue,Ze,jt),xr=L?yr*u.transform.getPitchedTextCorrection(jt.anchorX,jt.anchorY,re)/dr:yr*dr,nn=Ya({projectionContext:Yt,pitchedLabelPlaneMatrixInverse:C,symbol:jt,fontSize:xr,flip:!1,keepUpright:z,glyphOffsetArray:D.glyphOffsetArray,dynamicLayoutVertexArray:pt,aspectRatio:Ot,rotateToLine:Y});wt=nn.useVertical,(nn.notEnoughRoom||wt||nn.needsFlipping&&Ya({projectionContext:Yt,pitchedLabelPlaneMatrixInverse:C,symbol:jt,fontSize:xr,flip:!0,keepUpright:z,glyphOffsetArray:D.glyphOffsetArray,dynamicLayoutVertexArray:pt,aspectRatio:Ot,rotateToLine:Y}).notEnoughRoom)&&Ul(jt.numGlyphs,pt)}g?D.text.dynamicLayoutVertexBuffer.updateData(pt):D.icon.dynamicLayoutVertexBuffer.updateData(pt)}function Ca(D,u,g,w,C,L,z,Y){const re=L.glyphStartIndex+L.numGlyphs,le=L.lineStartIndex,he=L.lineStartIndex+L.lineLength,Ae=u.getoffsetX(L.glyphStartIndex),Ce=u.getoffsetX(re-1),Ue=Aa(D*Ae,g,w,C,L.segment,le,he,Y,z);if(!Ue)return null;const Ze=Aa(D*Ce,g,w,C,L.segment,le,he,Y,z);return Ze?Y.projectionCache.anyProjectionOccluded?null:{first:Ue,last:Ze}:null}function Do(D,u,g,w){return D===o.az.horizontal&&Math.abs(g.y-u.y)>Math.abs(g.x-u.x)*w?{useVertical:!0}:(D===o.az.vertical?u.y<g.y:u.x>g.x)?{needsFlipping:!0}:null}function Ya(D){const{projectionContext:u,pitchedLabelPlaneMatrixInverse:g,symbol:w,fontSize:C,flip:L,keepUpright:z,glyphOffsetArray:Y,dynamicLayoutVertexArray:re,aspectRatio:le,rotateToLine:he}=D,Ae=C/24,Ce=w.lineOffsetX*Ae,Ue=w.lineOffsetY*Ae;let Ze;if(w.numGlyphs>1){const ht=w.glyphStartIndex+w.numGlyphs,pt=w.lineStartIndex,dt=w.lineStartIndex+w.lineLength,xt=Ca(Ae,Y,Ce,Ue,L,w,he,u);if(!xt)return{notEnoughRoom:!0};const Ot=Iu(xt.first.point.x,xt.first.point.y,u,g),wt=Iu(xt.last.point.x,xt.last.point.y,u,g);if(z&&!L){const Lt=Do(w.writingMode,Ot,wt,le);if(Lt)return Lt}Ze=[xt.first];for(let Lt=w.glyphStartIndex+1;Lt<ht-1;Lt++){const jt=Aa(Ae*Y.getoffsetX(Lt),Ce,Ue,L,w.segment,pt,dt,u,he);if(!jt)return{notEnoughRoom:!0};Ze.push(jt)}Ze.push(xt.last)}else{if(z&&!L){const pt=zi(u.tileAnchorPoint.x,u.tileAnchorPoint.y,u).point,dt=w.lineStartIndex+w.segment+1,xt=new o.P(u.lineVertexArray.getx(dt),u.lineVertexArray.gety(dt)),Ot=zi(xt.x,xt.y,u),wt=Ot.signedDistanceFromCamera>0?Ot.point:sl(u.tileAnchorPoint,xt,pt,1,u),Lt=Iu(pt.x,pt.y,u,g),jt=Iu(wt.x,wt.y,u,g),Dt=Do(w.writingMode,Lt,jt,le);if(Dt)return Dt}const ht=Aa(Ae*Y.getoffsetX(w.glyphStartIndex),Ce,Ue,L,w.segment,w.lineStartIndex,w.lineStartIndex+w.lineLength,u,he);if(!ht||u.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Ze=[ht]}for(const ht of Ze)o.aG(re,ht.point,ht.angle);return{}}function sl(D,u,g,w,C){const L=D.add(D.sub(u)._unit()),z=zi(L.x,L.y,C).point,Y=g.sub(z);return g.add(Y._mult(w/Y.mag()))}function xi(D,u,g){const w=u.projectionCache;if(w.projections[D])return w.projections[D];const C=new o.P(u.lineVertexArray.getx(D),u.lineVertexArray.gety(D)),L=zi(C.x,C.y,u);if(L.signedDistanceFromCamera>0)return w.projections[D]=L.point,w.anyProjectionOccluded=w.anyProjectionOccluded||L.isOccluded,L.point;const z=D-g.direction;return sl(g.distanceFromAnchor===0?u.tileAnchorPoint:new o.P(u.lineVertexArray.getx(z),u.lineVertexArray.gety(z)),C,g.previousVertex,g.absOffsetX-g.distanceFromAnchor+1,u)}function zi(D,u,g){const w=D+g.translation[0],C=u+g.translation[1];let L;return g.pitchWithMap?(L=zn(w,C,g.pitchedLabelPlaneMatrix,g.getElevation),L.isOccluded=!1):(L=g.transform.projectTileCoordinates(w,C,g.unwrappedTileID,g.getElevation),L.point.x=(.5*L.point.x+.5)*g.width,L.point.y=(.5*-L.point.y+.5)*g.height),L}function Iu(D,u,g,w){if(g.pitchWithMap){const C=[D,u,0,1];return o.aH(C,C,w),g.transform.projectTileCoordinates(C[0]/C[3],C[1]/C[3],g.unwrappedTileID,g.getElevation).point}return{x:D/g.width*2-1,y:1-u/g.height*2}}function ma(D,u,g){return g.transform.projectTileCoordinates(D,u,g.unwrappedTileID,g.getElevation)}function Za(D,u,g){return D._unit()._perp()._mult(u*g)}function ps(D,u,g,w,C,L,z,Y,re){if(Y.projectionCache.offsets[D])return Y.projectionCache.offsets[D];const le=g.add(u);if(D+re.direction<w||D+re.direction>=C)return Y.projectionCache.offsets[D]=le,le;const he=xi(D+re.direction,Y,re),Ae=Za(he.sub(g),z,re.direction),Ce=g.add(Ae),Ue=he.add(Ae);return Y.projectionCache.offsets[D]=o.aI(L,le,Ce,Ue)||le,Y.projectionCache.offsets[D]}function Aa(D,u,g,w,C,L,z,Y,re){const le=w?D-u:D+u;let he=le>0?1:-1,Ae=0;w&&(he*=-1,Ae=Math.PI),he<0&&(Ae+=Math.PI);let Ce,Ue=he>0?L+C:L+C+1;Y.projectionCache.cachedAnchorPoint?Ce=Y.projectionCache.cachedAnchorPoint:(Ce=zi(Y.tileAnchorPoint.x,Y.tileAnchorPoint.y,Y).point,Y.projectionCache.cachedAnchorPoint=Ce);let Ze,ht,pt=Ce,dt=Ce,xt=0,Ot=0;const wt=Math.abs(le),Lt=[];let jt;for(;xt+Ot<=wt;){if(Ue+=he,Ue<L||Ue>=z)return null;xt+=Ot,dt=pt,ht=Ze;const Sr={absOffsetX:wt,direction:he,distanceFromAnchor:xt,previousVertex:dt};if(pt=xi(Ue,Y,Sr),g===0)Lt.push(dt),jt=pt.sub(dt);else{let dr;const yr=pt.sub(dt);dr=yr.mag()===0?Za(xi(Ue+he,Y,Sr).sub(pt),g,he):Za(yr,g,he),ht||(ht=dt.add(dr)),Ze=ps(Ue,dr,pt,L,z,ht,g,Y,Sr),Lt.push(ht),jt=Ze.sub(ht)}Ot=jt.mag()}const Dt=jt._mult((wt-xt)/Ot)._add(ht||dt),Yt=Ae+Math.atan2(pt.y-dt.y,pt.x-dt.x);return Lt.push(Dt),{point:Dt,angle:re?Yt:0,path:Lt}}const gs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ul(D,u){for(let g=0;g<D;g++){const w=u.length;u.resize(w+4),u.float32.set(gs,3*w)}}function Fa(D,u,g){const w=u[0],C=u[1];return D[0]=g[0]*w+g[4]*C+g[12],D[1]=g[1]*w+g[5]*C+g[13],D[3]=g[3]*w+g[7]*C+g[15],D}const _a=100;class xc{constructor(u,g=new Bn(u.width+200,u.height+200,25),w=new Bn(u.width+200,u.height+200,25)){this.transform=u,this.grid=g,this.ignoredGrid=w,this.pitchFactor=Math.cos(u.pitch*Math.PI/180)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+_a,this.screenBottomBoundary=u.height+_a,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(u,g,w,C,L,z,Y,re,le,he,Ae,Ce){const Ue=this.projectAndGetPerspectiveRatio(u.anchorPointX+re[0],u.anchorPointY+re[1],L,he,Ce),Ze=w*Ue.perspectiveRatio;let ht;if(z||Y)ht=this._projectCollisionBox(u,Ze,C,L,z,Y,re,Ue,he,Ae,Ce);else{const jt=Ue.x+(Ae?Ae.x*Ze:0),Dt=Ue.y+(Ae?Ae.y*Ze:0);ht={allPointsOccluded:!1,box:[jt+u.x1*Ze,Dt+u.y1*Ze,jt+u.x2*Ze,Dt+u.y2*Ze]}}const[pt,dt,xt,Ot]=ht.box,wt=z?ht.allPointsOccluded:Ue.isOccluded;let Lt=wt;return Lt||(Lt=Ue.perspectiveRatio<this.perspectiveRatioCutoff),Lt||(Lt=!this.isInsideGrid(pt,dt,xt,Ot)),Lt||g!=="always"&&this.grid.hitTest(pt,dt,xt,Ot,g,le)?{box:[pt,dt,xt,Ot],placeable:!1,offscreen:!1,occluded:wt}:{box:[pt,dt,xt,Ot],placeable:!0,offscreen:this.isOffscreen(pt,dt,xt,Ot),occluded:wt}}placeCollisionCircles(u,g,w,C,L,z,Y,re,le,he,Ae,Ce,Ue,Ze){const ht=[],pt=new o.P(g.anchorX,g.anchorY),dt=this.getPerspectiveRatio(pt.x,pt.y,z,Ze),xt=(le?L*this.transform.getPitchedTextCorrection(g.anchorX,g.anchorY,z)/dt:L*dt)/o.aM,Ot={getElevation:Ze,pitchedLabelPlaneMatrix:Y,lineVertexArray:w,pitchWithMap:le,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:pt,unwrappedTileID:z,width:this.transform.width,height:this.transform.height,translation:Ue},wt=Ca(xt,C,g.lineOffsetX*xt,g.lineOffsetY*xt,!1,g,!1,Ot);let Lt=!1,jt=!1,Dt=!0;if(wt){const Yt=.5*Ae*dt+Ce,Sr=new o.P(-100,-100),dr=new o.P(this.screenRightBoundary,this.screenBottomBoundary),yr=new Fr,xr=wt.first,nn=wt.last;let sn=[];for(let Ti=xr.path.length-1;Ti>=1;Ti--)sn.push(xr.path[Ti]);for(let Ti=1;Ti<nn.path.length;Ti++)sn.push(nn.path[Ti]);const Hr=2.5*Yt;if(le){const Ti=this.projectPathToScreenSpace(sn,Ot);sn=Ti.some((ka=>ka.signedDistanceFromCamera<=0))?[]:Ti.map((ka=>ka.point))}let pn=[];if(sn.length>0){const Ti=sn[0].clone(),ka=sn[0].clone();for(let yo=1;yo<sn.length;yo++)Ti.x=Math.min(Ti.x,sn[yo].x),Ti.y=Math.min(Ti.y,sn[yo].y),ka.x=Math.max(ka.x,sn[yo].x),ka.y=Math.max(ka.y,sn[yo].y);pn=Ti.x>=Sr.x&&ka.x<=dr.x&&Ti.y>=Sr.y&&ka.y<=dr.y?[sn]:ka.x<Sr.x||Ti.x>dr.x||ka.y<Sr.y||Ti.y>dr.y?[]:o.aJ([sn],Sr.x,Sr.y,dr.x,dr.y)}for(const Ti of pn){yr.reset(Ti,.25*Yt);let ka=0;ka=yr.length<=.5*Yt?1:Math.ceil(yr.paddedLength/Hr)+1;for(let yo=0;yo<ka;yo++){const to=yo/Math.max(ka-1,1),Io=yr.lerp(to),ro=Io.x+_a,Xo=Io.y+_a;ht.push(ro,Xo,Yt,0);const Po=ro-Yt,gl=Xo-Yt,_s=ro+Yt,os=Xo+Yt;if(Dt=Dt&&this.isOffscreen(Po,gl,_s,os),jt=jt||this.isInsideGrid(Po,gl,_s,os),u!=="always"&&this.grid.hitTestCircle(ro,Xo,Yt,u,he)&&(Lt=!0,!re))return{circles:[],offscreen:!1,collisionDetected:Lt}}}}return{circles:!re&&Lt||!jt||dt<this.perspectiveRatioCutoff?[]:ht,offscreen:Dt,collisionDetected:Lt}}projectPathToScreenSpace(u,g){const w=(function(C,L){const z=o.N();return o.aB(z,L.pitchedLabelPlaneMatrix),C.map((Y=>{const re=zn(Y.x,Y.y,z,L.getElevation),le=L.transform.projectTileCoordinates(re.point.x,re.point.y,L.unwrappedTileID,L.getElevation);return le.point.x=(.5*le.point.x+.5)*L.width,le.point.y=(.5*-le.point.y+.5)*L.height,le}))})(u,g);return(function(C){let L=0,z=0,Y=0,re=0;for(let le=0;le<C.length;le++)C[le].isOccluded?(Y=le+1,re=0):(re++,re>z&&(z=re,L=Y));return C.slice(L,L+z)})(w)}queryRenderedSymbols(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const g=[],w=new o.aa;for(const Ae of u){const Ce=new o.P(Ae.x+_a,Ae.y+_a);w.extend(Ce),g.push(Ce)}const{minX:C,minY:L,maxX:z,maxY:Y}=w,re=this.grid.query(C,L,z,Y).concat(this.ignoredGrid.query(C,L,z,Y)),le={},he={};for(const Ae of re){const Ce=Ae.key;if(le[Ce.bucketInstanceId]===void 0&&(le[Ce.bucketInstanceId]={}),le[Ce.bucketInstanceId][Ce.featureIndex])continue;const Ue=[new o.P(Ae.x1,Ae.y1),new o.P(Ae.x2,Ae.y1),new o.P(Ae.x2,Ae.y2),new o.P(Ae.x1,Ae.y2)];o.aK(g,Ue)&&(le[Ce.bucketInstanceId][Ce.featureIndex]=!0,he[Ce.bucketInstanceId]===void 0&&(he[Ce.bucketInstanceId]=[]),he[Ce.bucketInstanceId].push(Ce.featureIndex))}return he}insertCollisionBox(u,g,w,C,L,z){(w?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:L,collisionGroupID:z,overlapMode:g},u[0],u[1],u[2],u[3])}insertCollisionCircles(u,g,w,C,L,z){const Y=w?this.ignoredGrid:this.grid,re={bucketInstanceId:C,featureIndex:L,collisionGroupID:z,overlapMode:g};for(let le=0;le<u.length;le+=4)Y.insertCircle(re,u[le],u[le+1],u[le+2])}projectAndGetPerspectiveRatio(u,g,w,C,L){if(L){let z;C?(z=[u,g,C(u,g),1],o.aH(z,z,L)):(z=[u,g,0,1],Fa(z,z,L));const Y=z[3];return{x:(z[0]/Y+1)/2*this.transform.width+_a,y:(-z[1]/Y+1)/2*this.transform.height+_a,perspectiveRatio:.5+this.transform.cameraToCenterDistance/Y*.5,isOccluded:!1,signedDistanceFromCamera:Y}}{const z=this.transform.projectTileCoordinates(u,g,w,C);return{x:(z.point.x+1)/2*this.transform.width+_a,y:(1-z.point.y)/2*this.transform.height+_a,perspectiveRatio:.5+this.transform.cameraToCenterDistance/z.signedDistanceFromCamera*.5,isOccluded:z.isOccluded,signedDistanceFromCamera:z.signedDistanceFromCamera}}}getPerspectiveRatio(u,g,w,C){const L=this.transform.projectTileCoordinates(u,g,w,C);return .5+this.transform.cameraToCenterDistance/L.signedDistanceFromCamera*.5}isOffscreen(u,g,w,C){return w<_a||u>=this.screenRightBoundary||C<_a||g>this.screenBottomBoundary}isInsideGrid(u,g,w,C){return w>=0&&u<this.gridRightBoundary&&C>=0&&g<this.gridBottomBoundary}getViewportMatrix(){const u=o.ar([]);return o.O(u,u,[-100,-100,0]),u}_projectCollisionBox(u,g,w,C,L,z,Y,re,le,he,Ae){let Ce=1,Ue=0,Ze=0,ht=1;const pt=u.anchorPointX+Y[0],dt=u.anchorPointY+Y[1];if(z&&!L){const sn=this.projectAndGetPerspectiveRatio(pt+1,dt,C,le,Ae),Hr=sn.x-re.x,pn=Math.atan((sn.y-re.y)/Hr)+(Hr<0?Math.PI:0),Ti=Math.sin(pn),ka=Math.cos(pn);Ce=ka,Ue=Ti,Ze=-Ti,ht=ka}else if(!z&&L){const sn=ha(this.transform);Ce=sn.vecEast[0],Ue=sn.vecEast[1],Ze=sn.vecSouth[0],ht=sn.vecSouth[1]}let xt=re.x,Ot=re.y,wt=g;L&&(xt=pt,Ot=dt,wt=Math.pow(2,-(this.transform.zoom-w.overscaledZ)),wt*=this.transform.getPitchedTextCorrection(pt,dt,C),he||(wt*=o.an(.5+re.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),he&&(xt+=Ce*he.x*wt+Ze*he.y*wt,Ot+=Ue*he.x*wt+ht*he.y*wt);const Lt=u.x1*wt,jt=u.x2*wt,Dt=(Lt+jt)/2,Yt=u.y1*wt,Sr=u.y2*wt,dr=(Yt+Sr)/2,yr=[{offsetX:Lt,offsetY:Yt},{offsetX:Dt,offsetY:Yt},{offsetX:jt,offsetY:Yt},{offsetX:jt,offsetY:dr},{offsetX:jt,offsetY:Sr},{offsetX:Dt,offsetY:Sr},{offsetX:Lt,offsetY:Sr},{offsetX:Lt,offsetY:dr}];let xr=[];for(const{offsetX:sn,offsetY:Hr}of yr)xr.push(new o.P(xt+Ce*sn+Ze*Hr,Ot+Ue*sn+ht*Hr));let nn=!1;if(L){const sn=xr.map((Hr=>this.projectAndGetPerspectiveRatio(Hr.x,Hr.y,C,le,Ae)));nn=sn.some((Hr=>!Hr.isOccluded)),xr=sn.map((Hr=>new o.P(Hr.x,Hr.y)))}else nn=!0;return{box:o.aL(xr),allPointsOccluded:!nn}}}class ll{constructor(u,g,w,C){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?g:-g))):C&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class rs{constructor(u,g,w,C,L){this.text=new ll(u?u.text:null,g,w,L),this.icon=new ll(u?u.icon:null,g,C,L)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class so{constructor(u,g,w){this.text=u,this.icon=g,this.skipFade=w}}class ns{constructor(u,g,w,C,L){this.bucketInstanceId=u,this.featureIndex=g,this.sourceLayerIndex=w,this.bucketIndex=C,this.tileID=L}}class Ba{constructor(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}}get(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){const g=++this.maxGroupID;this.collisionGroups[u]={ID:g,predicate:w=>w.collisionGroupID===g}}return this.collisionGroups[u]}}function Vs(D,u,g,w,C){const{horizontalAlign:L,verticalAlign:z}=o.aS(D);return new o.P(-(L-.5)*u+w[0]*C,-(z-.5)*g+w[1]*C)}class Uc{constructor(u,g,w,C,L){this.transform=u.clone(),this.terrain=g,this.collisionIndex=new xc(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=w,this.retainedQueryData={},this.collisionGroups=new Ba(C),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=L,L&&(L.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(u){const g=this.terrain;return g?(w,C)=>g.getElevation(u,w,C):null}getBucketParts(u,g,w,C){const L=w.getBucket(g),z=w.latestFeatureIndex;if(!L||!z||g.id!==L.layerIds[0])return;const Y=w.collisionBoxArray,re=L.layers[0].layout,le=L.layers[0].paint,he=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),Ae=w.tileSize/o.a5,Ce=w.tileID.toUnwrapped(),Ue=re.get("text-rotation-alignment")==="map",Ze=o.aN(w,1,this.transform.zoom),ht=o.aO(this.collisionIndex.transform,w,le.get("text-translate"),le.get("text-translate-anchor")),pt=o.aO(this.collisionIndex.transform,w,le.get("icon-translate"),le.get("icon-translate-anchor")),dt=ei(Ue,this.transform,Ze);this.retainedQueryData[L.bucketInstanceId]=new ns(L.bucketInstanceId,z,L.sourceLayerIndex,L.index,w.tileID);const xt={bucket:L,layout:re,translationText:ht,translationIcon:pt,unwrappedTileID:Ce,pitchedLabelPlaneMatrix:dt,scale:he,textPixelRatio:Ae,holdingForFade:w.holdingForSymbolFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:o.ay(L.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(L.sourceID)};if(C)for(const Ot of L.sortKeyRanges){const{sortKey:wt,symbolInstanceStart:Lt,symbolInstanceEnd:jt}=Ot;u.push({sortKey:wt,symbolInstanceStart:Lt,symbolInstanceEnd:jt,parameters:xt})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:L.symbolInstances.length,parameters:xt})}attemptAnchorPlacement(u,g,w,C,L,z,Y,re,le,he,Ae,Ce,Ue,Ze,ht,pt,dt,xt,Ot,wt){const Lt=o.aP[u.textAnchor],jt=[u.textOffset0,u.textOffset1],Dt=Vs(Lt,w,C,jt,L),Yt=this.collisionIndex.placeCollisionBox(g,Ce,re,le,he,Y,z,pt,Ae.predicate,Ot,Dt,wt);if((!xt||this.collisionIndex.placeCollisionBox(xt,Ce,re,le,he,Y,z,dt,Ae.predicate,Ot,Dt,wt).placeable)&&Yt.placeable){let Sr;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ue.crossTileID]&&this.prevPlacement.placements[Ue.crossTileID]&&this.prevPlacement.placements[Ue.crossTileID].text&&(Sr=this.prevPlacement.variableOffsets[Ue.crossTileID].anchor),Ue.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Ue.crossTileID]={textOffset:jt,width:w,height:C,anchor:Lt,textBoxScale:L,prevAnchor:Sr},this.markUsedJustification(Ze,Lt,Ue,ht),Ze.allowVerticalPlacement&&(this.markUsedOrientation(Ze,ht,Ue),this.placedOrientations[Ue.crossTileID]=ht),{shift:Dt,placedGlyphBoxes:Yt}}}placeLayerBucketPart(u,g,w){const{bucket:C,layout:L,translationText:z,translationIcon:Y,unwrappedTileID:re,pitchedLabelPlaneMatrix:le,textPixelRatio:he,holdingForFade:Ae,collisionBoxArray:Ce,partiallyEvaluatedTextSize:Ue,collisionGroup:Ze}=u.parameters,ht=L.get("text-optional"),pt=L.get("icon-optional"),dt=o.aQ(L,"text-overlap","text-allow-overlap"),xt=dt==="always",Ot=o.aQ(L,"icon-overlap","icon-allow-overlap"),wt=Ot==="always",Lt=L.get("text-rotation-alignment")==="map",jt=L.get("text-pitch-alignment")==="map",Dt=L.get("icon-text-fit")!=="none",Yt=L.get("symbol-z-order")==="viewport-y",Sr=xt&&(wt||!C.hasIconData()||pt),dr=wt&&(xt||!C.hasTextData()||ht);!C.collisionArrays&&Ce&&C.deserializeCollisionBoxes(Ce);const yr=this.retainedQueryData[C.bucketInstanceId].tileID,xr=this._getTerrainElevationFunc(yr),nn=this.transform.getFastPathSimpleProjectionMatrix(yr),sn=(Hr,pn,Ti)=>{var ka,yo;if(g[Hr.crossTileID])return;if(Ae)return void(this.placements[Hr.crossTileID]=new so(!1,!1,!1));let to=!1,Io=!1,ro=!0,Xo=null,Po={box:null,placeable:!1,offscreen:null,occluded:!1},gl={placeable:!1},_s=null,os=null,Rl=null,Xh=0,sh=0,Ef=0;pn.textFeatureIndex?Xh=pn.textFeatureIndex:Hr.useRuntimeCollisionCircles&&(Xh=Hr.featureIndex),pn.verticalTextFeatureIndex&&(sh=pn.verticalTextFeatureIndex);const zu=pn.textBox;if(zu){const Sc=uo=>{let no=o.az.horizontal;if(C.allowVerticalPlacement&&!uo&&this.prevPlacement){const Qs=this.prevPlacement.placedOrientations[Hr.crossTileID];Qs&&(this.placedOrientations[Hr.crossTileID]=Qs,no=Qs,this.markUsedOrientation(C,no,Hr))}return no},Tf=(uo,no)=>{if(C.allowVerticalPlacement&&Hr.numVerticalGlyphVertices>0&&pn.verticalTextBox){for(const Qs of C.writingModes)if(Qs===o.az.vertical?(Po=no(),gl=Po):Po=uo(),Po&&Po.placeable)break}else Po=uo()},Gc=Hr.textAnchorOffsetStartIndex,Wc=Hr.textAnchorOffsetEndIndex;if(Wc===Gc){const uo=(no,Qs)=>{const el=this.collisionIndex.placeCollisionBox(no,dt,he,yr,re,jt,Lt,z,Ze.predicate,xr,void 0,nn);return el&&el.placeable&&(this.markUsedOrientation(C,Qs,Hr),this.placedOrientations[Hr.crossTileID]=Qs),el};Tf((()=>uo(zu,o.az.horizontal)),(()=>{const no=pn.verticalTextBox;return C.allowVerticalPlacement&&Hr.numVerticalGlyphVertices>0&&no?uo(no,o.az.vertical):{box:null,offscreen:null}})),Sc(Po&&Po.placeable)}else{let uo=o.aP[(yo=(ka=this.prevPlacement)===null||ka===void 0?void 0:ka.variableOffsets[Hr.crossTileID])===null||yo===void 0?void 0:yo.anchor];const no=(el,i2,a2)=>{const $d=el.x2-el.x1,iC=el.y2-el.y1,o2=Hr.textBoxScale,M_=Dt&&Ot==="never"?i2:null;let Yh=null,Zh=dt==="never"?1:2,Kh="never";uo&&Zh++;for(let k_=0;k_<Zh;k_++){for(let R_=Gc;R_<Wc;R_++){const jy=C.textAnchorOffsets.get(R_);if(uo&&jy.textAnchor!==uo)continue;const Uy=this.attemptAnchorPlacement(jy,el,$d,iC,o2,Lt,jt,he,yr,re,Ze,Kh,Hr,C,a2,z,Y,M_,xr);if(Uy&&(Yh=Uy.placedGlyphBoxes,Yh&&Yh.placeable))return to=!0,Xo=Uy.shift,Yh}uo?uo=null:Kh=dt}return w&&!Yh&&(Yh={box:this.collisionIndex.placeCollisionBox(zu,"always",he,yr,re,jt,Lt,z,Ze.predicate,xr,void 0,nn).box,offscreen:!1,placeable:!1,occluded:!1}),Yh};Tf((()=>no(zu,pn.iconBox,o.az.horizontal)),(()=>{const el=pn.verticalTextBox;return C.allowVerticalPlacement&&(!Po||!Po.placeable)&&Hr.numVerticalGlyphVertices>0&&el?no(el,pn.verticalIconBox,o.az.vertical):{box:null,occluded:!0,offscreen:null}})),Po&&(to=Po.placeable,ro=Po.offscreen);const Qs=Sc(Po&&Po.placeable);if(!to&&this.prevPlacement){const el=this.prevPlacement.variableOffsets[Hr.crossTileID];el&&(this.variableOffsets[Hr.crossTileID]=el,this.markUsedJustification(C,el.anchor,Hr,Qs))}}}if(_s=Po,to=_s&&_s.placeable,ro=_s&&_s.offscreen,Hr.useRuntimeCollisionCircles&&Hr.centerJustifiedTextSymbolIndex>=0){const Sc=C.text.placedSymbolArray.get(Hr.centerJustifiedTextSymbolIndex),Tf=o.aA(C.textSizeData,Ue,Sc),Gc=L.get("text-padding");os=this.collisionIndex.placeCollisionCircles(dt,Sc,C.lineVertexArray,C.glyphOffsetArray,Tf,re,le,w,jt,Ze.predicate,Hr.collisionCircleDiameter,Gc,z,xr),os.circles.length&&os.collisionDetected&&!w&&o.w("Collisions detected, but collision boxes are not shown"),to=xt||os.circles.length>0&&!os.collisionDetected,ro=ro&&os.offscreen}if(pn.iconFeatureIndex&&(Ef=pn.iconFeatureIndex),pn.iconBox){const Sc=Tf=>this.collisionIndex.placeCollisionBox(Tf,Ot,he,yr,re,jt,Lt,Y,Ze.predicate,xr,Dt&&Xo?Xo:void 0,nn);gl&&gl.placeable&&pn.verticalIconBox?(Rl=Sc(pn.verticalIconBox),Io=Rl.placeable):(Rl=Sc(pn.iconBox),Io=Rl.placeable),ro=ro&&Rl.offscreen}const Ud=ht||Hr.numHorizontalGlyphVertices===0&&Hr.numVerticalGlyphVertices===0,em=pt||Hr.numIconVertices===0;Ud||em?em?Ud||(Io=Io&&to):to=Io&&to:Io=to=Io&&to;const Vd=Io&&Rl.placeable;if(to&&_s.placeable&&this.collisionIndex.insertCollisionBox(_s.box,dt,L.get("text-ignore-placement"),C.bucketInstanceId,gl&&gl.placeable&&sh?sh:Xh,Ze.ID),Vd&&this.collisionIndex.insertCollisionBox(Rl.box,Ot,L.get("icon-ignore-placement"),C.bucketInstanceId,Ef,Ze.ID),os&&to&&this.collisionIndex.insertCollisionCircles(os.circles,dt,L.get("text-ignore-placement"),C.bucketInstanceId,Xh,Ze.ID),w&&this.storeCollisionData(C.bucketInstanceId,Ti,pn,_s,Rl,os),Hr.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(C.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Hr.crossTileID]=new so((to||Sr)&&!_s?.occluded,(Io||dr)&&!Rl?.occluded,ro||C.justReloaded),g[Hr.crossTileID]=!0};if(Yt){if(u.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Hr=C.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let pn=Hr.length-1;pn>=0;--pn){const Ti=Hr[pn];sn(C.symbolInstances.get(Ti),C.collisionArrays[Ti],Ti)}}else for(let Hr=u.symbolInstanceStart;Hr<u.symbolInstanceEnd;Hr++)sn(C.symbolInstances.get(Hr),C.collisionArrays[Hr],Hr);C.justReloaded=!1}storeCollisionData(u,g,w,C,L,z){if(w.textBox||w.iconBox){let Y,re;this.collisionBoxArrays.has(u)?Y=this.collisionBoxArrays.get(u):(Y=new Map,this.collisionBoxArrays.set(u,Y)),Y.has(g)?re=Y.get(g):(re={text:null,icon:null},Y.set(g,re)),w.textBox&&(re.text=C.box),w.iconBox&&(re.icon=L.box)}if(z){let Y=this.collisionCircleArrays[u];Y===void 0&&(Y=this.collisionCircleArrays[u]=[]);for(let re=0;re<z.circles.length;re+=4)Y.push(z.circles[re+0]-_a),Y.push(z.circles[re+1]-_a),Y.push(z.circles[re+2]),Y.push(z.collisionDetected?1:0)}}markUsedJustification(u,g,w,C){let L;L=C===o.az.vertical?w.verticalPlacedTextSymbolIndex:{left:w.leftJustifiedTextSymbolIndex,center:w.centerJustifiedTextSymbolIndex,right:w.rightJustifiedTextSymbolIndex}[o.aR(g)];const z=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex,w.verticalPlacedTextSymbolIndex];for(const Y of z)Y>=0&&(u.text.placedSymbolArray.get(Y).crossTileID=L>=0&&Y!==L?0:w.crossTileID)}markUsedOrientation(u,g,w){const C=g===o.az.horizontal||g===o.az.horizontalOnly?g:0,L=g===o.az.vertical?g:0,z=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex];for(const Y of z)u.text.placedSymbolArray.get(Y).placedOrientation=C;w.verticalPlacedTextSymbolIndex&&(u.text.placedSymbolArray.get(w.verticalPlacedTextSymbolIndex).placedOrientation=L)}commit(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;const g=this.prevPlacement;let w=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):0;const C=g?g.symbolFadeChange(u):1,L=g?g.opacities:{},z=g?g.variableOffsets:{},Y=g?g.placedOrientations:{};for(const re in this.placements){const le=this.placements[re],he=L[re];he?(this.opacities[re]=new rs(he,C,le.text,le.icon),w=w||le.text!==he.text.placed||le.icon!==he.icon.placed):(this.opacities[re]=new rs(null,C,le.text,le.icon,le.skipFade),w=w||le.text||le.icon)}for(const re in L){const le=L[re];if(!this.opacities[re]){const he=new rs(le,C,!1,!1);he.isHidden()||(this.opacities[re]=he,w=w||le.text.placed||le.icon.placed)}}for(const re in z)this.variableOffsets[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.variableOffsets[re]=z[re]);for(const re in Y)this.placedOrientations[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.placedOrientations[re]=Y[re]);if(g&&g.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");w?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:u)}updateLayerOpacities(u,g){const w={};for(const C of g){const L=C.getBucket(u);L&&C.latestFeatureIndex&&u.id===L.layerIds[0]&&this.updateBucketOpacities(L,C.tileID,w,C.collisionBoxArray)}}updateBucketOpacities(u,g,w,C){u.hasTextData()&&(u.text.opacityVertexArray.clear(),u.text.hasVisibleVertices=!1),u.hasIconData()&&(u.icon.opacityVertexArray.clear(),u.icon.hasVisibleVertices=!1),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();const L=u.layers[0],z=L.layout,Y=new rs(null,0,!1,!1,!0),re=z.get("text-allow-overlap"),le=z.get("icon-allow-overlap"),he=L._unevaluatedLayout.hasValue("text-variable-anchor")||L._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ae=z.get("text-rotation-alignment")==="map",Ce=z.get("text-pitch-alignment")==="map",Ue=z.get("icon-text-fit")!=="none",Ze=new rs(null,0,re&&(le||!u.hasIconData()||z.get("icon-optional")),le&&(re||!u.hasTextData()||z.get("text-optional")),!0);!u.collisionArrays&&C&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(C);const ht=(dt,xt,Ot)=>{for(let wt=0;wt<xt/4;wt++)dt.opacityVertexArray.emplaceBack(Ot);dt.hasVisibleVertices=dt.hasVisibleVertices||Ot!==tn},pt=this.collisionBoxArrays.get(u.bucketInstanceId);for(let dt=0;dt<u.symbolInstances.length;dt++){const xt=u.symbolInstances.get(dt),{numHorizontalGlyphVertices:Ot,numVerticalGlyphVertices:wt,crossTileID:Lt}=xt;let jt=this.opacities[Lt];w[Lt]?jt=Y:jt||(jt=Ze,this.opacities[Lt]=jt),w[Lt]=!0;const Dt=xt.numIconVertices>0,Yt=this.placedOrientations[xt.crossTileID],Sr=Yt===o.az.vertical,dr=Yt===o.az.horizontal||Yt===o.az.horizontalOnly;if(Ot>0||wt>0){const xr=Yr(jt.text);ht(u.text,Ot,Sr?tn:xr),ht(u.text,wt,dr?tn:xr);const nn=jt.text.isHidden();[xt.rightJustifiedTextSymbolIndex,xt.centerJustifiedTextSymbolIndex,xt.leftJustifiedTextSymbolIndex].forEach((pn=>{pn>=0&&(u.text.placedSymbolArray.get(pn).hidden=nn||Sr?1:0)})),xt.verticalPlacedTextSymbolIndex>=0&&(u.text.placedSymbolArray.get(xt.verticalPlacedTextSymbolIndex).hidden=nn||dr?1:0);const sn=this.variableOffsets[xt.crossTileID];sn&&this.markUsedJustification(u,sn.anchor,xt,Yt);const Hr=this.placedOrientations[xt.crossTileID];Hr&&(this.markUsedJustification(u,"left",xt,Hr),this.markUsedOrientation(u,Hr,xt))}if(Dt){const xr=Yr(jt.icon),nn=!(Ue&&xt.verticalPlacedIconSymbolIndex&&Sr);xt.placedIconSymbolIndex>=0&&(ht(u.icon,xt.numIconVertices,nn?xr:tn),u.icon.placedSymbolArray.get(xt.placedIconSymbolIndex).hidden=jt.icon.isHidden()),xt.verticalPlacedIconSymbolIndex>=0&&(ht(u.icon,xt.numVerticalIconVertices,nn?tn:xr),u.icon.placedSymbolArray.get(xt.verticalPlacedIconSymbolIndex).hidden=jt.icon.isHidden())}const yr=pt&&pt.has(dt)?pt.get(dt):{text:null,icon:null};if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){const xr=u.collisionArrays[dt];if(xr){let nn=new o.P(0,0);if(xr.textBox||xr.verticalTextBox){let sn=!0;if(he){const Hr=this.variableOffsets[Lt];Hr?(nn=Vs(Hr.anchor,Hr.width,Hr.height,Hr.textOffset,Hr.textBoxScale),Ae&&nn._rotate(Ce?-this.transform.bearingInRadians:this.transform.bearingInRadians)):sn=!1}if(xr.textBox||xr.verticalTextBox){let Hr;xr.textBox&&(Hr=Sr),xr.verticalTextBox&&(Hr=dr),Pu(u.textCollisionBox.collisionVertexArray,jt.text.placed,!sn||Hr,yr.text,nn.x,nn.y)}}if(xr.iconBox||xr.verticalIconBox){const sn=!!(!dr&&xr.verticalIconBox);let Hr;xr.iconBox&&(Hr=sn),xr.verticalIconBox&&(Hr=!sn),Pu(u.iconCollisionBox.collisionVertexArray,jt.icon.placed,Hr,yr.icon,Ue?nn.x:0,Ue?nn.y:0)}}}}if(u.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.text.opacityVertexArray.length!==u.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${u.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${u.text.layoutVertexArray.length}) / 4`);if(u.icon.opacityVertexArray.length!==u.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${u.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${u.icon.layoutVertexArray.length}) / 4`);u.bucketInstanceId in this.collisionCircleArrays&&(u.collisionCircleArray=this.collisionCircleArrays[u.bucketInstanceId],delete this.collisionCircleArrays[u.bucketInstanceId])}symbolFadeChange(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(u){return Math.max(0,(this.transform.zoom-u)/1.5)}hasTransitions(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(u,g){const w=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*w>u}setStale(){this.stale=!0}}function Pu(D,u,g,w,C,L){w&&w.length!==0||(w=[0,0,0,0]);const z=w[0]-_a,Y=w[1]-_a,re=w[2]-_a,le=w[3]-_a;D.emplaceBack(u?1:0,g?1:0,C||0,L||0,z,Y),D.emplaceBack(u?1:0,g?1:0,C||0,L||0,re,Y),D.emplaceBack(u?1:0,g?1:0,C||0,L||0,re,le),D.emplaceBack(u?1:0,g?1:0,C||0,L||0,z,le)}const Q=Math.pow(2,25),ge=Math.pow(2,24),Je=Math.pow(2,17),It=Math.pow(2,16),Vt=Math.pow(2,9),$t=Math.pow(2,8),er=Math.pow(2,1);function Yr(D){if(D.opacity===0&&!D.placed)return 0;if(D.opacity===1&&D.placed)return 4294967295;const u=D.placed?1:0,g=Math.floor(127*D.opacity);return g*Q+u*ge+g*Je+u*It+g*Vt+u*$t+g*er+u}const tn=0;class Gr{constructor(u){this._sortAcrossTiles=u.layout.get("symbol-z-order")!=="viewport-y"&&!u.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(u,g,w,C,L){const z=this._bucketParts;for(;this._currentTileIndex<u.length;)if(g.getBucketParts(z,C,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,L())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort(((Y,re)=>Y.sortKey-re.sortKey)));this._currentPartIndex<z.length;)if(g.placeLayerBucketPart(z[this._currentPartIndex],this._seenCrossTileIDs,w),this._currentPartIndex++,L())return!0;return!1}}class an{constructor(u,g,w,C,L,z,Y,re){this.placement=new Uc(u,g,z,Y,re),this._currentPlacementIndex=w.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=L,this._done=!1}isDone(){return this._done}continuePlacement(u,g,w){const C=T(),L=()=>!this._forceFullPlacement&&T()-C>2;for(;this._currentPlacementIndex>=0;){const z=g[u[this._currentPlacementIndex]],Y=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=Y)&&(!z.maxzoom||z.maxzoom>Y)){if(this._inProgressLayer||(this._inProgressLayer=new Gr(z)),this._inProgressLayer.continuePlacement(w[z.source],this.placement,this._showCollisionBoxes,z,L))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(u){return this.placement.commit(u),this.placement}}const Mr=512/o.a5/2;class ti{constructor(u,g,w){this.tileID=u,this.bucketInstanceId=w,this._symbolsByKey={};const C=new Map;for(let L=0;L<g.length;L++){const z=g.get(L),Y=z.key,re=C.get(Y);re?re.push(z):C.set(Y,[z])}for(const[L,z]of C){const Y={positions:z.map((re=>({x:Math.floor(re.anchorX*Mr),y:Math.floor(re.anchorY*Mr)}))),crossTileIDs:z.map((re=>re.crossTileID))};if(Y.positions.length>128){const re=new o.aT(Y.positions.length,16,Uint16Array);for(const{x:le,y:he}of Y.positions)re.add(le,he);re.finish(),delete Y.positions,Y.index=re}this._symbolsByKey[L]=Y}}getScaledCoordinates(u,g){const{x:w,y:C,z:L}=this.tileID.canonical,{x:z,y:Y,z:re}=g.canonical,le=Mr/Math.pow(2,re-L),he=(Y*o.a5+u.anchorY)*le,Ae=C*o.a5*Mr;return{x:Math.floor((z*o.a5+u.anchorX)*le-w*o.a5*Mr),y:Math.floor(he-Ae)}}findMatches(u,g,w){const C=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-g.canonical.z);for(let L=0;L<u.length;L++){const z=u.get(L);if(z.crossTileID)continue;const Y=this._symbolsByKey[z.key];if(!Y)continue;const re=this.getScaledCoordinates(z,g);if(Y.index){const le=Y.index.range(re.x-C,re.y-C,re.x+C,re.y+C).sort();for(const he of le){const Ae=Y.crossTileIDs[he];if(!w[Ae]){w[Ae]=!0,z.crossTileID=Ae;break}}}else if(Y.positions)for(let le=0;le<Y.positions.length;le++){const he=Y.positions[le],Ae=Y.crossTileIDs[le];if(Math.abs(he.x-re.x)<=C&&Math.abs(he.y-re.y)<=C&&!w[Ae]){w[Ae]=!0,z.crossTileID=Ae;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:u})=>u))}}class ki{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $n{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(u){const g=Math.round((u-this.lng)/360);if(g!==0)for(const w in this.indexes){const C=this.indexes[w],L={};for(const z in C){const Y=C[z];Y.tileID=Y.tileID.unwrapTo(Y.tileID.wrap+g),L[Y.tileID.key]=Y}this.indexes[w]=L}this.lng=u}addBucket(u,g,w){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(let L=0;L<g.symbolInstances.length;L++)g.symbolInstances.get(L).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]={});const C=this.usedCrossTileIDs[u.overscaledZ];for(const L in this.indexes){const z=this.indexes[L];if(Number(L)>u.overscaledZ)for(const Y in z){const re=z[Y];re.tileID.isChildOf(u)&&re.findMatches(g.symbolInstances,u,C)}else{const Y=z[u.scaledTo(Number(L)).key];Y&&Y.findMatches(g.symbolInstances,u,C)}}for(let L=0;L<g.symbolInstances.length;L++){const z=g.symbolInstances.get(L);z.crossTileID||(z.crossTileID=w.generate(),C[z.crossTileID]=!0)}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new ti(u,g.symbolInstances,g.bucketInstanceId),!0}removeBucketCrossTileIDs(u,g){for(const w of g.getCrossTileIDsLists())for(const C of w)delete this.usedCrossTileIDs[u][C]}removeStaleBuckets(u){let g=!1;for(const w in this.indexes){const C=this.indexes[w];for(const L in C)u[C[L].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,C[L]),delete C[L],g=!0)}return g}}class _n{constructor(){this.layerIndexes={},this.crossTileIDs=new ki,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(u,g,w){let C=this.layerIndexes[u.id];C===void 0&&(C=this.layerIndexes[u.id]=new $n);let L=!1;const z={};C.handleWrapJump(w);for(const Y of g){const re=Y.getBucket(u);re&&u.id===re.layerIds[0]&&(re.bucketInstanceId||(re.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(Y.tileID,re,this.crossTileIDs)&&(L=!0),z[re.bucketInstanceId]=!0)}return C.removeStaleBuckets(z)&&(L=!0),L}pruneUnusedLayers(u){const g={};u.forEach((w=>{g[w]=!0}));for(const w in this.layerIndexes)g[w]||delete this.layerIndexes[w]}}var Rr="void main() {fragColor=vec4(1.0);}";const fn={prelude:mn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:mn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:mn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:mn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:mn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:mn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:mn(Rr,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:mn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:mn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:mn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:mn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:mn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:mn(Rr,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:mn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:mn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:mn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:mn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:mn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:mn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:mn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:mn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:mn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:mn(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:mn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:mn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:mn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:mn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:mn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:mn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:mn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:mn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:mn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:mn(`#ifdef GL_ES
precision highp float;
#endif
in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:mn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function mn(D,u){const g=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=u.match(/in ([\w]+) ([\w]+)/g),C=D.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=u.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),z=L?L.concat(C):C,Y={};return{fragmentSource:D=D.replace(g,((re,le,he,Ae,Ce)=>(Y[Ce]=!0,le==="define"?`
#ifndef HAS_UNIFORM_u_${Ce}
in ${he} ${Ae} ${Ce};
#else
uniform ${he} ${Ae} u_${Ce};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Ce}
    ${he} ${Ae} ${Ce} = u_${Ce};
#endif
`))),vertexSource:u=u.replace(g,((re,le,he,Ae,Ce)=>{const Ue=Ae==="float"?"vec2":"vec4",Ze=Ce.match(/color/)?"color":Ue;return Y[Ce]?le==="define"?`
#ifndef HAS_UNIFORM_u_${Ce}
uniform lowp float u_${Ce}_t;
in ${he} ${Ue} a_${Ce};
out ${he} ${Ae} ${Ce};
#else
uniform ${he} ${Ae} u_${Ce};
#endif
`:Ze==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ce}
    ${Ce} = a_${Ce};
#else
    ${he} ${Ae} ${Ce} = u_${Ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ce}
    ${Ce} = unpack_mix_${Ze}(a_${Ce}, u_${Ce}_t);
#else
    ${he} ${Ae} ${Ce} = u_${Ce};
#endif
`:le==="define"?`
#ifndef HAS_UNIFORM_u_${Ce}
uniform lowp float u_${Ce}_t;
in ${he} ${Ue} a_${Ce};
#else
uniform ${he} ${Ae} u_${Ce};
#endif
`:Ze==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ce}
    ${he} ${Ae} ${Ce} = a_${Ce};
#else
    ${he} ${Ae} ${Ce} = u_${Ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ce}
    ${he} ${Ae} ${Ce} = unpack_mix_${Ze}(a_${Ce}, u_${Ce}_t);
#else
    ${he} ${Ae} ${Ce} = u_${Ce};
#endif
`})),staticAttributes:w,staticUniforms:z}}class fi{constructor(u,g,w){this.vertexBuffer=u,this.indexBuffer=g,this.segments=w}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var $i=o.aU([{name:"a_pos",type:"Int16",components:2}]);const ba="#define PROJECTION_MERCATOR",wi="mercator";class hi{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return wi}get shaderDefine(){return ba}get shaderPreludeCode(){return fn.projectionMercator}get vertexShaderPreludeCode(){return fn.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(u){}getMeshFromTileID(u,g,w,C,L){if(this._cachedMesh)return this._cachedMesh;const z=new o.aW;z.emplaceBack(0,0),z.emplaceBack(o.a5,0),z.emplaceBack(0,o.a5),z.emplaceBack(o.a5,o.a5);const Y=u.createVertexBuffer(z,$i.members),re=o.aX.simpleSegment(0,0,4,2),le=new o.aY;le.emplaceBack(1,0,2),le.emplaceBack(1,2,3);const he=u.createIndexBuffer(le);return this._cachedMesh=new fi(Y,he,re),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(u){}}class Cs{constructor(u=0,g=0,w=0,C=0){if(isNaN(u)||u<0||isNaN(g)||g<0||isNaN(w)||w<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=g,this.left=w,this.right=C}interpolate(u,g,w){return g.top!=null&&u.top!=null&&(this.top=o.G.number(u.top,g.top,w)),g.bottom!=null&&u.bottom!=null&&(this.bottom=o.G.number(u.bottom,g.bottom,w)),g.left!=null&&u.left!=null&&(this.left=o.G.number(u.left,g.left,w)),g.right!=null&&u.right!=null&&(this.right=o.G.number(u.right,g.right,w)),this}getCenter(u,g){const w=o.an((this.left+u-this.right)/2,0,u),C=o.an((this.top+g-this.bottom)/2,0,g);return new o.P(w,C)}equals(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}clone(){return new Cs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function $s(D,u){if(!D.renderWorldCopies||D.lngRange)return;const g=u.lng-D.center.lng;u.lng+=g>180?-360:g<-180?360:0}function Ri(D){return Math.max(0,Math.floor(D))}class As{constructor(u,g){var w;this.applyConstrain=(C,L)=>this._constrainOverride!==null?this._constrainOverride(C,L):this._callbacks.defaultConstrain(C,L),this._callbacks=u,this._tileSize=512,this._renderWorldCopies=g?.renderWorldCopies===void 0||!!g?.renderWorldCopies,this._minZoom=g?.minZoom||0,this._maxZoom=g?.maxZoom||22,this._minPitch=g?.minPitch==null?0:g?.minPitch,this._maxPitch=g?.maxPitch==null?60:g?.maxPitch,this._constrainOverride=(w=g?.constrainOverride)!==null&&w!==void 0?w:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ri(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Cs,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(u,g,w){this._constrainOverride=u.constrainOverride,this._latRange=u.latRange,this._lngRange=u.lngRange,this._width=u.width,this._height=u.height,this._center=u.center,this._elevation=u.elevation,this._minElevationForCurrentTile=u.minElevationForCurrentTile,this._zoom=u.zoom,this._tileZoom=Ri(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=u.bearingInRadians,this._fovInRadians=u.fovInRadians,this._pitchInRadians=u.pitchInRadians,this._rollInRadians=u.rollInRadians,this._unmodified=u.unmodified,this._edgeInsets=new Cs(u.padding.top,u.padding.bottom,u.padding.left,u.padding.right),this._minZoom=u.minZoom,this._maxZoom=u.maxZoom,this._minPitch=u.minPitch,this._maxPitch=u.maxPitch,this._renderWorldCopies=u.renderWorldCopies,this._cameraToCenterDistance=u.cameraToCenterDistance,this._nearZ=u.nearZ,this._farZ=u.farZ,this._autoCalculateNearFarZ=!w&&u.autoCalculateNearFarZ,g&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(u){this._minElevationForCurrentTile=u}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(u){this._minZoom!==u&&(this._minZoom=u,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(u){this._maxZoom!==u&&(this._maxZoom=u,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(u){this._minPitch!==u&&(this._minPitch=u,this.setPitch(Math.max(this.pitch,u)))}get maxPitch(){return this._maxPitch}setMaxPitch(u){this._maxPitch!==u&&(this._maxPitch=u,this.setPitch(Math.min(this.pitch,u)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u}get constrainOverride(){return this._constrainOverride}setConstrainOverride(u){u===void 0&&(u=null),this._constrainOverride!==u&&(this._constrainOverride=u,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(u){const g=o.W(u,-180,180)*Math.PI/180;var w,C,L,z,Y,re,le,he,Ae;this._bearingInRadians!==g&&(this._unmodified=!1,this._bearingInRadians=g,this._calcMatrices(),this._rotationMatrix=f(),w=this._rotationMatrix,L=-this._bearingInRadians,z=(C=this._rotationMatrix)[0],Y=C[1],re=C[2],le=C[3],he=Math.sin(L),Ae=Math.cos(L),w[0]=z*Ae+re*he,w[1]=Y*Ae+le*he,w[2]=z*-he+re*Ae,w[3]=Y*-he+le*Ae)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(u){const g=o.an(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==g&&(this._unmodified=!1,this._pitchInRadians=g,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(u){const g=u/180*Math.PI;this._rollInRadians!==g&&(this._unmodified=!1,this._rollInRadians=g,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aZ(this._fovInRadians)}setFov(u){u=o.an(u,.1,150),this.fov!==u&&(this._unmodified=!1,this._fovInRadians=o.ap(u),this._calcMatrices())}get zoom(){return this._zoom}setZoom(u){const g=this.applyConstrain(this._center,u).zoom;this._zoom!==g&&(this._unmodified=!1,this._zoom=g,this._tileZoom=Math.max(0,Math.floor(g)),this._scale=o.aq(g),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(u){u!==this._elevation&&(this._elevation=u,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(u,g){this._autoCalculateNearFarZ=!1,this._nearZ=u,this._farZ=g,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(u){return this._edgeInsets.equals(u)}interpolatePadding(u,g,w){this._unmodified=!1,this._edgeInsets.interpolate(u,g,w),this.constrainInternal(),this._calcMatrices()}resize(u,g,w=!0){this._width=u,this._height=g,w&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ht([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(u){u?(this._lngRange=[u.getWest(),u.getEast()],this._latRange=[u.getSouth(),u.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-o.ao,o.ao])}getCameraQueryGeometry(u,g){if(g.length===1)return[g[0],u];{const{minX:w,minY:C,maxX:L,maxY:z}=o.aa.fromPoints(g).extend(u);return[new o.P(w,C),new o.P(L,C),new o.P(L,z),new o.P(w,z),new o.P(w,C)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const u=this._unmodified,{center:g,zoom:w}=this.applyConstrain(this.center,this.zoom);this.setCenter(g),this.setZoom(w),this._unmodified=u,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let u=o.ar(new Float64Array(16));o.Q(u,u,[this._width/2,-this._height/2,1]),o.O(u,u,[1,-1,0]),this._clipSpaceToPixelsMatrix=u,u=o.ar(new Float64Array(16)),o.Q(u,u,[1,-1,1]),o.O(u,u,[-1,-1,0]),o.Q(u,u,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=u,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(u,g,w,C){const L=w!==void 0?w:this.bearing,z=C=C!==void 0?C:this.pitch,{distanceToCenter:Y,clampedElevation:re}=this._distanceToCenterFromAltElevationPitch(g,this.elevation,z),{x:le,y:he}=en(z,L),Ae=o.a9.fromLngLat(u,g);let Ce,Ue,Ze=o.a_(1,Ae.y),ht=0;do{if(ht+=1,ht>10)break;Ue=Y/Ze,Ce=new o.a9(Ae.x+le*Ue,Ae.y+he*Ue),Ze=1/Ce.meterInMercatorCoordinateUnits()}while(Math.abs(Y-Ue*Ze)>1e-12);return{center:Ce.toLngLat(),elevation:re,zoom:o.at(this.height/2/Math.tan(this.fovInRadians/2)/Ue/this.tileSize)}}recalculateZoomAndCenter(u){if(this.elevation-u==0)return;const g=1/this.worldSize,w=o.as(1,this.center.lat)*this.worldSize,C=o.a9.fromLngLat(this.center,this.elevation),L=C.x/g,z=C.y/g,Y=C.z/g,re=this.pitch,le=this.bearing,{x:he,y:Ae,z:Ce}=en(re,le),Ue=this.cameraToCenterDistance,Ze=L+Ue*-he,ht=z+Ue*-Ae,pt=Y+Ue*Ce,{distanceToCenter:dt,clampedElevation:xt}=this._distanceToCenterFromAltElevationPitch(pt/w,u,re),Ot=dt*w,wt=new o.a9((Ze+he*Ot)*g,(ht+Ae*Ot)*g,0).toLngLat(),Lt=o.as(1,wt.lat),jt=o.at(this.height/2/Math.tan(this.fovInRadians/2)/dt/Lt/this.tileSize);this._elevation=xt,this._center=wt,this.setZoom(jt)}_distanceToCenterFromAltElevationPitch(u,g,w){const C=-Math.cos(o.ap(w)),L=u-g;let z,Y=g;return C*L>=0||Math.abs(C)<.1?(z=1e4,Y=u+z*C):z=-L/C,{distanceToCenter:z,clampedElevation:Y}}getCameraPoint(){const u=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(u*Math.sin(this.rollInRadians),u*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const u=o.as(1,this.center.lat)*this.worldSize;return Rt(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/u).toLngLat()}getMercatorTileCoordinates(u){if(!u)return[0,0,1,1];const g=u.canonical.z>=0?1<<u.canonical.z:Math.pow(2,u.canonical.z);return[u.canonical.x/g,u.canonical.y/g,1/g/o.a5,1/g/o.a5]}}class oa{constructor(u,g){this.min=u,this.max=g,this.center=o.a$([],o.b0([],this.min,this.max),.5)}quadrant(u){const g=[u%2==0,u<2],w=o.b1(this.min),C=o.b1(this.max);for(let L=0;L<g.length;L++)w[L]=g[L]?this.min[L]:this.center[L],C[L]=g[L]?this.center[L]:this.max[L];return C[2]=this.max[2],new oa(w,C)}distanceX(u){return Math.max(Math.min(this.max[0],u[0]),this.min[0])-u[0]}distanceY(u){return Math.max(Math.min(this.max[1],u[1]),this.min[1])-u[1]}intersectsFrustum(u){let g=!0;for(let w=0;w<u.planes.length;w++){const C=this.intersectsPlane(u.planes[w]);if(C===0)return 0;C===1&&(g=!1)}return g?2:u.aabb.min[0]>this.max[0]||u.aabb.min[1]>this.max[1]||u.aabb.min[2]>this.max[2]||u.aabb.max[0]<this.min[0]||u.aabb.max[1]<this.min[1]||u.aabb.max[2]<this.min[2]?0:1}intersectsPlane(u){let g=u[3],w=u[3];for(let C=0;C<3;C++)u[C]>0?(g+=u[C]*this.min[C],w+=u[C]*this.max[C]):(w+=u[C]*this.min[C],g+=u[C]*this.max[C]);return g>=0?2:w<0?0:1}}class Mu{distanceToTile2d(u,g,w,C){const L=C.distanceX([u,g]),z=C.distanceY([u,g]);return Math.hypot(L,z)}getWrap(u,g,w){return w}getTileBoundingVolume(u,g,w,C){var L,z;let Y=0,re=0;if(C?.terrain){const he=new o.a2(u.z,g,u.z,u.x,u.y),Ae=C.terrain.getMinMaxElevation(he);Y=(L=Ae.minElevation)!==null&&L!==void 0?L:Math.min(0,w),re=(z=Ae.maxElevation)!==null&&z!==void 0?z:Math.max(0,w)}const le=1<<u.z;return new oa([g+u.x/le,u.y/le,Y],[g+(u.x+1)/le,(u.y+1)/le,re])}allowVariableZoom(u,g){const w=u.fov*(Math.abs(Math.cos(u.rollInRadians))*u.height+Math.abs(Math.sin(u.rollInRadians))*u.width)/u.height,C=o.an(78.5-w/2,0,60);return!!g.terrain||u.pitch>C}allowWorldCopies(){return!0}prepareNextFrame(){}}class Ka{constructor(u,g,w){this.points=u,this.planes=g,this.aabb=w}static fromInvProjectionMatrix(u,g=1,w=0,C,L){const z=L?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],Y=Math.pow(2,w),re=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((Ce=>(function(Ue,Ze,ht,pt){const dt=o.aH([],Ue,Ze),xt=1/dt[3]/ht*pt;return o.b6(dt,dt,[xt,xt,1/dt[3],xt])})(Ce,u,g,Y)));C&&(function(Ce,Ue,Ze,ht){const pt=ht?4:0,dt=ht?0:4;let xt=0;const Ot=[],wt=[];for(let Dt=0;Dt<4;Dt++){const Yt=o.b2([],Ce[Dt+dt],Ce[Dt+pt]),Sr=o.b7(Yt);o.a$(Yt,Yt,1/Sr),Ot.push(Sr),wt.push(Yt)}for(let Dt=0;Dt<4;Dt++){const Yt=o.b8(Ce[Dt+pt],wt[Dt],Ze);xt=Yt!==null&&Yt>=0?Math.max(xt,Yt):Math.max(xt,Ot[Dt])}const Lt=(function(Dt,Yt){const Sr=o.b2([],Dt[Yt[0]],Dt[Yt[1]]),dr=o.b2([],Dt[Yt[2]],Dt[Yt[1]]),yr=[0,0,0,0];return o.b3(yr,o.b4([],Sr,dr)),yr[3]=-o.b5(yr,Dt[Yt[0]]),yr})(Ce,Ue),jt=(function(Dt,Yt){const Sr=o.b9(Dt),dr=o.ba([],Dt,1/Sr),yr=o.b2([],Yt,o.a$([],dr,o.b5(Yt,dr))),xr=o.b9(yr);if(xr>0){const nn=Math.sqrt(1-dr[3]*dr[3]),sn=o.a$([],dr,-dr[3]),Hr=o.b0([],sn,o.a$([],yr,nn/xr));return o.bb(Yt,Hr)}return null})(Ze,Lt);if(jt!==null){const Dt=jt/o.b5(wt[0],Lt);xt=Math.min(xt,Dt)}for(let Dt=0;Dt<4;Dt++){const Yt=Math.min(xt,Ot[Dt]);Ce[Dt+dt]=[Ce[Dt+pt][0]+wt[Dt][0]*Yt,Ce[Dt+pt][1]+wt[Dt][1]*Yt,Ce[Dt+pt][2]+wt[Dt][2]*Yt,1]}})(re,z[0],C,L);const le=z.map((Ce=>{const Ue=o.b2([],re[Ce[0]],re[Ce[1]]),Ze=o.b2([],re[Ce[2]],re[Ce[1]]),ht=o.b3([],o.b4([],Ue,Ze)),pt=-o.b5(ht,re[Ce[1]]);return ht.concat(pt)})),he=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Ae=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const Ce of re)for(let Ue=0;Ue<3;Ue++)he[Ue]=Math.min(he[Ue],Ce[Ue]),Ae[Ue]=Math.max(Ae[Ue],Ce[Ue]);return new Ka(re,le,new oa(he,Ae))}}class qs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(u){this._helper.setMinZoom(u)}setMaxZoom(u){this._helper.setMaxZoom(u)}setMinPitch(u){this._helper.setMinPitch(u)}setMaxPitch(u){this._helper.setMaxPitch(u)}setRenderWorldCopies(u){this._helper.setRenderWorldCopies(u)}setBearing(u){this._helper.setBearing(u)}setPitch(u){this._helper.setPitch(u)}setRoll(u){this._helper.setRoll(u)}setFov(u){this._helper.setFov(u)}setZoom(u){this._helper.setZoom(u)}setCenter(u){this._helper.setCenter(u)}setElevation(u){this._helper.setElevation(u)}setMinElevationForCurrentTile(u){this._helper.setMinElevationForCurrentTile(u)}setPadding(u){this._helper.setPadding(u)}interpolatePadding(u,g,w){return this._helper.interpolatePadding(u,g,w)}isPaddingEqual(u){return this._helper.isPaddingEqual(u)}resize(u,g,w=!0){this._helper.resize(u,g,w)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(u){this._helper.setMaxBounds(u)}setConstrainOverride(u){this._helper.setConstrainOverride(u)}overrideNearFarZ(u,g){this._helper.overrideNearFarZ(u,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(u){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),u)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(u,g){}constructor(u){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(g,w)=>{w=o.an(+w,this.minZoom,this.maxZoom);const C={center:new o.V(g.lng,g.lat),zoom:w};let L=this._helper._lngRange;if(!this._helper._renderWorldCopies&&L===null){const wt=179.9999999999;L=[-wt,wt]}const z=this.tileSize*o.aq(C.zoom);let Y=0,re=z,le=0,he=z,Ae=0,Ce=0;const{x:Ue,y:Ze}=this.size;if(this._helper._latRange){const wt=this._helper._latRange;Y=o.X(wt[1])*z,re=o.X(wt[0])*z,re-Y<Ze&&(Ae=Ze/(re-Y))}L&&(le=o.W(o.Y(L[0])*z,0,z),he=o.W(o.Y(L[1])*z,0,z),he<le&&(he+=z),he-le<Ue&&(Ce=Ue/(he-le)));const{x:ht,y:pt}=Ar(z,g);let dt,xt;const Ot=Math.max(Ce||0,Ae||0);if(Ot){const wt=new o.P(Ce?(he+le)/2:ht,Ae?(re+Y)/2:pt);return C.center=$r(z,wt).wrap(),C.zoom+=o.at(Ot),C}if(this._helper._latRange){const wt=Ze/2;pt-wt<Y&&(xt=Y+wt),pt+wt>re&&(xt=re-wt)}if(L){const wt=(le+he)/2;let Lt=ht;this._helper._renderWorldCopies&&(Lt=o.W(ht,wt-z/2,wt+z/2));const jt=Ue/2;Lt-jt<le&&(dt=le+jt),Lt+jt>he&&(dt=he-jt)}if(dt!==void 0||xt!==void 0){const wt=new o.P(dt??ht,xt??pt);C.center=$r(z,wt).wrap()}return C},this.applyConstrain=(g,w)=>this._helper.applyConstrain(g,w),this._helper=new As({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(g,w)=>this.defaultConstrain(g,w)},u),this._coveringTilesDetailsProvider=new Mu}clone(){const u=new qs;return u.apply(this,!1),u}apply(u,g,w){this._helper.apply(u,g,w)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(u){const g=[new o.bc(0,u)];if(this._helper._renderWorldCopies){const w=this.screenPointToMercatorCoordinate(new o.P(0,0)),C=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),L=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),z=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),Y=Math.floor(Math.min(w.x,C.x,L.x,z.x)),re=Math.floor(Math.max(w.x,C.x,L.x,z.x)),le=1;for(let he=Y-le;he<=re+le;he++)he!==0&&g.push(new o.bc(he,u))}return g}getCameraFrustum(){return Ka.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(u){const g=this.screenPointToLocation(this.centerPoint,u),w=u?u.getElevationForLngLatZoom(g,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(w)}setLocationAtPoint(u,g){const w=o.as(this.elevation,this.center.lat),C=this.screenPointToMercatorCoordinateAtZ(g,w),L=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,w),z=o.a9.fromLngLat(u),Y=new o.a9(z.x-(C.x-L.x),z.y-(C.y-L.y));this.setCenter(Y?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(u,g){return g?this.coordinatePoint(o.a9.fromLngLat(u),g.getElevationForLngLat(u,this),this._pixelMatrix3D):this.coordinatePoint(o.a9.fromLngLat(u))}screenPointToLocation(u,g){var w;return(w=this.screenPointToMercatorCoordinate(u,g))===null||w===void 0?void 0:w.toLngLat()}screenPointToMercatorCoordinate(u,g){if(g){const w=g.pointCoordinate(u);if(w!=null)return w}return this.screenPointToMercatorCoordinateAtZ(u)}screenPointToMercatorCoordinateAtZ(u,g){const w=g||0,C=[u.x,u.y,0,1],L=[u.x,u.y,1,1];o.aH(C,C,this._pixelMatrixInverse),o.aH(L,L,this._pixelMatrixInverse);const z=C[3],Y=L[3],re=C[1]/z,le=L[1]/Y,he=C[2]/z,Ae=L[2]/Y,Ce=he===Ae?0:(w-he)/(Ae-he);return new o.a9(o.G.number(C[0]/z,L[0]/Y,Ce)/this.worldSize,o.G.number(re,le,Ce)/this.worldSize,w)}coordinatePoint(u,g=0,w=this._pixelMatrix){const C=[u.x*this.worldSize,u.y*this.worldSize,g,1];return o.aH(C,C,w),new o.P(C[0]/C[3],C[1]/C[3])}getBounds(){const u=Math.max(0,this._helper._height/2-cn(this));return new Ht().extend(this.screenPointToLocation(new o.P(0,u))).extend(this.screenPointToLocation(new o.P(this._helper._width,u))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(u,g){return g?g.pointCoordinate(u)!=null:u.y>this.height/2-cn(this)}calculatePosMatrix(u,g=!1,w){var C;const L=(C=u.key)!==null&&C!==void 0?C:o.bd(u.wrap,u.canonical.z,u.canonical.z,u.canonical.x,u.canonical.y),z=g?this._alignedPosMatrixCache:this._posMatrixCache;if(z.has(L)){const le=z.get(L);return w?le.f32:le.f64}const Y=zr(u,this.worldSize);o.S(Y,g?this._alignedProjMatrix:this._viewProjMatrix,Y);const re={f64:Y,f32:new Float32Array(Y)};return z.set(L,re),w?re.f32:re.f64}calculateFogMatrix(u){const g=u.key,w=this._fogMatrixCacheF32;if(w.has(g))return w.get(g);const C=zr(u,this.worldSize);return o.S(C,this._fogMatrix,C),w.set(g,new Float32Array(C)),w.get(g)}calculateCenterFromCameraLngLatAlt(u,g,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(u,g,w,C)}_calculateNearFarZIfNeeded(u,g,w){if(!this._helper.autoCalculateNearFarZ)return;const C=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),L=u-C*this._helper._pixelPerMeter/Math.cos(g),z=C<0?L:u,Y=Math.PI/2+this.pitchInRadians,re=o.ap(this.fov)*(Math.abs(Math.cos(o.ap(this.roll)))*this.height+Math.abs(Math.sin(o.ap(this.roll)))*this.width)/this.height*(.5+w.y/this.height),le=Math.sin(re)*z/Math.sin(o.an(Math.PI-Y-re,.01,Math.PI-.01)),he=cn(this),Ae=Math.atan(he/this._helper.cameraToCenterDistance),Ce=o.ap(.75),Ue=Ae>Ce?2*Ae*(.5+w.y/(2*he)):Ce,Ze=Math.sin(Ue)*z/Math.sin(o.an(Math.PI-Y-Ue,.01,Math.PI-.01)),ht=Math.min(le,Ze);this._helper._farZ=1.01*(Math.cos(Math.PI/2-g)*ht+z),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const u=this.centerOffset,g=Ar(this.worldSize,this.center),w=g.x,C=g.y;this._helper._pixelPerMeter=o.as(1,this.center.lat)*this.worldSize;const L=o.ap(Math.min(this.pitch,Ir)),z=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(L));let Y;this._calculateNearFarZIfNeeded(z,L,u),Y=new Float64Array(16),o.be(Y,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.aB(this._invProjMatrix,Y),Y[8]=2*-u.x/this._helper._width,Y[9]=2*u.y/this._helper._height,this._projectionMatrix=o.bf(Y),o.Q(Y,Y,[1,-1,1]),o.O(Y,Y,[0,0,-this._helper.cameraToCenterDistance]),o.bg(Y,Y,-this.rollInRadians),o.bh(Y,Y,this.pitchInRadians),o.bg(Y,Y,-this.bearingInRadians),o.O(Y,Y,[-w,-C,0]),this._mercatorMatrix=o.Q([],Y,[this.worldSize,this.worldSize,this.worldSize]),o.Q(Y,Y,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,Y),o.O(Y,Y,[0,0,-this.elevation]),this._viewProjMatrix=Y,this._invViewProjMatrix=o.aB([],Y);const re=[0,0,-1,1];o.aH(re,re,this._invViewProjMatrix),this._cameraPosition=[re[0]/re[3],re[1]/re[3],re[2]/re[3]],this._fogMatrix=new Float64Array(16),o.be(this._fogMatrix,this.fovInRadians,this.width/this.height,z,this._helper._farZ),this._fogMatrix[8]=2*-u.x/this.width,this._fogMatrix[9]=2*u.y/this.height,o.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.O(this._fogMatrix,this._fogMatrix,[-w,-C,0]),o.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,Y);const le=this._helper._width%2/2,he=this._helper._height%2/2,Ae=Math.cos(this.bearingInRadians),Ce=Math.sin(-this.bearingInRadians),Ue=w-Math.round(w)+Ae*le+Ce*he,Ze=C-Math.round(C)+Ae*he+Ce*le,ht=new Float64Array(Y);if(o.O(ht,ht,[Ue>.5?Ue-1:Ue,Ze>.5?Ze-1:Ze,0]),this._alignedProjMatrix=ht,Y=o.aB(new Float64Array(16),this._pixelMatrix),!Y)throw new Error("failed to invert matrix");this._pixelMatrixInverse=Y,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const u=this.screenPointToMercatorCoordinate(new o.P(0,0)),g=[u.x*this.worldSize,u.y*this.worldSize,0,1];return o.aH(g,g,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const u=o.as(1,this.center.lat)*this.worldSize;return Rt(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/u).toLngLat()}lngLatToCameraDepth(u,g){const w=o.a9.fromLngLat(u),C=[w.x*this.worldSize,w.y*this.worldSize,g,1];return o.aH(C,C,this._viewProjMatrix),C[2]/C[3]}getProjectionData(u){const{overscaledTileID:g,aligned:w,applyTerrainMatrix:C}=u,L=this._helper.getMercatorTileCoordinates(g),z=g?this.calculatePosMatrix(g,w,!0):null;let Y;return Y=g&&g.terrainRttPosMatrix32f&&C?g.terrainRttPosMatrix32f:z||o.bi(),{mainMatrix:Y,tileMercatorCoords:L,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:Y}}isLocationOccluded(u){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(u,g,w){return 1}transformLightDirection(u){return o.b1(u)}getRayDirectionFromPixel(u){throw new Error("Not implemented.")}projectTileCoordinates(u,g,w,C){const L=this.calculatePosMatrix(w);let z;C?(z=[u,g,C(u,g),1],o.aH(z,z,L)):(z=[u,g,0,1],Fa(z,z,L));const Y=z[3];return{point:new o.P(z[0]/Y,z[1]/Y),signedDistanceFromCamera:Y,isOccluded:!1}}populateCache(u){for(const g of u)this.calculatePosMatrix(g)}getMatrixForModel(u,g){const w=o.a9.fromLngLat(u,g),C=w.meterInMercatorCoordinateUnits(),L=o.bj();return o.O(L,L,[w.x,w.y,w.z]),o.bg(L,L,Math.PI),o.bh(L,L,Math.PI/2),o.Q(L,L,[-C,C,C]),L}getProjectionDataForCustomLayer(u=!0){const g=new o.a2(0,0,0,0,0),w=this.getProjectionData({overscaledTileID:g,applyGlobeMatrix:u}),C=zr(g,this.worldSize);o.S(C,this._viewProjMatrix,C),w.tileMercatorCoords=[0,0,1,1];const L=[o.a5,o.a5,this.worldSize/this._helper.pixelsPerMeter],z=o.bk();return o.Q(z,C,L),w.fallbackMatrix=z,w.mainMatrix=z,w}getFastPathSimpleProjectionMatrix(u){return this.calculatePosMatrix(u)}}function Vo(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function ku(D){if(D.useSlerp)if(D.k<1){const u=o.bl(D.startEulerAngles.roll,D.startEulerAngles.pitch,D.startEulerAngles.bearing),g=o.bl(D.endEulerAngles.roll,D.endEulerAngles.pitch,D.endEulerAngles.bearing),w=new Float64Array(4);o.bm(w,u,g,D.k);const C=o.bn(w);D.tr.setRoll(C.roll),D.tr.setPitch(C.pitch),D.tr.setBearing(C.bearing)}else D.tr.setRoll(D.endEulerAngles.roll),D.tr.setPitch(D.endEulerAngles.pitch),D.tr.setBearing(D.endEulerAngles.bearing);else D.tr.setRoll(o.G.number(D.startEulerAngles.roll,D.endEulerAngles.roll,D.k)),D.tr.setPitch(o.G.number(D.startEulerAngles.pitch,D.endEulerAngles.pitch,D.k)),D.tr.setBearing(o.G.number(D.startEulerAngles.bearing,D.endEulerAngles.bearing,D.k))}function Ru(D,u,g,w,C){const L=C.padding,z=Ar(C.worldSize,g.getNorthWest()),Y=Ar(C.worldSize,g.getNorthEast()),re=Ar(C.worldSize,g.getSouthEast()),le=Ar(C.worldSize,g.getSouthWest()),he=o.ap(-w),Ae=z.rotate(he),Ce=Y.rotate(he),Ue=re.rotate(he),Ze=le.rotate(he),ht=new o.P(Math.max(Ae.x,Ce.x,Ze.x,Ue.x),Math.max(Ae.y,Ce.y,Ze.y,Ue.y)),pt=new o.P(Math.min(Ae.x,Ce.x,Ze.x,Ue.x),Math.min(Ae.y,Ce.y,Ze.y,Ue.y)),dt=ht.sub(pt),xt=(C.width-(L.left+L.right+u.left+u.right))/dt.x,Ot=(C.height-(L.top+L.bottom+u.top+u.bottom))/dt.y;if(Ot<0||xt<0)return void Vo();const wt=Math.min(o.at(C.scale*Math.min(xt,Ot)),D.maxZoom),Lt=o.P.convert(D.offset),jt=new o.P((u.left-u.right)/2,(u.top-u.bottom)/2).rotate(o.ap(w)),Dt=Lt.add(jt).mult(C.scale/o.aq(wt));return{center:$r(C.worldSize,z.add(re).div(2).sub(Dt)),zoom:wt,bearing:w}}class go{get useGlobeControls(){return!1}handlePanInertia(u,g){const w=u.mag(),C=Math.abs(cn(g));return{easingOffset:u.mult(Math.min(.75*C/w,1)),easingCenter:g.center}}handleMapControlsRollPitchBearingZoom(u,g){u.bearingDelta&&g.setBearing(g.bearing+u.bearingDelta),u.pitchDelta&&g.setPitch(g.pitch+u.pitchDelta),u.rollDelta&&g.setRoll(g.roll+u.rollDelta),u.zoomDelta&&g.setZoom(g.zoom+u.zoomDelta)}handleMapControlsPan(u,g,w){u.around.distSqr(g.centerPoint)<.01||g.setLocationAtPoint(w,u.around)}cameraForBoxAndBearing(u,g,w,C,L){return Ru(u,g,w,C,L)}handleJumpToCenterZoom(u,g){u.zoom!==(g.zoom!==void 0?+g.zoom:u.zoom)&&u.setZoom(+g.zoom),g.center!==void 0&&u.setCenter(o.V.convert(g.center))}handleEaseTo(u,g){const w=u.zoom,C=u.padding,L={roll:u.roll,pitch:u.pitch,bearing:u.bearing},z={roll:g.roll===void 0?u.roll:g.roll,pitch:g.pitch===void 0?u.pitch:g.pitch,bearing:g.bearing===void 0?u.bearing:g.bearing},Y=g.zoom!==void 0,re=!u.isPaddingEqual(g.padding);let le=!1;const he=Y?+g.zoom:u.zoom;let Ae=u.centerPoint.add(g.offsetAsPoint);const Ce=u.screenPointToLocation(Ae),{center:Ue,zoom:Ze}=u.applyConstrain(o.V.convert(g.center||Ce),he??w);$s(u,Ue);const ht=Ar(u.worldSize,Ce),pt=Ar(u.worldSize,Ue).sub(ht),dt=o.aq(Ze-w);return le=Ze!==w,{easeFunc:xt=>{if(le&&u.setZoom(o.G.number(w,Ze,xt)),o.bo(L,z)||ku({startEulerAngles:L,endEulerAngles:z,tr:u,k:xt,useSlerp:L.roll!=z.roll}),re&&(u.interpolatePadding(C,g.padding,xt),Ae=u.centerPoint.add(g.offsetAsPoint)),g.around)u.setLocationAtPoint(g.around,g.aroundPoint);else{const Ot=o.aq(u.zoom-w),wt=Ze>w?Math.min(2,dt):Math.max(.5,dt),Lt=Math.pow(wt,1-xt),jt=$r(u.worldSize,ht.add(pt.mult(xt*Lt)).mult(Ot));u.setLocationAtPoint(u.renderWorldCopies?jt.wrap():jt,Ae)}},isZooming:le,elevationCenter:Ue}}handleFlyTo(u,g){const w=g.zoom!==void 0,C=u.zoom,L=u.applyConstrain(o.V.convert(g.center||g.locationAtOffset),w?+g.zoom:C),z=L.center,Y=L.zoom;$s(u,z);const re=Ar(u.worldSize,g.locationAtOffset),le=Ar(u.worldSize,z).sub(re),he=le.mag(),Ae=o.aq(Y-C);let Ce;if(g.minZoom!==void 0){const Ue=Math.min(+g.minZoom,C,Y),Ze=u.applyConstrain(z,Ue).zoom;Ce=o.aq(Ze-C)}return{easeFunc:(Ue,Ze,ht,pt)=>{u.setZoom(Ue===1?Y:C+o.at(Ze));const dt=Ue===1?z:$r(u.worldSize,re.add(le.mult(ht)).mult(Ze));u.setLocationAtPoint(u.renderWorldCopies?dt.wrap():dt,pt)},scaleOfZoom:Ae,targetCenter:z,scaleOfMinZoom:Ce,pixelPathLength:he}}}class ji{constructor(u,g,w){this.blendFunction=u,this.blendColor=g,this.mask=w}}ji.Replace=[1,0],ji.disabled=new ji(ji.Replace,o.bp.transparent,[!1,!1,!1,!1]),ji.unblended=new ji(ji.Replace,o.bp.transparent,[!0,!0,!0,!0]),ji.alphaBlended=new ji([1,771],o.bp.transparent,[!0,!0,!0,!0]);const Hs=2305;class ii{constructor(u,g,w){this.enable=u,this.mode=g,this.frontFace=w}}ii.disabled=new ii(!1,1029,Hs),ii.backCCW=new ii(!0,1029,Hs),ii.frontCCW=new ii(!0,1028,Hs);class ri{constructor(u,g,w){this.func=u,this.mask=g,this.range=w}}ri.ReadOnly=!1,ri.ReadWrite=!0,ri.disabled=new ri(519,ri.ReadOnly,[0,1]);const Oo=7680;class ai{constructor(u,g,w,C,L,z){this.test=u,this.ref=g,this.mask=w,this.fail=C,this.depthFail=L,this.pass=z}}ai.disabled=new ai({func:519,mask:0},0,0,Oo,Oo,Oo);const ue=new WeakMap;function We(D){var u;if(ue.has(D))return ue.get(D);{const g=(u=D.getParameter(D.VERSION))===null||u===void 0?void 0:u.startsWith("WebGL 2.0");return ue.set(D,g),g}}class bt{get awaitingQuery(){return!!this._readbackQueue}constructor(u){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=u;const g=u.context,w=g.gl;this._texFormat=w.RGBA,this._texType=w.UNSIGNED_BYTE;const C=new o.aW;C.emplaceBack(-1,-1),C.emplaceBack(2,-1),C.emplaceBack(-1,2);const L=new o.aY;L.emplaceBack(0,1,2),this._fullscreenTriangle=new fi(g.createVertexBuffer(C,$i.members),g.createIndexBuffer(L),o.aX.simpleSegment(0,0,C.length,L.length)),this._resultBuffer=new Uint8Array(4),g.activeTexture.set(w.TEXTURE1);const z=w.createTexture();w.bindTexture(w.TEXTURE_2D,z),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.NEAREST),w.texImage2D(w.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=g.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(z),We(w)&&(this._pbo=w.createBuffer(),w.bindBuffer(w.PIXEL_PACK_BUFFER,this._pbo),w.bufferData(w.PIXEL_PACK_BUFFER,4,w.STREAM_READ),w.bindBuffer(w.PIXEL_PACK_BUFFER,null))}destroy(){const u=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),u.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(u,g){const w=this._updateCount;return this._readbackQueue?w>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():w>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(u,g),this._updateCount++,this._measuredError}_bindFramebuffer(){const u=this._cachedRenderContext.context,g=u.gl;u.activeTexture.set(g.TEXTURE1),g.bindTexture(g.TEXTURE_2D,this._fbo.colorAttachment.get()),u.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(u,g){const w=this._cachedRenderContext.context,C=w.gl;if(this._bindFramebuffer(),w.viewport.set([0,0,this._texWidth,this._texHeight]),w.clear({color:o.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(w,C.TRIANGLES,ri.disabled,ai.disabled,ji.unblended,ii.disabled,((L,z)=>({u_input:L,u_output_expected:z}))(u,g),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&We(C)){C.bindBuffer(C.PIXEL_PACK_BUFFER,this._pbo),C.readBuffer(C.COLOR_ATTACHMENT0),C.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),C.bindBuffer(C.PIXEL_PACK_BUFFER,null);const L=C.fenceSync(C.SYNC_GPU_COMMANDS_COMPLETE,0);C.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:L}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const u=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&We(u)){const g=u.clientWaitSync(this._readbackQueue.sync,0,0);if(g===u.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(g===u.TIMEOUT_EXPIRED)return;u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),u.bindBuffer(u.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),u.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=bt._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(u){let g=0;return g+=u[0]/256,g+=u[1]/65536,g+=u[2]/16777216,u[3]<127&&(g=-g),g/128}}const Bt=o.a5/128;function sr(D,u){const g=D.granularity!==void 0?Math.max(D.granularity,1):1,w=g+(D.generateBorders?2:0),C=g+(D.extendToNorthPole||D.generateBorders?1:0)+(D.extendToSouthPole||D.generateBorders?1:0),L=w+1,z=C+1,Y=D.generateBorders?-1:0,re=D.generateBorders||D.extendToNorthPole?-1:0,le=g+(D.generateBorders?1:0),he=g+(D.generateBorders||D.extendToSouthPole?1:0),Ae=L*z,Ce=w*C*6,Ue=L*z>65536;if(Ue&&u==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Ze=Ue||u==="32bit",ht=new Int16Array(2*Ae);let pt=0;for(let Ot=re;Ot<=he;Ot++)for(let wt=Y;wt<=le;wt++){let Lt=wt/g*o.a5;wt===-1&&(Lt=-Bt),wt===g+1&&(Lt=o.a5+Bt);let jt=Ot/g*o.a5;Ot===-1&&(jt=D.extendToNorthPole?o.br:-Bt),Ot===g+1&&(jt=D.extendToSouthPole?o.bs:o.a5+Bt),ht[pt++]=Lt,ht[pt++]=jt}const dt=Ze?new Uint32Array(Ce):new Uint16Array(Ce);let xt=0;for(let Ot=0;Ot<C;Ot++)for(let wt=0;wt<w;wt++){const Lt=wt+1+Ot*L,jt=wt+(Ot+1)*L,Dt=wt+1+(Ot+1)*L;dt[xt++]=wt+Ot*L,dt[xt++]=jt,dt[xt++]=Lt,dt[xt++]=Lt,dt[xt++]=jt,dt[xt++]=Dt}return{vertices:ht.buffer.slice(0),indices:dt.buffer.slice(0),uses32bitIndices:Ze}}const Lr=new o.aV({fill:new o.bt(128,2),line:new o.bt(512,0),tile:new o.bt(128,32),stencil:new o.bt(128,1),circle:3});class Zr{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return fn.projectionGlobe}get vertexShaderPreludeCode(){return fn.projectionMercator.vertexSource}get subdivisionGranularity(){return Lr}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(u){this._errorMeasurement||(this._errorMeasurement=new bt(u));const g=o.X(this._errorQueryLatitudeDegrees),w=2*Math.atan(Math.exp(Math.PI-g*Math.PI*2))-.5*Math.PI,C=this._errorMeasurement.updateErrorLoop(g,w),L=T();C!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=C,this._errorMeasurementLastChangeTime=L);const z=Math.min(Math.max((L-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bv(z))}_getMeshKey(u){return`${u.granularity.toString(36)}_${u.generateBorders?"b":""}${u.extendToNorthPole?"n":""}${u.extendToSouthPole?"s":""}`}getMeshFromTileID(u,g,w,C,L){const z=(L==="stencil"?Lr.stencil:Lr.tile).getGranularityForZoomLevel(g.z);return this._getMesh(u,{granularity:z,generateBorders:w,extendToNorthPole:g.y===0&&C,extendToSouthPole:g.y===(1<<g.z)-1&&C})}_getMesh(u,g){const w=this._getMeshKey(g);if(w in this._tileMeshCache)return this._tileMeshCache[w];const C=(function(L,z){const Y=sr(z,"16bit"),re=o.aW.deserialize({arrayBuffer:Y.vertices,length:Y.vertices.byteLength/2/2}),le=o.aY.deserialize({arrayBuffer:Y.indices,length:Y.indices.byteLength/2/3});return new fi(L.createVertexBuffer(re,$i.members),L.createIndexBuffer(le),o.aX.simpleSegment(0,0,re.length,le.length))})(u,g);return this._tileMeshCache[w]=C,C}recalculate(u){}hasTransition(){const u=T();let g=!1;return g=g||(u-this._errorMeasurementLastChangeTime)/1e3<.7,g=g||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,g}setErrorQueryLatitudeDegrees(u){this._errorQueryLatitudeDegrees=u}}const Nn=new o.t({type:new o.D(o.u.projection.type)});class qn extends o.E{constructor(u){super(),this._transitionable=new o.x(Nn,void 0),this.setProjection(u),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0)),this._mercatorProjection=new hi,this._verticalPerspectiveProjection=new Zr}get transitionState(){const u=this.properties.get("type");if(typeof u=="string"&&u==="mercator")return 0;if(typeof u=="string"&&u==="vertical-perspective")return 1;if(u instanceof o.bw){if(u.from==="vertical-perspective"&&u.to==="mercator")return 1-u.transition;if(u.from==="mercator"&&u.to==="vertical-perspective")return u.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(u){this._mercatorProjection.updateGPUdependent(u),this._verticalPerspectiveProjection.updateGPUdependent(u)}getMeshFromTileID(u,g,w,C,L){return this.currentProjection.getMeshFromTileID(u,g,w,C,L)}setProjection(u){this._transitionable.setValue("type",u?.type||"mercator")}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}setErrorQueryLatitudeDegrees(u){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(u),this._mercatorProjection.setErrorQueryLatitudeDegrees(u)}}function Un(D){const u=Ui(D.worldSize,D.center.lat);return 2*Math.PI*u}function ui(D,u,g,w,C){const L=1/(1<<C),z=u/o.a5*L+w*L,Y=o.by((D/o.a5*L+g*L)*Math.PI*2+Math.PI,2*Math.PI),re=2*Math.atan(Math.exp(Math.PI-z*Math.PI*2))-.5*Math.PI,le=Math.cos(re),he=new Float64Array(3);return he[0]=Math.sin(Y)*le,he[1]=Math.sin(re),he[2]=Math.cos(Y)*le,he}function Hn(D){return(function(u,g){const w=Math.cos(g),C=new Float64Array(3);return C[0]=Math.sin(u)*w,C[1]=Math.sin(g),C[2]=Math.cos(u)*w,C})(D.lng*Math.PI/180,D.lat*Math.PI/180)}function Ui(D,u){return D/(2*Math.PI)/Math.cos(u*Math.PI/180)}function Xi(D){const u=Math.asin(D[1])/Math.PI*180,g=Math.sqrt(D[0]*D[0]+D[2]*D[2]);if(g>1e-6){const w=D[0]/g,C=Math.acos(D[2]/g),L=(w>0?C:-C)/Math.PI*180;return new o.V(o.W(L,-180,180),u)}return new o.V(0,u)}function ra(D){return Math.cos(D*Math.PI/180)}function Si(D,u){const g=ra(D),w=ra(u);return o.at(w/g)}function Ia(D,u){const g=D.rotate(u.bearingInRadians),w=u.zoom+Si(u.center.lat,0),C=o.bu(1/ra(u.center.lat),1/ra(Math.min(Math.abs(u.center.lat),60)),o.bx(w,7,3,0,1)),L=360/Un({worldSize:u.worldSize,center:{lat:u.center.lat}});return new o.V(u.center.lng-g.x*L*C,o.an(u.center.lat+g.y*L,-o.ao,o.ao))}function za(D){const u=.5*D,g=Math.sin(u),w=Math.cos(u);return Math.log(g+w)-Math.log(w-g)}function Gs(D,u,g,w){const C=D.lat+g*w;if(Math.abs(g)>1){const L=(Math.sign(D.lat+g)!==Math.sign(D.lat)?-Math.abs(D.lat):Math.abs(D.lat))*Math.PI/180,z=Math.abs(D.lat+g)*Math.PI/180,Y=za(L+w*(z-L)),re=za(L),le=za(z);return new o.V(D.lng+u*((Y-re)/(le-re)),C)}return new o.V(D.lng+u*w,C)}class ul{constructor(u){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=u}swapBuffers(){if(!this._hadAnyChanges)return;const u=this._cachePrevious;this._cachePrevious=this._cache,this._cache=u,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(u,g,w,C){const L=`${u.z}_${u.x}_${u.y}_${C?.terrain?"t":""}`,z=this._cache.get(L);if(z)return z;const Y=this._cachePrevious.get(L);if(Y)return this._cache.set(L,Y),Y;const re=this._boundingVolumeFactory(u,g,w,C);return this._cache.set(L,re),this._hadAnyChanges=!0,re}}class Ws{constructor(u,g,w,C){this.min=w,this.max=C,this.points=u,this.planes=g}static fromAabb(u,g){const w=[];for(let C=0;C<8;C++)w.push([1&~C?u[0]:g[0],(C>>1&1)==1?g[1]:u[1],(C>>2&1)==1?g[2]:u[2]]);return new Ws(w,[[-1,0,0,g[0]],[1,0,0,-u[0]],[0,-1,0,g[1]],[0,1,0,-u[1]],[0,0,-1,g[2]],[0,0,1,-u[2]]],u,g)}static fromCenterSizeAngles(u,g,w){const C=o.bB([],w[0],w[1],w[2]),L=o.bC([],[g[0],0,0],C),z=o.bC([],[0,g[1],0],C),Y=o.bC([],[0,0,g[2]],C),re=[...u],le=[...u];for(let Ae=0;Ae<8;Ae++)for(let Ce=0;Ce<3;Ce++){const Ue=u[Ce]+L[Ce]*(1&~Ae?-1:1)+z[Ce]*((Ae>>1&1)==1?1:-1)+Y[Ce]*((Ae>>2&1)==1?1:-1);re[Ce]=Math.min(re[Ce],Ue),le[Ce]=Math.max(le[Ce],Ue)}const he=[];for(let Ae=0;Ae<8;Ae++){const Ce=[...u];o.b0(Ce,Ce,o.a$([],L,1&~Ae?-1:1)),o.b0(Ce,Ce,o.a$([],z,(Ae>>1&1)==1?1:-1)),o.b0(Ce,Ce,o.a$([],Y,(Ae>>2&1)==1?1:-1)),he.push(Ce)}return new Ws(he,[[...L,-o.b5(L,he[0])],[...z,-o.b5(z,he[0])],[...Y,-o.b5(Y,he[0])],[-L[0],-L[1],-L[2],-o.b5(L,he[7])],[-z[0],-z[1],-z[2],-o.b5(z,he[7])],[-Y[0],-Y[1],-Y[2],-o.b5(Y,he[7])]],re,le)}intersectsFrustum(u){let g=!0;const w=this.points.length,C=this.planes.length,L=u.planes.length,z=u.points.length;for(let Y=0;Y<L;Y++){const re=u.planes[Y];let le=0;for(let he=0;he<w;he++){const Ae=this.points[he];re[0]*Ae[0]+re[1]*Ae[1]+re[2]*Ae[2]+re[3]>=0&&le++}if(le===0)return 0;le<w&&(g=!1)}if(g)return 2;for(let Y=0;Y<C;Y++){const re=this.planes[Y];let le=0;for(let he=0;he<z;he++){const Ae=u.points[he];re[0]*Ae[0]+re[1]*Ae[1]+re[2]*Ae[2]+re[3]>=0&&le++}if(le===0)return 0}return 1}intersectsPlane(u){const g=this.points.length;let w=0;for(let C=0;C<g;C++){const L=this.points[C];u[0]*L[0]+u[1]*L[1]+u[2]*L[2]+u[3]>=0&&w++}return w===g?2:w===0?0:1}}function $o(D,u,g){const w=D-u;return w<0?-w:Math.max(0,w-g)}function Xs(D,u,g,w,C){const L=D-g;let z;return z=L<0?Math.min(-L,1+L-C):L>1?Math.min(Math.max(L-C,0),1-L):0,Math.max(z,$o(u,w,C))}class Pa{constructor(){this._boundingVolumeCache=new ul(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(u,g,w,C){const L=1<<w.z,z=1/L,Y=w.x/L,re=w.y/L;let le=2;return le=Math.min(le,Xs(u,g,Y,re,z)),le=Math.min(le,Xs(u,g,Y+.5,-re-z,z)),le=Math.min(le,Xs(u,g,Y+.5,2-re-z,z)),le}getWrap(u,g,w){const C=1<<g.z,L=1/C,z=g.x/C,Y=$o(u.x,z,L),re=$o(u.x,z-1,L),le=$o(u.x,z+1,L),he=Math.min(Y,re,le);return he===le?1:he===re?-1:0}allowVariableZoom(u,g){return ln(u,g)>4}allowWorldCopies(){return!1}getTileBoundingVolume(u,g,w,C){return this._boundingVolumeCache.getTileBoundingVolume(u,g,w,C)}_computeTileBoundingVolume(u,g,w,C){var L,z;let Y=0,re=0;if(C?.terrain){const le=new o.a2(u.z,g,u.z,u.x,u.y),he=C.terrain.getMinMaxElevation(le);Y=(L=he.minElevation)!==null&&L!==void 0?L:Math.min(0,w),re=(z=he.maxElevation)!==null&&z!==void 0?z:Math.max(0,w)}if(Y/=o.bE,re/=o.bE,Y+=1,re+=1,u.z<=0)return Ws.fromAabb([-re,-re,-re],[re,re,re]);if(u.z===1)return Ws.fromAabb([u.x===0?-re:0,u.y===0?0:-re,-re],[u.x===0?0:re,u.y===0?re:0,re]);{const le=[ui(0,0,u.x,u.y,u.z),ui(o.a5,0,u.x,u.y,u.z),ui(o.a5,o.a5,u.x,u.y,u.z),ui(0,o.a5,u.x,u.y,u.z)],he=[];for(const yr of le)he.push(o.a$([],yr,re));if(re!==Y)for(const yr of le)he.push(o.a$([],yr,Y));u.y===0&&he.push([0,1,0]),u.y===(1<<u.z)-1&&he.push([0,-1,0]);const Ae=[1,1,1],Ce=[-1,-1,-1];for(const yr of he)for(let xr=0;xr<3;xr++)Ae[xr]=Math.min(Ae[xr],yr[xr]),Ce[xr]=Math.max(Ce[xr],yr[xr]);const Ue=ui(o.a5/2,o.a5/2,u.x,u.y,u.z),Ze=o.b4([],[0,1,0],Ue);o.b3(Ze,Ze);const ht=o.b4([],Ue,Ze);o.b3(ht,ht);const pt=o.b4([],le[2],le[1]);o.b3(pt,pt);const dt=o.b4([],le[0],le[3]);o.b3(dt,dt),he.push(o.a$([],Ue,re)),u.y>=(1<<u.z)/2&&he.push(o.a$([],ui(o.a5/2,0,u.x,u.y,u.z),re)),u.y<(1<<u.z)/2&&he.push(o.a$([],ui(o.a5/2,o.a5,u.x,u.y,u.z),re));const xt=Ys(Ue,he),Ot=Ys(ht,he),wt=[-Ue[0],-Ue[1],-Ue[2],xt.max],Lt=[Ue[0],Ue[1],Ue[2],-xt.min],jt=[-ht[0],-ht[1],-ht[2],Ot.max],Dt=[ht[0],ht[1],ht[2],-Ot.min],Yt=[...pt,0],Sr=[...dt,0],dr=[];return u.y===0?dr.push(o.bD(Sr,Yt,wt),o.bD(Sr,Yt,Lt)):dr.push(o.bD(jt,Yt,wt),o.bD(jt,Yt,Lt),o.bD(jt,Sr,wt),o.bD(jt,Sr,Lt)),u.y===(1<<u.z)-1?dr.push(o.bD(Sr,Yt,wt),o.bD(Sr,Yt,Lt)):dr.push(o.bD(Dt,Yt,wt),o.bD(Dt,Yt,Lt),o.bD(Dt,Sr,wt),o.bD(Dt,Sr,Lt)),new Ws(dr,[wt,Lt,jt,Dt,Yt,Sr],Ae,Ce)}}}function Ys(D,u){let g=1/0,w=-1/0;for(const C of u){const L=o.b5(D,C);g=Math.min(g,L),w=Math.max(w,L)}return{min:g,max:w}}class Il{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(u){this._helper.setMinZoom(u)}setMaxZoom(u){this._helper.setMaxZoom(u)}setMinPitch(u){this._helper.setMinPitch(u)}setMaxPitch(u){this._helper.setMaxPitch(u)}setRenderWorldCopies(u){this._helper.setRenderWorldCopies(u)}setBearing(u){this._helper.setBearing(u)}setPitch(u){this._helper.setPitch(u)}setRoll(u){this._helper.setRoll(u)}setFov(u){this._helper.setFov(u)}setZoom(u){this._helper.setZoom(u)}setCenter(u){this._helper.setCenter(u)}setElevation(u){this._helper.setElevation(u)}setMinElevationForCurrentTile(u){this._helper.setMinElevationForCurrentTile(u)}setPadding(u){this._helper.setPadding(u)}interpolatePadding(u,g,w){return this._helper.interpolatePadding(u,g,w)}isPaddingEqual(u){return this._helper.isPaddingEqual(u)}resize(u,g){this._helper.resize(u,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(u){this._helper.setMaxBounds(u)}setConstrainOverride(u){this._helper.setConstrainOverride(u)}overrideNearFarZ(u,g){this._helper.overrideNearFarZ(u,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(u){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),u)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(u){}constructor(u){this._cachedClippingPlane=o.bF(),this._projectionMatrix=o.bj(),this._globeViewProjMatrix32f=o.bi(),this._globeViewProjMatrixNoCorrection=o.bj(),this._globeViewProjMatrixNoCorrectionInverted=o.bj(),this._globeProjMatrixInverted=o.bj(),this._cameraPosition=o.bz(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(g,w)=>{const C=o.an(g.lat,-o.ao,o.ao),L=o.an(+w,this.minZoom+Si(0,C),this.maxZoom);return{center:new o.V(g.lng,C),zoom:L}},this.applyConstrain=(g,w)=>this._helper.applyConstrain(g,w),this._helper=new As({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(g,w)=>this.defaultConstrain(g,w)},u),this._coveringTilesDetailsProvider=new Pa}clone(){const u=new Il;return u.apply(this,!1),u}apply(u,g,w){this._globeLatitudeErrorCorrectionRadians=w||0,this._helper.apply(u,g)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const u=o.bz();return u[0]=this._cameraPosition[0],u[1]=this._cameraPosition[1],u[2]=this._cameraPosition[2],u}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(u){const{overscaledTileID:g,applyGlobeMatrix:w}=u,C=this._helper.getMercatorTileCoordinates(g);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:C,clippingPlane:this._cachedClippingPlane,projectionTransition:w?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(u){const g=this.pitchInRadians,w=this.cameraToCenterDistance/u,C=Math.sin(g)*w,L=Math.cos(g)*w+1,z=1/Math.sqrt(C*C+L*L)*1;let Y=-C,re=L;const le=Math.sqrt(Y*Y+re*re);Y/=le,re/=le;const he=[0,Y,re];o.bG(he,he,[0,0,0],-this.bearingInRadians),o.bH(he,he,[0,0,0],-1*this.center.lat*Math.PI/180),o.bI(he,he,[0,0,0],this.center.lng*Math.PI/180);const Ae=1/o.b7(he);return o.a$(he,he,Ae),[...he,-z*Ae]}isLocationOccluded(u){return!this.isSurfacePointVisible(Hn(u))}transformLightDirection(u){const g=this._helper._center.lng*Math.PI/180,w=this._helper._center.lat*Math.PI/180,C=Math.cos(w),L=[Math.sin(g)*C,Math.sin(w),Math.cos(g)*C],z=[L[2],0,-L[0]],Y=[0,0,0];o.b4(Y,z,L),o.b3(z,z),o.b3(Y,Y);const re=[0,0,0];return o.b3(re,[z[0]*u[0]+Y[0]*u[1]+L[0]*u[2],z[1]*u[0]+Y[1]*u[1]+L[1]*u[2],z[2]*u[0]+Y[2]*u[1]+L[2]*u[2]]),re}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(u,g,w){const C=(function(Y,re,le){const he=1/(1<<le.z);return new o.a9(Y/o.a5*he+le.x*he,re/o.a5*he+le.y*he)})(u,g,w.canonical),L=(z=C.y,[o.by(C.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-z*Math.PI*2))-.5*Math.PI]);var z;return this.getCircleRadiusCorrection()/Math.cos(L[1])}projectTileCoordinates(u,g,w,C){const L=w.canonical,z=ui(u,g,L.x,L.y,L.z),Y=1+(C?C(u,g):0)/o.bE,re=[z[0]*Y,z[1]*Y,z[2]*Y,1];o.aH(re,re,this._globeViewProjMatrixNoCorrection);const le=this._cachedClippingPlane,he=le[0]*z[0]+le[1]*z[1]+le[2]*z[2]+le[3]<0;return{point:new o.P(re[0]/re[3],re[1]/re[3]),signedDistanceFromCamera:re[3],isOccluded:he}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const u=Ui(this.worldSize,this.center.lat),g=o.bk(),w=o.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*u),o.be(g,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const C=this.centerOffset;g[8]=2*-C.x/this._helper._width,g[9]=2*C.y/this._helper._height,this._projectionMatrix=o.bf(g),this._globeProjMatrixInverted=o.bk(),o.aB(this._globeProjMatrixInverted,g),o.O(g,g,[0,0,-this.cameraToCenterDistance]),o.bg(g,g,this.rollInRadians),o.bh(g,g,-this.pitchInRadians),o.bg(g,g,this.bearingInRadians),o.O(g,g,[0,0,-u]);const L=o.bz();L[0]=u,L[1]=u,L[2]=u,o.bh(w,g,this.center.lat*Math.PI/180),o.bJ(w,w,-this.center.lng*Math.PI/180),o.Q(w,w,L),this._globeViewProjMatrixNoCorrection=w,o.bh(g,g,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bJ(g,g,-this.center.lng*Math.PI/180),o.Q(g,g,L),this._globeViewProjMatrix32f=new Float32Array(g),this._globeViewProjMatrixNoCorrectionInverted=o.bk(),o.aB(this._globeViewProjMatrixNoCorrectionInverted,w);const z=o.bz();this._cameraPosition=o.bz(),this._cameraPosition[2]=this.cameraToCenterDistance/u,o.bG(this._cameraPosition,this._cameraPosition,z,-this.rollInRadians),o.bH(this._cameraPosition,this._cameraPosition,z,this.pitchInRadians),o.bG(this._cameraPosition,this._cameraPosition,z,-this.bearingInRadians),o.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bH(this._cameraPosition,this._cameraPosition,z,-this.center.lat*Math.PI/180),o.bI(this._cameraPosition,this._cameraPosition,z,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(u);const Y=o.bf(this._globeViewProjMatrixNoCorrectionInverted);o.Q(Y,Y,[1,1,-1]),this._cachedFrustum=Ka.fromInvProjectionMatrix(Y,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(u){o.w("calculateFogMatrix is not supported on globe projection.");const g=o.bk();return o.ar(g),g}getVisibleUnwrappedCoordinates(u){return[new o.bc(0,u)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(u){u&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(u,g){if(!this._globeViewProjMatrixNoCorrection)return 1;const w=Hn(u);o.a$(w,w,1+g/o.bE);const C=o.bF();return o.aH(C,[w[0],w[1],w[2],1],this._globeViewProjMatrixNoCorrection),C[2]/C[3]}populateCache(u){}getBounds(){const u=.5*this.width,g=.5*this.height,w=[new o.P(0,0),new o.P(u,0),new o.P(this.width,0),new o.P(this.width,g),new o.P(this.width,this.height),new o.P(u,this.height),new o.P(0,this.height),new o.P(0,g)],C=[];for(const Ae of w)C.push(this.unprojectScreenPoint(Ae));let L=0,z=0,Y=0,re=0;const le=this.center;for(const Ae of C){const Ce=o.bK(le.lng,Ae.lng),Ue=o.bK(le.lat,Ae.lat);Ce<z&&(z=Ce),Ce>L&&(L=Ce),Ue<re&&(re=Ue),Ue>Y&&(Y=Ue)}const he=[le.lng+z,le.lat+re,le.lng+L,le.lat+Y];return this.isSurfacePointOnScreen([0,1,0])&&(he[3]=90,he[0]=-180,he[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(he[1]=-90,he[0]=-180,he[2]=180),new Ht(he)}calculateCenterFromCameraLngLatAlt(u,g,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(u,g,w,C)}setLocationAtPoint(u,g){const w=Hn(this.unprojectScreenPoint(g)),C=Hn(u),L=o.bz();o.bL(L);const z=o.bz();o.bI(z,w,L,-this.center.lng*Math.PI/180),o.bH(z,z,L,this.center.lat*Math.PI/180);const Y=C[0]*C[0]+C[2]*C[2],re=z[0]*z[0];if(Y<re)return;const le=Math.sqrt(Y-re),he=-le,Ae=o.bM(C[0],C[2],z[0],le),Ce=o.bM(C[0],C[2],z[0],he),Ue=o.bz();o.bI(Ue,C,L,-Ae);const Ze=o.bM(Ue[1],Ue[2],z[1],z[2]),ht=o.bz();o.bI(ht,C,L,-Ce);const pt=o.bM(ht[1],ht[2],z[1],z[2]),dt=.5*Math.PI,xt=Ze>=-dt&&Ze<=dt,Ot=pt>=-dt&&pt<=dt;let wt,Lt;if(xt&&Ot){const Sr=this.center.lng*Math.PI/180,dr=this.center.lat*Math.PI/180;o.bN(Ae,Sr)+o.bN(Ze,dr)<o.bN(Ce,Sr)+o.bN(pt,dr)?(wt=Ae,Lt=Ze):(wt=Ce,Lt=pt)}else if(xt)wt=Ae,Lt=Ze;else{if(!Ot)return;wt=Ce,Lt=pt}const jt=wt/Math.PI*180,Dt=Lt/Math.PI*180,Yt=this.center.lat;this.setCenter(new o.V(jt,o.an(Dt,-90,90))),this.setZoom(this.zoom+Si(Yt,this.center.lat))}locationToScreenPoint(u,g){const w=Hn(u);if(g){const C=g.getElevationForLngLatZoom(u,this._helper._tileZoom);o.a$(w,w,1+C/o.bE)}return this._projectSurfacePointToScreen(w)}_projectSurfacePointToScreen(u){const g=o.bF();return o.aH(g,[...u,1],this._globeViewProjMatrixNoCorrection),g[0]/=g[3],g[1]/=g[3],new o.P((.5*g[0]+.5)*this.width,(.5*-g[1]+.5)*this.height)}screenPointToMercatorCoordinate(u,g){if(g){const w=g.pointCoordinate(u);if(w)return w}return o.a9.fromLngLat(this.unprojectScreenPoint(u))}screenPointToLocation(u,g){var w;return(w=this.screenPointToMercatorCoordinate(u,g))===null||w===void 0?void 0:w.toLngLat()}isPointOnMapSurface(u,g){const w=this._cameraPosition,C=this.getRayDirectionFromPixel(u);return!!this.rayPlanetIntersection(w,C)}getRayDirectionFromPixel(u){const g=o.bF();g[0]=u.x/this.width*2-1,g[1]=-1*(u.y/this.height*2-1),g[2]=1,g[3]=1,o.aH(g,g,this._globeViewProjMatrixNoCorrectionInverted),g[0]/=g[3],g[1]/=g[3],g[2]/=g[3];const w=o.bz();w[0]=g[0]-this._cameraPosition[0],w[1]=g[1]-this._cameraPosition[1],w[2]=g[2]-this._cameraPosition[2];const C=o.bz();return o.b3(C,w),C}isSurfacePointVisible(u){const g=this._cachedClippingPlane;return g[0]*u[0]+g[1]*u[1]+g[2]*u[2]+g[3]>=0}isSurfacePointOnScreen(u){if(!this.isSurfacePointVisible(u))return!1;const g=o.bF();return o.aH(g,[...u,1],this._globeViewProjMatrixNoCorrection),g[0]/=g[3],g[1]/=g[3],g[2]/=g[3],g[0]>-1&&g[0]<1&&g[1]>-1&&g[1]<1&&g[2]>-1&&g[2]<1}rayPlanetIntersection(u,g){const w=o.b5(u,g),C=o.bz(),L=o.bz();o.a$(L,g,w),o.b2(C,u,L);const z=1-o.b5(C,C);if(z<0)return null;const Y=o.b5(u,u)-1,re=-w+(w<0?1:-1)*Math.sqrt(z),le=Y/re,he=re;return{tMin:Math.min(le,he),tMax:Math.max(le,he)}}unprojectScreenPoint(u){const g=this._cameraPosition,w=this.getRayDirectionFromPixel(u),C=this.rayPlanetIntersection(g,w);if(C){const he=o.bz();o.b0(he,g,[w[0]*C.tMin,w[1]*C.tMin,w[2]*C.tMin]);const Ae=o.bz();return o.b3(Ae,he),Xi(Ae)}const L=this._cachedClippingPlane,z=L[0]*w[0]+L[1]*w[1]+L[2]*w[2],Y=-o.bb(L,g)/z,re=o.bz();if(Y>0)o.b0(re,g,[w[0]*Y,w[1]*Y,w[2]*Y]);else{const he=o.bz();o.b0(he,g,[2*w[0],2*w[1],2*w[2]]);const Ae=o.bb(this._cachedClippingPlane,he);o.b2(re,he,[this._cachedClippingPlane[0]*Ae,this._cachedClippingPlane[1]*Ae,this._cachedClippingPlane[2]*Ae])}const le=(function(he){const Ae=o.bz();return Ae[0]=he[0]*-he[3],Ae[1]=he[1]*-he[3],Ae[2]=he[2]*-he[3],{center:Ae,radius:Math.sqrt(1-he[3]*he[3])}})(L);return Xi((function(he,Ae,Ce){const Ue=o.bz();o.b2(Ue,Ce,he);const Ze=o.bz();return o.bA(Ze,he,Ue,Ae/o.b9(Ue)),Ze})(le.center,le.radius,re))}getMatrixForModel(u,g){const w=o.V.convert(u),C=1/o.bE,L=o.bj();return o.bJ(L,L,w.lng/180*Math.PI),o.bh(L,L,-w.lat/180*Math.PI),o.O(L,L,[0,0,1+g/o.bE]),o.bh(L,L,.5*Math.PI),o.Q(L,L,[C,C,C]),L}getProjectionDataForCustomLayer(u=!0){const g=this.getProjectionData({overscaledTileID:new o.a2(0,0,0,0,0),applyGlobeMatrix:u});return g.tileMercatorCoords=[0,0,1,1],g}getFastPathSimpleProjectionMatrix(u){}}class ms{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(u){this._helper.setMinZoom(u)}setMaxZoom(u){this._helper.setMaxZoom(u)}setMinPitch(u){this._helper.setMinPitch(u)}setMaxPitch(u){this._helper.setMaxPitch(u)}setRenderWorldCopies(u){this._helper.setRenderWorldCopies(u)}setBearing(u){this._helper.setBearing(u)}setPitch(u){this._helper.setPitch(u)}setRoll(u){this._helper.setRoll(u)}setFov(u){this._helper.setFov(u)}setZoom(u){this._helper.setZoom(u)}setCenter(u){this._helper.setCenter(u)}setElevation(u){this._helper.setElevation(u)}setMinElevationForCurrentTile(u){this._helper.setMinElevationForCurrentTile(u)}setPadding(u){this._helper.setPadding(u)}interpolatePadding(u,g,w){return this._helper.interpolatePadding(u,g,w)}isPaddingEqual(u){return this._helper.isPaddingEqual(u)}resize(u,g,w=!0){this._helper.resize(u,g,w)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(u){this._helper.setMaxBounds(u)}setConstrainOverride(u){this._helper.setConstrainOverride(u)}overrideNearFarZ(u,g){this._helper.overrideNearFarZ(u,g)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(u){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),u)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(u,g){this._globeness=u,this._globeLatitudeErrorCorrectionRadians=g,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(u){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(g,w)=>this.currentTransform.defaultConstrain(g,w),this.applyConstrain=(g,w)=>this._helper.applyConstrain(g,w),this._helper=new As({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(g,w)=>this.defaultConstrain(g,w)},u),this._globeness=1,this._mercatorTransform=new qs,this._verticalPerspectiveTransform=new Il}clone(){const u=new ms;return u._globeness=this._globeness,u._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,u.apply(this,!1),u}apply(u,g){this._helper.apply(u,g),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(u){const g=this._mercatorTransform.getProjectionData(u),w=this._verticalPerspectiveTransform.getProjectionData(u);return{mainMatrix:this.isGlobeRendering?w.mainMatrix:g.mainMatrix,clippingPlane:w.clippingPlane,tileMercatorCoords:w.tileMercatorCoords,projectionTransition:u.applyGlobeMatrix?this._globeness:0,fallbackMatrix:g.fallbackMatrix}}isLocationOccluded(u){return this.currentTransform.isLocationOccluded(u)}transformLightDirection(u){return this.currentTransform.transformLightDirection(u)}getPixelScale(){return o.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(u,g,w){const C=this._mercatorTransform.getPitchedTextCorrection(u,g,w),L=this._verticalPerspectiveTransform.getPitchedTextCorrection(u,g,w);return o.bu(C,L,this._globeness)}projectTileCoordinates(u,g,w,C){return this.currentTransform.projectTileCoordinates(u,g,w,C)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(u){return this.currentTransform.calculateFogMatrix(u)}getVisibleUnwrappedCoordinates(u){return this.currentTransform.getVisibleUnwrappedCoordinates(u)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(u){this._mercatorTransform.recalculateZoomAndCenter(u),this._verticalPerspectiveTransform.recalculateZoomAndCenter(u)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(u,g){return this.currentTransform.lngLatToCameraDepth(u,g)}populateCache(u){this._mercatorTransform.populateCache(u),this._verticalPerspectiveTransform.populateCache(u)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(u,g,w,C){return this._helper.calculateCenterFromCameraLngLatAlt(u,g,w,C)}setLocationAtPoint(u,g){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(u,g),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(u,g),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(u,g){return this.currentTransform.locationToScreenPoint(u,g)}screenPointToMercatorCoordinate(u,g){return this.currentTransform.screenPointToMercatorCoordinate(u,g)}screenPointToLocation(u,g){return this.currentTransform.screenPointToLocation(u,g)}isPointOnMapSurface(u,g){return this.currentTransform.isPointOnMapSurface(u,g)}getRayDirectionFromPixel(u){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(u)}getMatrixForModel(u,g){return this.currentTransform.getMatrixForModel(u,g)}getProjectionDataForCustomLayer(u=!0){const g=this._mercatorTransform.getProjectionDataForCustomLayer(u);if(!this.isGlobeRendering)return g;const w=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(u);return w.fallbackMatrix=g.mainMatrix,w}getFastPathSimpleProjectionMatrix(u){return this.currentTransform.getFastPathSimpleProjectionMatrix(u)}}class Di{get useGlobeControls(){return!0}handlePanInertia(u,g){const w=Ia(u,g);return Math.abs(w.lng-g.center.lng)>180&&(w.lng=g.center.lng+179.5*Math.sign(w.lng-g.center.lng)),{easingCenter:w,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(u,g){const w=u.around,C=g.screenPointToLocation(w);u.bearingDelta&&g.setBearing(g.bearing+u.bearingDelta),u.pitchDelta&&g.setPitch(g.pitch+u.pitchDelta),u.rollDelta&&g.setRoll(g.roll+u.rollDelta);const L=g.zoom;u.zoomDelta&&g.setZoom(g.zoom+u.zoomDelta);const z=g.zoom-L;if(z===0)return;const Y=o.bK(g.center.lng,C.lng),re=Y/(Math.abs(Y/180)+1),le=o.bK(g.center.lat,C.lat),he=g.getRayDirectionFromPixel(w),Ae=g.cameraPosition,Ce=-1*o.b5(Ae,he),Ue=o.bz();o.b0(Ue,Ae,[he[0]*Ce,he[1]*Ce,he[2]*Ce]);const Ze=o.b7(Ue)-1,ht=Math.exp(.5*-Math.max(Ze-.3,0)),pt=Ui(g.worldSize,g.center.lat)/Math.min(g.width,g.height),dt=o.bx(pt,.9,.5,1,.25),xt=(1-o.aq(-z))*Math.min(ht,dt),Ot=g.center.lat,wt=g.zoom,Lt=new o.V(g.center.lng+re*xt,o.an(g.center.lat+le*xt,-o.ao,o.ao));g.setLocationAtPoint(C,w);const jt=g.center,Dt=o.bx(Math.abs(Y),45,85,0,1),Yt=o.bx(pt,.75,.35,0,1),Sr=Math.pow(Math.max(Dt,Yt),.25),dr=o.bK(jt.lng,Lt.lng),yr=o.bK(jt.lat,Lt.lat);g.setCenter(new o.V(jt.lng+dr*Sr,jt.lat+yr*Sr).wrap()),g.setZoom(wt+Si(Ot,g.center.lat))}handleMapControlsPan(u,g,w){if(!u.panDelta)return;const C=g.center.lat,L=g.zoom;g.setCenter(Ia(u.panDelta,g).wrap()),g.setZoom(L+Si(C,g.center.lat))}cameraForBoxAndBearing(u,g,w,C,L){const z=Ru(u,g,w,C,L),Y=g.left/L.width*2-1,re=(L.width-g.right)/L.width*2-1,le=g.top/L.height*-2+1,he=(L.height-g.bottom)/L.height*-2+1,Ae=o.bK(w.getWest(),w.getEast())<0,Ce=Ae?w.getEast():w.getWest(),Ue=Ae?w.getWest():w.getEast(),Ze=Math.max(w.getNorth(),w.getSouth()),ht=Math.min(w.getNorth(),w.getSouth()),pt=Ce+.5*o.bK(Ce,Ue),dt=Ze+.5*o.bK(Ze,ht),xt=L.clone();xt.setCenter(z.center),xt.setBearing(z.bearing),xt.setPitch(0),xt.setRoll(0),xt.setZoom(z.zoom);const Ot=xt.modelViewProjectionMatrix,wt=[Hn(w.getNorthWest()),Hn(w.getNorthEast()),Hn(w.getSouthWest()),Hn(w.getSouthEast()),Hn(new o.V(Ue,dt)),Hn(new o.V(Ce,dt)),Hn(new o.V(pt,Ze)),Hn(new o.V(pt,ht))],Lt=Hn(z.center);let jt=Number.POSITIVE_INFINITY;for(const Dt of wt)Y<0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Lt,Ot,"x",Y))),re>0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Lt,Ot,"x",re))),le>0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Lt,Ot,"y",le))),he<0&&(jt=Di.getLesserNonNegativeNonNull(jt,Di.solveVectorScale(Dt,Lt,Ot,"y",he)));if(Number.isFinite(jt)&&jt!==0)return z.zoom=xt.zoom+o.at(jt),z;Vo()}handleJumpToCenterZoom(u,g){const w=u.center.lat,C=u.applyConstrain(g.center?o.V.convert(g.center):u.center,u.zoom).center;u.setCenter(C.wrap());const L=g.zoom!==void 0?+g.zoom:u.zoom+Si(w,C.lat);u.zoom!==L&&u.setZoom(L)}handleEaseTo(u,g){const w=u.zoom,C=u.center,L=u.padding,z={roll:u.roll,pitch:u.pitch,bearing:u.bearing},Y={roll:g.roll===void 0?u.roll:g.roll,pitch:g.pitch===void 0?u.pitch:g.pitch,bearing:g.bearing===void 0?u.bearing:g.bearing},re=g.zoom!==void 0,le=!u.isPaddingEqual(g.padding);let he=!1;const Ae=g.center?o.V.convert(g.center):C,Ce=u.applyConstrain(Ae,w).center;$s(u,Ce);const Ue=u.clone();Ue.setCenter(Ce),Ue.setZoom(re?+g.zoom:w+Si(C.lat,Ae.lat)),Ue.setBearing(g.bearing);const Ze=new o.P(o.an(u.centerPoint.x+g.offsetAsPoint.x,0,u.width),o.an(u.centerPoint.y+g.offsetAsPoint.y,0,u.height));Ue.setLocationAtPoint(Ce,Ze);const ht=(g.offset&&g.offsetAsPoint.mag())>0?Ue.center:Ce,pt=re?+g.zoom:w+Si(C.lat,ht.lat),dt=w+Si(C.lat,0),xt=pt+Si(ht.lat,0),Ot=o.bK(C.lng,ht.lng),wt=o.bK(C.lat,ht.lat),Lt=o.aq(xt-dt);return he=pt!==w,{easeFunc:jt=>{if(o.bo(z,Y)||ku({startEulerAngles:z,endEulerAngles:Y,tr:u,k:jt,useSlerp:z.roll!=Y.roll}),le&&u.interpolatePadding(L,g.padding,jt),g.around)o.w("Easing around a point is not supported under globe projection."),u.setLocationAtPoint(g.around,g.aroundPoint);else{const Dt=xt>dt?Math.min(2,Lt):Math.max(.5,Lt),Yt=Math.pow(Dt,1-jt),Sr=Gs(C,Ot,wt,jt*Yt);u.setCenter(Sr.wrap())}if(he){const Dt=o.G.number(dt,xt,jt)+Si(0,u.center.lat);u.setZoom(Dt)}},isZooming:he,elevationCenter:ht}}handleFlyTo(u,g){const w=g.zoom!==void 0,C=u.center,L=u.zoom,z=u.padding,Y=!u.isPaddingEqual(g.padding),re=u.applyConstrain(o.V.convert(g.center||g.locationAtOffset),L).center,le=w?+g.zoom:u.zoom+Si(u.center.lat,re.lat),he=u.clone();he.setCenter(re),he.setZoom(le),he.setBearing(g.bearing);const Ae=new o.P(o.an(u.centerPoint.x+g.offsetAsPoint.x,0,u.width),o.an(u.centerPoint.y+g.offsetAsPoint.y,0,u.height));he.setLocationAtPoint(re,Ae);const Ce=he.center;$s(u,Ce);const Ue=(function(wt,Lt,jt){const Dt=Hn(Lt),Yt=Hn(jt),Sr=o.b5(Dt,Yt),dr=Math.acos(Sr),yr=Un(wt);return dr/(2*Math.PI)*yr})(u,C,Ce),Ze=L+Si(C.lat,0),ht=le+Si(Ce.lat,0),pt=o.aq(ht-Ze);let dt;if(typeof g.minZoom=="number"){const wt=+g.minZoom+Si(Ce.lat,0),Lt=Math.min(wt,Ze,ht)+Si(0,Ce.lat),jt=u.applyConstrain(Ce,Lt).zoom+Si(Ce.lat,0);dt=o.aq(jt-Ze)}const xt=o.bK(C.lng,Ce.lng),Ot=o.bK(C.lat,Ce.lat);return{easeFunc:(wt,Lt,jt,Dt)=>{const Yt=Gs(C,xt,Ot,jt);Y&&u.interpolatePadding(z,g.padding,wt);const Sr=wt===1?Ce:Yt;u.setCenter(Sr.wrap());const dr=Ze+o.at(Lt);u.setZoom(wt===1?le:dr+Si(0,Sr.lat))},scaleOfZoom:pt,targetCenter:Ce,scaleOfMinZoom:dt,pixelPathLength:Ue}}static solveVectorScale(u,g,w,C,L){const z=C==="x"?[w[0],w[4],w[8],w[12]]:[w[1],w[5],w[9],w[13]],Y=[w[3],w[7],w[11],w[15]],re=u[0]*z[0]+u[1]*z[1]+u[2]*z[2],le=u[0]*Y[0]+u[1]*Y[1]+u[2]*Y[2],he=g[0]*z[0]+g[1]*z[1]+g[2]*z[2],Ae=g[0]*Y[0]+g[1]*Y[1]+g[2]*Y[2];return he+L*le===re+L*Ae||Y[3]*(re-he)+z[3]*(Ae-le)+re*Ae==he*le?null:(he+z[3]-L*Ae-L*Y[3])/(he-re-L*Ae+L*le)}static getLesserNonNegativeNonNull(u,g){return g!==null&&g>=0&&g<u?g:u}}class qo{constructor(u){this._globe=u,this._mercatorCameraHelper=new go,this._verticalPerspectiveCameraHelper=new Di}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(u,g){return this.currentHelper.handlePanInertia(u,g)}handleMapControlsRollPitchBearingZoom(u,g){return this.currentHelper.handleMapControlsRollPitchBearingZoom(u,g)}handleMapControlsPan(u,g,w){this.currentHelper.handleMapControlsPan(u,g,w)}cameraForBoxAndBearing(u,g,w,C,L){return this.currentHelper.cameraForBoxAndBearing(u,g,w,C,L)}handleJumpToCenterZoom(u,g){this.currentHelper.handleJumpToCenterZoom(u,g)}handleEaseTo(u,g){return this.currentHelper.handleEaseTo(u,g)}handleFlyTo(u,g){return this.currentHelper.handleFlyTo(u,g)}}const Da=(D,u)=>o.B(D,u&&u.filter((g=>g.identifier!=="source.canvas"))),is=o.bO();class Is extends o.E{constructor(u,g={}){var w,C;super(),this._rtlPluginLoaded=()=>{for(const z in this.tileManagers){const Y=this.tileManagers[z].getSource().type;Y!=="vector"&&Y!=="geojson"||this.tileManagers[z].reload()}},this.map=u,this.dispatcher=new Ke(ot(),u._getMapId()),this.dispatcher.registerMessageHandler("GG",((z,Y)=>this.getGlyphs(z,Y))),this.dispatcher.registerMessageHandler("GI",((z,Y)=>this.getImages(z,Y))),this.dispatcher.registerMessageHandler("GDA",((z,Y)=>this.getDashes(z,Y))),this.imageManager=new G,this.imageManager.setEventedParent(this);const L=((w=u._container)===null||w===void 0?void 0:w.lang)||typeof document<"u"&&((C=document.documentElement)===null||C===void 0?void 0:C.lang)||void 0;this.glyphManager=new De(u._requestManager,g.localIdeographFontFamily,L),this.lineAtlas=new Ee(256,512),this.crossTileSymbolIndex=new _n,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",o.bP()),Et().on(qe,this._rtlPluginLoaded),this.on("data",(z=>{if(z.dataType!=="source"||z.sourceDataType!=="metadata")return;const Y=this.tileManagers[z.sourceId];if(!Y)return;const re=Y.getSource();if(re&&re.vectorLayerIds)for(const le in this._layers){const he=this._layers[le];he.source===re.id&&this._validateLayer(he)}}))}_setInitialValues(){var u;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new o.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((u=this.crossTileSymbolIndex)===null||u===void 0?void 0:u.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(u,g){var w,C,L;this._checkLoaded();const z=g===null?(L=(C=(w=this.stylesheet.state)===null||w===void 0?void 0:w[u])===null||C===void 0?void 0:C.default)!==null&&L!==void 0?L:null:g;if(o.bR(z,this._globalState[u]))return this;this._globalState[u]=z,this._applyGlobalStateChanges([u])}getGlobalState(){return this._globalState}setGlobalState(u){this._checkLoaded();const g=[];for(const w in u)!o.bR(this._globalState[w],u[w].default)&&(g.push(w),this._globalState[w]=u[w].default);this._applyGlobalStateChanges(g)}_applyGlobalStateChanges(u){if(u.length===0)return;const g=new Set,w={};for(const C of u){w[C]=this._globalState[C];for(const L in this._layers){const z=this._layers[L],Y=z.getLayoutAffectingGlobalStateRefs(),re=z.getPaintAffectingGlobalStateRefs(),le=z.getVisibilityAffectingGlobalStateRefs();if(Y.has(C)&&g.add(z.source),re.has(C))for(const{name:he,value:Ae}of re.get(C))this._updatePaintProperty(z,he,Ae);le?.has(C)&&(z.recalculateVisibility(),this._updateLayer(z))}}this.dispatcher.broadcast("UGS",w);for(const C in this.tileManagers)g.has(C)&&(this._reloadSource(C),this._changed=!0)}loadURL(u,g={},w){this.fire(new o.l("dataloading",{dataType:"style"})),g.validate=typeof g.validate!="boolean"||g.validate;const C=this.map._requestManager.transformRequest(u,"Style");this._loadStyleRequest=new AbortController;const L=this._loadStyleRequest;o.j(C,this._loadStyleRequest).then((z=>{this._loadStyleRequest=null,this._load(z.data,g,w)})).catch((z=>{this._loadStyleRequest=null,z&&!L.signal.aborted&&this.fire(new o.k(z))}))}loadJSON(u,g={},w){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,x.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,g.validate=g.validate!==!1,this._load(u,g,w)})).catch((()=>{}))}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(is,{validate:!1})}_load(u,g,w){var C,L;let z=g.transformStyle?g.transformStyle(w,u):u;if(!g.validate||!Da(this,o.C(z))){z=Object.assign({},z),this._loaded=!0,this.stylesheet=z;for(const Y in z.sources)this.addSource(Y,z.sources[Y],{validate:!1});z.sprite?this._loadSprite(z.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(z.glyphs),this._createLayers(),this.light=new Te(this.stylesheet.light),this._setProjectionInternal(((C=this.stylesheet.projection)===null||C===void 0?void 0:C.type)||"mercator"),this.sky=new de(this.stylesheet.sky),this.map.setTerrain((L=this.stylesheet.terrain)!==null&&L!==void 0?L:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){var u,g,w;const C=o.bS(this.stylesheet.layers);this.setGlobalState((u=this.stylesheet.state)!==null&&u!==void 0?u:null),this.dispatcher.broadcast("SL",C),this._order=C.map((L=>L.id)),this._layers={},this._serializedLayers=null;for(const L of C){const z=o.bT(L,this._globalState);if(z.setEventedParent(this,{layer:{id:L.id}}),this._layers[L.id]=z,o.bU(z)&&this.tileManagers[z.source]){const Y=(w=(g=L.paint)===null||g===void 0?void 0:g["raster-fade-duration"])!==null&&w!==void 0?w:z.paint.get("raster-fade-duration");this.tileManagers[z.source].setRasterFadeDuration(Y)}}}_loadSprite(u,g=!1,w=void 0){this.imageManager.setLoaded(!1);const C=new AbortController;let L;this._spriteRequest=C,(function(z,Y,re,le){return o._(this,void 0,void 0,(function*(){const he=X(z),Ae=re>1?"@2x":"",Ce={},Ue={};for(const{id:Ze,url:ht}of he){const pt=Y.transformRequest(oe(ht,Ae,".json"),"SpriteJSON");Ce[Ze]=o.j(pt,le);const dt=Y.transformRequest(oe(ht,Ae,".png"),"SpriteImage");Ue[Ze]=H.getImage(dt,le)}return yield Promise.all([...Object.values(Ce),...Object.values(Ue)]),(function(Ze,ht){return o._(this,void 0,void 0,(function*(){const pt={};for(const dt in Ze){pt[dt]={};const xt=x.getImageCanvasContext((yield ht[dt]).data),Ot=(yield Ze[dt]).data;for(const wt in Ot){const{width:Lt,height:jt,x:Dt,y:Yt,sdf:Sr,pixelRatio:dr,stretchX:yr,stretchY:xr,content:nn,textFitWidth:sn,textFitHeight:Hr}=Ot[wt];pt[dt][wt]={data:null,pixelRatio:dr,sdf:Sr,stretchX:yr,stretchY:xr,content:nn,textFitWidth:sn,textFitHeight:Hr,spriteData:{width:Lt,height:jt,x:Dt,y:Yt,context:xt}}}}return pt}))})(Ce,Ue)}))})(u,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((z=>{if(this._spriteRequest=null,z)for(const Y in z){this._spritesImagesIds[Y]=[];const re=this._spritesImagesIds[Y]?this._spritesImagesIds[Y].filter((le=>!(le in z))):[];for(const le of re)this.imageManager.removeImage(le),this._changedImages[le]=!0;for(const le in z[Y]){const he=Y==="default"?le:`${Y}:${le}`;this._spritesImagesIds[Y].push(he),he in this.imageManager.images?this.imageManager.updateImage(he,z[Y][le],!1):this.imageManager.addImage(he,z[Y][le]),g&&(this._changedImages[he]=!0)}}})).catch((z=>{this._spriteRequest=null,L=z,C.signal.aborted||this.fire(new o.k(L))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),g&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),w&&w(L)}))}_unloadSprite(){for(const u of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(u),this._changedImages[u]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(u){const g=this.tileManagers[u.source];if(!g)return;const w=u.sourceLayer;if(!w)return;const C=g.getSource();(C.type==="geojson"||C.vectorLayerIds&&C.vectorLayerIds.indexOf(w)===-1)&&this.fire(new o.k(new Error(`Source layer "${w}" does not exist on source "${C.id}" as specified by style layer "${u.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const u in this.tileManagers)if(!this.tileManagers[u].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(u,g=!1){const w=this._serializedAllLayers();if(!u||u.length===0)return Object.values(g?o.bV(w):w);const C=[];for(const L of u)if(w[L]){const z=g?o.bV(w[L]):w[L];C.push(z)}return C}_serializedAllLayers(){let u=this._serializedLayers;if(u)return u;u=this._serializedLayers={};const g=Object.keys(this._layers);for(const w of g){const C=this._layers[w];C.type!=="custom"&&(u[w]=C.serialize())}return u}hasTransitions(){var u,g,w;if(!((u=this.light)===null||u===void 0)&&u.hasTransition()||!((g=this.sky)===null||g===void 0)&&g.hasTransition()||!((w=this.projection)===null||w===void 0)&&w.hasTransition())return!0;for(const C in this.tileManagers)if(this.tileManagers[C].hasTransition())return!0;for(const C in this._layers)if(this._layers[C].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(u){if(!this._loaded)return;const g=this._changed;if(g){const C=Object.keys(this._updatedLayers),L=Object.keys(this._removedLayers);(C.length||L.length)&&this._updateWorkerLayers(C,L);for(const z in this._updatedSources){const Y=this._updatedSources[z];if(Y==="reload")this._reloadSource(z);else{if(Y!=="clear")throw new Error(`Invalid action ${Y}`);this._clearSource(z)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const z in this._updatedPaintProps)this._layers[z].updateTransitions(u);this.light.updateTransitions(u),this.sky.updateTransitions(u),this._resetUpdates()}const w={};for(const C in this.tileManagers){const L=this.tileManagers[C];w[C]=L.used,L.used=!1}for(const C of this._order){const L=this._layers[C];L.recalculate(u,this._availableImages),!L.isHidden(u.zoom)&&L.source&&(this.tileManagers[L.source].used=!0)}for(const C in w){const L=this.tileManagers[C];!!w[C]!=!!L.used&&L.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:C}))}this.light.recalculate(u),this.sky.recalculate(u),this.projection.recalculate(u),this.z=u.zoom,g&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const u=Object.keys(this._changedImages);if(u.length){for(const g in this.tileManagers)this.tileManagers[g].reloadTilesForDependencies(["icons","patterns"],u);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const u in this.tileManagers)this.tileManagers[u].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(u,g){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(u,!1),removedIds:g})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(u,g={}){var w;this._checkLoaded();const C=this.serialize();if(u=g.transformStyle?g.transformStyle(C,u):u,((w=g.validate)===null||w===void 0||w)&&Da(this,o.C(u)))return!1;(u=o.bV(u)).layers=o.bS(u.layers);const L=o.bW(C,u),z=this._getOperationsToPerform(L);if(z.unimplemented.length>0)throw new Error(`Unimplemented: ${z.unimplemented.join(", ")}.`);if(z.operations.length===0)return!1;for(const Y of z.operations)Y();return this.stylesheet=u,this._serializedLayers=null,this.fire(new o.l("style.load",{style:this})),!0}_getOperationsToPerform(u){const g=[],w=[];for(const C of u)switch(C.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":g.push((()=>this.addLayer.apply(this,C.args)));break;case"removeLayer":g.push((()=>this.removeLayer.apply(this,C.args)));break;case"setPaintProperty":g.push((()=>this.setPaintProperty.apply(this,C.args)));break;case"setLayoutProperty":g.push((()=>this.setLayoutProperty.apply(this,C.args)));break;case"setFilter":g.push((()=>this.setFilter.apply(this,C.args)));break;case"addSource":g.push((()=>this.addSource.apply(this,C.args)));break;case"removeSource":g.push((()=>this.removeSource.apply(this,C.args)));break;case"setLayerZoomRange":g.push((()=>this.setLayerZoomRange.apply(this,C.args)));break;case"setLight":g.push((()=>this.setLight.apply(this,C.args)));break;case"setGeoJSONSourceData":g.push((()=>this.setGeoJSONSourceData.apply(this,C.args)));break;case"setGlyphs":g.push((()=>this.setGlyphs.apply(this,C.args)));break;case"setSprite":g.push((()=>this.setSprite.apply(this,C.args)));break;case"setTerrain":g.push((()=>this.map.setTerrain.apply(this,C.args)));break;case"setSky":g.push((()=>this.setSky.apply(this,C.args)));break;case"setProjection":this.setProjection.apply(this,C.args);break;case"setGlobalState":g.push((()=>this.setGlobalState.apply(this,C.args)));break;case"setTransition":g.push((()=>{}));break;default:w.push(C.command)}return{operations:g,unimplemented:w}}addImage(u,g){if(this.getImage(u))return this.fire(new o.k(new Error(`An image named "${u}" already exists.`)));this.imageManager.addImage(u,g),this._afterImageUpdated(u)}updateImage(u,g){this.imageManager.updateImage(u,g)}getImage(u){return this.imageManager.getImage(u)}removeImage(u){if(!this.getImage(u))return this.fire(new o.k(new Error(`An image named "${u}" does not exist.`)));this.imageManager.removeImage(u),this._afterImageUpdated(u)}_afterImageUpdated(u){this._availableImages=this.imageManager.listImages(),this._changedImages[u]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(u,g,w={}){if(this._checkLoaded(),this.tileManagers[u]!==void 0)throw new Error(`Source "${u}" already exists.`);if(!g.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(g).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(o.C.source,`sources.${u}`,g,null,w))return;this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);const C=this.tileManagers[u]=new Ci(u,g,this.dispatcher);C.style=this,C.setEventedParent(this,(()=>({isSourceLoaded:C.loaded(),source:C.serialize(),sourceId:u}))),C.onAdd(this.map),this._changed=!0}removeSource(u){if(this._checkLoaded(),this.tileManagers[u]===void 0)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===u)return this.fire(new o.k(new Error(`Source "${u}" cannot be removed while layer "${w}" is using it.`)));const g=this.tileManagers[u];delete this.tileManagers[u],delete this._updatedSources[u],g.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:u})),g.setEventedParent(null),g.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(u,g){if(this._checkLoaded(),this.tileManagers[u]===void 0)throw new Error(`There is no source with this ID=${u}`);const w=this.tileManagers[u].getSource();if(w.type!=="geojson")throw new Error(`geojsonSource.type is ${w.type}, which is !== 'geojson`);w.setData(g),this._changed=!0}getSource(u){return this.tileManagers[u]&&this.tileManagers[u].getSource()}addLayer(u,g,w={}){this._checkLoaded();const C=u.id;if(this.getLayer(C))return void this.fire(new o.k(new Error(`Layer "${C}" already exists on this map.`)));let L;if(u.type==="custom"){if(Da(this,o.bX(u)))return;L=o.bT(u,this._globalState)}else{if("source"in u&&typeof u.source=="object"&&(this.addSource(C,u.source),u=o.bV(u),u=o.e(u,{source:C})),this._validate(o.C.layer,`layers.${C}`,u,{arrayIndex:-1},w))return;L=o.bT(u,this._globalState),this._validateLayer(L),L.setEventedParent(this,{layer:{id:C}})}const z=g?this._order.indexOf(g):this._order.length;if(g&&z===-1)this.fire(new o.k(new Error(`Cannot add layer "${C}" before non-existing layer "${g}".`)));else{if(this._order.splice(z,0,C),this._layerOrderChanged=!0,this._layers[C]=L,this._removedLayers[C]&&L.source&&L.type!=="custom"){const Y=this._removedLayers[C];delete this._removedLayers[C],Y.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",this.tileManagers[L.source].pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map)}}moveLayer(u,g){if(this._checkLoaded(),this._changed=!0,!this._layers[u])return void this.fire(new o.k(new Error(`The layer '${u}' does not exist in the map's style and cannot be moved.`)));if(u===g)return;const w=this._order.indexOf(u);this._order.splice(w,1);const C=g?this._order.indexOf(g):this._order.length;g&&C===-1?this.fire(new o.k(new Error(`Cannot move layer "${u}" before non-existing layer "${g}".`))):(this._order.splice(C,0,u),this._layerOrderChanged=!0)}removeLayer(u){this._checkLoaded();const g=this._layers[u];if(!g)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${u}".`)));g.setEventedParent(null);const w=this._order.indexOf(u);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[u]=g,delete this._layers[u],this._serializedLayers&&delete this._serializedLayers[u],delete this._updatedLayers[u],delete this._updatedPaintProps[u],g.onRemove&&g.onRemove(this.map)}getLayer(u){return this._layers[u]}getLayersOrder(){return[...this._order]}hasLayer(u){return u in this._layers}setLayerZoomRange(u,g,w){this._checkLoaded();const C=this.getLayer(u);C?C.minzoom===g&&C.maxzoom===w||(g!=null&&(C.minzoom=g),w!=null&&(C.maxzoom=w),this._updateLayer(C)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${u}".`)))}setFilter(u,g,w={}){this._checkLoaded();const C=this.getLayer(u);if(C){if(!o.bR(C.filter,g))return g==null?(C.setFilter(void 0),void this._updateLayer(C)):void(this._validate(o.C.filter,`layers.${C.id}.filter`,g,null,w)||(C.setFilter(o.bV(g)),this._updateLayer(C)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${u}".`)))}getFilter(u){return o.bV(this.getLayer(u).filter)}setLayoutProperty(u,g,w,C={}){this._checkLoaded();const L=this.getLayer(u);L?o.bR(L.getLayoutProperty(g),w)||(L.setLayoutProperty(g,w,C),this._updateLayer(L)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${u}".`)))}getLayoutProperty(u,g){const w=this.getLayer(u);if(w)return w.getLayoutProperty(g);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${u}".`)))}setPaintProperty(u,g,w,C={}){this._checkLoaded();const L=this.getLayer(u);L?o.bR(L.getPaintProperty(g),w)||this._updatePaintProperty(L,g,w,C):this.fire(new o.k(new Error(`Cannot style non-existing layer "${u}".`)))}_updatePaintProperty(u,g,w,C={}){u.setPaintProperty(g,w,C)&&this._updateLayer(u),o.bU(u)&&g==="raster-fade-duration"&&this.tileManagers[u.source].setRasterFadeDuration(w),this._changed=!0,this._updatedPaintProps[u.id]=!0,this._serializedLayers=null}getPaintProperty(u,g){return this.getLayer(u).getPaintProperty(g)}setFeatureState(u,g){this._checkLoaded();const w=u.source,C=u.sourceLayer,L=this.tileManagers[w];if(L===void 0)return void this.fire(new o.k(new Error(`The source '${w}' does not exist in the map's style.`)));const z=L.getSource().type;z==="geojson"&&C?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):z!=="vector"||C?(u.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),L.setFeatureState(C,u.id,g)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(u,g){this._checkLoaded();const w=u.source,C=this.tileManagers[w];if(C===void 0)return void this.fire(new o.k(new Error(`The source '${w}' does not exist in the map's style.`)));const L=C.getSource().type,z=L==="vector"?u.sourceLayer:void 0;L!=="vector"||z?g&&typeof u.id!="string"&&typeof u.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):C.removeFeatureState(z,u.id,g):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(u){this._checkLoaded();const g=u.source,w=u.sourceLayer,C=this.tileManagers[g];if(C!==void 0)return C.getSource().type!=="vector"||w?(u.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),C.getFeatureState(w,u.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${g}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const u=o.bY(this.tileManagers,(L=>L.serialize())),g=this._serializeByIds(this._order,!0),w=this.map.getTerrain()||void 0,C=this.stylesheet;return o.bZ({version:C.version,name:C.name,metadata:C.metadata,light:C.light,sky:C.sky,center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch,sprite:C.sprite,glyphs:C.glyphs,transition:C.transition,projection:C.projection,sources:u,layers:g,terrain:w},(L=>L!==void 0))}_updateLayer(u){this._updatedLayers[u.id]=!0,u.source&&!this._updatedSources[u.source]&&this.tileManagers[u.source].getSource().type!=="raster"&&(this._updatedSources[u.source]="reload",this.tileManagers[u.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(u){const g=z=>this._layers[z].type==="fill-extrusion",w={},C=[];for(let z=this._order.length-1;z>=0;z--){const Y=this._order[z];if(g(Y)){w[Y]=z;for(const re of u){const le=re[Y];if(le)for(const he of le)C.push(he)}}}C.sort(((z,Y)=>Y.intersectionZ-z.intersectionZ));const L=[];for(let z=this._order.length-1;z>=0;z--){const Y=this._order[z];if(g(Y))for(let re=C.length-1;re>=0;re--){const le=C[re].feature;if(w[le.layer.id]<z)break;L.push(le),C.pop()}else for(const re of u){const le=re[Y];if(le)for(const he of le)L.push(he.feature)}}return L}queryRenderedFeatures(u,g,w){g&&g.filter&&this._validate(o.C.filter,"queryRenderedFeatures.filter",g.filter,null,g);const C={};if(g&&g.layers){if(!(Array.isArray(g.layers)||g.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const le of g.layers){const he=this._layers[le];if(!he)return this.fire(new o.k(new Error(`The layer '${le}' does not exist in the map's style and cannot be queried for features.`))),[];C[he.source]=!0}}const L=[];g.availableImages=this._availableImages;const z=this._serializedAllLayers(),Y=g.layers instanceof Set?g.layers:Array.isArray(g.layers)?new Set(g.layers):null,re=Object.assign(Object.assign({},g),{layers:Y,globalState:this._globalState});for(const le in this.tileManagers)g.layers&&!C[le]||L.push(zt(this.tileManagers[le],this._layers,z,u,re,w,this.map.terrain?(he,Ae,Ce)=>this.map.terrain.getElevation(he,Ae,Ce):void 0));return this.placement&&L.push((function(le,he,Ae,Ce,Ue,Ze,ht){const pt={},dt=Ze.queryRenderedSymbols(Ce),xt=[];for(const Ot of Object.keys(dt).map(Number))xt.push(ht[Ot]);xt.sort(st);for(const Ot of xt){const wt=Ot.featureIndex.lookupSymbolFeatures(dt[Ot.bucketInstanceId],he,Ot.bucketIndex,Ot.sourceLayerIndex,{filterSpec:Ue.filter,globalState:Ue.globalState},Ue.layers,Ue.availableImages,le);for(const Lt in wt){const jt=pt[Lt]=pt[Lt]||[],Dt=wt[Lt];Dt.sort(((Yt,Sr)=>{const dr=Ot.featureSortOrder;if(dr){const yr=dr.indexOf(Yt.featureIndex);return dr.indexOf(Sr.featureIndex)-yr}return Sr.featureIndex-Yt.featureIndex}));for(const Yt of Dt)jt.push(Yt)}}return(function(Ot,wt,Lt){for(const jt in Ot)for(const Dt of Ot[jt])$e(Dt,Lt[wt[jt].source]);return Ot})(pt,le,Ae)})(this._layers,z,this.tileManagers,u,re,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(L)}querySourceFeatures(u,g){g?.filter&&this._validate(o.C.filter,"querySourceFeatures.filter",g.filter,null,g);const w=this.tileManagers[u];return w?(function(C,L){const z=C.getRenderableIds().map((le=>C.getTileByID(le))),Y=[],re={};for(let le=0;le<z.length;le++){const he=z[le],Ae=he.tileID.canonical.key;re[Ae]||(re[Ae]=!0,he.querySourceFeatures(Y,L))}return Y})(w,g?Object.assign(Object.assign({},g),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(u,g={}){this._checkLoaded();const w=this.light.getLight();let C=!1;for(const z in u)if(!o.bR(u[z],w[z])){C=!0;break}if(!C)return;const L={now:T(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(u,g),this.light.updateTransitions(L)}getProjection(){var u;return(u=this.stylesheet)===null||u===void 0?void 0:u.projection}setProjection(u){if(this._checkLoaded(),this.projection){if(this.projection.name===u.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=u,this._setProjectionInternal(u.type)}getSky(){var u;return(u=this.stylesheet)===null||u===void 0?void 0:u.sky}setSky(u,g={}){this._checkLoaded();const w=this.getSky();let C=!1;if(!u&&!w)return;if(u&&!w)C=!0;else if(!u&&w)C=!0;else for(const z in u)if(!o.bR(u[z],w[z])){C=!0;break}if(!C)return;const L={now:T(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=u,this.sky.setSky(u,g),this.sky.updateTransitions(L)}_setProjectionInternal(u){const g=(function(w,C){const L={constrainOverride:C};if(Array.isArray(w)){const z=new qn({type:w});return{projection:z,transform:new ms(L),cameraHelper:new qo(z)}}switch(w){case"mercator":return{projection:new hi,transform:new qs(L),cameraHelper:new go};case"globe":{const z=new qn({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:z,transform:new ms(L),cameraHelper:new qo(z)}}case"vertical-perspective":return{projection:new Zr,transform:new Il(L),cameraHelper:new Di};default:return o.w(`Unknown projection name: ${w}. Falling back to mercator projection.`),{projection:new hi,transform:new qs(L),cameraHelper:new go}}})(u,this.map.transformConstrain);this.projection=g.projection,this.map.migrateProjection(g.transform,g.cameraHelper);for(const w in this.tileManagers)this.tileManagers[w].reload()}_validate(u,g,w,C,L={}){return(!L||L.validate!==!1)&&Da(this,u.call(o.C,o.e({key:g,style:this.serialize(),value:w,styleSpec:o.u},C)))}_remove(u=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Et().off(qe,this._rtlPluginLoaded);for(const g in this._layers)this._layers[g].setEventedParent(null);for(const g in this.tileManagers){const w=this.tileManagers[g];w.setEventedParent(null),w.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),u&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(u)}_clearSource(u){this.tileManagers[u].clearTiles()}_reloadSource(u){this.tileManagers[u].resume(),this.tileManagers[u].reload()}_updateSources(u){for(const g in this.tileManagers)this.tileManagers[g].update(u,this.map.terrain)}_generateCollisionBoxes(){for(const u in this.tileManagers)this._reloadSource(u)}_updatePlacement(u,g,w,C,L=!1){let z=!1,Y=!1;const re={};for(const le of this._order){const he=this._layers[le];if(he.type!=="symbol")continue;if(!re[he.source]){const Ce=this.tileManagers[he.source];re[he.source]=Ce.getRenderableIds(!0).map((Ue=>Ce.getTileByID(Ue))).sort(((Ue,Ze)=>Ze.tileID.overscaledZ-Ue.tileID.overscaledZ||(Ue.tileID.isLessThan(Ze.tileID)?-1:1)))}const Ae=this.crossTileSymbolIndex.addLayer(he,re[he.source],u.center.lng);z=z||Ae}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((L=L||this._layerOrderChanged||w===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(T(),u.zoom))&&(this.pauseablePlacement=new an(u,this.map.terrain,this._order,L,g,w,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,re),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(T()),Y=!0),z&&this.pauseablePlacement.placement.setStale()),Y||z)for(const le of this._order){const he=this._layers[le];he.type==="symbol"&&this.placement.updateLayerOpacities(he,re[he.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(T())}_releaseSymbolFadeTiles(){for(const u in this.tileManagers)this.tileManagers[u].releaseSymbolFadeTiles()}getImages(u,g){return o._(this,void 0,void 0,(function*(){const w=yield this.imageManager.getImages(g.icons);this._updateTilesForChangedImages();const C=this.tileManagers[g.source];return C&&C.setDependencies(g.tileID.key,g.type,g.icons),w}))}getGlyphs(u,g){return o._(this,void 0,void 0,(function*(){const w=yield this.glyphManager.getGlyphs(g.stacks),C=this.tileManagers[g.source];return C&&C.setDependencies(g.tileID.key,g.type,[""]),w}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(u,g={}){this._checkLoaded(),u&&this._validate(o.C.glyphs,"glyphs",u,null,g)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=u,this.glyphManager.entries={},this.glyphManager.setURL(u))}getDashes(u,g){return o._(this,void 0,void 0,(function*(){const w={};for(const[C,L]of Object.entries(g.dashes))w[C]=this.lineAtlas.getDash(L.dasharray,L.round);return w}))}addSprite(u,g,w={},C){this._checkLoaded();const L=[{id:u,url:g}],z=[...X(this.stylesheet.sprite),...L];this._validate(o.C.sprite,"sprite",z,null,w)||(this.stylesheet.sprite=z,this._loadSprite(L,!0,C))}removeSprite(u){this._checkLoaded();const g=X(this.stylesheet.sprite);if(g.find((w=>w.id===u))){if(this._spritesImagesIds[u])for(const w of this._spritesImagesIds[u])this.imageManager.removeImage(w),this._changedImages[w]=!0;g.splice(g.findIndex((w=>w.id===u)),1),this.stylesheet.sprite=g.length>0?g:void 0,delete this._spritesImagesIds[u],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${u}" doesn't exists on this map.`)))}getSprite(){return X(this.stylesheet.sprite)}setSprite(u,g={},w){this._checkLoaded(),u&&this._validate(o.C.sprite,"sprite",u,null,g)||(this.stylesheet.sprite=u,u?this._loadSprite(u,!0,w):(this._unloadSprite(),w&&w(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const u in this.tileManagers){const g=this.tileManagers[u];g.setEventedParent(null),g.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const u in this._layers){const g=this._layers[u];g.setEventedParent(null),g.onRemove&&g.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var Ja=o.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class nc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(u,g,w,C,L,z,Y,re,le){this.context=u;let he=this.boundPaintVertexBuffers.length!==C.length;for(let Ae=0;!he&&Ae<C.length;Ae++)this.boundPaintVertexBuffers[Ae]!==C[Ae]&&(he=!0);!this.vao||this.boundProgram!==g||this.boundLayoutVertexBuffer!==w||he||this.boundIndexBuffer!==L||this.boundVertexOffset!==z||this.boundDynamicVertexBuffer!==Y||this.boundDynamicVertexBuffer2!==re||this.boundDynamicVertexBuffer3!==le?this.freshBind(g,w,C,L,z,Y,re,le):(u.bindVertexArray.set(this.vao),Y&&Y.bind(),L&&L.dynamicDraw&&L.bind(),re&&re.bind(),le&&le.bind())}freshBind(u,g,w,C,L,z,Y,re){const le=u.numAttributes,he=this.context,Ae=he.gl;this.vao&&this.destroy(),this.vao=he.createVertexArray(),he.bindVertexArray.set(this.vao),this.boundProgram=u,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=C,this.boundVertexOffset=L,this.boundDynamicVertexBuffer=z,this.boundDynamicVertexBuffer2=Y,this.boundDynamicVertexBuffer3=re,g.enableAttributes(Ae,u);for(const Ce of w)Ce.enableAttributes(Ae,u);z&&z.enableAttributes(Ae,u),Y&&Y.enableAttributes(Ae,u),re&&re.enableAttributes(Ae,u),g.bind(),g.setVertexAttribPointers(Ae,u,L);for(const Ce of w)Ce.bind(),Ce.setVertexAttribPointers(Ae,u,L);z&&(z.bind(),z.setVertexAttribPointers(Ae,u,L)),C&&C.bind(),Y&&(Y.bind(),Y.setVertexAttribPointers(Ae,u,L)),re&&(re.bind(),re.setVertexAttribPointers(Ae,u,L)),he.currentNumAttributes=le}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const uu=(D,u,g,w,C)=>({u_texture:0,u_ele_delta:D,u_fog_matrix:u,u_fog_color:g?g.properties.get("fog-color"):o.bp.white,u_fog_ground_blend:g?g.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:C?0:g?g.calculateFogBlendOpacity(w):0,u_horizon_color:g?g.properties.get("horizon-color"):o.bp.white,u_horizon_fog_blend:g?g.properties.get("horizon-fog-blend"):1,u_is_globe_mode:C?1:0}),Zs={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ja(D){const u=[];for(let g=0;g<D.length;g++){if(D[g]===null)continue;const w=D[g].split(" ");u.push(w.pop())}return u}class Ps{constructor(u,g,w,C,L,z,Y,re,le=[]){const he=u.gl;this.program=he.createProgram();const Ae=ja(g.staticAttributes),Ce=w?w.getBinderAttributes():[],Ue=Ae.concat(Ce),Ze=fn.prelude.staticUniforms?ja(fn.prelude.staticUniforms):[],ht=Y.staticUniforms?ja(Y.staticUniforms):[],pt=g.staticUniforms?ja(g.staticUniforms):[],dt=w?w.getBinderUniforms():[],xt=Ze.concat(ht).concat(pt).concat(dt),Ot=[];for(const dr of xt)Ot.indexOf(dr)<0&&Ot.push(dr);const wt=w?w.defines():[];We(he)&&wt.unshift("#version 300 es"),L&&wt.push("#define OVERDRAW_INSPECTOR;"),z&&wt.push("#define TERRAIN3D;"),re&&wt.push(re),le&&wt.push(...le);let Lt=wt.concat(fn.prelude.fragmentSource,Y.fragmentSource,g.fragmentSource).join(`
`),jt=wt.concat(fn.prelude.vertexSource,Y.vertexSource,g.vertexSource).join(`
`);We(he)||(Lt=(function(dr){return dr.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(Lt),jt=(function(dr){return dr.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(jt));const Dt=he.createShader(he.FRAGMENT_SHADER);if(he.isContextLost())return void(this.failedToCreate=!0);if(he.shaderSource(Dt,Lt),he.compileShader(Dt),!he.getShaderParameter(Dt,he.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${he.getShaderInfoLog(Dt)}`);he.attachShader(this.program,Dt);const Yt=he.createShader(he.VERTEX_SHADER);if(he.isContextLost())return void(this.failedToCreate=!0);if(he.shaderSource(Yt,jt),he.compileShader(Yt),!he.getShaderParameter(Yt,he.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${he.getShaderInfoLog(Yt)}`);he.attachShader(this.program,Yt),this.attributes={};const Sr={};this.numAttributes=Ue.length;for(let dr=0;dr<this.numAttributes;dr++)Ue[dr]&&(he.bindAttribLocation(this.program,dr,Ue[dr]),this.attributes[Ue[dr]]=dr);if(he.linkProgram(this.program),!he.getProgramParameter(this.program,he.LINK_STATUS))throw new Error(`Program failed to link: ${he.getProgramInfoLog(this.program)}`);he.deleteShader(Yt),he.deleteShader(Dt);for(let dr=0;dr<Ot.length;dr++){const yr=Ot[dr];if(yr&&!Sr[yr]){const xr=he.getUniformLocation(this.program,yr);xr&&(Sr[yr]=xr)}}this.fixedUniforms=C(u,Sr),this.terrainUniforms=((dr,yr)=>({u_depth:new o.b_(dr,yr.u_depth),u_terrain:new o.b_(dr,yr.u_terrain),u_terrain_dim:new o.bq(dr,yr.u_terrain_dim),u_terrain_matrix:new o.c0(dr,yr.u_terrain_matrix),u_terrain_unpack:new o.c1(dr,yr.u_terrain_unpack),u_terrain_exaggeration:new o.bq(dr,yr.u_terrain_exaggeration)}))(u,Sr),this.projectionUniforms=((dr,yr)=>({u_projection_matrix:new o.c0(dr,yr.u_projection_matrix),u_projection_tile_mercator_coords:new o.c1(dr,yr.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.c1(dr,yr.u_projection_clipping_plane),u_projection_transition:new o.bq(dr,yr.u_projection_transition),u_projection_fallback_matrix:new o.c0(dr,yr.u_projection_fallback_matrix)}))(u,Sr),this.binderUniforms=w?w.getUniforms(u,Sr):[]}draw(u,g,w,C,L,z,Y,re,le,he,Ae,Ce,Ue,Ze,ht,pt,dt,xt,Ot){const wt=u.gl;if(this.failedToCreate)return;if(u.program.set(this.program),u.setDepthMode(w),u.setStencilMode(C),u.setColorMode(L),u.setCullFace(z),re){u.activeTexture.set(wt.TEXTURE2),wt.bindTexture(wt.TEXTURE_2D,re.depthTexture),u.activeTexture.set(wt.TEXTURE3),wt.bindTexture(wt.TEXTURE_2D,re.texture);for(const jt in this.terrainUniforms)this.terrainUniforms[jt].set(re[jt])}if(le)for(const jt in le)this.projectionUniforms[Zs[jt]].set(le[jt]);if(Y)for(const jt in this.fixedUniforms)this.fixedUniforms[jt].set(Y[jt]);pt&&pt.setUniforms(u,this.binderUniforms,Ze,{zoom:ht});let Lt=0;switch(g){case wt.LINES:Lt=2;break;case wt.TRIANGLES:Lt=3;break;case wt.LINE_STRIP:Lt=1}for(const jt of Ue.get()){const Dt=jt.vaos||(jt.vaos={});(Dt[he]||(Dt[he]=new nc)).bind(u,this,Ae,pt?pt.getPaintVertexBuffers():[],Ce,jt.vertexOffset,dt,xt,Ot),wt.drawElements(g,jt.primitiveLength*Lt,wt.UNSIGNED_SHORT,jt.primitiveOffset*Lt*2)}}}function ic(D,u,g){const w=1/o.aN(g,1,u.transform.tileZoom),C=Math.pow(2,g.tileID.overscaledZ),L=g.tileSize*Math.pow(2,u.transform.tileZoom)/C,z=L*(g.tileID.canonical.x+g.tileID.wrap*C),Y=L*g.tileID.canonical.y;return{u_image:0,u_texsize:g.imageAtlasTexture.size,u_scale:[w,D.fromScale,D.toScale],u_fade:D.t,u_pixel_coord_upper:[z>>16,Y>>16],u_pixel_coord_lower:[65535&z,65535&Y]}}const ac=(D,u,g,w)=>{const C=D.style.light,L=C.properties.get("position"),z=[L.x,L.y,L.z],Y=o.c4();C.properties.get("anchor")==="viewport"&&o.c5(Y,D.transform.bearingInRadians),o.c6(z,z,Y);const re=D.transform.transformLightDirection(z),le=C.properties.get("color");return{u_lightpos:z,u_lightpos_globe:re,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[le.r,le.g,le.b],u_vertical_gradient:+u,u_opacity:g,u_fill_translate:w}},cl=(D,u,g,w,C,L,z)=>o.e(ac(D,u,g,w),ic(L,D,z),{u_height_factor:-Math.pow(2,C.overscaledZ)/z.tileSize/8}),cu=(D,u,g,w)=>o.e(ic(u,D,g),{u_fill_translate:w}),Lo=(D,u)=>({u_world:D,u_fill_translate:u}),mo=(D,u,g,w,C)=>o.e(cu(D,u,g,C),{u_world:w}),Du=(D,u,g,w,C)=>{const L=D.transform;let z,Y,re=0;if(g.paint.get("circle-pitch-alignment")==="map"){const le=o.aN(u,1,L.zoom);z=!0,Y=[le,le],re=le/(o.a5*Math.pow(2,u.tileID.overscaledZ))*2*Math.PI*C}else z=!1,Y=L.pixelsToGLUnits;return{u_camera_to_center_distance:L.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+z,u_device_pixel_ratio:D.pixelRatio,u_extrude_scale:Y,u_globe_extrude_scale:re,u_translate:w}},Ua=D=>({u_pixel_extrude_scale:[1/D.width,1/D.height]}),fu=D=>({u_viewport_size:[D.width,D.height]}),Ks=(D,u=1)=>({u_color:D,u_overlay:0,u_overlay_scale:u}),ys=(D,u,g,w)=>{const C=o.aN(D,1,u)/(o.a5*Math.pow(2,D.tileID.overscaledZ))*2*Math.PI*w;return{u_extrude_scale:o.aN(D,1,u),u_intensity:g,u_globe_extrude_scale:C}},Va=(D,u,g,w)=>{const C=o.N();o.c7(C,0,D.width,D.height,0,0,1);const L=D.context.gl;return{u_matrix:C,u_world:[L.drawingBufferWidth,L.drawingBufferHeight],u_image:g,u_color_ramp:w,u_opacity:u.paint.get("heatmap-opacity")}},Vl=(D,u,g)=>{const w=g.paint.get("hillshade-accent-color");let C;switch(g.paint.get("hillshade-method")){case"basic":C=4;break;case"combined":C=1;break;case"igor":C=2;break;case"multidirectional":C=3;break;default:C=0}const L=g.getIlluminationProperties();for(let z=0;z<L.directionRadians.length;z++)g.paint.get("hillshade-illumination-anchor")==="viewport"&&(L.directionRadians[z]+=D.transform.bearingInRadians);return{u_image:0,u_latrange:hl(0,u.tileID),u_exaggeration:g.paint.get("hillshade-exaggeration"),u_altitudes:L.altitudeRadians,u_azimuths:L.directionRadians,u_accent:w,u_method:C,u_highlights:L.highlightColor,u_shadows:L.shadowColor}},fl=(D,u)=>{const g=u.stride,w=o.N();return o.c7(w,0,o.a5,-o.a5,0,0,1),o.O(w,w,[0,-o.a5,0]),{u_matrix:w,u_image:1,u_dimension:[g,g],u_zoom:D.overscaledZ,u_unpack:u.getUnpackVector()}};function hl(D,u){const g=Math.pow(2,u.canonical.z),w=u.canonical.y;return[new o.a9(0,w/g).toLngLat().lat,new o.a9(0,(w+1)/g).toLngLat().lat]}const $l=(D,u,g=0)=>({u_image:0,u_unpack:u.getUnpackVector(),u_dimension:[u.stride,u.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:g,u_opacity:D.paint.get("color-relief-opacity")}),ql=(D,u,g,w)=>{const C=D.transform;return{u_translation:hn(D,u,g),u_ratio:w/o.aN(u,1,C.zoom),u_device_pixel_ratio:D.pixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},dl=(D,u,g,w,C)=>o.e(ql(D,u,g,w),{u_image:0,u_image_height:C}),Hl=(D,u,g,w,C)=>{const L=D.transform,z=mr(u,L);return{u_translation:hn(D,u,g),u_texsize:u.imageAtlasTexture.size,u_ratio:w/o.aN(u,1,L.zoom),u_device_pixel_ratio:D.pixelRatio,u_image:0,u_scale:[z,C.fromScale,C.toScale],u_fade:C.t,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]]}},Ou=(D,u,g,w,C)=>{const L=mr(u,D.transform);return o.e(ql(D,u,g,w),{u_tileratio:L,u_crossfade_from:C.fromScale,u_crossfade_to:C.toScale,u_image:0,u_mix:C.t,u_lineatlas_width:D.lineAtlas.width,u_lineatlas_height:D.lineAtlas.height})},tr=(D,u,g,w,C,L)=>{const z=mr(u,D.transform);return o.e(ql(D,u,g,w),{u_image:0,u_image_height:L,u_tileratio:z,u_crossfade_from:C.fromScale,u_crossfade_to:C.toScale,u_image_dash:1,u_mix:C.t,u_lineatlas_width:D.lineAtlas.width,u_lineatlas_height:D.lineAtlas.height})};function mr(D,u){return 1/o.aN(D,1,u.tileZoom)}function hn(D,u,g){return o.aO(D.transform,u,g.paint.get("line-translate"),g.paint.get("line-translate-anchor"))}const In=(D,u,g,w,C)=>{return{u_tl_parent:D,u_scale_parent:u,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(z=w.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(L=w.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:vi(w.paint.get("raster-hue-rotate")),u_coords_top:[C[0].x,C[0].y,C[1].x,C[1].y],u_coords_bottom:[C[3].x,C[3].y,C[2].x,C[2].y]};var L,z};function vi(D){D*=Math.PI/180;const u=Math.sin(D),g=Math.cos(D);return[(2*g+1)/3,(-Math.sqrt(3)*u-g+1)/3,(Math.sqrt(3)*u-g+1)/3]}const Pn=(D,u,g,w,C,L,z,Y,re,le,he,Ae,Ce)=>{const Ue=z.transform;return{u_is_size_zoom_constant:+(D==="constant"||D==="source"),u_is_size_feature_constant:+(D==="constant"||D==="camera"),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:Ue.cameraToCenterDistance,u_pitch:Ue.pitch/360*2*Math.PI,u_rotate_symbol:+g,u_aspect_ratio:Ue.width/Ue.height,u_fade_change:z.options.fadeDuration?z.symbolFadeChange:1,u_label_plane_matrix:Y,u_coord_matrix:re,u_is_text:+he,u_pitch_with_map:+w,u_is_along_line:C,u_is_variable_anchor:L,u_texsize:Ae,u_texture:0,u_translation:le,u_pitched_scale:Ce}},I=(D,u,g,w,C,L,z,Y,re,le,he,Ae,Ce,Ue)=>{const Ze=z.transform;return o.e(Pn(D,u,g,w,C,L,z,Y,re,le,he,Ae,Ue),{u_gamma_scale:w?Math.cos(Ze.pitch*Math.PI/180)*Ze.cameraToCenterDistance:1,u_device_pixel_ratio:z.pixelRatio,u_is_halo:1})},y=(D,u,g,w,C,L,z,Y,re,le,he,Ae,Ce)=>o.e(I(D,u,g,w,C,L,z,Y,re,le,!0,he,0,Ce),{u_texsize_icon:Ae,u_texture_icon:1}),_=(D,u)=>({u_opacity:D,u_color:u}),P=(D,u,g,w,C)=>o.e((function(L,z,Y,re){const le=Y.imageManager.getPattern(L.from.toString()),he=Y.imageManager.getPattern(L.to.toString()),{width:Ae,height:Ce}=Y.imageManager.getPixelSize(),Ue=Math.pow(2,re.tileID.overscaledZ),Ze=re.tileSize*Math.pow(2,Y.transform.tileZoom)/Ue,ht=Ze*(re.tileID.canonical.x+re.tileID.wrap*Ue),pt=Ze*re.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:le.tl,u_pattern_br_a:le.br,u_pattern_tl_b:he.tl,u_pattern_br_b:he.br,u_texsize:[Ae,Ce],u_mix:z.t,u_pattern_size_a:le.displaySize,u_pattern_size_b:he.displaySize,u_scale_a:z.fromScale,u_scale_b:z.toScale,u_tile_units_to_pixels:1/o.aN(re,1,Y.transform.tileZoom),u_pixel_coord_upper:[ht>>16,pt>>16],u_pixel_coord_lower:[65535&ht,65535&pt]}})(g,C,u,w),{u_opacity:D}),$=(D,u)=>{},ne={fillExtrusion:(D,u)=>({u_lightpos:new o.c2(D,u.u_lightpos),u_lightpos_globe:new o.c2(D,u.u_lightpos_globe),u_lightintensity:new o.bq(D,u.u_lightintensity),u_lightcolor:new o.c2(D,u.u_lightcolor),u_vertical_gradient:new o.bq(D,u.u_vertical_gradient),u_opacity:new o.bq(D,u.u_opacity),u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillExtrusionPattern:(D,u)=>({u_lightpos:new o.c2(D,u.u_lightpos),u_lightpos_globe:new o.c2(D,u.u_lightpos_globe),u_lightintensity:new o.bq(D,u.u_lightintensity),u_lightcolor:new o.c2(D,u.u_lightcolor),u_vertical_gradient:new o.bq(D,u.u_vertical_gradient),u_height_factor:new o.bq(D,u.u_height_factor),u_opacity:new o.bq(D,u.u_opacity),u_fill_translate:new o.c3(D,u.u_fill_translate),u_image:new o.b_(D,u.u_image),u_texsize:new o.c3(D,u.u_texsize),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade)}),fill:(D,u)=>({u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillPattern:(D,u)=>({u_image:new o.b_(D,u.u_image),u_texsize:new o.c3(D,u.u_texsize),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade),u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillOutline:(D,u)=>({u_world:new o.c3(D,u.u_world),u_fill_translate:new o.c3(D,u.u_fill_translate)}),fillOutlinePattern:(D,u)=>({u_world:new o.c3(D,u.u_world),u_image:new o.b_(D,u.u_image),u_texsize:new o.c3(D,u.u_texsize),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade),u_fill_translate:new o.c3(D,u.u_fill_translate)}),circle:(D,u)=>({u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_scale_with_map:new o.b_(D,u.u_scale_with_map),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_extrude_scale:new o.c3(D,u.u_extrude_scale),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_globe_extrude_scale:new o.bq(D,u.u_globe_extrude_scale),u_translate:new o.c3(D,u.u_translate)}),collisionBox:(D,u)=>({u_pixel_extrude_scale:new o.c3(D,u.u_pixel_extrude_scale)}),collisionCircle:(D,u)=>({u_viewport_size:new o.c3(D,u.u_viewport_size)}),debug:(D,u)=>({u_color:new o.b$(D,u.u_color),u_overlay:new o.b_(D,u.u_overlay),u_overlay_scale:new o.bq(D,u.u_overlay_scale)}),depth:$,clippingMask:$,heatmap:(D,u)=>({u_extrude_scale:new o.bq(D,u.u_extrude_scale),u_intensity:new o.bq(D,u.u_intensity),u_globe_extrude_scale:new o.bq(D,u.u_globe_extrude_scale)}),heatmapTexture:(D,u)=>({u_matrix:new o.c0(D,u.u_matrix),u_world:new o.c3(D,u.u_world),u_image:new o.b_(D,u.u_image),u_color_ramp:new o.b_(D,u.u_color_ramp),u_opacity:new o.bq(D,u.u_opacity)}),hillshade:(D,u)=>({u_image:new o.b_(D,u.u_image),u_latrange:new o.c3(D,u.u_latrange),u_exaggeration:new o.bq(D,u.u_exaggeration),u_altitudes:new o.c9(D,u.u_altitudes),u_azimuths:new o.c9(D,u.u_azimuths),u_accent:new o.b$(D,u.u_accent),u_method:new o.b_(D,u.u_method),u_shadows:new o.c8(D,u.u_shadows),u_highlights:new o.c8(D,u.u_highlights)}),hillshadePrepare:(D,u)=>({u_matrix:new o.c0(D,u.u_matrix),u_image:new o.b_(D,u.u_image),u_dimension:new o.c3(D,u.u_dimension),u_zoom:new o.bq(D,u.u_zoom),u_unpack:new o.c1(D,u.u_unpack)}),colorRelief:(D,u)=>({u_image:new o.b_(D,u.u_image),u_unpack:new o.c1(D,u.u_unpack),u_dimension:new o.c3(D,u.u_dimension),u_elevation_stops:new o.b_(D,u.u_elevation_stops),u_color_stops:new o.b_(D,u.u_color_stops),u_color_ramp_size:new o.b_(D,u.u_color_ramp_size),u_opacity:new o.bq(D,u.u_opacity)}),line:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels)}),lineGradient:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_image:new o.b_(D,u.u_image),u_image_height:new o.bq(D,u.u_image_height)}),linePattern:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_texsize:new o.c3(D,u.u_texsize),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_image:new o.b_(D,u.u_image),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_scale:new o.c2(D,u.u_scale),u_fade:new o.bq(D,u.u_fade)}),lineSDF:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_image:new o.b_(D,u.u_image),u_mix:new o.bq(D,u.u_mix),u_tileratio:new o.bq(D,u.u_tileratio),u_crossfade_from:new o.bq(D,u.u_crossfade_from),u_crossfade_to:new o.bq(D,u.u_crossfade_to),u_lineatlas_width:new o.bq(D,u.u_lineatlas_width),u_lineatlas_height:new o.bq(D,u.u_lineatlas_height)}),lineGradientSDF:(D,u)=>({u_translation:new o.c3(D,u.u_translation),u_ratio:new o.bq(D,u.u_ratio),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_units_to_pixels:new o.c3(D,u.u_units_to_pixels),u_image:new o.b_(D,u.u_image),u_image_height:new o.bq(D,u.u_image_height),u_tileratio:new o.bq(D,u.u_tileratio),u_crossfade_from:new o.bq(D,u.u_crossfade_from),u_crossfade_to:new o.bq(D,u.u_crossfade_to),u_image_dash:new o.b_(D,u.u_image_dash),u_mix:new o.bq(D,u.u_mix),u_lineatlas_width:new o.bq(D,u.u_lineatlas_width),u_lineatlas_height:new o.bq(D,u.u_lineatlas_height)}),raster:(D,u)=>({u_tl_parent:new o.c3(D,u.u_tl_parent),u_scale_parent:new o.bq(D,u.u_scale_parent),u_buffer_scale:new o.bq(D,u.u_buffer_scale),u_fade_t:new o.bq(D,u.u_fade_t),u_opacity:new o.bq(D,u.u_opacity),u_image0:new o.b_(D,u.u_image0),u_image1:new o.b_(D,u.u_image1),u_brightness_low:new o.bq(D,u.u_brightness_low),u_brightness_high:new o.bq(D,u.u_brightness_high),u_saturation_factor:new o.bq(D,u.u_saturation_factor),u_contrast_factor:new o.bq(D,u.u_contrast_factor),u_spin_weights:new o.c2(D,u.u_spin_weights),u_coords_top:new o.c1(D,u.u_coords_top),u_coords_bottom:new o.c1(D,u.u_coords_bottom)}),symbolIcon:(D,u)=>({u_is_size_zoom_constant:new o.b_(D,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(D,u.u_is_size_feature_constant),u_size_t:new o.bq(D,u.u_size_t),u_size:new o.bq(D,u.u_size),u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_pitch:new o.bq(D,u.u_pitch),u_rotate_symbol:new o.b_(D,u.u_rotate_symbol),u_aspect_ratio:new o.bq(D,u.u_aspect_ratio),u_fade_change:new o.bq(D,u.u_fade_change),u_label_plane_matrix:new o.c0(D,u.u_label_plane_matrix),u_coord_matrix:new o.c0(D,u.u_coord_matrix),u_is_text:new o.b_(D,u.u_is_text),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_is_along_line:new o.b_(D,u.u_is_along_line),u_is_variable_anchor:new o.b_(D,u.u_is_variable_anchor),u_texsize:new o.c3(D,u.u_texsize),u_texture:new o.b_(D,u.u_texture),u_translation:new o.c3(D,u.u_translation),u_pitched_scale:new o.bq(D,u.u_pitched_scale)}),symbolSDF:(D,u)=>({u_is_size_zoom_constant:new o.b_(D,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(D,u.u_is_size_feature_constant),u_size_t:new o.bq(D,u.u_size_t),u_size:new o.bq(D,u.u_size),u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_pitch:new o.bq(D,u.u_pitch),u_rotate_symbol:new o.b_(D,u.u_rotate_symbol),u_aspect_ratio:new o.bq(D,u.u_aspect_ratio),u_fade_change:new o.bq(D,u.u_fade_change),u_label_plane_matrix:new o.c0(D,u.u_label_plane_matrix),u_coord_matrix:new o.c0(D,u.u_coord_matrix),u_is_text:new o.b_(D,u.u_is_text),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_is_along_line:new o.b_(D,u.u_is_along_line),u_is_variable_anchor:new o.b_(D,u.u_is_variable_anchor),u_texsize:new o.c3(D,u.u_texsize),u_texture:new o.b_(D,u.u_texture),u_gamma_scale:new o.bq(D,u.u_gamma_scale),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_is_halo:new o.b_(D,u.u_is_halo),u_translation:new o.c3(D,u.u_translation),u_pitched_scale:new o.bq(D,u.u_pitched_scale)}),symbolTextAndIcon:(D,u)=>({u_is_size_zoom_constant:new o.b_(D,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(D,u.u_is_size_feature_constant),u_size_t:new o.bq(D,u.u_size_t),u_size:new o.bq(D,u.u_size),u_camera_to_center_distance:new o.bq(D,u.u_camera_to_center_distance),u_pitch:new o.bq(D,u.u_pitch),u_rotate_symbol:new o.b_(D,u.u_rotate_symbol),u_aspect_ratio:new o.bq(D,u.u_aspect_ratio),u_fade_change:new o.bq(D,u.u_fade_change),u_label_plane_matrix:new o.c0(D,u.u_label_plane_matrix),u_coord_matrix:new o.c0(D,u.u_coord_matrix),u_is_text:new o.b_(D,u.u_is_text),u_pitch_with_map:new o.b_(D,u.u_pitch_with_map),u_is_along_line:new o.b_(D,u.u_is_along_line),u_is_variable_anchor:new o.b_(D,u.u_is_variable_anchor),u_texsize:new o.c3(D,u.u_texsize),u_texsize_icon:new o.c3(D,u.u_texsize_icon),u_texture:new o.b_(D,u.u_texture),u_texture_icon:new o.b_(D,u.u_texture_icon),u_gamma_scale:new o.bq(D,u.u_gamma_scale),u_device_pixel_ratio:new o.bq(D,u.u_device_pixel_ratio),u_is_halo:new o.b_(D,u.u_is_halo),u_translation:new o.c3(D,u.u_translation),u_pitched_scale:new o.bq(D,u.u_pitched_scale)}),background:(D,u)=>({u_opacity:new o.bq(D,u.u_opacity),u_color:new o.b$(D,u.u_color)}),backgroundPattern:(D,u)=>({u_opacity:new o.bq(D,u.u_opacity),u_image:new o.b_(D,u.u_image),u_pattern_tl_a:new o.c3(D,u.u_pattern_tl_a),u_pattern_br_a:new o.c3(D,u.u_pattern_br_a),u_pattern_tl_b:new o.c3(D,u.u_pattern_tl_b),u_pattern_br_b:new o.c3(D,u.u_pattern_br_b),u_texsize:new o.c3(D,u.u_texsize),u_mix:new o.bq(D,u.u_mix),u_pattern_size_a:new o.c3(D,u.u_pattern_size_a),u_pattern_size_b:new o.c3(D,u.u_pattern_size_b),u_scale_a:new o.bq(D,u.u_scale_a),u_scale_b:new o.bq(D,u.u_scale_b),u_pixel_coord_upper:new o.c3(D,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(D,u.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bq(D,u.u_tile_units_to_pixels)}),terrain:(D,u)=>({u_texture:new o.b_(D,u.u_texture),u_ele_delta:new o.bq(D,u.u_ele_delta),u_fog_matrix:new o.c0(D,u.u_fog_matrix),u_fog_color:new o.b$(D,u.u_fog_color),u_fog_ground_blend:new o.bq(D,u.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bq(D,u.u_fog_ground_blend_opacity),u_horizon_color:new o.b$(D,u.u_horizon_color),u_horizon_fog_blend:new o.bq(D,u.u_horizon_fog_blend),u_is_globe_mode:new o.bq(D,u.u_is_globe_mode)}),terrainDepth:(D,u)=>({u_ele_delta:new o.bq(D,u.u_ele_delta)}),terrainCoords:(D,u)=>({u_texture:new o.b_(D,u.u_texture),u_terrain_coords_id:new o.bq(D,u.u_terrain_coords_id),u_ele_delta:new o.bq(D,u.u_ele_delta)}),projectionErrorMeasurement:(D,u)=>({u_input:new o.bq(D,u.u_input),u_output_expected:new o.bq(D,u.u_output_expected)}),atmosphere:(D,u)=>({u_sun_pos:new o.c2(D,u.u_sun_pos),u_atmosphere_blend:new o.bq(D,u.u_atmosphere_blend),u_globe_position:new o.c2(D,u.u_globe_position),u_globe_radius:new o.bq(D,u.u_globe_radius),u_inv_proj_matrix:new o.c0(D,u.u_inv_proj_matrix)}),sky:(D,u)=>({u_sky_color:new o.b$(D,u.u_sky_color),u_horizon_color:new o.b$(D,u.u_horizon_color),u_horizon:new o.c3(D,u.u_horizon),u_horizon_normal:new o.c3(D,u.u_horizon_normal),u_sky_horizon_blend:new o.bq(D,u.u_sky_horizon_blend),u_sky_blend:new o.bq(D,u.u_sky_blend)})};class ve{constructor(u,g,w){this.context=u;const C=u.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete g.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(u){const g=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Oe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class tt{constructor(u,g,w,C){this.length=g.length,this.attributes=w,this.itemSize=g.bytesPerElement,this.dynamicDraw=C,this.context=u;const L=u.gl;this.buffer=L.createBuffer(),u.bindVertexBuffer.set(this.buffer),L.bufferData(L.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?L.DYNAMIC_DRAW:L.STATIC_DRAW),this.dynamicDraw||delete g.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(u){if(u.length!==this.length)throw new Error(`Length of new data is ${u.length}, which doesn't match current length of ${this.length}`);const g=this.context.gl;this.bind(),g.bufferSubData(g.ARRAY_BUFFER,0,u.arrayBuffer)}enableAttributes(u,g){for(let w=0;w<this.attributes.length;w++){const C=g.attributes[this.attributes[w].name];C!==void 0&&u.enableVertexAttribArray(C)}}setVertexAttribPointers(u,g,w){for(let C=0;C<this.attributes.length;C++){const L=this.attributes[C],z=g.attributes[L.name];z!==void 0&&u.vertexAttribPointer(z,L.components,u[Oe[L.type]],!1,this.itemSize,L.offset+this.itemSize*(w||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ft{constructor(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(u){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class rr extends ft{getDefault(){return o.bp.transparent}set(u){const g=this.current;(u.r!==g.r||u.g!==g.g||u.b!==g.b||u.a!==g.a||this.dirty)&&(this.gl.clearColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class ur extends ft{getDefault(){return 1}set(u){(u!==this.current||this.dirty)&&(this.gl.clearDepth(u),this.current=u,this.dirty=!1)}}class qr extends ft{getDefault(){return 0}set(u){(u!==this.current||this.dirty)&&(this.gl.clearStencil(u),this.current=u,this.dirty=!1)}}class bn extends ft{getDefault(){return[!0,!0,!0,!0]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||u[3]!==g[3]||this.dirty)&&(this.gl.colorMask(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Dn extends ft{getDefault(){return!0}set(u){(u!==this.current||this.dirty)&&(this.gl.depthMask(u),this.current=u,this.dirty=!1)}}class Xn extends ft{getDefault(){return 255}set(u){(u!==this.current||this.dirty)&&(this.gl.stencilMask(u),this.current=u,this.dirty=!1)}}class Fn extends ft{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(u){const g=this.current;(u.func!==g.func||u.ref!==g.ref||u.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(u.func,u.ref,u.mask),this.current=u,this.dirty=!1)}}class En extends ft{getDefault(){const u=this.gl;return[u.KEEP,u.KEEP,u.KEEP]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(u[0],u[1],u[2]),this.current=u,this.dirty=!1)}}class na extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=u,this.dirty=!1}}class ca extends ft{getDefault(){return[0,1]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||this.dirty)&&(this.gl.depthRange(u[0],u[1]),this.current=u,this.dirty=!1)}}class lo extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=u,this.dirty=!1}}class Ma extends ft{getDefault(){return this.gl.LESS}set(u){(u!==this.current||this.dirty)&&(this.gl.depthFunc(u),this.current=u,this.dirty=!1)}}class Ho extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.BLEND):g.disable(g.BLEND),this.current=u,this.dirty=!1}}class Js extends ft{getDefault(){const u=this.gl;return[u.ONE,u.ZERO]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(u[0],u[1]),this.current=u,this.dirty=!1)}}class Pl extends ft{getDefault(){return o.bp.transparent}set(u){const g=this.current;(u.r!==g.r||u.g!==g.g||u.b!==g.b||u.a!==g.a||this.dirty)&&(this.gl.blendColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class hu extends ft{getDefault(){return this.gl.FUNC_ADD}set(u){(u!==this.current||this.dirty)&&(this.gl.blendEquation(u),this.current=u,this.dirty=!1)}}class du extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=u,this.dirty=!1}}class Ms extends ft{getDefault(){return this.gl.BACK}set(u){(u!==this.current||this.dirty)&&(this.gl.cullFace(u),this.current=u,this.dirty=!1)}}class Gl extends ft{getDefault(){return this.gl.CCW}set(u){(u!==this.current||this.dirty)&&(this.gl.frontFace(u),this.current=u,this.dirty=!1)}}class Wl extends ft{getDefault(){return null}set(u){(u!==this.current||this.dirty)&&(this.gl.useProgram(u),this.current=u,this.dirty=!1)}}class To extends ft{getDefault(){return this.gl.TEXTURE0}set(u){(u!==this.current||this.dirty)&&(this.gl.activeTexture(u),this.current=u,this.dirty=!1)}}class ni extends ft{getDefault(){const u=this.gl;return[0,0,u.drawingBufferWidth,u.drawingBufferHeight]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||u[3]!==g[3]||this.dirty)&&(this.gl.viewport(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Lu extends ft{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,u),this.current=u,this.dirty=!1}}class eh extends ft{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class yf extends ft{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindTexture(g.TEXTURE_2D,u),this.current=u,this.dirty=!1}}class pu extends ft{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class kp extends ft{getDefault(){return null}set(u){const g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Vg extends ft{getDefault(){return null}set(u){var g;if(u===this.current&&!this.dirty)return;const w=this.gl;We(w)?w.bindVertexArray(u):(g=w.getExtension("OES_vertex_array_object"))===null||g===void 0||g.bindVertexArrayOES(u),this.current=u,this.dirty=!1}}class $g extends ft{getDefault(){return 4}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,u),this.current=u,this.dirty=!1}}class qg extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),this.current=u,this.dirty=!1}}class Rd extends ft{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,u),this.current=u,this.dirty=!1}}class Vc extends ft{constructor(u,g){super(u),this.context=u,this.parent=g}getDefault(){return null}}class th extends Vc{setDirty(){this.dirty=!0}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class Rp extends Vc{set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Hg extends Vc{set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_STENCIL_ATTACHMENT,g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}const Dp="Framebuffer is not complete";class Op{constructor(u,g,w,C,L){this.context=u,this.width=g,this.height=w;const z=u.gl,Y=this.framebuffer=z.createFramebuffer();if(this.colorAttachment=new th(u,Y),C)this.depthAttachment=L?new Hg(u,Y):new Rp(u,Y);else if(L)throw new Error("Stencil cannot be set without depth");if(z.checkFramebufferStatus(z.FRAMEBUFFER)!==z.FRAMEBUFFER_COMPLETE)throw new Error(Dp)}destroy(){const u=this.context.gl,g=this.colorAttachment.get();if(g&&u.deleteTexture(g),this.depthAttachment){const w=this.depthAttachment.get();w&&u.deleteRenderbuffer(w)}u.deleteFramebuffer(this.framebuffer)}}class Lp{constructor(u){var g,w;if(this.gl=u,this.clearColor=new rr(this),this.clearDepth=new ur(this),this.clearStencil=new qr(this),this.colorMask=new bn(this),this.depthMask=new Dn(this),this.stencilMask=new Xn(this),this.stencilFunc=new Fn(this),this.stencilOp=new En(this),this.stencilTest=new na(this),this.depthRange=new ca(this),this.depthTest=new lo(this),this.depthFunc=new Ma(this),this.blend=new Ho(this),this.blendFunc=new Js(this),this.blendColor=new Pl(this),this.blendEquation=new hu(this),this.cullFace=new du(this),this.cullFaceSide=new Ms(this),this.frontFace=new Gl(this),this.program=new Wl(this),this.activeTexture=new To(this),this.viewport=new ni(this),this.bindFramebuffer=new Lu(this),this.bindRenderbuffer=new eh(this),this.bindTexture=new yf(this),this.bindVertexBuffer=new pu(this),this.bindElementBuffer=new kp(this),this.bindVertexArray=new Vg(this),this.pixelStoreUnpack=new $g(this),this.pixelStoreUnpackPremultiplyAlpha=new qg(this),this.pixelStoreUnpackFlipY=new Rd(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE),We(u)){this.HALF_FLOAT=u.HALF_FLOAT;const C=u.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(g=u.RGBA16F)!==null&&g!==void 0?g:C?.RGBA16F_EXT,this.RGB16F=(w=u.RGB16F)!==null&&w!==void 0?w:C?.RGB16F_EXT,u.getExtension("EXT_color_buffer_float")}else{u.getExtension("EXT_color_buffer_half_float"),u.getExtension("OES_texture_half_float_linear");const C=u.getExtension("OES_texture_half_float");this.HALF_FLOAT=C?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(u,g){return new ve(this,u,g)}createVertexBuffer(u,g,w){return new tt(this,u,g,w)}createRenderbuffer(u,g,w){const C=this.gl,L=C.createRenderbuffer();return this.bindRenderbuffer.set(L),C.renderbufferStorage(C.RENDERBUFFER,u,g,w),this.bindRenderbuffer.set(null),L}createFramebuffer(u,g,w,C){return new Op(this,u,g,w,C)}clear({color:u,depth:g,stencil:w}){const C=this.gl;let L=0;u&&(L|=C.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set([!0,!0,!0,!0])),g!==void 0&&(L|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(g),this.depthMask.set(!0)),w!==void 0&&(L|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),C.clear(L)}setCullFace(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))}setDepthMode(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)}setStencilMode(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)}setColorMode(u){o.bR(u.blendFunction,ji.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)}createVertexArray(){var u;return We(this.gl)?this.gl.createVertexArray():(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.createVertexArrayOES()}deleteVertexArray(u){var g;return We(this.gl)?this.gl.deleteVertexArray(u):(g=this.gl.getExtension("OES_vertex_array_object"))===null||g===void 0?void 0:g.deleteVertexArrayOES(u)}unbindVAO(){this.bindVertexArray.set(null)}}let vf;function rh(D,u,g,w,C){const L=D.context,z=D.transform,Y=L.gl,re=D.useProgram("collisionBox"),le=[];let he=0,Ae=0;for(let dt=0;dt<w.length;dt++){const xt=w[dt],Ot=u.getTile(xt).getBucket(g);if(!Ot)continue;const wt=C?Ot.textCollisionBox:Ot.iconCollisionBox,Lt=Ot.collisionCircleArray;Lt.length>0&&(le.push({circleArray:Lt,circleOffset:Ae,coord:xt}),he+=Lt.length/4,Ae=he),wt&&re.draw(L,Y.LINES,ri.disabled,ai.disabled,D.colorModeForRenderPass(),ii.disabled,Ua(D.transform),D.style.map.terrain&&D.style.map.terrain.getTerrainData(xt),z.getProjectionData({overscaledTileID:xt,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),g.id,wt.layoutVertexBuffer,wt.indexBuffer,wt.segments,null,D.transform.zoom,null,null,wt.collisionVertexBuffer)}if(!C||!le.length)return;const Ce=D.useProgram("collisionCircle"),Ue=new o.ca;Ue.resize(4*he),Ue._trim();let Ze=0;for(const dt of le)for(let xt=0;xt<dt.circleArray.length/4;xt++){const Ot=4*xt,wt=dt.circleArray[Ot+0],Lt=dt.circleArray[Ot+1],jt=dt.circleArray[Ot+2],Dt=dt.circleArray[Ot+3];Ue.emplace(Ze++,wt,Lt,jt,Dt,0),Ue.emplace(Ze++,wt,Lt,jt,Dt,1),Ue.emplace(Ze++,wt,Lt,jt,Dt,2),Ue.emplace(Ze++,wt,Lt,jt,Dt,3)}(!vf||vf.length<2*he)&&(vf=(function(dt){const xt=2*dt,Ot=new o.cc;Ot.resize(xt),Ot._trim();for(let wt=0;wt<xt;wt++){const Lt=6*wt;Ot.uint16[Lt+0]=4*wt+0,Ot.uint16[Lt+1]=4*wt+1,Ot.uint16[Lt+2]=4*wt+2,Ot.uint16[Lt+3]=4*wt+2,Ot.uint16[Lt+4]=4*wt+3,Ot.uint16[Lt+5]=4*wt+0}return Ot})(he));const ht=L.createIndexBuffer(vf,!0),pt=L.createVertexBuffer(Ue,o.cb.members,!0);for(const dt of le){const xt=fu(D.transform);Ce.draw(L,Y.TRIANGLES,ri.disabled,ai.disabled,D.colorModeForRenderPass(),ii.disabled,xt,D.style.map.terrain&&D.style.map.terrain.getTerrainData(dt.coord),null,g.id,pt,ht,o.aX.simpleSegment(0,2*dt.circleOffset,dt.circleArray.length,dt.circleArray.length/2),null,D.transform.zoom,null,null,null)}pt.destroy(),ht.destroy()}const Gg=o.ar(new Float32Array(16));function Wg(D,u,g,w,C,L){const{horizontalAlign:z,verticalAlign:Y}=o.aS(D);return new o.P((-(z-.5)*u/C+w[0])*L,(-(Y-.5)*g/C+w[1])*L)}function nh(D,u,g,w,C,L){const z=u.tileAnchorPoint.add(new o.P(u.translation[0],u.translation[1]));if(u.pitchWithMap){let Y=w.mult(L);g||(Y=Y.rotate(-C));const re=z.add(Y);return zn(re.x,re.y,u.pitchedLabelPlaneMatrix,u.getElevation).point}if(g){const Y=zi(u.tileAnchorPoint.x+1,u.tileAnchorPoint.y,u).point.sub(D),re=Math.atan(Y.y/Y.x)+(Y.x<0?Math.PI:0);return D.add(w.rotate(re))}return D.add(w)}function Dd(D,u,g,w,C,L,z,Y,re,le,he,Ae){const Ce=D.text.placedSymbolArray,Ue=D.text.dynamicLayoutVertexArray,Ze=D.icon.dynamicLayoutVertexArray,ht={};Ue.clear();for(let pt=0;pt<Ce.length;pt++){const dt=Ce.get(pt),xt=dt.hidden||!dt.crossTileID||D.allowVerticalPlacement&&!dt.placedOrientation?null:w[dt.crossTileID];if(xt){const Ot=new o.P(dt.anchorX,dt.anchorY),wt={getElevation:Ae,width:C.width,height:C.height,pitchedLabelPlaneMatrix:L,pitchWithMap:g,transform:C,tileAnchorPoint:Ot,translation:le,unwrappedTileID:he},Lt=g?ma(Ot.x,Ot.y,wt):zi(Ot.x,Ot.y,wt),jt=Na(C.cameraToCenterDistance,Lt.signedDistanceFromCamera);let Dt=o.aA(D.textSizeData,Y,dt)*jt/o.aM;g&&(Dt*=D.tilePixelRatio/z);const{width:Yt,height:Sr,anchor:dr,textOffset:yr,textBoxScale:xr}=xt,nn=Wg(dr,Yt,Sr,yr,xr,Dt),sn=C.getPitchedTextCorrection(Ot.x+le[0],Ot.y+le[1],he),Hr=nh(Lt.point,wt,u,nn,-C.bearingInRadians,sn),pn=D.allowVerticalPlacement&&dt.placedOrientation===o.az.vertical?Math.PI/2:0;for(let Ti=0;Ti<dt.numGlyphs;Ti++)o.aG(Ue,Hr,pn);re&&dt.associatedIconIndex>=0&&(ht[dt.associatedIconIndex]={shiftedAnchor:Hr,angle:pn})}else Ul(dt.numGlyphs,Ue)}if(re){Ze.clear();const pt=D.icon.placedSymbolArray;for(let dt=0;dt<pt.length;dt++){const xt=pt.get(dt);if(xt.hidden)Ul(xt.numGlyphs,Ze);else{const Ot=ht[dt];if(Ot)for(let wt=0;wt<xt.numGlyphs;wt++)o.aG(Ze,Ot.shiftedAnchor,Ot.angle);else Ul(xt.numGlyphs,Ze)}}D.icon.dynamicLayoutVertexBuffer.updateData(Ze)}D.text.dynamicLayoutVertexBuffer.updateData(Ue)}function Dy(D,u,g){return g.iconsInText&&u?"symbolTextAndIcon":D?"symbolSDF":"symbolIcon"}function Od(D,u,g,w,C,L,z,Y,re,le,he,Ae,Ce){const Ue=D.context,Ze=Ue.gl,ht=D.transform,pt=Y==="map",dt=re==="map",xt=Y!=="viewport"&&g.layout.get("symbol-placement")!=="point",Ot=pt&&!dt&&!xt,wt=!g.layout.get("symbol-sort-key").isConstant();let Lt=!1;const jt=D.getDepthModeForSublayer(0,ri.ReadOnly),Dt=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Yt=[],Sr=ht.getCircleRadiusCorrection();for(const dr of w){const yr=u.getTile(dr),xr=yr.getBucket(g);if(!xr)continue;const nn=C?xr.text:xr.icon;if(!nn||!nn.segments.get().length||!nn.hasVisibleVertices)continue;const sn=nn.programConfigurations.get(g.id),Hr=C||xr.sdfIcons,pn=C?xr.textSizeData:xr.iconSizeData,Ti=dt||ht.pitch!==0,ka=D.useProgram(Dy(Hr,C,xr),sn),yo=o.ay(pn,ht.zoom),to=D.style.map.terrain&&D.style.map.terrain.getTerrainData(dr);let Io,ro,Xo,Po,gl=[0,0],_s=null;if(C)ro=yr.glyphAtlasTexture,Xo=Ze.LINEAR,Io=yr.glyphAtlasTexture.size,xr.iconsInText&&(gl=yr.imageAtlasTexture.size,_s=yr.imageAtlasTexture,Po=Ti||D.options.rotating||D.options.zooming||pn.kind==="composite"||pn.kind==="camera"?Ze.LINEAR:Ze.NEAREST);else{const uo=g.layout.get("icon-size").constantOr(0)!==1||xr.iconsNeedLinear;ro=yr.imageAtlasTexture,Xo=Hr||D.options.rotating||D.options.zooming||uo||Ti?Ze.LINEAR:Ze.NEAREST,Io=yr.imageAtlasTexture.size}const os=o.aN(yr,1,D.transform.zoom),Rl=ei(pt,D.transform,os),Xh=o.N();o.aB(Xh,Rl);const sh=ua(dt,pt,D.transform,os),Ef=o.aO(ht,yr,L,z),zu=ht.getProjectionData({overscaledTileID:dr,applyGlobeMatrix:!Ce,applyTerrainMatrix:!0}),Ud=Dt&&xr.hasTextData(),em=g.layout.get("icon-text-fit")!=="none"&&Ud&&xr.hasIconData();if(xt){const uo=D.style.map.terrain?(Qs,el)=>D.style.map.terrain.getElevation(dr,Qs,el):null,no=g.layout.get("text-rotation-alignment")==="map";ds(xr,D,C,Rl,Xh,dt,le,no,dr.toUnwrapped(),ht.width,ht.height,Ef,uo)}const Vd=C&&Dt||em,Sc=xt||Vd?Gg:dt?Rl:D.transform.clipSpaceToPixelsMatrix,Tf=Hr&&g.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Gc;Gc=Hr?xr.iconsInText?y(pn.kind,yo,Ot,dt,xt,Vd,D,Sc,sh,Ef,Io,gl,Sr):I(pn.kind,yo,Ot,dt,xt,Vd,D,Sc,sh,Ef,C,Io,0,Sr):Pn(pn.kind,yo,Ot,dt,xt,Vd,D,Sc,sh,Ef,C,Io,Sr);const Wc={program:ka,buffers:nn,uniformValues:Gc,projectionData:zu,atlasTexture:ro,atlasTextureIcon:_s,atlasInterpolation:Xo,atlasInterpolationIcon:Po,isSDF:Hr,hasHalo:Tf};if(wt&&xr.canOverlap){Lt=!0;const uo=nn.segments.get();for(const no of uo)Yt.push({segments:new o.aX([no]),sortKey:no.sortKey,state:Wc,terrainData:to})}else Yt.push({segments:nn.segments,sortKey:0,state:Wc,terrainData:to})}Lt&&Yt.sort(((dr,yr)=>dr.sortKey-yr.sortKey));for(const dr of Yt){const yr=dr.state;if(Ue.activeTexture.set(Ze.TEXTURE0),yr.atlasTexture.bind(yr.atlasInterpolation,Ze.CLAMP_TO_EDGE),yr.atlasTextureIcon&&(Ue.activeTexture.set(Ze.TEXTURE1),yr.atlasTextureIcon&&yr.atlasTextureIcon.bind(yr.atlasInterpolationIcon,Ze.CLAMP_TO_EDGE)),yr.isSDF){const xr=yr.uniformValues;yr.hasHalo&&(xr.u_is_halo=1,Ld(yr.buffers,dr.segments,g,D,yr.program,jt,he,Ae,xr,yr.projectionData,dr.terrainData)),xr.u_is_halo=0}Ld(yr.buffers,dr.segments,g,D,yr.program,jt,he,Ae,yr.uniformValues,yr.projectionData,dr.terrainData)}}function Ld(D,u,g,w,C,L,z,Y,re,le,he){const Ae=w.context;C.draw(Ae,Ae.gl.TRIANGLES,L,z,Y,ii.backCCW,re,he,le,g.id,D.layoutVertexBuffer,D.indexBuffer,u,g.paint,w.transform.zoom,D.programConfigurations.get(g.id),D.dynamicLayoutVertexBuffer,D.opacityVertexBuffer)}function Oy(D,u,g,w,C){const L=D.context,z=L.gl,Y=ai.disabled,re=new ji([z.ONE,z.ONE],o.bp.transparent,[!0,!0,!0,!0]),le=u.getBucket(g);if(!le)return;const he=w.key;let Ae=g.heatmapFbos.get(he);Ae||(Ae=Nd(L,u.tileSize,u.tileSize),g.heatmapFbos.set(he,Ae)),L.bindFramebuffer.set(Ae.framebuffer),L.viewport.set([0,0,u.tileSize,u.tileSize]),L.clear({color:o.bp.transparent});const Ce=le.programConfigurations.get(g.id),Ue=D.useProgram("heatmap",Ce,!C),Ze=D.transform.getProjectionData({overscaledTileID:u.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ht=D.style.map.terrain.getTerrainData(w);Ue.draw(L,z.TRIANGLES,ri.disabled,Y,re,ii.disabled,ys(u,D.transform.zoom,g.paint.get("heatmap-intensity"),1),ht,Ze,g.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,g.paint,D.transform.zoom,Ce)}function Ly(D,u,g,w,C){const L=D.context,z=L.gl,Y=D.transform;L.setColorMode(D.colorModeForRenderPass());const re=Np(L,u),le=g.key,he=u.heatmapFbos.get(le);if(!he)return;L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,he.colorAttachment.get()),L.activeTexture.set(z.TEXTURE1),re.bind(z.LINEAR,z.CLAMP_TO_EDGE);const Ae=Y.getProjectionData({overscaledTileID:g,applyTerrainMatrix:C,applyGlobeMatrix:!w});D.useProgram("heatmapTexture").draw(L,z.TRIANGLES,ri.disabled,ai.disabled,D.colorModeForRenderPass(),ii.disabled,Va(D,u,0,1),null,Ae,u.id,D.rasterBoundsBuffer,D.quadTriangleIndexBuffer,D.rasterBoundsSegments,u.paint,Y.zoom),he.destroy(),u.heatmapFbos.delete(le)}function Nd(D,u,g){var w,C;const L=D.gl,z=L.createTexture();L.bindTexture(L.TEXTURE_2D,z),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MIN_FILTER,L.LINEAR),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MAG_FILTER,L.LINEAR);const Y=(w=D.HALF_FLOAT)!==null&&w!==void 0?w:L.UNSIGNED_BYTE,re=(C=D.RGBA16F)!==null&&C!==void 0?C:L.RGBA;L.texImage2D(L.TEXTURE_2D,0,re,u,g,0,L.RGBA,Y,null);const le=D.createFramebuffer(u,g,!1,!1);return le.colorAttachment.set(z),le}function Np(D,u){return u.colorRampTexture||(u.colorRampTexture=new o.T(D,u.colorRamp,D.gl.RGBA)),u.colorRampTexture}function $c(D,u,g,w,C,L,z,Y){let re=256;if(C.stepInterpolant){const le=u.getSource().maxzoom,he=z.canonical.z===le?Math.ceil(1<<D.transform.maxZoom-z.canonical.z):1;re=o.an(o.ce(L.maxLineLength/o.a5*1024*he),256,g.maxTextureSize)}return Y.gradient=o.cf({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:re,image:Y.gradient||void 0,clips:L.lineClipsArray}),Y.texture?Y.texture.update(Y.gradient):Y.texture=new o.T(g,Y.gradient,w.RGBA),Y.version=C.gradientVersion,Y.texture}function Nu(D,u,g,w,C){D.activeTexture.set(u.TEXTURE0),g.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),w.updatePaintBuffers(C)}function xa(D,u,g,w,C,L){(C||D.lineAtlas.dirty)&&(u.activeTexture.set(g.TEXTURE0),D.lineAtlas.bind(u)),w.updatePaintBuffers(L)}function ih(D,u,g,w,C,L,z){const Y=L.gradients[C.id];let re=Y.texture;C.gradientVersion!==Y.version&&(re=$c(D,u,g,w,C,L,z,Y)),g.activeTexture.set(w.TEXTURE0),re.bind(C.stepInterpolant?w.NEAREST:w.LINEAR,w.CLAMP_TO_EDGE)}function Xl(D,u,g,w,C,L,z,Y,re){const le=L.gradients[C.id];let he=le.texture;C.gradientVersion!==le.version&&(he=$c(D,u,g,w,C,L,z,le)),g.activeTexture.set(w.TEXTURE0),he.bind(C.stepInterpolant?w.NEAREST:w.LINEAR,w.CLAMP_TO_EDGE),g.activeTexture.set(w.TEXTURE1),D.lineAtlas.bind(g),Y.updatePaintBuffers(re)}function oc(D,u,g,w,C){if(!g||!w||!w.imageAtlas)return;const L=w.imageAtlas.patternPositions;let z=L[g.to.toString()],Y=L[g.from.toString()];if(!z&&Y&&(z=Y),!Y&&z&&(Y=z),!z||!Y){const re=C.getPaintProperty(u);z=L[re],Y=L[re]}z&&Y&&D.setConstantPatternPositions(z,Y)}function pl(D,u,g,w,C,L,z,Y){const re=D.context.gl,le="fill-pattern",he=g.paint.get(le),Ae=he&&he.constantOr(1),Ce=g.getCrossfadeParameters();let Ue,Ze,ht,pt,dt;const xt=D.transform,Ot=g.paint.get("fill-translate"),wt=g.paint.get("fill-translate-anchor");z?(Ze=Ae&&!g.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Ue=re.LINES):(Ze=Ae?"fillPattern":"fill",Ue=re.TRIANGLES);const Lt=he.constantOr(null);for(const jt of w){const Dt=u.getTile(jt);if(Ae&&!Dt.patternsLoaded())continue;const Yt=Dt.getBucket(g);if(!Yt)continue;const Sr=Yt.programConfigurations.get(g.id),dr=D.useProgram(Ze,Sr),yr=D.style.map.terrain&&D.style.map.terrain.getTerrainData(jt);Ae&&(D.context.activeTexture.set(re.TEXTURE0),Dt.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),Sr.updatePaintBuffers(Ce)),oc(Sr,le,Lt,Dt,g);const xr=xt.getProjectionData({overscaledTileID:jt,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),nn=o.aO(xt,Dt,Ot,wt);if(z){pt=Yt.indexBuffer2,dt=Yt.segments2;const Hr=[re.drawingBufferWidth,re.drawingBufferHeight];ht=Ze==="fillOutlinePattern"&&Ae?mo(D,Ce,Dt,Hr,nn):Lo(Hr,nn)}else pt=Yt.indexBuffer,dt=Yt.segments,ht=Ae?cu(D,Ce,Dt,nn):{u_fill_translate:nn};const sn=D.stencilModeForClipping(jt);dr.draw(D.context,Ue,C,sn,L,ii.backCCW,ht,yr,xr,g.id,Yt.layoutVertexBuffer,pt,dt,g.paint,D.transform.zoom,Sr)}}function Fp(D,u,g,w,C,L,z,Y){const re=D.context,le=re.gl,he="fill-extrusion-pattern",Ae=g.paint.get(he),Ce=Ae.constantOr(1),Ue=g.getCrossfadeParameters(),Ze=g.paint.get("fill-extrusion-opacity"),ht=Ae.constantOr(null),pt=D.transform;for(const dt of w){const xt=u.getTile(dt),Ot=xt.getBucket(g);if(!Ot)continue;const wt=D.style.map.terrain&&D.style.map.terrain.getTerrainData(dt),Lt=Ot.programConfigurations.get(g.id),jt=D.useProgram(Ce?"fillExtrusionPattern":"fillExtrusion",Lt);Ce&&(D.context.activeTexture.set(le.TEXTURE0),xt.imageAtlasTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),Lt.updatePaintBuffers(Ue));const Dt=pt.getProjectionData({overscaledTileID:dt,applyGlobeMatrix:!Y,applyTerrainMatrix:!0});oc(Lt,he,ht,xt,g);const Yt=o.aO(pt,xt,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),Sr=g.paint.get("fill-extrusion-vertical-gradient"),dr=Ce?cl(D,Sr,Ze,Yt,dt,Ue,xt):ac(D,Sr,Ze,Yt);jt.draw(re,re.gl.TRIANGLES,C,L,z,ii.backCCW,dr,wt,Dt,g.id,Ot.layoutVertexBuffer,Ot.indexBuffer,Ot.segments,g.paint,D.transform.zoom,Lt,D.style.map.terrain&&Ot.centroidVertexBuffer)}}function _f(D,u,g,w,C,L,z,Y,re){var le;const he=D.style.projection,Ae=D.context,Ce=D.transform,Ue=Ae.gl,Ze=[`#define NUM_ILLUMINATION_SOURCES ${g.paint.get("hillshade-highlight-color").values.length}`],ht=D.useProgram("hillshade",null,!1,Ze),pt=!D.options.moving;for(const dt of w){const xt=u.getTile(dt),Ot=xt.fbo;if(!Ot)continue;const wt=he.getMeshFromTileID(Ae,dt.canonical,Y,!0,"raster"),Lt=(le=D.style.map.terrain)===null||le===void 0?void 0:le.getTerrainData(dt);Ae.activeTexture.set(Ue.TEXTURE0),Ue.bindTexture(Ue.TEXTURE_2D,Ot.colorAttachment.get());const jt=Ce.getProjectionData({overscaledTileID:dt,aligned:pt,applyGlobeMatrix:!re,applyTerrainMatrix:!0});ht.draw(Ae,Ue.TRIANGLES,L,C[dt.overscaledZ],z,ii.backCCW,Vl(D,xt,g),Lt,jt,g.id,wt.vertexBuffer,wt.indexBuffer,wt.segments)}}function Bh(D,u,g,w,C,L,z,Y,re){var le;const he=D.style.projection,Ae=D.context,Ce=D.transform,Ue=Ae.gl,Ze=D.useProgram("colorRelief"),ht=!D.options.moving;let pt=!0,dt=0;for(const xt of w){const Ot=u.getTile(xt),wt=Ot.dem;if(pt){const dr=Ue.getParameter(Ue.MAX_TEXTURE_SIZE),{elevationTexture:yr,colorTexture:xr}=g.getColorRampTextures(Ae,dr,wt.getUnpackVector());Ae.activeTexture.set(Ue.TEXTURE1),yr.bind(Ue.NEAREST,Ue.CLAMP_TO_EDGE),Ae.activeTexture.set(Ue.TEXTURE4),xr.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),pt=!1,dt=yr.size[0]}if(!wt||!wt.data)continue;const Lt=wt.stride,jt=wt.getPixels();if(Ae.activeTexture.set(Ue.TEXTURE0),Ae.pixelStoreUnpackPremultiplyAlpha.set(!1),Ot.demTexture=Ot.demTexture||D.getTileTexture(Lt),Ot.demTexture){const dr=Ot.demTexture;dr.update(jt,{premultiply:!1}),dr.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE)}else Ot.demTexture=new o.T(Ae,jt,Ue.RGBA,{premultiply:!1}),Ot.demTexture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE);const Dt=he.getMeshFromTileID(Ae,xt.canonical,Y,!0,"raster"),Yt=(le=D.style.map.terrain)===null||le===void 0?void 0:le.getTerrainData(xt),Sr=Ce.getProjectionData({overscaledTileID:xt,aligned:ht,applyGlobeMatrix:!re,applyTerrainMatrix:!0});Ze.draw(Ae,Ue.TRIANGLES,L,C[xt.overscaledZ],z,ii.backCCW,$l(g,Ot.dem,dt),Yt,Sr,g.id,Dt.vertexBuffer,Dt.indexBuffer,Dt.segments)}}const bf=[new o.P(0,0),new o.P(o.a5,0),new o.P(o.a5,o.a5),new o.P(0,o.a5)];function ah(D,u,g,w,C,L,z,Y,re=!1,le=!1){const he=w[w.length-1].overscaledZ,Ae=D.context,Ce=Ae.gl,Ue=D.useProgram("raster"),Ze=D.transform,ht=D.style.projection,pt=D.colorModeForRenderPass(),dt=!D.options.moving,xt=g.paint.get("raster-opacity"),Ot=g.paint.get("raster-resampling"),wt=g.paint.get("raster-fade-duration"),Lt=!!D.style.map.terrain;for(const jt of w){const Dt=D.getDepthModeForSublayer(jt.overscaledZ-he,xt===1?ri.ReadWrite:ri.ReadOnly,Ce.LESS),Yt=u.getTile(jt),Sr=Ot==="nearest"?Ce.NEAREST:Ce.LINEAR;Ae.activeTexture.set(Ce.TEXTURE0),Yt.texture.bind(Sr,Ce.CLAMP_TO_EDGE,Ce.LINEAR_MIPMAP_NEAREST),Ae.activeTexture.set(Ce.TEXTURE1);const{parentTile:dr,parentScaleBy:yr,parentTopLeft:xr,fadeValues:nn}=Xg(Yt,u,wt,Lt);Yt.fadeOpacity=nn.tileOpacity,dr?(dr.fadeOpacity=nn.parentTileOpacity,dr.texture.bind(Sr,Ce.CLAMP_TO_EDGE,Ce.LINEAR_MIPMAP_NEAREST)):Yt.texture.bind(Sr,Ce.CLAMP_TO_EDGE,Ce.LINEAR_MIPMAP_NEAREST),Yt.texture.useMipmap&&Ae.extTextureFilterAnisotropic&&D.transform.pitch>20&&Ce.texParameterf(Ce.TEXTURE_2D,Ae.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ae.extTextureFilterAnisotropicMax);const sn=D.style.map.terrain&&D.style.map.terrain.getTerrainData(jt),Hr=Ze.getProjectionData({overscaledTileID:jt,aligned:dt,applyGlobeMatrix:!le,applyTerrainMatrix:!0}),pn=In(xr,yr,nn.fadeMix,g,Y),Ti=ht.getMeshFromTileID(Ae,jt.canonical,L,z,"raster");Ue.draw(Ae,Ce.TRIANGLES,Dt,C?C[jt.overscaledZ]:ai.disabled,pt,re?ii.frontCCW:ii.backCCW,pn,sn,Hr,g.id,Ti.vertexBuffer,Ti.indexBuffer,Ti.segments)}}function Xg(D,u,g,w){const C={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(g===0||w)return C;if(D.fadingParentID){const L=u.getLoadedTile(D.fadingParentID);if(!L)return C;const z=Math.pow(2,L.tileID.overscaledZ-D.tileID.overscaledZ),Y=[D.tileID.canonical.x*z%1,D.tileID.canonical.y*z%1],re=(function(le,he,Ae){const Ce=T(),Ue=(Ce-he.timeAdded)/Ae,Ze=le.fadingDirection===ct.Incoming,ht=o.an((Ce-le.timeAdded)/Ae,0,1),pt=o.an(1-Ue,0,1),dt=Ze?ht:pt;return{tileOpacity:dt,parentTileOpacity:Ze?pt:ht,fadeMix:{opacity:1,mix:1-dt}}})(D,L,g);return{parentTile:L,parentScaleBy:z,parentTopLeft:Y,fadeValues:re}}if(D.selfFading){const L=(function(z,Y){const re=(T()-z.timeAdded)/Y,le=o.an(re,0,1);return{tileOpacity:le,fadeMix:{opacity:le,mix:0}}})(D,g);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:L}}return C}const Ny=new o.bp(1,0,0,1),Fd=new o.bp(0,1,0,1),Bd=new o.bp(0,0,1,1),zh=new o.bp(1,0,1,1),wc=new o.bp(0,1,1,1);function Yg(D,u,g,w){zd(D,0,u+g/2,D.transform.width,g,w)}function Bp(D,u,g,w){zd(D,u-g/2,0,g,D.transform.height,w)}function zd(D,u,g,w,C,L){const z=D.context,Y=z.gl;Y.enable(Y.SCISSOR_TEST),Y.scissor(u*D.pixelRatio,g*D.pixelRatio,w*D.pixelRatio,C*D.pixelRatio),z.clear({color:L}),Y.disable(Y.SCISSOR_TEST)}function Fy(D,u,g){const w=D.context,C=w.gl,L=D.useProgram("debug"),z=ri.disabled,Y=ai.disabled,re=D.colorModeForRenderPass(),le="$debug",he=D.style.map.terrain&&D.style.map.terrain.getTerrainData(g);w.activeTexture.set(C.TEXTURE0);const Ae=u.getTileByID(g.key).latestRawTileData,Ce=Math.floor((Ae&&Ae.byteLength||0)/1024),Ue=u.getTile(g).tileSize,Ze=512/Math.min(Ue,512)*(g.overscaledZ/D.transform.zoom)*.5;let ht=g.canonical.toString();g.overscaledZ!==g.canonical.z&&(ht+=` => ${g.overscaledZ}`),(function(dt,xt){dt.initDebugOverlayCanvas();const Ot=dt.debugOverlayCanvas,wt=dt.context.gl,Lt=dt.debugOverlayCanvas.getContext("2d");Lt.clearRect(0,0,Ot.width,Ot.height),Lt.shadowColor="white",Lt.shadowBlur=2,Lt.lineWidth=1.5,Lt.strokeStyle="white",Lt.textBaseline="top",Lt.font="bold 36px Open Sans, sans-serif",Lt.fillText(xt,5,5),Lt.strokeText(xt,5,5),dt.debugOverlayTexture.update(Ot),dt.debugOverlayTexture.bind(wt.LINEAR,wt.CLAMP_TO_EDGE)})(D,`${ht} ${Ce}kB`);const pt=D.transform.getProjectionData({overscaledTileID:g,applyGlobeMatrix:!0,applyTerrainMatrix:!0});L.draw(w,C.TRIANGLES,z,Y,ji.alphaBlended,ii.disabled,Ks(o.bp.transparent,Ze),null,pt,le,D.debugBuffer,D.quadTriangleIndexBuffer,D.debugSegments),L.draw(w,C.LINE_STRIP,z,Y,re,ii.disabled,Ks(o.bp.red),he,pt,le,D.debugBuffer,D.tileBorderIndexBuffer,D.debugSegments)}function Zg(D,u,g,w){const{isRenderingGlobe:C}=w,L=D.context,z=L.gl,Y=D.transform,re=D.colorModeForRenderPass(),le=D.getDepthModeFor3D(),he=D.useProgram("terrain");L.bindFramebuffer.set(null),L.viewport.set([0,0,D.width,D.height]);for(const Ae of g){const Ce=u.getTerrainMesh(Ae.tileID),Ue=D.renderToTexture.getTexture(Ae),Ze=u.getTerrainData(Ae.tileID);L.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,Ue.texture);const ht=u.getMeshFrameDelta(Y.zoom),pt=Y.calculateFogMatrix(Ae.tileID.toUnwrapped()),dt=uu(ht,pt,D.style.sky,Y.pitch,C),xt=Y.getProjectionData({overscaledTileID:Ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});he.draw(L,z.TRIANGLES,le,ai.disabled,re,ii.backCCW,dt,Ze,xt,"terrain",Ce.vertexBuffer,Ce.indexBuffer,Ce.segments)}}function Kg(D,u){if(!u.mesh){const g=new o.aW;g.emplaceBack(-1,-1),g.emplaceBack(1,-1),g.emplaceBack(1,1),g.emplaceBack(-1,1);const w=new o.aY;w.emplaceBack(0,1,2),w.emplaceBack(0,2,3),u.mesh=new fi(D.createVertexBuffer(g,$i.members),D.createIndexBuffer(w),o.aX.simpleSegment(0,0,g.length,w.length))}return u.mesh}class By{constructor(u,g){this.context=new Lp(u),this.transform=g,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ci.maxOverzooming+Ci.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _n}resize(u,g,w){if(this.width=Math.floor(u*w),this.height=Math.floor(g*w),this.pixelRatio=w,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style._order)this.style._layers[C].resize()}setup(){const u=this.context,g=new o.aW;g.emplaceBack(0,0),g.emplaceBack(o.a5,0),g.emplaceBack(0,o.a5),g.emplaceBack(o.a5,o.a5),this.tileExtentBuffer=u.createVertexBuffer(g,$i.members),this.tileExtentSegments=o.aX.simpleSegment(0,0,4,2);const w=new o.aW;w.emplaceBack(0,0),w.emplaceBack(o.a5,0),w.emplaceBack(0,o.a5),w.emplaceBack(o.a5,o.a5),this.debugBuffer=u.createVertexBuffer(w,$i.members),this.debugSegments=o.aX.simpleSegment(0,0,4,5);const C=new o.ch;C.emplaceBack(0,0,0,0),C.emplaceBack(o.a5,0,o.a5,0),C.emplaceBack(0,o.a5,0,o.a5),C.emplaceBack(o.a5,o.a5,o.a5,o.a5),this.rasterBoundsBuffer=u.createVertexBuffer(C,Ja.members),this.rasterBoundsSegments=o.aX.simpleSegment(0,0,4,2);const L=new o.aW;L.emplaceBack(0,0),L.emplaceBack(o.a5,0),L.emplaceBack(0,o.a5),L.emplaceBack(o.a5,o.a5),this.rasterBoundsBufferPosOnly=u.createVertexBuffer(L,$i.members),this.rasterBoundsSegmentsPosOnly=o.aX.simpleSegment(0,0,4,5);const z=new o.aW;z.emplaceBack(0,0),z.emplaceBack(1,0),z.emplaceBack(0,1),z.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(z,$i.members),this.viewportSegments=o.aX.simpleSegment(0,0,4,2);const Y=new o.ci;Y.emplaceBack(0),Y.emplaceBack(1),Y.emplaceBack(3),Y.emplaceBack(2),Y.emplaceBack(0),this.tileBorderIndexBuffer=u.createIndexBuffer(Y);const re=new o.aY;re.emplaceBack(1,0,2),re.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(re);const le=this.context.gl;this.stencilClearMode=new ai({func:le.ALWAYS,mask:0},0,255,le.ZERO,le.ZERO,le.ZERO),this.tileExtentMesh=new fi(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const u=this.context,g=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const w=o.N();o.c7(w,0,this.width,this.height,0,0,1),o.Q(w,w,[g.drawingBufferWidth,g.drawingBufferHeight,0]);const C={mainMatrix:w,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w};this.useProgram("clippingMask",null,!0).draw(u,g.TRIANGLES,ri.disabled,this.stencilClearMode,ji.disabled,ii.disabled,null,null,C,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(u,g,w){if(this.currentStencilSource===u.source||!u.isTileClipped()||!g||!g.length)return;this.currentStencilSource=u.source,this.nextStencilID+g.length>256&&this.clearStencil();const C=this.context;C.setColorMode(ji.disabled),C.setDepthMode(ri.disabled);const L={};for(const z of g)L[z.key]=this.nextStencilID++;this._renderTileMasks(L,g,w,!0),this._renderTileMasks(L,g,w,!1),this._tileClippingMaskIDs=L}_renderTileMasks(u,g,w,C){const L=this.context,z=L.gl,Y=this.style.projection,re=this.transform,le=this.useProgram("clippingMask");for(const he of g){const Ae=u[he.key],Ce=this.style.map.terrain&&this.style.map.terrain.getTerrainData(he),Ue=Y.getMeshFromTileID(this.context,he.canonical,C,!0,"stencil"),Ze=re.getProjectionData({overscaledTileID:he,applyGlobeMatrix:!w,applyTerrainMatrix:!0});le.draw(L,z.TRIANGLES,ri.disabled,new ai({func:z.ALWAYS,mask:0},Ae,255,z.KEEP,z.KEEP,z.REPLACE),ji.disabled,w?ii.disabled:ii.backCCW,null,Ce,Ze,"$clipping",Ue.vertexBuffer,Ue.indexBuffer,Ue.segments)}}_renderTilesDepthBuffer(){const u=this.context,g=u.gl,w=this.style.projection,C=this.transform,L=this.useProgram("depth"),z=this.getDepthModeFor3D(),Y=Kn(C,{tileSize:C.tileSize});for(const re of Y){const le=this.style.map.terrain&&this.style.map.terrain.getTerrainData(re),he=w.getMeshFromTileID(this.context,re.canonical,!0,!0,"raster"),Ae=C.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!0,applyTerrainMatrix:!0});L.draw(u,g.TRIANGLES,z,ai.disabled,ji.disabled,ii.backCCW,null,le,Ae,"$clipping",he.vertexBuffer,he.indexBuffer,he.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const u=this.nextStencilID++,g=this.context.gl;return new ai({func:g.NOTEQUAL,mask:255},u,255,g.KEEP,g.KEEP,g.REPLACE)}stencilModeForClipping(u){const g=this.context.gl;return new ai({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,g.KEEP,g.KEEP,g.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(u){const g=this.context.gl,w=u.sort(((z,Y)=>Y.overscaledZ-z.overscaledZ)),C=w[w.length-1].overscaledZ,L=w[0].overscaledZ-C+1;if(L>1){this.currentStencilSource=void 0,this.nextStencilID+L>256&&this.clearStencil();const z={};for(let Y=0;Y<L;Y++)z[Y+C]=new ai({func:g.GEQUAL,mask:255},Y+this.nextStencilID,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID+=L,[z,w]}return[{[C]:ai.disabled},w]}stencilConfigForOverlapTwoPass(u){const g=this.context.gl,w=u.sort(((z,Y)=>Y.overscaledZ-z.overscaledZ)),C=w[w.length-1].overscaledZ,L=w[0].overscaledZ-C+1;if(this.clearStencil(),L>1){const z={},Y={};for(let re=0;re<L;re++)z[re+C]=new ai({func:g.GREATER,mask:255},L+1+re,255,g.KEEP,g.KEEP,g.REPLACE),Y[re+C]=new ai({func:g.GREATER,mask:255},1+re,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID=2*L+1,[z,Y,w]}return this.nextStencilID=3,[{[C]:new ai({func:g.GREATER,mask:255},2,255,g.KEEP,g.KEEP,g.REPLACE)},{[C]:new ai({func:g.GREATER,mask:255},1,255,g.KEEP,g.KEEP,g.REPLACE)},w]}colorModeForRenderPass(){const u=this.context.gl;return this._showOverdrawInspector?new ji([u.CONSTANT_COLOR,u.ONE],new o.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ji.unblended:ji.alphaBlended}getDepthModeForSublayer(u,g,w){if(!this.opaquePassEnabledForLayer())return ri.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new ri(w||this.context.gl.LEQUAL,g,[C,C])}getDepthModeFor3D(){return new ri(this.context.gl.LEQUAL,ri.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(u,g){var w,C;this.style=u,this.options=g,this.lineAtlas=u.lineAtlas,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(T()),this.imageManager.beginFrame();const L=this.style._order,z=this.style.tileManagers,Y={},re={},le={},he={isRenderingToTexture:!1,isRenderingGlobe:((w=u.projection)===null||w===void 0?void 0:w.transitionState)>0};for(const Ce in z){const Ue=z[Ce];Ue.used&&Ue.prepare(this.context),Y[Ce]=Ue.getVisibleCoordinates(!1),re[Ce]=Y[Ce].slice().reverse(),le[Ce]=Ue.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Ce=0;Ce<L.length;Ce++)if(this.style._layers[L[Ce]].is3D()){this.opaquePassCutoff=Ce;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Ce of L){const Ue=this.style._layers[Ce];if(!Ue.hasOffscreenPass()||Ue.isHidden(this.transform.zoom))continue;const Ze=re[Ue.source];(Ue.type==="custom"||Ze.length)&&this.renderLayer(this,z[Ue.source],Ue,Ze,he)}if((C=this.style.projection)===null||C===void 0||C.updateGPUdependent({context:this.context,useProgram:Ce=>this.useProgram(Ce)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:g.showOverdrawInspector?o.bp.black:o.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(Ce,Ue){const Ze=Ce.context,ht=Ze.gl,pt=((jt,Dt,Yt)=>{const Sr=Math.cos(Dt.rollInRadians),dr=Math.sin(Dt.rollInRadians),yr=cn(Dt),xr=Dt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:jt.properties.get("sky-color"),u_horizon_color:jt.properties.get("horizon-color"),u_horizon:[(Dt.width/2-yr*dr)*Yt,(Dt.height/2+yr*Sr)*Yt],u_horizon_normal:[-dr,Sr],u_sky_horizon_blend:jt.properties.get("sky-horizon-blend")*Dt.height/2*Yt,u_sky_blend:xr}})(Ue,Ce.style.map.transform,Ce.pixelRatio),dt=new ri(ht.LEQUAL,ri.ReadWrite,[0,1]),xt=ai.disabled,Ot=Ce.colorModeForRenderPass(),wt=Ce.useProgram("sky"),Lt=Kg(Ze,Ue);wt.draw(Ze,ht.TRIANGLES,dt,xt,Ot,ii.disabled,pt,null,void 0,"sky",Lt.vertexBuffer,Lt.indexBuffer,Lt.segments)})(this,this.style.sky),this._showOverdrawInspector=g.showOverdrawInspector,this.depthRangeFor3D=[0,1-(u._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=L.length-1;this.currentLayer>=0;this.currentLayer--){const Ce=this.style._layers[L[this.currentLayer]],Ue=z[Ce.source],Ze=Y[Ce.source];this._renderTileClippingMasks(Ce,Ze,!1),this.renderLayer(this,Ue,Ce,Ze,he)}this.renderPass="translucent";let Ae=!1;for(this.currentLayer=0;this.currentLayer<L.length;this.currentLayer++){const Ce=this.style._layers[L[this.currentLayer]],Ue=z[Ce.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Ce,he))continue;this.opaquePassEnabledForLayer()||Ae||(Ae=!0,he.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Ze=(Ce.type==="symbol"?le:re)[Ce.source];this._renderTileClippingMasks(Ce,Y[Ce.source],!!this.renderToTexture),this.renderLayer(this,Ue,Ce,Ze,he)}if(he.isRenderingGlobe&&(function(Ce,Ue,Ze){const ht=Ce.context,pt=ht.gl,dt=Ce.useProgram("atmosphere"),xt=new ri(pt.LEQUAL,ri.ReadOnly,[0,1]),Ot=Ce.transform,wt=(function(xr,nn){const sn=xr.properties.get("position"),Hr=[-sn.x,-sn.y,-sn.z],pn=o.ar(new Float64Array(16));return xr.properties.get("anchor")==="map"&&(o.bg(pn,pn,nn.rollInRadians),o.bh(pn,pn,-nn.pitchInRadians),o.bg(pn,pn,nn.bearingInRadians),o.bh(pn,pn,nn.center.lat*Math.PI/180),o.bJ(pn,pn,-nn.center.lng*Math.PI/180)),o.cg(Hr,Hr,pn),Hr})(Ze,Ce.transform),Lt=Ot.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),jt=Ue.properties.get("atmosphere-blend")*Lt.projectionTransition;if(jt===0)return;const Dt=Ui(Ot.worldSize,Ot.center.lat),Yt=Ot.inverseProjectionMatrix,Sr=new Float64Array(4);Sr[3]=1,o.aH(Sr,Sr,Ot.modelViewProjectionMatrix),Sr[0]/=Sr[3],Sr[1]/=Sr[3],Sr[2]/=Sr[3],Sr[3]=1,o.aH(Sr,Sr,Yt),Sr[0]/=Sr[3],Sr[1]/=Sr[3],Sr[2]/=Sr[3],Sr[3]=1;const dr=((xr,nn,sn,Hr,pn)=>({u_sun_pos:xr,u_atmosphere_blend:nn,u_globe_position:sn,u_globe_radius:Hr,u_inv_proj_matrix:pn}))(wt,jt,[Sr[0],Sr[1],Sr[2]],Dt,Yt),yr=Kg(ht,Ue);dt.draw(ht,pt.TRIANGLES,xt,ai.disabled,ji.alphaBlended,ii.disabled,dr,null,null,"atmosphere",yr.vertexBuffer,yr.indexBuffer,yr.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Ce=(function(Ue,Ze){let ht=null;const pt=Object.values(Ue._layers).flatMap((wt=>wt.source&&!wt.isHidden(Ze)?[Ue.tileManagers[wt.source]]:[])),dt=pt.filter((wt=>wt.getSource().type==="vector")),xt=pt.filter((wt=>wt.getSource().type!=="vector")),Ot=wt=>{(!ht||ht.getSource().maxzoom<wt.getSource().maxzoom)&&(ht=wt)};return dt.forEach((wt=>Ot(wt))),ht||xt.forEach((wt=>Ot(wt))),ht})(this.style,this.transform.zoom);Ce&&(function(Ue,Ze,ht){for(let pt=0;pt<ht.length;pt++)Fy(Ue,Ze,ht[pt])})(this,Ce,Ce.getVisibleCoordinates())}this.options.showPadding&&(function(Ce){const Ue=Ce.transform.padding;Yg(Ce,Ce.transform.height-(Ue.top||0),3,Ny),Yg(Ce,Ue.bottom||0,3,Fd),Bp(Ce,Ue.left||0,3,Bd),Bp(Ce,Ce.transform.width-(Ue.right||0),3,zh);const Ze=Ce.transform.centerPoint;(function(ht,pt,dt,xt){zd(ht,pt-1,dt-10,2,20,xt),zd(ht,pt-10,dt-1,20,2,xt)})(Ce,Ze.x,Ce.transform.height-Ze.y,wc)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(u){if(!this.style||!this.style.map||!this.style.map.terrain)return;const g=this.terrainFacilitator.matrix,w=this.transform.modelViewProjectionMatrix;let C=this.terrainFacilitator.dirty;C||(C=u?!o.cj(g,w):!o.ck(g,w)),C||(C=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),C&&(o.cl(g,w),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(L,z){const Y=L.context,re=Y.gl,le=L.transform,he=ji.unblended,Ae=new ri(re.LEQUAL,ri.ReadWrite,[0,1]),Ce=z.tileManager.getRenderableTiles(),Ue=L.useProgram("terrainDepth");Y.bindFramebuffer.set(z.getFramebuffer("depth").framebuffer),Y.viewport.set([0,0,L.width/devicePixelRatio,L.height/devicePixelRatio]),Y.clear({color:o.bp.transparent,depth:1});for(const Ze of Ce){const ht=z.getTerrainMesh(Ze.tileID),pt=z.getTerrainData(Ze.tileID),dt=le.getProjectionData({overscaledTileID:Ze.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),xt={u_ele_delta:z.getMeshFrameDelta(le.zoom)};Ue.draw(Y,re.TRIANGLES,Ae,ai.disabled,he,ii.backCCW,xt,pt,dt,"terrain",ht.vertexBuffer,ht.indexBuffer,ht.segments)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,L.width,L.height])})(this,this.style.map.terrain),(function(L,z){const Y=L.context,re=Y.gl,le=L.transform,he=ji.unblended,Ae=new ri(re.LEQUAL,ri.ReadWrite,[0,1]),Ce=z.getCoordsTexture(),Ue=z.tileManager.getRenderableTiles(),Ze=L.useProgram("terrainCoords");Y.bindFramebuffer.set(z.getFramebuffer("coords").framebuffer),Y.viewport.set([0,0,L.width/devicePixelRatio,L.height/devicePixelRatio]),Y.clear({color:o.bp.transparent,depth:1}),z.coordsIndex=[];for(const ht of Ue){const pt=z.getTerrainMesh(ht.tileID),dt=z.getTerrainData(ht.tileID);Y.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_2D,Ce.texture);const xt={u_terrain_coords_id:(255-z.coordsIndex.length)/255,u_texture:0,u_ele_delta:z.getMeshFrameDelta(le.zoom)},Ot=le.getProjectionData({overscaledTileID:ht.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Ze.draw(Y,re.TRIANGLES,Ae,ai.disabled,he,ii.backCCW,xt,dt,Ot,"terrain",pt.vertexBuffer,pt.indexBuffer,pt.segments),z.coordsIndex.push(ht.tileID.key)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,L.width,L.height])})(this,this.style.map.terrain))}renderLayer(u,g,w,C,L){w.isHidden(this.transform.zoom)||(w.type==="background"||w.type==="custom"||(C||[]).length)&&(this.id=w.id,o.cm(w)?(function(z,Y,re,le,he,Ae){if(z.renderPass!=="translucent")return;const{isRenderingToTexture:Ce}=Ae,Ue=ai.disabled,Ze=z.colorModeForRenderPass();(re._unevaluatedLayout.hasValue("text-variable-anchor")||re._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(ht,pt,dt,xt,Ot,wt,Lt,jt,Dt){const Yt=pt.transform,Sr=pt.style.map.terrain,dr=Ot==="map",yr=wt==="map";for(const xr of ht){const nn=xt.getTile(xr),sn=nn.getBucket(dt);if(!sn||!sn.text||!sn.text.segments.get().length)continue;const Hr=o.ay(sn.textSizeData,Yt.zoom),pn=o.aN(nn,1,pt.transform.zoom),Ti=ei(dr,pt.transform,pn),ka=dt.layout.get("icon-text-fit")!=="none"&&sn.hasIconData();if(Hr){const yo=Math.pow(2,Yt.zoom-nn.tileID.overscaledZ),to=Sr?(Io,ro)=>Sr.getElevation(xr,Io,ro):null;Dd(sn,dr,yr,Dt,Yt,Ti,yo,Hr,ka,o.aO(Yt,nn,Lt,jt),xr.toUnwrapped(),to)}}})(le,z,re,Y,re.layout.get("text-rotation-alignment"),re.layout.get("text-pitch-alignment"),re.paint.get("text-translate"),re.paint.get("text-translate-anchor"),he),re.paint.get("icon-opacity").constantOr(1)!==0&&Od(z,Y,re,le,!1,re.paint.get("icon-translate"),re.paint.get("icon-translate-anchor"),re.layout.get("icon-rotation-alignment"),re.layout.get("icon-pitch-alignment"),re.layout.get("icon-keep-upright"),Ue,Ze,Ce),re.paint.get("text-opacity").constantOr(1)!==0&&Od(z,Y,re,le,!0,re.paint.get("text-translate"),re.paint.get("text-translate-anchor"),re.layout.get("text-rotation-alignment"),re.layout.get("text-pitch-alignment"),re.layout.get("text-keep-upright"),Ue,Ze,Ce),Y.map.showCollisionBoxes&&(rh(z,Y,re,le,!0),rh(z,Y,re,le,!1))})(u,g,w,C,this.style.placement.variableOffsets,L):o.cn(w)?(function(z,Y,re,le,he){if(z.renderPass!=="translucent")return;const{isRenderingToTexture:Ae}=he,Ce=re.paint.get("circle-opacity"),Ue=re.paint.get("circle-stroke-width"),Ze=re.paint.get("circle-stroke-opacity"),ht=!re.layout.get("circle-sort-key").isConstant();if(Ce.constantOr(1)===0&&(Ue.constantOr(1)===0||Ze.constantOr(1)===0))return;const pt=z.context,dt=pt.gl,xt=z.transform,Ot=z.getDepthModeForSublayer(0,ri.ReadOnly),wt=ai.disabled,Lt=z.colorModeForRenderPass(),jt=[],Dt=xt.getCircleRadiusCorrection();for(let Yt=0;Yt<le.length;Yt++){const Sr=le[Yt],dr=Y.getTile(Sr),yr=dr.getBucket(re);if(!yr)continue;const xr=re.paint.get("circle-translate"),nn=re.paint.get("circle-translate-anchor"),sn=o.aO(xt,dr,xr,nn),Hr=yr.programConfigurations.get(re.id),pn=z.useProgram("circle",Hr),Ti=yr.layoutVertexBuffer,ka=yr.indexBuffer,yo=z.style.map.terrain&&z.style.map.terrain.getTerrainData(Sr),to={programConfiguration:Hr,program:pn,layoutVertexBuffer:Ti,indexBuffer:ka,uniformValues:Du(z,dr,re,sn,Dt),terrainData:yo,projectionData:xt.getProjectionData({overscaledTileID:Sr,applyGlobeMatrix:!Ae,applyTerrainMatrix:!0})};if(ht){const Io=yr.segments.get();for(const ro of Io)jt.push({segments:new o.aX([ro]),sortKey:ro.sortKey,state:to})}else jt.push({segments:yr.segments,sortKey:0,state:to})}ht&&jt.sort(((Yt,Sr)=>Yt.sortKey-Sr.sortKey));for(const Yt of jt){const{programConfiguration:Sr,program:dr,layoutVertexBuffer:yr,indexBuffer:xr,uniformValues:nn,terrainData:sn,projectionData:Hr}=Yt.state;dr.draw(pt,dt.TRIANGLES,Ot,wt,Lt,ii.backCCW,nn,sn,Hr,re.id,yr,xr,Yt.segments,re.paint,z.transform.zoom,Sr)}})(u,g,w,C,L):o.co(w)?(function(z,Y,re,le,he){if(re.paint.get("heatmap-opacity")===0)return;const Ae=z.context,{isRenderingToTexture:Ce,isRenderingGlobe:Ue}=he;if(z.style.map.terrain){for(const Ze of le){const ht=Y.getTile(Ze);Y.hasRenderableParent(Ze)||(z.renderPass==="offscreen"?Oy(z,ht,re,Ze,Ue):z.renderPass==="translucent"&&Ly(z,re,Ze,Ce,Ue))}Ae.viewport.set([0,0,z.width,z.height])}else z.renderPass==="offscreen"?(function(Ze,ht,pt,dt){const xt=Ze.context,Ot=xt.gl,wt=Ze.transform,Lt=ai.disabled,jt=new ji([Ot.ONE,Ot.ONE],o.bp.transparent,[!0,!0,!0,!0]);(function(Dt,Yt,Sr){const dr=Dt.gl;Dt.activeTexture.set(dr.TEXTURE1),Dt.viewport.set([0,0,Yt.width/4,Yt.height/4]);let yr=Sr.heatmapFbos.get(o.cd);yr?(dr.bindTexture(dr.TEXTURE_2D,yr.colorAttachment.get()),Dt.bindFramebuffer.set(yr.framebuffer)):(yr=Nd(Dt,Yt.width/4,Yt.height/4),Sr.heatmapFbos.set(o.cd,yr))})(xt,Ze,pt),xt.clear({color:o.bp.transparent});for(let Dt=0;Dt<dt.length;Dt++){const Yt=dt[Dt];if(ht.hasRenderableParent(Yt))continue;const Sr=ht.getTile(Yt),dr=Sr.getBucket(pt);if(!dr)continue;const yr=dr.programConfigurations.get(pt.id),xr=Ze.useProgram("heatmap",yr),nn=wt.getProjectionData({overscaledTileID:Yt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),sn=wt.getCircleRadiusCorrection();xr.draw(xt,Ot.TRIANGLES,ri.disabled,Lt,jt,ii.backCCW,ys(Sr,wt.zoom,pt.paint.get("heatmap-intensity"),sn),null,nn,pt.id,dr.layoutVertexBuffer,dr.indexBuffer,dr.segments,pt.paint,wt.zoom,yr)}xt.viewport.set([0,0,Ze.width,Ze.height])})(z,Y,re,le):z.renderPass==="translucent"&&(function(Ze,ht){const pt=Ze.context,dt=pt.gl;pt.setColorMode(Ze.colorModeForRenderPass());const xt=ht.heatmapFbos.get(o.cd);xt&&(pt.activeTexture.set(dt.TEXTURE0),dt.bindTexture(dt.TEXTURE_2D,xt.colorAttachment.get()),pt.activeTexture.set(dt.TEXTURE1),Np(pt,ht).bind(dt.LINEAR,dt.CLAMP_TO_EDGE),Ze.useProgram("heatmapTexture").draw(pt,dt.TRIANGLES,ri.disabled,ai.disabled,Ze.colorModeForRenderPass(),ii.disabled,Va(Ze,ht,0,1),null,null,ht.id,Ze.viewportBuffer,Ze.quadTriangleIndexBuffer,Ze.viewportSegments,ht.paint,Ze.transform.zoom))})(z,re)})(u,g,w,C,L):o.cp(w)?(function(z,Y,re,le,he){if(z.renderPass!=="translucent")return;const{isRenderingToTexture:Ae}=he,Ce=re.paint.get("line-opacity"),Ue=re.paint.get("line-width");if(Ce.constantOr(1)===0||Ue.constantOr(1)===0)return;const Ze=z.getDepthModeForSublayer(0,ri.ReadOnly),ht=z.colorModeForRenderPass(),pt=re.paint.get("line-dasharray"),dt=pt.constantOr(1),xt=re.paint.get("line-pattern"),Ot=xt.constantOr(1),wt=re.paint.get("line-gradient"),Lt=re.getCrossfadeParameters();let jt;jt=Ot?"linePattern":dt&&wt?"lineGradientSDF":dt?"lineSDF":wt?"lineGradient":"line";const Dt=z.context,Yt=Dt.gl,Sr=z.transform;let dr=!0;for(const yr of le){const xr=Y.getTile(yr);if(Ot&&!xr.patternsLoaded())continue;const nn=xr.getBucket(re);if(!nn)continue;const sn=nn.programConfigurations.get(re.id),Hr=z.context.program.get(),pn=z.useProgram(jt,sn),Ti=dr||pn.program!==Hr,ka=z.style.map.terrain&&z.style.map.terrain.getTerrainData(yr),yo=xt.constantOr(null),to=pt&&pt.constantOr(null);if(yo&&xr.imageAtlas){const gl=xr.imageAtlas,_s=gl.patternPositions[yo.to.toString()],os=gl.patternPositions[yo.from.toString()];_s&&os&&sn.setConstantPatternPositions(_s,os)}else if(to){const gl=re.layout.get("line-cap")==="round",_s=z.lineAtlas.getDash(to.to,gl),os=z.lineAtlas.getDash(to.from,gl);sn.setConstantDashPositions(_s,os)}const Io=Sr.getProjectionData({overscaledTileID:yr,applyGlobeMatrix:!Ae,applyTerrainMatrix:!0}),ro=Sr.getPixelScale();let Xo;Ot?(Xo=Hl(z,xr,re,ro,Lt),Nu(Dt,Yt,xr,sn,Lt)):dt&&wt?(Xo=tr(z,xr,re,ro,Lt,nn.lineClipsArray.length),Xl(z,Y,Dt,Yt,re,nn,yr,sn,Lt)):dt?(Xo=Ou(z,xr,re,ro,Lt),xa(z,Dt,Yt,sn,Ti,Lt)):wt?(Xo=dl(z,xr,re,ro,nn.lineClipsArray.length),ih(z,Y,Dt,Yt,re,nn,yr)):Xo=ql(z,xr,re,ro);const Po=z.stencilModeForClipping(yr);pn.draw(Dt,Yt.TRIANGLES,Ze,Po,ht,ii.disabled,Xo,ka,Io,re.id,nn.layoutVertexBuffer,nn.indexBuffer,nn.segments,re.paint,z.transform.zoom,sn,nn.layoutVertexBuffer2),dr=!1}})(u,g,w,C,L):o.cq(w)?(function(z,Y,re,le,he){const Ae=re.paint.get("fill-color"),Ce=re.paint.get("fill-opacity");if(Ce.constantOr(1)===0)return;const{isRenderingToTexture:Ue}=he,Ze=z.colorModeForRenderPass(),ht=re.paint.get("fill-pattern"),pt=z.opaquePassEnabledForLayer()&&!ht.constantOr(1)&&Ae.constantOr(o.bp.transparent).a===1&&Ce.constantOr(0)===1?"opaque":"translucent";if(z.renderPass===pt){const dt=z.getDepthModeForSublayer(1,z.renderPass==="opaque"?ri.ReadWrite:ri.ReadOnly);pl(z,Y,re,le,dt,Ze,!1,Ue)}if(z.renderPass==="translucent"&&re.paint.get("fill-antialias")){const dt=z.getDepthModeForSublayer(re.getPaintProperty("fill-outline-color")?2:0,ri.ReadOnly);pl(z,Y,re,le,dt,Ze,!0,Ue)}})(u,g,w,C,L):o.cr(w)?(function(z,Y,re,le,he){const Ae=re.paint.get("fill-extrusion-opacity");if(Ae===0)return;const{isRenderingToTexture:Ce}=he;if(z.renderPass==="translucent"){const Ue=new ri(z.context.gl.LEQUAL,ri.ReadWrite,z.depthRangeFor3D);if(Ae!==1||re.paint.get("fill-extrusion-pattern").constantOr(1))Fp(z,Y,re,le,Ue,ai.disabled,ji.disabled,Ce),Fp(z,Y,re,le,Ue,z.stencilModeFor3D(),z.colorModeForRenderPass(),Ce);else{const Ze=z.colorModeForRenderPass();Fp(z,Y,re,le,Ue,ai.disabled,Ze,Ce)}}})(u,g,w,C,L):o.cs(w)?(function(z,Y,re,le,he){if(z.renderPass!=="offscreen"&&z.renderPass!=="translucent")return;const{isRenderingToTexture:Ae}=he,Ce=z.context,Ue=z.style.projection.useSubdivision,Ze=z.getDepthModeForSublayer(0,ri.ReadOnly),ht=z.colorModeForRenderPass();if(z.renderPass==="offscreen")(function(pt,dt,xt,Ot,wt,Lt,jt){const Dt=pt.context,Yt=Dt.gl;for(const Sr of xt){const dr=dt.getTile(Sr),yr=dr.dem;if(!yr||!yr.data||!dr.needsHillshadePrepare)continue;const xr=yr.dim,nn=yr.stride,sn=yr.getPixels();if(Dt.activeTexture.set(Yt.TEXTURE1),Dt.pixelStoreUnpackPremultiplyAlpha.set(!1),dr.demTexture=dr.demTexture||pt.getTileTexture(nn),dr.demTexture){const pn=dr.demTexture;pn.update(sn,{premultiply:!1}),pn.bind(Yt.NEAREST,Yt.CLAMP_TO_EDGE)}else dr.demTexture=new o.T(Dt,sn,Yt.RGBA,{premultiply:!1}),dr.demTexture.bind(Yt.NEAREST,Yt.CLAMP_TO_EDGE);Dt.activeTexture.set(Yt.TEXTURE0);let Hr=dr.fbo;if(!Hr){const pn=new o.T(Dt,{width:xr,height:xr,data:null},Yt.RGBA);pn.bind(Yt.LINEAR,Yt.CLAMP_TO_EDGE),Hr=dr.fbo=Dt.createFramebuffer(xr,xr,!0,!1),Hr.colorAttachment.set(pn.texture)}Dt.bindFramebuffer.set(Hr.framebuffer),Dt.viewport.set([0,0,xr,xr]),pt.useProgram("hillshadePrepare").draw(Dt,Yt.TRIANGLES,wt,Lt,jt,ii.disabled,fl(dr.tileID,yr),null,null,Ot.id,pt.rasterBoundsBuffer,pt.quadTriangleIndexBuffer,pt.rasterBoundsSegments),dr.needsHillshadePrepare=!1}})(z,Y,le,re,Ze,ai.disabled,ht),Ce.viewport.set([0,0,z.width,z.height]);else if(z.renderPass==="translucent")if(Ue){const[pt,dt,xt]=z.stencilConfigForOverlapTwoPass(le);_f(z,Y,re,xt,pt,Ze,ht,!1,Ae),_f(z,Y,re,xt,dt,Ze,ht,!0,Ae)}else{const[pt,dt]=z.getStencilConfigForOverlapAndUpdateStencilID(le);_f(z,Y,re,dt,pt,Ze,ht,!1,Ae)}})(u,g,w,C,L):o.ct(w)?(function(z,Y,re,le,he){if(z.renderPass!=="translucent"||!le.length)return;const{isRenderingToTexture:Ae}=he,Ce=z.style.projection.useSubdivision,Ue=z.getDepthModeForSublayer(0,ri.ReadOnly),Ze=z.colorModeForRenderPass();if(Ce){const[ht,pt,dt]=z.stencilConfigForOverlapTwoPass(le);Bh(z,Y,re,dt,ht,Ue,Ze,!1,Ae),Bh(z,Y,re,dt,pt,Ue,Ze,!0,Ae)}else{const[ht,pt]=z.getStencilConfigForOverlapAndUpdateStencilID(le);Bh(z,Y,re,pt,ht,Ue,Ze,!1,Ae)}})(u,g,w,C,L):o.bU(w)?(function(z,Y,re,le,he){if(z.renderPass!=="translucent"||re.paint.get("raster-opacity")===0||!le.length)return;const{isRenderingToTexture:Ae}=he,Ce=Y.getSource(),Ue=z.style.projection.useSubdivision;if(Ce instanceof Qt)ah(z,Y,re,le,null,!1,!1,Ce.tileCoords,Ce.flippedWindingOrder,Ae);else if(Ue){const[Ze,ht,pt]=z.stencilConfigForOverlapTwoPass(le);ah(z,Y,re,pt,Ze,!1,!0,bf,!1,Ae),ah(z,Y,re,pt,ht,!0,!0,bf,!1,Ae)}else{const[Ze,ht]=z.getStencilConfigForOverlapAndUpdateStencilID(le);ah(z,Y,re,ht,Ze,!1,!0,bf,!1,Ae)}})(u,g,w,C,L):o.cu(w)?(function(z,Y,re,le,he){const Ae=re.paint.get("background-color"),Ce=re.paint.get("background-opacity");if(Ce===0)return;const{isRenderingToTexture:Ue}=he,Ze=z.context,ht=Ze.gl,pt=z.style.projection,dt=z.transform,xt=dt.tileSize,Ot=re.paint.get("background-pattern");if(z.isPatternMissing(Ot))return;const wt=!Ot&&Ae.a===1&&Ce===1&&z.opaquePassEnabledForLayer()?"opaque":"translucent";if(z.renderPass!==wt)return;const Lt=ai.disabled,jt=z.getDepthModeForSublayer(0,wt==="opaque"?ri.ReadWrite:ri.ReadOnly),Dt=z.colorModeForRenderPass(),Yt=z.useProgram(Ot?"backgroundPattern":"background"),Sr=le||Kn(dt,{tileSize:xt,terrain:z.style.map.terrain});Ot&&(Ze.activeTexture.set(ht.TEXTURE0),z.imageManager.bind(z.context));const dr=re.getCrossfadeParameters();for(const yr of Sr){const xr=dt.getProjectionData({overscaledTileID:yr,applyGlobeMatrix:!Ue,applyTerrainMatrix:!0}),nn=Ot?P(Ce,z,Ot,{tileID:yr,tileSize:xt},dr):_(Ce,Ae),sn=z.style.map.terrain&&z.style.map.terrain.getTerrainData(yr),Hr=pt.getMeshFromTileID(Ze,yr.canonical,!1,!0,"raster");Yt.draw(Ze,ht.TRIANGLES,jt,Lt,Dt,ii.backCCW,nn,sn,xr,re.id,Hr.vertexBuffer,Hr.indexBuffer,Hr.segments)}})(u,0,w,C,L):o.cv(w)&&(function(z,Y,re,le){const{isRenderingGlobe:he}=le,Ae=z.context,Ce=re.implementation,Ue=z.style.projection,Ze=z.transform,ht=Ze.getProjectionDataForCustomLayer(he),pt={farZ:Ze.farZ,nearZ:Ze.nearZ,fov:Ze.fov*Math.PI/180,modelViewProjectionMatrix:Ze.modelViewProjectionMatrix,projectionMatrix:Ze.projectionMatrix,shaderData:{variantName:Ue.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Ue.shaderPreludeCode.vertexSource}`,define:Ue.shaderDefine},defaultProjectionData:ht},dt=Ce.renderingMode?Ce.renderingMode:"2d";if(z.renderPass==="offscreen"){const xt=Ce.prerender;xt&&(z.setCustomLayerDefaults(),Ae.setColorMode(z.colorModeForRenderPass()),xt.call(Ce,Ae.gl,pt),Ae.setDirty(),z.setBaseState())}else if(z.renderPass==="translucent"){z.setCustomLayerDefaults(),Ae.setColorMode(z.colorModeForRenderPass()),Ae.setStencilMode(ai.disabled);const xt=dt==="3d"?z.getDepthModeFor3D():z.getDepthModeForSublayer(0,ri.ReadOnly);Ae.setDepthMode(xt),Ce.render(Ae.gl,pt),Ae.setDirty(),z.setBaseState(),Ae.bindFramebuffer.set(null)}})(u,0,w,L))}saveTileTexture(u){const g=this._tileTextures[u.size[0]];g?g.push(u):this._tileTextures[u.size[0]]=[u]}getTileTexture(u){const g=this._tileTextures[u];return g&&g.length>0?g.pop():null}isPatternMissing(u){if(!u)return!1;if(!u.from||!u.to)return!0;const g=this.imageManager.getPattern(u.from.toString()),w=this.imageManager.getPattern(u.to.toString());return!g||!w}useProgram(u,g,w=!1,C=[]){this.cache=this.cache||{};const L=!!this.style.map.terrain,z=this.style.projection,Y=w?fn.projectionMercator:z.shaderPreludeCode,re=w?ba:z.shaderDefine,le=u+(g?g.cacheKey:"")+`/${w?wi:z.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(L?"/terrain":"")+(C?`/${C.join("/")}`:"");return this.cache[le]||(this.cache[le]=new Ps(this.context,fn[u],g,ne[u],this._showOverdrawInspector,L,Y,re,C)),this.cache[le]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var u,g;if(this._tileTextures){for(const w in this._tileTextures){const C=this._tileTextures[w];if(C)for(const L of C)L.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((u=this.tileExtentMesh.vertexBuffer)===null||u===void 0||u.destroy()),this.tileExtentMesh&&((g=this.tileExtentMesh.indexBuffer)===null||g===void 0||g.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const w in this.cache){const C=this.cache[w];C&&C.program&&this.context.gl.deleteProgram(C.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:u,drawingBufferHeight:g}=this.context.gl;return this.width!==u||this.height!==g}}function Jg(D,u){let g,w=!1,C=null,L=null;const z=()=>{C=null,w&&(D.apply(L,g),C=setTimeout(z,u),w=!1)};return(...Y)=>(w=!0,L=this,g=Y,C||z(),C)}class zp{constructor(u){this._getCurrentHash=()=>{const g=window.location.hash.replace("#","");if(this._hashName){let w;return g.split("&").map((C=>C.split("="))).forEach((C=>{C[0]===this._hashName&&(w=C)})),(w&&w[1]||"").split("/")}return g.split("/")},this._onHashChange=()=>{const g=this._getCurrentHash();if(!this._isValidHash(g))return!1;const w=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(g[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+g[2],+g[1]],zoom:+g[0],bearing:w,pitch:+(g[4]||0)}),!0},this._updateHashUnthrottled=()=>{const g=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,g)},this._removeHash=()=>{const g=this._getCurrentHash();if(g.length===0)return;const w=g.join("/");let C=w;C.split("&").length>0&&(C=C.split("&")[0]),this._hashName&&(C=`${this._hashName}=${w}`);let L=window.location.hash.replace(C,"");L.startsWith("#&")?L=L.slice(0,1)+L.slice(2):L==="#"&&(L="");let z=window.location.href.replace(/(#.+)?$/,L);z=z.replace("&&","&"),window.history.replaceState(window.history.state,null,z)},this._updateHash=Jg(this._updateHashUnthrottled,300),this._hashName=u&&encodeURIComponent(u)}addTo(u){return this._map=u,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(u){const g=this._map.getCenter(),w=Math.round(100*this._map.getZoom())/100,C=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),L=Math.pow(10,C),z=Math.round(g.lng*L)/L,Y=Math.round(g.lat*L)/L,re=this._map.getBearing(),le=this._map.getPitch();let he="";if(he+=u?`/${z}/${Y}/${w}`:`${w}/${Y}/${z}`,(re||le)&&(he+="/"+Math.round(10*re)/10),le&&(he+=`/${Math.round(le)}`),this._hashName){const Ae=this._hashName;let Ce=!1;const Ue=window.location.hash.slice(1).split("&").map((Ze=>{const ht=Ze.split("=")[0];return ht===Ae?(Ce=!0,`${ht}=${he}`):Ze})).filter((Ze=>Ze));return Ce||Ue.push(`${Ae}=${he}`),`#${Ue.join("&")}`}return`#${he}`}_isValidHash(u){if(u.length<3||u.some(isNaN))return!1;try{new o.V(+u[2],+u[1])}catch{return!1}const g=+u[0],w=+(u[3]||0),C=+(u[4]||0);return g>=this._map.getMinZoom()&&g<=this._map.getMaxZoom()&&w>=-180&&w<=180&&C>=this._map.getMinPitch()&&C<=this._map.getMaxPitch()}}const sc={linearity:.3,easing:o.cw(0,0,.3,1)},zy=o.e({deceleration:2500,maxSpeed:1400},sc),Fu=o.e({deceleration:20,maxSpeed:1400},sc),Bu=o.e({deceleration:1e3,maxSpeed:360},sc),q=o.e({deceleration:1e3,maxSpeed:90},sc),K=o.e({deceleration:1e3,maxSpeed:360},sc);class me{constructor(u){this._map=u,this.clear()}clear(){this._inertiaBuffer=[]}record(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:T(),settings:u})}_drainInertiaBuffer(){const u=this._inertiaBuffer,g=T();for(;u.length>0&&g-u[0].time>160;)u.shift()}_onMoveEnd(u){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const g={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:L}of this._inertiaBuffer)g.zoom+=L.zoomDelta||0,g.bearing+=L.bearingDelta||0,g.pitch+=L.pitchDelta||0,g.roll+=L.rollDelta||0,L.panDelta&&g.pan._add(L.panDelta),L.around&&(g.around=L.around),L.pinchAround&&(g.pinchAround=L.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(g.pan.mag()){const L=Ye(g.pan.mag(),w,o.e({},zy,u||{})),z=g.pan.mult(L.amount/g.pan.mag()),Y=this._map.cameraHelper.handlePanInertia(z,this._map.transform);C.center=Y.easingCenter,C.offset=Y.easingOffset,Ie(C,L)}if(g.zoom){const L=Ye(g.zoom,w,Fu);C.zoom=this._map.transform.zoom+L.amount,Ie(C,L)}if(g.bearing){const L=Ye(g.bearing,w,Bu);C.bearing=this._map.transform.bearing+o.an(L.amount,-179,179),Ie(C,L)}if(g.pitch){const L=Ye(g.pitch,w,q);C.pitch=this._map.transform.pitch+L.amount,Ie(C,L)}if(g.roll){const L=Ye(g.roll,w,K);C.roll=this._map.transform.roll+o.an(L.amount,-179,179),Ie(C,L)}if(C.zoom||C.bearing){const L=g.pinchAround===void 0?g.around:g.pinchAround;C.around=L?this._map.unproject(L):this._map.getCenter()}return this.clear(),o.e(C,{noMoveStart:!0})}}function Ie(D,u){(!D.duration||D.duration<u.duration)&&(D.duration=u.duration,D.easing=u.easing)}function Ye(D,u,g){const{maxSpeed:w,linearity:C,deceleration:L}=g,z=o.an(D*C/(u/1e3),-w,w),Y=Math.abs(z)/(L*C);return{easing:g.easing,duration:1e3*Y,amount:z*(Y/2)}}class Qe extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w,C={}){w=w instanceof MouseEvent?w:new MouseEvent(u,w);const L=A.mousePos(g.getCanvas(),w),z=g.unproject(L);super(u,o.e({point:L,lngLat:z,originalEvent:w},C)),this._defaultPrevented=!1,this.target=g}}class nt extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w){const C=u==="touchend"?w.changedTouches:w.touches,L=A.touchPos(g.getCanvasContainer(),C),z=L.map((re=>g.unproject(re))),Y=L.reduce(((re,le,he,Ae)=>re.add(le.div(Ae.length))),new o.P(0,0));super(u,{points:L,point:Y,lngLats:z,lngLat:g.unproject(Y),originalEvent:w}),this._defaultPrevented=!1}}class lt extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w){super(u,{originalEvent:w}),this._defaultPrevented=!1}}class yt{constructor(u,g){this._map=u,this._clickTolerance=g.clickTolerance}reset(){delete this._mousedownPos}wheel(u){return this._firePreventable(new lt(u.type,this._map,u))}mousedown(u,g){return this._mousedownPos=g,this._firePreventable(new Qe(u.type,this._map,u))}mouseup(u){this._map.fire(new Qe(u.type,this._map,u))}click(u,g){this._mousedownPos&&this._mousedownPos.dist(g)>=this._clickTolerance||this._map.fire(new Qe(u.type,this._map,u))}dblclick(u){return this._firePreventable(new Qe(u.type,this._map,u))}mouseover(u){this._map.fire(new Qe(u.type,this._map,u))}mouseout(u){this._map.fire(new Qe(u.type,this._map,u))}touchstart(u){return this._firePreventable(new nt(u.type,this._map,u))}touchmove(u){this._map.fire(new nt(u.type,this._map,u))}touchend(u){this._map.fire(new nt(u.type,this._map,u))}touchcancel(u){this._map.fire(new nt(u.type,this._map,u))}_firePreventable(u){if(this._map.fire(u),u.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class At{constructor(u){this._map=u}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(u){this._map.fire(new Qe(u.type,this._map,u))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Qe("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(u){this._delayContextMenu?this._contextMenuEvent=u:this._ignoreContextMenu||this._map.fire(new Qe(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xt{constructor(u){this._map=u}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(u){return this.transform.screenPointToLocation(o.P.convert(u),this._map.terrain)}}class _r{constructor(u,g){this._map=u,this._tr=new Xt(u),this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=g.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(u,g){this.isEnabled()&&u.shiftKey&&u.button===0&&(A.disableDrag(),this._startPos=this._lastPos=g,this._active=!0)}mousemoveWindow(u,g){if(!this._active)return;const w=g;if(this._lastPos.equals(w)||!this._box&&w.dist(this._startPos)<this._clickTolerance)return;const C=this._startPos;this._lastPos=w,this._box||(this._box=A.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",u));const L=Math.min(C.x,w.x),z=Math.max(C.x,w.x),Y=Math.min(C.y,w.y),re=Math.max(C.y,w.y);A.setTransform(this._box,`translate(${L}px,${Y}px)`),this._box.style.width=z-L+"px",this._box.style.height=re-Y+"px"}mouseupWindow(u,g){if(!this._active||u.button!==0)return;const w=this._startPos,C=g;if(this.reset(),A.suppressClick(),w.x!==C.x||w.y!==C.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:u})),{cameraAnimation:L=>L.fitScreenCoordinates(w,C,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",u)}keydown(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(u,g){return this._map.fire(new o.l(u,{originalEvent:g}))}}function St(D,u){if(D.length!==u.length)throw new Error(`The number of touches and points are not equal - touches ${D.length}, points ${u.length}`);const g={};for(let w=0;w<D.length;w++)g[D[w].identifier]=u[w];return g}class Pt{constructor(u){this.reset(),this.numTouches=u.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(u,g,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=u.timeStamp),w.length===this.numTouches&&(this.centroid=(function(C){const L=new o.P(0,0);for(const z of C)L._add(z);return L.div(C.length)})(g),this.touches=St(w,g)))}touchmove(u,g,w){if(this.aborted||!this.centroid)return;const C=St(w,g);for(const L in this.touches){const z=C[L];(!z||z.dist(this.touches[L])>30)&&(this.aborted=!0)}}touchend(u,g,w){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class fr{constructor(u){this.singleTap=new Pt(u),this.numTaps=u.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(u,g,w){this.singleTap.touchstart(u,g,w)}touchmove(u,g,w){this.singleTap.touchmove(u,g,w)}touchend(u,g,w){const C=this.singleTap.touchend(u,g,w);if(C){const L=u.timeStamp-this.lastTime<500,z=!this.lastTap||this.lastTap.dist(C)<30;if(L&&z||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class Nr{constructor(u){this._tr=new Xt(u),this._zoomIn=new fr({numTouches:1,numTaps:2}),this._zoomOut=new fr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(u,g,w){this._zoomIn.touchstart(u,g,w),this._zoomOut.touchstart(u,g,w)}touchmove(u,g,w){this._zoomIn.touchmove(u,g,w),this._zoomOut.touchmove(u,g,w)}touchend(u,g,w){const C=this._zoomIn.touchend(u,g,w),L=this._zoomOut.touchend(u,g,w),z=this._tr;return C?(this._active=!0,u.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:Y=>Y.easeTo({duration:300,zoom:z.zoom+1,around:z.unproject(C)},{originalEvent:u})}):L?(this._active=!0,u.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:Y=>Y.easeTo({duration:300,zoom:z.zoom-1,around:z.unproject(L)},{originalEvent:u})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gr{constructor(u){this._enabled=!!u.enable,this._moveStateManager=u.moveStateManager,this._clickTolerance=u.clickTolerance||1,this._moveFunction=u.move,this._activateOnStart=!!u.activateOnStart,u.assignEvents(this),this.reset()}reset(u){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(u)}_move(...u){const g=this._moveFunction(...u);if(g.bearingDelta||g.pitchDelta||g.rollDelta||g.around||g.panDelta)return this._active=!0,g}dragStart(u,g){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(u)&&(this._moveStateManager.startMove(u),this._lastPoint=Array.isArray(g)?g[0]:g,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(u,g){if(!this.isEnabled())return;const w=this._lastPoint;if(!w)return;if(u.preventDefault(),!this._moveStateManager.isValidMoveEvent(u))return void this.reset(u);const C=Array.isArray(g)?g[0]:g;return!this._moved&&C.dist(w)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=C,this._move(w,C))}dragEnd(u){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(u)&&(this._moved&&A.suppressClick(),this.reset(u))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Br=0,jr=2,on={[Br]:1,[jr]:2};class Jr{constructor(u){this._correctEvent=u.checkCorrectEvent}startMove(u){const g=A.mouseButton(u);this._eventButton=g}endMove(u){delete this._eventButton}isValidStartEvent(u){return this._correctEvent(u)}isValidMoveEvent(u){return!(function(g,w){const C=on[w];return g.buttons===void 0||(g.buttons&C)!==C})(u,this._eventButton)}isValidEndEvent(u){return A.mouseButton(u)===this._eventButton}}class Jn{constructor(){this._firstTouch=void 0}_isOneFingerTouch(u){return u.targetTouches.length===1}_isSameTouchEvent(u){return u.targetTouches[0].identifier===this._firstTouch}startMove(u){this._firstTouch=u.targetTouches[0].identifier}endMove(u){delete this._firstTouch}isValidStartEvent(u){return this._isOneFingerTouch(u)}isValidMoveEvent(u){return this._isOneFingerTouch(u)&&this._isSameTouchEvent(u)}isValidEndEvent(u){return this._isOneFingerTouch(u)&&this._isSameTouchEvent(u)}}class Vn{constructor(u=new Jr({checkCorrectEvent:()=>!0}),g=new Jn){this.mouseMoveStateManager=u,this.oneFingerTouchMoveStateManager=g}_executeRelevantHandler(u,g,w){return u instanceof MouseEvent?g(u):typeof TouchEvent<"u"&&u instanceof TouchEvent?w(u):void 0}startMove(u){this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.startMove(g)),(g=>this.oneFingerTouchMoveStateManager.startMove(g)))}endMove(u){this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.endMove(g)),(g=>this.oneFingerTouchMoveStateManager.endMove(g)))}isValidStartEvent(u){return this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.isValidStartEvent(g)),(g=>this.oneFingerTouchMoveStateManager.isValidStartEvent(g)))}isValidMoveEvent(u){return this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.isValidMoveEvent(g)),(g=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(g)))}isValidEndEvent(u){return this._executeRelevantHandler(u,(g=>this.mouseMoveStateManager.isValidEndEvent(g)),(g=>this.oneFingerTouchMoveStateManager.isValidEndEvent(g)))}}const Ai=D=>{D.mousedown=D.dragStart,D.mousemoveWindow=D.dragMove,D.mouseup=D.dragEnd,D.contextmenu=u=>{u.preventDefault()}};class Zn{constructor(u,g){this._clickTolerance=u.clickTolerance||1,this._map=g,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(u){return u<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(u,g,w){return this._calculateTransform(u,g,w)}touchmove(u,g,w){if(this._active){if(!this._shouldBePrevented(w.length))return u.preventDefault(),this._calculateTransform(u,g,w);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",u)}}touchend(u,g,w){this._calculateTransform(u,g,w),this._active&&this._shouldBePrevented(w.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(u,g,w){w.length>0&&(this._active=!0);const C=St(w,g),L=new o.P(0,0),z=new o.P(0,0);let Y=0;for(const le in C){const he=C[le],Ae=this._touches[le];Ae&&(L._add(he),z._add(he.sub(Ae)),Y++,C[le]=he)}if(this._touches=C,this._shouldBePrevented(Y)||!z.mag())return;const re=z.div(Y);return this._sum._add(re),this._sum.mag()<this._clickTolerance?void 0:{around:L.div(Y),panDelta:re}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yi{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(u,g,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([g[0],g[1]]))}touchmove(u,g,w){if(!this._firstTwoTouches)return;u.preventDefault();const[C,L]=this._firstTwoTouches,z=No(w,g,C),Y=No(w,g,L);if(!z||!Y)return;const re=this._aroundCenter?null:z.add(Y).div(2);return this._move([z,Y],re,u)}touchend(u,g,w){if(!this._firstTwoTouches)return;const[C,L]=this._firstTwoTouches,z=No(w,g,C),Y=No(w,g,L);z&&Y||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function No(D,u,g){for(let w=0;w<D.length;w++)if(D[w].identifier===g)return u[w]}function Li(D,u){return Math.log(D/u)/Math.LN2}class Yn extends Yi{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(u){this._startDistance=this._distance=u[0].dist(u[1])}_move(u,g){const w=this._distance;if(this._distance=u[0].dist(u[1]),this._active||!(Math.abs(Li(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Li(this._distance,w),pinchAround:g}}}function wn(D,u){return 180*D.angleWith(u)/Math.PI}class Co extends Yi{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(u){this._startVector=this._vector=u[0].sub(u[1]),this._minDiameter=u[0].dist(u[1])}_move(u,g,w){const C=this._vector;if(this._vector=u[0].sub(u[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:wn(this._vector,C),pinchAround:g}}_isBelowThreshold(u){this._minDiameter=Math.min(this._minDiameter,u.mag());const g=25/(Math.PI*this._minDiameter)*360,w=wn(u,this._startVector);return Math.abs(w)<g}}function Pi(D){return Math.abs(D.y)>Math.abs(D.x)}class aa extends Yi{constructor(u){super(),this._currentTouchCount=0,this._map=u}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(u,g,w){super.touchstart(u,g,w),this._currentTouchCount=w.length}_start(u){this._lastPoints=u,Pi(u[0].sub(u[1]))&&(this._valid=!1)}_move(u,g,w){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const C=u[0].sub(this._lastPoints[0]),L=u[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(C,L,w.timeStamp),this._valid?(this._lastPoints=u,this._active=!0,{pitchDelta:(C.y+L.y)/2*-.5}):void 0}gestureBeginsVertically(u,g,w){if(this._valid!==void 0)return this._valid;const C=u.mag()>=2,L=g.mag()>=2;if(!C&&!L)return;if(!C||!L)return this._firstMove===void 0&&(this._firstMove=w),w-this._firstMove<100&&void 0;const z=u.y>0==g.y>0;return Pi(u)&&Pi(g)&&z}}const da={panStep:100,bearingStep:15,pitchStep:10};class Mi{constructor(u){this._tr=new Xt(u);const g=da;this._panStep=g.panStep,this._bearingStep=g.bearingStep,this._pitchStep=g.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(u){if(u.altKey||u.ctrlKey||u.metaKey)return;let g=0,w=0,C=0,L=0,z=0;switch(u.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:u.shiftKey?w=-1:(u.preventDefault(),L=-1);break;case 39:u.shiftKey?w=1:(u.preventDefault(),L=1);break;case 38:u.shiftKey?C=1:(u.preventDefault(),z=-1);break;case 40:u.shiftKey?C=-1:(u.preventDefault(),z=1);break;default:return}return this._rotationDisabled&&(w=0,C=0),{cameraAnimation:Y=>{const re=this._tr;Y.easeTo({duration:300,easeId:"keyboardHandler",easing:Ml,zoom:g?Math.round(re.zoom)+g*(u.shiftKey?2:1):re.zoom,bearing:re.bearing+w*this._bearingStep,pitch:re.pitch+C*this._pitchStep,offset:[-L*this._panStep,-z*this._panStep],center:re.center},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ml(D){return D*(2-D)}const Qa=4.000244140625,vs=1/450;class ks{constructor(u,g){this._onTimeout=w=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(w)},this._map=u,this._tr=new Xt(u),this._triggerRenderFrame=g,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=vs}setZoomRate(u){this._defaultZoomRate=u}setWheelZoomRate(u){this._wheelZoomRate=u}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!u&&u.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(u){return!!this._map.cooperativeGestures.isEnabled()&&!(u.ctrlKey||this._map.cooperativeGestures.isBypassed(u))}wheel(u){if(!this.isEnabled())return;if(this._shouldBePrevented(u))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",u);let g=u.deltaMode===WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY;const w=T(),C=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,g!==0&&g%Qa==0?this._type="wheel":g!==0&&Math.abs(g)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=g,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(C*g)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue)),u.shiftKey&&g&&(g/=4),this._type&&(this._lastWheelEvent=u,this._delta-=g,this._active||this._start(u)),u.preventDefault()}_start(u){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const g=A.mousePos(this._map.getCanvas(),u),w=this._tr;this._aroundPoint=this._aroundCenter?w.transform.locationToScreenPoint(o.V.convert(w.center)):g,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const u=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const Y=u.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=Y),typeof this._targetZoom=="number"&&(this._targetZoom+=Y)}if(this._delta!==0){const Y=this._type==="wheel"&&Math.abs(this._delta)>Qa?this._wheelZoomRate:this._defaultZoomRate;let re=2/(1+Math.exp(-Math.abs(this._delta*Y)));this._delta<0&&re!==0&&(re=1/re);const le=typeof this._targetZoom!="number"?u.scale:o.aq(this._targetZoom);this._targetZoom=u.applyConstrain(u.getCameraLngLat(),o.at(le*re)).zoom,this._type==="wheel"&&(this._startZoom=u.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom!="number"?u.zoom:this._targetZoom,w=this._startZoom,C=this._easing;let L,z=!1;if(this._type==="wheel"&&w&&C){const Y=T()-this._lastWheelEventTime,re=Math.min((Y+5)/200,1),le=C(re);L=o.G.number(w,g,le),re<1?this._frameId||(this._frameId=!0):z=!0}else L=g,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=L,{noInertia:!0,needsRenderFrame:!z,zoomDelta:L-u.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(u){let g=o.cy;if(this._prevEase){const w=this._prevEase,C=(T()-w.start)/w.duration,L=w.easing(C+.01)-w.easing(C),z=.27/Math.sqrt(L*L+1e-4)*.01,Y=Math.sqrt(.0729-z*z);g=o.cw(z,Y,.25,1)}return this._prevEase={start:T(),duration:u,easing:g},g}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Go{constructor(u,g){this._clickZoom=u,this._tapZoom=g}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class sa{constructor(u){this._tr=new Xt(u),this.reset()}reset(){this._active=!1}dblclick(u,g){return u.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:this._tr.zoom+(u.shiftKey?-1:1),around:this._tr.unproject(g)},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wa{constructor(){this._tap=new fr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(u,g,w){if(!this._swipePoint)if(this._tapTime){const C=g[0],L=u.timeStamp-this._tapTime<500,z=this._tapPoint.dist(C)<30;L&&z?w.length>0&&(this._swipePoint=C,this._swipeTouch=w[0].identifier):this.reset()}else this._tap.touchstart(u,g,w)}touchmove(u,g,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const C=g[0],L=C.y-this._swipePoint.y;return this._swipePoint=C,u.preventDefault(),this._active=!0,{zoomDelta:L/128}}}else this._tap.touchmove(u,g,w)}touchend(u,g,w){if(this._tapTime)this._swipePoint&&w.length===0&&this.reset();else{const C=this._tap.touchend(u,g,w);C&&(this._tapTime=u.timeStamp,this._tapPoint=C)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ao{constructor(u,g,w){this._el=u,this._mousePan=g,this._touchPan=w}enable(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qi{constructor(u,g,w,C){this._pitchWithRotate=u.pitchWithRotate,this._rollEnabled=u.rollEnabled,this._mouseRotate=g,this._mousePitch=w,this._mouseRoll=C}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Wo{constructor(u,g,w,C){this._el=u,this._touchZoom=g,this._touchRotate=w,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Tn{constructor(u,g){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=u,this._options=g,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const u=this._map.getCanvasContainer();u.classList.add("maplibregl-cooperative-gestures"),this._container=A.create("div","maplibregl-cooperative-gesture-screen",u);let g=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(g=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const w=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),C=document.createElement("div");C.className="maplibregl-desktop-message",C.textContent=g,this._container.appendChild(C);const L=document.createElement("div");L.className="maplibregl-mobile-message",L.textContent=w,this._container.appendChild(L),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(A.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(u){return u[this._bypassKey]}notifyGestureBlocked(u,g){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:u,originalEvent:g})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Sn=D=>D.zoom||D.drag||D.roll||D.pitch||D.rotate;class Rs extends o.l{}function Sa(D){return D.panDelta&&D.panDelta.mag()||D.zoomDelta||D.bearingDelta||D.pitchDelta||D.rollDelta}class Fo{constructor(u,g){this.handleWindowEvent=C=>{this.handleEvent(C,`${C.type}Window`)},this.handleEvent=(C,L)=>{if(C.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const z=C.type==="renderFrame"?void 0:C,Y={needsRenderFrame:!1},re={},le={};for(const{handlerName:Ce,handler:Ue,allowed:Ze}of this._handlers){if(!Ue.isEnabled())continue;let ht;if(this._blockedByActive(le,Ze,Ce))Ue.reset();else if(Ue[L||C.type]){if(o.cz(C,L||C.type)){const pt=A.mousePos(this._map.getCanvas(),C);ht=Ue[L||C.type](C,pt)}else if(o.cA(C,L||C.type)){const pt=this._getMapTouches(C.touches),dt=A.touchPos(this._map.getCanvas(),pt);ht=Ue[L||C.type](C,dt,pt)}else o.cB(L||C.type)||(ht=Ue[L||C.type](C));this.mergeHandlerResult(Y,re,ht,Ce,z),ht&&ht.needsRenderFrame&&this._triggerRenderFrame()}(ht||Ue.isActive())&&(le[Ce]=Ue)}const he={};for(const Ce in this._previousActiveHandlers)le[Ce]||(he[Ce]=z);this._previousActiveHandlers=le,(Object.keys(he).length||Sa(Y))&&(this._changes.push([Y,re,he]),this._triggerRenderFrame()),(Object.keys(le).length||Sa(Y))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Ae}=Y;Ae&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ae(this._map))},this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new me(u),this._bearingSnap=g.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(g);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[window,"blur",void 0]];for(const[C,L,z]of this._listeners)A.addEventListener(C,L,C===document?this.handleWindowEvent:this.handleEvent,z)}destroy(){for(const[u,g,w]of this._listeners)A.removeEventListener(u,g,u===document?this.handleWindowEvent:this.handleEvent,w)}_addDefaultHandlers(u){const g=this._map,w=g.getCanvasContainer();this._add("mapEvent",new yt(g,u));const C=g.boxZoom=new _r(g,u);this._add("boxZoom",C),u.interactive&&u.boxZoom&&C.enable();const L=g.cooperativeGestures=new Tn(g,u.cooperativeGestures);this._add("cooperativeGestures",L),u.cooperativeGestures&&L.enable();const z=new Nr(g),Y=new sa(g);g.doubleClickZoom=new Go(Y,z),this._add("tapZoom",z),this._add("clickZoom",Y),u.interactive&&u.doubleClickZoom&&g.doubleClickZoom.enable();const re=new wa;this._add("tapDragZoom",re);const le=g.touchPitch=new aa(g);this._add("touchPitch",le),u.interactive&&u.touchPitch&&g.touchPitch.enable(u.touchPitch);const he=()=>g.project(g.getCenter()),Ae=(function({enable:wt,clickTolerance:Lt,aroundCenter:jt=!0,minPixelCenterThreshold:Dt=100,rotateDegreesPerPixelMoved:Yt=.8},Sr){const dr=new Jr({checkCorrectEvent:yr=>A.mouseButton(yr)===0&&yr.ctrlKey||A.mouseButton(yr)===2&&!yr.ctrlKey});return new gr({clickTolerance:Lt,move:(yr,xr)=>{const nn=Sr();if(jt&&Math.abs(nn.y-yr.y)>Dt)return{bearingDelta:o.cx(new o.P(yr.x,xr.y),xr,nn)};let sn=(xr.x-yr.x)*Yt;return jt&&xr.y<nn.y&&(sn=-sn),{bearingDelta:sn}},moveStateManager:dr,enable:wt,assignEvents:Ai})})(u,he),Ce=(function({enable:wt,clickTolerance:Lt,pitchDegreesPerPixelMoved:jt=-.5}){const Dt=new Jr({checkCorrectEvent:Yt=>A.mouseButton(Yt)===0&&Yt.ctrlKey||A.mouseButton(Yt)===2});return new gr({clickTolerance:Lt,move:(Yt,Sr)=>({pitchDelta:(Sr.y-Yt.y)*jt}),moveStateManager:Dt,enable:wt,assignEvents:Ai})})(u),Ue=(function({enable:wt,clickTolerance:Lt,rollDegreesPerPixelMoved:jt=.3},Dt){const Yt=new Jr({checkCorrectEvent:Sr=>A.mouseButton(Sr)===2&&Sr.ctrlKey});return new gr({clickTolerance:Lt,move:(Sr,dr)=>{const yr=Dt();let xr=(dr.x-Sr.x)*jt;return dr.y<yr.y&&(xr=-xr),{rollDelta:xr}},moveStateManager:Yt,enable:wt,assignEvents:Ai})})(u,he);g.dragRotate=new qi(u,Ae,Ce,Ue),this._add("mouseRotate",Ae,["mousePitch"]),this._add("mousePitch",Ce,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Ue,["mousePitch"]),u.interactive&&u.dragRotate&&g.dragRotate.enable();const Ze=(function({enable:wt,clickTolerance:Lt}){const jt=new Jr({checkCorrectEvent:Dt=>A.mouseButton(Dt)===0&&!Dt.ctrlKey});return new gr({clickTolerance:Lt,move:(Dt,Yt)=>({around:Yt,panDelta:Yt.sub(Dt)}),activateOnStart:!0,moveStateManager:jt,enable:wt,assignEvents:Ai})})(u),ht=new Zn(u,g);g.dragPan=new Ao(w,Ze,ht),this._add("mousePan",Ze),this._add("touchPan",ht,["touchZoom","touchRotate"]),u.interactive&&u.dragPan&&g.dragPan.enable(u.dragPan);const pt=new Co,dt=new Yn;g.touchZoomRotate=new Wo(w,dt,pt,re),this._add("touchRotate",pt,["touchPan","touchZoom"]),this._add("touchZoom",dt,["touchPan","touchRotate"]),u.interactive&&u.touchZoomRotate&&g.touchZoomRotate.enable(u.touchZoomRotate),this._add("blockableMapEvent",new At(g));const xt=g.scrollZoom=new ks(g,(()=>this._triggerRenderFrame()));this._add("scrollZoom",xt,["mousePan"]),u.interactive&&u.scrollZoom&&g.scrollZoom.enable(u.scrollZoom);const Ot=g.keyboard=new Mi(g);this._add("keyboard",Ot),u.interactive&&u.keyboard&&g.keyboard.enable()}_add(u,g,w){this._handlers.push({handlerName:u,handler:g,allowed:w}),this._handlersById[u]=g}stop(u){if(!this._updatingCamera){for(const{handler:g}of this._handlers)g.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}}isActive(){for(const{handler:u}of this._handlers)if(u.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Sn(this._eventsInProgress)||this.isZooming()}_blockedByActive(u,g,w){for(const C in u)if(C!==w&&(!g||g.indexOf(C)<0))return!0;return!1}_getMapTouches(u){const g=[];for(const w of u)this._el.contains(w.target)&&g.push(w);return g}mergeHandlerResult(u,g,w,C,L){if(!w)return;o.e(u,w);const z={handlerName:C,originalEvent:w.originalEvent||L};w.zoomDelta!==void 0&&(g.zoom=z),w.panDelta!==void 0&&(g.drag=z),w.rollDelta!==void 0&&(g.roll=z),w.pitchDelta!==void 0&&(g.pitch=z),w.bearingDelta!==void 0&&(g.rotate=z)}_applyChanges(){const u={},g={},w={};for(const[C,L,z]of this._changes)C.panDelta&&(u.panDelta=(u.panDelta||new o.P(0,0))._add(C.panDelta)),C.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+C.pitchDelta),C.rollDelta&&(u.rollDelta=(u.rollDelta||0)+C.rollDelta),C.around!==void 0&&(u.around=C.around),C.pinchAround!==void 0&&(u.pinchAround=C.pinchAround),C.noInertia&&(u.noInertia=C.noInertia),o.e(g,L),o.e(w,z);this._updateMapTransform(u,g,w),this._changes=[]}_updateMapTransform(u,g,w){const C=this._map,L=C._getTransformForUpdate(),z=C.terrain;if(!(Sa(u)||z&&this._terrainMovement))return this._fireEvents(g,w,!0);C._stop(!0);let{panDelta:Y,zoomDelta:re,bearingDelta:le,pitchDelta:he,rollDelta:Ae,around:Ce,pinchAround:Ue}=u;Ue!==void 0&&(Ce=Ue),Ce=Ce||C.transform.centerPoint,z&&!L.isPointOnMapSurface(Ce)&&(Ce=L.centerPoint);const Ze={panDelta:Y,zoomDelta:re,rollDelta:Ae,pitchDelta:he,bearingDelta:le,around:Ce};this._map.cameraHelper.useGlobeControls&&!L.isPointOnMapSurface(Ce)&&(Ce=L.centerPoint);const ht=Ce.distSqr(L.centerPoint)<.01?L.center:L.screenPointToLocation(Y?Ce.sub(Y):Ce);this._handleMapControls({terrain:z,tr:L,deltasForHelper:Ze,preZoomAroundLoc:ht,combinedEventsInProgress:g,panDelta:Y}),C._applyUpdatedTransform(L),this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(g,w,!0)}_handleMapControls({terrain:u,tr:g,deltasForHelper:w,preZoomAroundLoc:C,combinedEventsInProgress:L,panDelta:z}){const Y=this._map.cameraHelper;if(Y.handleMapControlsRollPitchBearingZoom(w,g),u)return Y.useGlobeControls?(this._terrainMovement||!L.drag&&!L.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void Y.handleMapControlsPan(w,g,C)):this._terrainMovement||!L.drag&&!L.zoom?void(L.drag&&this._terrainMovement&&z?g.setCenter(g.screenPointToLocation(g.centerPoint.sub(z))):Y.handleMapControlsPan(w,g,C)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void Y.handleMapControlsPan(w,g,C));Y.handleMapControlsPan(w,g,C)}_fireEvents(u,g,w){const C=Sn(this._eventsInProgress),L=Sn(u),z={};for(const Ae in u){const{originalEvent:Ce}=u[Ae];this._eventsInProgress[Ae]||(z[`${Ae}start`]=Ce),this._eventsInProgress[Ae]=u[Ae]}!C&&L&&this._fireEvent("movestart",L.originalEvent);for(const Ae in z)this._fireEvent(Ae,z[Ae]);L&&this._fireEvent("move",L.originalEvent);for(const Ae in u){const{originalEvent:Ce}=u[Ae];this._fireEvent(Ae,Ce)}const Y={};let re;for(const Ae in this._eventsInProgress){const{handlerName:Ce,originalEvent:Ue}=this._eventsInProgress[Ae];this._handlersById[Ce].isActive()||(delete this._eventsInProgress[Ae],re=g[Ce]||Ue,Y[`${Ae}end`]=re)}for(const Ae in Y)this._fireEvent(Ae,Y[Ae]);const le=Sn(this._eventsInProgress),he=(C||L)&&!le;if(he&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Ae=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Ae.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Ae)}if(w&&he){this._updatingCamera=!0;const Ae=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Ce=Ue=>Ue!==0&&-this._bearingSnap<Ue&&Ue<this._bearingSnap;!Ae||!Ae.essential&&x.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:re})),Ce(this._map.getBearing())&&this._map.resetNorth()):(Ce(Ae.bearing||this._map.getBearing())&&(Ae.bearing=0),Ae.freezeElevation=!0,this._map.easeTo(Ae,{originalEvent:re})),this._updatingCamera=!1}}_fireEvent(u,g){this._map.fire(new o.l(u,g?{originalEvent:g}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((u=>{delete this._frameId,this.handleEvent(new Rs("renderFrame",{timeStamp:u})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class $a extends o.E{constructor(u,g,w){super(),this._renderFrameCallback=()=>{const C=Math.min((T()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(C)),C<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=u,this._bearingSnap=w.bearingSnap,this.cameraHelper=g,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(u,g){u.apply(this.transform,!0),this.transform=u,this.cameraHelper=g}getCenter(){return new o.V(this.transform.center.lng,this.transform.center.lat)}setCenter(u,g){return this.jumpTo({center:u},g)}getCenterElevation(){return this.transform.elevation}setCenterElevation(u,g){return this.jumpTo({elevation:u},g),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(u){this._centerClampedToGround=u}panBy(u,g,w){return u=o.P.convert(u).mult(-1),this.panTo(this.transform.center,o.e({offset:u},g),w)}panTo(u,g,w){return this.easeTo(o.e({center:u},g),w)}getZoom(){return this.transform.zoom}setZoom(u,g){return this.jumpTo({zoom:u},g),this}zoomTo(u,g,w){return this.easeTo(o.e({zoom:u},g),w)}zoomIn(u,g){return this.zoomTo(this.getZoom()+1,u,g),this}zoomOut(u,g){return this.zoomTo(this.getZoom()-1,u,g),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(u,g){return u!=this.transform.fov&&(this.transform.setFov(u),this.fire(new o.l("movestart",g)).fire(new o.l("move",g)).fire(new o.l("moveend",g))),this}getBearing(){return this.transform.bearing}setBearing(u,g){return this.jumpTo({bearing:u},g),this}getPadding(){return this.transform.padding}setPadding(u,g){return this.jumpTo({padding:u},g),this}rotateTo(u,g,w){return this.easeTo(o.e({bearing:u},g),w)}resetNorth(u,g){return this.rotateTo(0,o.e({duration:1e3},u),g),this}resetNorthPitch(u,g){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},u),g),this}snapToNorth(u,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(u,g):this}getPitch(){return this.transform.pitch}setPitch(u,g){return this.jumpTo({pitch:u},g),this}getRoll(){return this.transform.roll}setRoll(u,g){return this.jumpTo({roll:u},g),this}cameraForBounds(u,g){u=Ht.convert(u).adjustAntiMeridian();const w=g&&g.bearing||0;return this._cameraForBoxAndBearing(u.getNorthWest(),u.getSouthEast(),w,g)}_cameraForBoxAndBearing(u,g,w,C){const L={top:0,bottom:0,right:0,left:0};if(typeof(C=o.e({padding:L,offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding=="number"){const le=C.padding;C.padding={top:le,bottom:le,right:le,left:le}}const z=o.e(L,C.padding);C.padding=z;const Y=this.transform,re=new Ht(u,g);return this.cameraHelper.cameraForBoxAndBearing(C,z,re,w,Y)}fitBounds(u,g,w){return this._fitInternal(this.cameraForBounds(u,g),g,w)}fitScreenCoordinates(u,g,w,C,L){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(u)),this.transform.screenPointToLocation(o.P.convert(g)),w,C),C,L)}_fitInternal(u,g,w){return u?(delete(g=o.e(u,g)).padding,g.linear?this.easeTo(g,w):this.flyTo(g,w)):this}jumpTo(u,g){this.stop();const w=this._getTransformForUpdate();let C=!1,L=!1,z=!1;const Y=w.zoom;this.cameraHelper.handleJumpToCenterZoom(w,u);const re=w.zoom!==Y;return"elevation"in u&&w.elevation!==+u.elevation&&w.setElevation(+u.elevation),"bearing"in u&&w.bearing!==+u.bearing&&(C=!0,w.setBearing(+u.bearing)),"pitch"in u&&w.pitch!==+u.pitch&&(L=!0,w.setPitch(+u.pitch)),"roll"in u&&w.roll!==+u.roll&&(z=!0,w.setRoll(+u.roll)),u.padding==null||w.isPaddingEqual(u.padding)||w.setPadding(u.padding),this._applyUpdatedTransform(w),this.fire(new o.l("movestart",g)).fire(new o.l("move",g)),re&&this.fire(new o.l("zoomstart",g)).fire(new o.l("zoom",g)).fire(new o.l("zoomend",g)),C&&this.fire(new o.l("rotatestart",g)).fire(new o.l("rotate",g)).fire(new o.l("rotateend",g)),L&&this.fire(new o.l("pitchstart",g)).fire(new o.l("pitch",g)).fire(new o.l("pitchend",g)),z&&this.fire(new o.l("rollstart",g)).fire(new o.l("roll",g)).fire(new o.l("rollend",g)),this.fire(new o.l("moveend",g))}calculateCameraOptionsFromTo(u,g,w,C=0){const L=o.a9.fromLngLat(u,g),z=o.a9.fromLngLat(w,C),Y=z.x-L.x,re=z.y-L.y,le=z.z-L.z,he=Math.hypot(Y,re,le);if(he===0)throw new Error("Can't calculate camera options with same From and To");const Ae=Math.hypot(Y,re),Ce=o.at(this.transform.cameraToCenterDistance/he/this.transform.tileSize),Ue=180*Math.atan2(Y,-re)/Math.PI;let Ze=180*Math.acos(Ae/he)/Math.PI;return Ze=le<0?90-Ze:90+Ze,{center:z.toLngLat(),elevation:C,zoom:Ce,pitch:Ze,bearing:Ue}}calculateCameraOptionsFromCameraLngLatAltRotation(u,g,w,C,L){const z=this.transform.calculateCenterFromCameraLngLatAlt(u,g,w,C);return{center:z.center,elevation:z.elevation,zoom:z.zoom,bearing:w,pitch:C,roll:L}}easeTo(u,g){this._stop(!1,u.easeId),((u=o.e({offset:[0,0],duration:500,easing:o.cy},u)).animate===!1||!u.essential&&x.prefersReducedMotion)&&(u.duration=0);const w=this._getTransformForUpdate(),C=this.getBearing(),L=w.pitch,z=w.roll,Y="bearing"in u?this._normalizeBearing(u.bearing,C):C,re="pitch"in u?+u.pitch:L,le="roll"in u?this._normalizeBearing(u.roll,z):z,he="padding"in u?u.padding:w.padding,Ae=o.P.convert(u.offset);let Ce,Ue;u.around&&(Ce=o.V.convert(u.around),Ue=w.locationToScreenPoint(Ce));const Ze={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ht=this.cameraHelper.handleEaseTo(w,{bearing:Y,pitch:re,roll:le,padding:he,around:Ce,aroundPoint:Ue,offsetAsPoint:Ae,offset:u.offset,zoom:u.zoom,center:u.center});return this._rotating=this._rotating||C!==Y,this._pitching=this._pitching||re!==L,this._rolling=this._rolling||le!==z,this._padding=!w.isPaddingEqual(he),this._zooming=this._zooming||ht.isZooming,this._easeId=u.easeId,this._prepareEase(g,u.noMoveStart,Ze),this.terrain&&this._prepareElevation(ht.elevationCenter),this._ease((pt=>{ht.easeFunc(pt),this.terrain&&!u.freezeElevation&&this._updateElevation(pt),this._applyUpdatedTransform(w),this._fireMoveEvents(g)}),(pt=>{this.terrain&&u.freezeElevation&&this._finalizeElevation(),this._afterEase(g,pt)}),u),this}_prepareEase(u,g,w={}){this._moving=!0,g||w.moving||this.fire(new o.l("movestart",u)),this._zooming&&!w.zooming&&this.fire(new o.l("zoomstart",u)),this._rotating&&!w.rotating&&this.fire(new o.l("rotatestart",u)),this._pitching&&!w.pitching&&this.fire(new o.l("pitchstart",u)),this._rolling&&!w.rolling&&this.fire(new o.l("rollstart",u))}_prepareElevation(u){this._elevationCenter=u,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(u){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const g=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(u<1&&g!==this._elevationTarget){const w=this._elevationTarget-this._elevationStart;this._elevationStart+=u*(w-(g-(w*u+this._elevationStart))/(1-u)),this._elevationTarget=g}this.transform.setElevation(o.G.number(this._elevationStart,this._elevationTarget,u))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(u){if(!this.terrain&&u.elevation>=0&&u.pitch<=90)return{};const g=u.getCameraLngLat(),w=u.getCameraAltitude(),C=this.terrain?this.terrain.getElevationForLngLatZoom(g,u.zoom):0;if(w<C){const L=this.calculateCameraOptionsFromTo(g,C,u.center,u.elevation);return{pitch:L.pitch,zoom:L.zoom}}return{}}_applyUpdatedTransform(u){const g=[];if(g.push((C=>this._elevateCameraIfInsideTerrain(C))),this.transformCameraUpdate&&g.push((C=>this.transformCameraUpdate(C))),!g.length)return;const w=u.clone();for(const C of g){const L=w.clone(),{center:z,zoom:Y,roll:re,pitch:le,bearing:he,elevation:Ae}=C(L);z&&L.setCenter(z),Ae!==void 0&&L.setElevation(Ae),Y!==void 0&&L.setZoom(Y),re!==void 0&&L.setRoll(re),le!==void 0&&L.setPitch(le),he!==void 0&&L.setBearing(he),w.apply(L,!1)}this.transform.apply(w,!1)}_fireMoveEvents(u){this.fire(new o.l("move",u)),this._zooming&&this.fire(new o.l("zoom",u)),this._rotating&&this.fire(new o.l("rotate",u)),this._pitching&&this.fire(new o.l("pitch",u)),this._rolling&&this.fire(new o.l("roll",u))}_afterEase(u,g){if(this._easeId&&g&&this._easeId===g)return;delete this._easeId;const w=this._zooming,C=this._rotating,L=this._pitching,z=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,w&&this.fire(new o.l("zoomend",u)),C&&this.fire(new o.l("rotateend",u)),L&&this.fire(new o.l("pitchend",u)),z&&this.fire(new o.l("rollend",u)),this.fire(new o.l("moveend",u))}flyTo(u,g){if(!u.essential&&x.prefersReducedMotion){const xr=o.U(u,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(xr,g)}this.stop(),u=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.cy},u);const w=this._getTransformForUpdate(),C=w.bearing,L=w.pitch,z=w.roll,Y=w.padding,re="bearing"in u?this._normalizeBearing(u.bearing,C):C,le="pitch"in u?+u.pitch:L,he="roll"in u?this._normalizeBearing(u.roll,z):z,Ae="padding"in u?u.padding:w.padding,Ce=o.P.convert(u.offset);let Ue=w.centerPoint.add(Ce);const Ze=w.screenPointToLocation(Ue),ht=this.cameraHelper.handleFlyTo(w,{bearing:re,pitch:le,roll:he,padding:Ae,locationAtOffset:Ze,offsetAsPoint:Ce,center:u.center,minZoom:u.minZoom,zoom:u.zoom});let pt=u.curve;const dt=Math.max(w.width,w.height),xt=dt/ht.scaleOfZoom,Ot=ht.pixelPathLength;typeof ht.scaleOfMinZoom=="number"&&(pt=Math.sqrt(dt/ht.scaleOfMinZoom/Ot*2));const wt=pt*pt;function Lt(xr){const nn=(xt*xt-dt*dt+(xr?-1:1)*wt*wt*Ot*Ot)/(2*(xr?xt:dt)*wt*Ot);return Math.log(Math.sqrt(nn*nn+1)-nn)}function jt(xr){return(Math.exp(xr)-Math.exp(-xr))/2}function Dt(xr){return(Math.exp(xr)+Math.exp(-xr))/2}const Yt=Lt(!1);let Sr=function(xr){return Dt(Yt)/Dt(Yt+pt*xr)},dr=function(xr){return dt*((Dt(Yt)*(jt(nn=Yt+pt*xr)/Dt(nn))-jt(Yt))/wt)/Ot;var nn},yr=(Lt(!0)-Yt)/pt;if(Math.abs(Ot)<2e-6||!isFinite(yr)){if(Math.abs(dt-xt)<1e-6)return this.easeTo(u,g);const xr=xt<dt?-1:1;yr=Math.abs(Math.log(xt/dt))/pt,dr=()=>0,Sr=nn=>Math.exp(xr*pt*nn)}return u.duration="duration"in u?+u.duration:1e3*yr/("screenSpeed"in u?+u.screenSpeed/pt:+u.speed),u.maxDuration&&u.duration>u.maxDuration&&(u.duration=0),this._zooming=!0,this._rotating=C!==re,this._pitching=le!==L,this._rolling=he!==z,this._padding=!w.isPaddingEqual(Ae),this._prepareEase(g,!1),this.terrain&&this._prepareElevation(ht.targetCenter),this._ease((xr=>{const nn=xr*yr,sn=1/Sr(nn),Hr=dr(nn);this._rotating&&w.setBearing(o.G.number(C,re,xr)),this._pitching&&w.setPitch(o.G.number(L,le,xr)),this._rolling&&w.setRoll(o.G.number(z,he,xr)),this._padding&&(w.interpolatePadding(Y,Ae,xr),Ue=w.centerPoint.add(Ce)),ht.easeFunc(xr,sn,Hr,Ue),this.terrain&&!u.freezeElevation&&this._updateElevation(xr),this._applyUpdatedTransform(w),this._fireMoveEvents(g)}),(()=>{this.terrain&&u.freezeElevation&&this._finalizeElevation(),this._afterEase(g)}),u),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(u,g){var w;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const C=this._onEaseEnd;delete this._onEaseEnd,C.call(this,g)}return u||(w=this.handlers)===null||w===void 0||w.stop(!1),this}_ease(u,g,w){w.animate===!1||w.duration===0?(u(1),g()):(this._easeStart=T(),this._easeOptions=w,this._onEaseFrame=u,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(u,g){u=o.W(u,-180,180);const w=Math.abs(u-g);return Math.abs(u-360-g)<w&&(u-=360),Math.abs(u+360-g)<w&&(u+=360),u}queryTerrainElevation(u){return this.terrain?this.terrain.getElevationForLngLat(o.V.convert(u),this.transform):null}}const eo={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class kl{constructor(u=eo){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=g=>{!g||g.sourceDataType!=="metadata"&&g.sourceDataType!=="visibility"&&g.dataType!=="style"&&g.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=u}getDefaultPosition(){return"bottom-right"}onAdd(u){return this._map=u,this._compact=this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(u,g){const w=this._map._getUIString(`AttributionControl.${g}`);u.title=w,u.setAttribute("aria-label",w)}_updateAttributions(){if(!this._map.style)return;let u=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=u.concat(this.options.customAttribution.map((C=>typeof C!="string"?"":C))):typeof this.options.customAttribution=="string"&&u.push(this.options.customAttribution)),this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const g=this._map.style.tileManagers;for(const C in g){const L=g[C];if(L.used||L.usedForTerrain){const z=L.getSource();z.attribution&&u.indexOf(z.attribution)<0&&u.push(z.attribution)}}u=u.filter((C=>String(C).trim())),u.sort(((C,L)=>C.length-L.length)),u=u.filter(((C,L)=>{for(let z=L+1;z<u.length;z++)if(u[z].indexOf(C)>=0)return!1;return!0}));const w=u.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,u.length?(this._innerContainer.innerHTML=A.sanitize(w),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Yl{constructor(u={}){this._updateCompact=()=>{const g=this._container.children;if(g.length){const w=g[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&w.classList.add("maplibregl-compact"):w.classList.remove("maplibregl-compact")}},this.options=u}getDefaultPosition(){return"bottom-left"}onAdd(u){this._map=u,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl");const g=A.create("a","maplibregl-ctrl-logo");return g.target="_blank",g.rel="noopener nofollow",g.href="https://maplibre.org/",g.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),g.setAttribute("rel","noopener nofollow"),this._container.appendChild(g),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Zl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(u){const g=++this._id;return this._queue.push({callback:u,id:g,cancelled:!1}),g}remove(u){const g=this._currentlyRunning,w=g?this._queue.concat(g):this._queue;for(const C of w)if(C.id===u)return void(C.cancelled=!0)}run(u=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const g=this._currentlyRunning=this._queue;this._queue=[];for(const w of g)if(!w.cancelled&&(w.callback(u),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var gu=o.aU([{name:"a_pos3d",type:"Int16",components:3}]);class Ea extends o.E{constructor(u){super(),this._lastTilesetChange=T(),this.tileManager=u,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=u._source.tileSize*2**this.deltaZoom,u.usedForTerrain=!0,u.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(u,g){this.tileManager.update(u,g),this._renderableTilesKeys=[];const w={};for(const C of Kn(u,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:g,calculateTileZoom:this.tileManager._source.calculateTileZoom}))w[C.key]=!0,this._renderableTilesKeys.push(C.key),this._tiles[C.key]||(C.terrainRttPosMatrix32f=new Float64Array(16),o.c7(C.terrainRttPosMatrix32f,0,o.a5,o.a5,0,0,1),this._tiles[C.key]=new Kt(C,this.tileSize),this._lastTilesetChange=T());for(const C in this._tiles)w[C]||delete this._tiles[C]}freeRtt(u){for(const g in this._tiles){const w=this._tiles[g];(!u||w.tileID.equals(u)||w.tileID.isChildOf(u)||u.isChildOf(w.tileID))&&(w.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((u=>this.getTileByID(u)))}getTileByID(u){return this._tiles[u]}getTerrainCoords(u,g){return g?this._getTerrainCoordsForTileRanges(u,g):this._getTerrainCoordsForRegularTile(u)}_getTerrainCoordsForRegularTile(u){const g={};for(const w of this._renderableTilesKeys){const C=this._tiles[w].tileID,L=u.clone(),z=o.bk();if(C.canonical.equals(u.canonical))o.c7(z,0,o.a5,o.a5,0,0,1);else if(C.canonical.isChildOf(u.canonical)){const Y=C.canonical.z-u.canonical.z,re=C.canonical.x-(C.canonical.x>>Y<<Y),le=C.canonical.y-(C.canonical.y>>Y<<Y),he=o.a5>>Y;o.c7(z,0,he,he,0,0,1),o.O(z,z,[-re*he,-le*he,0])}else{if(!u.canonical.isChildOf(C.canonical))continue;{const Y=u.canonical.z-C.canonical.z,re=u.canonical.x-(u.canonical.x>>Y<<Y),le=u.canonical.y-(u.canonical.y>>Y<<Y),he=o.a5>>Y;o.c7(z,0,o.a5,o.a5,0,0,1),o.O(z,z,[re*he,le*he,0]),o.Q(z,z,[1/2**Y,1/2**Y,0])}}L.terrainRttPosMatrix32f=new Float32Array(z),g[w]=L}return g}_getTerrainCoordsForTileRanges(u,g){const w={};for(const C of this._renderableTilesKeys){const L=this._tiles[C].tileID;if(!this._isWithinTileRanges(L,g))continue;const z=u.clone(),Y=o.bk();if(L.canonical.z===u.canonical.z){const re=u.canonical.x-L.canonical.x+u.wrap*(1<<u.canonical.z),le=u.canonical.y-L.canonical.y;o.c7(Y,0,o.a5,o.a5,0,0,1),o.O(Y,Y,[re*o.a5,le*o.a5,0])}else if(L.canonical.z>u.canonical.z){const re=L.canonical.z-u.canonical.z,le=L.canonical.x-(L.canonical.x>>re<<re)+u.wrap*(1<<L.canonical.z),he=L.canonical.y-(L.canonical.y>>re<<re),Ae=u.canonical.x-(L.canonical.x>>re),Ce=u.canonical.y-(L.canonical.y>>re),Ue=o.a5>>re;o.c7(Y,0,Ue,Ue,0,0,1),o.O(Y,Y,[-le*Ue+Ae*o.a5,-he*Ue+Ce*o.a5,0])}else{const re=u.canonical.z-L.canonical.z,le=u.canonical.x-(u.canonical.x>>re<<re)+u.wrap*(1<<u.canonical.z),he=u.canonical.y-(u.canonical.y>>re<<re),Ae=(u.canonical.x>>re)-L.canonical.x,Ce=(u.canonical.y>>re)-L.canonical.y,Ue=o.a5<<re;o.c7(Y,0,Ue,Ue,0,0,1),o.O(Y,Y,[le*o.a5+Ae*Ue,he*o.a5+Ce*Ue,0])}z.terrainRttPosMatrix32f=new Float32Array(Y),w[C]=z}return w}getSourceTile(u,g){const w=this.tileManager._source;let C=u.overscaledZ-this.deltaZoom;if(C>w.maxzoom&&(C=w.maxzoom),C<w.minzoom)return;this._sourceTileCache[u.key]||(this._sourceTileCache[u.key]=u.scaledTo(C).key);let L=this.findTileInCaches(this._sourceTileCache[u.key]);if(!L?.dem&&g)for(;C>=w.minzoom&&!L?.dem;)L=this.findTileInCaches(u.scaledTo(C--).key);return L}findTileInCaches(u){let g=this.tileManager.getTileByID(u);return g||(g=this.tileManager._outOfViewCache.getByKey(u),g)}anyTilesAfterTime(u=Date.now()){return this._lastTilesetChange>=u}_isWithinTileRanges(u,g){const w=g[u.canonical.z];return!!w&&(u.wrap>w.minWrap||u.wrap<w.maxWrap||u.canonical.x>=w.minTileXWrapped&&u.canonical.x<=w.maxTileXWrapped&&u.canonical.y>=w.minTileY&&u.canonical.y<=w.maxTileY)}}class ia{constructor(u,g,w){this._meshCache={},this.painter=u,this.tileManager=new Ea(g),this.options=w,this.exaggeration=typeof w.exaggeration=="number"?w.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(u,g,w,C=o.a5){var L;if(!(g>=0&&g<C&&w>=0&&w<C))return 0;const z=this.getTerrainData(u),Y=(L=z.tile)===null||L===void 0?void 0:L.dem;if(!Y)return 0;const re=o.cC([],[g/C*o.a5,w/C*o.a5],z.u_terrain_matrix),le=[re[0]*Y.dim,re[1]*Y.dim],he=Math.floor(le[0]),Ae=Math.floor(le[1]),Ce=le[0]-he,Ue=le[1]-Ae;return Y.get(he,Ae)*(1-Ce)*(1-Ue)+Y.get(he+1,Ae)*Ce*(1-Ue)+Y.get(he,Ae+1)*(1-Ce)*Ue+Y.get(he+1,Ae+1)*Ce*Ue}getElevationForLngLatZoom(u,g){if(!o.cD(g,u.wrap()))return 0;const{tileID:w,mercatorX:C,mercatorY:L}=this._getOverscaledTileIDFromLngLatZoom(u,g);return this.getElevation(w,C%o.a5,L%o.a5,o.a5)}getElevationForLngLat(u,g){const w=Kn(g,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let C=0;for(const L of w)L.canonical.z>C&&(C=Math.min(L.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(u,C)}getElevation(u,g,w,C=o.a5){return this.getDEMElevation(u,g,w,C)*this.exaggeration}getTerrainData(u){if(!this._emptyDemTexture){const C=this.painter.context,L=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(C,L,C.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(C,new o.R({width:1,height:1}),C.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ar([])}const g=this.tileManager.getSourceTile(u,!0);if(g&&g.dem&&(!g.demTexture||g.needsTerrainPrepare)){const C=this.painter.context;g.demTexture=this.painter.getTileTexture(g.dem.stride),g.demTexture?g.demTexture.update(g.dem.getPixels(),{premultiply:!1}):g.demTexture=new o.T(C,g.dem.getPixels(),C.gl.RGBA,{premultiply:!1}),g.demTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),g.needsTerrainPrepare=!1}const w=g&&g.toString()+g.tileID.key+u.key;if(w&&!this._demMatrixCache[w]){const C=this.tileManager.getSource().maxzoom;let L=u.canonical.z-g.tileID.canonical.z;u.overscaledZ>u.canonical.z&&(u.canonical.z>=C?L=u.canonical.z-C:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const z=u.canonical.x-(u.canonical.x>>L<<L),Y=u.canonical.y-(u.canonical.y>>L<<L),re=o.cE(new Float64Array(16),[1/(o.a5<<L),1/(o.a5<<L),0]);o.O(re,re,[z*o.a5,Y*o.a5,0]),this._demMatrixCache[u.key]={matrix:re,coord:u}}return{u_depth:2,u_terrain:3,u_terrain_dim:g&&g.dem&&g.dem.dim||1,u_terrain_matrix:w?this._demMatrixCache[u.key].matrix:this._emptyDemMatrix,u_terrain_unpack:g&&g.dem&&g.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(g&&g.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:g}}getFramebuffer(u){const g=this.painter,w=g.width/devicePixelRatio,C=g.height/devicePixelRatio;return!this._fbo||this._fbo.width===w&&this._fbo.height===C||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(g.context,{width:w,height:C,data:null},g.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(g.context.gl.NEAREST,g.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(g.context,{width:w,height:C,data:null},g.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(g.context.gl.NEAREST,g.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=g.context.createFramebuffer(w,C,!0,!1),this._fbo.depthAttachment.set(g.context.createRenderbuffer(g.context.gl.DEPTH_COMPONENT16,w,C))),this._fbo.colorAttachment.set(u==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const u=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const g=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let L=0,z=0;L<this._coordsTextureSize;L++)for(let Y=0;Y<this._coordsTextureSize;Y++,z+=4)g[z+0]=255&Y,g[z+1]=255&L,g[z+2]=Y>>8<<4|L>>8,g[z+3]=0;const w=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(g.buffer)),C=new o.T(u,w,u.gl.RGBA,{premultiply:!1});return C.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),this._coordsTexture=C,C}pointCoordinate(u){this.painter.maybeDrawDepthAndCoords(!0);const g=new Uint8Array(4),w=this.painter.context,C=w.gl,L=Math.round(u.x*this.painter.pixelRatio/devicePixelRatio),z=Math.round(u.y*this.painter.pixelRatio/devicePixelRatio),Y=Math.round(this.painter.height/devicePixelRatio);w.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),C.readPixels(L,Y-z-1,1,1,C.RGBA,C.UNSIGNED_BYTE,g),w.bindFramebuffer.set(null);const re=g[0]+(g[2]>>4<<8),le=g[1]+((15&g[2])<<8),he=this.coordsIndex[255-g[3]],Ae=he&&this.tileManager.getTileByID(he);if(!Ae)return null;const Ce=this._coordsTextureSize,Ue=(1<<Ae.tileID.canonical.z)*Ce;return new o.a9((Ae.tileID.canonical.x*Ce+re)/Ue+Ae.tileID.wrap,(Ae.tileID.canonical.y*Ce+le)/Ue,this.getElevation(Ae.tileID,re,le,Ce))}depthAtPoint(u){const g=new Uint8Array(4),w=this.painter.context,C=w.gl;return w.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),C.readPixels(u.x,this.painter.height/devicePixelRatio-u.y-1,1,1,C.RGBA,C.UNSIGNED_BYTE,g),w.bindFramebuffer.set(null),(g[0]/16777216+g[1]/65536+g[2]/256+g[3])/256}getTerrainMesh(u){var g;const w=((g=this.painter.style.projection)===null||g===void 0?void 0:g.transitionState)>0,C=w&&u.canonical.y===0,L=w&&u.canonical.y===(1<<u.canonical.z)-1,z=`m_${C?"n":""}_${L?"s":""}`;if(this._meshCache[z])return this._meshCache[z];const Y=this.painter.context,re=new o.cF,le=new o.aY,he=this.meshSize,Ae=o.a5/he,Ce=he*he;for(let Dt=0;Dt<=he;Dt++)for(let Yt=0;Yt<=he;Yt++)re.emplaceBack(Yt*Ae,Dt*Ae,0);for(let Dt=0;Dt<Ce;Dt+=he+1)for(let Yt=0;Yt<he;Yt++)le.emplaceBack(Yt+Dt,he+Yt+Dt+1,he+Yt+Dt+2),le.emplaceBack(Yt+Dt,he+Yt+Dt+2,Yt+Dt+1);const Ue=re.length,Ze=Ue+(he+1),ht=(he+1)*he,pt=C?o.br:0,dt=C?0:1,xt=L?o.bs:o.a5,Ot=L?0:1;for(let Dt=0;Dt<=he;Dt++)re.emplaceBack(Dt*Ae,pt,dt);for(let Dt=0;Dt<=he;Dt++)re.emplaceBack(Dt*Ae,xt,Ot);for(let Dt=0;Dt<he;Dt++)le.emplaceBack(ht+Dt,Ze+Dt,Ze+Dt+1),le.emplaceBack(ht+Dt,Ze+Dt+1,ht+Dt+1),le.emplaceBack(0+Dt,Ue+Dt+1,Ue+Dt),le.emplaceBack(0+Dt,0+Dt+1,Ue+Dt+1);const wt=re.length,Lt=wt+2*(he+1);for(const Dt of[0,1])for(let Yt=0;Yt<=he;Yt++)for(const Sr of[0,1])re.emplaceBack(Dt*o.a5,Yt*Ae,Sr);for(let Dt=0;Dt<2*he;Dt+=2)le.emplaceBack(wt+Dt,wt+Dt+1,wt+Dt+3),le.emplaceBack(wt+Dt,wt+Dt+3,wt+Dt+2),le.emplaceBack(Lt+Dt,Lt+Dt+3,Lt+Dt+1),le.emplaceBack(Lt+Dt,Lt+Dt+2,Lt+Dt+3);const jt=new fi(Y.createVertexBuffer(re,gu.members),Y.createIndexBuffer(le),o.aX.simpleSegment(0,0,re.length,le.length));return this._meshCache[z]=jt,jt}getMeshFrameDelta(u){return 2*Math.PI*o.bE/Math.pow(2,Math.max(u,0))/5}getMinTileElevationForLngLatZoom(u,g){var w;if(!o.cD(g,u.wrap()))return 0;const{tileID:C}=this._getOverscaledTileIDFromLngLatZoom(u,g);return(w=this.getMinMaxElevation(C).minElevation)!==null&&w!==void 0?w:0}getMinMaxElevation(u){const g=this.getTerrainData(u).tile,w={minElevation:null,maxElevation:null};return g&&g.dem&&(w.minElevation=g.dem.min*this.exaggeration,w.maxElevation=g.dem.max*this.exaggeration),w}_getOverscaledTileIDFromLngLatZoom(u,g){const w=o.a9.fromLngLat(u.wrap()),C=(1<<g)*o.a5,L=w.x*C,z=w.y*C,Y=Math.floor(L/o.a5),re=Math.floor(z/o.a5);return{tileID:new o.a2(g,0,g,Y,re),mercatorX:L,mercatorY:z}}}class pa{constructor(u,g,w){this._context=u,this._size=g,this._tileSize=w,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const u of this._objects)u.texture.destroy(),u.fbo.destroy()}_createObject(u){const g=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),w=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return w.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),g.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),g.colorAttachment.set(w.texture),{id:u,fbo:g,texture:w,stamp:-1,inUse:!1}}getObjectForId(u){return this._objects[u]}useObject(u){u.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((g=>u.id!==g)),this._recentlyUsed.push(u.id)}stampObject(u){u.stamp=++this._stamp}getOrCreateFreeObject(){for(const g of this._recentlyUsed)if(!this._objects[g].inUse)return this._objects[g];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const u=this._createObject(this._objects.length);return this._objects.push(u),u}freeObject(u){u.inUse=!1}freeAllObjects(){for(const u of this._objects)this.freeObject(u)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((u=>!u.inUse))===!1}}const mu={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class yu{constructor(u,g){this.painter=u,this.terrain=g,this.pool=new pa(u.context,30,g.tileManager.tileSize*g.qualityFactor)}destruct(){this.pool.destruct()}getTexture(u){return this.pool.getObjectForId(u.rtt[this._stacks.length-1].id).texture}prepareForRender(u,g){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=u._order.filter((w=>!u._layers[w].isHidden(g))),this._coordsAscending={};for(const w in u.tileManagers){this._coordsAscending[w]={};const C=u.tileManagers[w].getVisibleCoordinates(),L=u.tileManagers[w].getSource(),z=L instanceof Qt?L.terrainTileRanges:null;for(const Y of C){const re=this.terrain.tileManager.getTerrainCoords(Y,z);for(const le in re)this._coordsAscending[w][le]||(this._coordsAscending[w][le]=[]),this._coordsAscending[w][le].push(re[le])}}this._coordsAscendingStr={};for(const w of u._order){const C=u._layers[w],L=C.source;if(mu[C.type]&&!this._coordsAscendingStr[L]){this._coordsAscendingStr[L]={};for(const z in this._coordsAscending[L])this._coordsAscendingStr[L][z]=this._coordsAscending[L][z].map((Y=>Y.key)).sort().join()}}for(const w of this._renderableTiles)for(const C in this._coordsAscendingStr){const L=this._coordsAscendingStr[C][w.tileID.key];L&&L!==w.rttCoords[C]&&(w.rtt=[])}}renderLayer(u,g){if(u.isHidden(this.painter.transform.zoom))return!1;const w=Object.assign(Object.assign({},g),{isRenderingToTexture:!0}),C=u.type,L=this.painter,z=this._renderableLayerIds[this._renderableLayerIds.length-1]===u.id;if(mu[C]&&(this._prevType&&mu[this._prevType]||this._stacks.push([]),this._prevType=C,this._stacks[this._stacks.length-1].push(u.id),!z))return!0;if(mu[this._prevType]||mu[C]&&z){this._prevType=C;const Y=this._stacks.length-1,re=this._stacks[Y]||[];for(const le of this._renderableTiles){if(this.pool.isFull()&&(Zg(this.painter,this.terrain,this._rttTiles,w),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(le),le.rtt[Y]){const Ae=this.pool.getObjectForId(le.rtt[Y].id);if(Ae.stamp===le.rtt[Y].stamp){this.pool.useObject(Ae);continue}}const he=this.pool.getOrCreateFreeObject();this.pool.useObject(he),this.pool.stampObject(he),le.rtt[Y]={id:he.id,stamp:he.stamp},L.context.bindFramebuffer.set(he.fbo.framebuffer),L.context.clear({color:o.bp.transparent,stencil:0}),L.currentStencilSource=void 0;for(let Ae=0;Ae<re.length;Ae++){const Ce=L.style._layers[re[Ae]],Ue=Ce.source?this._coordsAscending[Ce.source][le.tileID.key]:[le.tileID];L.context.viewport.set([0,0,he.fbo.width,he.fbo.height]),L._renderTileClippingMasks(Ce,Ue,!0),L.renderLayer(L,L.style.tileManagers[Ce.source],Ce,Ue,w),Ce.source&&(le.rttCoords[Ce.source]=this._coordsAscendingStr[Ce.source][le.tileID.key])}}return Zg(this.painter,this.terrain,this._rttTiles,w),this._rttTiles=[],this.pool.freeAllObjects(),mu[C]}return!1}}const as={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},jh=c,Uh={hash:!1,interactive:!0,bearingSnap:7,attributionControl:eo,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},Vh={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class qc{constructor(u,g,w=!1){this.mousedown=L=>{this.startMove(L,A.mousePos(this.element,L)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=L=>{this.move(L,A.mousePos(this.element,L))},this.mouseup=L=>{this._rotatePitchHandler.dragEnd(L),this.offTemp()},this.touchstart=L=>{L.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,L.targetTouches)[0],this.startMove(L,this._startPos),A.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.addEventListener(window,"touchend",this.touchend))},this.touchmove=L=>{L.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,L.targetTouches)[0],this.move(L,this._lastPos))},this.touchend=L=>{L.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=g;const C=new Vn;this._rotatePitchHandler=new gr({clickTolerance:3,move:(L,z)=>{const Y=g.getBoundingClientRect(),re=new o.P((Y.bottom-Y.top)/2,(Y.right-Y.left)/2);return{bearingDelta:o.cx(new o.P(L.x,z.y),z,re),pitchDelta:w?-.5*(z.y-L.y):void 0}},moveStateManager:C,enable:!0,assignEvents:()=>{}}),this.map=u,A.addEventListener(g,"mousedown",this.mousedown),A.addEventListener(g,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(g,"touchcancel",this.reset)}startMove(u,g){this._rotatePitchHandler.dragStart(u,g),A.disableDrag()}move(u,g){const w=this.map,{bearingDelta:C,pitchDelta:L}=this._rotatePitchHandler.dragMove(u,g)||{};C&&w.setBearing(w.getBearing()+C),L&&w.setPitch(w.getPitch()+L)}off(){const u=this.element;A.removeEventListener(u,"mousedown",this.mousedown),A.removeEventListener(u,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend),A.removeEventListener(u,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend)}}let Hc;function jp(D,u,g,w=!1){if(w||!g.getCoveringTilesDetailsProvider().allowWorldCopies())return D?.wrap();const C=new o.V(D.lng,D.lat);if(D=new o.V(D.lng,D.lat),u){const L=new o.V(D.lng-360,D.lat),z=new o.V(D.lng+360,D.lat),Y=g.locationToScreenPoint(D).distSqr(u);g.locationToScreenPoint(L).distSqr(u)<Y?D=L:g.locationToScreenPoint(z).distSqr(u)<Y&&(D=z)}for(;Math.abs(D.lng-g.center.lng)>180;){const L=g.locationToScreenPoint(D);if(L.x>=0&&L.y>=0&&L.x<=g.width&&L.y<=g.height)break;D.lng>g.center.lng?D.lng-=360:D.lng+=360}return D.lng!==C.lng&&g.isPointOnMapSurface(g.locationToScreenPoint(D))?D:C}const oh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function lc(D,u,g){const w=D.classList;for(const C in oh)w.remove(`maplibregl-${g}-anchor-${C}`);w.add(`maplibregl-${g}-anchor-${u}`)}class jd extends o.E{constructor(u){if(super(),this._onKeyPress=g=>{const w=g.code,C=g.charCode||g.keyCode;w!=="Space"&&w!=="Enter"&&C!==32&&C!==13||this.togglePopup()},this._onMapClick=g=>{const w=g.originalEvent.target,C=this._element;this._popup&&(w===C||C.contains(w))&&this.togglePopup()},this._update=g=>{if(!this._map)return;const w=this._map.loaded()&&!this._map.isMoving();(g?.type==="terrain"||g?.type==="render"&&!w)&&this._map.once("render",this._update),this._lngLat=jp(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let C="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?C=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(C=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let L="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?L="rotateX(0deg)":this._pitchAlignment==="map"&&(L=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||g&&g.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,`${oh[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${L} ${C}`),x.frameAsync(new AbortController).then((()=>{this._updateOpacity(g&&g.type==="moveend")})).catch((()=>{}))},this._onMove=g=>{if(!this._isDragging){const w=this._clickTolerance||this._map._clickTolerance;this._isDragging=g.point.dist(this._pointerdownPos)>=w}this._isDragging&&(this._pos=g.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=g=>{this._element.contains(g.originalEvent.target)&&(g.preventDefault(),this._positionDelta=g.point.sub(this._pos).add(this._offset),this._pointerdownPos=g.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=u&&u.anchor||"center",this._color=u&&u.color||"#3FB1CE",this._scale=u&&u.scale||1,this._draggable=u&&u.draggable||!1,this._clickTolerance=u&&u.clickTolerance||0,this._subpixelPositioning=u&&u.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=u&&u.rotation||0,this._rotationAlignment=u&&u.rotationAlignment||"auto",this._pitchAlignment=u&&u.pitchAlignment&&u.pitchAlignment!=="auto"?u.pitchAlignment:this._rotationAlignment,this.setOpacity(u?.opacity,u?.opacityWhenCovered),u&&u.element)this._element=u.element,this._offset=o.P.convert(u&&u.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div");const g=A.createNS("http://www.w3.org/2000/svg","svg"),w=41,C=27;g.setAttributeNS(null,"display","block"),g.setAttributeNS(null,"height",`${w}px`),g.setAttributeNS(null,"width",`${C}px`),g.setAttributeNS(null,"viewBox",`0 0 ${C} ${w}`);const L=A.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"stroke","none"),L.setAttributeNS(null,"stroke-width","1"),L.setAttributeNS(null,"fill","none"),L.setAttributeNS(null,"fill-rule","evenodd");const z=A.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill-rule","nonzero");const Y=A.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Y.setAttributeNS(null,"fill","#000000");const re=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const dt of re){const xt=A.createNS("http://www.w3.org/2000/svg","ellipse");xt.setAttributeNS(null,"opacity","0.04"),xt.setAttributeNS(null,"cx","10.5"),xt.setAttributeNS(null,"cy","5.80029008"),xt.setAttributeNS(null,"rx",dt.rx),xt.setAttributeNS(null,"ry",dt.ry),Y.appendChild(xt)}const le=A.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"fill",this._color);const he=A.createNS("http://www.w3.org/2000/svg","path");he.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),le.appendChild(he);const Ae=A.createNS("http://www.w3.org/2000/svg","g");Ae.setAttributeNS(null,"opacity","0.25"),Ae.setAttributeNS(null,"fill","#000000");const Ce=A.createNS("http://www.w3.org/2000/svg","path");Ce.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ae.appendChild(Ce);const Ue=A.createNS("http://www.w3.org/2000/svg","g");Ue.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ue.setAttributeNS(null,"fill","#FFFFFF");const Ze=A.createNS("http://www.w3.org/2000/svg","g");Ze.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ht=A.createNS("http://www.w3.org/2000/svg","circle");ht.setAttributeNS(null,"fill","#000000"),ht.setAttributeNS(null,"opacity","0.25"),ht.setAttributeNS(null,"cx","5.5"),ht.setAttributeNS(null,"cy","5.5"),ht.setAttributeNS(null,"r","5.4999962");const pt=A.createNS("http://www.w3.org/2000/svg","circle");pt.setAttributeNS(null,"fill","#FFFFFF"),pt.setAttributeNS(null,"cx","5.5"),pt.setAttributeNS(null,"cy","5.5"),pt.setAttributeNS(null,"r","5.4999962"),Ze.appendChild(ht),Ze.appendChild(pt),z.appendChild(Y),z.appendChild(le),z.appendChild(Ae),z.appendChild(Ue),z.appendChild(Ze),g.appendChild(z),g.setAttributeNS(null,"height",w*this._scale+"px"),g.setAttributeNS(null,"width",C*this._scale+"px"),this._element.appendChild(g),this._offset=o.P.convert(u&&u.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(g=>{g.preventDefault()})),this._element.addEventListener("mousedown",(g=>{g.preventDefault()})),lc(this._element,this._anchor,"marker"),u&&u.className)for(const g of u.className.split(" "))this._element.classList.add(g);this._popup=null}addTo(u){return this.remove(),this._map=u,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",u._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),u.getCanvasContainer().appendChild(this._element),u.on("move",this._update),u.on("moveend",this._update),u.on("terrain",this._update),u.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(u){return this._lngLat=o.V.convert(u),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(u){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),u){if(!("offset"in u.options)){const C=Math.abs(13.5)/Math.SQRT2;u.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(38.1-13.5+C)],"bottom-right":[-C,-1*(38.1-13.5+C)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=u,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(u){return this._subpixelPositioning=u,this}getPopup(){return this._popup}togglePopup(){const u=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:u?(u.isOpen()?u.remove():(u.setLngLat(this._lngLat),u.addTo(this._map)),this):this}_updateOpacity(u=!1){var g,w;const C=(g=this._map)===null||g===void 0?void 0:g.terrain,L=this._map.transform.isLocationOccluded(this._lngLat);if(!C||L){const Ue=L?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Ue&&(this._element.style.opacity=Ue))}if(u)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const z=this._map,Y=z.terrain.depthAtPoint(this._pos),re=z.terrain.getElevationForLngLat(this._lngLat,z.transform);if(z.transform.lngLatToCameraDepth(this._lngLat,re)-Y<.006)return void(this._element.style.opacity=this._opacity);const le=-this._offset.y/z.transform.pixelsPerMeter,he=Math.sin(z.getPitch()*Math.PI/180)*le,Ae=z.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),Ce=z.transform.lngLatToCameraDepth(this._lngLat,re+he)-Ae>.006;!((w=this._popup)===null||w===void 0)&&w.isOpen()&&Ce&&this._popup.remove(),this._element.style.opacity=Ce?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(u){return this._offset=o.P.convert(u),this._update(),this}addClassName(u){this._element.classList.add(u)}removeClassName(u){this._element.classList.remove(u)}toggleClassName(u){return this._element.classList.toggle(u)}setDraggable(u){return this._draggable=!!u,this._map&&(u?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(u){return this._rotation=u||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(u){return this._rotationAlignment=u||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(u){return this._pitchAlignment=u&&u!=="auto"?u:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(u,g){return(this._opacity===void 0||u===void 0&&g===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),u!==void 0&&(this._opacity=u),g!==void 0&&(this._opacityWhenCovered=g),this._map&&this._updateOpacity(!0),this}}const Qg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let $h=0,xf=!1;const qh={maxWidth:100,unit:"metric"};function Hh(D,u,g){const w=g&&g.maxWidth||100,C=D._container.clientHeight/2,L=D._container.clientWidth/2,z=D.unproject([L-w/2,C]),Y=D.unproject([L+w/2,C]),re=Math.round(D.project(Y).x-D.project(z).x),le=Math.min(w,re,D._container.clientWidth),he=z.distanceTo(Y);if(g&&g.unit==="imperial"){const Ae=3.2808*he;Ae>5280?wf(u,le,Ae/5280,D._getUIString("ScaleControl.Miles")):wf(u,le,Ae,D._getUIString("ScaleControl.Feet"))}else g&&g.unit==="nautical"?wf(u,le,he/1852,D._getUIString("ScaleControl.NauticalMiles")):he>=1e3?wf(u,le,he/1e3,D._getUIString("ScaleControl.Kilometers")):wf(u,le,he,D._getUIString("ScaleControl.Meters"))}function wf(D,u,g,w){const C=(function(L){const z=Math.pow(10,`${Math.floor(L)}`.length-1);let Y=L/z;return Y=Y>=10?10:Y>=5?5:Y>=3?3:Y>=2?2:Y>=1?1:(function(re){const le=Math.pow(10,Math.ceil(-Math.log(re)/Math.LN10));return Math.round(re*le)/le})(Y),z*Y})(g);D.style.width=u*(C/g)+"px",D.innerHTML=`${C}&nbsp;${w}`}const Gh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},Wh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Sf(D){if(D){if(typeof D=="number"){const u=Math.round(Math.abs(D)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,D),"top-left":new o.P(u,u),"top-right":new o.P(-u,u),bottom:new o.P(0,-D),"bottom-left":new o.P(u,-u),"bottom-right":new o.P(-u,-u),left:new o.P(D,0),right:new o.P(-D,0)}}if(D instanceof o.P||Array.isArray(D)){const u=o.P.convert(D);return{center:u,top:u,"top-left":u,"top-right":u,bottom:u,"bottom-left":u,"bottom-right":u,left:u,right:u}}return{center:o.P.convert(D.center||[0,0]),top:o.P.convert(D.top||[0,0]),"top-left":o.P.convert(D["top-left"]||[0,0]),"top-right":o.P.convert(D["top-right"]||[0,0]),bottom:o.P.convert(D.bottom||[0,0]),"bottom-left":o.P.convert(D["bottom-left"]||[0,0]),"bottom-right":o.P.convert(D["bottom-right"]||[0,0]),left:o.P.convert(D.left||[0,0]),right:o.P.convert(D.right||[0,0])}}return Sf(new o.P(0,0))}const Up=c;s.AJAXError=o.cI,s.Event=o.l,s.Evented=o.E,s.LngLat=o.V,s.MercatorCoordinate=o.a9,s.Point=o.P,s.addProtocol=o.cJ,s.config=o.c,s.removeProtocol=o.cK,s.AttributionControl=kl,s.BoxZoomHandler=_r,s.CanvasSource=Pe,s.CooperativeGesturesHandler=Tn,s.DoubleClickZoomHandler=Go,s.DragPanHandler=Ao,s.DragRotateHandler=qi,s.EdgeInsets=Cs,s.FullscreenControl=class extends o.E{constructor(D={}){super(),this._onFullscreenChange=()=>{var u;let g=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((u=g?.shadowRoot)===null||u===void 0)&&u.fullscreenElement;)g=g.shadowRoot.fullscreenElement;g===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,D&&D.container&&(D.container instanceof HTMLElement?this._container=D.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(D){return this._map=D,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const D=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon",D).setAttribute("aria-hidden","true"),D.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const D=this._getTitle();this._fullscreenButton.setAttribute("aria-label",D),this._fullscreenButton.title=D}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},s.GeoJSONSource=Tr,s.GeolocateControl=class extends o.E{constructor(D){super(),this._onSuccess=u=>{if(this._map){if(this._isOutOfMapMaxBounds(u))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",u)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=u,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(u),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(u),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",u)),this._finish()}},this._updateCamera=u=>{const g=new o.V(u.coords.longitude,u.coords.latitude),w=u.coords.accuracy,C=this._map.getBearing(),L=o.e({bearing:C},this.options.fitBoundsOptions),z=Ht.fromLngLat(g,w);this._map.fitBounds(z,L,{geolocateSource:!0})},this._updateMarker=u=>{if(u){const g=new o.V(u.coords.longitude,u.coords.latitude);this._accuracyCircleMarker.setLngLat(g).addTo(this._map),this._userLocationDotMarker.setLngLat(g).addTo(this._map),this._accuracy=u.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=u=>{if(this._map){if(u.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(u.code===3&&xf)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",u)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(u=>u.preventDefault())),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=u=>{if(this._map){if(u===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g)}else{const g=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new jd({element:this._dotElement}),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new jd({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(g=>{const w=g?.[0]instanceof ResizeObserverEntry;g.geolocateSource||this._watchState!=="ACTIVE_LOCK"||w||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))}))}},this.options=o.e({},Qg,D)}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return o._(this,arguments,void 0,(function*(u=!1){if(Hc!==void 0&&!u)return Hc;if(window.navigator.permissions===void 0)return Hc=!!window.navigator.geolocation,Hc;try{Hc=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Hc=!!window.navigator.geolocation}return Hc}))})().then((u=>this._finishSetupUI(u))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,$h=0,xf=!1}_isOutOfMapMaxBounds(D){const u=this._map.getMaxBounds(),g=D.coords;return u&&(g.longitude<u.getWest()||g.longitude>u.getEast()||g.latitude<u.getSouth()||g.latitude>u.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const D=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&D))return;const u=this._map.project(D),g=this._map.unproject([u.x+100,u.y]),w=D.distanceTo(g)/100,C=2*this._accuracy/w;this._circleElement.style.width=`${C.toFixed(2)}px`,this._circleElement.style.height=`${C.toFixed(2)}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":$h--,xf=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let D;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),$h++,$h>1?(D={maximumAge:6e5,timeout:0},xf=!0):(D=this.options.positionOptions,xf=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,D)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},s.GlobeControl=class{constructor(){this._toggleProjection=()=>{var D;const u=(D=this._map.getProjection())===null||D===void 0?void 0:D.type;this._map.setProjection(u!=="mercator"&&u?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var D;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((D=this._map.getProjection())===null||D===void 0?void 0:D.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=A.create("button","maplibregl-ctrl-globe",this._container),A.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},s.Hash=zp,s.ImageSource=Qt,s.KeyboardHandler=Mi,s.LngLatBounds=Ht,s.LogoControl=Yl,s.Map=class extends $a{constructor(D){var u,g;o.cG.mark(o.cH.create);const w=Object.assign(Object.assign(Object.assign({},Uh),D),{canvasContextAttributes:Object.assign(Object.assign({},Uh.canvasContextAttributes),D.canvasContextAttributes)});if(w.minZoom!=null&&w.maxZoom!=null&&w.minZoom>w.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(w.minPitch!=null&&w.maxPitch!=null&&w.minPitch>w.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(w.minPitch!=null&&w.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(w.maxPitch!=null&&w.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const C=new qs,L=new go;if(w.minZoom!==void 0&&C.setMinZoom(w.minZoom),w.maxZoom!==void 0&&C.setMaxZoom(w.maxZoom),w.minPitch!==void 0&&C.setMinPitch(w.minPitch),w.maxPitch!==void 0&&C.setMaxPitch(w.maxPitch),w.renderWorldCopies!==void 0&&C.setRenderWorldCopies(w.renderWorldCopies),w.transformConstrain!==null&&C.setConstrainOverride(w.transformConstrain),super(C,L,{bearingSnap:w.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Zl,this._controls=[],this._mapId=o.af(),this._lostContextStyle={style:null,images:null},this._contextLost=Y=>{Y.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const re of Object.values(this.style._layers))if(re.type==="custom"&&console.warn(`Custom layer with id '${re.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),re._listeners)for(const[le]of Object.entries(re._listeners))console.warn(`Custom layer with id '${re.id}' had event listeners for event '${le}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new o.l("webglcontextlost",{originalEvent:Y}))},this._contextRestored=Y=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new o.l("webglcontextrestored",{originalEvent:Y}))},this._onMapScroll=Y=>{if(Y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=w.interactive,this._maxTileCacheSize=w.maxTileCacheSize,this._maxTileCacheZoomLevels=w.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},w.canvasContextAttributes),this._trackResize=w.trackResize===!0,this._bearingSnap=w.bearingSnap,this._centerClampedToGround=w.centerClampedToGround,this._refreshExpiredTiles=w.refreshExpiredTiles===!0,this._fadeDuration=w.fadeDuration,this._crossSourceCollisions=w.crossSourceCollisions===!0,this._collectResourceTiming=w.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},as),w.locale),this._clickTolerance=w.clickTolerance,this._overridePixelRatio=w.pixelRatio,this._maxCanvasSize=w.maxCanvasSize,this._zoomLevelsToOverscale=w.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=w.transformCameraUpdate,this.transformConstrain=w.transformConstrain,this.cancelPendingTileRequestsWhileZooming=w.cancelPendingTileRequestsWhileZooming===!0,w.reduceMotion!==void 0&&(x.prefersReducedMotion=w.reduceMotion),this._imageQueueHandle=H.addThrottleControl((()=>this.isMoving())),this._requestManager=new W(w.transformRequest),typeof w.container=="string"){if(this._container=document.getElementById(w.container),!this._container)throw new Error(`Container '${w.container}' not found.`)}else{if(!(w.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=w.container}if(w.maxBounds&&this.setMaxBounds(w.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let Y=!1;const re=Jg((le=>{this._trackResize&&!this._removed&&(this.resize(le),this.redraw())}),50);this._resizeObserver=new ResizeObserver((le=>{Y?re(le):Y=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Fo(this,w),this._hash=w.hash&&new zp(typeof w.hash=="string"&&w.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:w.center,elevation:w.elevation,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch,roll:w.roll}),w.bounds&&(this.resize(),this.fitBounds(w.bounds,o.e({},w.fitBoundsOptions,{duration:0}))));const z=typeof w.style=="string"||((g=(u=w.style)===null||u===void 0?void 0:u.projection)===null||g===void 0?void 0:g.type)!=="globe";this.resize(null,z),this._localIdeographFontFamily=w.localIdeographFontFamily,this._validateStyle=w.validateStyle,w.style&&this.setStyle(w.style,{localIdeographFontFamily:w.localIdeographFontFamily}),w.attributionControl&&this.addControl(new kl(typeof w.attributionControl=="boolean"?void 0:w.attributionControl)),w.maplibreLogo&&this.addControl(new Yl,w.logoPosition),this.on("style.load",(()=>{if(z||this._resizeTransform(),this.transform.unmodified){const Y=o.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(Y)}})),this.on("data",(Y=>{this._update(Y.dataType==="style"),this.fire(new o.l(`${Y.dataType}data`,Y))})),this.on("dataloading",(Y=>{this.fire(new o.l(`${Y.dataType}dataloading`,Y))})),this.on("dataabort",(Y=>{this.fire(new o.l("sourcedataabort",Y))}))}_getMapId(){return this._mapId}setGlobalStateProperty(D,u){return this.style.setGlobalStateProperty(D,u),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(D,u){if(u===void 0&&(u=D.getDefaultPosition?D.getDefaultPosition():"top-right"),!D||!D.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const g=D.onAdd(this);this._controls.push(D);const w=this._controlPositions[u];return u.indexOf("bottom")!==-1?w.insertBefore(g,w.firstChild):w.appendChild(g),this}removeControl(D){if(!D||!D.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const u=this._controls.indexOf(D);return u>-1&&this._controls.splice(u,1),D.onRemove(this),this}hasControl(D){return this._controls.indexOf(D)>-1}coveringTiles(D){return Kn(this.transform,D)}calculateCameraOptionsFromTo(D,u,g,w){return w==null&&this.terrain&&(w=this.terrain.getElevationForLngLat(g,this.transform)),super.calculateCameraOptionsFromTo(D,u,g,w)}resize(D,u=!0){if(this._lostContextStyle.style!==null)return this;this._resizeInternal(u);const g=!this._moving;return g&&(this.stop(),this.fire(new o.l("movestart",D)).fire(new o.l("move",D))),this.fire(new o.l("resize",D)),g&&this.fire(new o.l("moveend",D)),this}_resizeInternal(D=!0){const[u,g]=this._containerDimensions(),w=this._getClampedPixelRatio(u,g);if(this._resizeCanvas(u,g,w),this.painter.resize(u,g,w),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const L=this._getClampedPixelRatio(u,g);this._resizeCanvas(u,g,L),this.painter.resize(u,g,L)}this._resizeTransform(D)}_resizeTransform(D=!0){var u;const[g,w]=this._containerDimensions();this.transform.resize(g,w,D),(u=this._requestedCameraState)===null||u===void 0||u.resize(g,w,D)}_getClampedPixelRatio(D,u){const{0:g,1:w}=this._maxCanvasSize,C=this.getPixelRatio(),L=D*C,z=u*C;return Math.min(L>g?g/L:1,z>w?w/z:1)*C}getPixelRatio(){var D;return(D=this._overridePixelRatio)!==null&&D!==void 0?D:devicePixelRatio}setPixelRatio(D){this._overridePixelRatio=D,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(D){return this.transform.setMaxBounds(Ht.convert(D)),this._update()}setMinZoom(D){if((D=D??-2)>=-2&&D<=this.transform.maxZoom){const u=this._getTransformForUpdate();return u.setMinZoom(D),this._applyUpdatedTransform(u),this._update(),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(D){if((D=D??22)>=this.transform.minZoom){const u=this._getTransformForUpdate();return u.setMaxZoom(D),this._applyUpdatedTransform(u),this._update(),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(D){if((D=D??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(D>=0&&D<=this.transform.maxPitch)return this.transform.setMinPitch(D),this._update(),this.getPitch()<D&&this.setPitch(D),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(D){if((D=D??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(D>=this.transform.minPitch)return this.transform.setMaxPitch(D),this._update(),this.getPitch()>D&&this.setPitch(D),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(D){return this.transform.setRenderWorldCopies(D),this._update()}setTransformConstrain(D){return this.transform.setConstrainOverride(D),this._update()}project(D){return this.transform.locationToScreenPoint(o.V.convert(D),this.style&&this.terrain)}unproject(D){return this.transform.screenPointToLocation(o.P.convert(D),this.terrain)}isMoving(){var D;return this._moving||((D=this.handlers)===null||D===void 0?void 0:D.isMoving())}isZooming(){var D;return this._zooming||((D=this.handlers)===null||D===void 0?void 0:D.isZooming())}isRotating(){var D;return this._rotating||((D=this.handlers)===null||D===void 0?void 0:D.isRotating())}_createDelegatedListener(D,u,g){if(D==="mouseenter"||D==="mouseover"){let w=!1;return{layers:u,listener:g,delegates:{mousemove:L=>{const z=u.filter((re=>this.getLayer(re))),Y=z.length!==0?this.queryRenderedFeatures(L.point,{layers:z}):[];Y.length?w||(w=!0,g.call(this,new Qe(D,this,L.originalEvent,{features:Y}))):w=!1},mouseout:()=>{w=!1}}}}if(D==="mouseleave"||D==="mouseout"){let w=!1;return{layers:u,listener:g,delegates:{mousemove:z=>{const Y=u.filter((re=>this.getLayer(re)));(Y.length!==0?this.queryRenderedFeatures(z.point,{layers:Y}):[]).length?w=!0:w&&(w=!1,g.call(this,new Qe(D,this,z.originalEvent)))},mouseout:z=>{w&&(w=!1,g.call(this,new Qe(D,this,z.originalEvent)))}}}}{const w=C=>{const L=u.filter((Y=>this.getLayer(Y))),z=L.length!==0?this.queryRenderedFeatures(C.point,{layers:L}):[];z.length&&(C.features=z,g.call(this,C),delete C.features)};return{layers:u,listener:g,delegates:{[D]:w}}}}_saveDelegatedListener(D,u){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[D]=this._delegatedListeners[D]||[],this._delegatedListeners[D].push(u)}_removeDelegatedListener(D,u,g){if(!this._delegatedListeners||!this._delegatedListeners[D])return;const w=this._delegatedListeners[D];for(let C=0;C<w.length;C++){const L=w[C];if(L.listener===g&&L.layers.length===u.length&&L.layers.every((z=>u.includes(z)))){for(const z in L.delegates)this.off(z,L.delegates[z]);return void w.splice(C,1)}}}on(D,u,g){if(g===void 0)return super.on(D,u);const w=typeof u=="string"?[u]:u,C=this._createDelegatedListener(D,w,g);this._saveDelegatedListener(D,C);for(const L in C.delegates)this.on(L,C.delegates[L]);return{unsubscribe:()=>{this._removeDelegatedListener(D,w,g)}}}once(D,u,g){if(g===void 0)return super.once(D,u);const w=typeof u=="string"?[u]:u,C=this._createDelegatedListener(D,w,g);for(const L in C.delegates){const z=C.delegates[L];C.delegates[L]=(...Y)=>{this._removeDelegatedListener(D,w,g),z(...Y)}}this._saveDelegatedListener(D,C);for(const L in C.delegates)this.once(L,C.delegates[L]);return this}off(D,u,g){return g===void 0?super.off(D,u):(this._removeDelegatedListener(D,typeof u=="string"?[u]:u,g),this)}queryRenderedFeatures(D,u){if(!this.style)return[];let g;const w=D instanceof o.P||Array.isArray(D),C=w?D:[[0,0],[this.transform.width,this.transform.height]];if(u=u||(w?{}:D)||{},C instanceof o.P||typeof C[0]=="number")g=[o.P.convert(C)];else{const L=o.P.convert(C[0]),z=o.P.convert(C[1]);g=[L,new o.P(z.x,L.y),z,new o.P(L.x,z.y),L]}return this.style.queryRenderedFeatures(g,u,this.transform)}querySourceFeatures(D,u){return this.style.querySourceFeatures(D,u)}setStyle(D,u){return(u=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},u)).diff!==!1&&u.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&D?(this._diffStyle(D,u),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._updateStyle(D,u))}setTransformRequest(D){return this._requestManager.setTransformRequest(D),this}_getUIString(D){const u=this._locale[D];if(u==null)throw new Error(`Missing UI string '${D}'`);return u}_updateStyle(D,u){var g,w;if(u.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(D,u)));const C=this.style&&u.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!D)),D?(this.style=new Is(this,u||{}),this.style.setEventedParent(this,{style:this.style}),typeof D=="string"?this.style.loadURL(D,u,C):this.style.loadJSON(D,u,C),this):((w=(g=this.style)===null||g===void 0?void 0:g.projection)===null||w===void 0||w.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Is(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(D,u){if(typeof D=="string"){const g=this._requestManager.transformRequest(D,"Style");o.j(g,new AbortController).then((w=>{this._updateDiff(w.data,u)})).catch((w=>{w&&this.fire(new o.k(w))}))}else typeof D=="object"&&this._updateDiff(D,u)}_updateDiff(D,u){try{this.style.setState(D,u)&&this._update(!0)}catch(g){o.w(`Unable to perform style diff: ${g.message||g.error||g}.  Rebuilding the style from scratch.`),this._updateStyle(D,u)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(D,u){return this._lazyInitEmptyStyle(),this.style.addSource(D,u),this._update(!0)}isSourceLoaded(D){const u=this.style&&this.style.tileManagers[D];if(u!==void 0)return u.loaded();this.fire(new o.k(new Error(`There is no tile manager with ID '${D}'`)))}setTerrain(D){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),D){const u=this.style.tileManagers[D.source];if(!u)throw new Error(`cannot load terrain, because there exists no source with ID: ${D.source}`);this.terrain===null&&u.reload();for(const g in this.style._layers){const w=this.style._layers[g];w.type==="hillshade"&&w.source===D.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),w.type==="color-relief"&&w.source===D.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ia(this.painter,u,D),this.painter.renderToTexture=new yu(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=g=>{var w;g.dataType==="style"?this.terrain.tileManager.freeRtt():g.dataType==="source"&&g.tile&&(g.sourceId!==D.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((w=g.source)===null||w===void 0?void 0:w.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(g.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:D})),this}getTerrain(){var D,u;return(u=(D=this.terrain)===null||D===void 0?void 0:D.options)!==null&&u!==void 0?u:null}areTilesLoaded(){const D=this.style&&this.style.tileManagers;for(const u of Object.values(D))if(!u.areTilesLoaded())return!1;return!0}removeSource(D){return this.style.removeSource(D),this._update(!0)}getSource(D){return this.style.getSource(D)}setSourceTileLodParams(D,u,g){if(g){const w=this.getSource(g);if(!w)throw new Error(`There is no source with ID "${g}", cannot set LOD parameters`);w.calculateTileZoom=nr(Math.max(1,D),Math.max(1,u))}else for(const w in this.style.tileManagers)this.style.tileManagers[w].getSource().calculateTileZoom=nr(Math.max(1,D),Math.max(1,u));return this._update(!0),this}refreshTiles(D,u){const g=this.style.tileManagers[D];if(!g)throw new Error(`There is no tile manager with ID "${D}", cannot refresh tile`);u===void 0?g.reload(!0):g.refreshTiles(u.map((w=>new o.ac(w.z,w.x,w.y))))}addImage(D,u,g={}){const{pixelRatio:w=1,sdf:C=!1,stretchX:L,stretchY:z,content:Y,textFitWidth:re,textFitHeight:le}=g;if(this._lazyInitEmptyStyle(),!(u instanceof HTMLImageElement||o.b(u))){if(u.width===void 0||u.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:he,height:Ae,data:Ce}=u,Ue=u;return this.style.addImage(D,{data:new o.R({width:he,height:Ae},new Uint8Array(Ce)),pixelRatio:w,stretchX:L,stretchY:z,content:Y,textFitWidth:re,textFitHeight:le,sdf:C,version:0,userImage:Ue}),Ue.onAdd&&Ue.onAdd(this,D),this}}{const{width:he,height:Ae,data:Ce}=x.getImageData(u);this.style.addImage(D,{data:new o.R({width:he,height:Ae},Ce),pixelRatio:w,stretchX:L,stretchY:z,content:Y,textFitWidth:re,textFitHeight:le,sdf:C,version:0})}}updateImage(D,u){const g=this.style.getImage(D);if(!g)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=u instanceof HTMLImageElement||o.b(u)?x.getImageData(u):u,{width:C,height:L,data:z}=w;if(C===void 0||L===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(C!==g.data.width||L!==g.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const Y=!(u instanceof HTMLImageElement||o.b(u));return g.data.replace(z,Y),this.style.updateImage(D,g),this}getImage(D){return this.style.getImage(D)}hasImage(D){return D?!!this.style.getImage(D):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(D){this.style.removeImage(D)}loadImage(D){return H.getImage(this._requestManager.transformRequest(D,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(D,u){return this._lazyInitEmptyStyle(),this.style.addLayer(D,u),this._update(!0)}moveLayer(D,u){return this.style.moveLayer(D,u),this._update(!0)}removeLayer(D){return this.style.removeLayer(D),this._update(!0)}getLayer(D){return this.style.getLayer(D)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(D,u,g){return this.style.setLayerZoomRange(D,u,g),this._update(!0)}setFilter(D,u,g={}){return this.style.setFilter(D,u,g),this._update(!0)}getFilter(D){return this.style.getFilter(D)}setPaintProperty(D,u,g,w={}){return this.style.setPaintProperty(D,u,g,w),this._update(!0)}getPaintProperty(D,u){return this.style.getPaintProperty(D,u)}setLayoutProperty(D,u,g,w={}){return this.style.setLayoutProperty(D,u,g,w),this._update(!0)}getLayoutProperty(D,u){return this.style.getLayoutProperty(D,u)}setGlyphs(D,u={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(D,u),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(D,u,g={}){return this._lazyInitEmptyStyle(),this.style.addSprite(D,u,g,(w=>{w||this._update(!0)})),this}removeSprite(D){return this._lazyInitEmptyStyle(),this.style.removeSprite(D),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(D,u={}){return this._lazyInitEmptyStyle(),this.style.setSprite(D,u,(g=>{g||this._update(!0)})),this}setLight(D,u={}){return this._lazyInitEmptyStyle(),this.style.setLight(D,u),this._update(!0)}getLight(){return this.style.getLight()}setSky(D,u={}){return this._lazyInitEmptyStyle(),this.style.setSky(D,u),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(D,u){return this.style.setFeatureState(D,u),this._update()}removeFeatureState(D,u){return this.style.removeFeatureState(D,u),this._update()}getFeatureState(D){return this.style.getFeatureState(D)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let D=0,u=0;return this._container&&(D=this._container.clientWidth||400,u=this._container.clientHeight||300),[D,u]}_setupContainer(){const D=this._container;D.classList.add("maplibregl-map");const u=this._canvasContainer=A.create("div","maplibregl-canvas-container",D);this._interactive&&u.classList.add("maplibregl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas",u),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const g=this._containerDimensions(),w=this._getClampedPixelRatio(g[0],g[1]);this._resizeCanvas(g[0],g[1],w);const C=this._controlContainer=A.create("div","maplibregl-control-container",D),L=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((z=>{L[z]=A.create("div",`maplibregl-ctrl-${z} `,C)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(D,u,g){this._canvas.width=Math.floor(g*D),this._canvas.height=Math.floor(g*u),this._canvas.style.width=`${D}px`,this._canvas.style.height=`${u}px`}_setupPainter(){const D=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let u=null;this._canvas.addEventListener("webglcontextcreationerror",(w=>{u={requestedAttributes:D},w&&(u.statusMessage=w.statusMessage,u.type=w.type)}),{once:!0});let g=null;if(g=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,D):this._canvas.getContext("webgl2",D)||this._canvas.getContext("webgl",D),!g){const w="Failed to initialize WebGL";throw u?(u.message=w,new Error(JSON.stringify(u))):new Error(w)}this.painter=new By(g,this.transform),R.testSupport(g)}migrateProjection(D,u){super.migrateProjection(D,u),this.painter.transform=D,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(D){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||D,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(D){return this._update(),this._renderTaskQueue.add(D)}_cancelRenderFrame(D){this._renderTaskQueue.remove(D)}_render(D){var u,g,w,C,L;const z=this._idleTriggered?this._fadeDuration:0,Y=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(D),this._removed)return;let re=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Ae=this.transform.zoom,Ce=T();this.style.zoomHistory.update(Ae,Ce);const Ue=new o.H(Ae,{now:Ce,fadeDuration:z,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Ze=Ue.crossFadingFactor();Ze===1&&Ze===this._crossFadingFactor||(re=!0,this._crossFadingFactor=Ze),this.style.update(Ue)}const le=((g=this.style.projection)===null||g===void 0?void 0:g.transitionState)>0!==Y;(w=this.style.projection)===null||w===void 0||w.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((C=this.style.projection)===null||C===void 0?void 0:C.transitionState,(L=this.style.projection)===null||L===void 0?void 0:L.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||le)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,z,this._crossSourceCollisions,le),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:z,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cG.mark(o.cH.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||re)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const he=this._sourcesDirty||this._styleDirty||this._placementDirty;return he||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||he||(this._fullyLoaded=!0,o.cG.mark(o.cH.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var D;this._hash&&this._hash.remove();for(const g of this._controls)g.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),H.removeThrottleControl(this._imageQueueHandle),(D=this._resizeObserver)===null||D===void 0||D.disconnect();const u=this.painter.context.gl.getExtension("WEBGL_lose_context");u?.loseContext&&u.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cG.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,x.frame(this._frameRequest,(D=>{o.cG.frame(D),this._frameRequest=null;try{this._render(D)}catch(u){if(!o.Z(u)&&!(function(g){return g.message===Dp})(u))throw u}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(D){this._showTileBoundaries!==D&&(this._showTileBoundaries=D,this._update())}get showPadding(){return!!this._showPadding}set showPadding(D){this._showPadding!==D&&(this._showPadding=D,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(D){this._showCollisionBoxes!==D&&(this._showCollisionBoxes=D,D?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(D){this._showOverdrawInspector!==D&&(this._showOverdrawInspector=D,this._update())}get repaint(){return!!this._repaint}set repaint(D){this._repaint!==D&&(this._repaint=D,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(D){this._vertices=D,this._update()}get version(){return jh}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(D){return this._lazyInitEmptyStyle(),this.style.setProjection(D),this._update(!0)}},s.MapMouseEvent=Qe,s.MapTouchEvent=nt,s.MapWheelEvent=lt,s.Marker=jd,s.NavigationControl=class{constructor(D){this._updateZoomButtons=()=>{const u=this._map.getZoom(),g=u===this._map.getMaxZoom(),w=u===this._map.getMinZoom();this._zoomInButton.disabled=g,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",g.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(u,g)=>{const w=this._map._getUIString(`NavigationControl.${g}`);u.title=w,u.setAttribute("aria-label",w)},this.options=o.e({},Vh,D),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(u=>u.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(u=>this._map.zoomIn({},{originalEvent:u}))),A.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(u=>this._map.zoomOut({},{originalEvent:u}))),A.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(u=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:u}):this._map.resetNorth({},{originalEvent:u})})),this._compassIcon=A.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(D){return this._map=D,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(D,u){const g=A.create("button",D,this._container);return g.type="button",g.addEventListener("click",u),g}},s.Popup=class extends o.E{constructor(D){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=u=>{this._update(u.point)},this._onMouseMove=u=>{this._update(u.point)},this._onDrag=u=>{this._update(u.point)},this._update=u=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=A.create("div","maplibregl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const z of this.options.className.split(" "))this._container.classList.add(z);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=jp(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!u)return;const g=this._flatPos=this._pos=this._trackPointer&&u?u:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&u?u:this._map.transform.locationToScreenPoint(this._lngLat));let w=this.options.anchor;const C=Sf(this.options.offset);if(!w){const z=this._container.offsetWidth,Y=this._container.offsetHeight,re=(function(he){var Ae,Ce,Ue,Ze;return he?{top:(Ae=he.top)!==null&&Ae!==void 0?Ae:0,right:(Ce=he.right)!==null&&Ce!==void 0?Ce:0,bottom:(Ue=he.bottom)!==null&&Ue!==void 0?Ue:0,left:(Ze=he.left)!==null&&Ze!==void 0?Ze:0}:{top:0,right:0,bottom:0,left:0}})(this.options.padding);let le;le=g.y+C.bottom.y<Y+re.top?["top"]:g.y>this._map.transform.height-Y-re.bottom?["bottom"]:[],g.x<z/2+re.left?le.push("left"):g.x>this._map.transform.width-z/2-re.right&&le.push("right"),w=le.length===0?"bottom":le.join("-")}let L=g.add(C[w]);this.options.subpixelPositioning||(L=L.round()),A.setTransform(this._container,`${oh[w]} translate(${L.x}px,${L.y}px)`),lc(this._container,w,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Gh),D)}addTo(D){return this._map&&this.remove(),this._map=D,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(D){return this._lngLat=o.V.convert(D),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(D){return this.setDOMContent(document.createTextNode(D))}setHTML(D){const u=document.createDocumentFragment(),g=document.createElement("body");let w;for(g.innerHTML=D;w=g.firstChild,w;)u.appendChild(w);return this.setDOMContent(u)}getMaxWidth(){var D;return(D=this._container)===null||D===void 0?void 0:D.style.maxWidth}setMaxWidth(D){return this.options.maxWidth=D,this._update(),this}setDOMContent(D){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(D),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(D){return this._container&&this._container.classList.add(D),this}removeClassName(D){return this._container&&this._container.classList.remove(D),this}setOffset(D){return this.options.offset=D,this._update(),this}toggleClassName(D){if(this._container)return this._container.classList.toggle(D)}setSubpixelPositioning(D){this.options.subpixelPositioning=D}setPadding(D){this.options.padding=D,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const D=this._container.querySelector(Wh);D&&D.focus()}},s.RasterDEMTileSource=br,s.RasterTileSource=vr,s.ScaleControl=class{constructor(D){this._onMove=()=>{Hh(this._map,this._container,this.options)},this.setUnit=u=>{this.options.unit=u,Hh(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},qh),D)}getDefaultPosition(){return"bottom-left"}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale",D.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},s.ScrollZoomHandler=ks,s.Style=Is,s.TerrainControl=class{constructor(D){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=D}onAdd(D){return this._map=D,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},s.TwoFingersTouchPitchHandler=aa,s.TwoFingersTouchRotateHandler=Co,s.TwoFingersTouchZoomHandler=Yn,s.TwoFingersTouchZoomRotateHandler=Wo,s.VectorTileSource=_t,s.VideoSource=at,s.addSourceType=(D,u)=>o._(void 0,void 0,void 0,(function*(){if(je(D))throw new Error(`A source type called "${D}" already exists.`);((g,w)=>{be[g]=w})(D,u)})),s.clearPrewarmedResources=function(){const D=Xe;D&&(D.isPreloaded()&&D.numActive()===1?(D.release(xe),Xe=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.createTileMesh=sr,s.getMaxParallelImageRequests=function(){return o.c.MAX_PARALLEL_IMAGE_REQUESTS},s.getRTLTextPluginStatus=function(){return Et().getRTLTextPluginStatus()},s.getVersion=function(){return Up},s.getWorkerCount=function(){return Ne.workerCount},s.getWorkerUrl=function(){return o.c.WORKER_URL},s.importScriptInWorkers=function(D){return it().broadcast("IS",D)},s.isTimeFrozen=function(){return E.isFrozen()},s.now=T,s.prewarm=function(){ot().acquire(xe)},s.restoreNow=function(){E.restoreNow()},s.setMaxParallelImageRequests=function(D){o.c.MAX_PARALLEL_IMAGE_REQUESTS=D},s.setNow=function(D){E.setNow(D)},s.setRTLTextPlugin=function(D,u){return Et().setRTLTextPlugin(D,u)},s.setWorkerCount=function(D){Ne.workerCount=D},s.setWorkerUrl=function(D){o.c.WORKER_URL=D}}));var a=r;return a}))})(eS)),eS.exports}var TT=Loe();const yM=Cd(TT);class Noe{registeredElements;baseLayers;firstSymbolLayer;eventHandlers;wrapper;initRegisteredElements;addNativeMaplibreFunctionsAndProps;map;style;styleJson;addSource;addControl;on;cleanup;constructor(e){const r=this;this.registeredElements={},this.baseLayers=[],this.firstSymbolLayer=void 0,this.eventHandlers={layerchange:[],viewportchange:[],addsource:[],addlayer:[]},this.wrapper={on:(o,c,f,d)=>{if(!r.eventHandlers[o])return;typeof f=="string"&&(d=f,f={}),r.eventHandlers[o].push({handler:c,options:f});const m=[o,c];d&&typeof d=="string"&&(r.initRegisteredElements(d),r.registeredElements[d].wrapperEvents.push(m))},off:(o,c)=>{r.eventHandlers[o]&&(r.eventHandlers[o]=r.eventHandlers[o].filter(f=>Object.is(f.handler,c)?!1:f))},fire:(o,c)=>{if(!r.eventHandlers[o])return;const f=c||window,d=new Event(o);r.eventHandlers[o].forEach(function(m){m.handler.call(f,d,r,c)})},layerState:[],layerStateString:"",oldLayerStateStrings:{},buildLayerObject:o=>{if(o)return{id:o.id,type:o.type,visible:o.visibility!=="none",baseLayer:r.baseLayers.indexOf(o.id)!==-1}},buildLayerObjects:()=>r.map.style._order.map(o=>r.wrapper.buildLayerObject(r.map.style._layers[o])).filter(o=>typeof o<"u"),refreshLayerState:()=>{r.wrapper.layerState=r.wrapper.buildLayerObjects(),JSON.stringify(r.wrapper.layerState)!==r.wrapper.layerStateString&&(r.wrapper.fire("layerchange"),r.wrapper.layerStateString=JSON.stringify(r.wrapper.layerState))},viewportState:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0},viewportStateString:"{}",oldViewportStateString:"{}",getViewport:()=>typeof r.map.getCenter=="function"?{center:(({lng:o,lat:c})=>({lng:o,lat:c}))(r.map.getCenter()),zoom:r.map.getZoom(),bearing:r.map.getBearing(),pitch:r.map.getPitch()}:{center:{lng:0,lat:0},zoom:0,bearing:0,pitch:0},refreshViewport:()=>{r.wrapper.viewportState=r.wrapper.getViewport()}},this.cancelled=!1,this.initRegisteredElements=(o,c)=>{(typeof r.registeredElements[o]>"u"||typeof c<"u"&&c)&&(r.registeredElements[o]={layers:[],sources:[],images:[],events:[],controls:[],wrapperEvents:[]})},this.addLayer=(o,c,f)=>r.map.style?(f&&typeof f=="string"&&typeof o.id<"u"&&(r.initRegisteredElements(f),r.registeredElements[f].layers.push(o.id),o?.source&&typeof o?.source!="string"&&r.registeredElements[f].sources.push(o.id)),r.map.addLayer(o,c),r.wrapper.fire("addlayer",{layer_id:o.id}),this):this,this.addSource=(o,c,f)=>r.map.style?(f&&typeof f=="string"&&typeof o<"u"&&(r.initRegisteredElements(f),r.registeredElements[f].sources.push(o)),r.map.addSource(o,c),r.wrapper.fire("addsource",{source_id:o}),this):this,this.addImage=(o,c,f,d)=>r.map.style?typeof f=="string"&&typeof d>"u"?r.addImage(o,c,void 0,f):(d&&typeof d=="string"&&typeof o<"u"&&(r.initRegisteredElements(d),r.registeredElements[d].images.push(o)),r.map.addImage(o,c,f),this):this,this.on=(o,c,f,d)=>{if(typeof f=="string"&&typeof c=="function")return r.on.call(r,o,void 0,c,f);let m=[o,c,f];return c||(m=[o,f]),d&&typeof d=="string"&&(r.initRegisteredElements(d),r.registeredElements[d].events.push(m)),r.map.on(...m),this},this.addControl=(o,c,f)=>(f&&typeof f=="string"&&(r.initRegisteredElements(f),r.registeredElements[f].controls.push(o)),r.map.addControl(o,c),this),this.cleanup=o=>{r.map.style&&typeof r.registeredElements[o]<"u"&&(r.registeredElements[o].layers.forEach(c=>{r.map.style.getLayer(c)&&r.map.style.removeLayer(c)}),r.registeredElements[o].sources.forEach(c=>{r.map.style.getSource(c)&&r.map.style.removeSource(c)}),r.registeredElements[o].images.forEach(c=>{r.map.hasImage(c)&&r.map.style.removeImage(c)}),r.registeredElements[o].events.forEach(c=>{r.map.off(...c)}),r.registeredElements[o].controls.forEach(c=>{r.map.removeControl(c)}),r.registeredElements[o].wrapperEvents.forEach(c=>{r.wrapper.off(...c)}),r.initRegisteredElements(o,!0))},["moveLayer","removeLayer","removeSource","setPaintProperty","setLayoutProperty"].forEach(o=>{this[o]=(...c)=>(r.map&&r.map.style&&typeof r.map.style[o]=="function"&&r.map.style[o](...c),r.map._update?r.map._update(!0):void 0)}),["getLayer","getSource","listImages","getPaintProperty","getLayoutProperty","removeImage"].forEach(o=>{this[o]=(...c)=>r.map&&r.map.style?r.map.style[o](...c):!1}),this.addNativeMaplibreFunctionsAndProps=()=>{Object.getOwnPropertyNames(Object.getPrototypeOf(this.map)).forEach(o=>{typeof this[o]>"u"&&(this[o]=(...c)=>r.map[o](...c))}),Object.keys(this.map).forEach(o=>{typeof this[o]>"u"&&(this[o]=r.map[o])})},["getZoom","setZoom","getCenter","setCenter","getBearing","setBearing","getPitch","setPitch","jumpTo","flyTo","panTo","panBy","panBy","zoomTo","zoomIn","zoomOut","getPadding","setPadding","rotateTo","resetNorth","resetNorthPitch","snapToNorth","cameraForBounds","fitBounds","fitScreenCoordinates","getFreeCameraOptions","setFreeCameraOptions","easeTo","stop"].forEach(o=>{this[o]=(...c)=>{if(typeof r.map[o]=="function")return r.map[o].call(r.map,...c)}}),(async()=>{typeof e.mapOptions.style=="string"&&e.mapOptions.style.indexOf("mapbox://")===-1&&await fetch(e.mapOptions.style).then(o=>{if(o.ok)return o.json();throw new Error("error loading map style.json")}).then(o=>{o.layers.forEach(c=>{r.baseLayers.push(c.id),!r.firstSymbolLayer&&c.type==="symbol"&&(r.firstSymbolLayer=c.id)}),r.styleJson=o,e.mapOptions.style=o}).catch(o=>{console.log(o)}),r.map=new TT.Map(e.mapOptions),r.addNativeMaplibreFunctionsAndProps(),r.wrapper.refreshViewport(),r.wrapper.fire("viewportchange"),r.map.on("load",()=>{r.addNativeMaplibreFunctionsAndProps()}),r.map.on("move",()=>{r.wrapper.viewportState=r.wrapper.getViewport(),r.wrapper.fire("viewportchange")}),r.map.on("idle",()=>{r.wrapper.refreshLayerState()}),r.map.on("data",()=>{r.wrapper.refreshLayerState()}),typeof e.onReady=="function"&&e.onReady(r.map,r)})()}}function mp(t,...e){const r=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(n=>r.searchParams.append("args[]",n)),`Minified MUI error #${t}; visit ${r} for the full message.`}const Sh="$$material";function NS(){return NS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},NS.apply(null,arguments)}function Foe(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function Boe(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var zoe=(function(){function t(r){var n=this;this._insertTag=function(i){var a;n.tags.length===0?n.insertionPoint?a=n.insertionPoint.nextSibling:n.prepend?a=n.container.firstChild:a=n.before:a=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,a),n.tags.push(i)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Boe(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=Foe(i);try{a.insertRule(n,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var i;return(i=n.parentNode)==null?void 0:i.removeChild(n)}),this.tags=[],this.ctr=0},t})(),Zu="-ms-",FS="-moz-",Ha="-webkit-",VW="comm",CD="rule",AD="decl",joe="@import",$W="@keyframes",Uoe="@layer",Voe=Math.abs,CT=String.fromCharCode,$oe=Object.assign;function qoe(t,e){return wu(t,0)^45?(((e<<2^wu(t,0))<<2^wu(t,1))<<2^wu(t,2))<<2^wu(t,3):0}function qW(t){return t.trim()}function Hoe(t,e){return(t=e.exec(t))?t[0]:t}function Ga(t,e,r){return t.replace(e,r)}function vM(t,e){return t.indexOf(e)}function wu(t,e){return t.charCodeAt(e)|0}function Ib(t,e,r){return t.slice(e,r)}function sd(t){return t.length}function ID(t){return t.length}function D2(t,e){return e.push(t),t}function Goe(t,e){return t.map(e).join("")}var AT=1,R0=1,HW=0,Oc=0,El=0,u_="";function IT(t,e,r,n,i,a,s){return{value:t,root:e,parent:r,type:n,props:i,children:a,line:AT,column:R0,length:s,return:""}}function K_(t,e){return $oe(IT("",null,null,"",null,null,0),t,{length:-t.length},e)}function Woe(){return El}function Xoe(){return El=Oc>0?wu(u_,--Oc):0,R0--,El===10&&(R0=1,AT--),El}function lf(){return El=Oc<HW?wu(u_,Oc++):0,R0++,El===10&&(R0=1,AT++),El}function gd(){return wu(u_,Oc)}function tS(){return Oc}function _x(t,e){return Ib(u_,t,e)}function Pb(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function GW(t){return AT=R0=1,HW=sd(u_=t),Oc=0,[]}function WW(t){return u_="",t}function rS(t){return qW(_x(Oc-1,_M(t===91?t+2:t===40?t+1:t)))}function Yoe(t){for(;(El=gd())&&El<33;)lf();return Pb(t)>2||Pb(El)>3?"":" "}function Zoe(t,e){for(;--e&&lf()&&!(El<48||El>102||El>57&&El<65||El>70&&El<97););return _x(t,tS()+(e<6&&gd()==32&&lf()==32))}function _M(t){for(;lf();)switch(El){case t:return Oc;case 34:case 39:t!==34&&t!==39&&_M(El);break;case 40:t===41&&_M(t);break;case 92:lf();break}return Oc}function Koe(t,e){for(;lf()&&t+El!==57;)if(t+El===84&&gd()===47)break;return"/*"+_x(e,Oc-1)+"*"+CT(t===47?t:lf())}function Joe(t){for(;!Pb(gd());)lf();return _x(t,Oc)}function Qoe(t){return WW(nS("",null,null,null,[""],t=GW(t),0,[0],t))}function nS(t,e,r,n,i,a,s,o,c){for(var f=0,d=0,m=s,b=0,x=0,E=0,T=1,A=1,R=1,F=0,N="",O=i,U=a,j=n,H=N;A;)switch(E=F,F=lf()){case 40:if(E!=108&&wu(H,m-1)==58){vM(H+=Ga(rS(F),"&","&\f"),"&\f")!=-1&&(R=-1);break}case 34:case 39:case 91:H+=rS(F);break;case 9:case 10:case 13:case 32:H+=Yoe(E);break;case 92:H+=Zoe(tS()-1,7);continue;case 47:switch(gd()){case 42:case 47:D2(ese(Koe(lf(),tS()),e,r),c);break;default:H+="/"}break;case 123*T:o[f++]=sd(H)*R;case 125*T:case 59:case 0:switch(F){case 0:case 125:A=0;case 59+d:R==-1&&(H=Ga(H,/\f/g,"")),x>0&&sd(H)-m&&D2(x>32?RB(H+";",n,r,m-1):RB(Ga(H," ","")+";",n,r,m-2),c);break;case 59:H+=";";default:if(D2(j=kB(H,e,r,f,d,i,o,N,O=[],U=[],m),a),F===123)if(d===0)nS(H,e,j,j,O,a,m,o,U);else switch(b===99&&wu(H,3)===110?100:b){case 100:case 108:case 109:case 115:nS(t,j,j,n&&D2(kB(t,j,j,0,0,i,o,N,i,O=[],m),U),i,U,m,o,n?O:U);break;default:nS(H,j,j,j,[""],U,0,o,U)}}f=d=x=0,T=R=1,N=H="",m=s;break;case 58:m=1+sd(H),x=E;default:if(T<1){if(F==123)--T;else if(F==125&&T++==0&&Xoe()==125)continue}switch(H+=CT(F),F*T){case 38:R=d>0?1:(H+="\f",-1);break;case 44:o[f++]=(sd(H)-1)*R,R=1;break;case 64:gd()===45&&(H+=rS(lf())),b=gd(),d=m=sd(N=H+=Joe(tS())),F++;break;case 45:E===45&&sd(H)==2&&(T=0)}}return a}function kB(t,e,r,n,i,a,s,o,c,f,d){for(var m=i-1,b=i===0?a:[""],x=ID(b),E=0,T=0,A=0;E<n;++E)for(var R=0,F=Ib(t,m+1,m=Voe(T=s[E])),N=t;R<x;++R)(N=qW(T>0?b[R]+" "+F:Ga(F,/&\f/g,b[R])))&&(c[A++]=N);return IT(t,e,r,i===0?CD:o,c,f,d)}function ese(t,e,r){return IT(t,e,r,VW,CT(Woe()),Ib(t,2,-2),0)}function RB(t,e,r,n){return IT(t,e,r,AD,Ib(t,0,n),Ib(t,n+1,-1),n)}function _0(t,e){for(var r="",n=ID(t),i=0;i<n;i++)r+=e(t[i],i,t,e)||"";return r}function tse(t,e,r,n){switch(t.type){case Uoe:if(t.children.length)break;case joe:case AD:return t.return=t.return||t.value;case VW:return"";case $W:return t.return=t.value+"{"+_0(t.children,n)+"}";case CD:t.value=t.props.join(",")}return sd(r=_0(t.children,n))?t.return=t.value+"{"+r+"}":""}function rse(t){var e=ID(t);return function(r,n,i,a){for(var s="",o=0;o<e;o++)s+=t[o](r,n,i,a)||"";return s}}function nse(t){return function(e){e.root||(e=e.return)&&t(e)}}function XW(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var ise=function(e,r,n){for(var i=0,a=0;i=a,a=gd(),i===38&&a===12&&(r[n]=1),!Pb(a);)lf();return _x(e,Oc)},ase=function(e,r){var n=-1,i=44;do switch(Pb(i)){case 0:i===38&&gd()===12&&(r[n]=1),e[n]+=ise(Oc-1,r,n);break;case 2:e[n]+=rS(i);break;case 4:if(i===44){e[++n]=gd()===58?"&\f":"",r[n]=e[n].length;break}default:e[n]+=CT(i)}while(i=lf());return e},ose=function(e,r){return WW(ase(GW(e),r))},DB=new WeakMap,sse=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!DB.get(n))&&!i){DB.set(e,!0);for(var a=[],s=ose(r,a),o=n.props,c=0,f=0;c<s.length;c++)for(var d=0;d<o.length;d++,f++)e.props[f]=a[c]?s[c].replace(/&\f/g,o[d]):o[d]+" "+s[c]}}},lse=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function YW(t,e){switch(qoe(t,e)){case 5103:return Ha+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ha+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Ha+t+FS+t+Zu+t+t;case 6828:case 4268:return Ha+t+Zu+t+t;case 6165:return Ha+t+Zu+"flex-"+t+t;case 5187:return Ha+t+Ga(t,/(\w+).+(:[^]+)/,Ha+"box-$1$2"+Zu+"flex-$1$2")+t;case 5443:return Ha+t+Zu+"flex-item-"+Ga(t,/flex-|-self/,"")+t;case 4675:return Ha+t+Zu+"flex-line-pack"+Ga(t,/align-content|flex-|-self/,"")+t;case 5548:return Ha+t+Zu+Ga(t,"shrink","negative")+t;case 5292:return Ha+t+Zu+Ga(t,"basis","preferred-size")+t;case 6060:return Ha+"box-"+Ga(t,"-grow","")+Ha+t+Zu+Ga(t,"grow","positive")+t;case 4554:return Ha+Ga(t,/([^-])(transform)/g,"$1"+Ha+"$2")+t;case 6187:return Ga(Ga(Ga(t,/(zoom-|grab)/,Ha+"$1"),/(image-set)/,Ha+"$1"),t,"")+t;case 5495:case 3959:return Ga(t,/(image-set\([^]*)/,Ha+"$1$`$1");case 4968:return Ga(Ga(t,/(.+:)(flex-)?(.*)/,Ha+"box-pack:$3"+Zu+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ha+t+t;case 4095:case 3583:case 4068:case 2532:return Ga(t,/(.+)-inline(.+)/,Ha+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(sd(t)-1-e>6)switch(wu(t,e+1)){case 109:if(wu(t,e+4)!==45)break;case 102:return Ga(t,/(.+:)(.+)-([^]+)/,"$1"+Ha+"$2-$3$1"+FS+(wu(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~vM(t,"stretch")?YW(Ga(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(wu(t,e+1)!==115)break;case 6444:switch(wu(t,sd(t)-3-(~vM(t,"!important")&&10))){case 107:return Ga(t,":",":"+Ha)+t;case 101:return Ga(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ha+(wu(t,14)===45?"inline-":"")+"box$3$1"+Ha+"$2$3$1"+Zu+"$2box$3")+t}break;case 5936:switch(wu(t,e+11)){case 114:return Ha+t+Zu+Ga(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Ha+t+Zu+Ga(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Ha+t+Zu+Ga(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Ha+t+Zu+t+t}return t}var use=function(e,r,n,i){if(e.length>-1&&!e.return)switch(e.type){case AD:e.return=YW(e.value,e.length);break;case $W:return _0([K_(e,{value:Ga(e.value,"@","@"+Ha)})],i);case CD:if(e.length)return Goe(e.props,function(a){switch(Hoe(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return _0([K_(e,{props:[Ga(a,/:(read-\w+)/,":"+FS+"$1")]})],i);case"::placeholder":return _0([K_(e,{props:[Ga(a,/:(plac\w+)/,":"+Ha+"input-$1")]}),K_(e,{props:[Ga(a,/:(plac\w+)/,":"+FS+"$1")]}),K_(e,{props:[Ga(a,/:(plac\w+)/,Zu+"input-$1")]})],i)}return""})}},cse=[use],fse=function(e){var r=e.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(T){var A=T.getAttribute("data-emotion");A.indexOf(" ")!==-1&&(document.head.appendChild(T),T.setAttribute("data-s",""))})}var i=e.stylisPlugins||cse,a={},s,o=[];s=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(T){for(var A=T.getAttribute("data-emotion").split(" "),R=1;R<A.length;R++)a[A[R]]=!0;o.push(T)});var c,f=[sse,lse];{var d,m=[tse,nse(function(T){d.insert(T)})],b=rse(f.concat(i,m)),x=function(A){return _0(Qoe(A),b)};c=function(A,R,F,N){d=F,x(A?A+"{"+R.styles+"}":R.styles),N&&(E.inserted[R.name]=!0)}}var E={key:r,sheet:new zoe({key:r,container:s,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:c};return E.sheet.hydrate(o),E},iA={exports:{}},io={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OB;function hse(){if(OB)return io;OB=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,n=t?Symbol.for("react.fragment"):60107,i=t?Symbol.for("react.strict_mode"):60108,a=t?Symbol.for("react.profiler"):60114,s=t?Symbol.for("react.provider"):60109,o=t?Symbol.for("react.context"):60110,c=t?Symbol.for("react.async_mode"):60111,f=t?Symbol.for("react.concurrent_mode"):60111,d=t?Symbol.for("react.forward_ref"):60112,m=t?Symbol.for("react.suspense"):60113,b=t?Symbol.for("react.suspense_list"):60120,x=t?Symbol.for("react.memo"):60115,E=t?Symbol.for("react.lazy"):60116,T=t?Symbol.for("react.block"):60121,A=t?Symbol.for("react.fundamental"):60117,R=t?Symbol.for("react.responder"):60118,F=t?Symbol.for("react.scope"):60119;function N(U){if(typeof U=="object"&&U!==null){var j=U.$$typeof;switch(j){case e:switch(U=U.type,U){case c:case f:case n:case a:case i:case m:return U;default:switch(U=U&&U.$$typeof,U){case o:case d:case E:case x:case s:return U;default:return j}}case r:return j}}}function O(U){return N(U)===f}return io.AsyncMode=c,io.ConcurrentMode=f,io.ContextConsumer=o,io.ContextProvider=s,io.Element=e,io.ForwardRef=d,io.Fragment=n,io.Lazy=E,io.Memo=x,io.Portal=r,io.Profiler=a,io.StrictMode=i,io.Suspense=m,io.isAsyncMode=function(U){return O(U)||N(U)===c},io.isConcurrentMode=O,io.isContextConsumer=function(U){return N(U)===o},io.isContextProvider=function(U){return N(U)===s},io.isElement=function(U){return typeof U=="object"&&U!==null&&U.$$typeof===e},io.isForwardRef=function(U){return N(U)===d},io.isFragment=function(U){return N(U)===n},io.isLazy=function(U){return N(U)===E},io.isMemo=function(U){return N(U)===x},io.isPortal=function(U){return N(U)===r},io.isProfiler=function(U){return N(U)===a},io.isStrictMode=function(U){return N(U)===i},io.isSuspense=function(U){return N(U)===m},io.isValidElementType=function(U){return typeof U=="string"||typeof U=="function"||U===n||U===f||U===a||U===i||U===m||U===b||typeof U=="object"&&U!==null&&(U.$$typeof===E||U.$$typeof===x||U.$$typeof===s||U.$$typeof===o||U.$$typeof===d||U.$$typeof===A||U.$$typeof===R||U.$$typeof===F||U.$$typeof===T)},io.typeOf=N,io}var LB;function dse(){return LB||(LB=1,iA.exports=hse()),iA.exports}var aA,NB;function pse(){if(NB)return aA;NB=1;var t=dse(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};a[t.ForwardRef]=n,a[t.Memo]=i;function s(E){return t.isMemo(E)?i:a[E.$$typeof]||e}var o=Object.defineProperty,c=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,m=Object.getPrototypeOf,b=Object.prototype;function x(E,T,A){if(typeof T!="string"){if(b){var R=m(T);R&&R!==b&&x(E,R,A)}var F=c(T);f&&(F=F.concat(f(T)));for(var N=s(E),O=s(T),U=0;U<F.length;++U){var j=F[U];if(!r[j]&&!(A&&A[j])&&!(O&&O[j])&&!(N&&N[j])){var H=d(T,j);try{o(E,j,H)}catch{}}}}return E}return aA=x,aA}pse();var gse=!0;function ZW(t,e,r){var n="";return r.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(n+=i+" ")}),n}var PD=function(e,r,n){var i=e.key+"-"+r.name;(n===!1||gse===!1)&&e.registered[i]===void 0&&(e.registered[i]=r.styles)},MD=function(e,r,n){PD(e,r,n);var i=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var a=r;do e.insert(r===a?"."+i:"",a,e.sheet,!0),a=a.next;while(a!==void 0)}};function mse(t){for(var e=0,r,n=0,i=t.length;i>=4;++n,i-=4)r=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(n+2)&255)<<16;case 2:e^=(t.charCodeAt(n+1)&255)<<8;case 1:e^=t.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var yse={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},vse=/[A-Z]|^ms/g,_se=/_EMO_([^_]+?)_([^]*?)_EMO_/g,KW=function(e){return e.charCodeAt(1)===45},FB=function(e){return e!=null&&typeof e!="boolean"},oA=XW(function(t){return KW(t)?t:t.replace(vse,"-$&").toLowerCase()}),BB=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(_se,function(n,i,a){return ld={name:i,styles:a,next:ld},i})}return yse[e]!==1&&!KW(e)&&typeof r=="number"&&r!==0?r+"px":r};function Mb(t,e,r){if(r==null)return"";var n=r;if(n.__emotion_styles!==void 0)return n;switch(typeof r){case"boolean":return"";case"object":{var i=r;if(i.anim===1)return ld={name:i.name,styles:i.styles,next:ld},i.name;var a=r;if(a.styles!==void 0){var s=a.next;if(s!==void 0)for(;s!==void 0;)ld={name:s.name,styles:s.styles,next:ld},s=s.next;var o=a.styles+";";return o}return bse(t,e,r)}case"function":{if(t!==void 0){var c=ld,f=r(t);return ld=c,Mb(t,e,f)}break}}var d=r;if(e==null)return d;var m=e[d];return m!==void 0?m:d}function bse(t,e,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=Mb(t,e,r[i])+";";else for(var a in r){var s=r[a];if(typeof s!="object"){var o=s;e!=null&&e[o]!==void 0?n+=a+"{"+e[o]+"}":FB(o)&&(n+=oA(a)+":"+BB(a,o)+";")}else if(Array.isArray(s)&&typeof s[0]=="string"&&(e==null||e[s[0]]===void 0))for(var c=0;c<s.length;c++)FB(s[c])&&(n+=oA(a)+":"+BB(a,s[c])+";");else{var f=Mb(t,e,s);switch(a){case"animation":case"animationName":{n+=oA(a)+":"+f+";";break}default:n+=a+"{"+f+"}"}}}return n}var zB=/label:\s*([^\s;{]+)\s*(;|$)/g,ld;function bx(t,e,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,i="";ld=void 0;var a=t[0];if(a==null||a.raw===void 0)n=!1,i+=Mb(r,e,a);else{var s=a;i+=s[0]}for(var o=1;o<t.length;o++)if(i+=Mb(r,e,t[o]),n){var c=a;i+=c[o]}zB.lastIndex=0;for(var f="",d;(d=zB.exec(i))!==null;)f+="-"+d[1];var m=mse(i)+f;return{name:m,styles:i,next:ld}}var xse=function(e){return e()},JW=LS.useInsertionEffect?LS.useInsertionEffect:!1,QW=JW||xse,jB=JW||te.useLayoutEffect,eX=te.createContext(typeof HTMLElement<"u"?fse({key:"css"}):null);eX.Provider;var kD=function(e){return te.forwardRef(function(r,n){var i=te.useContext(eX);return e(r,i,n)})},xx=te.createContext({}),RD={}.hasOwnProperty,bM="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",wse=function(e,r){var n={};for(var i in r)RD.call(r,i)&&(n[i]=r[i]);return n[bM]=e,n},Sse=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return PD(r,n,i),QW(function(){return MD(r,n,i)}),null},Ese=kD(function(t,e,r){var n=t.css;typeof n=="string"&&e.registered[n]!==void 0&&(n=e.registered[n]);var i=t[bM],a=[n],s="";typeof t.className=="string"?s=ZW(e.registered,a,t.className):t.className!=null&&(s=t.className+" ");var o=bx(a,void 0,te.useContext(xx));s+=e.key+"-"+o.name;var c={};for(var f in t)RD.call(t,f)&&f!=="css"&&f!==bM&&(c[f]=t[f]);return c.className=s,r&&(c.ref=r),te.createElement(te.Fragment,null,te.createElement(Sse,{cache:e,serialized:o,isStringTag:typeof i=="string"}),te.createElement(i,c))}),Tse=Ese,UB=function(e,r){var n=arguments;if(r==null||!RD.call(r,"css"))return te.createElement.apply(void 0,n);var i=n.length,a=new Array(i);a[0]=Tse,a[1]=wse(e,r);for(var s=2;s<i;s++)a[s]=n[s];return te.createElement.apply(null,a)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(UB||(UB={}));var tX=kD(function(t,e){var r=t.styles,n=bx([r],void 0,te.useContext(xx)),i=te.useRef();return jB(function(){var a=e.key+"-global",s=new e.sheet.constructor({key:a,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),o=!1,c=document.querySelector('style[data-emotion="'+a+" "+n.name+'"]');return e.sheet.tags.length&&(s.before=e.sheet.tags[0]),c!==null&&(o=!0,c.setAttribute("data-emotion",a),s.hydrate([c])),i.current=[s,o],function(){s.flush()}},[e]),jB(function(){var a=i.current,s=a[0],o=a[1];if(o){a[1]=!1;return}if(n.next!==void 0&&MD(e,n.next,!0),s.tags.length){var c=s.tags[s.tags.length-1].nextElementSibling;s.before=c,s.flush()}e.insert("",n,s,!1)},[e,n.name]),null});function DD(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return bx(e)}function wx(){var t=DD.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var Cse=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Ase=XW(function(t){return Cse.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),Ise=Ase,Pse=function(e){return e!=="theme"},VB=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?Ise:Pse},$B=function(e,r,n){var i;if(r){var a=r.shouldForwardProp;i=e.__emotion_forwardProp&&a?function(s){return e.__emotion_forwardProp(s)&&a(s)}:a}return typeof i!="function"&&n&&(i=e.__emotion_forwardProp),i},Mse=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return PD(r,n,i),QW(function(){return MD(r,n,i)}),null},kse=function t(e,r){var n=e.__emotion_real===e,i=n&&e.__emotion_base||e,a,s;r!==void 0&&(a=r.label,s=r.target);var o=$B(e,r,n),c=o||VB(i),f=!c("as");return function(){var d=arguments,m=n&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(a!==void 0&&m.push("label:"+a+";"),d[0]==null||d[0].raw===void 0)m.push.apply(m,d);else{var b=d[0];m.push(b[0]);for(var x=d.length,E=1;E<x;E++)m.push(d[E],b[E])}var T=kD(function(A,R,F){var N=f&&A.as||i,O="",U=[],j=A;if(A.theme==null){j={};for(var H in A)j[H]=A[H];j.theme=te.useContext(xx)}typeof A.className=="string"?O=ZW(R.registered,U,A.className):A.className!=null&&(O=A.className+" ");var W=bx(m.concat(U),R.registered,j);O+=R.key+"-"+W.name,s!==void 0&&(O+=" "+s);var X=f&&o===void 0?VB(N):c,oe={};for(var ee in A)f&&ee==="as"||X(ee)&&(oe[ee]=A[ee]);return oe.className=O,F&&(oe.ref=F),te.createElement(te.Fragment,null,te.createElement(Mse,{cache:R,serialized:W,isStringTag:typeof N=="string"}),te.createElement(N,oe))});return T.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",T.defaultProps=e.defaultProps,T.__emotion_real=T,T.__emotion_base=i,T.__emotion_styles=m,T.__emotion_forwardProp=o,Object.defineProperty(T,"toString",{value:function(){return"."+s}}),T.withComponent=function(A,R){var F=t(A,NS({},r,R,{shouldForwardProp:$B(T,R,!0)}));return F.apply(void 0,m)},T}},Rse=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],xM=kse.bind(null);Rse.forEach(function(t){xM[t]=xM(t)});var sA={exports:{}},lA,qB;function Dse(){if(qB)return lA;qB=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return lA=t,lA}var uA,HB;function Ose(){if(HB)return uA;HB=1;var t=Dse();function e(){}function r(){}return r.resetWarningCache=e,uA=function(){function n(s,o,c,f,d,m){if(m!==t){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},uA}var GB;function Lse(){return GB||(GB=1,sA.exports=Ose()()),sA.exports}var Nse=Lse();const kn=Cd(Nse);function Fse(t){return t==null||Object.keys(t).length===0}function rX(t){const{styles:e,defaultTheme:r={}}=t,n=typeof e=="function"?i=>e(Fse(i)?r:i):e;return J.jsx(tX,{styles:n})}function nX(t,e){return xM(t,e)}function Bse(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const WB=[];function yg(t){return WB[0]=t,bx(WB)}var cA={exports:{}},_o={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XB;function zse(){if(XB)return _o;XB=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),b=Symbol.for("react.view_transition"),x=Symbol.for("react.client.reference");function E(T){if(typeof T=="object"&&T!==null){var A=T.$$typeof;switch(A){case t:switch(T=T.type,T){case r:case i:case n:case c:case f:case b:return T;default:switch(T=T&&T.$$typeof,T){case s:case o:case m:case d:return T;case a:return T;default:return A}}case e:return A}}}return _o.ContextConsumer=a,_o.ContextProvider=s,_o.Element=t,_o.ForwardRef=o,_o.Fragment=r,_o.Lazy=m,_o.Memo=d,_o.Portal=e,_o.Profiler=i,_o.StrictMode=n,_o.Suspense=c,_o.SuspenseList=f,_o.isContextConsumer=function(T){return E(T)===a},_o.isContextProvider=function(T){return E(T)===s},_o.isElement=function(T){return typeof T=="object"&&T!==null&&T.$$typeof===t},_o.isForwardRef=function(T){return E(T)===o},_o.isFragment=function(T){return E(T)===r},_o.isLazy=function(T){return E(T)===m},_o.isMemo=function(T){return E(T)===d},_o.isPortal=function(T){return E(T)===e},_o.isProfiler=function(T){return E(T)===i},_o.isStrictMode=function(T){return E(T)===n},_o.isSuspense=function(T){return E(T)===c},_o.isSuspenseList=function(T){return E(T)===f},_o.isValidElementType=function(T){return typeof T=="string"||typeof T=="function"||T===r||T===i||T===n||T===c||T===f||typeof T=="object"&&T!==null&&(T.$$typeof===m||T.$$typeof===d||T.$$typeof===s||T.$$typeof===a||T.$$typeof===o||T.$$typeof===x||T.getModuleId!==void 0)},_o.typeOf=E,_o}var YB;function jse(){return YB||(YB=1,cA.exports=zse()),cA.exports}var iX=jse();function ud(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function aX(t){if(te.isValidElement(t)||iX.isValidElementType(t)||!ud(t))return t;const e={};return Object.keys(t).forEach(r=>{e[r]=aX(t[r])}),e}function ec(t,e,r={clone:!0}){const n=r.clone?{...t}:t;return ud(t)&&ud(e)&&Object.keys(e).forEach(i=>{te.isValidElement(e[i])||iX.isValidElementType(e[i])?n[i]=e[i]:ud(e[i])&&Object.prototype.hasOwnProperty.call(t,i)&&ud(t[i])?n[i]=ec(t[i],e[i],r):r.clone?n[i]=ud(e[i])?aX(e[i]):e[i]:n[i]=e[i]}),n}const Use=t=>{const e=Object.keys(t).map(r=>({key:r,val:t[r]}))||[];return e.sort((r,n)=>r.val-n.val),e.reduce((r,n)=>({...r,[n.key]:n.val}),{})};function Vse(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:n=5,...i}=t,a=Use(e),s=Object.keys(a);function o(b){return`@media (min-width:${typeof e[b]=="number"?e[b]:b}${r})`}function c(b){return`@media (max-width:${(typeof e[b]=="number"?e[b]:b)-n/100}${r})`}function f(b,x){const E=s.indexOf(x);return`@media (min-width:${typeof e[b]=="number"?e[b]:b}${r}) and (max-width:${(E!==-1&&typeof e[s[E]]=="number"?e[s[E]]:x)-n/100}${r})`}function d(b){return s.indexOf(b)+1<s.length?f(b,s[s.indexOf(b)+1]):o(b)}function m(b){const x=s.indexOf(b);return x===0?o(s[1]):x===s.length-1?c(s[x]):f(b,s[s.indexOf(b)+1]).replace("@media","@media not all and")}return{keys:s,values:a,up:o,down:c,between:f,only:d,not:m,unit:r,...i}}function ZB(t,e){if(!t.containerQueries)return e;const r=Object.keys(e).filter(n=>n.startsWith("@container")).sort((n,i)=>{const a=/min-width:\s*([0-9.]+)/;return+(n.match(a)?.[1]||0)-+(i.match(a)?.[1]||0)});return r.length?r.reduce((n,i)=>{const a=e[i];return delete n[i],n[i]=a,n},{...e}):e}function $se(t,e){return e==="@"||e.startsWith("@")&&(t.some(r=>e.startsWith(`@${r}`))||!!e.match(/^@\d/))}function qse(t,e){const r=e.match(/^@([^/]+)?\/?(.+)?$/);if(!r)return null;const[,n,i]=r,a=Number.isNaN(+n)?n||0:+n;return t.containerQueries(i).up(a)}function Hse(t){const e=(a,s)=>a.replace("@media",s?`@container ${s}`:"@container");function r(a,s){a.up=(...o)=>e(t.breakpoints.up(...o),s),a.down=(...o)=>e(t.breakpoints.down(...o),s),a.between=(...o)=>e(t.breakpoints.between(...o),s),a.only=(...o)=>e(t.breakpoints.only(...o),s),a.not=(...o)=>{const c=e(t.breakpoints.not(...o),s);return c.includes("not all and")?c.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):c}}const n={},i=a=>(r(n,a),n);return r(i),{...t,containerQueries:i}}const Gse={borderRadius:4};function rb(t,e){return e?ec(t,e,{clone:!1}):t}const PT={xs:0,sm:600,md:900,lg:1200,xl:1536},KB={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${PT[t]}px)`},Wse={containerQueries:t=>({up:e=>{let r=typeof e=="number"?e:PT[e]||e;return typeof r=="number"&&(r=`${r}px`),t?`@container ${t} (min-width:${r})`:`@container (min-width:${r})`}})};function yp(t,e,r){const n=t.theme||{};if(Array.isArray(e)){const a=n.breakpoints||KB;return e.reduce((s,o,c)=>(s[a.up(a.keys[c])]=r(e[c]),s),{})}if(typeof e=="object"){const a=n.breakpoints||KB;return Object.keys(e).reduce((s,o)=>{if($se(a.keys,o)){const c=qse(n.containerQueries?n:Wse,o);c&&(s[c]=r(e[o],o))}else if(Object.keys(a.values||PT).includes(o)){const c=a.up(o);s[c]=r(e[o],o)}else{const c=o;s[c]=e[c]}return s},{})}return r(e)}function Xse(t={}){return t.keys?.reduce((r,n)=>{const i=t.up(n);return r[i]={},r},{})||{}}function JB(t,e){return t.reduce((r,n)=>{const i=r[n];return(!i||Object.keys(i).length===0)&&delete r[n],r},e)}function un(t){if(typeof t!="string")throw new Error(mp(7));return t.charAt(0).toUpperCase()+t.slice(1)}function MT(t,e,r=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&r){const n=`vars.${e}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,t);if(n!=null)return n}return e.split(".").reduce((n,i)=>n&&n[i]!=null?n[i]:null,t)}function BS(t,e,r,n=r){let i;return typeof t=="function"?i=t(r):Array.isArray(t)?i=t[r]||n:i=MT(t,r)||n,e&&(i=e(i,n,t)),i}function ol(t){const{prop:e,cssProperty:r=t.prop,themeKey:n,transform:i}=t,a=s=>{if(s[e]==null)return null;const o=s[e],c=s.theme,f=MT(c,n)||{};return yp(s,o,m=>{let b=BS(f,i,m);return m===b&&typeof m=="string"&&(b=BS(f,i,`${e}${m==="default"?"":un(m)}`,m)),r===!1?b:{[r]:b}})};return a.propTypes={},a.filterProps=[e],a}function Yse(t){const e={};return r=>(e[r]===void 0&&(e[r]=t(r)),e[r])}const Zse={m:"margin",p:"padding"},Kse={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},QB={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Jse=Yse(t=>{if(t.length>2)if(QB[t])t=QB[t];else return[t];const[e,r]=t.split(""),n=Zse[e],i=Kse[r]||"";return Array.isArray(i)?i.map(a=>n+a):[n+i]}),OD=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],LD=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...OD,...LD];function Sx(t,e,r,n){const i=MT(t,e,!0)??r;return typeof i=="number"||typeof i=="string"?a=>typeof a=="string"?a:typeof i=="string"?i.startsWith("var(")&&a===0?0:i.startsWith("var(")&&a===1?i:`calc(${a} * ${i})`:i*a:Array.isArray(i)?a=>{if(typeof a=="string")return a;const s=Math.abs(a),o=i[s];return a>=0?o:typeof o=="number"?-o:typeof o=="string"&&o.startsWith("var(")?`calc(-1 * ${o})`:`-${o}`}:typeof i=="function"?i:()=>{}}function ND(t){return Sx(t,"spacing",8)}function Ex(t,e){return typeof e=="string"||e==null?e:t(e)}function Qse(t,e){return r=>t.reduce((n,i)=>(n[i]=Ex(e,r),n),{})}function ele(t,e,r,n){if(!e.includes(r))return null;const i=Jse(r),a=Qse(i,n),s=t[r];return yp(t,s,a)}function oX(t,e){const r=ND(t.theme);return Object.keys(t).map(n=>ele(t,e,n,r)).reduce(rb,{})}function Fs(t){return oX(t,OD)}Fs.propTypes={};Fs.filterProps=OD;function Bs(t){return oX(t,LD)}Bs.propTypes={};Bs.filterProps=LD;function sX(t=8,e=ND({spacing:t})){if(t.mui)return t;const r=(...n)=>(n.length===0?[1]:n).map(a=>{const s=e(a);return typeof s=="number"?`${s}px`:s}).join(" ");return r.mui=!0,r}function kT(...t){const e=t.reduce((n,i)=>(i.filterProps.forEach(a=>{n[a]=i}),n),{}),r=n=>Object.keys(n).reduce((i,a)=>e[a]?rb(i,e[a](n)):i,{});return r.propTypes={},r.filterProps=t.reduce((n,i)=>n.concat(i.filterProps),[]),r}function Rf(t){return typeof t!="number"?t:`${t}px solid`}function Kf(t,e){return ol({prop:t,themeKey:"borders",transform:e})}const tle=Kf("border",Rf),rle=Kf("borderTop",Rf),nle=Kf("borderRight",Rf),ile=Kf("borderBottom",Rf),ale=Kf("borderLeft",Rf),ole=Kf("borderColor"),sle=Kf("borderTopColor"),lle=Kf("borderRightColor"),ule=Kf("borderBottomColor"),cle=Kf("borderLeftColor"),fle=Kf("outline",Rf),hle=Kf("outlineColor"),RT=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Sx(t.theme,"shape.borderRadius",4),r=n=>({borderRadius:Ex(e,n)});return yp(t,t.borderRadius,r)}return null};RT.propTypes={};RT.filterProps=["borderRadius"];kT(tle,rle,nle,ile,ale,ole,sle,lle,ule,cle,RT,fle,hle);const DT=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Sx(t.theme,"spacing",8),r=n=>({gap:Ex(e,n)});return yp(t,t.gap,r)}return null};DT.propTypes={};DT.filterProps=["gap"];const OT=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Sx(t.theme,"spacing",8),r=n=>({columnGap:Ex(e,n)});return yp(t,t.columnGap,r)}return null};OT.propTypes={};OT.filterProps=["columnGap"];const LT=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Sx(t.theme,"spacing",8),r=n=>({rowGap:Ex(e,n)});return yp(t,t.rowGap,r)}return null};LT.propTypes={};LT.filterProps=["rowGap"];const dle=ol({prop:"gridColumn"}),ple=ol({prop:"gridRow"}),gle=ol({prop:"gridAutoFlow"}),mle=ol({prop:"gridAutoColumns"}),yle=ol({prop:"gridAutoRows"}),vle=ol({prop:"gridTemplateColumns"}),_le=ol({prop:"gridTemplateRows"}),ble=ol({prop:"gridTemplateAreas"}),xle=ol({prop:"gridArea"});kT(DT,OT,LT,dle,ple,gle,mle,yle,vle,_le,ble,xle);function b0(t,e){return e==="grey"?e:t}const wle=ol({prop:"color",themeKey:"palette",transform:b0}),Sle=ol({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:b0}),Ele=ol({prop:"backgroundColor",themeKey:"palette",transform:b0});kT(wle,Sle,Ele);function nf(t){return t<=1&&t!==0?`${t*100}%`:t}const Tle=ol({prop:"width",transform:nf}),FD=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=r=>{const n=t.theme?.breakpoints?.values?.[r]||PT[r];return n?t.theme?.breakpoints?.unit!=="px"?{maxWidth:`${n}${t.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:nf(r)}};return yp(t,t.maxWidth,e)}return null};FD.filterProps=["maxWidth"];const Cle=ol({prop:"minWidth",transform:nf}),Ale=ol({prop:"height",transform:nf}),Ile=ol({prop:"maxHeight",transform:nf}),Ple=ol({prop:"minHeight",transform:nf});ol({prop:"size",cssProperty:"width",transform:nf});ol({prop:"size",cssProperty:"height",transform:nf});const Mle=ol({prop:"boxSizing"});kT(Tle,FD,Cle,Ale,Ile,Ple,Mle);const Tx={border:{themeKey:"borders",transform:Rf},borderTop:{themeKey:"borders",transform:Rf},borderRight:{themeKey:"borders",transform:Rf},borderBottom:{themeKey:"borders",transform:Rf},borderLeft:{themeKey:"borders",transform:Rf},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Rf},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:RT},color:{themeKey:"palette",transform:b0},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:b0},backgroundColor:{themeKey:"palette",transform:b0},p:{style:Bs},pt:{style:Bs},pr:{style:Bs},pb:{style:Bs},pl:{style:Bs},px:{style:Bs},py:{style:Bs},padding:{style:Bs},paddingTop:{style:Bs},paddingRight:{style:Bs},paddingBottom:{style:Bs},paddingLeft:{style:Bs},paddingX:{style:Bs},paddingY:{style:Bs},paddingInline:{style:Bs},paddingInlineStart:{style:Bs},paddingInlineEnd:{style:Bs},paddingBlock:{style:Bs},paddingBlockStart:{style:Bs},paddingBlockEnd:{style:Bs},m:{style:Fs},mt:{style:Fs},mr:{style:Fs},mb:{style:Fs},ml:{style:Fs},mx:{style:Fs},my:{style:Fs},margin:{style:Fs},marginTop:{style:Fs},marginRight:{style:Fs},marginBottom:{style:Fs},marginLeft:{style:Fs},marginX:{style:Fs},marginY:{style:Fs},marginInline:{style:Fs},marginInlineStart:{style:Fs},marginInlineEnd:{style:Fs},marginBlock:{style:Fs},marginBlockStart:{style:Fs},marginBlockEnd:{style:Fs},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:DT},rowGap:{style:LT},columnGap:{style:OT},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:nf},maxWidth:{style:FD},minWidth:{transform:nf},height:{transform:nf},maxHeight:{transform:nf},minHeight:{transform:nf},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function kle(...t){const e=t.reduce((n,i)=>n.concat(Object.keys(i)),[]),r=new Set(e);return t.every(n=>r.size===Object.keys(n).length)}function Rle(t,e){return typeof t=="function"?t(e):t}function Dle(){function t(r,n,i,a){const s={[r]:n,theme:i},o=a[r];if(!o)return{[r]:n};const{cssProperty:c=r,themeKey:f,transform:d,style:m}=o;if(n==null)return null;if(f==="typography"&&n==="inherit")return{[r]:n};const b=MT(i,f)||{};return m?m(s):yp(s,n,E=>{let T=BS(b,d,E);return E===T&&typeof E=="string"&&(T=BS(b,d,`${r}${E==="default"?"":un(E)}`,E)),c===!1?T:{[c]:T}})}function e(r){const{sx:n,theme:i={},nested:a}=r||{};if(!n)return null;const s=i.unstable_sxConfig??Tx;function o(c){let f=c;if(typeof c=="function")f=c(i);else if(typeof c!="object")return c;if(!f)return null;const d=Xse(i.breakpoints),m=Object.keys(d);let b=d;return Object.keys(f).forEach(x=>{const E=Rle(f[x],i);if(E!=null)if(typeof E=="object")if(s[x])b=rb(b,t(x,E,i,s));else{const T=yp({theme:i},E,A=>({[x]:A}));kle(T,E)?b[x]=e({sx:E,theme:i,nested:!0}):b=rb(b,T)}else b=rb(b,t(x,E,i,s))}),!a&&i.modularCssLayers?{"@layer sx":ZB(i,JB(m,b))}:ZB(i,JB(m,b))}return Array.isArray(n)?n.map(o):o(n)}return e}const Eg=Dle();Eg.filterProps=["sx"];function Ole(t,e){const r=this;if(r.vars){if(!r.colorSchemes?.[t]||typeof r.getColorSchemeSelector!="function")return{};let n=r.getColorSchemeSelector(t);return n==="&"?e:((n.includes("data-")||n.includes("."))&&(n=`*:where(${n.replace(/\s*&$/,"")}) &`),{[n]:e})}return r.palette.mode===t?e:{}}function NT(t={},...e){const{breakpoints:r={},palette:n={},spacing:i,shape:a={},...s}=t,o=Vse(r),c=sX(i);let f=ec({breakpoints:o,direction:"ltr",components:{},palette:{mode:"light",...n},spacing:c,shape:{...Gse,...a}},s);return f=Hse(f),f.applyStyles=Ole,f=e.reduce((d,m)=>ec(d,m),f),f.unstable_sxConfig={...Tx,...s?.unstable_sxConfig},f.unstable_sx=function(m){return Eg({sx:m,theme:this})},f}function Lle(t){return Object.keys(t).length===0}function FT(t=null){const e=te.useContext(xx);return!e||Lle(e)?t:e}const Nle=NT();function Cx(t=Nle){return FT(t)}function fA(t){const e=yg(t);return t!==e&&e.styles?(e.styles.match(/^@layer\s+[^{]*$/)||(e.styles=`@layer global{${e.styles}}`),e):t}function lX({styles:t,themeId:e,defaultTheme:r={}}){const n=Cx(r),i=e&&n[e]||n;let a=typeof t=="function"?t(i):t;return i.modularCssLayers&&(Array.isArray(a)?a=a.map(s=>fA(typeof s=="function"?s(i):s)):a=fA(a)),J.jsx(rX,{styles:a})}const Fle=t=>{const e={systemProps:{},otherProps:{}},r=t?.theme?.unstable_sxConfig??Tx;return Object.keys(t).forEach(n=>{r[n]?e.systemProps[n]=t[n]:e.otherProps[n]=t[n]}),e};function BD(t){const{sx:e,...r}=t,{systemProps:n,otherProps:i}=Fle(r);let a;return Array.isArray(e)?a=[n,...e]:typeof e=="function"?a=(...s)=>{const o=e(...s);return ud(o)?{...n,...o}:n}:a={...n,...e},{...i,sx:a}}const e8=t=>t,Ble=()=>{let t=e8;return{configure(e){t=e},generate(e){return t(e)},reset(){t=e8}}},zD=Ble();function uX(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=uX(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function An(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=uX(t))&&(n&&(n+=" "),n+=e);return n}function cX(t={}){const{themeId:e,defaultTheme:r,defaultClassName:n="MuiBox-root",generateClassName:i}=t,a=nX("div",{shouldForwardProp:o=>o!=="theme"&&o!=="sx"&&o!=="as"})(Eg);return te.forwardRef(function(c,f){const d=Cx(r),{className:m,component:b="div",...x}=BD(c);return J.jsx(a,{as:b,ref:f,className:An(m,i?i(n):n),theme:e&&d[e]||d,...x})})}const zle={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function gi(t,e,r="Mui"){const n=zle[e];return n?`${r}-${n}`:`${zD.generate(t)}-${e}`}function pi(t,e,r="Mui"){const n={};return e.forEach(i=>{n[i]=gi(t,i,r)}),n}const jle=pi("MuiBox",["root"]),Mv=cX({defaultClassName:jle.root,generateClassName:zD.generate});function fX(t){const{variants:e,...r}=t,n={variants:e,style:yg(r),isProcessed:!0};return n.style===r||e&&e.forEach(i=>{typeof i.style!="function"&&(i.style=yg(i.style))}),n}const Ule=NT();function hA(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function Im(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}function Vle(t){return t?(e,r)=>r[t]:null}function $le(t,e,r){t.theme=Hle(t.theme)?r:t.theme[e]||t.theme}function iS(t,e,r){const n=typeof e=="function"?e(t):e;if(Array.isArray(n))return n.flatMap(i=>iS(t,i,r));if(Array.isArray(n?.variants)){let i;if(n.isProcessed)i=r?Im(n.style,r):n.style;else{const{variants:a,...s}=n;i=r?Im(yg(s),r):s}return hX(t,n.variants,[i],r)}return n?.isProcessed?r?Im(yg(n.style),r):n.style:r?Im(yg(n),r):n}function hX(t,e,r=[],n=void 0){let i;e:for(let a=0;a<e.length;a+=1){const s=e[a];if(typeof s.props=="function"){if(i??={...t,...t.ownerState,ownerState:t.ownerState},!s.props(i))continue}else for(const o in s.props)if(t[o]!==s.props[o]&&t.ownerState?.[o]!==s.props[o])continue e;typeof s.style=="function"?(i??={...t,...t.ownerState,ownerState:t.ownerState},r.push(n?Im(yg(s.style(i)),n):s.style(i))):r.push(n?Im(yg(s.style),n):s.style)}return r}function dX(t={}){const{themeId:e,defaultTheme:r=Ule,rootShouldForwardProp:n=hA,slotShouldForwardProp:i=hA}=t;function a(o){$le(o,e,r)}return(o,c={})=>{Bse(o,j=>j.filter(H=>H!==Eg));const{name:f,slot:d,skipVariantsResolver:m,skipSx:b,overridesResolver:x=Vle(Wle(d)),...E}=c,T=f&&f.startsWith("Mui")||d?"components":"custom",A=m!==void 0?m:d&&d!=="Root"&&d!=="root"||!1,R=b||!1;let F=hA;d==="Root"||d==="root"?F=n:d?F=i:Gle(o)&&(F=void 0);const N=nX(o,{shouldForwardProp:F,label:qle(),...E}),O=j=>{if(j.__emotion_real===j)return j;if(typeof j=="function")return function(W){return iS(W,j,W.theme.modularCssLayers?T:void 0)};if(ud(j)){const H=fX(j);return function(X){return H.variants?iS(X,H,X.theme.modularCssLayers?T:void 0):X.theme.modularCssLayers?Im(H.style,T):H.style}}return j},U=(...j)=>{const H=[],W=j.map(O),X=[];if(H.push(a),f&&x&&X.push(function(ae){const fe=ae.theme.components?.[f]?.styleOverrides;if(!fe)return null;const pe={};for(const De in fe)pe[De]=iS(ae,fe[De],ae.theme.modularCssLayers?"theme":void 0);return x(ae,pe)}),f&&!A&&X.push(function(ae){const fe=ae.theme?.components?.[f]?.variants;return fe?hX(ae,fe,[],ae.theme.modularCssLayers?"theme":void 0):null}),R||X.push(Eg),Array.isArray(W[0])){const G=W.shift(),ae=new Array(H.length).fill(""),se=new Array(X.length).fill("");let fe;fe=[...ae,...G,...se],fe.raw=[...ae,...G.raw,...se],H.unshift(fe)}const oe=[...H,...W,...X],ee=N(...oe);return o.muiName&&(ee.muiName=o.muiName),ee};return N.withConfig&&(U.withConfig=N.withConfig),U}}function qle(t,e){return void 0}function Hle(t){for(const e in t)return!1;return!0}function Gle(t){return typeof t=="string"&&t.charCodeAt(0)>96}function Wle(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}const my=dX();function kb(t,e,r=!1){const n={...e};for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const a=i;if(a==="components"||a==="slots")n[a]={...t[a],...n[a]};else if(a==="componentsProps"||a==="slotProps"){const s=t[a],o=e[a];if(!o)n[a]=s||{};else if(!s)n[a]=o;else{n[a]={...o};for(const c in s)if(Object.prototype.hasOwnProperty.call(s,c)){const f=c;n[a][f]=kb(s[f],o[f],r)}}}else a==="className"&&r&&e.className?n.className=An(t?.className,e?.className):a==="style"&&r&&e.style?n.style={...t?.style,...e?.style}:n[a]===void 0&&(n[a]=t[a])}return n}function pX(t){const{theme:e,name:r,props:n}=t;return!e||!e.components||!e.components[r]||!e.components[r].defaultProps?n:kb(e.components[r].defaultProps,n)}function Xle({props:t,name:e,defaultTheme:r,themeId:n}){let i=Cx(r);return n&&(i=i[n]||i),pX({theme:i,name:e,props:t})}const Tu=typeof window<"u"?te.useLayoutEffect:te.useEffect;function Yle(t,e,r,n,i){const[a,s]=te.useState(()=>i&&r?r(t).matches:n?n(t).matches:e);return Tu(()=>{if(!r)return;const o=r(t),c=()=>{s(o.matches)};return c(),o.addEventListener("change",c),()=>{o.removeEventListener("change",c)}},[t,r]),a}const Zle={...LS},gX=Zle.useSyncExternalStore;function Kle(t,e,r,n,i){const a=te.useCallback(()=>e,[e]),s=te.useMemo(()=>{if(i&&r)return()=>r(t).matches;if(n!==null){const{matches:d}=n(t);return()=>d}return a},[a,t,n,i,r]),[o,c]=te.useMemo(()=>{if(r===null)return[a,()=>()=>{}];const d=r(t);return[()=>d.matches,m=>(d.addEventListener("change",m),()=>{d.removeEventListener("change",m)})]},[a,r,t]);return gX(c,o,s)}function mX(t={}){const{themeId:e}=t;return function(n,i={}){let a=FT();a&&e&&(a=a[e]||a);const s=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:o=!1,matchMedia:c=s?window.matchMedia:null,ssrMatchMedia:f=null,noSsr:d=!1}=pX({name:"MuiUseMediaQuery",props:i,theme:a});let m=typeof n=="function"?n(a):n;return m=m.replace(/^@media( ?)/m,""),m.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),(gX!==void 0?Kle:Yle)(m,o,c,f,d)}}mX();function kv(t,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,r))}function jD(t,e=0,r=1){return kv(t,e,r)}function Jle(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let r=t.match(e);return r&&r[0].length===1&&(r=r.map(n=>n+n)),r?`rgb${r.length===4?"a":""}(${r.map((n,i)=>i<3?parseInt(n,16):Math.round(parseInt(n,16)/255*1e3)/1e3).join(", ")})`:""}function Tg(t){if(t.type)return t;if(t.charAt(0)==="#")return Tg(Jle(t));const e=t.indexOf("("),r=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(r))throw new Error(mp(9,t));let n=t.substring(e+1,t.length-1),i;if(r==="color"){if(n=n.split(" "),i=n.shift(),n.length===4&&n[3].charAt(0)==="/"&&(n[3]=n[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(i))throw new Error(mp(10,i))}else n=n.split(",");return n=n.map(a=>parseFloat(a)),{type:r,values:n,colorSpace:i}}const Qle=t=>{const e=Tg(t);return e.values.slice(0,3).map((r,n)=>e.type.includes("hsl")&&n!==0?`${r}%`:r).join(" ")},P1=(t,e)=>{try{return Qle(t)}catch{return t}};function BT(t){const{type:e,colorSpace:r}=t;let{values:n}=t;return e.includes("rgb")?n=n.map((i,a)=>a<3?parseInt(i,10):i):e.includes("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),e.includes("color")?n=`${r} ${n.join(" ")}`:n=`${n.join(", ")}`,`${e}(${n})`}function yX(t){t=Tg(t);const{values:e}=t,r=e[0],n=e[1]/100,i=e[2]/100,a=n*Math.min(i,1-i),s=(f,d=(f+r/30)%12)=>i-a*Math.max(Math.min(d-3,9-d,1),-1);let o="rgb";const c=[Math.round(s(0)*255),Math.round(s(8)*255),Math.round(s(4)*255)];return t.type==="hsla"&&(o+="a",c.push(e[3])),BT({type:o,values:c})}function wM(t){t=Tg(t);let e=t.type==="hsl"||t.type==="hsla"?Tg(yX(t)).values:t.values;return e=e.map(r=>(t.type!=="color"&&(r/=255),r<=.03928?r/12.92:((r+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function eue(t,e){const r=wM(t),n=wM(e);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}function zS(t,e){return t=Tg(t),e=jD(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,BT(t)}function um(t,e,r){try{return zS(t,e)}catch{return t}}function zT(t,e){if(t=Tg(t),e=jD(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]*=1-e;return BT(t)}function fo(t,e,r){try{return zT(t,e)}catch{return t}}function jT(t,e){if(t=Tg(t),e=jD(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let r=0;r<3;r+=1)t.values[r]+=(255-t.values[r])*e;else if(t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]+=(1-t.values[r])*e;return BT(t)}function ho(t,e,r){try{return jT(t,e)}catch{return t}}function SM(t,e=.15){return wM(t)>.5?zT(t,e):jT(t,e)}function O2(t,e,r){try{return SM(t,e)}catch{return t}}const vX=te.createContext(null);function UD(){return te.useContext(vX)}const tue=typeof Symbol=="function"&&Symbol.for,rue=tue?Symbol.for("mui.nested"):"__THEME_NESTED__";function nue(t,e){return typeof e=="function"?e(t):{...t,...e}}function iue(t){const{children:e,theme:r}=t,n=UD(),i=te.useMemo(()=>{const a=n===null?{...r}:nue(n,r);return a!=null&&(a[rue]=n!==null),a},[r,n]);return J.jsx(vX.Provider,{value:i,children:e})}const _X=te.createContext();function aue({value:t,...e}){return J.jsx(_X.Provider,{value:t??!0,...e})}const Ax=()=>te.useContext(_X)??!1,bX=te.createContext(void 0);function oue({value:t,children:e}){return J.jsx(bX.Provider,{value:t,children:e})}function sue(t){const{theme:e,name:r,props:n}=t;if(!e||!e.components||!e.components[r])return n;const i=e.components[r];return i.defaultProps?kb(i.defaultProps,n,e.components.mergeClassNameAndStyle):!i.styleOverrides&&!i.variants?kb(i,n,e.components.mergeClassNameAndStyle):n}function lue({props:t,name:e}){const r=te.useContext(bX);return sue({props:t,name:e,theme:{components:r}})}let t8=0;function uue(t){const[e,r]=te.useState(t),n=t||e;return te.useEffect(()=>{e==null&&(t8+=1,r(`mui-${t8}`))},[e]),n}const cue={...LS},r8=cue.useId;function Og(t){if(r8!==void 0){const e=r8();return t??e}return uue(t)}function fue(t){const e=FT(),r=Og()||"",{modularCssLayers:n}=t;let i="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!n||e!==null?i="":typeof n=="string"?i=n.replace(/mui(?!\.)/g,i):i=`@layer ${i};`,Tu(()=>{const a=document.querySelector("head");if(!a)return;const s=a.firstChild;if(i){if(s&&s.hasAttribute?.("data-mui-layer-order")&&s.getAttribute("data-mui-layer-order")===r)return;const o=document.createElement("style");o.setAttribute("data-mui-layer-order",r),o.textContent=i,a.prepend(o)}else a.querySelector(`style[data-mui-layer-order="${r}"]`)?.remove()},[i,r]),i?J.jsx(lX,{styles:i}):null}const n8={};function i8(t,e,r,n=!1){return te.useMemo(()=>{const i=t&&e[t]||e;if(typeof r=="function"){const a=r(i),s=t?{...e,[t]:a}:a;return n?()=>s:s}return t?{...e,[t]:r}:{...e,...r}},[t,e,r,n])}function xX(t){const{children:e,theme:r,themeId:n}=t,i=FT(n8),a=UD()||n8,s=i8(n,i,r),o=i8(n,a,r,!0),c=(n?s[n]:s).direction==="rtl",f=fue(s);return J.jsx(iue,{theme:o,children:J.jsx(xx.Provider,{value:s,children:J.jsx(aue,{value:c,children:J.jsxs(oue,{value:n?s[n].components:s.components,children:[f,e]})})})})}const a8={theme:void 0};function hue(t){let e,r;return function(i){let a=e;return(a===void 0||i.theme!==r)&&(a8.theme=i.theme,a=fX(t(a8)),e=a,r=i.theme),a}}const VD="mode",$D="color-scheme",due="data-color-scheme";function pue(t){const{defaultMode:e="system",defaultLightColorScheme:r="light",defaultDarkColorScheme:n="dark",modeStorageKey:i=VD,colorSchemeStorageKey:a=$D,attribute:s=due,colorSchemeNode:o="document.documentElement",nonce:c}=t||{};let f="",d=s;if(s==="class"&&(d=".%s"),s==="data"&&(d="[data-%s]"),d.startsWith(".")){const b=d.substring(1);f+=`${o}.classList.remove('${b}'.replace('%s', light), '${b}'.replace('%s', dark));
      ${o}.classList.add('${b}'.replace('%s', colorScheme));`}const m=d.match(/\[([^[\]]+)\]/);if(m){const[b,x]=m[1].split("=");x||(f+=`${o}.removeAttribute('${b}'.replace('%s', light));
      ${o}.removeAttribute('${b}'.replace('%s', dark));`),f+=`
      ${o}.setAttribute('${b}'.replace('%s', colorScheme), ${x?`${x}.replace('%s', colorScheme)`:'""'});`}else f+=`${o}.setAttribute('${d}', colorScheme);`;return J.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?c:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${i}') || '${e}';
  const dark = localStorage.getItem('${a}-dark') || '${n}';
  const light = localStorage.getItem('${a}-light') || '${r}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${f}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function gue(){}const mue=({key:t,storageWindow:e})=>(!e&&typeof window<"u"&&(e=window),{get(r){if(typeof window>"u")return;if(!e)return r;let n;try{n=e.localStorage.getItem(t)}catch{}return n||r},set:r=>{if(e)try{e.localStorage.setItem(t,r)}catch{}},subscribe:r=>{if(!e)return gue;const n=i=>{const a=i.newValue;i.key===t&&r(a)};return e.addEventListener("storage",n),()=>{e.removeEventListener("storage",n)}}});function dA(){}function o8(t){if(typeof window<"u"&&typeof window.matchMedia=="function"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function wX(t,e){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return e("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return e("dark")}function yue(t){return wX(t,e=>{if(e==="light")return t.lightColorScheme;if(e==="dark")return t.darkColorScheme})}function vue(t){const{defaultMode:e="light",defaultLightColorScheme:r,defaultDarkColorScheme:n,supportedColorSchemes:i=[],modeStorageKey:a=VD,colorSchemeStorageKey:s=$D,storageWindow:o=typeof window>"u"?void 0:window,storageManager:c=mue,noSsr:f=!1}=t,d=i.join(","),m=i.length>1,b=te.useMemo(()=>c?.({key:a,storageWindow:o}),[c,a,o]),x=te.useMemo(()=>c?.({key:`${s}-light`,storageWindow:o}),[c,s,o]),E=te.useMemo(()=>c?.({key:`${s}-dark`,storageWindow:o}),[c,s,o]),[T,A]=te.useState(()=>{const W=b?.get(e)||e,X=x?.get(r)||r,oe=E?.get(n)||n;return{mode:W,systemMode:o8(W),lightColorScheme:X,darkColorScheme:oe}}),[R,F]=te.useState(f||!m);te.useEffect(()=>{F(!0)},[]);const N=yue(T),O=te.useCallback(W=>{A(X=>{if(W===X.mode)return X;const oe=W??e;return b?.set(oe),{...X,mode:oe,systemMode:o8(oe)}})},[b,e]),U=te.useCallback(W=>{W?typeof W=="string"?W&&!d.includes(W)?console.error(`\`${W}\` does not exist in \`theme.colorSchemes\`.`):A(X=>{const oe={...X};return wX(X,ee=>{ee==="light"&&(x?.set(W),oe.lightColorScheme=W),ee==="dark"&&(E?.set(W),oe.darkColorScheme=W)}),oe}):A(X=>{const oe={...X},ee=W.light===null?r:W.light,G=W.dark===null?n:W.dark;return ee&&(d.includes(ee)?(oe.lightColorScheme=ee,x?.set(ee)):console.error(`\`${ee}\` does not exist in \`theme.colorSchemes\`.`)),G&&(d.includes(G)?(oe.darkColorScheme=G,E?.set(G)):console.error(`\`${G}\` does not exist in \`theme.colorSchemes\`.`)),oe}):A(X=>(x?.set(r),E?.set(n),{...X,lightColorScheme:r,darkColorScheme:n}))},[d,x,E,r,n]),j=te.useCallback(W=>{T.mode==="system"&&A(X=>{const oe=W?.matches?"dark":"light";return X.systemMode===oe?X:{...X,systemMode:oe}})},[T.mode]),H=te.useRef(j);return H.current=j,te.useEffect(()=>{if(typeof window.matchMedia!="function"||!m)return;const W=(...oe)=>H.current(...oe),X=window.matchMedia("(prefers-color-scheme: dark)");return X.addListener(W),W(X),()=>{X.removeListener(W)}},[m]),te.useEffect(()=>{if(m){const W=b?.subscribe(ee=>{(!ee||["light","dark","system"].includes(ee))&&O(ee||e)})||dA,X=x?.subscribe(ee=>{(!ee||d.match(ee))&&U({light:ee})})||dA,oe=E?.subscribe(ee=>{(!ee||d.match(ee))&&U({dark:ee})})||dA;return()=>{W(),X(),oe()}}},[U,O,d,e,o,m,b,x,E]),{...T,mode:R?T.mode:void 0,systemMode:R?T.systemMode:void 0,colorScheme:R?N:void 0,setMode:O,setColorScheme:U}}const _ue="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function bue(t){const{themeId:e,theme:r={},modeStorageKey:n=VD,colorSchemeStorageKey:i=$D,disableTransitionOnChange:a=!1,defaultColorScheme:s,resolveTheme:o}=t,c={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},f=te.createContext(void 0),d=()=>te.useContext(f)||c,m={},b={};function x(R){const{children:F,theme:N,modeStorageKey:O=n,colorSchemeStorageKey:U=i,disableTransitionOnChange:j=a,storageManager:H,storageWindow:W=typeof window>"u"?void 0:window,documentNode:X=typeof document>"u"?void 0:document,colorSchemeNode:oe=typeof document>"u"?void 0:document.documentElement,disableNestedContext:ee=!1,disableStyleSheetGeneration:G=!1,defaultMode:ae="system",forceThemeRerender:se=!1,noSsr:fe}=R,pe=te.useRef(!1),De=UD(),ye=te.useContext(f),we=!!ye&&!ee,Te=te.useMemo(()=>N||(typeof r=="function"?r():r),[N]),Re=Te[e],de=Re||Te,{colorSchemes:Ee=m,components:xe=b,cssVarPrefix:Ne}=de,Fe=Object.keys(Ee).filter(at=>!!Ee[at]).join(","),Xe=te.useMemo(()=>Fe.split(","),[Fe]),Be=typeof s=="string"?s:s.light,ot=typeof s=="string"?s:s.dark,Ke=Ee[Be]&&Ee[ot]?ae:Ee[de.defaultColorScheme]?.palette?.mode||de.palette?.mode,{mode:it,setMode:Me,systemMode:zt,lightColorScheme:st,darkColorScheme:$e,colorScheme:Jt,setColorScheme:Ht}=vue({supportedColorSchemes:Xe,defaultLightColorScheme:Be,defaultDarkColorScheme:ot,modeStorageKey:O,colorSchemeStorageKey:U,defaultMode:Ke,storageManager:H,storageWindow:W,noSsr:fe});let pr=it,_t=Jt;we&&(pr=ye.mode,_t=ye.colorScheme);let vr=_t||de.defaultColorScheme;de.vars&&!se&&(vr=de.defaultColorScheme);const br=te.useMemo(()=>{const at=de.generateThemeVars?.()||de.vars,Pe={...de,components:xe,colorSchemes:Ee,cssVarPrefix:Ne,vars:at};if(typeof Pe.generateSpacing=="function"&&(Pe.spacing=Pe.generateSpacing()),vr){const be=Ee[vr];be&&typeof be=="object"&&Object.keys(be).forEach(je=>{be[je]&&typeof be[je]=="object"?Pe[je]={...Pe[je],...be[je]}:Pe[je]=be[je]})}return o?o(Pe):Pe},[de,vr,xe,Ee,Ne]),lr=de.colorSchemeSelector;Tu(()=>{if(_t&&oe&&lr&&lr!=="media"){const at=lr;let Pe=lr;if(at==="class"&&(Pe=".%s"),at==="data"&&(Pe="[data-%s]"),at?.startsWith("data-")&&!at.includes("%s")&&(Pe=`[${at}="%s"]`),Pe.startsWith("."))oe.classList.remove(...Xe.map(be=>Pe.substring(1).replace("%s",be))),oe.classList.add(Pe.substring(1).replace("%s",_t));else{const be=Pe.replace("%s",_t).match(/\[([^\]]+)\]/);if(be){const[je,qe]=be[1].split("=");qe||Xe.forEach(Ge=>{oe.removeAttribute(je.replace(_t,Ge))}),oe.setAttribute(je,qe?qe.replace(/"|'/g,""):"")}else oe.setAttribute(Pe,_t)}}},[_t,lr,oe,Xe]),te.useEffect(()=>{let at;if(j&&pe.current&&X){const Pe=X.createElement("style");Pe.appendChild(X.createTextNode(_ue)),X.head.appendChild(Pe),window.getComputedStyle(X.body),at=setTimeout(()=>{X.head.removeChild(Pe)},1)}return()=>{clearTimeout(at)}},[_t,j,X]),te.useEffect(()=>(pe.current=!0,()=>{pe.current=!1}),[]);const Cr=te.useMemo(()=>({allColorSchemes:Xe,colorScheme:_t,darkColorScheme:$e,lightColorScheme:st,mode:pr,setColorScheme:Ht,setMode:Me,systemMode:zt}),[Xe,_t,$e,st,pr,Ht,Me,zt,br.colorSchemeSelector]);let Tr=!0;(G||de.cssVariables===!1||we&&De?.cssVarPrefix===Ne)&&(Tr=!1);const Qt=J.jsxs(te.Fragment,{children:[J.jsx(xX,{themeId:Re?e:void 0,theme:br,children:F}),Tr&&J.jsx(rX,{styles:br.generateStyleSheets?.()||[]})]});return we?Qt:J.jsx(f.Provider,{value:Cr,children:Qt})}const E=typeof s=="string"?s:s.light,T=typeof s=="string"?s:s.dark;return{CssVarsProvider:x,useColorScheme:d,getInitColorSchemeScript:R=>pue({colorSchemeStorageKey:i,defaultLightColorScheme:E,defaultDarkColorScheme:T,modeStorageKey:n,...R})}}function xue(t=""){function e(...n){if(!n.length)return"";const i=n[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${i}${e(...n.slice(1))})`:`, ${i}`}return(n,...i)=>`var(--${t?`${t}-`:""}${n}${e(...i)})`}const s8=(t,e,r,n=[])=>{let i=t;e.forEach((a,s)=>{s===e.length-1?Array.isArray(i)?i[Number(a)]=r:i&&typeof i=="object"&&(i[a]=r):i&&typeof i=="object"&&(i[a]||(i[a]=n.includes(a)?[]:{}),i=i[a])})},wue=(t,e,r)=>{function n(i,a=[],s=[]){Object.entries(i).forEach(([o,c])=>{(!r||r&&!r([...a,o]))&&c!=null&&(typeof c=="object"&&Object.keys(c).length>0?n(c,[...a,o],Array.isArray(c)?[...s,o]:s):e([...a,o],c,s))})}n(t)},Sue=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(n=>t.includes(n))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function pA(t,e){const{prefix:r,shouldSkipGeneratingVar:n}=e||{},i={},a={},s={};return wue(t,(o,c,f)=>{if((typeof c=="string"||typeof c=="number")&&(!n||!n(o,c))){const d=`--${r?`${r}-`:""}${o.join("-")}`,m=Sue(o,c);Object.assign(i,{[d]:m}),s8(a,o,`var(${d})`,f),s8(s,o,`var(${d}, ${m})`,f)}},o=>o[0]==="vars"),{css:i,vars:a,varsWithDefaults:s}}function Eue(t,e={}){const{getSelector:r=R,disableCssColorScheme:n,colorSchemeSelector:i,enableContrastVars:a}=e,{colorSchemes:s={},components:o,defaultColorScheme:c="light",...f}=t,{vars:d,css:m,varsWithDefaults:b}=pA(f,e);let x=b;const E={},{[c]:T,...A}=s;if(Object.entries(A||{}).forEach(([O,U])=>{const{vars:j,css:H,varsWithDefaults:W}=pA(U,e);x=ec(x,W),E[O]={css:H,vars:j}}),T){const{css:O,vars:U,varsWithDefaults:j}=pA(T,e);x=ec(x,j),E[c]={css:O,vars:U}}function R(O,U){let j=i;if(i==="class"&&(j=".%s"),i==="data"&&(j="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(j=`[${i}="%s"]`),O){if(j==="media")return t.defaultColorScheme===O?":root":{[`@media (prefers-color-scheme: ${s[O]?.palette?.mode||O})`]:{":root":U}};if(j)return t.defaultColorScheme===O?`:root, ${j.replace("%s",String(O))}`:j.replace("%s",String(O))}return":root"}return{vars:x,generateThemeVars:()=>{let O={...d};return Object.entries(E).forEach(([,{vars:U}])=>{O=ec(O,U)}),O},generateStyleSheets:()=>{const O=[],U=t.defaultColorScheme||"light";function j(X,oe){Object.keys(oe).length&&O.push(typeof X=="string"?{[X]:{...oe}}:X)}j(r(void 0,{...m}),m);const{[U]:H,...W}=E;if(H){const{css:X}=H,oe=s[U]?.palette?.mode,ee=!n&&oe?{colorScheme:oe,...X}:{...X};j(r(U,{...ee}),ee)}return Object.entries(W).forEach(([X,{css:oe}])=>{const ee=s[X]?.palette?.mode,G=!n&&ee?{colorScheme:ee,...oe}:{...oe};j(r(X,{...G}),G)}),a&&O.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),O}}}function Tue(t){return function(r){return t==="media"?`@media (prefers-color-scheme: ${r})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${r}"] &`:t==="class"?`.${r} &`:t==="data"?`[data-${r}] &`:`${t.replace("%s",r)} &`:"&"}}function mi(t,e,r=void 0){const n={};for(const i in t){const a=t[i];let s="",o=!0;for(let c=0;c<a.length;c+=1){const f=a[c];f&&(s+=(o===!0?"":" ")+e(f),o=!1,r&&r[f]&&(s+=" "+r[f]))}n[i]=s}return n}function nb(t,e){return te.isValidElement(t)&&e.indexOf(t.type.muiName??t.type?._payload?.value?.muiName)!==-1}const Cue=(t,e)=>t.filter(r=>e.includes(r)),c_=(t,e,r)=>{const n=t.keys[0];Array.isArray(e)?e.forEach((i,a)=>{r((s,o)=>{a<=t.keys.length-1&&(a===0?Object.assign(s,o):s[t.up(t.keys[a])]=o)},i)}):e&&typeof e=="object"?(Object.keys(e).length>t.keys.length?t.keys:Cue(t.keys,Object.keys(e))).forEach(a=>{if(t.keys.includes(a)){const s=e[a];s!==void 0&&r((o,c)=>{n===a?Object.assign(o,c):o[t.up(a)]=c},s)}}):(typeof e=="number"||typeof e=="string")&&r((i,a)=>{Object.assign(i,a)},e)};function jS(t){return`--Grid-${t}Spacing`}function UT(t){return`--Grid-parent-${t}Spacing`}const l8="--Grid-columns",x0="--Grid-parent-columns",Aue=({theme:t,ownerState:e})=>{const r={};return c_(t.breakpoints,e.size,(n,i)=>{let a={};i==="grow"&&(a={flexBasis:0,flexGrow:1,maxWidth:"100%"}),i==="auto"&&(a={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof i=="number"&&(a={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${i} / var(${x0}) - (var(${x0}) - ${i}) * (var(${UT("column")}) / var(${x0})))`}),n(r,a)}),r},Iue=({theme:t,ownerState:e})=>{const r={};return c_(t.breakpoints,e.offset,(n,i)=>{let a={};i==="auto"&&(a={marginLeft:"auto"}),typeof i=="number"&&(a={marginLeft:i===0?"0px":`calc(100% * ${i} / var(${x0}) + var(${UT("column")}) * ${i} / var(${x0}))`}),n(r,a)}),r},Pue=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={[l8]:12};return c_(t.breakpoints,e.columns,(n,i)=>{const a=i??12;n(r,{[l8]:a,"> *":{[x0]:a}})}),r},Mue=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return c_(t.breakpoints,e.rowSpacing,(n,i)=>{const a=typeof i=="string"?i:t.spacing?.(i);n(r,{[jS("row")]:a,"> *":{[UT("row")]:a}})}),r},kue=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return c_(t.breakpoints,e.columnSpacing,(n,i)=>{const a=typeof i=="string"?i:t.spacing?.(i);n(r,{[jS("column")]:a,"> *":{[UT("column")]:a}})}),r},Rue=({theme:t,ownerState:e})=>{if(!e.container)return{};const r={};return c_(t.breakpoints,e.direction,(n,i)=>{n(r,{flexDirection:i})}),r},Due=({ownerState:t})=>({minWidth:0,boxSizing:"border-box",...t.container&&{display:"flex",flexWrap:"wrap",...t.wrap&&t.wrap!=="wrap"&&{flexWrap:t.wrap},gap:`var(${jS("row")}) var(${jS("column")})`}}),Oue=t=>{const e=[];return Object.entries(t).forEach(([r,n])=>{n!==!1&&n!==void 0&&e.push(`grid-${r}-${String(n)}`)}),e},Lue=(t,e="xs")=>{function r(n){return n===void 0?!1:typeof n=="string"&&!Number.isNaN(Number(n))||typeof n=="number"&&n>0}if(r(t))return[`spacing-${e}-${String(t)}`];if(typeof t=="object"&&!Array.isArray(t)){const n=[];return Object.entries(t).forEach(([i,a])=>{r(a)&&n.push(`spacing-${i}-${String(a)}`)}),n}return[]},Nue=t=>t===void 0?[]:typeof t=="object"?Object.entries(t).map(([e,r])=>`direction-${e}-${r}`):[`direction-xs-${String(t)}`];function Fue(t,e){t.item!==void 0&&delete t.item,t.zeroMinWidth!==void 0&&delete t.zeroMinWidth,e.keys.forEach(r=>{t[r]!==void 0&&delete t[r]})}const Bue=NT(),zue=my("div",{name:"MuiGrid",slot:"Root"});function jue(t){return Xle({props:t,name:"MuiGrid",defaultTheme:Bue})}function Uue(t={}){const{createStyledComponent:e=zue,useThemeProps:r=jue,useTheme:n=Cx,componentName:i="MuiGrid"}=t,a=(f,d)=>{const{container:m,direction:b,spacing:x,wrap:E,size:T}=f,A={root:["root",m&&"container",E!=="wrap"&&`wrap-xs-${String(E)}`,...Nue(b),...Oue(T),...m?Lue(x,d.breakpoints.keys[0]):[]]};return mi(A,R=>gi(i,R),{})};function s(f,d,m=()=>!0){const b={};return f===null||(Array.isArray(f)?f.forEach((x,E)=>{x!==null&&m(x)&&d.keys[E]&&(b[d.keys[E]]=x)}):typeof f=="object"?Object.keys(f).forEach(x=>{const E=f[x];E!=null&&m(E)&&(b[x]=E)}):b[d.keys[0]]=f),b}const o=e(Pue,kue,Mue,Aue,Rue,Due,Iue),c=te.forwardRef(function(d,m){const b=n(),x=r(d),E=BD(x);Fue(E,b.breakpoints);const{className:T,children:A,columns:R=12,container:F=!1,component:N="div",direction:O="row",wrap:U="wrap",size:j={},offset:H={},spacing:W=0,rowSpacing:X=W,columnSpacing:oe=W,unstable_level:ee=0,...G}=E,ae=s(j,b.breakpoints,Re=>Re!==!1),se=s(H,b.breakpoints),fe=d.columns??(ee?void 0:R),pe=d.spacing??(ee?void 0:W),De=d.rowSpacing??d.spacing??(ee?void 0:X),ye=d.columnSpacing??d.spacing??(ee?void 0:oe),we={...E,level:ee,columns:fe,container:F,direction:O,wrap:U,spacing:pe,rowSpacing:De,columnSpacing:ye,size:ae,offset:se},Te=a(we,b);return J.jsx(o,{ref:m,as:N,ownerState:we,className:An(Te.root,T),...G,children:te.Children.map(A,Re=>te.isValidElement(Re)&&nb(Re,["Grid"])&&F&&Re.props.container?te.cloneElement(Re,{unstable_level:Re.props?.unstable_level??ee+1}):Re)})});return c.muiName="Grid",c}const Rb={black:"#000",white:"#fff"},Vue={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},av={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},ov={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},J_={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},sv={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},lv={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},uv={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function SX(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Rb.white,default:Rb.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const EX=SX();function TX(){return{text:{primary:Rb.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Rb.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const EM=TX();function u8(t,e,r,n){const i=n.light||n,a=n.dark||n*1.5;t[e]||(t.hasOwnProperty(r)?t[e]=t[r]:e==="light"?t.light=jT(t.main,i):e==="dark"&&(t.dark=zT(t.main,a)))}function c8(t,e,r,n,i){const a=i.light||i,s=i.dark||i*1.5;e[r]||(e.hasOwnProperty(n)?e[r]=e[n]:r==="light"?e.light=`color-mix(in ${t}, ${e.main}, #fff ${(a*100).toFixed(0)}%)`:r==="dark"&&(e.dark=`color-mix(in ${t}, ${e.main}, #000 ${(s*100).toFixed(0)}%)`))}function $ue(t="light"){return t==="dark"?{main:sv[200],light:sv[50],dark:sv[400]}:{main:sv[700],light:sv[400],dark:sv[800]}}function que(t="light"){return t==="dark"?{main:av[200],light:av[50],dark:av[400]}:{main:av[500],light:av[300],dark:av[700]}}function Hue(t="light"){return t==="dark"?{main:ov[500],light:ov[300],dark:ov[700]}:{main:ov[700],light:ov[400],dark:ov[800]}}function Gue(t="light"){return t==="dark"?{main:lv[400],light:lv[300],dark:lv[700]}:{main:lv[700],light:lv[500],dark:lv[900]}}function Wue(t="light"){return t==="dark"?{main:uv[400],light:uv[300],dark:uv[700]}:{main:uv[800],light:uv[500],dark:uv[900]}}function Xue(t="light"){return t==="dark"?{main:J_[400],light:J_[300],dark:J_[700]}:{main:"#ed6c02",light:J_[500],dark:J_[900]}}function Yue(t){return`oklch(from ${t} var(--__l) 0 h / var(--__a))`}function qD(t){const{mode:e="light",contrastThreshold:r=3,tonalOffset:n=.2,colorSpace:i,...a}=t,s=t.primary||$ue(e),o=t.secondary||que(e),c=t.error||Hue(e),f=t.info||Gue(e),d=t.success||Wue(e),m=t.warning||Xue(e);function b(A){return i?Yue(A):eue(A,EM.text.primary)>=r?EM.text.primary:EX.text.primary}const x=({color:A,name:R,mainShade:F=500,lightShade:N=300,darkShade:O=700})=>{if(A={...A},!A.main&&A[F]&&(A.main=A[F]),!A.hasOwnProperty("main"))throw new Error(mp(11,R?` (${R})`:"",F));if(typeof A.main!="string")throw new Error(mp(12,R?` (${R})`:"",JSON.stringify(A.main)));return i?(c8(i,A,"light",N,n),c8(i,A,"dark",O,n)):(u8(A,"light",N,n),u8(A,"dark",O,n)),A.contrastText||(A.contrastText=b(A.main)),A};let E;return e==="light"?E=SX():e==="dark"&&(E=TX()),ec({common:{...Rb},mode:e,primary:x({color:s,name:"primary"}),secondary:x({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:x({color:c,name:"error"}),warning:x({color:m,name:"warning"}),info:x({color:f,name:"info"}),success:x({color:d,name:"success"}),grey:Vue,contrastThreshold:r,getContrastText:b,augmentColor:x,tonalOffset:n,...E},a)}function Zue(t){const e={};return Object.entries(t).forEach(n=>{const[i,a]=n;typeof a=="object"&&(e[i]=`${a.fontStyle?`${a.fontStyle} `:""}${a.fontVariant?`${a.fontVariant} `:""}${a.fontWeight?`${a.fontWeight} `:""}${a.fontStretch?`${a.fontStretch} `:""}${a.fontSize||""}${a.lineHeight?`/${a.lineHeight} `:""}${a.fontFamily||""}`)}),e}function Kue(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function Jue(t){return Math.round(t*1e5)/1e5}const f8={textTransform:"uppercase"},h8='"Roboto", "Helvetica", "Arial", sans-serif';function CX(t,e){const{fontFamily:r=h8,fontSize:n=14,fontWeightLight:i=300,fontWeightRegular:a=400,fontWeightMedium:s=500,fontWeightBold:o=700,htmlFontSize:c=16,allVariants:f,pxToRem:d,...m}=typeof e=="function"?e(t):e,b=n/14,x=d||(A=>`${A/c*b}rem`),E=(A,R,F,N,O)=>({fontFamily:r,fontWeight:A,fontSize:x(R),lineHeight:F,...r===h8?{letterSpacing:`${Jue(N/R)}em`}:{},...O,...f}),T={h1:E(i,96,1.167,-1.5),h2:E(i,60,1.2,-.5),h3:E(a,48,1.167,0),h4:E(a,34,1.235,.25),h5:E(a,24,1.334,0),h6:E(s,20,1.6,.15),subtitle1:E(a,16,1.75,.15),subtitle2:E(s,14,1.57,.1),body1:E(a,16,1.5,.15),body2:E(a,14,1.43,.15),button:E(s,14,1.75,.4,f8),caption:E(a,12,1.66,.4),overline:E(a,12,2.66,1,f8),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ec({htmlFontSize:c,pxToRem:x,fontFamily:r,fontSize:n,fontWeightLight:i,fontWeightRegular:a,fontWeightMedium:s,fontWeightBold:o,...T},m,{clone:!1})}const Que=.2,ece=.14,tce=.12;function ls(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${Que})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${ece})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${tce})`].join(",")}const rce=["none",ls(0,2,1,-1,0,1,1,0,0,1,3,0),ls(0,3,1,-2,0,2,2,0,0,1,5,0),ls(0,3,3,-2,0,3,4,0,0,1,8,0),ls(0,2,4,-1,0,4,5,0,0,1,10,0),ls(0,3,5,-1,0,5,8,0,0,1,14,0),ls(0,3,5,-1,0,6,10,0,0,1,18,0),ls(0,4,5,-2,0,7,10,1,0,2,16,1),ls(0,5,5,-3,0,8,10,1,0,3,14,2),ls(0,5,6,-3,0,9,12,1,0,3,16,2),ls(0,6,6,-3,0,10,14,1,0,4,18,3),ls(0,6,7,-4,0,11,15,1,0,4,20,3),ls(0,7,8,-4,0,12,17,2,0,5,22,4),ls(0,7,8,-4,0,13,19,2,0,5,24,4),ls(0,7,9,-4,0,14,21,2,0,5,26,4),ls(0,8,9,-5,0,15,22,2,0,6,28,5),ls(0,8,10,-5,0,16,24,2,0,6,30,5),ls(0,8,11,-5,0,17,26,2,0,6,32,5),ls(0,9,11,-5,0,18,28,2,0,7,34,6),ls(0,9,12,-6,0,19,29,2,0,7,36,6),ls(0,10,13,-6,0,20,31,3,0,8,38,7),ls(0,10,13,-6,0,21,33,3,0,8,40,7),ls(0,10,14,-6,0,22,35,3,0,8,42,7),ls(0,11,14,-7,0,23,36,3,0,9,44,8),ls(0,11,15,-7,0,24,38,3,0,9,46,8)],nce={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},AX={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function d8(t){return`${Math.round(t)}ms`}function ice(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function ace(t){const e={...nce,...t.easing},r={...AX,...t.duration};return{getAutoHeightDuration:ice,create:(i=["all"],a={})=>{const{duration:s=r.standard,easing:o=e.easeInOut,delay:c=0,...f}=a;return(Array.isArray(i)?i:[i]).map(d=>`${d} ${typeof s=="string"?s:d8(s)} ${o} ${typeof c=="string"?c:d8(c)}`).join(",")},...t,easing:e,duration:r}}const oce={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function sce(t){return ud(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function IX(t={}){const e={...t};function r(n){const i=Object.entries(n);for(let a=0;a<i.length;a++){const[s,o]=i[a];!sce(o)||s.startsWith("unstable_")?delete n[s]:ud(o)&&(n[s]={...o},r(n[s]))}}return r(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function p8(t){return typeof t=="number"?`${(t*100).toFixed(0)}%`:`calc((${t}) * 100%)`}const lce=t=>{if(!Number.isNaN(+t))return+t;const e=t.match(/\d*\.?\d+/g);if(!e)return 0;let r=0;for(let n=0;n<e.length;n+=1)r+=+e[n];return r};function uce(t){Object.assign(t,{alpha(e,r){const n=this||t;return n.colorSpace?`oklch(from ${e} l c h / ${typeof r=="string"?`calc(${r})`:r})`:n.vars?`rgba(${e.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof r=="string"?`calc(${r})`:r})`:zS(e,lce(r))},lighten(e,r){const n=this||t;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #fff ${p8(r)})`:jT(e,r)},darken(e,r){const n=this||t;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #000 ${p8(r)})`:zT(e,r)}})}function TM(t={},...e){const{breakpoints:r,mixins:n={},spacing:i,palette:a={},transitions:s={},typography:o={},shape:c,colorSpace:f,...d}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error(mp(20));const m=qD({...a,colorSpace:f}),b=NT(t);let x=ec(b,{mixins:Kue(b.breakpoints,n),palette:m,shadows:rce.slice(),typography:CX(m,o),transitions:ace(s),zIndex:{...oce}});return x=ec(x,d),x=e.reduce((E,T)=>ec(E,T),x),x.unstable_sxConfig={...Tx,...d?.unstable_sxConfig},x.unstable_sx=function(T){return Eg({sx:T,theme:this})},x.toRuntimeSource=IX,uce(x),x}function CM(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const cce=[...Array(25)].map((t,e)=>{if(e===0)return"none";const r=CM(e);return`linear-gradient(rgba(255 255 255 / ${r}), rgba(255 255 255 / ${r}))`});function PX(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function MX(t){return t==="dark"?cce:[]}function fce(t){const{palette:e={mode:"light"},opacity:r,overlays:n,colorSpace:i,...a}=t,s=qD({...e,colorSpace:i});return{palette:s,opacity:{...PX(s.mode),...r},overlays:n||MX(s.mode),...a}}function hce(t){return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!t[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const dce=t=>[...[...Array(25)].map((e,r)=>`--${t?`${t}-`:""}overlays-${r}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],pce=t=>(e,r)=>{const n=t.rootSelector||":root",i=t.colorSchemeSelector;let a=i;if(i==="class"&&(a=".%s"),i==="data"&&(a="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(a=`[${i}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const s={};return dce(t.cssVarPrefix).forEach(o=>{s[o]=r[o],delete r[o]}),a==="media"?{[n]:r,"@media (prefers-color-scheme: dark)":{[n]:s}}:a?{[a.replace("%s",e)]:s,[`${n}, ${a.replace("%s",e)}`]:r}:{[n]:{...r,...s}}}if(a&&a!=="media")return`${n}, ${a.replace("%s",String(e))}`}else if(e){if(a==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[n]:r}};if(a)return a.replace("%s",String(e))}return n};function gce(t,e){e.forEach(r=>{t[r]||(t[r]={})})}function Ur(t,e,r){!t[e]&&r&&(t[e]=r)}function M1(t){return typeof t!="string"||!t.startsWith("hsl")?t:yX(t)}function Xd(t,e){`${e}Channel`in t||(t[`${e}Channel`]=P1(M1(t[e])))}function mce(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const Qh=t=>{try{return t()}catch{}},yce=(t="mui")=>xue(t);function gA(t,e,r,n,i){if(!r)return;r=r===!0?{}:r;const a=i==="dark"?"dark":"light";if(!n){e[i]=fce({...r,palette:{mode:a,...r?.palette},colorSpace:t});return}const{palette:s,...o}=TM({...n,palette:{mode:a,...r?.palette},colorSpace:t});return e[i]={...r,palette:s,opacity:{...PX(a),...r?.opacity},overlays:r?.overlays||MX(a)},o}function vce(t={},...e){const{colorSchemes:r={light:!0},defaultColorScheme:n,disableCssColorScheme:i=!1,cssVarPrefix:a="mui",nativeColor:s=!1,shouldSkipGeneratingVar:o=hce,colorSchemeSelector:c=r.light&&r.dark?"media":void 0,rootSelector:f=":root",...d}=t,m=Object.keys(r)[0],b=n||(r.light&&m!=="light"?"light":m),x=yce(a),{[b]:E,light:T,dark:A,...R}=r,F={...R};let N=E;if((b==="dark"&&!("dark"in r)||b==="light"&&!("light"in r))&&(N=!0),!N)throw new Error(mp(21,b));let O;s&&(O="oklch");const U=gA(O,F,N,d,b);T&&!F.light&&gA(O,F,T,void 0,"light"),A&&!F.dark&&gA(O,F,A,void 0,"dark");let j={defaultColorScheme:b,...U,cssVarPrefix:a,colorSchemeSelector:c,rootSelector:f,getCssVar:x,colorSchemes:F,font:{...Zue(U.typography),...U.font},spacing:mce(d.spacing)};Object.keys(j.colorSchemes).forEach(ee=>{const G=j.colorSchemes[ee].palette,ae=fe=>{const pe=fe.split("-"),De=pe[1],ye=pe[2];return x(fe,G[De][ye])};G.mode==="light"&&(Ur(G.common,"background","#fff"),Ur(G.common,"onBackground","#000")),G.mode==="dark"&&(Ur(G.common,"background","#000"),Ur(G.common,"onBackground","#fff"));function se(fe,pe,De){if(O){let ye;return fe===um&&(ye=`transparent ${((1-De)*100).toFixed(0)}%`),fe===fo&&(ye=`#000 ${(De*100).toFixed(0)}%`),fe===ho&&(ye=`#fff ${(De*100).toFixed(0)}%`),`color-mix(in ${O}, ${pe}, ${ye})`}return fe(pe,De)}if(gce(G,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),G.mode==="light"){Ur(G.Alert,"errorColor",se(fo,G.error.light,.6)),Ur(G.Alert,"infoColor",se(fo,G.info.light,.6)),Ur(G.Alert,"successColor",se(fo,G.success.light,.6)),Ur(G.Alert,"warningColor",se(fo,G.warning.light,.6)),Ur(G.Alert,"errorFilledBg",ae("palette-error-main")),Ur(G.Alert,"infoFilledBg",ae("palette-info-main")),Ur(G.Alert,"successFilledBg",ae("palette-success-main")),Ur(G.Alert,"warningFilledBg",ae("palette-warning-main")),Ur(G.Alert,"errorFilledColor",Qh(()=>G.getContrastText(G.error.main))),Ur(G.Alert,"infoFilledColor",Qh(()=>G.getContrastText(G.info.main))),Ur(G.Alert,"successFilledColor",Qh(()=>G.getContrastText(G.success.main))),Ur(G.Alert,"warningFilledColor",Qh(()=>G.getContrastText(G.warning.main))),Ur(G.Alert,"errorStandardBg",se(ho,G.error.light,.9)),Ur(G.Alert,"infoStandardBg",se(ho,G.info.light,.9)),Ur(G.Alert,"successStandardBg",se(ho,G.success.light,.9)),Ur(G.Alert,"warningStandardBg",se(ho,G.warning.light,.9)),Ur(G.Alert,"errorIconColor",ae("palette-error-main")),Ur(G.Alert,"infoIconColor",ae("palette-info-main")),Ur(G.Alert,"successIconColor",ae("palette-success-main")),Ur(G.Alert,"warningIconColor",ae("palette-warning-main")),Ur(G.AppBar,"defaultBg",ae("palette-grey-100")),Ur(G.Avatar,"defaultBg",ae("palette-grey-400")),Ur(G.Button,"inheritContainedBg",ae("palette-grey-300")),Ur(G.Button,"inheritContainedHoverBg",ae("palette-grey-A100")),Ur(G.Chip,"defaultBorder",ae("palette-grey-400")),Ur(G.Chip,"defaultAvatarColor",ae("palette-grey-700")),Ur(G.Chip,"defaultIconColor",ae("palette-grey-700")),Ur(G.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Ur(G.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Ur(G.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Ur(G.LinearProgress,"primaryBg",se(ho,G.primary.main,.62)),Ur(G.LinearProgress,"secondaryBg",se(ho,G.secondary.main,.62)),Ur(G.LinearProgress,"errorBg",se(ho,G.error.main,.62)),Ur(G.LinearProgress,"infoBg",se(ho,G.info.main,.62)),Ur(G.LinearProgress,"successBg",se(ho,G.success.main,.62)),Ur(G.LinearProgress,"warningBg",se(ho,G.warning.main,.62)),Ur(G.Skeleton,"bg",O?se(um,G.text.primary,.11):`rgba(${ae("palette-text-primaryChannel")} / 0.11)`),Ur(G.Slider,"primaryTrack",se(ho,G.primary.main,.62)),Ur(G.Slider,"secondaryTrack",se(ho,G.secondary.main,.62)),Ur(G.Slider,"errorTrack",se(ho,G.error.main,.62)),Ur(G.Slider,"infoTrack",se(ho,G.info.main,.62)),Ur(G.Slider,"successTrack",se(ho,G.success.main,.62)),Ur(G.Slider,"warningTrack",se(ho,G.warning.main,.62));const fe=O?se(fo,G.background.default,.6825):O2(G.background.default,.8);Ur(G.SnackbarContent,"bg",fe),Ur(G.SnackbarContent,"color",Qh(()=>O?EM.text.primary:G.getContrastText(fe))),Ur(G.SpeedDialAction,"fabHoverBg",O2(G.background.paper,.15)),Ur(G.StepConnector,"border",ae("palette-grey-400")),Ur(G.StepContent,"border",ae("palette-grey-400")),Ur(G.Switch,"defaultColor",ae("palette-common-white")),Ur(G.Switch,"defaultDisabledColor",ae("palette-grey-100")),Ur(G.Switch,"primaryDisabledColor",se(ho,G.primary.main,.62)),Ur(G.Switch,"secondaryDisabledColor",se(ho,G.secondary.main,.62)),Ur(G.Switch,"errorDisabledColor",se(ho,G.error.main,.62)),Ur(G.Switch,"infoDisabledColor",se(ho,G.info.main,.62)),Ur(G.Switch,"successDisabledColor",se(ho,G.success.main,.62)),Ur(G.Switch,"warningDisabledColor",se(ho,G.warning.main,.62)),Ur(G.TableCell,"border",se(ho,se(um,G.divider,1),.88)),Ur(G.Tooltip,"bg",se(um,G.grey[700],.92))}if(G.mode==="dark"){Ur(G.Alert,"errorColor",se(ho,G.error.light,.6)),Ur(G.Alert,"infoColor",se(ho,G.info.light,.6)),Ur(G.Alert,"successColor",se(ho,G.success.light,.6)),Ur(G.Alert,"warningColor",se(ho,G.warning.light,.6)),Ur(G.Alert,"errorFilledBg",ae("palette-error-dark")),Ur(G.Alert,"infoFilledBg",ae("palette-info-dark")),Ur(G.Alert,"successFilledBg",ae("palette-success-dark")),Ur(G.Alert,"warningFilledBg",ae("palette-warning-dark")),Ur(G.Alert,"errorFilledColor",Qh(()=>G.getContrastText(G.error.dark))),Ur(G.Alert,"infoFilledColor",Qh(()=>G.getContrastText(G.info.dark))),Ur(G.Alert,"successFilledColor",Qh(()=>G.getContrastText(G.success.dark))),Ur(G.Alert,"warningFilledColor",Qh(()=>G.getContrastText(G.warning.dark))),Ur(G.Alert,"errorStandardBg",se(fo,G.error.light,.9)),Ur(G.Alert,"infoStandardBg",se(fo,G.info.light,.9)),Ur(G.Alert,"successStandardBg",se(fo,G.success.light,.9)),Ur(G.Alert,"warningStandardBg",se(fo,G.warning.light,.9)),Ur(G.Alert,"errorIconColor",ae("palette-error-main")),Ur(G.Alert,"infoIconColor",ae("palette-info-main")),Ur(G.Alert,"successIconColor",ae("palette-success-main")),Ur(G.Alert,"warningIconColor",ae("palette-warning-main")),Ur(G.AppBar,"defaultBg",ae("palette-grey-900")),Ur(G.AppBar,"darkBg",ae("palette-background-paper")),Ur(G.AppBar,"darkColor",ae("palette-text-primary")),Ur(G.Avatar,"defaultBg",ae("palette-grey-600")),Ur(G.Button,"inheritContainedBg",ae("palette-grey-800")),Ur(G.Button,"inheritContainedHoverBg",ae("palette-grey-700")),Ur(G.Chip,"defaultBorder",ae("palette-grey-700")),Ur(G.Chip,"defaultAvatarColor",ae("palette-grey-300")),Ur(G.Chip,"defaultIconColor",ae("palette-grey-300")),Ur(G.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Ur(G.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Ur(G.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Ur(G.LinearProgress,"primaryBg",se(fo,G.primary.main,.5)),Ur(G.LinearProgress,"secondaryBg",se(fo,G.secondary.main,.5)),Ur(G.LinearProgress,"errorBg",se(fo,G.error.main,.5)),Ur(G.LinearProgress,"infoBg",se(fo,G.info.main,.5)),Ur(G.LinearProgress,"successBg",se(fo,G.success.main,.5)),Ur(G.LinearProgress,"warningBg",se(fo,G.warning.main,.5)),Ur(G.Skeleton,"bg",O?se(um,G.text.primary,.13):`rgba(${ae("palette-text-primaryChannel")} / 0.13)`),Ur(G.Slider,"primaryTrack",se(fo,G.primary.main,.5)),Ur(G.Slider,"secondaryTrack",se(fo,G.secondary.main,.5)),Ur(G.Slider,"errorTrack",se(fo,G.error.main,.5)),Ur(G.Slider,"infoTrack",se(fo,G.info.main,.5)),Ur(G.Slider,"successTrack",se(fo,G.success.main,.5)),Ur(G.Slider,"warningTrack",se(fo,G.warning.main,.5));const fe=O?se(ho,G.background.default,.985):O2(G.background.default,.98);Ur(G.SnackbarContent,"bg",fe),Ur(G.SnackbarContent,"color",Qh(()=>O?EX.text.primary:G.getContrastText(fe))),Ur(G.SpeedDialAction,"fabHoverBg",O2(G.background.paper,.15)),Ur(G.StepConnector,"border",ae("palette-grey-600")),Ur(G.StepContent,"border",ae("palette-grey-600")),Ur(G.Switch,"defaultColor",ae("palette-grey-300")),Ur(G.Switch,"defaultDisabledColor",ae("palette-grey-600")),Ur(G.Switch,"primaryDisabledColor",se(fo,G.primary.main,.55)),Ur(G.Switch,"secondaryDisabledColor",se(fo,G.secondary.main,.55)),Ur(G.Switch,"errorDisabledColor",se(fo,G.error.main,.55)),Ur(G.Switch,"infoDisabledColor",se(fo,G.info.main,.55)),Ur(G.Switch,"successDisabledColor",se(fo,G.success.main,.55)),Ur(G.Switch,"warningDisabledColor",se(fo,G.warning.main,.55)),Ur(G.TableCell,"border",se(fo,se(um,G.divider,1),.68)),Ur(G.Tooltip,"bg",se(um,G.grey[700],.92))}Xd(G.background,"default"),Xd(G.background,"paper"),Xd(G.common,"background"),Xd(G.common,"onBackground"),Xd(G,"divider"),Object.keys(G).forEach(fe=>{const pe=G[fe];fe!=="tonalOffset"&&pe&&typeof pe=="object"&&(pe.main&&Ur(G[fe],"mainChannel",P1(M1(pe.main))),pe.light&&Ur(G[fe],"lightChannel",P1(M1(pe.light))),pe.dark&&Ur(G[fe],"darkChannel",P1(M1(pe.dark))),pe.contrastText&&Ur(G[fe],"contrastTextChannel",P1(M1(pe.contrastText))),fe==="text"&&(Xd(G[fe],"primary"),Xd(G[fe],"secondary")),fe==="action"&&(pe.active&&Xd(G[fe],"active"),pe.selected&&Xd(G[fe],"selected")))})}),j=e.reduce((ee,G)=>ec(ee,G),j);const H={prefix:a,disableCssColorScheme:i,shouldSkipGeneratingVar:o,getSelector:pce(j),enableContrastVars:s},{vars:W,generateThemeVars:X,generateStyleSheets:oe}=Eue(j,H);return j.vars=W,Object.entries(j.colorSchemes[j.defaultColorScheme]).forEach(([ee,G])=>{j[ee]=G}),j.generateThemeVars=X,j.generateStyleSheets=oe,j.generateSpacing=function(){return sX(d.spacing,ND(this))},j.getColorSchemeSelector=Tue(c),j.spacing=j.generateSpacing(),j.shouldSkipGeneratingVar=o,j.unstable_sxConfig={...Tx,...d?.unstable_sxConfig},j.unstable_sx=function(G){return Eg({sx:G,theme:this})},j.toRuntimeSource=IX,j}function g8(t,e,r){t.colorSchemes&&r&&(t.colorSchemes[e]={...r!==!0&&r,palette:qD({...r===!0?{}:r.palette,mode:e})})}function f_(t={},...e){const{palette:r,cssVariables:n=!1,colorSchemes:i=r?void 0:{light:!0},defaultColorScheme:a=r?.mode,...s}=t,o=a||"light",c=i?.[o],f={...i,...r?{[o]:{...typeof c!="boolean"&&c,palette:r}}:void 0};if(n===!1){if(!("colorSchemes"in t))return TM(t,...e);let d=r;"palette"in t||f[o]&&(f[o]!==!0?d=f[o].palette:o==="dark"&&(d={mode:"dark"}));const m=TM({...t,palette:d},...e);return m.defaultColorScheme=o,m.colorSchemes=f,m.palette.mode==="light"&&(m.colorSchemes.light={...f.light!==!0&&f.light,palette:m.palette},g8(m,"dark",f.dark)),m.palette.mode==="dark"&&(m.colorSchemes.dark={...f.dark!==!0&&f.dark,palette:m.palette},g8(m,"light",f.light)),m}return!r&&!("light"in f)&&o==="light"&&(f.light=!0),vce({...s,colorSchemes:f,defaultColorScheme:o,...typeof n!="boolean"&&n},...e)}const HD=f_();function Nc(){const t=Cx(HD);return t[Sh]||t}function VT(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const Al=t=>VT(t)&&t!=="classes",Dr=dX({themeId:Sh,defaultTheme:HD,rootShouldForwardProp:Al});function _ce({theme:t,...e}){const r=Sh in t?t[Sh]:void 0;return J.jsx(xX,{...e,themeId:r?Sh:void 0,theme:r||t})}const L2={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:bce}=bue({themeId:Sh,theme:()=>f_({cssVariables:!0}),colorSchemeStorageKey:L2.colorSchemeStorageKey,modeStorageKey:L2.modeStorageKey,defaultColorScheme:{light:L2.defaultLightColorScheme,dark:L2.defaultDarkColorScheme},resolveTheme:t=>{const e={...t,typography:CX(t.palette,t.typography)};return e.unstable_sx=function(n){return Eg({sx:n,theme:this})},e}}),xce=bce;function kX({theme:t,...e}){const r=te.useMemo(()=>{if(typeof t=="function")return t;const n=Sh in t?t[Sh]:t;return"colorSchemes"in n?null:"vars"in n?t:{...t,vars:null}},[t]);return r?J.jsx(_ce,{theme:r,...e}):J.jsx(xce,{theme:t,...e})}const wce=f_({palette:{mode:"light"}}),Sce=f_({palette:{mode:"dark"}}),Ece=t=>({...t==="light"?wce:Sce,palette:{mode:t,...t==="dark"?{primary:{main:"#009EE0"},secondary:{main:"#747577"},background:{paper:"#313131"},text:{primary:"#FFF",contrast:"#000"},topToolbar:{barColor:"#000"},navigation:{buttonColor:"#fff",navColor:"#313131",navHover:"#747577"},GPS:{GPSActiveColor:"#fff",GPSInactiveColor:"#fff",GPSActiveBackgroundColor:"#747577"},compass:{compColor:"#313131",compHover:"#747577",compStroke:"#d3dce1",compNorth:"#cf003f",compSouth:"#d3dcf0"}}:{primary:{main:"#009EE0"},secondary:{main:"#747577"},text:{primary:"#000",contrast:"#fff"},topToolbar:{barColor:"#fff"},navigation:{buttonColor:"#747577",navColor:"#fff",navHover:"#f5f5f5"},GPS:{GPSActiveColor:"#009EE0",GPSInactiveColor:"#747577",GPSActiveBackgroundColor:"#fff"},compass:{compColor:"#fff",compHover:"#f5f5f5",compStroke:"#009ee0",compNorth:"#cf003f",compSouth:"#d3dcf0"}}}}),RX=t=>{const e=Ece(t&&["light","dark"].includes(t)?t:"light");return f_(e,{components:{MuiTypography:{styleOverrides:{root:{}}},MuiAppBar:{styleOverrides:{root:{backgroundColor:e.palette.topToolbar.barColor}}},MuiButton:{variants:[{props:{variant:"navtools"},style:{minWidth:"20px",minHeight:"20px",fontWeight:600,[e.breakpoints.down("md")]:{width:"50px",height:"50px",fontSize:"1.4em"},[e.breakpoints.up("md")]:{width:"30px",height:"30px",fontSize:"1.2em"},color:e.palette.text.primary,backgroundColor:e.palette.navigation.navColor,borderRadius:"23%",margin:"0.15px",marginTop:"4px",":hover":{backgroundColor:e.palette.navigation.navHover}}}]},MuiListItemText:{styleOverrides:{primary:({ownerState:r})=>r?.variant==="layerlist"?{fontSize:"0.9rem"}:{},secondary:({ownerState:r})=>r?.variant==="layerlist"?{fontSize:"0.7rem"}:{}}}}})};try{MapcomponentsTheme.displayName="MapcomponentsTheme",MapcomponentsTheme.__docgenInfo={description:"",displayName:"MapcomponentsTheme",props:{}}}catch{}const tc={source_openmaptiles_url:"https://wms.wheregroup.com/tileserver/tile/world-0-14.json",sprite:"https://wms.wheregroup.com/tileserver/sprites/osm-bright",glyphs:"https://wms.wheregroup.com/tileserver/fonts/{fontstack}/{range}.pbf",sourceOptions_tiles:["https://wms.wheregroup.com/tileserver/tile/world-0-14/{z}/{x}/{y}.pbf"]},bu=[];for(let t=0;t<256;++t)bu.push((t+256).toString(16).slice(1));function Tce(t,e=0){return(bu[t[e+0]]+bu[t[e+1]]+bu[t[e+2]]+bu[t[e+3]]+"-"+bu[t[e+4]]+bu[t[e+5]]+"-"+bu[t[e+6]]+bu[t[e+7]]+"-"+bu[t[e+8]]+bu[t[e+9]]+"-"+bu[t[e+10]]+bu[t[e+11]]+bu[t[e+12]]+bu[t[e+13]]+bu[t[e+14]]+bu[t[e+15]]).toLowerCase()}let mA;const Cce=new Uint8Array(16);function Ace(){if(!mA){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");mA=crypto.getRandomValues.bind(crypto)}return mA(Cce)}const Ice=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),m8={randomUUID:Ice};function vc(t,e,r){if(m8.randomUUID&&!t)return m8.randomUUID();t=t||{};const n=t.random??t.rng?.()??Ace();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Tce(n)}const GD=gt.createContext({});function AM(t){const[e,r]=gt.useState([]),[n,i]=gt.useState([]),[a,s]=gt.useState([]),[o,c]=gt.useState(tc.sourceOptions_tiles[0]),f=te.useMemo(()=>({layerId:"openmaptiles",sourceOptions:{type:"vector",tiles:[o]}}),[o]),d=T=>{if(!T)return;const A=[],R=[];T.layers.forEach((F,N)=>{F.type==="symbol"?R.push(F):(N===0&&(F.id=T.name||"background"),A.push(F))}),i(A),s(R)};te.useEffect(()=>{if(e.filter(T=>!T?.id).length){const T=[...e];T.forEach(A=>{A?.id||(A.id=vc())}),r(T)}},[e]);const m=te.useCallback((T,A)=>{const R=e?.filter?.(F=>F.id===T);if(R.length>0){const F=[...e],N=R[0],O=e.indexOf(N),U=A(O);U>=0&&U<=e.length-1&&(F.splice(O,1),F.splice(U,0,N),r(F))}},[e]),b=te.useCallback(T=>{m(T,A=>A+1)},[m]),x=te.useCallback(T=>{m(T,A=>A-1)},[m]),E={layers:e,setLayers:r,backgroundLayers:n,setBackgroundLayers:i,symbolLayers:a,setSymbolLayers:s,updateStyle:d,vtLayerConfig:f,tileUrl:o,setTileUrl:c,moveUp:x,moveDown:b,moveLayer:m};return J.jsx(GD.Provider,{value:E,children:t.children})}try{AM.displayName="LayerContextProvider",AM.__docgenInfo={description:"",displayName:"LayerContextProvider",props:{}}}catch{}const Lg=gt.createContext({}),IM=({children:t})=>{const[e,r]=te.useState(void 0),[n,i]=te.useState([]),a=te.useRef([]),s=te.useRef({}),o=d=>{if(d){typeof s.current[d]<"u"&&delete s.current[d];const m=a.current.indexOf(d);m>-1&&a.current.splice(m,1),i([...a.current]),a.current.length===0&&e&&r(void 0)}else o("anonymous_map")},f={map:e,setMap:d=>{if(r(d),n.length===0){const m="anonymous_map";i([...n,m]),s.current[m]=d}},maps:s.current,mapIds:n,registerMap:(d,m)=>{d&&m&&(s.current[d]=m,a.current.push(d),i([...a.current]),(!e||e?.cancelled===!0)&&r(m))},removeMap:o,mapExists:d=>d&&Object.keys(s.current).indexOf(d)===-1?!1:!(!d&&!e),getMap:d=>d&&n.indexOf(d)!==-1?s.current[d]:!d&&e?e:null};return J.jsx(Lg.Provider,{value:f,children:J.jsx(AM,{children:J.jsx(kX,{theme:RX("light"),children:t})})})};try{IM.displayName="MapComponentsProvider",IM.__docgenInfo={description:`MapComponentsProvider must be imported and wrapped around component where at least one of its child nodes requires access to a MapLibre-gl or openlayers instance that is registered in this mapContext.
MapComponentsProvider must be used one level higher than the first use of MapContext.

MapComponentsProvider requires at least one use of the MapLibreMap component somewhere down the component tree that will create the MapLibre-gl object and set the reference at MapContext.map. For MapLibre maps it is a good idea to provide a mapId attribute to the MapLibreMap Component even if you are only using a single map instance at start. It will make a later transition to using multiple instances within the same project much easier.`,displayName:"MapComponentsProvider",props:{}}}catch{}const DX={mapId:void 0,options:{center:{lng:8.607,lat:53.1409349},zoom:11,container:"",style:{version:8,name:"blank",center:[0,0],zoom:0,sources:{},sprite:"https://wms.wheregroup.com/tileserver/sprites/osm-bright",glyphs:"https://wms.wheregroup.com/tileserver/fonts/{fontstack}/{range}.pbf",layers:[{id:"_background",type:"background",paint:{"background-color":"rgba(0,0,0,0)"}}]}}},OX=t=>{const e=te.useRef(null),r=te.useRef(null),n=te.useContext(Lg),i=te.useRef(t.mapId),a=te.useRef(!1),s=te.useRef(t.options?.style);return te.useEffect(()=>{const o=i.current;return()=>{a.current=!1,n.removeMap(o),e.current&&(e.current.map?.remove?.(),e.current.cancelled=!0,e.current=null)}},[]),te.useEffect(()=>{a.current||r.current&&(a.current=!0,t?.options?.style&&(s.current=JSON.stringify(t.options.style)),e.current=new Noe({mapOptions:{style:"",...t.options,...t?.options?.style?{}:{style:DX?.options?.style},container:r.current},onReady:(o,c)=>{o.once("load",()=>{c?.cancelled?o.remove():(window._map=o,t.mapId?n.registerMap(t.mapId,c):n.setMap(c))})}}))},[t.options,t.mapId]),te.useEffect(()=>{if(e.current?.map&&t?.options?.style){const o=JSON.stringify(t.options.style);s.current!==o&&(s.current=o,e.current.map.setStyle(t.options.style))}},[t?.options?.style]),J.jsx("div",{ref:r,className:"mapContainer",style:t.style})};OX.defaultProps=DX;function $T(t){const e=te.useContext(Lg),r=te.useRef(!1),n=te.useRef(null),[i,a]=te.useState(),s=te.useRef(void 0),[o,c]=te.useState([]),f=te.useRef(""),d=te.useRef(vc()),m=te.useCallback(x=>!t?.filter?.includeBaseLayers&&x?.baseLayer?!1:typeof t.filter?.matchLayerIds<"u"?t.filter.matchLayerIds instanceof RegExp?t.filter.matchLayerIds.test(x.id):x.id.includes(t.filter.matchLayerIds):!0,[t.filter]),b=te.useCallback(()=>{if(!n.current)return;const x=n.current.wrapper.layerState.filter(m),E=JSON.stringify(x);f.current!==E&&(f.current=E,c(x))},[m]);return te.useEffect(()=>{const x=d.current;return()=>{n.current&&(n.current.cleanup(x),n.current=null),r.current=!1}},[]),te.useEffect(()=>{if(!(!e.mapExists(t.mapId)||r.current)){if(r.current=!0,n.current=e.getMap(t.mapId),!n.current){r.current=!1;return}t?.watch?.viewport&&(a(n.current.wrapper.viewportState),n.current.wrapper.on("viewportchange",()=>{s.current!==n.current?.wrapper.viewportStateString&&a(n.current?.wrapper.viewportState)},d.current)),t?.watch?.layers&&(b(),n.current.wrapper.on("layerchange",b,{includeBaseLayers:t?.filter?.includeBaseLayers,matchLayerIds:t?.filter?.matchLayerIds},d.current))}},[e.mapIds,e,t.mapId,b,t]),{layers:o,viewport:i}}$T.defaultProps={mapId:void 0,watch:{layers:!0,sources:!1,viewport:!1},filter:{includeBaseLayers:!1}};function ga(t){const e=te.useContext(Lg),[r,n]=te.useState({map:void 0,ready:!1}),i=$T({mapId:t?.mapId,watch:{viewport:!1,layers:!!t?.waitForLayer,sources:!1},filter:{includeBaseLayers:!0}}),a=te.useRef(null),s=te.useRef(vc()),o=()=>{a.current&&a.current.cleanup(s.current)};return te.useEffect(()=>()=>{o(),a.current=null},[]),te.useEffect(()=>{if(a.current&&a.current.cancelled===!0&&(a.current=null,n({map:void 0,ready:!1})),!(a.current||!e.mapExists(t?.mapId))){if(t?.waitForLayer){let c=!1;if(i?.layers?.forEach(f=>{f.id===t?.waitForLayer&&(c=!0)}),!c)return}a.current=e.getMap(t?.mapId),n({map:a.current,ready:!0})}},[e.mapIds,i.layers,e,t]),{map:r.map,mapIsReady:r.ready,componentId:s.current,layers:i.layers,cleanup:o}}function PM(...t){return t.reduce((e,r)=>r==null?e:function(...i){e.apply(this,i),r.apply(this,i)},()=>{})}function Pce(t){return J.jsx(lX,{...t,defaultTheme:HD,themeId:Sh})}function Mce(t){return function(r){return J.jsx(Pce,{styles:typeof t=="function"?n=>t({theme:n,...r}):t})}}function kce(){return BD}const ci=hue;function bi(t){return lue(t)}function Rce(t){return gi("MuiSvgIcon",t)}pi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Dce=t=>{const{color:e,fontSize:r,classes:n}=t,i={root:["root",e!=="inherit"&&`color${un(e)}`,`fontSize${un(r)}`]};return mi(i,Rce,n)},Oce=Dr("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color!=="inherit"&&e[`color${un(r.color)}`],e[`fontSize${un(r.fontSize)}`]]}})(ci(({theme:t})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:t.transitions?.create?.("fill",{duration:(t.vars??t).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:t.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:t.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,e])=>e&&e.main).map(([e])=>({props:{color:e},style:{color:(t.vars??t).palette?.[e]?.main}})),{props:{color:"action"},style:{color:(t.vars??t).palette?.action?.active}},{props:{color:"disabled"},style:{color:(t.vars??t).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),MM=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSvgIcon"}),{children:i,className:a,color:s="inherit",component:o="svg",fontSize:c="medium",htmlColor:f,inheritViewBox:d=!1,titleAccess:m,viewBox:b="0 0 24 24",...x}=n,E=te.isValidElement(i)&&i.type==="svg",T={...n,color:s,component:o,fontSize:c,instanceFontSize:e.fontSize,inheritViewBox:d,viewBox:b,hasSvgAsChild:E},A={};d||(A.viewBox=b);const R=Dce(T);return J.jsxs(Oce,{as:o,className:An(R.root,a),focusable:"false",color:f,"aria-hidden":m?void 0:!0,role:m?"img":void 0,ref:r,...A,...x,...E&&i.props,ownerState:T,children:[E?i.props.children:i,m?J.jsx("title",{children:m}):null]})});MM.muiName="SvgIcon";function Ji(t,e){function r(n,i){return J.jsx(MM,{"data-testid":void 0,ref:i,...n,children:t})}return r.muiName=MM.muiName,te.memo(te.forwardRef(r))}function WD(t,e=166){let r;function n(...i){const a=()=>{t.apply(this,i)};clearTimeout(r),r=setTimeout(a,e)}return n.clear=()=>{clearTimeout(r)},n}function fs(t){return t&&t.ownerDocument||document}function _c(t){return fs(t).defaultView||window}function y8(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function Wm(t){const{controlled:e,default:r,name:n,state:i="value"}=t,{current:a}=te.useRef(e!==void 0),[s,o]=te.useState(r),c=a?e:s,f=te.useCallback(d=>{a||o(d)},[]);return[c,f]}function ou(t){const e=te.useRef(t);return Tu(()=>{e.current=t}),te.useRef((...r)=>(0,e.current)(...r)).current}function Uo(...t){const e=te.useRef(void 0),r=te.useCallback(n=>{const i=t.map(a=>{if(a==null)return null;if(typeof a=="function"){const s=a,o=s(n);return typeof o=="function"?o:()=>{s(null)}}return a.current=n,()=>{a.current=null}});return()=>{i.forEach(a=>a?.())}},t);return te.useMemo(()=>t.every(n=>n==null)?null:n=>{e.current&&(e.current(),e.current=void 0),n!=null&&(e.current=r(n))},t)}function Lce(t,e){const r=t.charCodeAt(2);return t[0]==="o"&&t[1]==="n"&&r>=65&&r<=90&&typeof e=="function"}function Db(t,e){if(!t)return e;function r(s,o){const c={};return Object.keys(o).forEach(f=>{Lce(f,o[f])&&typeof s[f]=="function"&&(c[f]=(...d)=>{s[f](...d),o[f](...d)})}),c}if(typeof t=="function"||typeof e=="function")return s=>{const o=typeof e=="function"?e(s):e,c=typeof t=="function"?t({...s,...o}):t,f=An(s?.className,o?.className,c?.className),d=r(c,o);return{...o,...c,...d,...!!f&&{className:f},...o?.style&&c?.style&&{style:{...o.style,...c.style}},...o?.sx&&c?.sx&&{sx:[...Array.isArray(o.sx)?o.sx:[o.sx],...Array.isArray(c.sx)?c.sx:[c.sx]]}}};const n=e,i=r(t,n),a=An(n?.className,t?.className);return{...e,...t,...i,...!!a&&{className:a},...n?.style&&t?.style&&{style:{...n.style,...t.style}},...n?.sx&&t?.sx&&{sx:[...Array.isArray(n.sx)?n.sx:[n.sx],...Array.isArray(t.sx)?t.sx:[t.sx]]}}}function LX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function kM(t,e){return kM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},kM(t,e)}function NX(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,kM(t,e)}const v8={disabled:!1},US=gt.createContext(null);var Nce=function(e){return e.scrollTop},k1="unmounted",ym="exited",vm="entering",Rv="entered",RM="exiting",Jf=(function(t){NX(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=i,o=s&&!s.isMounting?n.enter:n.appear,c;return a.appearStatus=null,n.in?o?(c=ym,a.appearStatus=vm):c=Rv:n.unmountOnExit||n.mountOnEnter?c=k1:c=ym,a.state={status:c},a.nextCallback=null,a}e.getDerivedStateFromProps=function(i,a){var s=i.in;return s&&a.status===k1?{status:ym}:null};var r=e.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(i){var a=null;if(i!==this.props){var s=this.state.status;this.props.in?s!==vm&&s!==Rv&&(a=vm):(s===vm||s===Rv)&&(a=RM)}this.updateStatus(!1,a)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var i=this.props.timeout,a,s,o;return a=s=o=i,i!=null&&typeof i!="number"&&(a=i.exit,s=i.enter,o=i.appear!==void 0?i.appear:s),{exit:a,enter:s,appear:o}},r.updateStatus=function(i,a){if(i===void 0&&(i=!1),a!==null)if(this.cancelNextCallback(),a===vm){if(this.props.unmountOnExit||this.props.mountOnEnter){var s=this.props.nodeRef?this.props.nodeRef.current:I1.findDOMNode(this);s&&Nce(s)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ym&&this.setState({status:k1})},r.performEnter=function(i){var a=this,s=this.props.enter,o=this.context?this.context.isMounting:i,c=this.props.nodeRef?[o]:[I1.findDOMNode(this),o],f=c[0],d=c[1],m=this.getTimeouts(),b=o?m.appear:m.enter;if(!i&&!s||v8.disabled){this.safeSetState({status:Rv},function(){a.props.onEntered(f)});return}this.props.onEnter(f,d),this.safeSetState({status:vm},function(){a.props.onEntering(f,d),a.onTransitionEnd(b,function(){a.safeSetState({status:Rv},function(){a.props.onEntered(f,d)})})})},r.performExit=function(){var i=this,a=this.props.exit,s=this.getTimeouts(),o=this.props.nodeRef?void 0:I1.findDOMNode(this);if(!a||v8.disabled){this.safeSetState({status:ym},function(){i.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:RM},function(){i.props.onExiting(o),i.onTransitionEnd(s.exit,function(){i.safeSetState({status:ym},function(){i.props.onExited(o)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(i,a){a=this.setNextCallback(a),this.setState(i,a)},r.setNextCallback=function(i){var a=this,s=!0;return this.nextCallback=function(o){s&&(s=!1,a.nextCallback=null,i(o))},this.nextCallback.cancel=function(){s=!1},this.nextCallback},r.onTransitionEnd=function(i,a){this.setNextCallback(a);var s=this.props.nodeRef?this.props.nodeRef.current:I1.findDOMNode(this),o=i==null&&!this.props.addEndListener;if(!s||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[s,this.nextCallback],f=c[0],d=c[1];this.props.addEndListener(f,d)}i!=null&&setTimeout(this.nextCallback,i)},r.render=function(){var i=this.state.status;if(i===k1)return null;var a=this.props,s=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var o=LX(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return gt.createElement(US.Provider,{value:null},typeof s=="function"?s(i,o):gt.cloneElement(gt.Children.only(s),o))},e})(gt.Component);Jf.contextType=US;Jf.propTypes={};function cv(){}Jf.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:cv,onEntering:cv,onEntered:cv,onExit:cv,onExiting:cv,onExited:cv};Jf.UNMOUNTED=k1;Jf.EXITED=ym;Jf.ENTERING=vm;Jf.ENTERED=Rv;Jf.EXITING=RM;function Fce(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function XD(t,e){var r=function(a){return e&&te.isValidElement(a)?e(a):a},n=Object.create(null);return t&&te.Children.map(t,function(i){return i}).forEach(function(i){n[i.key]=r(i)}),n}function Bce(t,e){t=t||{},e=e||{};function r(d){return d in e?e[d]:t[d]}var n=Object.create(null),i=[];for(var a in t)a in e?i.length&&(n[a]=i,i=[]):i.push(a);var s,o={};for(var c in e){if(n[c])for(s=0;s<n[c].length;s++){var f=n[c][s];o[n[c][s]]=r(f)}o[c]=r(c)}for(s=0;s<i.length;s++)o[i[s]]=r(i[s]);return o}function Pm(t,e,r){return r[e]!=null?r[e]:t.props[e]}function zce(t,e){return XD(t.children,function(r){return te.cloneElement(r,{onExited:e.bind(null,r),in:!0,appear:Pm(r,"appear",t),enter:Pm(r,"enter",t),exit:Pm(r,"exit",t)})})}function jce(t,e,r){var n=XD(t.children),i=Bce(e,n);return Object.keys(i).forEach(function(a){var s=i[a];if(te.isValidElement(s)){var o=a in e,c=a in n,f=e[a],d=te.isValidElement(f)&&!f.props.in;c&&(!o||d)?i[a]=te.cloneElement(s,{onExited:r.bind(null,s),in:!0,exit:Pm(s,"exit",t),enter:Pm(s,"enter",t)}):!c&&o&&!d?i[a]=te.cloneElement(s,{in:!1}):c&&o&&te.isValidElement(f)&&(i[a]=te.cloneElement(s,{onExited:r.bind(null,s),in:f.props.in,exit:Pm(s,"exit",t),enter:Pm(s,"enter",t)}))}}),i}var Uce=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},Vce={component:"div",childFactory:function(e){return e}},YD=(function(t){NX(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=a.handleExited.bind(Fce(a));return a.state={contextValue:{isMounting:!0},handleExited:s,firstRender:!0},a}var r=e.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,a){var s=a.children,o=a.handleExited,c=a.firstRender;return{children:c?zce(i,o):jce(i,s,o),firstRender:!1}},r.handleExited=function(i,a){var s=XD(this.props.children);i.key in s||(i.props.onExited&&i.props.onExited(a),this.mounted&&this.setState(function(o){var c=NS({},o.children);return delete c[i.key],{children:c}}))},r.render=function(){var i=this.props,a=i.component,s=i.childFactory,o=LX(i,["component","childFactory"]),c=this.state.contextValue,f=Uce(this.state.children).map(s);return delete o.appear,delete o.enter,delete o.exit,a===null?gt.createElement(US.Provider,{value:c},f):gt.createElement(US.Provider,{value:c},gt.createElement(a,o,f))},e})(gt.Component);YD.propTypes={};YD.defaultProps=Vce;const _8={};function FX(t,e){const r=te.useRef(_8);return r.current===_8&&(r.current=t(e)),r}const $ce=[];function qce(t){te.useEffect(t,$ce)}class qT{static create(){return new qT}currentId=null;start(e,r){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,r()},e)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function ug(){const t=FX(qT.create).current;return qce(t.disposeEffect),t}const ZD=t=>t.scrollTop;function vp(t,e){const{timeout:r,easing:n,style:i={}}=t;return{duration:i.transitionDuration??(typeof r=="number"?r:r[e.mode]||0),easing:i.transitionTimingFunction??(typeof n=="object"?n[e.mode]:n),delay:i.transitionDelay}}function Hce(t){return gi("MuiCollapse",t)}pi("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const Gce=t=>{const{orientation:e,classes:r}=t,n={root:["root",`${e}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${e}`],wrapperInner:["wrapperInner",`${e}`]};return mi(n,Hce,r)},Wce=Dr("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.orientation],r.state==="entered"&&e.entered,r.state==="exited"&&!r.in&&r.collapsedSize==="0px"&&e.hidden]}})(ci(({theme:t})=>({height:0,overflow:"hidden",transition:t.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:t.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:e})=>e.state==="exited"&&!e.in&&e.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),Xce=Dr("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Yce=Dr("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),DM=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiCollapse"}),{addEndListener:i,children:a,className:s,collapsedSize:o="0px",component:c,easing:f,in:d,onEnter:m,onEntered:b,onEntering:x,onExit:E,onExited:T,onExiting:A,orientation:R="vertical",style:F,timeout:N=AX.standard,TransitionComponent:O=Jf,...U}=n,j={...n,orientation:R,collapsedSize:o},H=Gce(j),W=Nc(),X=ug(),oe=te.useRef(null),ee=te.useRef(),G=typeof o=="number"?`${o}px`:o,ae=R==="horizontal",se=ae?"width":"height",fe=te.useRef(null),pe=Uo(r,fe),De=Fe=>Xe=>{if(Fe){const Be=fe.current;Xe===void 0?Fe(Be):Fe(Be,Xe)}},ye=()=>oe.current?oe.current[ae?"clientWidth":"clientHeight"]:0,we=De((Fe,Xe)=>{oe.current&&ae&&(oe.current.style.position="absolute"),Fe.style[se]=G,m&&m(Fe,Xe)}),Te=De((Fe,Xe)=>{const Be=ye();oe.current&&ae&&(oe.current.style.position="");const{duration:ot,easing:Ke}=vp({style:F,timeout:N,easing:f},{mode:"enter"});if(N==="auto"){const it=W.transitions.getAutoHeightDuration(Be);Fe.style.transitionDuration=`${it}ms`,ee.current=it}else Fe.style.transitionDuration=typeof ot=="string"?ot:`${ot}ms`;Fe.style[se]=`${Be}px`,Fe.style.transitionTimingFunction=Ke,x&&x(Fe,Xe)}),Re=De((Fe,Xe)=>{Fe.style[se]="auto",b&&b(Fe,Xe)}),de=De(Fe=>{Fe.style[se]=`${ye()}px`,E&&E(Fe)}),Ee=De(T),xe=De(Fe=>{const Xe=ye(),{duration:Be,easing:ot}=vp({style:F,timeout:N,easing:f},{mode:"exit"});if(N==="auto"){const Ke=W.transitions.getAutoHeightDuration(Xe);Fe.style.transitionDuration=`${Ke}ms`,ee.current=Ke}else Fe.style.transitionDuration=typeof Be=="string"?Be:`${Be}ms`;Fe.style[se]=G,Fe.style.transitionTimingFunction=ot,A&&A(Fe)}),Ne=Fe=>{N==="auto"&&X.start(ee.current||0,Fe),i&&i(fe.current,Fe)};return J.jsx(O,{in:d,onEnter:we,onEntered:Re,onEntering:Te,onExit:de,onExited:Ee,onExiting:xe,addEndListener:Ne,nodeRef:fe,timeout:N==="auto"?null:N,...U,children:(Fe,{ownerState:Xe,...Be})=>J.jsx(Wce,{as:c,className:An(H.root,s,{entered:H.entered,exited:!d&&G==="0px"&&H.hidden}[Fe]),style:{[ae?"minWidth":"minHeight"]:G,...F},ref:pe,ownerState:{...j,state:Fe},...Be,children:J.jsx(Xce,{ownerState:{...j,state:Fe},className:H.wrapper,ref:oe,children:J.jsx(Yce,{ownerState:{...j,state:Fe},className:H.wrapperInner,children:a})})})})});DM&&(DM.muiSupportAuto=!0);function Zce(t){return gi("MuiPaper",t)}pi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Kce=t=>{const{square:e,elevation:r,variant:n,classes:i}=t,a={root:["root",n,!e&&"rounded",n==="elevation"&&`elevation${r}`]};return mi(a,Zce,i)},Jce=Dr("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],!r.square&&e.rounded,r.variant==="elevation"&&e[`elevation${r.elevation}`]]}})(ci(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:t.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(t.vars||t).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),Uf=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiPaper"}),i=Nc(),{className:a,component:s="div",elevation:o=1,square:c=!1,variant:f="elevation",...d}=n,m={...n,component:s,elevation:o,square:c,variant:f},b=Kce(m);return J.jsx(Jce,{as:s,ownerState:m,className:An(b.root,a),ref:r,...d,style:{...f==="elevation"&&{"--Paper-shadow":(i.vars||i).shadows[o],...i.vars&&{"--Paper-overlay":i.vars.overlays?.[o]},...!i.vars&&i.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${zS("#fff",CM(o))}, ${zS("#fff",CM(o))})`}},...d.style}})}),BX=te.createContext({});function md(t){return typeof t=="string"}function zX(t,e,r){return t===void 0||md(t)?e:{...e,ownerState:{...e.ownerState,...r}}}function jX(t,e,r){return typeof t=="function"?t(e,r):t}function Lm(t,e=[]){if(t===void 0)return{};const r={};return Object.keys(t).filter(n=>n.match(/^on[A-Z]/)&&typeof t[n]=="function"&&!e.includes(n)).forEach(n=>{r[n]=t[n]}),r}function b8(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(r=>!(r.match(/^on[A-Z]/)&&typeof t[r]=="function")).forEach(r=>{e[r]=t[r]}),e}function UX(t){const{getSlotProps:e,additionalProps:r,externalSlotProps:n,externalForwardedProps:i,className:a}=t;if(!e){const x=An(r?.className,a,i?.className,n?.className),E={...r?.style,...i?.style,...n?.style},T={...r,...i,...n};return x.length>0&&(T.className=x),Object.keys(E).length>0&&(T.style=E),{props:T,internalRef:void 0}}const s=Lm({...i,...n}),o=b8(n),c=b8(i),f=e(s),d=An(f?.className,r?.className,a,i?.className,n?.className),m={...f?.style,...r?.style,...i?.style,...n?.style},b={...f,...r,...c,...o};return d.length>0&&(b.className=d),Object.keys(m).length>0&&(b.style=m),{props:b,internalRef:f.ref}}function Ei(t,e){const{className:r,elementType:n,ownerState:i,externalForwardedProps:a,internalForwardedProps:s,shouldForwardComponentProp:o=!1,...c}=e,{component:f,slots:d={[t]:void 0},slotProps:m={[t]:void 0},...b}=a,x=d[t]||n,E=jX(m[t],i),{props:{component:T,...A},internalRef:R}=UX({className:r,...c,externalForwardedProps:t==="root"?b:void 0,externalSlotProps:E}),F=Uo(R,E?.ref,e.ref),N=t==="root"?T||f:T,O=zX(x,{...t==="root"&&!f&&!d[t]&&s,...t!=="root"&&!d[t]&&s,...A,...N&&!o&&{as:N},...N&&o&&{component:N},ref:F},i);return[x,O]}function Qce(t){return gi("MuiAccordion",t)}const N2=pi("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),efe=t=>{const{classes:e,square:r,expanded:n,disabled:i,disableGutters:a}=t;return mi({root:["root",!r&&"rounded",n&&"expanded",i&&"disabled",!a&&"gutters"],heading:["heading"],region:["region"]},Qce,e)},tfe=Dr(Uf,{name:"MuiAccordion",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${N2.region}`]:e.region},e.root,!r.square&&e.rounded,!r.disableGutters&&e.gutters]}})(ci(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{position:"relative",transition:t.transitions.create(["margin"],e),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(t.vars||t).palette.divider,transition:t.transitions.create(["opacity","background-color"],e)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${N2.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${N2.disabled}`]:{backgroundColor:(t.vars||t).palette.action.disabledBackground}}}),ci(({theme:t})=>({variants:[{props:e=>!e.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(t.vars||t).shape.borderRadius,borderBottomRightRadius:(t.vars||t).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:e=>!e.disableGutters,style:{[`&.${N2.expanded}`]:{margin:"16px 0"}}}]}))),rfe=Dr("h3",{name:"MuiAccordion",slot:"Heading"})({all:"unset"}),nfe=Dr("div",{name:"MuiAccordion",slot:"Region"})({}),ife=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAccordion"}),{children:i,className:a,defaultExpanded:s=!1,disabled:o=!1,disableGutters:c=!1,expanded:f,onChange:d,square:m=!1,slots:b={},slotProps:x={},TransitionComponent:E,TransitionProps:T,...A}=n,[R,F]=Wm({controlled:f,default:s,name:"Accordion",state:"expanded"}),N=te.useCallback(Te=>{F(!R),d&&d(Te,!R)},[R,d,F]),[O,...U]=te.Children.toArray(i),j=te.useMemo(()=>({expanded:R,disabled:o,disableGutters:c,toggle:N}),[R,o,c,N]),H={...n,square:m,disabled:o,disableGutters:c,expanded:R},W=efe(H),X={transition:E,...b},oe={transition:T,...x},ee={slots:X,slotProps:oe},[G,ae]=Ei("root",{elementType:tfe,externalForwardedProps:{...ee,...A},className:An(W.root,a),shouldForwardComponentProp:!0,ownerState:H,ref:r,additionalProps:{square:m}}),[se,fe]=Ei("heading",{elementType:rfe,externalForwardedProps:ee,className:W.heading,ownerState:H}),[pe,De]=Ei("transition",{elementType:DM,externalForwardedProps:ee,ownerState:H}),[ye,we]=Ei("region",{elementType:nfe,externalForwardedProps:ee,ownerState:H,className:W.region,additionalProps:{"aria-labelledby":O.props.id,id:O.props["aria-controls"],role:"region"}});return J.jsxs(G,{...ae,children:[J.jsx(se,{...fe,children:J.jsx(BX.Provider,{value:j,children:O})}),J.jsx(pe,{in:R,timeout:"auto",...De,children:J.jsx(ye,{...we,children:U})})]})});function D0(t){try{return t.matches(":focus-visible")}catch{}return!1}class VS{static create(){return new VS}static use(){const e=FX(VS.create).current,[r,n]=te.useState(!1);return e.shouldMount=r,e.setShouldMount=n,te.useEffect(e.mountEffect,[r]),e}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=ofe(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())};start(...e){this.mount().then(()=>this.ref.current?.start(...e))}stop(...e){this.mount().then(()=>this.ref.current?.stop(...e))}pulsate(...e){this.mount().then(()=>this.ref.current?.pulsate(...e))}}function afe(){return VS.use()}function ofe(){let t,e;const r=new Promise((n,i)=>{t=n,e=i});return r.resolve=t,r.reject=e,r}function sfe(t){const{className:e,classes:r,pulsate:n=!1,rippleX:i,rippleY:a,rippleSize:s,in:o,onExited:c,timeout:f}=t,[d,m]=te.useState(!1),b=An(e,r.ripple,r.rippleVisible,n&&r.ripplePulsate),x={width:s,height:s,top:-(s/2)+a,left:-(s/2)+i},E=An(r.child,d&&r.childLeaving,n&&r.childPulsate);return!o&&!d&&m(!0),te.useEffect(()=>{if(!o&&c!=null){const T=setTimeout(c,f);return()=>{clearTimeout(T)}}},[c,o,f]),J.jsx("span",{className:b,style:x,children:J.jsx("span",{className:E})})}const Mf=pi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),OM=550,lfe=80,ufe=wx`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,cfe=wx`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,ffe=wx`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,hfe=Dr("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),dfe=Dr(sfe,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Mf.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${ufe};
    animation-duration: ${OM}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  &.${Mf.ripplePulsate} {
    animation-duration: ${({theme:t})=>t.transitions.duration.shorter}ms;
  }

  & .${Mf.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Mf.childLeaving} {
    opacity: 0;
    animation-name: ${cfe};
    animation-duration: ${OM}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  & .${Mf.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${ffe};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,pfe=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:a={},className:s,...o}=n,[c,f]=te.useState([]),d=te.useRef(0),m=te.useRef(null);te.useEffect(()=>{m.current&&(m.current(),m.current=null)},[c]);const b=te.useRef(!1),x=ug(),E=te.useRef(null),T=te.useRef(null),A=te.useCallback(O=>{const{pulsate:U,rippleX:j,rippleY:H,rippleSize:W,cb:X}=O;f(oe=>[...oe,J.jsx(dfe,{classes:{ripple:An(a.ripple,Mf.ripple),rippleVisible:An(a.rippleVisible,Mf.rippleVisible),ripplePulsate:An(a.ripplePulsate,Mf.ripplePulsate),child:An(a.child,Mf.child),childLeaving:An(a.childLeaving,Mf.childLeaving),childPulsate:An(a.childPulsate,Mf.childPulsate)},timeout:OM,pulsate:U,rippleX:j,rippleY:H,rippleSize:W},d.current)]),d.current+=1,m.current=X},[a]),R=te.useCallback((O={},U={},j=()=>{})=>{const{pulsate:H=!1,center:W=i||U.pulsate,fakeElement:X=!1}=U;if(O?.type==="mousedown"&&b.current){b.current=!1;return}O?.type==="touchstart"&&(b.current=!0);const oe=X?null:T.current,ee=oe?oe.getBoundingClientRect():{width:0,height:0,left:0,top:0};let G,ae,se;if(W||O===void 0||O.clientX===0&&O.clientY===0||!O.clientX&&!O.touches)G=Math.round(ee.width/2),ae=Math.round(ee.height/2);else{const{clientX:fe,clientY:pe}=O.touches&&O.touches.length>0?O.touches[0]:O;G=Math.round(fe-ee.left),ae=Math.round(pe-ee.top)}if(W)se=Math.sqrt((2*ee.width**2+ee.height**2)/3),se%2===0&&(se+=1);else{const fe=Math.max(Math.abs((oe?oe.clientWidth:0)-G),G)*2+2,pe=Math.max(Math.abs((oe?oe.clientHeight:0)-ae),ae)*2+2;se=Math.sqrt(fe**2+pe**2)}O?.touches?E.current===null&&(E.current=()=>{A({pulsate:H,rippleX:G,rippleY:ae,rippleSize:se,cb:j})},x.start(lfe,()=>{E.current&&(E.current(),E.current=null)})):A({pulsate:H,rippleX:G,rippleY:ae,rippleSize:se,cb:j})},[i,A,x]),F=te.useCallback(()=>{R({},{pulsate:!0})},[R]),N=te.useCallback((O,U)=>{if(x.clear(),O?.type==="touchend"&&E.current){E.current(),E.current=null,x.start(0,()=>{N(O,U)});return}E.current=null,f(j=>j.length>0?j.slice(1):j),m.current=U},[x]);return te.useImperativeHandle(r,()=>({pulsate:F,start:R,stop:N}),[F,R,N]),J.jsx(hfe,{className:An(Mf.root,a.root,s),ref:T,...o,children:J.jsx(YD,{component:null,exit:!0,children:c})})});function gfe(t){return gi("MuiButtonBase",t)}const mfe=pi("MuiButtonBase",["root","disabled","focusVisible"]),yfe=t=>{const{disabled:e,focusVisible:r,focusVisibleClassName:n,classes:i}=t,s=mi({root:["root",e&&"disabled",r&&"focusVisible"]},gfe,i);return r&&n&&(s.root+=` ${n}`),s},vfe=Dr("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${mfe.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),h_=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:a=!1,children:s,className:o,component:c="button",disabled:f=!1,disableRipple:d=!1,disableTouchRipple:m=!1,focusRipple:b=!1,focusVisibleClassName:x,LinkComponent:E="a",onBlur:T,onClick:A,onContextMenu:R,onDragLeave:F,onFocus:N,onFocusVisible:O,onKeyDown:U,onKeyUp:j,onMouseDown:H,onMouseLeave:W,onMouseUp:X,onTouchEnd:oe,onTouchMove:ee,onTouchStart:G,tabIndex:ae=0,TouchRippleProps:se,touchRippleRef:fe,type:pe,...De}=n,ye=te.useRef(null),we=afe(),Te=Uo(we.ref,fe),[Re,de]=te.useState(!1);f&&Re&&de(!1),te.useImperativeHandle(i,()=>({focusVisible:()=>{de(!0),ye.current.focus()}}),[]);const Ee=we.shouldMount&&!d&&!f;te.useEffect(()=>{Re&&b&&!d&&we.pulsate()},[d,b,Re,we]);const xe=Yd(we,"start",H,m),Ne=Yd(we,"stop",R,m),Fe=Yd(we,"stop",F,m),Xe=Yd(we,"stop",X,m),Be=Yd(we,"stop",lr=>{Re&&lr.preventDefault(),W&&W(lr)},m),ot=Yd(we,"start",G,m),Ke=Yd(we,"stop",oe,m),it=Yd(we,"stop",ee,m),Me=Yd(we,"stop",lr=>{D0(lr.target)||de(!1),T&&T(lr)},!1),zt=ou(lr=>{ye.current||(ye.current=lr.currentTarget),D0(lr.target)&&(de(!0),O&&O(lr)),N&&N(lr)}),st=()=>{const lr=ye.current;return c&&c!=="button"&&!(lr.tagName==="A"&&lr.href)},$e=ou(lr=>{b&&!lr.repeat&&Re&&lr.key===" "&&we.stop(lr,()=>{we.start(lr)}),lr.target===lr.currentTarget&&st()&&lr.key===" "&&lr.preventDefault(),U&&U(lr),lr.target===lr.currentTarget&&st()&&lr.key==="Enter"&&!f&&(lr.preventDefault(),A&&A(lr))}),Jt=ou(lr=>{b&&lr.key===" "&&Re&&!lr.defaultPrevented&&we.stop(lr,()=>{we.pulsate(lr)}),j&&j(lr),A&&lr.target===lr.currentTarget&&st()&&lr.key===" "&&!lr.defaultPrevented&&A(lr)});let Ht=c;Ht==="button"&&(De.href||De.to)&&(Ht=E);const pr={};Ht==="button"?(pr.type=pe===void 0?"button":pe,pr.disabled=f):(!De.href&&!De.to&&(pr.role="button"),f&&(pr["aria-disabled"]=f));const _t=Uo(r,ye),vr={...n,centerRipple:a,component:c,disabled:f,disableRipple:d,disableTouchRipple:m,focusRipple:b,tabIndex:ae,focusVisible:Re},br=yfe(vr);return J.jsxs(vfe,{as:Ht,className:An(br.root,o),ownerState:vr,onBlur:Me,onClick:A,onContextMenu:Ne,onFocus:zt,onKeyDown:$e,onKeyUp:Jt,onMouseDown:xe,onMouseLeave:Be,onMouseUp:Xe,onDragLeave:Fe,onTouchEnd:Ke,onTouchMove:it,onTouchStart:ot,ref:_t,tabIndex:f?-1:ae,type:pe,...pr,...De,children:[s,Ee?J.jsx(pfe,{ref:Te,center:a,...se}):null]})});function Yd(t,e,r,n=!1){return ou(i=>(r&&r(i),n||t[e](i),!0))}function _fe(t){return gi("MuiAccordionSummary",t)}const t0=pi("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),bfe=t=>{const{classes:e,expanded:r,disabled:n,disableGutters:i}=t;return mi({root:["root",r&&"expanded",n&&"disabled",!i&&"gutters"],focusVisible:["focusVisible"],content:["content",r&&"expanded",!i&&"contentGutters"],expandIconWrapper:["expandIconWrapper",r&&"expanded"]},_fe,e)},xfe=Dr(h_,{name:"MuiAccordionSummary",slot:"Root"})(ci(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:t.spacing(0,2),transition:t.transitions.create(["min-height","background-color"],e),[`&.${t0.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${t0.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`&:hover:not(.${t0.disabled})`]:{cursor:"pointer"},variants:[{props:r=>!r.disableGutters,style:{[`&.${t0.expanded}`]:{minHeight:64}}}]}})),wfe=Dr("span",{name:"MuiAccordionSummary",slot:"Content"})(ci(({theme:t})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:e=>!e.disableGutters,style:{transition:t.transitions.create(["margin"],{duration:t.transitions.duration.shortest}),[`&.${t0.expanded}`]:{margin:"20px 0"}}}]}))),Sfe=Dr("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper"})(ci(({theme:t})=>({display:"flex",color:(t.vars||t).palette.action.active,transform:"rotate(0deg)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest}),[`&.${t0.expanded}`]:{transform:"rotate(180deg)"}}))),Efe=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAccordionSummary"}),{children:i,className:a,expandIcon:s,focusVisibleClassName:o,onClick:c,slots:f,slotProps:d,...m}=n,{disabled:b=!1,disableGutters:x,expanded:E,toggle:T}=te.useContext(BX),A=oe=>{T&&T(oe),c&&c(oe)},R={...n,expanded:E,disabled:b,disableGutters:x},F=bfe(R),N={slots:f,slotProps:d},[O,U]=Ei("root",{ref:r,shouldForwardComponentProp:!0,className:An(F.root,a),elementType:xfe,externalForwardedProps:{...N,...m},ownerState:R,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:b,"aria-expanded":E,focusVisibleClassName:An(F.focusVisible,o)},getSlotProps:oe=>({...oe,onClick:ee=>{oe.onClick?.(ee),A(ee)}})}),[j,H]=Ei("content",{className:F.content,elementType:wfe,externalForwardedProps:N,ownerState:R}),[W,X]=Ei("expandIconWrapper",{className:F.expandIconWrapper,elementType:Sfe,externalForwardedProps:N,ownerState:R});return J.jsxs(O,{...U,children:[J.jsx(j,{...H,children:i}),s&&J.jsx(W,{...X,children:s})]})});function Tfe(t){return typeof t.main=="string"}function Cfe(t,e=[]){if(!Tfe(t))return!1;for(const r of e)if(!t.hasOwnProperty(r)||typeof t[r]!="string")return!1;return!0}function jl(t=[]){return([,e])=>e&&Cfe(e,t)}function Afe(t){return gi("MuiCircularProgress",t)}pi("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Xp=44,LM=wx`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,NM=wx`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,Ife=typeof LM!="string"?DD`
        animation: ${LM} 1.4s linear infinite;
      `:null,Pfe=typeof NM!="string"?DD`
        animation: ${NM} 1.4s ease-in-out infinite;
      `:null,Mfe=t=>{const{classes:e,variant:r,color:n,disableShrink:i}=t,a={root:["root",r,`color${un(n)}`],svg:["svg"],circle:["circle",`circle${un(r)}`,i&&"circleDisableShrink"]};return mi(a,Afe,e)},kfe=Dr("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`color${un(r.color)}`]]}})(ci(({theme:t})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:Ife||{animation:`${LM} 1.4s linear infinite`}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))]}))),Rfe=Dr("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),Dfe=Dr("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.circle,e[`circle${un(r.variant)}`],r.disableShrink&&e.circleDisableShrink]}})(ci(({theme:t})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:Pfe||{animation:`${NM} 1.4s ease-in-out infinite`}}]}))),HT=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiCircularProgress"}),{className:i,color:a="primary",disableShrink:s=!1,size:o=40,style:c,thickness:f=3.6,value:d=0,variant:m="indeterminate",...b}=n,x={...n,color:a,disableShrink:s,size:o,thickness:f,value:d,variant:m},E=Mfe(x),T={},A={},R={};if(m==="determinate"){const F=2*Math.PI*((Xp-f)/2);T.strokeDasharray=F.toFixed(3),R["aria-valuenow"]=Math.round(d),T.strokeDashoffset=`${((100-d)/100*F).toFixed(3)}px`,A.transform="rotate(-90deg)"}return J.jsx(kfe,{className:An(E.root,i),style:{width:o,height:o,...A,...c},ownerState:x,ref:r,role:"progressbar",...R,...b,children:J.jsx(Rfe,{className:E.svg,ownerState:x,viewBox:`${Xp/2} ${Xp/2} ${Xp} ${Xp}`,children:J.jsx(Dfe,{className:E.circle,style:T,ownerState:x,cx:Xp,cy:Xp,r:(Xp-f)/2,fill:"none",strokeWidth:f})})})});function Ofe(t){return gi("MuiIconButton",t)}const x8=pi("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),Lfe=t=>{const{classes:e,disabled:r,color:n,edge:i,size:a,loading:s}=t,o={root:["root",s&&"loading",r&&"disabled",n!=="default"&&`color${un(n)}`,i&&`edge${un(i)}`,`size${un(a)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return mi(o,Ofe,e)},Nfe=Dr(h_,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.loading&&e.loading,r.color!=="default"&&e[`color${un(r.color)}`],r.edge&&e[`edge${un(r.edge)}`],e[`size${un(r.size)}`]]}})(ci(({theme:t})=>({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),ci(({theme:t})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],[`&.${x8.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled},[`&.${x8.loading}`]:{color:"transparent"}}))),Ffe=Dr("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(t.vars||t).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),uf=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiIconButton"}),{edge:i=!1,children:a,className:s,color:o="default",disabled:c=!1,disableFocusRipple:f=!1,size:d="medium",id:m,loading:b=null,loadingIndicator:x,...E}=n,T=Og(m),A=x??J.jsx(HT,{"aria-labelledby":T,color:"inherit",size:16}),R={...n,edge:i,color:o,disabled:c,disableFocusRipple:f,loading:b,loadingIndicator:A,size:d},F=Lfe(R);return J.jsxs(Nfe,{id:b?T:m,className:An(F.root,s),centerRipple:!0,focusRipple:!f,disabled:c||b,ref:r,...E,ownerState:R,children:[typeof b=="boolean"&&J.jsx("span",{className:F.loadingWrapper,style:{display:"contents"},children:J.jsx(Ffe,{className:F.loadingIndicator,ownerState:R,children:b&&A})}),a]})});function Bfe(t){return gi("MuiTypography",t)}const w8=pi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),zfe={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},jfe=kce(),Ufe=t=>{const{align:e,gutterBottom:r,noWrap:n,paragraph:i,variant:a,classes:s}=t,o={root:["root",a,t.align!=="inherit"&&`align${un(e)}`,r&&"gutterBottom",n&&"noWrap",i&&"paragraph"]};return mi(o,Bfe,s)},Vfe=Dr("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.variant&&e[r.variant],r.align!=="inherit"&&e[`align${un(r.align)}`],r.noWrap&&e.noWrap,r.gutterBottom&&e.gutterBottom,r.paragraph&&e.paragraph]}})(ci(({theme:t})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(t.typography).filter(([e,r])=>e!=="inherit"&&r&&typeof r=="object").map(([e,r])=>({props:{variant:e},style:r})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette?.text||{}).filter(([,e])=>typeof e=="string").map(([e])=>({props:{color:`text${un(e)}`},style:{color:(t.vars||t).palette.text[e]}})),{props:({ownerState:e})=>e.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:e})=>e.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:e})=>e.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:e})=>e.paragraph,style:{marginBottom:16}}]}))),S8={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Es=te.forwardRef(function(e,r){const{color:n,...i}=bi({props:e,name:"MuiTypography"}),a=!zfe[n],s=jfe({...i,...a&&{color:n}}),{align:o="inherit",className:c,component:f,gutterBottom:d=!1,noWrap:m=!1,paragraph:b=!1,variant:x="body1",variantMapping:E=S8,...T}=s,A={...s,align:o,color:n,className:c,component:f,gutterBottom:d,noWrap:m,paragraph:b,variant:x,variantMapping:E},R=f||(b?"p":E[x]||S8[x])||"span",F=Ufe(A);return J.jsx(Vfe,{as:R,ref:r,className:An(F.root,c),...T,ownerState:A,style:{...o!=="inherit"&&{"--Typography-textAlign":o},...T.style}})});function $fe(t){return gi("MuiAppBar",t)}pi("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const qfe=t=>{const{color:e,position:r,classes:n}=t,i={root:["root",`color${un(e)}`,`position${un(r)}`]};return mi(i,$fe,n)},E8=(t,e)=>t?`${t?.replace(")","")}, ${e})`:e,Hfe=Dr(Uf,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`position${un(r.position)}`],e[`color${un(r.color)}`]]}})(ci(({theme:t})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[100],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[100]),...t.applyStyles("dark",{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[900],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[900])})}},...Object.entries(t.palette).filter(jl(["contrastText"])).map(([e])=>({props:{color:e},style:{"--AppBar-background":(t.vars??t).palette[e].main,"--AppBar-color":(t.vars??t).palette[e].contrastText}})),{props:e=>e.enableColorOnDark===!0&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:e=>e.enableColorOnDark===!1&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundColor:t.vars?E8(t.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:t.vars?E8(t.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundImage:"none"})}}]}))),Gfe=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAppBar"}),{className:i,color:a="primary",enableColorOnDark:s=!1,position:o="fixed",...c}=n,f={...n,color:a,position:o,enableColorOnDark:s},d=qfe(f);return J.jsx(Hfe,{square:!0,component:"header",ownerState:f,elevation:4,className:An(d.root,i,o==="fixed"&&"mui-fixed"),ref:r,...c})});var kc="top",Vf="bottom",$f="right",Rc="left",KD="auto",Ix=[kc,Vf,$f,Rc],O0="start",Ob="end",Wfe="clippingParents",VX="viewport",Q_="popper",Xfe="reference",T8=Ix.reduce(function(t,e){return t.concat([e+"-"+O0,e+"-"+Ob])},[]),$X=[].concat(Ix,[KD]).reduce(function(t,e){return t.concat([e,e+"-"+O0,e+"-"+Ob])},[]),Yfe="beforeRead",Zfe="read",Kfe="afterRead",Jfe="beforeMain",Qfe="main",ehe="afterMain",the="beforeWrite",rhe="write",nhe="afterWrite",ihe=[Yfe,Zfe,Kfe,Jfe,Qfe,ehe,the,rhe,nhe];function xd(t){return t?(t.nodeName||"").toLowerCase():null}function cf(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Xm(t){var e=cf(t).Element;return t instanceof e||t instanceof Element}function Lf(t){var e=cf(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function JD(t){if(typeof ShadowRoot>"u")return!1;var e=cf(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function ahe(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},a=e.elements[r];!Lf(a)||!xd(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function ohe(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],a=e.attributes[n]||{},s=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),o=s.reduce(function(c,f){return c[f]="",c},{});!Lf(i)||!xd(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(c){i.removeAttribute(c)}))})}}const she={name:"applyStyles",enabled:!0,phase:"write",fn:ahe,effect:ohe,requires:["computeStyles"]};function yd(t){return t.split("-")[0]}var Nm=Math.max,$S=Math.min,L0=Math.round;function FM(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function qX(){return!/^((?!chrome|android).)*safari/i.test(FM())}function N0(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,a=1;e&&Lf(t)&&(i=t.offsetWidth>0&&L0(n.width)/t.offsetWidth||1,a=t.offsetHeight>0&&L0(n.height)/t.offsetHeight||1);var s=Xm(t)?cf(t):window,o=s.visualViewport,c=!qX()&&r,f=(n.left+(c&&o?o.offsetLeft:0))/i,d=(n.top+(c&&o?o.offsetTop:0))/a,m=n.width/i,b=n.height/a;return{width:m,height:b,top:d,right:f+m,bottom:d+b,left:f,x:f,y:d}}function QD(t){var e=N0(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function HX(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&JD(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function _p(t){return cf(t).getComputedStyle(t)}function lhe(t){return["table","td","th"].indexOf(xd(t))>=0}function Ng(t){return((Xm(t)?t.ownerDocument:t.document)||window.document).documentElement}function GT(t){return xd(t)==="html"?t:t.assignedSlot||t.parentNode||(JD(t)?t.host:null)||Ng(t)}function C8(t){return!Lf(t)||_p(t).position==="fixed"?null:t.offsetParent}function uhe(t){var e=/firefox/i.test(FM()),r=/Trident/i.test(FM());if(r&&Lf(t)){var n=_p(t);if(n.position==="fixed")return null}var i=GT(t);for(JD(i)&&(i=i.host);Lf(i)&&["html","body"].indexOf(xd(i))<0;){var a=_p(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Px(t){for(var e=cf(t),r=C8(t);r&&lhe(r)&&_p(r).position==="static";)r=C8(r);return r&&(xd(r)==="html"||xd(r)==="body"&&_p(r).position==="static")?e:r||uhe(t)||e}function eO(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function ib(t,e,r){return Nm(t,$S(e,r))}function che(t,e,r){var n=ib(t,e,r);return n>r?r:n}function GX(){return{top:0,right:0,bottom:0,left:0}}function WX(t){return Object.assign({},GX(),t)}function XX(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var fhe=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,WX(typeof e!="number"?e:XX(e,Ix))};function hhe(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,s=r.modifiersData.popperOffsets,o=yd(r.placement),c=eO(o),f=[Rc,$f].indexOf(o)>=0,d=f?"height":"width";if(!(!a||!s)){var m=fhe(i.padding,r),b=QD(a),x=c==="y"?kc:Rc,E=c==="y"?Vf:$f,T=r.rects.reference[d]+r.rects.reference[c]-s[c]-r.rects.popper[d],A=s[c]-r.rects.reference[c],R=Px(a),F=R?c==="y"?R.clientHeight||0:R.clientWidth||0:0,N=T/2-A/2,O=m[x],U=F-b[d]-m[E],j=F/2-b[d]/2+N,H=ib(O,j,U),W=c;r.modifiersData[n]=(e={},e[W]=H,e.centerOffset=H-j,e)}}function dhe(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||HX(e.elements.popper,i)&&(e.elements.arrow=i))}const phe={name:"arrow",enabled:!0,phase:"main",fn:hhe,effect:dhe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function F0(t){return t.split("-")[1]}var ghe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function mhe(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:L0(r*i)/i||0,y:L0(n*i)/i||0}}function A8(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,s=t.offsets,o=t.position,c=t.gpuAcceleration,f=t.adaptive,d=t.roundOffsets,m=t.isFixed,b=s.x,x=b===void 0?0:b,E=s.y,T=E===void 0?0:E,A=typeof d=="function"?d({x,y:T}):{x,y:T};x=A.x,T=A.y;var R=s.hasOwnProperty("x"),F=s.hasOwnProperty("y"),N=Rc,O=kc,U=window;if(f){var j=Px(r),H="clientHeight",W="clientWidth";if(j===cf(r)&&(j=Ng(r),_p(j).position!=="static"&&o==="absolute"&&(H="scrollHeight",W="scrollWidth")),j=j,i===kc||(i===Rc||i===$f)&&a===Ob){O=Vf;var X=m&&j===U&&U.visualViewport?U.visualViewport.height:j[H];T-=X-n.height,T*=c?1:-1}if(i===Rc||(i===kc||i===Vf)&&a===Ob){N=$f;var oe=m&&j===U&&U.visualViewport?U.visualViewport.width:j[W];x-=oe-n.width,x*=c?1:-1}}var ee=Object.assign({position:o},f&&ghe),G=d===!0?mhe({x,y:T},cf(r)):{x,y:T};if(x=G.x,T=G.y,c){var ae;return Object.assign({},ee,(ae={},ae[O]=F?"0":"",ae[N]=R?"0":"",ae.transform=(U.devicePixelRatio||1)<=1?"translate("+x+"px, "+T+"px)":"translate3d("+x+"px, "+T+"px, 0)",ae))}return Object.assign({},ee,(e={},e[O]=F?T+"px":"",e[N]=R?x+"px":"",e.transform="",e))}function yhe(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,s=a===void 0?!0:a,o=r.roundOffsets,c=o===void 0?!0:o,f={placement:yd(e.placement),variation:F0(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,A8(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:c})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,A8(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const vhe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:yhe,data:{}};var F2={passive:!0};function _he(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=i===void 0?!0:i,s=n.resize,o=s===void 0?!0:s,c=cf(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&f.forEach(function(d){d.addEventListener("scroll",r.update,F2)}),o&&c.addEventListener("resize",r.update,F2),function(){a&&f.forEach(function(d){d.removeEventListener("scroll",r.update,F2)}),o&&c.removeEventListener("resize",r.update,F2)}}const bhe={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:_he,data:{}};var xhe={left:"right",right:"left",bottom:"top",top:"bottom"};function aS(t){return t.replace(/left|right|bottom|top/g,function(e){return xhe[e]})}var whe={start:"end",end:"start"};function I8(t){return t.replace(/start|end/g,function(e){return whe[e]})}function tO(t){var e=cf(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function rO(t){return N0(Ng(t)).left+tO(t).scrollLeft}function She(t,e){var r=cf(t),n=Ng(t),i=r.visualViewport,a=n.clientWidth,s=n.clientHeight,o=0,c=0;if(i){a=i.width,s=i.height;var f=qX();(f||!f&&e==="fixed")&&(o=i.offsetLeft,c=i.offsetTop)}return{width:a,height:s,x:o+rO(t),y:c}}function Ehe(t){var e,r=Ng(t),n=tO(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=Nm(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Nm(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+rO(t),c=-n.scrollTop;return _p(i||r).direction==="rtl"&&(o+=Nm(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:c}}function nO(t){var e=_p(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function YX(t){return["html","body","#document"].indexOf(xd(t))>=0?t.ownerDocument.body:Lf(t)&&nO(t)?t:YX(GT(t))}function ab(t,e){var r;e===void 0&&(e=[]);var n=YX(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),a=cf(n),s=i?[a].concat(a.visualViewport||[],nO(n)?n:[]):n,o=e.concat(s);return i?o:o.concat(ab(GT(s)))}function BM(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function The(t,e){var r=N0(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function P8(t,e,r){return e===VX?BM(She(t,r)):Xm(e)?The(e,r):BM(Ehe(Ng(t)))}function Che(t){var e=ab(GT(t)),r=["absolute","fixed"].indexOf(_p(t).position)>=0,n=r&&Lf(t)?Px(t):t;return Xm(n)?e.filter(function(i){return Xm(i)&&HX(i,n)&&xd(i)!=="body"}):[]}function Ahe(t,e,r,n){var i=e==="clippingParents"?Che(t):[].concat(e),a=[].concat(i,[r]),s=a[0],o=a.reduce(function(c,f){var d=P8(t,f,n);return c.top=Nm(d.top,c.top),c.right=$S(d.right,c.right),c.bottom=$S(d.bottom,c.bottom),c.left=Nm(d.left,c.left),c},P8(t,s,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function ZX(t){var e=t.reference,r=t.element,n=t.placement,i=n?yd(n):null,a=n?F0(n):null,s=e.x+e.width/2-r.width/2,o=e.y+e.height/2-r.height/2,c;switch(i){case kc:c={x:s,y:e.y-r.height};break;case Vf:c={x:s,y:e.y+e.height};break;case $f:c={x:e.x+e.width,y:o};break;case Rc:c={x:e.x-r.width,y:o};break;default:c={x:e.x,y:e.y}}var f=i?eO(i):null;if(f!=null){var d=f==="y"?"height":"width";switch(a){case O0:c[f]=c[f]-(e[d]/2-r[d]/2);break;case Ob:c[f]=c[f]+(e[d]/2-r[d]/2);break}}return c}function Lb(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,a=r.strategy,s=a===void 0?t.strategy:a,o=r.boundary,c=o===void 0?Wfe:o,f=r.rootBoundary,d=f===void 0?VX:f,m=r.elementContext,b=m===void 0?Q_:m,x=r.altBoundary,E=x===void 0?!1:x,T=r.padding,A=T===void 0?0:T,R=WX(typeof A!="number"?A:XX(A,Ix)),F=b===Q_?Xfe:Q_,N=t.rects.popper,O=t.elements[E?F:b],U=Ahe(Xm(O)?O:O.contextElement||Ng(t.elements.popper),c,d,s),j=N0(t.elements.reference),H=ZX({reference:j,element:N,placement:i}),W=BM(Object.assign({},N,H)),X=b===Q_?W:j,oe={top:U.top-X.top+R.top,bottom:X.bottom-U.bottom+R.bottom,left:U.left-X.left+R.left,right:X.right-U.right+R.right},ee=t.modifiersData.offset;if(b===Q_&&ee){var G=ee[i];Object.keys(oe).forEach(function(ae){var se=[$f,Vf].indexOf(ae)>=0?1:-1,fe=[kc,Vf].indexOf(ae)>=0?"y":"x";oe[ae]+=G[fe]*se})}return oe}function Ihe(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,s=r.padding,o=r.flipVariations,c=r.allowedAutoPlacements,f=c===void 0?$X:c,d=F0(n),m=d?o?T8:T8.filter(function(E){return F0(E)===d}):Ix,b=m.filter(function(E){return f.indexOf(E)>=0});b.length===0&&(b=m);var x=b.reduce(function(E,T){return E[T]=Lb(t,{placement:T,boundary:i,rootBoundary:a,padding:s})[yd(T)],E},{});return Object.keys(x).sort(function(E,T){return x[E]-x[T]})}function Phe(t){if(yd(t)===KD)return[];var e=aS(t);return[I8(t),e,I8(e)]}function Mhe(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!0:s,c=r.fallbackPlacements,f=r.padding,d=r.boundary,m=r.rootBoundary,b=r.altBoundary,x=r.flipVariations,E=x===void 0?!0:x,T=r.allowedAutoPlacements,A=e.options.placement,R=yd(A),F=R===A,N=c||(F||!E?[aS(A)]:Phe(A)),O=[A].concat(N).reduce(function(xe,Ne){return xe.concat(yd(Ne)===KD?Ihe(e,{placement:Ne,boundary:d,rootBoundary:m,padding:f,flipVariations:E,allowedAutoPlacements:T}):Ne)},[]),U=e.rects.reference,j=e.rects.popper,H=new Map,W=!0,X=O[0],oe=0;oe<O.length;oe++){var ee=O[oe],G=yd(ee),ae=F0(ee)===O0,se=[kc,Vf].indexOf(G)>=0,fe=se?"width":"height",pe=Lb(e,{placement:ee,boundary:d,rootBoundary:m,altBoundary:b,padding:f}),De=se?ae?$f:Rc:ae?Vf:kc;U[fe]>j[fe]&&(De=aS(De));var ye=aS(De),we=[];if(a&&we.push(pe[G]<=0),o&&we.push(pe[De]<=0,pe[ye]<=0),we.every(function(xe){return xe})){X=ee,W=!1;break}H.set(ee,we)}if(W)for(var Te=E?3:1,Re=function(Ne){var Fe=O.find(function(Xe){var Be=H.get(Xe);if(Be)return Be.slice(0,Ne).every(function(ot){return ot})});if(Fe)return X=Fe,"break"},de=Te;de>0;de--){var Ee=Re(de);if(Ee==="break")break}e.placement!==X&&(e.modifiersData[n]._skip=!0,e.placement=X,e.reset=!0)}}const khe={name:"flip",enabled:!0,phase:"main",fn:Mhe,requiresIfExists:["offset"],data:{_skip:!1}};function M8(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function k8(t){return[kc,$f,Vf,Rc].some(function(e){return t[e]>=0})}function Rhe(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,s=Lb(e,{elementContext:"reference"}),o=Lb(e,{altBoundary:!0}),c=M8(s,n),f=M8(o,i,a),d=k8(c),m=k8(f);e.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:f,isReferenceHidden:d,hasPopperEscaped:m},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":m})}const Dhe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Rhe};function Ohe(t,e,r){var n=yd(t),i=[Rc,kc].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[Rc,$f].indexOf(n)>=0?{x:o,y:s}:{x:s,y:o}}function Lhe(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=i===void 0?[0,0]:i,s=$X.reduce(function(d,m){return d[m]=Ohe(m,e.rects,a),d},{}),o=s[e.placement],c=o.x,f=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=c,e.modifiersData.popperOffsets.y+=f),e.modifiersData[n]=s}const Nhe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Lhe};function Fhe(t){var e=t.state,r=t.name;e.modifiersData[r]=ZX({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Bhe={name:"popperOffsets",enabled:!0,phase:"read",fn:Fhe,data:{}};function zhe(t){return t==="x"?"y":"x"}function jhe(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!1:s,c=r.boundary,f=r.rootBoundary,d=r.altBoundary,m=r.padding,b=r.tether,x=b===void 0?!0:b,E=r.tetherOffset,T=E===void 0?0:E,A=Lb(e,{boundary:c,rootBoundary:f,padding:m,altBoundary:d}),R=yd(e.placement),F=F0(e.placement),N=!F,O=eO(R),U=zhe(O),j=e.modifiersData.popperOffsets,H=e.rects.reference,W=e.rects.popper,X=typeof T=="function"?T(Object.assign({},e.rects,{placement:e.placement})):T,oe=typeof X=="number"?{mainAxis:X,altAxis:X}:Object.assign({mainAxis:0,altAxis:0},X),ee=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,G={x:0,y:0};if(j){if(a){var ae,se=O==="y"?kc:Rc,fe=O==="y"?Vf:$f,pe=O==="y"?"height":"width",De=j[O],ye=De+A[se],we=De-A[fe],Te=x?-W[pe]/2:0,Re=F===O0?H[pe]:W[pe],de=F===O0?-W[pe]:-H[pe],Ee=e.elements.arrow,xe=x&&Ee?QD(Ee):{width:0,height:0},Ne=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:GX(),Fe=Ne[se],Xe=Ne[fe],Be=ib(0,H[pe],xe[pe]),ot=N?H[pe]/2-Te-Be-Fe-oe.mainAxis:Re-Be-Fe-oe.mainAxis,Ke=N?-H[pe]/2+Te+Be+Xe+oe.mainAxis:de+Be+Xe+oe.mainAxis,it=e.elements.arrow&&Px(e.elements.arrow),Me=it?O==="y"?it.clientTop||0:it.clientLeft||0:0,zt=(ae=ee?.[O])!=null?ae:0,st=De+ot-zt-Me,$e=De+Ke-zt,Jt=ib(x?$S(ye,st):ye,De,x?Nm(we,$e):we);j[O]=Jt,G[O]=Jt-De}if(o){var Ht,pr=O==="x"?kc:Rc,_t=O==="x"?Vf:$f,vr=j[U],br=U==="y"?"height":"width",lr=vr+A[pr],Cr=vr-A[_t],Tr=[kc,Rc].indexOf(R)!==-1,Qt=(Ht=ee?.[U])!=null?Ht:0,at=Tr?lr:vr-H[br]-W[br]-Qt+oe.altAxis,Pe=Tr?vr+H[br]+W[br]-Qt-oe.altAxis:Cr,be=x&&Tr?che(at,vr,Pe):ib(x?at:lr,vr,x?Pe:Cr);j[U]=be,G[U]=be-vr}e.modifiersData[n]=G}}const Uhe={name:"preventOverflow",enabled:!0,phase:"main",fn:jhe,requiresIfExists:["offset"]};function Vhe(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function $he(t){return t===cf(t)||!Lf(t)?tO(t):Vhe(t)}function qhe(t){var e=t.getBoundingClientRect(),r=L0(e.width)/t.offsetWidth||1,n=L0(e.height)/t.offsetHeight||1;return r!==1||n!==1}function Hhe(t,e,r){r===void 0&&(r=!1);var n=Lf(e),i=Lf(e)&&qhe(e),a=Ng(e),s=N0(t,i,r),o={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!r)&&((xd(e)!=="body"||nO(a))&&(o=$he(e)),Lf(e)?(c=N0(e,!0),c.x+=e.clientLeft,c.y+=e.clientTop):a&&(c.x=rO(a))),{x:s.left+o.scrollLeft-c.x,y:s.top+o.scrollTop-c.y,width:s.width,height:s.height}}function Ghe(t){var e=new Map,r=new Set,n=[];t.forEach(function(a){e.set(a.name,a)});function i(a){r.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!r.has(o)){var c=e.get(o);c&&i(c)}}),n.push(a)}return t.forEach(function(a){r.has(a.name)||i(a)}),n}function Whe(t){var e=Ghe(t);return ihe.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function Xhe(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function Yhe(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var R8={placement:"bottom",modifiers:[],strategy:"absolute"};function D8(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function Zhe(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,a=i===void 0?R8:i;return function(o,c,f){f===void 0&&(f=a);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},R8,a),modifiersData:{},elements:{reference:o,popper:c},attributes:{},styles:{}},m=[],b=!1,x={state:d,setOptions:function(R){var F=typeof R=="function"?R(d.options):R;T(),d.options=Object.assign({},a,d.options,F),d.scrollParents={reference:Xm(o)?ab(o):o.contextElement?ab(o.contextElement):[],popper:ab(c)};var N=Whe(Yhe([].concat(n,d.options.modifiers)));return d.orderedModifiers=N.filter(function(O){return O.enabled}),E(),x.update()},forceUpdate:function(){if(!b){var R=d.elements,F=R.reference,N=R.popper;if(D8(F,N)){d.rects={reference:Hhe(F,Px(N),d.options.strategy==="fixed"),popper:QD(N)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(oe){return d.modifiersData[oe.name]=Object.assign({},oe.data)});for(var O=0;O<d.orderedModifiers.length;O++){if(d.reset===!0){d.reset=!1,O=-1;continue}var U=d.orderedModifiers[O],j=U.fn,H=U.options,W=H===void 0?{}:H,X=U.name;typeof j=="function"&&(d=j({state:d,options:W,name:X,instance:x})||d)}}}},update:Xhe(function(){return new Promise(function(A){x.forceUpdate(),A(d)})}),destroy:function(){T(),b=!0}};if(!D8(o,c))return x;x.setOptions(f).then(function(A){!b&&f.onFirstUpdate&&f.onFirstUpdate(A)});function E(){d.orderedModifiers.forEach(function(A){var R=A.name,F=A.options,N=F===void 0?{}:F,O=A.effect;if(typeof O=="function"){var U=O({state:d,name:R,instance:x,options:N}),j=function(){};m.push(U||j)}})}function T(){m.forEach(function(A){return A()}),m=[]}return x}}var Khe=[bhe,Bhe,vhe,she,Nhe,khe,Uhe,phe,Dhe],Jhe=Zhe({defaultModifiers:Khe});function ad(t){const{elementType:e,externalSlotProps:r,ownerState:n,skipResolvingSlotProps:i=!1,...a}=t,s=i?{}:jX(r,n),{props:o,internalRef:c}=UX({...a,externalSlotProps:s}),f=Uo(c,s?.ref,t.additionalProps?.ref);return zX(e,{...o,ref:f},n)}function Fg(t){return parseInt(te.version,10)>=19?t?.props?.ref||null:t?.ref||null}function Qhe(t){return typeof t=="function"?t():t}const KX=te.forwardRef(function(e,r){const{children:n,container:i,disablePortal:a=!1}=e,[s,o]=te.useState(null),c=Uo(te.isValidElement(n)?Fg(n):null,r);if(Tu(()=>{a||o(Qhe(i)||document.body)},[i,a]),Tu(()=>{if(s&&!a)return y8(r,s),()=>{y8(r,null)}},[r,s,a]),a){if(te.isValidElement(n)){const f={ref:c};return te.cloneElement(n,f)}return n}return s&&lp.createPortal(n,s)});function ede(t){return gi("MuiPopper",t)}pi("MuiPopper",["root"]);function tde(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function zM(t){return typeof t=="function"?t():t}function rde(t){return t.nodeType!==void 0}const nde=t=>{const{classes:e}=t;return mi({root:["root"]},ede,e)},ide={},ade=te.forwardRef(function(e,r){const{anchorEl:n,children:i,direction:a,disablePortal:s,modifiers:o,open:c,placement:f,popperOptions:d,popperRef:m,slotProps:b={},slots:x={},TransitionProps:E,ownerState:T,...A}=e,R=te.useRef(null),F=Uo(R,r),N=te.useRef(null),O=Uo(N,m),U=te.useRef(O);Tu(()=>{U.current=O},[O]),te.useImperativeHandle(m,()=>N.current,[]);const j=tde(f,a),[H,W]=te.useState(j),[X,oe]=te.useState(zM(n));te.useEffect(()=>{N.current&&N.current.forceUpdate()}),te.useEffect(()=>{n&&oe(zM(n))},[n]),Tu(()=>{if(!X||!c)return;const fe=ye=>{W(ye.placement)};let pe=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:ye})=>{fe(ye)}}];o!=null&&(pe=pe.concat(o)),d&&d.modifiers!=null&&(pe=pe.concat(d.modifiers));const De=Jhe(X,R.current,{placement:j,...d,modifiers:pe});return U.current(De),()=>{De.destroy(),U.current(null)}},[X,s,o,c,d,j]);const ee={placement:H};E!==null&&(ee.TransitionProps=E);const G=nde(e),ae=x.root??"div",se=ad({elementType:ae,externalSlotProps:b.root,externalForwardedProps:A,additionalProps:{role:"tooltip",ref:F},ownerState:e,className:G.root});return J.jsx(ae,{...se,children:typeof i=="function"?i(ee):i})}),ode=te.forwardRef(function(e,r){const{anchorEl:n,children:i,container:a,direction:s="ltr",disablePortal:o=!1,keepMounted:c=!1,modifiers:f,open:d,placement:m="bottom",popperOptions:b=ide,popperRef:x,style:E,transition:T=!1,slotProps:A={},slots:R={},...F}=e,[N,O]=te.useState(!0),U=()=>{O(!1)},j=()=>{O(!0)};if(!c&&!d&&(!T||N))return null;let H;if(a)H=a;else if(n){const oe=zM(n);H=oe&&rde(oe)?fs(oe).body:fs(null).body}const W=!d&&c&&(!T||N)?"none":void 0,X=T?{in:d,onEnter:U,onExited:j}:void 0;return J.jsx(KX,{disablePortal:o,container:H,children:J.jsx(ade,{anchorEl:n,direction:s,disablePortal:o,modifiers:f,ref:r,open:T?!N:d,placement:m,popperOptions:b,popperRef:x,slotProps:A,slots:R,...F,style:{position:"fixed",top:0,left:0,display:W,...E},TransitionProps:X,children:i})})}),sde=Dr(ode,{name:"MuiPopper",slot:"Root"})({}),JX=te.forwardRef(function(e,r){const n=Ax(),i=bi({props:e,name:"MuiPopper"}),{anchorEl:a,component:s,components:o,componentsProps:c,container:f,disablePortal:d,keepMounted:m,modifiers:b,open:x,placement:E,popperOptions:T,popperRef:A,transition:R,slots:F,slotProps:N,...O}=i,U=F?.root??o?.Root,j={anchorEl:a,container:f,disablePortal:d,keepMounted:m,modifiers:b,open:x,placement:E,popperOptions:T,popperRef:A,transition:R,...O};return J.jsx(sde,{as:s,direction:n?"rtl":"ltr",slots:{root:U},slotProps:N??c,...j,ref:r})});function B2(t){return parseInt(t,10)||0}const lde={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function ude(t){for(const e in t)return!1;return!0}function O8(t){return ude(t)||t.outerHeightStyle===0&&!t.overflowing}const cde=te.forwardRef(function(e,r){const{onChange:n,maxRows:i,minRows:a=1,style:s,value:o,...c}=e,{current:f}=te.useRef(o!=null),d=te.useRef(null),m=Uo(r,d),b=te.useRef(null),x=te.useRef(null),E=te.useCallback(()=>{const N=d.current,O=x.current;if(!N||!O)return;const j=_c(N).getComputedStyle(N);if(j.width==="0px")return{outerHeightStyle:0,overflowing:!1};O.style.width=j.width,O.value=N.value||e.placeholder||"x",O.value.slice(-1)===`
`&&(O.value+=" ");const H=j.boxSizing,W=B2(j.paddingBottom)+B2(j.paddingTop),X=B2(j.borderBottomWidth)+B2(j.borderTopWidth),oe=O.scrollHeight;O.value="x";const ee=O.scrollHeight;let G=oe;a&&(G=Math.max(Number(a)*ee,G)),i&&(G=Math.min(Number(i)*ee,G)),G=Math.max(G,ee);const ae=G+(H==="border-box"?W+X:0),se=Math.abs(G-oe)<=1;return{outerHeightStyle:ae,overflowing:se}},[i,a,e.placeholder]),T=ou(()=>{const N=d.current,O=E();if(!N||!O||O8(O))return!1;const U=O.outerHeightStyle;return b.current!=null&&b.current!==U}),A=te.useCallback(()=>{const N=d.current,O=E();if(!N||!O||O8(O))return;const U=O.outerHeightStyle;b.current!==U&&(b.current=U,N.style.height=`${U}px`),N.style.overflow=O.overflowing?"hidden":""},[E]),R=te.useRef(-1);Tu(()=>{const N=WD(A),O=d?.current;if(!O)return;const U=_c(O);U.addEventListener("resize",N);let j;return typeof ResizeObserver<"u"&&(j=new ResizeObserver(()=>{T()&&(j.unobserve(O),cancelAnimationFrame(R.current),A(),R.current=requestAnimationFrame(()=>{j.observe(O)}))}),j.observe(O)),()=>{N.clear(),cancelAnimationFrame(R.current),U.removeEventListener("resize",N),j&&j.disconnect()}},[E,A,T]),Tu(()=>{A()});const F=N=>{f||A();const O=N.target,U=O.value.length,j=O.value.endsWith(`
`),H=O.selectionStart===U;j&&H&&O.setSelectionRange(U,U),n&&n(N)};return J.jsxs(te.Fragment,{children:[J.jsx("textarea",{value:o,onChange:F,ref:m,rows:a,style:s,...c}),J.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:x,tabIndex:-1,style:{...lde.shadow,...s,paddingTop:0,paddingBottom:0}})]})});function Bg({props:t,states:e,muiFormControl:r}){return e.reduce((n,i)=>(n[i]=t[i],r&&typeof t[i]>"u"&&(n[i]=r[i]),n),{})}const iO=te.createContext(void 0);function Ad(){return te.useContext(iO)}function L8(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function qS(t,e=!1){return t&&(L8(t.value)&&t.value!==""||e&&L8(t.defaultValue)&&t.defaultValue!=="")}function fde(t){return t.startAdornment}function hde(t){return gi("MuiInputBase",t)}const B0=pi("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var N8;const WT=(t,e)=>{const{ownerState:r}=t;return[e.root,r.formControl&&e.formControl,r.startAdornment&&e.adornedStart,r.endAdornment&&e.adornedEnd,r.error&&e.error,r.size==="small"&&e.sizeSmall,r.multiline&&e.multiline,r.color&&e[`color${un(r.color)}`],r.fullWidth&&e.fullWidth,r.hiddenLabel&&e.hiddenLabel]},XT=(t,e)=>{const{ownerState:r}=t;return[e.input,r.size==="small"&&e.inputSizeSmall,r.multiline&&e.inputMultiline,r.type==="search"&&e.inputTypeSearch,r.startAdornment&&e.inputAdornedStart,r.endAdornment&&e.inputAdornedEnd,r.hiddenLabel&&e.inputHiddenLabel]},dde=t=>{const{classes:e,color:r,disabled:n,error:i,endAdornment:a,focused:s,formControl:o,fullWidth:c,hiddenLabel:f,multiline:d,readOnly:m,size:b,startAdornment:x,type:E}=t,T={root:["root",`color${un(r)}`,n&&"disabled",i&&"error",c&&"fullWidth",s&&"focused",o&&"formControl",b&&b!=="medium"&&`size${un(b)}`,d&&"multiline",x&&"adornedStart",a&&"adornedEnd",f&&"hiddenLabel",m&&"readOnly"],input:["input",n&&"disabled",E==="search"&&"inputTypeSearch",d&&"inputMultiline",b==="small"&&"inputSizeSmall",f&&"inputHiddenLabel",x&&"inputAdornedStart",a&&"inputAdornedEnd",m&&"readOnly"]};return mi(T,hde,e)},YT=Dr("div",{name:"MuiInputBase",slot:"Root",overridesResolver:WT})(ci(({theme:t})=>({...t.typography.body1,color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${B0.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:e})=>e.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:e,size:r})=>e.multiline&&r==="small",style:{paddingTop:1}},{props:({ownerState:e})=>e.fullWidth,style:{width:"100%"}}]}))),ZT=Dr("input",{name:"MuiInputBase",slot:"Input",overridesResolver:XT})(ci(({theme:t})=>{const e=t.palette.mode==="light",r={color:"currentColor",...t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5},transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})},n={opacity:"0 !important"},i=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${B0.formControl} &`]:{"&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&::-ms-input-placeholder":n,"&:focus::-webkit-input-placeholder":i,"&:focus::-moz-placeholder":i,"&:focus::-ms-input-placeholder":i},[`&.${B0.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},variants:[{props:({ownerState:a})=>!a.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:a})=>a.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),F8=Mce({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),aO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiInputBase"}),{"aria-describedby":i,autoComplete:a,autoFocus:s,className:o,color:c,components:f={},componentsProps:d={},defaultValue:m,disabled:b,disableInjectingGlobalStyles:x,endAdornment:E,error:T,fullWidth:A=!1,id:R,inputComponent:F="input",inputProps:N={},inputRef:O,margin:U,maxRows:j,minRows:H,multiline:W=!1,name:X,onBlur:oe,onChange:ee,onClick:G,onFocus:ae,onKeyDown:se,onKeyUp:fe,placeholder:pe,readOnly:De,renderSuffix:ye,rows:we,size:Te,slotProps:Re={},slots:de={},startAdornment:Ee,type:xe="text",value:Ne,...Fe}=n,Xe=N.value!=null?N.value:Ne,{current:Be}=te.useRef(Xe!=null),ot=te.useRef(),Ke=te.useCallback(Ge=>{},[]),it=Uo(ot,O,N.ref,Ke),[Me,zt]=te.useState(!1),st=Ad(),$e=Bg({props:n,muiFormControl:st,states:["color","disabled","error","hiddenLabel","size","required","filled"]});$e.focused=st?st.focused:Me,te.useEffect(()=>{!st&&b&&Me&&(zt(!1),oe&&oe())},[st,b,Me,oe]);const Jt=st&&st.onFilled,Ht=st&&st.onEmpty,pr=te.useCallback(Ge=>{qS(Ge)?Jt&&Jt():Ht&&Ht()},[Jt,Ht]);Tu(()=>{Be&&pr({value:Xe})},[Xe,pr,Be]);const _t=Ge=>{ae&&ae(Ge),N.onFocus&&N.onFocus(Ge),st&&st.onFocus?st.onFocus(Ge):zt(!0)},vr=Ge=>{oe&&oe(Ge),N.onBlur&&N.onBlur(Ge),st&&st.onBlur?st.onBlur(Ge):zt(!1)},br=(Ge,...Nt)=>{if(!Be){const Et=Ge.target||ot.current;if(Et==null)throw new Error(mp(1));pr({value:Et.value})}N.onChange&&N.onChange(Ge,...Nt),ee&&ee(Ge,...Nt)};te.useEffect(()=>{pr(ot.current)},[]);const lr=Ge=>{ot.current&&Ge.currentTarget===Ge.target&&ot.current.focus(),G&&G(Ge)};let Cr=F,Tr=N;W&&Cr==="input"&&(we?Tr={type:void 0,minRows:we,maxRows:we,...Tr}:Tr={type:void 0,maxRows:j,minRows:H,...Tr},Cr=cde);const Qt=Ge=>{pr(Ge.animationName==="mui-auto-fill-cancel"?ot.current:{value:"x"})};te.useEffect(()=>{st&&st.setAdornedStart(!!Ee)},[st,Ee]);const at={...n,color:$e.color||"primary",disabled:$e.disabled,endAdornment:E,error:$e.error,focused:$e.focused,formControl:st,fullWidth:A,hiddenLabel:$e.hiddenLabel,multiline:W,size:$e.size,startAdornment:Ee,type:xe},Pe=dde(at),be=de.root||f.Root||YT,je=Re.root||d.root||{},qe=de.input||f.Input||ZT;return Tr={...Tr,...Re.input??d.input},J.jsxs(te.Fragment,{children:[!x&&typeof F8=="function"&&(N8||(N8=J.jsx(F8,{}))),J.jsxs(be,{...je,ref:r,onClick:lr,...Fe,...!md(be)&&{ownerState:{...at,...je.ownerState}},className:An(Pe.root,je.className,o,De&&"MuiInputBase-readOnly"),children:[Ee,J.jsx(iO.Provider,{value:null,children:J.jsx(qe,{"aria-invalid":$e.error,"aria-describedby":i,autoComplete:a,autoFocus:s,defaultValue:m,disabled:$e.disabled,id:R,onAnimationStart:Qt,name:X,placeholder:pe,readOnly:De,required:$e.required,rows:we,value:Xe,onKeyDown:se,onKeyUp:fe,type:xe,...Tr,...!md(qe)&&{as:Cr,ownerState:{...at,...Tr.ownerState}},ref:it,className:An(Pe.input,Tr.className,De&&"MuiInputBase-readOnly"),onBlur:vr,onChange:br,onFocus:_t})}),E,ye?ye({...$e,startAdornment:Ee}):null]})]})});function pde(t){return gi("MuiInput",t)}const e1={...B0,...pi("MuiInput",["root","underline","input"])};function gde(t){return gi("MuiOutlinedInput",t)}const ed={...B0,...pi("MuiOutlinedInput",["root","notchedOutline","input"])};function mde(t){return gi("MuiFilledInput",t)}const cm={...B0,...pi("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},yde=Ji(J.jsx("path",{d:"M7 10l5 5 5-5z"})),vde=Ji(J.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function _de(t){return gi("MuiAvatar",t)}pi("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const bde=t=>{const{classes:e,variant:r,colorDefault:n}=t;return mi({root:["root",r,n&&"colorDefault"],img:["img"],fallback:["fallback"]},_de,e)},xde=Dr("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],r.colorDefault&&e.colorDefault]}})(ci(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),wde=Dr("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),Sde=Dr(vde,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function Ede({crossOrigin:t,referrerPolicy:e,src:r,srcSet:n}){const[i,a]=te.useState(!1);return te.useEffect(()=>{if(!r&&!n)return;a(!1);let s=!0;const o=new Image;return o.onload=()=>{s&&a("loaded")},o.onerror=()=>{s&&a("error")},o.crossOrigin=t,o.referrerPolicy=e,o.src=r,n&&(o.srcset=n),()=>{s=!1}},[t,e,r,n]),i}const QX=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiAvatar"}),{alt:i,children:a,className:s,component:o="div",slots:c={},slotProps:f={},imgProps:d,sizes:m,src:b,srcSet:x,variant:E="circular",...T}=n;let A=null;const R={...n,component:o,variant:E},F=Ede({...d,...typeof f.img=="function"?f.img(R):f.img,src:b,srcSet:x}),N=b||x,O=N&&F!=="error";R.colorDefault=!O,delete R.ownerState;const U=bde(R),[j,H]=Ei("root",{ref:r,className:An(U.root,s),elementType:xde,externalForwardedProps:{slots:c,slotProps:f,component:o,...T},ownerState:R}),[W,X]=Ei("img",{className:U.img,elementType:wde,externalForwardedProps:{slots:c,slotProps:{img:{...d,...f.img}}},additionalProps:{alt:i,src:b,srcSet:x,sizes:m},ownerState:R}),[oe,ee]=Ei("fallback",{className:U.fallback,elementType:Sde,externalForwardedProps:{slots:c,slotProps:f},shouldForwardComponentProp:!0,ownerState:R});return O?A=J.jsx(W,{...X}):a||a===0?A=a:N&&i?A=i[0]:A=J.jsx(oe,{...ee}),J.jsx(j,{...H,children:A})}),Tde={entering:{opacity:1},entered:{opacity:1}},jM=te.forwardRef(function(e,r){const n=Nc(),i={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:a,appear:s=!0,children:o,easing:c,in:f,onEnter:d,onEntered:m,onEntering:b,onExit:x,onExited:E,onExiting:T,style:A,timeout:R=i,TransitionComponent:F=Jf,...N}=e,O=te.useRef(null),U=Uo(O,Fg(o),r),j=se=>fe=>{if(se){const pe=O.current;fe===void 0?se(pe):se(pe,fe)}},H=j(b),W=j((se,fe)=>{ZD(se);const pe=vp({style:A,timeout:R,easing:c},{mode:"enter"});se.style.webkitTransition=n.transitions.create("opacity",pe),se.style.transition=n.transitions.create("opacity",pe),d&&d(se,fe)}),X=j(m),oe=j(T),ee=j(se=>{const fe=vp({style:A,timeout:R,easing:c},{mode:"exit"});se.style.webkitTransition=n.transitions.create("opacity",fe),se.style.transition=n.transitions.create("opacity",fe),x&&x(se)}),G=j(E),ae=se=>{a&&a(O.current,se)};return J.jsx(F,{appear:s,in:f,nodeRef:O,onEnter:W,onEntered:X,onEntering:H,onExit:ee,onExited:G,onExiting:oe,addEndListener:ae,timeout:R,...N,children:(se,{ownerState:fe,...pe})=>te.cloneElement(o,{style:{opacity:0,visibility:se==="exited"&&!f?"hidden":void 0,...Tde[se],...A,...o.props.style},ref:U,...pe})})});function Cde(t){return gi("MuiBackdrop",t)}pi("MuiBackdrop",["root","invisible"]);const Ade=t=>{const{classes:e,invisible:r}=t;return mi({root:["root",r&&"invisible"]},Cde,e)},Ide=Dr("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.invisible&&e.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),eY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiBackdrop"}),{children:i,className:a,component:s="div",invisible:o=!1,open:c,components:f={},componentsProps:d={},slotProps:m={},slots:b={},TransitionComponent:x,transitionDuration:E,...T}=n,A={...n,component:s,invisible:o},R=Ade(A),F={transition:x,root:f.Root,...b},N={...d,...m},O={component:s,slots:F,slotProps:N},[U,j]=Ei("root",{elementType:Ide,externalForwardedProps:O,className:An(R.root,a),ownerState:A}),[H,W]=Ei("transition",{elementType:jM,externalForwardedProps:O,ownerState:A});return J.jsx(H,{in:c,timeout:E,...T,...W,children:J.jsx(U,{"aria-hidden":!0,...j,classes:R,ref:r,children:i})})}),Pde=pi("MuiBox",["root"]),Mde=f_(),Jo=cX({themeId:Sh,defaultTheme:Mde,defaultClassName:Pde.root,generateClassName:zD.generate});function kde(t){return gi("MuiButton",t)}const fm=pi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),tY=te.createContext({}),rY=te.createContext(void 0),Rde=t=>{const{color:e,disableElevation:r,fullWidth:n,size:i,variant:a,loading:s,loadingPosition:o,classes:c}=t,f={root:["root",s&&"loading",a,`${a}${un(e)}`,`size${un(i)}`,`${a}Size${un(i)}`,`color${un(e)}`,r&&"disableElevation",n&&"fullWidth",s&&`loadingPosition${un(o)}`],startIcon:["icon","startIcon",`iconSize${un(i)}`],endIcon:["icon","endIcon",`iconSize${un(i)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},d=mi(f,kde,c);return{...c,...d}},nY=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],Dde=Dr(h_,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`${r.variant}${un(r.color)}`],e[`size${un(r.size)}`],e[`${r.variant}Size${un(r.size)}`],r.color==="inherit"&&e.colorInherit,r.disableElevation&&e.disableElevation,r.fullWidth&&e.fullWidth,r.loading&&e.loading]}})(ci(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],r=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${fm.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${fm.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${fm.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${fm.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(jl()).map(([n])=>({props:{color:n},style:{"--variant-textColor":(t.vars||t).palette[n].main,"--variant-outlinedColor":(t.vars||t).palette[n].main,"--variant-outlinedBorder":t.alpha((t.vars||t).palette[n].main,.5),"--variant-containedColor":(t.vars||t).palette[n].contrastText,"--variant-containedBg":(t.vars||t).palette[n].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[n].dark,"--variant-textBg":t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[n].main,"--variant-outlinedBg":t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:e,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:r,"--variant-textBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${fm.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${fm.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${fm.loading}`]:{color:"transparent"}}}]}})),Ode=Dr("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.startIcon,r.loading&&e.startIconLoadingStart,e[`iconSize${un(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...nY]})),Lde=Dr("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.endIcon,r.loading&&e.endIconLoadingEnd,e[`iconSize${un(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...nY]})),Nde=Dr("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),B8=Dr("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),ta=te.forwardRef(function(e,r){const n=te.useContext(tY),i=te.useContext(rY),a=kb(n,e),s=bi({props:a,name:"MuiButton"}),{children:o,color:c="primary",component:f="button",className:d,disabled:m=!1,disableElevation:b=!1,disableFocusRipple:x=!1,endIcon:E,focusVisibleClassName:T,fullWidth:A=!1,id:R,loading:F=null,loadingIndicator:N,loadingPosition:O="center",size:U="medium",startIcon:j,type:H,variant:W="text",...X}=s,oe=Og(R),ee=N??J.jsx(HT,{"aria-labelledby":oe,color:"inherit",size:16}),G={...s,color:c,component:f,disabled:m,disableElevation:b,disableFocusRipple:x,fullWidth:A,loading:F,loadingIndicator:ee,loadingPosition:O,size:U,type:H,variant:W},ae=Rde(G),se=(j||F&&O==="start")&&J.jsx(Ode,{className:ae.startIcon,ownerState:G,children:j||J.jsx(B8,{className:ae.loadingIconPlaceholder,ownerState:G})}),fe=(E||F&&O==="end")&&J.jsx(Lde,{className:ae.endIcon,ownerState:G,children:E||J.jsx(B8,{className:ae.loadingIconPlaceholder,ownerState:G})}),pe=i||"",De=typeof F=="boolean"?J.jsx("span",{className:ae.loadingWrapper,style:{display:"contents"},children:F&&J.jsx(Nde,{className:ae.loadingIndicator,ownerState:G,children:ee})}):null;return J.jsxs(Dde,{ownerState:G,className:An(n.className,ae.root,d,pe),component:f,disabled:m||F,focusRipple:!x,focusVisibleClassName:An(ae.focusVisible,T),ref:r,type:H,id:F?oe:R,...X,classes:ae,children:[se,O!=="end"&&De,o,O==="end"&&De,fe]})});function Fde(t){return te.Children.toArray(t).filter(e=>te.isValidElement(e))}function Bde(t){return gi("MuiButtonGroup",t)}const ea=pi("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),zde=(t,e)=>{const{ownerState:r}=t;return[{[`& .${ea.grouped}`]:e.grouped},{[`& .${ea.grouped}`]:e[`grouped${un(r.orientation)}`]},{[`& .${ea.grouped}`]:e[`grouped${un(r.variant)}`]},{[`& .${ea.grouped}`]:e[`grouped${un(r.variant)}${un(r.orientation)}`]},{[`& .${ea.grouped}`]:e[`grouped${un(r.variant)}${un(r.color)}`]},{[`& .${ea.firstButton}`]:e.firstButton},{[`& .${ea.lastButton}`]:e.lastButton},{[`& .${ea.middleButton}`]:e.middleButton},e.root,e[r.variant],r.disableElevation===!0&&e.disableElevation,r.fullWidth&&e.fullWidth,r.orientation==="vertical"&&e.vertical]},jde=t=>{const{classes:e,color:r,disabled:n,disableElevation:i,fullWidth:a,orientation:s,variant:o}=t,c={root:["root",o,s,a&&"fullWidth",i&&"disableElevation",`color${un(r)}`],grouped:["grouped",`grouped${un(s)}`,`grouped${un(o)}`,`grouped${un(o)}${un(s)}`,`grouped${un(o)}${un(r)}`,n&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return mi(c,Bde,e)},Ude=Dr("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:zde})(ci(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(t.vars||t).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${ea.lastButton},& .${ea.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${ea.lastButton},& .${ea.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderRight:t.vars?`1px solid ${t.alpha(t.vars.palette.common.onBackground,.23)}`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${ea.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottom:t.vars?`1px solid ${t.alpha(t.vars.palette.common.onBackground,.23)}`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${ea.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(jl()).flatMap(([e])=>[{props:{variant:"text",color:e},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderColor:t.alpha((t.vars||t).palette[e].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${ea.lastButton},& .${ea.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${ea.lastButton},& .${ea.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderRight:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${ea.disabled}`]:{borderRight:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderBottom:`1px solid ${(t.vars||t).palette.grey[400]}`,[`&.${ea.disabled}`]:{borderBottom:`1px solid ${(t.vars||t).palette.action.disabled}`}}}},...Object.entries(t.palette).filter(jl(["dark"])).map(([e])=>({props:{variant:"contained",color:e},style:{[`& .${ea.firstButton},& .${ea.middleButton}`]:{borderColor:(t.vars||t).palette[e].dark}}}))],[`& .${ea.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),UM=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiButtonGroup"}),{children:i,className:a,color:s="primary",component:o="div",disabled:c=!1,disableElevation:f=!1,disableFocusRipple:d=!1,disableRipple:m=!1,fullWidth:b=!1,orientation:x="horizontal",size:E="medium",variant:T="outlined",...A}=n,R={...n,color:s,component:o,disabled:c,disableElevation:f,disableFocusRipple:d,disableRipple:m,fullWidth:b,orientation:x,size:E,variant:T},F=jde(R),N=te.useMemo(()=>({className:F.grouped,color:s,disabled:c,disableElevation:f,disableFocusRipple:d,disableRipple:m,fullWidth:b,size:E,variant:T}),[s,c,f,d,m,b,E,T,F.grouped]),O=Fde(i),U=O.length,j=H=>{const W=H===0,X=H===U-1;return W&&X?"":W?F.firstButton:X?F.lastButton:F.middleButton};return J.jsx(Ude,{as:o,role:"group",className:An(F.root,a),ref:r,ownerState:R,...A,children:J.jsx(tY.Provider,{value:N,children:O.map((H,W)=>J.jsx(rY.Provider,{value:j(W),children:H},W))})})});function Vde(t){return gi("PrivateSwitchBase",t)}pi("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const $de=t=>{const{classes:e,checked:r,disabled:n,edge:i}=t,a={root:["root",r&&"checked",n&&"disabled",i&&`edge${un(i)}`],input:["input"]};return mi(a,Vde,e)},qde=Dr(h_,{name:"MuiSwitchBase"})({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:t,ownerState:e})=>t==="start"&&e.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:t,ownerState:e})=>t==="end"&&e.size!=="small",style:{marginRight:-12}}]}),Hde=Dr("input",{name:"MuiSwitchBase",shouldForwardProp:Al})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),iY=te.forwardRef(function(e,r){const{autoFocus:n,checked:i,checkedIcon:a,defaultChecked:s,disabled:o,disableFocusRipple:c=!1,edge:f=!1,icon:d,id:m,inputProps:b,inputRef:x,name:E,onBlur:T,onChange:A,onFocus:R,readOnly:F,required:N=!1,tabIndex:O,type:U,value:j,slots:H={},slotProps:W={},...X}=e,[oe,ee]=Wm({controlled:i,default:!!s,name:"SwitchBase",state:"checked"}),G=Ad(),ae=Ne=>{R&&R(Ne),G&&G.onFocus&&G.onFocus(Ne)},se=Ne=>{T&&T(Ne),G&&G.onBlur&&G.onBlur(Ne)},fe=Ne=>{if(Ne.nativeEvent.defaultPrevented)return;const Fe=Ne.target.checked;ee(Fe),A&&A(Ne,Fe)};let pe=o;G&&typeof pe>"u"&&(pe=G.disabled);const De=U==="checkbox"||U==="radio",ye={...e,checked:oe,disabled:pe,disableFocusRipple:c,edge:f},we=$de(ye),Te={slots:H,slotProps:{input:b,...W}},[Re,de]=Ei("root",{ref:r,elementType:qde,className:we.root,shouldForwardComponentProp:!0,externalForwardedProps:{...Te,component:"span",...X},getSlotProps:Ne=>({...Ne,onFocus:Fe=>{Ne.onFocus?.(Fe),ae(Fe)},onBlur:Fe=>{Ne.onBlur?.(Fe),se(Fe)}}),ownerState:ye,additionalProps:{centerRipple:!0,focusRipple:!c,disabled:pe,role:void 0,tabIndex:null}}),[Ee,xe]=Ei("input",{ref:x,elementType:Hde,className:we.input,externalForwardedProps:Te,getSlotProps:Ne=>({...Ne,onChange:Fe=>{Ne.onChange?.(Fe),fe(Fe)}}),ownerState:ye,additionalProps:{autoFocus:n,checked:i,defaultChecked:s,disabled:pe,id:De?m:void 0,name:E,readOnly:F,required:N,tabIndex:O,type:U,...U==="checkbox"&&j===void 0?{}:{value:j}}});return J.jsxs(Re,{...de,children:[J.jsx(Ee,{...xe}),oe?a:d]})}),Gde=Ji(J.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),Wde=Ji(J.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),Xde=Ji(J.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}));function Yde(t){return gi("MuiCheckbox",t)}const yA=pi("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Zde=t=>{const{classes:e,indeterminate:r,color:n,size:i}=t,a={root:["root",r&&"indeterminate",`color${un(n)}`,`size${un(i)}`]},s=mi(a,Yde,e);return{...e,...s}},Kde=Dr(iY,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.indeterminate&&e.indeterminate,e[`size${un(r.size)}`],r.color!=="default"&&e[`color${un(r.color)}`]]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{[`&.${yA.checked}, &.${yA.indeterminate}`]:{color:(t.vars||t).palette[e].main},[`&.${yA.disabled}`]:{color:(t.vars||t).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),Jde=J.jsx(Wde,{}),Qde=J.jsx(Gde,{}),epe=J.jsx(Xde,{}),z0=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiCheckbox"}),{checkedIcon:i=Jde,color:a="primary",icon:s=Qde,indeterminate:o=!1,indeterminateIcon:c=epe,inputProps:f,size:d="medium",disableRipple:m=!1,className:b,slots:x={},slotProps:E={},...T}=n,A=o?c:s,R=o?c:i,F={...n,disableRipple:m,color:a,indeterminate:o,size:d},N=Zde(F),O=E.input??f,[U,j]=Ei("root",{ref:r,elementType:Kde,className:An(N.root,b),shouldForwardComponentProp:!0,externalForwardedProps:{slots:x,slotProps:E,...T},ownerState:F,additionalProps:{type:"checkbox",icon:te.cloneElement(A,{fontSize:A.props.fontSize??d}),checkedIcon:te.cloneElement(R,{fontSize:R.props.fontSize??d}),disableRipple:m,slots:x,slotProps:{input:Db(typeof O=="function"?O(F):O,{"data-indeterminate":o})}}});return J.jsx(U,{...j,classes:N})});function z8(t){return t.substring(2).toLowerCase()}function tpe(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function rpe(t){const{children:e,disableReactTree:r=!1,mouseEvent:n="onClick",onClickAway:i,touchEvent:a="onTouchEnd"}=t,s=te.useRef(!1),o=te.useRef(null),c=te.useRef(!1),f=te.useRef(!1);te.useEffect(()=>(setTimeout(()=>{c.current=!0},0),()=>{c.current=!1}),[]);const d=Uo(Fg(e),o),m=ou(E=>{const T=f.current;f.current=!1;const A=fs(o.current);if(!c.current||!o.current||"clientX"in E&&tpe(E,A))return;if(s.current){s.current=!1;return}let R;E.composedPath?R=E.composedPath().includes(o.current):R=!A.documentElement.contains(E.target)||o.current.contains(E.target),!R&&(r||!T)&&i(E)}),b=E=>T=>{f.current=!0;const A=e.props[E];A&&A(T)},x={ref:d};return a!==!1&&(x[a]=b(a)),te.useEffect(()=>{if(a!==!1){const E=z8(a),T=fs(o.current),A=()=>{s.current=!0};return T.addEventListener(E,m),T.addEventListener("touchmove",A),()=>{T.removeEventListener(E,m),T.removeEventListener("touchmove",A)}}},[m,a]),n!==!1&&(x[n]=b(n)),te.useEffect(()=>{if(n!==!1){const E=z8(n),T=fs(o.current);return T.addEventListener(E,m),()=>{T.removeEventListener(E,m)}}},[m,n]),te.cloneElement(e,x)}function aY(t=window){const e=t.document.documentElement.clientWidth;return t.innerWidth-e}function npe(t){const e=fs(t);return e.body===t?_c(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function ob(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function j8(t){return parseInt(_c(t).getComputedStyle(t).paddingRight,10)||0}function ipe(t){const r=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(t.tagName),n=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return r||n}function U8(t,e,r,n,i){const a=[e,r,...n];[].forEach.call(t.children,s=>{const o=!a.includes(s),c=!ipe(s);o&&c&&ob(s,i)})}function vA(t,e){let r=-1;return t.some((n,i)=>e(n)?(r=i,!0):!1),r}function ape(t,e){const r=[],n=t.container;if(!e.disableScrollLock){if(npe(n)){const s=aY(_c(n));r.push({value:n.style.paddingRight,property:"padding-right",el:n}),n.style.paddingRight=`${j8(n)+s}px`;const o=fs(n).querySelectorAll(".mui-fixed");[].forEach.call(o,c=>{r.push({value:c.style.paddingRight,property:"padding-right",el:c}),c.style.paddingRight=`${j8(c)+s}px`})}let a;if(n.parentNode instanceof DocumentFragment)a=fs(n).body;else{const s=n.parentElement,o=_c(n);a=s?.nodeName==="HTML"&&o.getComputedStyle(s).overflowY==="scroll"?s:n}r.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return()=>{r.forEach(({value:a,el:s,property:o})=>{a?s.style.setProperty(o,a):s.style.removeProperty(o)})}}function ope(t){const e=[];return[].forEach.call(t.children,r=>{r.getAttribute("aria-hidden")==="true"&&e.push(r)}),e}class spe{constructor(){this.modals=[],this.containers=[]}add(e,r){let n=this.modals.indexOf(e);if(n!==-1)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&ob(e.modalRef,!1);const i=ope(r);U8(r,e.mount,e.modalRef,i,!0);const a=vA(this.containers,s=>s.container===r);return a!==-1?(this.containers[a].modals.push(e),n):(this.containers.push({modals:[e],container:r,restore:null,hiddenSiblings:i}),n)}mount(e,r){const n=vA(this.containers,a=>a.modals.includes(e)),i=this.containers[n];i.restore||(i.restore=ape(i,r))}remove(e,r=!0){const n=this.modals.indexOf(e);if(n===-1)return n;const i=vA(this.containers,s=>s.modals.includes(e)),a=this.containers[i];if(a.modals.splice(a.modals.indexOf(e),1),this.modals.splice(n,1),a.modals.length===0)a.restore&&a.restore(),e.modalRef&&ob(e.modalRef,r),U8(a.container,e.mount,e.modalRef,a.hiddenSiblings,!1),this.containers.splice(i,1);else{const s=a.modals[a.modals.length-1];s.modalRef&&ob(s.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const lpe=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function upe(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function cpe(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=n=>t.ownerDocument.querySelector(`input[type="radio"]${n}`);let r=e(`[name="${t.name}"]:checked`);return r||(r=e(`[name="${t.name}"]`)),r!==t}function fpe(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||cpe(t))}function hpe(t){const e=[],r=[];return Array.from(t.querySelectorAll(lpe)).forEach((n,i)=>{const a=upe(n);a===-1||!fpe(n)||(a===0?e.push(n):r.push({documentOrder:i,tabIndex:a,node:n}))}),r.sort((n,i)=>n.tabIndex===i.tabIndex?n.documentOrder-i.documentOrder:n.tabIndex-i.tabIndex).map(n=>n.node).concat(e)}function dpe(){return!0}function ppe(t){const{children:e,disableAutoFocus:r=!1,disableEnforceFocus:n=!1,disableRestoreFocus:i=!1,getTabbable:a=hpe,isEnabled:s=dpe,open:o}=t,c=te.useRef(!1),f=te.useRef(null),d=te.useRef(null),m=te.useRef(null),b=te.useRef(null),x=te.useRef(!1),E=te.useRef(null),T=Uo(Fg(e),E),A=te.useRef(null);te.useEffect(()=>{!o||!E.current||(x.current=!r)},[r,o]),te.useEffect(()=>{if(!o||!E.current)return;const N=fs(E.current);return E.current.contains(N.activeElement)||(E.current.hasAttribute("tabIndex")||E.current.setAttribute("tabIndex","-1"),x.current&&E.current.focus()),()=>{i||(m.current&&m.current.focus&&(c.current=!0,m.current.focus()),m.current=null)}},[o]),te.useEffect(()=>{if(!o||!E.current)return;const N=fs(E.current),O=H=>{A.current=H,!(n||!s()||H.key!=="Tab")&&N.activeElement===E.current&&H.shiftKey&&(c.current=!0,d.current&&d.current.focus())},U=()=>{const H=E.current;if(H===null)return;if(!N.hasFocus()||!s()||c.current){c.current=!1;return}if(H.contains(N.activeElement)||n&&N.activeElement!==f.current&&N.activeElement!==d.current)return;if(N.activeElement!==b.current)b.current=null;else if(b.current!==null)return;if(!x.current)return;let W=[];if((N.activeElement===f.current||N.activeElement===d.current)&&(W=a(E.current)),W.length>0){const X=!!(A.current?.shiftKey&&A.current?.key==="Tab"),oe=W[0],ee=W[W.length-1];typeof oe!="string"&&typeof ee!="string"&&(X?ee.focus():oe.focus())}else H.focus()};N.addEventListener("focusin",U),N.addEventListener("keydown",O,!0);const j=setInterval(()=>{N.activeElement&&N.activeElement.tagName==="BODY"&&U()},50);return()=>{clearInterval(j),N.removeEventListener("focusin",U),N.removeEventListener("keydown",O,!0)}},[r,n,i,s,o,a]);const R=N=>{m.current===null&&(m.current=N.relatedTarget),x.current=!0,b.current=N.target;const O=e.props.onFocus;O&&O(N)},F=N=>{m.current===null&&(m.current=N.relatedTarget),x.current=!0};return J.jsxs(te.Fragment,{children:[J.jsx("div",{tabIndex:o?0:-1,onFocus:F,ref:f,"data-testid":"sentinelStart"}),te.cloneElement(e,{ref:T,onFocus:R}),J.jsx("div",{tabIndex:o?0:-1,onFocus:F,ref:d,"data-testid":"sentinelEnd"})]})}function gpe(t){return typeof t=="function"?t():t}function mpe(t){return t?t.props.hasOwnProperty("in"):!1}const V8=()=>{},z2=new spe;function ype(t){const{container:e,disableEscapeKeyDown:r=!1,disableScrollLock:n=!1,closeAfterTransition:i=!1,onTransitionEnter:a,onTransitionExited:s,children:o,onClose:c,open:f,rootRef:d}=t,m=te.useRef({}),b=te.useRef(null),x=te.useRef(null),E=Uo(x,d),[T,A]=te.useState(!f),R=mpe(o);let F=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(F=!1);const N=()=>fs(b.current),O=()=>(m.current.modalRef=x.current,m.current.mount=b.current,m.current),U=()=>{z2.mount(O(),{disableScrollLock:n}),x.current&&(x.current.scrollTop=0)},j=ou(()=>{const fe=gpe(e)||N().body;z2.add(O(),fe),x.current&&U()}),H=()=>z2.isTopModal(O()),W=ou(fe=>{b.current=fe,fe&&(f&&H()?U():x.current&&ob(x.current,F))}),X=te.useCallback(()=>{z2.remove(O(),F)},[F]);te.useEffect(()=>()=>{X()},[X]),te.useEffect(()=>{f?j():(!R||!i)&&X()},[f,X,R,i,j]);const oe=fe=>pe=>{fe.onKeyDown?.(pe),!(pe.key!=="Escape"||pe.which===229||!H())&&(r||(pe.stopPropagation(),c&&c(pe,"escapeKeyDown")))},ee=fe=>pe=>{fe.onClick?.(pe),pe.target===pe.currentTarget&&c&&c(pe,"backdropClick")};return{getRootProps:(fe={})=>{const pe=Lm(t);delete pe.onTransitionEnter,delete pe.onTransitionExited;const De={...pe,...fe};return{role:"presentation",...De,onKeyDown:oe(De),ref:E}},getBackdropProps:(fe={})=>{const pe=fe;return{"aria-hidden":!0,...pe,onClick:ee(pe),open:f}},getTransitionProps:()=>{const fe=()=>{A(!1),a&&a()},pe=()=>{A(!0),s&&s(),i&&X()};return{onEnter:PM(fe,o?.props.onEnter??V8),onExited:PM(pe,o?.props.onExited??V8)}},rootRef:E,portalRef:W,isTopModal:H,exited:T,hasTransition:R}}function vpe(t){return gi("MuiModal",t)}pi("MuiModal",["root","hidden","backdrop"]);const _pe=t=>{const{open:e,exited:r,classes:n}=t;return mi({root:["root",!e&&r&&"hidden"],backdrop:["backdrop"]},vpe,n)},bpe=Dr("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.open&&r.exited&&e.hidden]}})(ci(({theme:t})=>({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),xpe=Dr(eY,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),oO=te.forwardRef(function(e,r){const n=bi({name:"MuiModal",props:e}),{BackdropComponent:i=xpe,BackdropProps:a,classes:s,className:o,closeAfterTransition:c=!1,children:f,container:d,component:m,components:b={},componentsProps:x={},disableAutoFocus:E=!1,disableEnforceFocus:T=!1,disableEscapeKeyDown:A=!1,disablePortal:R=!1,disableRestoreFocus:F=!1,disableScrollLock:N=!1,hideBackdrop:O=!1,keepMounted:U=!1,onClose:j,onTransitionEnter:H,onTransitionExited:W,open:X,slotProps:oe={},slots:ee={},theme:G,...ae}=n,se={...n,closeAfterTransition:c,disableAutoFocus:E,disableEnforceFocus:T,disableEscapeKeyDown:A,disablePortal:R,disableRestoreFocus:F,disableScrollLock:N,hideBackdrop:O,keepMounted:U},{getRootProps:fe,getBackdropProps:pe,getTransitionProps:De,portalRef:ye,isTopModal:we,exited:Te,hasTransition:Re}=ype({...se,rootRef:r}),de={...se,exited:Te},Ee=_pe(de),xe={};if(f.props.tabIndex===void 0&&(xe.tabIndex="-1"),Re){const{onEnter:Ke,onExited:it}=De();xe.onEnter=Ke,xe.onExited=it}const Ne={slots:{root:b.Root,backdrop:b.Backdrop,...ee},slotProps:{...x,...oe}},[Fe,Xe]=Ei("root",{ref:r,elementType:bpe,externalForwardedProps:{...Ne,...ae,component:m},getSlotProps:fe,ownerState:de,className:An(o,Ee?.root,!de.open&&de.exited&&Ee?.hidden)}),[Be,ot]=Ei("backdrop",{ref:a?.ref,elementType:i,externalForwardedProps:Ne,shouldForwardComponentProp:!0,additionalProps:a,getSlotProps:Ke=>pe({...Ke,onClick:it=>{Ke?.onClick&&Ke.onClick(it)}}),className:An(a?.className,Ee?.backdrop),ownerState:de});return!U&&!X&&(!Re||Te)?null:J.jsx(KX,{ref:ye,container:d,disablePortal:R,children:J.jsxs(Fe,{...Xe,children:[!O&&i?J.jsx(Be,{...ot}):null,J.jsx(ppe,{disableEnforceFocus:T,disableAutoFocus:E,disableRestoreFocus:F,isEnabled:we,open:X,children:te.cloneElement(f,xe)})]})})});function wpe(t){return gi("MuiDialog",t)}const _A=pi("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),oY=te.createContext({}),Spe=Dr(eY,{name:"MuiDialog",slot:"Backdrop",overrides:(t,e)=>e.backdrop})({zIndex:-1}),Epe=t=>{const{classes:e,scroll:r,maxWidth:n,fullWidth:i,fullScreen:a}=t,s={root:["root"],container:["container",`scroll${un(r)}`],paper:["paper",`paperScroll${un(r)}`,`paperWidth${un(String(n))}`,i&&"paperFullWidth",a&&"paperFullScreen"]};return mi(s,wpe,e)},Tpe=Dr(oO,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),Cpe=Dr("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.container,e[`scroll${un(r.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Ape=Dr(Uf,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`scrollPaper${un(r.scroll)}`],e[`paperWidth${un(String(r.maxWidth))}`],r.fullWidth&&e.paperFullWidth,r.fullScreen&&e.paperFullScreen]}})(ci(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${_A.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(e=>e!=="xs").map(e=>({props:{maxWidth:e},style:{maxWidth:`${t.breakpoints.values[e]}${t.breakpoints.unit}`,[`&.${_A.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[e]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${_A.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),sO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialog"}),i=Nc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{"aria-describedby":s,"aria-labelledby":o,"aria-modal":c=!0,BackdropComponent:f,BackdropProps:d,children:m,className:b,disableEscapeKeyDown:x=!1,fullScreen:E=!1,fullWidth:T=!1,maxWidth:A="sm",onClick:R,onClose:F,open:N,PaperComponent:O=Uf,PaperProps:U={},scroll:j="paper",slots:H={},slotProps:W={},TransitionComponent:X=jM,transitionDuration:oe=a,TransitionProps:ee,...G}=n,ae={...n,disableEscapeKeyDown:x,fullScreen:E,fullWidth:T,maxWidth:A,scroll:j},se=Epe(ae),fe=te.useRef(),pe=zt=>{fe.current=zt.target===zt.currentTarget},De=zt=>{R&&R(zt),fe.current&&(fe.current=null,F&&F(zt,"backdropClick"))},ye=Og(o),we=te.useMemo(()=>({titleId:ye}),[ye]),Te={transition:X,...H},Re={transition:ee,paper:U,backdrop:d,...W},de={slots:Te,slotProps:Re},[Ee,xe]=Ei("root",{elementType:Tpe,shouldForwardComponentProp:!0,externalForwardedProps:de,ownerState:ae,className:An(se.root,b),ref:r}),[Ne,Fe]=Ei("backdrop",{elementType:Spe,shouldForwardComponentProp:!0,externalForwardedProps:de,ownerState:ae}),[Xe,Be]=Ei("paper",{elementType:Ape,shouldForwardComponentProp:!0,externalForwardedProps:de,ownerState:ae,className:An(se.paper,U.className)}),[ot,Ke]=Ei("container",{elementType:Cpe,externalForwardedProps:de,ownerState:ae,className:se.container}),[it,Me]=Ei("transition",{elementType:jM,externalForwardedProps:de,ownerState:ae,additionalProps:{appear:!0,in:N,timeout:oe,role:"presentation"}});return J.jsx(Ee,{closeAfterTransition:!0,slots:{backdrop:Ne},slotProps:{backdrop:{transitionDuration:oe,as:f,...Fe}},disableEscapeKeyDown:x,onClose:F,open:N,onClick:De,...xe,...G,children:J.jsx(it,{...Me,children:J.jsx(ot,{onMouseDown:pe,...Ke,children:J.jsx(Xe,{as:O,elevation:24,role:"dialog","aria-describedby":s,"aria-labelledby":ye,"aria-modal":c,...Be,children:J.jsx(oY.Provider,{value:we,children:m})})})})})});function Ipe(t){return gi("MuiDialogActions",t)}pi("MuiDialogActions",["root","spacing"]);const Ppe=t=>{const{classes:e,disableSpacing:r}=t;return mi({root:["root",!r&&"spacing"]},Ipe,e)},Mpe=Dr("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableSpacing&&e.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:t})=>!t.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Mx=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogActions"}),{className:i,disableSpacing:a=!1,...s}=n,o={...n,disableSpacing:a},c=Ppe(o);return J.jsx(Mpe,{className:An(c.root,i),ownerState:o,ref:r,...s})});function kpe(t){return gi("MuiDialogContent",t)}pi("MuiDialogContent",["root","dividers"]);function Rpe(t){return gi("MuiDialogTitle",t)}const Dpe=pi("MuiDialogTitle",["root"]),Ope=t=>{const{classes:e,dividers:r}=t;return mi({root:["root",r&&"dividers"]},kpe,e)},Lpe=Dr("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.dividers&&e.dividers]}})(ci(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:e})=>e.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>!e.dividers,style:{[`.${Dpe.root} + &`]:{paddingTop:0}}}]}))),lO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogContent"}),{className:i,dividers:a=!1,...s}=n,o={...n,dividers:a},c=Ope(o);return J.jsx(Lpe,{className:An(c.root,i),ownerState:o,ref:r,...s})});function Npe(t){return gi("MuiDialogContentText",t)}pi("MuiDialogContentText",["root"]);const Fpe=t=>{const{classes:e}=t,n=mi({root:["root"]},Npe,e);return{...e,...n}},Bpe=Dr(Es,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiDialogContentText",slot:"Root"})({}),zpe=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogContentText"}),{children:i,className:a,...s}=n,o=Fpe(s);return J.jsx(Bpe,{component:"p",variant:"body1",color:"textSecondary",ref:r,ownerState:s,className:An(o.root,a),...n,classes:o})}),jpe=t=>{const{classes:e}=t;return mi({root:["root"]},Rpe,e)},Upe=Dr(Es,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),yy=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDialogTitle"}),{className:i,id:a,...s}=n,o=n,c=jpe(o),{titleId:f=a}=te.useContext(oY);return J.jsx(Upe,{component:"h2",className:An(c.root,i),ownerState:o,ref:r,variant:"h6",id:a??f,...s})});function Vpe(t){return gi("MuiDivider",t)}const $8=pi("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),$pe=t=>{const{absolute:e,children:r,classes:n,flexItem:i,light:a,orientation:s,textAlign:o,variant:c}=t;return mi({root:["root",e&&"absolute",c,a&&"light",s==="vertical"&&"vertical",i&&"flexItem",r&&"withChildren",r&&s==="vertical"&&"withChildrenVertical",o==="right"&&s!=="vertical"&&"textAlignRight",o==="left"&&s!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",s==="vertical"&&"wrapperVertical"]},Vpe,n)},qpe=Dr("div",{name:"MuiDivider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.absolute&&e.absolute,e[r.variant],r.light&&e.light,r.orientation==="vertical"&&e.vertical,r.flexItem&&e.flexItem,r.children&&e.withChildren,r.children&&r.orientation==="vertical"&&e.withChildrenVertical,r.textAlign==="right"&&r.orientation!=="vertical"&&e.textAlignRight,r.textAlign==="left"&&r.orientation!=="vertical"&&e.textAlignLeft]}})(ci(({theme:t})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:t.alpha((t.vars||t).palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:t.spacing(1),marginBottom:t.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:e})=>!!e.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:e})=>e.children&&e.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:e})=>e.orientation==="vertical"&&e.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(t.vars||t).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:e})=>e.textAlign==="right"&&e.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:e})=>e.textAlign==="left"&&e.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),Hpe=Dr("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.wrapper,r.orientation==="vertical"&&e.wrapperVertical]}})(ci(({theme:t})=>({display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`}}]}))),VM=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDivider"}),{absolute:i=!1,children:a,className:s,orientation:o="horizontal",component:c=a||o==="vertical"?"div":"hr",flexItem:f=!1,light:d=!1,role:m=c!=="hr"?"separator":void 0,textAlign:b="center",variant:x="fullWidth",...E}=n,T={...n,absolute:i,component:c,flexItem:f,light:d,orientation:o,role:m,textAlign:b,variant:x},A=$pe(T);return J.jsx(qpe,{as:c,className:An(A.root,s),role:m,ref:r,ownerState:T,"aria-orientation":m==="separator"&&(c!=="hr"||o==="vertical")?o:void 0,...E,children:a?J.jsx(Hpe,{className:A.wrapper,ownerState:T,children:a}):null})});VM&&(VM.muiSkipListHighlight=!0);function Gpe(t,e,r){const n=e.getBoundingClientRect(),i=r&&r.getBoundingClientRect(),a=_c(e);let s;if(e.fakeTransform)s=e.fakeTransform;else{const f=a.getComputedStyle(e);s=f.getPropertyValue("-webkit-transform")||f.getPropertyValue("transform")}let o=0,c=0;if(s&&s!=="none"&&typeof s=="string"){const f=s.split("(")[1].split(")")[0].split(",");o=parseInt(f[4],10),c=parseInt(f[5],10)}return t==="left"?i?`translateX(${i.right+o-n.left}px)`:`translateX(${a.innerWidth+o-n.left}px)`:t==="right"?i?`translateX(-${n.right-i.left-o}px)`:`translateX(-${n.left+n.width-o}px)`:t==="up"?i?`translateY(${i.bottom+c-n.top}px)`:`translateY(${a.innerHeight+c-n.top}px)`:i?`translateY(-${n.top-i.top+n.height-c}px)`:`translateY(-${n.top+n.height-c}px)`}function Wpe(t){return typeof t=="function"?t():t}function j2(t,e,r){const n=Wpe(r),i=Gpe(t,e,n);i&&(e.style.webkitTransform=i,e.style.transform=i)}const Xpe=te.forwardRef(function(e,r){const n=Nc(),i={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},a={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:s,appear:o=!0,children:c,container:f,direction:d="down",easing:m=i,in:b,onEnter:x,onEntered:E,onEntering:T,onExit:A,onExited:R,onExiting:F,style:N,timeout:O=a,TransitionComponent:U=Jf,...j}=e,H=te.useRef(null),W=Uo(Fg(c),H,r),X=ye=>we=>{ye&&(we===void 0?ye(H.current):ye(H.current,we))},oe=X((ye,we)=>{j2(d,ye,f),ZD(ye),x&&x(ye,we)}),ee=X((ye,we)=>{const Te=vp({timeout:O,style:N,easing:m},{mode:"enter"});ye.style.webkitTransition=n.transitions.create("-webkit-transform",{...Te}),ye.style.transition=n.transitions.create("transform",{...Te}),ye.style.webkitTransform="none",ye.style.transform="none",T&&T(ye,we)}),G=X(E),ae=X(F),se=X(ye=>{const we=vp({timeout:O,style:N,easing:m},{mode:"exit"});ye.style.webkitTransition=n.transitions.create("-webkit-transform",we),ye.style.transition=n.transitions.create("transform",we),j2(d,ye,f),A&&A(ye)}),fe=X(ye=>{ye.style.webkitTransition="",ye.style.transition="",R&&R(ye)}),pe=ye=>{s&&s(H.current,ye)},De=te.useCallback(()=>{H.current&&j2(d,H.current,f)},[d,f]);return te.useEffect(()=>{if(b||d==="down"||d==="right")return;const ye=WD(()=>{H.current&&j2(d,H.current,f)}),we=_c(H.current);return we.addEventListener("resize",ye),()=>{ye.clear(),we.removeEventListener("resize",ye)}},[d,b,f]),te.useEffect(()=>{b||De()},[b,De]),J.jsx(U,{nodeRef:H,onEnter:oe,onEntered:G,onEntering:ee,onExit:se,onExited:fe,onExiting:ae,addEndListener:pe,appear:o,in:b,timeout:O,...j,children:(ye,{ownerState:we,...Te})=>te.cloneElement(c,{ref:W,style:{visibility:ye==="exited"&&!b?"hidden":void 0,...N,...c.props.style},...Te})})});function Ype(t){return gi("MuiDrawer",t)}pi("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const sY=(t,e)=>{const{ownerState:r}=t;return[e.root,(r.variant==="permanent"||r.variant==="persistent")&&e.docked,e.modal]},Zpe=t=>{const{classes:e,anchor:r,variant:n}=t,i={root:["root",`anchor${un(r)}`],docked:[(n==="permanent"||n==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${un(r)}`,n!=="temporary"&&`paperAnchorDocked${un(r)}`]};return mi(i,Ype,e)},Kpe=Dr(oO,{name:"MuiDrawer",slot:"Root",overridesResolver:sY})(ci(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer}))),Jpe=Dr("div",{shouldForwardProp:Al,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:sY})({flex:"0 0 auto"}),Qpe=Dr(Uf,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`paperAnchor${un(r.anchor)}`],r.variant!=="temporary"&&e[`paperAnchorDocked${un(r.anchor)}`]]}})(ci(({theme:t})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:e})=>e.anchor==="left"&&e.variant!=="temporary",style:{borderRight:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="top"&&e.variant!=="temporary",style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="right"&&e.variant!=="temporary",style:{borderLeft:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>e.anchor==="bottom"&&e.variant!=="temporary",style:{borderTop:`1px solid ${(t.vars||t).palette.divider}`}}]}))),lY={left:"right",right:"left",top:"down",bottom:"up"};function xm(t){return["left","right"].includes(t)}function R1({direction:t},e){return t==="rtl"&&xm(e)?lY[e]:e}const uO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiDrawer"}),i=Nc(),a=Ax(),s={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:o="left",BackdropProps:c,children:f,className:d,elevation:m=16,hideBackdrop:b=!1,ModalProps:{BackdropProps:x,...E}={},onClose:T,open:A=!1,PaperProps:R={},SlideProps:F,TransitionComponent:N,transitionDuration:O=s,variant:U="temporary",slots:j={},slotProps:H={},...W}=n,X=te.useRef(!1);te.useEffect(()=>{X.current=!0},[]);const oe=R1({direction:a?"rtl":"ltr"},o),G={...n,anchor:o,elevation:m,open:A,variant:U,...W},ae=Zpe(G),se={slots:{transition:N,...j},slotProps:{paper:R,transition:F,...H,backdrop:Db(H.backdrop||{...c,...x},{transitionDuration:O})}},[fe,pe]=Ei("root",{ref:r,elementType:Kpe,className:An(ae.root,ae.modal,d),shouldForwardComponentProp:!0,ownerState:G,externalForwardedProps:{...se,...W,...E},additionalProps:{open:A,onClose:T,hideBackdrop:b,slots:{backdrop:se.slots.backdrop},slotProps:{backdrop:se.slotProps.backdrop}}}),[De,ye]=Ei("paper",{elementType:Qpe,shouldForwardComponentProp:!0,className:An(ae.paper,R.className),ownerState:G,externalForwardedProps:se,additionalProps:{elevation:U==="temporary"?m:0,square:!0,...U==="temporary"&&{role:"dialog","aria-modal":"true"}}}),[we,Te]=Ei("docked",{elementType:Jpe,ref:r,className:An(ae.root,ae.docked,d),ownerState:G,externalForwardedProps:se,additionalProps:W}),[Re,de]=Ei("transition",{elementType:Xpe,ownerState:G,externalForwardedProps:se,additionalProps:{in:A,direction:lY[oe],timeout:O,appear:X.current}}),Ee=J.jsx(De,{...ye,children:f});if(U==="permanent")return J.jsx(we,{...Te,children:Ee});const xe=J.jsx(Re,{...de,children:Ee});return U==="persistent"?J.jsx(we,{...Te,children:xe}):J.jsx(fe,{...pe,children:xe})}),ege=t=>{const{classes:e,disableUnderline:r,startAdornment:n,endAdornment:i,size:a,hiddenLabel:s,multiline:o}=t,c={root:["root",!r&&"underline",n&&"adornedStart",i&&"adornedEnd",a==="small"&&`size${un(a)}`,s&&"hiddenLabel",o&&"multiline"],input:["input"]},f=mi(c,mde,e);return{...e,...f}},tge=Dr(YT,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...WT(t,e),!r.disableUnderline&&e.underline]}})(ci(({theme:t})=>{const e=t.palette.mode==="light",r=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",n=e?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",i=e?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",a=e?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:i,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n}},[`&.${cm.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:n},[`&.${cm.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:a},variants:[{props:({ownerState:s})=>!s.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${cm.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${cm.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline):r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${cm.disabled}, .${cm.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${cm.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(jl()).map(([s])=>({props:{disableUnderline:!1,color:s},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[s]?.main}`}}})),{props:({ownerState:s})=>s.startAdornment,style:{paddingLeft:12}},{props:({ownerState:s})=>s.endAdornment,style:{paddingRight:12}},{props:({ownerState:s})=>s.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:s,size:o})=>s.multiline&&o==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:s})=>s.multiline&&s.hiddenLabel&&s.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),rge=Dr(ZT,{name:"MuiFilledInput",slot:"Input",overridesResolver:XT})(ci(({theme:t})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:e})=>e.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}},{props:({ownerState:e})=>e.hiddenLabel&&e.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:e})=>e.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),cO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFilledInput"}),{disableUnderline:i=!1,components:a={},componentsProps:s,fullWidth:o=!1,hiddenLabel:c,inputComponent:f="input",multiline:d=!1,slotProps:m,slots:b={},type:x="text",...E}=n,T={...n,disableUnderline:i,fullWidth:o,inputComponent:f,multiline:d,type:x},A=ege(n),R={root:{ownerState:T},input:{ownerState:T}},F=m??s?ec(R,m??s):R,N=b.root??a.Root??tge,O=b.input??a.Input??rge;return J.jsx(aO,{slots:{root:N,input:O},slotProps:F,fullWidth:o,inputComponent:f,multiline:d,ref:r,type:x,...E,classes:A})});cO.muiName="Input";function nge(t){return gi("MuiFormControl",t)}pi("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const ige=t=>{const{classes:e,margin:r,fullWidth:n}=t,i={root:["root",r!=="none"&&`margin${un(r)}`,n&&"fullWidth"]};return mi(i,nge,e)},age=Dr("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`margin${un(r.margin)}`],r.fullWidth&&e.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),af=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormControl"}),{children:i,className:a,color:s="primary",component:o="div",disabled:c=!1,error:f=!1,focused:d,fullWidth:m=!1,hiddenLabel:b=!1,margin:x="none",required:E=!1,size:T="medium",variant:A="outlined",...R}=n,F={...n,color:s,component:o,disabled:c,error:f,fullWidth:m,hiddenLabel:b,margin:x,required:E,size:T,variant:A},N=ige(F),[O,U]=te.useState(()=>{let fe=!1;return i&&te.Children.forEach(i,pe=>{if(!nb(pe,["Input","Select"]))return;const De=nb(pe,["Select"])?pe.props.input:pe;De&&fde(De.props)&&(fe=!0)}),fe}),[j,H]=te.useState(()=>{let fe=!1;return i&&te.Children.forEach(i,pe=>{nb(pe,["Input","Select"])&&(qS(pe.props,!0)||qS(pe.props.inputProps,!0))&&(fe=!0)}),fe}),[W,X]=te.useState(!1);c&&W&&X(!1);const oe=d!==void 0&&!c?d:W;let ee;te.useRef(!1);const G=te.useCallback(()=>{H(!0)},[]),ae=te.useCallback(()=>{H(!1)},[]),se=te.useMemo(()=>({adornedStart:O,setAdornedStart:U,color:s,disabled:c,error:f,filled:j,focused:oe,fullWidth:m,hiddenLabel:b,size:T,onBlur:()=>{X(!1)},onFocus:()=>{X(!0)},onEmpty:ae,onFilled:G,registerEffect:ee,required:E,variant:A}),[O,s,c,f,j,oe,m,b,ee,ae,G,E,T,A]);return J.jsx(iO.Provider,{value:se,children:J.jsx(age,{as:o,ownerState:F,className:An(N.root,a),ref:r,...R,children:i})})});function oge(t){return gi("MuiFormControlLabel",t)}const D1=pi("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),sge=t=>{const{classes:e,disabled:r,labelPlacement:n,error:i,required:a}=t,s={root:["root",r&&"disabled",`labelPlacement${un(n)}`,i&&"error",a&&"required"],label:["label",r&&"disabled"],asterisk:["asterisk",i&&"error"]};return mi(s,oge,e)},lge=Dr("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${D1.label}`]:e.label},e.root,e[`labelPlacement${un(r.labelPlacement)}`]]}})(ci(({theme:t})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${D1.disabled}`]:{cursor:"default"},[`& .${D1.label}`]:{[`&.${D1.disabled}`]:{color:(t.vars||t).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:e})=>e==="start"||e==="top"||e==="bottom",style:{marginLeft:16}}]}))),uge=Dr("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(ci(({theme:t})=>({[`&.${D1.error}`]:{color:(t.vars||t).palette.error.main}}))),$M=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormControlLabel"}),{checked:i,className:a,componentsProps:s={},control:o,disabled:c,disableTypography:f,inputRef:d,label:m,labelPlacement:b="end",name:x,onChange:E,required:T,slots:A={},slotProps:R={},value:F,...N}=n,O=Ad(),U=c??o.props.disabled??O?.disabled,j=T??o.props.required,H={disabled:U,required:j};["checked","name","onChange","value","inputRef"].forEach(fe=>{typeof o.props[fe]>"u"&&typeof n[fe]<"u"&&(H[fe]=n[fe])});const W=Bg({props:n,muiFormControl:O,states:["error"]}),X={...n,disabled:U,labelPlacement:b,required:j,error:W.error},oe=sge(X),ee={slots:A,slotProps:{...s,...R}},[G,ae]=Ei("typography",{elementType:Es,externalForwardedProps:ee,ownerState:X});let se=m;return se!=null&&se.type!==Es&&!f&&(se=J.jsx(G,{component:"span",...ae,className:An(oe.label,ae?.className),children:se})),J.jsxs(lge,{className:An(oe.root,a),ownerState:X,ref:r,...N,children:[te.cloneElement(o,H),j?J.jsxs("div",{children:[se,J.jsxs(uge,{ownerState:X,"aria-hidden":!0,className:oe.asterisk,children:["","*"]})]}):se]})});function cge(t){return gi("MuiFormGroup",t)}pi("MuiFormGroup",["root","row","error"]);const fge=t=>{const{classes:e,row:r,error:n}=t;return mi({root:["root",r&&"row",n&&"error"]},cge,e)},hge=Dr("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.row&&e.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),uY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormGroup"}),{className:i,row:a=!1,...s}=n,o=Ad(),c=Bg({props:n,muiFormControl:o,states:["error"]}),f={...n,row:a,error:c.error},d=fge(f);return J.jsx(hge,{className:An(d.root,i),ownerState:f,ref:r,...s})});function dge(t){return gi("MuiFormHelperText",t)}const q8=pi("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var H8;const pge=t=>{const{classes:e,contained:r,size:n,disabled:i,error:a,filled:s,focused:o,required:c}=t,f={root:["root",i&&"disabled",a&&"error",n&&`size${un(n)}`,r&&"contained",o&&"focused",s&&"filled",c&&"required"]};return mi(f,dge,e)},gge=Dr("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size&&e[`size${un(r.size)}`],r.contained&&e.contained,r.filled&&e.filled]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${q8.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${q8.error}`]:{color:(t.vars||t).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:e})=>e.contained,style:{marginLeft:14,marginRight:14}}]}))),mge=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormHelperText"}),{children:i,className:a,component:s="p",disabled:o,error:c,filled:f,focused:d,margin:m,required:b,variant:x,...E}=n,T=Ad(),A=Bg({props:n,muiFormControl:T,states:["variant","size","disabled","error","filled","focused","required"]}),R={...n,component:s,contained:A.variant==="filled"||A.variant==="outlined",variant:A.variant,size:A.size,disabled:A.disabled,error:A.error,filled:A.filled,focused:A.focused,required:A.required};delete R.ownerState;const F=pge(R);return J.jsx(gge,{as:s,className:An(F.root,a),ref:r,...E,ownerState:R,children:i===" "?H8||(H8=J.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):i})});function yge(t){return gi("MuiFormLabel",t)}const sb=pi("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),vge=t=>{const{classes:e,color:r,focused:n,disabled:i,error:a,filled:s,required:o}=t,c={root:["root",`color${un(r)}`,i&&"disabled",a&&"error",s&&"filled",n&&"focused",o&&"required"],asterisk:["asterisk",a&&"error"]};return mi(c,yge,e)},_ge=Dr("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color==="secondary"&&e.colorSecondary,r.filled&&e.filled]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{[`&.${sb.focused}`]:{color:(t.vars||t).palette[e].main}}})),{props:{},style:{[`&.${sb.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${sb.error}`]:{color:(t.vars||t).palette.error.main}}}]}))),bge=Dr("span",{name:"MuiFormLabel",slot:"Asterisk"})(ci(({theme:t})=>({[`&.${sb.error}`]:{color:(t.vars||t).palette.error.main}}))),cY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiFormLabel"}),{children:i,className:a,color:s,component:o="label",disabled:c,error:f,filled:d,focused:m,required:b,...x}=n,E=Ad(),T=Bg({props:n,muiFormControl:E,states:["color","required","focused","disabled","error","filled"]}),A={...n,color:T.color||"primary",component:o,disabled:T.disabled,error:T.error,filled:T.filled,focused:T.focused,required:T.required},R=vge(A);return J.jsxs(_ge,{as:o,ownerState:A,className:An(R.root,a),ref:r,...x,children:[i,T.required&&J.jsxs(bge,{ownerState:A,"aria-hidden":!0,className:R.asterisk,children:["","*"]})]})}),up=Uue({createStyledComponent:Dr("div",{name:"MuiGrid",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.container&&e.container]}}),componentName:"MuiGrid",useThemeProps:t=>bi({props:t,name:"MuiGrid"}),useTheme:Nc});function qM(t){return`scale(${t}, ${t**2})`}const xge={entering:{opacity:1,transform:qM(1)},entered:{opacity:1,transform:"none"}},bA=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Nb=te.forwardRef(function(e,r){const{addEndListener:n,appear:i=!0,children:a,easing:s,in:o,onEnter:c,onEntered:f,onEntering:d,onExit:m,onExited:b,onExiting:x,style:E,timeout:T="auto",TransitionComponent:A=Jf,...R}=e,F=ug(),N=te.useRef(),O=Nc(),U=te.useRef(null),j=Uo(U,Fg(a),r),H=fe=>pe=>{if(fe){const De=U.current;pe===void 0?fe(De):fe(De,pe)}},W=H(d),X=H((fe,pe)=>{ZD(fe);const{duration:De,delay:ye,easing:we}=vp({style:E,timeout:T,easing:s},{mode:"enter"});let Te;T==="auto"?(Te=O.transitions.getAutoHeightDuration(fe.clientHeight),N.current=Te):Te=De,fe.style.transition=[O.transitions.create("opacity",{duration:Te,delay:ye}),O.transitions.create("transform",{duration:bA?Te:Te*.666,delay:ye,easing:we})].join(","),c&&c(fe,pe)}),oe=H(f),ee=H(x),G=H(fe=>{const{duration:pe,delay:De,easing:ye}=vp({style:E,timeout:T,easing:s},{mode:"exit"});let we;T==="auto"?(we=O.transitions.getAutoHeightDuration(fe.clientHeight),N.current=we):we=pe,fe.style.transition=[O.transitions.create("opacity",{duration:we,delay:De}),O.transitions.create("transform",{duration:bA?we:we*.666,delay:bA?De:De||we*.333,easing:ye})].join(","),fe.style.opacity=0,fe.style.transform=qM(.75),m&&m(fe)}),ae=H(b),se=fe=>{T==="auto"&&F.start(N.current||0,fe),n&&n(U.current,fe)};return J.jsx(A,{appear:i,in:o,nodeRef:U,onEnter:X,onEntered:oe,onEntering:W,onExit:G,onExited:ae,onExiting:ee,addEndListener:se,timeout:T==="auto"?null:T,...R,children:(fe,{ownerState:pe,...De})=>te.cloneElement(a,{style:{opacity:0,transform:qM(.75),visibility:fe==="exited"&&!o?"hidden":void 0,...xge[fe],...E,...a.props.style},ref:j,...De})})});Nb&&(Nb.muiSupportAuto=!0);const wge=t=>{const{classes:e,disableUnderline:r}=t,i=mi({root:["root",!r&&"underline"],input:["input"]},pde,e);return{...e,...i}},Sge=Dr(YT,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...WT(t,e),!r.disableUnderline&&e.underline]}})(ci(({theme:t})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline)),{position:"relative",variants:[{props:({ownerState:n})=>n.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:n})=>!n.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${e1.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${e1.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${e1.disabled}, .${e1.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${e1.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(jl()).map(([n])=>({props:{color:n,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[n].main}`}}}))]}})),Ege=Dr(ZT,{name:"MuiInput",slot:"Input",overridesResolver:XT})({}),fO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiInput"}),{disableUnderline:i=!1,components:a={},componentsProps:s,fullWidth:o=!1,inputComponent:c="input",multiline:f=!1,slotProps:d,slots:m={},type:b="text",...x}=n,E=wge(n),A={root:{ownerState:{disableUnderline:i}}},R=d??s?ec(d??s,A):A,F=m.root??a.Root??Sge,N=m.input??a.Input??Ege;return J.jsx(aO,{slots:{root:F,input:N},slotProps:R,fullWidth:o,inputComponent:c,multiline:f,ref:r,type:b,...x,classes:E})});fO.muiName="Input";function Tge(t){return gi("MuiInputLabel",t)}pi("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Cge=t=>{const{classes:e,formControl:r,size:n,shrink:i,disableAnimation:a,variant:s,required:o}=t,c={root:["root",r&&"formControl",!a&&"animated",i&&"shrink",n&&n!=="medium"&&`size${un(n)}`,s],asterisk:[o&&"asterisk"]},f=mi(c,Tge,e);return{...e,...f}},Age=Dr(cY,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${sb.asterisk}`]:e.asterisk},e.root,r.formControl&&e.formControl,r.size==="small"&&e.sizeSmall,r.shrink&&e.shrink,!r.disableAnimation&&e.animated,r.focused&&e.focused,e[r.variant]]}})(ci(({theme:t})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:e})=>e.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:e})=>e.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:e})=>!e.disableAnimation,style:{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="filled"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:e,ownerState:r,size:n})=>e==="filled"&&r.shrink&&n==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="outlined"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),vg=te.forwardRef(function(e,r){const n=bi({name:"MuiInputLabel",props:e}),{disableAnimation:i=!1,margin:a,shrink:s,variant:o,className:c,...f}=n,d=Ad();let m=s;typeof m>"u"&&d&&(m=d.filled||d.focused||d.adornedStart);const b=Bg({props:n,muiFormControl:d,states:["size","variant","required","focused"]}),x={...n,disableAnimation:i,formControl:d,shrink:m,size:b.size,variant:b.variant,required:b.required,focused:b.focused},E=Cge(x);return J.jsx(Age,{"data-shrink":m,ref:r,className:An(E.root,c),...f,ownerState:x,classes:E})}),Nf=te.createContext({});function Ige(t){return gi("MuiList",t)}pi("MuiList",["root","padding","dense","subheader"]);const Pge=t=>{const{classes:e,disablePadding:r,dense:n,subheader:i}=t;return mi({root:["root",!r&&"padding",n&&"dense",i&&"subheader"]},Ige,e)},Mge=Dr("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disablePadding&&e.padding,r.dense&&e.dense,r.subheader&&e.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:t})=>!t.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:t})=>t.subheader,style:{paddingTop:0}}]}),kh=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiList"}),{children:i,className:a,component:s="ul",dense:o=!1,disablePadding:c=!1,subheader:f,...d}=n,m=te.useMemo(()=>({dense:o}),[o]),b={...n,component:s,dense:o,disablePadding:c},x=Pge(b);return J.jsx(Nf.Provider,{value:m,children:J.jsxs(Mge,{as:s,className:An(x.root,a),ref:r,ownerState:b,...d,children:[f,i]})})});function kge(t){return gi("MuiListItem",t)}pi("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);function Rge(t){return gi("MuiListItemButton",t)}const Dv=pi("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),Dge=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters]},Oge=t=>{const{alignItems:e,classes:r,dense:n,disabled:i,disableGutters:a,divider:s,selected:o}=t,f=mi({root:["root",n&&"dense",!a&&"gutters",s&&"divider",i&&"disabled",e==="flex-start"&&"alignItemsFlexStart",o&&"selected"]},Rge,r);return{...r,...f}},Lge=Dr(h_,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:Dge})(ci(({theme:t})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Dv.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${Dv.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}},[`&.${Dv.selected}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity)}},[`&.${Dv.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${Dv.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},variants:[{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.dense,style:{paddingTop:4,paddingBottom:4}}]}))),fY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemButton"}),{alignItems:i="center",autoFocus:a=!1,component:s="div",children:o,dense:c=!1,disableGutters:f=!1,divider:d=!1,focusVisibleClassName:m,selected:b=!1,className:x,...E}=n,T=te.useContext(Nf),A=te.useMemo(()=>({dense:c||T.dense||!1,alignItems:i,disableGutters:f}),[i,T.dense,c,f]),R=te.useRef(null);Tu(()=>{a&&R.current&&R.current.focus()},[a]);const F={...n,alignItems:i,dense:A.dense,disableGutters:f,divider:d,selected:b},N=Oge(F),O=Uo(R,r);return J.jsx(Nf.Provider,{value:A,children:J.jsx(Lge,{ref:O,href:E.href||E.to,component:(E.href||E.to)&&s==="div"?"button":s,focusVisibleClassName:An(N.focusVisible,m),ownerState:F,className:An(N.root,x),...E,classes:N,children:o})})});function Nge(t){return gi("MuiListItemSecondaryAction",t)}pi("MuiListItemSecondaryAction",["root","disableGutters"]);const Fge=t=>{const{disableGutters:e,classes:r}=t;return mi({root:["root",e&&"disableGutters"]},Nge,r)},Bge=Dr("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.disableGutters&&e.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:t})=>t.disableGutters,style:{right:0}}]}),hY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemSecondaryAction"}),{className:i,...a}=n,s=te.useContext(Nf),o={...n,disableGutters:s.disableGutters},c=Fge(o);return J.jsx(Bge,{className:An(c.root,i),ownerState:o,ref:r,...a})});hY.muiName="ListItemSecondaryAction";const zge=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters,!r.disablePadding&&e.padding,r.hasSecondaryAction&&e.secondaryAction]},jge=t=>{const{alignItems:e,classes:r,dense:n,disableGutters:i,disablePadding:a,divider:s,hasSecondaryAction:o}=t;return mi({root:["root",n&&"dense",!i&&"gutters",!a&&"padding",s&&"divider",e==="flex-start"&&"alignItemsFlexStart",o&&"secondaryAction"],container:["container"]},kge,r)},Uge=Dr("div",{name:"MuiListItem",slot:"Root",overridesResolver:zge})(ci(({theme:t})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>!e.disablePadding&&e.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:e})=>!e.disablePadding&&!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>!e.disablePadding&&!!e.secondaryAction,style:{paddingRight:48}},{props:({ownerState:e})=>!!e.secondaryAction,style:{[`& > .${Dv.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>e.button,style:{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:e})=>e.hasSecondaryAction,style:{paddingRight:48}}]}))),Vge=Dr("li",{name:"MuiListItem",slot:"Container"})({position:"relative"}),qf=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItem"}),{alignItems:i="center",children:a,className:s,component:o,components:c={},componentsProps:f={},ContainerComponent:d="li",ContainerProps:{className:m,...b}={},dense:x=!1,disableGutters:E=!1,disablePadding:T=!1,divider:A=!1,secondaryAction:R,slotProps:F={},slots:N={},...O}=n,U=te.useContext(Nf),j=te.useMemo(()=>({dense:x||U.dense||!1,alignItems:i,disableGutters:E}),[i,U.dense,x,E]),H=te.useRef(null),W=te.Children.toArray(a),X=W.length&&nb(W[W.length-1],["ListItemSecondaryAction"]),oe={...n,alignItems:i,dense:j.dense,disableGutters:E,disablePadding:T,divider:A,hasSecondaryAction:X},ee=jge(oe),G=Uo(H,r),ae=N.root||c.Root||Uge,se=F.root||f.root||{},fe={className:An(ee.root,se.className,s),...O};let pe=o||"li";return X?(pe=!fe.component&&!o?"div":pe,d==="li"&&(pe==="li"?pe="div":fe.component==="li"&&(fe.component="div")),J.jsx(Nf.Provider,{value:j,children:J.jsxs(Vge,{as:d,className:An(ee.container,m),ref:G,ownerState:oe,...b,children:[J.jsx(ae,{...se,...!md(ae)&&{as:pe,ownerState:{...oe,...se.ownerState}},...fe,children:W}),W.pop()]})})):J.jsx(Nf.Provider,{value:j,children:J.jsxs(ae,{...se,as:pe,ref:G,...!md(ae)&&{ownerState:{...oe,...se.ownerState}},...fe,children:[W,R&&J.jsx(hY,{children:R})]})})});function $ge(t){return gi("MuiListItemAvatar",t)}pi("MuiListItemAvatar",["root","alignItemsFlexStart"]);const qge=t=>{const{alignItems:e,classes:r}=t;return mi({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},$ge,r)},Hge=Dr("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})({minWidth:56,flexShrink:0,variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}),dY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemAvatar"}),{className:i,...a}=n,s=te.useContext(Nf),o={...n,alignItems:s.alignItems},c=qge(o);return J.jsx(Hge,{className:An(c.root,i),ownerState:o,ref:r,...a})});function Gge(t){return gi("MuiListItemIcon",t)}const G8=pi("MuiListItemIcon",["root","alignItemsFlexStart"]),Wge=t=>{const{alignItems:e,classes:r}=t;return mi({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},Gge,r)},Xge=Dr("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})(ci(({theme:t})=>({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),Fb=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemIcon"}),{className:i,...a}=n,s=te.useContext(Nf),o={...n,alignItems:s.alignItems},c=Wge(o);return J.jsx(Xge,{className:An(c.root,i),ownerState:o,ref:r,...a})});function Yge(t){return gi("MuiListItemText",t)}const r0=pi("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Zge=t=>{const{classes:e,inset:r,primary:n,secondary:i,dense:a}=t;return mi({root:["root",r&&"inset",a&&"dense",n&&i&&"multiline"],primary:["primary"],secondary:["secondary"]},Yge,e)},Kge=Dr("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${r0.primary}`]:e.primary},{[`& .${r0.secondary}`]:e.secondary},e.root,r.inset&&e.inset,r.primary&&r.secondary&&e.multiline,r.dense&&e.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${w8.root}:where(& .${r0.primary})`]:{display:"block"},[`.${w8.root}:where(& .${r0.secondary})`]:{display:"block"},variants:[{props:({ownerState:t})=>t.primary&&t.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:t})=>t.inset,style:{paddingLeft:56}}]}),Df=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiListItemText"}),{children:i,className:a,disableTypography:s=!1,inset:o=!1,primary:c,primaryTypographyProps:f,secondary:d,secondaryTypographyProps:m,slots:b={},slotProps:x={},...E}=n,{dense:T}=te.useContext(Nf);let A=c??i,R=d;const F={...n,disableTypography:s,inset:o,primary:!!A,secondary:!!R,dense:T},N=Zge(F),O={slots:b,slotProps:{primary:f,secondary:m,...x}},[U,j]=Ei("root",{className:An(N.root,a),elementType:Kge,externalForwardedProps:{...O,...E},ownerState:F,ref:r}),[H,W]=Ei("primary",{className:N.primary,elementType:Es,externalForwardedProps:O,ownerState:F}),[X,oe]=Ei("secondary",{className:N.secondary,elementType:Es,externalForwardedProps:O,ownerState:F});return A!=null&&A.type!==Es&&!s&&(A=J.jsx(H,{variant:T?"body2":"body1",component:W?.variant?void 0:"span",...W,children:A})),R!=null&&R.type!==Es&&!s&&(R=J.jsx(X,{variant:"body2",color:"textSecondary",...oe,children:R})),J.jsxs(U,{...j,children:[A,R]})});function xA(t,e,r){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:r?null:t.firstChild}function W8(t,e,r){return t===e?r?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:r?null:t.lastChild}function pY(t,e){if(e===void 0)return!0;let r=t.innerText;return r===void 0&&(r=t.textContent),r=r.trim().toLowerCase(),r.length===0?!1:e.repeating?r[0]===e.keys[0]:r.startsWith(e.keys.join(""))}function t1(t,e,r,n,i,a){let s=!1,o=i(t,e,e?r:!1);for(;o;){if(o===t.firstChild){if(s)return!1;s=!0}const c=n?!1:o.disabled||o.getAttribute("aria-disabled")==="true";if(!o.hasAttribute("tabindex")||!pY(o,a)||c)o=i(t,o,r);else return o.focus(),!0}return!1}const Jge=te.forwardRef(function(e,r){const{actions:n,autoFocus:i=!1,autoFocusItem:a=!1,children:s,className:o,disabledItemsFocusable:c=!1,disableListWrap:f=!1,onKeyDown:d,variant:m="selectedMenu",...b}=e,x=te.useRef(null),E=te.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Tu(()=>{i&&x.current.focus()},[i]),te.useImperativeHandle(n,()=>({adjustStyleForScrollbar:(N,{direction:O})=>{const U=!x.current.style.width;if(N.clientHeight<x.current.clientHeight&&U){const j=`${aY(_c(N))}px`;x.current.style[O==="rtl"?"paddingLeft":"paddingRight"]=j,x.current.style.width=`calc(100% + ${j})`}return x.current}}),[]);const T=N=>{const O=x.current,U=N.key;if(N.ctrlKey||N.metaKey||N.altKey){d&&d(N);return}const H=fs(O).activeElement;if(U==="ArrowDown")N.preventDefault(),t1(O,H,f,c,xA);else if(U==="ArrowUp")N.preventDefault(),t1(O,H,f,c,W8);else if(U==="Home")N.preventDefault(),t1(O,null,f,c,xA);else if(U==="End")N.preventDefault(),t1(O,null,f,c,W8);else if(U.length===1){const W=E.current,X=U.toLowerCase(),oe=performance.now();W.keys.length>0&&(oe-W.lastTime>500?(W.keys=[],W.repeating=!0,W.previousKeyMatched=!0):W.repeating&&X!==W.keys[0]&&(W.repeating=!1)),W.lastTime=oe,W.keys.push(X);const ee=H&&!W.repeating&&pY(H,W);W.previousKeyMatched&&(ee||t1(O,H,!1,c,xA,W))?N.preventDefault():W.previousKeyMatched=!1}d&&d(N)},A=Uo(x,r);let R=-1;te.Children.forEach(s,(N,O)=>{if(!te.isValidElement(N)){R===O&&(R+=1,R>=s.length&&(R=-1));return}N.props.disabled||(m==="selectedMenu"&&N.props.selected||R===-1)&&(R=O),R===O&&(N.props.disabled||N.props.muiSkipListHighlight||N.type.muiSkipListHighlight)&&(R+=1,R>=s.length&&(R=-1))});const F=te.Children.map(s,(N,O)=>{if(O===R){const U={};return a&&(U.autoFocus=!0),N.props.tabIndex===void 0&&m==="selectedMenu"&&(U.tabIndex=0),te.cloneElement(N,U)}return N});return J.jsx(kh,{role:"menu",ref:A,className:o,onKeyDown:T,tabIndex:i?0:-1,...b,children:F})});function Qge(t){return gi("MuiPopover",t)}pi("MuiPopover",["root","paper"]);function X8(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.height/2:e==="bottom"&&(r=t.height),r}function Y8(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.width/2:e==="right"&&(r=t.width),r}function Z8(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function U2(t){return typeof t=="function"?t():t}const eme=t=>{const{classes:e}=t;return mi({root:["root"],paper:["paper"]},Qge,e)},tme=Dr(oO,{name:"MuiPopover",slot:"Root"})({}),gY=Dr(Uf,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),rme=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiPopover"}),{action:i,anchorEl:a,anchorOrigin:s={vertical:"top",horizontal:"left"},anchorPosition:o,anchorReference:c="anchorEl",children:f,className:d,container:m,elevation:b=8,marginThreshold:x=16,open:E,PaperProps:T={},slots:A={},slotProps:R={},transformOrigin:F={vertical:"top",horizontal:"left"},TransitionComponent:N,transitionDuration:O="auto",TransitionProps:U={},disableScrollLock:j=!1,...H}=n,W=te.useRef(),X={...n,anchorOrigin:s,anchorReference:c,elevation:b,marginThreshold:x,transformOrigin:F,TransitionComponent:N,transitionDuration:O,TransitionProps:U},oe=eme(X),ee=te.useCallback(()=>{if(c==="anchorPosition")return o;const Ke=U2(a),Me=(Ke&&Ke.nodeType===1?Ke:fs(W.current).body).getBoundingClientRect();return{top:Me.top+X8(Me,s.vertical),left:Me.left+Y8(Me,s.horizontal)}},[a,s.horizontal,s.vertical,o,c]),G=te.useCallback(Ke=>({vertical:X8(Ke,F.vertical),horizontal:Y8(Ke,F.horizontal)}),[F.horizontal,F.vertical]),ae=te.useCallback(Ke=>{const it={width:Ke.offsetWidth,height:Ke.offsetHeight},Me=G(it);if(c==="none")return{top:null,left:null,transformOrigin:Z8(Me)};const zt=ee();let st=zt.top-Me.vertical,$e=zt.left-Me.horizontal;const Jt=st+it.height,Ht=$e+it.width,pr=_c(U2(a)),_t=pr.innerHeight-x,vr=pr.innerWidth-x;if(x!==null&&st<x){const br=st-x;st-=br,Me.vertical+=br}else if(x!==null&&Jt>_t){const br=Jt-_t;st-=br,Me.vertical+=br}if(x!==null&&$e<x){const br=$e-x;$e-=br,Me.horizontal+=br}else if(Ht>vr){const br=Ht-vr;$e-=br,Me.horizontal+=br}return{top:`${Math.round(st)}px`,left:`${Math.round($e)}px`,transformOrigin:Z8(Me)}},[a,c,ee,G,x]),[se,fe]=te.useState(E),pe=te.useCallback(()=>{const Ke=W.current;if(!Ke)return;const it=ae(Ke);it.top!==null&&Ke.style.setProperty("top",it.top),it.left!==null&&(Ke.style.left=it.left),Ke.style.transformOrigin=it.transformOrigin,fe(!0)},[ae]);te.useEffect(()=>(j&&window.addEventListener("scroll",pe),()=>window.removeEventListener("scroll",pe)),[a,j,pe]);const De=()=>{pe()},ye=()=>{fe(!1)};te.useEffect(()=>{E&&pe()}),te.useImperativeHandle(i,()=>E?{updatePosition:()=>{pe()}}:null,[E,pe]),te.useEffect(()=>{if(!E)return;const Ke=WD(()=>{pe()}),it=_c(U2(a));return it.addEventListener("resize",Ke),()=>{Ke.clear(),it.removeEventListener("resize",Ke)}},[a,E,pe]);let we=O;const Te={slots:{transition:N,...A},slotProps:{transition:U,paper:T,...R}},[Re,de]=Ei("transition",{elementType:Nb,externalForwardedProps:Te,ownerState:X,getSlotProps:Ke=>({...Ke,onEntering:(it,Me)=>{Ke.onEntering?.(it,Me),De()},onExited:it=>{Ke.onExited?.(it),ye()}}),additionalProps:{appear:!0,in:E}});O==="auto"&&!Re.muiSupportAuto&&(we=void 0);const Ee=m||(a?fs(U2(a)).body:void 0),[xe,{slots:Ne,slotProps:Fe,...Xe}]=Ei("root",{ref:r,elementType:tme,externalForwardedProps:{...Te,...H},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:A.backdrop},slotProps:{backdrop:Db(typeof R.backdrop=="function"?R.backdrop(X):R.backdrop,{invisible:!0})},container:Ee,open:E},ownerState:X,className:An(oe.root,d)}),[Be,ot]=Ei("paper",{ref:W,className:oe.paper,elementType:gY,externalForwardedProps:Te,shouldForwardComponentProp:!0,additionalProps:{elevation:b,style:se?void 0:{opacity:0}},ownerState:X});return J.jsx(xe,{...Xe,...!md(xe)&&{slots:Ne,slotProps:Fe,disableScrollLock:j},children:J.jsx(Re,{...de,timeout:we,children:J.jsx(Be,{...ot,children:f})})})});function nme(t){return gi("MuiMenu",t)}pi("MuiMenu",["root","paper","list"]);const ime={vertical:"top",horizontal:"right"},ame={vertical:"top",horizontal:"left"},ome=t=>{const{classes:e}=t;return mi({root:["root"],paper:["paper"],list:["list"]},nme,e)},sme=Dr(rme,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiMenu",slot:"Root"})({}),lme=Dr(gY,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),ume=Dr(Jge,{name:"MuiMenu",slot:"List"})({outline:0}),mY=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiMenu"}),{autoFocus:i=!0,children:a,className:s,disableAutoFocusItem:o=!1,MenuListProps:c={},onClose:f,open:d,PaperProps:m={},PopoverClasses:b,transitionDuration:x="auto",TransitionProps:{onEntering:E,...T}={},variant:A="selectedMenu",slots:R={},slotProps:F={},...N}=n,O=Ax(),U={...n,autoFocus:i,disableAutoFocusItem:o,MenuListProps:c,onEntering:E,PaperProps:m,transitionDuration:x,TransitionProps:T,variant:A},j=ome(U),H=i&&!o&&d,W=te.useRef(null),X=(we,Te)=>{W.current&&W.current.adjustStyleForScrollbar(we,{direction:O?"rtl":"ltr"}),E&&E(we,Te)},oe=we=>{we.key==="Tab"&&(we.preventDefault(),f&&f(we,"tabKeyDown"))};let ee=-1;te.Children.map(a,(we,Te)=>{te.isValidElement(we)&&(we.props.disabled||(A==="selectedMenu"&&we.props.selected||ee===-1)&&(ee=Te))});const G={slots:R,slotProps:{list:c,transition:T,paper:m,...F}},ae=ad({elementType:R.root,externalSlotProps:F.root,ownerState:U,className:[j.root,s]}),[se,fe]=Ei("paper",{className:j.paper,elementType:lme,externalForwardedProps:G,shouldForwardComponentProp:!0,ownerState:U}),[pe,De]=Ei("list",{className:An(j.list,c.className),elementType:ume,shouldForwardComponentProp:!0,externalForwardedProps:G,getSlotProps:we=>({...we,onKeyDown:Te=>{oe(Te),we.onKeyDown?.(Te)}}),ownerState:U}),ye=typeof G.slotProps.transition=="function"?G.slotProps.transition(U):G.slotProps.transition;return J.jsx(sme,{onClose:f,anchorOrigin:{vertical:"bottom",horizontal:O?"right":"left"},transformOrigin:O?ime:ame,slots:{root:R.root,paper:se,backdrop:R.backdrop,...R.transition&&{transition:R.transition}},slotProps:{root:ae,paper:fe,backdrop:typeof F.backdrop=="function"?F.backdrop(U):F.backdrop,transition:{...ye,onEntering:(...we)=>{X(...we),ye?.onEntering?.(...we)}}},open:d,ref:r,transitionDuration:x,ownerState:U,...N,classes:b,children:J.jsx(pe,{actions:W,autoFocus:i&&(ee===-1||o),autoFocusItem:H,variant:A,...De,children:a})})});function cme(t){return gi("MuiMenuItem",t)}const r1=pi("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),fme=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.divider&&e.divider,!r.disableGutters&&e.gutters]},hme=t=>{const{disabled:e,dense:r,divider:n,disableGutters:i,selected:a,classes:s}=t,c=mi({root:["root",r&&"dense",e&&"disabled",!i&&"gutters",n&&"divider",a&&"selected"]},cme,s);return{...s,...c}},dme=Dr(h_,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:fme})(ci(({theme:t})=>({...t.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${r1.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${r1.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}},[`&.${r1.selected}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity)}},[`&.${r1.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${r1.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${$8.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${$8.inset}`]:{marginLeft:52},[`& .${r0.root}`]:{marginTop:0,marginBottom:0},[`& .${r0.inset}`]:{paddingLeft:36},[`& .${G8.root}`]:{minWidth:36},variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>!e.dense,style:{[t.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:e})=>e.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...t.typography.body2,[`& .${G8.root} svg`]:{fontSize:"1.25rem"}}}]}))),Fm=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiMenuItem"}),{autoFocus:i=!1,component:a="li",dense:s=!1,divider:o=!1,disableGutters:c=!1,focusVisibleClassName:f,role:d="menuitem",tabIndex:m,className:b,...x}=n,E=te.useContext(Nf),T=te.useMemo(()=>({dense:s||E.dense||!1,disableGutters:c}),[E.dense,s,c]),A=te.useRef(null);Tu(()=>{i&&A.current&&A.current.focus()},[i]);const R={...n,dense:T.dense,divider:o,disableGutters:c},F=hme(n),N=Uo(A,r);let O;return n.disabled||(O=m!==void 0?m:-1),J.jsx(Nf.Provider,{value:T,children:J.jsx(dme,{ref:N,role:d,tabIndex:O,component:a,focusVisibleClassName:An(F.focusVisible,f),className:An(F.root,b),...x,ownerState:R,classes:F})})});function pme(t){return gi("MuiNativeSelect",t)}const hO=pi("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),gme=t=>{const{classes:e,variant:r,disabled:n,multiple:i,open:a,error:s}=t,o={select:["select",r,n&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${un(r)}`,a&&"iconOpen",n&&"disabled"]};return mi(o,pme,e)},yY=Dr("select",{name:"MuiNativeSelect"})(({theme:t})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${hO.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},variants:[{props:({ownerState:e})=>e.variant!=="filled"&&e.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}}]})),mme=Dr(yY,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Al,overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.select,e[r.variant],r.error&&e.error,{[`&.${hO.multiple}`]:e.multiple}]}})({}),vY=Dr("svg",{name:"MuiNativeSelect"})(({theme:t})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,[`&.${hO.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:({ownerState:e})=>e.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),yme=Dr(vY,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${un(r.variant)}`],r.open&&e.iconOpen]}})({}),vme=te.forwardRef(function(e,r){const{className:n,disabled:i,error:a,IconComponent:s,inputRef:o,variant:c="standard",...f}=e,d={...e,disabled:i,variant:c,error:a},m=gme(d);return J.jsxs(te.Fragment,{children:[J.jsx(mme,{ownerState:d,className:An(m.select,n),disabled:i,ref:o||r,...f}),e.multiple?null:J.jsx(yme,{as:s,ownerState:d,className:m.icon})]})});function _me(t){const{children:e,defer:r=!1,fallback:n=null}=t,[i,a]=te.useState(!1);return Tu(()=>{r||a(!0)},[r]),te.useEffect(()=>{r&&a(!0)},[r]),i?e:n}var K8;const bme=Dr("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:Al})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),xme=Dr("legend",{name:"MuiNotchedOutlined",shouldForwardProp:Al})(ci(({theme:t})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:e})=>!e.withLabel,style:{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})}},{props:({ownerState:e})=>e.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:e})=>e.withLabel&&e.notched,style:{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}}]})));function wme(t){const{children:e,classes:r,className:n,label:i,notched:a,...s}=t,o=i!=null&&i!=="",c={...t,notched:a,withLabel:o};return J.jsx(bme,{"aria-hidden":!0,className:n,ownerState:c,...s,children:J.jsx(xme,{ownerState:c,children:o?J.jsx("span",{children:i}):K8||(K8=J.jsx("span",{className:"notranslate","aria-hidden":!0,children:""}))})})}const Sme=t=>{const{classes:e}=t,n=mi({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},gde,e);return{...e,...n}},Eme=Dr(YT,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:WT})(ci(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${ed.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${ed.notchedOutline}`]:{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}},[`&.${ed.focused} .${ed.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(t.palette).filter(jl()).map(([r])=>({props:{color:r},style:{[`&.${ed.focused} .${ed.notchedOutline}`]:{borderColor:(t.vars||t).palette[r].main}}})),{props:{},style:{[`&.${ed.error} .${ed.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${ed.disabled} .${ed.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:14}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:14}},{props:({ownerState:r})=>r.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:r,size:n})=>r.multiline&&n==="small",style:{padding:"8.5px 14px"}}]}})),Tme=Dr(wme,{name:"MuiOutlinedInput",slot:"NotchedOutline"})(ci(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}})),Cme=Dr(ZT,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:XT})(ci(({theme:t})=>({padding:"16.5px 14px",...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:e})=>e.multiline,style:{padding:0}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}}]}))),KT=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiOutlinedInput"}),{components:i={},fullWidth:a=!1,inputComponent:s="input",label:o,multiline:c=!1,notched:f,slots:d={},slotProps:m={},type:b="text",...x}=n,E=Sme(n),T=Ad(),A=Bg({props:n,muiFormControl:T,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),R={...n,color:A.color||"primary",disabled:A.disabled,error:A.error,focused:A.focused,formControl:T,fullWidth:a,hiddenLabel:A.hiddenLabel,multiline:c,size:A.size,type:b},F=d.root??i.Root??Eme,N=d.input??i.Input??Cme,[O,U]=Ei("notchedOutline",{elementType:Tme,className:E.notchedOutline,shouldForwardComponentProp:!0,ownerState:R,externalForwardedProps:{slots:d,slotProps:m},additionalProps:{label:o!=null&&o!==""&&A.required?J.jsxs(te.Fragment,{children:[o,"","*"]}):o}});return J.jsx(aO,{slots:{root:F,input:N},slotProps:m,renderSuffix:j=>J.jsx(O,{...U,notched:typeof f<"u"?f:!!(j.startAdornment||j.filled||j.focused)}),fullWidth:a,inputComponent:s,multiline:c,ref:r,type:b,...x,classes:{...E,notchedOutline:null}})});KT.muiName="Input";const Ame=Ji(J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),Ime=Ji(J.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),Pme=Dr("span",{name:"MuiRadioButtonIcon",shouldForwardProp:Al})({position:"relative",display:"flex"}),Mme=Dr(Ame,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),kme=Dr(Ime,{name:"MuiRadioButtonIcon"})(ci(({theme:t})=>({left:0,position:"absolute",transform:"scale(0)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.shortest})}}]})));function _Y(t){const{checked:e=!1,classes:r={},fontSize:n}=t,i={...t,checked:e};return J.jsxs(Pme,{className:r.root,ownerState:i,children:[J.jsx(Mme,{fontSize:n,className:r.background,ownerState:i}),J.jsx(kme,{fontSize:n,className:r.dot,ownerState:i})]})}const bY=te.createContext(void 0);function Rme(){return te.useContext(bY)}function Dme(t){return gi("MuiRadio",t)}const J8=pi("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),Ome=t=>{const{classes:e,color:r,size:n}=t,i={root:["root",`color${un(r)}`,n!=="medium"&&`size${un(n)}`]};return{...e,...mi(i,Dme,e)}},Lme=Dr(iY,{shouldForwardProp:t=>Al(t)||t==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size!=="medium"&&e[`size${un(r.size)}`],e[`color${un(r.color)}`]]}})(ci(({theme:t})=>({color:(t.vars||t).palette.text.secondary,[`&.${J8.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,disabled:!1},style:{[`&.${J8.checked}`]:{color:(t.vars||t).palette[e].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function Nme(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}const Fme=J.jsx(_Y,{checked:!0}),Bme=J.jsx(_Y,{}),Q8=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiRadio"}),{checked:i,checkedIcon:a=Fme,color:s="primary",icon:o=Bme,name:c,onChange:f,size:d="medium",className:m,disabled:b,disableRipple:x=!1,slots:E={},slotProps:T={},inputProps:A,...R}=n,F=Ad();let N=b;F&&typeof N>"u"&&(N=F.disabled),N??=!1;const O={...n,disabled:N,disableRipple:x,color:s,size:d},U=Ome(O),j=Rme();let H=i;const W=PM(f,j&&j.onChange);let X=c;j&&(typeof H>"u"&&(H=Nme(j.value,n.value)),typeof X>"u"&&(X=j.name));const oe=T.input??A,[ee,G]=Ei("root",{ref:r,elementType:Lme,className:An(U.root,m),shouldForwardComponentProp:!0,externalForwardedProps:{slots:E,slotProps:T,...R},getSlotProps:ae=>({...ae,onChange:(se,...fe)=>{ae.onChange?.(se,...fe),W(se,...fe)}}),ownerState:O,additionalProps:{type:"radio",icon:te.cloneElement(o,{fontSize:o.props.fontSize??d}),checkedIcon:te.cloneElement(a,{fontSize:a.props.fontSize??d}),disabled:N,name:X,checked:H,slots:E,slotProps:{input:typeof oe=="function"?oe(O):oe}}});return J.jsx(ee,{...G,classes:U})});function zme(t){return gi("MuiRadioGroup",t)}pi("MuiRadioGroup",["root","row","error"]);const jme=t=>{const{classes:e,row:r,error:n}=t;return mi({root:["root",r&&"row",n&&"error"]},zme,e)},Ume=te.forwardRef(function(e,r){const{actions:n,children:i,className:a,defaultValue:s,name:o,onChange:c,value:f,...d}=e,m=te.useRef(null),b=jme(e),[x,E]=Wm({controlled:f,default:s,name:"RadioGroup"});te.useImperativeHandle(n,()=>({focus:()=>{let F=m.current.querySelector("input:not(:disabled):checked");F||(F=m.current.querySelector("input:not(:disabled)")),F&&F.focus()}}),[]);const T=Uo(r,m),A=Og(o),R=te.useMemo(()=>({name:A,onChange(F){E(F.target.value),c&&c(F,F.target.value)},value:x}),[A,c,E,x]);return J.jsx(bY.Provider,{value:R,children:J.jsx(uY,{role:"radiogroup",ref:T,className:An(b.root,a),...d,children:i})})}),Vme={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function xY(t){return gi("MuiSelect",t)}const n1=pi("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var ez;const $me=Dr(yY,{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`&.${n1.select}`]:e.select},{[`&.${n1.select}`]:e[r.variant]},{[`&.${n1.error}`]:e.error},{[`&.${n1.multiple}`]:e.multiple}]}})({[`&.${n1.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),qme=Dr(vY,{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${un(r.variant)}`],r.open&&e.iconOpen]}})({}),Hme=Dr("input",{shouldForwardProp:t=>VT(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function tz(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function Gme(t){return t==null||typeof t=="string"&&!t.trim()}const Wme=t=>{const{classes:e,variant:r,disabled:n,multiple:i,open:a,error:s}=t,o={select:["select",r,n&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${un(r)}`,a&&"iconOpen",n&&"disabled"],nativeInput:["nativeInput"]};return mi(o,xY,e)},Xme=te.forwardRef(function(e,r){const{"aria-describedby":n,"aria-label":i,autoFocus:a,autoWidth:s,children:o,className:c,defaultOpen:f,defaultValue:d,disabled:m,displayEmpty:b,error:x=!1,IconComponent:E,inputRef:T,labelId:A,MenuProps:R={},multiple:F,name:N,onBlur:O,onChange:U,onClose:j,onFocus:H,onOpen:W,open:X,readOnly:oe,renderValue:ee,required:G,SelectDisplayProps:ae={},tabIndex:se,type:fe,value:pe,variant:De="standard",...ye}=e,[we,Te]=Wm({controlled:pe,default:d,name:"Select"}),[Re,de]=Wm({controlled:X,default:f,name:"Select"}),Ee=te.useRef(null),xe=te.useRef(null),[Ne,Fe]=te.useState(null),{current:Xe}=te.useRef(X!=null),[Be,ot]=te.useState(),Ke=Uo(r,T),it=te.useCallback(ct=>{xe.current=ct,ct&&Fe(ct)},[]),Me=Ne?.parentNode;te.useImperativeHandle(Ke,()=>({focus:()=>{xe.current.focus()},node:Ee.current,value:we}),[we]),te.useEffect(()=>{f&&Re&&Ne&&!Xe&&(ot(s?null:Me.clientWidth),xe.current.focus())},[Ne,s]),te.useEffect(()=>{a&&xe.current.focus()},[a]),te.useEffect(()=>{if(!A)return;const ct=fs(xe.current).getElementById(A);if(ct){const Kt=()=>{getSelection().isCollapsed&&xe.current.focus()};return ct.addEventListener("click",Kt),()=>{ct.removeEventListener("click",Kt)}}},[A]);const zt=(ct,Kt)=>{ct?W&&W(Kt):j&&j(Kt),Xe||(ot(s?null:Me.clientWidth),de(ct))},st=ct=>{ct.button===0&&(ct.preventDefault(),xe.current.focus(),zt(!0,ct))},$e=ct=>{zt(!1,ct)},Jt=te.Children.toArray(o),Ht=ct=>{const Kt=Jt.find(qt=>qt.props.value===ct.target.value);Kt!==void 0&&(Te(Kt.props.value),U&&U(ct,Kt))},pr=ct=>Kt=>{let qt;if(Kt.currentTarget.hasAttribute("tabindex")){if(F){qt=Array.isArray(we)?we.slice():[];const Ir=we.indexOf(ct.props.value);Ir===-1?qt.push(ct.props.value):qt.splice(Ir,1)}else qt=ct.props.value;if(ct.props.onClick&&ct.props.onClick(Kt),we!==qt&&(Te(qt),U)){const Ir=Kt.nativeEvent||Kt,Ar=new Ir.constructor(Ir.type,Ir);Object.defineProperty(Ar,"target",{writable:!0,value:{value:qt,name:N}}),U(Ar,ct)}F||zt(!1,Kt)}},_t=ct=>{oe||[" ","ArrowUp","ArrowDown","Enter"].includes(ct.key)&&(ct.preventDefault(),zt(!0,ct))},vr=Ne!==null&&Re,br=ct=>{!vr&&O&&(Object.defineProperty(ct,"target",{writable:!0,value:{value:we,name:N}}),O(ct))};delete ye["aria-invalid"];let lr,Cr;const Tr=[];let Qt=!1;(qS({value:we})||b)&&(ee?lr=ee(we):Qt=!0);const at=Jt.map(ct=>{if(!te.isValidElement(ct))return null;let Kt;if(F){if(!Array.isArray(we))throw new Error(mp(2));Kt=we.some(qt=>tz(qt,ct.props.value)),Kt&&Qt&&Tr.push(ct.props.children)}else Kt=tz(we,ct.props.value),Kt&&Qt&&(Cr=ct.props.children);return te.cloneElement(ct,{"aria-selected":Kt?"true":"false",onClick:pr(ct),onKeyUp:qt=>{qt.key===" "&&qt.preventDefault(),ct.props.onKeyUp&&ct.props.onKeyUp(qt)},role:"option",selected:Kt,value:void 0,"data-value":ct.props.value})});Qt&&(F?Tr.length===0?lr=null:lr=Tr.reduce((ct,Kt,qt)=>(ct.push(Kt),qt<Tr.length-1&&ct.push(", "),ct),[]):lr=Cr);let Pe=Be;!s&&Xe&&Ne&&(Pe=Me.clientWidth);let be;typeof se<"u"?be=se:be=m?null:0;const je=ae.id||(N?`mui-component-select-${N}`:void 0),qe={...e,variant:De,value:we,open:vr,error:x},Ge=Wme(qe),Nt={...R.PaperProps,...typeof R.slotProps?.paper=="function"?R.slotProps.paper(qe):R.slotProps?.paper},Et={...R.MenuListProps,...typeof R.slotProps?.list=="function"?R.slotProps.list(qe):R.slotProps?.list},mt=Og();return J.jsxs(te.Fragment,{children:[J.jsx($me,{as:"div",ref:it,tabIndex:be,role:"combobox","aria-controls":vr?mt:void 0,"aria-disabled":m?"true":void 0,"aria-expanded":vr?"true":"false","aria-haspopup":"listbox","aria-label":i,"aria-labelledby":[A,je].filter(Boolean).join(" ")||void 0,"aria-describedby":n,"aria-required":G?"true":void 0,"aria-invalid":x?"true":void 0,onKeyDown:_t,onMouseDown:m||oe?null:st,onBlur:br,onFocus:H,...ae,ownerState:qe,className:An(ae.className,Ge.select,c),id:je,children:Gme(lr)?ez||(ez=J.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):lr}),J.jsx(Hme,{"aria-invalid":x,value:Array.isArray(we)?we.join(","):we,name:N,ref:Ee,"aria-hidden":!0,onChange:Ht,tabIndex:-1,disabled:m,className:Ge.nativeInput,autoFocus:a,required:G,...ye,ownerState:qe}),J.jsx(qme,{as:E,className:Ge.icon,ownerState:qe}),J.jsx(mY,{id:`menu-${N||""}`,anchorEl:Me,open:vr,onClose:$e,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...R,slotProps:{...R.slotProps,list:{"aria-labelledby":A,role:"listbox","aria-multiselectable":F?"true":void 0,disableListWrap:!0,id:mt,...Et},paper:{...Nt,style:{minWidth:Pe,...Nt!=null?Nt.style:null}}},children:at})]})}),Yme=t=>{const{classes:e}=t,n=mi({root:["root"]},xY,e);return{...e,...n}},dO={name:"MuiSelect",slot:"Root",shouldForwardProp:t=>Al(t)&&t!=="variant"},Zme=Dr(fO,dO)(""),Kme=Dr(KT,dO)(""),Jme=Dr(cO,dO)(""),_g=te.forwardRef(function(e,r){const n=bi({name:"MuiSelect",props:e}),{autoWidth:i=!1,children:a,classes:s={},className:o,defaultOpen:c=!1,displayEmpty:f=!1,IconComponent:d=yde,id:m,input:b,inputProps:x,label:E,labelId:T,MenuProps:A,multiple:R=!1,native:F=!1,onClose:N,onOpen:O,open:U,renderValue:j,SelectDisplayProps:H,variant:W="outlined",...X}=n,oe=F?vme:Xme,ee=Ad(),G=Bg({props:n,muiFormControl:ee,states:["variant","error"]}),ae=G.variant||W,se={...n,variant:ae,classes:s},fe=Yme(se),{root:pe,...De}=fe,ye=b||{standard:J.jsx(Zme,{ownerState:se}),outlined:J.jsx(Kme,{label:E,ownerState:se}),filled:J.jsx(Jme,{ownerState:se})}[ae],we=Uo(r,Fg(ye));return J.jsx(te.Fragment,{children:te.cloneElement(ye,{inputComponent:oe,inputProps:{children:a,error:G.error,IconComponent:d,variant:ae,type:void 0,multiple:R,...F?{id:m}:{autoWidth:i,defaultOpen:c,displayEmpty:f,labelId:T,MenuProps:A,onClose:N,onOpen:O,open:U,renderValue:j,SelectDisplayProps:{id:m,...H}},...x,classes:x?ec(De,x.classes):De,...b?b.props.inputProps:{}},...(R&&F||f)&&ae==="outlined"?{notched:!0}:{},ref:we,className:An(ye.props.className,o,fe.root),...!b&&{variant:ae},...X})})});_g.muiName="Select";function Qme(t,e,r=(n,i)=>n===i){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}const eye=2;function fv(t,e,r,n,i){return r===1?Math.min(t+e,i):Math.max(t-e,n)}function wY(t,e){return t-e}function rz(t,e){const{index:r}=t.reduce((n,i,a)=>{const s=Math.abs(e-i);return n===null||s<n.distance||s===n.distance?{distance:s,index:a}:n},null)??{};return r}function V2(t,e){if(e.current!==void 0&&t.changedTouches){const r=t;for(let n=0;n<r.changedTouches.length;n+=1){const i=r.changedTouches[n];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function HS(t,e,r){return(t-e)*100/(r-e)}function tye(t,e,r){return(r-e)*t+e}function rye(t){if(Math.abs(t)<1){const r=t.toExponential().split("e-"),n=r[0].split(".")[1];return(n?n.length:0)+parseInt(r[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function nye(t,e,r){const n=Math.round((t-r)/e)*e+r;return Number(n.toFixed(rye(e)))}function nz({values:t,newValue:e,index:r}){const n=t.slice();return n[r]=e,n.sort(wY)}function $2({sliderRef:t,activeIndex:e,setActive:r}){const n=fs(t.current);(!t.current?.contains(n.activeElement)||Number(n?.activeElement?.getAttribute("data-index"))!==e)&&t.current?.querySelector(`[type="range"][data-index="${e}"]`).focus(),r&&r(e)}function q2(t,e){return typeof t=="number"&&typeof e=="number"?t===e:typeof t=="object"&&typeof e=="object"?Qme(t,e):!1}const iye={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},aye=t=>t;let H2;function iz(){return H2===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?H2=CSS.supports("touch-action","none"):H2=!0),H2}function oye(t){const{"aria-labelledby":e,defaultValue:r,disabled:n=!1,disableSwap:i=!1,isRtl:a=!1,marks:s=!1,max:o=100,min:c=0,name:f,onChange:d,onChangeCommitted:m,orientation:b="horizontal",rootRef:x,scale:E=aye,step:T=1,shiftStep:A=10,tabIndex:R,value:F}=t,N=te.useRef(void 0),[O,U]=te.useState(-1),[j,H]=te.useState(-1),[W,X]=te.useState(!1),oe=te.useRef(0),ee=te.useRef(null),[G,ae]=Wm({controlled:F,default:r??c,name:"Slider"}),se=d&&((Qt,at,Pe)=>{const be=Qt.nativeEvent||Qt,je=new be.constructor(be.type,be);Object.defineProperty(je,"target",{writable:!0,value:{value:at,name:f}}),ee.current=at,d(je,at,Pe)}),fe=Array.isArray(G);let pe=fe?G.slice().sort(wY):[G];pe=pe.map(Qt=>Qt==null?c:kv(Qt,c,o));const De=s===!0&&T!==null?[...Array(Math.floor((o-c)/T)+1)].map((Qt,at)=>({value:c+T*at})):s||[],ye=De.map(Qt=>Qt.value),[we,Te]=te.useState(-1),Re=te.useRef(null),de=Uo(x,Re),Ee=Qt=>at=>{const Pe=Number(at.currentTarget.getAttribute("data-index"));D0(at.target)&&Te(Pe),H(Pe),Qt?.onFocus?.(at)},xe=Qt=>at=>{D0(at.target)||Te(-1),H(-1),Qt?.onBlur?.(at)},Ne=(Qt,at)=>{const Pe=Number(Qt.currentTarget.getAttribute("data-index")),be=pe[Pe],je=ye.indexOf(be);let qe=at;if(De&&T==null){const Ge=ye[ye.length-1];qe>=Ge?qe=Ge:qe<=ye[0]?qe=ye[0]:qe=qe<be?ye[je-1]:ye[je+1]}if(qe=kv(qe,c,o),fe){i&&(qe=kv(qe,pe[Pe-1]||-1/0,pe[Pe+1]||1/0));const Ge=qe;qe=nz({values:pe,newValue:qe,index:Pe});let Nt=Pe;i||(Nt=qe.indexOf(Ge)),$2({sliderRef:Re,activeIndex:Nt})}ae(qe),Te(Pe),se&&!q2(qe,G)&&se(Qt,qe,Pe),m&&m(Qt,ee.current??qe)},Fe=Qt=>at=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(at.key)){at.preventDefault();const Pe=Number(at.currentTarget.getAttribute("data-index")),be=pe[Pe];let je=null;if(T!=null){const qe=at.shiftKey?A:T;switch(at.key){case"ArrowUp":je=fv(be,qe,1,c,o);break;case"ArrowRight":je=fv(be,qe,a?-1:1,c,o);break;case"ArrowDown":je=fv(be,qe,-1,c,o);break;case"ArrowLeft":je=fv(be,qe,a?1:-1,c,o);break;case"PageUp":je=fv(be,A,1,c,o);break;case"PageDown":je=fv(be,A,-1,c,o);break;case"Home":je=c;break;case"End":je=o;break}}else if(De){const qe=ye[ye.length-1],Ge=ye.indexOf(be),Nt=[a?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"],Et=[a?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];Nt.includes(at.key)?Ge===0?je=ye[0]:je=ye[Ge-1]:Et.includes(at.key)&&(Ge===ye.length-1?je=qe:je=ye[Ge+1])}je!=null&&Ne(at,je)}Qt?.onKeyDown?.(at)};Tu(()=>{n&&Re.current.contains(document.activeElement)&&document.activeElement?.blur()},[n]),n&&O!==-1&&U(-1),n&&we!==-1&&Te(-1);const Xe=Qt=>at=>{Qt.onChange?.(at),Ne(at,at.target.valueAsNumber)},Be=te.useRef(void 0);let ot=b;a&&b==="horizontal"&&(ot+="-reverse");const Ke=({finger:Qt,move:at=!1})=>{const{current:Pe}=Re,{width:be,height:je,bottom:qe,left:Ge}=Pe.getBoundingClientRect();let Nt;ot.startsWith("vertical")?Nt=(qe-Qt.y)/je:Nt=(Qt.x-Ge)/be,ot.includes("-reverse")&&(Nt=1-Nt);let Et;if(Et=tye(Nt,c,o),T)Et=nye(Et,T,c);else{const ct=rz(ye,Et);Et=ye[ct]}Et=kv(Et,c,o);let mt=0;if(fe){at?mt=Be.current:mt=rz(pe,Et),i&&(Et=kv(Et,pe[mt-1]||-1/0,pe[mt+1]||1/0));const ct=Et;Et=nz({values:pe,newValue:Et,index:mt}),i&&at||(mt=Et.indexOf(ct),Be.current=mt)}return{newValue:Et,activeIndex:mt}},it=ou(Qt=>{const at=V2(Qt,N);if(!at)return;if(oe.current+=1,Qt.type==="mousemove"&&Qt.buttons===0){Me(Qt);return}const{newValue:Pe,activeIndex:be}=Ke({finger:at,move:!0});$2({sliderRef:Re,activeIndex:be,setActive:U}),ae(Pe),!W&&oe.current>eye&&X(!0),se&&!q2(Pe,G)&&se(Qt,Pe,be)}),Me=ou(Qt=>{const at=V2(Qt,N);if(X(!1),!at)return;const{newValue:Pe}=Ke({finger:at,move:!0});U(-1),Qt.type==="touchend"&&H(-1),m&&m(Qt,ee.current??Pe),N.current=void 0,st()}),zt=ou(Qt=>{if(n)return;iz()||Qt.preventDefault();const at=Qt.changedTouches[0];at!=null&&(N.current=at.identifier);const Pe=V2(Qt,N);if(Pe!==!1){const{newValue:je,activeIndex:qe}=Ke({finger:Pe});$2({sliderRef:Re,activeIndex:qe,setActive:U}),ae(je),se&&!q2(je,G)&&se(Qt,je,qe)}oe.current=0;const be=fs(Re.current);be.addEventListener("touchmove",it,{passive:!0}),be.addEventListener("touchend",Me,{passive:!0})}),st=te.useCallback(()=>{const Qt=fs(Re.current);Qt.removeEventListener("mousemove",it),Qt.removeEventListener("mouseup",Me),Qt.removeEventListener("touchmove",it),Qt.removeEventListener("touchend",Me)},[Me,it]);te.useEffect(()=>{const{current:Qt}=Re;return Qt.addEventListener("touchstart",zt,{passive:iz()}),()=>{Qt.removeEventListener("touchstart",zt),st()}},[st,zt]),te.useEffect(()=>{n&&st()},[n,st]);const $e=Qt=>at=>{if(Qt.onMouseDown?.(at),n||at.defaultPrevented||at.button!==0)return;at.preventDefault();const Pe=V2(at,N);if(Pe!==!1){const{newValue:je,activeIndex:qe}=Ke({finger:Pe});$2({sliderRef:Re,activeIndex:qe,setActive:U}),ae(je),se&&!q2(je,G)&&se(at,je,qe)}oe.current=0;const be=fs(Re.current);be.addEventListener("mousemove",it,{passive:!0}),be.addEventListener("mouseup",Me)},Jt=HS(fe?pe[0]:c,c,o),Ht=HS(pe[pe.length-1],c,o)-Jt,pr=(Qt={})=>{const at=Lm(Qt),Pe={onMouseDown:$e(at||{})},be={...at,...Pe};return{...Qt,ref:de,...be}},_t=Qt=>at=>{Qt.onMouseOver?.(at);const Pe=Number(at.currentTarget.getAttribute("data-index"));H(Pe)},vr=Qt=>at=>{Qt.onMouseLeave?.(at),H(-1)},br=(Qt={})=>{const at=Lm(Qt),Pe={onMouseOver:_t(at||{}),onMouseLeave:vr(at||{})};return{...Qt,...at,...Pe}},lr=Qt=>({pointerEvents:O!==-1&&O!==Qt?"none":void 0});let Cr;return b==="vertical"&&(Cr=a?"vertical-rl":"vertical-lr"),{active:O,axis:ot,axisProps:iye,dragging:W,focusedThumbIndex:we,getHiddenInputProps:(Qt={})=>{const at=Lm(Qt),Pe={onChange:Xe(at||{}),onFocus:Ee(at||{}),onBlur:xe(at||{}),onKeyDown:Fe(at||{})},be={...at,...Pe};return{tabIndex:R,"aria-labelledby":e,"aria-orientation":b,"aria-valuemax":E(o),"aria-valuemin":E(c),name:f,type:"range",min:t.min,max:t.max,step:t.step===null&&t.marks?"any":t.step??void 0,disabled:n,...Qt,...be,style:{...Vme,direction:a?"rtl":"ltr",width:"100%",height:"100%",writingMode:Cr}}},getRootProps:pr,getThumbProps:br,marks:De,open:j,range:fe,rootRef:de,trackLeap:Ht,trackOffset:Jt,values:pe,getThumbStyle:lr}}const sye=t=>!t||!md(t);function lye(t){return gi("MuiSlider",t)}const Of=pi("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),uye=t=>{const{open:e}=t;return{offset:An(e&&Of.valueLabelOpen),circle:Of.valueLabelCircle,label:Of.valueLabelLabel}};function cye(t){const{children:e,className:r,value:n}=t,i=uye(t);return e?te.cloneElement(e,{className:e.props.className},J.jsxs(te.Fragment,{children:[e.props.children,J.jsx("span",{className:An(i.offset,r),"aria-hidden":!0,children:J.jsx("span",{className:i.circle,children:J.jsx("span",{className:i.label,children:n})})})]})):null}function az(t){return t}const fye=Dr("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`color${un(r.color)}`],r.size!=="medium"&&e[`size${un(r.size)}`],r.marked&&e.marked,r.orientation==="vertical"&&e.vertical,r.track==="inverted"&&e.trackInverted,r.track===!1&&e.trackFalse]}})(ci(({theme:t})=>({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${Of.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${Of.dragging}`]:{[`& .${Of.thumb}, & .${Of.track}`]:{transition:"none"}},variants:[...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}))),hye=Dr("span",{name:"MuiSlider",slot:"Rail"})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),dye=Dr("span",{name:"MuiSlider",slot:"Track"})(ci(({theme:t})=>({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e,track:"inverted"},style:{...t.vars?{backgroundColor:t.vars.palette.Slider[`${e}Track`],borderColor:t.vars.palette.Slider[`${e}Track`]}:{backgroundColor:t.lighten(t.palette[e].main,.62),borderColor:t.lighten(t.palette[e].main,.62),...t.applyStyles("dark",{backgroundColor:t.darken(t.palette[e].main,.5)}),...t.applyStyles("dark",{borderColor:t.darken(t.palette[e].main,.5)})}}}))]}))),pye=Dr("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.thumb,e[`thumbColor${un(r.color)}`],r.size!=="medium"&&e[`thumbSize${un(r.size)}`]]}})(ci(({theme:t})=>({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${Of.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(t.palette).filter(jl()).map(([e])=>({props:{color:e},style:{[`&:hover, &.${Of.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${t.alpha((t.vars||t).palette[e].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${Of.active}`]:{boxShadow:`0px 0px 0px 14px ${t.alpha((t.vars||t).palette[e].main,.16)}`}}}))]}))),gye=Dr(cye,{name:"MuiSlider",slot:"ValueLabel"})(ci(({theme:t})=>({zIndex:1,whiteSpace:"nowrap",...t.typography.body2,fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${Of.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${Of.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]}))),mye=Dr("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>VT(t)&&t!=="markActive",overridesResolver:(t,e)=>{const{markActive:r}=t;return[e.mark,r&&e.markActive]}})(ci(({theme:t})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}))),yye=Dr("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>VT(t)&&t!=="markLabelActive"})(ci(({theme:t})=>({...t.typography.body2,color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]}))),vye=t=>{const{disabled:e,dragging:r,marked:n,orientation:i,track:a,classes:s,color:o,size:c}=t,f={root:["root",e&&"disabled",r&&"dragging",n&&"marked",i==="vertical"&&"vertical",a==="inverted"&&"trackInverted",a===!1&&"trackFalse",o&&`color${un(o)}`,c&&`size${un(c)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled",c&&`thumbSize${un(c)}`,o&&`thumbColor${un(o)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return mi(f,lye,s)},_ye=({children:t})=>t,pO=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSlider"}),i=Ax(),{"aria-label":a,"aria-valuetext":s,"aria-labelledby":o,component:c="span",components:f={},componentsProps:d={},color:m="primary",classes:b,className:x,disableSwap:E=!1,disabled:T=!1,getAriaLabel:A,getAriaValueText:R,marks:F=!1,max:N=100,min:O=0,name:U,onChange:j,onChangeCommitted:H,orientation:W="horizontal",shiftStep:X=10,size:oe="medium",step:ee=1,scale:G=az,slotProps:ae,slots:se,tabIndex:fe,track:pe="normal",value:De,valueLabelDisplay:ye="off",valueLabelFormat:we=az,...Te}=n,Re={...n,isRtl:i,max:N,min:O,classes:b,disabled:T,disableSwap:E,orientation:W,marks:F,color:m,size:oe,step:ee,shiftStep:X,scale:G,track:pe,valueLabelDisplay:ye,valueLabelFormat:we},{axisProps:de,getRootProps:Ee,getHiddenInputProps:xe,getThumbProps:Ne,open:Fe,active:Xe,axis:Be,focusedThumbIndex:ot,range:Ke,dragging:it,marks:Me,values:zt,trackOffset:st,trackLeap:$e,getThumbStyle:Jt}=oye({...Re,rootRef:r});Re.marked=Me.length>0&&Me.some(zr=>zr.label),Re.dragging=it,Re.focusedThumbIndex=ot;const Ht=vye(Re),pr=se?.root??f.Root??fye,_t=se?.rail??f.Rail??hye,vr=se?.track??f.Track??dye,br=se?.thumb??f.Thumb??pye,lr=se?.valueLabel??f.ValueLabel??gye,Cr=se?.mark??f.Mark??mye,Tr=se?.markLabel??f.MarkLabel??yye,Qt=se?.input??f.Input??"input",at=ae?.root??d.root,Pe=ae?.rail??d.rail,be=ae?.track??d.track,je=ae?.thumb??d.thumb,qe=ae?.valueLabel??d.valueLabel,Ge=ae?.mark??d.mark,Nt=ae?.markLabel??d.markLabel,Et=ae?.input??d.input,mt=ad({elementType:pr,getSlotProps:Ee,externalSlotProps:at,externalForwardedProps:Te,additionalProps:{...sye(pr)&&{as:c}},ownerState:{...Re,...at?.ownerState},className:[Ht.root,x]}),ct=ad({elementType:_t,externalSlotProps:Pe,ownerState:Re,className:Ht.rail}),Kt=ad({elementType:vr,externalSlotProps:be,additionalProps:{style:{...de[Be].offset(st),...de[Be].leap($e)}},ownerState:{...Re,...be?.ownerState},className:Ht.track}),qt=ad({elementType:br,getSlotProps:Ne,externalSlotProps:je,ownerState:{...Re,...je?.ownerState},className:Ht.thumb}),Ir=ad({elementType:lr,externalSlotProps:qe,ownerState:{...Re,...qe?.ownerState},className:Ht.valueLabel}),Ar=ad({elementType:Cr,externalSlotProps:Ge,ownerState:Re,className:Ht.mark}),$r=ad({elementType:Tr,externalSlotProps:Nt,ownerState:Re,className:Ht.markLabel}),cn=ad({elementType:Qt,getSlotProps:xe,externalSlotProps:Et,ownerState:Re});return J.jsxs(pr,{...mt,children:[J.jsx(_t,{...ct}),J.jsx(vr,{...Kt}),Me.filter(zr=>zr.value>=O&&zr.value<=N).map((zr,Rt)=>{const en=HS(zr.value,O,N),jn=de[Be].offset(en);let Qr;return pe===!1?Qr=zt.includes(zr.value):Qr=pe==="normal"&&(Ke?zr.value>=zt[0]&&zr.value<=zt[zt.length-1]:zr.value<=zt[0])||pe==="inverted"&&(Ke?zr.value<=zt[0]||zr.value>=zt[zt.length-1]:zr.value>=zt[0]),J.jsxs(te.Fragment,{children:[J.jsx(Cr,{"data-index":Rt,...Ar,...!md(Cr)&&{markActive:Qr},style:{...jn,...Ar.style},className:An(Ar.className,Qr&&Ht.markActive)}),zr.label!=null?J.jsx(Tr,{"aria-hidden":!0,"data-index":Rt,...$r,...!md(Tr)&&{markLabelActive:Qr},style:{...jn,...$r.style},className:An(Ht.markLabel,$r.className,Qr&&Ht.markLabelActive),children:zr.label}):null]},Rt)}),zt.map((zr,Rt)=>{const en=HS(zr,O,N),jn=de[Be].offset(en),Qr=ye==="off"?_ye:lr;return J.jsx(Qr,{...!md(Qr)&&{valueLabelFormat:we,valueLabelDisplay:ye,value:typeof we=="function"?we(G(zr),Rt):we,index:Rt,open:Fe===Rt||Xe===Rt||ye==="on",disabled:T},...Ir,children:J.jsx(br,{"data-index":Rt,...qt,className:An(Ht.thumb,qt.className,Xe===Rt&&Ht.active,ot===Rt&&Ht.focusVisible),style:{...jn,...Jt(Rt),...qt.style},children:J.jsx(Qt,{"data-index":Rt,"aria-label":A?A(Rt):a,"aria-valuenow":G(zr),"aria-labelledby":o,"aria-valuetext":R?R(G(zr),Rt):s,value:zt[Rt],...cn})})},Rt)})]})});function bye(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:r=!1,onClose:n,open:i,resumeHideDuration:a}=t,s=ug();te.useEffect(()=>{if(!i)return;function R(F){F.defaultPrevented||F.key==="Escape"&&n?.(F,"escapeKeyDown")}return document.addEventListener("keydown",R),()=>{document.removeEventListener("keydown",R)}},[i,n]);const o=ou((R,F)=>{n?.(R,F)}),c=ou(R=>{!n||R==null||s.start(R,()=>{o(null,"timeout")})});te.useEffect(()=>(i&&c(e),s.clear),[i,e,c,s]);const f=R=>{n?.(R,"clickaway")},d=s.clear,m=te.useCallback(()=>{e!=null&&c(a??e*.5)},[e,a,c]),b=R=>F=>{const N=R.onBlur;N?.(F),m()},x=R=>F=>{const N=R.onFocus;N?.(F),d()},E=R=>F=>{const N=R.onMouseEnter;N?.(F),d()},T=R=>F=>{const N=R.onMouseLeave;N?.(F),m()};return te.useEffect(()=>{if(!r&&i)return window.addEventListener("focus",m),window.addEventListener("blur",d),()=>{window.removeEventListener("focus",m),window.removeEventListener("blur",d)}},[r,i,m,d]),{getRootProps:(R={})=>{const F={...Lm(t),...Lm(R)};return{role:"presentation",...R,...F,onBlur:b(F),onFocus:x(F),onMouseEnter:E(F),onMouseLeave:T(F)}},onClickAway:f}}function xye(t){return gi("MuiSnackbarContent",t)}pi("MuiSnackbarContent",["root","message","action"]);const wye=t=>{const{classes:e}=t;return mi({root:["root"],action:["action"],message:["message"]},xye,e)},Sye=Dr(Uf,{name:"MuiSnackbarContent",slot:"Root"})(ci(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98;return{...t.typography.body2,color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(SM(t.palette.background.default,e)),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:SM(t.palette.background.default,e),display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),Eye=Dr("div",{name:"MuiSnackbarContent",slot:"Message"})({padding:"8px 0"}),Tye=Dr("div",{name:"MuiSnackbarContent",slot:"Action"})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Cye=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSnackbarContent"}),{action:i,className:a,message:s,role:o="alert",...c}=n,f=n,d=wye(f);return J.jsxs(Sye,{role:o,elevation:6,className:An(d.root,a),ownerState:f,ref:r,...c,children:[J.jsx(Eye,{className:d.message,ownerState:f,children:s}),i?J.jsx(Tye,{className:d.action,ownerState:f,children:i}):null]})});function Aye(t){return gi("MuiSnackbar",t)}pi("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const Iye=t=>{const{classes:e,anchorOrigin:r}=t,n={root:["root",`anchorOrigin${un(r.vertical)}${un(r.horizontal)}`]};return mi(n,Aye,e)},Pye=Dr("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`anchorOrigin${un(r.anchorOrigin.vertical)}${un(r.anchorOrigin.horizontal)}`]]}})(ci(({theme:t})=>({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:e})=>e.anchorOrigin.vertical==="top",style:{top:8,[t.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:e})=>e.anchorOrigin.vertical!=="top",style:{bottom:8,[t.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[t.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[t.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="center",style:{[t.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),Mye=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiSnackbar"}),i=Nc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{action:s,anchorOrigin:{vertical:o,horizontal:c}={vertical:"bottom",horizontal:"left"},autoHideDuration:f=null,children:d,className:m,ClickAwayListenerProps:b,ContentProps:x,disableWindowBlurListener:E=!1,message:T,onBlur:A,onClose:R,onFocus:F,onMouseEnter:N,onMouseLeave:O,open:U,resumeHideDuration:j,slots:H={},slotProps:W={},TransitionComponent:X,transitionDuration:oe=a,TransitionProps:{onEnter:ee,onExited:G,...ae}={},...se}=n,fe={...n,anchorOrigin:{vertical:o,horizontal:c},autoHideDuration:f,disableWindowBlurListener:E,TransitionComponent:X,transitionDuration:oe},pe=Iye(fe),{getRootProps:De,onClickAway:ye}=bye({...fe}),[we,Te]=te.useState(!0),Re=zt=>{Te(!0),G&&G(zt)},de=(zt,st)=>{Te(!1),ee&&ee(zt,st)},Ee={slots:{transition:X,...H},slotProps:{content:x,clickAwayListener:b,transition:ae,...W}},[xe,Ne]=Ei("root",{ref:r,className:[pe.root,m],elementType:Pye,getSlotProps:De,externalForwardedProps:{...Ee,...se},ownerState:fe}),[Fe,{ownerState:Xe,...Be}]=Ei("clickAwayListener",{elementType:rpe,externalForwardedProps:Ee,getSlotProps:zt=>({onClickAway:(...st)=>{const $e=st[0];zt.onClickAway?.(...st),!$e?.defaultMuiPrevented&&ye(...st)}}),ownerState:fe}),[ot,Ke]=Ei("content",{elementType:Cye,shouldForwardComponentProp:!0,externalForwardedProps:Ee,additionalProps:{message:T,action:s},ownerState:fe}),[it,Me]=Ei("transition",{elementType:Nb,externalForwardedProps:Ee,getSlotProps:zt=>({onEnter:(...st)=>{zt.onEnter?.(...st),de(...st)},onExited:(...st)=>{zt.onExited?.(...st),Re(...st)}}),additionalProps:{appear:!0,in:U,timeout:oe,direction:o==="top"?"down":"up"},ownerState:fe});return!U&&we?null:J.jsx(Fe,{...Be,...H.clickAwayListener&&{ownerState:Xe},children:J.jsx(xe,{...Ne,children:J.jsx(it,{...Me,children:d||J.jsx(ot,{...Ke})})})})});function kye(t){return gi("MuiTooltip",t)}const zs=pi("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function Rye(t){return Math.round(t*1e5)/1e5}const Dye=t=>{const{classes:e,disableInteractive:r,arrow:n,touch:i,placement:a}=t,s={popper:["popper",!r&&"popperInteractive",n&&"popperArrow"],tooltip:["tooltip",n&&"tooltipArrow",i&&"touch",`tooltipPlacement${un(a.split("-")[0])}`],arrow:["arrow"]};return mi(s,kye,e)},Oye=Dr(JX,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.popper,!r.disableInteractive&&e.popperInteractive,r.arrow&&e.popperArrow,!r.open&&e.popperClose]}})(ci(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${zs.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${zs.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${zs.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${zs.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${zs.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${zs.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${zs.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${zs.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),Lye=Dr("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.tooltip,r.touch&&e.touch,r.arrow&&e.tooltipArrow,e[`tooltipPlacement${un(r.placement.split("-")[0])}`]]}})(ci(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${zs.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${zs.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${zs.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${zs.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${Rye(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${zs.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${zs.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${zs.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${zs.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${zs.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${zs.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${zs.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${zs.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${zs.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${zs.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),Nye=Dr("span",{name:"MuiTooltip",slot:"Arrow"})(ci(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let G2=!1;const oz=new qT;let i1={x:0,y:0};function W2(t,e){return(r,...n)=>{e&&e(r,...n),t(r,...n)}}const cg=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiTooltip"}),{arrow:i=!1,children:a,classes:s,components:o={},componentsProps:c={},describeChild:f=!1,disableFocusListener:d=!1,disableHoverListener:m=!1,disableInteractive:b=!1,disableTouchListener:x=!1,enterDelay:E=100,enterNextDelay:T=0,enterTouchDelay:A=700,followCursor:R=!1,id:F,leaveDelay:N=0,leaveTouchDelay:O=1500,onClose:U,onOpen:j,open:H,placement:W="bottom",PopperComponent:X,PopperProps:oe={},slotProps:ee={},slots:G={},title:ae,TransitionComponent:se,TransitionProps:fe,...pe}=n,De=te.isValidElement(a)?a:J.jsx("span",{children:a}),ye=Nc(),we=Ax(),[Te,Re]=te.useState(),[de,Ee]=te.useState(null),xe=te.useRef(!1),Ne=b||R,Fe=ug(),Xe=ug(),Be=ug(),ot=ug(),[Ke,it]=Wm({controlled:H,default:!1,name:"Tooltip",state:"open"});let Me=Ke;const zt=Og(F),st=te.useRef(),$e=ou(()=>{st.current!==void 0&&(document.body.style.WebkitUserSelect=st.current,st.current=void 0),ot.clear()});te.useEffect(()=>$e,[$e]);const Jt=nr=>{oz.clear(),G2=!0,it(!0),j&&!Me&&j(nr)},Ht=ou(nr=>{oz.start(800+N,()=>{G2=!1}),it(!1),U&&Me&&U(nr),Fe.start(ye.transitions.duration.shortest,()=>{xe.current=!1})}),pr=nr=>{xe.current&&nr.type!=="touchstart"||(Te&&Te.removeAttribute("title"),Xe.clear(),Be.clear(),E||G2&&T?Xe.start(G2?T:E,()=>{Jt(nr)}):Jt(nr))},_t=nr=>{Xe.clear(),Be.start(N,()=>{Ht(nr)})},[,vr]=te.useState(!1),br=nr=>{D0(nr.target)||(vr(!1),_t(nr))},lr=nr=>{Te||Re(nr.currentTarget),D0(nr.target)&&(vr(!0),pr(nr))},Cr=nr=>{xe.current=!0;const oi=De.props;oi.onTouchStart&&oi.onTouchStart(nr)},Tr=nr=>{Cr(nr),Be.clear(),Fe.clear(),$e(),st.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",ot.start(A,()=>{document.body.style.WebkitUserSelect=st.current,pr(nr)})},Qt=nr=>{De.props.onTouchEnd&&De.props.onTouchEnd(nr),$e(),Be.start(O,()=>{Ht(nr)})};te.useEffect(()=>{if(!Me)return;function nr(oi){oi.key==="Escape"&&Ht(oi)}return document.addEventListener("keydown",nr),()=>{document.removeEventListener("keydown",nr)}},[Ht,Me]);const at=Uo(Fg(De),Re,r);!ae&&ae!==0&&(Me=!1);const Pe=te.useRef(),be=nr=>{const oi=De.props;oi.onMouseMove&&oi.onMouseMove(nr),i1={x:nr.clientX,y:nr.clientY},Pe.current&&Pe.current.update()},je={},qe=typeof ae=="string";f?(je.title=!Me&&qe&&!m?ae:null,je["aria-describedby"]=Me?zt:null):(je["aria-label"]=qe?ae:null,je["aria-labelledby"]=Me&&!qe?zt:null);const Ge={...je,...pe,...De.props,className:An(pe.className,De.props.className),onTouchStart:Cr,ref:at,...R?{onMouseMove:be}:{}},Nt={};x||(Ge.onTouchStart=Tr,Ge.onTouchEnd=Qt),m||(Ge.onMouseOver=W2(pr,Ge.onMouseOver),Ge.onMouseLeave=W2(_t,Ge.onMouseLeave),Ne||(Nt.onMouseOver=pr,Nt.onMouseLeave=_t)),d||(Ge.onFocus=W2(lr,Ge.onFocus),Ge.onBlur=W2(br,Ge.onBlur),Ne||(Nt.onFocus=lr,Nt.onBlur=br));const Et={...n,isRtl:we,arrow:i,disableInteractive:Ne,placement:W,PopperComponentProp:X,touch:xe.current},mt=typeof ee.popper=="function"?ee.popper(Et):ee.popper,ct=te.useMemo(()=>{let nr=[{name:"arrow",enabled:!!de,options:{element:de,padding:4}}];return oe.popperOptions?.modifiers&&(nr=nr.concat(oe.popperOptions.modifiers)),mt?.popperOptions?.modifiers&&(nr=nr.concat(mt.popperOptions.modifiers)),{...oe.popperOptions,...mt?.popperOptions,modifiers:nr}},[de,oe.popperOptions,mt?.popperOptions]),Kt=Dye(Et),qt=typeof ee.transition=="function"?ee.transition(Et):ee.transition,Ir={slots:{popper:o.Popper,transition:o.Transition??se,tooltip:o.Tooltip,arrow:o.Arrow,...G},slotProps:{arrow:ee.arrow??c.arrow,popper:{...oe,...mt??c.popper},tooltip:ee.tooltip??c.tooltip,transition:{...fe,...qt??c.transition}}},[Ar,$r]=Ei("popper",{elementType:Oye,externalForwardedProps:Ir,ownerState:Et,className:An(Kt.popper,oe?.className)}),[cn,zr]=Ei("transition",{elementType:Nb,externalForwardedProps:Ir,ownerState:Et}),[Rt,en]=Ei("tooltip",{elementType:Lye,className:Kt.tooltip,externalForwardedProps:Ir,ownerState:Et}),[jn,Qr]=Ei("arrow",{elementType:Nye,className:Kt.arrow,externalForwardedProps:Ir,ownerState:Et,ref:Ee});return J.jsxs(te.Fragment,{children:[te.cloneElement(De,Ge),J.jsx(Ar,{as:X??JX,placement:W,anchorEl:R?{getBoundingClientRect:()=>({top:i1.y,left:i1.x,right:i1.x,bottom:i1.y,width:0,height:0})}:Te,popperRef:Pe,open:Te?Me:!1,id:zt,transition:!0,...Nt,...$r,popperOptions:ct,children:({TransitionProps:nr})=>J.jsx(cn,{timeout:ye.transitions.duration.shorter,...nr,...zr,children:J.jsxs(Rt,{...en,children:[ae,i?J.jsx(jn,{...Qr}):null]})})})]})}),Fye=Dr("div",{name:"MuiSwipeArea",shouldForwardProp:Al})(ci(({theme:t})=>({position:"fixed",top:0,left:0,bottom:0,zIndex:t.zIndex.drawer-1,variants:[{props:{anchor:"left"},style:{right:"auto"}},{props:{anchor:"right"},style:{left:"auto",right:0}},{props:{anchor:"top"},style:{bottom:"auto",right:0}},{props:{anchor:"bottom"},style:{top:"auto",bottom:0,right:0}}]}))),Bye=te.forwardRef(function(e,r){const{anchor:n,classes:i={},className:a,width:s,style:o,...c}=e,f=e;return J.jsx(Fye,{className:An("PrivateSwipeArea-root",i.root,i[`anchor${un(n)}`],a),ref:r,style:{[xm(n)?"width":"height"]:s,...o},ownerState:f,...c})}),X2=3,wA=20;let Zd=null;function SA(t,e,r){return t==="right"?r.body.offsetWidth-e[0].pageX:e[0].pageX}function EA(t,e,r){return t==="bottom"?r.innerHeight-e[0].clientY:e[0].clientY}function a1(t,e){return t?e.clientWidth:e.clientHeight}function sz(t,e,r,n){return Math.min(Math.max(r?e-t:n+e-t,0),n)}function zye(t,e){const r=[];for(;t&&t!==e.parentElement;){const n=_c(e).getComputedStyle(t);n.getPropertyValue("position")==="absolute"||n.getPropertyValue("overflow-x")==="hidden"||(t.clientWidth>0&&t.scrollWidth>t.clientWidth||t.clientHeight>0&&t.scrollHeight>t.clientHeight)&&r.push(t),t=t.parentElement}return r}function jye({domTreeShapes:t,start:e,current:r,anchor:n}){const i={scrollPosition:{x:"scrollLeft",y:"scrollTop"},scrollLength:{x:"scrollWidth",y:"scrollHeight"},clientLength:{x:"clientWidth",y:"clientHeight"}};return t.some(a=>{let s=r>=e;(n==="top"||n==="left")&&(s=!s);const o=n==="left"||n==="right"?"x":"y",c=Math.round(a[i.scrollPosition[o]]),f=c>0,d=c+a[i.clientLength[o]]<a[i.scrollLength[o]];return!!(s&&d||!s&&f)})}const Uye=typeof navigator<"u"&&/iPad|iPhone|iPod/.test(navigator.userAgent),Vye=te.forwardRef(function(e,r){const n=bi({name:"MuiSwipeableDrawer",props:e}),i=Nc(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:s="left",disableBackdropTransition:o=!1,disableDiscovery:c=!1,disableSwipeToOpen:f=Uye,hideBackdrop:d,hysteresis:m=.52,allowSwipeInChildren:b=!1,minFlingVelocity:x=450,ModalProps:{BackdropProps:E,...T}={},onClose:A,onOpen:R,open:F=!1,PaperProps:N={},SwipeAreaProps:O,swipeAreaWidth:U=20,transitionDuration:j=a,variant:H="temporary",slots:W={},slotProps:X={},...oe}=n,[ee,G]=te.useState(!1),ae=te.useRef({isSwiping:null}),se=te.useRef(),fe=te.useRef(),pe=te.useRef(),De=Uo(N.ref,pe),ye=te.useRef(!1),we=te.useRef();Tu(()=>{we.current=null},[F]);const Te=te.useCallback((Xe,Be={})=>{const{mode:ot=null,changeTransition:Ke=!0}=Be,it=R1(i,s),Me=["right","bottom"].includes(it)?1:-1,zt=xm(s),st=zt?`translate(${Me*Xe}px, 0)`:`translate(0, ${Me*Xe}px)`,$e=pe.current.style;$e.webkitTransform=st,$e.transform=st;let Jt="";if(ot&&(Jt=i.transitions.create("all",vp({easing:void 0,style:void 0,timeout:j},{mode:ot}))),Ke&&($e.webkitTransition=Jt,$e.transition=Jt),!o&&!d){const Ht=fe.current.style;Ht.opacity=1-Xe/a1(zt,pe.current),Ke&&(Ht.webkitTransition=Jt,Ht.transition=Jt)}},[s,o,d,i,j]),Re=ou(Xe=>{if(!ye.current)return;if(Zd=null,ye.current=!1,lp.flushSync(()=>{G(!1)}),!ae.current.isSwiping){ae.current.isSwiping=null;return}ae.current.isSwiping=null;const Be=R1(i,s),ot=xm(s);let Ke;ot?Ke=SA(Be,Xe.changedTouches,fs(Xe.currentTarget)):Ke=EA(Be,Xe.changedTouches,_c(Xe.currentTarget));const it=ot?ae.current.startX:ae.current.startY,Me=a1(ot,pe.current),zt=sz(Ke,it,F,Me),st=zt/Me;if(Math.abs(ae.current.velocity)>x&&(we.current=Math.abs((Me-zt)/ae.current.velocity)*1e3),F){ae.current.velocity>x||st>m?A():Te(0,{mode:"exit"});return}ae.current.velocity<-x||1-st>m?R():Te(a1(ot,pe.current),{mode:"enter"})}),de=(Xe=!1)=>{if(!ee){(Xe||!(c&&b))&&lp.flushSync(()=>{G(!0)});const Be=xm(s);!F&&pe.current&&Te(a1(Be,pe.current)+(c?15:-wA),{changeTransition:!1}),ae.current.velocity=0,ae.current.lastTime=null,ae.current.lastTranslate=null,ae.current.paperHit=!1,ye.current=!0}},Ee=ou(Xe=>{if(!pe.current||!ye.current||Zd!==null&&Zd!==ae.current)return;de(!0);const Be=R1(i,s),ot=xm(s),Ke=SA(Be,Xe.touches,fs(Xe.currentTarget)),it=EA(Be,Xe.touches,_c(Xe.currentTarget));if(F&&pe.current.contains(Xe.target)&&Zd===null){const Jt=zye(Xe.target,pe.current);if(jye({domTreeShapes:Jt,start:ot?ae.current.startX:ae.current.startY,current:ot?Ke:it,anchor:s})){Zd=!0;return}Zd=ae.current}if(ae.current.isSwiping==null){const Jt=Math.abs(Ke-ae.current.startX),Ht=Math.abs(it-ae.current.startY),pr=ot?Jt>Ht&&Jt>X2:Ht>Jt&&Ht>X2;if(pr&&Xe.cancelable&&Xe.preventDefault(),pr===!0||(ot?Ht>X2:Jt>X2)){if(ae.current.isSwiping=pr,!pr){Re(Xe);return}ae.current.startX=Ke,ae.current.startY=it,!c&&!F&&(ot?ae.current.startX-=wA:ae.current.startY-=wA)}}if(!ae.current.isSwiping)return;const Me=a1(ot,pe.current);let zt=ot?ae.current.startX:ae.current.startY;F&&!ae.current.paperHit&&(zt=Math.min(zt,Me));const st=sz(ot?Ke:it,zt,F,Me);if(F)if(ae.current.paperHit)st===0&&(ae.current.startX=Ke,ae.current.startY=it);else if(ot?Ke<Me:it<Me)ae.current.paperHit=!0,ae.current.startX=Ke,ae.current.startY=it;else return;ae.current.lastTranslate===null&&(ae.current.lastTranslate=st,ae.current.lastTime=performance.now()+1);const $e=(st-ae.current.lastTranslate)/(performance.now()-ae.current.lastTime)*1e3;ae.current.velocity=ae.current.velocity*.4+$e*.6,ae.current.lastTranslate=st,ae.current.lastTime=performance.now(),Xe.cancelable&&Xe.preventDefault(),Te(st)}),xe=ou(Xe=>{if(Xe.defaultPrevented||Xe.defaultMuiPrevented||F&&(d||!fe.current.contains(Xe.target))&&!pe.current.contains(Xe.target))return;const Be=R1(i,s),ot=xm(s),Ke=SA(Be,Xe.touches,fs(Xe.currentTarget)),it=EA(Be,Xe.touches,_c(Xe.currentTarget));if(!F){if(f||!(Xe.target===se.current||pe.current?.contains(Xe.target)&&(typeof b=="function"?b(Xe,se.current,pe.current):b)))return;if(ot){if(Ke>U)return}else if(it>U)return}Xe.defaultMuiPrevented=!0,Zd=null,ae.current.startX=Ke,ae.current.startY=it,de()});te.useEffect(()=>{if(H==="temporary"){const Xe=fs(pe.current);return Xe.addEventListener("touchstart",xe),Xe.addEventListener("touchmove",Ee,{passive:!F}),Xe.addEventListener("touchend",Re),()=>{Xe.removeEventListener("touchstart",xe),Xe.removeEventListener("touchmove",Ee,{passive:!F}),Xe.removeEventListener("touchend",Re)}}},[H,F,xe,Ee,Re]),te.useEffect(()=>()=>{Zd===ae.current&&(Zd=null)},[]),te.useEffect(()=>{F||G(!1)},[F]);const[Ne,Fe]=Ei("swipeArea",{ref:se,elementType:Bye,ownerState:n,externalForwardedProps:{slots:W,slotProps:{swipeArea:O,...X}},additionalProps:{width:U,anchor:s}});return J.jsxs(te.Fragment,{children:[J.jsx(uO,{open:H==="temporary"&&ee?!0:F,variant:H,ModalProps:{BackdropProps:{...E,ref:fe},...H==="temporary"&&{keepMounted:!0},...T},hideBackdrop:d,anchor:s,transitionDuration:we.current||j,onClose:A,ref:r,slots:W,slotProps:{...X,backdrop:Db(X.backdrop??E,{ref:fe}),paper:Db(X.paper??N,{style:{pointerEvents:H==="temporary"&&!F&&!b?"none":""},ref:De})},...oe}),!f&&H==="temporary"&&J.jsx(_me,{children:J.jsx(Ne,{...Fe})})]})});function $ye(t){return gi("MuiToolbar",t)}pi("MuiToolbar",["root","gutters","regular","dense"]);const qye=t=>{const{classes:e,disableGutters:r,variant:n}=t;return mi({root:["root",!r&&"gutters",n]},$ye,e)},Hye=Dr("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableGutters&&e.gutters,e[r.variant]]}})(ci(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}))),Gye=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiToolbar"}),{className:i,component:a="div",disableGutters:s=!1,variant:o="regular",...c}=n,f={...n,component:a,disableGutters:s,variant:o},d=qye(f);return J.jsx(Hye,{as:a,className:An(d.root,i),ref:r,ownerState:f,...c})});function Wye(t){return gi("MuiTextField",t)}pi("MuiTextField",["root"]);const Xye={standard:fO,filled:cO,outlined:KT},Yye=t=>{const{classes:e}=t;return mi({root:["root"]},Wye,e)},Zye=Dr(af,{name:"MuiTextField",slot:"Root"})({}),JT=te.forwardRef(function(e,r){const n=bi({props:e,name:"MuiTextField"}),{autoComplete:i,autoFocus:a=!1,children:s,className:o,color:c="primary",defaultValue:f,disabled:d=!1,error:m=!1,FormHelperTextProps:b,fullWidth:x=!1,helperText:E,id:T,InputLabelProps:A,inputProps:R,InputProps:F,inputRef:N,label:O,maxRows:U,minRows:j,multiline:H=!1,name:W,onBlur:X,onChange:oe,onFocus:ee,placeholder:G,required:ae=!1,rows:se,select:fe=!1,SelectProps:pe,slots:De={},slotProps:ye={},type:we,value:Te,variant:Re="outlined",...de}=n,Ee={...n,autoFocus:a,color:c,disabled:d,error:m,fullWidth:x,multiline:H,required:ae,select:fe,variant:Re},xe=Yye(Ee),Ne=Og(T),Fe=E&&Ne?`${Ne}-helper-text`:void 0,Xe=O&&Ne?`${Ne}-label`:void 0,Be=Xye[Re],ot={slots:De,slotProps:{input:F,inputLabel:A,htmlInput:R,formHelperText:b,select:pe,...ye}},Ke={},it=ot.slotProps.inputLabel;Re==="outlined"&&(it&&typeof it.shrink<"u"&&(Ke.notched=it.shrink),Ke.label=O),fe&&((!pe||!pe.native)&&(Ke.id=void 0),Ke["aria-describedby"]=void 0);const[Me,zt]=Ei("root",{elementType:Zye,shouldForwardComponentProp:!0,externalForwardedProps:{...ot,...de},ownerState:Ee,className:An(xe.root,o),ref:r,additionalProps:{disabled:d,error:m,fullWidth:x,required:ae,color:c,variant:Re}}),[st,$e]=Ei("input",{elementType:Be,externalForwardedProps:ot,additionalProps:Ke,ownerState:Ee}),[Jt,Ht]=Ei("inputLabel",{elementType:vg,externalForwardedProps:ot,ownerState:Ee}),[pr,_t]=Ei("htmlInput",{elementType:"input",externalForwardedProps:ot,ownerState:Ee}),[vr,br]=Ei("formHelperText",{elementType:mge,externalForwardedProps:ot,ownerState:Ee}),[lr,Cr]=Ei("select",{elementType:_g,externalForwardedProps:ot,ownerState:Ee}),Tr=J.jsx(st,{"aria-describedby":Fe,autoComplete:i,autoFocus:a,defaultValue:f,fullWidth:x,multiline:H,name:W,rows:se,maxRows:U,minRows:j,type:we,value:Te,id:Ne,inputRef:N,onBlur:X,onChange:oe,onFocus:ee,placeholder:G,inputProps:_t,slots:{input:De.htmlInput?pr:void 0},...$e});return J.jsxs(Me,{...zt,children:[O!=null&&O!==""&&J.jsx(Jt,{htmlFor:Ne,id:Xe,...Ht,children:O}),fe?J.jsx(lr,{"aria-describedby":Fe,id:Ne,labelId:Xe,value:Te,input:Tr,...Cr,children:s}):Tr,E&&J.jsx(vr,{id:Fe,...br,children:E})]})}),kx=mX({themeId:Sh}),Kye=Ji(J.jsx("path",{d:"M5 15H3v4c0 1.1.9 2 2 2h4v-2H5zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2m0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2zM12 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),HM=t=>{const e=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(!1),i=()=>{navigator.geolocation.getCurrentPosition(a,s)},a=te.useCallback(o=>{e.map?.map.setCenter?.([o.coords.longitude,o.coords.latitude])},[e.map]),s=()=>{console.log("Access of user location denied"),n(!0)};return J.jsx(J.Fragment,{children:J.jsx(ta,{variant:"navtools",sx:o=>({zIndex:1002,color:r?t.offColor??o.palette.navigation.buttonColor:t.onColor??o.palette.navigation.buttonColor}),onClick:i,disabled:r,children:J.jsx(Kye,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})})};try{HM.displayName="MlCenterPosition",HM.__docgenInfo={description:"Component template",displayName:"MlCenterPosition",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},onColor:{defaultValue:null,description:"Active button font color",name:"onColor",required:!1,type:{name:"string | undefined"}},offColor:{defaultValue:null,description:"Inactive button font color",name:"offColor",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"CSS style object that is applied to the button component",name:"style",required:!1,type:{name:"SxProps<Theme> | undefined"}}}}}catch{}const lz=t=>{const e=ga({mapId:t.mapId});return console.log(e.componentId+" remove this log"),J.jsx(J.Fragment,{})};try{lz.displayName="MlComponentTemplate",lz.__docgenInfo={description:"Component description",displayName:"MlComponentTemplate",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const Jye=Ji(J.jsx("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3m-3 11H8v-5h8zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m-1-9H6v4h12z"}));function po(t){"@babel/helpers - typeof";return po=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},po(t)}var Th=Uint8Array,of=Uint16Array,gO=Int32Array,mO=new Th([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yO=new Th([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uz=new Th([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),SY=function(t,e){for(var r=new of(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new gO(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},EY=SY(mO,2),Qye=EY.b,GM=EY.r;Qye[28]=258,GM[258]=28;var eve=SY(yO,0),cz=eve.r,WM=new of(32768);for(var es=0;es<32768;++es){var Yp=(es&43690)>>1|(es&21845)<<1;Yp=(Yp&52428)>>2|(Yp&13107)<<2,Yp=(Yp&61680)>>4|(Yp&3855)<<4,WM[es]=((Yp&65280)>>8|(Yp&255)<<8)>>1}var lb=(function(t,e,r){for(var n=t.length,i=0,a=new of(e);i<n;++i)t[i]&&++a[t[i]-1];var s=new of(e);for(i=1;i<e;++i)s[i]=s[i-1]+a[i-1]<<1;var o;if(r){o=new of(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var f=i<<4|t[i],d=e-t[i],m=s[t[i]-1]++<<d,b=m|(1<<d)-1;m<=b;++m)o[WM[m]>>c]=f}else for(o=new of(n),i=0;i<n;++i)t[i]&&(o[i]=WM[s[t[i]-1]++]>>15-t[i]);return o}),Ym=new Th(288);for(var es=0;es<144;++es)Ym[es]=8;for(var es=144;es<256;++es)Ym[es]=9;for(var es=256;es<280;++es)Ym[es]=7;for(var es=280;es<288;++es)Ym[es]=8;var GS=new Th(32);for(var es=0;es<32;++es)GS[es]=5;var tve=lb(Ym,9,0),rve=lb(GS,5,0),TY=function(t){return(t+7)/8|0},nve=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Th(t.subarray(e,r))},Kd=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},o1=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},TA=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,a=r.slice();if(!i)return{t:AY,l:0};if(i==1){var s=new Th(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(U,j){return U.f-j.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],f=0,d=1,m=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};d!=i-1;)o=r[r[f].f<r[m].f?f++:m++],c=r[f!=d&&r[f].f<r[m].f?f++:m++],r[d++]={s:-1,f:o.f+c.f,l:o,r:c};for(var b=a[0].s,n=1;n<i;++n)a[n].s>b&&(b=a[n].s);var x=new of(b+1),E=XM(r[d-1],x,0);if(E>e){var n=0,T=0,A=E-e,R=1<<A;for(a.sort(function(j,H){return x[H.s]-x[j.s]||j.f-H.f});n<i;++n){var F=a[n].s;if(x[F]>e)T+=R-(1<<E-x[F]),x[F]=e;else break}for(T>>=A;T>0;){var N=a[n].s;x[N]<e?T-=1<<e-x[N]++-1:++n}for(;n>=0&&T;--n){var O=a[n].s;x[O]==e&&(--x[O],++T)}E=e}return{t:new Th(x),l:E}},XM=function(t,e,r){return t.s==-1?Math.max(XM(t.l,e,r+1),XM(t.r,e,r+1)):e[t.s]=r},fz=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new of(++e),n=0,i=t[0],a=1,s=function(c){r[n++]=c},o=1;o<=e;++o)if(t[o]==i&&o!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(i),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(i);a=1,i=t[o]}return{c:r.subarray(0,n),n:e}},s1=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},CY=function(t,e,r){var n=r.length,i=TY(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<n;++a)t[i+a+4]=r[a];return(i+4+n)*8},hz=function(t,e,r,n,i,a,s,o,c,f,d){Kd(e,d++,r),++i[256];for(var m=TA(i,15),b=m.t,x=m.l,E=TA(a,15),T=E.t,A=E.l,R=fz(b),F=R.c,N=R.n,O=fz(T),U=O.c,j=O.n,H=new of(19),W=0;W<F.length;++W)++H[F[W]&31];for(var W=0;W<U.length;++W)++H[U[W]&31];for(var X=TA(H,7),oe=X.t,ee=X.l,G=19;G>4&&!oe[uz[G-1]];--G);var ae=f+5<<3,se=s1(i,Ym)+s1(a,GS)+s,fe=s1(i,b)+s1(a,T)+s+14+3*G+s1(H,oe)+2*H[16]+3*H[17]+7*H[18];if(c>=0&&ae<=se&&ae<=fe)return CY(e,d,t.subarray(c,c+f));var pe,De,ye,we;if(Kd(e,d,1+(fe<se)),d+=2,fe<se){pe=lb(b,x,0),De=b,ye=lb(T,A,0),we=T;var Te=lb(oe,ee,0);Kd(e,d,N-257),Kd(e,d+5,j-1),Kd(e,d+10,G-4),d+=14;for(var W=0;W<G;++W)Kd(e,d+3*W,oe[uz[W]]);d+=3*G;for(var Re=[F,U],de=0;de<2;++de)for(var Ee=Re[de],W=0;W<Ee.length;++W){var xe=Ee[W]&31;Kd(e,d,Te[xe]),d+=oe[xe],xe>15&&(Kd(e,d,Ee[W]>>5&127),d+=Ee[W]>>12)}}else pe=tve,De=Ym,ye=rve,we=GS;for(var W=0;W<o;++W){var Ne=n[W];if(Ne>255){var xe=Ne>>18&31;o1(e,d,pe[xe+257]),d+=De[xe+257],xe>7&&(Kd(e,d,Ne>>23&31),d+=mO[xe]);var Fe=Ne&31;o1(e,d,ye[Fe]),d+=we[Fe],Fe>3&&(o1(e,d,Ne>>5&8191),d+=yO[Fe])}else o1(e,d,pe[Ne]),d+=De[Ne]}return o1(e,d,pe[256]),d+De[256]},ive=new gO([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),AY=new Th(0),ave=function(t,e,r,n,i,a){var s=a.z||t.length,o=new Th(n+s+5*(1+Math.ceil(s/7e3))+i),c=o.subarray(n,o.length-i),f=a.l,d=(a.r||0)&7;if(e){d&&(c[0]=a.r>>3);for(var m=ive[e-1],b=m>>13,x=m&8191,E=(1<<r)-1,T=a.p||new of(32768),A=a.h||new of(E+1),R=Math.ceil(r/3),F=2*R,N=function(st){return(t[st]^t[st+1]<<R^t[st+2]<<F)&E},O=new gO(25e3),U=new of(288),j=new of(32),H=0,W=0,X=a.i||0,oe=0,ee=a.w||0,G=0;X+2<s;++X){var ae=N(X),se=X&32767,fe=A[ae];if(T[se]=fe,A[ae]=se,ee<=X){var pe=s-X;if((H>7e3||oe>24576)&&(pe>423||!f)){d=hz(t,c,0,O,U,j,W,oe,G,X-G,d),oe=H=W=0,G=X;for(var De=0;De<286;++De)U[De]=0;for(var De=0;De<30;++De)j[De]=0}var ye=2,we=0,Te=x,Re=se-fe&32767;if(pe>2&&ae==N(X-Re))for(var de=Math.min(b,pe)-1,Ee=Math.min(32767,X),xe=Math.min(258,pe);Re<=Ee&&--Te&&se!=fe;){if(t[X+ye]==t[X+ye-Re]){for(var Ne=0;Ne<xe&&t[X+Ne]==t[X+Ne-Re];++Ne);if(Ne>ye){if(ye=Ne,we=Re,Ne>de)break;for(var Fe=Math.min(Re,Ne-2),Xe=0,De=0;De<Fe;++De){var Be=X-Re+De&32767,ot=T[Be],Ke=Be-ot&32767;Ke>Xe&&(Xe=Ke,fe=Be)}}}se=fe,fe=T[se],Re+=se-fe&32767}if(we){O[oe++]=268435456|GM[ye]<<18|cz[we];var it=GM[ye]&31,Me=cz[we]&31;W+=mO[it]+yO[Me],++U[257+it],++j[Me],ee=X+ye,++H}else O[oe++]=t[X],++U[t[X]]}}for(X=Math.max(X,ee);X<s;++X)O[oe++]=t[X],++U[t[X]];d=hz(t,c,f,O,U,j,W,oe,G,X-G,d),f||(a.r=d&7|c[d/8|0]<<3,d-=7,a.h=A,a.p=T,a.i=X,a.w=ee)}else{for(var X=a.w||0;X<s+f;X+=65535){var zt=X+65535;zt>=s&&(c[d/8|0]=f,zt=s),d=CY(c,d+1,t.subarray(X,zt))}a.i=s}return nve(o,0,n+TY(d)+i)},IY=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,a=r.length|0,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},ove=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),s=new Th(a.length+t.length);s.set(a),s.set(t,a.length),t=s,i.w=a.length}return ave(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},PY=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},sve=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=IY();i.p(e.dictionary),PY(t,2,i.d())}};function YM(t,e){e||(e={});var r=IY();r.p(t);var n=ove(t,e,e.dictionary?6:2,4);return sve(n,e),PY(n,n.length-4,r.d()),n}var lve=typeof TextDecoder<"u"&&new TextDecoder,uve=0;try{lve.decode(AY,{stream:!0}),uve=1}catch{}function cve(t){if(Array.isArray(t))return t}function fve(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],c=!0,f=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(c=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);c=!0);}catch(d){f=!0,i=d}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(f)throw i}}return o}}function dz(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function hve(t,e){if(t){if(typeof t=="string")return dz(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dz(t,e):void 0}}function dve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pz(t,e){return cve(t)||fve(t,e)||hve(t,e)||dve()}function gz(t,e="utf8"){return new TextDecoder(e).decode(t)}const pve=new TextEncoder;function gve(t){return pve.encode(t)}const mve=1024*8,yve=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),CA={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class vO{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=mve,r={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const i=r.offset?r.offset>>>0:0,a=e.byteLength-i;let s=i;(ArrayBuffer.isView(e)||e instanceof vO)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+i),e=e.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=e,this.length=a,this.byteLength=a,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,a),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=CA[r].BYTES_PER_ELEMENT*e,i=this.byteOffset+this.offset,a=this.buffer.slice(i,i+n);if(this.littleEndian===yve&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(i,i+n));o.reverse();const c=new CA[r](o.buffer);return this.offset+=n,c.reverse(),c}const s=new CA[r](a);return this.offset+=n,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return gz(this.readBytes(e))}decodeText(e=1,r="utf8"){return gz(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(gve(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function d_(t){let e=t.length;for(;--e>=0;)t[e]=0}const vve=3,_ve=258,MY=29,bve=256,xve=bve+1+MY,kY=30,wve=512,Sve=new Array((xve+2)*2);d_(Sve);const Eve=new Array(kY*2);d_(Eve);const Tve=new Array(wve);d_(Tve);const Cve=new Array(_ve-vve+1);d_(Cve);const Ave=new Array(MY);d_(Ave);const Ive=new Array(kY);d_(Ive);const Pve=(t,e,r,n)=>{let i=t&65535|0,a=t>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do i=i+e[n++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16|0};var ZM=Pve;const Mve=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},kve=new Uint32Array(Mve()),Rve=(t,e,r,n)=>{const i=kve,a=n+r;t^=-1;for(let s=n;s<a;s++)t=t>>>8^i[(t^e[s])&255];return t^-1};var td=Rve,KM={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},RY={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Dve=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Ove=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)Dve(r,n)&&(t[n]=r[n])}}return t},Lve=t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,a=t.length;n<a;n++){let s=t[n];r.set(s,i),i+=s.length}return r},DY={assign:Ove,flattenChunks:Lve};let OY=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{OY=!1}const Bb=new Uint8Array(256);for(let t=0;t<256;t++)Bb[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Bb[254]=Bb[254]=1;var Nve=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,a,s=t.length,o=0;for(i=0;i<s;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(o),a=0,i=0;a<o;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|r&63):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|r&63):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|r&63);return e};const Fve=(t,e)=>{if(e<65534&&t.subarray&&OY)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var Bve=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const a=new Array(r*2);for(i=0,n=0;n<r;){let s=t[n++];if(s<128){a[i++]=s;continue}let o=Bb[s];if(o>4){a[i++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<r;)s=s<<6|t[n++]&63,o--;if(o>1){a[i++]=65533;continue}s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|s&1023)}return Fve(a,i)},zve=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+Bb[t[r]]>e?r:e},JM={string2buf:Nve,buf2string:Bve,utf8border:zve};function jve(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Uve=jve;const Y2=16209,Vve=16191;var $ve=function(e,r){let n,i,a,s,o,c,f,d,m,b,x,E,T,A,R,F,N,O,U,j,H,W,X,oe;const ee=e.state;n=e.next_in,X=e.input,i=n+(e.avail_in-5),a=e.next_out,oe=e.output,s=a-(r-e.avail_out),o=a+(e.avail_out-257),c=ee.dmax,f=ee.wsize,d=ee.whave,m=ee.wnext,b=ee.window,x=ee.hold,E=ee.bits,T=ee.lencode,A=ee.distcode,R=(1<<ee.lenbits)-1,F=(1<<ee.distbits)-1;e:do{E<15&&(x+=X[n++]<<E,E+=8,x+=X[n++]<<E,E+=8),N=T[x&R];t:for(;;){if(O=N>>>24,x>>>=O,E-=O,O=N>>>16&255,O===0)oe[a++]=N&65535;else if(O&16){U=N&65535,O&=15,O&&(E<O&&(x+=X[n++]<<E,E+=8),U+=x&(1<<O)-1,x>>>=O,E-=O),E<15&&(x+=X[n++]<<E,E+=8,x+=X[n++]<<E,E+=8),N=A[x&F];r:for(;;){if(O=N>>>24,x>>>=O,E-=O,O=N>>>16&255,O&16){if(j=N&65535,O&=15,E<O&&(x+=X[n++]<<E,E+=8,E<O&&(x+=X[n++]<<E,E+=8)),j+=x&(1<<O)-1,j>c){e.msg="invalid distance too far back",ee.mode=Y2;break e}if(x>>>=O,E-=O,O=a-s,j>O){if(O=j-O,O>d&&ee.sane){e.msg="invalid distance too far back",ee.mode=Y2;break e}if(H=0,W=b,m===0){if(H+=f-O,O<U){U-=O;do oe[a++]=b[H++];while(--O);H=a-j,W=oe}}else if(m<O){if(H+=f+m-O,O-=m,O<U){U-=O;do oe[a++]=b[H++];while(--O);if(H=0,m<U){O=m,U-=O;do oe[a++]=b[H++];while(--O);H=a-j,W=oe}}}else if(H+=m-O,O<U){U-=O;do oe[a++]=b[H++];while(--O);H=a-j,W=oe}for(;U>2;)oe[a++]=W[H++],oe[a++]=W[H++],oe[a++]=W[H++],U-=3;U&&(oe[a++]=W[H++],U>1&&(oe[a++]=W[H++]))}else{H=a-j;do oe[a++]=oe[H++],oe[a++]=oe[H++],oe[a++]=oe[H++],U-=3;while(U>2);U&&(oe[a++]=oe[H++],U>1&&(oe[a++]=oe[H++]))}}else if((O&64)===0){N=A[(N&65535)+(x&(1<<O)-1)];continue r}else{e.msg="invalid distance code",ee.mode=Y2;break e}break}}else if((O&64)===0){N=T[(N&65535)+(x&(1<<O)-1)];continue t}else if(O&32){ee.mode=Vve;break e}else{e.msg="invalid literal/length code",ee.mode=Y2;break e}break}}while(n<i&&a<o);U=E>>3,n-=U,E-=U<<3,x&=(1<<E)-1,e.next_in=n,e.next_out=a,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=a<o?257+(o-a):257-(a-o),ee.hold=x,ee.bits=E};const hv=15,mz=852,yz=592,vz=0,AA=1,_z=2,qve=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Hve=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Gve=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Wve=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Xve=(t,e,r,n,i,a,s,o)=>{const c=o.bits;let f=0,d=0,m=0,b=0,x=0,E=0,T=0,A=0,R=0,F=0,N,O,U,j,H,W=null,X;const oe=new Uint16Array(hv+1),ee=new Uint16Array(hv+1);let G=null,ae,se,fe;for(f=0;f<=hv;f++)oe[f]=0;for(d=0;d<n;d++)oe[e[r+d]]++;for(x=c,b=hv;b>=1&&oe[b]===0;b--);if(x>b&&(x=b),b===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,o.bits=1,0;for(m=1;m<b&&oe[m]===0;m++);for(x<m&&(x=m),A=1,f=1;f<=hv;f++)if(A<<=1,A-=oe[f],A<0)return-1;if(A>0&&(t===vz||b!==1))return-1;for(ee[1]=0,f=1;f<hv;f++)ee[f+1]=ee[f]+oe[f];for(d=0;d<n;d++)e[r+d]!==0&&(s[ee[e[r+d]]++]=d);if(t===vz?(W=G=s,X=20):t===AA?(W=qve,G=Hve,X=257):(W=Gve,G=Wve,X=0),F=0,d=0,f=m,H=a,E=x,T=0,U=-1,R=1<<x,j=R-1,t===AA&&R>mz||t===_z&&R>yz)return 1;for(;;){ae=f-T,s[d]+1<X?(se=0,fe=s[d]):s[d]>=X?(se=G[s[d]-X],fe=W[s[d]-X]):(se=96,fe=0),N=1<<f-T,O=1<<E,m=O;do O-=N,i[H+(F>>T)+O]=ae<<24|se<<16|fe|0;while(O!==0);for(N=1<<f-1;F&N;)N>>=1;if(N!==0?(F&=N-1,F+=N):F=0,d++,--oe[f]===0){if(f===b)break;f=e[r+s[d]]}if(f>x&&(F&j)!==U){for(T===0&&(T=x),H+=m,E=f-T,A=1<<E;E+T<b&&(A-=oe[E+T],!(A<=0));)E++,A<<=1;if(R+=1<<E,t===AA&&R>mz||t===_z&&R>yz)return 1;U=F&j,i[U]=x<<24|E<<16|H-a|0}}return F!==0&&(i[H+F]=f-T<<24|64<<16|0),o.bits=x,0};var ub=Xve;const Yve=0,LY=1,NY=2,{Z_FINISH:bz,Z_BLOCK:Zve,Z_TREES:Z2,Z_OK:Zm,Z_STREAM_END:Kve,Z_NEED_DICT:Jve,Z_STREAM_ERROR:Hf,Z_DATA_ERROR:FY,Z_MEM_ERROR:BY,Z_BUF_ERROR:Qve,Z_DEFLATED:xz}=RY,QT=16180,wz=16181,Sz=16182,Ez=16183,Tz=16184,Cz=16185,Az=16186,Iz=16187,Pz=16188,Mz=16189,WS=16190,Jd=16191,IA=16192,kz=16193,PA=16194,Rz=16195,Dz=16196,Oz=16197,Lz=16198,K2=16199,J2=16200,Nz=16201,Fz=16202,Bz=16203,zz=16204,jz=16205,MA=16206,Uz=16207,Vz=16208,us=16209,zY=16210,jY=16211,e0e=852,t0e=592,r0e=15,n0e=r0e,$z=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function i0e(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const vy=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<QT||e.mode>jY?1:0},UY=t=>{if(vy(t))return Hf;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=QT,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(e0e),e.distcode=e.distdyn=new Int32Array(t0e),e.sane=1,e.back=-1,Zm},VY=t=>{if(vy(t))return Hf;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,UY(t)},$Y=(t,e)=>{let r;if(vy(t))return Hf;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Hf:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,VY(t))},qY=(t,e)=>{if(!t)return Hf;const r=new i0e;t.state=r,r.strm=t,r.window=null,r.mode=QT;const n=$Y(t,e);return n!==Zm&&(t.state=null),n},a0e=t=>qY(t,n0e);let qz=!0,kA,RA;const o0e=t=>{if(qz){kA=new Int32Array(512),RA=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(ub(LY,t.lens,0,288,kA,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;ub(NY,t.lens,0,32,RA,0,t.work,{bits:5}),qz=!1}t.lencode=kA,t.lenbits=9,t.distcode=RA,t.distbits=5},HY=(t,e,r,n)=>{let i;const a=t.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),a.window.set(e.subarray(r-n,r-n+i),a.wnext),n-=i,n?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},s0e=(t,e)=>{let r,n,i,a,s,o,c,f,d,m,b,x,E,T,A=0,R,F,N,O,U,j,H,W;const X=new Uint8Array(4);let oe,ee;const G=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(vy(t)||!t.output||!t.input&&t.avail_in!==0)return Hf;r=t.state,r.mode===Jd&&(r.mode=IA),s=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,n=t.input,o=t.avail_in,f=r.hold,d=r.bits,m=o,b=c,W=Zm;e:for(;;)switch(r.mode){case QT:if(r.wrap===0){r.mode=IA;break}for(;d<16;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(r.wrap&2&&f===35615){r.wbits===0&&(r.wbits=15),r.check=0,X[0]=f&255,X[1]=f>>>8&255,r.check=td(r.check,X,2,0),f=0,d=0,r.mode=wz;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((f&255)<<8)+(f>>8))%31){t.msg="incorrect header check",r.mode=us;break}if((f&15)!==xz){t.msg="unknown compression method",r.mode=us;break}if(f>>>=4,d-=4,H=(f&15)+8,r.wbits===0&&(r.wbits=H),H>15||H>r.wbits){t.msg="invalid window size",r.mode=us;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=f&512?Mz:Jd,f=0,d=0;break;case wz:for(;d<16;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(r.flags=f,(r.flags&255)!==xz){t.msg="unknown compression method",r.mode=us;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=us;break}r.head&&(r.head.text=f>>8&1),r.flags&512&&r.wrap&4&&(X[0]=f&255,X[1]=f>>>8&255,r.check=td(r.check,X,2,0)),f=0,d=0,r.mode=Sz;case Sz:for(;d<32;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.head&&(r.head.time=f),r.flags&512&&r.wrap&4&&(X[0]=f&255,X[1]=f>>>8&255,X[2]=f>>>16&255,X[3]=f>>>24&255,r.check=td(r.check,X,4,0)),f=0,d=0,r.mode=Ez;case Ez:for(;d<16;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.head&&(r.head.xflags=f&255,r.head.os=f>>8),r.flags&512&&r.wrap&4&&(X[0]=f&255,X[1]=f>>>8&255,r.check=td(r.check,X,2,0)),f=0,d=0,r.mode=Tz;case Tz:if(r.flags&1024){for(;d<16;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.length=f,r.head&&(r.head.extra_len=f),r.flags&512&&r.wrap&4&&(X[0]=f&255,X[1]=f>>>8&255,r.check=td(r.check,X,2,0)),f=0,d=0}else r.head&&(r.head.extra=null);r.mode=Cz;case Cz:if(r.flags&1024&&(x=r.length,x>o&&(x=o),x&&(r.head&&(H=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+x),H)),r.flags&512&&r.wrap&4&&(r.check=td(r.check,n,x,a)),o-=x,a+=x,r.length-=x),r.length))break e;r.length=0,r.mode=Az;case Az:if(r.flags&2048){if(o===0)break e;x=0;do H=n[a+x++],r.head&&H&&r.length<65536&&(r.head.name+=String.fromCharCode(H));while(H&&x<o);if(r.flags&512&&r.wrap&4&&(r.check=td(r.check,n,x,a)),o-=x,a+=x,H)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Iz;case Iz:if(r.flags&4096){if(o===0)break e;x=0;do H=n[a+x++],r.head&&H&&r.length<65536&&(r.head.comment+=String.fromCharCode(H));while(H&&x<o);if(r.flags&512&&r.wrap&4&&(r.check=td(r.check,n,x,a)),o-=x,a+=x,H)break e}else r.head&&(r.head.comment=null);r.mode=Pz;case Pz:if(r.flags&512){for(;d<16;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(r.wrap&4&&f!==(r.check&65535)){t.msg="header crc mismatch",r.mode=us;break}f=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Jd;break;case Mz:for(;d<32;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}t.adler=r.check=$z(f),f=0,d=0,r.mode=WS;case WS:if(r.havedict===0)return t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,r.hold=f,r.bits=d,Jve;t.adler=r.check=1,r.mode=Jd;case Jd:if(e===Zve||e===Z2)break e;case IA:if(r.last){f>>>=d&7,d-=d&7,r.mode=MA;break}for(;d<3;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}switch(r.last=f&1,f>>>=1,d-=1,f&3){case 0:r.mode=kz;break;case 1:if(o0e(r),r.mode=K2,e===Z2){f>>>=2,d-=2;break e}break;case 2:r.mode=Dz;break;case 3:t.msg="invalid block type",r.mode=us}f>>>=2,d-=2;break;case kz:for(f>>>=d&7,d-=d&7;d<32;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if((f&65535)!==(f>>>16^65535)){t.msg="invalid stored block lengths",r.mode=us;break}if(r.length=f&65535,f=0,d=0,r.mode=PA,e===Z2)break e;case PA:r.mode=Rz;case Rz:if(x=r.length,x){if(x>o&&(x=o),x>c&&(x=c),x===0)break e;i.set(n.subarray(a,a+x),s),o-=x,a+=x,c-=x,s+=x,r.length-=x;break}r.mode=Jd;break;case Dz:for(;d<14;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(r.nlen=(f&31)+257,f>>>=5,d-=5,r.ndist=(f&31)+1,f>>>=5,d-=5,r.ncode=(f&15)+4,f>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=us;break}r.have=0,r.mode=Oz;case Oz:for(;r.have<r.ncode;){for(;d<3;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.lens[G[r.have++]]=f&7,f>>>=3,d-=3}for(;r.have<19;)r.lens[G[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,oe={bits:r.lenbits},W=ub(Yve,r.lens,0,19,r.lencode,0,r.work,oe),r.lenbits=oe.bits,W){t.msg="invalid code lengths set",r.mode=us;break}r.have=0,r.mode=Lz;case Lz:for(;r.have<r.nlen+r.ndist;){for(;A=r.lencode[f&(1<<r.lenbits)-1],R=A>>>24,F=A>>>16&255,N=A&65535,!(R<=d);){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(N<16)f>>>=R,d-=R,r.lens[r.have++]=N;else{if(N===16){for(ee=R+2;d<ee;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(f>>>=R,d-=R,r.have===0){t.msg="invalid bit length repeat",r.mode=us;break}H=r.lens[r.have-1],x=3+(f&3),f>>>=2,d-=2}else if(N===17){for(ee=R+3;d<ee;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}f>>>=R,d-=R,H=0,x=3+(f&7),f>>>=3,d-=3}else{for(ee=R+7;d<ee;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}f>>>=R,d-=R,H=0,x=11+(f&127),f>>>=7,d-=7}if(r.have+x>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=us;break}for(;x--;)r.lens[r.have++]=H}}if(r.mode===us)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=us;break}if(r.lenbits=9,oe={bits:r.lenbits},W=ub(LY,r.lens,0,r.nlen,r.lencode,0,r.work,oe),r.lenbits=oe.bits,W){t.msg="invalid literal/lengths set",r.mode=us;break}if(r.distbits=6,r.distcode=r.distdyn,oe={bits:r.distbits},W=ub(NY,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,oe),r.distbits=oe.bits,W){t.msg="invalid distances set",r.mode=us;break}if(r.mode=K2,e===Z2)break e;case K2:r.mode=J2;case J2:if(o>=6&&c>=258){t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,r.hold=f,r.bits=d,$ve(t,b),s=t.next_out,i=t.output,c=t.avail_out,a=t.next_in,n=t.input,o=t.avail_in,f=r.hold,d=r.bits,r.mode===Jd&&(r.back=-1);break}for(r.back=0;A=r.lencode[f&(1<<r.lenbits)-1],R=A>>>24,F=A>>>16&255,N=A&65535,!(R<=d);){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(F&&(F&240)===0){for(O=R,U=F,j=N;A=r.lencode[j+((f&(1<<O+U)-1)>>O)],R=A>>>24,F=A>>>16&255,N=A&65535,!(O+R<=d);){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}f>>>=O,d-=O,r.back+=O}if(f>>>=R,d-=R,r.back+=R,r.length=N,F===0){r.mode=jz;break}if(F&32){r.back=-1,r.mode=Jd;break}if(F&64){t.msg="invalid literal/length code",r.mode=us;break}r.extra=F&15,r.mode=Nz;case Nz:if(r.extra){for(ee=r.extra;d<ee;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Fz;case Fz:for(;A=r.distcode[f&(1<<r.distbits)-1],R=A>>>24,F=A>>>16&255,N=A&65535,!(R<=d);){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if((F&240)===0){for(O=R,U=F,j=N;A=r.distcode[j+((f&(1<<O+U)-1)>>O)],R=A>>>24,F=A>>>16&255,N=A&65535,!(O+R<=d);){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}f>>>=O,d-=O,r.back+=O}if(f>>>=R,d-=R,r.back+=R,F&64){t.msg="invalid distance code",r.mode=us;break}r.offset=N,r.extra=F&15,r.mode=Bz;case Bz:if(r.extra){for(ee=r.extra;d<ee;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=us;break}r.mode=zz;case zz:if(c===0)break e;if(x=b-c,r.offset>x){if(x=r.offset-x,x>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=us;break}x>r.wnext?(x-=r.wnext,E=r.wsize-x):E=r.wnext-x,x>r.length&&(x=r.length),T=r.window}else T=i,E=s-r.offset,x=r.length;x>c&&(x=c),c-=x,r.length-=x;do i[s++]=T[E++];while(--x);r.length===0&&(r.mode=J2);break;case jz:if(c===0)break e;i[s++]=r.length,c--,r.mode=J2;break;case MA:if(r.wrap){for(;d<32;){if(o===0)break e;o--,f|=n[a++]<<d,d+=8}if(b-=c,t.total_out+=b,r.total+=b,r.wrap&4&&b&&(t.adler=r.check=r.flags?td(r.check,i,b,s-b):ZM(r.check,i,b,s-b)),b=c,r.wrap&4&&(r.flags?f:$z(f))!==r.check){t.msg="incorrect data check",r.mode=us;break}f=0,d=0}r.mode=Uz;case Uz:if(r.wrap&&r.flags){for(;d<32;){if(o===0)break e;o--,f+=n[a++]<<d,d+=8}if(r.wrap&4&&f!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=us;break}f=0,d=0}r.mode=Vz;case Vz:W=Kve;break e;case us:W=FY;break e;case zY:return BY;case jY:default:return Hf}return t.next_out=s,t.avail_out=c,t.next_in=a,t.avail_in=o,r.hold=f,r.bits=d,(r.wsize||b!==t.avail_out&&r.mode<us&&(r.mode<MA||e!==bz))&&HY(t,t.output,t.next_out,b-t.avail_out),m-=t.avail_in,b-=t.avail_out,t.total_in+=m,t.total_out+=b,r.total+=b,r.wrap&4&&b&&(t.adler=r.check=r.flags?td(r.check,i,b,t.next_out-b):ZM(r.check,i,b,t.next_out-b)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Jd?128:0)+(r.mode===K2||r.mode===PA?256:0),(m===0&&b===0||e===bz)&&W===Zm&&(W=Qve),W},l0e=t=>{if(vy(t))return Hf;let e=t.state;return e.window&&(e.window=null),t.state=null,Zm},u0e=(t,e)=>{if(vy(t))return Hf;const r=t.state;return(r.wrap&2)===0?Hf:(r.head=e,e.done=!1,Zm)},c0e=(t,e)=>{const r=e.length;let n,i,a;return vy(t)||(n=t.state,n.wrap!==0&&n.mode!==WS)?Hf:n.mode===WS&&(i=1,i=ZM(i,e,r,0),i!==n.check)?FY:(a=HY(t,e,r,r),a?(n.mode=zY,BY):(n.havedict=1,Zm))};var f0e=VY,h0e=$Y,d0e=UY,p0e=a0e,g0e=qY,m0e=s0e,y0e=l0e,v0e=u0e,_0e=c0e,b0e="pako inflate (from Nodeca project)",rp={inflateReset:f0e,inflateReset2:h0e,inflateResetKeep:d0e,inflateInit:p0e,inflateInit2:g0e,inflate:m0e,inflateEnd:y0e,inflateGetHeader:v0e,inflateSetDictionary:_0e,inflateInfo:b0e};function x0e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var w0e=x0e;const GY=Object.prototype.toString,{Z_NO_FLUSH:S0e,Z_FINISH:E0e,Z_OK:zb,Z_STREAM_END:DA,Z_NEED_DICT:OA,Z_STREAM_ERROR:T0e,Z_DATA_ERROR:Hz,Z_MEM_ERROR:C0e}=RY;function Rx(t){this.options=DY.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Uve,this.strm.avail_out=0;let r=rp.inflateInit2(this.strm,e.windowBits);if(r!==zb)throw new Error(KM[r]);if(this.header=new w0e,rp.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=JM.string2buf(e.dictionary):GY.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=rp.inflateSetDictionary(this.strm,e.dictionary),r!==zb)))throw new Error(KM[r])}Rx.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?E0e:S0e,GY.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=rp.inflate(r,s),a===OA&&i&&(a=rp.inflateSetDictionary(r,i),a===zb?a=rp.inflate(r,s):a===Hz&&(a=OA));r.avail_in>0&&a===DA&&r.state.wrap>0&&t[r.next_in]!==0;)rp.inflateReset(r),a=rp.inflate(r,s);switch(a){case T0e:case Hz:case OA:case C0e:return this.onEnd(a),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||a===DA))if(this.options.to==="string"){let c=JM.utf8border(r.output,r.next_out),f=r.next_out-c,d=JM.buf2string(r.output,c);r.next_out=f,r.avail_out=n-f,f&&r.output.set(r.output.subarray(c,c+f),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===zb&&o===0)){if(a===DA)return a=rp.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Rx.prototype.onData=function(t){this.chunks.push(t)};Rx.prototype.onEnd=function(t){t===zb&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=DY.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function A0e(t,e){const r=new Rx(e);if(r.push(t),r.err)throw r.msg||KM[r.err];return r.result}var I0e=Rx,P0e=A0e,M0e={Inflate:I0e,inflate:P0e};const{Inflate:k0e,inflate:R0e}=M0e;var Gz=k0e,D0e=R0e;const WY=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;WY[t]=e}const Wz=4294967295;function O0e(t,e,r){let n=t;for(let i=0;i<r;i++)n=WY[(n^e[i])&255]^n>>>8;return n}function L0e(t,e){return(O0e(Wz,t,e)^Wz)>>>0}function Xz(t,e,r){const n=t.readUint32(),i=L0e(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function XY(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function YY(t,e,r,n){let i=0;for(;i<n;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+e[i-n]&255}function ZY(t,e,r,n){let i=0;if(r.length===0)for(;i<n;i++)e[i]=t[i];else for(;i<n;i++)e[i]=t[i]+r[i]&255}function KY(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+(e[a-i]>>1)&255}else{for(;a<i;a++)e[a]=t[a]+(r[a]>>1)&255;for(;a<n;a++)e[a]=t[a]+(e[a-i]+r[a]>>1)&255}}function JY(t,e,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)e[a]=t[a];for(;a<n;a++)e[a]=t[a]+e[a-i]&255}else{for(;a<i;a++)e[a]=t[a]+r[a]&255;for(;a<n;a++)e[a]=t[a]+N0e(e[a-i],r[a],r[a-i])&255}}function N0e(t,e,r){const n=t+e-r,i=Math.abs(n-t),a=Math.abs(n-e),s=Math.abs(n-r);return i<=a&&i<=s?t:a<=s?e:r}function F0e(t,e,r,n,i,a){switch(t){case 0:XY(e,r,i);break;case 1:YY(e,r,i,a);break;case 2:ZY(e,r,n,i);break;case 3:KY(e,r,n,i,a);break;case 4:JY(e,r,n,i,a);break;default:throw new Error(`Unsupported filter: ${t}`)}}const B0e=new Uint16Array([255]),z0e=new Uint8Array(B0e.buffer),j0e=z0e[0]===255;function U0e(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*i,c=new Uint8Array(n*r*o);let f=0;for(let d=0;d<7;d++){const m=s[d],b=Math.ceil((r-m.x)/m.xStep),x=Math.ceil((n-m.y)/m.yStep);if(b<=0||x<=0)continue;const E=b*o,T=new Uint8Array(E);for(let A=0;A<x;A++){const R=e[f++],F=e.subarray(f,f+E);f+=E;const N=new Uint8Array(E);F0e(R,F,N,T,E,o),T.set(N);for(let O=0;O<b;O++){const U=m.x+O*m.xStep,j=m.y+A*m.yStep;if(!(U>=r||j>=n))for(let H=0;H<o;H++)c[(j*r+U)*o+H]=N[O*o+H]}}}if(a===16){const d=new Uint16Array(c.buffer);if(j0e)for(let m=0;m<d.length;m++)d[m]=V0e(d[m]);return d}else return c}function V0e(t){return(t&255)<<8|t>>8&255}const $0e=new Uint16Array([255]),q0e=new Uint8Array($0e.buffer),H0e=q0e[0]===255,G0e=new Uint8Array(0);function Yz(t){const{data:e,width:r,height:n,channels:i,depth:a}=t,s=Math.ceil(a/8)*i,o=Math.ceil(a/8*i*r),c=new Uint8Array(n*o);let f=G0e,d=0,m,b;for(let x=0;x<n;x++){switch(m=e.subarray(d+1,d+1+o),b=c.subarray(x*o,(x+1)*o),e[d]){case 0:XY(m,b,o);break;case 1:YY(m,b,o,s);break;case 2:ZY(m,b,f,o);break;case 3:KY(m,b,f,o,s);break;case 4:JY(m,b,f,o,s);break;default:throw new Error(`Unsupported filter: ${e[d]}`)}f=b,d+=o+1}if(a===16){const x=new Uint16Array(c.buffer);if(H0e)for(let E=0;E<x.length;E++)x[E]=W0e(x[E]);return x}else return c}function W0e(t){return(t&255)<<8|t>>8&255}const oS=Uint8Array.of(137,80,78,71,13,10,26,10);function Zz(t){if(!X0e(t.readBytes(oS.length)))throw new Error("wrong PNG signature")}function X0e(t){if(t.length<oS.length)return!1;for(let e=0;e<oS.length;e++)if(t[e]!==oS[e])return!1;return!0}const Y0e="tEXt",Z0e=0,QY=new TextDecoder("latin1");function K0e(t){if(Q0e(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const J0e=/^[\u0000-\u00FF]*$/;function Q0e(t){if(!J0e.test(t))throw new Error("invalid latin1 text")}function e_e(t,e,r){const n=eZ(e);t[n]=t_e(e,r-n.length-1)}function eZ(t){for(t.mark();t.readByte()!==Z0e;);const e=t.offset;t.reset();const r=QY.decode(t.readBytes(e-t.offset-1));return t.skip(1),K0e(r),r}function t_e(t,e){return QY.decode(t.readBytes(e))}const Kc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},LA={UNKNOWN:-1,DEFLATE:0},Kz={UNKNOWN:-1,ADAPTIVE:0},NA={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Q2={NONE:0,BACKGROUND:1,PREVIOUS:2},FA={SOURCE:0,OVER:1};class r_e extends vO{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,r={}){super(e);const{checkCrc:n=!1}=r;this._checkCrc=n,this._inflator=new Gz,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=LA.UNKNOWN,this._filterMethod=Kz.UNKNOWN,this._interlaceMethod=NA.UNKNOWN,this._colorType=Kc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Zz(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeChunk(e,r)}return this.decodeImage(),this._png}decodeApng(){for(Zz(this);!this._end;){const e=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(e,r)}return this.decodeApngImage(),this._apng}decodeChunk(e,r){const n=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case Y0e:e_e(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?Xz(this,e+4,r):this.skip(4)}decodeApngChunk(e,r){const n=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,r),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?Xz(this,e+4,r):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=n_e(this.readUint8());const r=this.readUint8();this._colorType=r;let n;switch(r){case Kc.GREYSCALE:n=1;break;case Kc.TRUECOLOUR:n=3;break;case Kc.INDEXED_COLOUR:n=1;break;case Kc.GREYSCALE_ALPHA:n=2;break;case Kc.TRUECOLOUR_ALPHA:n=4;break;case Kc.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==LA.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const r=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let i=0;i<r;i++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const r=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let r=e,n=this.offset+this.byteOffset;if(n+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case Kc.GREYSCALE:case Kc.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let r=0;r<e/2;r++)this._transparency[r]=this.readUint16();break}case Kc.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let r=0;for(;r<e;r++){const n=this.readByte();this._palette[r].push(n)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case Kc.UNKNOWN:case Kc.GREYSCALE_ALPHA:case Kc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const r=eZ(this),n=this.readUint8();if(n!==LA.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const i=this.readBytes(e-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:D0e(i)}}decodepHYs(){const e=this.readUint32(),r=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:r,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const r={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=Yz({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)r.data=n.data;else{const i=this._apng.frames.at(e-1);this.disposeFrame(n,i,r),this.addFrameDataToCanvas(r,n)}this._apng.frames.push(r)}}return this._apng}disposeFrame(e,r,n){switch(e.disposeOp){case Q2.NONE:break;case Q2.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let a=0;a<this._png.width;a++){const s=(i*e.width+a)*this._png.channels;for(let o=0;o<this._png.channels;o++)n.data[s+o]=0}break;case Q2.PREVIOUS:n.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,r){const n=1<<this._png.depth,i=(a,s)=>{const o=((a+r.yOffset)*this._png.width+r.xOffset+s)*this._png.channels,c=(a*r.width+s)*this._png.channels;return{index:o,frameIndex:c}};switch(r.blendOp){case FA.SOURCE:for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const{index:o,frameIndex:c}=i(a,s);for(let f=0;f<this._png.channels;f++)e.data[o+f]=r.data[c+f]}break;case FA.OVER:for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const{index:o,frameIndex:c}=i(a,s);for(let f=0;f<this._png.channels;f++){const d=r.data[c+this._png.channels-1]/n,m=f%(this._png.channels-1)===0?1:r.data[c+f],b=Math.floor(d*m+(1-d)*e.data[o+f]);e.data[o+f]+=b}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Kz.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===NA.NO_INTERLACE)this._png.data=Yz({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===NA.ADAM7)this._png.data=U0e({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,r=this._frames.at(-1);r?r.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Q2.NONE,blendOp:FA.SOURCE,data:e}),this._inflator=new Gz,this._writingDataChunks=!1}}function n_e(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var Jz;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(Jz||(Jz={}));function i_e(t,e){return new r_e(t,e).decode()}var Oi=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function BA(){Oi.console&&typeof Oi.console.log=="function"&&Oi.console.log.apply(Oi.console,arguments)}var Ro={log:BA,warn:function(t){Oi.console&&(typeof Oi.console.warn=="function"?Oi.console.warn.apply(Oi.console,arguments):BA.call(null,arguments))},error:function(t){Oi.console&&(typeof Oi.console.error=="function"?Oi.console.error.apply(Oi.console,arguments):BA(t))}};function zA(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){_m(n.response,e,r)},n.onerror=function(){Ro.error("could not download file")},n.send()}function Qz(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function ew(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var _m=Oi.saveAs||((typeof window>"u"?"undefined":po(window))!=="object"||window!==Oi?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Oi.URL||Oi.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?Qz(i.href)?zA(t,e,r):ew(i,i.target="_blank"):ew(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){ew(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(Qz(t))zA(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){ew(n)})}else navigator.msSaveOrOpenBlob((function(i,a){return a===void 0?a={autoBom:!1}:po(a)!=="object"&&(Ro.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i})(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return zA(t,e,r);var i=t.type==="application/octet-stream",a=/constructor/i.test(Oi.HTMLElement)||Oi.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&a)&&(typeof FileReader>"u"?"undefined":po(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var d=o.result;d=s?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},o.readAsDataURL(t)}else{var c=Oi.URL||Oi.webkitURL,f=c.createObjectURL(t);n?n.location=f:location.href=f,n=null,setTimeout(function(){c.revokeObjectURL(f)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function tZ(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,s=i.exec(t);s&&(e=a(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),c=this.g.toString(16),f=this.b.toString(16);return o.length==1&&(o="0"+o),c.length==1&&(c="0"+c),f.length==1&&(f="0"+f),"#"+o+c+f}}var sS=Oi.atob.bind(Oi),e9=Oi.btoa.bind(Oi);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function jA(t,e){var r=t[0],n=t[1],i=t[2],a=t[3];r=Vu(r,n,i,a,e[0],7,-680876936),a=Vu(a,r,n,i,e[1],12,-389564586),i=Vu(i,a,r,n,e[2],17,606105819),n=Vu(n,i,a,r,e[3],22,-1044525330),r=Vu(r,n,i,a,e[4],7,-176418897),a=Vu(a,r,n,i,e[5],12,1200080426),i=Vu(i,a,r,n,e[6],17,-1473231341),n=Vu(n,i,a,r,e[7],22,-45705983),r=Vu(r,n,i,a,e[8],7,1770035416),a=Vu(a,r,n,i,e[9],12,-1958414417),i=Vu(i,a,r,n,e[10],17,-42063),n=Vu(n,i,a,r,e[11],22,-1990404162),r=Vu(r,n,i,a,e[12],7,1804603682),a=Vu(a,r,n,i,e[13],12,-40341101),i=Vu(i,a,r,n,e[14],17,-1502002290),r=$u(r,n=Vu(n,i,a,r,e[15],22,1236535329),i,a,e[1],5,-165796510),a=$u(a,r,n,i,e[6],9,-1069501632),i=$u(i,a,r,n,e[11],14,643717713),n=$u(n,i,a,r,e[0],20,-373897302),r=$u(r,n,i,a,e[5],5,-701558691),a=$u(a,r,n,i,e[10],9,38016083),i=$u(i,a,r,n,e[15],14,-660478335),n=$u(n,i,a,r,e[4],20,-405537848),r=$u(r,n,i,a,e[9],5,568446438),a=$u(a,r,n,i,e[14],9,-1019803690),i=$u(i,a,r,n,e[3],14,-187363961),n=$u(n,i,a,r,e[8],20,1163531501),r=$u(r,n,i,a,e[13],5,-1444681467),a=$u(a,r,n,i,e[2],9,-51403784),i=$u(i,a,r,n,e[7],14,1735328473),r=qu(r,n=$u(n,i,a,r,e[12],20,-1926607734),i,a,e[5],4,-378558),a=qu(a,r,n,i,e[8],11,-2022574463),i=qu(i,a,r,n,e[11],16,1839030562),n=qu(n,i,a,r,e[14],23,-35309556),r=qu(r,n,i,a,e[1],4,-1530992060),a=qu(a,r,n,i,e[4],11,1272893353),i=qu(i,a,r,n,e[7],16,-155497632),n=qu(n,i,a,r,e[10],23,-1094730640),r=qu(r,n,i,a,e[13],4,681279174),a=qu(a,r,n,i,e[0],11,-358537222),i=qu(i,a,r,n,e[3],16,-722521979),n=qu(n,i,a,r,e[6],23,76029189),r=qu(r,n,i,a,e[9],4,-640364487),a=qu(a,r,n,i,e[12],11,-421815835),i=qu(i,a,r,n,e[15],16,530742520),r=Hu(r,n=qu(n,i,a,r,e[2],23,-995338651),i,a,e[0],6,-198630844),a=Hu(a,r,n,i,e[7],10,1126891415),i=Hu(i,a,r,n,e[14],15,-1416354905),n=Hu(n,i,a,r,e[5],21,-57434055),r=Hu(r,n,i,a,e[12],6,1700485571),a=Hu(a,r,n,i,e[3],10,-1894986606),i=Hu(i,a,r,n,e[10],15,-1051523),n=Hu(n,i,a,r,e[1],21,-2054922799),r=Hu(r,n,i,a,e[8],6,1873313359),a=Hu(a,r,n,i,e[15],10,-30611744),i=Hu(i,a,r,n,e[6],15,-1560198380),n=Hu(n,i,a,r,e[13],21,1309151649),r=Hu(r,n,i,a,e[4],6,-145523070),a=Hu(a,r,n,i,e[11],10,-1120210379),i=Hu(i,a,r,n,e[2],15,718787259),n=Hu(n,i,a,r,e[9],21,-343485551),t[0]=fg(r,t[0]),t[1]=fg(n,t[1]),t[2]=fg(i,t[2]),t[3]=fg(a,t[3])}function e3(t,e,r,n,i,a){return e=fg(fg(e,t),fg(n,a)),fg(e<<i|e>>>32-i,r)}function Vu(t,e,r,n,i,a,s){return e3(e&r|~e&n,t,e,i,a,s)}function $u(t,e,r,n,i,a,s){return e3(e&n|r&~n,t,e,i,a,s)}function qu(t,e,r,n,i,a,s){return e3(e^r^n,t,e,i,a,s)}function Hu(t,e,r,n,i,a,s){return e3(r^(e|~n),t,e,i,a,s)}function rZ(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)jA(n,a_e(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(jA(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,jA(n,i),n}function a_e(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var t9="0123456789abcdef".split("");function o_e(t){for(var e="",r=0;r<4;r++)e+=t9[t>>8*r+4&15]+t9[t>>8*r&15];return e}function s_e(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function QM(t){return rZ(t).map(s_e).join("")}var l_e=(function(t){for(var e=0;e<t.length;e++)t[e]=o_e(t[e]);return t.join("")})(rZ("hello"))!="5d41402abc4b2a76b9719d911017c592";function fg(t,e){if(l_e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function ek(t,e){var r,n,i,a;if(t!==r){for(var s=(i=t,a=1+(256/t.length|0),new Array(a+1).join(i)),o=[],c=0;c<256;c++)o[c]=c;var f=0;for(c=0;c<256;c++){var d=o[c];f=(f+d+s.charCodeAt(c))%256,o[c]=o[f],o[f]=d}r=t,n=o}else o=n;var m=e.length,b=0,x=0,E="";for(c=0;c<m;c++)x=(x+(d=o[b=(b+1)%256]))%256,o[b]=o[x],o[x]=d,s=o[(o[b]+o[x])%256],E+=String.fromCharCode(e.charCodeAt(c)^s);return E}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var r9={print:4,modify:8,copy:16,"annot-forms":32};function Ov(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(o){if(r9.perm!==void 0)throw new Error("Invalid permission: "+o);i+=r9[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,s),this.P=-(1+(255^i)),this.encryptionKey=QM(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=ek(this.encryptionKey,this.padding)}function Lv(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);e+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):t[n]}return e}function n9(t){if(po(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!i],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in e[r]){var s=e[r][a];try{s[0].apply(t,n)}catch(o){Oi.console&&Ro.error("jsPDF PubSub Error",o.message,o)}s[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function XS(t){if(!(this instanceof XS))return new XS(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function nZ(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function wm(t,e,r,n,i){if(!(this instanceof wm))return new wm(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,nZ.call(this,n,i)}function n0(t,e,r,n,i){if(!(this instanceof n0))return new n0(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,nZ.call(this,n,i)}function di(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],s=[],o=1,c=16,f="S",d=null;po(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,a=t.compress||t.compressPdf||a,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),f=t.defaultPathOperation||"S"),s=t.filters||(a===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var m=t.putOnlyUsedFonts||!1,b={},x={internal:{},__private__:{}};x.__private__.PubSub=n9;var E="1.3",T=x.__private__.getPdfVersion=function(){return E};x.__private__.setPdfVersion=function(ue){E=ue};var A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};x.__private__.getPageFormats=function(){return A};var R=x.__private__.getPageFormat=function(ue){return A[ue]};i=i||"a4";var F="compat",N="advanced",O=F;function U(){this.saveGraphicsState(),$e(new ln(qe,0,0,-qe,0,Oo()*qe).toString()+" cm"),this.setFontSize(this.getFontSize()/qe),f="n",O=N}function j(){this.restoreGraphicsState(),f="S",O=F}var H=x.__private__.combineFontStyleAndFontWeight=function(ue,We){if(ue=="bold"&&We=="normal"||ue=="bold"&&We==400||ue=="normal"&&We=="italic"||ue=="bold"&&We=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return We&&(ue=We==400||We==="normal"?ue==="italic"?"italic":"normal":We!=700&&We!=="bold"||ue!=="normal"?(We==700?"bold":We)+""+ue:"bold"),ue};x.advancedAPI=function(ue){var We=O===F;return We&&U.call(this),typeof ue!="function"||(ue(this),We&&j.call(this)),this},x.compatAPI=function(ue){var We=O===N;return We&&j.call(this),typeof ue!="function"||(ue(this),We&&U.call(this)),this},x.isAdvancedAPI=function(){return O===N};var W,X=function(ue){if(O!==N)throw new Error(ue+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},oe=x.roundToPrecision=x.__private__.roundToPrecision=function(ue,We){var bt=e||We;if(isNaN(ue)||isNaN(bt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return ue.toFixed(bt).replace(/0+$/,"")};W=x.hpf=x.__private__.hpf=typeof c=="number"?function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.hpf");return oe(ue,c)}:c==="smart"?function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.hpf");return oe(ue,ue>-1&&ue<1?16:5)}:function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.hpf");return oe(ue,16)};var ee=x.f2=x.__private__.f2=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.f2");return oe(ue,2)},G=x.__private__.f3=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.f3");return oe(ue,3)},ae=x.scale=x.__private__.scale=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.scale");return O===F?ue*qe:O===N?ue:void 0},se=function(ue){return ae((function(We){return O===F?Oo()-We:O===N?We:void 0})(ue))};x.__private__.setPrecision=x.setPrecision=function(ue){typeof parseInt(ue,10)=="number"&&(e=parseInt(ue,10))};var fe,pe="00000000000000000000000000000000",De=x.__private__.getFileId=function(){return pe},ye=x.__private__.setFileId=function(ue){return pe=ue!==void 0&&/^[a-fA-F0-9]{32}$/.test(ue)?ue.toUpperCase():pe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Ba=new Ov(d.userPermissions,d.userPassword,d.ownerPassword,pe)),pe};x.setFileId=function(ue){return ye(ue),this},x.getFileId=function(){return De()};var we=x.__private__.convertDateToPDFDate=function(ue){var We=ue.getTimezoneOffset(),bt=We<0?"+":"-",Bt=Math.floor(Math.abs(We/60)),sr=Math.abs(We%60),Lr=[bt,xe(Bt),"'",xe(sr),"'"].join("");return["D:",ue.getFullYear(),xe(ue.getMonth()+1),xe(ue.getDate()),xe(ue.getHours()),xe(ue.getMinutes()),xe(ue.getSeconds()),Lr].join("")},Te=x.__private__.convertPDFDateToDate=function(ue){var We=parseInt(ue.substr(2,4),10),bt=parseInt(ue.substr(6,2),10)-1,Bt=parseInt(ue.substr(8,2),10),sr=parseInt(ue.substr(10,2),10),Lr=parseInt(ue.substr(12,2),10),Zr=parseInt(ue.substr(14,2),10);return new Date(We,bt,Bt,sr,Lr,Zr,0)},Re=x.__private__.setCreationDate=function(ue){var We;if(ue===void 0&&(ue=new Date),ue instanceof Date)We=we(ue);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(ue))throw new Error("Invalid argument passed to jsPDF.setCreationDate");We=ue}return fe=We},de=x.__private__.getCreationDate=function(ue){var We=fe;return ue==="jsDate"&&(We=Te(fe)),We};x.setCreationDate=function(ue){return Re(ue),this},x.getCreationDate=function(ue){return de(ue)};var Ee,xe=x.__private__.padd2=function(ue){return("0"+parseInt(ue)).slice(-2)},Ne=x.__private__.padd2Hex=function(ue){return("00"+(ue=ue.toString())).substr(ue.length)},Fe=0,Xe=[],Be=[],ot=0,Ke=[],it=[],Me=!1,zt=Be;x.__private__.setCustomOutputDestination=function(ue){Me=!0,zt=ue};var st=function(ue){Me||(zt=ue)};x.__private__.resetCustomOutputDestination=function(){Me=!1,zt=Be};var $e=x.__private__.out=function(ue){return ue=ue.toString(),ot+=ue.length+1,zt.push(ue),zt},Jt=x.__private__.write=function(ue){return $e(arguments.length===1?ue.toString():Array.prototype.join.call(arguments," "))},Ht=x.__private__.getArrayBuffer=function(ue){for(var We=ue.length,bt=new ArrayBuffer(We),Bt=new Uint8Array(bt);We--;)Bt[We]=ue.charCodeAt(We);return bt},pr=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];x.__private__.getStandardFonts=function(){return pr};var _t=t.fontSize||16;x.__private__.setFontSize=x.setFontSize=function(ue){return _t=O===N?ue/qe:ue,this};var vr,br=x.__private__.getFontSize=x.getFontSize=function(){return O===F?_t:_t*qe},lr=t.R2L||!1;x.__private__.setR2L=x.setR2L=function(ue){return lr=ue,this},x.__private__.getR2L=x.getR2L=function(){return lr};var Cr,Tr=x.__private__.setZoomMode=function(ue){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(ue))vr=ue;else if(isNaN(ue)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(ue)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+ue+'" is not recognized.');vr=ue}else vr=parseInt(ue,10)};x.__private__.getZoomMode=function(){return vr};var Qt,at=x.__private__.setPageMode=function(ue){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(ue)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+ue+'" is not recognized.');Cr=ue};x.__private__.getPageMode=function(){return Cr};var Pe=x.__private__.setLayoutMode=function(ue){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(ue)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+ue+'" is not recognized.');Qt=ue};x.__private__.getLayoutMode=function(){return Qt},x.__private__.setDisplayMode=x.setDisplayMode=function(ue,We,bt){return Tr(ue),Pe(We),at(bt),this};var be={title:"",subject:"",author:"",keywords:"",creator:""};x.__private__.getDocumentProperty=function(ue){if(Object.keys(be).indexOf(ue)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return be[ue]},x.__private__.getDocumentProperties=function(){return be},x.__private__.setDocumentProperties=x.setProperties=x.setDocumentProperties=function(ue){for(var We in be)be.hasOwnProperty(We)&&ue[We]&&(be[We]=ue[We]);return this},x.__private__.setDocumentProperty=function(ue,We){if(Object.keys(be).indexOf(ue)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return be[ue]=We};var je,qe,Ge,Nt,Et,mt={},ct={},Kt=[],qt={},Ir={},Ar={},$r={},cn=null,zr=0,Rt=[],en=new n9(x),jn=t.hotfixes||[],Qr={},nr={},oi=[],ln=function ue(We,bt,Bt,sr,Lr,Zr){if(!(this instanceof ue))return new ue(We,bt,Bt,sr,Lr,Zr);isNaN(We)&&(We=1),isNaN(bt)&&(bt=0),isNaN(Bt)&&(Bt=0),isNaN(sr)&&(sr=1),isNaN(Lr)&&(Lr=0),isNaN(Zr)&&(Zr=0),this._matrix=[We,bt,Bt,sr,Lr,Zr]};Object.defineProperty(ln.prototype,"sx",{get:function(){return this._matrix[0]},set:function(ue){this._matrix[0]=ue}}),Object.defineProperty(ln.prototype,"shy",{get:function(){return this._matrix[1]},set:function(ue){this._matrix[1]=ue}}),Object.defineProperty(ln.prototype,"shx",{get:function(){return this._matrix[2]},set:function(ue){this._matrix[2]=ue}}),Object.defineProperty(ln.prototype,"sy",{get:function(){return this._matrix[3]},set:function(ue){this._matrix[3]=ue}}),Object.defineProperty(ln.prototype,"tx",{get:function(){return this._matrix[4]},set:function(ue){this._matrix[4]=ue}}),Object.defineProperty(ln.prototype,"ty",{get:function(){return this._matrix[5]},set:function(ue){this._matrix[5]=ue}}),Object.defineProperty(ln.prototype,"a",{get:function(){return this._matrix[0]},set:function(ue){this._matrix[0]=ue}}),Object.defineProperty(ln.prototype,"b",{get:function(){return this._matrix[1]},set:function(ue){this._matrix[1]=ue}}),Object.defineProperty(ln.prototype,"c",{get:function(){return this._matrix[2]},set:function(ue){this._matrix[2]=ue}}),Object.defineProperty(ln.prototype,"d",{get:function(){return this._matrix[3]},set:function(ue){this._matrix[3]=ue}}),Object.defineProperty(ln.prototype,"e",{get:function(){return this._matrix[4]},set:function(ue){this._matrix[4]=ue}}),Object.defineProperty(ln.prototype,"f",{get:function(){return this._matrix[5]},set:function(ue){this._matrix[5]=ue}}),Object.defineProperty(ln.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ln.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ln.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ln.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ln.prototype.join=function(ue){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(W).join(ue)},ln.prototype.multiply=function(ue){var We=ue.sx*this.sx+ue.shy*this.shx,bt=ue.sx*this.shy+ue.shy*this.sy,Bt=ue.shx*this.sx+ue.sy*this.shx,sr=ue.shx*this.shy+ue.sy*this.sy,Lr=ue.tx*this.sx+ue.ty*this.shx+this.tx,Zr=ue.tx*this.shy+ue.ty*this.sy+this.ty;return new ln(We,bt,Bt,sr,Lr,Zr)},ln.prototype.decompose=function(){var ue=this.sx,We=this.shy,bt=this.shx,Bt=this.sy,sr=this.tx,Lr=this.ty,Zr=Math.sqrt(ue*ue+We*We),Nn=(ue/=Zr)*bt+(We/=Zr)*Bt;bt-=ue*Nn,Bt-=We*Nn;var qn=Math.sqrt(bt*bt+Bt*Bt);return Nn/=qn,ue*(Bt/=qn)<We*(bt/=qn)&&(ue=-ue,We=-We,Nn=-Nn,Zr=-Zr),{scale:new ln(Zr,0,0,qn,0,0),translate:new ln(1,0,0,1,sr,Lr),rotate:new ln(ue,We,-We,ue,0,0),skew:new ln(1,0,Nn,1,0,0)}},ln.prototype.toString=function(ue){return this.join(" ")},ln.prototype.inversed=function(){var ue=this.sx,We=this.shy,bt=this.shx,Bt=this.sy,sr=this.tx,Lr=this.ty,Zr=1/(ue*Bt-We*bt),Nn=Bt*Zr,qn=-We*Zr,Un=-bt*Zr,ui=ue*Zr;return new ln(Nn,qn,Un,ui,-Nn*sr-Un*Lr,-qn*sr-ui*Lr)},ln.prototype.applyToPoint=function(ue){var We=ue.x*this.sx+ue.y*this.shx+this.tx,bt=ue.x*this.shy+ue.y*this.sy+this.ty;return new ku(We,bt)},ln.prototype.applyToRectangle=function(ue){var We=this.applyToPoint(ue),bt=this.applyToPoint(new ku(ue.x+ue.w,ue.y+ue.h));return new Ru(We.x,We.y,bt.x-We.x,bt.y-We.y)},ln.prototype.clone=function(){var ue=this.sx,We=this.shy,bt=this.shx,Bt=this.sy,sr=this.tx,Lr=this.ty;return new ln(ue,We,bt,Bt,sr,Lr)},x.Matrix=ln;var Kn=x.matrixMult=function(ue,We){return We.multiply(ue)},ke=new ln(1,0,0,1,0,0);x.unitMatrix=x.identityMatrix=ke;var He=function(ue,We){if(!Ir[ue]){var bt=(We instanceof wm?"Sh":"P")+(Object.keys(qt).length+1).toString(10);We.id=bt,Ir[ue]=bt,qt[bt]=We,en.publish("addPattern",We)}};x.ShadingPattern=wm,x.TilingPattern=n0,x.addShadingPattern=function(ue,We){return X("addShadingPattern()"),He(ue,We),this},x.beginTilingPattern=function(ue){X("beginTilingPattern()"),ji(ue.boundingBox[0],ue.boundingBox[1],ue.boundingBox[2]-ue.boundingBox[0],ue.boundingBox[3]-ue.boundingBox[1],ue.matrix)},x.endTilingPattern=function(ue,We){X("endTilingPattern()"),We.stream=it[Ee].join(`
`),He(ue,We),en.publish("endTilingPattern",We),oi.pop().restore()};var Tt,Gt=x.__private__.newObject=function(){var ue=Ut();return Xr(ue,!0),ue},Ut=x.__private__.newObjectDeferred=function(){return Fe++,Xe[Fe]=function(){return ot},Fe},Xr=function(ue,We){return We=typeof We=="boolean"&&We,Xe[ue]=ot,We&&$e(ue+" 0 obj"),ue},Ln=x.__private__.newAdditionalObject=function(){var ue={objId:Ut(),content:""};return Ke.push(ue),ue},Bi=Ut(),Ci=Ut(),Fr=x.__private__.decodeColorString=function(ue){var We=ue.split(" ");if(We.length!==2||We[1]!=="g"&&We[1]!=="G")We.length!==5||We[4]!=="k"&&We[4]!=="K"||(We=[(1-We[0])*(1-We[3]),(1-We[1])*(1-We[3]),(1-We[2])*(1-We[3]),"r"]);else{var bt=parseFloat(We[0]);We=[bt,bt,bt,"r"]}for(var Bt="#",sr=0;sr<3;sr++)Bt+=("0"+Math.floor(255*parseFloat(We[sr])).toString(16)).slice(-2);return Bt},Rn=x.__private__.encodeColorString=function(ue){var We;typeof ue=="string"&&(ue={ch1:ue});var bt=ue.ch1,Bt=ue.ch2,sr=ue.ch3,Lr=ue.ch4,Zr=ue.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof bt=="string"&&bt.charAt(0)!=="#"){var Nn=new tZ(bt);if(Nn.ok)bt=Nn.toHex();else if(!/^\d*\.?\d*$/.test(bt))throw new Error('Invalid color "'+bt+'" passed to jsPDF.encodeColorString.')}if(typeof bt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(bt)&&(bt="#"+bt[1]+bt[1]+bt[2]+bt[2]+bt[3]+bt[3]),typeof bt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(bt)){var qn=parseInt(bt.substr(1),16);bt=qn>>16&255,Bt=qn>>8&255,sr=255&qn}if(Bt===void 0||Lr===void 0&&bt===Bt&&Bt===sr)We=typeof bt=="string"?bt+" "+Zr[0]:ue.precision===2?ee(bt/255)+" "+Zr[0]:G(bt/255)+" "+Zr[0];else if(Lr===void 0||po(Lr)==="object"){if(Lr&&!isNaN(Lr.a)&&Lr.a===0)return["1.","1.","1.",Zr[1]].join(" ");We=typeof bt=="string"?[bt,Bt,sr,Zr[1]].join(" "):ue.precision===2?[ee(bt/255),ee(Bt/255),ee(sr/255),Zr[1]].join(" "):[G(bt/255),G(Bt/255),G(sr/255),Zr[1]].join(" ")}else We=typeof bt=="string"?[bt,Bt,sr,Lr,Zr[2]].join(" "):ue.precision===2?[ee(bt),ee(Bt),ee(sr),ee(Lr),Zr[2]].join(" "):[G(bt),G(Bt),G(sr),G(Lr),Zr[2]].join(" ");return We},Bn=x.__private__.getFilters=function(){return s},ei=x.__private__.putStream=function(ue){var We=(ue=ue||{}).data||"",bt=ue.filters||Bn(),Bt=ue.alreadyAppliedFilters||[],sr=ue.addLength1||!1,Lr=We.length,Zr=ue.objectId,Nn=function(Si){return Si};if(d!==null&&Zr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Nn=Ba.encryptor(Zr,0));var qn={};bt===!0&&(bt=["FlateEncode"]);var Un=ue.additionalKeyValues||[],ui=(qn=di.API.processDataByFilters!==void 0?di.API.processDataByFilters(We,bt):{data:We,reverseChain:[]}).reverseChain+(Array.isArray(Bt)?Bt.join(" "):Bt.toString());if(qn.data.length!==0&&(Un.push({key:"Length",value:qn.data.length}),sr===!0&&Un.push({key:"Length1",value:Lr})),ui.length!=0)if(ui.split("/").length-1==1)Un.push({key:"Filter",value:ui});else{Un.push({key:"Filter",value:"["+ui+"]"});for(var Hn=0;Hn<Un.length;Hn+=1)if(Un[Hn].key==="DecodeParms"){for(var Ui=[],Xi=0;Xi<qn.reverseChain.split("/").length-1;Xi+=1)Ui.push("null");Ui.push(Un[Hn].value),Un[Hn].value="["+Ui.join(" ")+"]"}}$e("<<");for(var ra=0;ra<Un.length;ra++)$e("/"+Un[ra].key+" "+Un[ra].value);$e(">>"),qn.data.length!==0&&($e("stream"),$e(Nn(qn.data)),$e("endstream"))},ua=x.__private__.putPage=function(ue){var We=ue.number,bt=ue.data,Bt=ue.objId,sr=ue.contentsObjId;Xr(Bt,!0),$e("<</Type /Page"),$e("/Parent "+ue.rootDictionaryObjId+" 0 R"),$e("/Resources "+ue.resourceDictionaryObjId+" 0 R"),$e("/MediaBox ["+parseFloat(W(ue.mediaBox.bottomLeftX))+" "+parseFloat(W(ue.mediaBox.bottomLeftY))+" "+W(ue.mediaBox.topRightX)+" "+W(ue.mediaBox.topRightY)+"]"),ue.cropBox!==null&&$e("/CropBox ["+W(ue.cropBox.bottomLeftX)+" "+W(ue.cropBox.bottomLeftY)+" "+W(ue.cropBox.topRightX)+" "+W(ue.cropBox.topRightY)+"]"),ue.bleedBox!==null&&$e("/BleedBox ["+W(ue.bleedBox.bottomLeftX)+" "+W(ue.bleedBox.bottomLeftY)+" "+W(ue.bleedBox.topRightX)+" "+W(ue.bleedBox.topRightY)+"]"),ue.trimBox!==null&&$e("/TrimBox ["+W(ue.trimBox.bottomLeftX)+" "+W(ue.trimBox.bottomLeftY)+" "+W(ue.trimBox.topRightX)+" "+W(ue.trimBox.topRightY)+"]"),ue.artBox!==null&&$e("/ArtBox ["+W(ue.artBox.bottomLeftX)+" "+W(ue.artBox.bottomLeftY)+" "+W(ue.artBox.topRightX)+" "+W(ue.artBox.topRightY)+"]"),typeof ue.userUnit=="number"&&ue.userUnit!==1&&$e("/UserUnit "+ue.userUnit),en.publish("putPage",{objId:Bt,pageContext:Rt[We],pageNumber:We,page:bt}),$e("/Contents "+sr+" 0 R"),$e(">>"),$e("endobj");var Lr=bt.join(`
`);return O===N&&(Lr+=`
Q`),Xr(sr,!0),ei({data:Lr,filters:Bn(),objectId:sr}),$e("endobj"),Bt},ha=x.__private__.putPages=function(){var ue,We,bt=[];for(ue=1;ue<=zr;ue++)Rt[ue].objId=Ut(),Rt[ue].contentsObjId=Ut();for(ue=1;ue<=zr;ue++)bt.push(ua({number:ue,data:it[ue],objId:Rt[ue].objId,contentsObjId:Rt[ue].contentsObjId,mediaBox:Rt[ue].mediaBox,cropBox:Rt[ue].cropBox,bleedBox:Rt[ue].bleedBox,trimBox:Rt[ue].trimBox,artBox:Rt[ue].artBox,userUnit:Rt[ue].userUnit,rootDictionaryObjId:Bi,resourceDictionaryObjId:Ci}));Xr(Bi,!0),$e("<</Type /Pages");var Bt="/Kids [";for(We=0;We<zr;We++)Bt+=bt[We]+" 0 R ";$e(Bt+"]"),$e("/Count "+zr),$e(">>"),$e("endobj"),en.publish("postPutPages")},zn=function(ue){en.publish("putFont",{font:ue,out:$e,newObject:Gt,putStream:ei}),ue.isAlreadyPutted!==!0&&(ue.objectNumber=Gt(),$e("<<"),$e("/Type /Font"),$e("/BaseFont /"+Lv(ue.postScriptName)),$e("/Subtype /Type1"),typeof ue.encoding=="string"&&$e("/Encoding /"+ue.encoding),$e("/FirstChar 32"),$e("/LastChar 255"),$e(">>"),$e("endobj"))},Na=function(ue){ue.objectNumber=Gt();var We=[];We.push({key:"Type",value:"/XObject"}),We.push({key:"Subtype",value:"/Form"}),We.push({key:"BBox",value:"["+[W(ue.x),W(ue.y),W(ue.x+ue.width),W(ue.y+ue.height)].join(" ")+"]"}),We.push({key:"Matrix",value:"["+ue.matrix.toString()+"]"});var bt=ue.pages[1].join(`
`);ei({data:bt,additionalKeyValues:We,objectId:ue.objectNumber}),$e("endobj")},Wi=function(ue,We){We||(We=21);var bt=Gt(),Bt=(function(Zr,Nn){var qn,Un=[],ui=1/(Nn-1);for(qn=0;qn<1;qn+=ui)Un.push(qn);if(Un.push(1),Zr[0].offset!=0){var Hn={offset:0,color:Zr[0].color};Zr.unshift(Hn)}if(Zr[Zr.length-1].offset!=1){var Ui={offset:1,color:Zr[Zr.length-1].color};Zr.push(Ui)}for(var Xi="",ra=0,Si=0;Si<Un.length;Si++){for(qn=Un[Si];qn>Zr[ra+1].offset;)ra++;var Ia=Zr[ra].offset,za=(qn-Ia)/(Zr[ra+1].offset-Ia),Gs=Zr[ra].color,ul=Zr[ra+1].color;Xi+=Ne(Math.round((1-za)*Gs[0]+za*ul[0]).toString(16))+Ne(Math.round((1-za)*Gs[1]+za*ul[1]).toString(16))+Ne(Math.round((1-za)*Gs[2]+za*ul[2]).toString(16))}return Xi.trim()})(ue.colors,We),sr=[];sr.push({key:"FunctionType",value:"0"}),sr.push({key:"Domain",value:"[0.0 1.0]"}),sr.push({key:"Size",value:"["+We+"]"}),sr.push({key:"BitsPerSample",value:"8"}),sr.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),sr.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ei({data:Bt,additionalKeyValues:sr,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:bt}),$e("endobj"),ue.objectNumber=Gt(),$e("<< /ShadingType "+ue.type),$e("/ColorSpace /DeviceRGB");var Lr="/Coords ["+W(parseFloat(ue.coords[0]))+" "+W(parseFloat(ue.coords[1]))+" ";ue.type===2?Lr+=W(parseFloat(ue.coords[2]))+" "+W(parseFloat(ue.coords[3])):Lr+=W(parseFloat(ue.coords[2]))+" "+W(parseFloat(ue.coords[3]))+" "+W(parseFloat(ue.coords[4]))+" "+W(parseFloat(ue.coords[5])),$e(Lr+="]"),ue.matrix&&$e("/Matrix ["+ue.matrix.toString()+"]"),$e("/Function "+bt+" 0 R"),$e("/Extend [true true]"),$e(">>"),$e("endobj")},ds=function(ue,We){var bt=Ut(),Bt=Gt();We.push({resourcesOid:bt,objectOid:Bt}),ue.objectNumber=Bt;var sr=[];sr.push({key:"Type",value:"/Pattern"}),sr.push({key:"PatternType",value:"1"}),sr.push({key:"PaintType",value:"1"}),sr.push({key:"TilingType",value:"1"}),sr.push({key:"BBox",value:"["+ue.boundingBox.map(W).join(" ")+"]"}),sr.push({key:"XStep",value:W(ue.xStep)}),sr.push({key:"YStep",value:W(ue.yStep)}),sr.push({key:"Resources",value:bt+" 0 R"}),ue.matrix&&sr.push({key:"Matrix",value:"["+ue.matrix.toString()+"]"}),ei({data:ue.stream,additionalKeyValues:sr,objectId:ue.objectNumber}),$e("endobj")},Ca=function(ue){for(var We in ue.objectNumber=Gt(),$e("<<"),ue)switch(We){case"opacity":$e("/ca "+ee(ue[We]));break;case"stroke-opacity":$e("/CA "+ee(ue[We]))}$e(">>"),$e("endobj")},Do=function(ue){Xr(ue.resourcesOid,!0),$e("<<"),$e("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var We in $e("/Font <<"),mt)mt.hasOwnProperty(We)&&(m===!1||m===!0&&b.hasOwnProperty(We))&&$e("/"+We+" "+mt[We].objectNumber+" 0 R");$e(">>")})(),(function(){if(Object.keys(qt).length>0){for(var We in $e("/Shading <<"),qt)qt.hasOwnProperty(We)&&qt[We]instanceof wm&&qt[We].objectNumber>=0&&$e("/"+We+" "+qt[We].objectNumber+" 0 R");en.publish("putShadingPatternDict"),$e(">>")}})(),(function(We){if(Object.keys(qt).length>0){for(var bt in $e("/Pattern <<"),qt)qt.hasOwnProperty(bt)&&qt[bt]instanceof x.TilingPattern&&qt[bt].objectNumber>=0&&qt[bt].objectNumber<We&&$e("/"+bt+" "+qt[bt].objectNumber+" 0 R");en.publish("putTilingPatternDict"),$e(">>")}})(ue.objectOid),(function(){if(Object.keys(Ar).length>0){var We;for(We in $e("/ExtGState <<"),Ar)Ar.hasOwnProperty(We)&&Ar[We].objectNumber>=0&&$e("/"+We+" "+Ar[We].objectNumber+" 0 R");en.publish("putGStateDict"),$e(">>")}})(),(function(){for(var We in $e("/XObject <<"),Qr)Qr.hasOwnProperty(We)&&Qr[We].objectNumber>=0&&$e("/"+We+" "+Qr[We].objectNumber+" 0 R");en.publish("putXobjectDict"),$e(">>")})(),$e(">>"),$e("endobj")},Ya=function(ue){ct[ue.fontName]=ct[ue.fontName]||{},ct[ue.fontName][ue.fontStyle]=ue.id},sl=function(ue,We,bt,Bt,sr){var Lr={id:"F"+(Object.keys(mt).length+1).toString(10),postScriptName:ue,fontName:We,fontStyle:bt,encoding:Bt,isStandardFont:sr||!1,metadata:{}};return en.publish("addFont",{font:Lr,instance:this}),mt[Lr.id]=Lr,Ya(Lr),Lr.id},xi=x.__private__.pdfEscape=x.pdfEscape=function(ue,We){return(function(bt,Bt){var sr,Lr,Zr,Nn,qn,Un,ui,Hn,Ui;if(Zr=(Bt=Bt||{}).sourceEncoding||"Unicode",qn=Bt.outputEncoding,(Bt.autoencode||qn)&&mt[je].metadata&&mt[je].metadata[Zr]&&mt[je].metadata[Zr].encoding&&(Nn=mt[je].metadata[Zr].encoding,!qn&&mt[je].encoding&&(qn=mt[je].encoding),!qn&&Nn.codePages&&(qn=Nn.codePages[0]),typeof qn=="string"&&(qn=Nn[qn]),qn)){for(ui=!1,Un=[],sr=0,Lr=bt.length;sr<Lr;sr++)(Hn=qn[bt.charCodeAt(sr)])?Un.push(String.fromCharCode(Hn)):Un.push(bt[sr]),Un[sr].charCodeAt(0)>>8&&(ui=!0);bt=Un.join("")}for(sr=bt.length;ui===void 0&&sr!==0;)bt.charCodeAt(sr-1)>>8&&(ui=!0),sr--;if(!ui)return bt;for(Un=Bt.noBOM?[]:[254,255],sr=0,Lr=bt.length;sr<Lr;sr++){if((Ui=(Hn=bt.charCodeAt(sr))>>8)>>8)throw new Error("Character at position "+sr+" of string '"+bt+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Un.push(Ui),Un.push(Hn-(Ui<<8))}return String.fromCharCode.apply(void 0,Un)})(ue,We).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zi=x.__private__.beginPage=function(ue){it[++zr]=[],Rt[zr]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(ue[0]),topRightY:Number(ue[1])}},Za(zr),st(it[Ee])},Iu=function(ue,We){var bt,Bt,sr;switch(r=We||r,typeof ue=="string"&&(bt=R(ue.toLowerCase()),Array.isArray(bt)&&(Bt=bt[0],sr=bt[1])),Array.isArray(ue)&&(Bt=ue[0]*qe,sr=ue[1]*qe),isNaN(Bt)&&(Bt=i[0],sr=i[1]),(Bt>14400||sr>14400)&&(Ro.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Bt=Math.min(14400,Bt),sr=Math.min(14400,sr)),i=[Bt,sr],r.substr(0,1)){case"l":sr>Bt&&(i=[sr,Bt]);break;case"p":Bt>sr&&(i=[sr,Bt])}zi(i),Rr($n),$e(Cs),Ka!==0&&$e(Ka+" J"),qs!==0&&$e(qs+" j"),en.publish("addPage",{pageNumber:zr})},ma=function(ue){ue>0&&ue<=zr&&(it.splice(ue,1),Rt.splice(ue,1),zr--,Ee>zr&&(Ee=zr),this.setPage(Ee))},Za=function(ue){ue>0&&ue<=zr&&(Ee=ue)},ps=x.__private__.getNumberOfPages=x.getNumberOfPages=function(){return it.length-1},Aa=function(ue,We,bt){var Bt,sr=void 0;return bt=bt||{},ue=ue!==void 0?ue:mt[je].fontName,We=We!==void 0?We:mt[je].fontStyle,Bt=ue.toLowerCase(),ct[Bt]!==void 0&&ct[Bt][We]!==void 0?sr=ct[Bt][We]:ct[ue]!==void 0&&ct[ue][We]!==void 0?sr=ct[ue][We]:bt.disableWarning===!1&&Ro.warn("Unable to look up font label for font '"+ue+"', '"+We+"'. Refer to getFontList() for available fonts."),sr||bt.noFallback||(sr=ct.times[We])==null&&(sr=ct.times.normal),sr},gs=x.__private__.putInfo=function(){var ue=Gt(),We=function(Bt){return Bt};for(var bt in d!==null&&(We=Ba.encryptor(ue,0)),$e("<<"),$e("/Producer ("+xi(We("jsPDF "+di.version))+")"),be)be.hasOwnProperty(bt)&&be[bt]&&$e("/"+bt.substr(0,1).toUpperCase()+bt.substr(1)+" ("+xi(We(be[bt]))+")");$e("/CreationDate ("+xi(We(fe))+")"),$e(">>"),$e("endobj")},Ul=x.__private__.putCatalog=function(ue){var We=(ue=ue||{}).rootDictionaryObjId||Bi;switch(Gt(),$e("<<"),$e("/Type /Catalog"),$e("/Pages "+We+" 0 R"),vr||(vr="fullwidth"),vr){case"fullwidth":$e("/OpenAction [3 0 R /FitH null]");break;case"fullheight":$e("/OpenAction [3 0 R /FitV null]");break;case"fullpage":$e("/OpenAction [3 0 R /Fit]");break;case"original":$e("/OpenAction [3 0 R /XYZ null null 1]");break;default:var bt=""+vr;bt.substr(bt.length-1)==="%"&&(vr=parseInt(vr)/100),typeof vr=="number"&&$e("/OpenAction [3 0 R /XYZ null null "+ee(vr)+"]")}switch(Qt||(Qt="continuous"),Qt){case"continuous":$e("/PageLayout /OneColumn");break;case"single":$e("/PageLayout /SinglePage");break;case"two":case"twoleft":$e("/PageLayout /TwoColumnLeft");break;case"tworight":$e("/PageLayout /TwoColumnRight")}Cr&&$e("/PageMode /"+Cr),en.publish("putCatalog"),$e(">>"),$e("endobj")},Fa=x.__private__.putTrailer=function(){$e("trailer"),$e("<<"),$e("/Size "+(Fe+1)),$e("/Root "+Fe+" 0 R"),$e("/Info "+(Fe-1)+" 0 R"),d!==null&&$e("/Encrypt "+Ba.oid+" 0 R"),$e("/ID [ <"+pe+"> <"+pe+"> ]"),$e(">>")},_a=x.__private__.putHeader=function(){$e("%PDF-"+E),$e("%")},xc=x.__private__.putXRef=function(){var ue="0000000000";$e("xref"),$e("0 "+(Fe+1)),$e("0000000000 65535 f ");for(var We=1;We<=Fe;We++)typeof Xe[We]=="function"?$e((ue+Xe[We]()).slice(-10)+" 00000 n "):Xe[We]!==void 0?$e((ue+Xe[We]).slice(-10)+" 00000 n "):$e("0000000000 00000 n ")},ll=x.__private__.buildDocument=function(){var ue;Fe=0,ot=0,Be=[],Xe=[],Ke=[],Bi=Ut(),Ci=Ut(),st(Be),en.publish("buildDocument"),_a(),ha(),(function(){en.publish("putAdditionalObjects");for(var bt=0;bt<Ke.length;bt++){var Bt=Ke[bt];Xr(Bt.objId,!0),$e(Bt.content),$e("endobj")}en.publish("postPutAdditionalObjects")})(),ue=[],(function(){for(var bt in mt)mt.hasOwnProperty(bt)&&(m===!1||m===!0&&b.hasOwnProperty(bt))&&zn(mt[bt])})(),(function(){var bt;for(bt in Ar)Ar.hasOwnProperty(bt)&&Ca(Ar[bt])})(),(function(){for(var bt in Qr)Qr.hasOwnProperty(bt)&&Na(Qr[bt])})(),(function(bt){var Bt;for(Bt in qt)qt.hasOwnProperty(Bt)&&(qt[Bt]instanceof wm?Wi(qt[Bt]):qt[Bt]instanceof n0&&ds(qt[Bt],bt))})(ue),en.publish("putResources"),ue.forEach(Do),Do({resourcesOid:Ci,objectOid:Number.MAX_SAFE_INTEGER}),en.publish("postPutResources"),d!==null&&(Ba.oid=Gt(),$e("<<"),$e("/Filter /Standard"),$e("/V "+Ba.v),$e("/R "+Ba.r),$e("/U <"+Ba.toHexString(Ba.U)+">"),$e("/O <"+Ba.toHexString(Ba.O)+">"),$e("/P "+Ba.P),$e(">>"),$e("endobj")),gs(),Ul();var We=ot;return xc(),Fa(),$e("startxref"),$e(""+We),$e("%%EOF"),st(it[Ee]),Be.join(`
`)},rs=x.__private__.getBlob=function(ue){return new Blob([Ht(ue)],{type:"application/pdf"})},so=x.output=x.__private__.output=(Tt=function(ue,We){switch(typeof(We=We||{})=="string"?We={filename:We}:We.filename=We.filename||"generated.pdf",ue){case void 0:return ll();case"save":x.save(We.filename);break;case"arraybuffer":return Ht(ll());case"blob":return rs(ll());case"bloburi":case"bloburl":if(Oi.URL!==void 0&&typeof Oi.URL.createObjectURL=="function")return Oi.URL&&Oi.URL.createObjectURL(rs(ll()))||void 0;Ro.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var bt="",Bt=ll();try{bt=e9(Bt)}catch{bt=e9(unescape(encodeURIComponent(Bt)))}return"data:application/pdf;filename="+We.filename+";base64,"+bt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Oi)==="[object Window]"){var sr="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Lr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';We.pdfObjectUrl&&(sr=We.pdfObjectUrl,Lr="");var Zr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+sr+'"'+Lr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(We)+");<\/script></body></html>",Nn=Oi.open();return Nn!==null&&Nn.document.write(Zr),Nn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Oi)==="[object Window]"){var qn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(We.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+We.filename+'" width="500px" height="400px" /></body></html>',Un=Oi.open();if(Un!==null){Un.document.write(qn);var ui=this;Un.document.documentElement.querySelector("#pdfViewer").onload=function(){Un.document.title=We.filename,Un.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ui.output("bloburl"))}}return Un}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Oi)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Hn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",We)+'"></iframe></body></html>',Ui=Oi.open();if(Ui!==null&&(Ui.document.write(Hn),Ui.document.title=We.filename),Ui||typeof safari>"u")return Ui;break;case"datauri":case"dataurl":return Oi.document.location.href=this.output("datauristring",We);default:return null}},Tt.foo=function(){try{return Tt.apply(this,arguments)}catch(bt){var ue=bt.stack||"";~ue.indexOf(" at ")&&(ue=ue.split(" at ")[1]);var We="Error in function "+ue.split(`
`)[0].split("<")[0]+": "+bt.message;if(!Oi.console)throw new Error(We);Oi.console.error(We,bt),Oi.alert&&alert(We)}},Tt.foo.bar=Tt,Tt.foo),ns=function(ue){return Array.isArray(jn)===!0&&jn.indexOf(ue)>-1};switch(n){case"pt":qe=1;break;case"mm":qe=72/25.4;break;case"cm":qe=72/2.54;break;case"in":qe=72;break;case"px":qe=ns("px_scaling")==1?.75:96/72;break;case"pc":case"em":qe=12;break;case"ex":qe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);qe=n}var Ba=null;Re(),ye();var Vs=x.__private__.getPageInfo=x.getPageInfo=function(ue){if(isNaN(ue)||ue%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Rt[ue].objId,pageNumber:ue,pageContext:Rt[ue]}},Uc=x.__private__.getPageInfoByObjId=function(ue){if(isNaN(ue)||ue%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var We in Rt)if(Rt[We].objId===ue)break;return Vs(We)},Pu=x.__private__.getCurrentPageInfo=x.getCurrentPageInfo=function(){return{objId:Rt[Ee].objId,pageNumber:Ee,pageContext:Rt[Ee]}};x.addPage=function(){return Iu.apply(this,arguments),this},x.setPage=function(){return Za.apply(this,arguments),st.call(this,it[Ee]),this},x.insertPage=function(ue){return this.addPage(),this.movePage(Ee,ue),this},x.movePage=function(ue,We){var bt,Bt;if(ue>We){bt=it[ue],Bt=Rt[ue];for(var sr=ue;sr>We;sr--)it[sr]=it[sr-1],Rt[sr]=Rt[sr-1];it[We]=bt,Rt[We]=Bt,this.setPage(We)}else if(ue<We){bt=it[ue],Bt=Rt[ue];for(var Lr=ue;Lr<We;Lr++)it[Lr]=it[Lr+1],Rt[Lr]=Rt[Lr+1];it[We]=bt,Rt[We]=Bt,this.setPage(We)}return this},x.deletePage=function(){return ma.apply(this,arguments),this},x.__private__.text=x.text=function(ue,We,bt,Bt,sr){var Lr,Zr,Nn,qn,Un,ui,Hn,Ui,Xi,ra=(Bt=Bt||{}).scope||this;if(typeof ue=="number"&&typeof We=="number"&&(typeof bt=="string"||Array.isArray(bt))){var Si=bt;bt=We,We=ue,ue=Si}if(arguments[3]instanceof ln==0?(Nn=arguments[4],qn=arguments[5],po(Hn=arguments[3])==="object"&&Hn!==null||(typeof Nn=="string"&&(qn=Nn,Nn=null),typeof Hn=="string"&&(qn=Hn,Hn=null),typeof Hn=="number"&&(Nn=Hn,Hn=null),Bt={flags:Hn,angle:Nn,align:qn})):(X("The transform parameter of text() with a Matrix value"),Xi=sr),isNaN(We)||isNaN(bt)||ue==null)throw new Error("Invalid arguments passed to jsPDF.text");if(ue.length===0)return ra;var Ia,za="",Gs=typeof Bt.lineHeightFactor=="number"?Bt.lineHeightFactor:ki,ul=ra.internal.scaleFactor;function Ws(Pn){return Pn=Pn.split("	").join(Array(Bt.TabLen||9).join(" ")),xi(Pn,Hn)}function $o(Pn){for(var I,y=Pn.concat(),_=[],P=y.length;P--;)typeof(I=y.shift())=="string"?_.push(I):Array.isArray(Pn)&&(I.length===1||I[1]===void 0&&I[2]===void 0)?_.push(I[0]):_.push([I[0],I[1],I[2]]);return _}function Xs(Pn,I){var y;if(typeof Pn=="string")y=I(Pn)[0];else if(Array.isArray(Pn)){for(var _,P,$=Pn.concat(),ne=[],ve=$.length;ve--;)typeof(_=$.shift())=="string"?ne.push(I(_)[0]):Array.isArray(_)&&typeof _[0]=="string"&&(P=I(_[0],_[1],_[2]),ne.push([P[0],P[1],P[2]]));y=ne}return y}var Pa=!1,Ys=!0;if(typeof ue=="string")Pa=!0;else if(Array.isArray(ue)){var Il=ue.concat();Zr=[];for(var ms,Di=Il.length;Di--;)(typeof(ms=Il.shift())!="string"||Array.isArray(ms)&&typeof ms[0]!="string")&&(Ys=!1);Pa=Ys}if(Pa===!1)throw new Error('Type of text must be string or Array. "'+ue+'" is not recognized.');typeof ue=="string"&&(ue=ue.match(/[\r?\n]/)?ue.split(/\r\n|\r|\n/g):[ue]);var qo=_t/ra.internal.scaleFactor,Da=qo*(Gs-1);switch(Bt.baseline){case"bottom":bt-=Da;break;case"top":bt+=qo-Da;break;case"hanging":bt+=qo-2*Da;break;case"middle":bt+=qo/2-Da}if((ui=Bt.maxWidth||0)>0&&(typeof ue=="string"?ue=ra.splitTextToSize(ue,ui):Object.prototype.toString.call(ue)==="[object Array]"&&(ue=ue.reduce(function(Pn,I){return Pn.concat(ra.splitTextToSize(I,ui))},[]))),Lr={text:ue,x:We,y:bt,options:Bt,mutex:{pdfEscape:xi,activeFontKey:je,fonts:mt,activeFontSize:_t}},en.publish("preProcessText",Lr),ue=Lr.text,Nn=(Bt=Lr.options).angle,Xi instanceof ln==0&&Nn&&typeof Nn=="number"){Nn*=Math.PI/180,Bt.rotationDirection===0&&(Nn=-Nn),O===N&&(Nn=-Nn);var is=Math.cos(Nn),Is=Math.sin(Nn);Xi=new ln(is,Is,-Is,is,0,0)}else Nn&&Nn instanceof ln&&(Xi=Nn);O!==N||Xi||(Xi=ke),(Un=Bt.charSpace||oa)!==void 0&&(za+=W(ae(Un))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ui=Bt.horizontalScale)!==void 0&&(za+=W(100*Ui)+` Tz
`),Bt.lang;var Ja=-1,nc=Bt.renderingMode!==void 0?Bt.renderingMode:Bt.stroke,uu=ra.internal.getCurrentPageInfo().pageContext;switch(nc){case 0:case!1:case"fill":Ja=0;break;case 1:case!0:case"stroke":Ja=1;break;case 2:case"fillThenStroke":Ja=2;break;case 3:case"invisible":Ja=3;break;case 4:case"fillAndAddForClipping":Ja=4;break;case 5:case"strokeAndAddPathForClipping":Ja=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ja=6;break;case 7:case"addToPathForClipping":Ja=7}var Zs=uu.usedRenderingMode!==void 0?uu.usedRenderingMode:-1;Ja!==-1?za+=Ja+` Tr
`:Zs!==-1&&(za+=`0 Tr
`),Ja!==-1&&(uu.usedRenderingMode=Ja),qn=Bt.align||"left";var ja,Ps=_t*Gs,ic=ra.internal.pageSize.getWidth(),ac=mt[je];Un=Bt.charSpace||oa,ui=Bt.maxWidth||0,Hn=Object.assign({autoencode:!0,noBOM:!0},Bt.flags);var cl=[],cu=function(Pn){return ra.getStringUnitWidth(Pn,{font:ac,charSpace:Un,fontSize:_t,doKerning:!1})*_t/ul};if(Object.prototype.toString.call(ue)==="[object Array]"){var Lo;Zr=$o(ue),qn!=="left"&&(ja=Zr.map(cu));var mo,Du=0;if(qn==="right"){We-=ja[0],ue=[],Di=Zr.length;for(var Ua=0;Ua<Di;Ua++)Ua===0?(mo=$i(We),Lo=ba(bt)):(mo=ae(Du-ja[Ua]),Lo=-Ps),ue.push([Zr[Ua],mo,Lo]),Du=ja[Ua]}else if(qn==="center"){We-=ja[0]/2,ue=[],Di=Zr.length;for(var fu=0;fu<Di;fu++)fu===0?(mo=$i(We),Lo=ba(bt)):(mo=ae((Du-ja[fu])/2),Lo=-Ps),ue.push([Zr[fu],mo,Lo]),Du=ja[fu]}else if(qn==="left"){ue=[],Di=Zr.length;for(var Ks=0;Ks<Di;Ks++)ue.push(Zr[Ks])}else if(qn==="justify"&&ac.encoding==="Identity-H"){ue=[],Di=Zr.length,ui=ui!==0?ui:ic;for(var ys=0,Va=0;Va<Di;Va++)if(Lo=Va===0?ba(bt):-Ps,mo=Va===0?$i(We):ys,Va<Di-1){var Vl=ae((ui-ja[Va])/(Zr[Va].split(" ").length-1)),fl=Zr[Va].split(" ");ue.push([fl[0]+" ",mo,Lo]),ys=0;for(var hl=1;hl<fl.length;hl++){var $l=(cu(fl[hl-1]+" "+fl[hl])-cu(fl[hl]))*ul+Vl;hl==fl.length-1?ue.push([fl[hl],$l,0]):ue.push([fl[hl]+" ",$l,0]),ys-=$l}}else ue.push([Zr[Va],mo,Lo]);ue.push(["",ys,0])}else{if(qn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(ue=[],Di=Zr.length,ui=ui!==0?ui:ic,Va=0;Va<Di;Va++)Lo=Va===0?ba(bt):-Ps,mo=Va===0?$i(We):0,Va<Di-1?cl.push(W(ae((ui-ja[Va])/(Zr[Va].split(" ").length-1)))):cl.push(0),ue.push([Zr[Va],mo,Lo])}}(typeof Bt.R2L=="boolean"?Bt.R2L:lr)===!0&&(ue=Xs(ue,function(Pn,I,y){return[Pn.split("").reverse().join(""),I,y]})),Lr={text:ue,x:We,y:bt,options:Bt,mutex:{pdfEscape:xi,activeFontKey:je,fonts:mt,activeFontSize:_t}},en.publish("postProcessText",Lr),ue=Lr.text,Ia=Lr.mutex.isHex||!1;var ql=mt[je].encoding;ql!=="WinAnsiEncoding"&&ql!=="StandardEncoding"||(ue=Xs(ue,function(Pn,I,y){return[Ws(Pn),I,y]})),Zr=$o(ue),ue=[];for(var dl,Hl,Ou,tr=Array.isArray(Zr[0])?1:0,mr="",hn=function(Pn,I,y){var _="";return y instanceof ln?(y=typeof Bt.angle=="number"?Kn(y,new ln(1,0,0,1,Pn,I)):Kn(new ln(1,0,0,1,Pn,I),y),O===N&&(y=Kn(new ln(1,0,0,-1,0,0),y)),_=y.join(" ")+` Tm
`):_=W(Pn)+" "+W(I)+` Td
`,_},In=0;In<Zr.length;In++){switch(mr="",tr){case 1:Ou=(Ia?"<":"(")+Zr[In][0]+(Ia?">":")"),dl=parseFloat(Zr[In][1]),Hl=parseFloat(Zr[In][2]);break;case 0:Ou=(Ia?"<":"(")+Zr[In]+(Ia?">":")"),dl=$i(We),Hl=ba(bt)}cl!==void 0&&cl[In]!==void 0&&(mr=cl[In]+` Tw
`),In===0?ue.push(mr+hn(dl,Hl,Xi)+Ou):tr===0?ue.push(mr+Ou):tr===1&&ue.push(mr+hn(dl,Hl,Xi)+Ou)}ue=tr===0?ue.join(` Tj
T* `):ue.join(` Tj
`),ue+=` Tj
`;var vi=`BT
/`;return vi+=je+" "+_t+` Tf
`,vi+=W(_t*Gs)+` TL
`,vi+=Ri+`
`,vi+=za,vi+=ue,$e(vi+="ET"),b[je]=!0,ra};var Q=x.__private__.clip=x.clip=function(ue){return $e(ue==="evenodd"?"W*":"W"),this};x.clipEvenOdd=function(){return Q("evenodd")},x.__private__.discardPath=x.discardPath=function(){return $e("n"),this};var ge=x.__private__.isValidStyle=function(ue){var We=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(ue)!==-1&&(We=!0),We};x.__private__.setDefaultPathOperation=x.setDefaultPathOperation=function(ue){return ge(ue)&&(f=ue),this};var Je=x.__private__.getStyle=x.getStyle=function(ue){var We=f;switch(ue){case"D":case"S":We="S";break;case"F":We="f";break;case"FD":case"DF":We="B";break;case"f":case"f*":case"B":case"B*":We=ue}return We},It=x.close=function(){return $e("h"),this};x.stroke=function(){return $e("S"),this},x.fill=function(ue){return Vt("f",ue),this},x.fillEvenOdd=function(ue){return Vt("f*",ue),this},x.fillStroke=function(ue){return Vt("B",ue),this},x.fillStrokeEvenOdd=function(ue){return Vt("B*",ue),this};var Vt=function(ue,We){po(We)==="object"?Yr(We,ue):$e(ue)},$t=function(ue){ue===null||O===N&&ue===void 0||(ue=Je(ue),$e(ue))};function er(ue,We,bt,Bt,sr){var Lr=new n0(We||this.boundingBox,bt||this.xStep,Bt||this.yStep,this.gState,sr||this.matrix);Lr.stream=this.stream;var Zr=ue+"$$"+this.cloneIndex+++"$$";return He(Zr,Lr),Lr}var Yr=function(ue,We){var bt=Ir[ue.key],Bt=qt[bt];if(Bt instanceof wm)$e("q"),$e(tn(We)),Bt.gState&&x.setGState(Bt.gState),$e(ue.matrix.toString()+" cm"),$e("/"+bt+" sh"),$e("Q");else if(Bt instanceof n0){var sr=new ln(1,0,0,-1,0,Oo());ue.matrix&&(sr=sr.multiply(ue.matrix||ke),bt=er.call(Bt,ue.key,ue.boundingBox,ue.xStep,ue.yStep,sr).id),$e("q"),$e("/Pattern cs"),$e("/"+bt+" scn"),Bt.gState&&x.setGState(Bt.gState),$e(We),$e("Q")}},tn=function(ue){switch(ue){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Gr=x.moveTo=function(ue,We){return $e(W(ae(ue))+" "+W(se(We))+" m"),this},an=x.lineTo=function(ue,We){return $e(W(ae(ue))+" "+W(se(We))+" l"),this},Mr=x.curveTo=function(ue,We,bt,Bt,sr,Lr){return $e([W(ae(ue)),W(se(We)),W(ae(bt)),W(se(Bt)),W(ae(sr)),W(se(Lr)),"c"].join(" ")),this};x.__private__.line=x.line=function(ue,We,bt,Bt,sr){if(isNaN(ue)||isNaN(We)||isNaN(bt)||isNaN(Bt)||!ge(sr))throw new Error("Invalid arguments passed to jsPDF.line");return O===F?this.lines([[bt-ue,Bt-We]],ue,We,[1,1],sr||"S"):this.lines([[bt-ue,Bt-We]],ue,We,[1,1]).stroke()},x.__private__.lines=x.lines=function(ue,We,bt,Bt,sr,Lr){var Zr,Nn,qn,Un,ui,Hn,Ui,Xi,ra,Si,Ia,za;if(typeof ue=="number"&&(za=bt,bt=We,We=ue,ue=za),Bt=Bt||[1,1],Lr=Lr||!1,isNaN(We)||isNaN(bt)||!Array.isArray(ue)||!Array.isArray(Bt)||!ge(sr)||typeof Lr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Gr(We,bt),Zr=Bt[0],Nn=Bt[1],Un=ue.length,Si=We,Ia=bt,qn=0;qn<Un;qn++)(ui=ue[qn]).length===2?(Si=ui[0]*Zr+Si,Ia=ui[1]*Nn+Ia,an(Si,Ia)):(Hn=ui[0]*Zr+Si,Ui=ui[1]*Nn+Ia,Xi=ui[2]*Zr+Si,ra=ui[3]*Nn+Ia,Si=ui[4]*Zr+Si,Ia=ui[5]*Nn+Ia,Mr(Hn,Ui,Xi,ra,Si,Ia));return Lr&&It(),$t(sr),this},x.path=function(ue){for(var We=0;We<ue.length;We++){var bt=ue[We],Bt=bt.c;switch(bt.op){case"m":Gr(Bt[0],Bt[1]);break;case"l":an(Bt[0],Bt[1]);break;case"c":Mr.apply(this,Bt);break;case"h":It()}}return this},x.__private__.rect=x.rect=function(ue,We,bt,Bt,sr){if(isNaN(ue)||isNaN(We)||isNaN(bt)||isNaN(Bt)||!ge(sr))throw new Error("Invalid arguments passed to jsPDF.rect");return O===F&&(Bt=-Bt),$e([W(ae(ue)),W(se(We)),W(ae(bt)),W(ae(Bt)),"re"].join(" ")),$t(sr),this},x.__private__.triangle=x.triangle=function(ue,We,bt,Bt,sr,Lr,Zr){if(isNaN(ue)||isNaN(We)||isNaN(bt)||isNaN(Bt)||isNaN(sr)||isNaN(Lr)||!ge(Zr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[bt-ue,Bt-We],[sr-bt,Lr-Bt],[ue-sr,We-Lr]],ue,We,[1,1],Zr,!0),this},x.__private__.roundedRect=x.roundedRect=function(ue,We,bt,Bt,sr,Lr,Zr){if(isNaN(ue)||isNaN(We)||isNaN(bt)||isNaN(Bt)||isNaN(sr)||isNaN(Lr)||!ge(Zr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Nn=4/3*(Math.SQRT2-1);return sr=Math.min(sr,.5*bt),Lr=Math.min(Lr,.5*Bt),this.lines([[bt-2*sr,0],[sr*Nn,0,sr,Lr-Lr*Nn,sr,Lr],[0,Bt-2*Lr],[0,Lr*Nn,-sr*Nn,Lr,-sr,Lr],[2*sr-bt,0],[-sr*Nn,0,-sr,-Lr*Nn,-sr,-Lr],[0,2*Lr-Bt],[0,-Lr*Nn,sr*Nn,-Lr,sr,-Lr]],ue+sr,We,[1,1],Zr,!0),this},x.__private__.ellipse=x.ellipse=function(ue,We,bt,Bt,sr){if(isNaN(ue)||isNaN(We)||isNaN(bt)||isNaN(Bt)||!ge(sr))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Lr=4/3*(Math.SQRT2-1)*bt,Zr=4/3*(Math.SQRT2-1)*Bt;return Gr(ue+bt,We),Mr(ue+bt,We-Zr,ue+Lr,We-Bt,ue,We-Bt),Mr(ue-Lr,We-Bt,ue-bt,We-Zr,ue-bt,We),Mr(ue-bt,We+Zr,ue-Lr,We+Bt,ue,We+Bt),Mr(ue+Lr,We+Bt,ue+bt,We+Zr,ue+bt,We),$t(sr),this},x.__private__.circle=x.circle=function(ue,We,bt,Bt){if(isNaN(ue)||isNaN(We)||isNaN(bt)||!ge(Bt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(ue,We,bt,bt,Bt)},x.setFont=function(ue,We,bt){return bt&&(We=H(We,bt)),je=Aa(ue,We,{disableWarning:!1}),this};var ti=x.__private__.getFont=x.getFont=function(){return mt[Aa.apply(x,arguments)]};x.__private__.getFontList=x.getFontList=function(){var ue,We,bt={};for(ue in ct)if(ct.hasOwnProperty(ue))for(We in bt[ue]=[],ct[ue])ct[ue].hasOwnProperty(We)&&bt[ue].push(We);return bt},x.addFont=function(ue,We,bt,Bt,sr){var Lr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Lr.indexOf(arguments[3])!==-1?sr=arguments[3]:arguments[3]&&Lr.indexOf(arguments[3])==-1&&(bt=H(bt,Bt)),sl.call(this,ue,We,bt,sr=sr||"Identity-H")};var ki,$n=t.lineWidth||.200025,_n=x.__private__.getLineWidth=x.getLineWidth=function(){return $n},Rr=x.__private__.setLineWidth=x.setLineWidth=function(ue){return $n=ue,$e(W(ae(ue))+" w"),this};x.__private__.setLineDash=di.API.setLineDash=di.API.setLineDashPattern=function(ue,We){if(ue=ue||[],We=We||0,isNaN(We)||!Array.isArray(ue))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return ue=ue.map(function(bt){return W(ae(bt))}).join(" "),We=W(ae(We)),$e("["+ue+"] "+We+" d"),this};var fn=x.__private__.getLineHeight=x.getLineHeight=function(){return _t*ki};x.__private__.getLineHeight=x.getLineHeight=function(){return _t*ki};var mn=x.__private__.setLineHeightFactor=x.setLineHeightFactor=function(ue){return typeof(ue=ue||1.15)=="number"&&(ki=ue),this},fi=x.__private__.getLineHeightFactor=x.getLineHeightFactor=function(){return ki};mn(t.lineHeight);var $i=x.__private__.getHorizontalCoordinate=function(ue){return ae(ue)},ba=x.__private__.getVerticalCoordinate=function(ue){return O===N?ue:Rt[Ee].mediaBox.topRightY-Rt[Ee].mediaBox.bottomLeftY-ae(ue)},wi=x.__private__.getHorizontalCoordinateString=x.getHorizontalCoordinateString=function(ue){return W($i(ue))},hi=x.__private__.getVerticalCoordinateString=x.getVerticalCoordinateString=function(ue){return W(ba(ue))},Cs=t.strokeColor||"0 G";x.__private__.getStrokeColor=x.getDrawColor=function(){return Fr(Cs)},x.__private__.setStrokeColor=x.setDrawColor=function(ue,We,bt,Bt){return Cs=Rn({ch1:ue,ch2:We,ch3:bt,ch4:Bt,pdfColorType:"draw",precision:2}),$e(Cs),this};var $s=t.fillColor||"0 g";x.__private__.getFillColor=x.getFillColor=function(){return Fr($s)},x.__private__.setFillColor=x.setFillColor=function(ue,We,bt,Bt){return $s=Rn({ch1:ue,ch2:We,ch3:bt,ch4:Bt,pdfColorType:"fill",precision:2}),$e($s),this};var Ri=t.textColor||"0 g",As=x.__private__.getTextColor=x.getTextColor=function(){return Fr(Ri)};x.__private__.setTextColor=x.setTextColor=function(ue,We,bt,Bt){return Ri=Rn({ch1:ue,ch2:We,ch3:bt,ch4:Bt,pdfColorType:"text",precision:3}),this};var oa=t.charSpace,Mu=x.__private__.getCharSpace=x.getCharSpace=function(){return parseFloat(oa||0)};x.__private__.setCharSpace=x.setCharSpace=function(ue){if(isNaN(ue))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return oa=ue,this};var Ka=0;x.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},x.__private__.setLineCap=x.setLineCap=function(ue){var We=x.CapJoinStyles[ue];if(We===void 0)throw new Error("Line cap style of '"+ue+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ka=We,$e(We+" J"),this};var qs=0;x.__private__.setLineJoin=x.setLineJoin=function(ue){var We=x.CapJoinStyles[ue];if(We===void 0)throw new Error("Line join style of '"+ue+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return qs=We,$e(We+" j"),this},x.__private__.setLineMiterLimit=x.__private__.setMiterLimit=x.setLineMiterLimit=x.setMiterLimit=function(ue){if(ue=ue||0,isNaN(ue))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return $e(W(ae(ue))+" M"),this},x.GState=XS,x.setGState=function(ue){(ue=typeof ue=="string"?Ar[$r[ue]]:Vo(null,ue)).equals(cn)||($e("/"+ue.id+" gs"),cn=ue)};var Vo=function(ue,We){if(!ue||!$r[ue]){var bt=!1;for(var Bt in Ar)if(Ar.hasOwnProperty(Bt)&&Ar[Bt].equals(We)){bt=!0;break}if(bt)We=Ar[Bt];else{var sr="GS"+(Object.keys(Ar).length+1).toString(10);Ar[sr]=We,We.id=sr}return ue&&($r[ue]=We.id),en.publish("addGState",We),We}};x.addGState=function(ue,We){return Vo(ue,We),this},x.saveGraphicsState=function(){return $e("q"),Kt.push({key:je,size:_t,color:Ri}),this},x.restoreGraphicsState=function(){$e("Q");var ue=Kt.pop();return je=ue.key,_t=ue.size,Ri=ue.color,cn=null,this},x.setCurrentTransformationMatrix=function(ue){return $e(ue.toString()+" cm"),this},x.comment=function(ue){return $e("#"+ue),this};var ku=function(ue,We){var bt=ue||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return bt},set:function(Lr){isNaN(Lr)||(bt=parseFloat(Lr))}});var Bt=We||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Bt},set:function(Lr){isNaN(Lr)||(Bt=parseFloat(Lr))}});var sr="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return sr},set:function(Lr){sr=Lr.toString()}}),this},Ru=function(ue,We,bt,Bt){ku.call(this,ue,We),this.type="rect";var sr=bt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return sr},set:function(Zr){isNaN(Zr)||(sr=parseFloat(Zr))}});var Lr=Bt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Lr},set:function(Zr){isNaN(Zr)||(Lr=parseFloat(Zr))}}),this},go=function(){this.page=zr,this.currentPage=Ee,this.pages=it.slice(0),this.pagesContext=Rt.slice(0),this.x=Ge,this.y=Nt,this.matrix=Et,this.width=ii(Ee),this.height=Oo(Ee),this.outputDestination=zt,this.id="",this.objectNumber=-1};go.prototype.restore=function(){zr=this.page,Ee=this.currentPage,Rt=this.pagesContext,it=this.pages,Ge=this.x,Nt=this.y,Et=this.matrix,ri(Ee,this.width),ai(Ee,this.height),zt=this.outputDestination};var ji=function(ue,We,bt,Bt,sr){oi.push(new go),zr=Ee=0,it=[],Ge=ue,Nt=We,Et=sr,zi([bt,Bt])};for(var Hs in x.beginFormObject=function(ue,We,bt,Bt,sr){return ji(ue,We,bt,Bt,sr),this},x.endFormObject=function(ue){return(function(We){if(nr[We])oi.pop().restore();else{var bt=new go,Bt="Xo"+(Object.keys(Qr).length+1).toString(10);bt.id=Bt,nr[We]=Bt,Qr[Bt]=bt,en.publish("addFormObject",bt),oi.pop().restore()}})(ue),this},x.doFormObject=function(ue,We){var bt=Qr[nr[ue]];return $e("q"),$e(We.toString()+" cm"),$e("/"+bt.id+" Do"),$e("Q"),this},x.getFormObject=function(ue){var We=Qr[nr[ue]];return{x:We.x,y:We.y,width:We.width,height:We.height,matrix:We.matrix}},x.save=function(ue,We){return ue=ue||"generated.pdf",(We=We||{}).returnPromise=We.returnPromise||!1,We.returnPromise===!1?(_m(rs(ll()),ue),typeof _m.unload=="function"&&Oi.setTimeout&&setTimeout(_m.unload,911),this):new Promise(function(bt,Bt){try{var sr=_m(rs(ll()),ue);typeof _m.unload=="function"&&Oi.setTimeout&&setTimeout(_m.unload,911),bt(sr)}catch(Lr){Bt(Lr.message)}})},di.API)di.API.hasOwnProperty(Hs)&&(Hs==="events"&&di.API.events.length?(function(ue,We){var bt,Bt,sr;for(sr=We.length-1;sr!==-1;sr--)bt=We[sr][0],Bt=We[sr][1],ue.subscribe.apply(ue,[bt].concat(typeof Bt=="function"?[Bt]:Bt))})(en,di.API.events):x[Hs]=di.API[Hs]);var ii=x.getPageWidth=function(ue){return(Rt[ue=ue||Ee].mediaBox.topRightX-Rt[ue].mediaBox.bottomLeftX)/qe},ri=x.setPageWidth=function(ue,We){Rt[ue].mediaBox.topRightX=We*qe+Rt[ue].mediaBox.bottomLeftX},Oo=x.getPageHeight=function(ue){return(Rt[ue=ue||Ee].mediaBox.topRightY-Rt[ue].mediaBox.bottomLeftY)/qe},ai=x.setPageHeight=function(ue,We){Rt[ue].mediaBox.topRightY=We*qe+Rt[ue].mediaBox.bottomLeftY};return x.internal={pdfEscape:xi,getStyle:Je,getFont:ti,getFontSize:br,getCharSpace:Mu,getTextColor:As,getLineHeight:fn,getLineHeightFactor:fi,getLineWidth:_n,write:Jt,getHorizontalCoordinate:$i,getVerticalCoordinate:ba,getCoordinateString:wi,getVerticalCoordinateString:hi,collections:{},newObject:Gt,newAdditionalObject:Ln,newObjectDeferred:Ut,newObjectDeferredBegin:Xr,getFilters:Bn,putStream:ei,events:en,scaleFactor:qe,pageSize:{getWidth:function(){return ii(Ee)},setWidth:function(ue){ri(Ee,ue)},getHeight:function(){return Oo(Ee)},setHeight:function(ue){ai(Ee,ue)}},encryptionOptions:d,encryption:Ba,getEncryptor:function(ue){return d!==null?Ba.encryptor(ue,0):function(We){return We}},output:so,getNumberOfPages:ps,pages:it,out:$e,f2:ee,f3:G,getPageInfo:Vs,getPageInfoByObjId:Uc,getCurrentPageInfo:Pu,getPDFVersion:T,Point:ku,Rectangle:Ru,Matrix:ln,hasHotfix:ns},Object.defineProperty(x.internal.pageSize,"width",{get:function(){return ii(Ee)},set:function(ue){ri(Ee,ue)},enumerable:!0,configurable:!0}),Object.defineProperty(x.internal.pageSize,"height",{get:function(){return Oo(Ee)},set:function(ue){ai(Ee,ue)},enumerable:!0,configurable:!0}),(function(ue){for(var We=0,bt=pr.length;We<bt;We++){var Bt=sl.call(this,ue[We][0],ue[We][1],ue[We][2],pr[We][3],!0);m===!1&&(b[Bt]=!0);var sr=ue[We][0].split("-");Ya({id:Bt,fontName:sr[0],fontStyle:sr[1]||""})}en.publish("addFonts",{fonts:mt,dictionary:ct})}).call(x,pr),je="F1",Iu(i,r),en.publish("initialized"),x}Ov.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Ov.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ov.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},Ov.prototype.processOwnerPassword=function(t,e){return ek(QM(e).substr(0,5),t)},Ov.prototype.encryptor=function(t,e){var r=QM(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return ek(r,n)}},XS.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||po(t)!==po(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},di.API={events:[]},di.version="3.0.2";var js=di.API,_O=1,_y=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},dv=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Vi=function(t){return t.toFixed(2)},Zp=function(t){return t.toFixed(5)};js.__acroform__={};var Fc=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},i9=function(t){return t*_O},id=function(t){var e=new aZ,r=Qn.internal.getHeight(t)||0,n=Qn.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Vi(n)),Number(Vi(r))],e},u_e=js.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},c_e=js.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},f_e=js.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},tl=js.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return f_e(t,e-1)},rl=js.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return u_e(t,e-1)},nl=js.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return c_e(t,e-1)},h_e=js.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],a=t[1],s=t[2],o=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(a+o)||0,c.upperRight_X=r(i+s)||0,c.upperRight_Y=n(a)||0,[Number(Vi(c.lowerLeft_X)),Number(Vi(c.lowerLeft_Y)),Number(Vi(c.upperRight_X)),Number(Vi(c.upperRight_Y))]},d_e=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=tk(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+Vi(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=id(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},tk=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(ee){return ee.split(`
`)}):i.map(function(ee){return[ee]});var a=r,s=Qn.internal.getHeight(t)||0;s=s<0?-s:s;var o=Qn.internal.getWidth(t)||0;o=o<0?-o:o;var c=function(ee,G,ae){if(ee+1<i.length){var se=G+" "+i[ee+1][0];return tw(se,t,ae).width<=o-4}return!1};a++;e:for(;a>0;){e="",a--;var f,d,m=tw("3",t,a).height,b=t.multiline?s-a:(s-m)/2,x=b+=2,E=0,T=0,A=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+tw(e,t,a=12).width+", FieldWidth:"+o+`
`;break}for(var R="",F=0,N=0;N<i.length;N++)if(i.hasOwnProperty(N)){var O=!1;if(i[N].length!==1&&A!==i[N].length-1){if((m+2)*(F+2)+2>s)continue e;R+=i[N][A],O=!0,T=N,N--}else{R=(R+=i[N][A]+" ").substr(R.length-1)==" "?R.substr(0,R.length-1):R;var U=parseInt(N),j=c(U,R,a),H=N>=i.length-1;if(j&&!H){R+=" ",A=0;continue}if(j||H){if(H)T=U;else if(t.multiline&&(m+2)*(F+2)+2>s)continue e}else{if(!t.multiline||(m+2)*(F+2)+2>s)continue e;T=U}}for(var W="",X=E;X<=T;X++){var oe=i[X];if(t.multiline){if(X===T){W+=oe[A]+" ",A=(A+1)%oe.length;continue}if(X===E){W+=oe[oe.length-1]+" ";continue}}W+=oe[0]+" "}switch(W=W.substr(W.length-1)==" "?W.substr(0,W.length-1):W,d=tw(W,t,a).width,t.textAlign){case"right":f=o-d-2;break;case"center":f=(o-d)/2;break;default:f=2}e+=Vi(f)+" "+Vi(x)+` Td
`,e+="("+_y(W)+`) Tj
`,e+=-Vi(f)+` 0 Td
`,x=-(a+2),d=0,E=O?T:T+1,F++,R=""}break}return n.text=e,n.fontSize=a,n},tw=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},p_e={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},g_e=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},m_e=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Rh.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(p_e)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");_O=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new oZ,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&g_e(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var a=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],c=[],f=o.Rect;if(o.Rect&&(o.Rect=h_e(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Qn.createDefaultAppearanceStream(o),po(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(c=o.getKeyValueListForStream()),o.Rect=f,o.hasAppearanceStream&&!o.appearanceStreamContent){var d=d_e(o);c.push({key:"AP",value:"<</N "+d+">>"}),i.internal.acroformPlugin.xForms.push(d)}if(o.appearanceStreamContent){var m="";for(var b in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(b)){var x=o.appearanceStreamContent[b];if(m+="/"+b+" ",m+="<<",Object.keys(x).length>=1||Array.isArray(x)){for(var s in x)if(x.hasOwnProperty(s)){var E=x[s];typeof E=="function"&&(E=E.call(i,o)),m+="/"+s+" "+E+" ",i.internal.acroformPlugin.xForms.indexOf(E)>=0||i.internal.acroformPlugin.xForms.push(E)}}else typeof(E=x)=="function"&&(E=E.call(i,o)),m+="/"+s+" "+E,i.internal.acroformPlugin.xForms.indexOf(E)>=0||i.internal.acroformPlugin.xForms.push(E);m+=">>"}c.push({key:"AP",value:`<<
`+m+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:o.objId}),i.internal.out("endobj")}a&&(function(T,A){for(var R in T)if(T.hasOwnProperty(R)){var F=R,N=T[R];A.internal.newObjectDeferredBegin(N.objId,!0),po(N)==="object"&&typeof N.putStream=="function"&&N.putStream(),delete T[F]}})(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},iZ=js.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),po(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+_y(n(t[a].toString()))+")"):i+=t[a].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},UA=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+_y(n(t))+")"},fd=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};fd.prototype.toString=function(){return this.objId+" 0 R"},fd.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},fd.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:iZ(i,this.objId,this.scope)}):i instanceof fd?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var aZ=function(){fd.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Fc(aZ,fd);var oZ=function(){fd.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+_y(r(t))+")"}},set:function(r){t=r}})};Fc(oZ,fd);var Rh=function t(){fd.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(R){if(isNaN(R))throw new Error('Invalid value "'+R+'" for attribute F supplied.');e=R}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!tl(e,3)},set:function(R){R?this.F=rl(e,3):this.F=nl(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(R){if(isNaN(R))throw new Error('Invalid value "'+R+'" for attribute Ff supplied.');r=R}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(R){n=R!==void 0?R:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(R){n[0]=R}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(R){n[1]=R}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(R){n[2]=R}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(R){n[3]=R}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(R){switch(R){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=R;break;default:throw new Error('Invalid value "'+R+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof YS)return;a="FieldObject"+t.FieldNum++}var R=function(F){return F};return this.scope&&(R=this.scope.internal.getEncryptor(this.objId)),"("+_y(R(a))+")"},set:function(R){a=R.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(R){a=R}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(R){s=R}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(R){o=R}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(R){c=R}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/_O:f},set:function(R){f=R}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(R){d=R}});var m="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!m||this instanceof YS||this instanceof Bm))return UA(m,this.objId,this.scope)},set:function(R){R=R.toString(),m=R}});var b=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(b)return this instanceof nu==0?UA(b,this.objId,this.scope):b},set:function(R){R=R.toString(),b=this instanceof nu==0?R.substr(0,1)==="("?dv(R.substr(1,R.length-2)):dv(R):R}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof nu==1?dv(b.substr(1,b.length-1)):b},set:function(R){R=R.toString(),b=this instanceof nu==1?"/"+R:R}});var x=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(x)return x},set:function(R){this.V=R}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof nu==0?UA(x,this.objId,this.scope):x},set:function(R){R=R.toString(),x=this instanceof nu==0?R.substr(0,1)==="("?dv(R.substr(1,R.length-2)):dv(R):R}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof nu==1?dv(x.substr(1,x.length-1)):x},set:function(R){R=R.toString(),x=this instanceof nu==1?"/"+R:R}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var E,T=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return T},set:function(R){R=!!R,T=R}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(E)return E},set:function(R){E=R}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,1)},set:function(R){R?this.Ff=rl(this.Ff,1):this.Ff=nl(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,2)},set:function(R){R?this.Ff=rl(this.Ff,2):this.Ff=nl(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,3)},set:function(R){R?this.Ff=rl(this.Ff,3):this.Ff=nl(this.Ff,3)}});var A=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(A!==null)return A},set:function(R){if([0,1,2].indexOf(R)===-1)throw new Error('Invalid value "'+R+'" for attribute Q supplied.');A=R}}),Object.defineProperty(this,"textAlign",{get:function(){var R;switch(A){case 0:default:R="left";break;case 1:R="center";break;case 2:R="right"}return R},configurable:!0,enumerable:!0,set:function(R){switch(R){case"right":case 2:A=2;break;case"center":case 1:A=1;break;default:A=0}}})};Fc(Rh,fd);var w0=function(){Rh.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return iZ(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=(function(a,s,o){o||(o=1);for(var c,f=[];c=s.exec(a);)f.push(c[o]);return f})(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,18)},set:function(r){r?this.Ff=rl(this.Ff,18):this.Ff=nl(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=rl(this.Ff,19):this.Ff=nl(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,20)},set:function(r){r?(this.Ff=rl(this.Ff,20),e.sort()):this.Ff=nl(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,22)},set:function(r){r?this.Ff=rl(this.Ff,22):this.Ff=nl(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,23)},set:function(r){r?this.Ff=rl(this.Ff,23):this.Ff=nl(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,27)},set:function(r){r?this.Ff=rl(this.Ff,27):this.Ff=nl(this.Ff,27)}}),this.hasAppearanceStream=!1};Fc(w0,Rh);var S0=function(){w0.call(this),this.fontName="helvetica",this.combo=!1};Fc(S0,w0);var E0=function(){S0.call(this),this.combo=!0};Fc(E0,S0);var lS=function(){E0.call(this),this.edit=!0};Fc(lS,E0);var nu=function(){Rh.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,15)},set:function(r){r?this.Ff=rl(this.Ff,15):this.Ff=nl(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,16)},set:function(r){r?this.Ff=rl(this.Ff,16):this.Ff=nl(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,17)},set:function(r){r?this.Ff=rl(this.Ff,17):this.Ff=nl(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,26)},set:function(r){r?this.Ff=rl(this.Ff,26):this.Ff=nl(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+_y(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){po(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Fc(nu,Rh);var uS=function(){nu.call(this),this.pushButton=!0};Fc(uS,nu);var T0=function(){nu.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Fc(T0,nu);var YS=function(){var t,e;Rh.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,s=[];for(a in s.push("<<"),n)s.push("/"+a+" ("+_y(i(n[a]))+")");return s.push(">>"),s.join(`
`)},set:function(i){po(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Qn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Fc(YS,Rh),T0.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},T0.prototype.createOption=function(t){var e=new YS;return e.Parent=this,e.optionName=t,this.Kids.push(e),y_e.call(this.scope,e),e};var cS=function(){nu.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Qn.CheckBox.createAppearanceStream()};Fc(cS,nu);var Bm=function(){Rh.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,13)},set:function(e){e?this.Ff=rl(this.Ff,13):this.Ff=nl(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,21)},set:function(e){e?this.Ff=rl(this.Ff,21):this.Ff=nl(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,23)},set:function(e){e?this.Ff=rl(this.Ff,23):this.Ff=nl(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,24)},set:function(e){e?this.Ff=rl(this.Ff,24):this.Ff=nl(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,25)},set:function(e){e?this.Ff=rl(this.Ff,25):this.Ff=nl(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,26)},set:function(e){e?this.Ff=rl(this.Ff,26):this.Ff=nl(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Fc(Bm,Rh);var fS=function(){Bm.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!tl(this.Ff,14)},set:function(t){t?this.Ff=rl(this.Ff,14):this.Ff=nl(this.Ff,14)}}),this.password=!0};Fc(fS,Bm);var Qn={CheckBox:{createAppearanceStream:function(){return{N:{On:Qn.CheckBox.YesNormal},D:{On:Qn.CheckBox.YesPushDown,Off:Qn.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=id(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=tk(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Vi(a.fontSize)+" Tf "+i),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=id(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],a=Qn.internal.getHeight(t),s=Qn.internal.getWidth(t),o=tk(t,t.caption);return i.push("1 g"),i.push("0 0 "+Vi(s)+" "+Vi(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Vi(s-1)+" "+Vi(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Vi(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=id(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Qn.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Qn.RadioButton.Circle.YesNormal,e.D[t]=Qn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=id(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Qn.internal.Bezier_C,a=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Zp(Qn.internal.getWidth(t)/2)+" "+Zp(Qn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=id(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Qn.internal.Bezier_C).toFixed(5)),s=Number((n*Qn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Zp(Qn.internal.getWidth(t)/2)+" "+Zp(Qn.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Zp(Qn.internal.getWidth(t)/2)+" "+Zp(Qn.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=id(t);e.scope=t.scope;var r=[],n=Qn.internal.getWidth(t)<=Qn.internal.getHeight(t)?Qn.internal.getWidth(t)/4:Qn.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Qn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Zp(Qn.internal.getWidth(t)/2)+" "+Zp(Qn.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Qn.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Qn.RadioButton.Cross.YesNormal,e.D[t]=Qn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=id(t);e.scope=t.scope;var r=[],n=Qn.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Vi(Qn.internal.getWidth(t)-2)+" "+Vi(Qn.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Vi(n.x1.x)+" "+Vi(n.x1.y)+" m"),r.push(Vi(n.x2.x)+" "+Vi(n.x2.y)+" l"),r.push(Vi(n.x4.x)+" "+Vi(n.x4.y)+" m"),r.push(Vi(n.x3.x)+" "+Vi(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=id(t);e.scope=t.scope;var r=Qn.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Vi(Qn.internal.getWidth(t)-2)+" "+Vi(Qn.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Vi(r.x1.x)+" "+Vi(r.x1.y)+" m"),n.push(Vi(r.x2.x)+" "+Vi(r.x2.y)+" l"),n.push(Vi(r.x4.x)+" "+Vi(r.x4.y)+" m"),n.push(Vi(r.x3.x)+" "+Vi(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=id(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Vi(Qn.internal.getWidth(t))+" "+Vi(Qn.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Qn.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Qn.internal.getWidth(t),r=Qn.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Qn.internal.getWidth=function(t){var e=0;return po(t)==="object"&&(e=i9(t.Rect[2])),e},Qn.internal.getHeight=function(t){var e=0;return po(t)==="object"&&(e=i9(t.Rect[3])),e};var y_e=js.addField=function(t){if(m_e(this,t),!(t instanceof Rh))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};js.AcroFormChoiceField=w0,js.AcroFormListBox=S0,js.AcroFormComboBox=E0,js.AcroFormEditBox=lS,js.AcroFormButton=nu,js.AcroFormPushButton=uS,js.AcroFormRadioButton=T0,js.AcroFormCheckBox=cS,js.AcroFormTextField=Bm,js.AcroFormPasswordField=fS,js.AcroFormAppearance=Qn,js.AcroForm={ChoiceField:w0,ListBox:S0,ComboBox:E0,EditBox:lS,Button:nu,PushButton:uS,RadioButton:T0,CheckBox:cS,TextField:Bm,PasswordField:fS,Appearance:Qn},di.AcroForm={ChoiceField:w0,ListBox:S0,ComboBox:E0,EditBox:lS,Button:nu,PushButton:uS,RadioButton:T0,CheckBox:cS,TextField:Bm,PasswordField:fS,Appearance:Qn};di.AcroForm;function sZ(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(ee,G){var ae,se,fe,pe,De,ye=r;if((G=G||r)==="RGBA"||ee.data!==void 0&&ee.data instanceof Uint8ClampedArray&&"height"in ee&&"width"in ee)return"RGBA";if(j(ee))for(De in n)for(fe=n[De],ae=0;ae<fe.length;ae+=1){for(pe=!0,se=0;se<fe[ae].length;se+=1)if(fe[ae][se]!==void 0&&fe[ae][se]!==ee[se]){pe=!1;break}if(pe===!0){ye=De;break}}else for(De in n)for(fe=n[De],ae=0;ae<fe.length;ae+=1){for(pe=!0,se=0;se<fe[ae].length;se+=1)if(fe[ae][se]!==void 0&&fe[ae][se]!==ee.charCodeAt(se)){pe=!1;break}if(pe===!0){ye=De;break}}return ye===r&&G!==r&&(ye=G),ye},a=function ee(G){for(var ae=this.internal.write,se=this.internal.putStream,fe=(0,this.internal.getFilters)();fe.indexOf("FlateEncode")!==-1;)fe.splice(fe.indexOf("FlateEncode"),1);G.objectId=this.internal.newObject();var pe=[];if(pe.push({key:"Type",value:"/XObject"}),pe.push({key:"Subtype",value:"/Image"}),pe.push({key:"Width",value:G.width}),pe.push({key:"Height",value:G.height}),G.colorSpace===R.INDEXED?pe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(G.palette.length/3-1)+" "+("sMask"in G&&G.sMask!==void 0?G.objectId+2:G.objectId+1)+" 0 R]"}):(pe.push({key:"ColorSpace",value:"/"+G.colorSpace}),G.colorSpace===R.DEVICE_CMYK&&pe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),pe.push({key:"BitsPerComponent",value:G.bitsPerComponent}),"decodeParameters"in G&&G.decodeParameters!==void 0&&pe.push({key:"DecodeParms",value:"<<"+G.decodeParameters+">>"}),"transparency"in G&&Array.isArray(G.transparency)){for(var De="",ye=0,we=G.transparency.length;ye<we;ye++)De+=G.transparency[ye]+" "+G.transparency[ye]+" ";pe.push({key:"Mask",value:"["+De+"]"})}G.sMask!==void 0&&pe.push({key:"SMask",value:G.objectId+1+" 0 R"});var Te=G.filter!==void 0?["/"+G.filter]:void 0;if(se({data:G.data,additionalKeyValues:pe,alreadyAppliedFilters:Te,objectId:G.objectId}),ae("endobj"),"sMask"in G&&G.sMask!==void 0){var Re=(G.predictor!=null?"/Predictor "+G.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+G.width,de={width:G.width,height:G.height,colorSpace:"DeviceGray",bitsPerComponent:G.bitsPerComponent,decodeParameters:Re,data:G.sMask};"filter"in G&&(de.filter=G.filter),ee.call(this,de)}if(G.colorSpace===R.INDEXED){var Ee=this.internal.newObject();se({data:W(new Uint8Array(G.palette)),objectId:Ee}),ae("endobj")}},s=function(){var ee=this.internal.collections[e+"images"];for(var G in ee)a.call(this,ee[G])},o=function(){var ee,G=this.internal.collections[e+"images"],ae=this.internal.write;for(var se in G)ae("/I"+(ee=G[se]).index,ee.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},f=function(){var ee=this.internal.collections[e+"images"];return c.call(this),ee},d=function(){return Object.keys(this.internal.collections[e+"images"]).length},m=function(ee){return typeof t["process"+ee.toUpperCase()]=="function"},b=function(ee){return po(ee)==="object"&&ee.nodeType===1},x=function(ee,G){if(ee.nodeName==="IMG"&&ee.hasAttribute("src")){var ae=""+ee.getAttribute("src");if(ae.indexOf("data:image/")===0)return sS(unescape(ae).split("base64,").pop());var se=t.loadFile(ae,!0);if(se!==void 0)return se}if(ee.nodeName==="CANVAS"){if(ee.width===0||ee.height===0)throw new Error("Given canvas must have data. Canvas width: "+ee.width+", height: "+ee.height);var fe;switch(G){case"PNG":fe="image/png";break;case"WEBP":fe="image/webp";break;default:fe="image/jpeg"}return sS(ee.toDataURL(fe,1).split("base64,").pop())}},E=function(ee){var G=this.internal.collections[e+"images"];if(G){for(var ae in G)if(ee===G[ae].alias)return G[ae]}},T=function(ee,G,ae){return ee||G||(ee=-96,G=-96),ee<0&&(ee=-1*ae.width*72/ee/this.internal.scaleFactor),G<0&&(G=-1*ae.height*72/G/this.internal.scaleFactor),ee===0&&(ee=G*ae.width/ae.height),G===0&&(G=ee*ae.height/ae.width),[ee,G]},A=function(ee,G,ae,se,fe,pe){var De=T.call(this,ae,se,fe),ye=this.internal.getCoordinateString,we=this.internal.getVerticalCoordinateString,Te=f.call(this);if(ae=De[0],se=De[1],Te[fe.index]=fe,pe){pe*=Math.PI/180;var Re=Math.cos(pe),de=Math.sin(pe),Ee=function(Ne){return Ne.toFixed(4)},xe=[Ee(Re),Ee(de),Ee(-1*de),Ee(Re),0,0,"cm"]}this.internal.write("q"),pe?(this.internal.write([1,"0","0",1,ye(ee),we(G+se),"cm"].join(" ")),this.internal.write(xe.join(" ")),this.internal.write([ye(ae),"0","0",ye(se),"0","0","cm"].join(" "))):this.internal.write([ye(ae),"0","0",ye(se),ye(ee),we(G+se),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+fe.index+" Do"),this.internal.write("Q")},R=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var F=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},N=t.__addimage__.sHashCode=function(ee){var G,ae,se=0;if(typeof ee=="string")for(ae=ee.length,G=0;G<ae;G++)se=(se<<5)-se+ee.charCodeAt(G),se|=0;else if(j(ee))for(ae=ee.byteLength/2,G=0;G<ae;G++)se=(se<<5)-se+ee[G],se|=0;return se},O=t.__addimage__.validateStringAsBase64=function(ee){(ee=ee||"").toString().trim();var G=!0;return ee.length===0&&(G=!1),ee.length%4!=0&&(G=!1),/^[A-Za-z0-9+/]+$/.test(ee.substr(0,ee.length-2))===!1&&(G=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(ee.substr(-2))===!1&&(G=!1),G},U=t.__addimage__.extractImageFromDataUrl=function(ee){if(ee==null||!(ee=ee.trim()).startsWith("data:"))return null;var G=ee.indexOf(",");return G<0?null:ee.substring(0,G).trim().endsWith("base64")?ee.substring(G+1):null};t.__addimage__.isArrayBuffer=function(ee){return ee instanceof ArrayBuffer};var j=t.__addimage__.isArrayBufferView=function(ee){return ee instanceof Int8Array||ee instanceof Uint8Array||ee instanceof Uint8ClampedArray||ee instanceof Int16Array||ee instanceof Uint16Array||ee instanceof Int32Array||ee instanceof Uint32Array||ee instanceof Float32Array||ee instanceof Float64Array},H=t.__addimage__.binaryStringToUint8Array=function(ee){for(var G=ee.length,ae=new Uint8Array(G),se=0;se<G;se++)ae[se]=ee.charCodeAt(se);return ae},W=t.__addimage__.arrayBufferToBinaryString=function(ee){for(var G="",ae=j(ee)?ee:new Uint8Array(ee),se=0;se<ae.length;se+=8192)G+=String.fromCharCode.apply(null,ae.subarray(se,se+8192));return G};t.addImage=function(){var ee,G,ae,se,fe,pe,De,ye,we;if(typeof arguments[1]=="number"?(G=r,ae=arguments[1],se=arguments[2],fe=arguments[3],pe=arguments[4],De=arguments[5],ye=arguments[6],we=arguments[7]):(G=arguments[1],ae=arguments[2],se=arguments[3],fe=arguments[4],pe=arguments[5],De=arguments[6],ye=arguments[7],we=arguments[8]),po(ee=arguments[0])==="object"&&!b(ee)&&"imageData"in ee){var Te=ee;ee=Te.imageData,G=Te.format||G||r,ae=Te.x||ae||0,se=Te.y||se||0,fe=Te.w||Te.width||fe,pe=Te.h||Te.height||pe,De=Te.alias||De,ye=Te.compression||ye,we=Te.rotation||Te.angle||we}var Re=this.internal.getFilters();if(ye===void 0&&Re.indexOf("FlateEncode")!==-1&&(ye="SLOW"),isNaN(ae)||isNaN(se))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var de=X.call(this,ee,G,De,ye);return A.call(this,ae,se,fe,pe,de,we),this};var X=function(ee,G,ae,se){var fe,pe,De;if(typeof ee=="string"&&i(ee)===r){ee=unescape(ee);var ye=oe(ee,!1);(ye!==""||(ye=t.loadFile(ee,!0))!==void 0)&&(ee=ye)}if(b(ee)&&(ee=x(ee,G)),G=i(ee,G),!m(G))throw new Error("addImage does not support files of type '"+G+"', please ensure that a plugin for '"+G+"' support is added.");if(((De=ae)==null||De.length===0)&&(ae=(function(we){return typeof we=="string"||j(we)?N(we):j(we.data)?N(we.data):null})(ee)),(fe=E.call(this,ae))||(ee instanceof Uint8Array||G==="RGBA"||(pe=ee,ee=H(ee)),fe=this["process"+G.toUpperCase()](ee,d.call(this),ae,(function(we){return we&&typeof we=="string"&&(we=we.toUpperCase()),we in t.image_compression?we:F.NONE})(se),pe)),!fe)throw new Error("An unknown error occurred whilst processing the image.");return fe},oe=t.__addimage__.convertBase64ToBinaryString=function(ee,G){G=typeof G!="boolean"||G;var ae,se="";if(typeof ee=="string"){var fe;ae=(fe=U(ee))!==null&&fe!==void 0?fe:ee;try{se=sS(ae)}catch(pe){if(G)throw O(ae)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+pe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return se};t.getImageProperties=function(ee){var G,ae,se="";if(b(ee)&&(ee=x(ee)),typeof ee=="string"&&i(ee)===r&&((se=oe(ee,!1))===""&&(se=t.loadFile(ee)||""),ee=se),ae=i(ee),!m(ae))throw new Error("addImage does not support files of type '"+ae+"', please ensure that a plugin for '"+ae+"' support is added.");if(ee instanceof Uint8Array||(ee=H(ee)),!(G=this["process"+ae.toUpperCase()](ee)))throw new Error("An unknown error occurred whilst processing the image");return G.fileType=ae,G}})(di.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};di.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,a,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),f=r.pageContext.annotations,d=!1,m=0;m<f.length&&!d;m++)switch((n=f[m]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var b=0;b<f.length;b++){n=f[b];var x=this.internal.pdfEscape,E=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var T=this.internal.newAdditionalObject(),A=this.internal.newAdditionalObject(),R=this.internal.getEncryptor(T.objId),F=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+x(R(n.contents))+")",a+=" /Popup "+A.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+x(R(F))+") >>",T.content=a;var N=T.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+N,n.open&&(a+=" /Open true"),a+=" >>",A.content=a,this.internal.write(T.objId,"0 R",A.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var O=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+x(E(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+O+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var U=this.annotations._nameMap[n.options.name];n.options.pageNumber=U.page,n.options.top=U.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+x(E(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var j=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+j+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,a,s){var o=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:c(r),y:f(n),w:c(r+i),h:f(n+a)},options:s,type:"link"})},t.textWithLink=function(r,n,i,a){var s,o,c=this.getTextWidth(r),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var d=this.splitTextToSize(r,o).length;s=Math.ceil(f*d)}else o=c,s=f;return this.text(r,n,i,a),i+=.2*f,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,i-f,o,s,a),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(di.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(T){return e[T.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(T){return typeof T=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(T)},o=t.__arabicParser__.isArabicEndLetter=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(T){return s(T)&&i.indexOf(T.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length>=1};var f=t.__arabicParser__.arabicLetterHasFinalForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(T){return s(T)&&a(T)&&e[T.charCodeAt(0)].length==4},m=t.__arabicParser__.resolveLigatures=function(T){var A=0,R=r,F="",N=0;for(A=0;A<T.length;A+=1)R[T.charCodeAt(A)]!==void 0?(N++,typeof(R=R[T.charCodeAt(A)])=="number"&&(F+=String.fromCharCode(R),R=r,N=0),A===T.length-1&&(R=r,F+=T.charAt(A-(N-1)),A-=N-1,N=0)):(R=r,F+=T.charAt(A-N),A-=N,N=0);return F};t.__arabicParser__.isArabicDiacritic=function(T){return T!==void 0&&n[T.charCodeAt(0)]!==void 0};var b=t.__arabicParser__.getCorrectForm=function(T,A,R){return s(T)?a(T)===!1?-1:!f(T)||!s(A)&&!s(R)||!s(R)&&o(A)||o(T)&&!s(A)||o(T)&&c(A)||o(T)&&o(A)?0:d(T)&&s(A)&&!o(A)&&s(R)&&f(R)?3:o(T)||!s(R)?1:2:-1},x=function(T){var A=0,R=0,F=0,N="",O="",U="",j=(T=T||"").split("\\s+"),H=[];for(A=0;A<j.length;A+=1){for(H.push(""),R=0;R<j[A].length;R+=1)N=j[A][R],O=j[A][R-1],U=j[A][R+1],s(N)?(F=b(N,O,U),H[A]+=F!==-1?String.fromCharCode(e[N.charCodeAt(0)][F]):N):H[A]+=N;H[A]=m(H[A])}return H.join(" ")},E=t.__arabicParser__.processArabic=t.processArabic=function(){var T,A=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,R=[];if(Array.isArray(A)){var F=0;for(R=[],F=0;F<A.length;F+=1)Array.isArray(A[F])?R.push([x(A[F][0]),A[F][1],A[F][2]]):R.push([x(A[F])]);T=R}else T=x(A);return typeof arguments[0]=="string"?T:(arguments[0].text=T,arguments[0])};t.events.push(["preProcessText",E])})(di.API),di.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(di.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(T){c=T}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(T){f=T}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(T){d=T}});var m=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return m},set:function(T){m=T}});var b=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return b},set:function(T){b=T}});var x=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return x},set:function(T){x=T}});var E=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return E},set:function(T){E=T}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,f){n.call(this);var d=(f=f||{}).fontSize||this.getFontSize(),m=f.font||this.getFont(),b=f.scaleFactor||this.internal.scaleFactor,x=0,E=0,T=0,A=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var R=f.maxWidth;R>0?typeof c=="string"?c=this.splitTextToSize(c,R):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(N,O){return N.concat(A.splitTextToSize(O,R))},[])):c=Array.isArray(c)?c:[c];for(var F=0;F<c.length;F++)x<(T=this.getStringUnitWidth(c[F],{font:m})*d)&&(x=T);return x!==0&&(E=c.length),{w:x/=b,h:Math.max((E*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/b,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var f=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,m=this.internal.__cell__.margins||e,b=this.internal.__cell__.tableHeaderRow,x=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===c.lineNumber?(c.x=(f.x||0)+(f.width||0),c.y=f.y||0):f.y+f.height+c.height+m.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=m.top,x&&b&&(this.printHeaderRow(c.lineNumber,!0),c.y+=b[0].height)):c.y=f.y+f.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};t.table=function(c,f,d,m,b){if(n.call(this),!d)throw new Error("No data for PDF table.");var x,E,T,A,R=[],F=[],N=[],O={},U={},j=[],H=[],W=(b=b||{}).autoSize||!1,X=b.printHeaders!==!1,oe=b.css&&b.css["font-size"]!==void 0?16*b.css["font-size"]:b.fontSize||12,ee=b.margins||Object.assign({width:this.getPageWidth()},e),G=typeof b.padding=="number"?b.padding:3,ae=b.headerBackgroundColor||"#c8c8c8",se=b.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=X,this.internal.__cell__.margins=ee,this.internal.__cell__.table_font_size=oe,this.internal.__cell__.padding=G,this.internal.__cell__.headerBackgroundColor=ae,this.internal.__cell__.headerTextColor=se,this.setFontSize(oe),m==null)F=R=Object.keys(d[0]),N=R.map(function(){return"left"});else if(Array.isArray(m)&&po(m[0])==="object")for(R=m.map(function(Te){return Te.name}),F=m.map(function(Te){return Te.prompt||Te.name||""}),N=m.map(function(Te){return Te.align||"left"}),x=0;x<m.length;x+=1)U[m[x].name]=.7499990551181103*m[x].width;else Array.isArray(m)&&typeof m[0]=="string"&&(F=R=m,N=R.map(function(){return"left"}));if(W||Array.isArray(m)&&typeof m[0]=="string")for(x=0;x<R.length;x+=1){for(O[A=R[x]]=d.map(function(Te){return Te[A]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(F[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),E=O[A],this.setFont(void 0,"normal"),T=0;T<E.length;T+=1)j.push(this.getTextDimensions(E[T],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);U[A]=Math.max.apply(null,j)+G+G,j=[]}if(X){var fe={};for(x=0;x<R.length;x+=1)fe[R[x]]={},fe[R[x]].text=F[x],fe[R[x]].align=N[x];var pe=o.call(this,fe,U);H=R.map(function(Te){return new a(c,f,U[Te],pe,fe[Te].text,void 0,fe[Te].align)}),this.setTableHeaderRow(H),this.printHeaderRow(1,!1)}var De=m.reduce(function(Te,Re){return Te[Re.name]=Re.align,Te},{});for(x=0;x<d.length;x+=1){"rowStart"in b&&b.rowStart instanceof Function&&b.rowStart({row:x,data:d[x]},this);var ye=o.call(this,d[x],U);for(T=0;T<R.length;T+=1){var we=d[x][R[T]];"cellStart"in b&&b.cellStart instanceof Function&&b.cellStart({row:x,col:T,data:we},this),s.call(this,new a(c,f,U[R[T]],ye,we,x+2,De[R[T]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=f,this};var o=function(c,f){var d=this.internal.__cell__.padding,m=this.internal.__cell__.table_font_size,b=this.internal.scaleFactor;return Object.keys(c).map(function(x){var E=c[x];return this.splitTextToSize(E.hasOwnProperty("text")?E.text:E,f[x]-d-d)},this).map(function(x){return this.getLineHeightFactor()*x.length*m/b+d+d},this).reduce(function(x,E){return Math.max(x,E)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var m=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(m[0],m[1],m[2],m[3],void 0,-1)}this.setFont(void 0,"bold");for(var b=[],x=0;x<this.internal.__cell__.tableHeaderRow.length;x+=1){d=this.internal.__cell__.tableHeaderRow[x].clone(),f&&(d.y=this.internal.__cell__.margins.top||0,b.push(d)),d.lineNumber=c;var E=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,d),this.setTextColor(E)}b.length>0&&this.setTableHeaderRow(b),this.setFont(void 0,"normal"),r=!1}})(di.API);var lZ={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},uZ=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],rk=sZ(uZ),cZ=[100,200,300,400,500,600,700,800,900],v_e=sZ(cZ);function VA(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(a){return lZ[a=a||"normal"]?a:"normal"})(t.style),n=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(t.weight),i=(function(a){return typeof rk[a=a||"normal"]=="number"?a:"normal"})(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function a9(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var __e={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},o9={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function s9(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function l9(t){return t.trimLeft()}function b_e(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function x_e(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var rw,u9,c9,pv,nw,f9,h9,d9,$A=["times"];function p9(t,e,r,n){var i=4,a=m9;switch(n){case di.API.image_compression.FAST:i=1,a=g9;break;case di.API.image_compression.MEDIUM:i=6,a=y9;break;case di.API.image_compression.SLOW:i=9,a=v9}t=(function(o,c,f,d){for(var m,b=o.length/c,x=new Uint8Array(o.length+b),E=[w_e,g9,m9,y9,v9],T=0;T<b;T+=1){var A=T*c,R=o.subarray(A,A+c);if(d)x.set(d(R,f,m),A+T);else{for(var F=E.length,N=[],O=0;O<F;O+=1)N[O]=E[O](R,f,m);var U=E_e(N.concat());x.set(N[U],A+T)}m=R}return x})(t,e,r,a);var s=YM(t,{level:i});return di.API.__addimage__.arrayBufferToBinaryString(s)}function w_e(t){var e=Array.apply([],t);return e.unshift(0),e}function g9(t,e){var r=t.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var a=t[i-e]||0;n[i+1]=t[i]-a+256&255}return n}function m9(t,e,r){var n=t.length,i=[];i[0]=2;for(var a=0;a<n;a+=1){var s=r&&r[a]||0;i[a+1]=t[a]-s+256&255}return i}function y9(t,e,r){var n=t.length,i=[];i[0]=3;for(var a=0;a<n;a+=1){var s=t[a-e]||0,o=r&&r[a]||0;i[a+1]=t[a]+256-(s+o>>>1)&255}return i}function v9(t,e,r){var n=t.length,i=[];i[0]=4;for(var a=0;a<n;a+=1){var s=S_e(t[a-e]||0,r&&r[a]||0,r&&r[a-e]||0);i[a+1]=t[a]-s+256&255}return i}function S_e(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),i=Math.abs(t-r),a=Math.abs(t+e-r-r);return n<=i&&n<=a?t:i<=a?e:r}function E_e(t){var e=t.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return e.indexOf(Math.min.apply(null,e))}function qA(t,e,r){var n=e*r,i=Math.floor(n/8),a=16-(n-8*i+r),s=(1<<r)-1;return fZ(t,i)>>a&s}function _9(t,e,r,n){var i=r*n,a=Math.floor(i/8),s=16-(i-8*a+n),o=(1<<n)-1,c=(e&o)<<s;(function(f,d,m){if(d+1<f.byteLength)f.setUint16(d,m,!1);else{var b=m>>8&255;f.setUint8(d,b)}})(t,a,fZ(t,a)&~(o<<s)&65535|c)}function fZ(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function T_e(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,s=1<<1+(7&i);t[e++],t[e++];var o=null,c=null;a&&(o=e,c=s,e+=3*s);var f=!0,d=[],m=0,b=null,x=0,E=null;for(this.width=r,this.height=n;f&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,E=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((ee=t[e++])>=0))throw Error("Invalid block size");if(ee===0)break;e+=ee}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var T=t[e++];m=t[e++]|t[e++]<<8,b=t[e++],1&T||(b=null),x=T>>2&7,e++;break;case 254:for(;;){if(!((ee=t[e++])>=0))throw Error("Invalid block size");if(ee===0)break;e+=ee}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var A=t[e++]|t[e++]<<8,R=t[e++]|t[e++]<<8,F=t[e++]|t[e++]<<8,N=t[e++]|t[e++]<<8,O=t[e++],U=O>>6&1,j=1<<1+(7&O),H=o,W=c,X=!1;O>>7&&(X=!0,H=e,W=j,e+=3*j);var oe=e;for(e++;;){var ee;if(!((ee=t[e++])>=0))throw Error("Invalid block size");if(ee===0)break;e+=ee}d.push({x:A,y:R,width:F,height:N,has_local_palette:X,palette_offset:H,palette_size:W,data_offset:oe,data_length:e-oe,transparent_index:b,interlaced:!!U,delay:m,disposal:x});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return E},this.frameInfo=function(G){if(G<0||G>=d.length)throw new Error("Frame index out of range.");return d[G]},this.decodeAndBlitFrameBGRA=function(G,ae){var se=this.frameInfo(G),fe=se.width*se.height,pe=new Uint8Array(fe);b9(t,se.data_offset,pe,fe);var De=se.palette_offset,ye=se.transparent_index;ye===null&&(ye=256);var we=se.width,Te=r-we,Re=we,de=4*(se.y*r+se.x),Ee=4*((se.y+se.height)*r+se.x),xe=de,Ne=4*Te;se.interlaced===!0&&(Ne+=4*r*7);for(var Fe=8,Xe=0,Be=pe.length;Xe<Be;++Xe){var ot=pe[Xe];if(Re===0&&(Re=we,(xe+=Ne)>=Ee&&(Ne=4*Te+4*r*(Fe-1),xe=de+(we+Te)*(Fe<<1),Fe>>=1)),ot===ye)xe+=4;else{var Ke=t[De+3*ot],it=t[De+3*ot+1],Me=t[De+3*ot+2];ae[xe++]=Me,ae[xe++]=it,ae[xe++]=Ke,ae[xe++]=255}--Re}},this.decodeAndBlitFrameRGBA=function(G,ae){var se=this.frameInfo(G),fe=se.width*se.height,pe=new Uint8Array(fe);b9(t,se.data_offset,pe,fe);var De=se.palette_offset,ye=se.transparent_index;ye===null&&(ye=256);var we=se.width,Te=r-we,Re=we,de=4*(se.y*r+se.x),Ee=4*((se.y+se.height)*r+se.x),xe=de,Ne=4*Te;se.interlaced===!0&&(Ne+=4*r*7);for(var Fe=8,Xe=0,Be=pe.length;Xe<Be;++Xe){var ot=pe[Xe];if(Re===0&&(Re=we,(xe+=Ne)>=Ee&&(Ne=4*Te+4*r*(Fe-1),xe=de+(we+Te)*(Fe<<1),Fe>>=1)),ot===ye)xe+=4;else{var Ke=t[De+3*ot],it=t[De+3*ot+1],Me=t[De+3*ot+2];ae[xe++]=Ke,ae[xe++]=it,ae[xe++]=Me,ae[xe++]=255}--Re}}}function b9(t,e,r,n){for(var i=t[e++],a=1<<i,s=a+1,o=s+1,c=i+1,f=(1<<c)-1,d=0,m=0,b=0,x=t[e++],E=new Int32Array(4096),T=null;;){for(;d<16&&x!==0;)m|=t[e++]<<d,d+=8,x===1?x=t[e++]:--x;if(d<c)break;var A=m&f;if(m>>=c,d-=c,A!==a){if(A===s)break;for(var R=A<o?A:T,F=0,N=R;N>a;)N=E[N]>>8,++F;var O=N;if(b+F+(R!==A?1:0)>n)return void Ro.log("Warning, gif stream longer than expected.");r[b++]=O;var U=b+=F;for(R!==A&&(r[b++]=O),N=R;F--;)N=E[N],r[--U]=255&N,N>>=8;T!==null&&o<4096&&(E[o++]=T<<8|O,o>=f+1&&c<12&&(++c,f=f<<1|1)),T=A}else o=s+1,f=(1<<(c=i+1))-1,T=null}return b!==n&&Ro.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function HA(t){var e,r,n,i,a,s=Math.floor,o=new Array(64),c=new Array(64),f=new Array(64),d=new Array(64),m=new Array(65535),b=new Array(65535),x=new Array(64),E=new Array(64),T=[],A=0,R=7,F=new Array(64),N=new Array(64),O=new Array(64),U=new Array(256),j=new Array(2048),H=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],W=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],X=[0,1,2,3,4,5,6,7,8,9,10,11],oe=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],ee=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],G=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ae=[0,1,2,3,4,5,6,7,8,9,10,11],se=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],fe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function pe(de,Ee){for(var xe=0,Ne=0,Fe=new Array,Xe=1;Xe<=16;Xe++){for(var Be=1;Be<=de[Xe];Be++)Fe[Ee[Ne]]=[],Fe[Ee[Ne]][0]=xe,Fe[Ee[Ne]][1]=Xe,Ne++,xe++;xe*=2}return Fe}function De(de){for(var Ee=de[0],xe=de[1]-1;xe>=0;)Ee&1<<xe&&(A|=1<<R),xe--,--R<0&&(A==255?(ye(255),ye(0)):ye(A),R=7,A=0)}function ye(de){T.push(de)}function we(de){ye(de>>8&255),ye(255&de)}function Te(de,Ee,xe,Ne,Fe){for(var Xe,Be=Fe[0],ot=Fe[240],Ke=(function(_t,vr){var br,lr,Cr,Tr,Qt,at,Pe,be,je,qe,Ge=0;for(je=0;je<8;++je){br=_t[Ge],lr=_t[Ge+1],Cr=_t[Ge+2],Tr=_t[Ge+3],Qt=_t[Ge+4],at=_t[Ge+5],Pe=_t[Ge+6];var Nt=br+(be=_t[Ge+7]),Et=br-be,mt=lr+Pe,ct=lr-Pe,Kt=Cr+at,qt=Cr-at,Ir=Tr+Qt,Ar=Tr-Qt,$r=Nt+Ir,cn=Nt-Ir,zr=mt+Kt,Rt=mt-Kt;_t[Ge]=$r+zr,_t[Ge+4]=$r-zr;var en=.707106781*(Rt+cn);_t[Ge+2]=cn+en,_t[Ge+6]=cn-en;var jn=.382683433*(($r=Ar+qt)-(Rt=ct+Et)),Qr=.5411961*$r+jn,nr=1.306562965*Rt+jn,oi=.707106781*(zr=qt+ct),ln=Et+oi,Kn=Et-oi;_t[Ge+5]=Kn+Qr,_t[Ge+3]=Kn-Qr,_t[Ge+1]=ln+nr,_t[Ge+7]=ln-nr,Ge+=8}for(Ge=0,je=0;je<8;++je){br=_t[Ge],lr=_t[Ge+8],Cr=_t[Ge+16],Tr=_t[Ge+24],Qt=_t[Ge+32],at=_t[Ge+40],Pe=_t[Ge+48];var ke=br+(be=_t[Ge+56]),He=br-be,Tt=lr+Pe,Gt=lr-Pe,Ut=Cr+at,Xr=Cr-at,Ln=Tr+Qt,Bi=Tr-Qt,Ci=ke+Ln,Fr=ke-Ln,Rn=Tt+Ut,Bn=Tt-Ut;_t[Ge]=Ci+Rn,_t[Ge+32]=Ci-Rn;var ei=.707106781*(Bn+Fr);_t[Ge+16]=Fr+ei,_t[Ge+48]=Fr-ei;var ua=.382683433*((Ci=Bi+Xr)-(Bn=Gt+He)),ha=.5411961*Ci+ua,zn=1.306562965*Bn+ua,Na=.707106781*(Rn=Xr+Gt),Wi=He+Na,ds=He-Na;_t[Ge+40]=ds+ha,_t[Ge+24]=ds-ha,_t[Ge+8]=Wi+zn,_t[Ge+56]=Wi-zn,Ge++}for(je=0;je<64;++je)qe=_t[je]*vr[je],x[je]=qe>0?qe+.5|0:qe-.5|0;return x})(de,Ee),it=0;it<64;++it)E[H[it]]=Ke[it];var Me=E[0]-xe;xe=E[0],Me==0?De(Ne[0]):(De(Ne[b[Xe=32767+Me]]),De(m[Xe]));for(var zt=63;zt>0&&E[zt]==0;)zt--;if(zt==0)return De(Be),xe;for(var st,$e=1;$e<=zt;){for(var Jt=$e;E[$e]==0&&$e<=zt;)++$e;var Ht=$e-Jt;if(Ht>=16){st=Ht>>4;for(var pr=1;pr<=st;++pr)De(ot);Ht&=15}Xe=32767+E[$e],De(Fe[(Ht<<4)+b[Xe]]),De(m[Xe]),$e++}return zt!=63&&De(Be),xe}function Re(de){de=Math.min(Math.max(de,1),100),a!=de&&((function(Ee){for(var xe=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ne=0;Ne<64;Ne++){var Fe=s((xe[Ne]*Ee+50)/100);Fe=Math.min(Math.max(Fe,1),255),o[H[Ne]]=Fe}for(var Xe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Be=0;Be<64;Be++){var ot=s((Xe[Be]*Ee+50)/100);ot=Math.min(Math.max(ot,1),255),c[H[Be]]=ot}for(var Ke=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],it=0,Me=0;Me<8;Me++)for(var zt=0;zt<8;zt++)f[it]=1/(o[H[it]]*Ke[Me]*Ke[zt]*8),d[it]=1/(c[H[it]]*Ke[Me]*Ke[zt]*8),it++})(de<50?Math.floor(5e3/de):Math.floor(200-2*de)),a=de)}this.encode=function(de,Ee){Ee&&Re(Ee),T=new Array,A=0,R=7,we(65496),we(65504),we(16),ye(74),ye(70),ye(73),ye(70),ye(0),ye(1),ye(1),ye(0),we(1),we(1),ye(0),ye(0),(function(){we(65499),we(132),ye(0);for(var lr=0;lr<64;lr++)ye(o[lr]);ye(1);for(var Cr=0;Cr<64;Cr++)ye(c[Cr])})(),(function(lr,Cr){we(65472),we(17),ye(8),we(Cr),we(lr),ye(3),ye(1),ye(17),ye(0),ye(2),ye(17),ye(1),ye(3),ye(17),ye(1)})(de.width,de.height),(function(){we(65476),we(418),ye(0);for(var lr=0;lr<16;lr++)ye(W[lr+1]);for(var Cr=0;Cr<=11;Cr++)ye(X[Cr]);ye(16);for(var Tr=0;Tr<16;Tr++)ye(oe[Tr+1]);for(var Qt=0;Qt<=161;Qt++)ye(ee[Qt]);ye(1);for(var at=0;at<16;at++)ye(G[at+1]);for(var Pe=0;Pe<=11;Pe++)ye(ae[Pe]);ye(17);for(var be=0;be<16;be++)ye(se[be+1]);for(var je=0;je<=161;je++)ye(fe[je])})(),we(65498),we(12),ye(3),ye(1),ye(0),ye(2),ye(17),ye(3),ye(17),ye(0),ye(63),ye(0);var xe=0,Ne=0,Fe=0;A=0,R=7,this.encode.displayName="_encode_";for(var Xe,Be,ot,Ke,it,Me,zt,st,$e,Jt=de.data,Ht=de.width,pr=de.height,_t=4*Ht,vr=0;vr<pr;){for(Xe=0;Xe<_t;){for(it=_t*vr+Xe,zt=-1,st=0,$e=0;$e<64;$e++)Me=it+(st=$e>>3)*_t+(zt=4*(7&$e)),vr+st>=pr&&(Me-=_t*(vr+1+st-pr)),Xe+zt>=_t&&(Me-=Xe+zt-_t+4),Be=Jt[Me++],ot=Jt[Me++],Ke=Jt[Me++],F[$e]=(j[Be]+j[ot+256|0]+j[Ke+512|0]>>16)-128,N[$e]=(j[Be+768|0]+j[ot+1024|0]+j[Ke+1280|0]>>16)-128,O[$e]=(j[Be+1280|0]+j[ot+1536|0]+j[Ke+1792|0]>>16)-128;xe=Te(F,f,xe,e,n),Ne=Te(N,d,Ne,r,i),Fe=Te(O,d,Fe,r,i),Xe+=32}vr+=8}if(R>=0){var br=[];br[1]=R+1,br[0]=(1<<R+1)-1,De(br)}return we(65497),new Uint8Array(T)},t=t||50,(function(){for(var de=String.fromCharCode,Ee=0;Ee<256;Ee++)U[Ee]=de(Ee)})(),e=pe(W,X),r=pe(G,ae),n=pe(oe,ee),i=pe(se,fe),(function(){for(var de=1,Ee=2,xe=1;xe<=15;xe++){for(var Ne=de;Ne<Ee;Ne++)b[32767+Ne]=xe,m[32767+Ne]=[],m[32767+Ne][1]=xe,m[32767+Ne][0]=Ne;for(var Fe=-(Ee-1);Fe<=-de;Fe++)b[32767+Fe]=xe,m[32767+Fe]=[],m[32767+Fe][1]=xe,m[32767+Fe][0]=Ee-1+Fe;de<<=1,Ee<<=1}})(),(function(){for(var de=0;de<256;de++)j[de]=19595*de,j[de+256|0]=38470*de,j[de+512|0]=7471*de+32768,j[de+768|0]=-11059*de,j[de+1024|0]=-21709*de,j[de+1280|0]=32768*de+8421375,j[de+1536|0]=-27439*de,j[de+1792|0]=-5329*de})(),Re(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function dh(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function x9(t){function e(X){if(!X)throw Error("assert :P")}function r(X,oe,ee){for(var G=0;4>G;G++)if(X[oe+G]!=ee.charCodeAt(G))return!0;return!1}function n(X,oe,ee,G,ae){for(var se=0;se<ae;se++)X[oe+se]=ee[G+se]}function i(X,oe,ee,G){for(var ae=0;ae<G;ae++)X[oe+ae]=ee}function a(X){return new Int32Array(X)}function s(X,oe){for(var ee=[],G=0;G<X;G++)ee.push(new oe);return ee}function o(X,oe){var ee=[];return(function G(ae,se,fe){for(var pe=fe[se],De=0;De<pe&&(ae.push(fe.length>se+1?[]:new oe),!(fe.length<se+1));De++)G(ae[De],se+1,fe)})(ee,0,X),ee}var c=function(){var X=this;function oe(q,K){for(var me=1<<K-1>>>0;q&me;)me>>>=1;return me?(q&me-1)+me:q}function ee(q,K,me,Ie,Ye){e(!(Ie%me));do q[K+(Ie-=me)]=Ye;while(0<Ie)}function G(q,K,me,Ie,Ye){if(e(2328>=Ye),512>=Ye)var Qe=a(512);else if((Qe=a(Ye))==null)return 0;return(function(nt,lt,yt,At,Xt,_r){var St,Pt,fr=lt,Nr=1<<yt,gr=a(16),Br=a(16);for(e(Xt!=0),e(At!=null),e(nt!=null),e(0<yt),Pt=0;Pt<Xt;++Pt){if(15<At[Pt])return 0;++gr[At[Pt]]}if(gr[0]==Xt)return 0;for(Br[1]=0,St=1;15>St;++St){if(gr[St]>1<<St)return 0;Br[St+1]=Br[St]+gr[St]}for(Pt=0;Pt<Xt;++Pt)St=At[Pt],0<At[Pt]&&(_r[Br[St]++]=Pt);if(Br[15]==1)return(At=new ae).g=0,At.value=_r[0],ee(nt,fr,1,Nr,At),Nr;var jr,on=-1,Jr=Nr-1,Jn=0,Vn=1,Ai=1,Zn=1<<yt;for(Pt=0,St=1,Xt=2;St<=yt;++St,Xt<<=1){if(Vn+=Ai<<=1,0>(Ai-=gr[St]))return 0;for(;0<gr[St];--gr[St])(At=new ae).g=St,At.value=_r[Pt++],ee(nt,fr+Jn,Xt,Zn,At),Jn=oe(Jn,St)}for(St=yt+1,Xt=2;15>=St;++St,Xt<<=1){if(Vn+=Ai<<=1,0>(Ai-=gr[St]))return 0;for(;0<gr[St];--gr[St]){if(At=new ae,(Jn&Jr)!=on){for(fr+=Zn,jr=1<<(on=St)-yt;15>on&&!(0>=(jr-=gr[on]));)++on,jr<<=1;Nr+=Zn=1<<(jr=on-yt),nt[lt+(on=Jn&Jr)].g=jr+yt,nt[lt+on].value=fr-lt-on}At.g=St-yt,At.value=_r[Pt++],ee(nt,fr+(Jn>>yt),Xt,Zn,At),Jn=oe(Jn,St)}}return Vn!=2*Br[15]-1?0:Nr})(q,K,me,Ie,Ye,Qe)}function ae(){this.value=this.g=0}function se(){this.value=this.g=0}function fe(){this.G=s(5,ae),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Ua,se)}function pe(q,K,me,Ie){e(q!=null),e(K!=null),e(2147483648>Ie),q.Ca=254,q.I=0,q.b=-8,q.Ka=0,q.oa=K,q.pa=me,q.Jd=K,q.Yc=me+Ie,q.Zc=4<=Ie?me+Ie-4+1:me,Be(q)}function De(q,K){for(var me=0;0<K--;)me|=Ke(q,128)<<K;return me}function ye(q,K){var me=De(q,K);return ot(q)?-me:me}function we(q,K,me,Ie){var Ye,Qe=0;for(e(q!=null),e(K!=null),e(4294967288>Ie),q.Sb=Ie,q.Ra=0,q.u=0,q.h=0,4<Ie&&(Ie=4),Ye=0;Ye<Ie;++Ye)Qe+=K[me+Ye]<<8*Ye;q.Ra=Qe,q.bb=Ie,q.oa=K,q.pa=me}function Te(q){for(;8<=q.u&&q.bb<q.Sb;)q.Ra>>>=8,q.Ra+=q.oa[q.pa+q.bb]<<ys-8>>>0,++q.bb,q.u-=8;Ne(q)&&(q.h=1,q.u=0)}function Re(q,K){if(e(0<=K),!q.h&&K<=Ks){var me=xe(q)&fu[K];return q.u+=K,Te(q),me}return q.h=1,q.u=0}function de(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Ee(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function xe(q){return q.Ra>>>(q.u&ys-1)>>>0}function Ne(q){return e(q.bb<=q.Sb),q.h||q.bb==q.Sb&&q.u>ys}function Fe(q,K){q.u=K,q.h=Ne(q)}function Xe(q){q.u>=Va&&(e(q.u>=Va),Te(q))}function Be(q){e(q!=null&&q.oa!=null),q.pa<q.Zc?(q.I=(q.oa[q.pa++]|q.I<<8)>>>0,q.b+=8):(e(q!=null&&q.oa!=null),q.pa<q.Yc?(q.b+=8,q.I=q.oa[q.pa++]|q.I<<8):q.Ka?q.b=0:(q.I<<=8,q.b+=8,q.Ka=1))}function ot(q){return De(q,1)}function Ke(q,K){var me=q.Ca;0>q.b&&Be(q);var Ie=q.b,Ye=me*K>>>8,Qe=(q.I>>>Ie>Ye)+0;for(Qe?(me-=Ye,q.I-=Ye+1<<Ie>>>0):me=Ye+1,Ie=me,Ye=0;256<=Ie;)Ye+=8,Ie>>=8;return Ie=7^Ye+Vl[Ie],q.b-=Ie,q.Ca=(me<<Ie)-1,Qe}function it(q,K,me){q[K+0]=me>>24&255,q[K+1]=me>>16&255,q[K+2]=me>>8&255,q[K+3]=255&me}function Me(q,K){return q[K+0]|q[K+1]<<8}function zt(q,K){return Me(q,K)|q[K+2]<<16}function st(q,K){return Me(q,K)|Me(q,K+2)<<16}function $e(q,K){var me=1<<K;return e(q!=null),e(0<K),q.X=a(me),q.X==null?0:(q.Mb=32-K,q.Xa=K,1)}function Jt(q,K){e(q!=null),e(K!=null),e(q.Xa==K.Xa),n(K.X,0,q.X,0,1<<K.Xa)}function Ht(){this.X=[],this.Xa=this.Mb=0}function pr(q,K,me,Ie){e(me!=null),e(Ie!=null);var Ye=me[0],Qe=Ie[0];return Ye==0&&(Ye=(q*Qe+K/2)/K),Qe==0&&(Qe=(K*Ye+q/2)/q),0>=Ye||0>=Qe?0:(me[0]=Ye,Ie[0]=Qe,1)}function _t(q,K){return q+(1<<K)-1>>>K}function vr(q,K){return((4278255360&q)+(4278255360&K)>>>0&4278255360)+((16711935&q)+(16711935&K)>>>0&16711935)>>>0}function br(q,K){X[K]=function(me,Ie,Ye,Qe,nt,lt,yt){var At;for(At=0;At<nt;++At){var Xt=X[q](lt[yt+At-1],Ye,Qe+At);lt[yt+At]=vr(me[Ie+At],Xt)}}}function lr(){this.ud=this.hd=this.jd=0}function Cr(q,K){return((4278124286&(q^K))>>>1)+(q&K)>>>0}function Tr(q){return 0<=q&&256>q?q:0>q?0:255<q?255:void 0}function Qt(q,K){return Tr(q+(q-K+.5>>1))}function at(q,K,me){return Math.abs(K-me)-Math.abs(q-me)}function Pe(q,K,me,Ie,Ye,Qe,nt){for(Ie=Qe[nt-1],me=0;me<Ye;++me)Qe[nt+me]=Ie=vr(q[K+me],Ie)}function be(q,K,me,Ie,Ye){var Qe;for(Qe=0;Qe<me;++Qe){var nt=q[K+Qe],lt=nt>>8&255,yt=16711935&(yt=(yt=16711935&nt)+((lt<<16)+lt));Ie[Ye+Qe]=(4278255360&nt)+yt>>>0}}function je(q,K){K.jd=255&q,K.hd=q>>8&255,K.ud=q>>16&255}function qe(q,K,me,Ie,Ye,Qe){var nt;for(nt=0;nt<Ie;++nt){var lt=K[me+nt],yt=lt>>>8,At=lt,Xt=255&(Xt=(Xt=lt>>>16)+((q.jd<<24>>24)*(yt<<24>>24)>>>5));At=255&(At=(At+=(q.hd<<24>>24)*(yt<<24>>24)>>>5)+((q.ud<<24>>24)*(Xt<<24>>24)>>>5)),Ye[Qe+nt]=(4278255360&lt)+(Xt<<16)+At}}function Ge(q,K,me,Ie,Ye){X[K]=function(Qe,nt,lt,yt,At,Xt,_r,St,Pt){for(yt=_r;yt<St;++yt)for(_r=0;_r<Pt;++_r)At[Xt++]=Ye(lt[Ie(Qe[nt++])])},X[q]=function(Qe,nt,lt,yt,At,Xt,_r){var St=8>>Qe.b,Pt=Qe.Ea,fr=Qe.K[0],Nr=Qe.w;if(8>St)for(Qe=(1<<Qe.b)-1,Nr=(1<<St)-1;nt<lt;++nt){var gr,Br=0;for(gr=0;gr<Pt;++gr)gr&Qe||(Br=Ie(yt[At++])),Xt[_r++]=Ye(fr[Br&Nr]),Br>>=St}else X["VP8LMapColor"+me](yt,At,fr,Nr,Xt,_r,nt,lt,Pt)}}function Nt(q,K,me,Ie,Ye){for(me=K+me;K<me;){var Qe=q[K++];Ie[Ye++]=Qe>>16&255,Ie[Ye++]=Qe>>8&255,Ie[Ye++]=255&Qe}}function Et(q,K,me,Ie,Ye){for(me=K+me;K<me;){var Qe=q[K++];Ie[Ye++]=Qe>>16&255,Ie[Ye++]=Qe>>8&255,Ie[Ye++]=255&Qe,Ie[Ye++]=Qe>>24&255}}function mt(q,K,me,Ie,Ye){for(me=K+me;K<me;){var Qe=(nt=q[K++])>>16&240|nt>>12&15,nt=240&nt|nt>>28&15;Ie[Ye++]=Qe,Ie[Ye++]=nt}}function ct(q,K,me,Ie,Ye){for(me=K+me;K<me;){var Qe=(nt=q[K++])>>16&248|nt>>13&7,nt=nt>>5&224|nt>>3&31;Ie[Ye++]=Qe,Ie[Ye++]=nt}}function Kt(q,K,me,Ie,Ye){for(me=K+me;K<me;){var Qe=q[K++];Ie[Ye++]=255&Qe,Ie[Ye++]=Qe>>8&255,Ie[Ye++]=Qe>>16&255}}function qt(q,K,me,Ie,Ye,Qe){if(Qe==0)for(me=K+me;K<me;)it(Ie,((Qe=q[K++])[0]>>24|Qe[1]>>8&65280|Qe[2]<<8&16711680|Qe[3]<<24)>>>0),Ye+=32;else n(Ie,Ye,q,K,me)}function Ir(q,K){X[K][0]=X[q+"0"],X[K][1]=X[q+"1"],X[K][2]=X[q+"2"],X[K][3]=X[q+"3"],X[K][4]=X[q+"4"],X[K][5]=X[q+"5"],X[K][6]=X[q+"6"],X[K][7]=X[q+"7"],X[K][8]=X[q+"8"],X[K][9]=X[q+"9"],X[K][10]=X[q+"10"],X[K][11]=X[q+"11"],X[K][12]=X[q+"12"],X[K][13]=X[q+"13"],X[K][14]=X[q+"0"],X[K][15]=X[q+"0"]}function Ar(q){return q==qg||q==Rd||q==Vc||q==th}function $r(){this.eb=[],this.size=this.A=this.fb=0}function cn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function zr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new $r,this.f.kb=new cn,this.sd=null}function Rt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function en(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function jn(q){return alert("todo:WebPSamplerProcessPlane"),q.T}function Qr(q,K){var me=q.T,Ie=K.ba.f.RGBA,Ye=Ie.eb,Qe=Ie.fb+q.ka*Ie.A,nt=pl[K.ba.S],lt=q.y,yt=q.O,At=q.f,Xt=q.N,_r=q.ea,St=q.W,Pt=K.cc,fr=K.dc,Nr=K.Mc,gr=K.Nc,Br=q.ka,jr=q.ka+q.T,on=q.U,Jr=on+1>>1;for(Br==0?nt(lt,yt,null,null,At,Xt,_r,St,At,Xt,_r,St,Ye,Qe,null,null,on):(nt(K.ec,K.fc,lt,yt,Pt,fr,Nr,gr,At,Xt,_r,St,Ye,Qe-Ie.A,Ye,Qe,on),++me);Br+2<jr;Br+=2)Pt=At,fr=Xt,Nr=_r,gr=St,Xt+=q.Rc,St+=q.Rc,Qe+=2*Ie.A,nt(lt,(yt+=2*q.fa)-q.fa,lt,yt,Pt,fr,Nr,gr,At,Xt,_r,St,Ye,Qe-Ie.A,Ye,Qe,on);return yt+=q.fa,q.j+jr<q.o?(n(K.ec,K.fc,lt,yt,on),n(K.cc,K.dc,At,Xt,Jr),n(K.Mc,K.Nc,_r,St,Jr),me--):1&jr||nt(lt,yt,null,null,At,Xt,_r,St,At,Xt,_r,St,Ye,Qe+Ie.A,null,null,on),me}function nr(q,K,me){var Ie=q.F,Ye=[q.J];if(Ie!=null){var Qe=q.U,nt=K.ba.S,lt=nt==kp||nt==Vc;K=K.ba.f.RGBA;var yt=[0],At=q.ka;yt[0]=q.T,q.Kb&&(At==0?--yt[0]:(--At,Ye[0]-=q.width),q.j+q.ka+q.T==q.o&&(yt[0]=q.o-q.j-At));var Xt=K.eb;At=K.fb+At*K.A,q=Ma(Ie,Ye[0],q.width,Qe,yt,Xt,At+(lt?0:3),K.A),e(me==yt),q&&Ar(nt)&&ca(Xt,At,lt,Qe,yt,K.A)}return 0}function oi(q){var K=q.ma,me=K.ba.S,Ie=11>me,Ye=me==eh||me==pu||me==kp||me==Vg||me==12||Ar(me);if(K.memory=null,K.Ib=null,K.Jb=null,K.Nd=null,!Lo(K.Oa,q,Ye?11:12))return 0;if(Ye&&Ar(me)&&Ys(),q.da)alert("todo:use_scaling");else{if(Ie){if(K.Ib=jn,q.Kb){if(me=q.U+1>>1,K.memory=a(q.U+2*me),K.memory==null)return 0;K.ec=K.memory,K.fc=0,K.cc=K.ec,K.dc=K.fc+q.U,K.Mc=K.cc,K.Nc=K.dc+me,K.Ib=Qr,Ys()}}else alert("todo:EmitYUV");Ye&&(K.Jb=nr,Ie&&Xs())}if(Ie&&!Bp){for(q=0;256>q;++q)zd[q]=89858*(q-128)+Bd>>Fd,Kg[q]=-22014*(q-128)+Bd,Zg[q]=-45773*(q-128),Fy[q]=113618*(q-128)+Bd>>Fd;for(q=zh;q<wc;++q)K=76283*(q-16)+Bd>>Fd,By[q-zh]=ja(K,255),Jg[q-zh]=ja(K+8>>4,15);Bp=1}return 1}function ln(q){var K=q.ma,me=q.U,Ie=q.T;return e(!(1&q.ka)),0>=me||0>=Ie?0:(me=K.Ib(q,K),K.Jb!=null&&K.Jb(q,K,me),K.Dc+=me,1)}function Kn(q){q.ma.memory=null}function ke(q,K,me,Ie){return Re(q,8)!=47?0:(K[0]=Re(q,14)+1,me[0]=Re(q,14)+1,Ie[0]=Re(q,1),Re(q,3)!=0?0:!q.h)}function He(q,K){if(4>q)return q+1;var me=q-2>>1;return(2+(1&q)<<me)+Re(K,me)+1}function Tt(q,K){return 120<K?K-120:1<=(me=((me=vf[K-1])>>4)*q+(8-(15&me)))?me:1;var me}function Gt(q,K,me){var Ie=xe(me),Ye=q[K+=255&Ie].g-8;return 0<Ye&&(Fe(me,me.u+8),Ie=xe(me),K+=q[K].value,K+=Ie&(1<<Ye)-1),Fe(me,me.u+q[K].g),q[K].value}function Ut(q,K,me){return me.g+=q.g,me.value+=q.value<<K>>>0,e(8>=me.g),q.g}function Xr(q,K,me){var Ie=q.xc;return e((K=Ie==0?0:q.vc[q.md*(me>>Ie)+(K>>Ie)])<q.Wb),q.Ya[K]}function Ln(q,K,me,Ie){var Ye=q.ab,Qe=q.c*K,nt=q.C;K=nt+K;var lt=me,yt=Ie;for(Ie=q.Ta,me=q.Ua;0<Ye--;){var At=q.gc[Ye],Xt=nt,_r=K,St=lt,Pt=yt,fr=(yt=Ie,lt=me,At.Ea);switch(e(Xt<_r),e(_r<=At.nc),At.hc){case 2:$l(St,Pt,(_r-Xt)*fr,yt,lt);break;case 0:var Nr=Xt,gr=_r,Br=yt,jr=lt,on=(Zn=At).Ea;Nr==0&&(fl(St,Pt,null,null,1,Br,jr),Pe(St,Pt+1,0,0,on-1,Br,jr+1),Pt+=on,jr+=on,++Nr);for(var Jr=1<<Zn.b,Jn=Jr-1,Vn=_t(on,Zn.b),Ai=Zn.K,Zn=Zn.w+(Nr>>Zn.b)*Vn;Nr<gr;){var Yi=Ai,No=Zn,Li=1;for(hl(St,Pt,Br,jr-on,1,Br,jr);Li<on;){var Yn=(Li&~Jn)+Jr;Yn>on&&(Yn=on),(0,tr[Yi[No++]>>8&15])(St,Pt+ +Li,Br,jr+Li-on,Yn-Li,Br,jr+Li),Li=Yn}Pt+=on,jr+=on,++Nr&Jn||(Zn+=Vn)}_r!=At.nc&&n(yt,lt-fr,yt,lt+(_r-Xt-1)*fr,fr);break;case 1:for(fr=St,gr=Pt,on=(St=At.Ea)-(jr=St&~(Br=(Pt=1<<At.b)-1)),Nr=_t(St,At.b),Jr=At.K,At=At.w+(Xt>>At.b)*Nr;Xt<_r;){for(Jn=Jr,Vn=At,Ai=new lr,Zn=gr+jr,Yi=gr+St;gr<Zn;)je(Jn[Vn++],Ai),mr(Ai,fr,gr,Pt,yt,lt),gr+=Pt,lt+=Pt;gr<Yi&&(je(Jn[Vn++],Ai),mr(Ai,fr,gr,on,yt,lt),gr+=on,lt+=on),++Xt&Br||(At+=Nr)}break;case 3:if(St==yt&&Pt==lt&&0<At.b){for(gr=yt,St=fr=lt+(_r-Xt)*fr-(jr=(_r-Xt)*_t(At.Ea,At.b)),Pt=yt,Br=lt,Nr=[],jr=(on=jr)-1;0<=jr;--jr)Nr[jr]=Pt[Br+jr];for(jr=on-1;0<=jr;--jr)gr[St+jr]=Nr[jr];ql(At,Xt,_r,yt,fr,yt,lt)}else ql(At,Xt,_r,St,Pt,yt,lt)}lt=Ie,yt=me}yt!=me&&n(Ie,me,lt,yt,Qe)}function Bi(q,K){var me=q.V,Ie=q.Ba+q.c*q.C,Ye=K-q.C;if(e(K<=q.l.o),e(16>=Ye),0<Ye){var Qe=q.l,nt=q.Ta,lt=q.Ua,yt=Qe.width;if(Ln(q,Ye,me,Ie),Ye=lt=[lt],e((me=q.C)<(Ie=K)),e(Qe.v<Qe.va),Ie>Qe.o&&(Ie=Qe.o),me<Qe.j){var At=Qe.j-me;me=Qe.j,Ye[0]+=At*yt}if(me>=Ie?me=0:(Ye[0]+=4*Qe.v,Qe.ka=me-Qe.j,Qe.U=Qe.va-Qe.v,Qe.T=Ie-me,me=1),me){if(lt=lt[0],11>(me=q.ca).S){var Xt=me.f.RGBA,_r=(Ie=me.S,Ye=Qe.U,Qe=Qe.T,At=Xt.eb,Xt.A),St=Qe;for(Xt=Xt.fb+q.Ma*Xt.A;0<St--;){var Pt=nt,fr=lt,Nr=Ye,gr=At,Br=Xt;switch(Ie){case Lu:hn(Pt,fr,Nr,gr,Br);break;case eh:In(Pt,fr,Nr,gr,Br);break;case qg:In(Pt,fr,Nr,gr,Br),ca(gr,Br,0,Nr,1,0);break;case yf:I(Pt,fr,Nr,gr,Br);break;case pu:qt(Pt,fr,Nr,gr,Br,1);break;case Rd:qt(Pt,fr,Nr,gr,Br,1),ca(gr,Br,0,Nr,1,0);break;case kp:qt(Pt,fr,Nr,gr,Br,0);break;case Vc:qt(Pt,fr,Nr,gr,Br,0),ca(gr,Br,1,Nr,1,0);break;case Vg:vi(Pt,fr,Nr,gr,Br);break;case th:vi(Pt,fr,Nr,gr,Br),lo(gr,Br,Nr,1,0);break;case $g:Pn(Pt,fr,Nr,gr,Br);break;default:e(0)}lt+=yt,Xt+=_r}q.Ma+=Qe}else alert("todo:EmitRescaledRowsYUVA");e(q.Ma<=me.height)}}q.C=K,e(q.C<=q.i)}function Ci(q){var K;if(0<q.ua)return 0;for(K=0;K<q.Wb;++K){var me=q.Ya[K].G,Ie=q.Ya[K].H;if(0<me[1][Ie[1]+0].g||0<me[2][Ie[2]+0].g||0<me[3][Ie[3]+0].g)return 0}return 1}function Fr(q,K,me,Ie,Ye,Qe){if(q.Z!=0){var nt=q.qd,lt=q.rd;for(e(oc[q.Z]!=null);K<me;++K)oc[q.Z](nt,lt,Ie,Ye,Ie,Ye,Qe),nt=Ie,lt=Ye,Ye+=Qe;q.qd=nt,q.rd=lt}}function Rn(q,K){var me=q.l.ma,Ie=me.Z==0||me.Z==1?q.l.j:q.C;if(Ie=q.C<Ie?Ie:q.C,e(K<=q.l.o),K>Ie){var Ye=q.l.width,Qe=me.ca,nt=me.tb+Ye*Ie,lt=q.V,yt=q.Ba+q.c*Ie,At=q.gc;e(q.ab==1),e(At[0].hc==3),Hl(At[0],Ie,K,lt,yt,Qe,nt),Fr(me,Ie,K,Qe,nt,Ye)}q.C=q.Ma=K}function Bn(q,K,me,Ie,Ye,Qe,nt){var lt=q.$/Ie,yt=q.$%Ie,At=q.m,Xt=q.s,_r=me+q.$,St=_r;Ye=me+Ie*Ye;var Pt=me+Ie*Qe,fr=280+Xt.ua,Nr=q.Pb?lt:16777216,gr=0<Xt.ua?Xt.Wa:null,Br=Xt.wc,jr=_r<Pt?Xr(Xt,yt,lt):null;e(q.C<Qe),e(Pt<=Ye);var on=!1;e:for(;;){for(;on||_r<Pt;){var Jr=0;if(lt>=Nr){var Jn=_r-me;e((Nr=q).Pb),Nr.wd=Nr.m,Nr.xd=Jn,0<Nr.s.ua&&Jt(Nr.s.Wa,Nr.s.vb),Nr=lt+Gg}if(yt&Br||(jr=Xr(Xt,yt,lt)),e(jr!=null),jr.Qb&&(K[_r]=jr.qb,on=!0),!on)if(Xe(At),jr.jc){Jr=At,Jn=K;var Vn=_r,Ai=jr.pd[xe(Jr)&Ua-1];e(jr.jc),256>Ai.g?(Fe(Jr,Jr.u+Ai.g),Jn[Vn]=Ai.value,Jr=0):(Fe(Jr,Jr.u+Ai.g-256),e(256<=Ai.value),Jr=Ai.value),Jr==0&&(on=!0)}else Jr=Gt(jr.G[0],jr.H[0],At);if(At.h)break;if(on||256>Jr){if(!on)if(jr.nd)K[_r]=(jr.qb|Jr<<8)>>>0;else{if(Xe(At),on=Gt(jr.G[1],jr.H[1],At),Xe(At),Jn=Gt(jr.G[2],jr.H[2],At),Vn=Gt(jr.G[3],jr.H[3],At),At.h)break;K[_r]=(Vn<<24|on<<16|Jr<<8|Jn)>>>0}if(on=!1,++_r,++yt>=Ie&&(yt=0,++lt,nt!=null&&lt<=Qe&&!(lt%16)&&nt(q,lt),gr!=null))for(;St<_r;)Jr=K[St++],gr.X[(506832829*Jr&4294967295)>>>gr.Mb]=Jr}else if(280>Jr){if(Jr=He(Jr-256,At),Jn=Gt(jr.G[4],jr.H[4],At),Xe(At),Jn=Tt(Ie,Jn=He(Jn,At)),At.h)break;if(_r-me<Jn||Ye-_r<Jr)break e;for(Vn=0;Vn<Jr;++Vn)K[_r+Vn]=K[_r+Vn-Jn];for(_r+=Jr,yt+=Jr;yt>=Ie;)yt-=Ie,++lt,nt!=null&&lt<=Qe&&!(lt%16)&&nt(q,lt);if(e(_r<=Ye),yt&Br&&(jr=Xr(Xt,yt,lt)),gr!=null)for(;St<_r;)Jr=K[St++],gr.X[(506832829*Jr&4294967295)>>>gr.Mb]=Jr}else{if(!(Jr<fr))break e;for(on=Jr-280,e(gr!=null);St<_r;)Jr=K[St++],gr.X[(506832829*Jr&4294967295)>>>gr.Mb]=Jr;Jr=_r,e(!(on>>>(Jn=gr).Xa)),K[Jr]=Jn.X[on],on=!0}on||e(At.h==Ne(At))}if(q.Pb&&At.h&&_r<Ye)e(q.m.h),q.a=5,q.m=q.wd,q.$=q.xd,0<q.s.ua&&Jt(q.s.vb,q.s.Wa);else{if(At.h)break e;nt?.(q,lt>Qe?Qe:lt),q.a=0,q.$=_r-me}return 1}return q.a=3,0}function ei(q){e(q!=null),q.vc=null,q.yc=null,q.Ya=null;var K=q.Wa;K!=null&&(K.X=null),q.vb=null,e(q!=null)}function ua(){var q=new Ui;return q==null?null:(q.a=0,q.xb=Xl,Ir("Predictor","VP8LPredictors"),Ir("Predictor","VP8LPredictors_C"),Ir("PredictorAdd","VP8LPredictorsAdd"),Ir("PredictorAdd","VP8LPredictorsAdd_C"),$l=be,mr=qe,hn=Nt,In=Et,vi=mt,Pn=ct,I=Kt,X.VP8LMapColor32b=dl,X.VP8LMapColor8b=Ou,q)}function ha(q,K,me,Ie,Ye){var Qe=1,nt=[q],lt=[K],yt=Ie.m,At=Ie.s,Xt=null,_r=0;e:for(;;){if(me)for(;Qe&&Re(yt,1);){var St=nt,Pt=lt,fr=Ie,Nr=1,gr=fr.m,Br=fr.gc[fr.ab],jr=Re(gr,2);if(fr.Oc&1<<jr)Qe=0;else{switch(fr.Oc|=1<<jr,Br.hc=jr,Br.Ea=St[0],Br.nc=Pt[0],Br.K=[null],++fr.ab,e(4>=fr.ab),jr){case 0:case 1:Br.b=Re(gr,3)+2,Nr=ha(_t(Br.Ea,Br.b),_t(Br.nc,Br.b),0,fr,Br.K),Br.K=Br.K[0];break;case 3:var on,Jr=Re(gr,8)+1,Jn=16<Jr?0:4<Jr?1:2<Jr?2:3;if(St[0]=_t(Br.Ea,Jn),Br.b=Jn,on=Nr=ha(Jr,1,0,fr,Br.K)){var Vn,Ai=Jr,Zn=Br,Yi=1<<(8>>Zn.b),No=a(Yi);if(No==null)on=0;else{var Li=Zn.K[0],Yn=Zn.w;for(No[0]=Zn.K[0][0],Vn=1;Vn<1*Ai;++Vn)No[Vn]=vr(Li[Yn+Vn],No[Vn-1]);for(;Vn<4*Yi;++Vn)No[Vn]=0;Zn.K[0]=null,Zn.K[0]=No,on=1}}Nr=on;break;case 2:break;default:e(0)}Qe=Nr}}if(nt=nt[0],lt=lt[0],Qe&&Re(yt,1)&&!(Qe=1<=(_r=Re(yt,4))&&11>=_r)){Ie.a=3;break e}var wn;if(wn=Qe)t:{var Co,Pi,aa,da=Ie,Mi=nt,Ml=lt,Qa=_r,vs=me,ks=da.m,Go=da.s,sa=[null],wa=1,Ao=0,qi=rh[Qa];r:for(;;){if(vs&&Re(ks,1)){var Wo=Re(ks,3)+2,Tn=_t(Mi,Wo),Sn=_t(Ml,Wo),Rs=Tn*Sn;if(!ha(Tn,Sn,0,da,sa))break r;for(sa=sa[0],Go.xc=Wo,Co=0;Co<Rs;++Co){var Sa=sa[Co]>>8&65535;sa[Co]=Sa,Sa>=wa&&(wa=Sa+1)}}if(ks.h)break r;for(Pi=0;5>Pi;++Pi){var Fo=Dp[Pi];!Pi&&0<Qa&&(Fo+=1<<Qa),Ao<Fo&&(Ao=Fo)}var $a=s(wa*qi,ae),eo=wa,kl=s(eo,fe);if(kl==null)var Yl=null;else e(65536>=eo),Yl=kl;var Zl=a(Ao);if(Yl==null||Zl==null||$a==null){da.a=1;break r}var gu=$a;for(Co=aa=0;Co<wa;++Co){var Ea=Yl[Co],ia=Ea.G,pa=Ea.H,mu=0,yu=1,as=0;for(Pi=0;5>Pi;++Pi){Fo=Dp[Pi],ia[Pi]=gu,pa[Pi]=aa,!Pi&&0<Qa&&(Fo+=1<<Qa);i:{var jh,Uh=Fo,Vh=da,qc=Zl,Hc=gu,jp=aa,oh=0,lc=Vh.m,jd=Re(lc,1);if(i(qc,0,0,Uh),jd){var Qg=Re(lc,1)+1,$h=Re(lc,1),xf=Re(lc,$h==0?1:8);qc[xf]=1,Qg==2&&(qc[xf=Re(lc,8)]=1);var qh=1}else{var Hh=a(19),wf=Re(lc,4)+4;if(19<wf){Vh.a=3;var Gh=0;break i}for(jh=0;jh<wf;++jh)Hh[Lp[jh]]=Re(lc,3);var Wh=void 0,Sf=void 0,Up=Vh,D=Hh,u=Uh,g=qc,w=0,C=Up.m,L=8,z=s(128,ae);n:for(;G(z,0,7,D,19);){if(Re(C,1)){var Y=2+2*Re(C,3);if((Wh=2+Re(C,Y))>u)break n}else Wh=u;for(Sf=0;Sf<u&&Wh--;){Xe(C);var re=z[0+(127&xe(C))];Fe(C,C.u+re.g);var le=re.value;if(16>le)g[Sf++]=le,le!=0&&(L=le);else{var he=le==16,Ae=le-16,Ce=Hg[Ae],Ue=Re(C,Rp[Ae])+Ce;if(Sf+Ue>u)break n;for(var Ze=he?L:0;0<Ue--;)g[Sf++]=Ze}}w=1;break n}w||(Up.a=3),qh=w}(qh=qh&&!lc.h)&&(oh=G(Hc,jp,8,qc,Uh)),qh&&oh!=0?Gh=oh:(Vh.a=3,Gh=0)}if(Gh==0)break r;if(yu&&Op[Pi]==1&&(yu=gu[aa].g==0),mu+=gu[aa].g,aa+=Gh,3>=Pi){var ht,pt=Zl[0];for(ht=1;ht<Fo;++ht)Zl[ht]>pt&&(pt=Zl[ht]);as+=pt}}if(Ea.nd=yu,Ea.Qb=0,yu&&(Ea.qb=(ia[3][pa[3]+0].value<<24|ia[1][pa[1]+0].value<<16|ia[2][pa[2]+0].value)>>>0,mu==0&&256>ia[0][pa[0]+0].value&&(Ea.Qb=1,Ea.qb+=ia[0][pa[0]+0].value<<8)),Ea.jc=!Ea.Qb&&6>as,Ea.jc){var dt,xt=Ea;for(dt=0;dt<Ua;++dt){var Ot=dt,wt=xt.pd[Ot],Lt=xt.G[0][xt.H[0]+Ot];256<=Lt.value?(wt.g=Lt.g+256,wt.value=Lt.value):(wt.g=0,wt.value=0,Ot>>=Ut(Lt,8,wt),Ot>>=Ut(xt.G[1][xt.H[1]+Ot],16,wt),Ot>>=Ut(xt.G[2][xt.H[2]+Ot],0,wt),Ut(xt.G[3][xt.H[3]+Ot],24,wt))}}}Go.vc=sa,Go.Wb=wa,Go.Ya=Yl,Go.yc=$a,wn=1;break t}wn=0}if(!(Qe=wn)){Ie.a=3;break e}if(0<_r){if(At.ua=1<<_r,!$e(At.Wa,_r)){Ie.a=1,Qe=0;break e}}else At.ua=0;var jt=Ie,Dt=nt,Yt=lt,Sr=jt.s,dr=Sr.xc;if(jt.c=Dt,jt.i=Yt,Sr.md=_t(Dt,dr),Sr.wc=dr==0?-1:(1<<dr)-1,me){Ie.xb=ih;break e}if((Xt=a(nt*lt))==null){Ie.a=1,Qe=0;break e}Qe=(Qe=Bn(Ie,Xt,0,nt,lt,lt,null))&&!yt.h;break e}return Qe?(Ye!=null?Ye[0]=Xt:(e(Xt==null),e(me)),Ie.$=0,me||ei(At)):ei(At),Qe}function zn(q,K){var me=q.c*q.i,Ie=me+K+16*K;return e(q.c<=K),q.V=a(Ie),q.V==null?(q.Ta=null,q.Ua=0,q.a=1,0):(q.Ta=q.V,q.Ua=q.Ba+me+K,1)}function Na(q,K){var me=q.C,Ie=K-me,Ye=q.V,Qe=q.Ba+q.c*me;for(e(K<=q.l.o);0<Ie;){var nt=16<Ie?16:Ie,lt=q.l.ma,yt=q.l.width,At=yt*nt,Xt=lt.ca,_r=lt.tb+yt*me,St=q.Ta,Pt=q.Ua;Ln(q,nt,Ye,Qe),Ho(St,Pt,Xt,_r,At),Fr(lt,me,me+nt,Xt,_r,yt),Ie-=nt,Ye+=nt*q.c,me+=nt}e(me==K),q.C=q.Ma=K}function Wi(){this.ub=this.yd=this.td=this.Rb=0}function ds(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ca(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Do(){this.Yb=(function(){var q=[];return(function K(me,Ie,Ye){for(var Qe=Ye[Ie],nt=0;nt<Qe&&(me.push(Ye.length>Ie+1?[]:0),!(Ye.length<Ie+1));nt++)K(me[nt],Ie+1,Ye)})(q,0,[3,11]),q})()}function Ya(){this.jb=a(3),this.Wc=o([4,8],Do),this.Xc=o([4,17],Do)}function sl(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function xi(){this.ld=this.La=this.dd=this.tc=0}function zi(){this.Na=this.la=0}function Iu(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ma(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Za(){this.uc=this.M=this.Nb=0,this.wa=Array(new xi),this.Y=0,this.ya=Array(new ma),this.aa=0,this.l=new gs}function ps(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Aa(){this.cb=this.a=0,this.sc="",this.m=new de,this.Od=new Wi,this.Kc=new ds,this.ed=new sl,this.Qa=new Ca,this.Ic=this.$c=this.Aa=0,this.D=new Za,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,de),this.ia=0,this.pb=s(4,Iu),this.Pa=new Ya,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ps),this.Hd=0,this.rb=Array(new zi),this.sb=0,this.wa=Array(new xi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ma),this.L=this.aa=0,this.gd=o([4,2],xi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function gs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ul(){var q=new Aa;return q!=null&&(q.a=0,q.sc="OK",q.cb=0,q.Xb=0,Dd||(Dd=ll)),q}function Fa(q,K,me){return q.a==0&&(q.a=K,q.sc=me,q.cb=0),0}function _a(q,K,me){return 3<=me&&q[K+0]==157&&q[K+1]==1&&q[K+2]==42}function xc(q,K){if(q==null)return 0;if(q.a=0,q.sc="OK",K==null)return Fa(q,2,"null VP8Io passed to VP8GetHeaders()");var me=K.data,Ie=K.w,Ye=K.ha;if(4>Ye)return Fa(q,7,"Truncated header.");var Qe=me[Ie+0]|me[Ie+1]<<8|me[Ie+2]<<16,nt=q.Od;if(nt.Rb=!(1&Qe),nt.td=Qe>>1&7,nt.yd=Qe>>4&1,nt.ub=Qe>>5,3<nt.td)return Fa(q,3,"Incorrect keyframe parameters.");if(!nt.yd)return Fa(q,4,"Frame not displayable.");Ie+=3,Ye-=3;var lt=q.Kc;if(nt.Rb){if(7>Ye)return Fa(q,7,"cannot parse picture header");if(!_a(me,Ie,Ye))return Fa(q,3,"Bad code word");lt.c=16383&(me[Ie+4]<<8|me[Ie+3]),lt.Td=me[Ie+4]>>6,lt.i=16383&(me[Ie+6]<<8|me[Ie+5]),lt.Ud=me[Ie+6]>>6,Ie+=7,Ye-=7,q.za=lt.c+15>>4,q.Ub=lt.i+15>>4,K.width=lt.c,K.height=lt.i,K.Da=0,K.j=0,K.v=0,K.va=K.width,K.o=K.height,K.da=0,K.ib=K.width,K.hb=K.height,K.U=K.width,K.T=K.height,i((Qe=q.Pa).jb,0,255,Qe.jb.length),e((Qe=q.Qa)!=null),Qe.Cb=0,Qe.Bb=0,Qe.Fb=1,i(Qe.Zb,0,0,Qe.Zb.length),i(Qe.Lb,0,0,Qe.Lb)}if(nt.ub>Ye)return Fa(q,7,"bad partition length");pe(Qe=q.m,me,Ie,nt.ub),Ie+=nt.ub,Ye-=nt.ub,nt.Rb&&(lt.Ld=ot(Qe),lt.Kd=ot(Qe)),lt=q.Qa;var yt,At=q.Pa;if(e(Qe!=null),e(lt!=null),lt.Cb=ot(Qe),lt.Cb){if(lt.Bb=ot(Qe),ot(Qe)){for(lt.Fb=ot(Qe),yt=0;4>yt;++yt)lt.Zb[yt]=ot(Qe)?ye(Qe,7):0;for(yt=0;4>yt;++yt)lt.Lb[yt]=ot(Qe)?ye(Qe,6):0}if(lt.Bb)for(yt=0;3>yt;++yt)At.jb[yt]=ot(Qe)?De(Qe,8):255}else lt.Bb=0;if(Qe.Ka)return Fa(q,3,"cannot parse segment header");if((lt=q.ed).zd=ot(Qe),lt.Tb=De(Qe,6),lt.wb=De(Qe,3),lt.Pc=ot(Qe),lt.Pc&&ot(Qe)){for(At=0;4>At;++At)ot(Qe)&&(lt.vd[At]=ye(Qe,6));for(At=0;4>At;++At)ot(Qe)&&(lt.od[At]=ye(Qe,6))}if(q.L=lt.Tb==0?0:lt.zd?1:2,Qe.Ka)return Fa(q,3,"cannot parse filter header");var Xt=Ye;if(Ye=yt=Ie,Ie=yt+Xt,lt=Xt,q.Xb=(1<<De(q.m,2))-1,Xt<3*(At=q.Xb))me=7;else{for(yt+=3*At,lt-=3*At,Xt=0;Xt<At;++Xt){var _r=me[Ye+0]|me[Ye+1]<<8|me[Ye+2]<<16;_r>lt&&(_r=lt),pe(q.Jc[+Xt],me,yt,_r),yt+=_r,lt-=_r,Ye+=3}pe(q.Jc[+At],me,yt,lt),me=yt<Ie?0:5}if(me!=0)return Fa(q,me,"cannot parse partitions");for(me=De(yt=q.m,7),Ye=ot(yt)?ye(yt,4):0,Ie=ot(yt)?ye(yt,4):0,lt=ot(yt)?ye(yt,4):0,At=ot(yt)?ye(yt,4):0,yt=ot(yt)?ye(yt,4):0,Xt=q.Qa,_r=0;4>_r;++_r){if(Xt.Cb){var St=Xt.Zb[_r];Xt.Fb||(St+=me)}else{if(0<_r){q.pb[_r]=q.pb[0];continue}St=me}var Pt=q.pb[_r];Pt.Sc[0]=Wg[ja(St+Ye,127)],Pt.Sc[1]=nh[ja(St+0,127)],Pt.Eb[0]=2*Wg[ja(St+Ie,127)],Pt.Eb[1]=101581*nh[ja(St+lt,127)]>>16,8>Pt.Eb[1]&&(Pt.Eb[1]=8),Pt.Qc[0]=Wg[ja(St+At,117)],Pt.Qc[1]=nh[ja(St+yt,127)],Pt.lc=St+yt}if(!nt.Rb)return Fa(q,4,"Not a key frame.");for(ot(Qe),nt=q.Pa,me=0;4>me;++me){for(Ye=0;8>Ye;++Ye)for(Ie=0;3>Ie;++Ie)for(lt=0;11>lt;++lt)At=Ke(Qe,Nd[me][Ye][Ie][lt])?De(Qe,8):Oy[me][Ye][Ie][lt],nt.Wc[me][Ye].Yb[Ie][lt]=At;for(Ye=0;17>Ye;++Ye)nt.Xc[me][Ye]=nt.Wc[me][Np[Ye]]}return q.kc=ot(Qe),q.kc&&(q.Bd=De(Qe,8)),q.cb=1}function ll(q,K,me,Ie,Ye,Qe,nt){var lt=K[Ye].Yb[me];for(me=0;16>Ye;++Ye){if(!Ke(q,lt[me+0]))return Ye;for(;!Ke(q,lt[me+1]);)if(lt=K[++Ye].Yb[0],me=0,Ye==16)return 16;var yt=K[Ye+1].Yb;if(Ke(q,lt[me+2])){var At=q,Xt=0;if(Ke(At,(St=lt)[(_r=me)+3]))if(Ke(At,St[_r+6])){for(lt=0,_r=2*(Xt=Ke(At,St[_r+8]))+(St=Ke(At,St[_r+9+Xt])),Xt=0,St=Dy[_r];St[lt];++lt)Xt+=Xt+Ke(At,St[lt]);Xt+=3+(8<<_r)}else Ke(At,St[_r+7])?(Xt=7+2*Ke(At,165),Xt+=Ke(At,145)):Xt=5+Ke(At,159);else Xt=Ke(At,St[_r+4])?3+Ke(At,St[_r+5]):2;lt=yt[2]}else Xt=1,lt=yt[1];yt=nt+Od[Ye],0>(At=q).b&&Be(At);var _r,St=At.b,Pt=(_r=At.Ca>>1)-(At.I>>St)>>31;--At.b,At.Ca+=Pt,At.Ca|=1,At.I-=(_r+1&Pt)<<St,Qe[yt]=((Xt^Pt)-Pt)*Ie[(0<Ye)+0]}return 16}function rs(q){var K=q.rb[q.sb-1];K.la=0,K.Na=0,i(q.zc,0,0,q.zc.length),q.ja=0}function so(q,K,me,Ie,Ye){Ye=q[K+me+32*Ie]+(Ye>>3),q[K+me+32*Ie]=-256&Ye?0>Ye?0:255:Ye}function ns(q,K,me,Ie,Ye,Qe){so(q,K,0,me,Ie+Ye),so(q,K,1,me,Ie+Qe),so(q,K,2,me,Ie-Qe),so(q,K,3,me,Ie-Ye)}function Ba(q){return(20091*q>>16)+q}function Vs(q,K,me,Ie){var Ye,Qe=0,nt=a(16);for(Ye=0;4>Ye;++Ye){var lt=q[K+0]+q[K+8],yt=q[K+0]-q[K+8],At=(35468*q[K+4]>>16)-Ba(q[K+12]),Xt=Ba(q[K+4])+(35468*q[K+12]>>16);nt[Qe+0]=lt+Xt,nt[Qe+1]=yt+At,nt[Qe+2]=yt-At,nt[Qe+3]=lt-Xt,Qe+=4,K++}for(Ye=Qe=0;4>Ye;++Ye)lt=(q=nt[Qe+0]+4)+nt[Qe+8],yt=q-nt[Qe+8],At=(35468*nt[Qe+4]>>16)-Ba(nt[Qe+12]),so(me,Ie,0,0,lt+(Xt=Ba(nt[Qe+4])+(35468*nt[Qe+12]>>16))),so(me,Ie,1,0,yt+At),so(me,Ie,2,0,yt-At),so(me,Ie,3,0,lt-Xt),Qe++,Ie+=32}function Uc(q,K,me,Ie){var Ye=q[K+0]+4,Qe=35468*q[K+4]>>16,nt=Ba(q[K+4]),lt=35468*q[K+1]>>16;ns(me,Ie,0,Ye+nt,q=Ba(q[K+1]),lt),ns(me,Ie,1,Ye+Qe,q,lt),ns(me,Ie,2,Ye-Qe,q,lt),ns(me,Ie,3,Ye-nt,q,lt)}function Pu(q,K,me,Ie,Ye){Vs(q,K,me,Ie),Ye&&Vs(q,K+16,me,Ie+4)}function Q(q,K,me,Ie){_(q,K+0,me,Ie,1),_(q,K+32,me,Ie+128,1)}function ge(q,K,me,Ie){var Ye;for(q=q[K+0]+4,Ye=0;4>Ye;++Ye)for(K=0;4>K;++K)so(me,Ie,K,Ye,q)}function Je(q,K,me,Ie){q[K+0]&&ne(q,K+0,me,Ie),q[K+16]&&ne(q,K+16,me,Ie+4),q[K+32]&&ne(q,K+32,me,Ie+128),q[K+48]&&ne(q,K+48,me,Ie+128+4)}function It(q,K,me,Ie){var Ye,Qe=a(16);for(Ye=0;4>Ye;++Ye){var nt=q[K+0+Ye]+q[K+12+Ye],lt=q[K+4+Ye]+q[K+8+Ye],yt=q[K+4+Ye]-q[K+8+Ye],At=q[K+0+Ye]-q[K+12+Ye];Qe[0+Ye]=nt+lt,Qe[8+Ye]=nt-lt,Qe[4+Ye]=At+yt,Qe[12+Ye]=At-yt}for(Ye=0;4>Ye;++Ye)nt=(q=Qe[0+4*Ye]+3)+Qe[3+4*Ye],lt=Qe[1+4*Ye]+Qe[2+4*Ye],yt=Qe[1+4*Ye]-Qe[2+4*Ye],At=q-Qe[3+4*Ye],me[Ie+0]=nt+lt>>3,me[Ie+16]=At+yt>>3,me[Ie+32]=nt-lt>>3,me[Ie+48]=At-yt>>3,Ie+=64}function Vt(q,K,me){var Ie,Ye=K-32,Qe=To,nt=255-q[Ye-1];for(Ie=0;Ie<me;++Ie){var lt,yt=Qe,At=nt+q[K-1];for(lt=0;lt<me;++lt)q[K+lt]=yt[At+q[Ye+lt]];K+=32}}function $t(q,K){Vt(q,K,4)}function er(q,K){Vt(q,K,8)}function Yr(q,K){Vt(q,K,16)}function tn(q,K){var me;for(me=0;16>me;++me)n(q,K+32*me,q,K-32,16)}function Gr(q,K){var me;for(me=16;0<me;--me)i(q,K,q[K-1],16),K+=32}function an(q,K,me){var Ie;for(Ie=0;16>Ie;++Ie)i(K,me+32*Ie,q,16)}function Mr(q,K){var me,Ie=16;for(me=0;16>me;++me)Ie+=q[K-1+32*me]+q[K+me-32];an(Ie>>5,q,K)}function ti(q,K){var me,Ie=8;for(me=0;16>me;++me)Ie+=q[K-1+32*me];an(Ie>>4,q,K)}function ki(q,K){var me,Ie=8;for(me=0;16>me;++me)Ie+=q[K+me-32];an(Ie>>4,q,K)}function $n(q,K){an(128,q,K)}function _n(q,K,me){return q+2*K+me+2>>2}function Rr(q,K){var me,Ie=K-32;for(Ie=new Uint8Array([_n(q[Ie-1],q[Ie+0],q[Ie+1]),_n(q[Ie+0],q[Ie+1],q[Ie+2]),_n(q[Ie+1],q[Ie+2],q[Ie+3]),_n(q[Ie+2],q[Ie+3],q[Ie+4])]),me=0;4>me;++me)n(q,K+32*me,Ie,0,Ie.length)}function fn(q,K){var me=q[K-1],Ie=q[K-1+32],Ye=q[K-1+64],Qe=q[K-1+96];it(q,K+0,16843009*_n(q[K-1-32],me,Ie)),it(q,K+32,16843009*_n(me,Ie,Ye)),it(q,K+64,16843009*_n(Ie,Ye,Qe)),it(q,K+96,16843009*_n(Ye,Qe,Qe))}function mn(q,K){var me,Ie=4;for(me=0;4>me;++me)Ie+=q[K+me-32]+q[K-1+32*me];for(Ie>>=3,me=0;4>me;++me)i(q,K+32*me,Ie,4)}function fi(q,K){var me=q[K-1+0],Ie=q[K-1+32],Ye=q[K-1+64],Qe=q[K-1-32],nt=q[K+0-32],lt=q[K+1-32],yt=q[K+2-32],At=q[K+3-32];q[K+0+96]=_n(Ie,Ye,q[K-1+96]),q[K+1+96]=q[K+0+64]=_n(me,Ie,Ye),q[K+2+96]=q[K+1+64]=q[K+0+32]=_n(Qe,me,Ie),q[K+3+96]=q[K+2+64]=q[K+1+32]=q[K+0+0]=_n(nt,Qe,me),q[K+3+64]=q[K+2+32]=q[K+1+0]=_n(lt,nt,Qe),q[K+3+32]=q[K+2+0]=_n(yt,lt,nt),q[K+3+0]=_n(At,yt,lt)}function $i(q,K){var me=q[K+1-32],Ie=q[K+2-32],Ye=q[K+3-32],Qe=q[K+4-32],nt=q[K+5-32],lt=q[K+6-32],yt=q[K+7-32];q[K+0+0]=_n(q[K+0-32],me,Ie),q[K+1+0]=q[K+0+32]=_n(me,Ie,Ye),q[K+2+0]=q[K+1+32]=q[K+0+64]=_n(Ie,Ye,Qe),q[K+3+0]=q[K+2+32]=q[K+1+64]=q[K+0+96]=_n(Ye,Qe,nt),q[K+3+32]=q[K+2+64]=q[K+1+96]=_n(Qe,nt,lt),q[K+3+64]=q[K+2+96]=_n(nt,lt,yt),q[K+3+96]=_n(lt,yt,yt)}function ba(q,K){var me=q[K-1+0],Ie=q[K-1+32],Ye=q[K-1+64],Qe=q[K-1-32],nt=q[K+0-32],lt=q[K+1-32],yt=q[K+2-32],At=q[K+3-32];q[K+0+0]=q[K+1+64]=Qe+nt+1>>1,q[K+1+0]=q[K+2+64]=nt+lt+1>>1,q[K+2+0]=q[K+3+64]=lt+yt+1>>1,q[K+3+0]=yt+At+1>>1,q[K+0+96]=_n(Ye,Ie,me),q[K+0+64]=_n(Ie,me,Qe),q[K+0+32]=q[K+1+96]=_n(me,Qe,nt),q[K+1+32]=q[K+2+96]=_n(Qe,nt,lt),q[K+2+32]=q[K+3+96]=_n(nt,lt,yt),q[K+3+32]=_n(lt,yt,At)}function wi(q,K){var me=q[K+0-32],Ie=q[K+1-32],Ye=q[K+2-32],Qe=q[K+3-32],nt=q[K+4-32],lt=q[K+5-32],yt=q[K+6-32],At=q[K+7-32];q[K+0+0]=me+Ie+1>>1,q[K+1+0]=q[K+0+64]=Ie+Ye+1>>1,q[K+2+0]=q[K+1+64]=Ye+Qe+1>>1,q[K+3+0]=q[K+2+64]=Qe+nt+1>>1,q[K+0+32]=_n(me,Ie,Ye),q[K+1+32]=q[K+0+96]=_n(Ie,Ye,Qe),q[K+2+32]=q[K+1+96]=_n(Ye,Qe,nt),q[K+3+32]=q[K+2+96]=_n(Qe,nt,lt),q[K+3+64]=_n(nt,lt,yt),q[K+3+96]=_n(lt,yt,At)}function hi(q,K){var me=q[K-1+0],Ie=q[K-1+32],Ye=q[K-1+64],Qe=q[K-1+96];q[K+0+0]=me+Ie+1>>1,q[K+2+0]=q[K+0+32]=Ie+Ye+1>>1,q[K+2+32]=q[K+0+64]=Ye+Qe+1>>1,q[K+1+0]=_n(me,Ie,Ye),q[K+3+0]=q[K+1+32]=_n(Ie,Ye,Qe),q[K+3+32]=q[K+1+64]=_n(Ye,Qe,Qe),q[K+3+64]=q[K+2+64]=q[K+0+96]=q[K+1+96]=q[K+2+96]=q[K+3+96]=Qe}function Cs(q,K){var me=q[K-1+0],Ie=q[K-1+32],Ye=q[K-1+64],Qe=q[K-1+96],nt=q[K-1-32],lt=q[K+0-32],yt=q[K+1-32],At=q[K+2-32];q[K+0+0]=q[K+2+32]=me+nt+1>>1,q[K+0+32]=q[K+2+64]=Ie+me+1>>1,q[K+0+64]=q[K+2+96]=Ye+Ie+1>>1,q[K+0+96]=Qe+Ye+1>>1,q[K+3+0]=_n(lt,yt,At),q[K+2+0]=_n(nt,lt,yt),q[K+1+0]=q[K+3+32]=_n(me,nt,lt),q[K+1+32]=q[K+3+64]=_n(Ie,me,nt),q[K+1+64]=q[K+3+96]=_n(Ye,Ie,me),q[K+1+96]=_n(Qe,Ye,Ie)}function $s(q,K){var me;for(me=0;8>me;++me)n(q,K+32*me,q,K-32,8)}function Ri(q,K){var me;for(me=0;8>me;++me)i(q,K,q[K-1],8),K+=32}function As(q,K,me){var Ie;for(Ie=0;8>Ie;++Ie)i(K,me+32*Ie,q,8)}function oa(q,K){var me,Ie=8;for(me=0;8>me;++me)Ie+=q[K+me-32]+q[K-1+32*me];As(Ie>>4,q,K)}function Mu(q,K){var me,Ie=4;for(me=0;8>me;++me)Ie+=q[K+me-32];As(Ie>>3,q,K)}function Ka(q,K){var me,Ie=4;for(me=0;8>me;++me)Ie+=q[K-1+32*me];As(Ie>>3,q,K)}function qs(q,K){As(128,q,K)}function Vo(q,K,me){var Ie=q[K-me],Ye=q[K+0],Qe=3*(Ye-Ie)+Gl[1020+q[K-2*me]-q[K+me]],nt=Wl[112+(Qe+4>>3)];q[K-me]=To[255+Ie+Wl[112+(Qe+3>>3)]],q[K+0]=To[255+Ye-nt]}function ku(q,K,me,Ie){var Ye=q[K+0],Qe=q[K+me];return ni[255+q[K-2*me]-q[K-me]]>Ie||ni[255+Qe-Ye]>Ie}function Ru(q,K,me,Ie){return 4*ni[255+q[K-me]-q[K+0]]+ni[255+q[K-2*me]-q[K+me]]<=Ie}function go(q,K,me,Ie,Ye){var Qe=q[K-3*me],nt=q[K-2*me],lt=q[K-me],yt=q[K+0],At=q[K+me],Xt=q[K+2*me],_r=q[K+3*me];return 4*ni[255+lt-yt]+ni[255+nt-At]>Ie?0:ni[255+q[K-4*me]-Qe]<=Ye&&ni[255+Qe-nt]<=Ye&&ni[255+nt-lt]<=Ye&&ni[255+_r-Xt]<=Ye&&ni[255+Xt-At]<=Ye&&ni[255+At-yt]<=Ye}function ji(q,K,me,Ie){var Ye=2*Ie+1;for(Ie=0;16>Ie;++Ie)Ru(q,K+Ie,me,Ye)&&Vo(q,K+Ie,me)}function Hs(q,K,me,Ie){var Ye=2*Ie+1;for(Ie=0;16>Ie;++Ie)Ru(q,K+Ie*me,1,Ye)&&Vo(q,K+Ie*me,1)}function ii(q,K,me,Ie){var Ye;for(Ye=3;0<Ye;--Ye)ji(q,K+=4*me,me,Ie)}function ri(q,K,me,Ie){var Ye;for(Ye=3;0<Ye;--Ye)Hs(q,K+=4,me,Ie)}function Oo(q,K,me,Ie,Ye,Qe,nt,lt){for(Qe=2*Qe+1;0<Ye--;){if(go(q,K,me,Qe,nt))if(ku(q,K,me,lt))Vo(q,K,me);else{var yt=q,At=K,Xt=me,_r=yt[At-2*Xt],St=yt[At-Xt],Pt=yt[At+0],fr=yt[At+Xt],Nr=yt[At+2*Xt],gr=27*(jr=Gl[1020+3*(Pt-St)+Gl[1020+_r-fr]])+63>>7,Br=18*jr+63>>7,jr=9*jr+63>>7;yt[At-3*Xt]=To[255+yt[At-3*Xt]+jr],yt[At-2*Xt]=To[255+_r+Br],yt[At-Xt]=To[255+St+gr],yt[At+0]=To[255+Pt-gr],yt[At+Xt]=To[255+fr-Br],yt[At+2*Xt]=To[255+Nr-jr]}K+=Ie}}function ai(q,K,me,Ie,Ye,Qe,nt,lt){for(Qe=2*Qe+1;0<Ye--;){if(go(q,K,me,Qe,nt))if(ku(q,K,me,lt))Vo(q,K,me);else{var yt=q,At=K,Xt=me,_r=yt[At-Xt],St=yt[At+0],Pt=yt[At+Xt],fr=Wl[112+(4+(Nr=3*(St-_r))>>3)],Nr=Wl[112+(Nr+3>>3)],gr=fr+1>>1;yt[At-2*Xt]=To[255+yt[At-2*Xt]+gr],yt[At-Xt]=To[255+_r+Nr],yt[At+0]=To[255+St-fr],yt[At+Xt]=To[255+Pt-gr]}K+=Ie}}function ue(q,K,me,Ie,Ye,Qe){Oo(q,K,me,1,16,Ie,Ye,Qe)}function We(q,K,me,Ie,Ye,Qe){Oo(q,K,1,me,16,Ie,Ye,Qe)}function bt(q,K,me,Ie,Ye,Qe){var nt;for(nt=3;0<nt;--nt)ai(q,K+=4*me,me,1,16,Ie,Ye,Qe)}function Bt(q,K,me,Ie,Ye,Qe){var nt;for(nt=3;0<nt;--nt)ai(q,K+=4,1,me,16,Ie,Ye,Qe)}function sr(q,K,me,Ie,Ye,Qe,nt,lt){Oo(q,K,Ye,1,8,Qe,nt,lt),Oo(me,Ie,Ye,1,8,Qe,nt,lt)}function Lr(q,K,me,Ie,Ye,Qe,nt,lt){Oo(q,K,1,Ye,8,Qe,nt,lt),Oo(me,Ie,1,Ye,8,Qe,nt,lt)}function Zr(q,K,me,Ie,Ye,Qe,nt,lt){ai(q,K+4*Ye,Ye,1,8,Qe,nt,lt),ai(me,Ie+4*Ye,Ye,1,8,Qe,nt,lt)}function Nn(q,K,me,Ie,Ye,Qe,nt,lt){ai(q,K+4,1,Ye,8,Qe,nt,lt),ai(me,Ie+4,1,Ye,8,Qe,nt,lt)}function qn(){this.ba=new zr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new en,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Un(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ui(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Hn(){this.ua=0,this.Wa=new Ht,this.vb=new Ht,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new fe,this.yc=new ae}function Ui(){this.xb=this.a=0,this.l=new gs,this.ca=new zr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Ee,this.Pb=0,this.wd=new Ee,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Hn,this.ab=0,this.gc=s(4,ui),this.Oc=0}function Xi(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new gs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ra(q,K,me,Ie,Ye,Qe,nt){for(q=q==null?0:q[K+0],K=0;K<nt;++K)Ye[Qe+K]=q+me[Ie+K]&255,q=Ye[Qe+K]}function Si(q,K,me,Ie,Ye,Qe,nt){var lt;if(q==null)ra(null,null,me,Ie,Ye,Qe,nt);else for(lt=0;lt<nt;++lt)Ye[Qe+lt]=q[K+lt]+me[Ie+lt]&255}function Ia(q,K,me,Ie,Ye,Qe,nt){if(q==null)ra(null,null,me,Ie,Ye,Qe,nt);else{var lt,yt=q[K+0],At=yt,Xt=yt;for(lt=0;lt<nt;++lt)At=Xt+(yt=q[K+lt])-At,Xt=me[Ie+lt]+(-256&At?0>At?0:255:At)&255,At=yt,Ye[Qe+lt]=Xt}}function za(q,K,me,Ie){var Ye=K.width,Qe=K.o;if(e(q!=null&&K!=null),0>me||0>=Ie||me+Ie>Qe)return null;if(!q.Cc){if(q.ga==null){var nt;if(q.ga=new Xi,(nt=q.ga==null)||(nt=K.width*K.o,e(q.Gb.length==0),q.Gb=a(nt),q.Uc=0,q.Gb==null?nt=0:(q.mb=q.Gb,q.nb=q.Uc,q.rc=null,nt=1),nt=!nt),!nt){nt=q.ga;var lt=q.Fa,yt=q.P,At=q.qc,Xt=q.mb,_r=q.nb,St=yt+1,Pt=At-1,fr=nt.l;if(e(lt!=null&&Xt!=null&&K!=null),oc[0]=null,oc[1]=ra,oc[2]=Si,oc[3]=Ia,nt.ca=Xt,nt.tb=_r,nt.c=K.width,nt.i=K.height,e(0<nt.c&&0<nt.i),1>=At)K=0;else if(nt.$a=3&lt[yt+0],nt.Z=lt[yt+0]>>2&3,nt.Lc=lt[yt+0]>>4&3,yt=lt[yt+0]>>6&3,0>nt.$a||1<nt.$a||4<=nt.Z||1<nt.Lc||yt)K=0;else if(fr.put=ln,fr.ac=oi,fr.bc=Kn,fr.ma=nt,fr.width=K.width,fr.height=K.height,fr.Da=K.Da,fr.v=K.v,fr.va=K.va,fr.j=K.j,fr.o=K.o,nt.$a)e:{e(nt.$a==1),K=ua();t:for(;;){if(K==null){K=0;break e}if(e(nt!=null),nt.mc=K,K.c=nt.c,K.i=nt.i,K.l=nt.l,K.l.ma=nt,K.l.width=nt.c,K.l.height=nt.i,K.a=0,we(K.m,lt,St,Pt),!ha(nt.c,nt.i,1,K,null)||(K.ab==1&&K.gc[0].hc==3&&Ci(K.s)?(nt.ic=1,lt=K.c*K.i,K.Ta=null,K.Ua=0,K.V=a(lt),K.Ba=0,K.V==null?(K.a=1,K=0):K=1):(nt.ic=0,K=zn(K,nt.c)),!K))break t;K=1;break e}nt.mc=null,K=0}else K=Pt>=nt.c*nt.i;nt=!K}if(nt)return null;q.ga.Lc!=1?q.Ga=0:Ie=Qe-me}e(q.ga!=null),e(me+Ie<=Qe);e:{if(K=(lt=q.ga).c,Qe=lt.l.o,lt.$a==0){if(St=q.rc,Pt=q.Vc,fr=q.Fa,yt=q.P+1+me*K,At=q.mb,Xt=q.nb+me*K,e(yt<=q.P+q.qc),lt.Z!=0)for(e(oc[lt.Z]!=null),nt=0;nt<Ie;++nt)oc[lt.Z](St,Pt,fr,yt,At,Xt,K),St=At,Pt=Xt,Xt+=K,yt+=K;else for(nt=0;nt<Ie;++nt)n(At,Xt,fr,yt,K),St=At,Pt=Xt,Xt+=K,yt+=K;q.rc=St,q.Vc=Pt}else{if(e(lt.mc!=null),K=me+Ie,e((nt=lt.mc)!=null),e(K<=nt.i),nt.C>=K)K=1;else if(lt.ic||Xs(),lt.ic){lt=nt.V,St=nt.Ba,Pt=nt.c;var Nr=nt.i,gr=(fr=1,yt=nt.$/Pt,At=nt.$%Pt,Xt=nt.m,_r=nt.s,nt.$),Br=Pt*Nr,jr=Pt*K,on=_r.wc,Jr=gr<jr?Xr(_r,At,yt):null;e(gr<=Br),e(K<=Nr),e(Ci(_r));t:for(;;){for(;!Xt.h&&gr<jr;){if(At&on||(Jr=Xr(_r,At,yt)),e(Jr!=null),Xe(Xt),256>(Nr=Gt(Jr.G[0],Jr.H[0],Xt)))lt[St+gr]=Nr,++gr,++At>=Pt&&(At=0,++yt<=K&&!(yt%16)&&Rn(nt,yt));else{if(!(280>Nr)){fr=0;break t}Nr=He(Nr-256,Xt);var Jn,Vn=Gt(Jr.G[4],Jr.H[4],Xt);if(Xe(Xt),!(gr>=(Vn=Tt(Pt,Vn=He(Vn,Xt)))&&Br-gr>=Nr)){fr=0;break t}for(Jn=0;Jn<Nr;++Jn)lt[St+gr+Jn]=lt[St+gr+Jn-Vn];for(gr+=Nr,At+=Nr;At>=Pt;)At-=Pt,++yt<=K&&!(yt%16)&&Rn(nt,yt);gr<jr&&At&on&&(Jr=Xr(_r,At,yt))}e(Xt.h==Ne(Xt))}Rn(nt,yt>K?K:yt);break t}!fr||Xt.h&&gr<Br?(fr=0,nt.a=Xt.h?5:3):nt.$=gr,K=fr}else K=Bn(nt,nt.V,nt.Ba,nt.c,nt.i,K,Na);if(!K){Ie=0;break e}}me+Ie>=Qe&&(q.Cc=1),Ie=1}if(!Ie)return null;if(q.Cc&&((Ie=q.ga)!=null&&(Ie.mc=null),q.ga=null,0<q.Ga))return alert("todo:WebPDequantizeLevels"),null}return q.nb+me*Ye}function Gs(q,K,me,Ie,Ye,Qe){for(;0<Ye--;){var nt,lt=q,yt=K+(me?1:0),At=q,Xt=K+(me?0:3);for(nt=0;nt<Ie;++nt){var _r=At[Xt+4*nt];_r!=255&&(_r*=32897,lt[yt+4*nt+0]=lt[yt+4*nt+0]*_r>>23,lt[yt+4*nt+1]=lt[yt+4*nt+1]*_r>>23,lt[yt+4*nt+2]=lt[yt+4*nt+2]*_r>>23)}K+=Qe}}function ul(q,K,me,Ie,Ye){for(;0<Ie--;){var Qe;for(Qe=0;Qe<me;++Qe){var nt=q[K+2*Qe+0],lt=15&(At=q[K+2*Qe+1]),yt=4369*lt,At=(240&At|At>>4)*yt>>16;q[K+2*Qe+0]=(240&nt|nt>>4)*yt>>16&240|(15&nt|nt<<4)*yt>>16>>4&15,q[K+2*Qe+1]=240&At|lt}K+=Ye}}function Ws(q,K,me,Ie,Ye,Qe,nt,lt){var yt,At,Xt=255;for(At=0;At<Ye;++At){for(yt=0;yt<Ie;++yt){var _r=q[K+yt];Qe[nt+4*yt]=_r,Xt&=_r}K+=me,nt+=lt}return Xt!=255}function $o(q,K,me,Ie,Ye){var Qe;for(Qe=0;Qe<Ye;++Qe)me[Ie+Qe]=q[K+Qe]>>8}function Xs(){ca=Gs,lo=ul,Ma=Ws,Ho=$o}function Pa(q,K,me){X[q]=function(Ie,Ye,Qe,nt,lt,yt,At,Xt,_r,St,Pt,fr,Nr,gr,Br,jr,on){var Jr,Jn=on-1>>1,Vn=lt[yt+0]|At[Xt+0]<<16,Ai=_r[St+0]|Pt[fr+0]<<16;e(Ie!=null);var Zn=3*Vn+Ai+131074>>2;for(K(Ie[Ye+0],255&Zn,Zn>>16,Nr,gr),Qe!=null&&(Zn=3*Ai+Vn+131074>>2,K(Qe[nt+0],255&Zn,Zn>>16,Br,jr)),Jr=1;Jr<=Jn;++Jr){var Yi=lt[yt+Jr]|At[Xt+Jr]<<16,No=_r[St+Jr]|Pt[fr+Jr]<<16,Li=Vn+Yi+Ai+No+524296,Yn=Li+2*(Yi+Ai)>>3;Zn=Yn+Vn>>1,Vn=(Li=Li+2*(Vn+No)>>3)+Yi>>1,K(Ie[Ye+2*Jr-1],255&Zn,Zn>>16,Nr,gr+(2*Jr-1)*me),K(Ie[Ye+2*Jr-0],255&Vn,Vn>>16,Nr,gr+(2*Jr-0)*me),Qe!=null&&(Zn=Li+Ai>>1,Vn=Yn+No>>1,K(Qe[nt+2*Jr-1],255&Zn,Zn>>16,Br,jr+(2*Jr-1)*me),K(Qe[nt+2*Jr+0],255&Vn,Vn>>16,Br,jr+(2*Jr+0)*me)),Vn=Yi,Ai=No}1&on||(Zn=3*Vn+Ai+131074>>2,K(Ie[Ye+on-1],255&Zn,Zn>>16,Nr,gr+(on-1)*me),Qe!=null&&(Zn=3*Ai+Vn+131074>>2,K(Qe[nt+on-1],255&Zn,Zn>>16,Br,jr+(on-1)*me)))}}function Ys(){pl[Lu]=Fp,pl[eh]=Bh,pl[yf]=_f,pl[pu]=bf,pl[kp]=ah,pl[Vg]=Xg,pl[$g]=Ny,pl[qg]=Bh,pl[Rd]=bf,pl[Vc]=ah,pl[th]=Xg}function Il(q){return q&-16384?0>q?0:255:q>>Yg}function ms(q,K){return Il((19077*q>>8)+(26149*K>>8)-14234)}function Di(q,K,me){return Il((19077*q>>8)-(6419*K>>8)-(13320*me>>8)+8708)}function qo(q,K){return Il((19077*q>>8)+(33050*K>>8)-17685)}function Da(q,K,me,Ie,Ye){Ie[Ye+0]=ms(q,me),Ie[Ye+1]=Di(q,K,me),Ie[Ye+2]=qo(q,K)}function is(q,K,me,Ie,Ye){Ie[Ye+0]=qo(q,K),Ie[Ye+1]=Di(q,K,me),Ie[Ye+2]=ms(q,me)}function Is(q,K,me,Ie,Ye){var Qe=Di(q,K,me);K=Qe<<3&224|qo(q,K)>>3,Ie[Ye+0]=248&ms(q,me)|Qe>>5,Ie[Ye+1]=K}function Ja(q,K,me,Ie,Ye){var Qe=240&qo(q,K)|15;Ie[Ye+0]=240&ms(q,me)|Di(q,K,me)>>4,Ie[Ye+1]=Qe}function nc(q,K,me,Ie,Ye){Ie[Ye+0]=255,Da(q,K,me,Ie,Ye+1)}function uu(q,K,me,Ie,Ye){is(q,K,me,Ie,Ye),Ie[Ye+3]=255}function Zs(q,K,me,Ie,Ye){Da(q,K,me,Ie,Ye),Ie[Ye+3]=255}function ja(q,K){return 0>q?0:q>K?K:q}function Ps(q,K,me){X[q]=function(Ie,Ye,Qe,nt,lt,yt,At,Xt,_r){for(var St=Xt+(-2&_r)*me;Xt!=St;)K(Ie[Ye+0],Qe[nt+0],lt[yt+0],At,Xt),K(Ie[Ye+1],Qe[nt+0],lt[yt+0],At,Xt+me),Ye+=2,++nt,++yt,Xt+=2*me;1&_r&&K(Ie[Ye+0],Qe[nt+0],lt[yt+0],At,Xt)}}function ic(q,K,me){return me==0?q==0?K==0?6:5:K==0?4:0:me}function ac(q,K,me,Ie,Ye){switch(q>>>30){case 3:_(K,me,Ie,Ye,0);break;case 2:P(K,me,Ie,Ye);break;case 1:ne(K,me,Ie,Ye)}}function cl(q,K){var me,Ie,Ye=K.M,Qe=K.Nb,nt=q.oc,lt=q.pc+40,yt=q.oc,At=q.pc+584,Xt=q.oc,_r=q.pc+600;for(me=0;16>me;++me)nt[lt+32*me-1]=129;for(me=0;8>me;++me)yt[At+32*me-1]=129,Xt[_r+32*me-1]=129;for(0<Ye?nt[lt-1-32]=yt[At-1-32]=Xt[_r-1-32]=129:(i(nt,lt-32-1,127,21),i(yt,At-32-1,127,9),i(Xt,_r-32-1,127,9)),Ie=0;Ie<q.za;++Ie){var St=K.ya[K.aa+Ie];if(0<Ie){for(me=-1;16>me;++me)n(nt,lt+32*me-4,nt,lt+32*me+12,4);for(me=-1;8>me;++me)n(yt,At+32*me-4,yt,At+32*me+4,4),n(Xt,_r+32*me-4,Xt,_r+32*me+4,4)}var Pt=q.Gd,fr=q.Hd+Ie,Nr=St.ad,gr=St.Hc;if(0<Ye&&(n(nt,lt-32,Pt[fr].y,0,16),n(yt,At-32,Pt[fr].f,0,8),n(Xt,_r-32,Pt[fr].ea,0,8)),St.Za){var Br=nt,jr=lt-32+16;for(0<Ye&&(Ie>=q.za-1?i(Br,jr,Pt[fr].y[15],4):n(Br,jr,Pt[fr+1].y,0,4)),me=0;4>me;me++)Br[jr+128+me]=Br[jr+256+me]=Br[jr+384+me]=Br[jr+0+me];for(me=0;16>me;++me,gr<<=2)Br=nt,jr=lt+zp[me],Nu[St.Ob[me]](Br,jr),ac(gr,Nr,16*+me,Br,jr)}else if(Br=ic(Ie,Ye,St.Ob[0]),$c[Br](nt,lt),gr!=0)for(me=0;16>me;++me,gr<<=2)ac(gr,Nr,16*+me,nt,lt+zp[me]);for(me=St.Gc,Br=ic(Ie,Ye,St.Dd),xa[Br](yt,At),xa[Br](Xt,_r),gr=Nr,Br=yt,jr=At,255&(St=0|me)&&(170&St?$(gr,256,Br,jr):ve(gr,256,Br,jr)),St=Xt,gr=_r,255&(me>>=8)&&(170&me?$(Nr,320,St,gr):ve(Nr,320,St,gr)),Ye<q.Ub-1&&(n(Pt[fr].y,0,nt,lt+480,16),n(Pt[fr].f,0,yt,At+224,8),n(Pt[fr].ea,0,Xt,_r+224,8)),me=8*Qe*q.B,Pt=q.sa,fr=q.ta+16*Ie+16*Qe*q.R,Nr=q.qa,St=q.ra+8*Ie+me,gr=q.Ha,Br=q.Ia+8*Ie+me,me=0;16>me;++me)n(Pt,fr+me*q.R,nt,lt+32*me,16);for(me=0;8>me;++me)n(Nr,St+me*q.B,yt,At+32*me,8),n(gr,Br+me*q.B,Xt,_r+32*me,8)}}function cu(q,K,me,Ie,Ye,Qe,nt,lt,yt){var At=[0],Xt=[0],_r=0,St=yt!=null?yt.kd:0,Pt=yt??new Un;if(q==null||12>me)return 7;Pt.data=q,Pt.w=K,Pt.ha=me,K=[K],me=[me],Pt.gb=[Pt.gb];e:{var fr=K,Nr=me,gr=Pt.gb;if(e(q!=null),e(Nr!=null),e(gr!=null),gr[0]=0,12<=Nr[0]&&!r(q,fr[0],"RIFF")){if(r(q,fr[0]+8,"WEBP")){gr=3;break e}var Br=st(q,fr[0]+4);if(12>Br||4294967286<Br){gr=3;break e}if(St&&Br>Nr[0]-8){gr=7;break e}gr[0]=Br,fr[0]+=12,Nr[0]-=12}gr=0}if(gr!=0)return gr;for(Br=0<Pt.gb[0],me=me[0];;){e:{var jr=q;Nr=K,gr=me;var on=At,Jr=Xt,Jn=fr=[0];if((Zn=_r=[_r])[0]=0,8>gr[0])gr=7;else{if(!r(jr,Nr[0],"VP8X")){if(st(jr,Nr[0]+4)!=10){gr=3;break e}if(18>gr[0]){gr=7;break e}var Vn=st(jr,Nr[0]+8),Ai=1+zt(jr,Nr[0]+12);if(2147483648<=Ai*(jr=1+zt(jr,Nr[0]+15))){gr=3;break e}Jn!=null&&(Jn[0]=Vn),on!=null&&(on[0]=Ai),Jr!=null&&(Jr[0]=jr),Nr[0]+=18,gr[0]-=18,Zn[0]=1}gr=0}}if(_r=_r[0],fr=fr[0],gr!=0)return gr;if(Nr=!!(2&fr),!Br&&_r)return 3;if(Qe!=null&&(Qe[0]=!!(16&fr)),nt!=null&&(nt[0]=Nr),lt!=null&&(lt[0]=0),nt=At[0],fr=Xt[0],_r&&Nr&&yt==null){gr=0;break}if(4>me){gr=7;break}if(Br&&_r||!Br&&!_r&&!r(q,K[0],"ALPH")){me=[me],Pt.na=[Pt.na],Pt.P=[Pt.P],Pt.Sa=[Pt.Sa];e:{Vn=q,gr=K,Br=me;var Zn=Pt.gb;on=Pt.na,Jr=Pt.P,Jn=Pt.Sa,Ai=22,e(Vn!=null),e(Br!=null),jr=gr[0];var Yi=Br[0];for(e(on!=null),e(Jn!=null),on[0]=null,Jr[0]=null,Jn[0]=0;;){if(gr[0]=jr,Br[0]=Yi,8>Yi){gr=7;break e}var No=st(Vn,jr+4);if(4294967286<No){gr=3;break e}var Li=8+No+1&-2;if(Ai+=Li,0<Zn&&Ai>Zn){gr=3;break e}if(!r(Vn,jr,"VP8 ")||!r(Vn,jr,"VP8L")){gr=0;break e}if(Yi[0]<Li){gr=7;break e}r(Vn,jr,"ALPH")||(on[0]=Vn,Jr[0]=jr+8,Jn[0]=No),jr+=Li,Yi-=Li}}if(me=me[0],Pt.na=Pt.na[0],Pt.P=Pt.P[0],Pt.Sa=Pt.Sa[0],gr!=0)break}me=[me],Pt.Ja=[Pt.Ja],Pt.xa=[Pt.xa];e:if(Zn=q,gr=K,Br=me,on=Pt.gb[0],Jr=Pt.Ja,Jn=Pt.xa,Vn=gr[0],jr=!r(Zn,Vn,"VP8 "),Ai=!r(Zn,Vn,"VP8L"),e(Zn!=null),e(Br!=null),e(Jr!=null),e(Jn!=null),8>Br[0])gr=7;else{if(jr||Ai){if(Zn=st(Zn,Vn+4),12<=on&&Zn>on-12){gr=3;break e}if(St&&Zn>Br[0]-8){gr=7;break e}Jr[0]=Zn,gr[0]+=8,Br[0]-=8,Jn[0]=Ai}else Jn[0]=5<=Br[0]&&Zn[Vn+0]==47&&!(Zn[Vn+4]>>5),Jr[0]=Br[0];gr=0}if(me=me[0],Pt.Ja=Pt.Ja[0],Pt.xa=Pt.xa[0],K=K[0],gr!=0)break;if(4294967286<Pt.Ja)return 3;if(lt==null||Nr||(lt[0]=Pt.xa?2:1),nt=[nt],fr=[fr],Pt.xa){if(5>me){gr=7;break}lt=nt,St=fr,Nr=Qe,q==null||5>me?q=0:5<=me&&q[K+0]==47&&!(q[K+4]>>5)?(Br=[0],Zn=[0],on=[0],we(Jr=new Ee,q,K,me),ke(Jr,Br,Zn,on)?(lt!=null&&(lt[0]=Br[0]),St!=null&&(St[0]=Zn[0]),Nr!=null&&(Nr[0]=on[0]),q=1):q=0):q=0}else{if(10>me){gr=7;break}lt=fr,q==null||10>me||!_a(q,K+3,me-3)?q=0:(St=q[K+0]|q[K+1]<<8|q[K+2]<<16,Nr=16383&(q[K+7]<<8|q[K+6]),q=16383&(q[K+9]<<8|q[K+8]),1&St||3<(St>>1&7)||!(St>>4&1)||St>>5>=Pt.Ja||!Nr||!q?q=0:(nt&&(nt[0]=Nr),lt&&(lt[0]=q),q=1))}if(!q||(nt=nt[0],fr=fr[0],_r&&(At[0]!=nt||Xt[0]!=fr)))return 3;yt!=null&&(yt[0]=Pt,yt.offset=K-yt.w,e(4294967286>K-yt.w),e(yt.offset==yt.ha-me));break}return gr==0||gr==7&&_r&&yt==null?(Qe!=null&&(Qe[0]|=Pt.na!=null&&0<Pt.na.length),Ie!=null&&(Ie[0]=nt),Ye!=null&&(Ye[0]=fr),0):gr}function Lo(q,K,me){var Ie=K.width,Ye=K.height,Qe=0,nt=0,lt=Ie,yt=Ye;if(K.Da=q!=null&&0<q.Da,K.Da&&(lt=q.cd,yt=q.bd,Qe=q.v,nt=q.j,11>me||(Qe&=-2,nt&=-2),0>Qe||0>nt||0>=lt||0>=yt||Qe+lt>Ie||nt+yt>Ye))return 0;if(K.v=Qe,K.j=nt,K.va=Qe+lt,K.o=nt+yt,K.U=lt,K.T=yt,K.da=q!=null&&0<q.da,K.da){if(!pr(lt,yt,me=[q.ib],Qe=[q.hb]))return 0;K.ib=me[0],K.hb=Qe[0]}return K.ob=q!=null&&q.ob,K.Kb=q==null||!q.Sd,K.da&&(K.ob=K.ib<3*Ie/4&&K.hb<3*Ye/4,K.Kb=0),1}function mo(q){if(q==null)return 2;if(11>q.S){var K=q.f.RGBA;K.fb+=(q.height-1)*K.A,K.A=-K.A}else K=q.f.kb,q=q.height,K.O+=(q-1)*K.fa,K.fa=-K.fa,K.N+=(q-1>>1)*K.Ab,K.Ab=-K.Ab,K.W+=(q-1>>1)*K.Db,K.Db=-K.Db,K.F!=null&&(K.J+=(q-1)*K.lb,K.lb=-K.lb);return 0}function Du(q,K,me,Ie){if(Ie==null||0>=q||0>=K)return 2;if(me!=null){if(me.Da){var Ye=me.cd,Qe=me.bd,nt=-2&me.v,lt=-2&me.j;if(0>nt||0>lt||0>=Ye||0>=Qe||nt+Ye>q||lt+Qe>K)return 2;q=Ye,K=Qe}if(me.da){if(!pr(q,K,Ye=[me.ib],Qe=[me.hb]))return 2;q=Ye[0],K=Qe[0]}}Ie.width=q,Ie.height=K;e:{var yt=Ie.width,At=Ie.height;if(q=Ie.S,0>=yt||0>=At||!(q>=Lu&&13>q))q=2;else{if(0>=Ie.Rd&&Ie.sd==null){nt=Qe=Ye=K=0;var Xt=(lt=yt*Bu[q])*At;if(11>q||(Qe=(At+1)/2*(K=(yt+1)/2),q==12&&(nt=(Ye=yt)*At)),(At=a(Xt+2*Qe+nt))==null){q=1;break e}Ie.sd=At,11>q?((yt=Ie.f.RGBA).eb=At,yt.fb=0,yt.A=lt,yt.size=Xt):((yt=Ie.f.kb).y=At,yt.O=0,yt.fa=lt,yt.Fd=Xt,yt.f=At,yt.N=0+Xt,yt.Ab=K,yt.Cd=Qe,yt.ea=At,yt.W=0+Xt+Qe,yt.Db=K,yt.Ed=Qe,q==12&&(yt.F=At,yt.J=0+Xt+2*Qe),yt.Tc=nt,yt.lb=Ye)}if(K=1,Ye=Ie.S,Qe=Ie.width,nt=Ie.height,Ye>=Lu&&13>Ye)if(11>Ye)q=Ie.f.RGBA,K&=(lt=Math.abs(q.A))*(nt-1)+Qe<=q.size,K&=lt>=Qe*Bu[Ye],K&=q.eb!=null;else{q=Ie.f.kb,lt=(Qe+1)/2,Xt=(nt+1)/2,yt=Math.abs(q.fa),At=Math.abs(q.Ab);var _r=Math.abs(q.Db),St=Math.abs(q.lb),Pt=St*(nt-1)+Qe;K&=yt*(nt-1)+Qe<=q.Fd,K&=At*(Xt-1)+lt<=q.Cd,K=(K&=_r*(Xt-1)+lt<=q.Ed)&yt>=Qe&At>=lt&_r>=lt,K&=q.y!=null,K&=q.f!=null,K&=q.ea!=null,Ye==12&&(K&=St>=Qe,K&=Pt<=q.Tc,K&=q.F!=null)}else K=0;q=K?0:2}}return q!=0||me!=null&&me.fd&&(q=mo(Ie)),q}var Ua=64,fu=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ks=24,ys=32,Va=8,Vl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];br("Predictor0","PredictorAdd0"),X.Predictor0=function(){return 4278190080},X.Predictor1=function(q){return q},X.Predictor2=function(q,K,me){return K[me+0]},X.Predictor3=function(q,K,me){return K[me+1]},X.Predictor4=function(q,K,me){return K[me-1]},X.Predictor5=function(q,K,me){return Cr(Cr(q,K[me+1]),K[me+0])},X.Predictor6=function(q,K,me){return Cr(q,K[me-1])},X.Predictor7=function(q,K,me){return Cr(q,K[me+0])},X.Predictor8=function(q,K,me){return Cr(K[me-1],K[me+0])},X.Predictor9=function(q,K,me){return Cr(K[me+0],K[me+1])},X.Predictor10=function(q,K,me){return Cr(Cr(q,K[me-1]),Cr(K[me+0],K[me+1]))},X.Predictor11=function(q,K,me){var Ie=K[me+0];return 0>=at(Ie>>24&255,q>>24&255,(K=K[me-1])>>24&255)+at(Ie>>16&255,q>>16&255,K>>16&255)+at(Ie>>8&255,q>>8&255,K>>8&255)+at(255&Ie,255&q,255&K)?Ie:q},X.Predictor12=function(q,K,me){var Ie=K[me+0];return(Tr((q>>24&255)+(Ie>>24&255)-((K=K[me-1])>>24&255))<<24|Tr((q>>16&255)+(Ie>>16&255)-(K>>16&255))<<16|Tr((q>>8&255)+(Ie>>8&255)-(K>>8&255))<<8|Tr((255&q)+(255&Ie)-(255&K)))>>>0},X.Predictor13=function(q,K,me){var Ie=K[me-1];return(Qt((q=Cr(q,K[me+0]))>>24&255,Ie>>24&255)<<24|Qt(q>>16&255,Ie>>16&255)<<16|Qt(q>>8&255,Ie>>8&255)<<8|Qt(255&q,255&Ie))>>>0};var fl=X.PredictorAdd0;X.PredictorAdd1=Pe,br("Predictor2","PredictorAdd2"),br("Predictor3","PredictorAdd3"),br("Predictor4","PredictorAdd4"),br("Predictor5","PredictorAdd5"),br("Predictor6","PredictorAdd6"),br("Predictor7","PredictorAdd7"),br("Predictor8","PredictorAdd8"),br("Predictor9","PredictorAdd9"),br("Predictor10","PredictorAdd10"),br("Predictor11","PredictorAdd11"),br("Predictor12","PredictorAdd12"),br("Predictor13","PredictorAdd13");var hl=X.PredictorAdd2;Ge("ColorIndexInverseTransform","MapARGB","32b",function(q){return q>>8&255},function(q){return q}),Ge("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(q){return q},function(q){return q>>8&255});var $l,ql=X.ColorIndexInverseTransform,dl=X.MapARGB,Hl=X.VP8LColorIndexInverseTransformAlpha,Ou=X.MapAlpha,tr=X.VP8LPredictorsAdd=[];tr.length=16,(X.VP8LPredictors=[]).length=16,(X.VP8LPredictorsAdd_C=[]).length=16,(X.VP8LPredictors_C=[]).length=16;var mr,hn,In,vi,Pn,I,y,_,P,$,ne,ve,Oe,tt,ft,rr,ur,qr,bn,Dn,Xn,Fn,En,na,ca,lo,Ma,Ho,Js=a(511),Pl=a(2041),hu=a(225),du=a(767),Ms=0,Gl=Pl,Wl=hu,To=du,ni=Js,Lu=0,eh=1,yf=2,pu=3,kp=4,Vg=5,$g=6,qg=7,Rd=8,Vc=9,th=10,Rp=[2,3,7],Hg=[3,3,11],Dp=[280,256,256,256,40],Op=[0,1,1,1,0],Lp=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],vf=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],rh=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Gg=8,Wg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],nh=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Dd=null,Dy=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Od=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ld=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Oy=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ly=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Nd=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Np=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],$c=[],Nu=[],xa=[],ih=1,Xl=2,oc=[],pl=[];Pa("UpsampleRgbLinePair",Da,3),Pa("UpsampleBgrLinePair",is,3),Pa("UpsampleRgbaLinePair",Zs,4),Pa("UpsampleBgraLinePair",uu,4),Pa("UpsampleArgbLinePair",nc,4),Pa("UpsampleRgba4444LinePair",Ja,2),Pa("UpsampleRgb565LinePair",Is,2);var Fp=X.UpsampleRgbLinePair,_f=X.UpsampleBgrLinePair,Bh=X.UpsampleRgbaLinePair,bf=X.UpsampleBgraLinePair,ah=X.UpsampleArgbLinePair,Xg=X.UpsampleRgba4444LinePair,Ny=X.UpsampleRgb565LinePair,Fd=16,Bd=1<<Fd-1,zh=-227,wc=482,Yg=6,Bp=0,zd=a(256),Fy=a(256),Zg=a(256),Kg=a(256),By=a(wc-zh),Jg=a(wc-zh);Ps("YuvToRgbRow",Da,3),Ps("YuvToBgrRow",is,3),Ps("YuvToRgbaRow",Zs,4),Ps("YuvToBgraRow",uu,4),Ps("YuvToArgbRow",nc,4),Ps("YuvToRgba4444Row",Ja,2),Ps("YuvToRgb565Row",Is,2);var zp=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],sc=[0,2,8],zy=[8,7,6,4,4,2,2,2,1,1,1,1],Fu=1;this.WebPDecodeRGBA=function(q,K,me,Ie,Ye){var Qe=eh,nt=new qn,lt=new zr;nt.ba=lt,lt.S=Qe,lt.width=[lt.width],lt.height=[lt.height];var yt=lt.width,At=lt.height,Xt=new Rt;if(Xt==null||q==null)var _r=2;else e(Xt!=null),_r=cu(q,K,me,Xt.width,Xt.height,Xt.Pd,Xt.Qd,Xt.format,null);if(_r!=0?yt=0:(yt!=null&&(yt[0]=Xt.width[0]),At!=null&&(At[0]=Xt.height[0]),yt=1),yt){lt.width=lt.width[0],lt.height=lt.height[0],Ie!=null&&(Ie[0]=lt.width),Ye!=null&&(Ye[0]=lt.height);e:{if(Ie=new gs,(Ye=new Un).data=q,Ye.w=K,Ye.ha=me,Ye.kd=1,K=[0],e(Ye!=null),((q=cu(Ye.data,Ye.w,Ye.ha,null,null,null,K,null,Ye))==0||q==7)&&K[0]&&(q=4),(K=q)==0){if(e(nt!=null),Ie.data=Ye.data,Ie.w=Ye.w+Ye.offset,Ie.ha=Ye.ha-Ye.offset,Ie.put=ln,Ie.ac=oi,Ie.bc=Kn,Ie.ma=nt,Ye.xa){if((q=ua())==null){nt=1;break e}if((function(St,Pt){var fr=[0],Nr=[0],gr=[0];t:for(;;){if(St==null)return 0;if(Pt==null)return St.a=2,0;if(St.l=Pt,St.a=0,we(St.m,Pt.data,Pt.w,Pt.ha),!ke(St.m,fr,Nr,gr)){St.a=3;break t}if(St.xb=Xl,Pt.width=fr[0],Pt.height=Nr[0],!ha(fr[0],Nr[0],1,St,null))break t;return 1}return e(St.a!=0),0})(q,Ie)){if(Ie=(K=Du(Ie.width,Ie.height,nt.Oa,nt.ba))==0){t:{Ie=q;r:for(;;){if(Ie==null){Ie=0;break t}if(e(Ie.s.yc!=null),e(Ie.s.Ya!=null),e(0<Ie.s.Wb),e((me=Ie.l)!=null),e((Ye=me.ma)!=null),Ie.xb!=0){if(Ie.ca=Ye.ba,Ie.tb=Ye.tb,e(Ie.ca!=null),!Lo(Ye.Oa,me,pu)){Ie.a=2;break r}if(!zn(Ie,me.width)||me.da)break r;if((me.da||Ar(Ie.ca.S))&&Xs(),11>Ie.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Ie.ca.f.kb.F!=null&&Xs()),Ie.Pb&&0<Ie.s.ua&&Ie.s.vb.X==null&&!$e(Ie.s.vb,Ie.s.Wa.Xa)){Ie.a=1;break r}Ie.xb=0}if(!Bn(Ie,Ie.V,Ie.Ba,Ie.c,Ie.i,me.o,Bi))break r;Ye.Dc=Ie.Ma,Ie=1;break t}e(Ie.a!=0),Ie=0}Ie=!Ie}Ie&&(K=q.a)}else K=q.a}else{if((q=new Ul)==null){nt=1;break e}if(q.Fa=Ye.na,q.P=Ye.P,q.qc=Ye.Sa,xc(q,Ie)){if((K=Du(Ie.width,Ie.height,nt.Oa,nt.ba))==0){if(q.Aa=0,me=nt.Oa,e((Ye=q)!=null),me!=null){if(0<(yt=0>(yt=me.Md)?0:100<yt?255:255*yt/100)){for(At=Xt=0;4>At;++At)12>(_r=Ye.pb[At]).lc&&(_r.ia=yt*zy[0>_r.lc?0:_r.lc]>>3),Xt|=_r.ia;Xt&&(alert("todo:VP8InitRandom"),Ye.ia=1)}Ye.Ga=me.Id,100<Ye.Ga?Ye.Ga=100:0>Ye.Ga&&(Ye.Ga=0)}(function(St,Pt){if(St==null)return 0;if(Pt==null)return Fa(St,2,"NULL VP8Io parameter in VP8Decode().");if(!St.cb&&!xc(St,Pt))return 0;if(e(St.cb),Pt.ac==null||Pt.ac(Pt)){Pt.ob&&(St.L=0);var fr=sc[St.L];if(St.L==2?(St.yb=0,St.zb=0):(St.yb=Pt.v-fr>>4,St.zb=Pt.j-fr>>4,0>St.yb&&(St.yb=0),0>St.zb&&(St.zb=0)),St.Va=Pt.o+15+fr>>4,St.Hb=Pt.va+15+fr>>4,St.Hb>St.za&&(St.Hb=St.za),St.Va>St.Ub&&(St.Va=St.Ub),0<St.L){var Nr=St.ed;for(fr=0;4>fr;++fr){var gr;if(St.Qa.Cb){var Br=St.Qa.Lb[fr];St.Qa.Fb||(Br+=Nr.Tb)}else Br=Nr.Tb;for(gr=0;1>=gr;++gr){var jr=St.gd[fr][gr],on=Br;if(Nr.Pc&&(on+=Nr.vd[0],gr&&(on+=Nr.od[0])),0<(on=0>on?0:63<on?63:on)){var Jr=on;0<Nr.wb&&(Jr=4<Nr.wb?Jr>>2:Jr>>1)>9-Nr.wb&&(Jr=9-Nr.wb),1>Jr&&(Jr=1),jr.dd=Jr,jr.tc=2*on+Jr,jr.ld=40<=on?2:15<=on?1:0}else jr.tc=0;jr.La=gr}}}fr=0}else Fa(St,6,"Frame setup failed"),fr=St.a;if(fr=fr==0){if(fr){St.$c=0,0<St.Aa||(St.Ic=Fu);t:{fr=St.Ic,Nr=4*(Jr=St.za);var Jn=32*Jr,Vn=Jr+1,Ai=0<St.L?Jr*(0<St.Aa?2:1):0,Zn=(St.Aa==2?2:1)*Jr;if((jr=Nr+832+(gr=3*(16*fr+sc[St.L])/2*Jn)+(Br=St.Fa!=null&&0<St.Fa.length?St.Kc.c*St.Kc.i:0))!=jr)fr=0;else{if(jr>St.Vb){if(St.Vb=0,St.Ec=a(jr),St.Fc=0,St.Ec==null){fr=Fa(St,1,"no memory during frame initialization.");break t}St.Vb=jr}jr=St.Ec,on=St.Fc,St.Ac=jr,St.Bc=on,on+=Nr,St.Gd=s(Jn,ps),St.Hd=0,St.rb=s(Vn+1,zi),St.sb=1,St.wa=Ai?s(Ai,xi):null,St.Y=0,St.D.Nb=0,St.D.wa=St.wa,St.D.Y=St.Y,0<St.Aa&&(St.D.Y+=Jr),e(!0),St.oc=jr,St.pc=on,on+=832,St.ya=s(Zn,ma),St.aa=0,St.D.ya=St.ya,St.D.aa=St.aa,St.Aa==2&&(St.D.aa+=Jr),St.R=16*Jr,St.B=8*Jr,Jr=(Jn=sc[St.L])*St.R,Jn=Jn/2*St.B,St.sa=jr,St.ta=on+Jr,St.qa=St.sa,St.ra=St.ta+16*fr*St.R+Jn,St.Ha=St.qa,St.Ia=St.ra+8*fr*St.B+Jn,St.$c=0,on+=gr,St.mb=Br?jr:null,St.nb=Br?on:null,e(on+Br<=St.Fc+St.Vb),rs(St),i(St.Ac,St.Bc,0,Nr),fr=1}}if(fr){if(Pt.ka=0,Pt.y=St.sa,Pt.O=St.ta,Pt.f=St.qa,Pt.N=St.ra,Pt.ea=St.Ha,Pt.Vd=St.Ia,Pt.fa=St.R,Pt.Rc=St.B,Pt.F=null,Pt.J=0,!Ms){for(fr=-255;255>=fr;++fr)Js[255+fr]=0>fr?-fr:fr;for(fr=-1020;1020>=fr;++fr)Pl[1020+fr]=-128>fr?-128:127<fr?127:fr;for(fr=-112;112>=fr;++fr)hu[112+fr]=-16>fr?-16:15<fr?15:fr;for(fr=-255;510>=fr;++fr)du[255+fr]=0>fr?0:255<fr?255:fr;Ms=1}y=It,_=Pu,$=Q,ne=ge,ve=Je,P=Uc,Oe=ue,tt=We,ft=sr,rr=Lr,ur=bt,qr=Bt,bn=Zr,Dn=Nn,Xn=ji,Fn=Hs,En=ii,na=ri,Nu[0]=mn,Nu[1]=$t,Nu[2]=Rr,Nu[3]=fn,Nu[4]=fi,Nu[5]=ba,Nu[6]=$i,Nu[7]=wi,Nu[8]=Cs,Nu[9]=hi,$c[0]=Mr,$c[1]=Yr,$c[2]=tn,$c[3]=Gr,$c[4]=ti,$c[5]=ki,$c[6]=$n,xa[0]=oa,xa[1]=er,xa[2]=$s,xa[3]=Ri,xa[4]=Ka,xa[5]=Mu,xa[6]=qs,fr=1}else fr=0}fr&&(fr=(function(Yi,No){for(Yi.M=0;Yi.M<Yi.Va;++Yi.M){var Li,Yn=Yi.Jc[Yi.M&Yi.Xb],wn=Yi.m,Co=Yi;for(Li=0;Li<Co.za;++Li){var Pi=wn,aa=Co,da=aa.Ac,Mi=aa.Bc+4*Li,Ml=aa.zc,Qa=aa.ya[aa.aa+Li];if(aa.Qa.Bb?Qa.$b=Ke(Pi,aa.Pa.jb[0])?2+Ke(Pi,aa.Pa.jb[2]):Ke(Pi,aa.Pa.jb[1]):Qa.$b=0,aa.kc&&(Qa.Ad=Ke(Pi,aa.Bd)),Qa.Za=!Ke(Pi,145)+0,Qa.Za){var vs=Qa.Ob,ks=0;for(aa=0;4>aa;++aa){var Go,sa=Ml[0+aa];for(Go=0;4>Go;++Go){sa=Ly[da[Mi+Go]][sa];for(var wa=Ld[Ke(Pi,sa[0])];0<wa;)wa=Ld[2*wa+Ke(Pi,sa[wa])];sa=-wa,da[Mi+Go]=sa}n(vs,ks,da,Mi,4),ks+=4,Ml[0+aa]=sa}}else sa=Ke(Pi,156)?Ke(Pi,128)?1:3:Ke(Pi,163)?2:0,Qa.Ob[0]=sa,i(da,Mi,sa,4),i(Ml,0,sa,4);Qa.Dd=Ke(Pi,142)?Ke(Pi,114)?Ke(Pi,183)?1:3:2:0}if(Co.m.Ka)return Fa(Yi,7,"Premature end-of-partition0 encountered.");for(;Yi.ja<Yi.za;++Yi.ja){if(Co=Yn,Pi=(wn=Yi).rb[wn.sb-1],da=wn.rb[wn.sb+wn.ja],Li=wn.ya[wn.aa+wn.ja],Mi=wn.kc?Li.Ad:0)Pi.la=da.la=0,Li.Za||(Pi.Na=da.Na=0),Li.Hc=0,Li.Gc=0,Li.ia=0;else{var Ao,qi;if(Pi=da,da=Co,Mi=wn.Pa.Xc,Ml=wn.ya[wn.aa+wn.ja],Qa=wn.pb[Ml.$b],aa=Ml.ad,vs=0,ks=wn.rb[wn.sb-1],sa=Go=0,i(aa,vs,0,384),Ml.Za)var Wo=0,Tn=Mi[3];else{wa=a(16);var Sn=Pi.Na+ks.Na;if(Sn=Dd(da,Mi[1],Sn,Qa.Eb,0,wa,0),Pi.Na=ks.Na=(0<Sn)+0,1<Sn)y(wa,0,aa,vs);else{var Rs=wa[0]+3>>3;for(wa=0;256>wa;wa+=16)aa[vs+wa]=Rs}Wo=1,Tn=Mi[0]}var Sa=15&Pi.la,Fo=15&ks.la;for(wa=0;4>wa;++wa){var $a=1&Fo;for(Rs=qi=0;4>Rs;++Rs)Sa=Sa>>1|($a=(Sn=Dd(da,Tn,Sn=$a+(1&Sa),Qa.Sc,Wo,aa,vs))>Wo)<<7,qi=qi<<2|(3<Sn?3:1<Sn?2:aa[vs+0]!=0),vs+=16;Sa>>=4,Fo=Fo>>1|$a<<7,Go=(Go<<8|qi)>>>0}for(Tn=Sa,Wo=Fo>>4,Ao=0;4>Ao;Ao+=2){for(qi=0,Sa=Pi.la>>4+Ao,Fo=ks.la>>4+Ao,wa=0;2>wa;++wa){for($a=1&Fo,Rs=0;2>Rs;++Rs)Sn=$a+(1&Sa),Sa=Sa>>1|($a=0<(Sn=Dd(da,Mi[2],Sn,Qa.Qc,0,aa,vs)))<<3,qi=qi<<2|(3<Sn?3:1<Sn?2:aa[vs+0]!=0),vs+=16;Sa>>=2,Fo=Fo>>1|$a<<5}sa|=qi<<4*Ao,Tn|=Sa<<4<<Ao,Wo|=(240&Fo)<<Ao}Pi.la=Tn,ks.la=Wo,Ml.Hc=Go,Ml.Gc=sa,Ml.ia=43690&sa?0:Qa.ia,Mi=!(Go|sa)}if(0<wn.L&&(wn.wa[wn.Y+wn.ja]=wn.gd[Li.$b][Li.Za],wn.wa[wn.Y+wn.ja].La|=!Mi),Co.Ka)return Fa(Yi,7,"Premature end-of-file encountered.")}if(rs(Yi),wn=No,Co=1,Li=(Yn=Yi).D,Pi=0<Yn.L&&Yn.M>=Yn.zb&&Yn.M<=Yn.Va,Yn.Aa==0)t:{if(Li.M=Yn.M,Li.uc=Pi,cl(Yn,Li),Co=1,Li=(qi=Yn.D).Nb,Pi=(sa=sc[Yn.L])*Yn.R,da=sa/2*Yn.B,wa=16*Li*Yn.R,Rs=8*Li*Yn.B,Mi=Yn.sa,Ml=Yn.ta-Pi+wa,Qa=Yn.qa,aa=Yn.ra-da+Rs,vs=Yn.Ha,ks=Yn.Ia-da+Rs,Fo=(Sa=qi.M)==0,Go=Sa>=Yn.Va-1,Yn.Aa==2&&cl(Yn,qi),qi.uc)for($a=(Sn=Yn).D.M,e(Sn.D.uc),qi=Sn.yb;qi<Sn.Hb;++qi){Wo=qi,Tn=$a;var eo=(kl=(as=Sn).D).Nb;Ao=as.R;var kl=kl.wa[kl.Y+Wo],Yl=as.sa,Zl=as.ta+16*eo*Ao+16*Wo,gu=kl.dd,Ea=kl.tc;if(Ea!=0)if(e(3<=Ea),as.L==1)0<Wo&&Fn(Yl,Zl,Ao,Ea+4),kl.La&&na(Yl,Zl,Ao,Ea),0<Tn&&Xn(Yl,Zl,Ao,Ea+4),kl.La&&En(Yl,Zl,Ao,Ea);else{var ia=as.B,pa=as.qa,mu=as.ra+8*eo*ia+8*Wo,yu=as.Ha,as=as.Ia+8*eo*ia+8*Wo;eo=kl.ld,0<Wo&&(tt(Yl,Zl,Ao,Ea+4,gu,eo),rr(pa,mu,yu,as,ia,Ea+4,gu,eo)),kl.La&&(qr(Yl,Zl,Ao,Ea,gu,eo),Dn(pa,mu,yu,as,ia,Ea,gu,eo)),0<Tn&&(Oe(Yl,Zl,Ao,Ea+4,gu,eo),ft(pa,mu,yu,as,ia,Ea+4,gu,eo)),kl.La&&(ur(Yl,Zl,Ao,Ea,gu,eo),bn(pa,mu,yu,as,ia,Ea,gu,eo))}}if(Yn.ia&&alert("todo:DitherRow"),wn.put!=null){if(qi=16*Sa,Sa=16*(Sa+1),Fo?(wn.y=Yn.sa,wn.O=Yn.ta+wa,wn.f=Yn.qa,wn.N=Yn.ra+Rs,wn.ea=Yn.Ha,wn.W=Yn.Ia+Rs):(qi-=sa,wn.y=Mi,wn.O=Ml,wn.f=Qa,wn.N=aa,wn.ea=vs,wn.W=ks),Go||(Sa-=sa),Sa>wn.o&&(Sa=wn.o),wn.F=null,wn.J=null,Yn.Fa!=null&&0<Yn.Fa.length&&qi<Sa&&(wn.J=za(Yn,wn,qi,Sa-qi),wn.F=Yn.mb,wn.F==null&&wn.F.length==0)){Co=Fa(Yn,3,"Could not decode alpha data.");break t}qi<wn.j&&(sa=wn.j-qi,qi=wn.j,e(!(1&sa)),wn.O+=Yn.R*sa,wn.N+=Yn.B*(sa>>1),wn.W+=Yn.B*(sa>>1),wn.F!=null&&(wn.J+=wn.width*sa)),qi<Sa&&(wn.O+=wn.v,wn.N+=wn.v>>1,wn.W+=wn.v>>1,wn.F!=null&&(wn.J+=wn.v),wn.ka=qi-wn.j,wn.U=wn.va-wn.v,wn.T=Sa-qi,Co=wn.put(wn))}Li+1!=Yn.Ic||Go||(n(Yn.sa,Yn.ta-Pi,Mi,Ml+16*Yn.R,Pi),n(Yn.qa,Yn.ra-da,Qa,aa+8*Yn.B,da),n(Yn.Ha,Yn.Ia-da,vs,ks+8*Yn.B,da))}if(!Co)return Fa(Yi,6,"Output aborted.")}return 1})(St,Pt)),Pt.bc!=null&&Pt.bc(Pt),fr&=1}return fr?(St.cb=0,fr):0})(q,Ie)||(K=q.a)}}else K=q.a}K==0&&nt.Oa!=null&&nt.Oa.fd&&(K=mo(nt.ba))}nt=K}Qe=nt!=0?null:11>Qe?lt.f.RGBA.eb:lt.f.kb.y}else Qe=null;return Qe};var Bu=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(X,oe){for(var ee="",G=0;G<4;G++)ee+=String.fromCharCode(X[oe++]);return ee}function d(X,oe){return X[oe+0]|X[oe+1]<<8}function m(X,oe){return(X[oe+0]|X[oe+1]<<8|X[oe+2]<<16)>>>0}function b(X,oe){return(X[oe+0]|X[oe+1]<<8|X[oe+2]<<16|X[oe+3]<<24)>>>0}new c;var x=[0],E=[0],T=[],A=new c,R=t,F=(function(X,oe){var ee={},G=0,ae=!1,se=0,fe=0;if(ee.frames=[],!(function(de,Ee){for(var xe=0;xe<4;xe++)if(de[Ee+xe]!="RIFF".charCodeAt(xe))return!0;return!1})(X,oe)){for(b(X,oe+=4),oe+=8;oe<X.length;){var pe=f(X,oe),De=b(X,oe+=4);oe+=4;var ye=De+(1&De);switch(pe){case"VP8 ":case"VP8L":ee.frames[G]===void 0&&(ee.frames[G]={}),(Re=ee.frames[G]).src_off=ae?fe:oe-8,Re.src_size=se+De+8,G++,ae&&(ae=!1,se=0,fe=0);break;case"VP8X":(Re=ee.header={}).feature_flags=X[oe];var we=oe+4;Re.canvas_width=1+m(X,we),we+=3,Re.canvas_height=1+m(X,we),we+=3;break;case"ALPH":ae=!0,se=ye+8,fe=oe-8;break;case"ANIM":(Re=ee.header).bgcolor=b(X,oe),we=oe+4,Re.loop_count=d(X,we),we+=2;break;case"ANMF":var Te,Re;(Re=ee.frames[G]={}).offset_x=2*m(X,oe),oe+=3,Re.offset_y=2*m(X,oe),oe+=3,Re.width=1+m(X,oe),oe+=3,Re.height=1+m(X,oe),oe+=3,Re.duration=m(X,oe),oe+=3,Te=X[oe++],Re.dispose=1&Te,Re.blend=Te>>1&1}pe!="ANMF"&&(oe+=ye)}return ee}})(R,0);F.response=R,F.rgbaoutput=!0,F.dataurl=!1;var N=F.header?F.header:null,O=F.frames?F.frames:null;if(N){N.loop_counter=N.loop_count,x=[N.canvas_height],E=[N.canvas_width];for(var U=0;U<O.length&&O[U].blend!=0;U++);}var j=O[0],H=A.WebPDecodeRGBA(R,j.src_off,j.src_size,E,x);j.rgba=H,j.imgwidth=E[0],j.imgheight=x[0];for(var W=0;W<E[0]*x[0]*4;W++)T[W]=H[W];return this.width=E,this.height=x,this.data=T,this}(function(t){var e,r,n,i,a,s,o,c,f,d=function(de){return de=de||{},this.isStrokeTransparent=de.isStrokeTransparent||!1,this.strokeOpacity=de.strokeOpacity||1,this.strokeStyle=de.strokeStyle||"#000000",this.fillStyle=de.fillStyle||"#000000",this.isFillTransparent=de.isFillTransparent||!1,this.fillOpacity=de.fillOpacity||1,this.font=de.font||"10px sans-serif",this.textBaseline=de.textBaseline||"alphabetic",this.textAlign=de.textAlign||"left",this.lineWidth=de.lineWidth||1,this.lineJoin=de.lineJoin||"miter",this.lineCap=de.lineCap||"butt",this.path=de.path||[],this.transform=de.transform!==void 0?de.transform.clone():new c,this.globalCompositeOperation=de.globalCompositeOperation||"normal",this.globalAlpha=de.globalAlpha||1,this.clip_path=de.clip_path||[],this.currentPoint=de.currentPoint||new s,this.miterLimit=de.miterLimit||10,this.lastPoint=de.lastPoint||new s,this.lineDashOffset=de.lineDashOffset||0,this.lineDash=de.lineDash||[],this.margin=de.margin||[0,0,0,0],this.prevPageLastElemOffset=de.prevPageLastElemOffset||0,this.ignoreClearRect=typeof de.ignoreClearRect!="boolean"||de.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new m(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,f=new d}]);var m=function(de){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Ee=de;Object.defineProperty(this,"pdf",{get:function(){return Ee}});var xe=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return xe},set:function(st){xe=!!st}});var Ne=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Ne},set:function(st){Ne=!!st}});var Fe=0;Object.defineProperty(this,"posX",{get:function(){return Fe},set:function(st){isNaN(st)||(Fe=st)}});var Xe=0;Object.defineProperty(this,"posY",{get:function(){return Xe},set:function(st){isNaN(st)||(Xe=st)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(st){var $e;typeof st=="number"?$e=[st,st,st,st]:(($e=new Array(4))[0]=st[0],$e[1]=st.length>=2?st[1]:$e[0],$e[2]=st.length>=3?st[2]:$e[0],$e[3]=st.length>=4?st[3]:$e[1]),f.margin=$e}});var Be=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Be},set:function(st){Be=st}});var ot=0;Object.defineProperty(this,"lastBreak",{get:function(){return ot},set:function(st){ot=st}});var Ke=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ke},set:function(st){Ke=st}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(st){st instanceof d&&(f=st)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(st){f.path=st}});var it=[];Object.defineProperty(this,"ctxStack",{get:function(){return it},set:function(st){it=st}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(st){var $e;$e=b(st),this.ctx.fillStyle=$e.style,this.ctx.isFillTransparent=$e.a===0,this.ctx.fillOpacity=$e.a,this.pdf.setFillColor($e.r,$e.g,$e.b,{a:$e.a}),this.pdf.setTextColor($e.r,$e.g,$e.b,{a:$e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(st){var $e=b(st);this.ctx.strokeStyle=$e.style,this.ctx.isStrokeTransparent=$e.a===0,this.ctx.strokeOpacity=$e.a,$e.a===0?this.pdf.setDrawColor(255,255,255):($e.a,this.pdf.setDrawColor($e.r,$e.g,$e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(st){["butt","round","square"].indexOf(st)!==-1&&(this.ctx.lineCap=st,this.pdf.setLineCap(st))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(st){isNaN(st)||(this.ctx.lineWidth=st,this.pdf.setLineWidth(st))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(st){["bevel","round","miter"].indexOf(st)!==-1&&(this.ctx.lineJoin=st,this.pdf.setLineJoin(st))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(st){isNaN(st)||(this.ctx.miterLimit=st,this.pdf.setMiterLimit(st))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(st){this.ctx.textBaseline=st}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(st){["right","end","center","left","start"].indexOf(st)!==-1&&(this.ctx.textAlign=st)}});var Me=null,zt=null;Object.defineProperty(this,"fontFaces",{get:function(){return zt},set:function(st){Me=null,zt=st}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(st){var $e;if(this.ctx.font=st,($e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(st))!==null){var Jt=$e[1];$e[2];var Ht=$e[3],pr=$e[4];$e[5];var _t=$e[6],vr=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(pr)[2];pr=Math.floor(vr==="px"?parseFloat(pr)*this.pdf.internal.scaleFactor:vr==="em"?parseFloat(pr)*this.pdf.getFontSize():parseFloat(pr)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(pr);var br=(function(qe){var Ge,Nt,Et=[],mt=qe.trim();if(mt==="")return $A;if(mt in o9)return[o9[mt]];for(;mt!=="";){switch(Nt=null,Ge=(mt=l9(mt)).charAt(0)){case'"':case"'":Nt=b_e(mt.substring(1),Ge);break;default:Nt=x_e(mt)}if(Nt===null||(Et.push(Nt[0]),(mt=l9(Nt[1]))!==""&&mt.charAt(0)!==","))return $A;mt=mt.replace(/^,/,"")}return Et})(_t);if(this.fontFaces){var lr=(function(qe,Ge){if(Me===null){var Nt=(function(Et){var mt=[];return Object.keys(Et).forEach(function(ct){Et[ct].forEach(function(Kt){var qt=null;switch(Kt){case"bold":qt={family:ct,weight:"bold"};break;case"italic":qt={family:ct,style:"italic"};break;case"bolditalic":qt={family:ct,weight:"bold",style:"italic"};break;case"":case"normal":qt={family:ct}}qt!==null&&(qt.ref={name:ct,style:Kt},mt.push(qt))})}),mt})(qe.getFontList());Me=(function(Et){for(var mt={},ct=0;ct<Et.length;++ct){var Kt=VA(Et[ct]),qt=Kt.family,Ir=Kt.stretch,Ar=Kt.style,$r=Kt.weight;mt[qt]=mt[qt]||{},mt[qt][Ir]=mt[qt][Ir]||{},mt[qt][Ir][Ar]=mt[qt][Ir][Ar]||{},mt[qt][Ir][Ar][$r]=Kt}return mt})(Nt.concat(Ge))}return Me})(this.pdf,this.fontFaces),Cr=br.map(function(qe){return{family:qe,stretch:"normal",weight:Ht,style:Jt}}),Tr=(function(qe,Ge,Nt){for(var Et=(Nt=Nt||{}).defaultFontFamily||"times",mt=Object.assign({},__e,Nt.genericFontFamilies||{}),ct=null,Kt=null,qt=0;qt<Ge.length;++qt)if(mt[(ct=VA(Ge[qt])).family]&&(ct.family=mt[ct.family]),qe.hasOwnProperty(ct.family)){Kt=qe[ct.family];break}if(!(Kt=Kt||qe[Et]))throw new Error("Could not find a font-family for the rule '"+s9(ct)+"' and default family '"+Et+"'.");if(Kt=(function(Ir,Ar){if(Ar[Ir])return Ar[Ir];var $r=rk[Ir],cn=$r<=rk.normal?-1:1,zr=a9(Ar,uZ,$r,cn);if(!zr)throw new Error("Could not find a matching font-stretch value for "+Ir);return zr})(ct.stretch,Kt),Kt=(function(Ir,Ar){if(Ar[Ir])return Ar[Ir];for(var $r=lZ[Ir],cn=0;cn<$r.length;++cn)if(Ar[$r[cn]])return Ar[$r[cn]];throw new Error("Could not find a matching font-style for "+Ir)})(ct.style,Kt),!(Kt=(function(Ir,Ar){if(Ar[Ir])return Ar[Ir];if(Ir===400&&Ar[500])return Ar[500];if(Ir===500&&Ar[400])return Ar[400];var $r=v_e[Ir],cn=a9(Ar,cZ,$r,Ir<400?-1:1);if(!cn)throw new Error("Could not find a matching font-weight for value "+Ir);return cn})(ct.weight,Kt)))throw new Error("Failed to resolve a font for the rule '"+s9(ct)+"'.");return Kt})(lr,Cr);this.pdf.setFont(Tr.ref.name,Tr.ref.style)}else{var Qt="";(Ht==="bold"||parseInt(Ht,10)>=700||Jt==="bold")&&(Qt="bold"),Jt==="italic"&&(Qt+="italic"),Qt.length===0&&(Qt="normal");for(var at="",Pe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},be=0;be<br.length;be++){if(this.pdf.internal.getFont(br[be],Qt,{noFallback:!0,disableWarning:!0})!==void 0){at=br[be];break}if(Qt==="bolditalic"&&this.pdf.internal.getFont(br[be],"bold",{noFallback:!0,disableWarning:!0})!==void 0)at=br[be],Qt="bold";else if(this.pdf.internal.getFont(br[be],"normal",{noFallback:!0,disableWarning:!0})!==void 0){at=br[be],Qt="normal";break}}if(at===""){for(var je=0;je<br.length;je++)if(Pe[br[je]]){at=Pe[br[je]];break}}at=at===""?"Times":at,this.pdf.setFont(at,Qt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(st){this.ctx.globalCompositeOperation=st}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(st){this.ctx.globalAlpha=st}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(st){this.ctx.lineDashOffset=st,Re.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(st){this.ctx.lineDash=st,Re.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(st){this.ctx.ignoreClearRect=!!st}})};m.prototype.setLineDash=function(de){this.lineDash=de},m.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},m.prototype.fill=function(){O.call(this,"fill",!1)},m.prototype.stroke=function(){O.call(this,"stroke",!1)},m.prototype.beginPath=function(){this.path=[{type:"begin"}]},m.prototype.moveTo=function(de,Ee){if(isNaN(de)||isNaN(Ee))throw Ro.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var xe=this.ctx.transform.applyToPoint(new s(de,Ee));this.path.push({type:"mt",x:xe.x,y:xe.y}),this.ctx.lastPoint=new s(de,Ee)},m.prototype.closePath=function(){var de=new s(0,0),Ee=0;for(Ee=this.path.length-1;Ee!==-1;Ee--)if(this.path[Ee].type==="begin"&&po(this.path[Ee+1])==="object"&&typeof this.path[Ee+1].x=="number"){de=new s(this.path[Ee+1].x,this.path[Ee+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(de.x,de.y)},m.prototype.lineTo=function(de,Ee){if(isNaN(de)||isNaN(Ee))throw Ro.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var xe=this.ctx.transform.applyToPoint(new s(de,Ee));this.path.push({type:"lt",x:xe.x,y:xe.y}),this.ctx.lastPoint=new s(xe.x,xe.y)},m.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),O.call(this,null,!0)},m.prototype.quadraticCurveTo=function(de,Ee,xe,Ne){if(isNaN(xe)||isNaN(Ne)||isNaN(de)||isNaN(Ee))throw Ro.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Fe=this.ctx.transform.applyToPoint(new s(xe,Ne)),Xe=this.ctx.transform.applyToPoint(new s(de,Ee));this.path.push({type:"qct",x1:Xe.x,y1:Xe.y,x:Fe.x,y:Fe.y}),this.ctx.lastPoint=new s(Fe.x,Fe.y)},m.prototype.bezierCurveTo=function(de,Ee,xe,Ne,Fe,Xe){if(isNaN(Fe)||isNaN(Xe)||isNaN(de)||isNaN(Ee)||isNaN(xe)||isNaN(Ne))throw Ro.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Be=this.ctx.transform.applyToPoint(new s(Fe,Xe)),ot=this.ctx.transform.applyToPoint(new s(de,Ee)),Ke=this.ctx.transform.applyToPoint(new s(xe,Ne));this.path.push({type:"bct",x1:ot.x,y1:ot.y,x2:Ke.x,y2:Ke.y,x:Be.x,y:Be.y}),this.ctx.lastPoint=new s(Be.x,Be.y)},m.prototype.arc=function(de,Ee,xe,Ne,Fe,Xe){if(isNaN(de)||isNaN(Ee)||isNaN(xe)||isNaN(Ne)||isNaN(Fe))throw Ro.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Xe=!!Xe,!this.ctx.transform.isIdentity){var Be=this.ctx.transform.applyToPoint(new s(de,Ee));de=Be.x,Ee=Be.y;var ot=this.ctx.transform.applyToPoint(new s(0,xe)),Ke=this.ctx.transform.applyToPoint(new s(0,0));xe=Math.sqrt(Math.pow(ot.x-Ke.x,2)+Math.pow(ot.y-Ke.y,2))}Math.abs(Fe-Ne)>=2*Math.PI&&(Ne=0,Fe=2*Math.PI),this.path.push({type:"arc",x:de,y:Ee,radius:xe,startAngle:Ne,endAngle:Fe,counterclockwise:Xe})},m.prototype.arcTo=function(de,Ee,xe,Ne,Fe){throw new Error("arcTo not implemented.")},m.prototype.rect=function(de,Ee,xe,Ne){if(isNaN(de)||isNaN(Ee)||isNaN(xe)||isNaN(Ne))throw Ro.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(de,Ee),this.lineTo(de+xe,Ee),this.lineTo(de+xe,Ee+Ne),this.lineTo(de,Ee+Ne),this.lineTo(de,Ee),this.lineTo(de+xe,Ee),this.lineTo(de,Ee)},m.prototype.fillRect=function(de,Ee,xe,Ne){if(isNaN(de)||isNaN(Ee)||isNaN(xe)||isNaN(Ne))throw Ro.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!x.call(this)){var Fe={};this.lineCap!=="butt"&&(Fe.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Fe.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(de,Ee,xe,Ne),this.fill(),Fe.hasOwnProperty("lineCap")&&(this.lineCap=Fe.lineCap),Fe.hasOwnProperty("lineJoin")&&(this.lineJoin=Fe.lineJoin)}},m.prototype.strokeRect=function(de,Ee,xe,Ne){if(isNaN(de)||isNaN(Ee)||isNaN(xe)||isNaN(Ne))throw Ro.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");E.call(this)||(this.beginPath(),this.rect(de,Ee,xe,Ne),this.stroke())},m.prototype.clearRect=function(de,Ee,xe,Ne){if(isNaN(de)||isNaN(Ee)||isNaN(xe)||isNaN(Ne))throw Ro.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(de,Ee,xe,Ne))},m.prototype.save=function(de){de=typeof de!="boolean"||de;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,xe=0;xe<this.pdf.internal.getNumberOfPages();xe++)this.pdf.setPage(xe+1),this.pdf.internal.out("q");if(this.pdf.setPage(Ee),de){this.ctx.fontSize=this.pdf.internal.getFontSize();var Ne=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Ne}},m.prototype.restore=function(de){de=typeof de!="boolean"||de;for(var Ee=this.pdf.internal.getCurrentPageInfo().pageNumber,xe=0;xe<this.pdf.internal.getNumberOfPages();xe++)this.pdf.setPage(xe+1),this.pdf.internal.out("Q");this.pdf.setPage(Ee),de&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},m.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var b=function(de){var Ee,xe,Ne,Fe;if(de.isCanvasGradient===!0&&(de=de.getColor()),!de)return{r:0,g:0,b:0,a:0,style:de};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(de))Ee=0,xe=0,Ne=0,Fe=0;else{var Xe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(de);if(Xe!==null)Ee=parseInt(Xe[1]),xe=parseInt(Xe[2]),Ne=parseInt(Xe[3]),Fe=1;else if((Xe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(de))!==null)Ee=parseInt(Xe[1]),xe=parseInt(Xe[2]),Ne=parseInt(Xe[3]),Fe=parseFloat(Xe[4]);else{if(Fe=1,typeof de=="string"&&de.charAt(0)!=="#"){var Be=new tZ(de);de=Be.ok?Be.toHex():"#000000"}de.length===4?(Ee=de.substring(1,2),Ee+=Ee,xe=de.substring(2,3),xe+=xe,Ne=de.substring(3,4),Ne+=Ne):(Ee=de.substring(1,3),xe=de.substring(3,5),Ne=de.substring(5,7)),Ee=parseInt(Ee,16),xe=parseInt(xe,16),Ne=parseInt(Ne,16)}}return{r:Ee,g:xe,b:Ne,a:Fe,style:de}},x=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},E=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};m.prototype.fillText=function(de,Ee,xe,Ne){if(isNaN(Ee)||isNaN(xe)||typeof de!="string")throw Ro.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Ne=isNaN(Ne)?void 0:Ne,!x.call(this)){var Fe=ye(this.ctx.transform.rotation),Xe=this.ctx.transform.scaleX;G.call(this,{text:de,x:Ee,y:xe,scale:Xe,angle:Fe,align:this.textAlign,maxWidth:Ne})}},m.prototype.strokeText=function(de,Ee,xe,Ne){if(isNaN(Ee)||isNaN(xe)||typeof de!="string")throw Ro.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!E.call(this)){Ne=isNaN(Ne)?void 0:Ne;var Fe=ye(this.ctx.transform.rotation),Xe=this.ctx.transform.scaleX;G.call(this,{text:de,x:Ee,y:xe,scale:Xe,renderingMode:"stroke",angle:Fe,align:this.textAlign,maxWidth:Ne})}},m.prototype.measureText=function(de){if(typeof de!="string")throw Ro.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Ee=this.pdf,xe=this.pdf.internal.scaleFactor,Ne=Ee.internal.getFontSize(),Fe=Ee.getStringUnitWidth(de)*Ne/Ee.internal.scaleFactor;return new function(Xe){var Be=(Xe=Xe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Be}}),this}({width:Fe*=Math.round(96*xe/72*1e4)/1e4})},m.prototype.scale=function(de,Ee){if(isNaN(de)||isNaN(Ee))throw Ro.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var xe=new c(de,0,0,Ee,0,0);this.ctx.transform=this.ctx.transform.multiply(xe)},m.prototype.rotate=function(de){if(isNaN(de))throw Ro.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Ee=new c(Math.cos(de),Math.sin(de),-Math.sin(de),Math.cos(de),0,0);this.ctx.transform=this.ctx.transform.multiply(Ee)},m.prototype.translate=function(de,Ee){if(isNaN(de)||isNaN(Ee))throw Ro.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var xe=new c(1,0,0,1,de,Ee);this.ctx.transform=this.ctx.transform.multiply(xe)},m.prototype.transform=function(de,Ee,xe,Ne,Fe,Xe){if(isNaN(de)||isNaN(Ee)||isNaN(xe)||isNaN(Ne)||isNaN(Fe)||isNaN(Xe))throw Ro.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Be=new c(de,Ee,xe,Ne,Fe,Xe);this.ctx.transform=this.ctx.transform.multiply(Be)},m.prototype.setTransform=function(de,Ee,xe,Ne,Fe,Xe){de=isNaN(de)?1:de,Ee=isNaN(Ee)?0:Ee,xe=isNaN(xe)?0:xe,Ne=isNaN(Ne)?1:Ne,Fe=isNaN(Fe)?0:Fe,Xe=isNaN(Xe)?0:Xe,this.ctx.transform=new c(de,Ee,xe,Ne,Fe,Xe)};var T=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};m.prototype.drawImage=function(de,Ee,xe,Ne,Fe,Xe,Be,ot,Ke){var it=this.pdf.getImageProperties(de),Me=1,zt=1,st=1,$e=1;Ne!==void 0&&ot!==void 0&&(st=ot/Ne,$e=Ke/Fe,Me=it.width/Ne*ot/Ne,zt=it.height/Fe*Ke/Fe),Xe===void 0&&(Xe=Ee,Be=xe,Ee=0,xe=0),Ne!==void 0&&ot===void 0&&(ot=Ne,Ke=Fe),Ne===void 0&&ot===void 0&&(ot=it.width,Ke=it.height);for(var Jt,Ht=this.ctx.transform.decompose(),pr=ye(Ht.rotate.shx),_t=new c,vr=(_t=(_t=(_t=_t.multiply(Ht.translate)).multiply(Ht.skew)).multiply(Ht.scale)).applyToRectangle(new o(Xe-Ee*st,Be-xe*$e,Ne*Me,Fe*zt)),br=A.call(this,vr),lr=[],Cr=0;Cr<br.length;Cr+=1)lr.indexOf(br[Cr])===-1&&lr.push(br[Cr]);if(N(lr),this.autoPaging)for(var Tr=lr[0],Qt=lr[lr.length-1],at=Tr;at<Qt+1;at++){this.pdf.setPage(at);var Pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],be=at===1?this.posY+this.margin[0]:this.margin[0],je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ge=at===1?0:je+(at-2)*qe;if(this.ctx.clip_path.length!==0){var Nt=this.path;Jt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=F(Jt,this.posX+this.margin[3],-Ge+be+this.ctx.prevPageLastElemOffset),U.call(this,"fill",!0),this.path=Nt}var Et=JSON.parse(JSON.stringify(vr));Et=F([Et],this.posX+this.margin[3],-Ge+be+this.ctx.prevPageLastElemOffset)[0];var mt=(at>Tr||at<Qt)&&T.call(this);mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pe,qe,null).clip().discardPath()),this.pdf.addImage(de,"JPEG",Et.x,Et.y,Et.w,Et.h,null,null,pr),mt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(de,"JPEG",vr.x,vr.y,vr.w,vr.h,null,null,pr)};var A=function(de,Ee,xe){var Ne=[];Ee=Ee||this.pdf.internal.pageSize.width,xe=xe||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Fe=this.posY+this.ctx.prevPageLastElemOffset;switch(de.type){default:case"mt":case"lt":Ne.push(Math.floor((de.y+Fe)/xe)+1);break;case"arc":Ne.push(Math.floor((de.y+Fe-de.radius)/xe)+1),Ne.push(Math.floor((de.y+Fe+de.radius)/xe)+1);break;case"qct":var Xe=we(this.ctx.lastPoint.x,this.ctx.lastPoint.y,de.x1,de.y1,de.x,de.y);Ne.push(Math.floor((Xe.y+Fe)/xe)+1),Ne.push(Math.floor((Xe.y+Xe.h+Fe)/xe)+1);break;case"bct":var Be=Te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,de.x1,de.y1,de.x2,de.y2,de.x,de.y);Ne.push(Math.floor((Be.y+Fe)/xe)+1),Ne.push(Math.floor((Be.y+Be.h+Fe)/xe)+1);break;case"rect":Ne.push(Math.floor((de.y+Fe)/xe)+1),Ne.push(Math.floor((de.y+de.h+Fe)/xe)+1)}for(var ot=0;ot<Ne.length;ot+=1)for(;this.pdf.internal.getNumberOfPages()<Ne[ot];)R.call(this);return Ne},R=function(){var de=this.fillStyle,Ee=this.strokeStyle,xe=this.font,Ne=this.lineCap,Fe=this.lineWidth,Xe=this.lineJoin;this.pdf.addPage(),this.fillStyle=de,this.strokeStyle=Ee,this.font=xe,this.lineCap=Ne,this.lineWidth=Fe,this.lineJoin=Xe},F=function(de,Ee,xe){for(var Ne=0;Ne<de.length;Ne++)switch(de[Ne].type){case"bct":de[Ne].x2+=Ee,de[Ne].y2+=xe;case"qct":de[Ne].x1+=Ee,de[Ne].y1+=xe;default:de[Ne].x+=Ee,de[Ne].y+=xe}return de},N=function(de){return de.sort(function(Ee,xe){return Ee-xe})},O=function(de,Ee){for(var xe,Ne,Fe=this.fillStyle,Xe=this.strokeStyle,Be=this.lineCap,ot=this.lineWidth,Ke=Math.abs(ot*this.ctx.transform.scaleX),it=this.lineJoin,Me=JSON.parse(JSON.stringify(this.path)),zt=JSON.parse(JSON.stringify(this.path)),st=[],$e=0;$e<zt.length;$e++)if(zt[$e].x!==void 0)for(var Jt=A.call(this,zt[$e]),Ht=0;Ht<Jt.length;Ht+=1)st.indexOf(Jt[Ht])===-1&&st.push(Jt[Ht]);for(var pr=0;pr<st.length;pr++)for(;this.pdf.internal.getNumberOfPages()<st[pr];)R.call(this);if(N(st),this.autoPaging)for(var _t=st[0],vr=st[st.length-1],br=_t;br<vr+1;br++){this.pdf.setPage(br),this.fillStyle=Fe,this.strokeStyle=Xe,this.lineCap=Be,this.lineWidth=Ke,this.lineJoin=it;var lr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Cr=br===1?this.posY+this.margin[0]:this.margin[0],Tr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],at=br===1?0:Tr+(br-2)*Qt;if(this.ctx.clip_path.length!==0){var Pe=this.path;xe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=F(xe,this.posX+this.margin[3],-at+Cr+this.ctx.prevPageLastElemOffset),U.call(this,de,!0),this.path=Pe}if(Ne=JSON.parse(JSON.stringify(Me)),this.path=F(Ne,this.posX+this.margin[3],-at+Cr+this.ctx.prevPageLastElemOffset),Ee===!1||br===0){var be=(br>_t||br<vr)&&T.call(this);be&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lr,Qt,null).clip().discardPath()),U.call(this,de,Ee),be&&this.pdf.restoreGraphicsState()}this.lineWidth=ot}else this.lineWidth=Ke,U.call(this,de,Ee),this.lineWidth=ot;this.path=Me},U=function(de,Ee){if((de!=="stroke"||Ee||!E.call(this))&&(de==="stroke"||Ee||!x.call(this))){for(var xe,Ne,Fe=[],Xe=this.path,Be=0;Be<Xe.length;Be++){var ot=Xe[Be];switch(ot.type){case"begin":Fe.push({begin:!0});break;case"close":Fe.push({close:!0});break;case"mt":Fe.push({start:ot,deltas:[],abs:[]});break;case"lt":var Ke=Fe.length;if(Xe[Be-1]&&!isNaN(Xe[Be-1].x)&&(xe=[ot.x-Xe[Be-1].x,ot.y-Xe[Be-1].y],Ke>0)){for(;Ke>=0;Ke--)if(Fe[Ke-1].close!==!0&&Fe[Ke-1].begin!==!0){Fe[Ke-1].deltas.push(xe),Fe[Ke-1].abs.push(ot);break}}break;case"bct":xe=[ot.x1-Xe[Be-1].x,ot.y1-Xe[Be-1].y,ot.x2-Xe[Be-1].x,ot.y2-Xe[Be-1].y,ot.x-Xe[Be-1].x,ot.y-Xe[Be-1].y],Fe[Fe.length-1].deltas.push(xe);break;case"qct":var it=Xe[Be-1].x+2/3*(ot.x1-Xe[Be-1].x),Me=Xe[Be-1].y+2/3*(ot.y1-Xe[Be-1].y),zt=ot.x+2/3*(ot.x1-ot.x),st=ot.y+2/3*(ot.y1-ot.y),$e=ot.x,Jt=ot.y;xe=[it-Xe[Be-1].x,Me-Xe[Be-1].y,zt-Xe[Be-1].x,st-Xe[Be-1].y,$e-Xe[Be-1].x,Jt-Xe[Be-1].y],Fe[Fe.length-1].deltas.push(xe);break;case"arc":Fe.push({deltas:[],abs:[],arc:!0}),Array.isArray(Fe[Fe.length-1].abs)&&Fe[Fe.length-1].abs.push(ot)}}Ne=Ee?null:de==="stroke"?"stroke":"fill";for(var Ht=!1,pr=0;pr<Fe.length;pr++)if(Fe[pr].arc)for(var _t=Fe[pr].abs,vr=0;vr<_t.length;vr++){var br=_t[vr];br.type==="arc"?W.call(this,br.x,br.y,br.radius,br.startAngle,br.endAngle,br.counterclockwise,void 0,Ee,!Ht):ae.call(this,br.x,br.y),Ht=!0}else if(Fe[pr].close===!0)this.pdf.internal.out("h"),Ht=!1;else if(Fe[pr].begin!==!0){var lr=Fe[pr].start.x,Cr=Fe[pr].start.y;se.call(this,Fe[pr].deltas,lr,Cr),Ht=!0}Ne&&X.call(this,Ne),Ee&&oe.call(this)}},j=function(de){var Ee=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,xe=Ee*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return de-xe;case"top":return de+Ee-xe;case"hanging":return de+Ee-2*xe;case"middle":return de+Ee/2-xe;default:return de}},H=function(de){return de+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};m.prototype.createLinearGradient=function(){var de=function(){};return de.colorStops=[],de.addColorStop=function(Ee,xe){this.colorStops.push([Ee,xe])},de.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},de.isCanvasGradient=!0,de},m.prototype.createPattern=function(){return this.createLinearGradient()},m.prototype.createRadialGradient=function(){return this.createLinearGradient()};var W=function(de,Ee,xe,Ne,Fe,Xe,Be,ot,Ke){for(var it=pe.call(this,xe,Ne,Fe,Xe),Me=0;Me<it.length;Me++){var zt=it[Me];Me===0&&(Ke?ee.call(this,zt.x1+de,zt.y1+Ee):ae.call(this,zt.x1+de,zt.y1+Ee)),fe.call(this,de,Ee,zt.x2,zt.y2,zt.x3,zt.y3,zt.x4,zt.y4)}ot?oe.call(this):X.call(this,Be)},X=function(de){switch(de){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},oe=function(){this.pdf.clip(),this.pdf.discardPath()},ee=function(de,Ee){this.pdf.internal.out(r(de)+" "+n(Ee)+" m")},G=function(de){var Ee;switch(de.align){case"right":case"end":Ee="right";break;case"center":Ee="center";break;default:Ee="left"}var xe=this.pdf.getTextDimensions(de.text),Ne=j.call(this,de.y),Fe=H.call(this,Ne)-xe.h,Xe=this.ctx.transform.applyToPoint(new s(de.x,Ne)),Be=this.ctx.transform.decompose(),ot=new c;ot=(ot=(ot=ot.multiply(Be.translate)).multiply(Be.skew)).multiply(Be.scale);for(var Ke,it,Me,zt=this.ctx.transform.applyToRectangle(new o(de.x,Ne,xe.w,xe.h)),st=ot.applyToRectangle(new o(de.x,Fe,xe.w,xe.h)),$e=A.call(this,st),Jt=[],Ht=0;Ht<$e.length;Ht+=1)Jt.indexOf($e[Ht])===-1&&Jt.push($e[Ht]);if(N(Jt),this.autoPaging)for(var pr=Jt[0],_t=Jt[Jt.length-1],vr=pr;vr<_t+1;vr++){this.pdf.setPage(vr);var br=vr===1?this.posY+this.margin[0]:this.margin[0],lr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Cr=this.pdf.internal.pageSize.height-this.margin[2],Tr=Cr-this.margin[0],Qt=this.pdf.internal.pageSize.width-this.margin[1],at=Qt-this.margin[3],Pe=vr===1?0:lr+(vr-2)*Tr;if(this.ctx.clip_path.length!==0){var be=this.path;Ke=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=F(Ke,this.posX+this.margin[3],-1*Pe+br),U.call(this,"fill",!0),this.path=be}var je=F([JSON.parse(JSON.stringify(st))],this.posX+this.margin[3],-Pe+br+this.ctx.prevPageLastElemOffset)[0];de.scale>=.01&&(it=this.pdf.internal.getFontSize(),this.pdf.setFontSize(it*de.scale),Me=this.lineWidth,this.lineWidth=Me*de.scale);var qe=this.autoPaging!=="text";if(qe||je.y+je.h<=Cr){if(qe||je.y>=br&&je.x<=Qt){var Ge=qe?de.text:this.pdf.splitTextToSize(de.text,de.maxWidth||Qt-je.x)[0],Nt=F([JSON.parse(JSON.stringify(zt))],this.posX+this.margin[3],-Pe+br+this.ctx.prevPageLastElemOffset)[0],Et=qe&&(vr>pr||vr<_t)&&T.call(this);Et&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],at,Tr,null).clip().discardPath()),this.pdf.text(Ge,Nt.x,Nt.y,{angle:de.angle,align:Ee,renderingMode:de.renderingMode}),Et&&this.pdf.restoreGraphicsState()}}else je.y<Cr&&(this.ctx.prevPageLastElemOffset+=Cr-je.y);de.scale>=.01&&(this.pdf.setFontSize(it),this.lineWidth=Me)}else de.scale>=.01&&(it=this.pdf.internal.getFontSize(),this.pdf.setFontSize(it*de.scale),Me=this.lineWidth,this.lineWidth=Me*de.scale),this.pdf.text(de.text,Xe.x+this.posX,Xe.y+this.posY,{angle:de.angle,align:Ee,renderingMode:de.renderingMode,maxWidth:de.maxWidth}),de.scale>=.01&&(this.pdf.setFontSize(it),this.lineWidth=Me)},ae=function(de,Ee,xe,Ne){xe=xe||0,Ne=Ne||0,this.pdf.internal.out(r(de+xe)+" "+n(Ee+Ne)+" l")},se=function(de,Ee,xe){return this.pdf.lines(de,Ee,xe,null,null)},fe=function(de,Ee,xe,Ne,Fe,Xe,Be,ot){this.pdf.internal.out([e(i(xe+de)),e(a(Ne+Ee)),e(i(Fe+de)),e(a(Xe+Ee)),e(i(Be+de)),e(a(ot+Ee)),"c"].join(" "))},pe=function(de,Ee,xe,Ne){for(var Fe=2*Math.PI,Xe=Math.PI/2;Ee>xe;)Ee-=Fe;var Be=Math.abs(xe-Ee);Be<Fe&&Ne&&(Be=Fe-Be);for(var ot=[],Ke=Ne?-1:1,it=Ee;Be>1e-5;){var Me=it+Ke*Math.min(Be,Xe);ot.push(De.call(this,de,it,Me)),Be-=Math.abs(Me-it),it=Me}return ot},De=function(de,Ee,xe){var Ne=(xe-Ee)/2,Fe=de*Math.cos(Ne),Xe=de*Math.sin(Ne),Be=Fe,ot=-Xe,Ke=Be*Be+ot*ot,it=Ke+Be*Fe+ot*Xe,Me=4/3*(Math.sqrt(2*Ke*it)-it)/(Be*Xe-ot*Fe),zt=Be-Me*ot,st=ot+Me*Be,$e=zt,Jt=-st,Ht=Ne+Ee,pr=Math.cos(Ht),_t=Math.sin(Ht);return{x1:de*Math.cos(Ee),y1:de*Math.sin(Ee),x2:zt*pr-st*_t,y2:zt*_t+st*pr,x3:$e*pr-Jt*_t,y3:$e*_t+Jt*pr,x4:de*Math.cos(xe),y4:de*Math.sin(xe)}},ye=function(de){return 180*de/Math.PI},we=function(de,Ee,xe,Ne,Fe,Xe){var Be=de+.5*(xe-de),ot=Ee+.5*(Ne-Ee),Ke=Fe+.5*(xe-Fe),it=Xe+.5*(Ne-Xe),Me=Math.min(de,Fe,Be,Ke),zt=Math.max(de,Fe,Be,Ke),st=Math.min(Ee,Xe,ot,it),$e=Math.max(Ee,Xe,ot,it);return new o(Me,st,zt-Me,$e-st)},Te=function(de,Ee,xe,Ne,Fe,Xe,Be,ot){var Ke,it,Me,zt,st,$e,Jt,Ht,pr,_t,vr,br,lr,Cr,Tr=xe-de,Qt=Ne-Ee,at=Fe-xe,Pe=Xe-Ne,be=Be-Fe,je=ot-Xe;for(it=0;it<41;it++)pr=(Jt=(Me=de+(Ke=it/40)*Tr)+Ke*((st=xe+Ke*at)-Me))+Ke*(st+Ke*(Fe+Ke*be-st)-Jt),_t=(Ht=(zt=Ee+Ke*Qt)+Ke*(($e=Ne+Ke*Pe)-zt))+Ke*($e+Ke*(Xe+Ke*je-$e)-Ht),it==0?(vr=pr,br=_t,lr=pr,Cr=_t):(vr=Math.min(vr,pr),br=Math.min(br,_t),lr=Math.max(lr,pr),Cr=Math.max(Cr,_t));return new o(Math.round(vr),Math.round(br),Math.round(lr-vr),Math.round(Cr-br))},Re=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var de,Ee,xe=(de=this.ctx.lineDash,Ee=this.ctx.lineDashOffset,JSON.stringify({lineDash:de,lineDashOffset:Ee}));this.prevLineDash!==xe&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=xe)}}})(di.API),(function(t){var e=function(s){var o,c,f,d,m,b,x,E,T,A;for(c=[],f=0,d=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;d>f;f+=4)(m=(s.charCodeAt(f)<<24)+(s.charCodeAt(f+1)<<16)+(s.charCodeAt(f+2)<<8)+s.charCodeAt(f+3))!==0?(b=(m=((m=((m=((m=(m-(A=m%85))/85)-(T=m%85))/85)-(E=m%85))/85)-(x=m%85))/85)%85,c.push(b+33,x+33,E+33,T+33,A+33)):c.push(122);return(function(R,F){for(var N=F;N>0;N--)R.pop()})(c,o.length),String.fromCharCode.apply(String,c)+"~>"},r=function(s){var o,c,f,d,m,b=String,x="length",E=255,T="charCodeAt",A="slice",R="replace";for(s[A](-2),s=s[A](0,-2)[R](/\s/g,"")[R]("z","!!!!!"),f=[],d=0,m=(s+=o="uuuuu"[A](s[x]%5||5))[x];m>d;d+=5)c=52200625*(s[T](d)-33)+614125*(s[T](d+1)-33)+7225*(s[T](d+2)-33)+85*(s[T](d+3)-33)+(s[T](d+4)-33),f.push(E&c>>24,E&c>>16,E&c>>8,E&c);return(function(F,N){for(var O=N;O>0;O--)F.pop()})(f,o[x]),b.fromCharCode.apply(b,f)},n=function(s){return s.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var c="",f=0;f<s.length;f+=2)c+=String.fromCharCode("0x"+(s[f]+s[f+1]));return c},a=function(s){for(var o=new Uint8Array(s.length),c=s.length;c--;)o[c]=s.charCodeAt(c);return(o=YM(o)).reduce(function(f,d){return f+String.fromCharCode(d)},"")};t.processDataByFilters=function(s,o){var c=0,f=s||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),c=0;c<o.length;c+=1)switch(o[c]){case"ASCII85Decode":case"/ASCII85Decode":f=r(f),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=e(f),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=i(f),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=n(f),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=a(f),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[c]+'" is not implemented')}return{data:f,reverseChain:d.reverse().join(" ")}}})(di.API),(function(t){t.loadFile=function(e,r,n){return(function(i,a,s){a=a!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=(function(c,f,d){var m=new XMLHttpRequest,b=0,x=function(E){var T=E.length,A=[],R=String.fromCharCode;for(b=0;b<T;b+=1)A.push(R(255&E.charCodeAt(b)));return A.join("")};if(m.open("GET",c,!f),m.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(m.onload=function(){m.status===200?d(x(this.responseText)):d(void 0)}),m.send(null),f&&m.status===200)return x(m.responseText)})(i,a,s)}catch{}return o})(e,r,n)},t.loadImageFile=t.loadFile})(di.API),(function(t){function e(){return(Oi.html2canvas?Promise.resolve(Oi.html2canvas):nA(()=>import("./html2canvas.esm-B0tyYwQk.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Oi.DOMPurify?Promise.resolve(Oi.DOMPurify):nA(()=>import("./purify.es-CQJ0hv7W.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var c=po(o);return c==="undefined"?"undefined":c==="string"||o instanceof String?"string":c==="number"||o instanceof Number?"number":c==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(o,c){var f=document.createElement(o);for(var d in c.className&&(f.className=c.className),c.innerHTML&&c.dompurify&&(f.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)f.style[d]=c.style[d];return f},a=function o(c,f){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),m=c.firstChild;m;m=m.nextSibling)f!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||d.appendChild(o(m,f));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},s=function o(c){var f=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),f);return(d=d.setProgress(1,o,1,[o])).set(c)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,c){return o.__proto__=c||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,c){return this.then(function(){switch(c=c||(function(f){switch(n(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),c){case"string":return this.then(r).then(function(f){return this.set({src:i("div",{innerHTML:o,dompurify:f})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(c){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,c(this.prop.container,f)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(c){var f=this.opt.jsPDF,d=this.opt.fontFaces,m=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,b=Object.assign({async:!0,allowTaint:!0,scale:m,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete b.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=d,d)for(var x=0;x<d.length;++x){var E=d[x],T=E.src.find(function(A){return A.format==="truetype"});T&&f.addFont(T.url,E.ref.name,E.ref.style)}return b.windowHeight=b.windowHeight||0,b.windowHeight=b.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):b.windowHeight,f.context2d.save(!0),c(this.prop.container,b)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,c,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(o,c):this.outputPdf(o,c)},s.prototype.outputPdf=function(o,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,c)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(n(o)!=="object")return this;var c=Object.keys(o||{}).map(function(f){if(f in s.template.prop)return function(){this.prop[f]=o[f]};switch(f){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[f]=o[f]}}},this);return this.then(function(){return this.thenList(c)})},s.prototype.get=function(o,c){return this.then(function(){var f=o in s.template.prop?this.prop[o]:this.opt[o];return c?c(f):f})},s.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function c(f,d){return Math.floor(f*d/72*96)}return this.then(function(){(o=o||di.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:c(o.inner.width,o.k),height:c(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,c,f,d){return o!=null&&(this.progress.val=o),c!=null&&(this.progress.state=c),f!=null&&(this.progress.n=f),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,c,f,d){return this.setProgress(o?this.progress.val+o:null,c||null,f?this.progress.n+f:null,d?this.progress.stack.concat(d):null)},s.prototype.then=function(o,c){var f=this;return this.thenCore(o,c,function(d,m){return f.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(b){return f.updateProgress(null,d),b}).then(d,m).then(function(b){return f.updateProgress(1),b})})},s.prototype.thenCore=function(o,c,f){f=f||Promise.prototype.then;var d=this;o&&(o=o.bind(d)),c&&(c=c.bind(d));var m=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:s.convert(Object.assign({},d),Promise.prototype),b=f.call(m,o,c);return s.convert(b,d.__proto__)},s.prototype.thenExternal=function(o,c){return Promise.prototype.then.call(this,o,c)},s.prototype.thenList=function(o){var c=this;return o.forEach(function(f){c=c.thenCore(f)}),c},s.prototype.catch=function(o){o&&(o=o.bind(this));var c=Promise.prototype.catch.call(this,o);return s.convert(c,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,di.getPageSize=function(o,c,f){if(po(o)==="object"){var d=o;o=d.orientation,c=d.unit||c,f=d.format||f}c=c||"mm",f=f||"a4",o=(""+(o||"P")).toLowerCase();var m,b=(""+f).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":m=1;break;case"mm":m=72/25.4;break;case"cm":m=72/2.54;break;case"in":m=72;break;case"px":m=.75;break;case"pc":case"em":m=12;break;case"ex":m=6;break;default:throw"Invalid unit: "+c}var E,T=0,A=0;if(x.hasOwnProperty(b))T=x[b][1]/m,A=x[b][0]/m;else try{T=f[1],A=f[0]}catch{throw new Error("Invalid format: "+f)}if(o==="p"||o==="portrait")o="p",A>T&&(E=A,A=T,T=E);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",T>A&&(E=A,A=T,T=E)}return{width:A,height:T,unit:c,k:m,orientation:o}},t.html=function(o,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(VA):null;var f=new s(c);return c.worker?f:f.from(o).doCallback()}})(di.API),di.API.addJS=function(t){return c9=t,this.internal.events.subscribe("postPutResources",function(){rw=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(rw+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),u9=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+c9+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){rw!==void 0&&u9!==void 0&&this.internal.out("/Names <</JavaScript "+rw+" 0 R>>")}),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),a=0;a<i.length;a++){var s=i[a],o=n.exec(s);if(o!=null){var c=o[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,d=[];for(a=0;a<f;a++){var m=r.internal.newObject();d.push(m);var b=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+b.objId+" 0 R /XYZ null null null]>> endobj")}var x=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<d.length;a++)r.internal.write("(page_"+(a+1)+")"+d[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+x+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,a){var s={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var s=n.children[a];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])})(di.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,a,s,o){var c,f=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=(function(m){for(var b,x=256*m.charCodeAt(4)+m.charCodeAt(5),E=m.length,T={width:0,height:0,numcomponents:1},A=4;A<E;A+=2){if(A+=x,e.indexOf(m.charCodeAt(A+1))!==-1){b=256*m.charCodeAt(A+5)+m.charCodeAt(A+6),T={width:256*m.charCodeAt(A+7)+m.charCodeAt(A+8),height:b,numcomponents:m.charCodeAt(A+9)};break}x=256*m.charCodeAt(A+2)+m.charCodeAt(A+3)}return T})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:o,bitsPerComponent:8,filter:f,index:n,alias:i}}return d}})(di.API),di.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var i,a=i_e(t,{checkCrc:!0}),s=a.width,o=a.height,c=a.channels,f=a.palette,d=a.depth;i=f&&c===1?(function(H){for(var W=H.width,X=H.height,oe=H.data,ee=H.palette,G=H.depth,ae=!1,se=[],fe=[],pe=void 0,De=!1,ye=0,we=0;we<ee.length;we++){var Te=pz(ee[we],4),Re=Te[0],de=Te[1],Ee=Te[2],xe=Te[3];se.push(Re,de,Ee),xe!=null&&(xe===0?(ye++,fe.length<1&&fe.push(we)):xe<255&&(De=!0))}if(De||ye>1){ae=!0,fe=void 0;var Ne=W*X;pe=new Uint8Array(Ne);for(var Fe=new DataView(oe.buffer),Xe=0;Xe<Ne;Xe++){var Be=qA(Fe,Xe,G),ot=pz(ee[Be],4)[3];pe[Xe]=ot}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:oe,alphaBytes:pe,needSMask:ae,palette:se,mask:fe}})(a):c===2||c===4?(function(H){for(var W=H.data,X=H.width,oe=H.height,ee=H.channels,G=H.depth,ae=ee===2?"DeviceGray":"DeviceRGB",se=ee-1,fe=X*oe,pe=se,De=fe*pe,ye=1*fe,we=Math.ceil(De*G/8),Te=Math.ceil(ye*G/8),Re=new Uint8Array(we),de=new Uint8Array(Te),Ee=new DataView(W.buffer),xe=new DataView(Re.buffer),Ne=new DataView(de.buffer),Fe=!1,Xe=0;Xe<fe;Xe++){for(var Be=Xe*ee,ot=0;ot<pe;ot++)_9(xe,qA(Ee,Be+ot,G),Xe*pe+ot,G);var Ke=qA(Ee,Be+pe,G);Ke<(1<<G)-1&&(Fe=!0),_9(Ne,Ke,1*Xe,G)}return{colorSpace:ae,colorsPerPixel:se,colorBytes:Re,alphaBytes:de,needSMask:Fe}})(a):(function(H){var W=H.data,X=H.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:X,colorsPerPixel:X==="DeviceGray"?1:3,colorBytes:W instanceof Uint8Array?W:new Uint8Array(W.buffer),needSMask:!1}})(a);var m,b,x,E=i,T=E.colorSpace,A=E.colorsPerPixel,R=E.colorBytes,F=E.alphaBytes,N=E.needSMask,O=E.palette,U=E.mask,j=null;return n!==di.API.image_compression.NONE&&typeof YM=="function"?(j=(function(H){var W;switch(H){case di.API.image_compression.FAST:W=11;break;case di.API.image_compression.MEDIUM:W=13;break;case di.API.image_compression.SLOW:W=14;break;default:W=12}return W})(n),m=this.decode.FLATE_DECODE,b="/Predictor ".concat(j," "),t=p9(R,s*A,A,n),N&&(x=p9(F,s,1,n))):(m=void 0,b="",t=R,N&&(x=F)),b+="/Colors ".concat(A," /BitsPerComponent ").concat(d," /Columns ").concat(s),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(x&&this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),{alias:r,data:t,index:e,filter:m,decodeParameters:b,transparency:U,palette:O,sMask:x,predictor:j,width:s,height:o,bitsPerComponent:d,colorSpace:T}}},(function(t){t.processGIF89A=function(e,r,n,i){var a=new T_e(e),s=a.width,o=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var f={data:c,width:s,height:o},d=new HA(100).encode(f,100);return t.processJPEG.call(this,d,r,n,i)},t.processGIF87A=t.processGIF89A})(di.API),dh.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},dh.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Ro.log("bit decode error:"+r)}},dh.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var c=this.palette[a>>7-o&1];this.data[s+4*o]=c.blue,this.data[s+4*o+1]=c.green,this.data[s+4*o+2]=c.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},dh.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,o=a>>4,c=15&a,f=this.palette[o];if(this.data[s]=f.blue,this.data[s+1]=f.green,this.data[s+2]=f.red,this.data[s+3]=255,2*i+1>=this.width)break;f=this.palette[c],this.data[s+4]=f.blue,this.data[s+4+1]=f.green,this.data[s+4+2]=f.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},dh.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[a]=s.red,this.data[a+1]=s.green,this.data[a+2]=s.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},dh.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(a&e)/e*255|0,o=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,f=a>>15?255:0,d=n*this.width*4+4*i;this.data[d]=c,this.data[d+1]=o,this.data[d+2]=s,this.data[d+3]=f}this.pos+=t}},dh.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,c=(s>>5&r)/r*255|0,f=(s>>11)/e*255|0,d=i*this.width*4+4*a;this.data[d]=f,this.data[d+1]=c,this.data[d+2]=o,this.data[d+3]=255}this.pos+=t}},dh.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=a,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},dh.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=s}},dh.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,n,i){var a=new dh(e,!1),s=a.width,o=a.height,c={data:a.getData(),width:s,height:o},f=new HA(100).encode(c,100);return t.processJPEG.call(this,f,r,n,i)}})(di.API),x9.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,n,i){var a=new x9(e),s=a.width,o=a.height,c={data:a.getData(),width:s,height:o},f=new HA(100).encode(c,100);return t.processJPEG.call(this,f,r,n,i)}})(di.API),di.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,a=new Uint8Array(i/4*3),s=new Uint8Array(i/4),o=0,c=0,f=0;f<i;f+=4){var d=n[f],m=n[f+1],b=n[f+2],x=n[f+3];a[o++]=d,a[o++]=m,a[o++]=b,s[c++]=x}var E=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:E,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},di.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},pv=di.API,nw=pv.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:i.metadata.Unicode.widths,c=o.fof?o.fof:1,f=e.kerning?e.kerning:i.metadata.Unicode.kerning,d=f.fof?f.fof:1,m=e.doKerning!==!1,b=0,x=t.length,E=0,T=o[0]||c,A=[];for(r=0;r<x;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?A.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/a)||0)/1e3):(b=m&&po(f[n])==="object"&&!isNaN(parseInt(f[n][E],10))?f[n][E]/d:0,A.push((o[n]||T)/c+b)),E=n;return A},f9=pv.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return pv.processArabic&&(t=pv.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:nw.apply(this,arguments).reduce(function(a,s){return a+s},0)},h9=function(t,e,r,n){for(var i=[],a=0,s=t.length,o=0;a!==s&&o+e[a]<r;)o+=e[a],a++;i.push(t.slice(0,a));var c=a;for(o=0;a!==s;)o+e[a]>n&&(i.push(t.slice(c,a)),o=0,c=a),o+=e[a],a++;return c!==a&&i.push(t.slice(c,a)),i},d9=function(t,e,r){r||(r={});var n,i,a,s,o,c,f,d=[],m=[d],b=r.textIndent||0,x=0,E=0,T=t.split(" "),A=nw.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?T[0].length+2:r.lineIndent||0){var R=Array(c).join(" "),F=[];T.map(function(O){(O=O.split(/\s*\n/)).length>1?F=F.concat(O.map(function(U,j){return(j&&U.length?`
`:"")+U})):F.push(O[0])}),T=F,c=f9.apply(this,[R,r])}for(a=0,s=T.length;a<s;a++){var N=0;if(n=T[a],c&&n[0]==`
`&&(n=n.substr(1),N=1),b+x+(E=(i=nw.apply(this,[n,r])).reduce(function(O,U){return O+U},0))>e||N){if(E>e){for(o=h9.apply(this,[n,i,e-(b+x),e]),d.push(o.shift()),d=[o.pop()];o.length;)m.push([o.shift()]);E=i.slice(n.length-(d[0]?d[0].length:0)).reduce(function(O,U){return O+U},0)}else d=[n];m.push(d),b=E+c,x=A}else d.push(n),b+=x+E,x=A}return f=c?function(O,U){return(U?R:"")+O.join(" ")}:function(O){return O.join(" ")},m.map(f)},pv.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var m=this.internal.getFont(d.fontName,d.fontStyle),b="Unicode";return m.metadata[b]?{widths:m.metadata[b].widths||{0:1},kerning:m.metadata[b].kerning||{}}:{font:m.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=r.lineIndent;var o,c,f=[];for(o=0,c=n.length;o<c;o++)f=f.concat(d9.apply(this,[n[o],s,a]));return f},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},a=0;a<16;a++)n[r[a]]=e[a],i[e[a]]=r[a];var s=function(b){return"0x"+parseInt(b,10).toString(16)},o=t.__fontmetrics__.compress=function(b){var x,E,T,A,R=["{"];for(var F in b){if(x=b[F],isNaN(parseInt(F,10))?E="'"+F+"'":(F=parseInt(F,10),E=(E=s(F).slice(2)).slice(0,-1)+i[E.slice(-1)]),typeof x=="number")x<0?(T=s(x).slice(3),A="-"):(T=s(x).slice(2),A=""),T=A+T.slice(0,-1)+i[T.slice(-1)];else{if(po(x)!=="object")throw new Error("Don't know what to do with value type "+po(x)+".");T=o(x)}R.push(E+T)}return R.push("}"),R.join("")},c=t.__fontmetrics__.uncompress=function(b){if(typeof b!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,E,T,A,R={},F=1,N=R,O=[],U="",j="",H=b.length-1,W=1;W<H;W+=1)(A=b[W])=="'"?x?(T=x.join(""),x=void 0):x=[]:x?x.push(A):A=="{"?(O.push([N,T]),N={},T=void 0):A=="}"?((E=O.pop())[0][E[1]]=N,T=void 0,N=E[0]):A=="-"?F=-1:T===void 0?n.hasOwnProperty(A)?(U+=n[A],T=parseInt(U,16)*F,F=1,U=""):U+=A:n.hasOwnProperty(A)?(j+=n[A],N[T]=parseInt(j,16)*F,F=1,T=void 0,j=""):j+=A;return R},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},m={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(b){var x=b.font,E=m.Unicode[x.postScriptName];E&&(x.metadata.Unicode={},x.metadata.Unicode.widths=E.widths,x.metadata.Unicode.kerning=E.kerning);var T=d.Unicode[x.postScriptName];T&&(x.metadata.Unicode.encoding=T,x.encoding=T.codePages[0])}])})(di.API),(function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=r.charCodeAt(a);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,a=r.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(sS(o)),s.metadata=t.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])})(di),di.API.addSvgAsImage=function(t,e,r,n,i,a,s,o){if(isNaN(e)||isNaN(r))throw Ro.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw Ro.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=i;var f=c.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return(Oi.canvg?Promise.resolve(Oi.canvg):nA(()=>import("./index.es-BZy0QKLz.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)).catch(function(b){return Promise.reject(new Error("Could not load canvg: "+b))}).then(function(b){return b.default?b.default:b}).then(function(b){return b.fromString(f,t,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(b){return b.render(d)}).then(function(){m.addImage(c.toDataURL("image/jpeg",1),e,r,n,i,s,o)})},di.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},di.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,a,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),c=[],f=0,d=0,m=0;function b(E,T){var A,R=!1;for(A=0;A<E.length;A+=1)E[A]===T&&(R=!0);return R}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var x=o.length;for(m=0;m<x;m+=1)r[o[m]].value=r[o[m]].defaultValue,r[o[m]].explicitSet=!1}if(po(t)==="object"){for(i in t)if(a=t[i],b(o,i)&&a!==void 0){if(r[i].type==="boolean"&&typeof a=="boolean")r[i].value=a;else if(r[i].type==="name"&&b(r[i].valueSet,a))r[i].value=a;else if(r[i].type==="integer"&&Number.isInteger(a))r[i].value=a;else if(r[i].type==="array"){for(f=0;f<a.length;f+=1)if(n=!0,a[f].length===1&&typeof a[f][0]=="number")c.push(String(a[f]-1));else if(a[f].length>1){for(d=0;d<a[f].length;d+=1)typeof a[f][d]!="number"&&(n=!1);n===!0&&c.push([a[f][0]-1,a[f][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var E,T=[];for(E in r)r[E].explicitSet===!0&&(r[E].type==="name"?T.push("/"+E+" /"+r[E].value):T.push("/"+E+" "+r[E].value));T.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+T.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),f=a.length+s.length+o.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(i+a+s+o+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(di.API),(function(t){var e=t.API,r=e.pdfEscape16=function(a,s){for(var o,c=s.metadata.Unicode.widths,f=["","0","00","000","0000"],d=[""],m=0,b=a.length;m<b;++m){if(o=s.metadata.characterToGlyph(a.charCodeAt(m)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=a.charCodeAt(m),c.indexOf(o)==-1&&(c.push(o),c.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return d.join("");o=o.toString(16),d.push(f[4-o.length],o)}return d.join("")},n=function(a){var s,o,c,f,d,m,b;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],m=0,b=(o=Object.keys(a).sort(function(x,E){return x-E})).length;m<b;m++)s=o[m],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[s]!==void 0&&a[s]!==null&&typeof a[s].toString=="function"&&(f=("0000"+a[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+f+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(s){var o=s.font,c=s.out,f=s.newObject,d=s.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var m=o.metadata.Unicode.widths,b=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),x="",E=0;E<b.length;E++)x+=String.fromCharCode(b[E]);var T=f();d({data:x,addLength1:!0,objectId:T}),c("endobj");var A=f();d({data:n(o.metadata.toUnicode),addLength1:!0,objectId:A}),c("endobj");var R=f();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Lv(o.fontName)),c("/FontFile2 "+T+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),c("/Flags "+o.metadata.flags),c("/StemV "+o.metadata.stemV),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c(">>"),c("endobj");var F=f();c("<<"),c("/Type /Font"),c("/BaseFont /"+Lv(o.fontName)),c("/FontDescriptor "+R+" 0 R"),c("/W "+t.API.PDFObject.convert(m)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+o.encoding+")"),c(">>"),c(">>"),c("endobj"),o.objectNumber=f(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+A+" 0 R"),c("/BaseFont /"+Lv(o.fontName)),c("/Encoding /"+o.encoding),c("/DescendantFonts ["+F+" 0 R]"),c(">>"),c("endobj"),o.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(s){var o=s.font,c=s.out,f=s.newObject,d=s.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var m=o.metadata.rawData,b="",x=0;x<m.length;x++)b+=String.fromCharCode(m[x]);var E=f();d({data:b,addLength1:!0,objectId:E}),c("endobj");var T=f();d({data:n(o.metadata.toUnicode),addLength1:!0,objectId:T}),c("endobj");var A=f();c("<<"),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c("/StemV "+o.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+E+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),c("/FontName /"+Lv(o.fontName)),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c(">>"),c("endobj"),o.objectNumber=f();for(var R=0;R<o.metadata.hmtx.widths.length;R++)o.metadata.hmtx.widths[R]=parseInt(o.metadata.hmtx.widths[R]*(1e3/o.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+T+" 0 R/BaseFont/"+Lv(o.fontName)+"/FontDescriptor "+A+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),c("endobj"),o.isAlreadyPutted=!0}})(a)}]);var i=function(a){var s,o=a.text||"",c=a.x,f=a.y,d=a.options||{},m=a.mutex||{},b=m.pdfEscape,x=m.activeFontKey,E=m.fonts,T=x,A="",R=0,F="",N=E[T].encoding;if(E[T].encoding!=="Identity-H")return{text:o,x:c,y:f,options:d,mutex:m};for(F=o,T=x,Array.isArray(o)&&(F=o[0]),R=0;R<F.length;R+=1)E[T].metadata.hasOwnProperty("cmap")&&(s=E[T].metadata.cmap.unicode.codeMap[F[R].charCodeAt(0)]),s||F[R].charCodeAt(0)<256&&E[T].metadata.hasOwnProperty("Unicode")?A+=F[R]:A+="";var O="";return parseInt(T.slice(1))<14||N==="WinAnsiEncoding"?O=b(A,T).split("").map(function(U){return U.charCodeAt(0).toString(16)}).join(""):N==="Identity-H"&&(O=r(A,E[T])),m.isHex=!0,{text:O,x:c,y:f,options:d,mutex:m}};e.events.push(["postProcessText",function(a){var s=a.text||"",o=[],c={text:s,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(s)){var f=0;for(f=0;f<s.length;f+=1)Array.isArray(s[f])&&s[f].length===3?o.push([i(Object.assign({},c,{text:s[f][0]})).text,s[f][1],s[f][2]]):o.push(i(Object.assign({},c,{text:s[f]})).text);a.text=o}else a.text=i(Object.assign({},c,{text:s})).text}])})(di),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(di.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,a,s,o,c,f,d,m=e,b=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],x=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],E={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},T={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},A=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],R=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),F=!1,N=0;this.__bidiEngine__={};var O=function(ee){var G=ee.charCodeAt(),ae=G>>8,se=T[ae];return se!==void 0?m[256*se+(255&G)]:ae===252||ae===253?"AL":R.test(ae)?"L":ae===8?"R":"N"},U=function(ee){for(var G,ae=0;ae<ee.length;ae++){if((G=O(ee.charAt(ae)))==="L")return!1;if(G==="R")return!0}return!1},j=function(ee,G,ae,se){var fe,pe,De,ye,we=G[se];switch(we){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":F=!1;break;case"N":case"AN":break;case"EN":F&&(we="AN");break;case"AL":F=!0,we="R";break;case"WS":case"BN":we="N";break;case"CS":se<1||se+1>=G.length||(fe=ae[se-1])!=="EN"&&fe!=="AN"||(pe=G[se+1])!=="EN"&&pe!=="AN"?we="N":F&&(pe="AN"),we=pe===fe?pe:"N";break;case"ES":we=(fe=se>0?ae[se-1]:"B")==="EN"&&se+1<G.length&&G[se+1]==="EN"?"EN":"N";break;case"ET":if(se>0&&ae[se-1]==="EN"){we="EN";break}if(F){we="N";break}for(De=se+1,ye=G.length;De<ye&&G[De]==="ET";)De++;we=De<ye&&G[De]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(ye=G.length,De=se+1;De<ye&&G[De]==="NSM";)De++;if(De<ye){var Te=ee[se],Re=Te>=1425&&Te<=2303||Te===64286;if(fe=G[De],Re&&(fe==="R"||fe==="AL")){we="R";break}}}we=se<1||(fe=G[se-1])==="B"?"N":ae[se-1];break;case"B":F=!1,i=!0,we=N;break;case"S":a=!0,we="N"}return we},H=function(ee,G,ae){var se=ee.split("");return ae&&W(se,ae,{hiLevel:N}),se.reverse(),G&&G.reverse(),se.join("")},W=function(ee,G,ae){var se,fe,pe,De,ye,we=-1,Te=ee.length,Re=0,de=[],Ee=N?x:b,xe=[];for(F=!1,i=!1,a=!1,fe=0;fe<Te;fe++)xe[fe]=O(ee[fe]);for(pe=0;pe<Te;pe++){if(ye=Re,de[pe]=j(ee,xe,de,pe),se=240&(Re=Ee[ye][E[de[pe]]]),Re&=15,G[pe]=De=Ee[Re][5],se>0)if(se===16){for(fe=we;fe<pe;fe++)G[fe]=1;we=-1}else we=-1;if(Ee[Re][6])we===-1&&(we=pe);else if(we>-1){for(fe=we;fe<pe;fe++)G[fe]=De;we=-1}xe[pe]==="B"&&(G[pe]=0),ae.hiLevel|=De}a&&(function(Ne,Fe,Xe){for(var Be=0;Be<Xe;Be++)if(Ne[Be]==="S"){Fe[Be]=N;for(var ot=Be-1;ot>=0&&Ne[ot]==="WS";ot--)Fe[ot]=N}})(xe,G,Te)},X=function(ee,G,ae,se,fe){if(!(fe.hiLevel<ee)){if(ee===1&&N===1&&!i)return G.reverse(),void(ae&&ae.reverse());for(var pe,De,ye,we,Te=G.length,Re=0;Re<Te;){if(se[Re]>=ee){for(ye=Re+1;ye<Te&&se[ye]>=ee;)ye++;for(we=Re,De=ye-1;we<De;we++,De--)pe=G[we],G[we]=G[De],G[De]=pe,ae&&(pe=ae[we],ae[we]=ae[De],ae[De]=pe);Re=ye}Re++}}},oe=function(ee,G,ae){var se=ee.split(""),fe={hiLevel:N};return ae||(ae=[]),W(se,ae,fe),(function(pe,De,ye){if(ye.hiLevel!==0&&d)for(var we,Te=0;Te<pe.length;Te++)De[Te]===1&&(we=A.indexOf(pe[Te]))>=0&&(pe[Te]=A[we+1])})(se,ae,fe),X(2,se,G,ae,fe),X(1,se,G,ae,fe),se.join("")};return this.__bidiEngine__.doBidiReorder=function(ee,G,ae){if((function(fe,pe){if(pe)for(var De=0;De<fe.length;De++)pe[De]=De;o===void 0&&(o=U(fe)),f===void 0&&(f=U(fe))})(ee,G),s||!c||f)if(s&&c&&o^f)N=o?1:0,ee=H(ee,G,ae);else if(!s&&c&&f)N=o?1:0,ee=oe(ee,G,ae),ee=H(ee,G);else if(!s||o||c||f){if(s&&!c&&o^f)ee=H(ee,G),o?(N=0,ee=oe(ee,G,ae)):(N=1,ee=oe(ee,G,ae),ee=H(ee,G));else if(s&&o&&!c&&f)N=1,ee=oe(ee,G,ae),ee=H(ee,G);else if(!s&&!c&&o^f){var se=d;o?(N=1,ee=oe(ee,G,ae),N=0,d=!1,ee=oe(ee,G,ae),d=se):(N=0,ee=oe(ee,G,ae),ee=H(ee,G),N=1,d=!1,ee=oe(ee,G,ae),d=se,ee=H(ee,G))}}else N=0,ee=oe(ee,G,ae);else N=o?1:0,ee=oe(ee,G,ae);return ee},this.__bidiEngine__.setOptions=function(ee){ee&&(s=ee.isInputVisual,c=ee.isOutputVisual,o=ee.isInputRtl,f=ee.isOutputRtl,d=ee.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var s=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(s=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?s.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):s.push([r.doBidiReorder(i[o])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])})(di),di.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Cg(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new j_e(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new C_e(this.contents),this.head=new I_e(this),this.name=new D_e(this),this.cmap=new hZ(this),this.toUnicode={},this.hhea=new P_e(this),this.maxp=new O_e(this),this.hmtx=new L_e(this),this.post=new k_e(this),this.os2=new M_e(this),this.loca=new z_e(this),this.glyf=new N_e(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,c,f;for(f=[],s=0,o=(c=this.bbox).length;s<o;s++)e=c[s],f.push(Math.round(e*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,a,s,o;for(s=0,a=0,o=(e=""+e).length;0<=o?a<o:a>o;a=0<=o?++a:--a)i=e.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t})();var Dh,Cg=(function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,a,s,o,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^s)+256*(255^o)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*a+65536*s+256*o+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,a;for(a=[],n=0,i=e.length;n<i;n++)r=e[n],a.push(this.writeByte(r));return a},t})(),C_e=(function(){var t;function e(r){var n,i,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,a,s,o,c,f,d,m,b,x,E,T;for(T in x=Object.keys(r).length,c=Math.log(2),m=16*Math.floor(Math.log(x)/c),s=Math.floor(m/c),d=16*x-m,(i=new Cg).writeInt(this.scalarType),i.writeShort(x),i.writeShort(m),i.writeShort(s),i.writeShort(d),a=16*x,f=i.pos+a,o=null,E=[],r)for(b=r[T],i.writeString(T),i.writeInt(t(b)),i.writeInt(f),i.writeInt(b.length),E=E.concat(b),T==="head"&&(o=f),f+=b.length;f%4;)E.push(0),f++;return i.write(E),n=2981146554-t(i.data),i.pos=o+8,i.writeUInt32(n),i.data},t=function(r){var n,i,a,s;for(r=dZ.call(r);r.length%4;)r.push(0);for(a=new Cg(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=a.readUInt32();return 4294967295&i},e})(),A_e={}.hasOwnProperty,Id=function(t,e){for(var r in e)A_e.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Dh=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var I_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Id(t,Dh),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new Cg).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t})(),w9=(function(){function t(e,r){var n,i,a,s,o,c,f,d,m,b,x,E,T,A,R,F,N;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),m=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(x=e.readUInt16(),b=x/2,e.pos+=6,a=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),e.pos+=2,T=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),f=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),d=(function(){var O,U;for(U=[],c=O=0;0<=b?O<b:O>b;c=0<=b?++O:--O)U.push(e.readUInt16());return U})(),i=(this.length-e.pos+this.offset)/2,o=(function(){var O,U;for(U=[],c=O=0;0<=i?O<i:O>i;c=0<=i?++O:--O)U.push(e.readUInt16());return U})(),c=R=0,N=a.length;R<N;c=++R)for(A=a[c],n=F=E=T[c];E<=A?F<=A:F>=A;n=E<=A?++F:--F)d[c]===0?s=n+f[c]:(s=o[d[c]/2+(n-E)-(b-c)]||0)!==0&&(s+=f[c]),this.codeMap[n]=65535&s}e.pos=m}return t.encode=function(e,r){var n,i,a,s,o,c,f,d,m,b,x,E,T,A,R,F,N,O,U,j,H,W,X,oe,ee,G,ae,se,fe,pe,De,ye,we,Te,Re,de,Ee,xe,Ne,Fe,Xe,Be,ot,Ke,it,Me;switch(se=new Cg,s=Object.keys(e).sort(function(zt,st){return zt-st}),r){case"macroman":for(T=0,A=(function(){var zt=[];for(E=0;E<256;++E)zt.push(0);return zt})(),F={0:0},a={},fe=0,we=s.length;fe<we;fe++)F[ot=e[i=s[fe]]]==null&&(F[ot]=++T),a[i]={old:e[i],new:F[e[i]]},A[i]=F[e[i]];return se.writeUInt16(1),se.writeUInt16(0),se.writeUInt32(12),se.writeUInt16(0),se.writeUInt16(262),se.writeUInt16(0),se.write(A),{charMap:a,subtable:se.data,maxGlyphID:T+1};case"unicode":for(G=[],m=[],N=0,F={},n={},R=f=null,pe=0,Te=s.length;pe<Te;pe++)F[U=e[i=s[pe]]]==null&&(F[U]=++N),n[i]={old:U,new:F[U]},o=F[U]-i,R!=null&&o===f||(R&&m.push(R),G.push(i),f=o),R=i;for(R&&m.push(R),m.push(65535),G.push(65535),oe=2*(X=G.length),W=2*Math.pow(Math.log(X)/Math.LN2,2),b=Math.log(W/2)/Math.LN2,H=2*X-W,c=[],j=[],x=[],E=De=0,Re=G.length;De<Re;E=++De){if(ee=G[E],d=m[E],ee===65535){c.push(0),j.push(0);break}if(ee-(ae=n[ee].new)>=32768)for(c.push(0),j.push(2*(x.length+X-E)),i=ye=ee;ee<=d?ye<=d:ye>=d;i=ee<=d?++ye:--ye)x.push(n[i].new);else c.push(ae-ee),j.push(0)}for(se.writeUInt16(3),se.writeUInt16(1),se.writeUInt32(12),se.writeUInt16(4),se.writeUInt16(16+8*X+2*x.length),se.writeUInt16(0),se.writeUInt16(oe),se.writeUInt16(W),se.writeUInt16(b),se.writeUInt16(H),Xe=0,de=m.length;Xe<de;Xe++)i=m[Xe],se.writeUInt16(i);for(se.writeUInt16(0),Be=0,Ee=G.length;Be<Ee;Be++)i=G[Be],se.writeUInt16(i);for(Ke=0,xe=c.length;Ke<xe;Ke++)o=c[Ke],se.writeUInt16(o);for(it=0,Ne=j.length;it<Ne;it++)O=j[it],se.writeUInt16(O);for(Me=0,Fe=x.length;Me<Fe;Me++)T=x[Me],se.writeUInt16(T);return{charMap:n,subtable:se.data,maxGlyphID:N+1}}},t})(),hZ=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Id(t,Dh),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new w9(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,i;return r==null&&(r="macroman"),n=w9.encode(e,r),(i=new Cg).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},t})(),P_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Id(t,Dh),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t})(),M_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Id(t,Dh),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n})(),this.charRange=(function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t})(),k_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Id(t,Dh),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)r=e.readByte(),i.push(this.names.push(e.readString(r)));return i;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var s,o,c;for(c=[],a=s=0,o=this.file.maxp.numGlyphs;0<=o?s<o:s>o;a=0<=o?++s:--s)c.push(e.readUInt32());return c}).call(this)}},t})(),R_e=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},D_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Id(t,Dh),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,i,a,s,o,c,f,d,m,b;for(e.pos=this.offset,e.readShort(),r=e.readShort(),o=e.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(c={},a=d=0,m=n.length;d<m;a=++d)i=n[a],e.pos=i.offset,f=e.readString(i.length),s=new R_e(f,i),c[b=i.nameID]==null&&(c[b]=[]),c[i.nameID].push(s);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t})(),O_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Id(t,Dh),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t})(),L_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Id(t,Dh),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,i,a,s,o,c;for(e.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var f,d;for(d=[],r=f=0;0<=i?f<i:f>i;r=0<=i?++f:--f)d.push(e.readInt16());return d})(),this.widths=(function(){var f,d,m,b;for(b=[],f=0,d=(m=this.metrics).length;f<d;f++)a=m[f],b.push(a.advance);return b}).call(this),n=this.widths[this.widths.length-1],c=[],r=s=0;0<=i?s<i:s>i;r=0<=i?++s:--s)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t})(),dZ=[].slice,N_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Id(t,Dh),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,i,a,s,o,c,f,d,m;return e in this.cache?this.cache[e]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(e),(i=a.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,s=(o=new Cg(r.read(i))).readShort(),f=o.readShort(),m=o.readShort(),c=o.readShort(),d=o.readShort(),this.cache[e]=s===-1?new B_e(o,f,m,c,d):new F_e(o,s,f,m,c,d),this.cache[e]))},t.prototype.encode=function(e,r,n){var i,a,s,o,c;for(s=[],a=[],o=0,c=r.length;o<c;o++)i=e[r[o]],a.push(s.length),i&&(s=s.concat(i.encode(n)));return a.push(s.length),{table:s,offsets:a}},t})(),F_e=(function(){function t(e,r,n,i,a,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),B_e=(function(){function t(e,r,n,i,a){var s,o;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Cg(dZ.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),z_e=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Id(t,Dh),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=2)a.push(2*e.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=4)a.push(e.readUInt32());return a}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),i=0,a=0,s=0;s<n.length;++s)if(n[s]=i,a<r.length&&r[a]==s){++a,n[s]=i;var o=this.offsets[s],c=this.offsets[s+1]-o;c>0&&(i+=c)}for(var f=new Array(4*n.length),d=0;d<n.length;++d)f[4*d+3]=255&n[d],f[4*d+2]=(65280&n[d])>>8,f[4*d+1]=(16711680&n[d])>>16,f[4*d]=(4278190080&n[d])>>24;return f},t})(),j_e=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,a;for(r in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,a,s,o,c;for(i={},s=0,o=e.length;s<o;s++)i[a=e[s]]=this.font.glyf.glyphFor(a);for(a in r=[],i)(n=i[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],i[a]=n;return i},t.prototype.encode=function(e,r){var n,i,a,s,o,c,f,d,m,b,x,E,T,A,R;for(i in n=hZ.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),x={0:0},R=n.charMap)x[(c=R[i]).old]=c.new;for(E in b=n.maxGlyphID,s)E in x||(x[E]=b++);return d=(function(F){var N,O;for(N in O={},F)O[F[N]]=N;return O})(x),m=Object.keys(d).sort(function(F,N){return F-N}),T=(function(){var F,N,O;for(O=[],F=0,N=m.length;F<N;F++)o=m[F],O.push(d[o]);return O})(),a=this.font.glyf.encode(s,T,x),f=this.font.loca.encode(a.offsets,T),A={cmap:this.font.cmap.raw(),glyf:a.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(A["OS/2"]=this.font.os2.raw()),this.font.directory.encode(A)},t})();di.API.PDFObject=(function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,a,s;if(Array.isArray(r))return"["+(function(){var o,c,f;for(f=[],o=0,c=r.length;o<c;o++)n=r[o],f.push(e.convert(n));return f})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in a=["<<"],r)s=r[i],a.push("/"+i+" "+e.convert(s));return a.push(">>"),a.join(`
`)}return""+r},e})();const U_e=t=>{const e=t.width,r=t.height,n=document.createElement("div");n.className="hidden-map",n.style.width="0px",n.style.height="0px",n.style.overflow="hidden",document.body.appendChild(n);const i=document.createElement("div");i.style.width=e+"px",i.style.height=r+"px",n.appendChild(i);const a=t.map.map.getStyle();for(const c in a.sources){const f=a.sources[c];Object.keys(f).forEach(d=>{f[d]||delete f[d]})}const s=new TT.Map({container:i,center:t.map.map.getCenter(),zoom:t.map.map.getZoom(),bearing:0,pitch:0,interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,style:a}),o=s._cameraForBoxAndBearing([t.bboxUnrotated[0],t.bboxUnrotated[1]],[t.bboxUnrotated[2],t.bboxUnrotated[3]],t.bearing+t.map.map.getBearing());return s._fitInternal(o),new Promise(c=>{console.log("before idle"),s.once("idle",function(){const f={...t,renderMap:s,hiddenContainer:n,createPdf:d=>V_e({...t,renderMap:s,hiddenContainer:n,...d}),createPng:d=>q_e({...t,renderMap:s,hiddenContainer:n,...d})};c(f)})})};function V_e(t){const e=new di({orientation:t?.orientation==="portrait"?"p":"l",unit:"mm",compress:!0,format:t.format});return Object.defineProperty(window,"devicePixelRatio",{get:function(){return 300/96}}),new Promise(r=>{e.addImage(t.renderMap.getCanvas().toDataURL("image/png"),"png",0,0,e.internal.pageSize.getWidth(),e.internal.pageSize.getHeight(),void 0,"FAST"),t.renderMap.remove(),t.hiddenContainer.parentNode?.removeChild(t.hiddenContainer);const n={...t,pdf:e,downloadPdf:i=>$_e({...n,...i}),formData:new FormData};r(n)})}function $_e(t){return t.pdf.save("Map.pdf"),new Promise(function(e){e({...t})})}function q_e(t){return new Promise(e=>{const r=t.renderMap.getCanvas().toDataURL("image/png"),n={...t,png:r,downloadPng:i=>H_e({...n,...i})};e(n)})}function H_e(t){const e=document.createElement("a");return e.download=t?.name?t.name+".png":"map.png",e.href=t.png,document.body.appendChild(e),e.click(),document.body.removeChild(e),new Promise(function(r){r({...t})})}function pZ(t){const e=ga({mapId:t.mapId});return{createExport:te.useMemo(()=>{if(e.map)return n=>U_e({map:e.map,...n})},[e.map])}}const S9=t=>{const e=ga({mapId:t.mapId}),r=pZ({mapId:t.mapId}),[n,i]=gt.useState(!1);return J.jsx(J.Fragment,{children:J.jsx(ta,{color:"primary",variant:"contained",onClick:()=>{if(e.map&&r?.createExport){i(!0);const a=e.map.getBounds(),s=[a.getWest(),a.getSouth(),a.getEast(),a.getNorth()];r.createExport({width:595*1.4,height:842*1.4,bbox:s,bboxUnrotated:s,bearing:e.map.getBearing(),format:"a4",orientation:"portrait",...t.exportOptions}).then(o=>o.createPdf()).then(o=>(i(!1),o.downloadPdf())).catch(o=>{console.log(o),i(!1)})}},children:n?J.jsx(HT,{size:24,sx:{color:"#fff"}}):J.jsx(Jye,{})})})};try{S9.displayName="MlCreatePdfButton",S9.__docgenInfo={description:"Renders a button that will create a PDF version of the current map view (dimensions adjusted to fit Din A4 Paper).",displayName:"MlCreatePdfButton",props:{mapId:{defaultValue:null,description:"ID of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},exportOptions:{defaultValue:null,description:"Option overrides for the createExport function",name:"exportOptions",required:!1,type:{name:"createExportOptions | undefined"}}}}}catch{}const i0={A4:{"300dpi":{width:2480,height:3508},"150dpi":{width:1240,height:1754},"72dpi":{width:595,height:842}},A3:{"300dpi":{width:3505,height:4961},"150dpi":{width:1754,height:2480},"72dpi":{width:842,height:1191}},A2:{"300dpi":{width:4961,height:7016},"150dpi":{width:2480,height:3508},"72dpi":{width:1191,height:1684}},A1:{"300dpi":{width:7016,height:9933},"150dpi":{width:3508,height:4967},"72dpi":{width:1684,height:2384}},A0:{"300dpi":{width:9933,height:14043},"150dpi":{width:4967,height:7022},"72dpi":{width:2384,height:3370}}},gZ=gt.createContext({}),G_e=i0.A4["72dpi"],nk=({children:t})=>{const[e,r]=te.useState("A4"),[n,i]=te.useState("72dpi"),[a,s]=te.useState({center:void 0,scale:void 0,rotate:0,width:210,height:297,orientation:"portrait",fixedScale:0}),o=te.useRef(null),c=te.useMemo(()=>typeof i0[e][n]<"u"?a.orientation==="portrait"?i0[e][n]:{width:i0[e][n].height,height:i0[e][n].width}:G_e,[e,n,a.orientation]),f={options:a,setOptions:s,format:e,setFormat:r,quality:n,setQuality:i,geojsonRef:o,template:c};return J.jsx(gZ.Provider,{value:f,children:t})};try{nk.displayName="PdfContextProvider",nk.__docgenInfo={description:"",displayName:"PdfContextProvider",props:{}}}catch{}function bO(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return!0;return!1}function mZ(t,e){for(var r=t.length,n=0;n<r;++n)if(e(t[n],n))return t[n];return null}function yZ(t){var e=t;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function xO(t,e){try{return new RegExp(t,"g").exec(e)}catch{return null}}function W_e(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!!(e&&e.length)}function X_e(t,e){var r=xO("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return r?r[3]:""}function ik(t){return t.replace(/_/g,".")}function O1(t,e){var r=null,n="-1";return bO(t,function(i){var a=xO("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(r=i,n=a[3]||"-1",i.versionAlias?n=i.versionAlias:i.versionTest&&(n=X_e(i.versionTest.toLowerCase(),e)||n),n=ik(n),!0)}),{preset:r,version:n}}function iw(t,e){var r={brand:"",version:"-1"};return bO(t,function(n){var i=vZ(e,n);return i?(r.brand=n.id,r.version=n.versionAlias||i.version,r.version!=="-1"):!1}),r}function vZ(t,e){return mZ(t,function(r){var n=r.brand;return xO(""+e.test,n.toLowerCase())})}var _Z=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],bZ=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],ak=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],xZ=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],wZ=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function SZ(t){return!!O1(xZ,t).preset}function Y_e(t){var e=yZ(t),r=!!/mobi/g.exec(e),n={name:"unknown",version:"-1",majorVersion:-1,webview:SZ(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=O1(_Z,e),s=a.preset,o=a.version,c=O1(wZ,e),f=c.preset,d=c.version,m=O1(bZ,e);if(n.chromium=!!m.preset,n.chromiumVersion=m.version,!n.chromium){var b=O1(ak,e);n.webkit=!!b.preset,n.webkitVersion=b.version}return f&&(i.name=f.id,i.version=d,i.majorVersion=parseInt(d,10)),s&&(n.name=s.id,n.version=o,n.webview&&i.name==="ios"&&n.name!=="safari"&&(n.webview=!1)),n.majorVersion=parseInt(n.version,10),{browser:n,os:i,isMobile:r,isHints:!1}}function Z_e(t){var e=navigator.userAgentData,r=(e.uaList||e.brands).slice(),n=e.mobile||!1,i=r[0],a=(e.platform||navigator.platform).toLowerCase(),s={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!iw(xZ,r).brand||SZ(yZ())},o={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&bO(ak,function(b){return vZ(r,b)});var c=iw(bZ,r);if(s.chromium=!!c.brand,s.chromiumVersion=c.version||"-1",!s.chromium){var f=iw(ak,r);s.webkit=!!f.brand,s.webkitVersion=f.version||"-1"}var d=mZ(wZ,function(b){return new RegExp(""+b.test,"g").exec(a)});o.name=d?d.id:"";{var m=iw(_Z,r);s.name=m.brand||s.name,s.version=m.brand&&t?t.uaFullVersion:m.version}return s.webkit&&(o.name=n?"ios":"mac"),o.name==="ios"&&s.webview&&(s.version="-1"),o.version=ik(o.version),s.version=ik(s.version),o.majorVersion=parseInt(o.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:o,isMobile:n,isHints:!0}}function K_e(t){return W_e()?Z_e():Y_e(t)}function J_e(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.map(function(n){return n.split(" ").map(function(i){return i?""+t+i:""}).join(" ")}).join(" ")}function Q_e(t,e){return e.replace(/([^}{]*){/gm,function(r,n){return n.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"})}function zm(t,e){return function(r){r&&(t[e]=r)}}function EZ(t,e,r){return function(n){n&&(t[e][r]=n)}}function e1e(t,e){return e===void 0&&(e={}),function(r,n){t.forEach(function(i){var a=e[i]||i;a in r||(r[a]=function(){for(var s,o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];var f=(s=this[n])[i].apply(s,o);return f===this[n]?this:f})})}}var t1e="function",r1e="object",n1e="string",i1e="number",wO="undefined",TZ=typeof window!==wO,a1e=typeof document!==wO&&document,o1e=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Tl=1e-7,aw={cm:function(t){return t*96/2.54},mm:function(t){return t*96/254},in:function(t){return t*96},pt:function(t){return t*96/72},pc:function(t){return t*96/6},"%":function(t,e){return t*e/100},vw:function(t,e){return e===void 0&&(e=window.innerWidth),t/100*e},vh:function(t,e){return e===void 0&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function s1e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function ZS(t,e,r,n){return(t*n+e*r)/(r+n)}function SO(t){return typeof t===wO}function Ch(t){return t&&typeof t===r1e}function su(t){return Array.isArray(t)}function Ap(t){return typeof t===n1e}function jb(t){return typeof t===i1e}function EO(t){return typeof t===t1e}function l1e(t,e){var r=t===""||t==" ",n=e===""||e==" ";return n&&r||t===e}function CZ(t,e,r,n,i){var a=TO(t,e,r);return a?r:u1e(t,e,r+1,n,i)}function TO(t,e,r){if(!t.ignore)return null;var n=e.slice(Math.max(r-3,0),r+3).join("");return new RegExp(t.ignore).exec(n)}function u1e(t,e,r,n,i){for(var a=function(f){var d=e[f].trim();if(d===t.close&&!TO(t,e,f))return{value:f};var m=f,b=ff(i,function(x){var E=x.open;return E===d});if(b&&(m=CZ(b,e,f,n,i)),m===-1)return s=f,"break";f=m,s=f},s,o=r;o<n;++o){var c=a(o);if(o=s,typeof c=="object")return c.value;if(c==="break")break}return-1}function CO(t,e){var r=Ap(e)?{separator:e}:e,n=r.separator,i=n===void 0?",":n,a=r.isSeparateFirst,s=r.isSeparateOnlyOpenClose,o=r.isSeparateOpenClose,c=o===void 0?s:o,f=r.openCloseCharacters,d=f===void 0?o1e:f,m=d.map(function(H){var W=H.open,X=H.close;return W===X?W:W+"|"+X}).join("|"),b="(\\s*"+i+"\\s*|"+m+"|\\s+)",x=new RegExp(b,"g"),E=t.split(x).filter(function(H){return H&&H!=="undefined"}),T=E.length,A=[],R=[];function F(){return R.length?(A.push(R.join("")),R=[],!0):!1}for(var N=function(H){var W=E[H].trim(),X=H,oe=ff(d,function(ae){var se=ae.open;return se===W}),ee=ff(d,function(ae){var se=ae.close;return se===W});if(oe){if(X=CZ(oe,E,H,T,d),X!==-1&&c)return F()&&a||(A.push(E.slice(H,X+1).join("")),H=X,a)?(O=H,"break"):(O=H,"continue")}else if(ee&&!TO(ee,E,H)){var G=s1e(d);return G.splice(d.indexOf(ee),1),{value:CO(t,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:s,isSeparateOpenClose:c,openCloseCharacters:G})}}else if(l1e(W,i)&&!s)return F(),a?(O=H,"break"):(O=H,"continue");X===-1&&(X=T-1),R.push(E.slice(H,X+1).join("")),H=X,O=H},O,U=0;U<T;++U){var j=N(U);if(U=O,typeof j=="object")return j.value;if(j==="break")break}return R.length&&A.push(R.join("")),A}function Ag(t){return CO(t,"")}function Mm(t){return CO(t,",")}function AZ(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Dx(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var r=e[1],n=e[2],i=e[3];return{prefix:r,unit:i,value:parseFloat(n)}}function c1e(t,e){return t.replace(/([a-z])([A-Z])/g,function(r,n,i){return""+n+e+i.toLowerCase()})}function Ub(){return Date.now?Date.now():new Date().getTime()}function bp(t,e,r){r===void 0&&(r=-1);for(var n=t.length,i=0;i<n;++i)if(e(t[i],i,t))return i;return r}function ff(t,e,r){var n=bp(t,e);return n>-1?t[n]:r}var IZ=(function(){var t=Ub(),e=TZ&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(r){var n=Ub(),i=setTimeout(function(){r(n-t)},1e3/60);return i}})(),f1e=(function(){var t=TZ&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(e){clearTimeout(e)}})();function p_(t){return Object.keys(t)}function wo(t,e){var r=Dx(t),n=r.value,i=r.unit;if(Ch(e)){var a=e[i];if(a){if(EO(a))return a(n);if(aw[i])return aw[i](n,a)}}else if(i==="%")return n*e/100;return aw[i]?aw[i](n):n}function ok(t,e,r){return Math.max(e,Math.min(t,r))}function E9(t,e,r,n){return n===void 0&&(n=t[0]/t[1]),[[Fi(e[0],Tl),Fi(e[0]/n,Tl)],[Fi(e[1]*n,Tl),Fi(e[1],Tl)]].filter(function(i){return i.every(function(a,s){var o=e[s],c=Fi(o,Tl);return r?a<=o||a<=c:a>=o||a>=c})})[0]||t}function PZ(t,e,r,n){if(!n)return t.map(function(x,E){return ok(x,e[E],r[E])});var i=t[0],a=t[1],s=n===!0?i/a:n,o=E9(t,e,!1,s),c=o[0],f=o[1],d=E9(t,r,!0,s),m=d[0],b=d[1];return i<c||a<f?(i=c,a=f):(i>m||a>b)&&(i=m,a=b),[i,a]}function h1e(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return r}function sk(t){for(var e=t.length,r=0,n=e-1;n>=0;--n)r+=t[n];return e?r/e:0}function al(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function d1e(t){return[0,1].map(function(e){return sk(t.map(function(r){return r[e]}))})}function T9(t){var e=d1e(t),r=al(e,t[0]),n=al(e,t[1]);return r<n&&n-r<Math.PI||r>n&&n-r<-Math.PI?1:-1}function hp(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function Fi(t,e){if(!e)return t;var r=1/e;return Math.round(t/e)/r}function C9(t,e){return t.forEach(function(r,n){t[n]=Fi(t[n],e)}),t}function p1e(t){for(var e=[],r=0;r<t;++r)e.push(r);return e}function g1e(t){return t.reduce(function(e,r){return e.concat(r)},[])}function Bl(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function MZ(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function kZ(t,e){if(t.classList)t.classList.remove(e);else{var r=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(r," ")}}function Gu(t,e,r,n){t.addEventListener(e,r,n)}function _u(t,e,r,n){t.removeEventListener(e,r,n)}function AO(t){return t?.ownerDocument||a1e}function IO(t){return AO(t).documentElement}function zg(t){return AO(t).body}function bg(t){var e;return((e=t?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function RZ(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function PO(t){return Ch(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}function m1e(t,e,r,n,i,a){for(var s=0;s<i;++s){var o=r+s*i,c=n+s*i;t[o]+=t[c]*a,e[o]+=e[c]*a}}function y1e(t,e,r,n,i){for(var a=0;a<i;++a){var s=r+a*i,o=n+a*i,c=t[s],f=e[s];t[s]=t[o],t[o]=c,e[s]=e[o],e[o]=f}}function v1e(t,e,r,n,i){for(var a=0;a<n;++a){var s=r+a*n;t[s]/=i,e[s]/=i}}function DZ(t,e,r){for(var n=t.slice(),i=0;i<r;++i)n[i*r+e-1]=0,n[(e-1)*r+i]=0;return n[(e-1)*(r+1)]=1,n}function wd(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=t.slice(),n=Qo(e),i=0;i<e;++i){var a=e*i+i;if(!Fi(r[a],Tl)){for(var s=i+1;s<e;++s)if(r[e*i+s]){y1e(r,n,i,s,e);break}}if(!Fi(r[a],Tl))return[];v1e(r,n,i,e,r[a]);for(var s=0;s<e;++s){var o=s,c=s+i*e,f=r[c];!Fi(f,Tl)||i===s||m1e(r,n,o,i,e,-f)}}return n}function _1e(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=0;n<e;++n)for(var i=0;i<e;++i)r[i*e+n]=t[e*n+i];return r}function OZ(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var r=[],n=t[e*e-1],i=0;i<e-1;++i)r[i]=t[e*(e-1)+i]/n;return r[e-1]=0,r}function b1e(t,e){for(var r=Qo(e),n=0;n<e-1;++n)r[e*(e-1)+n]=t[n]||0;return r}function Km(t,e){for(var r=t.slice(),n=t.length;n<e-1;++n)r[n]=0;return r[e-1]=1,r}function Ah(t,e,r){if(e===void 0&&(e=Math.sqrt(t.length)),e===r)return t;for(var n=Qo(r),i=Math.min(e,r),a=0;a<i-1;++a){for(var s=0;s<i-1;++s)n[a*r+s]=t[a*e+s];n[(a+1)*r-1]=t[(a+1)*e-1],n[(r-1)*r+a]=t[(e-1)*e+a]}return n[r*r-1]=t[e*e-1],n}function KS(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=Qo(t);return e.forEach(function(i){n=So(n,i,t)}),n}function So(t,e,r){r===void 0&&(r=Math.sqrt(t.length));var n=[],i=t.length/r,a=e.length/i;if(i){if(!a)return t}else return e;for(var s=0;s<r;++s)for(var o=0;o<a;++o){n[o*r+s]=0;for(var c=0;c<i;++c)n[o*r+s]+=t[c*r+s]*e[o*i+c]}return n}function Ra(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]+e[i];return n}function _i(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]-e[i];return n}function x1e(t,e){return e===void 0&&(e=t.length===6),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function LZ(t,e){return e===void 0&&(e=t.length===9),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function rc(t,e,r){r===void 0&&(r=e.length);var n=So(t,e,r),i=n[r-1];return n.map(function(a){return a/i})}function w1e(t,e){return So(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function S1e(t,e){return So(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function E1e(t,e){return So(t,Lx(e,4))}function ow(t,e){var r=e[0],n=r===void 0?1:r,i=e[1],a=i===void 0?1:i,s=e[2],o=s===void 0?1:s;return So(t,[n,0,0,0,0,a,0,0,0,0,o,0,0,0,0,1],4)}function Ox(t,e){return rc(Lx(e,3),Km(t,3))}function GA(t,e){var r=e[0],n=r===void 0?0:r,i=e[1],a=i===void 0?0:i,s=e[2],o=s===void 0?0:s;return So(t,[1,0,0,0,0,1,0,0,0,0,1,0,n,a,o,1],4)}function A9(t,e){return So(t,e,4)}function Lx(t,e){var r=Math.cos(t),n=Math.sin(t),i=Qo(e);return i[0]=r,i[1]=n,i[e]=-n,i[e+1]=r,i}function Qo(t){for(var e=t*t,r=[],n=0;n<e;++n)r[n]=n%(t+1)?0:1;return r}function MO(t,e){for(var r=Qo(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[(e+1)*i]=t[i];return r}function Jm(t,e){for(var r=Qo(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[e*(e-1)+i]=t[i];return r}function kO(t,e,r,n,i,a,s,o){var c=t[0],f=t[1],d=e[0],m=e[1],b=r[0],x=r[1],E=n[0],T=n[1],A=i[0],R=i[1],F=a[0],N=a[1],O=s[0],U=s[1],j=o[0],H=o[1],W=[c,0,d,0,b,0,E,0,f,0,m,0,x,0,T,0,1,0,1,0,1,0,1,0,0,c,0,d,0,b,0,E,0,f,0,m,0,x,0,T,0,1,0,1,0,1,0,1,-A*c,-R*c,-F*d,-N*d,-O*b,-U*b,-j*E,-H*E,-A*f,-R*f,-F*m,-N*m,-O*x,-U*x,-j*T,-H*T],X=wd(W,8);if(!X.length)return[];var oe=So(X,[A,R,F,N,O,U,j,H],8);return oe[8]=1,Ah(_1e(oe),3,4)}var cb=function(){return cb=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},cb.apply(this,arguments)};function T1e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Vb(t,e){return e===void 0&&(e=0),Nv(j0(t,e))}function C1e(t,e){var r=rc(t,[e[0],e[1]||0,e[2]||0,1],4),n=r[3]||1;return[r[0]/n,r[1]/n,r[2]/n]}function Nv(t){var e=T1e();return t.forEach(function(r){var n=r.matrixFunction,i=r.functionValue;n&&(e=n(e,i))}),e}function j0(t,e){e===void 0&&(e=0);var r=su(t)?t:Ag(t);return r.map(function(n){var i=AZ(n),a=i.prefix,s=i.value,o=null,c=a,f="";if(a==="translate"||a==="translateX"||a==="translate3d"){var d=Ch(e)?cb(cb({},e),{"o%":e["%"]}):{"%":e,"o%":e},m=Mm(s).map(function(ae,se){return se===0&&"x%"in d?d["%"]=e["x%"]:se===1&&"y%"in d?d["%"]=e["y%"]:d["%"]=e["o%"],wo(ae,d)}),b=m[0],x=m[1],E=x===void 0?0:x,T=m[2],A=T===void 0?0:T;o=GA,f=[b,E,A]}else if(a==="translateY"){var R=Ch(e)?cb({"%":e["y%"]},e):{"%":e},E=wo(s,R);o=GA,f=[0,E,0]}else if(a==="translateZ"){var A=parseFloat(s);o=GA,f=[0,0,A]}else if(a==="scale"||a==="scale3d"){var F=Mm(s).map(function(ae){return parseFloat(ae)}),N=F[0],O=F[1],U=O===void 0?N:O,j=F[2],H=j===void 0?1:j;o=ow,f=[N,U,H]}else if(a==="scaleX"){var N=parseFloat(s);o=ow,f=[N,1,1]}else if(a==="scaleY"){var U=parseFloat(s);o=ow,f=[1,U,1]}else if(a==="scaleZ"){var H=parseFloat(s);o=ow,f=[1,1,H]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var W=Dx(s),X=W.unit,oe=W.value,ee=X==="rad"?oe:oe*Math.PI/180;a==="rotate"||a==="rotateZ"?(c="rotateZ",o=E1e):a==="rotateX"?o=w1e:a==="rotateY"&&(o=S1e),f=ee}else if(a==="matrix3d")o=A9,f=Mm(s).map(function(ae){return parseFloat(ae)});else if(a==="matrix"){var G=Mm(s).map(function(ae){return parseFloat(ae)});o=A9,f=[G[0],G[1],0,0,G[2],G[3],0,0,0,0,1,0,G[4],G[5],0,1]}else c="";return{name:a,functionName:c,value:s,matrixFunction:o,functionValue:f}})}var A1e=(function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(r){return this.values[this.keys.indexOf(r)]},e.set=function(r,n){var i=this.keys,a=this.values,s=i.indexOf(r),o=s===-1?i.length:s;i[o]=r,a[o]=n},t})(),I1e=(function(){function t(){this.object={}}var e=t.prototype;return e.get=function(r){return this.object[r]},e.set=function(r,n){this.object[r]=n},t})(),P1e=typeof Map=="function",M1e=(function(){function t(){}var e=t.prototype;return e.connect=function(r,n){this.prev=r,this.next=n,r&&(r.next=this),n&&(n.prev=this)},e.disconnect=function(){var r=this.prev,n=this.next;r&&(r.next=n),n&&(n.prev=r)},e.getIndex=function(){for(var r=this,n=-1;r;)r=r.prev,++n;return n},t})();function k1e(t,e){var r=[],n=[];return t.forEach(function(i){var a=i[0],s=i[1],o=new M1e;r[a]=o,n[s]=o}),r.forEach(function(i,a){i.connect(r[a-1])}),t.filter(function(i,a){return!e[a]}).map(function(i,a){var s=i[0],o=i[1];if(s===o)return[0,0];var c=r[s],f=n[o-1],d=c.getIndex();c.disconnect(),f?c.connect(f,f.next):c.connect(void 0,r[0]);var m=c.getIndex();return[d,m]})}var R1e=(function(){function t(r,n,i,a,s,o,c,f){this.prevList=r,this.list=n,this.added=i,this.removed=a,this.changed=s,this.maintained=o,this.changedBeforeAdded=c,this.fixed=f}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var r=k1e(this.changedBeforeAdded,this.fixed),n=this.changed,i=[];this.cacheOrdered=r.filter(function(a,s){var o=a[0],c=a[1],f=n[s],d=f[0],m=f[1];if(o!==c)return i.push([d,m]),!0}),this.cachePureChanged=i},t})();function RO(t,e,r){var n=P1e?Map:r?I1e:A1e,i=r||function(F){return F},a=[],s=[],o=[],c=t.map(i),f=e.map(i),d=new n,m=new n,b=[],x=[],E={},T=[],A=0,R=0;return c.forEach(function(F,N){d.set(F,N)}),f.forEach(function(F,N){m.set(F,N)}),c.forEach(function(F,N){var O=m.get(F);typeof O>"u"?(++R,s.push(N)):E[O]=R}),f.forEach(function(F,N){var O=d.get(F);typeof O>"u"?(a.push(N),++A):(o.push([O,N]),R=E[N]||0,b.push([O-R,N-A]),x.push(N===O),O!==N&&T.push([O,N]))}),s.reverse(),new R1e(t,e,a,s,T,o,b,x)}var D1e=(function(){function t(r,n){r===void 0&&(r=[]),this.findKeyCallback=n,this.list=[].slice.call(r)}var e=t.prototype;return e.update=function(r){var n=[].slice.call(r),i=RO(this.list,n,this.findKeyCallback);return this.list=n,i},t})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var lk=function(t,e){return lk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},lk(t,e)};function O1e(t,e){lk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var NZ=typeof Map=="function"?void 0:(function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}})(),FZ=(function(t){O1e(e,t);function e(r){return r===void 0&&(r=[]),t.call(this,r,NZ)||this}return e})(D1e);function L1e(t,e){return RO(t,e,NZ)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var uk=function(){return uk=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},uk.apply(this,arguments)};function N1e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}var DO=(function(){function t(){this._events={}}var e=t.prototype;return e.on=function(r,n){if(Ch(r))for(var i in r)this.on(i,r[i]);else this._addEvent(r,n,{});return this},e.off=function(r,n){if(!r)this._events={};else if(Ch(r))for(var i in r)this.off(i);else if(!n)this._events[r]=[];else{var a=this._events[r];if(a){var s=bp(a,function(o){return o.listener===n});s>-1&&a.splice(s,1)}}return this},e.once=function(r,n){var i=this;return n&&this._addEvent(r,n,{once:!0}),new Promise(function(a){i._addEvent(r,a,{once:!0})})},e.emit=function(r,n){var i=this;n===void 0&&(n={});var a=this._events[r];if(!r||!a)return!0;var s=!1;return n.eventType=r,n.stop=function(){s=!0},n.currentTarget=this,N1e(a).forEach(function(o){o.listener(n),o.once&&i.off(r,o.listener)}),!s},e.trigger=function(r,n){return n===void 0&&(n={}),this.emit(r,n)},e._addEvent=function(r,n,i){var a=this._events;a[r]=a[r]||[];var s=a[r];s.push(uk({listener:n},i))},t})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ck=function(t,e){return ck=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ck(t,e)};function F1e(t,e){ck(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var a0=function(){return a0=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},a0.apply(this,arguments)};function B1e(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function I9(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function sw(t){if(t){if(Ap(t))return document.querySelector(t)}else return null;if(EO(t))return t();if(t instanceof Element)return t;if("current"in t)return t.current;if("value"in t)return t.value}var z1e=(function(t){F1e(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n._startRect=null,n._startPos=[],n._prevTime=0,n._timer=0,n._prevScrollPos=[0,0],n._isWait=!1,n._flag=!1,n._currentOptions=null,n._lock=!1,n._unregister=null,n._onScroll=function(){var i=n._currentOptions;n._lock||!i||n.emit("scrollDrag",{next:function(a){n.checkScroll({container:i.container,inputEvent:a})}})},n}var r=e.prototype;return r.dragStart=function(n,i){var a=sw(i.container);if(!a){this._flag=!1;return}var s=0,o=0,c=0,f=0;if(a===document.body)c=window.innerWidth,f=window.innerHeight;else{var d=a.getBoundingClientRect();s=d.top,o=d.left,c=d.width,f=d.height}this._flag=!0,this._startPos=[n.clientX,n.clientY],this._startRect={top:s,left:o,width:c,height:f},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},r.drag=function(n,i){if(clearTimeout(this._timer),!!this._flag){var a=n.clientX,s=n.clientY,o=i.threshold,c=o===void 0?0:o,f=this,d=f._startRect,m=f._startPos;this._currentOptions=i;var b=[0,0];return d.top>s-c?(m[1]>d.top||s<m[1])&&(b[1]=-1):d.top+d.height<s+c&&(m[1]<d.top+d.height||s>m[1])&&(b[1]=1),d.left>a-c?(m[0]>d.left||a<m[0])&&(b[0]=-1):d.left+d.width<a+c&&(m[0]<d.left+d.width||a>m[0])&&(b[0]=1),!b[0]&&!b[1]?!1:this._continueDrag(a0(a0({},i),{direction:b,inputEvent:n,isDrag:!0}))}},r.checkScroll=function(n){var i=this;if(this._isWait)return!1;var a=n.prevScrollPos,s=a===void 0?this._prevScrollPos:a,o=n.direction,c=n.throttleTime,f=c===void 0?0:c,d=n.inputEvent,m=n.isDrag,b=this._getScrollPosition(o||[0,0],n),x=b[0]-s[0],E=b[1]-s[1],T=o||[x?Math.abs(x)/x:0,E?Math.abs(E)/E:0];return this._prevScrollPos=b,this._lock=!1,!x&&!E?!1:(this.emit("move",{offsetX:T[0]?x:0,offsetY:T[1]?E:0,inputEvent:d}),f&&m&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},f)),!0)},r.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},r._getScrollPosition=function(n,i){var a=i.container,s=i.getScrollPosition,o=s===void 0?B1e:s;return o({container:sw(a),direction:n})},r._continueDrag=function(n){var i=this,a,s=n.container,o=n.direction,c=n.throttleTime,f=n.useScroll,d=n.isDrag,m=n.inputEvent;if(!(!this._flag||d&&this._isWait)){var b=Ub(),x=Math.max(c+this._prevTime-b,0);if(x>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(n)},x),!1;this._prevTime=b;var E=this._getScrollPosition(o,n);this._prevScrollPos=E,d&&(this._isWait=!0),f||(this._lock=!0);var T={container:sw(s),direction:o,inputEvent:m};return(a=n.requestScroll)===null||a===void 0||a.call(n,T),this.emit("scroll",T),this._isWait=!1,f||this.checkScroll(a0(a0({},n),{prevScrollPos:E,direction:o,inputEvent:m}))}},r._registerScrollEvent=function(n){this._unregisterScrollEvent();var i=n.checkScrollEvent;if(i){var a=i===!0?I9:i,s=sw(n.container);i===!0&&(s===document.body||s===document.documentElement)?this._unregister=I9(window,this._onScroll):this._unregister=a(s,this._onScroll)}},r._unregisterScrollEvent=function(){var n;(n=this._unregister)===null||n===void 0||n.call(this),this._unregister=null},e})(DO);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function j1e(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function Ic(t){return Fi(t,Tl)}function U1e(t,e){return t.every(function(r,n){return Ic(r-e[n])===0})}function V1e(t,e){return!Ic(t[0]-e[0])&&!Ic(t[1]-e[1])}function BZ(t){return t.length<3?0:Math.abs(h1e(t.map(function(e,r){var n=t[r+1]||t[0];return e[0]*n[1]-n[0]*e[1]})))/2}function P9(t,e){var r=e.width,n=e.height,i=e.left,a=e.top,s=Qm(t),o=s.minX,c=s.minY,f=s.maxX,d=s.maxY,m=r/(f-o),b=n/(d-c);return t.map(function(x){return[i+(x[0]-o)*m,a+(x[1]-c)*b]})}function Qm(t){var e=t.map(function(n){return n[0]}),r=t.map(function(n){return n[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,r),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,r)}}function fk(t,e,r){var n=t[0],i=t[1],a=Qm(e),s=a.minX,o=a.maxX,c=[[s,i],[o,i]],f=JS(c[0],c[1]),d=hk(e),m=[];if(d.forEach(function(E){var T=JS(E[0],E[1]),A=E[0];if(U1e(f,T))m.push({pos:t,line:E,type:"line"});else{var R=zZ(OO(f,T),[c,E]);R.forEach(function(F){E.some(function(N){return V1e(N,F)})?m.push({pos:F,line:E,type:"point"}):Ic(A[1]-i)!==0&&m.push({pos:F,line:E,type:"intersection"})})}}),ff(m,function(E){return E[0]===n}))return!0;var b=0,x={};return m.forEach(function(E){var T=E.pos,A=E.type,R=E.line;if(!(T[0]>n))if(A==="intersection")++b;else{if(A==="line")return;if(A==="point"){var F=ff(R,function(U){return U[1]!==i}),N=x[T[0]],O=F[1]>i?1:-1;N?N!==O&&++b:x[T[0]]=O}}}),b%2===1}function JS(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],s=i-r,o=a-n;Math.abs(s)<Tl&&(s=0),Math.abs(o)<Tl&&(o=0);var c=0,f=0,d=0;return s?o?(c=-o/s,f=1,d=-c*r-n):(f=1,d=-n):o&&(c=-1,d=r),[c,f,d]}function OO(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],c=r===0&&a===0,f=n===0&&s===0,d=[];if(c&&f)return[];if(c){var m=-i/n,b=-o/s;return m!==b?[]:[[-1/0,m],[1/0,m]]}else if(f){var x=-i/r,E=-o/a;return x!==E?[]:[[x,-1/0],[x,1/0]]}else if(r===0){var T=-i/n,A=-(s*T+o)/a;d=[[A,T]]}else if(a===0){var T=-o/s,A=-(n*T+i)/r;d=[[A,T]]}else if(n===0){var A=-i/r,T=-(a*A+o)/s;d=[[A,T]]}else if(s===0){var A=-o/a,T=-(r*A+i)/n;d=[[A,T]]}else{var A=(n*o-s*i)/(s*r-n*a),T=-(r*A+i)/n;d=[[A,T]]}return d.map(function(R){return[R[0],R[1]]})}function zZ(t,e){var r=e.map(function(m){return[0,1].map(function(b){return[Math.min(m[0][b],m[1][b]),Math.max(m[0][b],m[1][b])]})}),n=[];if(t.length===2){var i=t[0],a=i[0],s=i[1];if(Ic(a-t[1][0])){if(!Ic(s-t[1][1])){var f=Math.max.apply(Math,r.map(function(m){return m[0][0]})),d=Math.min.apply(Math,r.map(function(m){return m[0][1]}));if(Ic(f-d)>0)return[];n=[[f,s],[d,s]]}}else{var o=Math.max.apply(Math,r.map(function(m){return m[1][0]})),c=Math.min.apply(Math,r.map(function(m){return m[1][1]}));if(Ic(o-c)>0)return[];n=[[a,o],[a,c]]}}return n.length||(n=t.filter(function(m){var b=m[0],x=m[1];return r.every(function(E){return 0<=Ic(b-E[0][0])&&0<=Ic(E[0][1]-b)&&0<=Ic(x-E[1][0])&&0<=Ic(E[1][1]-x)})})),n.map(function(m){return[Ic(m[0]),Ic(m[1])]})}function hk(t){return j1e(t.slice(1),[t[0]]).map(function(e,r){return[t[r],e]})}function $1e(t,e){var r=t.slice(),n=e.slice();T9(r)===-1&&r.reverse(),T9(n)===-1&&n.reverse();var i=hk(r),a=hk(n),s=i.map(function(d){return JS(d[0],d[1])}),o=a.map(function(d){return JS(d[0],d[1])}),c=[];s.forEach(function(d,m){var b=i[m],x=[];o.forEach(function(E,T){var A=OO(d,E),R=zZ(A,[b,a[T]]);x.push.apply(x,R.map(function(F){return{index1:m,index2:T,pos:F,type:"intersection"}}))}),x.sort(function(E,T){return hp(b[0],E.pos)-hp(b[0],T.pos)}),c.push.apply(c,x),fk(b[1],n)&&c.push({index1:m,index2:-1,pos:b[1],type:"inside"})}),a.forEach(function(d,m){if(fk(d[1],r)){var b=!1,x=bp(c,function(E){var T=E.index2;return T===m?(b=!0,!1):!!b});x===-1&&(b=!1,x=bp(c,function(E){var T=E.index1,A=E.index2;return T===-1&&A+1===m?(b=!0,!1):!!b})),x===-1?c.push({index1:-1,index2:m,pos:d[1],type:"inside"}):c.splice(x,0,{index1:-1,index2:m,pos:d[1],type:"inside"})}});var f={};return c.filter(function(d){var m=d.pos,b=m[0]+"x"+m[1];return f[b]?!1:(f[b]=!0,!0)})}function q1e(t,e){var r=$1e(t,e);return r.map(function(n){var i=n.pos;return i})}function H1e(t,e){var r=q1e(t,e);return BZ(r)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var dk=function(t,e){return dk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},dk(t,e)};function G1e(t,e){dk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var wl=function(){return wl=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},wl.apply(this,arguments)};function W1e(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return i>=0?i:i+Math.PI*2}function WA(t){return W1e([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function X1e(t){return t.touches&&t.touches.length>=2}function lw(t){return t?t.touches?Z1e(t.touches):[jZ(t)]:[]}function Y1e(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}function M9(t,e,r){var n=r.length,i=fb(t,n),a=i.clientX,s=i.clientY,o=i.originalClientX,c=i.originalClientY,f=fb(e,n),d=f.clientX,m=f.clientY,b=fb(r,n),x=b.clientX,E=b.clientY,T=a-d,A=s-m,R=a-x,F=s-E;return{clientX:o,clientY:c,deltaX:T,deltaY:A,distX:R,distY:F}}function XA(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function Z1e(t){for(var e=Math.min(t.length,2),r=[],n=0;n<e;++n)r.push(jZ(t[n]));return r}function jZ(t){return{clientX:t.clientX,clientY:t.clientY}}function fb(t,e){e===void 0&&(e=t.length);for(var r={clientX:0,clientY:0,originalClientX:0,originalClientY:0},n=Math.min(t.length,e),i=0;i<n;++i){var a=t[i];r.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,r.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,r.clientX+=a.clientX,r.clientY+=a.clientY}return e?{clientX:r.clientX/e,clientY:r.clientY/e,originalClientX:r.originalClientX/e,originalClientY:r.originalClientY/e}:r}var YA=(function(){function t(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return t.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),WA(e)},t.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),WA(e)-WA(this.startClients)},t.prototype.getPosition=function(e,r){e===void 0&&(e=this.prevClients);var n=M9(e||this.prevClients,this.prevClients,this.startClients),i=n.deltaX,a=n.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,n},t.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var r=this.prevClients,n=this.startClients,i=Math.min(this.length,r.length),a=[],s=0;s<i;++s)a[s]=M9([e[s]],[r[s]],[n[s]]);return a},t.prototype.getMovement=function(e){var r=this.movement;if(!e)return r;var n=fb(e,this.length),i=fb(this.prevClients,this.length),a=n.clientX-i.clientX,s=n.clientY-i.clientY;return Math.sqrt(a*a+s*s)+r},t.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),XA(e)},t.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),XA(e)/XA(this.startClients)},t.prototype.move=function(e,r){this.startClients.forEach(function(n){n.clientX-=e,n.clientY-=r}),this.prevClients.forEach(function(n){n.clientX-=e,n.clientY-=r})},t})(),k9=["textarea","input"],K1e=(function(t){G1e(e,t);function e(r,n){n===void 0&&(n={});var i=t.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(b,x){if(x===void 0&&(x=!0),!(!i.flag&&b.cancelable===!1)){var E=b.type.indexOf("drag")>=-1;if(!(i.flag&&E)){i._isDragAPI=!0;var T=i.options,A=T.container,R=T.pinchOutside,F=T.preventWheelClick,N=T.preventRightClick,O=T.preventDefault,U=T.checkInput,j=T.dragFocusedInput,H=T.preventClickEventOnDragStart,W=T.preventClickEventOnDrag,X=T.preventClickEventByCondition,oe=i._useTouch,ee=!i.flag;if(i._isSecondaryButton=b.which===3||b.button===2,F&&(b.which===2||b.button===1)||N&&(b.which===3||b.button===2))return i.stop(),!1;if(ee){var G=i._window.document.activeElement,ae=b.target;if(ae){var se=ae.tagName.toLowerCase(),fe=k9.indexOf(se)>-1,pe=ae.isContentEditable;if(fe||pe){if(U||!j&&G===ae)return!1;if(G&&(G===ae||pe&&G.isContentEditable&&G.contains(ae)))if(j)ae.blur();else return!1}else if((O||b.type==="touchstart")&&G){var De=G.tagName.toLowerCase();(G.isContentEditable||k9.indexOf(De)>-1)&&G.blur()}(H||W||X)&&Gu(i._window,"click",i._onClick,!0)}i.clientStores=[new YA(lw(b))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=x,i._dragFlag=!0,i._prevInputEvent=b,i.data={},i.doubleFlag=Ub()-i.prevTime<200,i._isMouseEvent=Y1e(b),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var ye=i._preventMouseEvent||i.emit("dragStart",wl(wl({data:i.data,datas:i.data,inputEvent:b,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:x,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){b.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));ye===!1&&i.stop(),i._isMouseEvent&&i.flag&&O&&b.preventDefault()}if(!i.flag)return!1;var we=0;if(ee?(i._attchDragEvent(),oe&&R&&(we=setTimeout(function(){Gu(A,"touchstart",i.onDragStart,{passive:!1})}))):oe&&R&&_u(A,"touchstart",i.onDragStart),i.flag&&X1e(b)){if(clearTimeout(we),ee&&b.touches.length!==b.changedTouches.length)return;i.pinchFlag||i.onPinchStart(b)}}}},i.onDrag=function(b,x){if(i.flag){var E=i.options.preventDefault;!i._isMouseEvent&&E&&b.preventDefault(),i._prevInputEvent=b;var T=lw(b),A=i.moveClients(T,b,!1);if(i._dragFlag){if(i.pinchFlag||A.deltaX||A.deltaY){var R=i._preventMouseEvent||i.emit("drag",wl(wl({},A),{isScroll:!!x,inputEvent:b}));if(R===!1){i.stop();return}}i.pinchFlag&&i.onPinch(b,T)}i.getCurrentStore().getPosition(T,!0)}},i.onDragEnd=function(b){if(i.flag){var x=i.options,E=x.pinchOutside,T=x.container,A=x.preventClickEventOnDrag,R=x.preventClickEventOnDragStart,F=x.preventClickEventByCondition,N=i.isDrag;(A||R||F)&&requestAnimationFrame(function(){i._allowClickEvent()}),!F&&!R&&A&&!N&&i._allowClickEvent(),i._useTouch&&E&&_u(T,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(b);var O=b?.touches?lw(b):[],U=O.length;U===0||!i.options.keepDragging?i.flag=!1:i._addStore(new YA(O));var j=i._getPosition(),H=Ub(),W=!N&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=N||W?0:H,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",wl({data:i.data,datas:i.data,isDouble:W,isDrag:N,isClick:!N,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:b,isTrusted:i._isTrusted},j)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){_u(i._window,"click",i._onClick,!0)},i._onClick=function(b){i._allowClickEvent(),i._allowMouseEvent();var x=i.options.preventClickEventByCondition;x?.(b)||(b.stopPropagation(),b.preventDefault())},i._onContextMenu=function(b){var x=i.options;x.preventRightClick?i.onDragEnd(b):b.preventDefault()},i._passCallback=function(){};var a=[].concat(r),s=a[0];i._window=RZ(s)?s:bg(s),i.options=wl({checkInput:!1,container:s&&!("document"in s)?bg(s):s,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n);var o=i.options,c=o.container,f=o.events,d=o.checkWindowBlur;if(i._useDrag=f.indexOf("drag")>-1,i._useTouch=f.indexOf("touch")>-1,i._useMouse=f.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(b){Gu(b,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(b){Gu(b,"mousedown",i.onDragStart),Gu(b,"mousemove",i._passCallback)}),Gu(c,"contextmenu",i._onContextMenu)),d&&Gu(bg(),"blur",i.onBlur),i._useTouch){var m={passive:!1};a.forEach(function(b){Gu(b,"touchstart",i.onDragStart,m),Gu(b,"touchmove",i._passCallback,m)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(r){return this.getCurrentStore().getMovement(r)+this.clientStores.slice(1).reduce(function(n,i){return n+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(r,n,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(r,n),a&&this.onDrag(i,!0))},e.prototype.move=function(r,n){var i=r[0],a=r[1],s=this.getCurrentStore(),o=s.prevClients;return this.moveClients(o.map(function(c){var f=c.clientX,d=c.clientY;return{clientX:f+i,clientY:d+a,originalClientX:f,originalClientY:d}}),n,!0)},e.prototype.triggerDragStart=function(r){this.onDragStart(r,!1)},e.prototype.setEventData=function(r){var n=this.data;for(var i in r)n[i]=r[i];return this},e.prototype.setEventDatas=function(r){return this.setEventData(r)},e.prototype.getCurrentEvent=function(r){return r===void 0&&(r=this._prevInputEvent),wl(wl({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:r})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var r=this,n=this.targets,i=this.options.container;this.off(),_u(this._window,"blur",this.onBlur),this._useDrag&&n.forEach(function(a){_u(a,"dragstart",r.onDragStart)}),this._useMouse&&(n.forEach(function(a){_u(a,"mousedown",r.onDragStart)}),_u(i,"contextmenu",this._onContextMenu)),this._useTouch&&(n.forEach(function(a){_u(a,"touchstart",r.onDragStart)}),_u(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(r){var n=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new YA(lw(r));this.pinchFlag=!0,this._addStore(a);var s=this.emit("pinchStart",wl(wl({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:r,isTrusted:this._isTrusted,preventDefault:function(){r.preventDefault()},preventDrag:function(){n._dragFlag=!1}}));s===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(r,n){if(!(!this.flag||!this.pinchFlag||n.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",wl(wl({data:this.data,datas:this.data,movement:this.getMovement(n),angle:i.getAngle(n),rotation:i.getRotation(n),touches:i.getPositions(n),scale:i.getScale(n),distance:i.getDistance(n)},i.getPosition(n)),{inputEvent:r,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(r){if(this.pinchFlag){var n=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",wl(wl({data:this.data,datas:this.data,isPinch:n,touches:i.getPositions()},i.getPosition()),{inputEvent:r}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(r,n,i){var a=this._getPosition(r,i),s=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var o=!1;return!s&&this.isDrag&&(o=!0),wl(wl({data:this.data,datas:this.data},a),{movement:this.getMovement(r),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:n,isTrusted:this._isTrusted,isFirstDrag:o})},e.prototype._addStore=function(r){this.clientStores.splice(0,0,r)},e.prototype._getPosition=function(r,n){var i=this.getCurrentStore(),a=i.getPosition(r,n),s=this.clientStores.slice(1).reduce(function(f,d){var m=d.getPosition();return f.distX+=m.distX,f.distY+=m.distY,f},a),o=s.distX,c=s.distY;return wl(wl({},a),{distX:o,distY:c})},e.prototype._attchDragEvent=function(){var r=this._window,n=this.options.container,i={passive:!1};this._isDragAPI&&(Gu(n,"dragover",this.onDrag,i),Gu(r,"dragend",this.onDragEnd)),this._useMouse&&(Gu(n,"mousemove",this.onDrag),Gu(r,"mouseup",this.onDragEnd)),this._useTouch&&(Gu(n,"touchmove",this.onDrag,i),Gu(r,"touchend",this.onDragEnd,i),Gu(r,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var r=this._window,n=this.options.container;this._isDragAPI&&(_u(n,"dragover",this.onDrag),_u(r,"dragend",this.onDragEnd)),this._useMouse&&(_u(n,"mousemove",this.onDrag),_u(r,"mouseup",this.onDragEnd)),this._useTouch&&(_u(n,"touchstart",this.onDragStart),_u(n,"touchmove",this.onDrag),_u(r,"touchend",this.onDragEnd),_u(r,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(DO);function J1e(t){for(var e=5381,r=t.length;r;)e=e*33^t.charCodeAt(--r);return e>>>0}var Q1e=J1e;function ebe(t){return Q1e(t).toString(36)}function tbe(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function rbe(t,e,r){return r.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(n,i){var a=i.trim();return(a?Mm(a):[""]).map(function(s){var o=s.trim();return o.indexOf("@")===0?o:o.indexOf(":global")>-1?o.replace(/\:global/g,""):o.indexOf(":host")>-1?"".concat(o.replace(/\:host/g,".".concat(t))):o?".".concat(t," ").concat(o):".".concat(t)}).join(", ")+" {"})}function nbe(t,e,r,n,i){var a=AO(n),s=a.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",t),s.setAttribute("data-styled-count","1"),r.nonce&&s.setAttribute("nonce",r.nonce),s.innerHTML=rbe(t,e,r),(i||a.head||a.body).appendChild(s),s}function ibe(t){var e="rCS"+ebe(t);return{className:e,inject:function(r,n){n===void 0&&(n={});var i=tbe(r),a=(i||r.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=nbe(e,t,n,r,i);else{var s=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(s+1))}return{destroy:function(){var o,c=parseFloat(a.getAttribute("data-styled-count"))||0;c<=1?(a.remove?a.remove():(o=a.parentNode)===null||o===void 0||o.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(c-1))}}}}}var pk=function(){return pk=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},pk.apply(this,arguments)};function abe(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function UZ(t,e){var r=ibe(e),n=r.className;return te.forwardRef(function(i,a){var s=i.className,o=s===void 0?"":s;i.cspNonce;var c=abe(i,["className","cspNonce"]),f=te.useRef();return te.useImperativeHandle(a,function(){return f.current},[]),te.useEffect(function(){var d=r.inject(f.current,{nonce:i.cspNonce});return function(){d.destroy()}},[]),te.createElement(t,pk({ref:f,"data-styled-id":n,className:"".concat(o," ").concat(n)},c))})}var gk=function(t,e){return gk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},gk(t,e)};function Nx(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");gk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Wt=function(){return Wt=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Wt.apply(this,arguments)};function obe(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function sbe(t,e,r,n){var i=arguments.length,a=i<3?e:n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,n);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(a=(i<3?s(a):i>3?s(e,r,a):s(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function lbe(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zt(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,a=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return a}function yn(t,e,r){if(arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}function Fx(t,e){return Wt({events:[],props:[],name:t},e)}var ube=["n","w","s","e"],LO=["n","w","s","e","nw","ne","sw","se"];function cbe(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function fbe(t){var e=cbe(1,t),r=Math.round(t/45)*45%180,n="ns-resize";return r===135?n="nwse-resize":r===45?n="nesw-resize":r===90&&(n="ew-resize"),"cursor:".concat(n,";cursor: url('").concat(e,"') 16 16, ").concat(n,";")}var g_=K_e(),VZ=g_.browser.webkit,$Z=VZ&&(function(){var t=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1})(),qZ=g_.browser.name,HZ=parseInt(g_.browser.version,10),hbe=qZ==="chrome",dbe=g_.browser.chromium,pbe=parseInt(g_.browser.chromiumVersion,10)||0,gbe=hbe&&HZ>=109||dbe&&pbe>=109,mbe=qZ==="firefox",ybe=parseInt(g_.browser.webkitVersion,10)>=612||HZ>=15,NO="moveable-",vbe=LO.map(function(t){var e="",r="",n="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",i="top"),t.indexOf("w")>-1&&(r="left: ".concat(a,";"),n="right"),t.indexOf("e")>-1&&(r="left: 0px;",n="left"),'.around-control[data-direction*="'.concat(t,`"] {
        `).concat(r).concat(e,`
        transform-origin: `).concat(n," ").concat(i,`;
    }`)}).join(`
`),_be=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(vbe,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return`
.direction[data-rotation="`.concat(t,'"], :global .view-control-rotation').concat(t,` {
`).concat(fbe(t),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat($Z?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),bbe=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],mk=1e-4,bc=1e-7,uw=1e-9,yk=Math.pow(10,10),R9=-yk,xbe={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},FO={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},GZ={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},wbe=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Bx(t,e,r,n,i,a){var s,o;a===void 0&&(a="draggable");var c=(o=(s=e.gestos[a])===null||s===void 0?void 0:s.move(r,t.inputEvent))!==null&&o!==void 0?o:{},f=c.originalDatas||c.datas,d=f[a]||(f[a]={});return Wt(Wt({},c),{isPinch:!!n,parentEvent:!0,datas:d,originalDatas:t.originalDatas})}var U0=(function(){function t(e){var r;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(r={},r[e]={},r)}return t.prototype.dragStart=function(e,r){this.isDrag=!1,this.isFlag=!1;var n=r.originalDatas;return this.datas=n,n[this.ableName]||(n[this.ableName]={}),Wt(Wt({},this.move(e,r.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(e,r){return this.move([e[0]-this.prevX,e[1]-this.prevY],r)},t.prototype.move=function(e,r){var n,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],n=e[0],i=e[1],this.isFlag=!0;else{var s=this.isDrag;n=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!s&&this.isDrag&&(a=!0)}return this.prevX=n,this.prevY=i,{type:"drag",clientX:n,clientY:i,inputEvent:r,isFirstDrag:a,isDrag:this.isDrag,distX:n-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t})();function C0(t,e,r,n){var i=t.length===16,a=i?4:3,s=xy(t,r,n,a),o=Zt(s,4),c=Zt(o[0],2),f=c[0],d=c[1],m=Zt(o[1],2),b=m[0],x=m[1],E=Zt(o[2],2),T=E[0],A=E[1],R=Zt(o[3],2),F=R[0],N=R[1],O=Zt(xs(t,e,a),2),U=O[0],j=O[1],H=Math.min(f,b,T,F),W=Math.min(d,x,A,N),X=Math.max(f,b,T,F),oe=Math.max(d,x,A,N);f=f-H||0,b=b-H||0,T=T-H||0,F=F-H||0,d=d-W||0,x=x-W||0,A=A-W||0,N=N-W||0,U=U-H||0,j=j-W||0;var ee=t[0],G=t[a+1],ae=mc(ee*G);return{left:H,top:W,right:X,bottom:oe,origin:[U,j],pos1:[f,d],pos2:[b,x],pos3:[T,A],pos4:[F,N],direction:ae}}function WZ(t,e){var r=e.clientX,n=e.clientY,i=e.datas,a=t.state,s=a.moveableClientRect,o=a.rootMatrix,c=a.is3d,f=a.pos1,d=s.left,m=s.top,b=c?4:3,x=Zt(_i(q0(o,[r-d,n-m],b),f),2),E=x[0],T=x[1],A=Zt(Pd({datas:i,distX:E,distY:T}),2),R=A[0],F=A[1];return[R,F]}function by(t,e){var r=e.datas,n=t.state,i=n.allMatrix,a=n.beforeMatrix,s=n.is3d,o=n.left,c=n.top,f=n.origin,d=n.offsetMatrix,m=n.targetMatrix,b=n.transformOrigin,x=s?4:3;r.is3d=s,r.matrix=i,r.targetMatrix=m,r.beforeMatrix=a,r.offsetMatrix=d,r.transformOrigin=b,r.inverseMatrix=wd(i,x),r.inverseBeforeMatrix=wd(a,x),r.absoluteOrigin=Km(Ra([o,c],f),x),r.startDragBeforeDist=rc(r.inverseBeforeMatrix,r.absoluteOrigin,x),r.startDragDist=rc(r.inverseMatrix,r.absoluteOrigin,x)}function Sbe(t){return C0(t.datas.beforeTransform,[50,50],100,100).direction}function t3(t,e,r){var n=e.datas,i=e.originalDatas.beforeRenderable,a=n.transformIndex,s=i.nextTransforms,o=s.length,c=i.nextTransformAppendedIndexes,f=-1;a===-1?(r==="translate"?f=0:r==="rotate"&&(f=bp(s,function(x){return x.match(/scale\(/g)})),f===-1&&(f=s.length),n.transformIndex=f):ff(c,function(x){return x.index===a&&x.functionName===r})?f=a:f=a+c.filter(function(x){return x.index<a}).length;var d=Yxe(s,t.state,f),m=d.targetFunction,b=r==="rotate"?"rotateZ":r;n.beforeFunctionTexts=d.beforeFunctionTexts,n.afterFunctionTexts=d.afterFunctionTexts,n.beforeTransform=d.beforeFunctionMatrix,n.beforeTransform2=d.beforeFunctionMatrix2,n.targetTansform=d.targetFunctionMatrix,n.afterTransform=d.afterFunctionMatrix,n.afterTransform2=d.afterFunctionMatrix2,n.targetAllTransform=d.allFunctionMatrix,m.functionName===b?(n.afterFunctionTexts.splice(0,1),n.isAppendTransform=!1):o>f&&(n.isAppendTransform=!0,i.nextTransformAppendedIndexes=yn(yn([],Zt(c),!1),[{functionName:r,index:f,isAppend:!0}],!1))}function r3(t,e,r){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?r:e," ").concat(t.afterFunctionTexts.join(" "))}function Ebe(t){var e=t.datas,r=t.distX,n=t.distY,i=Zt(YZ({datas:e,distX:r,distY:n}),2),a=i[0],s=i[1],o=XZ(e,b1e([a,s],4));return rc(o,Km([0,0,0],4),4)}function XZ(t,e,r){var n=t.beforeTransform,i=t.afterTransform,a=t.beforeTransform2,s=t.afterTransform2,o=t.targetAllTransform,c=r?So(o,e,4):So(e,o,4),f=So(wd(r?a:n,4),c,4),d=So(f,wd(r?s:i,4),4);return d}function YZ(t){var e=t.datas,r=t.distX,n=t.distY,i=e.inverseBeforeMatrix,a=e.is3d,s=e.startDragBeforeDist,o=e.absoluteOrigin,c=a?4:3;return _i(rc(i,Ra(o,[r,n]),c),s)}function Pd(t,e){var r=t.datas,n=t.distX,i=t.distY,a=r.inverseBeforeMatrix,s=r.inverseMatrix,o=r.is3d,c=r.startDragBeforeDist,f=r.startDragDist,d=r.absoluteOrigin,m=o?4:3;return _i(rc(e?a:s,Ra(d,[n,i]),m),e?c:f)}function Tbe(t,e){var r=t.datas,n=t.distX,i=t.distY;r.beforeMatrix;var a=r.matrix,s=r.is3d;r.startDragBeforeDist;var o=r.startDragDist,c=r.absoluteOrigin,f=s?4:3;return _i(rc(a,Ra(o,[n,i]),f),c)}function Cbe(t,e,r,n,i,a){return n===void 0&&(n=e),i===void 0&&(i=r),a===void 0&&(a=[0,0]),t?t.map(function(s,o){var c=Dx(s),f=c.value,d=c.unit,m=o?i:n,b=o?r:e;if(s==="%"||isNaN(f)){var x=m?a[o]/m:0;return b*x}else if(d!=="%")return f;return b*f/100}):a}function ZZ(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function Abe(t,e){return ZZ(e).map(function(r){return t[r]})}function ZA(t,e){var r=(e+1)/2;return[ZS(t[0][0],t[1][0],r,1-r),ZS(t[0][1],t[1][1],r,1-r)]}function zl(t,e){var r=ZA([t[0],t[1]],e[0]),n=ZA([t[2],t[3]],e[0]);return ZA([r,n],e[1])}function Ibe(t,e,r,n,i,a){var s=xy(e,r,n,i),o=zl(s,a),c=t[0]-o[0],f=t[1]-o[1];return[c,f]}function zx(t,e,r,n){return So(t,db(e,n,r),n)}function Pbe(t,e,r,n){var i=t.transformOrigin,a=t.offsetMatrix,s=t.is3d,o=s?4:3,c;if(Ap(r)){var f=e.beforeTransform,d=e.afterTransform;n?c=Ah(Vb(r),4,o):c=Ah(So(So(f,Vb([r]),4),d,4),4,o)}else c=r;return zx(a,c,i,o)}function Mbe(t,e){var r=t.transformOrigin,n=t.offsetMatrix,i=t.is3d,a=t.targetMatrix,s=t.targetAllTransform,o=i?4:3;return zx(n,So(s||a,MO(e,o),o),r,o)}function n3(t,e){var r=m_(e);return{setTransform:function(n,i){i===void 0&&(i=-1),r.startTransforms=su(n)?n:Ag(n),vk(t,e,i)},setTransformIndex:function(n){vk(t,e,n)}}}function i3(t,e,r){var n=m_(e),i=n.startTransforms;vk(t,e,bp(i,function(a){return a.indexOf("".concat(r,"("))===0}))}function vk(t,e,r){var n=m_(e),i=e.datas;if(i.transformIndex=r,r!==-1){var a=n.startTransforms[r];if(a){var s=t.state,o=j0([a],{"x%":function(c){return c/100*s.offsetWidth},"y%":function(c){return c/100*s.offsetHeight}});i.startValue=o[0].functionValue}}}function BO(t,e){var r=m_(t);r.nextTransforms=Ag(e)}function m_(t){return t.originalDatas.beforeRenderable}function QS(t){var e=t.originalDatas.beforeRenderable;return e.nextTransforms}function cw(t){return(QS(t)||[]).join(" ")}function fw(t){return m_(t).nextStyle}function KZ(t,e,r,n,i){BO(i,e);var a=gc.drag(t,Bx(i,t.state,r,n)),s=a?a.transform:e;return Wt(Wt({transform:e,drag:a},yc({transform:s},i)),{afterTransform:s})}function zO(t,e,r,n,i,a){var s=Pbe(t.state,i,e,a),o=Dbe(t,r,n,s);return o}function JZ(t,e,r,n,i,a,s){var o=zO(t,e,r,i,a,s),c=t.state,f=c.left,d=c.top,m=t.props.groupable,b=m?f:0,x=m?d:0,E=_i(n,o);return _i(E,[b,x])}function kbe(t,e,r,n,i,a,s){var o=JZ(t,e,r,n,i,a,s);return o}function Rbe(t,e,r){return[e?-1+t[0]/(e/2):0,r?-1+t[1]/(r/2):0]}function Dbe(t,e,r,n){n===void 0&&(n=t.state.allMatrix);var i=t.state,a=i.width,s=i.height,o=i.is3d,c=o?4:3,f=[a/2*(1+e[0])+r[0],s/2*(1+e[1])+r[1]];return xs(n,f,c)}function Obe(t,e,r){var n=r.fixedDirection,i=r.fixedPosition,a=r.fixedOffset;return JZ(t,"rotate(".concat(e,"deg)"),n,i,a,r)}function Lbe(t,e,r,n,i,a){var s=t.props.groupable,o=t.state,c=o.transformOrigin,f=o.offsetMatrix,d=o.is3d,m=o.width,b=o.height,x=o.left,E=o.top,T=a.fixedDirection,A=a.nextTargetMatrix||o.targetMatrix,R=d?4:3,F=Cbe(i,e,r,m,b,c),N=s?x:0,O=s?E:0,U=zx(f,A,F,R),j=Ibe(n,U,e,r,R,T);return _i(j,[N,O])}function Nbe(t,e){return zl(Wf(t.state),e)}function Fbe(t,e){var r=t.targetGesto,n=t.controlGesto,i;return r?.isFlag()&&(i=r.getEventData()[e]),!i&&n?.isFlag()&&(i=n.getEventData()[e]),i||{}}function Bbe(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function zbe(t){var e=t("scale"),r=t("rotate"),n=t("translate"),i=[];return n&&n!=="0px"&&n!=="none"&&i.push("translate(".concat(n.split(/\s+/).join(","),")")),r&&r!=="1"&&r!=="none"&&i.push("rotate(".concat(r,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function QZ(t,e,r){for(var n=t,i=[],a=IO(t)||zg(t),s=!r&&t===e||t===a,o=s,c=!1,f=3,d,m,b,x=!1,E=qb(e,e,!0).offsetParent,T=1;n&&!o;){o=s;var A=Lc(n),R=A("position"),F=SK(n),N=R==="fixed",O=zbe(A),U=x1e(Nxe(F)),j=void 0,H=!1,W=!1,X=0,oe=0,ee=0,G=0,ae={hasTransform:!1,fixedContainer:null};N&&(x=!0,ae=Uxe(n),E=ae.fixedContainer);var se=U.length;!c&&(se===16||O.length)&&(c=!0,f=4,Ek(i),b&&(b=Ah(b,3,4))),c&&se===9&&(U=Ah(U,3,4));var fe=jxe(n,t),pe=fe.tagName,De=fe.hasOffset,ye=fe.isSVG,we=fe.origin,Te=fe.targetOrigin,Re=fe.offset,de=Zt(Re,2),Ee=de[0],xe=de[1];pe==="svg"&&!n.ownerSVGElement&&b&&(i.push({type:"target",target:n,matrix:Vxe(n,f)}),i.push({type:"offset",target:n,matrix:Qo(f)}));var Ne=parseFloat(A("zoom"))||1;if(N)j=ae.fixedContainer,H=!0;else{var Fe=qb(n,e,!1,!0,A),Xe=Fe.offsetZoom;if(j=Fe.offsetParent,H=Fe.isEnd,W=Fe.isStatic,T*=Xe,(Fe.isCustomElement||Xe!==1)&&W)Ee-=j.offsetLeft,xe-=j.offsetTop;else if(mbe||gbe){var Be=Fe.parentSlotElement;if(Be){for(var ot=j,Ke=0,it=0;ot&&Bbe(ot);)Ke+=ot.offsetLeft,it+=ot.offsetTop,ot=ot.offsetParent;Ee-=Ke,xe-=it}}}if(VZ&&!ybe&&De&&!ye&&W&&(R==="relative"||R==="static")&&(Ee-=j.offsetLeft,xe-=j.offsetTop,s=s||H),N)De&&ae.hasTransform&&(ee=j.clientLeft,G=j.clientTop);else if(De&&E!==j&&(X=j.clientLeft,oe=j.clientTop),De&&j===a){var Me=EK(n,!1);Ee+=Me[0],xe+=Me[1]}if(i.push({type:"target",target:n,matrix:db(U,f,we)}),O.length&&(i.push({type:"offset",target:n,matrix:Qo(f)}),i.push({type:"target",target:n,matrix:db(Vb(O),f,we)})),De){var zt=n===t,st=zt?0:n.scrollLeft,$e=zt?0:n.scrollTop;i.push({type:"offset",target:n,matrix:Jm([Ee-st+X-ee,xe-$e+oe-G],f)})}else i.push({type:"offset",target:n,origin:we});if(Ne!==1&&i.push({type:"zoom",target:n,matrix:db(MO([Ne,Ne],f),f,[0,0])}),b||(b=U),d||(d=we),m||(m=Te),o||N)break;n=j,s=H,(!r||n===a)&&(o=s)}return b||(b=Qo(f)),d||(d=[0,0]),m||(m=[0,0]),{zoom:T,offsetContainer:E,matrixes:i,targetMatrix:b,transformOrigin:d,targetOrigin:m,is3d:c,hasFixed:x}}var Sm=null,Em=null,o0=null;function V0(t){t?(window.Map&&(Sm=new Map,Em=new Map),o0=[]):(Sm=null,o0=null,Em=null)}function jbe(t){var e=Em?.get(t);if(e)return e;var r=pb(t,!0);return Em&&Em.set(t,r),r}function Ube(t,e){if(o0){var r=ff(o0,function(i){return i[0][0]==t&&i[0][1]==e});if(r)return r[1]}var n=QZ(t,e,!0);return o0&&o0.push([[t,e],n]),n}function Lc(t){var e=Sm?.get(t);if(!e){var r=bg(t).getComputedStyle(t);if(!Sm)return function(a){return r[a]};e={style:r,cached:{}},Sm.set(t,e)}var n=e.cached,i=e.style;return function(a){return a in n||(n[a]=i[a]),n[a]}}function Eh(t,e,r){var n=r.originalDatas;n.groupable=n.groupable||{};var i=n.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return t.moveables.map(function(s,o){return a[o]=a[o]||{},a[o][e]=a[o][e]||{},Wt(Wt({},r),{isRequestChild:!0,datas:a[o][e],originalDatas:a[o]})})}function KA(t,e,r,n,i,a,s){var o=!!r.match(/Start$/g),c=!!r.match(/End$/g),f=i.isPinch,d=i.datas,m=Eh(t,e.name,i),b=t.moveables,x=[],E=m.map(function(T,A){var R=b[A],F=R.state,N=F.gestos,O=T;if(o)O=new U0(s).dragStart(n,T),x.push(O);else{if(N[s]||(N[s]=d.childGestos[A]),!N[s])return;O=Bx(T,F,n,f,a,s),x.push(O)}var U=e[r](R,Wt(Wt({},O),{parentFlag:!0}));return c&&(N[s]=null),U});return o&&(d.childGestos=b.map(function(T){return T.state.gestos[s]})),{eventParams:E,childEvents:x}}function dp(t,e,r,n,i,a){i===void 0&&(i=function(d,m){return m});var s=!!r.match(/End$/g),o=Eh(t,e.name,n),c=t.moveables,f=o.map(function(d,m){var b=c[m],x=d;x=i(b,d);var E=e[r](b,Wt(Wt({},x),{parentFlag:!0}));return s&&(b.state.gestos={}),E});return f}function eE(t,e,r,n){var i=r.fixedDirection,a=r.fixedPosition,s=n.datas.startPositions||Wf(e.state),o=zl(s,i),c=Zt(rc(Lx(-t.rotation/180*Math.PI,3),[o[0]-a[0],o[1]-a[1],1],3),2),f=c[0],d=c[1];return n.datas.originalX=f,n.datas.originalY=d,n}function eK(t,e,r,n){var i=t.getState(),a=i.renderPoses,s=i.rotation,o=i.direction,c=ey(t.props,e).zoom,f=hb(s/Math.PI*180),d={},m=t.renderState;m.renderDirectionMap||(m.renderDirectionMap={});var b=m.renderDirectionMap;r.forEach(function(E){var T=E.dir;d[T]=!0});var x=mc(o);return r.map(function(E){var T=E.data,A=E.classNames,R=E.dir,F=FO[R];if(!F||!d[R])return null;b[R]=!0;var N=(Fi(f,15)+x*GZ[R]+720)%180,O={};return p_(T).forEach(function(U){O["data-".concat(U)]=T[U]}),n.createElement("div",Wt({className:yi.apply(void 0,yn(["control","direction",R,e],Zt(A),!1)),"data-rotation":N,"data-direction":R},O,{key:"direction-".concat(R),style:iE.apply(void 0,yn([s,c],Zt(F.map(function(U){return a[U]})),!1))}))})}function tK(t,e,r,n){var i=ey(t.props,r),a=i.renderDirections,s=a===void 0?e:a,o=i.displayAroundControls;if(!s)return[];var c=s===!0?LO:s;return yn(yn([],Zt(o?aK(t,n,r,c):[]),!1),Zt(eK(t,r,c.map(function(f){return{data:{},classNames:[],dir:f}}),n)),!1)}function $b(t,e,r,n,i,a){for(var s=[],o=6;o<arguments.length;o++)s[o-6]=arguments[o];var c=al(r,n),f=e?Fi(c/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(a),className:yi.apply(void 0,yn(["line","direction",e?"edge":"",e],Zt(s),!1)),"data-rotation":f,"data-line-key":a,"data-direction":e,style:N1(r,n,i,c)})}function rK(t,e,r,n,i){var a=r===!0?ube:r;return a.map(function(s,o){var c=Zt(FO[s],2),f=c[0],d=c[1];if(d!=null)return $b(t,s,n[f],n[d],i,"".concat(e,"Edge").concat(o),e)}).filter(Boolean)}function nK(t){return function(e,r){var n=ey(e.props,t).edge;return n&&(n===!0||n.length)?yn(yn([],Zt(rK(r,t,n,e.getState().renderPoses,e.props.zoom)),!1),Zt(Vbe(e,t,r)),!1):iK(e,t,r)}}function iK(t,e,r){return tK(t,LO,e,r)}function Vbe(t,e,r){return tK(t,["nw","ne","sw","se"],e,r)}function aK(t,e,r,n){var i=t.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=t.getState(),s=a.renderPoses,o=a.rotation,c=a.direction,f=i.renderDirectionMap,d=t.props.zoom,m=mc(c),b=o/Math.PI*180;return(n||p_(f)).map(function(x){var E=FO[x];if(!E)return null;var T=(Fi(b,15)+m*GZ[x]+720)%180,A=["around-control"];return r&&A.push("direction",r),e.createElement("div",{className:yi.apply(void 0,yn([],Zt(A),!1)),"data-rotation":T,"data-direction":x,key:"direction-around-".concat(x),style:iE.apply(void 0,yn([o,d],Zt(E.map(function(R){return s[R]})),!1))})})}function jO(t,e,r){var n=t||{},i=n.position,a=i===void 0?"client":i,s=n.left,o=s===void 0?-1/0:s,c=n.top,f=c===void 0?-1/0:c,d=n.right,m=d===void 0?1/0:d,b=n.bottom,x=b===void 0?1/0:b,E={position:a,left:o,top:f,right:m,bottom:x};return{vertical:D9(E,e,!0),horizontal:D9(E,r,!1)}}function a3(t,e){var r=t.state,n=r.containerClientRect,i=n.clientHeight,a=n.clientWidth,s=n.clientLeft,o=n.clientTop,c=r.snapOffset,f=c.left,d=c.top,m=c.right,b=c.bottom,x=e||t.props.bounds||{},E=x.position||"client",T=E==="css",A=x.left,R=A===void 0?-1/0:A,F=x.top,N=F===void 0?-1/0:F,O=x.right,U=O===void 0?T?-1/0:1/0:O,j=x.bottom,H=j===void 0?T?-1/0:1/0:j;return T&&(U=a+m-f-U,H=i+b-d-H),{left:R+f-s,right:U+f-s,top:N+d-o,bottom:H+d-o}}function $be(t,e,r){var n=a3(t),i=n.left,a=n.top,s=n.right,o=n.bottom,c=Zt(r,2),f=c[0],d=c[1],m=Zt(_i(r,e),2),b=m[0],x=m[1];rn(b)<bc&&(b=0),rn(x)<bc&&(x=0);var E=x>0,T=b>0,A={isBound:!1,offset:0,pos:0},R={isBound:!1,offset:0,pos:0};if(b===0&&x===0)return{vertical:A,horizontal:R};if(b===0)E?o<d&&(R.pos=o,R.offset=d-o):a>d&&(R.pos=a,R.offset=d-a);else if(x===0)T?s<f&&(A.pos=s,A.offset=f-s):i>f&&(A.pos=i,A.offset=f-i);else{var F=x/b,N=r[1]-F*f,O=0,U=0,j=!1;T&&s<=f?(O=F*s+N,U=s,j=!0):!T&&f<=i&&(O=F*i+N,U=i,j=!0),j&&(O<a||O>o)&&(j=!1),j||(E&&o<=d?(O=o,U=(O-N)/F,j=!0):!E&&d<=a&&(O=a,U=(O-N)/F,j=!0)),j&&(A.isBound=!0,A.pos=U,A.offset=f-U,R.isBound=!0,R.pos=O,R.offset=d-O)}return{vertical:A,horizontal:R}}function D9(t,e,r){var n=t[r?"left":"top"],i=t[r?"right":"bottom"],a=Math.min.apply(Math,yn([],Zt(e),!1)),s=Math.max.apply(Math,yn([],Zt(e),!1)),o=[];return n+1>a&&o.push({direction:"start",isBound:!0,offset:a-n,pos:n}),i-1<s&&o.push({direction:"end",isBound:!0,offset:s-i,pos:i}),o.length||o.push({isBound:!1,offset:0,pos:0}),o.sort(function(c,f){return rn(f.offset)-rn(c.offset)})}function O9(t,e,r){var n=r?t.map(function(i){return Ox(i,r)}):t;return n.some(function(i){return i[0]<e.left&&rn(i[0]-e.left)>.1||i[0]>e.right&&rn(i[0]-e.right)>.1||i[1]<e.top&&rn(i[1]-e.top)>.1||i[1]>e.bottom&&rn(i[1]-e.bottom)>.1})}function qbe(t,e,r){var n=Gf(t),i=Math.sqrt(n*n-e*e)||0;return[i,-i].sort(function(a,s){return rn(a-t[r?0:1])-rn(s-t[r?0:1])}).map(function(a){return al([0,0],r?[a,e]:[e,a])})}function Hbe(t,e,r,n,i){if(!t.props.bounds)return[];var a=i*Math.PI/180,s=a3(t),o=s.left,c=s.top,f=s.right,d=s.bottom,m=o-n[0],b=f-n[0],x=c-n[1],E=d-n[1],T={left:m,top:x,right:b,bottom:E};if(!O9(r,T,0))return[];var A=[];return[[m,0],[b,0],[x,1],[E,1]].forEach(function(R){var F=Zt(R,2),N=F[0],O=F[1];r.forEach(function(U){var j=al([0,0],U);A.push.apply(A,yn([],Zt(qbe(U,N,O).map(function(H){return a+H-j}).filter(function(H){return!O9(e,T,H)}).map(function(H){return Fi(H*180/Math.PI,bc)})),!1))})}),A}var Gbe=["left","right","center"],Wbe=["top","bottom","middle"],L9={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},Ig={start:"left",end:"right",center:"center"},Pg={start:"top",end:"bottom",center:"middle"};function s0(){return{left:!1,top:!1,right:!1,bottom:!1}}function y_(t,e){var r=t.props,n=r.snappable,i=r.bounds,a=r.innerBounds,s=r.verticalGuidelines,o=r.horizontalGuidelines,c=r.snapGridWidth,f=r.snapGridHeight,d=t.state,m=d.guidelines,b=d.enableSnap;return!n||!b||e&&n!==!0&&n.indexOf(e)<0?!1:!!(c||f||i||a||m&&m.length||s&&s.length||o&&o.length)}function UO(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function Xbe(t,e){var r=UO(t),n={};for(var i in r)i in e&&r[i]&&(n[i]=e[i]);return n}function VO(t,e){var r=Xbe(t,e),n=Wbe.filter(function(a){return a in r}),i=Gbe.filter(function(a){return a in r});return{horizontalNames:n,verticalNames:i,horizontal:n.map(function(a){return r[a]}),vertical:i.map(function(a){return r[a]})}}function Ybe(t,e,r){var n=xs(t,[e.clientLeft,e.clientTop],r);return[e.left+n[0],e.top+n[1]]}function Zbe(t){var e=Zt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];Math.abs(i)<Tl&&(i=0),Math.abs(a)<Tl&&(a=0);var s=0,o=0,c=0;return i?a?(s=-a/i,o=1,c=s*r[0]-r[1]):(o=1,c=-r[1]):(s=-1,c=r[0]),[s,o,c].map(function(f){return Fi(f,Tl)})}var oK="snapRotationThreshold",sK="snapRotationDegrees",lK="snapHorizontalThreshold",uK="snapVerticalThreshold";function o3(t,e,r,n,i,a,s){var o;n===void 0&&(n=[]),i===void 0&&(i=[]);var c=t.props,f=((o=t.state.snapThresholdInfo)===null||o===void 0?void 0:o.multiples)||[1,1],d=Z9(s,c[lK],5),m=Z9(a,c[uK],5);return cK(t.state.guidelines,e,r,n,i,d,m,f)}function cK(t,e,r,n,i,a,s,o){return{vertical:F9(t,"vertical",e,s*o[0],n),horizontal:F9(t,"horizontal",r,a*o[1],i)}}function Kbe(t,e,r){var n=Zt(r,2),i=n[0],a=n[1],s=Zt(e,2),o=s[0],c=s[1],f=Zt(_i(r,e),2),d=f[0],m=f[1],b=m>0,x=d>0;d=aE(d),m=aE(m);var E={isSnap:!1,offset:0,pos:0},T={isSnap:!1,offset:0,pos:0};if(d===0&&m===0)return{vertical:E,horizontal:T};var A=o3(t,d?[i]:[],m?[a]:[],[],[],void 0,void 0),R=A.vertical,F=A.horizontal;R.posInfos.filter(function(pe){var De=pe.pos;return x?De>=o:De<=o}),F.posInfos.filter(function(pe){var De=pe.pos;return b?De>=c:De<=c}),R.isSnap=R.posInfos.length>0,F.isSnap=F.posInfos.length>0;var N=_k(R),O=N.isSnap,U=N.guideline,j=_k(F),H=j.isSnap,W=j.guideline,X=H?W.pos[1]:0,oe=O?U.pos[0]:0;if(d===0)H&&(T.isSnap=!0,T.pos=W.pos[1],T.offset=a-T.pos);else if(m===0)O&&(E.isSnap=!0,E.pos=oe,E.offset=i-oe);else{var ee=m/d,G=r[1]-ee*i,ae=0,se=0,fe=!1;O?(se=oe,ae=ee*se+G,fe=!0):H&&(ae=X,se=(ae-G)/ee,fe=!0),fe&&(E.isSnap=!0,E.pos=se,E.offset=i-se,T.isSnap=!0,T.pos=ae,T.offset=a-ae)}return{vertical:E,horizontal:T}}function hg(t){var e="";return t===-1||t==="top"||t==="left"?e="start":t===0||t==="center"||t==="middle"?e="center":(t===1||t==="right"||t==="bottom")&&(e="end"),e}function N9(t,e,r,n){var i=VO(t.props.snapDirections,e),a=o3(t,i.vertical,i.horizontal,i.verticalNames.map(function(c){return hg(c)}),i.horizontalNames.map(function(c){return hg(c)}),r,n),s=hg(i.horizontalNames[a.horizontal.index]),o=hg(i.verticalNames[a.vertical.index]);return{vertical:Wt(Wt({},a.vertical),{direction:o}),horizontal:Wt(Wt({},a.horizontal),{direction:s})}}function _k(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var r=t.posInfos[0],n=r.guidelineInfos[0],i=n.offset,a=n.dist,s=n.guideline;return{isSnap:e,offset:i,dist:a,pos:r.pos,guideline:s}}function F9(t,e,r,n,i){var a,s;if(i===void 0&&(i=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var o=e==="vertical",c=o?0:1,f=r.map(function(m,b){var x=i[b]||"",E=t.map(function(T){var A=T.pos,R=m-A[c];return{offset:R,dist:rn(R),guideline:T,direction:x}}).filter(function(T){var A=T.guideline,R=T.dist,F=A.type;return!(F!==e||R>n)}).sort(function(T,A){return T.dist-A.dist});return{pos:m,index:b,guidelineInfos:E,direction:x}}).filter(function(m){return m.guidelineInfos.length>0}).sort(function(m,b){return m.guidelineInfos[0].dist-b.guidelineInfos[0].dist}),d=f.length>0;return{isSnap:d,index:d?f[0].index:-1,direction:(s=(a=f[0])===null||a===void 0?void 0:a.direction)!==null&&s!==void 0?s:"",posInfos:f}}function Jbe(t,e,r,n,i){var a=[];r[0]&&r[1]?a=[r,[-r[0],r[1]],[r[0],-r[1]]]:!r[0]&&!r[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(b,x,E){var T=E[x+1]||E[0];a.push(b),a.push([(b[0]+T[0])/2,(b[1]+T[1])/2])}):t.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],r):(a.push.apply(a,yn([],Zt(Abe([[-1,-1],[1,-1],[-1,-1],[1,1]],r)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var s=a.map(function(b){return zl(e,b)}),o=s.map(function(b){return b[0]}),c=s.map(function(b){return b[1]}),f=o3(t,o,c,a.map(function(b){return hg(b[0])}),a.map(function(b){return hg(b[1])}),n,i),d=hg(a.map(function(b){return b[0]})[f.vertical.index]),m=hg(a.map(function(b){return b[1]})[f.horizontal.index]);return{vertical:Wt(Wt({},f.vertical),{direction:d}),horizontal:Wt(Wt({},f.horizontal),{direction:m})}}function fK(t,e){var r=rn(t.offset),n=rn(e.offset);return t.isBound&&e.isBound?n-r:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?n-r:t.isSnap?-1:e.isSnap||r<bc?1:n<bc?-1:r-n}function tE(t,e){return t.slice().sort(function(r,n){var i=r.sign[e],a=n.sign[e],s=r.offset[e],o=n.offset[e];if(i){if(!a)return-1}else return 1;return fK({isBound:r.isBound,isSnap:r.isSnap,offset:s},{isBound:n.isBound,isSnap:n.isSnap,offset:o})})[0]}function Qbe(t,e,r){var n=[];if(r)rn(e[0])!==1||rn(e[1])!==1?n.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):n.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),n.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var i=t[0]?t:[1,1];[1,-1].forEach(function(s){[1,-1].forEach(function(o){var c=[s*i[0],o*i[1]];e[0]===c[0]&&e[1]===c[1]||n.push([e,c])})})}else if(t[0]){var a=rn(e[0])===1?[1]:[1,-1];a.forEach(function(s){n.push([[e[0],-1],[s*t[0],-1]],[[e[0],0],[s*t[0],0]],[[e[0],1],[s*t[0],1]])})}else if(t[1]){var a=rn(e[1])===1?[1]:[1,-1];a.forEach(function(o){n.push([[-1,e[1]],[-1,o*t[1]]],[[0,e[1]],[0,o*t[1]]],[[1,e[1]],[1,o*t[1]]])})}return n}function hK(t,e){var r=sk([e[0][0],e[1][0]]),n=sk([e[0][1],e[1][1]]);return{vertical:r<=t[0],horizontal:n<=t[1]}}function $O(t,e){var r=Zt(e,2),n=r[0],i=r[1],a=i[0]-n[0],s=i[1]-n[1];rn(a)<bc&&(a=0),rn(s)<bc&&(s=0);var o,c;if(!a)o=n[0],c=t[0];else if(!s)o=n[1],c=t[1];else{var f=s/a;o=f*(t[0]-n[0])+n[1],c=t[1]}return o-c}function dK(t,e,r,n){return n===void 0&&(n=bc),t.every(function(i){var a=$O(i,e),s=a<=0;return s===r||rn(a)<=n})}function B9(t,e,r,n,i){return i===void 0&&(i=0),n&&e-i<=t||!n&&t<=r+i?{isBound:!0,offset:n?e-t:r-t}:{isBound:!1,offset:0}}function exe(t,e){var r=e.line,n=e.centerSign,i=e.verticalSign,a=e.horizontalSign,s=e.lineConstants,o=t.props.innerBounds;if(!o)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var c=o.left,f=o.top,d=o.width,m=o.height,b=[[c,f],[c,f+m]],x=[[c,f],[c+d,f]],E=[[c+d,f],[c+d,f+m]],T=[[c,f+m],[c+d,f+m]];if(dK([[c,f],[c+d,f],[c,f+m],[c+d,f+m]],r,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var A=dg(r,s,x,i),R=dg(r,s,T,i),F=dg(r,s,b,a),N=dg(r,s,E,a),O=A.isBound&&R.isBound,U=A.isBound||R.isBound,j=F.isBound&&N.isBound,H=F.isBound||N.isBound,W=$0(A.offset,R.offset),X=$0(F.offset,N.offset),oe=[0,0],ee=!1,G=!1;return rn(X)<rn(W)?(oe=[W,0],ee=U,G=O):(oe=[0,X],ee=H,G=j),{isAllBound:G,isVerticalBound:U,isHorizontalBound:H,isBound:ee,offset:oe}}function dg(t,e,r,n,i,a){var s=Zt(e,2),o=s[0],c=s[1],f=t[0],d=r[0],m=r[1],b=aE(m[1]-d[1]),x=aE(m[0]-d[0]),E=c,T=o,A=-o/c;if(x){if(!b){if(a&&!E)return{isBound:!1,offset:0};if(T){var O=(d[1]-f[1])/A+f[0];return B9(O,d[0],m[0],n,i)}else{var F=d[1]-f[1],N=rn(F)<=(i||0);return{isBound:N,offset:N?F:0}}}}else{if(a&&!T)return{isBound:!1,offset:0};if(E){var R=A*(d[0]-f[0])+f[1];return B9(R,d[1],m[1],n,i)}else{var F=d[0]-f[0],N=rn(F)<=(i||0);return{isBound:N,offset:N?F:0}}}return{isBound:!1,offset:0}}function pK(t,e,r){return e.map(function(n){var i=exe(t,n),a=i.isBound,s=i.offset,o=i.isVerticalBound,c=i.isHorizontalBound,f=n.multiple,d=Pd({datas:r,distX:s[0],distY:s[1]}).map(function(m,b){return m*(f[b]?2/f[b]:0)});return{sign:f,isBound:a,isVerticalBound:o,isHorizontalBound:c,isSnap:!1,offset:d}})}function txe(t,e,r){var n,i=qO(t,e,[0,0],!1).map(function(b){return Wt(Wt({},b),{multiple:b.multiple.map(function(x){return rn(x)*2})})}),a=pK(t,i,r),s=tE(a,0),o=tE(a,1),c=0,f=0,d=s.isVerticalBound||o.isVerticalBound,m=s.isHorizontalBound||o.isHorizontalBound;return(d||m)&&(n=Zt(Tbe({datas:r,distX:-s.offset[0],distY:-o.offset[1]}),2),c=n[0],f=n[1]),{vertical:{isBound:d,offset:c},horizontal:{isBound:m,offset:f}}}function rxe(t,e){var r=[],n=t[0],i=t[1];return n&&i?r.push([[0,i*2],t,[-n,i]],[[n*2,0],t,[n,-i]]):n?(r.push([[n*2,0],[n,1],[n,-1]]),e&&r.push([[0,-1],[n,-1],[-n,-1]],[[0,1],[n,1],[-n,1]])):i?(r.push([[0,i*2],[1,i],[-1,i]]),e&&r.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):r.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),r}function qO(t,e,r,n){var i=t.state,a=i.allMatrix,s=i.is3d,o=xy(a,100,100,s?4:3),c=zl(o,[0,0]);return rxe(r,n).map(function(f){var d=Zt(f,3),m=d[0],b=d[1],x=d[2],E=[zl(o,b),zl(o,x)],T=Zbe(E),A=hK(c,E),R=A.vertical,F=A.horizontal,N=$O(c,E)<=0;return{multiple:m,centerSign:N,verticalSign:R,horizontalSign:F,lineConstants:T,line:[zl(e,b),zl(e,x)]}})}function z9(t,e,r,n){var i=n?t.map(function(a){return Ox(a,n)}):t;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var s=$O(r,a)<=0;return!dK(e,a,s)})}function nxe(t){var e=Zt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return rn(r[0]);if(!a)return rn(r[1]);var s=a/i;return rn((-s*r[0]+r[1])/Math.sqrt(Math.pow(s,2)+1))}function ixe(t){var e=Zt(t,2),r=e[0],n=e[1],i=n[0]-r[0],a=n[1]-r[1];if(!i)return[r[0],0];if(!a)return[0,r[1]];var s=a/i,o=-s*r[0]+r[1];return[-o/(s+1/s),o/(s*s+1)]}function axe(t,e,r,n,i){var a=t.props.innerBounds,s=i*Math.PI/180;if(!a)return[];var o=a.left,c=a.top,f=a.width,d=a.height,m=o-n[0],b=o+f-n[0],x=c-n[1],E=c+d-n[1],T=[[m,x],[b,x],[m,E],[b,E]],A=zl(r,[0,0]);if(!z9(r,T,A,0))return[];var R=[],F=T.map(function(N){return[Gf(N),al([0,0],N)]});return[[r[0],r[1]],[r[1],r[3]],[r[3],r[2]],[r[2],r[0]]].forEach(function(N){var O=al([0,0],ixe(N)),U=nxe(N);R.push.apply(R,yn([],Zt(F.filter(function(j){var H=Zt(j,1),W=H[0];return W&&U<=W}).map(function(j){var H=Zt(j,2),W=H[0],X=H[1],oe=Math.acos(W?U/W:0),ee=X+oe,G=X-oe;return[s+ee-O,s+G-O]}).reduce(function(j,H){return j.push.apply(j,yn([],Zt(H),!1)),j},[]).filter(function(j){return!z9(e,T,A,j)}).map(function(j){return Fi(j*180/Math.PI,bc)})),!1))}),R}function oxe(t){var e=t.props.innerBounds,r=s0();if(!e)return{boundMap:r,vertical:[],horizontal:[]};var n=t.getRect(),i=n.pos1,a=n.pos2,s=n.pos3,o=n.pos4,c=[i,a,s,o],f=zl(c,[0,0]),d=e.left,m=e.top,b=e.width,x=e.height,E=[[d,m],[d,m+x]],T=[[d,m],[d+b,m]],A=[[d+b,m],[d+b,m+x]],R=[[d,m+x],[d+b,m+x]],F=qO(t,c,[0,0],!1),N=[],O=[];return F.forEach(function(U){var j=U.line,H=U.lineConstants,W=hK(f,j),X=W.horizontal,oe=W.vertical,ee=dg(j,H,T,oe,1,!0),G=dg(j,H,R,oe,1,!0),ae=dg(j,H,E,X,1,!0),se=dg(j,H,A,X,1,!0);ee.isBound&&!r.top&&(N.push(m),r.top=!0),G.isBound&&!r.bottom&&(N.push(m+x),r.bottom=!0),ae.isBound&&!r.left&&(O.push(d),r.left=!0),se.isBound&&!r.right&&(O.push(d+b),r.right=!0)}),{boundMap:r,horizontal:N,vertical:O}}function sxe(t,e,r,n){var i=e[0]-t[0],a=e[1]-t[1];if(rn(i)<Tl&&(i=0),rn(a)<Tl&&(a=0),!i)return n?[0,0]:[0,r];if(!a)return n?[r,0]:[0,0];var s=a/i,o=t[1]-s*t[0];if(n){var c=s*(e[0]+r)+o;return[r,c-e[1]]}else{var f=(e[1]+r-o)/s;return[f-e[0],r]}}function bk(t,e,r,n,i){var a=sxe(t,e,r,n);if(!a)return{isOutside:!1,offset:[0,0]};var s=hp(t,e),o=hp(a,t),c=hp(a,e),f=o>s||c>s,d=Zt(Pd({datas:i,distX:a[0],distY:a[1]}),2),m=d[0],b=d[1];return{offset:[m,b],isOutside:f}}function rE(t,e){return t.isBound?t.offset:e.isSnap?_k(e).offset:0}function lxe(t,e,r,n,i){var a=Zt(e,2),s=a[0],o=a[1],c=Zt(r,2),f=c[0],d=c[1],m=Zt(n,2),b=m[0],x=m[1],E=Zt(i,2),T=E[0],A=E[1],R=-T,F=-A;if(t&&s&&o){R=0,F=0;var N=[];if(f&&d?N.push([0,A],[T,0]):f?N.push([T,0]):d?N.push([0,A]):b&&x?N.push([0,A],[T,0]):b?N.push([T,0]):x&&N.push([0,A]),N.length){N.sort(function(H,W){return Gf(_i([s,o],H))-Gf(_i([s,o],W))});var O=N[0];if(O[0]&&rn(s)>Tl)R=-O[0],F=o*rn(s+R)/rn(s)-o;else if(O[1]&&rn(o)>Tl){var U=o;F=-O[1],R=s*rn(o+F)/rn(U)-s}if(t&&d&&f)if(rn(R)>Tl&&rn(R)<rn(T)){var j=rn(T)/rn(R);R*=j,F*=j}else if(rn(F)>Tl&&rn(F)<rn(A)){var j=rn(A)/rn(F);R*=j,F*=j}else R=$0(-T,R),F=$0(-A,F)}}else R=s||f?-T:0,F=o||d?-A:0;return[R,F]}function uxe(t,e,r,n,i,a){if(!y_(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var s=WO(a.absolutePoses,[e,r]),o=Ff(s),c=o.left,f=o.right,d=o.top,m=o.bottom,b={horizontal:s.map(function(se){return se[1]}),vertical:s.map(function(se){return se[0]})},x=UO(t.props.snapDirections),E=VO(x,{left:c,right:f,top:d,bottom:m,center:(c+f)/2,middle:(d+m)/2}),T=s3(t,i,E,b),A=T.vertical,R=T.horizontal,F=txe(t,s,a),N=F.vertical,O=F.horizontal,U=A.isSnap,j=R.isSnap,H=A.isBound||N.isBound,W=R.isBound||O.isBound,X=$0(A.offset,N.offset),oe=$0(R.offset,O.offset),ee=Zt(lxe(n,[e,r],[H,W],[U,j],[X,oe]),2),G=ee[0],ae=ee[1];return[{isBound:H,isSnap:U,offset:G},{isBound:W,isSnap:j,offset:ae}]}function s3(t,e,r,n){n===void 0&&(n=r);var i=jO(a3(t),n.vertical,n.horizontal),a=i.horizontal,s=i.vertical,o=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:o3(t,r.vertical,r.horizontal,void 0,void 0,void 0,void 0),c=o.horizontal,f=o.vertical,d=rE(a[0],c),m=rE(s[0],f),b=rn(d),x=rn(m);return{horizontal:{isBound:a[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:d,dist:b,bounds:a,snap:c},vertical:{isBound:s[0].isBound,isSnap:f.isSnap,snapIndex:f.index,offset:m,dist:x,bounds:s,snap:f}}}function j9(t,e,r,n,i,a,s){s===void 0&&(s=[1,1]);var o=jO(e,r,n),c=o.horizontal,f=o.vertical,d=cK(t,r,n,[],[],i,a,s),m=d.horizontal,b=d.vertical,x=rE(c[0],m),E=rE(f[0],b),T=rn(x),A=rn(E);return{horizontal:{isBound:c[0].isBound,isSnap:m.isSnap,snapIndex:m.index,offset:x,dist:T,bounds:c,snap:m},vertical:{isBound:f[0].isBound,isSnap:b.isSnap,snapIndex:b.index,offset:E,dist:A,bounds:f,snap:b}}}function cxe(t,e,r,n){var i=al(t,e)/Math.PI*180,a=r.vertical,s=a.isBound,o=a.isSnap,c=a.dist,f=r.horizontal,d=f.isBound,m=f.isSnap,b=f.dist,x=i%180,E=x<3||x>177,T=x>87&&x<93;return b<c&&(s||o&&!T&&(!n||!E))?"vertical":d||m&&!E&&(!n||!T)?"horizontal":""}function fxe(t,e,r,n,i,a){return r.map(function(s){var o=Zt(s,2),c=o[0],f=o[1],d=zl(e,c),m=zl(e,f),b=n?hxe(t,d,m,i):s3(t,i,{vertical:[m[0]],horizontal:[m[1]]}),x=b.horizontal,E=x.offset,T=x.isBound,A=x.isSnap,R=b.vertical,F=R.offset,N=R.isBound,O=R.isSnap,U=_i(f,c);if(!F&&!E)return{isBound:N||T,isSnap:O||A,sign:U,offset:[0,0]};var j=cxe(d,m,b,n);if(!j)return{sign:U,isBound:!1,isSnap:!1,offset:[0,0]};var H=j==="vertical",W=[0,0];return!n&&rn(f[0])===1&&rn(f[1])===1&&c[0]!==f[0]&&c[1]!==f[1]?W=Pd({datas:a,distX:-F,distY:-E}):W=bk(d,m,-(H?F:E),H,a).offset,W=W.map(function(X,oe){return X*(U[oe]?2/U[oe]:0)}),{sign:U,isBound:H?N:T,isSnap:H?O:A,offset:W}})}function U9(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function hxe(t,e,r,n){var i=$be(t,e,r),a=i.horizontal,s=i.vertical,o=n?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:Kbe(t,e,r),c=o.horizontal,f=o.vertical,d=U9(a,c),m=U9(s,f),b=rn(d),x=rn(m);return{horizontal:{isBound:a.isBound,isSnap:c.isSnap,offset:d,dist:b},vertical:{isBound:s.isBound,isSnap:f.isSnap,offset:m,dist:x}}}function dxe(t,e,r,n,i){var a=[-r[0],-r[1]],s=t.state,o=s.width,c=s.height,f=t.props.bounds,d=1/0,m=1/0;if(f){var b=[[r[0],-r[1]],[-r[0],r[1]]],x=f.left,E=x===void 0?-1/0:x,T=f.top,A=T===void 0?-1/0:T,R=f.right,F=R===void 0?1/0:R,N=f.bottom,O=N===void 0?1/0:N;b.forEach(function(U){var j=U[0]!==a[0],H=U[1]!==a[1],W=zl(e,U),X=al(n,W)*360/Math.PI;if(H){var oe=W.slice();(rn(X-360)<2||rn(X-180)<2)&&(oe[1]=n[1]);var ee=bk(n,oe,(n[1]<W[1]?O:A)-W[1],!1,i),G=Zt(ee.offset,2),ae=G[1],se=ee.isOutside;isNaN(ae)||(m=c+(se?1:-1)*rn(ae))}if(j){var oe=W.slice();(rn(X-90)<2||rn(X-270)<2)&&(oe[0]=n[0]);var fe=bk(n,oe,(n[0]<W[0]?F:E)-W[0],!0,i),pe=Zt(fe.offset,1),De=pe[0],ye=fe.isOutside;isNaN(De)||(d=o+(ye?1:-1)*rn(De))}})}return{maxWidth:d,maxHeight:m}}var gc={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var r=t.props,n=r.hideThrottleDragRotateLine,i=r.throttleDragRotate,a=r.zoom,s=t.getState(),o=s.dragInfo,c=s.beforeOrigin;if(n||!i||!o)return[];var f=o.dist;if(!f[0]&&!f[1])return[];var d=Gf(f),m=al(f,[0,0]);return[e.createElement("div",{className:yi("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(d,"px"),transform:"translate(".concat(c[0],"px, ").concat(c[1],"px) rotate(").concat(m,"rad) scaleY(").concat(a,")")}})]},dragStart:function(t,e){var r=e.datas,n=e.parentEvent,i=e.parentGesto,a=t.state,s=a.gestos,o=a.style;if(s.draggable)return!1;s.draggable=i||t.targetGesto,r.datas={},r.left=parseFloat(o.left||"")||0,r.top=parseFloat(o.top||"")||0,r.bottom=parseFloat(o.bottom||"")||0,r.right=parseFloat(o.right||"")||0,r.startValue=[0,0],by(t,e),i3(t,e,"translate"),Rxe(t,r),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,r.deltaOffset=[0,0];var c=Ki(t,e,Wt({set:function(d){r.startValue=d}},n3(t,e))),f=n||Wn(t,"onDragStart",c);return f!==!1?(r.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(s.draggable=null,r.isPinch=!1),r.isDrag?c:!1},drag:function(t,e){if(e){t3(t,e,"translate");var r=e.datas,n=e.parentEvent,i=e.parentFlag,a=e.isPinch,s=e.deltaOffset,o=e.useSnap,c=e.isRequest,f=e.isGroup,d=e.parentThrottleDrag,m=e.distX,b=e.distY,x=r.isDrag,E=r.prevDist,T=r.prevBeforeDist,A=r.startValue;if(x){s&&(m+=s[0],b+=s[1]);var R=t.props,F=R.parentMoveable,N=f?0:R.throttleDrag||d||0,O=n?0:R.throttleDragRotate||0,U=0,j=!1,H=!1,W=!1,X=!1;if(!n&&O>0&&(m||b)){var oe=R.startDragRotate||0,ee=Fi(oe+al([0,0],[m,b])*180/Math.PI,O)-oe,G=b*Math.abs(Math.cos((ee-90)/180*Math.PI)),ae=m*Math.abs(Math.cos(ee/180*Math.PI)),se=Gf([ae,G]);U=ee*Math.PI/180,m=se*Math.cos(U),b=se*Math.sin(U)}if(!a&&!n&&!i){var fe=Zt(uxe(t,m,b,O,!o&&c||s,r),2),pe=fe[0],De=fe[1];j=pe.isSnap,H=pe.isBound,W=De.isSnap,X=De.isBound;var ye=pe.offset,we=De.offset;m+=ye,b+=we}var Te=Ra(YZ({datas:r,distX:m,distY:b}),A),Re=Ra(Ebe({datas:r,distX:m,distY:b}),A);C9(Re,bc),C9(Te,bc),O||(!j&&!H&&(Re[0]=Fi(Re[0],N),Te[0]=Fi(Te[0],N)),!W&&!X&&(Re[1]=Fi(Re[1],N),Te[1]=Fi(Te[1],N)));var de=_i(Te,A),Ee=_i(Re,A),xe=_i(Ee,E),Ne=_i(de,T);r.prevDist=Ee,r.prevBeforeDist=de,r.passDelta=xe,r.passDist=Ee;var Fe=r.left+de[0],Xe=r.top+de[1],Be=r.right-de[0],ot=r.bottom-de[1],Ke=r3(r,"translate(".concat(Re[0],"px, ").concat(Re[1],"px)"),"translate(".concat(Ee[0],"px, ").concat(Ee[1],"px)"));if(BO(e,Ke),t.state.dragInfo.dist=n?[0,0]:Ee,!(!n&&!F&&xe.every(function($e){return!$e})&&Ne.some(function($e){return!$e}))){var it=t.state,Me=it.width,zt=it.height,st=Ki(t,e,Wt({transform:Ke,dist:Ee,delta:xe,translate:Re,beforeDist:de,beforeDelta:Ne,beforeTranslate:Te,left:Fe,top:Xe,right:Be,bottom:ot,width:Me,height:zt,isPinch:a},yc({transform:Ke},e)));return!n&&Wn(t,"onDrag",st),st}}}},dragAfter:function(t,e){var r=e.datas,n=r.deltaOffset;return n[0]||n[1]?(r.deltaOffset=[0,0],this.drag(t,Wt(Wt({},e),{deltaOffset:n}))):!1},dragEnd:function(t,e){var r=e.parentEvent,n=e.datas;if(t.state.dragInfo=null,!!n.isDrag){n.isDrag=!1;var i=hf(t,e,{});return!r&&Wn(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=this.dragStart(t,e);if(!o)return!1;var c=KA(t,this,"dragStart",[a||0,s||0],e,!1,"draggable"),f=c.childEvents,d=c.eventParams,m=Wt(Wt({},o),{targets:t.props.targets,events:d}),b=Wn(t,"onDragGroupStart",m);i.isDrag=b!==!1;var x=(n=(r=f[0])===null||r===void 0?void 0:r.datas.startValue)!==null&&n!==void 0?n:[0,0];return i.throttleOffset=[x[0]%1,x[1]%1],i.isDrag?o:!1},dragGroup:function(t,e){var r=e.datas;if(r.isDrag){var n=this.drag(t,Wt(Wt({},e),{parentThrottleDrag:t.props.throttleDrag})),i=e.datas.passDelta,a=KA(t,this,"drag",i,e,!1,"draggable").eventParams;if(n){var s=Wt({targets:t.props.targets,events:a},n);return Wn(t,"onDragGroup",s),s}}},dragGroupEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isDrag){this.dragEnd(t,e);var i=KA(t,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return Wn(t,"onDragGroupEnd",hf(t,e,{targets:t.props.targets,events:i})),r}},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=!1;return{isControl:!1,requestStart:function(s){return a=s.useSnap,{datas:e,useSnap:a}},request:function(s){return"x"in s?n=s.x-r.left:"deltaX"in s&&(n+=s.deltaX),"y"in s?i=s.y-r.top:"deltaY"in s&&(i+=s.deltaY),{datas:e,distX:n,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function gK(t,e){var r=zl(t,e),n=[0,0];return{fixedPosition:r,fixedDirection:e,fixedOffset:n}}function pxe(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=[i/2*(1+e[0]),a/2*(1+e[1])],c=xs(r,o,s),f=[0,0];return{fixedPosition:c,fixedDirection:e,fixedOffset:f}}function mK(t,e){var r=t.allMatrix,n=t.is3d,i=t.width,a=t.height,s=n?4:3,o=Rbe(e,i,a),c=xs(r,e,s),f=[i?0:e[0],a?0:e[1]];return{fixedPosition:c,fixedDirection:o,fixedOffset:f}}var V9=ZO("resizable"),xk={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:nK("resizable"),dragControlCondition:V9,viewClassName:YO("resizable"),dragControlStart:function(t,e){var r,n=e.inputEvent,i=e.isPinch,a=e.isGroup,s=e.parentDirection,o=e.parentGesto,c=e.datas,f=e.parentFixedDirection,d=e.parentEvent,m=PK(s,i,n,c),b=t.state,x=b.target,E=b.width,T=b.height,A=b.gestos;if(!m||!x||A.resizable)return!1;A.resizable=o||t.controlGesto,!i&&by(t,e),c.datas={},c.direction=m,c.startOffsetWidth=E,c.startOffsetHeight=T,c.prevWidth=0,c.prevHeight=0,c.minSize=[0,0],c.startWidth=b.inlineCSSWidth||b.cssWidth,c.startHeight=b.inlineCSSHeight||b.cssHeight,c.maxSize=[1/0,1/0],a||(c.minSize=[b.minOffsetWidth,b.minOffsetHeight],c.maxSize=[b.maxOffsetWidth,b.maxOffsetHeight]);var R=t.props.transformOrigin||"% %";c.transformOrigin=Ap(R)?R.split(" "):R,c.startOffsetMatrix=b.offsetMatrix,c.startTransformOrigin=b.transformOrigin,c.isWidth=(r=e?.parentIsWidth)!==null&&r!==void 0?r:!m[0]&&!m[1]||m[0]||!m[1];function F(X){c.ratio=X&&isFinite(X)?X:0}c.startPositions=Wf(t.state);function N(X){var oe=gK(c.startPositions,X);c.fixedDirection=oe.fixedDirection,c.fixedPosition=oe.fixedPosition,c.fixedOffset=oe.fixedOffset}function O(X){var oe=mK(t.state,X);c.fixedDirection=oe.fixedDirection,c.fixedPosition=oe.fixedPosition,c.fixedOffset=oe.fixedOffset}function U(X){c.minSize=[wo("".concat(X[0]),0)||0,wo("".concat(X[1]),0)||0]}function j(X){var oe=[X[0]||1/0,X[1]||1/0];(!jb(oe[0])||isFinite(oe[0]))&&(oe[0]=wo("".concat(oe[0]),0)||1/0),(!jb(oe[1])||isFinite(oe[1]))&&(oe[1]=wo("".concat(oe[1]),0)||1/0),c.maxSize=oe}F(E/T),N(f||[-m[0],-m[1]]),c.setFixedDirection=N,c.setFixedPosition=O,c.setMin=U,c.setMax=j;var H=Ki(t,e,{direction:m,startRatio:c.ratio,set:function(X){var oe=Zt(X,2),ee=oe[0],G=oe[1];c.startWidth=ee,c.startHeight=G},setMin:U,setMax:j,setRatio:F,setFixedDirection:N,setFixedPosition:O,setOrigin:function(X){c.transformOrigin=X},dragStart:gc.dragStart(t,new U0().dragStart([0,0],e))}),W=d||Wn(t,"onResizeStart",H);return c.startFixedDirection=c.fixedDirection,c.startFixedPosition=c.fixedPosition,W!==!1&&(c.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:m}),c.isResize?H:!1},dragControl:function(t,e){var r,n=e.datas,i=e.parentFlag,a=e.isPinch,s=e.parentKeepRatio,o=e.dragClient,c=e.parentDist,f=e.useSnap,d=e.isRequest,m=e.isGroup,b=e.parentEvent,x=e.resolveMatrix,E=n.isResize,T=n.transformOrigin,A=n.startWidth,R=n.startHeight,F=n.prevWidth,N=n.prevHeight,O=n.minSize,U=n.maxSize,j=n.ratio,H=n.startOffsetWidth,W=n.startOffsetHeight,X=n.isWidth;if(!E)return;if(x){var oe=t.state.is3d,ee=n.startOffsetMatrix,G=n.startTransformOrigin,ae=oe?4:3,se=Vb(QS(e)),fe=Math.sqrt(se.length);ae!==fe&&(se=Ah(se,fe,ae));var pe=zx(ee,se,G,ae),De=xy(pe,H,W,ae);n.startPositions=De,n.nextTargetMatrix=se,n.nextAllMatrix=pe}var ye=ey(t.props,"resizable"),we=ye.resizeFormat,Te=ye.throttleResize,Re=Te===void 0?i?0:1:Te,de=ye.parentMoveable,Ee=ye.keepRatioFinally,xe=n.direction,Ne=xe,Fe=0,Xe=0;!xe[0]&&!xe[1]&&(Ne=[1,1]);var Be=j&&(s??ye.keepRatio)||!1;function ot(){var Tr=n.fixedDirection,Qt=LK(Ne,Be,n,e);Fe=Qt.distWidth,Xe=Qt.distHeight;var at=Ne[0]-Tr[0]||Be?Math.max(H+Fe,bc):H,Pe=Ne[1]-Tr[1]||Be?Math.max(W+Xe,bc):W;return Be&&H&&W&&(X?Pe=at/j:at=Pe*j),[at,Pe]}var Ke=Zt(ot(),2),it=Ke[0],Me=Ke[1];b||(n.setFixedDirection(n.fixedDirection),Wn(t,"onBeforeResize",Ki(t,e,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection:function(Tr){var Qt;return n.setFixedDirection(Tr),Qt=Zt(ot(),2),it=Qt[0],Me=Qt[1],[it,Me]},setFixedPosition:function(Tr){var Qt;return n.setFixedPosition(Tr),Qt=Zt(ot(),2),it=Qt[0],Me=Qt[1],[it,Me]},boundingWidth:it,boundingHeight:Me,setSize:function(Tr){var Qt;Qt=Zt(Tr,2),it=Qt[0],Me=Qt[1]}},!0)));var zt=o;o||(!i&&a?zt=Nbe(t,[0,0]):zt=n.fixedPosition);var st=[0,0];a||(st=Mxe(t,it,Me,xe,zt,!f&&d,n)),c&&(!c[0]&&(st[0]=0),!c[1]&&(st[1]=0));function $e(){var Tr;we&&(Tr=Zt(we([it,Me]),2),it=Tr[0],Me=Tr[1]),it=Fi(it,Re),Me=Fi(Me,Re)}if(Be){Ne[0]&&Ne[1]&&st[0]&&st[1]&&(rn(st[0])>rn(st[1])?st[1]=0:st[0]=0);var Jt=!st[0]&&!st[1];Jt&&$e(),Ne[0]&&!Ne[1]||st[0]&&!st[1]||Jt&&X?(it+=st[0],Me=it/j):(!Ne[0]&&Ne[1]||!st[0]&&st[1]||Jt&&!X)&&(Me+=st[1],it=Me*j)}else it+=st[0],Me+=st[1],it=Math.max(0,it),Me=Math.max(0,Me);r=Zt(PZ([it,Me],O,U,Be?j:!1),2),it=r[0],Me=r[1],$e(),Be&&(m||Ee)&&(X?Me=it/j:it=Me*j),Fe=it-H,Xe=Me-W;var Ht=[Fe-F,Xe-N];n.prevWidth=Fe,n.prevHeight=Xe;var pr=Lbe(t,it,Me,zt,T,n);if(!(!de&&Ht.every(function(Tr){return!Tr})&&pr.every(function(Tr){return!Tr}))){var _t=gc.drag(t,Bx(e,t.state,pr,!!a,!1,"draggable")),vr=_t.transform,br=A+Fe,lr=R+Xe,Cr=Ki(t,e,Wt({width:br,height:lr,offsetWidth:Math.round(it),offsetHeight:Math.round(Me),startRatio:j,boundingWidth:it,boundingHeight:Me,direction:xe,dist:[Fe,Xe],delta:Ht,isPinch:!!a,drag:_t},kK({style:{width:"".concat(br,"px"),height:"".concat(lr,"px")},transform:vr},_t,e)));return!b&&Wn(t,"onResize",Cr),Cr}},dragControlAfter:function(t,e){var r=e.datas,n=r.isResize,i=r.startOffsetWidth,a=r.startOffsetHeight,s=r.prevWidth,o=r.prevHeight;if(!(!n||t.props.checkResizableError===!1)){var c=t.state,f=c.width,d=c.height,m=f-(i+s),b=d-(a+o),x=rn(m)>3,E=rn(b)>3;if(x&&(r.startWidth+=m,r.startOffsetWidth+=m,r.prevWidth+=m),E&&(r.startHeight+=b,r.startOffsetHeight+=b,r.prevHeight+=b),x||E)return this.dragControl(t,e)}},dragControlEnd:function(t,e){var r=e.datas,n=e.parentEvent;if(r.isResize){r.isResize=!1;var i=hf(t,e,{});return!n&&Wn(t,"onResizeEnd",i),i}},dragGroupControlCondition:V9,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,Wt(Wt({},e),{isGroup:!0}));if(!n)return!1;var i=Eh(t,"resizable",e),a=r.startOffsetWidth,s=r.startOffsetHeight;function o(){var x=r.minSize;i.forEach(function(E){var T=E.datas,A=T.minSize,R=T.startOffsetWidth,F=T.startOffsetHeight,N=a*(R?A[0]/R:0),O=s*(F?A[1]/F:0);x[0]=Math.max(x[0],N),x[1]=Math.max(x[1],O)})}function c(){var x=r.maxSize;i.forEach(function(E){var T=E.datas,A=T.maxSize,R=T.startOffsetWidth,F=T.startOffsetHeight,N=a*(R?A[0]/R:0),O=s*(F?A[1]/F:0);x[0]=Math.min(x[0],N),x[1]=Math.min(x[1],O)})}var f=dp(t,this,"dragControlStart",e,function(x,E){return eE(t,x,r,E)});o(),c();var d=function(x){n.setFixedDirection(x),f.forEach(function(E,T){E.setFixedDirection(x),eE(t,E.moveable,r,i[T])})};r.setFixedDirection=d;var m=Wt(Wt({},n),{targets:t.props.targets,events:f.map(function(x){return Wt(Wt({},x),{setMin:function(E){x.setMin(E),o()},setMax:function(E){x.setMax(E),c()}})}),setFixedDirection:d,setMin:function(x){n.setMin(x),o()},setMax:function(x){n.setMax(x),c()}}),b=Wn(t,"onResizeGroupStart",m);return r.isResize=b!==!1,r.isResize?n:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isResize){var n=ey(t.props,"resizable");u3(t,"onBeforeResize",function(x){Wn(t,"onBeforeResizeGroup",Ki(t,e,Wt(Wt({},x),{targets:n.targets}),!0))});var i=this.dragControl(t,Wt(Wt({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,s=i.boundingHeight,o=i.dist,c=n.keepRatio,f=[a/(a-o[0]),s/(s-o[1])],d=r.fixedPosition,m=dp(t,this,"dragControl",e,function(x,E){var T=Zt(rc(Lx(t.rotation/180*Math.PI,3),[E.datas.originalX*f[0],E.datas.originalY*f[1],1],3),2),A=T[0],R=T[1];return Wt(Wt({},E),{parentDist:null,parentScale:f,dragClient:Ra(d,[A,R]),parentKeepRatio:c})}),b=Wt({targets:n.targets,events:m},i);return Wn(t,"onResizeGroup",b),b}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isResize){this.dragControlEnd(t,e);var i=dp(t,this,"dragControlEnd",e),a=hf(t,e,{targets:t.props.targets,events:i});return Wn(t,"onResizeGroupEnd",a),r}},request:function(t){var e={},r=0,n=0,i=!1,a=t.getRect();return{isControl:!0,requestStart:function(s){var o;return i=s.useSnap,{datas:e,parentDirection:s.direction||[1,1],parentIsWidth:(o=s?.horizontal)!==null&&o!==void 0?o:!0,useSnap:i}},request:function(s){return"offsetWidth"in s?r=s.offsetWidth-a.offsetWidth:"deltaWidth"in s&&(r+=s.deltaWidth),"offsetHeight"in s?n=s.offsetHeight-a.offsetHeight:"deltaHeight"in s&&(n+=s.deltaHeight),{datas:e,parentDist:[r,n],parentKeepRatio:s.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.resizable=null}};function JA(t,e,r,n,i){var a=t.props.groupable,s=t.state,o=s.is3d?4:3,c=e.origin,f=xs(t.state.rootMatrix,_i([c[0],c[1]],a?[0,0]:[s.left,s.top]),o),d=Ra([i.left,i.top],f);e.startAbsoluteOrigin=d,e.prevDeg=al(d,[r,n])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=hp(d,[r,n])}function hS(t,e,r){var n=r.defaultDeg,i=r.prevDeg,a=i%360,s=Math.floor(i/360);a<0&&(a+=360),a>t&&a>270&&t<90?++s:a<t&&a<90&&t>270&&--s;var o=e*(s*360+t-n);return r.prevDeg=n+o,o}function QA(t,e,r,n){return hS(al(n.startAbsoluteOrigin,[t,e])/Math.PI*180,r,n)}function e5(t,e,r,n,i,a){var s=t.props.throttleRotate,o=s===void 0?0:s,c=r.prevSnapDeg,f=0,d=!1;if(a){var m=Pxe(t,e,n,i+n);d=m.isSnap,f=i+m.dist}d||(f=Fi(i+n,o));var b=f-i;return r.prevSnapDeg=b,[b-c,b,f]}function yK(t,e,r){var n=Zt(e,4),i=n[0],a=n[1],s=n[2],o=n[3];if(t==="none")return[];if(su(t))return t.map(function(A){return yK(A,[i,a,s,o],r)[0]});var c=Zt((t||"top").split("-"),2),f=c[0],d=c[1],m=[i,a];f==="left"?m=[s,i]:f==="right"?m=[a,o]:f==="bottom"&&(m=[o,s]);var b=[(m[0][0]+m[1][0])/2,(m[0][1]+m[1][1])/2],x=AK(m,r);if(d){var E=d==="top"||d==="left",T=f==="bottom"||f==="left";b=m[E&&!T||!E&&T?0:1]}return[[b,x]]}function wk(t,e){if(e.isRequest)return e.requestAble==="rotatable";var r=e.inputEvent.target;if(Bl(r,yi("rotation-control"))||t.props.rotateAroundControls&&Bl(r,yi("around-control"))||Bl(r,yi("control"))&&Bl(r,yi("rotatable")))return!0;var n=t.props.rotationTarget;return n?KO(n,!0).some(function(i){return i?r===i||r.contains(i):!1}):!1}var gxe=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,mxe={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[gxe],viewClassName:function(t){return t.isDragging("rotatable")?yi("view-rotation-dragging"):""},render:function(t,e){var r=ey(t.props,"rotatable"),n=r.rotatable,i=r.rotationPosition,a=r.zoom,s=r.renderDirections,o=r.rotateAroundControls,c=r.resolveAblesWithRotatable,f=t.getState(),d=f.renderPoses,m=f.direction;if(!n)return null;var b=yK(i,d,m),x=[];if(b.forEach(function(R,F){var N=Zt(R,2),O=N[0],U=N[1];x.push(e.createElement("div",{key:"rotation".concat(F),className:yi("rotation"),style:{transform:"translate(-50%) translate(".concat(O[0],"px, ").concat(O[1],"px) rotate(").concat(U,"rad)")}},e.createElement("div",{className:yi("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:yi("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),s){var E=p_(c||{}),T={};E.forEach(function(R){c[R].forEach(function(F){T[F]=R})});var A=[];su(s)&&(A=s.map(function(R){var F=T[R];return{data:F?{resolve:F}:{},classNames:F?["move"]:[],dir:R}})),x.push.apply(x,yn([],Zt(eK(t,"rotatable",A,e)),!1))}return o&&x.push.apply(x,yn([],Zt(aK(t,e)),!1)),x},dragControlCondition:wk,dragControlStart:function(t,e){var r,n,i=e.datas,a=e.clientX,s=e.clientY,o=e.parentRotate,c=e.parentFlag,f=e.isPinch,d=e.isRequest,m=t.state,b=m.target,x=m.left,E=m.top,T=m.direction,A=m.beforeDirection,R=m.targetTransform,F=m.moveableClientRect,N=m.offsetMatrix,O=m.targetMatrix,U=m.allMatrix,j=m.width,H=m.height;if(!d&&!b)return!1;var W=t.getRect();i.rect=W,i.transform=R,i.left=x,i.top=E;var X=function(Ne){var Fe=mK(t.state,Ne);i.fixedDirection=Fe.fixedDirection,i.fixedOffset=Fe.fixedOffset,i.fixedPosition=Fe.fixedPosition,Re&&Re.setFixedPosition(Ne)},oe=function(Ne){var Fe=pxe(t.state,Ne);i.fixedDirection=Fe.fixedDirection,i.fixedOffset=Fe.fixedOffset,i.fixedPosition=Fe.fixedPosition,Re&&Re.setFixedDirection(Ne)},ee=a,G=s;if(d||f||c){var ae=o||0;i.beforeInfo={origin:W.beforeOrigin,prevDeg:ae,defaultDeg:ae,prevSnapDeg:0,startDist:0},i.afterInfo=Wt(Wt({},i.beforeInfo),{origin:W.origin}),i.absoluteInfo=Wt(Wt({},i.beforeInfo),{origin:W.origin,startValue:ae})}else{var se=(n=e.inputEvent)===null||n===void 0?void 0:n.target;if(se){var fe=se.getAttribute("data-direction")||"",pe=xbe[fe];if(pe){i.isControl=!0,i.isAroundControl=Bl(se,yi("around-control")),i.controlDirection=pe;var De=se.getAttribute("data-resolve");De&&(i.resolveAble=De);var ye=Hxe(m.rootMatrix,m.renderPoses,F);r=Zt(zl(ye,pe),2),ee=r[0],G=r[1]}}i.beforeInfo={origin:W.beforeOrigin},i.afterInfo={origin:W.origin},i.absoluteInfo={origin:W.origin,startValue:W.rotation};var we=X;X=function(Ne){var Fe=m.is3d?4:3,Xe=Zt(Ra(OZ(O,Fe),Ne),2),Be=Xe[0],ot=Xe[1],Ke=rc(N,Km([Be,ot],Fe)),it=rc(U,Km([Ne[0],Ne[1]],Fe));we(Ne);var Me=m.posDelta;i.beforeInfo.origin=_i(Ke,Me),i.afterInfo.origin=_i(it,Me),i.absoluteInfo.origin=_i(it,Me),JA(t,i.beforeInfo,ee,G,F),JA(t,i.afterInfo,ee,G,F),JA(t,i.absoluteInfo,ee,G,F)},oe=function(Ne){var Fe=zl([[0,0],[j,0],[0,H],[j,H]],Ne);X(Fe)}}i.startClientX=ee,i.startClientY=G,i.direction=T,i.beforeDirection=A,i.startValue=0,i.datas={},i3(t,e,"rotate");var Te=!1,Re=!1;if(i.isControl&&i.resolveAble){var de=i.resolveAble;de==="resizable"&&(Re=xk.dragControlStart(t,Wt(Wt({},new U0("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}Re||(Te=gc.dragStart(t,new U0().dragStart([0,0],e))),X(Gxe(t));var Ee=Ki(t,e,Wt(Wt({set:function(Ne){i.startValue=Ne*Math.PI/180},setFixedDirection:oe,setFixedPosition:X},n3(t,e)),{dragStart:Te,resizeStart:Re})),xe=Wn(t,"onRotateStart",Ee);return i.isRotate=xe!==!1,m.snapRenderInfo={request:e.isRequest},i.isRotate?Ee:!1},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.clientDistX,o=e.clientDistY,c=e.parentRotate,f=e.parentFlag,d=e.isPinch,m=e.groupDelta,b=e.resolveMatrix,x=a.beforeDirection,E=a.beforeInfo,T=a.afterInfo,A=a.absoluteInfo,R=a.isRotate,F=a.startValue,N=a.rect,O=a.startClientX,U=a.startClientY;if(R){t3(t,e,"rotate");var j=Sbe(e),H=x*j,W=t.props.parentMoveable,X=0,oe,ee,G=0,ae,se,fe=0,pe,De,ye=180/Math.PI*F,we=A.startValue,Te=!1,Re=O+s,de=U+o;if(!f&&"parentDist"in e){var Ee=e.parentDist;oe=Ee,ae=Ee,pe=Ee}else d||f?(oe=hS(c,x,E),ae=hS(c,H,T),pe=hS(c,H,A)):(oe=QA(Re,de,x,E),ae=QA(Re,de,H,T),pe=QA(Re,de,H,A),Te=!0);if(ee=ye+oe,se=ye+ae,De=we+pe,Wn(t,"onBeforeRotate",Ki(t,e,{beforeRotation:ee,rotation:se,absoluteRotation:De,setRotation:function(zt){ae=zt-ye,oe=ae,pe=ae}},!0)),r=Zt(e5(t,N,E,oe,ye,Te),3),X=r[0],oe=r[1],ee=r[2],n=Zt(e5(t,N,T,ae,ye,Te),3),G=n[0],ae=n[1],se=n[2],i=Zt(e5(t,N,A,pe,we,Te),3),fe=i[0],pe=i[1],De=i[2],!(!fe&&!G&&!X&&!W&&!b)){var xe=r3(a,"rotate(".concat(se,"deg)"),"rotate(".concat(ae,"deg)"));b&&(a.fixedPosition=zO(t,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var Ne=Obe(t,ae,a),Fe=_i(Ra(m||[0,0],Ne),a.prevInverseDist||[0,0]);a.prevInverseDist=Ne,a.requestValue=null;var Xe=KZ(t,xe,Fe,d,e),Be=Xe,ot=hp([Re,de],A.startAbsoluteOrigin)-A.startDist,Ke=void 0;if(a.resolveAble==="resizable"){var it=xk.dragControl(t,Wt(Wt({},Bx(e,t.state,[e.deltaX,e.deltaY],!!d,!1,"resizable")),{resolveMatrix:!0,parentDistance:ot}));it&&(Ke=it,Be=kK(Be,it,e))}var Me=Ki(t,e,Wt(Wt({delta:G,dist:ae,rotate:se,rotation:se,beforeDist:oe,beforeDelta:X,beforeRotate:ee,beforeRotation:ee,absoluteDist:pe,absoluteDelta:fe,absoluteRotate:De,absoluteRotation:De,isPinch:!!d,resize:Ke},Xe),Be));return Wn(t,"onRotate",Me),Me}}},dragControlEnd:function(t,e){var r=e.datas;if(r.isRotate){r.isRotate=!1;var n=hf(t,e,{});return Wn(t,"onRotateEnd",n),n}},dragGroupControlCondition:wk,dragGroupControlStart:function(t,e){var r=e.datas,n=t.state,i=n.left,a=n.top,s=n.beforeOrigin,o=this.dragControlStart(t,e);if(!o)return!1;o.set(r.beforeDirection*t.rotation);var c=dp(t,this,"dragControlStart",e,function(m,b){var x=m.state,E=x.left,T=x.top,A=x.beforeOrigin,R=Ra(_i([E,T],[i,a]),_i(A,s));return b.datas.startGroupClient=R,b.datas.groupClient=R,Wt(Wt({},b),{parentRotate:0})}),f=Wt(Wt({},o),{targets:t.props.targets,events:c}),d=Wn(t,"onRotateGroupStart",f);return r.isRotate=d!==!1,r.isRotate?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isRotate){u3(t,"onBeforeRotate",function(f){Wn(t,"onBeforeRotateGroup",Ki(t,e,Wt(Wt({},f),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=r.beforeDirection,a=n.beforeDist,s=a/180*Math.PI,o=dp(t,this,"dragControl",e,function(f,d){var m=d.datas.startGroupClient,b=Zt(d.datas.groupClient,2),x=b[0],E=b[1],T=Zt(Ox(m,s*i),2),A=T[0],R=T[1],F=[A-x,R-E];return d.datas.groupClient=[A,R],Wt(Wt({},d),{parentRotate:a,groupDelta:F})});t.rotation=i*n.beforeRotation;var c=Wt({targets:t.props.targets,events:o,set:function(f){t.rotation=f},setGroupRotation:function(f){t.rotation=f}},n);return Wn(t,"onRotateGroup",c),c}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isRotate){this.dragControlEnd(t,e);var i=dp(t,this,"dragControlEnd",e),a=hf(t,e,{targets:t.props.targets,events:i});return Wn(t,"onRotateGroupEnd",a),r}},request:function(t){var e={},r=0,n=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?r+=i.deltaRotate:"rotate"in i&&(r=i.rotate-n),{datas:e,parentDist:r}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function yxe(t,e){var r,n=t.direction,i=t.classNames,a=t.size,s=t.pos,o=t.zoom,c=t.key,f=n==="horizontal",d=f?"Y":"X";return e.createElement("div",{key:c,className:i.join(" "),style:(r={},r[f?"width":"height"]="".concat(a),r.transform="translate(".concat(s[0],", ").concat(s[1],") translate").concat(d,"(-50%) scale").concat(d,"(").concat(o,")"),r)})}function HO(t,e){return yxe(Wt(Wt({},t),{classNames:yn([yi("line","guideline",t.direction)],Zt(t.classNames),!1).filter(function(r){return r}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(r){return"".concat(Fi(r,.1),"px")})}),e)}function $9(t,e,r,n,i,a,s,o){var c=t.props.zoom;return r.map(function(f,d){var m=f.type,b=f.pos,x=[0,0];return x[s]=n,x[s?0:1]=-i+b,HO({key:"".concat(e,"TargetGuideline").concat(d),classNames:[yi("target","bold",m)],posValue:x,sizeValue:a,zoom:c,direction:e},o)})}function q9(t,e,r,n,i,a){var s=t.props,o=s.zoom,c=s.isDisplayInnerSnapDigit,f=e==="horizontal"?Ig:Pg,d=i[f.start],m=i[f.end];return r.filter(function(b){var x=b.hide,E=b.elementRect;if(x)return!1;if(c&&E){var T=E.rect;if(T[f.start]<=d&&m<=T[f.end])return!1}return!0}).map(function(b,x){var E=b.pos,T=b.size,A=b.element,R=b.className,F=[-n[0]+E[0],-n[1]+E[1]];return HO({key:"".concat(e,"-default-guideline-").concat(x),classNames:A?[yi("bold"),R]:[yi("normal"),R],direction:e,posValue:F,sizeValue:T,zoom:o},a)})}function L1(t,e,r,n,i,a,s,o){var c,f=t.props,d=f.snapDigit,m=d===void 0?0:d,b=f.isDisplaySnapDigit,x=b===void 0?!0:b,E=f.snapDistFormat,T=E===void 0?function(U,j){return U}:E,A=f.zoom,R=e==="horizontal"?"X":"Y",F=e==="vertical"?"height":"width",N=Math.abs(i),O=x?parseFloat(N.toFixed(m)):0;return o.createElement("div",{key:"".concat(e,"-").concat(r,"-guideline-").concat(n),className:yi("guideline-group",e),style:(c={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},c[F]="".concat(N,"px"),c)},HO({direction:e,classNames:[yi(r),s],size:"100%",posValue:[0,0],sizeValue:N,zoom:A},o),o.createElement("div",{className:yi("size-value","gap"),style:{transform:"translate".concat(R,"(-50%) scale(").concat(A,")")}},O>0?T(O,e):""))}function vxe(t,e,r,n){var i=t==="vertical"?0:1,a=t==="vertical"?1:0,s=i?Ig:Pg,o=r[s.start],c=r[s.end];return RK(e,function(f){return f.pos[i]}).map(function(f){var d=[],m=[],b=[];return f.forEach(function(x){var E,T,A=x.element,R=x.elementRect.rect;if(R[s.end]<o)d.push(x);else if(c<R[s.start])m.push(x);else if(R[s.start]<=o&&c<=R[s.end]&&n){var F=x.pos,N={element:A,rect:Wt(Wt({},R),(E={},E[s.end]=R[s.start],E))},O={element:A,rect:Wt(Wt({},R),(T={},T[s.start]=R[s.end],T))},U=[0,0],j=[0,0];U[i]=F[i],U[a]=F[a],j[i]=F[i],j[a]=F[a]+x.size,d.push({type:t,pos:U,size:0,elementRect:N,direction:"",elementDirection:"end"}),m.push({type:t,pos:j,size:0,elementRect:O,direction:"",elementDirection:"start"})}}),d.sort(function(x,E){return E.pos[a]-x.pos[a]}),m.sort(function(x,E){return x.pos[a]-E.pos[a]}),{total:f,start:d,end:m,inner:b}})}function _xe(t,e,r,n,i){var a=t.props.isDisplayInnerSnapDigit,s=[];return["vertical","horizontal"].forEach(function(o){var c=e.filter(function(A){return A.type===o}),f=o==="vertical"?1:0,d=f?0:1,m=vxe(o,c,n,a),b=f?Pg:Ig,x=f?Ig:Pg,E=n[b.start],T=n[b.end];m.forEach(function(A){var R=A.total,F=A.start,N=A.end,O=A.inner,U=r[d]+R[0].pos[d]-n[x.start],j=n;F.forEach(function(H){var W=H.elementRect.rect,X=j[b.start]-W[b.end];if(X>0){var oe=[0,0];oe[f]=r[f]+j[b.start]-E-X,oe[d]=U,s.push(L1(t,o,"dashed",s.length,X,oe,H.className,i))}j=W}),j=n,N.forEach(function(H){var W=H.elementRect.rect,X=W[b.start]-j[b.end];if(X>0){var oe=[0,0];oe[f]=r[f]+j[b.end]-E,oe[d]=U,s.push(L1(t,o,"dashed",s.length,X,oe,H.className,i))}j=W}),O.forEach(function(H){var W=H.elementRect.rect,X=E-W[b.start],oe=W[b.end]-T,ee=[0,0],G=[0,0];ee[f]=r[f]-X,ee[d]=U,G[f]=r[f]+T-E,G[d]=U,s.push(L1(t,o,"dashed",s.length,X,ee,H.className,i)),s.push(L1(t,o,"dashed",s.length,oe,G,H.className,i))})})}),s}function bxe(t,e,r,n,i){var a=[];return["horizontal","vertical"].forEach(function(s){var o=e.filter(function(A){return A.type===s}).slice(0,1),c=s==="vertical"?0:1,f=c?0:1,d=c?Pg:Ig,m=c?Ig:Pg,b=n[d.start],x=n[d.end],E=n[m.start],T=n[m.end];o.forEach(function(A){var R=A.gap,F=A.gapRects,N=Math.max.apply(Math,yn([E],Zt(F.map(function(j){var H=j.rect;return H[m.start]})),!1)),O=Math.min.apply(Math,yn([T],Zt(F.map(function(j){var H=j.rect;return H[m.end]})),!1)),U=(N+O)/2;N===O||U===(E+T)/2||F.forEach(function(j){var H=j.rect,W=j.className,X=[r[0],r[1]];if(H[d.end]<b)X[c]+=H[d.end]-b;else if(x<H[d.start])X[c]+=H[d.start]-b-R;else return;X[f]+=U-E,a.push(L1(t,c?"vertical":"horizontal","gap",a.length,R,X,W,i))})})}),a}function Sk(t){var e,r,n=t.state,i=n.containerClientRect,a=n.hasFixed,s=i.overflow,o=i.scrollHeight,c=i.scrollWidth,f=i.clientHeight,d=i.clientWidth,m=i.clientLeft,b=i.clientTop,x=t.props,E=x.snapGap,T=E===void 0?!0:E,A=x.verticalGuidelines,R=x.horizontalGuidelines,F=x.snapThreshold,N=F===void 0?5:F,O=x.maxSnapElementGuidelineDistance,U=O===void 0?1/0:O,j=x.isDisplayGridGuidelines,H=Ff(Wf(t.state)),W=H.top,X=H.left,oe=H.bottom,ee=H.right,G={top:W,left:X,bottom:oe,right:ee,center:(X+ee)/2,middle:(W+oe)/2},ae=Exe(t),se=yn([],Zt(ae),!1),fe=((r=(e=n.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&r!==void 0?r:[1,1]).map(function(we){return we*N});T&&se.push.apply(se,yn([],Zt(xxe(t,G,fe)),!1));var pe=Wt({},n.snapOffset||{left:0,top:0,bottom:0,right:0});if(se.push.apply(se,yn([],Zt(Sxe(t,s?c:d,s?o:f,m,b,pe,j)),!1)),a){var De=i.left,ye=i.top;pe.left+=De,pe.top+=ye,pe.right+=De,pe.bottom+=ye}return se.push.apply(se,yn([],Zt(_K(R||!1,A||!1,s?c:d,s?o:f,m,b,pe)),!1)),se=se.filter(function(we){var Te=we.element,Re=we.elementRect,de=we.type;if(!Te||!Re)return!0;var Ee=Re.rect;return vK(G,Ee,de,U)}),se}function xxe(t,e,r){var n=t.props,i=n.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,s=n.maxSnapElementGapDistance,o=s===void 0?1/0:s,c=t.state.elementRects,f=[];return[["vertical",Ig,Pg],["horizontal",Pg,Ig]].forEach(function(d){var m=Zt(d,3),b=m[0],x=m[1],E=m[2],T=e[x.start],A=e[x.end],R=e[x.center],F=e[E.start],N=e[E.end],O={left:r[0],top:r[1]};function U(W){var X=W.rect,oe=O[x.start];return X[x.end]<T+oe?T-X[x.end]:A-oe<X[x.start]?X[x.start]-A:-1}var j=c.filter(function(W){var X=W.rect;return X[E.start]>N||X[E.end]<F?!1:U(W)>0}).sort(function(W,X){return U(W)-U(X)}),H=[];j.forEach(function(W){j.forEach(function(X){if(W!==X){var oe=W.rect,ee=X.rect,G=oe[E.start],ae=oe[E.end],se=ee[E.start],fe=ee[E.end];G>fe||se>ae||H.push([W,X])}})}),H.forEach(function(W){var X=Zt(W,2),oe=X[0],ee=X[1],G=oe.rect,ae=ee.rect,se=G[x.start],fe=G[x.end],pe=ae[x.start],De=ae[x.end],ye=O[x.start],we=0,Te=0,Re=!1,de=!1,Ee=!1;if(fe<=T&&A<=pe){if(de=!0,we=(pe-fe-(A-T))/2,Te=fe+we+(A-T)/2,rn(Te-R)>ye)return}else if(fe<pe&&De<T+ye){if(Re=!0,we=pe-fe,Te=De+we,rn(Te-T)>ye)return}else if(fe<pe&&A-ye<se){if(Ee=!0,we=pe-fe,Te=se-we,rn(Te-A)>ye)return}else return;we&&vK(e,ae,b,a)&&(we>o||f.push({type:b,pos:b==="vertical"?[Te,0]:[0,Te],element:ee.element,size:0,className:ee.className,isStart:Re,isCenter:de,isEnd:Ee,gap:we,hide:!0,gapRects:[oe,ee],direction:"",elementDirection:""}))})}),f}function wxe(t,e,r,n){var i,a,s=t.props,o=t.state,c=s.snapGridAll,f=s.snapGridWidth,d=f===void 0?0:f,m=s.snapGridHeight,b=m===void 0?0:m,x=o.snapRenderInfo,E=x&&(((i=x.direction)===null||i===void 0?void 0:i[0])||((a=x.direction)===null||a===void 0?void 0:a[1])),T=t.moveables;if(c&&T&&E&&(d||b)){if(o.snapThresholdInfo)return;o.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var A=t.getRect(),R=A.children,F=x.direction;if(R){var N=F.map(function(U,j){var H=j===0?{snapSize:d,posName:"left",sizeName:"width",clientOffset:n.left-e}:{snapSize:b,posName:"top",sizeName:"height",clientOffset:n.top-r},W=H.snapSize,X=H.posName,oe=H.sizeName,ee=H.clientOffset;if(!W)return{dir:U,multiple:1,snapSize:W,snapOffset:0};var G=A[oe],ae=A[X],se=g1e(R.map(function(Re){return[Re[X]-ae,Re[oe],G-Re[oe]-Re[X]+ae]})).filter(function(Re){return Re}).sort(function(Re,de){return Re-de}),fe=se[0],pe=se.map(function(Re){return Fi(Re/fe,.1)*W}),De=1,ye=Fi(G/fe,.1);for(De=1;De<=10&&!pe.every(function(Re){return Re*De%1===0});++De);var we=(-U+1)/2,Te=ZS(ae-ee,ae-ee+G,we,1-we);return{multiple:ye*De,dir:U,snapSize:W,snapOffset:Math.round(Te/W)}}),O=N.map(function(U){return U.multiple||1});o.snapThresholdInfo.multiples=O,o.snapThresholdInfo.offset=N.map(function(U){return U.snapOffset}),N.forEach(function(U,j){U.snapSize})}}else o.snapThresholdInfo=null}function Sxe(t,e,r,n,i,a,s){n===void 0&&(n=0),i===void 0&&(i=0);var o=t.props,c=t.state,f=o.snapGridWidth,d=f===void 0?0:f,m=o.snapGridHeight,b=m===void 0?0:m,x=[],E=a.left,T=a.top,A=[0,0];wxe(t,n,i,a);var R=c.snapThresholdInfo,F=d,N=b;if(R&&(d*=R.multiples[0]||1,b*=R.multiples[1]||1,A=R.offset),b){for(var O=function(j){x.push({type:"horizontal",pos:[E,Fi(A[1]*N+j-i+T,.1)],className:yi("grid-guideline"),size:e,hide:!s,direction:"",grid:!0})},U=0;U<=r*2;U+=b)O(U);for(var U=-b;U>=-r;U-=b)O(U)}if(d){for(var O=function(H){x.push({type:"vertical",pos:[Fi(A[0]*F+H-n+E,.1),T],className:yi("grid-guideline"),size:r,hide:!s,direction:"",grid:!0})},U=0;U<=e*2;U+=d)O(U);for(var U=-d;U>=-e;U-=d)O(U)}return x}function vK(t,e,r,n){return r==="horizontal"?rn(t.right-e.left)<=n||rn(t.left-e.right)<=n||t.left<=e.right&&e.left<=t.right:r==="vertical"?rn(t.bottom-e.top)<=n||rn(t.top-e.bottom)<=n||t.top<=e.bottom&&e.top<=t.bottom:!0}function Exe(t){var e=t.state,r=t.props.elementGuidelines,n=r===void 0?[]:r;if(!n.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(b){return!b.refresh}),a=n.map(function(b){return Ch(b)&&"element"in b?Wt(Wt({},b),{element:vd(b.element,!0)}):{element:vd(b,!0)}}).filter(function(b){return b.element}),s=L1e(i.map(function(b){return b.element}),a.map(function(b){return b.element})),o=s.maintained,c=s.added,f=[];o.forEach(function(b){var x=Zt(b,2),E=x[0],T=x[1];f[T]=i[E]}),Txe(t,c.map(function(b){return a[b]})).map(function(b,x){f[c[x]]=b}),e.elementRects=f;var d=UO(t.props.elementSnapDirections),m=[];return f.forEach(function(b){var x=b.element,E=b.top,T=E===void 0?d.top:E,A=b.left,R=A===void 0?d.left:A,F=b.right,N=F===void 0?d.right:F,O=b.bottom,U=O===void 0?d.bottom:O,j=b.center,H=j===void 0?d.center:j,W=b.middle,X=W===void 0?d.middle:W,oe=b.className,ee=b.rect,G=VO({top:T,right:N,left:R,bottom:U,center:H,middle:X},ee),ae=G.horizontal,se=G.vertical,fe=G.horizontalNames,pe=G.verticalNames,De=ee.top,ye=ee.left,we=ee.right-ye,Te=ee.bottom-De,Re=[we,Te];se.forEach(function(de,Ee){m.push({type:"vertical",element:x,pos:[Fi(de,.1),De],size:Te,sizes:Re,className:oe,elementRect:b,elementDirection:L9[pe[Ee]]||pe[Ee],direction:""})}),ae.forEach(function(de,Ee){m.push({type:"horizontal",element:x,pos:[ye,Fi(de,.1)],size:we,sizes:Re,className:oe,elementRect:b,elementDirection:L9[fe[Ee]]||fe[Ee],direction:""})})}),m}function H9(t,e){return t?t.map(function(r){var n=Ch(r)?r:{pos:r},i=n.pos;return jb(i)?n:Wt(Wt({},n),{pos:wo(i,e)})}):[]}function _K(t,e,r,n,i,a,s){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s={left:0,top:0,right:0,bottom:0});var o=[],c=s.left,f=s.top,d=s.bottom,m=s.right,b=r+m-c,x=n+d-f;return H9(t,x).forEach(function(E){o.push({type:"horizontal",pos:[c,Fi(E.pos-a+f,.1)],size:b,className:E.className,direction:""})}),H9(e,b).forEach(function(E){o.push({type:"vertical",pos:[Fi(E.pos-i+c,.1),f],size:x,className:E.className,direction:""})}),o}function Txe(t,e){if(!e.length)return[];var r=t.props.groupable,n=t.state,i=n.containerClientRect,a=n.rootMatrix,s=n.is3d,o=n.offsetDelta,c=s?4:3,f=Zt(Ybe(a,i,c),2),d=f[0],m=f[1],b=r?0:o[0],x=r?0:o[1];return e.map(function(E){var T=E.element.getBoundingClientRect(),A=T.left-d-b,R=T.top-m-x,F=R+T.height,N=A+T.width,O=Zt(q0(a,[A,R],c),2),U=O[0],j=O[1],H=Zt(q0(a,[N,F],c),2),W=H[0],X=H[1];return Wt(Wt({},E),{rect:{left:U,right:W,top:j,bottom:X,center:(U+W)/2,middle:(j+X)/2}})})}function hw(t){var e=t.state,r=e.container,n=t.props.snapContainer||r;if(e.snapContainer===n&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(r!==n){var s=vd(n,!0);if(s){var o=pb(s),c=K9(e,[o.left-i.left,o.top-i.top]),f=K9(e,[o.right-i.right,o.bottom-i.bottom]);a.left=Fi(c[0],1e-5),a.top=Fi(c[1],1e-5),a.right=Fi(f[0],1e-5),a.bottom=Fi(f[1],1e-5)}}return e.snapContainer=n,e.snapOffset=a,e.guidelines=Sk(t),e.enableSnap=!0,!0}function bK(t,e,r,n,i,a){var s=xy(t,e,r,a?4:3),o=zl(s,n);return WO(s,_i(i,o))}function G9(t){return t?t/rn(t):0}function Cxe(t,e,r,n,i,a){var s=a.fixedDirection,o=Qbe(r,s,n),c=qO(t,e,r,n),f=yn(yn([],Zt(fxe(t,e,o,n,i,a)),!1),Zt(pK(t,c,a)),!1),d=tE(f,0),m=tE(f,1);return{width:{isBound:d.isBound,offset:d.offset[0]},height:{isBound:m.isBound,offset:m.offset[1]}}}function Axe(t,e,r,n,i,a,s,o,c){var f=zl(e,s),d=s3(t,o,{vertical:[f[0]],horizontal:[f[1]]}),m=d.horizontal.offset,b=d.vertical.offset;if(Fi(b,mk)||Fi(m,mk)){var x=Zt(Pd({datas:c,distX:-b,distY:-m}),2),E=x[0],T=x[1],A=Math.min(i||1/0,r+s[0]*E),R=Math.min(a||1/0,n+s[1]*T);return[A-r,R-n]}return[0,0]}function xK(t,e,r,n,i,a,s,o){for(var c=Wf(t.state),f=t.props.keepRatio,d=0,m=0,b=0;b<2;++b){var x=e(d,m),E=Cxe(t,x,i,f,s,o),T=E.width,A=E.height,R=T.isBound,F=A.isBound,N=T.offset,O=A.offset;if(b===1&&(R||(N=0),F||(O=0)),b===0&&s&&!R&&!F)return[0,0];if(f){var U=rn(N)*(r?1/r:1),j=rn(O)*(n?1/n:1),H=R&&F?U<j:F||!R&&U<j;H?N=r*O/n:O=n*N/r}d+=N,m+=O}if(!f&&i[0]&&i[1]){var W=dxe(t,c,i,a,o),X=W.maxWidth,oe=W.maxHeight,ee=Zt(Axe(t,e(d,m).map(function(se){return se.map(function(fe){return Fi(fe,mk)})}),r+d,n+m,X,oe,i,s,o),2),N=ee[0],O=ee[1];d+=N,m+=O}return[d,m]}function hb(t){return t<0&&(t=t%360+360),t%=360,t}function Ixe(t,e){e=hb(e);var r=Math.floor(t/360),n=r*360+360-e,i=r*360+e;return rn(t-n)<rn(t-i)?n:i}function t5(t,e){t=hb(t),e=hb(e);var r=hb(t-e);return Math.min(r,360-r)}function Pxe(t,e,r,n){var i,a=t.props,s=(i=a[oK])!==null&&i!==void 0?i:5,o=a[sK];if(y_(t,"rotatable")){var c=e.pos1,f=e.pos2,d=e.pos3,m=e.pos4,b=e.origin,x=r*Math.PI/180,E=[c,f,d,m].map(function(O){return _i(O,b)}),T=E.map(function(O){return Ox(O,x)}),A=yn(yn([],Zt(Hbe(t,E,T,b,r)),!1),Zt(axe(t,E,T,b,r)),!1);A.sort(function(O,U){return rn(O-r)-rn(U-r)});var R=A.length>0;if(R)return{isSnap:R,dist:R?A[0]:r}}if(o?.length&&s){var F=o.slice().sort(function(O,U){return t5(O,n)-t5(U,n)}),N=F[0];if(t5(N,n)<=s)return{isSnap:!0,dist:r+Ixe(n,N)-n}}return{isSnap:!1,dist:r}}function Mxe(t,e,r,n,i,a,s){if(!y_(t,"resizable"))return[0,0];var o=s.fixedDirection,c=s.nextAllMatrix,f=t.state,d=f.allMatrix,m=f.is3d;return xK(t,function(b,x){return bK(c||d,e+b,r+x,o,i,m)},e,r,n,i,a,s)}function kxe(t,e,r,n,i){if(!y_(t,"scalable"))return[0,0];var a=i.startOffsetWidth,s=i.startOffsetHeight,o=i.fixedPosition,c=i.fixedDirection,f=i.is3d,d=xK(t,function(m,b){return bK(Mbe(i,Ra(e,[m/a,b/s])),a,s,c,o,f)},a,s,r,o,n,i);return[d[0]/a,d[1]/s]}function Rxe(t,e){e.absolutePoses=Wf(t.state)}function W9(t){var e=[];return t.forEach(function(r){r.guidelineInfos.forEach(function(n){var i=n.guideline;ff(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:r}))})}),e.map(function(r){var n=r.guideline,i=r.posInfo;return Wt(Wt({},n),{direction:i.direction})})}function X9(t,e,r,n,i,a){var s=jO(a3(t,a),e,r),o=s.vertical,c=s.horizontal,f=s0();o.forEach(function(E){E.isBound&&(E.direction==="start"&&(f.left=!0),E.direction==="end"&&(f.right=!0),n.push({type:"bounds",pos:E.pos}))}),c.forEach(function(E){E.isBound&&(E.direction==="start"&&(f.top=!0),E.direction==="end"&&(f.bottom=!0),i.push({type:"bounds",pos:E.pos}))});var d=oxe(t),m=d.boundMap,b=d.vertical,x=d.horizontal;return b.forEach(function(E){bp(n,function(T){var A=T.type,R=T.pos;return A==="bounds"&&R===E})>=0||n.push({type:"bounds",pos:E})}),x.forEach(function(E){bp(i,function(T){var A=T.type,R=T.pos;return A==="bounds"&&R===E})>=0||i.push({type:"bounds",pos:E})}),{boundMap:f,innerBoundMap:m}}var Dxe=ZO("",["resizable","scalable"]),Oxe={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",oK,sK,lK,uK,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(t,e){var r=t.state,n=r.top,i=r.left,a=r.pos1,s=r.pos2,o=r.pos3,c=r.pos4,f=r.snapRenderInfo,d=t.props.snapRenderThreshold,m=d===void 0?1:d;if(!f||!f.render||!y_(t,""))return u0(t,"boundMap",s0(),function(xe){return JSON.stringify(xe)}),u0(t,"innerBoundMap",s0(),function(xe){return JSON.stringify(xe)}),[];r.guidelines=Sk(t);var b=Math.min(a[0],s[0],o[0],c[0]),x=Math.min(a[1],s[1],o[1],c[1]),E=f.externalPoses||[],T=Wf(t.state),A=[],R=[],F=[],N=[],O=[],U=Ff(T),j=U.width,H=U.height,W=U.top,X=U.left,oe=U.bottom,ee=U.right,G={left:X,right:ee,top:W,bottom:oe,center:(X+ee)/2,middle:(W+oe)/2},ae=E.length>0,se=ae?Ff(E):{};if(!f.request){if(f.direction&&O.push(Jbe(t,T,f.direction,m,m)),f.snap){var fe=Ff(T);f.center&&(fe.middle=(fe.top+fe.bottom)/2,fe.center=(fe.left+fe.right)/2),O.push(N9(t,fe,m,m))}ae&&(f.center&&(se.middle=(se.top+se.bottom)/2,se.center=(se.left+se.right)/2),O.push(N9(t,se,m,m))),O.forEach(function(xe){var Ne=xe.vertical.posInfos,Fe=xe.horizontal.posInfos;A.push.apply(A,yn([],Zt(Ne.filter(function(Xe){var Be=Xe.guidelineInfos;return Be.some(function(ot){var Ke=ot.guideline;return!Ke.hide})}).map(function(Xe){return{type:"snap",pos:Xe.pos}})),!1)),R.push.apply(R,yn([],Zt(Fe.filter(function(Xe){var Be=Xe.guidelineInfos;return Be.some(function(ot){var Ke=ot.guideline;return!Ke.hide})}).map(function(Xe){return{type:"snap",pos:Xe.pos}})),!1)),F.push.apply(F,yn([],Zt(W9(Ne)),!1)),N.push.apply(N,yn([],Zt(W9(Fe)),!1))})}var pe=X9(t,[X,ee],[W,oe],A,R),De=pe.boundMap,ye=pe.innerBoundMap;ae&&X9(t,[se.left,se.right],[se.top,se.bottom],A,R,f.externalBounds);var we=yn(yn([],Zt(F),!1),Zt(N),!1),Te=we.filter(function(xe){return xe.element&&!xe.gapRects}),Re=we.filter(function(xe){return xe.gapRects}).sort(function(xe,Ne){return xe.gap-Ne.gap});Wn(t,"onSnap",{guidelines:we.filter(function(xe){var Ne=xe.element;return!Ne}),elements:Te,gaps:Re},!0);var de=u0(t,"boundMap",De,function(xe){return JSON.stringify(xe)},s0()),Ee=u0(t,"innerBoundMap",ye,function(xe){return JSON.stringify(xe)},s0());return(De===de||ye===Ee)&&Wn(t,"onBound",{bounds:De,innerBounds:ye},!0),yn(yn(yn(yn(yn(yn([],Zt(_xe(t,Te,[b,x],G,e)),!1),Zt(bxe(t,Re,[b,x],G,e)),!1),Zt(q9(t,"horizontal",N,[i,n],G,e)),!1),Zt(q9(t,"vertical",F,[i,n],G,e)),!1),Zt($9(t,"horizontal",R,b,n,j,0,e)),!1),Zt($9(t,"vertical",A,x,i,H,1,e)),!1)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},hw(t)},drag:function(t){var e=t.state;hw(t)||(e.guidelines=Sk(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){if(Dxe(t,e)||wk(t,e))return!0;if(!e.isRequest&&e.inputEvent)return Bl(e.inputEvent.target,yi("snap-control"))},dragControlStart:function(t){t.state.snapRenderInfo=null,hw(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,hw(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function Lxe(t,e){return[t[0]*e[0],t[1]*e[1]]}function yi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return J_e.apply(void 0,yn([NO],Zt(t),!1))}function wK(t){t()}function Nxe(t){return!t||t==="none"?[1,0,0,1,0,0]:Ch(t)?t:Vb(t)}function db(t,e,r){return KS(e,Jm(r,e),t,Jm(r.map(function(n){return-n}),e))}function Fxe(t,e,r){if(e==="%"){var n=GO(t.ownerSVGElement);return n[r?"width":"height"]/100}return 1}function Bxe(t){var e=zxe(XO(t,":before"));return e.map(function(r,n){var i=Dx(r),a=i.value,s=i.unit;return a*Fxe(t,s,n===0)})}function nE(t){return t?t.split(" "):["0","0"]}function zxe(t){return nE(t.transformOrigin)}function SK(t){var e=Lc(t),r=e("transform");if(r&&r!=="none")return r;if("transform"in t){var n=t.transform,i=n.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var s=[],o=function(f){var d=i[f].matrix;s.push("matrix(".concat(["a","b","c","d","e","f"].map(function(m){return d[m]}).join(", "),")"))},c=0;c<a;++c)o(c);return s.join(" ")}return""}function qb(t,e,r,n,i){var a,s,o=IO(t)||zg(t),c=!1,f,d;if(!t||r)f=t;else{var m=(a=t?.assignedSlot)===null||a===void 0?void 0:a.parentElement,b=t.parentElement;m?(c=!0,d=b,f=m):f=b}for(var x=!1,E=t===e||f===e,T="relative",A=1,R=parseFloat(i?.("zoom"))||1,F=i?.("position");f&&f!==o;){e===f&&(E=!0);var N=Lc(f),O=f.tagName.toLowerCase(),U=SK(f),j=N("willChange"),H=parseFloat(N("zoom"))||1;if(T=N("position"),n&&H!==1){A=H;break}if(!r&&n&&R!==1&&F&&F!=="absolute"||O==="svg"||O==="foreignobject"||T!=="static"||U&&U!=="none"||j==="transform")break;var W=(s=t?.assignedSlot)===null||s===void 0?void 0:s.parentNode,X=f.parentNode;W&&(c=!0,d=X);var oe=X;if(oe&&oe.nodeType===11){f=oe.host,x=!0,T=Lc(f)("position");break}f=oe,T="relative"}return{offsetZoom:A,hasSlot:c,parentSlotElement:d,isCustomElement:x,isStatic:T==="static",isEnd:E||!f||f===o,offsetParent:f||o}}function jxe(t,e){var r,n=t.tagName.toLowerCase(),i=t.offsetLeft,a=t.offsetTop,s=Lc(t),o=SO(i),c=!o,f,d;return!c&&(n!=="svg"||t.ownerSVGElement)?(f=$Z?Bxe(t):nE(s("transformOrigin")).map(function(m){return parseFloat(m)}),d=f.slice(),c=!0,n==="svg"?(i=0,a=0):(r=Zt($xe(t,f,t===e&&e.tagName.toLowerCase()==="g"),4),i=r[0],a=r[1],f[0]=r[2],f[1]=r[3])):(f=nE(s("transformOrigin")).map(function(m){return parseFloat(m)}),d=f.slice()),{tagName:n,isSVG:o,hasOffset:c,offset:[i||0,a||0],origin:f,targetOrigin:d}}function EK(t,e){var r=Lc(t),n=Lc(zg(t)),i=n("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(n("marginLeft"),10),s=parseInt(n("marginTop"),10);return r("position")==="absolute"&&((r("top")!=="auto"||r("bottom")!=="auto")&&(s=0),(r("left")!=="auto"||r("right")!=="auto")&&(a=0)),[a,s]}function Ek(t){t.forEach(function(e){var r=e.matrix;r&&(e.matrix=Ah(r,3,4))})}function Uxe(t){for(var e=t.parentElement,r=!1,n=zg(t);e;){var i=XO(e).transform;if(i&&i!=="none"){r=!0;break}if(e===n)break;e=e.parentElement}return{fixedContainer:e||n,hasTransform:r}}function l3(t,e){return e===void 0&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat(LZ(t,!e).join(","),")")}function GO(t){var e=t.clientWidth,r=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:r};var n=t.viewBox,i=n&&n.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||r,clientWidth:e,clientHeight:r}}function Vxe(t,e){var r,n=GO(t),i=n.width,a=n.height,s=n.clientWidth,o=n.clientHeight,c=s/i,f=o/a,d=t.preserveAspectRatio.baseVal,m=d.align,b=d.meetOrSlice,x=[0,0],E=[c,f],T=[0,0];if(m!==1){var A=(m-2)%3,R=Math.floor((m-2)/3);x[0]=i*A/2,x[1]=a*R/2;var F=b===2?Math.max(f,c):Math.min(c,f);E[0]=F,E[1]=F,T[0]=(s-i)/2*A,T[1]=(o-a)/2*R}var N=MO(E,e);return r=Zt(T,2),N[e*(e-1)]=r[0],N[e*(e-1)+1]=r[1],db(N,e,x)}function $xe(t,e,r){var n=t.tagName.toLowerCase();if(!t.getBBox||!r&&n==="g")return[0,0,0,0];var i=Lc(t),a=i("transform-box")==="fill-box",s=t.getBBox(),o=GO(t.ownerSVGElement),c=s.x,f=s.y;n==="foreignobject"&&!c&&!f&&(c=parseFloat(t.getAttribute("x"))||0,f=parseFloat(t.getAttribute("y"))||0);var d=c-o.x,m=f-o.y,b=a?e[0]:e[0]-d,x=a?e[1]:e[1]-m;return[d,m,b,x]}function xs(t,e,r){return rc(t,Km(e,r),r)}function xy(t,e,r,n){return[[0,0],[e,0],[0,r],[e,r]].map(function(i){return xs(t,i,n)})}function Ff(t){var e=t.map(function(f){return f[0]}),r=t.map(function(f){return f[1]}),n=Math.min.apply(Math,yn([],Zt(e),!1)),i=Math.min.apply(Math,yn([],Zt(r),!1)),a=Math.max.apply(Math,yn([],Zt(e),!1)),s=Math.max.apply(Math,yn([],Zt(r),!1)),o=a-n,c=s-i;return{left:n,top:i,right:a,bottom:s,width:o,height:c}}function Y9(t,e,r,n){var i=xy(t,e,r,n);return Ff(i)}function qxe(t,e,r,n,i){var a,s=t.target,o=t.origin,c=e.matrix,f=CK(s),d=f.offsetWidth,m=f.offsetHeight,b=r.getBoundingClientRect(),x=[0,0];r===zg(r)&&(x=EK(s,!0));for(var E=s.getBoundingClientRect(),T=E.left-b.left+r.scrollLeft-(r.clientLeft||0)+x[0],A=E.top-b.top+r.scrollTop-(r.clientTop||0)+x[1],R=E.width,F=E.height,N=KS(n,i,c),O=Y9(N,d,m,n),U=O.left,j=O.top,H=O.width,W=O.height,X=xs(N,o,n),oe=_i(X,[U,j]),ee=[T+oe[0]*R/H,A+oe[1]*F/W],G=[0,0],ae=0;++ae<10;){var se=wd(i,n);a=Zt(_i(xs(se,ee,n),xs(se,X,n)),2),G[0]=a[0],G[1]=a[1];var fe=KS(n,i,Jm(G,n),c),pe=Y9(fe,d,m,n),De=pe.left,ye=pe.top,we=De-T,Te=ye-A;if(rn(we)<2&&rn(Te)<2)break;ee[0]-=we,ee[1]-=Te}return G.map(function(Re){return Math.round(Re)})}function Hxe(t,e,r){var n=t.length===16,i=n?4:3,a=e.map(function(c){return xs(t,c,i)}),s=r.left,o=r.top;return a.map(function(c){return[c[0]+s,c[1]+o]})}function Gf(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function TK(t,e){return Gf([e[0]-t[0],e[1]-t[1]])}function N1(t,e,r,n){r===void 0&&(r=1),n===void 0&&(n=al(t,e));var i=TK(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(n,"rad) scaleY(").concat(r,")"),width:"".concat(i,"px")}}function iE(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=r.length,a=r.reduce(function(o,c){return o+c[0]},0)/i,s=r.reduce(function(o,c){return o+c[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(s,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function ey(t,e){var r=t[e];return Ch(r)?Wt(Wt({},t),r):t}function CK(t){var e=t&&!SO(t.offsetWidth),r=0,n=0,i=0,a=0,s=0,o=0,c=0,f=0,d=0,m=0,b=0,x=0,E=1/0,T=1/0,A=1/0,R=1/0,F=0,N=0,O=!1;if(t)if(!e&&t.ownerSVGElement){var U=t.getBBox();O=!0,r=U.width,n=U.height,s=r,o=n,c=r,f=n,i=r,a=n}else{var j=Lc(t),H=t.style,W=j("boxSizing")==="border-box",X=parseFloat(j("borderLeftWidth"))||0,oe=parseFloat(j("borderRightWidth"))||0,ee=parseFloat(j("borderTopWidth"))||0,G=parseFloat(j("borderBottomWidth"))||0,ae=parseFloat(j("paddingLeft"))||0,se=parseFloat(j("paddingRight"))||0,fe=parseFloat(j("paddingTop"))||0,pe=parseFloat(j("paddingBottom"))||0,De=ae+se,ye=fe+pe,we=X+oe,Te=ee+G,Re=De+we,de=ye+Te,Ee=j("position"),xe=0,Ne=0;if("clientLeft"in t){var Fe=null;if(Ee==="absolute"){var Xe=qb(t,zg(t));Fe=Xe.offsetParent}else Fe=t.parentElement;if(Fe){var Be=Lc(Fe);xe=parseFloat(Be("width")),Ne=parseFloat(Be("height"))}}d=Math.max(De,wo(j("minWidth"),xe)||0),m=Math.max(ye,wo(j("minHeight"),Ne)||0),E=wo(j("maxWidth"),xe),T=wo(j("maxHeight"),Ne),isNaN(E)&&(E=1/0),isNaN(T)&&(T=1/0),F=wo(H.width,0)||0,N=wo(H.height,0)||0,s=parseFloat(j("width"))||0,o=parseFloat(j("height"))||0,c=rn(s-F)<1?ok(d,F||s,E):s,f=rn(o-N)<1?ok(m,N||o,T):o,r=c,n=f,i=c,a=f,W?(A=E,R=T,b=d,x=m,c=r-Re,f=n-de):(A=E+Re,R=T+de,b=d+Re,x=m+de,r=c+Re,n=f+de),i=c+De,a=f+ye}return{svg:O,offsetWidth:r,offsetHeight:n,clientWidth:i,clientHeight:a,contentWidth:c,contentHeight:f,inlineCSSWidth:F,inlineCSSHeight:N,cssWidth:s,cssHeight:o,minWidth:d,minHeight:m,maxWidth:E,maxHeight:T,minOffsetWidth:b,minOffsetHeight:x,maxOffsetWidth:A,maxOffsetHeight:R}}function AK(t,e){return al(e>0?t[0]:t[1],e>0?t[1]:t[0])}function dw(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function IK(t,e){var r=t===zg(t)||t===IO(t),n={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return r&&(n.clientHeight=Math.max(e.height,n.clientHeight),n.scrollHeight=Math.max(e.height,n.scrollHeight)),n.overflow=Lc(t)("overflow")!=="visible",Wt(Wt({},e),n)}function r5(t,e,r,n){var i=t.left,a=t.right,s=t.top,o=t.bottom,c=e.top,f=e.left,d={left:f+i,top:c+s,right:f+a,bottom:c+o,width:a-i,height:o-s};return r&&n?IK(r,d):d}function pb(t,e){var r=0,n=0,i=0,a=0;if(t){var s=t.getBoundingClientRect();r=s.left,n=s.top,i=s.width,a=s.height}var o={left:r,top:n,width:i,height:a,right:r+i,bottom:n+a};return t&&e?IK(t,o):o}function Gxe(t){var e=t.props,r=e.groupable,n=e.svgOrigin,i=t.getState(),a=i.offsetWidth,s=i.offsetHeight,o=i.svg,c=i.transformOrigin;return!r&&o&&n?JO(n,a,s):c}function PK(t,e,r,n){var i;if(t)i=t;else if(e)i=[0,0];else{var a=r.target;i=MK(a,n)}return i}function MK(t,e){if(t){var r=t.getAttribute("data-rotation")||"",n=t.getAttribute("data-direction");if(e.deg=r,!!n){var i=[0,0];return n.indexOf("w")>-1&&(i[0]=-1),n.indexOf("e")>-1&&(i[0]=1),n.indexOf("n")>-1&&(i[1]=-1),n.indexOf("s")>-1&&(i[1]=1),i}}}function WO(t,e){return[Ra(e,t[0]),Ra(e,t[1]),Ra(e,t[2]),Ra(e,t[3])]}function Wf(t){var e=t.left,r=t.top,n=t.pos1,i=t.pos2,a=t.pos3,s=t.pos4;return WO([n,i,a,s],[e,r])}function Tk(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(r){r.unset&&r.unset(t)})}function l0(t,e){var r=e?"controlGesto":"targetGesto",n=t[r];n?.isIdle()===!1&&Tk(t,e),n?.unset(),t[r]=null}function yc(t,e){if(e){var r=m_(e);r.nextStyle=Wt(Wt({},r.nextStyle),t)}return{style:t,cssText:p_(t).map(function(n){return"".concat(c1e(n,"-"),": ").concat(t[n],";")}).join("")}}function kK(t,e,r){var n=e.afterTransform||e.transform;return Wt(Wt({},yc(Wt(Wt(Wt({},t.style),e.style),{transform:n}),r)),{afterTransform:n,transform:t.transform})}function Ki(t,e,r,n){var i=e.datas;i.datas||(i.datas={});var a=Wt(Wt({},r),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var s;(s=e.stop)===null||s===void 0||s.call(e)}});return i.isStartEvent?n||(i.lastEvent=a):i.isStartEvent=!0,a}function hf(t,e,r){var n=e.datas,i="isDrag"in r?r.isDrag:e.isDrag;return n.datas||(n.datas={}),Wt(Wt({isDrag:i},r),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:n.lastEvent,isDouble:e.isDouble,datas:n.datas,isFirstDrag:!!e.isFirstDrag})}function u3(t,e,r){t._emitter.on(e,r)}function Wn(t,e,r,n,i){return t.triggerEvent(e,r,n,i)}function XO(t,e){return bg(t).getComputedStyle(t,e)}function pw(t,e,r){var n={},i={};return t.filter(function(a){var s=a.name;if(n[s]||!e.some(function(o){return a[o]}))return!1;if(!r&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return n[s]=!0,!0})}function Ck(t,e){return t===e||t==null&&e==null}function Z9(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length-1,n=0;n<r;++n){var i=t[n];if(!SO(i))return i}return t[r]}function RK(t,e){var r=[],n=[];return t.forEach(function(i,a){var s=e(i,a,t),o=n.indexOf(s),c=r[o]||[];o===-1&&(n.push(s),r.push(c)),c.push(i)}),r}function Wxe(t,e){var r=[],n={};return t.forEach(function(i,a){var s=e(i,a,t),o=n[s];o||(o=[],n[s]=o,r.push(o)),o.push(i)}),r}function DK(t){return t.reduce(function(e,r){return e.concat(r)},[])}function $0(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort(function(r,n){return rn(n)-rn(r)}),t[0]}function q0(t,e,r){return rc(wd(t,r),Km(e,r),r)}function Xxe(t,e){var r,n=t.is3d,i=t.rootMatrix,a=n?4:3;return r=Zt(q0(i,[e.distX,e.distY],a),2),e.distX=r[0],e.distY=r[1],e}function Af(t,e,r,n){if(!r[0]&&!r[1])return e;var i=xs(t,[G9(r[0]||1),0],n),a=xs(t,[0,G9(r[1]||1)],n),s=xs(t,[r[0]/Gf(i),r[1]/Gf(a)],n);return Ra(e,s)}function yh(t,e,r){return r?"".concat(t/e*100,"%"):"".concat(t,"px")}function aE(t){return rn(t)<=bc?0:t}function YO(t){return function(e){if(!e.isDragging(t))return"";var r=Fbe(e,t),n=r.deg;return n?yi("view-control-rotation".concat(n)):""}}function ZO(t,e){return e===void 0&&(e=[t]),function(r,n){if(n.isRequest)return e.some(function(a){return n.requestAble===a})?n.parentDirection:!1;var i=n.inputEvent.target;return Bl(i,yi("direction"))&&(!t||Bl(i,yi(t)))}}function Yxe(t,e,r){var n,i=j0(t,{"x%":function(U){return U/100*e.offsetWidth},"y%":function(U){return U/100*e.offsetHeight}}),a=t.slice(0,r<0?void 0:r),s=t.slice(0,r<0?void 0:r+1),o=t[r]||"",c=r<0?[]:t.slice(r),f=r<0?[]:t.slice(r+1),d=i.slice(0,r<0?void 0:r),m=i.slice(0,r<0?void 0:r+1),b=(n=i[r])!==null&&n!==void 0?n:j0([""])[0],x=r<0?[]:i.slice(r),E=r<0?[]:i.slice(r+1),T=b?[b]:[],A=Nv(d),R=Nv(m),F=Nv(x),N=Nv(E),O=So(A,F,4);return{transforms:t,beforeFunctionMatrix:A,beforeFunctionMatrix2:R,targetFunctionMatrix:Nv(T),afterFunctionMatrix:F,afterFunctionMatrix2:N,allFunctionMatrix:O,beforeFunctions:d,beforeFunctions2:m,targetFunction:T[0],afterFunctions:x,afterFunctions2:E,beforeFunctionTexts:a,beforeFunctionTexts2:s,targetFunctionText:o,afterFunctionTexts:c,afterFunctionTexts2:f}}function Zxe(t){return!t||!Ch(t)||PO(t)?!1:su(t)||"length"in t}function vd(t,e){return t?PO(t)?t:Ap(t)?e?document.querySelector(t):t:EO(t)?t():RZ(t)?t:"current"in t?t.current:t:null}function KO(t,e){if(!t)return[];var r=Zxe(t)?[].slice.call(t):[t];return r.reduce(function(n,i){return Ap(i)&&e?yn(yn([],Zt(n),!1),Zt([].slice.call(document.querySelectorAll(i))),!1):(su(i)?n.push(KO(i,e)):n.push(vd(i,e)),n)},[])}function Kxe(t,e,r){var n=al(t,e)/Math.PI*180;return n=r>=0?n:180-n,n=n>=0?n:360+n,n}function K9(t,e){var r=t.rootMatrix,n=t.is3d,i=n?4:3,a=wd(r,i);return n||(a=Ah(a,3,4)),a[12]=0,a[13]=0,a[14]=0,C1e(a,e)}function OK(t,e,r,n,i){var a=Zt(t,2),s=a[0],o=a[1],c=0,f=0;if(i&&s&&o){var d=al([0,0],e),m=al([0,0],n),b=Gf(e),x=Math.cos(d-m)*b;if(!n[0])f=x,c=f*r;else if(!n[1])c=x,f=c/r;else{var E=n[0]*s,T=n[1]*o,A=Math.atan2(E+e[0],T+e[1]),R=Math.atan2(E,T);A<0&&(A+=Math.PI*2),R<0&&(R+=Math.PI*2);var F=0;rn(A-R)<Math.PI/2||rn(A-R)>Math.PI/2*3||(R+=Math.PI),F=A-R,F>Math.PI*2?F-=Math.PI*2:F>Math.PI?F=2*Math.PI-F:F<-Math.PI&&(F=-2*Math.PI-F);var N=Gf([E+e[0],T+e[1]])*Math.cos(F);c=N*Math.sin(R)-E,f=N*Math.cos(R)-T,n[0]<0&&(c*=-1),n[1]<0&&(f*=-1)}}else c=n[0]*e[0],f=n[1]*e[1];return[c,f]}function LK(t,e,r,n){var i,a=r.ratio,s=r.startOffsetWidth,o=r.startOffsetHeight,c=0,f=0,d=n.distX,m=n.distY,b=n.pinchScale,x=n.parentDistance,E=n.parentDist,T=n.parentScale,A=r.fixedDirection,R=[0,1].map(function(H){return rn(t[H]-A[H])}),F=[0,1].map(function(H){var W=R[H];return W!==0&&(W=2/W),W});if(E)c=E[0],f=E[1],e&&(c?f||(f=c/a):c=f*a);else if(jb(b))c=(b-1)*s,f=(b-1)*o;else if(T)c=(T[0]-1)*s,f=(T[1]-1)*o;else if(x){var N=s*R[0],O=o*R[1],U=Gf([N,O]);c=x/U*N*F[0],f=x/U*O*F[1]}else{var j=Pd({datas:r,distX:d,distY:m});j=F.map(function(H,W){return j[W]*H}),i=Zt(OK([s,o],j,a,t,e),2),c=i[0],f=i[1]}return{distWidth:c,distHeight:f}}function Ak(t,e){if(e){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};var r=Zt(t.split(" "),2),n=r[0],i=r[1],a=Ak(n||""),s=Ak(i||""),o=Wt(Wt({},a),s),c={x:"50%",y:"50%"};return o.x&&(c.x=o.x),o.y&&(c.y=o.y),o.value&&(o.x&&!o.y&&(c.y=o.value),!o.x&&o.y&&(c.x=o.value)),c}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function JO(t,e,r){var n=Ak(t,!0),i=n.x,a=n.y;return[wo(i,e)||0,wo(a,r)||0]}function Jxe(t,e,r){var n=t.map(function(a){return _i(a,e)}),i=n.map(function(a){return Ox(a,r)});return{prev:n,next:i,result:i.map(function(a){return Ra(a,e)})}}function NK(t,e){return t.length===e.length&&t.every(function(r,n){var i=e[n],a=su(r),s=su(i);return a&&s?NK(r,i):!a&&!s?r===i:!1})}function u0(t,e,r,n,i){var a=t._store,s=a[e];if(!(e in a))if(i!=null)a[e]=i,s=i;else return a[e]=r,r;return s===r||n(s)===n(r)?s:(a[e]=r,r)}function mc(t){return t>=0?1:-1}function rn(t){return Math.abs(t)}function n5(t,e){return p1e(t).map(function(r){return e(r)})}function FK(t){return jb(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var Qxe=Fx("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,e){var r=e.datas,n=e.targets,i=e.angle,a=e.originalDatas,s=t.props,o=s.pinchable,c=s.ables;if(!o)return!1;var f="onPinch".concat(n?"Group":"","Start"),d="drag".concat(n?"Group":"","ControlStart"),m=(o===!0?t.controlAbles:c.filter(function(T){return o.indexOf(T.name)>-1})).filter(function(T){return T.canPinch&&T[d]}),b=Ki(t,e,{});n&&(b.targets=n);var x=Wn(t,f,b);r.isPinch=x!==!1,r.ables=m;var E=r.isPinch;return E?(m.forEach(function(T){if(a[T.name]=a[T.name]||{},!!T[d]){var A=Wt(Wt({},e),{datas:a[T.name],parentRotate:i,isPinch:!0});T[d](t,A)}}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},E):!1},pinch:function(t,e){var r=e.datas,n=e.scale,i=e.distance,a=e.originalDatas,s=e.inputEvent,o=e.targets,c=e.angle;if(r.isPinch){var f=i*(1-1/n),d=Ki(t,e,{});o&&(d.targets=o);var m="onPinch".concat(o?"Group":"");Wn(t,m,d);var b=r.ables,x="drag".concat(o?"Group":"","Control");return b.forEach(function(E){E[x]&&E[x](t,Wt(Wt({},e),{datas:a[E.name],inputEvent:s,resolveMatrix:!0,pinchScale:n,parentDistance:f,parentRotate:c,isPinch:!0}))}),d}},pinchEnd:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.targets,s=e.originalDatas;if(r.isPinch){var o="onPinch".concat(a?"Group":"","End"),c=hf(t,e,{isDrag:n});a&&(c.targets=a),Wn(t,o,c);var f=r.ables,d="drag".concat(a?"Group":"","ControlEnd");return f.forEach(function(m){m[d]&&m[d](t,Wt(Wt({},e),{isDrag:n,datas:s[m.name],inputEvent:i,isPinch:!0}))}),n}},pinchGroupStart:function(t,e){return this.pinchStart(t,Wt(Wt({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,Wt(Wt({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,Wt(Wt({},e),{targets:t.props.targets}))}}),J9=ZO("scalable"),e2e={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:nK("scalable"),dragControlCondition:J9,viewClassName:YO("scalable"),dragControlStart:function(t,e){var r=e.datas,n=e.isPinch,i=e.inputEvent,a=e.parentDirection,s=PK(a,n,i,r),o=t.state,c=o.width,f=o.height,d=o.targetTransform,m=o.target,b=o.pos1,x=o.pos2,E=o.pos4;if(!s||!m)return!1;n||by(t,e),r.datas={},r.transform=d,r.prevDist=[1,1],r.direction=s,r.startOffsetWidth=c,r.startOffsetHeight=f,r.startValue=[1,1];var T=!s[0]&&!s[1]||s[0]||!s[1];i3(t,e,"scale"),r.isWidth=T;function A(j){r.ratio=j&&isFinite(j)?j:0}r.startPositions=Wf(t.state);function R(j){var H=gK(r.startPositions,j);r.fixedDirection=H.fixedDirection,r.fixedPosition=H.fixedPosition,r.fixedOffset=H.fixedOffset}r.setFixedDirection=R,A(hp(b,x)/hp(x,E)),R([-s[0],-s[1]]);var F=function(j){r.minScaleSize=j},N=function(j){r.maxScaleSize=j};F([-1/0,-1/0]),N([1/0,1/0]);var O=Ki(t,e,Wt(Wt({direction:s,set:function(j){r.startValue=j},setRatio:A,setFixedDirection:R,setMinScaleSize:F,setMaxScaleSize:N},n3(t,e)),{dragStart:gc.dragStart(t,new U0().dragStart([0,0],e))})),U=Wn(t,"onScaleStart",O);return r.startFixedDirection=r.fixedDirection,U!==!1&&(r.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:s}),r.isScale?O:!1},dragControl:function(t,e){t3(t,e,"scale");var r=e.datas,n=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,s=e.dragClient,o=e.isRequest,c=e.useSnap,f=e.resolveMatrix,d=r.prevDist,m=r.direction,b=r.startOffsetWidth,x=r.startOffsetHeight,E=r.isScale,T=r.startValue,A=r.isWidth,R=r.ratio;if(!E)return!1;var F=t.props,N=F.throttleScale,O=F.parentMoveable,U=m;!m[0]&&!m[1]&&(U=[1,1]);var j=R&&(n??F.keepRatio)||!1,H=t.state,W=[T[0],T[1]];function X(){var it=LK(U,j,r,e),Me=it.distWidth,zt=it.distHeight,st=b?(b+Me)/b:1,$e=x?(x+zt)/x:1;T[0]||(W[0]=Me/b),T[1]||(W[1]=zt/x);var Jt=(U[0]||j?st:1)*W[0],Ht=(U[1]||j?$e:1)*W[1];return Jt===0&&(Jt=mc(d[0])*uw),Ht===0&&(Ht=mc(d[1])*uw),[Jt,Ht]}var oe=X();if(!a&&t.props.groupable){var ee=H.snapRenderInfo||{},G=ee.direction;su(G)&&(G[0]||G[1])&&(H.snapRenderInfo={direction:m,request:e.isRequest})}Wn(t,"onBeforeScale",Ki(t,e,{scale:oe,setFixedDirection:function(it){return r.setFixedDirection(it),oe=X(),oe},startFixedDirection:r.startFixedDirection,setScale:function(it){oe=it}},!0));var ae=[oe[0]/W[0],oe[1]/W[1]],se=s,fe=[0,0],pe=mc(ae[0]*ae[1]),De=!s&&!i&&a;if(De||f?se=zO(t,r.targetAllTransform,[0,0],[0,0],r):s||(se=r.fixedPosition),a||(fe=kxe(t,ae,m,!c&&o,r)),j){U[0]&&U[1]&&fe[0]&&fe[1]&&(Math.abs(fe[0]*b)>Math.abs(fe[1]*x)?fe[1]=0:fe[0]=0);var ye=!fe[0]&&!fe[1];if(ye&&(A?ae[0]=Fi(ae[0]*W[0],N)/W[0]:ae[1]=Fi(ae[1]*W[1],N)/W[1]),U[0]&&!U[1]||fe[0]&&!fe[1]||ye&&A){ae[0]+=fe[0];var we=b*ae[0]*W[0]/R;ae[1]=mc(pe*ae[0])*rn(we/x/W[1])}else if(!U[0]&&U[1]||!fe[0]&&fe[1]||ye&&!A){ae[1]+=fe[1];var Te=x*ae[1]*W[1]*R;ae[0]=mc(pe*ae[1])*rn(Te/b/W[0])}}else ae[0]+=fe[0],ae[1]+=fe[1],fe[0]||(ae[0]=Fi(ae[0]*W[0],N)/W[0]),fe[1]||(ae[1]=Fi(ae[1]*W[1],N)/W[1]);ae[0]===0&&(ae[0]=mc(d[0])*uw),ae[1]===0&&(ae[1]=mc(d[1])*uw),oe=Lxe(ae,[W[0],W[1]]);var Re=[b,x],de=[b*oe[0],x*oe[1]];de=PZ(de,r.minScaleSize,r.maxScaleSize,j?R:!1),oe=n5(2,function(it){return Re[it]?de[it]/Re[it]:de[it]}),ae=n5(2,function(it){return oe[it]/W[it]});var Ee=n5(2,function(it){return d[it]?ae[it]/d[it]:ae[it]}),xe="scale(".concat(ae.join(", "),")"),Ne="scale(".concat(oe.join(", "),")"),Fe=r3(r,Ne,xe),Xe=!T[0]||!T[1],Be=kbe(t,Xe?Ne:xe,r.fixedDirection,se,r.fixedOffset,r,Xe),ot=De?Be:_i(Be,r.prevInverseDist||[0,0]);if(r.prevDist=ae,r.prevInverseDist=Be,oe[0]===d[0]&&oe[1]===d[1]&&ot.every(function(it){return!it})&&!O&&!De)return!1;var Ke=Ki(t,e,Wt({offsetWidth:b,offsetHeight:x,direction:m,scale:oe,dist:ae,delta:Ee,isPinch:!!a},KZ(t,Fe,ot,a,e)));return Wn(t,"onScale",Ke),Ke},dragControlEnd:function(t,e){var r=e.datas;if(!r.isScale)return!1;r.isScale=!1;var n=hf(t,e,{});return Wn(t,"onScaleEnd",n),n},dragGroupControlCondition:J9,dragGroupControlStart:function(t,e){var r=e.datas,n=this.dragControlStart(t,e);if(!n)return!1;var i=Eh(t,"resizable",e);r.moveableScale=t.scale;var a=dp(t,this,"dragControlStart",e,function(f,d){return eE(t,f,r,d)}),s=function(f){n.setFixedDirection(f),a.forEach(function(d,m){d.setFixedDirection(f),eE(t,d.moveable,r,i[m])})};r.setFixedDirection=s;var o=Wt(Wt({},n),{targets:t.props.targets,events:a,setFixedDirection:s}),c=Wn(t,"onScaleGroupStart",o);return r.isScale=c!==!1,r.isScale?o:!1},dragGroupControl:function(t,e){var r=e.datas;if(r.isScale){u3(t,"onBeforeScale",function(d){Wn(t,"onBeforeScaleGroup",Ki(t,e,Wt(Wt({},d),{targets:t.props.targets}),!0))});var n=this.dragControl(t,e);if(n){var i=n.dist,a=r.moveableScale;t.scale=[i[0]*a[0],i[1]*a[1]];var s=t.props.keepRatio,o=r.fixedPosition,c=dp(t,this,"dragControl",e,function(d,m){var b=Zt(rc(Lx(t.rotation/180*Math.PI,3),[m.datas.originalX*i[0],m.datas.originalY*i[1],1],3),2),x=b[0],E=b[1];return Wt(Wt({},m),{parentDist:null,parentScale:i,parentKeepRatio:s,dragClient:Ra(o,[x,E])})}),f=Wt({targets:t.props.targets,events:c},n);return Wn(t,"onScaleGroup",f),f}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isScale){this.dragControlEnd(t,e);var i=dp(t,this,"dragControlEnd",e),a=hf(t,e,{targets:t.props.targets,events:i});return Wn(t,"onScaleGroupEnd",a),r}},request:function(){var t={},e=0,r=0,n=!1;return{isControl:!0,requestStart:function(i){return n=i.useSnap,{datas:t,parentDirection:i.direction||[1,1],useSnap:n}},request:function(i){return e+=i.deltaWidth,r+=i.deltaHeight,{datas:t,parentDist:[e,r],parentKeepRatio:i.keepRatio,useSnap:n}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:n}}}}};function Kp(t,e){return t.map(function(r,n){return ZS(r,e[n],1,2)})}function Q9(t,e,r){var n=al(t,e),i=al(t,r),a=i-n;return a>=0?a:a+2*Math.PI}function t2e(t,e){var r=Q9(t[0],t[1],t[2]),n=Q9(e[0],e[1],e[2]),i=Math.PI;return!(r>=i&&n<=i||r<=i&&n>=i)}var r2e={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:YO("warpable"),render:function(t,e){var r=t.props,n=r.resizable,i=r.scalable,a=r.warpable,s=r.zoom;if(n||i||!a)return[];var o=t.state,c=o.pos1,f=o.pos2,d=o.pos3,m=o.pos4,b=Kp(c,f),x=Kp(f,c),E=Kp(c,d),T=Kp(d,c),A=Kp(d,m),R=Kp(m,d),F=Kp(f,m),N=Kp(m,f);return yn([e.createElement("div",{className:yi("line"),key:"middeLine1",style:N1(b,A,s)}),e.createElement("div",{className:yi("line"),key:"middeLine2",style:N1(x,R,s)}),e.createElement("div",{className:yi("line"),key:"middeLine3",style:N1(E,F,s)}),e.createElement("div",{className:yi("line"),key:"middeLine4",style:N1(T,N,s)})],Zt(iK(t,"warpable",e)),!1)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var r=e.inputEvent.target;return Bl(r,yi("direction"))&&Bl(r,yi("warpable"))},dragControlStart:function(t,e){var r=e.datas,n=e.inputEvent,i=t.props.target,a=n.target,s=MK(a,r);if(!s||!i)return!1;var o=t.state,c=o.transformOrigin,f=o.is3d,d=o.targetTransform,m=o.targetMatrix,b=o.width,x=o.height,E=o.left,T=o.top;r.datas={},r.targetTransform=d,r.warpTargetMatrix=f?m:Ah(m,3,4),r.targetInverseMatrix=DZ(wd(r.warpTargetMatrix,4),3,4),r.direction=s,r.left=E,r.top=T,r.poses=[[0,0],[b,0],[0,x],[b,x]].map(function(F){return _i(F,c)}),r.nextPoses=r.poses.map(function(F){var N=Zt(F,2),O=N[0],U=N[1];return rc(r.warpTargetMatrix,[O,U,0,1],4)}),r.startValue=Qo(4),r.prevMatrix=Qo(4),r.absolutePoses=Wf(o),r.posIndexes=ZZ(s),by(t,e),i3(t,e,"matrix3d"),o.snapRenderInfo={request:e.isRequest,direction:s};var A=Ki(t,e,Wt({set:function(F){r.startValue=F}},n3(t,e))),R=Wn(t,"onWarpStart",A);return R!==!1&&(r.isWarp=!0),r.isWarp},dragControl:function(t,e){var r=e.datas,n=e.isRequest,i=e.distX,a=e.distY,s=r.targetInverseMatrix,o=r.prevMatrix,c=r.isWarp,f=r.startValue,d=r.poses,m=r.posIndexes,b=r.absolutePoses;if(!c)return!1;if(t3(t,e,"matrix3d"),y_(t,"warpable")){var x=m.map(function(X){return b[X]});x.length>1&&x.push([(x[0][0]+x[1][0])/2,(x[0][1]+x[1][1])/2]);var E=s3(t,n,{horizontal:x.map(function(X){return X[1]+a}),vertical:x.map(function(X){return X[0]+i})}),T=E.horizontal,A=E.vertical;a-=T.offset,i-=A.offset}var R=Pd({datas:r,distX:i,distY:a},!0),F=r.nextPoses.slice();if(m.forEach(function(X){F[X]=Ra(F[X],R)}),!bbe.every(function(X){return t2e(X.map(function(oe){return d[oe]}),X.map(function(oe){return F[oe]}))}))return!1;var N=kO(d[0],d[2],d[1],d[3],F[0],F[2],F[1],F[3]);if(!N.length)return!1;var O=So(s,N,4),U=XZ(r,O,!0),j=So(wd(o,4),U,4);r.prevMatrix=U;var H=So(f,U,4),W=r3(r,"matrix3d(".concat(H.join(", "),")"),"matrix3d(".concat(U.join(", "),")"));return BO(e,W),Wn(t,"onWarp",Ki(t,e,Wt({delta:j,matrix:H,dist:U,multiply:So,transform:W},yc({transform:W},e)))),!0},dragControlEnd:function(t,e){var r=e.datas,n=e.isDrag;return r.isWarp?(r.isWarp=!1,Wn(t,"onWarpEnd",hf(t,e,{})),n):!1}},n2e=yi("area-pieces"),gw=yi("area-piece"),BK=yi("avoid"),i2e=yi("view-dragging");function i5(t){var e=t.areaElement;if(e){var r=t.state,n=r.width,i=r.height;kZ(e,BK),e.style.cssText+="left: 0px; top: 0px; width: ".concat(n,"px; height: ").concat(i,"px")}}function ej(t){return t.createElement("div",{key:"area_pieces",className:n2e},t.createElement("div",{className:gw}),t.createElement("div",{className:gw}),t.createElement("div",{className:gw}),t.createElement("div",{className:gw}))}var zK={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,e){var r=t.props,n=r.target,i=r.dragArea,a=r.groupable,s=r.passDragArea,o=t.getState(),c=o.width,f=o.height,d=o.renderPoses,m=s?yi("area","pass"):yi("area");if(a)return[e.createElement("div",{key:"area",ref:zm(t,"areaElement"),className:m}),ej(e)];if(!n||!i)return[];var b=kO([0,0],[c,0],[0,f],[c,f],d[0],d[1],d[2],d[3]),x=b.length?l3(b,!0):"none";return[e.createElement("div",{key:"area",ref:zm(t,"areaElement"),className:m,style:{top:"0px",left:"0px",width:"".concat(c,"px"),height:"".concat(f,"px"),transformOrigin:"0 0",transform:x}}),ej(e)]},dragStart:function(t,e){var r=e.datas,n=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;r.isDragArea=!1;var s=t.areaElement,o=t.state,c=o.moveableClientRect,f=o.renderPoses,d=o.rootMatrix,m=o.is3d,b=c.left,x=c.top,E=Ff(f),T=E.left,A=E.top,R=E.width,F=E.height,N=m?4:3,O=Zt(q0(d,[n-b,i-x],N),2),U=O[0],j=O[1];U-=T,j-=A;var H=[{left:T,top:A,width:R,height:j-10},{left:T,top:A,width:U-10,height:F},{left:T,top:A+j+10,width:R,height:F-j-10},{left:T+U+10,top:A,width:R-U-10,height:F}],W=[].slice.call(s.nextElementSibling.children);H.forEach(function(X,oe){W[oe].style.cssText="left: ".concat(X.left,"px;top: ").concat(X.top,"px; width: ").concat(X.width,"px; height: ").concat(X.height,"px;")}),MZ(s,BK),o.disableNativeEvent=!0},drag:function(t,e){var r=e.datas,n=e.inputEvent;if(this.enableNativeEvent(t),!n)return!1;r.isDragArea||(r.isDragArea=!0,i5(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var r=e.inputEvent,n=e.datas;if(!r)return!1;n.isDragArea||i5(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){i5(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&IZ(function(){e.disableNativeEvent=!1})}},a2e=Fx("origin",{props:["origin","svgOrigin"],render:function(t,e){var r=t.props,n=r.zoom,i=r.svgOrigin,a=r.groupable,s=t.getState(),o=s.beforeOrigin,c=s.rotation,f=s.svg,d=s.allMatrix,m=s.is3d,b=s.left,x=s.top,E=s.offsetWidth,T=s.offsetHeight,A;if(!a&&f&&i){var R=Zt(JO(i,E,T),2),F=R[0],N=R[1],O=m?4:3,U=xs(d,[F,N],O);A=iE(c,n,_i(U,[b,x]))}else A=iE(c,n,o);return[e.createElement("div",{className:yi("control","origin"),style:A,key:"beforeOrigin"})]}});function o2e(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var s2e={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,e){var r=t.props,n=r.scrollContainer,i=n===void 0?t.getContainer():n,a=r.scrollOptions,s=new z1e,o=vd(i,!0);e.datas.dragScroll=s,t.state.dragScroll=s;var c=e.isControl?"controlGesto":"targetGesto",f=e.targets;s.on("scroll",function(d){var m=d.container,b=d.direction,x=Ki(t,e,{scrollContainer:m,direction:b}),E=f?"onScrollGroup":"onScroll";f&&(x.targets=f),Wn(t,E,x)}).on("move",function(d){var m=d.offsetX,b=d.offsetY,x=d.inputEvent;t[c].scrollBy(m,b,x.inputEvent,!1)}).on("scrollDrag",function(d){var m=d.next;m(t[c].getCurrentEvent())}),s.dragStart(e,Wt({container:o},a))},checkScroll:function(t,e){var r=e.datas.dragScroll;if(r){var n=t.props,i=n.scrollContainer,a=i===void 0?t.getContainer():i,s=n.scrollThreshold,o=s===void 0?0:s,c=n.scrollThrottleTime,f=c===void 0?0:c,d=n.getScrollPosition,m=d===void 0?o2e:d,b=n.scrollOptions;return r.drag(e,Wt({container:a,threshold:o,throttleTime:f,getScrollPosition:function(x){return m({scrollContainer:x.container,direction:x.direction})}},b)),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,Wt(Wt({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,Wt(Wt({},e),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,e){return this.drag(t,Wt(Wt({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,Wt(Wt({},e),{targets:t.props.targets}))},unset:function(t){var e,r=t.state;(e=r.dragScroll)===null||e===void 0||e.dragEnd(),r.dragScroll=null}},jK={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},l2e=Fx("padding",{props:["padding"],render:function(t,e){var r=t.props;if(r.dragArea)return[];var n=FK(r.padding||{}),i=n.left,a=n.top,s=n.right,o=n.bottom,c=t.getState(),f=c.renderPoses,d=c.pos1,m=c.pos2,b=c.pos3,x=c.pos4,E=[d,m,b,x],T=[];return i>0&&T.push([0,2]),a>0&&T.push([0,1]),s>0&&T.push([1,3]),o>0&&T.push([2,3]),T.map(function(A,R){var F=Zt(A,2),N=F[0],O=F[1],U=E[N],j=E[O],H=f[N],W=f[O],X=kO([0,0],[100,0],[0,100],[100,100],U,j,H,W);if(X.length)return e.createElement("div",{key:"padding".concat(R),className:yi("padding"),style:{transform:l3(X,!0)}})})}}),tj=["nw","ne","se","sw"];function mw(t,e){var r=t[0]+t[1],n=r>e?e/r:1;return t[0]*=n,t[1]=e-t[1]*n,t}var u2e=[1,2,5,6],c2e=[0,3,4,7],Tm=[1,-1,-1,1],Cm=[1,1,-1,-1];function QO(t,e,r,n,i,a,s,o){i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=r),o===void 0&&(o=n);var c=[],f=!1,d=t.filter(function(b){return!b.virtual}),m=d.map(function(b){var x=b.horizontal,E=b.vertical,T=b.pos;if(E&&!f&&(f=!0,c.push("/")),f){var A=Math.max(0,E===1?T[1]-a:o-T[1]);return c.push(yh(A,n,e)),A}else{var A=Math.max(0,x===1?T[0]-i:s-T[0]);return c.push(yh(A,r,e)),A}});return{radiusPoses:d,styles:c,raws:m}}function UK(t){for(var e=[0,0],r=[0,0],n=t.length,i=0;i<n;++i){var a=t[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,r[0]=i+1),a.vertical&&(r[1]===0&&(r[0]=i),r[1]=i-r[0]+1))}return{horizontalRange:e,verticalRange:r}}function VK(t,e,r,n,i,a,s){var o,c,f,d;a===void 0&&(a=[0,0]),s===void 0&&(s=!1);var m=t.indexOf("/"),b=(m>-1?t.slice(0,m):t).length,x=t.slice(0,b),E=t.slice(b+1),T=x.length,A=E.length,R=A>0,F=Zt(x,4),N=F[0],O=N===void 0?"0px":N,U=F[1],j=U===void 0?O:U,H=F[2],W=H===void 0?O:H,X=F[3],oe=X===void 0?j:X,ee=Zt(E,4),G=ee[0],ae=G===void 0?O:G,se=ee[1],fe=se===void 0?R?ae:j:se,pe=ee[2],De=pe===void 0?R?ae:W:pe,ye=ee[3],we=ye===void 0?R?fe:oe:ye,Te=[O,j,W,oe].map(function(Fe){return wo(Fe,e)}),Re=[ae,fe,De,we].map(function(Fe){return wo(Fe,r)}),de=Te.slice(),Ee=Re.slice();o=Zt(mw([de[0],de[1]],e),2),de[0]=o[0],de[1]=o[1],c=Zt(mw([de[3],de[2]],e),2),de[3]=c[0],de[2]=c[1],f=Zt(mw([Ee[0],Ee[3]],r),2),Ee[0]=f[0],Ee[3]=f[1],d=Zt(mw([Ee[1],Ee[2]],r),2),Ee[1]=d[0],Ee[2]=d[1];var xe=s?de:de.slice(0,Math.max(a[0],T)),Ne=s?Ee:Ee.slice(0,Math.max(a[1],A));return yn(yn([],Zt(xe.map(function(Fe,Xe){var Be=tj[Xe];return{virtual:Xe>=T,horizontal:Tm[Xe],vertical:0,pos:[n+Fe,i+(Cm[Xe]===-1?r:0)],sub:!0,raw:Te[Xe],direction:Be}})),!1),Zt(Ne.map(function(Fe,Xe){var Be=tj[Xe];return{virtual:Xe>=A,horizontal:0,vertical:Cm[Xe],pos:[n+(Tm[Xe]===-1?e:0),i+Fe],sub:!0,raw:Re[Xe],direction:Be}})),!1)}function f2e(t,e,r,n,i){i===void 0&&(i=e.length);var a=UK(t.slice(n)),s=a.horizontalRange,o=a.verticalRange,c=r-n,f=0;if(c===0)f=i;else if(c>0&&c<s[1])f=s[1]-c;else if(c>=o[0])f=o[0]+o[1]-c;else return;t.splice(r,f),e.splice(r,f)}function h2e(t,e,r,n,i,a,s,o,c,f,d){f===void 0&&(f=0),d===void 0&&(d=0);var m=UK(t.slice(r)),b=m.horizontalRange,x=m.verticalRange;if(n>-1)for(var E=Tm[n]===1?a-f:o-a,T=b[1];T<=n;++T){var A=Cm[T]===1?d:c,R=0;if(n===T?R=a:T===0?R=f+E:Tm[T]===-1&&(R=o-(e[r][0]-f)),t.splice(r+T,0,{horizontal:Tm[T],vertical:0,pos:[R,A]}),e.splice(r+T,0,[R,A]),T===0)break}else if(i>-1){var F=Cm[i]===1?s-d:c-s;if(b[1]===0&&x[1]===0){var N=[f+F,d];t.push({horizontal:Tm[0],vertical:0,pos:N}),e.push(N)}for(var O=x[0],T=x[1];T<=i;++T){var R=Tm[T]===1?f:o,A=0;if(i===T?A=s:T===0?A=d+F:Cm[T]===1?A=e[r+O][1]:Cm[T]===-1&&(A=c-(e[r+O][1]-d)),t.push({horizontal:0,vertical:Cm[T],pos:[R,A]}),e.push([R,A]),T===0)break}}}function d2e(t,e){e===void 0&&(e=t.map(function(i){return i.raw}));var r=t.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),n=t.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:r,verticals:n}}var p2e=[[0,-1,"n"],[1,0,"e"]],g2e=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function eL(t,e,r){var n=t.props.clipRelative,i=t.state,a=i.width,s=i.height,o=e,c=o.type,f=o.poses,d=c==="rect",m=c==="circle";if(c==="polygon")return r.map(function(j){return"".concat(yh(j[0],a,n)," ").concat(yh(j[1],s,n))});if(d||c==="inset"){var b=r[1][1],x=r[3][0],E=r[7][0],T=r[5][1];if(d)return[b,x,T,E].map(function(j){return"".concat(j,"px")});var A=[b,a-x,s-T,E].map(function(j,H){return yh(j,H%2?a:s,n)});if(r.length>8){var R=Zt(_i(r[4],r[0]),2),F=R[0],N=R[1];A.push.apply(A,yn(["round"],Zt(QO(f.slice(8).map(function(j,H){return Wt(Wt({},j),{pos:r[H]})}),n,F,N,E,b,x,T).styles),!1))}return A}else if(m||c==="ellipse"){var O=r[0],U=yh(rn(r[1][1]-O[1]),m?Math.sqrt((a*a+s*s)/2):s,n),A=m?[U]:[yh(rn(r[2][0]-O[0]),a,n),U];return A.push("at",yh(O[0],a,n),yh(O[1],s,n)),A}}function oE(t,e,r,n){var i=[n,(n+e)/2,e],a=[t,(t+r)/2,r];return g2e.map(function(s){var o=Zt(s,3),c=o[0],f=o[1],d=o[2],m=i[c+1],b=a[f+1];return{vertical:rn(f),horizontal:rn(c),direction:d,pos:[m,b]}})}function $K(t){var e=[1/0,-1/0],r=[1/0,-1/0];return t.forEach(function(n){var i=n.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),r[0]=Math.min(r[0],i[1]),r[1]=Math.max(r[1],i[1])}),[rn(e[1]-e[0]),rn(r[1]-r[0])]}function rj(t,e,r,n,i){var a,s,o,c,f,d,m,b,x;if(t){var E=i;if(!E){var T=Lc(t),A=T("clipPath");E=A!=="none"?A:T("clip")}if(!((!E||E==="none"||E==="auto")&&(E=n,!E))){var R=AZ(E),F=R.prefix,N=F===void 0?E:F,O=R.value,U=O===void 0?"":O,j=N==="circle",H=" ";if(N==="polygon"){var W=Mm(U||"0% 0%, 100% 0%, 100% 100%, 0% 100%");H=",";var X=W.map(function(br){var lr=Zt(br.split(" "),2),Cr=lr[0],Tr=lr[1];return{vertical:1,horizontal:1,pos:[wo(Cr,e),wo(Tr,r)]}}),oe=Qm(X.map(function(br){return br.pos}));return{type:N,clipText:E,poses:X,splitter:H,left:oe.minX,right:oe.maxX,top:oe.minY,bottom:oe.maxY}}else if(j||N==="ellipse"){var ee="",G="",ae=0,se=0,W=Ag(U);if(j){var fe="";a=Zt(W,4),s=a[0],fe=s===void 0?"50%":s,o=a[2],ee=o===void 0?"50%":o,c=a[3],G=c===void 0?"50%":c,ae=wo(fe,Math.sqrt((e*e+r*r)/2)),se=ae}else{var pe="",De="";f=Zt(W,5),d=f[0],pe=d===void 0?"50%":d,m=f[1],De=m===void 0?"50%":m,b=f[3],ee=b===void 0?"50%":b,x=f[4],G=x===void 0?"50%":x,ae=wo(pe,e),se=wo(De,r)}var ye=[wo(ee,e),wo(G,r)],X=yn([{vertical:1,horizontal:1,pos:ye,direction:"nesw"}],Zt(p2e.slice(0,j?1:2).map(function(Cr){return{vertical:rn(Cr[1]),horizontal:Cr[0],direction:Cr[2],sub:!0,pos:[ye[0]+Cr[0]*ae,ye[1]+Cr[1]*se]}})),!1);return{type:N,clipText:E,radiusX:ae,radiusY:se,left:ye[0]-ae,top:ye[1]-se,right:ye[0]+ae,bottom:ye[1]+se,poses:X,splitter:H}}else if(N==="inset"){var W=Ag(U||"0 0 0 0"),we=W.indexOf("round"),Te=(we>-1?W.slice(0,we):W).length,Re=W.slice(Te+1),de=Zt(W.slice(0,Te),4),Ee=de[0],xe=de[1],Ne=xe===void 0?Ee:xe,Fe=de[2],Xe=Fe===void 0?Ee:Fe,Be=de[3],ot=Be===void 0?Ne:Be,Ke=Zt([Ee,Xe].map(function(Cr){return wo(Cr,r)}),2),it=Ke[0],Me=Ke[1],zt=Zt([ot,Ne].map(function(Cr){return wo(Cr,e)}),2),st=zt[0],$e=zt[1],Jt=e-$e,Ht=r-Me,pr=VK(Re,Jt-st,Ht-it,st,it),X=yn(yn([],Zt(oE(it,Jt,Ht,st)),!1),Zt(pr),!1);return{type:"inset",clipText:E,poses:X,top:it,left:st,right:Jt,bottom:Ht,radius:Re,splitter:H}}else if(N==="rect"){var W=Mm(U||"0px, ".concat(e,"px, ").concat(r,"px, 0px"));H=",";var _t=Zt(W.map(function(at){var Pe=Dx(at).value;return Pe}),4),vr=_t[0],$e=_t[1],Me=_t[2],st=_t[3],X=oE(vr,$e,Me,st);return{type:"rect",clipText:E,poses:X,top:vr,right:$e,bottom:Me,left:st,values:W,splitter:H}}}}}function m2e(t,e,r,n,i){var a=t[e],s=a.direction,o=a.sub,c=t.map(function(){return[0,0]}),f=s?s.split(""):[];if(n&&e<8){var d=f.filter(function(ae){return ae==="w"||ae==="e"}),m=f.filter(function(ae){return ae==="n"||ae==="s"}),b=d[0],x=m[0];c[e]=r;var E=Zt($K(t),2),T=E[0],A=E[1],R=T&&A?T/A:0;if(R&&i){var F=(e+4)%8,N=t[F].pos,O=[0,0];s.indexOf("w")>-1?O[0]=-1:s.indexOf("e")>-1&&(O[0]=1),s.indexOf("n")>-1?O[1]=-1:s.indexOf("s")>-1&&(O[1]=1);var U=OK([T,A],r,R,O,!0),j=T+U[0],H=A+U[1],W=N[1],X=N[1],oe=N[0],ee=N[0];O[0]===-1?oe=ee-j:O[0]===1?ee=oe+j:(oe=oe-j/2,ee=ee+j/2),O[1]===-1?W=X-H:(O[1]===1||(W=X-H/2),X=W+H);var G=oE(W,ee,X,oe);t.forEach(function(ae,se){c[se][0]=G[se].pos[0]-ae.pos[0],c[se][1]=G[se].pos[1]-ae.pos[1]})}else t.forEach(function(ae,se){var fe=ae.direction;fe&&(fe.indexOf(b)>-1&&(c[se][0]=r[0]),fe.indexOf(x)>-1&&(c[se][1]=r[1]))}),b&&(c[1][0]=r[0]/2,c[5][0]=r[0]/2),x&&(c[3][1]=r[1]/2,c[7][1]=r[1]/2)}else s&&!o?f.forEach(function(ae){var se=ae==="n"||ae==="s";t.forEach(function(fe,pe){var De=fe.direction,ye=fe.horizontal,we=fe.vertical;!De||De.indexOf(ae)===-1||(c[pe]=[se||!ye?0:r[0],!se||!we?0:r[1]])})}):c[e]=r;return c}function y2e(t,e){var r=Zt(WZ(t,e),2),n=r[0],i=r[1],a=e.datas,s=a.clipPath,o=a.clipIndex,c=s,f=c.type,d=c.poses,m=c.splitter,b=d.map(function(F){return F.pos});if(f==="polygon")b.splice(o,0,[n,i]);else if(f==="inset"){var x=u2e.indexOf(o),E=c2e.indexOf(o),T=d.length;if(h2e(d,b,8,x,E,n,i,b[4][0],b[4][1],b[0][0],b[0][1]),T===d.length)return}else return;var A=eL(t,s,b),R="".concat(f,"(").concat(A.join(m),")");Wn(t,"onClip",Ki(t,e,Wt({clipEventType:"added",clipType:f,poses:b,clipStyles:A,clipStyle:R,distX:0,distY:0},yc({clipPath:R},e))))}function v2e(t,e){var r=e.datas,n=r.clipPath,i=r.clipIndex,a=n,s=a.type,o=a.poses,c=a.splitter,f=o.map(function(x){return x.pos}),d=f.length;if(s==="polygon")o.splice(i,1),f.splice(i,1);else if(s==="inset"){if(i<8||(f2e(o,f,i,8,d),d===o.length))return}else return;var m=eL(t,n,f),b="".concat(s,"(").concat(m.join(c),")");Wn(t,"onClip",Ki(t,e,Wt({clipEventType:"removed",clipType:s,poses:f,clipStyles:m,clipStyle:b,distX:0,distY:0},yc({clipPath:b},e))))}var _2e={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(t,e){var r=t.props,n=r.customClipPath,i=r.defaultClipPath,a=r.clipArea,s=r.zoom,o=r.groupable,c=t.getState(),f=c.target,d=c.width,m=c.height,b=c.allMatrix,x=c.is3d,E=c.left,T=c.top,A=c.pos1,R=c.pos2,F=c.pos3,N=c.pos4,O=c.clipPathState,U=c.snapBoundInfos,j=c.rotation;if(!f||o)return[];var H=rj(f,d,m,i||"inset",O||n);if(!H)return[];var W=x?4:3,X=H.type,oe=H.poses,ee=oe.map(function($e){var Jt=xs(b,$e.pos,W);return[Jt[0]-E,Jt[1]-T]}),G=[],ae=[],se=X==="rect",fe=X==="inset",pe=X==="polygon";if(se||fe||pe){var De=fe?ee.slice(0,8):ee;ae=De.map(function($e,Jt){var Ht=Jt===0?De[De.length-1]:De[Jt-1],pr=al(Ht,$e),_t=TK(Ht,$e);return e.createElement("div",{key:"clipLine".concat(Jt),className:yi("line","clip-line","snap-control"),"data-clip-index":Jt,style:{width:"".concat(_t,"px"),transform:"translate(".concat(Ht[0],"px, ").concat(Ht[1],"px) rotate(").concat(pr,"rad) scaleY(").concat(s,")")}})})}if(G=ee.map(function($e,Jt){return e.createElement("div",{key:"clipControl".concat(Jt),className:yi("control","clip-control","snap-control"),"data-clip-index":Jt,style:{transform:"translate(".concat($e[0],"px, ").concat($e[1],"px) rotate(").concat(j,"rad) scale(").concat(s,")")}})}),fe&&G.push.apply(G,yn([],Zt(ee.slice(8).map(function($e,Jt){return e.createElement("div",{key:"clipRadiusControl".concat(Jt),className:yi("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+Jt,style:{transform:"translate(".concat($e[0],"px, ").concat($e[1],"px) rotate(").concat(j,"rad) scale(").concat(s,")")}})})),!1)),X==="circle"||X==="ellipse"){var ye=H.left,we=H.top,Te=H.radiusX,Re=H.radiusY,de=Zt(_i(xs(b,[ye,we],W),xs(b,[0,0],W)),2),Ee=de[0],xe=de[1],Ne="none";if(!a){for(var Fe=Math.max(10,Te/5,Re/5),Xe=[],Be=0;Be<=Fe;++Be){var ot=Math.PI*2/Fe*Be;Xe.push([Te+(Te-s)*Math.cos(ot),Re+(Re-s)*Math.sin(ot)])}Xe.push([Te,-2]),Xe.push([-2,-2]),Xe.push([-2,Re*2+2]),Xe.push([Te*2+2,Re*2+2]),Xe.push([Te*2+2,-2]),Xe.push([Te,-2]),Ne="polygon(".concat(Xe.map(function($e){return"".concat($e[0],"px ").concat($e[1],"px")}).join(", "),")")}G.push(e.createElement("div",{key:"clipEllipse",className:yi("clip-ellipse","snap-control"),style:{width:"".concat(Te*2,"px"),height:"".concat(Re*2,"px"),clipPath:Ne,transform:"translate(".concat(-E+Ee,"px, ").concat(-T+xe,"px) ").concat(l3(b))}}))}if(a){var Ke=Ff(yn([A,R,F,N],Zt(ee),!1)),it=Ke.width,Me=Ke.height,zt=Ke.left,st=Ke.top;if(pe||se||fe){var Xe=fe?ee.slice(0,8):ee;G.push(e.createElement("div",{key:"clipArea",className:yi("clip-area","snap-control"),style:{width:"".concat(it,"px"),height:"".concat(Me,"px"),transform:"translate(".concat(zt,"px, ").concat(st,"px)"),clipPath:"polygon(".concat(Xe.map(function(Jt){return"".concat(Jt[0]-zt,"px ").concat(Jt[1]-st,"px")}).join(", "),")")}}))}}return U&&["vertical","horizontal"].forEach(function($e){var Jt=U[$e],Ht=$e==="horizontal";Jt.isSnap&&ae.push.apply(ae,yn([],Zt(Jt.snap.posInfos.map(function(pr,_t){var vr=pr.pos,br=_i(xs(b,Ht?[0,vr]:[vr,0],W),[E,T]),lr=_i(xs(b,Ht?[d,vr]:[vr,m],W),[E,T]);return $b(e,"",br,lr,s,"clip".concat($e,"snap").concat(_t),"guideline")})),!1)),Jt.isBound&&ae.push.apply(ae,yn([],Zt(Jt.bounds.map(function(pr,_t){var vr=pr.pos,br=_i(xs(b,Ht?[0,vr]:[vr,0],W),[E,T]),lr=_i(xs(b,Ht?[d,vr]:[vr,m],W),[E,T]);return $b(e,"",br,lr,s,"clip".concat($e,"bounds").concat(_t),"guideline","bounds","bold")})),!1))}),yn(yn([],Zt(G),!1),Zt(ae),!1)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var r=t.props,n=r.dragWithClip,i=n===void 0?!0:n;return i?!1:this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,Wt(Wt({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var r=t.state,n=t.props,i=n.defaultClipPath,a=n.customClipPath,s=r.target,o=r.width,c=r.height,f=e.inputEvent?e.inputEvent.target:null,d=f&&f.getAttribute("class")||"",m=e.datas,b=rj(s,o,c,i||"inset",a);if(!b)return!1;var x=b.clipText,E=b.type,T=b.poses,A=Wn(t,"onClipStart",Ki(t,e,{clipType:E,clipStyle:x,poses:T.map(function(R){return R.pos})}));return A===!1?(m.isClipStart=!1,!1):(m.isControl=d&&d.indexOf("clip-control")>-1,m.isLine=d.indexOf("clip-line")>-1,m.isArea=d.indexOf("clip-area")>-1||d.indexOf("clip-ellipse")>-1,m.clipIndex=f?parseInt(f.getAttribute("data-clip-index"),10):-1,m.clipPath=b,m.isClipStart=!0,r.clipPathState=x,by(t,e),!0)},dragControl:function(t,e){var r,n,i,a=e.datas,s=e.originalDatas,o=e.isDragTarget;if(!a.isClipStart)return!1;var c=a,f=c.isControl,d=c.isLine,m=c.isArea,b=c.clipIndex,x=c.clipPath;if(!x)return!1;var E=ey(t.props,"clippable"),T=E.keepRatio,A=0,R=0,F=s.draggable,N=Pd(e);o&&F?(r=Zt(F.prevBeforeDist,2),A=r[0],R=r[1]):(n=Zt(N,2),A=n[0],R=n[1]);var O=[A,R],U=t.state,j=U.width,H=U.height,W=!m&&!f&&!d,X=x.type,oe=x.poses,ee=x.splitter,G=oe.map(function($r){return $r.pos});W&&(A=-A,R=-R);var ae=!f||oe[b].direction==="nesw",se=X==="inset"||X==="rect",fe=oe.map(function(){return[0,0]});if(f&&!ae){var pe=oe[b],De=pe.horizontal,ye=pe.vertical,we=[A*rn(De),R*rn(ye)];fe=m2e(oe,b,we,se,T)}else ae&&(fe=G.map(function(){return[A,R]}));var Te=G.map(function($r,cn){return Ra($r,fe[cn])}),Re=yn([],Zt(Te),!1);U.snapBoundInfos=null;var de=x.type==="circle",Ee=x.type==="ellipse";if(de||Ee){var xe=Ff(Te),Ne=rn(xe.bottom-xe.top),Fe=rn(Ee?xe.right-xe.left:Ne),Xe=Te[0][1]+Ne,Be=Te[0][0]-Fe,ot=Te[0][0]+Fe;de&&(Re.push([ot,xe.bottom]),fe.push([1,0])),Re.push([xe.left,Xe]),fe.push([0,1]),Re.push([Be,xe.bottom]),fe.push([1,0])}var Ke=_K((E.clipHorizontalGuidelines||[]).map(function($r){return wo("".concat($r),H)}),(E.clipVerticalGuidelines||[]).map(function($r){return wo("".concat($r),j)}),j,H),it=[],Me=[];if(de||Ee)it=[Re[4][0],Re[2][0]],Me=[Re[1][1],Re[3][1]];else if(se){var zt=[Re[0],Re[2],Re[4],Re[6]],st=[fe[0],fe[2],fe[4],fe[6]];it=zt.filter(function($r,cn){return st[cn][0]}).map(function($r){return $r[0]}),Me=zt.filter(function($r,cn){return st[cn][1]}).map(function($r){return $r[1]})}else it=Re.filter(function($r,cn){return fe[cn][0]}).map(function($r){return $r[0]}),Me=Re.filter(function($r,cn){return fe[cn][1]}).map(function($r){return $r[1]});var $e=[0,0],Jt=j9(Ke,E.clipTargetBounds&&{left:0,top:0,right:j,bottom:H},it,Me,5,5),Ht=Jt.horizontal,pr=Jt.vertical,_t=Ht.offset,vr=pr.offset;if(Ht.isBound&&($e[1]+=_t),pr.isBound&&($e[0]+=vr),(Ee||de)&&fe[0][0]===0&&fe[0][1]===0){var xe=Ff(Te),br=xe.bottom-xe.top,lr=Ee?xe.right-xe.left:br,Cr=pr.isBound?rn(vr):pr.snapIndex===0?-vr:vr,Tr=Ht.isBound?rn(_t):Ht.snapIndex===0?-_t:_t;lr-=Cr,br-=Tr,de&&(br=fK(pr,Ht)>0?br:lr,lr=br);var Qt=Re[0];Re[1][1]=Qt[1]-br,Re[2][0]=Qt[0]+lr,Re[3][1]=Qt[1]+br,Re[4][0]=Qt[0]-lr}else if(se&&T&&f){var at=Zt($K(oe),2),Pe=at[0],be=at[1],je=Pe&&be?Pe/be:0,qe=oe[b],Ge=qe.direction||"",Nt=Re[1][1],Xe=Re[5][1],Be=Re[7][0],ot=Re[3][0];rn(_t)<=rn(vr)?_t=mc(_t)*rn(vr)/je:vr=mc(vr)*rn(_t)*je,Ge.indexOf("w")>-1?Be-=vr:Ge.indexOf("e")>-1?ot-=vr:(Be+=vr/2,ot-=vr/2),Ge.indexOf("n")>-1?Nt-=_t:Ge.indexOf("s")>-1?Xe-=_t:(Nt+=_t/2,Xe-=_t/2);var Et=oE(Nt,ot,Xe,Be);Re.forEach(function(Rt,en){var jn;jn=Zt(Et[en].pos,2),Rt[0]=jn[0],Rt[1]=jn[1]})}else Re.forEach(function($r,cn){var zr=fe[cn];zr[0]&&($r[0]-=vr),zr[1]&&($r[1]-=_t)});var mt=eL(t,x,Te),ct="".concat(X,"(").concat(mt.join(ee),")");if(U.clipPathState=ct,de||Ee)it=[Re[4][0],Re[2][0]],Me=[Re[1][1],Re[3][1]];else if(se){var zt=[Re[0],Re[2],Re[4],Re[6]];it=zt.map(function(cn){return cn[0]}),Me=zt.map(function(cn){return cn[1]})}else it=Re.map(function($r){return $r[0]}),Me=Re.map(function($r){return $r[1]});if(U.snapBoundInfos=j9(Ke,E.clipTargetBounds&&{left:0,top:0,right:j,bottom:H},it,Me,1,1),F){var Kt=U.is3d,qt=U.allMatrix,Ir=Kt?4:3,Ar=$e;o&&(Ar=[O[0]+$e[0]-N[0],O[1]+$e[1]-N[1]]),F.deltaOffset=So(qt,[Ar[0],Ar[1],0,0],Ir)}return Wn(t,"onClip",Ki(t,e,Wt({clipEventType:"changed",clipType:X,poses:Te,clipStyle:ct,clipStyles:mt,distX:A,distY:R},yc((i={},i[X==="rect"?"clip":"clipPath"]=ct,i),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var r=e.isDrag,n=e.datas,i=e.isDouble,a=n.isLine,s=n.isClipStart,o=n.isControl;return s?(Wn(t,"onClipEnd",hf(t,e,{})),i&&(o?v2e(t,e):a&&y2e(t,e)),i||r):!1},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},b2e={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(t,e){return e.isRequest?e.requestAble==="originDraggable":Bl(e.inputEvent.target,yi("origin"))},dragControlStart:function(t,e){var r=e.datas;by(t,e);var n=Ki(t,e,{dragStart:gc.dragStart(t,new U0().dragStart([0,0],e))}),i=Wn(t,"onDragOriginStart",n);return r.startOrigin=t.state.transformOrigin,r.startTargetOrigin=t.state.targetOrigin,r.prevOrigin=[0,0],r.isDragOrigin=!0,i===!1?(r.isDragOrigin=!1,!1):n},dragControl:function(t,e){var r=e.datas,n=e.isPinch,i=e.isRequest;if(!r.isDragOrigin)return!1;var a=Zt(Pd(e),2),s=a[0],o=a[1],c=t.state,f=c.width,d=c.height,m=c.offsetMatrix,b=c.targetMatrix,x=c.is3d,E=t.props.originRelative,T=E===void 0?!0:E,A=x?4:3,R=[s,o];if(i){var F=e.distOrigin;(F[0]||F[1])&&(R=F)}var N=Ra(r.startOrigin,R),O=Ra(r.startTargetOrigin,R),U=_i(R,r.prevOrigin),j=zx(m,b,N,A),H=t.getRect(),W=Ff(xy(j,f,d,A)),X=[H.left-W.left,H.top-W.top];r.prevOrigin=R;var oe=[yh(O[0],f,T),yh(O[1],d,T)].join(" "),ee=gc.drag(t,Bx(e,t.state,X,!!n)),G=Ki(t,e,Wt(Wt({width:f,height:d,origin:N,dist:R,delta:U,transformOrigin:oe,drag:ee},yc({transformOrigin:oe,transform:ee.transform},e)),{afterTransform:ee.transform}));return Wn(t,"onDragOrigin",G),G},dragControlEnd:function(t,e){var r=e.datas;return r.isDragOrigin?(Wn(t,"onDragOriginEnd",hf(t,e,{})),!0):!1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);return!!r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);return r?(t.transformOrigin=r.transformOrigin,!0):!1},request:function(t){var e={},r=t.getRect(),n=0,i=0,a=r.transformOrigin,s=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(o){return"deltaOrigin"in o?(s[0]+=o.deltaOrigin[0],s[1]+=o.deltaOrigin[1]):"origin"in o?(s[0]=o.origin[0]-a[0],s[1]=o.origin[1]-a[1]):("x"in o?n=o.x-r.left:"deltaX"in o&&(n+=o.deltaX),"y"in o?i=o.y-r.top:"deltaY"in o&&(i+=o.deltaY)),{datas:e,distX:n,distY:i,distOrigin:s}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function x2e(t,e,r,n){var i=t.filter(function(c){var f=c.virtual,d=c.horizontal;return d&&!f}).length,a=t.filter(function(c){var f=c.virtual,d=c.vertical;return d&&!f}).length,s=-1;if(e===0&&(i===0?s=0:i===1&&(s=1)),e===2&&(i<=2?s=2:i<=3&&(s=3)),e===3&&(a===0?s=4:a<4&&(s=7)),e===1&&(a<=1?s=5:a<=2&&(s=6)),!(s===-1||!t[s].virtual)){var o=t[s];w2e(t,s),s<4?o.pos[0]=r:o.pos[1]=n}}function w2e(t,e){e<4?t.slice(0,e+1).forEach(function(r){r.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(function(r){r.virtual=!1}))}function S2e(t,e){e<4?t.slice(e,4).forEach(function(r){r.virtual=!0}):t.slice(e).forEach(function(r){r.virtual=!0})}function nj(t,e,r,n,i){n===void 0&&(n=[0,0]);var a=[];return!t||t==="0px"?a=[]:a=Ag(t),VK(a,e,r,0,0,n,i)}function ij(t,e,r,n,i){var a=t.state,s=a.width,o=a.height,c=QO(i,t.props.roundRelative,s,o),f=c.raws,d=c.styles,m=c.radiusPoses,b=d2e(m,f),x=b.horizontals,E=b.verticals,T=d.join(" ");a.borderRadiusState=T;var A=Ki(t,e,Wt({horizontals:x,verticals:E,borderRadius:T,width:s,height:o,delta:n,dist:r},yc({borderRadius:T},e)));return Wn(t,"onRound",A),A}function aj(t){var e,r,n=t.getState().style,i=n.borderRadius||"";if(!i&&t.props.groupable){var a=t.moveables[0],s=t.getTargets()[0];s&&(a?.props.target===s?(i=(r=(e=t.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&r!==void 0?r:"",n.borderRadius=i):(i=XO(s).borderRadius,n.borderRadius=i))}return i}var E2e={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(t){var e=t.props.roundClickable;return e===!0||e==="line"?yi("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,e){var r=t.getState(),n=r.target,i=r.width,a=r.height,s=r.allMatrix,o=r.is3d,c=r.left,f=r.top,d=r.borderRadiusState,m=t.props,b=m.minRoundControls,x=b===void 0?[0,0]:b,E=m.maxRoundControls,T=E===void 0?[4,4]:E,A=m.zoom,R=m.roundPadding,F=R===void 0?0:R,N=m.isDisplayShadowRoundControls,O=m.groupable;if(!n)return null;var U=d||aj(t),j=o?4:3,H=nj(U,i,a,x,!0);if(!H)return null;var W=0,X=0,oe=O?[0,0]:[c,f];return H.map(function(ee,G){var ae=ee.horizontal,se=ee.vertical,fe=ee.direction||"",pe=yn([],Zt(ee.pos),!1);X+=Math.abs(ae),W+=Math.abs(se),ae&&fe.indexOf("n")>-1&&(pe[1]-=F),se&&fe.indexOf("w")>-1&&(pe[0]-=F),ae&&fe.indexOf("s")>-1&&(pe[1]+=F),se&&fe.indexOf("e")>-1&&(pe[0]+=F);var De=_i(xs(s,pe,j),oe),ye=N&&N!=="horizontal",we=ee.vertical?W<=T[1]&&(ye||!ee.virtual):X<=T[0]&&(N||!ee.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(G),className:yi("control","border-radius",ee.vertical?"vertical":"",ee.virtual?"virtual":""),"data-radius-index":G,style:{display:we?"block":"none",transform:"translate(".concat(De[0],"px, ").concat(De[1],"px) scale(").concat(A,")")}})})},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var r=e.inputEvent.target.getAttribute("class")||"";return r.indexOf("border-radius")>-1||r.indexOf("moveable-line")>-1&&r.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var r=e.inputEvent,n=e.datas,i=r.target,a=i.getAttribute("class")||"",s=a.indexOf("border-radius")>-1,o=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,c=s?parseInt(i.getAttribute("data-radius-index"),10):-1,f=-1;if(o){var d=i.getAttribute("data-line-key")||"";d&&(f=parseInt(d.replace(/render-line-/g,""),10),isNaN(f)&&(f=-1))}if(!s&&!o)return!1;var m=Ki(t,e,{}),b=Wn(t,"onRoundStart",m);if(b===!1)return!1;n.lineIndex=f,n.controlIndex=c,n.isControl=s,n.isLine=o,by(t,e);var x=t.props,E=x.roundRelative,T=x.minRoundControls,A=T===void 0?[0,0]:T,R=t.state,F=R.width,N=R.height;n.isRound=!0,n.prevDist=[0,0];var O=aj(t),U=nj(O||"",F,N,A,!0)||[];return n.controlPoses=U,R.borderRadiusState=QO(U,E,F,N).styles.join(" "),m},dragControl:function(t,e){var r=e.datas,n=r.controlPoses;if(!r.isRound||!r.isControl||!n.length)return!1;var i=r.controlIndex,a=Zt(Pd(e),2),s=a[0],o=a[1],c=[s,o],f=_i(c,r.prevDist),d=t.props.maxRoundControls,m=d===void 0?[4,4]:d,b=t.state,x=b.width,E=b.height,T=n[i],A=T.vertical,R=T.horizontal,F=n.map(function(O){var U=O.horizontal,j=O.vertical,H=[U*R*c[0],j*A*c[1]];if(U){if(m[0]===1)return H;if(m[0]<4&&U!==R)return H}else{if(m[1]===0)return H[1]=j*R*c[0]/x*E,H;if(A){if(m[1]===1)return H;if(m[1]<4&&j!==A)return H}}return[0,0]});F[i]=c;var N=n.map(function(O,U){return Wt(Wt({},O),{pos:Ra(O.pos,F[U])})});return i<4?N.slice(0,i+1).forEach(function(O){O.virtual=!1}):N.slice(4,i+1).forEach(function(O){O.virtual=!1}),r.prevDist=[s,o],ij(t,e,c,f,N)},dragControlEnd:function(t,e){var r=t.state;r.borderRadiusState="";var n=e.datas,i=e.isDouble;if(!n.isRound)return!1;var a=n.isControl,s=n.controlIndex,o=n.isLine,c=n.lineIndex,f=n.controlPoses,d=f.filter(function(R){var F=R.virtual;return F}).length,m=t.props.roundClickable,b=m===void 0?!0:m;if(i&&b){if(a&&(b===!0||b==="control"))S2e(f,s);else if(o&&(b===!0||b==="line")){var x=Zt(WZ(t,e),2),E=x[0],T=x[1];x2e(f,c,E,T)}d!==f.filter(function(R){var F=R.virtual;return F}).length&&ij(t,e,[0,0],[0,0],f)}var A=hf(t,e,{});return Wn(t,"onRoundEnd",A),r.borderRadiusState="",A},dragGroupControlStart:function(t,e){var r=this.dragControlStart(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=Eh(t,"roundable",e),s=Wt({targets:t.props.targets,events:a.map(function(o,c){return Wt(Wt({},o),{target:i[c],moveable:n[c],currentTarget:n[c]})})},r);return Wn(t,"onRoundGroupStart",s),r},dragGroupControl:function(t,e){var r=this.dragControl(t,e);if(!r)return!1;var n=t.moveables,i=t.props.targets,a=Eh(t,"roundable",e),s=Wt({targets:t.props.targets,events:a.map(function(o,c){return Wt(Wt(Wt({},o),{target:i[c],moveable:n[c],currentTarget:n[c]}),yc({borderRadius:r.borderRadius},o))})},r);return Wn(t,"onRoundGroup",s),s},dragGroupControlEnd:function(t,e){var r=t.moveables,n=t.props.targets,i=Eh(t,"roundable",e);u3(t,"onRound",function(o){var c=Wt({targets:t.props.targets,events:i.map(function(f,d){return Wt(Wt(Wt({},f),{target:n[d],moveable:r[d],currentTarget:r[d]}),yc({borderRadius:o.borderRadius},f))})},o);Wn(t,"onRoundGroup",c)});var a=this.dragControlEnd(t,e);if(!a)return!1;var s=Wt({targets:t.props.targets,events:i.map(function(o,c){var f;return Wt(Wt({},o),{target:n[c],moveable:r[c],currentTarget:r[c],lastEvent:(f=o.datas)===null||f===void 0?void 0:f.lastEvent})})},a);return Wn(t,"onRoundGroupEnd",s),s},unset:function(t){t.state.borderRadiusState=""}};function T2e(t,e){var r=e?4:3,n=Qo(r),i="matrix".concat(e?"3d":"","(").concat(n.join(","),")");return t===i||t==="matrix(1,0,0,1,0,0)"}var qK={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,e){var r=t.state,n=r.is3d,i=r.targetMatrix,a=r.inlineTransform,s=n?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(LZ(i,!0),")"),o=!a||a==="none"?s:a;e.datas.startTransforms=T2e(o,n)?[]:Ag(o)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return Ki(t,e,{setTransform:function(r){e.datas.startTransforms=su(r)?r:Ag(r)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return Ki(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),Wn(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),Wn(t,"onBeforeRender",Ki(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),Wn(t,"onBeforeRenderEnd",Ki(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var r=this;this.dragStart(t,e);var n=Eh(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.setTransform(c,s),r.resetStyle(s),r.fillDragStartParams(c,s)});Wn(t,"onBeforeRenderGroupStart",Ki(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:a}))},dragGroup:function(t,e){var r=this;this.drag(t,e);var n=Eh(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.resetStyle(s),r.fillDragParams(c,s)});Wn(t,"onBeforeRenderGroup",Ki(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:a}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),Wn(t,"onBeforeRenderGroupEnd",Ki(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},HK={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,e){Wn(t,"onRenderStart",Ki(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){Wn(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){return this.drag(t,e)},dragEnd:function(t,e){Wn(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){Wn(t,"onRenderGroupStart",Ki(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var r=this,n=Eh(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.fillDragParams(c,s)});Wn(t,"onRenderGroup",Ki(t,e,Wt(Wt({isPinch:!!e.isPinch,targets:t.props.targets,transform:cw(e),transformObject:{}},yc(fw(e))),{events:a})))},dragGroupEnd:function(t,e){var r=this,n=Eh(t,"beforeRenderable",e),i=t.moveables,a=n.map(function(s,o){var c=i[o];return r.fillDragEndParams(c,s)});Wn(t,"onRenderGroupEnd",Ki(t,e,Wt({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:a,transformObject:{},transform:cw(e)},yc(fw(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){var r={};return j0(QS(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),Ki(t,e,Wt({isPinch:!!e.isPinch,transformObject:r,transform:cw(e)},yc(fw(e))))},fillDragEndParams:function(t,e){var r={};return j0(QS(e)||[]).forEach(function(n){r[n.name]=n.functionValue}),Ki(t,e,Wt({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:r,transform:cw(e)},yc(fw(e))))}};function gb(t,e,r,n,i,a,s){a.clientDistX=a.distX,a.clientDistY=a.distY;var o=i==="Start",c=i==="End",f=i==="After",d=t.state.target,m=a.isRequest,b=n.indexOf("Control")>-1;if(!d||o&&b&&!m&&t.areaElement===a.inputEvent.target)return!1;var x=yn([],Zt(e),!1);if(m){var E=a.requestAble;x.some(function(G){return G.name===E})||x.push.apply(x,yn([],Zt(t.props.ables.filter(function(G){return G.name===E})),!1))}if(!x.length||x.every(function(G){return G.dragRelation}))return!1;var T=a.inputEvent,A;c&&T&&(A=document.elementFromPoint(a.clientX,a.clientY)||T.target);var R=!1,F=function(){var G;R=!0,(G=a.stop)===null||G===void 0||G.call(a)},N=o&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());N&&t.updateRect(i,!0,!1);var O=a.datas,U=b?"controlGesto":"targetGesto",j=t[U],H=function(G,ae,se){if(!(ae in G)||j!==t[U])return!1;var fe=G.name,pe=O[fe]||(O[fe]={});if(o&&(pe.isEventStart=!se||!G[se]||G[se](t,a)),!pe.isEventStart)return!1;var De=G[ae](t,Wt(Wt({},a),{stop:F,datas:pe,originalDatas:O,inputTarget:A}));return t._emitter.off(),o&&De===!1&&(pe.isEventStart=!1),De};N&&x.forEach(function(G){G.unset&&G.unset(t)}),H(qK,"drag".concat(n).concat(i));var W=0,X=0;r.forEach(function(G){if(R)return!1;var ae="".concat(G).concat(n).concat(i),se="".concat(G).concat(n,"Condition");i===""&&!m&&Xxe(t.state,a);var fe=x.filter(function(ye){return ye[ae]});fe=fe.filter(function(ye,we){return ye.name&&fe.indexOf(ye)===we});var pe=fe.filter(function(ye){return H(ye,ae,se)}),De=pe.length;R&&++W,De&&++X,!R&&o&&fe.length&&!De&&(W+=fe.filter(function(ye){var we=ye.name,Te=O[we];return Te.isEventStart?ye.dragRelation!=="strong":!1}).length?1:0)}),(!f||X)&&H(HK,"drag".concat(n).concat(i));var oe=j!==t[U]||W===r.length;if((c||R||oe)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(G){G.state.gestos={}}),x.forEach(function(G){G.unset&&G.unset(t)})),o&&!oe&&!m&&X&&t.props.preventDefault&&a?.preventDefault(),t.isUnmounted||oe)return!1;if(!o&&X&&!s||c){var ee=t.props.flushSync||wK;ee(function(){t.updateRect(c?i:"",!0,!1),t.forceUpdate()})}return!o&&!c&&!f&&X&&!s&&gb(t,e,r,n,i+"After",a),!0}function tL(t,e){return function(r,n){var i;n===void 0&&(n=r.inputEvent.target);var a=n,s=t.areaElement,o=t._dragTarget;return!o||!e&&(!((i=t.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===o||o.contains(a)||a===s||!t.isMoveableElement(a)&&!t.controlBox.contains(a)||Bl(a,"moveable-area")||Bl(a,"moveable-padding")||Bl(a,"moveable-edgeDraggable")}}function GK(t,e,r){var n=t.controlBox,i=[],a=t.props,s=a.dragArea,o=t.state.target,c=a.dragTarget;i.push(n),(!s||c)&&i.push(e),!s&&c&&o&&e!==o&&a.dragTargetSelf&&i.push(o);var f=tL(t);return XK(t,i,"targetAbles",r,{dragStart:f,pinchStart:f})}function WK(t,e){var r=t.controlBox,n=[];n.push(r);var i=tL(t,!0),a=function(s,o){if(o===void 0&&(o=s.inputEvent.target),o===r)return!0;var c=i(s,o);return!c};return XK(t,n,"controlAbles",e,{dragStart:a,pinchStart:a})}function XK(t,e,r,n,i){i===void 0&&(i={});var a=r==="targetAbles",s=t.props,o=s.pinchOutside,c=s.pinchThreshold,f=s.preventClickEventOnDrag,d=s.preventClickDefault,m=s.checkInput,b=s.dragFocusedInput,x=s.preventDefault,E=x===void 0?!0:x,T=s.preventRightClick,A=T===void 0?!0:T,R=s.preventWheelClick,F=R===void 0?!0:R,N=s.dragContainer,O=vd(N,!0),U={preventDefault:E,preventRightClick:A,preventWheelClick:F,container:O||bg(t.getControlBoxElement()),pinchThreshold:c,pinchOutside:o,preventClickEventOnDrag:a?f:!1,preventClickEventOnDragStart:a?d:!1,preventClickEventByCondition:a?null:function(W){return t.controlBox.contains(W.target)},checkInput:a?m:!1,dragFocusedInput:b},j=new K1e(e,U),H=n==="Control";return["drag","pinch"].forEach(function(W){["Start","","End"].forEach(function(X){j.on("".concat(W).concat(X),function(oe){var ee,G=oe.eventType,ae=W==="drag"&&oe.isPinch;if(i[G]&&!i[G](oe)){oe.stop();return}if(!ae){var se=W==="drag"?[W]:["drag",W],fe=yn([],Zt(t[r]),!1),pe=gb(t,fe,se,n,X,oe);pe?(t.props.stopPropagation||X==="Start"&&H)&&((ee=oe?.inputEvent)===null||ee===void 0||ee.stopPropagation()):oe.stop()}})})}),j}var C2e=(function(){function t(e,r,n){var i=this;this.target=e,this.moveable=r,this.eventName=n,this.ables=[],this._onEvent=function(a){var s=i.eventName,o=i.moveable;o.state.disableNativeEvent||i.ables.forEach(function(c){c[s](o,{inputEvent:a})})},e.addEventListener(n.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(e){this.ables=e},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t})();function A2e(t,e,r,n){var i;r===void 0&&(r=e);var a=QZ(t,e),s=a.matrixes,o=a.is3d,c=a.targetMatrix,f=a.transformOrigin,d=a.targetOrigin,m=a.offsetContainer,b=a.hasFixed,x=a.zoom,E=Ube(m,r),T=E.matrixes,A=E.is3d,R=E.offsetContainer,F=E.zoom,N=n,O=4,U=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t,j=c,H=Qo(O),W=Qo(O),X=Qo(O),oe=Qo(O),ee=s.length,G=T.map(function(we){return Wt(Wt({},we),{matrix:we.matrix?yn([],Zt(we.matrix),!1):void 0})}).reverse();s.reverse(),!o&&N&&(j=Ah(j,3,4),Ek(s)),!A&&N&&Ek(G),G.forEach(function(we){W=So(W,we.matrix,O)});var ae=r||zg(t),se=((i=G[0])===null||i===void 0?void 0:i.target)||qb(ae,ae,!0).offsetParent,fe=G.slice(1).reduce(function(we,Te){return So(we,Te.matrix,O)},Qo(O));s.forEach(function(we,Te){if(ee-2===Te&&(X=H.slice()),ee-1===Te&&(oe=H.slice()),!we.matrix){var Re=s[Te+1],de=qxe(we,Re,se,O,So(fe,H,O));we.matrix=Jm(de,O)}H=So(H,we.matrix,O)});var pe=!U&&o;j||(j=Qo(pe?4:3));var De=l3(U&&j.length===16?Ah(j,4,3):j,pe),ye=W;return W=DZ(W,O,O),{hasZoom:x!==1||F!==1,hasFixed:b,matrixes:s,rootMatrix:W,originalRootMatrix:ye,beforeMatrix:X,offsetMatrix:oe,allMatrix:H,targetMatrix:j,targetTransform:De,inlineTransform:t.style.transform,transformOrigin:f,targetOrigin:d,is3d:N,offsetContainer:m,offsetRootContainer:R}}function I2e(t,e,r,n){r===void 0&&(r=e);var i=0,a=0,s=0,o={},c=CK(t);if(t&&(i=c.offsetWidth,a=c.offsetHeight),t){var f=A2e(t,e,r,n),d=C0(f.allMatrix,f.transformOrigin,i,a);o=Wt(Wt({},f),d);var m=C0(f.allMatrix,[50,50],100,100);s=AK([m.pos1,m.pos2],m.direction)}var b=4;return Wt(Wt(Wt({hasZoom:!1,width:i,height:a,rotation:s},c),{originalRootMatrix:Qo(b),rootMatrix:Qo(b),beforeMatrix:Qo(b),offsetMatrix:Qo(b),allMatrix:Qo(b),targetMatrix:Qo(b),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!0,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),o)}function Ik(t,e,r,n,i,a){a===void 0&&(a=[]);var s=1,o=[0,0],c=dw(),f=dw(),d=dw(),m=dw(),b=[0,0],x={},E=I2e(e,r,i,!0);if(e){var T=Lc(e);a.forEach(function(G){x[G]=T(G)});var A=E.is3d?4:3,R=C0(E.offsetMatrix,Ra(E.transformOrigin,OZ(E.targetMatrix,A)),E.width,E.height);s=R.direction,o=Ra(R.origin,[R.left-E.left,R.top-E.top]),m=pb(E.offsetRootContainer);var F=qb(n,n,!0).offsetParent||E.offsetRootContainer;if(E.hasZoom){var N=C0(So(E.originalRootMatrix,E.allMatrix),E.transformOrigin,E.width,E.height),O=C0(E.originalRootMatrix,nE(Lc(F)("transformOrigin")).map(function(G){return parseFloat(G)}),F.offsetWidth,F.offsetHeight);if(c=r5(N,m),d=r5(O,m,F,!0),t){var U=N.left,j=N.top;f=r5({left:U,top:j,bottom:j,right:j},m)}}else{c=pb(e),d=jbe(F),t&&(f=pb(t));var H=d.left,W=d.top,X=d.clientLeft,oe=d.clientTop,ee=[c.left-H,c.top-W];b=_i(q0(E.rootMatrix,ee,4),[X+E.left,oe+E.top])}}return Wt({targetClientRect:c,containerClientRect:d,moveableClientRect:f,rootContainerClientRect:m,beforeDirection:s,beforeOrigin:o,originalBeforeOrigin:o,target:e,style:x,offsetDelta:b},E)}function oj(t){var e=t.pos1,r=t.pos2,n=t.pos3,i=t.pos4;if(!e||!r||!n||!i)return null;var a=Qm([e,r,n,i]),s=[a.minX,a.minY],o=_i(t.origin,s);return e=_i(e,s),r=_i(r,s),n=_i(n,s),i=_i(i,s),Wt(Wt({},t),{left:t.left,top:t.top,posDelta:s,pos1:e,pos2:r,pos3:n,pos4:i,origin:o,beforeOrigin:o,isPersisted:!0})}var H0=(function(t){Nx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.state=Wt({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},Ik(null)),r.renderState={},r.enabledAbles=[],r.targetAbles=[],r.controlAbles=[],r.rotation=0,r.scale=[1,1],r.isMoveableMounted=!1,r.isUnmounted=!1,r.events={mouseEnter:null,mouseLeave:null},r._emitter=new DO,r._prevOriginalDragTarget=null,r._originalDragTarget=null,r._prevDragTarget=null,r._dragTarget=null,r._prevPropTarget=null,r._propTarget=null,r._prevDragArea=!1,r._isPropTargetChanged=!1,r._hasFirstTarget=!1,r._reiszeObserver=null,r._observerId=0,r._mutationObserver=null,r._rootContainer=null,r._viewContainer=null,r._viewClassNames=[],r._store={},r.checkUpdateRect=function(){if(!r.isDragging()){var n=r.props.parentMoveable;if(n){n.checkUpdateRect();return}f1e(r._observerId),r._observerId=IZ(function(){r.isDragging()||r.updateRect()})}},r._onPreventClick=function(n){n.stopPropagation(),n.preventDefault()},r}return e.prototype.render=function(){var r=this.props,n=this.getState(),i=r.parentPosition,a=r.className,s=r.target,o=r.zoom,c=r.cspNonce,f=r.translateZ,d=r.cssStyled,m=r.groupable,b=r.linePadding,x=r.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var E=Zt(i||[0,0],2),T=E[0],A=E[1],R=n.left,F=n.top,N=n.target,O=n.direction,U=n.hasFixed,j=n.offsetDelta,H=r.targets,W=this.isDragging(),X={};this.getEnabledAbles().forEach(function(fe){X["data-able-".concat(fe.name.toLowerCase())]=!0});var oe=this._getAbleClassName(),ee=H&&H.length&&(N||m)||s||!this._hasFirstTarget&&this.state.isPersisted,G=this.controlBox||this.props.firstRenderState||this.props.persistData,ae=[R-T,F-A];!m&&r.useAccuratePosition&&(ae[0]+=j[0],ae[1]+=j[1]);var se={position:U?"fixed":"absolute",display:ee?"block":"none",visibility:G?"visible":"hidden",transform:"translate3d(".concat(ae[0],"px, ").concat(ae[1],"px, ").concat(f,")"),"--zoom":o,"--zoompx":"".concat(o,"px")};return b&&(se["--moveable-line-padding"]=b),x&&(se["--moveable-control-padding"]=x),te.createElement(d,Wt({cspNonce:c,ref:zm(this,"controlBox"),className:"".concat(yi("control-box",O===-1?"reverse":"",W?"dragging":"")," ").concat(oe," ").concat(a)},X,{onClick:this._onPreventClick,style:se}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var r=this.props,n=r.parentMoveable,i=r.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!n&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(r){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(r)},e.prototype.componentWillUnmount=function(){var r,n;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(r=this._reiszeObserver)===null||r===void 0||r.disconnect(),(n=this._mutationObserver)===null||n===void 0||n.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),l0(this,!1),l0(this,!0);var a=this.events;for(var s in a){var o=a[s];o&&o.destroy()}},e.prototype.getTargets=function(){var r=this.props.target;return r?[r]:[]},e.prototype.getAble=function(r){var n=this.props.ables||[];return ff(n,function(i){return i.name===r})},e.prototype.getContainer=function(){var r=this.props,n=r.parentMoveable,i=r.wrapperMoveable,a=r.container;return a||i&&i.getContainer()||n&&n.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(r){var n;return r&&(((n=r.getAttribute)===null||n===void 0?void 0:n.call(r,"class"))||"").indexOf(NO)>-1},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=this.targetGesto,a=this.controlGesto;return i&&tL(this)({inputEvent:r},n)?i.isFlag()||i.triggerDragStart(r):a&&this.isMoveableElement(n)&&(a.isFlag()||a.triggerDragStart(r)),this},e.prototype.hitTest=function(r){var n=this.state,i=n.target,a=n.pos1,s=n.pos2,o=n.pos3,c=n.pos4,f=n.targetClientRect;if(!i)return 0;var d;if(PO(r)){var m=r.getBoundingClientRect();d={left:m.left,top:m.top,width:m.width,height:m.height}}else d=Wt({width:0,height:0},r);var b=d.left,x=d.top,E=d.width,T=d.height,A=P9([a,s,c,o],f),R=H1e(A,[[b,x],[b+E,x],[b+E,x+T],[b,x+T]]),F=BZ(A);return!R||!F?0:Math.min(100,R/F*100)},e.prototype.isInside=function(r,n){var i=this.state,a=i.target,s=i.pos1,o=i.pos2,c=i.pos3,f=i.pos4,d=i.targetClientRect;return a?fk([r,n],P9([s,o,f,c],d)):!1},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0);var a=this.props,s=!a.parentPosition&&!a.wrapperMoveable;s&&V0(!0);var o=a.parentMoveable,c=this.state,f=c.target||a.target,d=this.getContainer(),m=o?o._rootContainer:this._rootContainer,b=Ik(this.controlBox,f,d,d,m||d,this._getRequestStyles());if(!f&&this._hasFirstTarget&&a.persistData){var x=oj(a.persistData);for(var E in x)b[E]=x[E]}s&&V0(),this.updateState(b,o?!1:i)},e.prototype.isDragging=function(r){var n,i,a=this.targetGesto,s=this.controlGesto;if(a?.isFlag()){if(!r)return!0;var o=a.getEventData();return!!(!((n=o[r])===null||n===void 0)&&n.isEventStart)}if(s?.isFlag()){if(!r)return!0;var o=s.getEventData();return!!(!((i=o[r])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(r){this.updateRect(r,!0)},e.prototype.getRect=function(){var r=this.state,n=Wf(this.state),i=Zt(n,4),a=i[0],s=i[1],o=i[2],c=i[3],f=Ff(n),d=r.width,m=r.height,b=f.width,x=f.height,E=f.left,T=f.top,A=[r.left,r.top],R=Ra(A,r.origin),F=Ra(A,r.beforeOrigin),N=r.transformOrigin;return{width:b,height:x,left:E,top:T,pos1:a,pos2:s,pos3:o,pos4:c,offsetWidth:d,offsetHeight:m,beforeOrigin:F,origin:R,transformOrigin:N,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(r){if(!r||r==="target"){var n=this.targetGesto;n?.isIdle()===!1&&Tk(this,!1),n?.stop()}if(!r||r==="control"){var n=this.controlGesto;n?.isIdle()===!1&&Tk(this,!0),n?.stop()}},e.prototype.getRotation=function(){var r=this.state,n=r.pos1,i=r.pos2,a=r.direction;return Kxe(n,i,a)},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this,s=a.props,o=s.parentMoveable||s.wrapperMoveable||a,c=o.props.ables,f=s.groupable,d=ff(c,function(R){return R.name===r});if(this.isDragging()||!d||!d.request)return{request:function(){return this},requestEnd:function(){return this}};var m=d.request(a),b=i||n.isInstant,x=m.isControl?"controlAbles":"targetAbles",E="".concat(f?"Group":"").concat(m.isControl?"Control":""),T=yn([],Zt(o[x]),!1),A={request:function(R){return gb(a,T,["drag"],E,"",Wt(Wt({},m.request(R)),{requestAble:r,isRequest:!0}),b),A},requestEnd:function(){return gb(a,T,["drag"],E,"End",Wt(Wt({},m.requestEnd()),{requestAble:r,isRequest:!0}),b),A}};return gb(a,T,["drag"],E,"Start",Wt(Wt({},m.requestStart(n)),{requestAble:r,isRequest:!0}),b),b?A.request(n).requestEnd():A},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var r=this.getState(),n=this.props,i=n.padding,a=r.originalBeforeOrigin,s=r.transformOrigin,o=r.allMatrix,c=r.is3d,f=r.pos1,d=r.pos2,m=r.pos3,b=r.pos4,x=r.left,E=r.top,T=r.isPersisted,A=n.zoom||1;if(!i&&A<=1){r.renderPoses=[f,d,m,b],r.renderLines=[[f,d],[d,b],[b,m],[m,f]];return}var R=FK(i||{}),F=R.left,N=R.top,O=R.bottom,U=R.right,j=c?4:3,H=[];T?H=s:this.controlBox&&n.groupable?H=a:H=Ra(a,[x,E]);var W=KS(j,Jm(H.map(function(se){return-se}),j),o,Jm(s,j)),X=Af(W,f,[-F,-N],j),oe=Af(W,d,[U,-N],j),ee=Af(W,m,[-F,O],j),G=Af(W,b,[U,O],j);r.renderPoses=[X,oe,ee,G],r.renderLines=[[X,oe],[oe,G],[G,ee],[ee,X]];{var ae=A/2;r.renderLines=[[Af(W,f,[-F-ae,-N],j),Af(W,d,[U+ae,-N],j)],[Af(W,d,[U,-N-ae],j),Af(W,b,[U,O+ae],j)],[Af(W,b,[U+ae,O],j),Af(W,m,[-F-ae,O],j)],[Af(W,m,[-F,O+ae],j),Af(W,f,[-F,-N-ae],j)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var r=this.props,n=r.target,i=r.container,a=r.parentMoveable,s=this.state,o=s.target,c=s.container;if(!(!o&&!n)){this.updateAbles();var f=!Ck(o,n),d=f||!Ck(c,i);if(d){var m=i||this.controlBox;m&&this.unsetAbles(),this.updateState({target:n,container:i}),!a&&m&&this.updateRect("End",!1,!1),this._isPropTargetChanged=f}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(r,n){var i=this.props;if(this._emitter.trigger(r,n),i.parentMoveable&&n.isRequest&&!n.isRequestChild)return i.parentMoveable.triggerEvent(r,n,!0);var a=i[r];return a&&a(n)},e.prototype.useCSS=function(r,n){var i=this.props.customStyledMap,a=r+n;return i[a]||(i[a]=UZ(r,n)),i[a]},e.prototype.getState=function(){var r,n=this.props;(n.target||!((r=n.targets)===null||r===void 0)&&r.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=n.persistData,s=n.firstRenderState;if(s&&!i)return s;if(!this._hasFirstTarget&&a){var o=oj(a);if(o)return this.updateState(o,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var r=this;this.targetAbles.forEach(function(n){n.unset&&n.unset(r)})},e.prototype.updateAbles=function(r,n){r===void 0&&(r=this.props.ables),n===void 0&&(n="");var i=this.props,a=i.triggerAblesSimultaneously,s=this.getEnabledAbles(r),o="drag".concat(n,"Start"),c="pinch".concat(n,"Start"),f="drag".concat(n,"ControlStart"),d=pw(s,[o,c],a),m=pw(s,[f],a);this.enabledAbles=s,this.targetAbles=d,this.controlAbles=m},e.prototype.updateState=function(r,n){if(n){if(this.isUnmounted)return;this.setState(r)}else{var i=this.state;for(var a in r)i[a]=r[a]}},e.prototype.getEnabledAbles=function(r){r===void 0&&(r=this.props.ables);var n=this.props;return r.filter(function(i){return i&&(i.always&&n[i.name]!==!1||n[i.name])})},e.prototype.renderAbles=function(){var r=this,n=this.props,i=n.triggerAblesSimultaneously,a={createElement:te.createElement};return this.renderState={},Wxe(DK(pw(this.getEnabledAbles(),["render"],i).map(function(s){var o=s.render;return o(r,a)||[]})).filter(function(s){return s}),function(s){var o=s.key;return o}).map(function(s){return s[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return yn(yn([],Zt(n),!1),Zt(o),!1)},yn([],Zt(this.props.requestStyles||[]),!1));return r},e.prototype._updateObserver=function(r){this._updateResizeObserver(r),this._updateMutationObserver(r)},e.prototype._updateEvents=function(){var r=this.targetAbles.length,n=this.controlAbles.length,i=this._dragTarget,a=!r&&this.targetGesto||this._isTargetChanged(!0);a&&(l0(this,!1),this.updateState({gestos:{}})),n||l0(this,!0),i&&r&&!this.targetGesto&&(this.targetGesto=GK(this,i,"")),!this.controlGesto&&n&&(this.controlGesto=WK(this,"Control"))},e.prototype._updateTargets=function(){var r=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=r.dragArea,this._propTarget=r.target,this._originalDragTarget=r.dragTarget||r.target,this._dragTarget=vd(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var r=this.props,n=r,i=n.zoom,a=n.hideDefaultLines,s=n.hideChildMoveableDefaultLines,o=n.parentMoveable;if(a||o&&s)return[];var c=this.getState(),f={createElement:te.createElement};return c.renderLines.map(function(d,m){return $b(f,"",d[0],d[1],i,"render-line-".concat(m))})},e.prototype._isTargetChanged=function(r){var n=this.props,i=n.dragTarget||n.target,a=this._prevOriginalDragTarget,s=this._prevDragArea,o=n.dragArea,c=!o&&a!==i,f=(r||o)&&s!==o;return c||f||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var r=this,n=this.props,i=n.dragArea?this.areaElement:this.state.target,a=this.events,s=p_(a);if(this._isTargetChanged())for(var o in a){var c=a[o];c&&c.destroy(),a[o]=null}if(i){var f=this.enabledAbles;s.forEach(function(d){var m=pw(f,[d]),b=m.length>0,x=a[d];if(!b){x&&(x.destroy(),a[d]=null);return}x||(x=new C2e(i,r,d),a[d]=x),x.setAbles(m)})}},e.prototype._checkUpdateRootContainer=function(){var r=this.props.rootContainer;!this._rootContainer&&r&&(this._rootContainer=vd(r,!0))},e.prototype._checkUpdateViewContainer=function(){var r=this.props.viewContainer;!this._viewContainer&&r&&(this._viewContainer=vd(r,!0));var n=this._viewContainer;n&&this._changeAbleViewClassNames(yn(yn([],Zt(this._getAbleViewClassNames()),!1),[this.isDragging()?i2e:""],!1))},e.prototype._changeAbleViewClassNames=function(r){var n=this._viewContainer,i=RK(r.filter(Boolean),function(f){return f}).map(function(f){var d=Zt(f,1),m=d[0];return m}),a=this._viewClassNames,s=RO(a,i),o=s.removed,c=s.added;o.forEach(function(f){kZ(n,a[f])}),c.forEach(function(f){MZ(n,i[f])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var r=this;return(this.getEnabledAbles().map(function(n){var i;return((i=n.viewClassName)===null||i===void 0?void 0:i.call(n,r))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(r){var n=this;r===void 0&&(r="");var i=this.getEnabledAbles(),a=this.targetGesto,s=this.controlGesto,o=a?.isFlag()?a.getEventData():{},c=s?.isFlag()?s.getEventData():{};return i.map(function(f){var d,m,b,x=f.name,E=((d=f.className)===null||d===void 0?void 0:d.call(f,n))||"";return(!((m=o[x])===null||m===void 0)&&m.isEventStart||!((b=c[x])===null||b===void 0)&&b.isEventStart)&&(E+=" ".concat(yi("".concat(x).concat(r,"-dragging")))),E.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(r){var n,i=this.props,a=i.target,s=bg(this.getControlBoxElement());if(!s.ResizeObserver||!a||!i.useResizeObserver){(n=this._reiszeObserver)===null||n===void 0||n.disconnect();return}if(!(r.target===a&&this._reiszeObserver)){var o=new s.ResizeObserver(this.checkUpdateRect);o.observe(a,{box:"border-box"}),this._reiszeObserver=o}},e.prototype._updateMutationObserver=function(r){var n=this,i,a=this.props,s=a.target,o=bg(this.getControlBoxElement());if(!o.MutationObserver||!s||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(r.target===s&&this._mutationObserver)){var c=new o.MutationObserver(function(f){var d,m;try{for(var b=lbe(f),x=b.next();!x.done;x=b.next()){var E=x.value;E.type==="attributes"&&E.attributeName==="style"&&n.checkUpdateRect()}}catch(T){d={error:T}}finally{try{x&&!x.done&&(m=b.return)&&m.call(b)}finally{if(d)throw d.error}}});c.observe(s,{attributes:!0}),this._mutationObserver=c}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:wK,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e})(te.PureComponent),rL={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,e){var r,n=t.props,i=n.targets||[],a=t.getState(),s=a.left,o=a.top,c=a.isPersisted,f=n.zoom||1,d=t.renderGroupRects,m=((r=n.persistData)===null||r===void 0?void 0:r.children)||[];c?i=m.map(function(){return null}):m=[];var b=u0(t,"parentPosition",[s,o],function(E){return E.join(",")}),x=u0(t,"requestStyles",t.getRequestChildStyles(),function(E){return E.join(",")});return t.moveables=t.moveables.slice(0,i.length),yn(yn([],Zt(i.map(function(E,T){return e.createElement(H0,{key:"moveable"+T,ref:EZ(t,"moveables",T),target:E,origin:!1,requestStyles:x,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,useMutationObserver:n.useMutationObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[s,o],persistData:m[T],zoom:f})})),!1),Zt(DK(d.map(function(E,T){var A=E.pos1,R=E.pos2,F=E.pos3,N=E.pos4,O=[A,R,F,N];return[[0,1],[1,3],[3,2],[2,0]].map(function(U,j){var H=Zt(U,2),W=H[0],X=H[1];return $b(e,"",_i(O[W],b),_i(O[X],b),f,"group-rect-".concat(T,"-").concat(j))})}))),!1)}},P2e=Fx("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var r=t.props.target,n=e.inputEvent,i=e.inputTarget,a=t.isMoveableElement(i),s=!a&&t.controlBox.contains(i);if(!(!n||!i||e.isDrag||t.isMoveableElement(i)||s)){var o=r.contains(i);Wn(t,"onClick",Ki(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:r===i,moveableTarget:t.props.target,containsTarget:o}))}},dragGroupEnd:function(t,e){var r=e.inputEvent,n=e.inputTarget;if(!(!r||!n||e.isDrag||t.isMoveableElement(n)||e.datas.inputTarget===n)){var i=t.props.targets,a=i.indexOf(n),s=a>-1,o=!1;a===-1&&(a=bp(i,function(c){return c.contains(n)}),o=a>-1),Wn(t,"onClickGroup",Ki(t,e,{isDouble:e.isDouble,targets:i,inputTarget:n,targetIndex:a,isTarget:s,containsTarget:o,moveableTarget:i[a]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function gv(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),Wt(Wt({},t),{datas:e})}var M2e=Fx("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(t,e){var r=t.props,n=r.edgeDraggable;return n?rK(e,"edgeDraggable",n,t.getState().renderPoses,r.zoom):[]},dragCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Bl(i,yi("direction"))&&Bl(i,yi("edge"))&&Bl(i,yi("edgeDraggable"))},dragStart:function(t,e){return gc.dragStart(t,gv(e))},drag:function(t,e){return gc.drag(t,gv(e))},dragEnd:function(t,e){return gc.dragEnd(t,gv(e))},dragGroupCondition:function(t,e){var r,n=t.props,i=(r=e.inputEvent)===null||r===void 0?void 0:r.target;return!n.edgeDraggable||!i?!1:!n.draggable&&Bl(i,yi("direction"))&&Bl(i,yi("line"))},dragGroupStart:function(t,e){return gc.dragGroupStart(t,gv(e))},dragGroup:function(t,e){return gc.dragGroup(t,gv(e))},dragGroupEnd:function(t,e){return gc.dragGroupEnd(t,gv(e))},unset:function(t){return gc.unset(t)}}),YK={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},k2e=[qK,jK,Oxe,Qxe,gc,M2e,xk,e2e,r2e,mxe,s2e,l2e,a2e,b2e,_2e,E2e,rL,YK,P2e,zK,HK];function sj(t,e){var r=Zt(t,3),n=r[0],i=r[1],a=r[2];return(n*e[0]+i*e[1]+a)/Math.sqrt(n*n+i*i)}function yw(t,e){var r=Zt(t,2),n=r[0],i=r[1];return-n*e[0]-i*e[1]}function lj(t,e){return Math.max.apply(Math,yn([],Zt(t.map(function(r){var n=Zt(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.max(i[e],a[e],s[e],o[e])})),!1))}function uj(t,e){return Math.min.apply(Math,yn([],Zt(t.map(function(r){var n=Zt(r,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.min(i[e],a[e],s[e],o[e])})),!1))}function R2e(t,e){var r,n,i,a=[0,0],s=[0,0],o=[0,0],c=[0,0],f=0,d=0;if(!t.length)return{pos1:a,pos2:s,pos3:o,pos4:c,minX:0,minY:0,maxX:0,maxY:0,width:f,height:d,rotation:e};var m=Fi(e,bc);if(m%90){var b=m/180*Math.PI,x=Math.tan(b),E=-1/x,T=[yk,R9],A=[[0,0],[0,0]],R=[yk,R9],F=[[0,0],[0,0]];t.forEach(function(Ee){Ee.forEach(function(xe){var Ne=sj([-x,1,0],xe),Fe=sj([-E,1,0],xe);T[0]>Ne&&(A[0]=xe,T[0]=Ne),T[1]<Ne&&(A[1]=xe,T[1]=Ne),R[0]>Fe&&(F[0]=xe,R[0]=Fe),R[1]<Fe&&(F[1]=xe,R[1]=Fe)})});var N=Zt(A,2),O=N[0],U=N[1],j=Zt(F,2),H=j[0],W=j[1],X=[-x,1,yw([-x,1],O)],oe=[-x,1,yw([-x,1],U)],ee=[-E,1,yw([-E,1],H)],G=[-E,1,yw([-E,1],W)];r=Zt([[X,ee],[X,G],[oe,ee],[oe,G]].map(function(Ee){var xe=Zt(Ee,2),Ne=xe[0],Fe=xe[1];return OO(Ne,Fe)[0]}),4),a=r[0],s=r[1],o=r[2],c=r[3],f=R[1]-R[0],d=T[1]-T[0]}else{var ae=uj(t,0),se=uj(t,1),fe=lj(t,0),pe=lj(t,1);if(a=[ae,se],s=[fe,se],o=[ae,pe],c=[fe,pe],f=fe-ae,d=pe-se,m%180){var De=[o,a,c,s];n=Zt(De,4),a=n[0],s=n[1],o=n[2],c=n[3],f=pe-se,d=fe-ae}}if(m%360>180){var De=[c,o,s,a];i=Zt(De,4),a=i[0],s=i[1],o=i[2],c=i[3]}var ye=Qm([a,s,o,c]),we=ye.minX,Te=ye.minY,Re=ye.maxX,de=ye.maxY;return{pos1:a,pos2:s,pos3:o,pos4:c,width:f,height:d,minX:we,minY:Te,maxX:Re,maxY:de,rotation:e}}function ZK(t,e){var r=e.map(function(n){if(su(n)){var i=ZK(t,n),a=i.length;return a>1?i:a===1?i[0]:null}else{var s=ff(t,function(o){var c=o.manager;return c.props.target===n});return s?(s.finded=!0,s.manager):null}}).filter(Boolean);return r.length===1&&su(r[0])?r[0]:r}var D2e=(function(t){Nx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.differ=new FZ,r.moveables=[],r.transformOrigin="50% 50%",r.renderGroupRects=[],r._targetGroups=[],r._hasFirstTargets=!1,r}return e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){var a;i===void 0&&(i=!0);var s=this.state;if(!this.controlBox||s.isPersisted)return;V0(!0),this.moveables.forEach(function(Be){Be.updateRect(r,!1,!1)});var o=this.props,c=this.moveables,f=s.target||o.target,d=c.map(function(Be){return{finded:!1,manager:Be}}),m=this.props.targetGroups||[],b=ZK(d,m),x=o.useDefaultGroupRotate;b.push.apply(b,yn([],Zt(d.filter(function(Be){var ot=Be.finded;return!ot}).map(function(Be){var ot=Be.manager;return ot})),!1));var E=[],T=!n||r!==""&&o.updateGroup,A=o.defaultGroupRotate||0;if(!this._hasFirstTargets){var R=(a=o.persistData)===null||a===void 0?void 0:a.rotation;R!=null&&(A=R)}function F(Be,ot,Ke){var it=Be.map(function(pr){if(su(pr)){var _t=F(pr,ot),vr=[_t.pos1,_t.pos2,_t.pos3,_t.pos4];return E.push(_t),{poses:vr,rotation:_t.rotation}}else return{poses:Wf(pr.state),rotation:pr.getRotation()}}),Me=it.map(function(pr){var _t=pr.rotation;return _t}),zt=0,st=Me[0],$e=Me.every(function(pr){return Math.abs(st-pr)<.1});T?zt=!x&&$e?st:A:zt=!x&&!Ke&&$e?st:ot;var Jt=it.map(function(pr){var _t=pr.poses;return _t}),Ht=R2e(Jt,zt);return Ht}var N=F(b,this.rotation,!0);T&&(this.rotation=N.rotation,this.transformOrigin=o.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=m,this.renderGroupRects=E;var O=this.transformOrigin,U=this.rotation,j=this.scale,H=N.width,W=N.height,X=N.minX,oe=N.minY,ee=Jxe([[0,0],[H,0],[0,W],[H,W]],JO(O,H,W),this.rotation/180*Math.PI),G=Qm(ee.result),ae=G.minX,se=G.minY,fe=" rotate(".concat(U,"deg)")+" scale(".concat(mc(j[0]),", ").concat(mc(j[1]),")"),pe="translate(".concat(-ae,"px, ").concat(-se,"px)").concat(fe);this.controlBox.style.transform="translate3d(".concat(X,"px, ").concat(oe,"px, ").concat(this.props.translateZ||0,")"),f.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(O,";")+"width:".concat(H,"px;height:").concat(W,"px;")+"transform: ".concat(pe),s.width=H,s.height=W;var De=this.getContainer(),ye=Ik(this.controlBox,f,this.controlBox,this.getContainer(),this._rootContainer||De,[]),we=[ye.left,ye.top],Te=Zt(Wf(ye),4),Re=Te[0],de=Te[1],Ee=Te[2],xe=Te[3],Ne=Qm([Re,de,Ee,xe]),Fe=[Ne.minX,Ne.minY],Xe=mc(j[0]*j[1]);ye.pos1=_i(Re,Fe),ye.pos2=_i(de,Fe),ye.pos3=_i(Ee,Fe),ye.pos4=_i(xe,Fe),ye.left=X-ye.left+Fe[0],ye.top=oe-ye.top+Fe[1],ye.origin=_i(Ra(we,ye.origin),Fe),ye.beforeOrigin=_i(Ra(we,ye.beforeOrigin),Fe),ye.originalBeforeOrigin=Ra(we,ye.originalBeforeOrigin),ye.transformOrigin=_i(Ra(we,ye.transformOrigin),Fe),f.style.transform="translate(".concat(-ae-Fe[0],"px, ").concat(-se-Fe[1],"px)")+fe,V0(),this.updateState(Wt(Wt({},ye),{posDelta:Fe,direction:Xe,beforeDirection:Xe}),i)},e.prototype.getRect=function(){return Wt(Wt({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.triggerEvent=function(r,n,i){if(i||r.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,r,n);this._emitter.trigger(r,n)},e.prototype.getRequestChildStyles=function(){var r=this.getEnabledAbles().reduce(function(n,i){var a,s,o=(s=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&s!==void 0?s:[];return yn(yn([],Zt(n),!1),Zt(o),!1)},[]);return r},e.prototype.getMoveables=function(){return yn([],Zt(this.moveables),!1)},e.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,yn(yn([],Zt(this.props.ables),!1),[rL],!1),"Group")},e.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=vd(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var r=this.state,n=this.props,i=this._prevDragTarget,a=n.dragTarget||this.areaElement,s=n.targets,o=this.differ.update(s),c=o.added,f=o.changed,d=o.removed,m=c.length||d.length;(m||this._prevOriginalDragTarget!==this._originalDragTarget)&&(l0(this,!1),l0(this,!0),this.updateState({gestos:{}})),i!==a&&(r.target=null),r.target||(r.target=this.areaElement,this.controlBox.style.display="block"),r.target&&(this.targetGesto||(this.targetGesto=GK(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=WK(this,"GroupControl")));var b=!Ck(r.container,n.container);b&&(r.container=n.container),(b||m||this.transformOrigin!==(n.defaultGroupOrigin||"50% 50%")||f.length||s.length&&!NK(this._targetGroups,n.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!m},e.prototype._updateObserver=function(){},e.defaultProps=Wt(Wt({},H0.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(H0),O2e=(function(t){Nx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.moveables=[],r}return e.prototype.render=function(){var r=this,n,i=this.props,a=i.cspNonce,s=i.cssStyled,o=i.persistData,c=i.targets||[],f=c.length,d=this.isUnmounted||!f,m=(n=o?.children)!==null&&n!==void 0?n:[];return d&&!f&&m.length?c=m.map(function(){return null}):d||(m=[]),te.createElement(s,{cspNonce:a,ref:zm(this,"controlBox"),className:yi("control-box")},c.map(function(b,x){var E,T,A=(T=(E=i.individualGroupableProps)===null||E===void 0?void 0:E.call(i,b,x))!==null&&T!==void 0?T:{};return te.createElement(H0,Wt({key:"moveable"+x,ref:EZ(r,"moveables",x)},i,A,{target:b,wrapperMoveable:r,isWrapperMounted:r.isMoveableMounted,persistData:m[x]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(r,n,i){i===void 0&&(i=!0),V0(!0),this.moveables.forEach(function(a){a.updateRect(r,n,i)}),V0()},e.prototype.getRect=function(){return Wt(Wt({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(r){return r.getRect()})})},e.prototype.request=function(r,n,i){n===void 0&&(n={});var a=this.moveables.map(function(c){return c.request(r,Wt(Wt({},n),{isInstant:!1}),!1)}),s=i||n.isInstant,o={request:function(c){return a.forEach(function(f){return f.request(c)}),this},requestEnd:function(){return a.forEach(function(c){return c.requestEnd()}),this}};return s?o.request(n).requestEnd():o},e.prototype.dragStart=function(r,n){n===void 0&&(n=r.target);var i=n,a=ff(this.moveables,function(s){var o=s.getTargets()[0],c=s.getControlBoxElement(),f=s.getDragElement();return!o||!f?!1:f===i||f.contains(i)||f!==o&&o===i||o.contains(i)||c===i||c.contains(i)});return a&&a.dragStart(r,n),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return yn([],Zt(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(H0);function KK(t,e){var r=[];return t.forEach(function(n){if(n){if(Ap(n)){e[n]&&r.push.apply(r,yn([],Zt(e[n]),!1));return}su(n)?r.push.apply(r,yn([],Zt(KK(n,e)),!1)):r.push(n)}}),r}function JK(t,e){var r=[];return t.forEach(function(n){if(n){if(Ap(n)){e[n]&&r.push.apply(r,yn([],Zt(e[n]),!1));return}su(n)?r.push(JK(n,e)):r.push(n)}}),r}function QK(t,e){return t.length!==e.length||t.some(function(r,n){var i=e[n];return!r&&!i?!1:r!=i?su(r)&&su(i)?QK(r,i):!0:!1})}var L2e=(function(t){Nx(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.refTargets=[],r.selectorMap={},r._differ=new FZ,r._elementTargets=[],r._tmpRefTargets=[],r._tmpSelectorMap={},r._onChangeTargets=null,r}return e.makeStyled=function(){var r={},n=this.getTotalAbles();n.forEach(function(a){var s=a.css;s&&s.forEach(function(o){r[o]=!0})});var i=p_(r).join(`
`);this.defaultStyled=UZ("div",Q_e(NO,_be+i))},e.getTotalAbles=function(){return yn([jK,rL,YK,zK],Zt(this.defaultAbles),!1)},e.prototype.render=function(){var r,n=this.constructor;n.defaultStyled||n.makeStyled();var i=this.props,a=i.ables,s=i.props,o=obe(i,["ables","props"]),c=Zt(this._updateRefs(!0),2),f=c[0],d=c[1],m=KK(f,d),b=m.length>1,x=n.getTotalAbles(),E=yn(yn([],Zt(x),!1),Zt(a||[]),!1),T=Wt(Wt(Wt({},o),s||{}),{ables:E,cssStyled:n.defaultStyled,customStyledMap:n.customStyledMap});this._elementTargets=m;var A=null,R=this.moveable,F=o.persistData;if(F?.children&&(b=!0),o.individualGroupable)return te.createElement(O2e,Wt({key:"individual-group",ref:zm(this,"moveable")},T,{target:null,targets:m}));if(b){var N=JK(f,d);if(R&&!R.props.groupable&&!R.props.individualGroupable){var O=R.props.target;O&&m.indexOf(O)>-1&&(A=Wt({},R.state))}return te.createElement(D2e,Wt({key:"group",ref:zm(this,"moveable")},T,(r=o.groupableProps)!==null&&r!==void 0?r:{},{target:null,targets:m,targetGroups:N,firstRenderState:A}))}else{var U=m[0];if(R&&(R.props.groupable||R.props.individualGroupable)){var j=R.moveables||[],H=ff(j,function(W){return W.props.target===U});H&&(A=Wt({},H.state))}return te.createElement(H0,Wt({key:"single",ref:zm(this,"moveable")},T,{target:U,firstRenderState:A}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var r,n;return(n=(r=this.moveable)===null||r===void 0?void 0:r.getTargets())!==null&&n!==void 0?n:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var r=this,n;return this._onChangeTargets=function(){r._onChangeTargets=null,n()},new Promise(function(i){n=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(r){var n=this.refTargets,i=KO(this.props.target||this.props.targets),a=typeof document<"u",s=QK(n,i),o=this.selectorMap,c={};return this.refTargets.forEach(function f(d){if(Ap(d)){var m=o[d];m?c[d]=o[d]:a&&(s=!0,c[d]=[].slice.call(document.querySelectorAll(d)))}else su(d)&&d.forEach(f)}),this._tmpRefTargets=i,this._tmpSelectorMap=c,[i,c,!r&&s]},e.prototype._checkChangeTargets=function(){var r,n,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),s=a.added,o=a.removed,c=s.length||o.length;c&&((n=(r=this.props).onChangeTargets)===null||n===void 0||n.call(r,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var f=Zt(this._updateRefs(),3),d=f[0],m=f[1],b=f[2];this.refTargets=d,this.selectorMap=m,b&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,sbe([e1e(wbe)],e.prototype,"moveable",void 0),e})(te.PureComponent),N2e=(function(t){Nx(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.defaultAbles=k2e,e})(L2e),Ku=63710088e-1,eJ={centimeters:Ku*100,centimetres:Ku*100,degrees:360/(2*Math.PI),feet:Ku*3.28084,inches:Ku*39.37,kilometers:Ku/1e3,kilometres:Ku/1e3,meters:Ku,metres:Ku,miles:Ku/1609.344,millimeters:Ku*1e3,millimetres:Ku*1e3,nauticalmiles:Ku/1852,radians:1,yards:Ku*1.0936};function ty(t,e,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function Xf(t,e,r={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!cj(t[0])||!cj(t[1]))throw new Error("coordinates must contain numbers");return ty({type:"Point",coordinates:t},e,r)}function c3(t,e,r={}){for(const i of t){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<i[i.length-1].length;a++)if(i[i.length-1][a]!==i[0][a])throw new Error("First and last Position are not equivalent.")}return ty({type:"Polygon",coordinates:t},e,r)}function Su(t,e,r={}){if(t.length<2)throw new Error("coordinates must be an array of two or more positions");return ty({type:"LineString",coordinates:t},e,r)}function xp(t,e={}){const r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function F2e(t,e,r={}){return ty({type:"MultiLineString",coordinates:t},e,r)}function tJ(t,e="kilometers"){const r=eJ[e];if(!r)throw new Error(e+" units is invalid");return t*r}function nL(t,e="kilometers"){const r=eJ[e];if(!r)throw new Error(e+" units is invalid");return t/r}function B2e(t,e){return sE(nL(t,e))}function sE(t){return t%(2*Math.PI)*180/Math.PI}function bh(t){return t%360*Math.PI/180}function cj(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function iL(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function Mg(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function rJ(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Hb(t){return t.type==="Feature"?t.geometry:t}function nJ(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}function Gb(t,e,r={}){if(r.final===!0)return z2e(t,e);const n=Mg(t),i=Mg(e),a=bh(n[0]),s=bh(i[0]),o=bh(n[1]),c=bh(i[1]),f=Math.sin(s-a)*Math.cos(c),d=Math.cos(o)*Math.sin(c)-Math.sin(o)*Math.cos(c)*Math.cos(s-a);return sE(Math.atan2(f,d))}function z2e(t,e){let r=Gb(e,t);return r=(r+180)%360,r}function G0(t,e,r,n={}){const i=Mg(t),a=bh(i[0]),s=bh(i[1]),o=bh(r),c=nL(e,n.units),f=Math.asin(Math.sin(s)*Math.cos(c)+Math.cos(s)*Math.sin(c)*Math.cos(o)),d=a+Math.atan2(Math.sin(o)*Math.sin(c)*Math.cos(s),Math.cos(c)-Math.sin(s)*Math.sin(f)),m=sE(d),b=sE(f);return Xf([m,b],n.properties)}function f3(t,e,r={}){var n=Mg(t),i=Mg(e),a=bh(i[1]-n[1]),s=bh(i[0]-n[0]),o=bh(n[1]),c=bh(i[1]),f=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(o)*Math.cos(c);return tJ(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),r.units)}function j2e(t,e,r={}){const i=Hb(t).coordinates;let a=0;for(let s=0;s<i.length&&!(e>=a&&s===i.length-1);s++)if(a>=e){const o=e-a;if(o){const c=Gb(i[s],i[s-1])-180;return G0(i[s],o,c,r)}else return Xf(i[s])}else a+=f3(i[s],i[s+1],r);return Xf(i[i.length-1])}function v_(t,e,r){if(t!==null)for(var n,i,a,s,o,c,f,d=0,m=0,b,x=t.type,E=x==="FeatureCollection",T=x==="Feature",A=E?t.features.length:1,R=0;R<A;R++){f=E?t.features[R].geometry:T?t.geometry:t,b=f?f.type==="GeometryCollection":!1,o=b?f.geometries.length:1;for(var F=0;F<o;F++){var N=0,O=0;if(s=b?f.geometries[F]:f,s!==null){c=s.coordinates;var U=s.type;switch(d=r&&(U==="Polygon"||U==="MultiPolygon")?1:0,U){case null:break;case"Point":if(e(c,m,R,N,O)===!1)return!1;m++,N++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(e(c[n],m,R,N,O)===!1)return!1;m++,U==="MultiPoint"&&N++}U==="LineString"&&N++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(i=0;i<c[n].length-d;i++){if(e(c[n][i],m,R,N,O)===!1)return!1;m++}U==="MultiLineString"&&N++,U==="Polygon"&&O++}U==="Polygon"&&N++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(O=0,i=0;i<c[n].length;i++){for(a=0;a<c[n][i].length-d;a++){if(e(c[n][i][a],m,R,N,O)===!1)return!1;m++}O++}N++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(v_(s.geometries[n],e,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function fj(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var r=0;r<t.features.length&&e(t.features[r],r)!==!1;r++);}function h3(t,e){var r,n,i,a,s,o,c,f,d,m,b=0,x=t.type==="FeatureCollection",E=t.type==="Feature",T=x?t.features.length:1;for(r=0;r<T;r++){for(o=x?t.features[r].geometry:E?t.geometry:t,f=x?t.features[r].properties:E?t.properties:{},d=x?t.features[r].bbox:E?t.bbox:void 0,m=x?t.features[r].id:E?t.id:void 0,c=o?o.type==="GeometryCollection":!1,s=c?o.geometries.length:1,i=0;i<s;i++){if(a=c?o.geometries[i]:o,a===null){if(e(null,b,f,d,m)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,b,f,d,m)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(e(a.geometries[n],b,f,d,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}b++}}function U2e(t,e,r){var n=r;return h3(t,function(i,a,s,o,c){n=e(n,i,a,s,o,c)}),n}function aL(t,e){h3(t,function(r,n,i,a,s){var o=r===null?null:r.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return e(ty(r,i,{bbox:a,id:s}),n,0)===!1?!1:void 0}var c;switch(o){case"MultiPoint":c="Point";break;case"MultiLineString":c="LineString";break;case"MultiPolygon":c="Polygon";break}for(var f=0;f<r.coordinates.length;f++){var d=r.coordinates[f],m={type:c,coordinates:d};if(e(ty(m,i),n,f)===!1)return!1}})}function V2e(t,e){aL(t,function(r,n,i){var a=0;if(r.geometry){var s=r.geometry.type;if(!(s==="Point"||s==="MultiPoint")){var o,c=0,f=0,d=0;if(v_(r,function(m,b,x,E,T){if(o===void 0||n>c||E>f||T>d){o=m,c=n,f=E,d=T,a=0;return}var A=Su([o,m],r.properties);if(e(A,n,i,T,a)===!1)return!1;a++,o=m})===!1)return!1}}})}function $2e(t,e,r){var n=r,i=!1;return V2e(t,function(a,s,o,c,f){i===!1&&r===void 0?n=a:n=e(n,a,s,o,c,f),i=!0}),n}function q2e(t){return U2e(t,(e,r)=>e+H2e(r),0)}function H2e(t){let e=0,r;switch(t.type){case"Polygon":return hj(t.coordinates);case"MultiPolygon":for(r=0;r<t.coordinates.length;r++)e+=hj(t.coordinates[r]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function hj(t){let e=0;if(t&&t.length>0){e+=Math.abs(dj(t[0]));for(let r=1;r<t.length;r++)e-=Math.abs(dj(t[r]))}return e}var G2e=Ku*Ku/2,a5=Math.PI/180;function dj(t){const e=t.length-1;if(e<=2)return 0;let r=0,n=0;for(;n<e;){const i=t[n],a=t[n+1===e?0:n+1],s=t[n+2>=e?(n+2)%e:n+2],o=i[0]*a5,c=a[1]*a5,f=s[0]*a5;r+=(f-o)*Math.sin(c),n++}return r*G2e}function df(t,e={}){if(t.bbox!=null&&e.recompute!==!0)return t.bbox;const r=[1/0,1/0,-1/0,-1/0];return v_(t,n=>{r[0]>n[0]&&(r[0]=n[0]),r[1]>n[1]&&(r[1]=n[1]),r[2]<n[0]&&(r[2]=n[0]),r[3]<n[1]&&(r[3]=n[1])}),r}function pj(t,e={}){const r=Number(t[0]),n=Number(t[1]),i=Number(t[2]),a=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const s=[r,n];return c3([[s,[i,n],[i,a],[r,a],s]],e.properties,{bbox:t,id:e.id})}const pp=11102230246251565e-32,Wu=134217729,W2e=(3+8*pp)*pp;function o5(t,e,r,n,i){let a,s,o,c,f=e[0],d=n[0],m=0,b=0;d>f==d>-f?(a=f,f=e[++m]):(a=d,d=n[++b]);let x=0;if(m<t&&b<r)for(d>f==d>-f?(s=f+a,o=a-(s-f),f=e[++m]):(s=d+a,o=a-(s-d),d=n[++b]),a=s,o!==0&&(i[x++]=o);m<t&&b<r;)d>f==d>-f?(s=a+f,c=s-a,o=a-(s-c)+(f-c),f=e[++m]):(s=a+d,c=s-a,o=a-(s-c)+(d-c),d=n[++b]),a=s,o!==0&&(i[x++]=o);for(;m<t;)s=a+f,c=s-a,o=a-(s-c)+(f-c),f=e[++m],a=s,o!==0&&(i[x++]=o);for(;b<r;)s=a+d,c=s-a,o=a-(s-c)+(d-c),d=n[++b],a=s,o!==0&&(i[x++]=o);return(a!==0||x===0)&&(i[x++]=a),x}function X2e(t,e){let r=e[0];for(let n=1;n<t;n++)r+=e[n];return r}function jx(t){return new Float64Array(t)}const Y2e=(3+16*pp)*pp,Z2e=(2+12*pp)*pp,K2e=(9+64*pp)*pp*pp,mv=jx(4),gj=jx(8),mj=jx(12),yj=jx(16),hc=jx(4);function J2e(t,e,r,n,i,a,s){let o,c,f,d,m,b,x,E,T,A,R,F,N,O,U,j,H,W;const X=t-i,oe=r-i,ee=e-a,G=n-a;O=X*G,b=Wu*X,x=b-(b-X),E=X-x,b=Wu*G,T=b-(b-G),A=G-T,U=E*A-(O-x*T-E*T-x*A),j=ee*oe,b=Wu*ee,x=b-(b-ee),E=ee-x,b=Wu*oe,T=b-(b-oe),A=oe-T,H=E*A-(j-x*T-E*T-x*A),R=U-H,m=U-R,mv[0]=U-(R+m)+(m-H),F=O+R,m=F-O,N=O-(F-m)+(R-m),R=N-j,m=N-R,mv[1]=N-(R+m)+(m-j),W=F+R,m=W-F,mv[2]=F-(W-m)+(R-m),mv[3]=W;let ae=X2e(4,mv),se=Z2e*s;if(ae>=se||-ae>=se||(m=t-X,o=t-(X+m)+(m-i),m=r-oe,f=r-(oe+m)+(m-i),m=e-ee,c=e-(ee+m)+(m-a),m=n-G,d=n-(G+m)+(m-a),o===0&&c===0&&f===0&&d===0)||(se=K2e*s+W2e*Math.abs(ae),ae+=X*d+G*o-(ee*f+oe*c),ae>=se||-ae>=se))return ae;O=o*G,b=Wu*o,x=b-(b-o),E=o-x,b=Wu*G,T=b-(b-G),A=G-T,U=E*A-(O-x*T-E*T-x*A),j=c*oe,b=Wu*c,x=b-(b-c),E=c-x,b=Wu*oe,T=b-(b-oe),A=oe-T,H=E*A-(j-x*T-E*T-x*A),R=U-H,m=U-R,hc[0]=U-(R+m)+(m-H),F=O+R,m=F-O,N=O-(F-m)+(R-m),R=N-j,m=N-R,hc[1]=N-(R+m)+(m-j),W=F+R,m=W-F,hc[2]=F-(W-m)+(R-m),hc[3]=W;const fe=o5(4,mv,4,hc,gj);O=X*d,b=Wu*X,x=b-(b-X),E=X-x,b=Wu*d,T=b-(b-d),A=d-T,U=E*A-(O-x*T-E*T-x*A),j=ee*f,b=Wu*ee,x=b-(b-ee),E=ee-x,b=Wu*f,T=b-(b-f),A=f-T,H=E*A-(j-x*T-E*T-x*A),R=U-H,m=U-R,hc[0]=U-(R+m)+(m-H),F=O+R,m=F-O,N=O-(F-m)+(R-m),R=N-j,m=N-R,hc[1]=N-(R+m)+(m-j),W=F+R,m=W-F,hc[2]=F-(W-m)+(R-m),hc[3]=W;const pe=o5(fe,gj,4,hc,mj);O=o*d,b=Wu*o,x=b-(b-o),E=o-x,b=Wu*d,T=b-(b-d),A=d-T,U=E*A-(O-x*T-E*T-x*A),j=c*f,b=Wu*c,x=b-(b-c),E=c-x,b=Wu*f,T=b-(b-f),A=f-T,H=E*A-(j-x*T-E*T-x*A),R=U-H,m=U-R,hc[0]=U-(R+m)+(m-H),F=O+R,m=F-O,N=O-(F-m)+(R-m),R=N-j,m=N-R,hc[1]=N-(R+m)+(m-j),W=F+R,m=W-F,hc[2]=F-(W-m)+(R-m),hc[3]=W;const De=o5(pe,mj,4,hc,yj);return yj[De-1]}function Q2e(t,e,r,n,i,a){const s=(e-a)*(r-i),o=(t-i)*(n-a),c=s-o,f=Math.abs(s+o);return Math.abs(c)>=Y2e*f?c:-J2e(t,e,r,n,i,a,f)}function ewe(t,e){var r,n,i=0,a,s,o,c,f,d,m,b=t[0],x=t[1],E=e.length;for(r=0;r<E;r++){n=0;var T=e[r],A=T.length-1;if(d=T[0],d[0]!==T[A][0]&&d[1]!==T[A][1])throw new Error("First and last coordinates in a ring must be the same");for(s=d[0]-b,o=d[1]-x,n;n<A;n++){if(m=T[n+1],c=m[0]-b,f=m[1]-x,o===0&&f===0){if(c<=0&&s>=0||s<=0&&c>=0)return 0}else if(f>=0&&o<=0||f<=0&&o>=0){if(a=Q2e(s,c,o,f,0,0),a===0)return 0;(a>0&&f>0&&o<=0||a<0&&f<=0&&o>0)&&i++}d=m,o=f,s=c}}return i%2!==0}function d3(t,e,r={}){if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");const n=Mg(t),i=Hb(e),a=i.type,s=e.bbox;let o=i.coordinates;if(s&&twe(n,s)===!1)return!1;a==="Polygon"&&(o=[o]);let c=!1;for(var f=0;f<o.length;++f){const d=ewe(n,o[f]);if(d===0)return!r.ignoreBoundary;d&&(c=!0)}return c}function twe(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}function Wb(t,e,r={}){const n=Mg(t),i=rJ(e);for(let a=0;a<i.length-1;a++){let s=!1;if(r.ignoreEndVertices&&(a===0&&(s="start"),a===i.length-2&&(s="end"),a===0&&a+1===i.length-1&&(s="both")),rwe(i[a],i[a+1],n,s,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}function rwe(t,e,r,n,i){const a=r[0],s=r[1],o=t[0],c=t[1],f=e[0],d=e[1],m=r[0]-o,b=r[1]-c,x=f-o,E=d-c,T=m*E-b*x;if(i!==null){if(Math.abs(T)>i)return!1}else if(T!==0)return!1;if(Math.abs(x)===Math.abs(E)&&Math.abs(x)===0)return n?!1:r[0]===t[0]&&r[1]===t[1];if(n){if(n==="start")return Math.abs(x)>=Math.abs(E)?x>0?o<a&&a<=f:f<=a&&a<o:E>0?c<s&&s<=d:d<=s&&s<c;if(n==="end")return Math.abs(x)>=Math.abs(E)?x>0?o<=a&&a<f:f<a&&a<=o:E>0?c<=s&&s<d:d<s&&s<=c;if(n==="both")return Math.abs(x)>=Math.abs(E)?x>0?o<a&&a<f:f<a&&a<o:E>0?c<s&&s<d:d<s&&s<c}else return Math.abs(x)>=Math.abs(E)?x>0?o<=a&&a<=f:f<=a&&a<=o:E>0?c<=s&&s<=d:d<=s&&s<=c;return!1}function nwe(t,e){const r=Hb(t),n=Hb(e),i=r.type,a=n.type,s=r.coordinates,o=n.coordinates;switch(i){case"Point":switch(a){case"Point":return oL(s,o);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPoint":switch(a){case"Point":return awe(r,n);case"MultiPoint":return owe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"LineString":switch(a){case"Point":return Wb(n,r,{ignoreEndVertices:!0});case"LineString":return uwe(r,n);case"MultiPoint":return swe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"Polygon":switch(a){case"Point":return d3(n,r,{ignoreBoundary:!0});case"LineString":return cwe(r,n);case"Polygon":return iJ(r,n);case"MultiPoint":return lwe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPolygon":switch(a){case"Polygon":return iwe(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function iwe(t,e){return t.coordinates.some(r=>iJ({type:"Polygon",coordinates:r},e))}function awe(t,e){let r,n=!1;for(r=0;r<t.coordinates.length;r++)if(oL(t.coordinates[r],e.coordinates)){n=!0;break}return n}function owe(t,e){for(const r of e.coordinates){let n=!1;for(const i of t.coordinates)if(oL(r,i)){n=!0;break}if(!n)return!1}return!0}function swe(t,e){let r=!1;for(const n of e.coordinates)if(Wb(n,t,{ignoreEndVertices:!0})&&(r=!0),!Wb(n,t))return!1;return!!r}function lwe(t,e){for(const r of e.coordinates)if(!d3(r,t,{ignoreBoundary:!0}))return!1;return!0}function uwe(t,e){let r=!1;for(const n of e.coordinates)if(Wb({type:"Point",coordinates:n},t,{ignoreEndVertices:!0})&&(r=!0),!Wb({type:"Point",coordinates:n},t,{ignoreEndVertices:!1}))return!1;return r}function cwe(t,e){let r=!1,n=0;const i=df(t),a=df(e);if(!aJ(i,a))return!1;for(n;n<e.coordinates.length-1;n++){const s=fwe(e.coordinates[n],e.coordinates[n+1]);if(d3({type:"Point",coordinates:s},t,{ignoreBoundary:!0})){r=!0;break}}return r}function iJ(t,e){if(t.type==="Feature"&&t.geometry===null||e.type==="Feature"&&e.geometry===null)return!1;const r=df(t),n=df(e);if(!aJ(r,n))return!1;const i=Hb(e).coordinates;for(const a of i)for(const s of a)if(!d3(s,t))return!1;return!0}function aJ(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function oL(t,e){return t[0]===e[0]&&t[1]===e[1]}function fwe(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function hwe(t,e={}){const r=df(t),n=(r[0]+r[2])/2,i=(r[1]+r[3])/2;return Xf([n,i],e.properties,e)}var dS={exports:{}},dwe=dS.exports,vj;function pwe(){return vj||(vj=1,(function(t,e){(function(r,n){t.exports=n()})(dwe,(function(){function r(I,y){(y==null||y>I.length)&&(y=I.length);for(var _=0,P=Array(y);_<y;_++)P[_]=I[_];return P}function n(I,y,_){return y=d(y),(function(P,$){if($&&(typeof $=="object"||typeof $=="function"))return $;if($!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(ne){if(ne===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne})(P)})(I,b()?Reflect.construct(y,_||[],d(I).constructor):y.apply(I,_))}function i(I,y){if(!(I instanceof y))throw new TypeError("Cannot call a class as a function")}function a(I,y,_){if(b())return Reflect.construct.apply(null,arguments);var P=[null];P.push.apply(P,y);var $=new(I.bind.apply(I,P));return _&&x($,_.prototype),$}function s(I,y){for(var _=0;_<y.length;_++){var P=y[_];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(I,A(P.key),P)}}function o(I,y,_){return y&&s(I.prototype,y),_&&s(I,_),Object.defineProperty(I,"prototype",{writable:!1}),I}function c(I,y){var _=typeof Symbol<"u"&&I[Symbol.iterator]||I["@@iterator"];if(!_){if(Array.isArray(I)||(_=R(I))||y){_&&(I=_);var P=0,$=function(){};return{s:$,n:function(){return P>=I.length?{done:!0}:{done:!1,value:I[P++]}},e:function(tt){throw tt},f:$}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ne,ve=!0,Oe=!1;return{s:function(){_=_.call(I)},n:function(){var tt=_.next();return ve=tt.done,tt},e:function(tt){Oe=!0,ne=tt},f:function(){try{ve||_.return==null||_.return()}finally{if(Oe)throw ne}}}}function f(){return f=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(I,y,_){var P=(function(ne,ve){for(;!{}.hasOwnProperty.call(ne,ve)&&(ne=d(ne))!==null;);return ne})(I,y);if(P){var $=Object.getOwnPropertyDescriptor(P,y);return $.get?$.get.call(arguments.length<3?I:_):$.value}},f.apply(null,arguments)}function d(I){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(y){return y.__proto__||Object.getPrototypeOf(y)},d(I)}function m(I,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");I.prototype=Object.create(y&&y.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),Object.defineProperty(I,"prototype",{writable:!1}),y&&x(I,y)}function b(){try{var I=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(b=function(){return!!I})()}function x(I,y){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,P){return _.__proto__=P,_},x(I,y)}function E(I,y,_,P){var $=f(d(1&P?I.prototype:I),y,_);return 2&P&&typeof $=="function"?function(ne){return $.apply(_,ne)}:$}function T(I){return(function(y){if(Array.isArray(y))return r(y)})(I)||(function(y){if(typeof Symbol<"u"&&y[Symbol.iterator]!=null||y["@@iterator"]!=null)return Array.from(y)})(I)||R(I)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function A(I){var y=(function(_,P){if(typeof _!="object"||!_)return _;var $=_[Symbol.toPrimitive];if($!==void 0){var ne=$.call(_,P);if(typeof ne!="object")return ne;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)})(I,"string");return typeof y=="symbol"?y:y+""}function R(I,y){if(I){if(typeof I=="string")return r(I,y);var _={}.toString.call(I).slice(8,-1);return _==="Object"&&I.constructor&&(_=I.constructor.name),_==="Map"||_==="Set"?Array.from(I):_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_)?r(I,y):void 0}}function F(I){var y=typeof Map=="function"?new Map:void 0;return F=function(_){if(_===null||!(function($){try{return Function.toString.call($).indexOf("[native code]")!==-1}catch{return typeof $=="function"}})(_))return _;if(typeof _!="function")throw new TypeError("Super expression must either be null or a function");if(y!==void 0){if(y.has(_))return y.get(_);y.set(_,P)}function P(){return a(_,arguments,d(this).constructor)}return P.prototype=Object.create(_.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),x(P,_)},F(I)}var N=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(y){this._quadrantSegments=y,this._quadrantSegments===0&&(this._joinStyle=I.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=I.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),y<=0&&(this._quadrantSegments=1),this._joinStyle!==I.JOIN_ROUND&&(this._quadrantSegments=I.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(y){this._joinStyle=y}},{key:"setSimplifyFactor",value:function(y){this._simplifyFactor=y<0?0:y}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(y){this._endCapStyle=y}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(y){this._mitreLimit=y}},{key:"setSingleSided",value:function(y){this._isSingleSided=y}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=I.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=I.CAP_ROUND,this._joinStyle=I.JOIN_ROUND,this._mitreLimit=I.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=I.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var y=arguments[0];this.setQuadrantSegments(y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.setQuadrantSegments(_),this.setEndCapStyle(P)}else if(arguments.length===4){var $=arguments[0],ne=arguments[1],ve=arguments[2],Oe=arguments[3];this.setQuadrantSegments($),this.setEndCapStyle(ne),this.setJoinStyle(ve),this.setMitreLimit(Oe)}}}},{key:"bufferDistanceError",value:function(y){var _=Math.PI/2/y;return 1-Math.cos(_/2)}}])})();N.CAP_ROUND=1,N.CAP_FLAT=2,N.CAP_SQUARE=3,N.JOIN_ROUND=1,N.JOIN_MITRE=2,N.JOIN_BEVEL=3,N.DEFAULT_QUADRANT_SEGMENTS=8,N.DEFAULT_MITRE_LIMIT=5,N.DEFAULT_SIMPLIFY_FACTOR=.01;var O=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({Exception:y})[0],P}return m(y,I),o(y,[{key:"toString",value:function(){return this.message}}])})(F(Error)),U=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({IllegalArgumentException:y})[0],P}return m(y,I),o(y)})(O),j=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I){}}])})();function H(){}function W(){}function X(){}var oe,ee,G,ae,se,fe,pe,De,ye=(function(){return o((function I(){i(this,I)}),null,[{key:"equalsWithTolerance",value:function(I,y,_){return Math.abs(I-y)<=_}}])})(),we=(function(){return o((function I(y,_){i(this,I),this.low=_||0,this.high=y||0}),null,[{key:"toBinaryString",value:function(I){var y,_="";for(y=2147483648;y>0;y>>>=1)_+=(I.high&y)===y?"1":"0";for(y=2147483648;y>0;y>>>=1)_+=(I.low&y)===y?"1":"0";return _}}])})();function Te(){}function Re(){}Te.NaN=NaN,Te.isNaN=function(I){return Number.isNaN(I)},Te.isInfinite=function(I){return!Number.isFinite(I)},Te.MAX_VALUE=Number.MAX_VALUE,Te.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Te.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(fe=2146435072,pe=new Float64Array(1),De=new Int32Array(pe.buffer),Te.doubleToLongBits=function(I){pe[0]=I;var y=0|De[0],_=0|De[1];return(_&fe)===fe&&1048575&_&&y!==0&&(y=0,_=2146959360),new we(_,y)},Te.longBitsToDouble=function(I){return De[0]=I.low,De[1]=I.high,pe[0]}):(oe=1023,ee=Math.log2,G=Math.floor,ae=Math.pow,se=(function(){for(var I=53;I>0;I--){var y=ae(2,I)-1;if(G(ee(y))+1===I)return y}return 0})(),Te.doubleToLongBits=function(I){var y,_,P,$,ne,ve,Oe,tt,ft;if(I<0||1/I===Number.NEGATIVE_INFINITY?(ve=1<<31,I=-I):ve=0,I===0)return new we(tt=ve,ft=0);if(I===1/0)return new we(tt=2146435072|ve,ft=0);if(I!=I)return new we(tt=2146959360,ft=0);if($=0,ft=0,(y=G(I))>1)if(y<=se)($=G(ee(y)))<=20?(ft=0,tt=y<<20-$&1048575):(ft=y%(_=ae(2,P=$-20))<<32-P,tt=y/_&1048575);else for(P=y,ft=0;(P=G(_=P/2))!==0;)$++,ft>>>=1,ft|=(1&tt)<<31,tt>>>=1,_!==P&&(tt|=524288);if(Oe=$+oe,ne=y===0,y=I-y,$<52&&y!==0)for(P=0;;){if((_=2*y)>=1?(y=_-1,ne?(Oe--,ne=!1):(P<<=1,P|=1,$++)):(y=_,ne?--Oe==0&&($++,ne=!1):(P<<=1,$++)),$===20)tt|=P,P=0;else if($===52){ft|=P;break}if(_===1){$<20?tt|=P<<20-$:$<52&&(ft|=P<<52-$);break}}return tt|=Oe<<20,new we(tt|=ve,ft)},Te.longBitsToDouble=function(I){var y,_,P,$,ne=I.high,ve=I.low,Oe=ne&1<<31?-1:1;for(P=((2146435072&ne)>>20)-oe,$=0,_=1<<19,y=1;y<=20;y++)ne&_&&($+=ae(2,-y)),_>>>=1;for(_=1<<31,y=21;y<=52;y++)ve&_&&($+=ae(2,-y)),_>>>=1;if(P===-1023){if($===0)return 0*Oe;P=-1022}else{if(P===1024)return $===0?Oe/0:NaN;$+=1}return Oe*$*ae(2,P)});var de=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({RuntimeException:y})[0],P}return m(y,I),o(y)})(O),Ee=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,null,[{key:"constructor_",value:function(){if(arguments.length===0)de.constructor_.call(this);else if(arguments.length===1){var _=arguments[0];de.constructor_.call(this,_)}}}])})(de),xe=(function(){function I(){i(this,I)}return o(I,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)I.shouldNeverReachHere(null);else if(arguments.length===1){var y=arguments[0];throw new Ee("Should never reach here"+(y!==null?": "+y:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var y=arguments[0];I.isTrue(y,null)}else if(arguments.length===2){var _=arguments[1];if(!arguments[0])throw _===null?new Ee:new Ee(_)}}},{key:"equals",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];I.equals(y,_,null)}else if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2];if(!$.equals(P))throw new Ee("Expected "+P+" but encountered "+$+(ne!==null?": "+ne:""))}}}])})(),Ne=new ArrayBuffer(8),Fe=new Float64Array(Ne),Xe=new Int32Array(Ne),Be=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getM",value:function(){return Te.NaN}},{key:"setOrdinate",value:function(y,_){switch(y){case I.X:this.x=_;break;case I.Y:this.y=_;break;case I.Z:this.setZ(_);break;default:throw new U("Invalid ordinate index: "+y)}}},{key:"equals2D",value:function(){if(arguments.length===1){var y=arguments[0];return this.x===y.x&&this.y===y.y}if(arguments.length===2){var _=arguments[0],P=arguments[1];return!!ye.equalsWithTolerance(this.x,_.x,P)&&!!ye.equalsWithTolerance(this.y,_.y,P)}}},{key:"setM",value:function(y){throw new U("Invalid ordinate index: "+I.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(y){switch(y){case I.X:return this.x;case I.Y:return this.y;case I.Z:return this.getZ()}throw new U("Invalid ordinate index: "+y)}},{key:"equals3D",value:function(y){return this.x===y.x&&this.y===y.y&&(this.getZ()===y.getZ()||Te.isNaN(this.getZ())&&Te.isNaN(y.getZ()))}},{key:"equals",value:function(y){return y instanceof I&&this.equals2D(y)}},{key:"equalInZ",value:function(y,_){return ye.equalsWithTolerance(this.getZ(),y.getZ(),_)}},{key:"setX",value:function(y){this.x=y}},{key:"compareTo",value:function(y){var _=y;return this.x<_.x?-1:this.x>_.x?1:this.y<_.y?-1:this.y>_.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(y){this.z=y}},{key:"clone",value:function(){try{return null}catch(y){if(y instanceof CloneNotSupportedException)return xe.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw y}}},{key:"copy",value:function(){return new I(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(y){var _=this.x-y.x,P=this.y-y.y,$=this.getZ()-y.getZ();return Math.sqrt(_*_+P*P+$*$)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(y){this.y=y}},{key:"distance",value:function(y){var _=this.x-y.x,P=this.y-y.y;return Math.sqrt(_*_+P*P)}},{key:"hashCode",value:function(){var y=17;return y=37*(y=37*y+I.hashCode(this.x))+I.hashCode(this.y)}},{key:"setCoordinate",value:function(y){this.x=y.x,this.y=y.y,this.z=y.getZ()}},{key:"interfaces_",get:function(){return[H,W,X]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)I.constructor_.call(this,0,0);else if(arguments.length===1){var y=arguments[0];I.constructor_.call(this,y.x,y.y,y.getZ())}else if(arguments.length===2){var _=arguments[0],P=arguments[1];I.constructor_.call(this,_,P,I.NULL_ORDINATE)}else if(arguments.length===3){var $=arguments[0],ne=arguments[1],ve=arguments[2];this.x=$,this.y=ne,this.z=ve}}},{key:"hashCode",value:function(y){return Fe[0]=y,Xe[0]^Xe[1]}}])})(),ot=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"compare",value:function(y,_){var P=I.compare(y.x,_.x);if(P!==0)return P;var $=I.compare(y.y,_.y);return $!==0?$:this._dimensionsToTest<=2?0:I.compare(y.getZ(),_.getZ())}},{key:"interfaces_",get:function(){return[Re]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)I.constructor_.call(this,2);else if(arguments.length===1){var y=arguments[0];if(y!==2&&y!==3)throw new U("only 2 or 3 dimensions may be specified");this._dimensionsToTest=y}}},{key:"compare",value:function(y,_){return y<_?-1:y>_?1:Te.isNaN(y)?Te.isNaN(_)?0:-1:Te.isNaN(_)?1:0}}])})();Be.DimensionalComparator=ot,Be.NULL_ORDINATE=Te.NaN,Be.X=0,Be.Y=1,Be.Z=2,Be.M=3;var Ke=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(y){if(!(y instanceof I))return!1;var _=y;return this.isNull()?_.isNull():this._maxx===_.getMaxX()&&this._maxy===_.getMaxY()&&this._minx===_.getMinX()&&this._miny===_.getMinY()}},{key:"intersection",value:function(y){if(this.isNull()||y.isNull()||!this.intersects(y))return new I;var _=this._minx>y._minx?this._minx:y._minx,P=this._miny>y._miny?this._miny:y._miny;return new I(_,this._maxx<y._maxx?this._maxx:y._maxx,P,this._maxy<y._maxy?this._maxy:y._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];return this.covers(y.x,y.y)}if(arguments[0]instanceof I){var _=arguments[0];return!this.isNull()&&!_.isNull()&&_.getMinX()>=this._minx&&_.getMaxX()<=this._maxx&&_.getMinY()>=this._miny&&_.getMaxY()<=this._maxy}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];return!this.isNull()&&P>=this._minx&&P<=this._maxx&&$>=this._miny&&$<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return!this.isNull()&&!y.isNull()&&!(y._minx>this._maxx||y._maxx<this._minx||y._miny>this._maxy||y._maxy<this._miny)}if(arguments[0]instanceof Be){var _=arguments[0];return this.intersects(_.x,_.y)}}else if(arguments.length===2){if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var P=arguments[0],$=arguments[1];return!this.isNull()&&!((P.x<$.x?P.x:$.x)>this._maxx)&&!((P.x>$.x?P.x:$.x)<this._minx)&&!((P.y<$.y?P.y:$.y)>this._maxy)&&!((P.y>$.y?P.y:$.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var ne=arguments[0],ve=arguments[1];return!this.isNull()&&!(ne>this._maxx||ne<this._minx||ve>this._maxy||ve<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return Math.sqrt(y*y+_*_)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];this.expandToInclude(y.x,y.y)}else if(arguments[0]instanceof I){var _=arguments[0];if(_.isNull())return null;this.isNull()?(this._minx=_.getMinX(),this._maxx=_.getMaxX(),this._miny=_.getMinY(),this._maxy=_.getMaxY()):(_._minx<this._minx&&(this._minx=_._minx),_._maxx>this._maxx&&(this._maxx=_._maxx),_._miny<this._miny&&(this._miny=_._miny),_._maxy>this._maxy&&(this._maxy=_._maxy))}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.isNull()?(this._minx=P,this._maxx=P,this._miny=$,this._maxy=$):(P<this._minx&&(this._minx=P),P>this._maxx&&(this._maxx=P),$<this._miny&&(this._miny=$),$>this._maxy&&(this._maxy=$))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return y<_?y:_}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(y){var _=y;return this.isNull()?_.isNull()?0:-1:_.isNull()?1:this._minx<_._minx?-1:this._minx>_._minx?1:this._miny<_._miny?-1:this._miny>_._miny?1:this._maxx<_._maxx?-1:this._maxx>_._maxx?1:this._maxy<_._maxy?-1:this._maxy>_._maxy?1:0}},{key:"translate",value:function(y,_){if(this.isNull())return null;this.init(this.getMinX()+y,this.getMaxX()+y,this.getMinY()+_,this.getMaxY()+_)}},{key:"copy",value:function(){return new I(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(y){return!(!this.isNull()&&!y.isNull())||y._minx>this._maxx||y._maxx<this._minx||y._miny>this._maxy||y._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var y=this.getWidth(),_=this.getHeight();return y>_?y:_}},{key:"expandBy",value:function(){if(arguments.length===1){var y=arguments[0];this.expandBy(y,y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];if(this.isNull())return null;this._minx-=_,this._maxx+=_,this._miny-=P,this._maxy+=P,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.covers(y)}if(arguments[0]instanceof Be){var _=arguments[0];return this.covers(_)}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];return this.covers(P,$)}}},{key:"centre",value:function(){return this.isNull()?null:new Be((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];this.init(y.x,y.x,y.y,y.y)}else if(arguments[0]instanceof I){var _=arguments[0];this._minx=_._minx,this._maxx=_._maxx,this._miny=_._miny,this._maxy=_._maxy}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.init(P.x,$.x,P.y,$.y)}else if(arguments.length===4){var ne=arguments[0],ve=arguments[1],Oe=arguments[2],tt=arguments[3];ne<ve?(this._minx=ne,this._maxx=ve):(this._minx=ve,this._maxx=ne),Oe<tt?(this._miny=Oe,this._maxy=tt):(this._miny=tt,this._maxy=Oe)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(y){if(this.intersects(y))return 0;var _=0;this._maxx<y._minx?_=y._minx-this._maxx:this._minx>y._maxx&&(_=this._minx-y._maxx);var P=0;return this._maxy<y._miny?P=y._miny-this._maxy:this._miny>y._maxy&&(P=this._miny-y._maxy),_===0?P:P===0?_:Math.sqrt(_*_+P*P)}},{key:"hashCode",value:function(){var y=17;return y=37*(y=37*(y=37*(y=37*y+Be.hashCode(this._minx))+Be.hashCode(this._maxx))+Be.hashCode(this._miny))+Be.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[H,X]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];this.init(y.x,y.x,y.y,y.y)}else if(arguments[0]instanceof I){var _=arguments[0];this.init(_)}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.init(P.x,$.x,P.y,$.y)}else if(arguments.length===4){var ne=arguments[0],ve=arguments[1],Oe=arguments[2],tt=arguments[3];this.init(ne,ve,Oe,tt)}}},{key:"intersects",value:function(){if(arguments.length===3){var y=arguments[0],_=arguments[1],P=arguments[2];return P.x>=(y.x<_.x?y.x:_.x)&&P.x<=(y.x>_.x?y.x:_.x)&&P.y>=(y.y<_.y?y.y:_.y)&&P.y<=(y.y>_.y?y.y:_.y)}if(arguments.length===4){var $=arguments[0],ne=arguments[1],ve=arguments[2],Oe=arguments[3],tt=Math.min(ve.x,Oe.x),ft=Math.max(ve.x,Oe.x),rr=Math.min($.x,ne.x),ur=Math.max($.x,ne.x);return!(rr>ft)&&!(ur<tt)&&(tt=Math.min(ve.y,Oe.y),ft=Math.max(ve.y,Oe.y),rr=Math.min($.y,ne.y),ur=Math.max($.y,ne.y),!(rr>ft)&&!(ur<tt))}}}])})(),it=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===I.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(y){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(y){return this===y||this.equalsExact(y,0)}},{key:"geometryChanged",value:function(){this.apply(I.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(y){return y!==null&&this.norm().equalsExact(y.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var y;if(arguments.length===1){var _=arguments[0];return y=_,this.getTypeCode()!==y.getTypeCode()?this.getTypeCode()-y.getTypeCode():this.isEmpty()&&y.isEmpty()?0:this.isEmpty()?-1:y.isEmpty()?1:this.compareToSameClass(_)}if(arguments.length===2){var P=arguments[0],$=arguments[1];return y=P,this.getTypeCode()!==y.getTypeCode()?this.getTypeCode()-y.getTypeCode():this.isEmpty()&&y.isEmpty()?0:this.isEmpty()?-1:y.isEmpty()?1:this.compareToSameClass(P,$)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(y){if(y.getTypeCode()===I.TYPECODE_GEOMETRYCOLLECTION)throw new U("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(y,_,P){return P===0?y.equals(_):y.distance(_)<=P}},{key:"norm",value:function(){var y=this.copy();return y.normalize(),y}},{key:"reverse",value:function(){var y=this.reverseInternal();return this.envelope!=null&&(y.envelope=this.envelope.copy()),y.setSRID(this.getSRID()),y}},{key:"copy",value:function(){var y=this.copyInternal();return y.envelope=this._envelope==null?null:this._envelope.copy(),y._SRID=this._SRID,y._userData=this._userData,y}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Ke(this._envelope)}},{key:"setSRID",value:function(y){this._SRID=y}},{key:"setUserData",value:function(y){this._userData=y}},{key:"compare",value:function(y,_){for(var P=y.iterator(),$=_.iterator();P.hasNext()&&$.hasNext();){var ne=P.next(),ve=$.next(),Oe=ne.compareTo(ve);if(Oe!==0)return Oe}return P.hasNext()?1:$.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(y){return this.getClass()===y.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===I.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===I.TYPECODE_MULTIPOINT||this.getTypeCode()===I.TYPECODE_MULTILINESTRING||this.getTypeCode()===I.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[W,H,X]}},{key:"getClass",value:function(){return I}}],[{key:"hasNonEmptyElements",value:function(y){for(var _=0;_<y.length;_++)if(!y[_].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(y){for(var _=0;_<y.length;_++)if(y[_]===null)return!0;return!1}}])})();it.constructor_=function(I){I&&(this._envelope=null,this._userData=null,this._factory=I,this._SRID=I.getSRID())},it.TYPECODE_POINT=0,it.TYPECODE_MULTIPOINT=1,it.TYPECODE_LINESTRING=2,it.TYPECODE_LINEARRING=3,it.TYPECODE_MULTILINESTRING=4,it.TYPECODE_POLYGON=5,it.TYPECODE_MULTIPOLYGON=6,it.TYPECODE_GEOMETRYCOLLECTION=7,it.TYPENAME_POINT="Point",it.TYPENAME_MULTIPOINT="MultiPoint",it.TYPENAME_LINESTRING="LineString",it.TYPENAME_LINEARRING="LinearRing",it.TYPENAME_MULTILINESTRING="MultiLineString",it.TYPENAME_POLYGON="Polygon",it.TYPENAME_MULTIPOLYGON="MultiPolygon",it.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",it.geometryChangedFilter={get interfaces_(){return[j]},filter:function(I){I.geometryChangedAction()}};var Me=(function(){function I(){i(this,I)}return o(I,null,[{key:"toLocationSymbol",value:function(y){switch(y){case I.EXTERIOR:return"e";case I.BOUNDARY:return"b";case I.INTERIOR:return"i";case I.NONE:return"-"}throw new U("Unknown location value: "+y)}}])})();Me.INTERIOR=0,Me.BOUNDARY=1,Me.EXTERIOR=2,Me.NONE=-1;var zt=(function(){return o((function I(){i(this,I)}),[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])})(),st=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({NoSuchElementException:y})[0],P}return m(y,I),o(y)})(O),$e=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({UnsupportedOperationException:y})[0],P}return m(y,I),o(y)})(O),Jt=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y,[{key:"contains",value:function(){}}])})(zt),Ht=(function(I){function y(_){var P;return i(this,y),(P=n(this,y)).map=new Map,_ instanceof zt&&P.addAll(_),P}return m(y,I),o(y,[{key:"contains",value:function(_){var P=_.hashCode?_.hashCode():_;return!!this.map.has(P)}},{key:"add",value:function(_){var P=_.hashCode?_.hashCode():_;return!this.map.has(P)&&!!this.map.set(P,_)}},{key:"addAll",value:function(_){var P,$=c(_);try{for($.s();!(P=$.n()).done;){var ne=P.value;this.add(ne)}}catch(ve){$.e(ve)}finally{$.f()}return!0}},{key:"remove",value:function(){throw new $e}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new pr(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])})(Jt),pr=(function(){return o((function I(y){i(this,I),this.iterator=y.values();var _=this.iterator.next(),P=_.done,$=_.value;this.done=P,this.value=$}),[{key:"next",value:function(){if(this.done)throw new st;var I=this.value,y=this.iterator.next(),_=y.done,P=y.value;return this.done=_,this.value=P,I}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new $e}}])})(),_t=(function(){function I(){i(this,I)}return o(I,null,[{key:"opposite",value:function(y){return y===I.LEFT?I.RIGHT:y===I.RIGHT?I.LEFT:y}}])})();_t.ON=0,_t.LEFT=1,_t.RIGHT=2;var vr=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({EmptyStackException:y})[0],P}return m(y,I),o(y)})(O),br=(function(I){function y(_){var P;return i(this,y),(P=n(this,y,[_])).name=Object.keys({IndexOutOfBoundsException:y})[0],P}return m(y,I),o(y)})(O),lr=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])})(zt),Cr=(function(I){function y(){var _;return i(this,y),(_=n(this,y)).array=[],_}return m(y,I),o(y,[{key:"add",value:function(_){return this.array.push(_),!0}},{key:"get",value:function(_){if(_<0||_>=this.size())throw new br;return this.array[_]}},{key:"push",value:function(_){return this.array.push(_),_}},{key:"pop",value:function(){if(this.array.length===0)throw new vr;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new vr;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(_){return this.array.indexOf(_)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])})(lr);function Tr(I,y){return I.interfaces_&&I.interfaces_.indexOf(y)>-1}var Qt=(function(){return o((function I(y){i(this,I),this.str=y}),[{key:"append",value:function(I){this.str+=I}},{key:"setCharAt",value:function(I,y){this.str=this.str.substr(0,I)+y+this.str.substr(I+1)}},{key:"toString",value:function(){return this.str}}])})(),at=(function(){function I(y){i(this,I),this.value=y}return o(I,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(y){return this.value<y?-1:this.value>y?1:0}}],[{key:"compare",value:function(y,_){return y<_?-1:y>_?1:0}},{key:"isNan",value:function(y){return Number.isNaN(y)}},{key:"valueOf",value:function(y){return new I(y)}}])})(),Pe=(function(){return o((function I(){i(this,I)}),null,[{key:"isWhitespace",value:function(I){return I<=32&&I>=0||I===127}},{key:"toUpperCase",value:function(I){return I.toUpperCase()}}])})(),be=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"le",value:function(y){return this._hi<y._hi||this._hi===y._hi&&this._lo<=y._lo}},{key:"extractSignificantDigits",value:function(y,_){var P=this.abs(),$=I.magnitude(P._hi),ne=I.TEN.pow($);(P=P.divide(ne)).gt(I.TEN)?(P=P.divide(I.TEN),$+=1):P.lt(I.ONE)&&(P=P.multiply(I.TEN),$-=1);for(var ve=$+1,Oe=new Qt,tt=I.MAX_PRINT_DIGITS-1,ft=0;ft<=tt;ft++){y&&ft===ve&&Oe.append(".");var rr=Math.trunc(P._hi);if(rr<0)break;var ur=!1,qr=0;rr>9?(ur=!0,qr="9"):qr="0"+rr,Oe.append(qr),P=P.subtract(I.valueOf(rr)).multiply(I.TEN),ur&&P.selfAdd(I.TEN);var bn=!0,Dn=I.magnitude(P._hi);if(Dn<0&&Math.abs(Dn)>=tt-ft&&(bn=!1),!bn)break}return _[0]=$,Oe.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return this.add(y.negate())}if(typeof arguments[0]=="number"){var _=arguments[0];return this.add(-_)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof I){var y=arguments[0];return this._hi===y._hi&&this._lo===y._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return this.isNaN()?this:this.selfAdd(-y._hi,-y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.isNaN()?this:this.selfAdd(-_,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(y){return this.le(y)?this:y}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.selfDivide(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.selfDivide(_,0)}}else if(arguments.length===2){var P,$,ne,ve,Oe=arguments[0],tt=arguments[1],ft=null,rr=null,ur=null,qr=null;return ne=this._hi/Oe,qr=(ft=(ur=I.SPLIT*ne)-(ft=ur-ne))*(rr=(qr=I.SPLIT*Oe)-(rr=qr-Oe))-(ve=ne*Oe)+ft*($=Oe-rr)+(P=ne-ft)*rr+P*$,qr=ne+(ur=(this._hi-ve-qr+this._lo-ne*tt)/Oe),this._hi=qr,this._lo=ne-qr+ur,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof I){var y,_,P,$,ne=arguments[0],ve=null,Oe=null,tt=null,ft=null;return y=(P=this._hi/ne._hi)-(ve=(tt=I.SPLIT*P)-(ve=tt-P)),ft=ve*(Oe=(ft=I.SPLIT*ne._hi)-(Oe=ft-ne._hi))-($=P*ne._hi)+ve*(_=ne._hi-Oe)+y*Oe+y*_,new I(ft=P+(tt=(this._hi-$-ft+this._lo-P*ne._lo)/ne._hi),P-ft+tt)}if(typeof arguments[0]=="number"){var rr=arguments[0];return Te.isNaN(rr)?I.createNaN():I.copy(this).selfDivide(rr,0)}}},{key:"ge",value:function(y){return this._hi>y._hi||this._hi===y._hi&&this._lo>=y._lo}},{key:"pow",value:function(y){if(y===0)return I.valueOf(1);var _=new I(this),P=I.valueOf(1),$=Math.abs(y);if($>1)for(;$>0;)$%2==1&&P.selfMultiply(_),($/=2)>0&&(_=_.sqr());else P=_;return y<0?P.reciprocal():P}},{key:"ceil",value:function(){if(this.isNaN())return I.NaN;var y=Math.ceil(this._hi),_=0;return y===this._hi&&(_=Math.ceil(this._lo)),new I(y,_)}},{key:"compareTo",value:function(y){var _=y;return this._hi<_._hi?-1:this._hi>_._hi?1:this._lo<_._lo?-1:this._lo>_._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return this.init(y),this}if(typeof arguments[0]=="number"){var _=arguments[0];return this.init(_),this}}},{key:"max",value:function(y){return this.ge(y)?this:y}},{key:"sqrt",value:function(){if(this.isZero())return I.valueOf(0);if(this.isNegative())return I.NaN;var y=1/Math.sqrt(this._hi),_=this._hi*y,P=I.valueOf(_),$=this.subtract(P.sqr())._hi*(.5*y);return P.add($)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.selfAdd(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _,P,$,ne,ve,Oe=arguments[0],tt=null;return tt=($=this._hi+Oe)-(ne=$-this._hi),P=(ve=(tt=Oe-ne+(this._hi-tt))+this._lo)+($-(_=$+ve)),this._hi=_+P,this._lo=P+(_-this._hi),this}}else if(arguments.length===2){var ft,rr,ur,qr,bn=arguments[0],Dn=arguments[1],Xn=null,Fn=null,En=null;ur=this._hi+bn,rr=this._lo+Dn,Fn=ur-(En=ur-this._hi),Xn=rr-(qr=rr-this._lo);var na=(ft=ur+(En=(Fn=bn-En+(this._hi-Fn))+rr))+(En=(Xn=Dn-qr+(this._lo-Xn))+(En+(ur-ft))),ca=En+(ft-na);return this._hi=na,this._lo=ca,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof I){var y=arguments[0];return this.selfMultiply(y._hi,y._lo)}if(typeof arguments[0]=="number"){var _=arguments[0];return this.selfMultiply(_,0)}}else if(arguments.length===2){var P,$,ne=arguments[0],ve=arguments[1],Oe=null,tt=null,ft=null,rr=null;Oe=(ft=I.SPLIT*this._hi)-this._hi,rr=I.SPLIT*ne,Oe=ft-Oe,P=this._hi-Oe,tt=rr-ne;var ur=(ft=this._hi*ne)+(rr=Oe*(tt=rr-tt)-ft+Oe*($=ne-tt)+P*tt+P*$+(this._hi*ve+this._lo*ne)),qr=rr+(Oe=ft-ur);return this._hi=ur,this._lo=qr,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return I.NaN;var y=Math.floor(this._hi),_=0;return y===this._hi&&(_=Math.floor(this._lo)),new I(y,_)}},{key:"negate",value:function(){return this.isNaN()?this:new I(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(y){if(y instanceof CloneNotSupportedException)return null;throw y}}},{key:"multiply",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return y.isNaN()?I.createNaN():I.copy(this).selfMultiply(y)}if(typeof arguments[0]=="number"){var _=arguments[0];return Te.isNaN(_)?I.createNaN():I.copy(this).selfMultiply(_,0)}}},{key:"isNaN",value:function(){return Te.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var y=I.magnitude(this._hi);return y>=-3&&y<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var y=this.getSpecialNumberString();if(y!==null)return y;var _=new Array(1).fill(null),P=this.extractSignificantDigits(!0,_),$=_[0]+1,ne=P;if(P.charAt(0)===".")ne="0"+P;else if($<0)ne="0."+I.stringOfChar("0",-$)+P;else if(P.indexOf(".")===-1){var ve=$-P.length;ne=P+I.stringOfChar("0",ve)+".0"}return this.isNegative()?"-"+ne:ne}},{key:"reciprocal",value:function(){var y,_,P,$,ne=null,ve=null,Oe=null,tt=null;y=(P=1/this._hi)-(ne=(Oe=I.SPLIT*P)-(ne=Oe-P)),ve=(tt=I.SPLIT*this._hi)-this._hi;var ft=P+(Oe=(1-($=P*this._hi)-(tt=ne*(ve=tt-ve)-$+ne*(_=this._hi-ve)+y*ve+y*_)-P*this._lo)/this._hi);return new I(ft,P-ft+Oe)}},{key:"toSciNotation",value:function(){if(this.isZero())return I.SCI_NOT_ZERO;var y=this.getSpecialNumberString();if(y!==null)return y;var _=new Array(1).fill(null),P=this.extractSignificantDigits(!1,_),$=I.SCI_NOT_EXPONENT_CHAR+_[0];if(P.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+P);var ne="";P.length>1&&(ne=P.substring(1));var ve=P.charAt(0)+"."+ne;return this.isNegative()?"-"+ve+$:ve+$}},{key:"abs",value:function(){return this.isNaN()?I.NaN:this.isNegative()?this.negate():new I(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(y){return this._hi<y._hi||this._hi===y._hi&&this._lo<y._lo}},{key:"add",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return I.copy(this).selfAdd(y)}if(typeof arguments[0]=="number"){var _=arguments[0];return I.copy(this).selfAdd(_)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var y=arguments[0];this._hi=y,this._lo=0}else if(arguments[0]instanceof I){var _=arguments[0];this._hi=_._hi,this._lo=_._lo}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this._hi=P,this._lo=$}}},{key:"gt",value:function(y){return this._hi>y._hi||this._hi===y._hi&&this._lo>y._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?I.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[X,H,W]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var y=arguments[0];this.init(y)}else if(arguments[0]instanceof I){var _=arguments[0];this.init(_)}else if(typeof arguments[0]=="string"){var P=arguments[0];I.constructor_.call(this,I.parse(P))}}else if(arguments.length===2){var $=arguments[0],ne=arguments[1];this.init($,ne)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1],P=arguments[2],$=arguments[3];return I.determinant(I.valueOf(y),I.valueOf(_),I.valueOf(P),I.valueOf($))}if(arguments[3]instanceof I&&arguments[2]instanceof I&&arguments[0]instanceof I&&arguments[1]instanceof I){var ne=arguments[1],ve=arguments[2],Oe=arguments[3];return arguments[0].multiply(Oe).selfSubtract(ne.multiply(ve))}}},{key:"sqr",value:function(y){return I.valueOf(y).selfMultiply(y)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var y=arguments[0];return I.parse(y)}if(typeof arguments[0]=="number")return new I(arguments[0])}},{key:"sqrt",value:function(y){return I.valueOf(y).sqrt()}},{key:"parse",value:function(y){for(var _=0,P=y.length;Pe.isWhitespace(y.charAt(_));)_++;var $=!1;if(_<P){var ne=y.charAt(_);ne!=="-"&&ne!=="+"||(_++,ne==="-"&&($=!0))}for(var ve=new I,Oe=0,tt=0,ft=0,rr=!1;!(_>=P);){var ur=y.charAt(_);if(_++,Pe.isDigit(ur)){var qr=ur-"0";ve.selfMultiply(I.TEN),ve.selfAdd(qr),Oe++}else{if(ur!=="."){if(ur==="e"||ur==="E"){var bn=y.substring(_);try{ft=at.parseInt(bn)}catch(na){throw na instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+bn+" in string "+y):na}break}throw new NumberFormatException("Unexpected character '"+ur+"' at position "+_+" in string "+y)}tt=Oe,rr=!0}}var Dn=ve;rr||(tt=Oe);var Xn=Oe-tt-ft;if(Xn===0)Dn=ve;else if(Xn>0){var Fn=I.TEN.pow(Xn);Dn=ve.divide(Fn)}else if(Xn<0){var En=I.TEN.pow(-Xn);Dn=ve.multiply(En)}return $?Dn.negate():Dn}},{key:"createNaN",value:function(){return new I(Te.NaN,Te.NaN)}},{key:"copy",value:function(y){return new I(y)}},{key:"magnitude",value:function(y){var _=Math.abs(y),P=Math.log(_)/Math.log(10),$=Math.trunc(Math.floor(P));return 10*Math.pow(10,$)<=_&&($+=1),$}},{key:"stringOfChar",value:function(y,_){for(var P=new Qt,$=0;$<_;$++)P.append(y);return P.toString()}}])})();be.PI=new be(3.141592653589793,12246467991473532e-32),be.TWO_PI=new be(6.283185307179586,24492935982947064e-32),be.PI_2=new be(1.5707963267948966,6123233995736766e-32),be.E=new be(2.718281828459045,14456468917292502e-32),be.NaN=new be(Te.NaN,Te.NaN),be.EPS=123259516440783e-46,be.SPLIT=134217729,be.MAX_PRINT_DIGITS=32,be.TEN=be.valueOf(10),be.ONE=be.valueOf(1),be.SCI_NOT_EXPONENT_CHAR="E",be.SCI_NOT_ZERO="0.0E0";var je=(function(){function I(){i(this,I)}return o(I,null,[{key:"orientationIndex",value:function(y,_,P){var $=I.orientationIndexFilter(y,_,P);if($<=1)return $;var ne=be.valueOf(_.x).selfAdd(-y.x),ve=be.valueOf(_.y).selfAdd(-y.y),Oe=be.valueOf(P.x).selfAdd(-_.x),tt=be.valueOf(P.y).selfAdd(-_.y);return ne.selfMultiply(tt).selfSubtract(ve.selfMultiply(Oe)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof be&&arguments[2]instanceof be&&arguments[0]instanceof be&&arguments[1]instanceof be){var y=arguments[1],_=arguments[2],P=arguments[3];return arguments[0].multiply(P).selfSubtract(y.multiply(_)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var $=arguments[0],ne=arguments[1],ve=arguments[2],Oe=arguments[3],tt=be.valueOf($),ft=be.valueOf(ne),rr=be.valueOf(ve),ur=be.valueOf(Oe);return tt.multiply(ur).selfSubtract(ft.multiply(rr)).signum()}}},{key:"intersection",value:function(y,_,P,$){var ne=new be(y.y).selfSubtract(_.y),ve=new be(_.x).selfSubtract(y.x),Oe=new be(y.x).selfMultiply(_.y).selfSubtract(new be(_.x).selfMultiply(y.y)),tt=new be(P.y).selfSubtract($.y),ft=new be($.x).selfSubtract(P.x),rr=new be(P.x).selfMultiply($.y).selfSubtract(new be($.x).selfMultiply(P.y)),ur=ve.multiply(rr).selfSubtract(ft.multiply(Oe)),qr=tt.multiply(Oe).selfSubtract(ne.multiply(rr)),bn=ne.multiply(ft).selfSubtract(tt.multiply(ve)),Dn=ur.selfDivide(bn).doubleValue(),Xn=qr.selfDivide(bn).doubleValue();return Te.isNaN(Dn)||Te.isInfinite(Dn)||Te.isNaN(Xn)||Te.isInfinite(Xn)?null:new Be(Dn,Xn)}},{key:"orientationIndexFilter",value:function(y,_,P){var $=null,ne=(y.x-P.x)*(_.y-P.y),ve=(y.y-P.y)*(_.x-P.x),Oe=ne-ve;if(ne>0){if(ve<=0)return I.signum(Oe);$=ne+ve}else{if(!(ne<0)||ve>=0)return I.signum(Oe);$=-ne-ve}var tt=I.DP_SAFE_EPSILON*$;return Oe>=tt||-Oe>=tt?I.signum(Oe):2}},{key:"signum",value:function(y){return y>0?1:y<0?-1:0}}])})();je.DP_SAFE_EPSILON=1e-15;var qe=(function(){return o((function I(){i(this,I)}),[{key:"getM",value:function(I){if(this.hasM()){var y=this.getDimension()-this.getMeasures();return this.getOrdinate(I,y)}return Te.NaN}},{key:"setOrdinate",value:function(I,y,_){}},{key:"getZ",value:function(I){return this.hasZ()?this.getOrdinate(I,2):Te.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(I,y){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(I){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(I){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(I){}},{key:"copy",value:function(){}},{key:"getY",value:function(I){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[W]}}])})();qe.X=0,qe.Y=1,qe.Z=2,qe.M=3;var Ge=(function(){function I(){i(this,I)}return o(I,null,[{key:"index",value:function(y,_,P){return je.orientationIndex(y,_,P)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var y=arguments[0],_=y.length-1;if(_<3)throw new U("Ring has fewer than 4 points, so orientation cannot be determined");for(var P=y[0],$=0,ne=1;ne<=_;ne++){var ve=y[ne];ve.y>P.y&&(P=ve,$=ne)}var Oe=$;do(Oe-=1)<0&&(Oe=_);while(y[Oe].equals2D(P)&&Oe!==$);var tt=$;do tt=(tt+1)%_;while(y[tt].equals2D(P)&&tt!==$);var ft=y[Oe],rr=y[tt];if(ft.equals2D(P)||rr.equals2D(P)||ft.equals2D(rr))return!1;var ur=I.index(ft,P,rr);return ur===0?ft.x>rr.x:ur>0}if(Tr(arguments[0],qe)){var qr=arguments[0],bn=qr.size()-1;if(bn<3)throw new U("Ring has fewer than 4 points, so orientation cannot be determined");for(var Dn=qr.getCoordinate(0),Xn=0,Fn=1;Fn<=bn;Fn++){var En=qr.getCoordinate(Fn);En.y>Dn.y&&(Dn=En,Xn=Fn)}var na=null,ca=Xn;do(ca-=1)<0&&(ca=bn),na=qr.getCoordinate(ca);while(na.equals2D(Dn)&&ca!==Xn);var lo=null,Ma=Xn;do Ma=(Ma+1)%bn,lo=qr.getCoordinate(Ma);while(lo.equals2D(Dn)&&Ma!==Xn);if(na.equals2D(Dn)||lo.equals2D(Dn)||na.equals2D(lo))return!1;var Ho=I.index(na,Dn,lo);return Ho===0?na.x>lo.x:Ho>0}}}])})();Ge.CLOCKWISE=-1,Ge.RIGHT=Ge.CLOCKWISE,Ge.COUNTERCLOCKWISE=1,Ge.LEFT=Ge.COUNTERCLOCKWISE,Ge.COLLINEAR=0,Ge.STRAIGHT=Ge.COLLINEAR;var Nt=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(I,y){var _=this.getRightmostSideOfSegment(I,y);return _<0&&(_=this.getRightmostSideOfSegment(I,y-1)),_<0&&(this._minCoord=null,this.checkForRightmostCoordinate(I)),_}},{key:"findRightmostEdgeAtVertex",value:function(){var I=this._minDe.getEdge().getCoordinates();xe.isTrue(this._minIndex>0&&this._minIndex<I.length,"rightmost point expected to be interior vertex of edge");var y=I[this._minIndex-1],_=I[this._minIndex+1],P=Ge.index(this._minCoord,_,y),$=!1;(y.y<this._minCoord.y&&_.y<this._minCoord.y&&P===Ge.COUNTERCLOCKWISE||y.y>this._minCoord.y&&_.y>this._minCoord.y&&P===Ge.CLOCKWISE)&&($=!0),$&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(I,y){var _=I.getEdge().getCoordinates();if(y<0||y+1>=_.length||_[y].y===_[y+1].y)return-1;var P=_t.LEFT;return _[y].y<_[y+1].y&&(P=_t.RIGHT),P}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(I){for(var y=I.getEdge().getCoordinates(),_=0;_<y.length-1;_++)(this._minCoord===null||y[_].x>this._minCoord.x)&&(this._minDe=I,this._minIndex=_,this._minCoord=y[_])}},{key:"findRightmostEdgeAtNode",value:function(){var I=this._minDe.getNode().getEdges();this._minDe=I.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(I){for(var y=I.iterator();y.hasNext();){var _=y.next();_.isForward()&&this.checkForRightmostCoordinate(_)}xe.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===_t.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])})(),Et=(function(I){function y(_,P){var $;return i(this,y),($=n(this,y,[P?_+" [ "+P+" ]":_])).pt=P?new Be(P):void 0,$.name=Object.keys({TopologyException:y})[0],$}return m(y,I),o(y,[{key:"getCoordinate",value:function(){return this.pt}}])})(de),mt=(function(){return o((function I(){i(this,I),this.array=[]}),[{key:"addLast",value:function(I){this.array.push(I)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])})(),ct=(function(I){function y(_){var P;return i(this,y),(P=n(this,y)).array=[],_ instanceof zt&&P.addAll(_),P}return m(y,I),o(y,[{key:"interfaces_",get:function(){return[lr,zt]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(_){return arguments.length===1?this.array.push(_):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(_){var P,$=c(_);try{for($.s();!(P=$.n()).done;){var ne=P.value;this.array.push(ne)}}catch(ve){$.e(ve)}finally{$.f()}}},{key:"set",value:function(_,P){var $=this.array[_];return this.array[_]=P,$}},{key:"iterator",value:function(){return new Kt(this)}},{key:"get",value:function(_){if(_<0||_>=this.size())throw new br;return this.array[_]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(_){_?this.array.sort((function(P,$){return _.compare(P,$)})):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(_){for(var P=0,$=this.array.length;P<$;P++)if(this.array[P]===_)return!!this.array.splice(P,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])})(lr),Kt=(function(){return o((function I(y){i(this,I),this.arrayList=y,this.position=0}),[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new st;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(I){return this.arrayList.set(this.position-1,I)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])})(),qt=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"clearVisitedEdges",value:function(){for(var I=this._dirEdgeList.iterator();I.hasNext();)I.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(I){for(var y=null,_=I.getEdges().iterator();_.hasNext();){var P=_.next();if(P.isVisited()||P.getSym().isVisited()){y=P;break}}if(y===null)throw new Et("unable to find edge to compute depths at "+I.getCoordinate());I.getEdges().computeDepths(y);for(var $=I.getEdges().iterator();$.hasNext();){var ne=$.next();ne.setVisited(!0),this.copySymDepths(ne)}}},{key:"computeDepth",value:function(I){this.clearVisitedEdges();var y=this._finder.getEdge();y.getNode(),y.getLabel(),y.setEdgeDepths(_t.RIGHT,I),this.copySymDepths(y),this.computeDepths(y)}},{key:"create",value:function(I){this.addReachable(I),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var I=this._dirEdgeList.iterator();I.hasNext();){var y=I.next();y.getDepth(_t.RIGHT)>=1&&y.getDepth(_t.LEFT)<=0&&!y.isInteriorAreaEdge()&&y.setInResult(!0)}}},{key:"computeDepths",value:function(I){var y=new Ht,_=new mt,P=I.getNode();for(_.addLast(P),y.add(P),I.setVisited(!0);!_.isEmpty();){var $=_.removeFirst();y.add($),this.computeNodeDepth($);for(var ne=$.getEdges().iterator();ne.hasNext();){var ve=ne.next().getSym();if(!ve.isVisited()){var Oe=ve.getNode();y.contains(Oe)||(_.addLast(Oe),y.add(Oe))}}}}},{key:"compareTo",value:function(I){var y=I;return this._rightMostCoord.x<y._rightMostCoord.x?-1:this._rightMostCoord.x>y._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var I=new Ke,y=this._dirEdgeList.iterator();y.hasNext();)for(var _=y.next().getEdge().getCoordinates(),P=0;P<_.length-1;P++)I.expandToInclude(_[P]);this._env=I}return this._env}},{key:"addReachable",value:function(I){var y=new Cr;for(y.add(I);!y.empty();){var _=y.pop();this.add(_,y)}}},{key:"copySymDepths",value:function(I){var y=I.getSym();y.setDepth(_t.LEFT,I.getDepth(_t.RIGHT)),y.setDepth(_t.RIGHT,I.getDepth(_t.LEFT))}},{key:"add",value:function(I,y){I.setVisited(!0),this._nodes.add(I);for(var _=I.getEdges().iterator();_.hasNext();){var P=_.next();this._dirEdgeList.add(P);var $=P.getSym().getNode();$.isVisited()||y.push($)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new ct,this._nodes=new ct,this._rightMostCoord=null,this._env=null,this._finder=new Nt}}])})(),Ir=(function(){return o((function I(){i(this,I)}),null,[{key:"intersection",value:function(I,y,_,P){var $=I.x<y.x?I.x:y.x,ne=I.y<y.y?I.y:y.y,ve=I.x>y.x?I.x:y.x,Oe=I.y>y.y?I.y:y.y,tt=_.x<P.x?_.x:P.x,ft=_.y<P.y?_.y:P.y,rr=_.x>P.x?_.x:P.x,ur=_.y>P.y?_.y:P.y,qr=(($>tt?$:tt)+(ve<rr?ve:rr))/2,bn=((ne>ft?ne:ft)+(Oe<ur?Oe:ur))/2,Dn=I.x-qr,Xn=I.y-bn,Fn=y.x-qr,En=y.y-bn,na=_.x-qr,ca=_.y-bn,lo=P.x-qr,Ma=P.y-bn,Ho=Xn-En,Js=Fn-Dn,Pl=Dn*En-Fn*Xn,hu=ca-Ma,du=lo-na,Ms=na*Ma-lo*ca,Gl=Ho*du-hu*Js,Wl=(Js*Ms-du*Pl)/Gl,To=(hu*Pl-Ho*Ms)/Gl;return Te.isNaN(Wl)||Te.isInfinite(Wl)||Te.isNaN(To)||Te.isInfinite(To)?null:new Be(Wl+qr,To+bn)}}])})(),Ar=(function(){return o((function I(){i(this,I)}),null,[{key:"arraycopy",value:function(I,y,_,P,$){for(var ne=0,ve=y;ve<y+$;ve++)_[P+ne]=I[ve],ne++}},{key:"getProperty",value:function(I){return{"line.separator":`
`}[I]}}])})(),$r=(function(){function I(){i(this,I)}return o(I,null,[{key:"log10",value:function(y){var _=Math.log(y);return Te.isInfinite(_)||Te.isNaN(_)?_:_/I.LOG_10}},{key:"min",value:function(y,_,P,$){var ne=y;return _<ne&&(ne=_),P<ne&&(ne=P),$<ne&&(ne=$),ne}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1],P=arguments[2];return y<_?_:y>P?P:y}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var $=arguments[0],ne=arguments[1],ve=arguments[2];return $<ne?ne:$>ve?ve:$}}},{key:"wrap",value:function(y,_){return y<0?_- -y%_:y%_}},{key:"max",value:function(){if(arguments.length===3){var y=arguments[1],_=arguments[2],P=arguments[0];return y>P&&(P=y),_>P&&(P=_),P}if(arguments.length===4){var $=arguments[1],ne=arguments[2],ve=arguments[3],Oe=arguments[0];return $>Oe&&(Oe=$),ne>Oe&&(Oe=ne),ve>Oe&&(Oe=ve),Oe}}},{key:"average",value:function(y,_){return(y+_)/2}}])})();$r.LOG_10=Math.log(10);var cn=(function(){function I(){i(this,I)}return o(I,null,[{key:"segmentToSegment",value:function(y,_,P,$){if(y.equals(_))return I.pointToSegment(y,P,$);if(P.equals($))return I.pointToSegment($,y,_);var ne=!1;if(Ke.intersects(y,_,P,$)){var ve=(_.x-y.x)*($.y-P.y)-(_.y-y.y)*($.x-P.x);if(ve===0)ne=!0;else{var Oe=(y.y-P.y)*($.x-P.x)-(y.x-P.x)*($.y-P.y),tt=((y.y-P.y)*(_.x-y.x)-(y.x-P.x)*(_.y-y.y))/ve,ft=Oe/ve;(ft<0||ft>1||tt<0||tt>1)&&(ne=!0)}}else ne=!0;return ne?$r.min(I.pointToSegment(y,P,$),I.pointToSegment(_,P,$),I.pointToSegment(P,y,_),I.pointToSegment($,y,_)):0}},{key:"pointToSegment",value:function(y,_,P){if(_.x===P.x&&_.y===P.y)return y.distance(_);var $=(P.x-_.x)*(P.x-_.x)+(P.y-_.y)*(P.y-_.y),ne=((y.x-_.x)*(P.x-_.x)+(y.y-_.y)*(P.y-_.y))/$;if(ne<=0)return y.distance(_);if(ne>=1)return y.distance(P);var ve=((_.y-y.y)*(P.x-_.x)-(_.x-y.x)*(P.y-_.y))/$;return Math.abs(ve)*Math.sqrt($)}},{key:"pointToLinePerpendicular",value:function(y,_,P){var $=(P.x-_.x)*(P.x-_.x)+(P.y-_.y)*(P.y-_.y),ne=((_.y-y.y)*(P.x-_.x)-(_.x-y.x)*(P.y-_.y))/$;return Math.abs(ne)*Math.sqrt($)}},{key:"pointToSegmentString",value:function(y,_){if(_.length===0)throw new U("Line array must contain at least one vertex");for(var P=y.distance(_[0]),$=0;$<_.length-1;$++){var ne=I.pointToSegment(y,_[$],_[$+1]);ne<P&&(P=ne)}return P}}])})(),zr=(function(){return o((function I(){i(this,I)}),[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||Tr(arguments[0],qe);else if(arguments.length!==2){if(arguments.length===3){var I=arguments[0],y=arguments[1];return this.create(I,y)}}}}])})(),Rt=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I){}}])})(),en=(function(){return o((function I(){i(this,I)}),null,[{key:"ofLine",value:function(I){var y=I.size();if(y<=1)return 0;var _=0,P=new Be;I.getCoordinate(0,P);for(var $=P.x,ne=P.y,ve=1;ve<y;ve++){I.getCoordinate(ve,P);var Oe=P.x,tt=P.y,ft=Oe-$,rr=tt-ne;_+=Math.sqrt(ft*ft+rr*rr),$=Oe,ne=tt}return _}}])})(),jn=o((function I(){i(this,I)})),Qr=(function(){function I(){i(this,I)}return o(I,null,[{key:"copyCoord",value:function(y,_,P,$){for(var ne=Math.min(y.getDimension(),P.getDimension()),ve=0;ve<ne;ve++)P.setOrdinate($,ve,y.getOrdinate(_,ve))}},{key:"isRing",value:function(y){var _=y.size();return _===0||!(_<=3)&&y.getOrdinate(0,qe.X)===y.getOrdinate(_-1,qe.X)&&y.getOrdinate(0,qe.Y)===y.getOrdinate(_-1,qe.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(Tr(arguments[0],qe)&&Number.isInteger(arguments[1])){var y=arguments[0],_=arguments[1];I.scroll(y,_,I.isRing(y))}else if(Tr(arguments[0],qe)&&arguments[1]instanceof Be){var P=arguments[0],$=arguments[1],ne=I.indexOf($,P);if(ne<=0)return null;I.scroll(P,ne)}}else if(arguments.length===3){var ve=arguments[0],Oe=arguments[1],tt=arguments[2];if(Oe<=0)return null;for(var ft=ve.copy(),rr=tt?ve.size()-1:ve.size(),ur=0;ur<rr;ur++)for(var qr=0;qr<ve.getDimension();qr++)ve.setOrdinate(ur,qr,ft.getOrdinate((Oe+ur)%rr,qr));if(tt)for(var bn=0;bn<ve.getDimension();bn++)ve.setOrdinate(rr,bn,ve.getOrdinate(0,bn))}}},{key:"isEqual",value:function(y,_){var P=y.size();if(P!==_.size())return!1;for(var $=Math.min(y.getDimension(),_.getDimension()),ne=0;ne<P;ne++)for(var ve=0;ve<$;ve++){var Oe=y.getOrdinate(ne,ve),tt=_.getOrdinate(ne,ve);if(y.getOrdinate(ne,ve)!==_.getOrdinate(ne,ve)&&(!Te.isNaN(Oe)||!Te.isNaN(tt)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var y=arguments[0];return I.minCoordinateIndex(y,0,y.size()-1)}if(arguments.length===3){for(var _=arguments[0],P=arguments[2],$=-1,ne=null,ve=arguments[1];ve<=P;ve++){var Oe=_.getCoordinate(ve);(ne===null||ne.compareTo(Oe)>0)&&(ne=Oe,$=ve)}return $}}},{key:"extend",value:function(y,_,P){var $=y.create(P,_.getDimension()),ne=_.size();if(I.copy(_,0,$,0,ne),ne>0)for(var ve=ne;ve<P;ve++)I.copy(_,ne-1,$,ve,1);return $}},{key:"reverse",value:function(y){for(var _=y.size()-1,P=Math.trunc(_/2),$=0;$<=P;$++)I.swap(y,$,_-$)}},{key:"swap",value:function(y,_,P){if(_===P)return null;for(var $=0;$<y.getDimension();$++){var ne=y.getOrdinate(_,$);y.setOrdinate(_,$,y.getOrdinate(P,$)),y.setOrdinate(P,$,ne)}}},{key:"copy",value:function(y,_,P,$,ne){for(var ve=0;ve<ne;ve++)I.copyCoord(y,_+ve,P,$+ve)}},{key:"ensureValidRing",value:function(y,_){var P=_.size();return P===0?_:P<=3?I.createClosedRing(y,_,4):_.getOrdinate(0,qe.X)===_.getOrdinate(P-1,qe.X)&&_.getOrdinate(0,qe.Y)===_.getOrdinate(P-1,qe.Y)?_:I.createClosedRing(y,_,P+1)}},{key:"indexOf",value:function(y,_){for(var P=0;P<_.size();P++)if(y.x===_.getOrdinate(P,qe.X)&&y.y===_.getOrdinate(P,qe.Y))return P;return-1}},{key:"createClosedRing",value:function(y,_,P){var $=y.create(P,_.getDimension()),ne=_.size();I.copy(_,0,$,0,ne);for(var ve=ne;ve<P;ve++)I.copy(_,0,$,ve,1);return $}},{key:"minCoordinate",value:function(y){for(var _=null,P=0;P<y.size();P++){var $=y.getCoordinate(P);(_===null||_.compareTo($)>0)&&(_=$)}return _}}])})(),nr=(function(){function I(){i(this,I)}return o(I,null,[{key:"toDimensionSymbol",value:function(y){switch(y){case I.FALSE:return I.SYM_FALSE;case I.TRUE:return I.SYM_TRUE;case I.DONTCARE:return I.SYM_DONTCARE;case I.P:return I.SYM_P;case I.L:return I.SYM_L;case I.A:return I.SYM_A}throw new U("Unknown dimension value: "+y)}},{key:"toDimensionValue",value:function(y){switch(Pe.toUpperCase(y)){case I.SYM_FALSE:return I.FALSE;case I.SYM_TRUE:return I.TRUE;case I.SYM_DONTCARE:return I.DONTCARE;case I.SYM_P:return I.P;case I.SYM_L:return I.L;case I.SYM_A:return I.A}throw new U("Unknown dimension symbol: "+y)}}])})();nr.P=0,nr.L=1,nr.A=2,nr.FALSE=-1,nr.TRUE=-2,nr.DONTCARE=-3,nr.SYM_FALSE="F",nr.SYM_TRUE="T",nr.SYM_DONTCARE="*",nr.SYM_P="0",nr.SYM_L="1",nr.SYM_A="2";var oi=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I){}}])})(),ln=(function(){return o((function I(){i(this,I)}),[{key:"filter",value:function(I,y){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])})(),Kn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new Ke:this._points.expandEnvelope(new Ke)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new y(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];if(!this.isEquivalentClass(_))return!1;var $=_;if(this._points.size()!==$._points.size())return!1;for(var ne=0;ne<this._points.size();ne++)if(!this.equal(this._points.getCoordinate(ne),$._points.getCoordinate(ne),P))return!1;return!0}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var _=0;_<Math.trunc(this._points.size()/2);_++){var P=this._points.size()-1-_;if(!this._points.getCoordinate(_).equals(this._points.getCoordinate(P))){if(this._points.getCoordinate(_).compareTo(this._points.getCoordinate(P))>0){var $=this._points.copy();Qr.reverse($),this._points=$}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?nr.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var _=this._points.copy();return Qr.reverse(_),this.getFactory().createLineString(_)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return it.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return en.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var _=arguments[0],P=0,$=0;P<this._points.size()&&$<_._points.size();){var ne=this._points.getCoordinate(P).compareTo(_._points.getCoordinate($));if(ne!==0)return ne;P++,$++}return P<this._points.size()?1:$<_._points.size()?-1:0}if(arguments.length===2){var ve=arguments[0];return arguments[1].compare(this._points,ve._points)}}},{key:"apply",value:function(){if(Tr(arguments[0],Rt))for(var _=arguments[0],P=0;P<this._points.size();P++)_.filter(this._points.getCoordinate(P));else if(Tr(arguments[0],ln)){var $=arguments[0];if(this._points.size()===0)return null;for(var ne=0;ne<this._points.size()&&($.filter(this._points,ne),!$.isDone());ne++);$.isGeometryChanged()&&this.geometryChanged()}else Tr(arguments[0],oi)?arguments[0].filter(this):Tr(arguments[0],j)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new $e}},{key:"isEquivalentClass",value:function(_){return _ instanceof y}},{key:"getCoordinateN",value:function(_){return this._points.getCoordinate(_)}},{key:"getGeometryType",value:function(){return it.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(_){if(_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),_.size()===1)throw new U("Invalid number of points in LineString (found "+_.size()+" - must be 0 or >= 2)");this._points=_}},{key:"isCoordinate",value:function(_){for(var P=0;P<this._points.size();P++)if(this._points.getCoordinate(P).equals(_))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(_){return this.getFactory().createPoint(this._points.getCoordinate(_))}},{key:"interfaces_",get:function(){return[jn]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var _=arguments[0],P=arguments[1];it.constructor_.call(this,P),this.init(_)}}}}])})(it),ke=o((function I(){i(this,I)})),He=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new Ke;var _=new Ke;return _.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),_}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new y(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&(!(!this.isEmpty()||!_.isEmpty())||this.isEmpty()===_.isEmpty()&&this.equal(_.getCoordinate(),this.getCoordinate(),P))}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return nr.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return it.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0];return this.getCoordinate().compareTo(_.getCoordinate())}if(arguments.length===2){var P=arguments[0];return arguments[1].compare(this._coordinates,P._coordinates)}}},{key:"apply",value:function(){if(Tr(arguments[0],Rt)){var _=arguments[0];if(this.isEmpty())return null;_.filter(this.getCoordinate())}else if(Tr(arguments[0],ln)){var P=arguments[0];if(this.isEmpty())return null;P.filter(this._coordinates,0),P.isGeometryChanged()&&this.geometryChanged()}else Tr(arguments[0],oi)?arguments[0].filter(this):Tr(arguments[0],j)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return it.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(_){_===null&&(_=this.getFactory().getCoordinateSequenceFactory().create([])),xe.isTrue(_.size()<=1),this._coordinates=_}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[ke]}}],[{key:"constructor_",value:function(){this._coordinates=null;var _=arguments[0],P=arguments[1];it.constructor_.call(this,P),this.init(_)}}])})(it),Tt=(function(){function I(){i(this,I)}return o(I,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var y=arguments[0];return Math.abs(I.ofRingSigned(y))}if(Tr(arguments[0],qe)){var _=arguments[0];return Math.abs(I.ofRingSigned(_))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var y=arguments[0];if(y.length<3)return 0;for(var _=0,P=y[0].x,$=1;$<y.length-1;$++){var ne=y[$].x-P,ve=y[$+1].y;_+=ne*(y[$-1].y-ve)}return _/2}if(Tr(arguments[0],qe)){var Oe=arguments[0],tt=Oe.size();if(tt<3)return 0;var ft=new Be,rr=new Be,ur=new Be;Oe.getCoordinate(0,rr),Oe.getCoordinate(1,ur);var qr=rr.x;ur.x-=qr;for(var bn=0,Dn=1;Dn<tt-1;Dn++)ft.y=rr.y,rr.x=ur.x,rr.y=ur.y,Oe.getCoordinate(Dn+1,ur),ur.x-=qr,bn+=rr.x*(ft.y-ur.y);return bn/2}}}])})(),Gt=(function(){return o((function I(){i(this,I)}),null,[{key:"sort",value:function(){var I=arguments,y=arguments[0];if(arguments.length===1)y.sort((function(qr,bn){return qr.compareTo(bn)}));else if(arguments.length===2)y.sort((function(qr,bn){return I[1].compare(qr,bn)}));else if(arguments.length===3){var _=y.slice(arguments[1],arguments[2]);_.sort();var P=y.slice(0,arguments[1]).concat(_,y.slice(arguments[2],y.length));y.splice(0,y.length);var $,ne=c(P);try{for(ne.s();!($=ne.n()).done;){var ve=$.value;y.push(ve)}}catch(qr){ne.e(qr)}finally{ne.f()}}else if(arguments.length===4){var Oe=y.slice(arguments[1],arguments[2]);Oe.sort((function(qr,bn){return I[3].compare(qr,bn)}));var tt=y.slice(0,arguments[1]).concat(Oe,y.slice(arguments[2],y.length));y.splice(0,y.length);var ft,rr=c(tt);try{for(rr.s();!(ft=rr.n()).done;){var ur=ft.value;y.push(ur)}}catch(qr){rr.e(qr)}finally{rr.f()}}}},{key:"asList",value:function(I){var y,_=new ct,P=c(I);try{for(P.s();!(y=P.n()).done;){var $=y.value;_.add($)}}catch(ne){P.e(ne)}finally{P.f()}return _}},{key:"copyOf",value:function(I,y){return I.slice(0,y)}}])})(),Ut=o((function I(){i(this,I)})),Xr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var _=new Array(this.getNumPoints()).fill(null),P=-1,$=this._shell.getCoordinates(),ne=0;ne<$.length;ne++)_[++P]=$[ne];for(var ve=0;ve<this._holes.length;ve++)for(var Oe=this._holes[ve].getCoordinates(),tt=0;tt<Oe.length;tt++)_[++P]=Oe[tt];return _}},{key:"getArea",value:function(){var _=0;_+=Tt.ofRing(this._shell.getCoordinateSequence());for(var P=0;P<this._holes.length;P++)_-=Tt.ofRing(this._holes[P].getCoordinateSequence());return _}},{key:"copyInternal",value:function(){for(var _=this._shell.copy(),P=new Array(this._holes.length).fill(null),$=0;$<this._holes.length;$++)P[$]=this._holes[$].copy();return new y(_,P,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var _=this._shell.getCoordinateSequence(),P=this.getEnvelopeInternal(),$=0;$<5;$++){var ne=_.getX($);if(ne!==P.getMinX()&&ne!==P.getMaxX())return!1;var ve=_.getY($);if(ve!==P.getMinY()&&ve!==P.getMaxY())return!1}for(var Oe=_.getX(0),tt=_.getY(0),ft=1;ft<=4;ft++){var rr=_.getX(ft),ur=_.getY(ft);if(rr!==Oe==(ur!==tt))return!1;Oe=rr,tt=ur}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];if(!this.isEquivalentClass(_))return!1;var $=_,ne=this._shell,ve=$._shell;if(!ne.equalsExact(ve,P)||this._holes.length!==$._holes.length)return!1;for(var Oe=0;Oe<this._holes.length;Oe++)if(!this._holes[Oe].equalsExact($._holes[Oe],P))return!1;return!0}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var _=0;_<this._holes.length;_++)this._holes[_]=this.normalized(this._holes[_],!1);Gt.sort(this._holes)}else if(arguments.length===2){var P=arguments[0],$=arguments[1];if(P.isEmpty())return null;var ne=P.getCoordinateSequence(),ve=Qr.minCoordinateIndex(ne,0,ne.size()-2);Qr.scroll(ne,ve,!0),Ge.isCCW(ne)===$&&Qr.reverse(ne)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var _=this.getExteriorRing().reverse(),P=new Array(this.getNumInteriorRing()).fill(null),$=0;$<P.length;$++)P[$]=this.getInteriorRingN($).reverse();return this.getFactory().createPolygon(_,P)}},{key:"getTypeCode",value:function(){return it.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var _=0;_+=this._shell.getLength();for(var P=0;P<this._holes.length;P++)_+=this._holes[P].getLength();return _}},{key:"getNumPoints",value:function(){for(var _=this._shell.getNumPoints(),P=0;P<this._holes.length;P++)_+=this._holes[P].getNumPoints();return _}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(_,P){var $=_.copy();return this.normalize($,P),$}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0],P=this._shell,$=_._shell;return P.compareToSameClass($)}if(arguments.length===2){var ne=arguments[1],ve=arguments[0],Oe=this._shell,tt=ve._shell,ft=Oe.compareToSameClass(tt,ne);if(ft!==0)return ft;for(var rr=this.getNumInteriorRing(),ur=ve.getNumInteriorRing(),qr=0;qr<rr&&qr<ur;){var bn=this.getInteriorRingN(qr),Dn=ve.getInteriorRingN(qr),Xn=bn.compareToSameClass(Dn,ne);if(Xn!==0)return Xn;qr++}return qr<rr?1:qr<ur?-1:0}}},{key:"apply",value:function(){if(Tr(arguments[0],Rt)){var _=arguments[0];this._shell.apply(_);for(var P=0;P<this._holes.length;P++)this._holes[P].apply(_)}else if(Tr(arguments[0],ln)){var $=arguments[0];if(this._shell.apply($),!$.isDone())for(var ne=0;ne<this._holes.length&&(this._holes[ne].apply($),!$.isDone());ne++);$.isGeometryChanged()&&this.geometryChanged()}else if(Tr(arguments[0],oi))arguments[0].filter(this);else if(Tr(arguments[0],j)){var ve=arguments[0];ve.filter(this),this._shell.apply(ve);for(var Oe=0;Oe<this._holes.length;Oe++)this._holes[Oe].apply(ve)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var _=new Array(this._holes.length+1).fill(null);_[0]=this._shell;for(var P=0;P<this._holes.length;P++)_[P+1]=this._holes[P];return _.length<=1?this.getFactory().createLinearRing(_[0].getCoordinateSequence()):this.getFactory().createMultiLineString(_)}},{key:"getGeometryType",value:function(){return it.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(_){return this._holes[_]}},{key:"interfaces_",get:function(){return[Ut]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var _=arguments[0],P=arguments[1],$=arguments[2];if(it.constructor_.call(this,$),_===null&&(_=this.getFactory().createLinearRing()),P===null&&(P=[]),it.hasNullElements(P))throw new U("holes must not contain null elements");if(_.isEmpty()&&it.hasNonEmptyElements(P))throw new U("shell is empty but holes are not");this._shell=_,this._holes=P}}])})(it),Ln=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y)})(Jt),Bi=(function(I){function y(_){var P;return i(this,y),(P=n(this,y)).array=[],_ instanceof zt&&P.addAll(_),P}return m(y,I),o(y,[{key:"contains",value:function(_){var P,$=c(this.array);try{for($.s();!(P=$.n()).done;)if(P.value.compareTo(_)===0)return!0}catch(ne){$.e(ne)}finally{$.f()}return!1}},{key:"add",value:function(_){if(this.contains(_))return!1;for(var P=0,$=this.array.length;P<$;P++)if(this.array[P].compareTo(_)===1)return!!this.array.splice(P,0,_);return this.array.push(_),!0}},{key:"addAll",value:function(_){var P,$=c(_);try{for($.s();!(P=$.n()).done;){var ne=P.value;this.add(ne)}}catch(ve){$.e(ve)}finally{$.f()}return!0}},{key:"remove",value:function(){throw new $e}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new Ci(this.array)}}])})(Ln),Ci=(function(){return o((function I(y){i(this,I),this.array=y,this.position=0}),[{key:"next",value:function(){if(this.position===this.array.length)throw new st;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new $e}}])})(),Fr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeEnvelopeInternal",value:function(){for(var _=new Ke,P=0;P<this._geometries.length;P++)_.expandToInclude(this._geometries[P].getEnvelopeInternal());return _}},{key:"getGeometryN",value:function(_){return this._geometries[_]}},{key:"getCoordinates",value:function(){for(var _=new Array(this.getNumPoints()).fill(null),P=-1,$=0;$<this._geometries.length;$++)for(var ne=this._geometries[$].getCoordinates(),ve=0;ve<ne.length;ve++)_[++P]=ne[ve];return _}},{key:"getArea",value:function(){for(var _=0,P=0;P<this._geometries.length;P++)_+=this._geometries[P].getArea();return _}},{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];if(!this.isEquivalentClass(_))return!1;var $=_;if(this._geometries.length!==$._geometries.length)return!1;for(var ne=0;ne<this._geometries.length;ne++)if(!this._geometries[ne].equalsExact($._geometries[ne],P))return!1;return!0}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var _=0;_<this._geometries.length;_++)this._geometries[_].normalize();Gt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var _=nr.FALSE,P=0;P<this._geometries.length;P++)_=Math.max(_,this._geometries[P].getBoundaryDimension());return _}},{key:"reverseInternal",value:function(){for(var _=this._geometries.length,P=new ct(_),$=0;$<_;$++)P.add(this._geometries[$].reverse());return this.getFactory().buildGeometry(P)}},{key:"getTypeCode",value:function(){return it.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var _=nr.FALSE,P=0;P<this._geometries.length;P++)_=Math.max(_,this._geometries[P].getDimension());return _}},{key:"getLength",value:function(){for(var _=0,P=0;P<this._geometries.length;P++)_+=this._geometries[P].getLength();return _}},{key:"getNumPoints",value:function(){for(var _=0,P=0;P<this._geometries.length;P++)_+=this._geometries[P].getNumPoints();return _}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var _=arguments[0],P=new Bi(Gt.asList(this._geometries)),$=new Bi(Gt.asList(_._geometries));return this.compare(P,$)}if(arguments.length===2){for(var ne=arguments[1],ve=arguments[0],Oe=this.getNumGeometries(),tt=ve.getNumGeometries(),ft=0;ft<Oe&&ft<tt;){var rr=this.getGeometryN(ft),ur=ve.getGeometryN(ft),qr=rr.compareToSameClass(ur,ne);if(qr!==0)return qr;ft++}return ft<Oe?1:ft<tt?-1:0}}},{key:"apply",value:function(){if(Tr(arguments[0],Rt))for(var _=arguments[0],P=0;P<this._geometries.length;P++)this._geometries[P].apply(_);else if(Tr(arguments[0],ln)){var $=arguments[0];if(this._geometries.length===0)return null;for(var ne=0;ne<this._geometries.length&&(this._geometries[ne].apply($),!$.isDone());ne++);$.isGeometryChanged()&&this.geometryChanged()}else if(Tr(arguments[0],oi)){var ve=arguments[0];ve.filter(this);for(var Oe=0;Oe<this._geometries.length;Oe++)this._geometries[Oe].apply(ve)}else if(Tr(arguments[0],j)){var tt=arguments[0];tt.filter(this);for(var ft=0;ft<this._geometries.length;ft++)this._geometries[ft].apply(tt)}}},{key:"getBoundary",value:function(){return it.checkNotGeometryCollection(this),xe.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return it.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var _=arguments[0],P=arguments[1];if(it.constructor_.call(this,P),_===null&&(_=[]),it.hasNullElements(_))throw new U("geometries must not contain null elements");this._geometries=_}}}}])})(it),Rn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&E(y,"equalsExact",this,1).call(this,_,P)}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var _=arguments[0];return this._geometries[_].getCoordinate()}return E(y,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return nr.FALSE}},{key:"getTypeCode",value:function(){return it.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return it.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[ke]}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Fr.constructor_.call(this,_,P)}}])})(Fr),Bn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){return new y(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return nr.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||E(y,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var _=this._points.copy();return Qr.reverse(_),this.getFactory().createLinearRing(_)}},{key:"getTypeCode",value:function(){return it.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!E(y,"isClosed",this,1).call(this))throw new U("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<y.MINIMUM_VALID_SIZE)throw new U("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return it.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Kn.constructor_.call(this,_,P),this.validateConstruction()}}])})(Kn);Bn.MINIMUM_VALID_SIZE=4;var ei=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"setOrdinate",value:function(_,P){switch(_){case y.X:this.x=P;break;case y.Y:this.y=P;break;default:throw new U("Invalid ordinate index: "+_)}}},{key:"getZ",value:function(){return Be.NULL_ORDINATE}},{key:"getOrdinate",value:function(_){switch(_){case y.X:return this.x;case y.Y:return this.y}throw new U("Invalid ordinate index: "+_)}},{key:"setZ",value:function(_){throw new U("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)Be.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Be.constructor_.call(this,_.x,_.y)}else if(arguments[0]instanceof Be){var P=arguments[0];Be.constructor_.call(this,P.x,P.y)}}else if(arguments.length===2){var $=arguments[0],ne=arguments[1];Be.constructor_.call(this,$,ne,Be.NULL_ORDINATE)}}}])})(Be);ei.X=0,ei.Y=1,ei.Z=-1,ei.M=-1;var ua=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(_,P){switch(_){case y.X:this.x=P;break;case y.Y:this.y=P;break;case y.M:this._m=P;break;default:throw new U("Invalid ordinate index: "+_)}}},{key:"setM",value:function(_){this._m=_}},{key:"getZ",value:function(){return Be.NULL_ORDINATE}},{key:"getOrdinate",value:function(_){switch(_){case y.X:return this.x;case y.Y:return this.y;case y.M:return this._m}throw new U("Invalid ordinate index: "+_)}},{key:"setZ",value:function(_){throw new U("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ(),this._m=_.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Be.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Be.constructor_.call(this,_.x,_.y),this._m=_._m}else if(arguments[0]instanceof Be){var P=arguments[0];Be.constructor_.call(this,P.x,P.y),this._m=this.getM()}}else if(arguments.length===3){var $=arguments[0],ne=arguments[1],ve=arguments[2];Be.constructor_.call(this,$,ne,Be.NULL_ORDINATE),this._m=ve}}}])})(Be);ua.X=0,ua.Y=1,ua.Z=-1,ua.M=2;var ha=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(_,P){switch(_){case Be.X:this.x=P;break;case Be.Y:this.y=P;break;case Be.Z:this.z=P;break;case Be.M:this._m=P;break;default:throw new U("Invalid ordinate index: "+_)}}},{key:"setM",value:function(_){this._m=_}},{key:"getOrdinate",value:function(_){switch(_){case Be.X:return this.x;case Be.Y:return this.y;case Be.Z:return this.getZ();case Be.M:return this.getM()}throw new U("Invalid ordinate index: "+_)}},{key:"copy",value:function(){return new y(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(_){this.x=_.x,this.y=_.y,this.z=_.getZ(),this._m=_.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Be.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof y){var _=arguments[0];Be.constructor_.call(this,_),this._m=_._m}else if(arguments[0]instanceof Be){var P=arguments[0];Be.constructor_.call(this,P),this._m=this.getM()}}else if(arguments.length===4){var $=arguments[0],ne=arguments[1],ve=arguments[2],Oe=arguments[3];Be.constructor_.call(this,$,ne,ve),this._m=Oe}}}])})(Be),zn=(function(){function I(){i(this,I)}return o(I,null,[{key:"measures",value:function(y){return y instanceof ei?0:y instanceof ua||y instanceof ha?1:0}},{key:"dimension",value:function(y){return y instanceof ei?2:y instanceof ua?3:y instanceof ha?4:3}},{key:"create",value:function(){if(arguments.length===1){var y=arguments[0];return I.create(y,0)}if(arguments.length===2){var _=arguments[0],P=arguments[1];return _===2?new ei:_===3&&P===0?new Be:_===3&&P===1?new ua:_===4&&P===1?new ha:new Be}}}])})(),Na=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getCoordinate",value:function(_){return this.get(_)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&Tr(arguments[0],zt)){for(var _=arguments[1],P=!1,$=arguments[0].iterator();$.hasNext();)this.add($.next(),_),P=!0;return P}return E(y,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var _=E(y,"clone",this,1).call(this),P=0;P<this.size();P++)_.add(P,this.get(P).clone());return _}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(y.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(y.coordArrayType);for(var _=this.size(),P=new Array(_).fill(null),$=0;$<_;$++)P[$]=this.get(_-$-1);return P}}},{key:"add",value:function(){if(arguments.length===1){var _=arguments[0];return E(y,"add",this,1).call(this,_)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var P=arguments[0],$=arguments[1];return this.add(P,$,!0),!0}if(arguments[0]instanceof Be&&typeof arguments[1]=="boolean"){var ne=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(ne))return null;E(y,"add",this,1).call(this,ne)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var ve=arguments[0],Oe=arguments[1];return this.add(ve,Oe),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var tt=arguments[0],ft=arguments[1];if(arguments[2])for(var rr=0;rr<tt.length;rr++)this.add(tt[rr],ft);else for(var ur=tt.length-1;ur>=0;ur--)this.add(tt[ur],ft);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Be){var qr=arguments[0],bn=arguments[1];if(!arguments[2]){var Dn=this.size();if(Dn>0&&(qr>0&&this.get(qr-1).equals2D(bn)||qr<Dn&&this.get(qr).equals2D(bn)))return null}E(y,"add",this,1).call(this,qr,bn)}}else if(arguments.length===4){var Xn=arguments[0],Fn=arguments[1],En=arguments[2],na=arguments[3],ca=1;En>na&&(ca=-1);for(var lo=En;lo!==na;lo+=ca)this.add(Xn[lo],Fn);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var _=this.get(0).copy();this.add(_,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var _=arguments[0];this.ensureCapacity(_.length),this.add(_,!0)}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.ensureCapacity(P.length),this.add(P,$)}}}}])})(ct);Na.coordArrayType=new Array(0).fill(null);var Wi=(function(){function I(){i(this,I)}return o(I,null,[{key:"isRing",value:function(y){return!(y.length<4)&&!!y[0].equals2D(y[y.length-1])}},{key:"ptNotInList",value:function(y,_){for(var P=0;P<y.length;P++){var $=y[P];if(I.indexOf($,_)<0)return $}return null}},{key:"scroll",value:function(y,_){var P=I.indexOf(_,y);if(P<0)return null;var $=new Array(y.length).fill(null);Ar.arraycopy(y,P,$,0,y.length-P),Ar.arraycopy(y,0,$,y.length-P,P),Ar.arraycopy($,0,y,0,y.length)}},{key:"equals",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];if(y===_)return!0;if(y===null||_===null||y.length!==_.length)return!1;for(var P=0;P<y.length;P++)if(!y[P].equals(_[P]))return!1;return!0}if(arguments.length===3){var $=arguments[0],ne=arguments[1],ve=arguments[2];if($===ne)return!0;if($===null||ne===null||$.length!==ne.length)return!1;for(var Oe=0;Oe<$.length;Oe++)if(ve.compare($[Oe],ne[Oe])!==0)return!1;return!0}}},{key:"intersection",value:function(y,_){for(var P=new Na,$=0;$<y.length;$++)_.intersects(y[$])&&P.add(y[$],!0);return P.toCoordinateArray()}},{key:"measures",value:function(y){if(y===null||y.length===0)return 0;var _,P=0,$=c(y);try{for($.s();!(_=$.n()).done;){var ne=_.value;P=Math.max(P,zn.measures(ne))}}catch(ve){$.e(ve)}finally{$.f()}return P}},{key:"hasRepeatedPoints",value:function(y){for(var _=1;_<y.length;_++)if(y[_-1].equals(y[_]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(y){return I.hasRepeatedPoints(y)?new Na(y,!1).toCoordinateArray():y}},{key:"reverse",value:function(y){for(var _=y.length-1,P=Math.trunc(_/2),$=0;$<=P;$++){var ne=y[$];y[$]=y[_-$],y[_-$]=ne}}},{key:"removeNull",value:function(y){for(var _=0,P=0;P<y.length;P++)y[P]!==null&&_++;var $=new Array(_).fill(null);if(_===0)return $;for(var ne=0,ve=0;ve<y.length;ve++)y[ve]!==null&&($[ne++]=y[ve]);return $}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var y=arguments[0],_=new Array(y.length).fill(null),P=0;P<y.length;P++)_[P]=y[P].copy();return _}if(arguments.length===5)for(var $=arguments[0],ne=arguments[1],ve=arguments[2],Oe=arguments[3],tt=arguments[4],ft=0;ft<tt;ft++)ve[Oe+ft]=$[ne+ft].copy()}},{key:"isEqualReversed",value:function(y,_){for(var P=0;P<y.length;P++){var $=y[P],ne=_[y.length-P-1];if($.compareTo(ne)!==0)return!1}return!0}},{key:"envelope",value:function(y){for(var _=new Ke,P=0;P<y.length;P++)_.expandToInclude(y[P]);return _}},{key:"toCoordinateArray",value:function(y){return y.toArray(I.coordArrayType)}},{key:"dimension",value:function(y){if(y===null||y.length===0)return 3;var _,P=0,$=c(y);try{for($.s();!(_=$.n()).done;){var ne=_.value;P=Math.max(P,zn.dimension(ne))}}catch(ve){$.e(ve)}finally{$.f()}return P}},{key:"atLeastNCoordinatesOrNothing",value:function(y,_){return _.length>=y?_:[]}},{key:"indexOf",value:function(y,_){for(var P=0;P<_.length;P++)if(y.equals(_[P]))return P;return-1}},{key:"increasingDirection",value:function(y){for(var _=0;_<Math.trunc(y.length/2);_++){var P=y.length-1-_,$=y[_].compareTo(y[P]);if($!==0)return $}return 1}},{key:"compare",value:function(y,_){for(var P=0;P<y.length&&P<_.length;){var $=y[P].compareTo(_[P]);if($!==0)return $;P++}return P<_.length?-1:P<y.length?1:0}},{key:"minCoordinate",value:function(y){for(var _=null,P=0;P<y.length;P++)(_===null||_.compareTo(y[P])>0)&&(_=y[P]);return _}},{key:"extract",value:function(y,_,P){_=$r.clamp(_,0,y.length);var $=(P=$r.clamp(P,-1,y.length))-_+1;P<0&&($=0),_>=y.length&&($=0),P<_&&($=0);var ne=new Array($).fill(null);if($===0)return ne;for(var ve=0,Oe=_;Oe<=P;Oe++)ne[ve++]=y[Oe];return ne}}])})(),ds=(function(){return o((function I(){i(this,I)}),[{key:"compare",value:function(I,y){var _=I,P=y;return Wi.compare(_,P)}},{key:"interfaces_",get:function(){return[Re]}}])})(),Ca=(function(){return o((function I(){i(this,I)}),[{key:"compare",value:function(I,y){var _=I,P=y;if(_.length<P.length)return-1;if(_.length>P.length)return 1;if(_.length===0)return 0;var $=Wi.compare(_,P);return Wi.isEqualReversed(_,P)?0:$}},{key:"OLDcompare",value:function(I,y){var _=I,P=y;if(_.length<P.length)return-1;if(_.length>P.length)return 1;if(_.length===0)return 0;for(var $=Wi.increasingDirection(_),ne=Wi.increasingDirection(P),ve=$>0?0:_.length-1,Oe=ne>0?0:_.length-1,tt=0;tt<_.length;tt++){var ft=_[ve].compareTo(P[Oe]);if(ft!==0)return ft;ve+=$,Oe+=ne}return 0}},{key:"interfaces_",get:function(){return[Re]}}])})();Wi.ForwardComparator=ds,Wi.BidirectionalComparator=Ca,Wi.coordArrayType=new Array(0).fill(null);var Do=(function(){return o((function I(y){i(this,I),this.str=y}),[{key:"append",value:function(I){this.str+=I}},{key:"setCharAt",value:function(I,y){this.str=this.str.substr(0,I)+y+this.str.substr(I+1)}},{key:"toString",value:function(){return this.str}}])})(),Ya=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getM",value:function(y){return this.hasM()?this._coordinates[y].getM():Te.NaN}},{key:"setOrdinate",value:function(y,_,P){switch(_){case qe.X:this._coordinates[y].x=P;break;case qe.Y:this._coordinates[y].y=P;break;default:this._coordinates[y].setOrdinate(_,P)}}},{key:"getZ",value:function(y){return this.hasZ()?this._coordinates[y].getZ():Te.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(y,_){switch(_){case qe.X:return this._coordinates[y].x;case qe.Y:return this._coordinates[y].y;default:return this._coordinates[y].getOrdinate(_)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var y=arguments[0];return this._coordinates[y]}if(arguments.length===2){var _=arguments[0];arguments[1].setCoordinate(this._coordinates[_])}}},{key:"getCoordinateCopy",value:function(y){var _=this.createCoordinate();return _.setCoordinate(this._coordinates[y]),_}},{key:"createCoordinate",value:function(){return zn.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(y){return this._coordinates[y].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(y){for(var _=0;_<this._coordinates.length;_++)y.expandToInclude(this._coordinates[_]);return y}},{key:"copy",value:function(){for(var y=new Array(this.size()).fill(null),_=0;_<this._coordinates.length;_++){var P=this.createCoordinate();P.setCoordinate(this._coordinates[_]),y[_]=P}return new I(y,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var y=new Do(17*this._coordinates.length);y.append("("),y.append(this._coordinates[0]);for(var _=1;_<this._coordinates.length;_++)y.append(", "),y.append(this._coordinates[_]);return y.append(")"),y.toString()}return"()"}},{key:"getY",value:function(y){return this._coordinates[y].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[qe,X]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];I.constructor_.call(this,y,Wi.dimension(y),Wi.measures(y))}else if(Number.isInteger(arguments[0])){var _=arguments[0];this._coordinates=new Array(_).fill(null);for(var P=0;P<_;P++)this._coordinates[P]=new Be}else if(Tr(arguments[0],qe)){var $=arguments[0];if($===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=$.getDimension(),this._measures=$.getMeasures(),this._coordinates=new Array($.size()).fill(null);for(var ne=0;ne<this._coordinates.length;ne++)this._coordinates[ne]=$.getCoordinateCopy(ne)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var ve=arguments[0],Oe=arguments[1];I.constructor_.call(this,ve,Oe,Wi.measures(ve))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var tt=arguments[0],ft=arguments[1];this._coordinates=new Array(tt).fill(null),this._dimension=ft;for(var rr=0;rr<tt;rr++)this._coordinates[rr]=zn.create(ft)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var ur=arguments[0],qr=arguments[1],bn=arguments[2];this._dimension=qr,this._measures=bn,this._coordinates=ur===null?new Array(0).fill(null):ur}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Dn=arguments[0],Xn=arguments[1],Fn=arguments[2];this._coordinates=new Array(Dn).fill(null),this._dimension=Xn,this._measures=Fn;for(var En=0;En<Dn;En++)this._coordinates[En]=this.createCoordinate()}}}}])})(),sl=(function(){function I(){i(this,I)}return o(I,[{key:"readResolve",value:function(){return I.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new Ya(arguments[0]);if(Tr(arguments[0],qe))return new Ya(arguments[0])}else{if(arguments.length===2){var y=arguments[1];return y>3&&(y=3),y<2&&(y=2),new Ya(arguments[0],y)}if(arguments.length===3){var _=arguments[2],P=arguments[1]-_;return _>1&&(_=1),P>3&&(P=3),P<2&&(P=2),new Ya(arguments[0],P+_,_)}}}},{key:"interfaces_",get:function(){return[zr,X]}}],[{key:"instance",value:function(){return I.instanceObject}}])})();sl.instanceObject=new sl;var xi=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&E(y,"equalsExact",this,1).call(this,_,P)}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return it.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var _=new ct,P=0;P<this._geometries.length;P++)for(var $=this._geometries[P].getBoundary(),ne=0;ne<$.getNumGeometries();ne++)_.add($.getGeometryN(ne));var ve=new Array(_.size()).fill(null);return this.getFactory().createMultiLineString(_.toArray(ve))}},{key:"getGeometryType",value:function(){return it.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Ut]}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Fr.constructor_.call(this,_,P)}}])})(Fr),zi=(function(){return o((function I(){i(this,I)}),[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])})(),Iu=(function(I){function y(){var _;return i(this,y),(_=n(this,y)).map=new Map,_}return m(y,I),o(y,[{key:"get",value:function(_){return this.map.get(_)||null}},{key:"put",value:function(_,P){return this.map.set(_,P),P}},{key:"values",value:function(){for(var _=new ct,P=this.map.values(),$=P.next();!$.done;)_.add($.value),$=P.next();return _}},{key:"entrySet",value:function(){var _=new Ht;return this.map.entries().forEach((function(P){return _.add(P)})),_}},{key:"size",value:function(){return this.map.size()}}])})(zi),ma=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"equals",value:function(y){if(!(y instanceof I))return!1;var _=y;return this._modelType===_._modelType&&this._scale===_._scale}},{key:"compareTo",value:function(y){var _=y,P=this.getMaximumSignificantDigits(),$=_.getMaximumSignificantDigits();return at.compare(P,$)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===I.FLOATING||this._modelType===I.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var y="UNKNOWN";return this._modelType===I.FLOATING?y="Floating":this._modelType===I.FLOATING_SINGLE?y="Floating-Single":this._modelType===I.FIXED&&(y="Fixed (Scale="+this.getScale()+")"),y}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var y=arguments[0];return Te.isNaN(y)||this._modelType===I.FLOATING_SINGLE?y:this._modelType===I.FIXED?Math.round(y*this._scale)/this._scale:y}if(arguments[0]instanceof Be){var _=arguments[0];if(this._modelType===I.FLOATING)return null;_.x=this.makePrecise(_.x),_.y=this.makePrecise(_.y)}}},{key:"getMaximumSignificantDigits",value:function(){var y=16;return this._modelType===I.FLOATING?y=16:this._modelType===I.FLOATING_SINGLE?y=6:this._modelType===I.FIXED&&(y=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),y}},{key:"setScale",value:function(y){this._scale=Math.abs(y)}},{key:"interfaces_",get:function(){return[X,H]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=I.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Za){var y=arguments[0];this._modelType=y,y===I.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var _=arguments[0];this._modelType=I.FIXED,this.setScale(_)}else if(arguments[0]instanceof I){var P=arguments[0];this._modelType=P._modelType,this._scale=P._scale}}}},{key:"mostPrecise",value:function(y,_){return y.compareTo(_)>=0?y:_}}])})(),Za=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"readResolve",value:function(){return I.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){this._name=null;var y=arguments[0];this._name=y,I.nameToTypeMap.put(y,this)}}])})();Za.nameToTypeMap=new Iu,ma.Type=Za,ma.FIXED=new Za("FIXED"),ma.FLOATING=new Za("FLOATING"),ma.FLOATING_SINGLE=new Za("FLOATING SINGLE"),ma.maximumPreciseValue=9007199254740992;var ps=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"copyInternal",value:function(){for(var _=new Array(this._geometries.length).fill(null),P=0;P<_.length;P++)_[P]=this._geometries[P].copy();return new y(_,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof it){var _=arguments[0],P=arguments[1];return!!this.isEquivalentClass(_)&&E(y,"equalsExact",this,1).call(this,_,P)}return E(y,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?nr.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var _=0;_<this._geometries.length;_++)if(!this._geometries[_].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return it.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new $e}},{key:"getGeometryType",value:function(){return it.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[jn]}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];Fr.constructor_.call(this,_,P)}}])})(Fr),Aa=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"createEmpty",value:function(y){switch(y){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new U("Invalid dimension: "+y)}}},{key:"toGeometry",value:function(y){return y.isNull()?this.createPoint():y.getMinX()===y.getMaxX()&&y.getMinY()===y.getMaxY()?this.createPoint(new Be(y.getMinX(),y.getMinY())):y.getMinX()===y.getMaxX()||y.getMinY()===y.getMaxY()?this.createLineString([new Be(y.getMinX(),y.getMinY()),new Be(y.getMaxX(),y.getMaxY())]):this.createPolygon(this.createLinearRing([new Be(y.getMinX(),y.getMinY()),new Be(y.getMinX(),y.getMaxY()),new Be(y.getMaxX(),y.getMaxY()),new Be(y.getMaxX(),y.getMinY()),new Be(y.getMinX(),y.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];return this.createLineString(y!==null?this.getCoordinateSequenceFactory().create(y):null)}if(Tr(arguments[0],qe))return new Kn(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new ps(null,this):arguments.length===1?new ps(arguments[0],this):void 0}},{key:"buildGeometry",value:function(y){for(var _=null,P=!1,$=!1,ne=y.iterator();ne.hasNext();){var ve=ne.next(),Oe=ve.getTypeCode();_===null&&(_=Oe),Oe!==_&&(P=!0),ve instanceof Fr&&($=!0)}if(_===null)return this.createGeometryCollection();if(P||$)return this.createGeometryCollection(I.toGeometryArray(y));var tt=y.iterator().next();if(y.size()>1){if(tt instanceof Xr)return this.createMultiPolygon(I.toPolygonArray(y));if(tt instanceof Kn)return this.createMultiLineString(I.toLineStringArray(y));if(tt instanceof He)return this.createMultiPoint(I.toPointArray(y));xe.shouldNeverReachHere("Unhandled geometry type: "+tt.getGeometryType())}return tt}},{key:"createMultiPointFromCoords",value:function(y){return this.createMultiPoint(y!==null?this.getCoordinateSequenceFactory().create(y):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Be){var y=arguments[0];return this.createPoint(y!==null?this.getCoordinateSequenceFactory().create([y]):null)}if(Tr(arguments[0],qe))return new He(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(Tr(arguments[0],qe)){var y=arguments[0];return this.createPolygon(this.createLinearRing(y))}if(arguments[0]instanceof Array){var _=arguments[0];return this.createPolygon(this.createLinearRing(_))}if(arguments[0]instanceof Bn){var P=arguments[0];return this.createPolygon(P,null)}}else if(arguments.length===2)return new Xr(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new Fr(null,this):arguments.length===1?new Fr(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];return this.createLinearRing(y!==null?this.getCoordinateSequenceFactory().create(y):null)}if(Tr(arguments[0],qe))return new Bn(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new xi(null,this):arguments.length===1?new xi(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Rn(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new Rn(arguments[0],this);if(Tr(arguments[0],qe)){var y=arguments[0];if(y===null)return this.createMultiPoint(new Array(0).fill(null));for(var _=new Array(y.size()).fill(null),P=0;P<y.size();P++){var $=this.getCoordinateSequenceFactory().create(1,y.getDimension(),y.getMeasures());Qr.copy(y,P,$,0,1),_[P]=this.createPoint($)}return this.createMultiPoint(_)}}}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)I.constructor_.call(this,new ma,0);else if(arguments.length===1){if(Tr(arguments[0],zr)){var y=arguments[0];I.constructor_.call(this,new ma,0,y)}else if(arguments[0]instanceof ma){var _=arguments[0];I.constructor_.call(this,_,0,I.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];I.constructor_.call(this,P,$,I.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var ne=arguments[0],ve=arguments[1],Oe=arguments[2];this._precisionModel=ne,this._coordinateSequenceFactory=Oe,this._SRID=ve}}},{key:"toMultiPolygonArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toGeometryArray",value:function(y){if(y===null)return null;var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return sl.instance()}},{key:"toMultiLineStringArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toLineStringArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toMultiPointArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toLinearRingArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toPointArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"toPolygonArray",value:function(y){var _=new Array(y.size()).fill(null);return y.toArray(_)}},{key:"createPointFromInternalCoord",value:function(y,_){return _.getPrecisionModel().makePrecise(y),_.getFactory().createPoint(y)}}])})(),gs="XY",Ul="XYZ",Fa="XYM",_a="XYZM",xc={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},ll="EMPTY",rs=1,so=2,ns=3,Ba=4,Vs=5,Uc=6;for(var Pu in xc)xc[Pu].toUpperCase();var Q=(function(){return o((function I(y){i(this,I),this.wkt=y,this.index_=-1}),[{key:"isAlpha_",value:function(I){return I>="a"&&I<="z"||I>="A"&&I<="Z"}},{key:"isNumeric_",value:function(I,y){return I>="0"&&I<="9"||I=="."&&!(y!==void 0&&y)}},{key:"isWhiteSpace_",value:function(I){return I==" "||I=="	"||I=="\r"||I==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var I,y=this.nextChar_(),_=this.index_,P=y;if(y=="(")I=so;else if(y==",")I=Vs;else if(y==")")I=ns;else if(this.isNumeric_(y)||y=="-")I=Ba,P=this.readNumber_();else if(this.isAlpha_(y))I=rs,P=this.readText_();else{if(this.isWhiteSpace_(y))return this.nextToken();if(y!=="")throw new Error("Unexpected character: "+y);I=Uc}return{position:_,value:P,type:I}}},{key:"readNumber_",value:function(){var I,y=this.index_,_=!1,P=!1;do I=="."?_=!0:I!="e"&&I!="E"||(P=!0),I=this.nextChar_();while(this.isNumeric_(I,_)||!P&&(I=="e"||I=="E")||P&&(I=="-"||I=="+"));return parseFloat(this.wkt.substring(y,this.index_--))}},{key:"readText_",value:function(){var I,y=this.index_;do I=this.nextChar_();while(this.isAlpha_(I));return this.wkt.substring(y,this.index_--).toUpperCase()}}])})(),ge=(function(){return o((function I(y,_){i(this,I),this.lexer_=y,this.token_,this.layout_=gs,this.factory=_}),[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(I){return this.token_.type==I}},{key:"match",value:function(I){var y=this.isTokenType(I);return y&&this.consume_(),y}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var I=gs,y=this.token_;if(this.isTokenType(rs)){var _=y.value;_==="Z"?I=Ul:_==="M"?I=Fa:_==="ZM"&&(I=_a),I!==gs&&this.consume_()}return I}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(so)){var I=[];do I.push(this.parseGeometry_());while(this.match(Vs));if(this.match(ns))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(so)){var I=this.parsePoint_();if(this.match(ns))return I}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(so)){var I=this.parsePointList_();if(this.match(ns))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(so)){var I=this.parseLineStringTextList_();if(this.match(ns))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var I;if(this.match(so)){if(I=this.token_.type==so?this.parsePointTextList_():this.parsePointList_(),this.match(ns))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(so)){var I=this.parseLineStringTextList_();if(this.match(ns))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(so)){var I=this.parsePolygonTextList_();if(this.match(ns))return I}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var I=[],y=this.layout_.length,_=0;_<y;++_){var P=this.token_;if(!this.match(Ba))break;I.push(P.value)}if(I.length==y)return I;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var I=[this.parsePoint_()];this.match(Vs);)I.push(this.parsePoint_());return I}},{key:"parsePointTextList_",value:function(){for(var I=[this.parsePointText_()];this.match(Vs);)I.push(this.parsePointText_());return I}},{key:"parseLineStringTextList_",value:function(){for(var I=[this.parseLineStringText_()];this.match(Vs);)I.push(this.parseLineStringText_());return I}},{key:"parsePolygonTextList_",value:function(){for(var I=[this.parsePolygonText_()];this.match(Vs);)I.push(this.parsePolygonText_());return I}},{key:"isEmptyGeometry_",value:function(){var I=this.isTokenType(rs)&&this.token_.value==ll;return I&&this.consume_(),I}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var I=this.factory,y=function(Xn){return a(Be,T(Xn))},_=function(Xn){var Fn=Xn.map((function(En){return I.createLinearRing(En.map(y))}));return Fn.length>1?I.createPolygon(Fn[0],Fn.slice(1)):I.createPolygon(Fn[0])},P=this.token_;if(this.match(rs)){var $=P.value;if(this.layout_=this.parseGeometryLayout_(),$=="GEOMETRYCOLLECTION"){var ne=this.parseGeometryCollectionText_();return I.createGeometryCollection(ne)}switch($){case"POINT":var ve=this.parsePointText_();return ve?I.createPoint(a(Be,T(ve))):I.createPoint();case"LINESTRING":var Oe=this.parseLineStringText_().map(y);return I.createLineString(Oe);case"LINEARRING":var tt=this.parseLineStringText_().map(y);return I.createLinearRing(tt);case"POLYGON":var ft=this.parsePolygonText_();return ft&&ft.length!==0?_(ft):I.createPolygon();case"MULTIPOINT":var rr=this.parseMultiPointText_();if(!rr||rr.length===0)return I.createMultiPoint();var ur=rr.map(y).map((function(Xn){return I.createPoint(Xn)}));return I.createMultiPoint(ur);case"MULTILINESTRING":var qr=this.parseMultiLineStringText_().map((function(Xn){return I.createLineString(Xn.map(y))}));return I.createMultiLineString(qr);case"MULTIPOLYGON":var bn=this.parseMultiPolygonText_();if(!bn||bn.length===0)return I.createMultiPolygon();var Dn=bn.map(_);return I.createMultiPolygon(Dn);default:throw new Error("Invalid geometry type: "+$)}}throw new Error(this.formatErrorMessage_())}}])})();function Je(I){if(I.isEmpty())return"";var y=I.getCoordinate(),_=[y.x,y.y];return y.z===void 0||Number.isNaN(y.z)||_.push(y.z),y.m===void 0||Number.isNaN(y.m)||_.push(y.m),_.join(" ")}function It(I){for(var y=I.getCoordinates().map((function(ne){var ve=[ne.x,ne.y];return ne.z===void 0||Number.isNaN(ne.z)||ve.push(ne.z),ne.m===void 0||Number.isNaN(ne.m)||ve.push(ne.m),ve})),_=[],P=0,$=y.length;P<$;++P)_.push(y[P].join(" "));return _.join(", ")}function Vt(I){var y=[];y.push("("+It(I.getExteriorRing())+")");for(var _=0,P=I.getNumInteriorRing();_<P;++_)y.push("("+It(I.getInteriorRingN(_))+")");return y.join(", ")}var $t={Point:Je,LineString:It,LinearRing:It,Polygon:Vt,MultiPoint:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push("("+Je(I.getGeometryN(_))+")");return y.join(", ")},MultiLineString:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push("("+It(I.getGeometryN(_))+")");return y.join(", ")},MultiPolygon:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push("("+Vt(I.getGeometryN(_))+")");return y.join(", ")},GeometryCollection:function(I){for(var y=[],_=0,P=I.getNumGeometries();_<P;++_)y.push(er(I.getGeometryN(_)));return y.join(", ")}};function er(I){var y=I.getGeometryType(),_=$t[y];y=y.toUpperCase();var P=(function($){var ne="";if($.isEmpty())return ne;var ve=$.getCoordinate();return ve.z===void 0||Number.isNaN(ve.z)||(ne+="Z"),ve.m===void 0||Number.isNaN(ve.m)||(ne+="M"),ne})(I);return P.length>0&&(y+=" "+P),I.isEmpty()?y+" "+ll:y+" ("+_(I)+")"}var Yr=(function(){return o((function I(y){i(this,I),this.geometryFactory=y||new Aa,this.precisionModel=this.geometryFactory.getPrecisionModel()}),[{key:"read",value:function(I){var y=new Q(I);return new ge(y,this.geometryFactory).parse()}},{key:"write",value:function(I){return er(I)}}])})(),tn=(function(){return o((function I(y){i(this,I),this.parser=new Yr(y)}),[{key:"write",value:function(I){return this.parser.write(I)}}],[{key:"toLineString",value:function(I,y){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+I.x+" "+I.y+", "+y.x+" "+y.y+" )"}}])})(),Gr=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getIndexAlongSegment",value:function(y,_){return this.computeIntLineIndex(),this._intLineIndex[y][_]}},{key:"getTopologySummary",value:function(){var y=new Do;return this.isEndPoint()&&y.append(" endpoint"),this._isProper&&y.append(" proper"),this.isCollinear()&&y.append(" collinear"),y.toString()}},{key:"computeIntersection",value:function(y,_,P,$){this._inputLines[0][0]=y,this._inputLines[0][1]=_,this._inputLines[1][0]=P,this._inputLines[1][1]=$,this._result=this.computeIntersect(y,_,P,$)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var y=arguments[0];this.getEdgeDistance(y,0)>this.getEdgeDistance(y,1)?(this._intLineIndex[y][0]=0,this._intLineIndex[y][1]=1):(this._intLineIndex[y][0]=1,this._intLineIndex[y][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(y){this._precisionModel=y}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var y=arguments[0],_=0;_<this._result;_++)if(!this._intPt[_].equals2D(this._inputLines[y][0])&&!this._intPt[_].equals2D(this._inputLines[y][1]))return!0;return!1}}},{key:"getIntersection",value:function(y){return this._intPt[y]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==I.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(y,_){return I.computeEdgeDistance(this._intPt[_],this._inputLines[y][0],this._inputLines[y][1])}},{key:"isCollinear",value:function(){return this._result===I.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return tn.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+tn.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(y,_){return this._inputLines[y][_]}},{key:"isIntersection",value:function(y){for(var _=0;_<this._result;_++)if(this._intPt[_].equals2D(y))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(y,_){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[y][_]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Be,this._intPt[1]=new Be,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(y,_,P){var $=Math.abs(P.x-_.x),ne=Math.abs(P.y-_.y),ve=-1;if(y.equals(_))ve=0;else if(y.equals(P))ve=$>ne?$:ne;else{var Oe=Math.abs(y.x-_.x),tt=Math.abs(y.y-_.y);(ve=$>ne?Oe:tt)!==0||y.equals(_)||(ve=Math.max(Oe,tt))}return xe.isTrue(!(ve===0&&!y.equals(_)),"Bad distance calculation"),ve}},{key:"nonRobustComputeEdgeDistance",value:function(y,_,P){var $=y.x-_.x,ne=y.y-_.y,ve=Math.sqrt($*$+ne*ne);return xe.isTrue(!(ve===0&&!y.equals(_)),"Invalid distance calculation"),ve}}])})();Gr.DONT_INTERSECT=0,Gr.DO_INTERSECT=1,Gr.COLLINEAR=2,Gr.NO_INTERSECTION=0,Gr.POINT_INTERSECTION=1,Gr.COLLINEAR_INTERSECTION=2;var an=(function(I){function y(){return i(this,y),n(this,y)}return m(y,I),o(y,[{key:"isInSegmentEnvelopes",value:function(_){var P=new Ke(this._inputLines[0][0],this._inputLines[0][1]),$=new Ke(this._inputLines[1][0],this._inputLines[1][1]);return P.contains(_)&&$.contains(_)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return E(y,"computeIntersection",this,1).apply(this,arguments);var _=arguments[0],P=arguments[1],$=arguments[2];if(this._isProper=!1,Ke.intersects(P,$,_)&&Ge.index(P,$,_)===0&&Ge.index($,P,_)===0)return this._isProper=!0,(_.equals(P)||_.equals($))&&(this._isProper=!1),this._result=Gr.POINT_INTERSECTION,null;this._result=Gr.NO_INTERSECTION}},{key:"intersection",value:function(_,P,$,ne){var ve=this.intersectionSafe(_,P,$,ne);return this.isInSegmentEnvelopes(ve)||(ve=new Be(y.nearestEndpoint(_,P,$,ne))),this._precisionModel!==null&&this._precisionModel.makePrecise(ve),ve}},{key:"checkDD",value:function(_,P,$,ne,ve){var Oe=je.intersection(_,P,$,ne),tt=this.isInSegmentEnvelopes(Oe);Ar.out.println("DD in env = "+tt+"  --------------------- "+Oe),ve.distance(Oe)>1e-4&&Ar.out.println("Distance = "+ve.distance(Oe))}},{key:"intersectionSafe",value:function(_,P,$,ne){var ve=Ir.intersection(_,P,$,ne);return ve===null&&(ve=y.nearestEndpoint(_,P,$,ne)),ve}},{key:"computeCollinearIntersection",value:function(_,P,$,ne){var ve=Ke.intersects(_,P,$),Oe=Ke.intersects(_,P,ne),tt=Ke.intersects($,ne,_),ft=Ke.intersects($,ne,P);return ve&&Oe?(this._intPt[0]=$,this._intPt[1]=ne,Gr.COLLINEAR_INTERSECTION):tt&&ft?(this._intPt[0]=_,this._intPt[1]=P,Gr.COLLINEAR_INTERSECTION):ve&&tt?(this._intPt[0]=$,this._intPt[1]=_,!$.equals(_)||Oe||ft?Gr.COLLINEAR_INTERSECTION:Gr.POINT_INTERSECTION):ve&&ft?(this._intPt[0]=$,this._intPt[1]=P,!$.equals(P)||Oe||tt?Gr.COLLINEAR_INTERSECTION:Gr.POINT_INTERSECTION):Oe&&tt?(this._intPt[0]=ne,this._intPt[1]=_,!ne.equals(_)||ve||ft?Gr.COLLINEAR_INTERSECTION:Gr.POINT_INTERSECTION):Oe&&ft?(this._intPt[0]=ne,this._intPt[1]=P,!ne.equals(P)||ve||tt?Gr.COLLINEAR_INTERSECTION:Gr.POINT_INTERSECTION):Gr.NO_INTERSECTION}},{key:"computeIntersect",value:function(_,P,$,ne){if(this._isProper=!1,!Ke.intersects(_,P,$,ne))return Gr.NO_INTERSECTION;var ve=Ge.index(_,P,$),Oe=Ge.index(_,P,ne);if(ve>0&&Oe>0||ve<0&&Oe<0)return Gr.NO_INTERSECTION;var tt=Ge.index($,ne,_),ft=Ge.index($,ne,P);return tt>0&&ft>0||tt<0&&ft<0?Gr.NO_INTERSECTION:ve===0&&Oe===0&&tt===0&&ft===0?this.computeCollinearIntersection(_,P,$,ne):(ve===0||Oe===0||tt===0||ft===0?(this._isProper=!1,_.equals2D($)||_.equals2D(ne)?this._intPt[0]=_:P.equals2D($)||P.equals2D(ne)?this._intPt[0]=P:ve===0?this._intPt[0]=new Be($):Oe===0?this._intPt[0]=new Be(ne):tt===0?this._intPt[0]=new Be(_):ft===0&&(this._intPt[0]=new Be(P))):(this._isProper=!0,this._intPt[0]=this.intersection(_,P,$,ne)),Gr.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(_,P,$,ne){var ve=_,Oe=cn.pointToSegment(_,$,ne),tt=cn.pointToSegment(P,$,ne);return tt<Oe&&(Oe=tt,ve=P),(tt=cn.pointToSegment($,_,P))<Oe&&(Oe=tt,ve=$),(tt=cn.pointToSegment(ne,_,P))<Oe&&(Oe=tt,ve=ne),ve}}])})(Gr),Mr=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"countSegment",value:function(y,_){if(y.x<this._p.x&&_.x<this._p.x)return null;if(this._p.x===_.x&&this._p.y===_.y)return this._isPointOnSegment=!0,null;if(y.y===this._p.y&&_.y===this._p.y){var P=y.x,$=_.x;return P>$&&(P=_.x,$=y.x),this._p.x>=P&&this._p.x<=$&&(this._isPointOnSegment=!0),null}if(y.y>this._p.y&&_.y<=this._p.y||_.y>this._p.y&&y.y<=this._p.y){var ne=Ge.index(y,_,this._p);if(ne===Ge.COLLINEAR)return this._isPointOnSegment=!0,null;_.y<y.y&&(ne=-ne),ne===Ge.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==Me.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?Me.BOUNDARY:this._crossingCount%2==1?Me.INTERIOR:Me.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var y=arguments[0];this._p=y}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof Be&&Tr(arguments[1],qe)){for(var y=arguments[1],_=new I(arguments[0]),P=new Be,$=new Be,ne=1;ne<y.size();ne++)if(y.getCoordinate(ne,P),y.getCoordinate(ne-1,$),_.countSegment(P,$),_.isOnSegment())return _.getLocation();return _.getLocation()}if(arguments[0]instanceof Be&&arguments[1]instanceof Array){for(var ve=arguments[1],Oe=new I(arguments[0]),tt=1;tt<ve.length;tt++){var ft=ve[tt],rr=ve[tt-1];if(Oe.countSegment(ft,rr),Oe.isOnSegment())return Oe.getLocation()}return Oe.getLocation()}}}])})(),ti=(function(){function I(){i(this,I)}return o(I,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof Be&&Tr(arguments[1],qe)){for(var y=arguments[0],_=arguments[1],P=new an,$=new Be,ne=new Be,ve=_.size(),Oe=1;Oe<ve;Oe++)if(_.getCoordinate(Oe-1,$),_.getCoordinate(Oe,ne),P.computeIntersection(y,$,ne),P.hasIntersection())return!0;return!1}if(arguments[0]instanceof Be&&arguments[1]instanceof Array){for(var tt=arguments[0],ft=arguments[1],rr=new an,ur=1;ur<ft.length;ur++){var qr=ft[ur-1],bn=ft[ur];if(rr.computeIntersection(tt,qr,bn),rr.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(y,_){return Mr.locatePointInRing(y,_)}},{key:"isInRing",value:function(y,_){return I.locateInRing(y,_)!==Me.EXTERIOR}}])})(),ki=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"setAllLocations",value:function(y){for(var _=0;_<this.location.length;_++)this.location[_]=y}},{key:"isNull",value:function(){for(var y=0;y<this.location.length;y++)if(this.location[y]!==Me.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(y){for(var _=0;_<this.location.length;_++)this.location[_]===Me.NONE&&(this.location[_]=y)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(y){if(y.location.length>this.location.length){var _=new Array(3).fill(null);_[_t.ON]=this.location[_t.ON],_[_t.LEFT]=Me.NONE,_[_t.RIGHT]=Me.NONE,this.location=_}for(var P=0;P<this.location.length;P++)this.location[P]===Me.NONE&&P<y.location.length&&(this.location[P]=y.location[P])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var y=this.location[_t.LEFT];this.location[_t.LEFT]=this.location[_t.RIGHT],this.location[_t.RIGHT]=y}},{key:"toString",value:function(){var y=new Qt;return this.location.length>1&&y.append(Me.toLocationSymbol(this.location[_t.LEFT])),y.append(Me.toLocationSymbol(this.location[_t.ON])),this.location.length>1&&y.append(Me.toLocationSymbol(this.location[_t.RIGHT])),y.toString()}},{key:"setLocations",value:function(y,_,P){this.location[_t.ON]=y,this.location[_t.LEFT]=_,this.location[_t.RIGHT]=P}},{key:"get",value:function(y){return y<this.location.length?this.location[y]:Me.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var y=0;y<this.location.length;y++)if(this.location[y]===Me.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var y=arguments[0];this.setLocation(_t.ON,y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.location[_]=P}}},{key:"init",value:function(y){this.location=new Array(y).fill(null),this.setAllLocations(Me.NONE)}},{key:"isEqualOnSide",value:function(y,_){return this.location[_]===y.location[_]}},{key:"allPositionsEqual",value:function(y){for(var _=0;_<this.location.length;_++)if(this.location[_]!==y)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var y=arguments[0];this.init(y.length)}else if(Number.isInteger(arguments[0])){var _=arguments[0];this.init(1),this.location[_t.ON]=_}else if(arguments[0]instanceof I){var P=arguments[0];if(this.init(P.location.length),P!==null)for(var $=0;$<this.location.length;$++)this.location[$]=P.location[$]}}else if(arguments.length===3){var ne=arguments[0],ve=arguments[1],Oe=arguments[2];this.init(3),this.location[_t.ON]=ne,this.location[_t.LEFT]=ve,this.location[_t.RIGHT]=Oe}}}])})(),$n=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getGeometryCount",value:function(){var y=0;return this.elt[0].isNull()||y++,this.elt[1].isNull()||y++,y}},{key:"setAllLocations",value:function(y,_){this.elt[y].setAllLocations(_)}},{key:"isNull",value:function(y){return this.elt[y].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var y=arguments[0];this.setAllLocationsIfNull(0,y),this.setAllLocationsIfNull(1,y)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.elt[_].setAllLocationsIfNull(P)}}},{key:"isLine",value:function(y){return this.elt[y].isLine()}},{key:"merge",value:function(y){for(var _=0;_<2;_++)this.elt[_]===null&&y.elt[_]!==null?this.elt[_]=new ki(y.elt[_]):this.elt[_].merge(y.elt[_])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var y=arguments[0];return this.elt[y].get(_t.ON)}if(arguments.length===2){var _=arguments[0],P=arguments[1];return this.elt[_].get(P)}}},{key:"toString",value:function(){var y=new Qt;return this.elt[0]!==null&&(y.append("A:"),y.append(this.elt[0].toString())),this.elt[1]!==null&&(y.append(" B:"),y.append(this.elt[1].toString())),y.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var y=arguments[0];return this.elt[y].isArea()}}},{key:"isAnyNull",value:function(y){return this.elt[y].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];this.elt[y].setLocation(_t.ON,_)}else if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2];this.elt[P].setLocation($,ne)}}},{key:"isEqualOnSide",value:function(y,_){return this.elt[0].isEqualOnSide(y.elt[0],_)&&this.elt[1].isEqualOnSide(y.elt[1],_)}},{key:"allPositionsEqual",value:function(y,_){return this.elt[y].allPositionsEqual(_)}},{key:"toLine",value:function(y){this.elt[y].isArea()&&(this.elt[y]=new ki(this.elt[y].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var y=arguments[0];this.elt[0]=new ki(y),this.elt[1]=new ki(y)}else if(arguments[0]instanceof I){var _=arguments[0];this.elt[0]=new ki(_.elt[0]),this.elt[1]=new ki(_.elt[1])}}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.elt[0]=new ki(Me.NONE),this.elt[1]=new ki(Me.NONE),this.elt[P].setLocation($)}else if(arguments.length===3){var ne=arguments[0],ve=arguments[1],Oe=arguments[2];this.elt[0]=new ki(ne,ve,Oe),this.elt[1]=new ki(ne,ve,Oe)}else if(arguments.length===4){var tt=arguments[0],ft=arguments[1],rr=arguments[2],ur=arguments[3];this.elt[0]=new ki(Me.NONE,Me.NONE,Me.NONE),this.elt[1]=new ki(Me.NONE,Me.NONE,Me.NONE),this.elt[tt].setLocations(ft,rr,ur)}}},{key:"toLineLabel",value:function(y){for(var _=new I(Me.NONE),P=0;P<2;P++)_.setLocation(P,y.getLocation(P));return _}}])})(),_n=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var I=new Array(this._pts.size()).fill(null),y=0;y<this._pts.size();y++)I[y]=this._pts.get(y);this._ring=this._geometryFactory.createLinearRing(I),this._isHole=Ge.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(I){this._startDe=I;var y=I,_=!0;do{if(y===null)throw new Et("Found null DirectedEdge");if(y.getEdgeRing()===this)throw new Et("Directed Edge visited twice during ring-building at "+y.getCoordinate());this._edges.add(y);var P=y.getLabel();xe.isTrue(P.isArea()),this.mergeLabel(P),this.addPoints(y.getEdge(),y.isForward(),_),_=!1,this.setEdgeRing(y,this),y=this.getNext(y)}while(y!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(I){return this._pts.get(I)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var I=this._startDe;do{var y=I.getNode().getEdges().getOutgoingDegree(this);y>this._maxNodeDegree&&(this._maxNodeDegree=y),I=this.getNext(I)}while(I!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(I,y,_){var P=I.getCoordinates();if(y){var $=1;_&&($=0);for(var ne=$;ne<P.length;ne++)this._pts.add(P[ne])}else{var ve=P.length-2;_&&(ve=P.length-1);for(var Oe=ve;Oe>=0;Oe--)this._pts.add(P[Oe])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var I=this._startDe;do I.getEdge().setInResult(!0),I=I.getNext();while(I!==this._startDe)}},{key:"containsPoint",value:function(I){var y=this.getLinearRing();if(!y.getEnvelopeInternal().contains(I)||!ti.isInRing(I,y.getCoordinates()))return!1;for(var _=this._holes.iterator();_.hasNext();)if(_.next().containsPoint(I))return!1;return!0}},{key:"addHole",value:function(I){this._holes.add(I)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var I=arguments[0];this.mergeLabel(I,0),this.mergeLabel(I,1)}else if(arguments.length===2){var y=arguments[1],_=arguments[0].getLocation(y,_t.RIGHT);if(_===Me.NONE)return null;if(this._label.getLocation(y)===Me.NONE)return this._label.setLocation(y,_),null}}},{key:"setShell",value:function(I){this._shell=I,I!==null&&I.addHole(this)}},{key:"toPolygon",value:function(I){for(var y=new Array(this._holes.size()).fill(null),_=0;_<this._holes.size();_++)y[_]=this._holes.get(_).getLinearRing();return I.createPolygon(this.getLinearRing(),y)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new ct,this._pts=new ct,this._label=new $n(Me.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new ct,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var I=arguments[0],y=arguments[1];this._geometryFactory=y,this.computePoints(I),this.computeRing()}}}}])})(),Rr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"setEdgeRing",value:function(_,P){_.setMinEdgeRing(P)}},{key:"getNext",value:function(_){return _.getNextMin()}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];_n.constructor_.call(this,_,P)}}])})(_n),fn=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"buildMinimalRings",value:function(){var _=new ct,P=this._startDe;do{if(P.getMinEdgeRing()===null){var $=new Rr(P,this._geometryFactory);_.add($)}P=P.getNext()}while(P!==this._startDe);return _}},{key:"setEdgeRing",value:function(_,P){_.setEdgeRing(P)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var _=this._startDe;do _.getNode().getEdges().linkMinimalDirectedEdges(this),_=_.getNext();while(_!==this._startDe)}},{key:"getNext",value:function(_){return _.getNext()}}],[{key:"constructor_",value:function(){var _=arguments[0],P=arguments[1];_n.constructor_.call(this,_,P)}}])})(_n),mn=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"setVisited",value:function(I){this._isVisited=I}},{key:"setInResult",value:function(I){this._isInResult=I}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(I){this._label=I}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(I){this._isCovered=I,this._isCoveredSet=!0}},{key:"updateIM",value:function(I){xe.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(I)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var I=arguments[0];this._label=I}}}}])})(),fi=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"isIncidentEdgeInResult",value:function(){for(var _=this.getEdges().getEdges().iterator();_.hasNext();)if(_.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(_){_.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(_){}},{key:"computeMergedLocation",value:function(_,P){var $=Me.NONE;if($=this._label.getLocation(P),!_.isNull(P)){var ne=_.getLocation(P);$!==Me.BOUNDARY&&($=ne)}return $}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return E(y,"setLabel",this,1).apply(this,arguments);var _=arguments[0],P=arguments[1];this._label===null?this._label=new $n(_,P):this._label.setLocation(_,P)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof y){var _=arguments[0];this.mergeLabel(_._label)}else if(arguments[0]instanceof $n)for(var P=arguments[0],$=0;$<2;$++){var ne=this.computeMergedLocation(P,$);this._label.getLocation($)===Me.NONE&&this._label.setLocation($,ne)}}},{key:"add",value:function(_){this._edges.insert(_),_.setNode(this)}},{key:"setLabelBoundary",value:function(_){if(this._label===null)return null;var P=Me.NONE;this._label!==null&&(P=this._label.getLocation(_));var $=null;switch(P){case Me.BOUNDARY:$=Me.INTERIOR;break;case Me.INTERIOR:default:$=Me.BOUNDARY}this._label.setLocation(_,$)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var _=arguments[0],P=arguments[1];this._coord=_,this._edges=P,this._label=new $n(0,Me.NONE)}}])})(mn),$i=(function(I){function y(){return i(this,y),n(this,y,arguments)}return m(y,I),o(y)})(zi);function ba(I){return I==null?0:I.color}function wi(I){return I==null?null:I.parent}function hi(I,y){I!==null&&(I.color=y)}function Cs(I){return I==null?null:I.left}function $s(I){return I==null?null:I.right}var Ri=(function(I){function y(){var _;return i(this,y),(_=n(this,y)).root_=null,_.size_=0,_}return m(y,I),o(y,[{key:"get",value:function(_){for(var P=this.root_;P!==null;){var $=_.compareTo(P.key);if($<0)P=P.left;else{if(!($>0))return P.value;P=P.right}}return null}},{key:"put",value:function(_,P){if(this.root_===null)return this.root_={key:_,value:P,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var $,ne,ve=this.root_;do if($=ve,(ne=_.compareTo(ve.key))<0)ve=ve.left;else{if(!(ne>0)){var Oe=ve.value;return ve.value=P,Oe}ve=ve.right}while(ve!==null);var tt={key:_,left:null,right:null,value:P,parent:$,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return ne<0?$.left=tt:$.right=tt,this.fixAfterInsertion(tt),this.size_++,null}},{key:"fixAfterInsertion",value:function(_){var P;for(_.color=1;_!=null&&_!==this.root_&&_.parent.color===1;)wi(_)===Cs(wi(wi(_)))?ba(P=$s(wi(wi(_))))===1?(hi(wi(_),0),hi(P,0),hi(wi(wi(_)),1),_=wi(wi(_))):(_===$s(wi(_))&&(_=wi(_),this.rotateLeft(_)),hi(wi(_),0),hi(wi(wi(_)),1),this.rotateRight(wi(wi(_)))):ba(P=Cs(wi(wi(_))))===1?(hi(wi(_),0),hi(P,0),hi(wi(wi(_)),1),_=wi(wi(_))):(_===Cs(wi(_))&&(_=wi(_),this.rotateRight(_)),hi(wi(_),0),hi(wi(wi(_)),1),this.rotateLeft(wi(wi(_))));this.root_.color=0}},{key:"values",value:function(){var _=new ct,P=this.getFirstEntry();if(P!==null)for(_.add(P.value);(P=y.successor(P))!==null;)_.add(P.value);return _}},{key:"entrySet",value:function(){var _=new Ht,P=this.getFirstEntry();if(P!==null)for(_.add(P);(P=y.successor(P))!==null;)_.add(P);return _}},{key:"rotateLeft",value:function(_){if(_!=null){var P=_.right;_.right=P.left,P.left!=null&&(P.left.parent=_),P.parent=_.parent,_.parent==null?this.root_=P:_.parent.left===_?_.parent.left=P:_.parent.right=P,P.left=_,_.parent=P}}},{key:"rotateRight",value:function(_){if(_!=null){var P=_.left;_.left=P.right,P.right!=null&&(P.right.parent=_),P.parent=_.parent,_.parent==null?this.root_=P:_.parent.right===_?_.parent.right=P:_.parent.left=P,P.right=_,_.parent=P}}},{key:"getFirstEntry",value:function(){var _=this.root_;if(_!=null)for(;_.left!=null;)_=_.left;return _}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(_){for(var P=this.root_;P!==null;){var $=_.compareTo(P.key);if($<0)P=P.left;else{if(!($>0))return!0;P=P.right}}return!1}}],[{key:"successor",value:function(_){var P;if(_===null)return null;if(_.right!==null){for(P=_.right;P.left!==null;)P=P.left;return P}P=_.parent;for(var $=_;P!==null&&$===P.right;)$=P,P=P.parent;return P}}])})($i),As=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"find",value:function(I){return this.nodeMap.get(I)}},{key:"addNode",value:function(){if(arguments[0]instanceof Be){var I=arguments[0],y=this.nodeMap.get(I);return y===null&&(y=this.nodeFact.createNode(I),this.nodeMap.put(I,y)),y}if(arguments[0]instanceof fi){var _=arguments[0],P=this.nodeMap.get(_.getCoordinate());return P===null?(this.nodeMap.put(_.getCoordinate(),_),_):(P.mergeLabel(_),P)}}},{key:"print",value:function(I){for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(I){for(var y=new ct,_=this.iterator();_.hasNext();){var P=_.next();P.getLabel().getLocation(I)===Me.BOUNDARY&&y.add(P)}return y}},{key:"add",value:function(I){var y=I.getCoordinate();this.addNode(y).add(I)}}],[{key:"constructor_",value:function(){this.nodeMap=new Ri,this.nodeFact=null;var I=arguments[0];this.nodeFact=I}}])})(),oa=(function(){function I(){i(this,I)}return o(I,null,[{key:"isNorthern",value:function(y){return y===I.NE||y===I.NW}},{key:"isOpposite",value:function(y,_){return y!==_&&(y-_+4)%4===2}},{key:"commonHalfPlane",value:function(y,_){if(y===_)return y;if((y-_+4)%4===2)return-1;var P=y<_?y:_;return P===0&&(y>_?y:_)===3?3:P}},{key:"isInHalfPlane",value:function(y,_){return _===I.SE?y===I.SE||y===I.SW:y===_||y===_+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1];if(y===0&&_===0)throw new U("Cannot compute the quadrant for point ( "+y+", "+_+" )");return y>=0?_>=0?I.NE:I.SE:_>=0?I.NW:I.SW}if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var P=arguments[0],$=arguments[1];if($.x===P.x&&$.y===P.y)throw new U("Cannot compute the quadrant for two identical points "+P);return $.x>=P.x?$.y>=P.y?I.NE:I.SE:$.y>=P.y?I.NW:I.SW}}}])})();oa.NE=0,oa.NW=1,oa.SW=2,oa.SE=3;var Mu=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"compareDirection",value:function(y){return this._dx===y._dx&&this._dy===y._dy?0:this._quadrant>y._quadrant?1:this._quadrant<y._quadrant?-1:Ge.index(y._p0,y._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(y){this._node=y}},{key:"print",value:function(y){var _=Math.atan2(this._dy,this._dx),P=this.getClass().getName(),$=P.lastIndexOf("."),ne=P.substring($+1);y.print("  "+ne+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+_+"   "+this._label)}},{key:"compareTo",value:function(y){var _=y;return this.compareDirection(_)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var y=Math.atan2(this._dy,this._dx),_=this.getClass().getName(),P=_.lastIndexOf(".");return"  "+_.substring(P+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+y+"   "+this._label}},{key:"computeLabel",value:function(y){}},{key:"init",value:function(y,_){this._p0=y,this._p1=_,this._dx=_.x-y.x,this._dy=_.y-y.y,this._quadrant=oa.quadrant(this._dx,this._dy),xe.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var y=arguments[0];this._edge=y}else if(arguments.length===3){var _=arguments[0],P=arguments[1],$=arguments[2];I.constructor_.call(this,_,P,$,null)}else if(arguments.length===4){var ne=arguments[0],ve=arguments[1],Oe=arguments[2],tt=arguments[3];I.constructor_.call(this,ne),this.init(ve,Oe),this._label=tt}}}])})(),Ka=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(_){return this._depth[_]}},{key:"setVisited",value:function(_){this._isVisited=_}},{key:"computeDirectedLabel",value:function(){this._label=new $n(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(_,P){if(this._depth[_]!==-999&&this._depth[_]!==P)throw new Et("assigned depths do not match",this.getCoordinate());this._depth[_]=P}},{key:"isInteriorAreaEdge",value:function(){for(var _=!0,P=0;P<2;P++)this._label.isArea(P)&&this._label.getLocation(P,_t.LEFT)===Me.INTERIOR&&this._label.getLocation(P,_t.RIGHT)===Me.INTERIOR||(_=!1);return _}},{key:"setNextMin",value:function(_){this._nextMin=_}},{key:"print",value:function(_){E(y,"print",this,1).call(this,_),_.print(" "+this._depth[_t.LEFT]+"/"+this._depth[_t.RIGHT]),_.print(" ("+this.getDepthDelta()+")"),this._isInResult&&_.print(" inResult")}},{key:"setMinEdgeRing",value:function(_){this._minEdgeRing=_}},{key:"isLineEdge",value:function(){var _=this._label.isLine(0)||this._label.isLine(1),P=!this._label.isArea(0)||this._label.allPositionsEqual(0,Me.EXTERIOR),$=!this._label.isArea(1)||this._label.allPositionsEqual(1,Me.EXTERIOR);return _&&P&&$}},{key:"setEdgeRing",value:function(_){this._edgeRing=_}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var _=this._edge.getDepthDelta();return this._isForward||(_=-_),_}},{key:"setInResult",value:function(_){this._isInResult=_}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(_){this.print(_),_.print(" "),this._isForward?this._edge.print(_):this._edge.printReverse(_)}},{key:"setSym",value:function(_){this._sym=_}},{key:"setVisitedEdge",value:function(_){this.setVisited(_),this._sym.setVisited(_)}},{key:"setEdgeDepths",value:function(_,P){var $=this.getEdge().getDepthDelta();this._isForward||($=-$);var ne=1;_===_t.LEFT&&(ne=-1);var ve=_t.opposite(_),Oe=P+$*ne;this.setDepth(_,P),this.setDepth(ve,Oe)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(_){this._next=_}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var _=arguments[0],P=arguments[1];if(Mu.constructor_.call(this,_),this._isForward=P,P)this.init(_.getCoordinate(0),_.getCoordinate(1));else{var $=_.getNumPoints()-1;this.init(_.getCoordinate($),_.getCoordinate($-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(_,P){return _===Me.EXTERIOR&&P===Me.INTERIOR?1:_===Me.INTERIOR&&P===Me.EXTERIOR?-1:0}}])})(Mu),qs=(function(){return o((function I(){i(this,I)}),[{key:"createNode",value:function(I){return new fi(I,null)}}])})(),Vo=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"printEdges",value:function(I){I.println("Edges:");for(var y=0;y<this._edges.size();y++){I.println("edge "+y+":");var _=this._edges.get(y);_.print(I),_.eiList.print(I)}}},{key:"find",value:function(I){return this._nodes.find(I)}},{key:"addNode",value:function(){if(arguments[0]instanceof fi){var I=arguments[0];return this._nodes.addNode(I)}if(arguments[0]instanceof Be){var y=arguments[0];return this._nodes.addNode(y)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var I=this._nodes.iterator();I.hasNext();)I.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(I){Ar.out.println(I)}},{key:"isBoundaryNode",value:function(I,y){var _=this._nodes.find(y);if(_===null)return!1;var P=_.getLabel();return P!==null&&P.getLocation(I)===Me.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var I=this._nodes.iterator();I.hasNext();)I.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(I,y,_,P){return!!I.equals(_)&&Ge.index(I,y,P)===Ge.COLLINEAR&&oa.quadrant(I,y)===oa.quadrant(_,P)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(I){Ar.out.print(I)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(I,y){for(var _=0;_<this._edges.size();_++){var P=this._edges.get(_),$=P.getCoordinates();if(this.matchInSameDirection(I,y,$[0],$[1])||this.matchInSameDirection(I,y,$[$.length-1],$[$.length-2]))return P}return null}},{key:"insertEdge",value:function(I){this._edges.add(I)}},{key:"findEdgeEnd",value:function(I){for(var y=this.getEdgeEnds().iterator();y.hasNext();){var _=y.next();if(_.getEdge()===I)return _}return null}},{key:"addEdges",value:function(I){for(var y=I.iterator();y.hasNext();){var _=y.next();this._edges.add(_);var P=new Ka(_,!0),$=new Ka(_,!1);P.setSym($),$.setSym(P),this.add(P),this.add($)}}},{key:"add",value:function(I){this._nodes.add(I),this._edgeEndList.add(I)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(I,y){for(var _=0;_<this._edges.size();_++){var P=this._edges.get(_),$=P.getCoordinates();if(I.equals($[0])&&y.equals($[1]))return P}return null}}],[{key:"constructor_",value:function(){if(this._edges=new ct,this._nodes=null,this._edgeEndList=new ct,arguments.length===0)this._nodes=new As(new qs);else if(arguments.length===1){var I=arguments[0];this._nodes=new As(I)}}},{key:"linkResultDirectedEdges",value:function(I){for(var y=I.iterator();y.hasNext();)y.next().getEdges().linkResultDirectedEdges()}}])})(),ku=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"sortShellsAndHoles",value:function(y,_,P){for(var $=y.iterator();$.hasNext();){var ne=$.next();ne.isHole()?P.add(ne):_.add(ne)}}},{key:"computePolygons",value:function(y){for(var _=new ct,P=y.iterator();P.hasNext();){var $=P.next().toPolygon(this._geometryFactory);_.add($)}return _}},{key:"placeFreeHoles",value:function(y,_){for(var P=_.iterator();P.hasNext();){var $=P.next();if($.getShell()===null){var ne=I.findEdgeRingContaining($,y);if(ne===null)throw new Et("unable to assign hole to a shell",$.getCoordinate(0));$.setShell(ne)}}}},{key:"buildMinimalEdgeRings",value:function(y,_,P){for(var $=new ct,ne=y.iterator();ne.hasNext();){var ve=ne.next();if(ve.getMaxNodeDegree()>2){ve.linkDirectedEdgesForMinimalEdgeRings();var Oe=ve.buildMinimalRings(),tt=this.findShell(Oe);tt!==null?(this.placePolygonHoles(tt,Oe),_.add(tt)):P.addAll(Oe)}else $.add(ve)}return $}},{key:"buildMaximalEdgeRings",value:function(y){for(var _=new ct,P=y.iterator();P.hasNext();){var $=P.next();if($.isInResult()&&$.getLabel().isArea()&&$.getEdgeRing()===null){var ne=new fn($,this._geometryFactory);_.add(ne),ne.setInResult()}}return _}},{key:"placePolygonHoles",value:function(y,_){for(var P=_.iterator();P.hasNext();){var $=P.next();$.isHole()&&$.setShell(y)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(y){for(var _=0,P=null,$=y.iterator();$.hasNext();){var ne=$.next();ne.isHole()||(P=ne,_++)}return xe.isTrue(_<=1,"found two shells in MinimalEdgeRing list"),P}},{key:"add",value:function(){if(arguments.length===1){var y=arguments[0];this.add(y.getEdgeEnds(),y.getNodes())}else if(arguments.length===2){var _=arguments[0],P=arguments[1];Vo.linkResultDirectedEdges(P);var $=this.buildMaximalEdgeRings(_),ne=new ct,ve=this.buildMinimalEdgeRings($,this._shellList,ne);this.sortShellsAndHoles(ve,this._shellList,ne),this.placeFreeHoles(this._shellList,ne)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new ct;var y=arguments[0];this._geometryFactory=y}},{key:"findEdgeRingContaining",value:function(y,_){for(var P=y.getLinearRing(),$=P.getEnvelopeInternal(),ne=P.getCoordinateN(0),ve=null,Oe=null,tt=_.iterator();tt.hasNext();){var ft=tt.next(),rr=ft.getLinearRing(),ur=rr.getEnvelopeInternal();if(!ur.equals($)&&ur.contains($)){ne=Wi.ptNotInList(P.getCoordinates(),rr.getCoordinates());var qr=!1;ti.isInRing(ne,rr.getCoordinates())&&(qr=!0),qr&&(ve===null||Oe.contains(ur))&&(Oe=(ve=ft).getLinearRing().getEnvelopeInternal())}}return ve}}])})(),Ru=(function(){return o((function I(){i(this,I)}),[{key:"getBounds",value:function(){}}])})(),go=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[Ru,X]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var I=arguments[0],y=arguments[1];this._bounds=I,this._item=y}}])})(),ji=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"poll",value:function(){if(this.isEmpty())return null;var I=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),I}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(I){for(var y=null,_=this._items.get(I);2*I<=this._size&&((y=2*I)!==this._size&&this._items.get(y+1).compareTo(this._items.get(y))<0&&y++,this._items.get(y).compareTo(_)<0);I=y)this._items.set(I,this._items.get(y));this._items.set(I,_)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(I){this._items.add(null),this._size+=1;var y=this._size;for(this._items.set(0,I);I.compareTo(this._items.get(Math.trunc(y/2)))<0;y/=2)this._items.set(y,this._items.get(Math.trunc(y/2)));this._items.set(y,I)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new ct,this._items.add(null)}}])})(),Hs=(function(){return o((function I(){i(this,I)}),[{key:"insert",value:function(I,y){}},{key:"remove",value:function(I,y){}},{key:"query",value:function(){}}])})(),ii=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(I){xe.isTrue(this._bounds===null),this._childBoundables.add(I)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[Ru,X]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new ct,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var I=arguments[0];this._level=I}}}}])})(),ri={reverseOrder:function(){return{compare:function(I,y){return y.compareTo(I)}}},min:function(I){return ri.sort(I),I.get(0)},sort:function(I,y){var _=I.toArray();y?Gt.sort(_,y):Gt.sort(_);for(var P=I.iterator(),$=0,ne=_.length;$<ne;$++)P.next(),P.set(_[$])},singletonList:function(I){var y=new ct;return y.add(I),y}},Oo=(function(){function I(){i(this,I)}return o(I,null,[{key:"maxDistance",value:function(y,_,P,$,ne,ve,Oe,tt){var ft=I.distance(y,_,ne,ve);return ft=Math.max(ft,I.distance(y,_,Oe,tt)),ft=Math.max(ft,I.distance(P,$,ne,ve)),ft=Math.max(ft,I.distance(P,$,Oe,tt))}},{key:"distance",value:function(y,_,P,$){var ne=P-y,ve=$-_;return Math.sqrt(ne*ne+ve*ve)}},{key:"maximumDistance",value:function(y,_){var P=Math.min(y.getMinX(),_.getMinX()),$=Math.min(y.getMinY(),_.getMinY()),ne=Math.max(y.getMaxX(),_.getMaxX()),ve=Math.max(y.getMaxY(),_.getMaxY());return I.distance(P,$,ne,ve)}},{key:"minMaxDistance",value:function(y,_){var P=y.getMinX(),$=y.getMinY(),ne=y.getMaxX(),ve=y.getMaxY(),Oe=_.getMinX(),tt=_.getMinY(),ft=_.getMaxX(),rr=_.getMaxY(),ur=I.maxDistance(P,$,P,ve,Oe,tt,Oe,rr);return ur=Math.min(ur,I.maxDistance(P,$,P,ve,Oe,tt,ft,tt)),ur=Math.min(ur,I.maxDistance(P,$,P,ve,ft,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(P,$,P,ve,ft,rr,ft,tt)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,Oe,tt,Oe,rr)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,Oe,tt,ft,tt)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,ft,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(P,$,ne,$,ft,rr,ft,tt)),ur=Math.min(ur,I.maxDistance(ne,ve,P,ve,Oe,tt,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,ve,P,ve,Oe,tt,ft,tt)),ur=Math.min(ur,I.maxDistance(ne,ve,P,ve,ft,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,ve,P,ve,ft,rr,ft,tt)),ur=Math.min(ur,I.maxDistance(ne,ve,ne,$,Oe,tt,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,ve,ne,$,Oe,tt,ft,tt)),ur=Math.min(ur,I.maxDistance(ne,ve,ne,$,ft,rr,Oe,rr)),ur=Math.min(ur,I.maxDistance(ne,ve,ne,$,ft,rr,ft,tt))}}])})(),ai=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"maximumDistance",value:function(){return Oo.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(y,_){var P=I.isComposite(this._boundable1),$=I.isComposite(this._boundable2);if(P&&$)return I.area(this._boundable1)>I.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,y,_),null):(this.expand(this._boundable2,this._boundable1,!0,y,_),null);if(P)return this.expand(this._boundable1,this._boundable2,!1,y,_),null;if($)return this.expand(this._boundable2,this._boundable1,!0,y,_),null;throw new U("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(I.isComposite(this._boundable1)||I.isComposite(this._boundable2))}},{key:"compareTo",value:function(y){var _=y;return this._distance<_._distance?-1:this._distance>_._distance?1:0}},{key:"expand",value:function(y,_,P,$,ne){for(var ve=y.getChildBoundables().iterator();ve.hasNext();){var Oe=ve.next(),tt=null;(tt=P?new I(_,Oe,this._itemDistance):new I(Oe,_,this._itemDistance)).getDistance()<ne&&$.add(tt)}}},{key:"getBoundable",value:function(y){return y===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var y=arguments[0],_=arguments[1],P=arguments[2];this._boundable1=y,this._boundable2=_,this._itemDistance=P,this._distance=this.distance()}},{key:"area",value:function(y){return y.getBounds().getArea()}},{key:"isComposite",value:function(y){return y instanceof ii}}])})(),ue=(function(){return o((function I(){i(this,I)}),[{key:"visitItem",value:function(I){}}])})(),We=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"queryInternal",value:function(){if(Tr(arguments[2],ue)&&arguments[0]instanceof Object&&arguments[1]instanceof ii)for(var y=arguments[0],_=arguments[2],P=arguments[1].getChildBoundables(),$=0;$<P.size();$++){var ne=P.get($);this.getIntersectsOp().intersects(ne.getBounds(),y)&&(ne instanceof ii?this.queryInternal(y,ne,_):ne instanceof go?_.visitItem(ne.getItem()):xe.shouldNeverReachHere())}else if(Tr(arguments[2],lr)&&arguments[0]instanceof Object&&arguments[1]instanceof ii)for(var ve=arguments[0],Oe=arguments[2],tt=arguments[1].getChildBoundables(),ft=0;ft<tt.size();ft++){var rr=tt.get(ft);this.getIntersectsOp().intersects(rr.getBounds(),ve)&&(rr instanceof ii?this.queryInternal(ve,rr,Oe):rr instanceof go?Oe.add(rr.getItem()):xe.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(y){return y.get(y.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var y=0,_=arguments[0].getChildBoundables().iterator();_.hasNext();){var P=_.next();P instanceof ii?y+=this.size(P):P instanceof go&&(y+=1)}return y}}},{key:"removeItem",value:function(y,_){for(var P=null,$=y.getChildBoundables().iterator();$.hasNext();){var ne=$.next();ne instanceof go&&ne.getItem()===_&&(P=ne)}return P!==null&&(y.getChildBoundables().remove(P),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var y=this.itemsTree(this._root);return y===null?new ct:y}if(arguments.length===1){for(var _=arguments[0],P=new ct,$=_.getChildBoundables().iterator();$.hasNext();){var ne=$.next();if(ne instanceof ii){var ve=this.itemsTree(ne);ve!==null&&P.add(ve)}else ne instanceof go?P.add(ne.getItem()):xe.shouldNeverReachHere()}return P.size()<=0?null:P}}},{key:"insert",value:function(y,_){xe.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new go(y,_))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var y=arguments[0],_=new ct;return this.boundablesAtLevel(y,this._root,_),_}if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2];if(xe.isTrue(P>-2),$.getLevel()===P)return ne.add($),null;for(var ve=$.getChildBoundables().iterator();ve.hasNext();){var Oe=ve.next();Oe instanceof ii?this.boundablesAtLevel(P,Oe,ne):(xe.isTrue(Oe instanceof go),P===-1&&ne.add(Oe))}return null}}},{key:"query",value:function(){if(arguments.length===1){var y=arguments[0];this.build();var _=new ct;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),y)&&this.queryInternal(y,this._root,_),_}if(arguments.length===2){var P=arguments[0],$=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),P)&&this.queryInternal(P,this._root,$)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),y)&&this.remove(y,this._root,_)}if(arguments.length===3){var P=arguments[0],$=arguments[1],ne=arguments[2],ve=this.removeItem($,ne);if(ve)return!0;for(var Oe=null,tt=$.getChildBoundables().iterator();tt.hasNext();){var ft=tt.next();if(this.getIntersectsOp().intersects(ft.getBounds(),P)&&ft instanceof ii&&(ve=this.remove(P,ft,ne))){Oe=ft;break}}return Oe!==null&&Oe.getChildBoundables().isEmpty()&&$.getChildBoundables().remove(Oe),ve}}},{key:"createHigherLevels",value:function(y,_){xe.isTrue(!y.isEmpty());var P=this.createParentBoundables(y,_+1);return P.size()===1?P.get(0):this.createHigherLevels(P,_+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var y=0,_=arguments[0].getChildBoundables().iterator();_.hasNext();){var P=_.next();if(P instanceof ii){var $=this.depth(P);$>y&&(y=$)}}return y+1}}},{key:"createParentBoundables",value:function(y,_){xe.isTrue(!y.isEmpty());var P=new ct;P.add(this.createNode(_));var $=new ct(y);ri.sort($,this.getComparator());for(var ne=$.iterator();ne.hasNext();){var ve=ne.next();this.lastNode(P).getChildBoundables().size()===this.getNodeCapacity()&&P.add(this.createNode(_)),this.lastNode(P).addChildBoundable(ve)}return P}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new ct,this._nodeCapacity=null,arguments.length===0)I.constructor_.call(this,I.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var y=arguments[0];xe.isTrue(y>1,"Node capacity must be greater than 1"),this._nodeCapacity=y}}},{key:"compareDoubles",value:function(y,_){return y>_?1:y<_?-1:0}}])})();We.IntersectsOp=function(){},We.DEFAULT_NODE_CAPACITY=10;var bt=(function(){return o((function I(){i(this,I)}),[{key:"distance",value:function(I,y){}}])})(),Bt=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"createParentBoundablesFromVerticalSlices",value:function(_,P){xe.isTrue(_.length>0);for(var $=new ct,ne=0;ne<_.length;ne++)$.addAll(this.createParentBoundablesFromVerticalSlice(_[ne],P));return $}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var _=arguments[0],P=arguments[1];return this.nearestNeighbourK(_,Te.POSITIVE_INFINITY,P)}if(arguments.length===3){var $=arguments[0],ne=arguments[2],ve=arguments[1],Oe=new ji;Oe.add($);for(var tt=new ji;!Oe.isEmpty()&&ve>=0;){var ft=Oe.poll(),rr=ft.getDistance();if(rr>=ve)break;ft.isLeaves()?tt.size()<ne?tt.add(ft):(tt.peek().getDistance()>rr&&(tt.poll(),tt.add(ft)),ve=tt.peek().getDistance()):ft.expandToQueue(Oe,ve)}return y.getItems(tt)}}},{key:"createNode",value:function(_){return new sr(_)}},{key:"size",value:function(){return arguments.length===0?E(y,"size",this,1).call(this):E(y,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ke))return E(y,"insert",this,1).apply(this,arguments);var _=arguments[0],P=arguments[1];if(_.isNull())return null;E(y,"insert",this,1).call(this,_,P)}},{key:"getIntersectsOp",value:function(){return y.intersectsOp}},{key:"verticalSlices",value:function(_,P){for(var $=Math.trunc(Math.ceil(_.size()/P)),ne=new Array(P).fill(null),ve=_.iterator(),Oe=0;Oe<P;Oe++){ne[Oe]=new ct;for(var tt=0;ve.hasNext()&&tt<$;){var ft=ve.next();ne[Oe].add(ft),tt++}}return ne}},{key:"query",value:function(){if(arguments.length===1){var _=arguments[0];return E(y,"query",this,1).call(this,_)}if(arguments.length===2){var P=arguments[0],$=arguments[1];E(y,"query",this,1).call(this,P,$)}}},{key:"getComparator",value:function(){return y.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(_,P){return E(y,"createParentBoundables",this,1).call(this,_,P)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ke){var _=arguments[0],P=arguments[1];return E(y,"remove",this,1).call(this,_,P)}return E(y,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?E(y,"depth",this,1).call(this):E(y,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(_,P){xe.isTrue(!_.isEmpty());var $=Math.trunc(Math.ceil(_.size()/this.getNodeCapacity())),ne=new ct(_);ri.sort(ne,y.xComparator);var ve=this.verticalSlices(ne,Math.trunc(Math.ceil(Math.sqrt($))));return this.createParentBoundablesFromVerticalSlices(ve,P)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(Tr(arguments[0],bt)){var _=arguments[0];if(this.isEmpty())return null;var P=new ai(this.getRoot(),this.getRoot(),_);return this.nearestNeighbour(P)}if(arguments[0]instanceof ai){var $=arguments[0],ne=Te.POSITIVE_INFINITY,ve=null,Oe=new ji;for(Oe.add($);!Oe.isEmpty()&&ne>0;){var tt=Oe.poll(),ft=tt.getDistance();if(ft>=ne)break;tt.isLeaves()?(ne=ft,ve=tt):tt.expandToQueue(Oe,ne)}return ve===null?null:[ve.getBoundable(0).getItem(),ve.getBoundable(1).getItem()]}}else{if(arguments.length===2){var rr=arguments[0],ur=arguments[1];if(this.isEmpty()||rr.isEmpty())return null;var qr=new ai(this.getRoot(),rr.getRoot(),ur);return this.nearestNeighbour(qr)}if(arguments.length===3){var bn=arguments[2],Dn=new go(arguments[0],arguments[1]),Xn=new ai(this.getRoot(),Dn,bn);return this.nearestNeighbour(Xn)[0]}if(arguments.length===4){var Fn=arguments[2],En=arguments[3],na=new go(arguments[0],arguments[1]),ca=new ai(this.getRoot(),na,Fn);return this.nearestNeighbourK(ca,En)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var _=arguments[0],P=arguments[1],$=Te.POSITIVE_INFINITY,ne=new ji;for(ne.add(_);!ne.isEmpty();){var ve=ne.poll(),Oe=ve.getDistance();if(Oe>P)return!1;if(ve.maximumDistance()<=P)return!0;if(ve.isLeaves()){if(($=Oe)<=P)return!0}else ve.expandToQueue(ne,$)}return!1}if(arguments.length===3){var tt=arguments[0],ft=arguments[1],rr=arguments[2],ur=new ai(this.getRoot(),tt.getRoot(),ft);return this.isWithinDistance(ur,rr)}}},{key:"interfaces_",get:function(){return[Hs,X]}}],[{key:"constructor_",value:function(){if(arguments.length===0)y.constructor_.call(this,y.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var _=arguments[0];We.constructor_.call(this,_)}}},{key:"centreX",value:function(_){return y.avg(_.getMinX(),_.getMaxX())}},{key:"avg",value:function(_,P){return(_+P)/2}},{key:"getItems",value:function(_){for(var P=new Array(_.size()).fill(null),$=0;!_.isEmpty();){var ne=_.poll();P[$]=ne.getBoundable(0).getItem(),$++}return P}},{key:"centreY",value:function(_){return y.avg(_.getMinY(),_.getMaxY())}}])})(We),sr=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"computeBounds",value:function(){for(var _=null,P=this.getChildBoundables().iterator();P.hasNext();){var $=P.next();_===null?_=new Ke($.getBounds()):_.expandToInclude($.getBounds())}return _}}],[{key:"constructor_",value:function(){var _=arguments[0];ii.constructor_.call(this,_)}}])})(ii);Bt.STRtreeNode=sr,Bt.xComparator=new((function(){return o((function I(){i(this,I)}),[{key:"interfaces_",get:function(){return[Re]}},{key:"compare",value:function(I,y){return We.compareDoubles(Bt.centreX(I.getBounds()),Bt.centreX(y.getBounds()))}}])})()),Bt.yComparator=new((function(){return o((function I(){i(this,I)}),[{key:"interfaces_",get:function(){return[Re]}},{key:"compare",value:function(I,y){return We.compareDoubles(Bt.centreY(I.getBounds()),Bt.centreY(y.getBounds()))}}])})()),Bt.intersectsOp=new((function(){return o((function I(){i(this,I)}),[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(I,y){return I.intersects(y)}}])})()),Bt.DEFAULT_NODE_CAPACITY=10;var Lr=(function(){function I(){i(this,I)}return o(I,null,[{key:"relativeSign",value:function(y,_){return y<_?-1:y>_?1:0}},{key:"compare",value:function(y,_,P){if(_.equals2D(P))return 0;var $=I.relativeSign(_.x,P.x),ne=I.relativeSign(_.y,P.y);switch(y){case 0:return I.compareValue($,ne);case 1:return I.compareValue(ne,$);case 2:return I.compareValue(ne,-$);case 3:return I.compareValue(-$,ne);case 4:return I.compareValue(-$,-ne);case 5:return I.compareValue(-ne,-$);case 6:return I.compareValue(-ne,$);case 7:return I.compareValue($,-ne)}return xe.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(y,_){return y<0?-1:y>0?1:_<0?-1:_>0?1:0}}])})(),Zr=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(I){I.print(this.coord),I.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(I){var y=I;return this.segmentIndex<y.segmentIndex?-1:this.segmentIndex>y.segmentIndex?1:this.coord.equals2D(y.coord)?0:this._isInterior?y._isInterior?Lr.compare(this._segmentOctant,this.coord,y.coord):1:-1}},{key:"isEndPoint",value:function(I){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===I}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var I=arguments[0],y=arguments[1],_=arguments[2],P=arguments[3];this._segString=I,this.coord=new Be(y),this.segmentIndex=_,this._segmentOctant=P,this._isInterior=!y.equals2D(I.getCoordinate(_))}}])})(),Nn=(function(){return o((function I(){i(this,I)}),[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])})(),qn=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getSplitCoordinates",value:function(){var I=new Na;this.addEndpoints();for(var y=this.iterator(),_=y.next();y.hasNext();){var P=y.next();this.addEdgeCoordinates(_,P,I),_=P}return I.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var I=new ct;this.findCollapsesFromInsertedNodes(I),this.findCollapsesFromExistingVertices(I);for(var y=I.iterator();y.hasNext();){var _=y.next().intValue();this.add(this._edge.getCoordinate(_),_)}}},{key:"createSplitEdgePts",value:function(I,y){var _=y.segmentIndex-I.segmentIndex+2;if(_===2)return[new Be(I.coord),new Be(y.coord)];var P=this._edge.getCoordinate(y.segmentIndex),$=y.isInterior()||!y.coord.equals2D(P);$||_--;var ne=new Array(_).fill(null),ve=0;ne[ve++]=new Be(I.coord);for(var Oe=I.segmentIndex+1;Oe<=y.segmentIndex;Oe++)ne[ve++]=this._edge.getCoordinate(Oe);return $&&(ne[ve]=new Be(y.coord)),ne}},{key:"print",value:function(I){I.println("Intersections:");for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"findCollapsesFromExistingVertices",value:function(I){for(var y=0;y<this._edge.size()-2;y++){var _=this._edge.getCoordinate(y);this._edge.getCoordinate(y+1);var P=this._edge.getCoordinate(y+2);_.equals2D(P)&&I.add(at.valueOf(y+1))}}},{key:"addEdgeCoordinates",value:function(I,y,_){var P=this.createSplitEdgePts(I,y);_.add(P,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(I){this.addEndpoints(),this.addCollapsedNodes();for(var y=this.iterator(),_=y.next();y.hasNext();){var P=y.next(),$=this.createSplitEdge(_,P);I.add($),_=P}}},{key:"findCollapseIndex",value:function(I,y,_){if(!I.coord.equals2D(y.coord))return!1;var P=y.segmentIndex-I.segmentIndex;return y.isInterior()||P--,P===1&&(_[0]=I.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(I){for(var y=new Array(1).fill(null),_=this.iterator(),P=_.next();_.hasNext();){var $=_.next();this.findCollapseIndex(P,$,y)&&I.add(at.valueOf(y[0])),P=$}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var I=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(I),I)}},{key:"createSplitEdge",value:function(I,y){var _=this.createSplitEdgePts(I,y);return new Ui(_,this._edge.getData())}},{key:"add",value:function(I,y){var _=new Zr(this._edge,I,y,this._edge.getSegmentOctant(y)),P=this._nodeMap.get(_);return P!==null?(xe.isTrue(P.coord.equals2D(I),"Found equal nodes with different coordinates"),P):(this._nodeMap.put(_,_),_)}},{key:"checkSplitEdgesCorrectness",value:function(I){var y=this._edge.getCoordinates(),_=I.get(0).getCoordinate(0);if(!_.equals2D(y[0]))throw new de("bad split edge start point at "+_);var P=I.get(I.size()-1).getCoordinates(),$=P[P.length-1];if(!$.equals2D(y[y.length-1]))throw new de("bad split edge end point at "+$)}}],[{key:"constructor_",value:function(){this._nodeMap=new Ri,this._edge=null;var I=arguments[0];this._edge=I}}])})(),Un=(function(){function I(){i(this,I)}return o(I,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var y=arguments[0],_=arguments[1];if(y===0&&_===0)throw new U("Cannot compute the octant for point ( "+y+", "+_+" )");var P=Math.abs(y),$=Math.abs(_);return y>=0?_>=0?P>=$?0:1:P>=$?7:6:_>=0?P>=$?3:2:P>=$?4:5}if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var ne=arguments[0],ve=arguments[1],Oe=ve.x-ne.x,tt=ve.y-ne.y;if(Oe===0&&tt===0)throw new U("Cannot compute the octant for two identical points "+ne);return I.octant(Oe,tt)}}}])})(),ui=(function(){return o((function I(){i(this,I)}),[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(I){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(I){}},{key:"getData",value:function(){}}])})(),Hn=(function(){return o((function I(){i(this,I)}),[{key:"addIntersection",value:function(I,y){}},{key:"interfaces_",get:function(){return[ui]}}])})(),Ui=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(y){return this._pts[y]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(y){return y===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(y),this.getCoordinate(y+1))}},{key:"setData",value:function(y){this._data=y}},{key:"safeOctant",value:function(y,_){return y.equals2D(_)?0:Un.octant(y,_)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var y=arguments[0],_=arguments[1];this.addIntersectionNode(y,_)}else if(arguments.length===4){var P=arguments[1],$=arguments[3],ne=new Be(arguments[0].getIntersection($));this.addIntersection(ne,P)}}},{key:"toString",value:function(){return tn.toLineString(new Ya(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(y,_){var P=_,$=P+1;if($<this._pts.length){var ne=this._pts[$];y.equals2D(ne)&&(P=$)}return this._nodeList.add(y,P)}},{key:"addIntersections",value:function(y,_,P){for(var $=0;$<y.getIntersectionNum();$++)this.addIntersection(y,_,P,$)}},{key:"interfaces_",get:function(){return[Hn]}}],[{key:"constructor_",value:function(){this._nodeList=new qn(this),this._pts=null,this._data=null;var y=arguments[0],_=arguments[1];this._pts=y,this._data=_}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var y=arguments[0],_=new ct;return I.getNodedSubstrings(y,_),_}if(arguments.length===2)for(var P=arguments[1],$=arguments[0].iterator();$.hasNext();)$.next().getNodeList().addSplitEdges(P)}}])})(),Xi=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof I){var y=arguments[0],_=Ge.index(this.p0,this.p1,y.p0),P=Ge.index(this.p0,this.p1,y.p1);return _>=0&&P>=0||_<=0&&P<=0?Math.max(_,P):0}if(arguments[0]instanceof Be){var $=arguments[0];return Ge.index(this.p0,this.p1,$)}}},{key:"toGeometry",value:function(y){return y.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(y){if(!(y instanceof I))return!1;var _=y;return this.p0.equals(_.p0)&&this.p1.equals(_.p1)}},{key:"intersection",value:function(y){var _=new an;return _.computeIntersection(this.p0,this.p1,y.p0,y.p1),_.hasIntersection()?_.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof Be){var y=arguments[0];if(y.equals(this.p0)||y.equals(this.p1))return new Be(y);var _=this.projectionFactor(y),P=new Be;return P.x=this.p0.x+_*(this.p1.x-this.p0.x),P.y=this.p0.y+_*(this.p1.y-this.p0.y),P}if(arguments[0]instanceof I){var $=arguments[0],ne=this.projectionFactor($.p0),ve=this.projectionFactor($.p1);if(ne>=1&&ve>=1||ne<=0&&ve<=0)return null;var Oe=this.project($.p0);ne<0&&(Oe=this.p0),ne>1&&(Oe=this.p1);var tt=this.project($.p1);return ve<0&&(tt=this.p0),ve>1&&(tt=this.p1),new I(Oe,tt)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(y){return y===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(y){return cn.pointToLinePerpendicular(y,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return I.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(y){if(y.equals(this.p0))return 0;if(y.equals(this.p1))return 1;var _=this.p1.x-this.p0.x,P=this.p1.y-this.p0.y,$=_*_+P*P;return $<=0?Te.NaN:((y.x-this.p0.x)*_+(y.y-this.p0.y)*P)/$}},{key:"closestPoints",value:function(y){var _=this.intersection(y);if(_!==null)return[_,_];var P=new Array(2).fill(null),$=Te.MAX_VALUE,ne=null,ve=this.closestPoint(y.p0);$=ve.distance(y.p0),P[0]=ve,P[1]=y.p0;var Oe=this.closestPoint(y.p1);(ne=Oe.distance(y.p1))<$&&($=ne,P[0]=Oe,P[1]=y.p1);var tt=y.closestPoint(this.p0);(ne=tt.distance(this.p0))<$&&($=ne,P[0]=this.p0,P[1]=tt);var ft=y.closestPoint(this.p1);return(ne=ft.distance(this.p1))<$&&($=ne,P[0]=this.p1,P[1]=ft),P}},{key:"closestPoint",value:function(y){var _=this.projectionFactor(y);return _>0&&_<1?this.project(y):this.p0.distance(y)<this.p1.distance(y)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(y){var _=y,P=this.p0.compareTo(_.p0);return P!==0?P:this.p1.compareTo(_.p1)}},{key:"reverse",value:function(){var y=this.p0;this.p0=this.p1,this.p1=y}},{key:"equalsTopo",value:function(y){return this.p0.equals(y.p0)&&this.p1.equals(y.p1)||this.p0.equals(y.p1)&&this.p1.equals(y.p0)}},{key:"lineIntersection",value:function(y){return Ir.intersection(this.p0,this.p1,y.p0,y.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(y,_){var P=this.p0.x+y*(this.p1.x-this.p0.x),$=this.p0.y+y*(this.p1.y-this.p0.y),ne=this.p1.x-this.p0.x,ve=this.p1.y-this.p0.y,Oe=Math.sqrt(ne*ne+ve*ve),tt=0,ft=0;if(_!==0){if(Oe<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");tt=_*ne/Oe,ft=_*ve/Oe}return new Be(P-ft,$+tt)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var y=arguments[0];this.setCoordinates(y.p0,y.p1)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.p0.x=_.x,this.p0.y=_.y,this.p1.x=P.x,this.p1.y=P.y}}},{key:"segmentFraction",value:function(y){var _=this.projectionFactor(y);return _<0?_=0:(_>1||Te.isNaN(_))&&(_=1),_}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(y){var _=this.p1.getY()-this.p0.getY(),P=this.p0.getX()-this.p1.getX(),$=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),ne=_*_+P*P,ve=_*_-P*P,Oe=y.getX(),tt=y.getY();return new Be((-ve*Oe-2*_*P*tt-2*_*$)/ne,(ve*tt-2*_*P*Oe-2*P*$)/ne)}},{key:"distance",value:function(){if(arguments[0]instanceof I){var y=arguments[0];return cn.segmentToSegment(this.p0,this.p1,y.p0,y.p1)}if(arguments[0]instanceof Be){var _=arguments[0];return cn.pointToSegment(_,this.p0,this.p1)}}},{key:"pointAlong",value:function(y){var _=new Be;return _.x=this.p0.x+y*(this.p1.x-this.p0.x),_.y=this.p0.y+y*(this.p1.y-this.p0.y),_}},{key:"hashCode",value:function(){var y=Te.doubleToLongBits(this.p0.x);y^=31*Te.doubleToLongBits(this.p0.y);var _=Math.trunc(y)^Math.trunc(y>>32),P=Te.doubleToLongBits(this.p1.x);return P^=31*Te.doubleToLongBits(this.p1.y),_^(Math.trunc(P)^Math.trunc(P>>32))}},{key:"interfaces_",get:function(){return[H,X]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)I.constructor_.call(this,new Be,new Be);else if(arguments.length===1){var y=arguments[0];I.constructor_.call(this,y.p0,y.p1)}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this.p0=_,this.p1=P}else if(arguments.length===4){var $=arguments[0],ne=arguments[1],ve=arguments[2],Oe=arguments[3];I.constructor_.call(this,new Be($,ne),new Be(ve,Oe))}}},{key:"midPoint",value:function(y,_){return new Be((y.x+_.x)/2,(y.y+_.y)/2)}}])})(),ra=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var I=arguments[1],y=arguments[2],_=arguments[3];arguments[0].getLineSegment(I,this._overlapSeg1),y.getLineSegment(_,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new Xi,this._overlapSeg2=new Xi}}])})(),Si=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getLineSegment",value:function(I,y){y.p0=this._pts[I],y.p1=this._pts[I+1]}},{key:"computeSelect",value:function(I,y,_,P){var $=this._pts[y],ne=this._pts[_];if(_-y==1)return P.select(this,y),null;if(!I.intersects($,ne))return null;var ve=Math.trunc((y+_)/2);y<ve&&this.computeSelect(I,y,ve,P),ve<_&&this.computeSelect(I,ve,_,P)}},{key:"getCoordinates",value:function(){for(var I=new Array(this._end-this._start+1).fill(null),y=0,_=this._start;_<=this._end;_++)I[y++]=this._pts[_];return I}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var I=arguments[0],y=arguments[1];this.computeOverlaps(this._start,this._end,I,I._start,I._end,y)}else if(arguments.length===6){var _=arguments[0],P=arguments[1],$=arguments[2],ne=arguments[3],ve=arguments[4],Oe=arguments[5];if(P-_==1&&ve-ne==1)return Oe.overlap(this,_,$,ne),null;if(!this.overlaps(_,P,$,ne,ve))return null;var tt=Math.trunc((_+P)/2),ft=Math.trunc((ne+ve)/2);_<tt&&(ne<ft&&this.computeOverlaps(_,tt,$,ne,ft,Oe),ft<ve&&this.computeOverlaps(_,tt,$,ft,ve,Oe)),tt<P&&(ne<ft&&this.computeOverlaps(tt,P,$,ne,ft,Oe),ft<ve&&this.computeOverlaps(tt,P,$,ft,ve,Oe))}}},{key:"setId",value:function(I){this._id=I}},{key:"select",value:function(I,y){this.computeSelect(I,this._start,this._end,y)}},{key:"getEnvelope",value:function(){if(this._env===null){var I=this._pts[this._start],y=this._pts[this._end];this._env=new Ke(I,y)}return this._env}},{key:"overlaps",value:function(I,y,_,P,$){return Ke.intersects(this._pts[I],this._pts[y],_._pts[P],_._pts[$])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var I=arguments[0],y=arguments[1],_=arguments[2],P=arguments[3];this._pts=I,this._start=y,this._end=_,this._context=P}}])})(),Ia=(function(){function I(){i(this,I)}return o(I,null,[{key:"findChainEnd",value:function(y,_){for(var P=_;P<y.length-1&&y[P].equals2D(y[P+1]);)P++;if(P>=y.length-1)return y.length-1;for(var $=oa.quadrant(y[P],y[P+1]),ne=_+1;ne<y.length&&!(!y[ne-1].equals2D(y[ne])&&oa.quadrant(y[ne-1],y[ne])!==$);)ne++;return ne-1}},{key:"getChains",value:function(){if(arguments.length===1){var y=arguments[0];return I.getChains(y,null)}if(arguments.length===2){var _=arguments[0],P=arguments[1],$=new ct,ne=0;do{var ve=I.findChainEnd(_,ne),Oe=new Si(_,ne,ve,P);$.add(Oe),ne=ve}while(ne<_.length-1);return $}}}])})(),za=(function(){return o((function I(){i(this,I)}),[{key:"computeNodes",value:function(I){}},{key:"getNodedSubstrings",value:function(){}}])})(),Gs=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"setSegmentIntersector",value:function(I){this._segInt=I}},{key:"interfaces_",get:function(){return[za]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var I=arguments[0];this.setSegmentIntersector(I)}}}}])})(),ul=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return Ui.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(_){for(var P=Ia.getChains(_.getCoordinates(),_).iterator();P.hasNext();){var $=P.next();$.setId(this._idCounter++),this._index.insert($.getEnvelope(),$),this._monoChains.add($)}}},{key:"computeNodes",value:function(_){this._nodedSegStrings=_;for(var P=_.iterator();P.hasNext();)this.add(P.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var _=new Ws(this._segInt),P=this._monoChains.iterator();P.hasNext();)for(var $=P.next(),ne=this._index.query($.getEnvelope()).iterator();ne.hasNext();){var ve=ne.next();if(ve.getId()>$.getId()&&($.computeOverlaps(ve,_),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new ct,this._index=new Bt,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var _=arguments[0];Gs.constructor_.call(this,_)}}}}])})(Gs),Ws=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"overlap",value:function(){if(arguments.length!==4)return E(y,"overlap",this,1).apply(this,arguments);var _=arguments[1],P=arguments[2],$=arguments[3],ne=arguments[0].getContext(),ve=P.getContext();this._si.processIntersections(ne,_,ve,$)}}],[{key:"constructor_",value:function(){this._si=null;var _=arguments[0];this._si=_}}])})(ra);ul.SegmentOverlapAction=Ws;var $o=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isDeletable",value:function(y,_,P,$){var ne=this._inputLine[y],ve=this._inputLine[_],Oe=this._inputLine[P];return!!this.isConcave(ne,ve,Oe)&&!!this.isShallow(ne,ve,Oe,$)&&this.isShallowSampled(ne,ve,y,P,$)}},{key:"deleteShallowConcavities",value:function(){for(var y=1,_=this.findNextNonDeletedIndex(y),P=this.findNextNonDeletedIndex(_),$=!1;P<this._inputLine.length;){var ne=!1;this.isDeletable(y,_,P,this._distanceTol)&&(this._isDeleted[_]=I.DELETE,ne=!0,$=!0),y=ne?P:_,_=this.findNextNonDeletedIndex(y),P=this.findNextNonDeletedIndex(_)}return $}},{key:"isShallowConcavity",value:function(y,_,P,$){return Ge.index(y,_,P)===this._angleOrientation&&cn.pointToSegment(_,y,P)<$}},{key:"isShallowSampled",value:function(y,_,P,$,ne){var ve=Math.trunc(($-P)/I.NUM_PTS_TO_CHECK);ve<=0&&(ve=1);for(var Oe=P;Oe<$;Oe+=ve)if(!this.isShallow(y,_,this._inputLine[Oe],ne))return!1;return!0}},{key:"isConcave",value:function(y,_,P){var $=Ge.index(y,_,P)===this._angleOrientation;return $}},{key:"simplify",value:function(y){this._distanceTol=Math.abs(y),y<0&&(this._angleOrientation=Ge.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var _=!1;do _=this.deleteShallowConcavities();while(_);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(y){for(var _=y+1;_<this._inputLine.length&&this._isDeleted[_]===I.DELETE;)_++;return _}},{key:"isShallow",value:function(y,_,P,$){return cn.pointToSegment(_,y,P)<$}},{key:"collapseLine",value:function(){for(var y=new Na,_=0;_<this._inputLine.length;_++)this._isDeleted[_]!==I.DELETE&&y.add(this._inputLine[_]);return y.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Ge.COUNTERCLOCKWISE;var y=arguments[0];this._inputLine=y}},{key:"simplify",value:function(y,_){return new I(y).simplify(_)}}])})();$o.INIT=0,$o.DELETE=1,$o.KEEP=1,$o.NUM_PTS_TO_CHECK=10;var Xs=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getCoordinates",value:function(){return this._ptList.toArray(I.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(y){this._precisionModel=y}},{key:"addPt",value:function(y){var _=new Be(y);if(this._precisionModel.makePrecise(_),this.isRedundant(_))return null;this._ptList.add(_)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(y,_){if(_)for(var P=0;P<y.length;P++)this.addPt(y[P]);else for(var $=y.length-1;$>=0;$--)this.addPt(y[$])}},{key:"isRedundant",value:function(y){if(this._ptList.size()<1)return!1;var _=this._ptList.get(this._ptList.size()-1);return y.distance(_)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Aa().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var y=new Be(this._ptList.get(0)),_=this._ptList.get(this._ptList.size()-1);if(y.equals(_))return null;this._ptList.add(y)}},{key:"setMinimumVertexDistance",value:function(y){this._minimimVertexDistance=y}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new ct}}])})();Xs.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var Pa=(function(){function I(){i(this,I)}return o(I,null,[{key:"toDegrees",value:function(y){return 180*y/Math.PI}},{key:"normalize",value:function(y){for(;y>Math.PI;)y-=I.PI_TIMES_2;for(;y<=-Math.PI;)y+=I.PI_TIMES_2;return y}},{key:"angle",value:function(){if(arguments.length===1){var y=arguments[0];return Math.atan2(y.y,y.x)}if(arguments.length===2){var _=arguments[0],P=arguments[1],$=P.x-_.x,ne=P.y-_.y;return Math.atan2(ne,$)}}},{key:"isAcute",value:function(y,_,P){var $=y.x-_.x,ne=y.y-_.y;return $*(P.x-_.x)+ne*(P.y-_.y)>0}},{key:"isObtuse",value:function(y,_,P){var $=y.x-_.x,ne=y.y-_.y;return $*(P.x-_.x)+ne*(P.y-_.y)<0}},{key:"interiorAngle",value:function(y,_,P){var $=I.angle(_,y),ne=I.angle(_,P);return Math.abs(ne-$)}},{key:"normalizePositive",value:function(y){if(y<0){for(;y<0;)y+=I.PI_TIMES_2;y>=I.PI_TIMES_2&&(y=0)}else{for(;y>=I.PI_TIMES_2;)y-=I.PI_TIMES_2;y<0&&(y=0)}return y}},{key:"angleBetween",value:function(y,_,P){var $=I.angle(_,y),ne=I.angle(_,P);return I.diff($,ne)}},{key:"diff",value:function(y,_){var P=null;return(P=y<_?_-y:y-_)>Math.PI&&(P=2*Math.PI-P),P}},{key:"toRadians",value:function(y){return y*Math.PI/180}},{key:"getTurn",value:function(y,_){var P=Math.sin(_-y);return P>0?I.COUNTERCLOCKWISE:P<0?I.CLOCKWISE:I.NONE}},{key:"angleBetweenOriented",value:function(y,_,P){var $=I.angle(_,y),ne=I.angle(_,P)-$;return ne<=-Math.PI?ne+I.PI_TIMES_2:ne>Math.PI?ne-I.PI_TIMES_2:ne}}])})();Pa.PI_TIMES_2=2*Math.PI,Pa.PI_OVER_2=Math.PI/2,Pa.PI_OVER_4=Math.PI/4,Pa.COUNTERCLOCKWISE=Ge.COUNTERCLOCKWISE,Pa.CLOCKWISE=Ge.CLOCKWISE,Pa.NONE=Ge.COLLINEAR;var Ys=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"addNextSegment",value:function(y,_){if(this._s0=this._s1,this._s1=this._s2,this._s2=y,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var P=Ge.index(this._s0,this._s1,this._s2),$=P===Ge.CLOCKWISE&&this._side===_t.LEFT||P===Ge.COUNTERCLOCKWISE&&this._side===_t.RIGHT;P===0?this.addCollinear(_):$?this.addOutsideTurn(P,_):this.addInsideTurn(P,_)}},{key:"addLineEndCap",value:function(y,_){var P=new Xi(y,_),$=new Xi;this.computeOffsetSegment(P,_t.LEFT,this._distance,$);var ne=new Xi;this.computeOffsetSegment(P,_t.RIGHT,this._distance,ne);var ve=_.x-y.x,Oe=_.y-y.y,tt=Math.atan2(Oe,ve);switch(this._bufParams.getEndCapStyle()){case N.CAP_ROUND:this._segList.addPt($.p1),this.addDirectedFillet(_,tt+Math.PI/2,tt-Math.PI/2,Ge.CLOCKWISE,this._distance),this._segList.addPt(ne.p1);break;case N.CAP_FLAT:this._segList.addPt($.p1),this._segList.addPt(ne.p1);break;case N.CAP_SQUARE:var ft=new Be;ft.x=Math.abs(this._distance)*Math.cos(tt),ft.y=Math.abs(this._distance)*Math.sin(tt);var rr=new Be($.p1.x+ft.x,$.p1.y+ft.y),ur=new Be(ne.p1.x+ft.x,ne.p1.y+ft.y);this._segList.addPt(rr),this._segList.addPt(ur)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(y,_,P,$){var ne=Ir.intersection(_.p0,_.p1,P.p0,P.p1);if(ne!==null&&($<=0?1:ne.distance(y)/Math.abs($))<=this._bufParams.getMitreLimit())return this._segList.addPt(ne),null;this.addLimitedMitreJoin(_,P,$,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(y,_){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*I.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===N.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===N.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(_&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,y,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(y){this._segList.addPt(new Be(y.x+this._distance,y.y+this._distance)),this._segList.addPt(new Be(y.x+this._distance,y.y-this._distance)),this._segList.addPt(new Be(y.x-this._distance,y.y-this._distance)),this._segList.addPt(new Be(y.x-this._distance,y.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(y,_){this._segList.addPts(y,_)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(y,_,P,$,ne){var ve=_.x-y.x,Oe=_.y-y.y,tt=Math.atan2(Oe,ve),ft=P.x-y.x,rr=P.y-y.y,ur=Math.atan2(rr,ft);$===Ge.CLOCKWISE?tt<=ur&&(tt+=2*Math.PI):tt>=ur&&(tt-=2*Math.PI),this._segList.addPt(_),this.addDirectedFillet(y,tt,ur,$,ne),this._segList.addPt(P)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(y,_,P){this._s1=y,this._s2=_,this._side=P,this._seg1.setCoordinates(y,_),this.computeOffsetSegment(this._seg1,P,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(y,_,P,$){var ne=this._seg0.p1,ve=Pa.angle(ne,this._seg0.p0),Oe=Pa.angleBetweenOriented(this._seg0.p0,ne,this._seg1.p1)/2,tt=Pa.normalize(ve+Oe),ft=Pa.normalize(tt+Math.PI),rr=$*P,ur=P-rr*Math.abs(Math.sin(Oe)),qr=ne.x+rr*Math.cos(ft),bn=ne.y+rr*Math.sin(ft),Dn=new Be(qr,bn),Xn=new Xi(ne,Dn),Fn=Xn.pointAlongOffset(1,ur),En=Xn.pointAlongOffset(1,-ur);this._side===_t.LEFT?(this._segList.addPt(Fn),this._segList.addPt(En)):(this._segList.addPt(En),this._segList.addPt(Fn))}},{key:"addDirectedFillet",value:function(y,_,P,$,ne){var ve=$===Ge.CLOCKWISE?-1:1,Oe=Math.abs(_-P),tt=Math.trunc(Oe/this._filletAngleQuantum+.5);if(tt<1)return null;for(var ft=Oe/tt,rr=new Be,ur=0;ur<tt;ur++){var qr=_+ve*ur*ft;rr.x=y.x+ne*Math.cos(qr),rr.y=y.y+ne*Math.sin(qr),this._segList.addPt(rr)}}},{key:"computeOffsetSegment",value:function(y,_,P,$){var ne=_===_t.LEFT?1:-1,ve=y.p1.x-y.p0.x,Oe=y.p1.y-y.p0.y,tt=Math.sqrt(ve*ve+Oe*Oe),ft=ne*P*ve/tt,rr=ne*P*Oe/tt;$.p0.x=y.p0.x-rr,$.p0.y=y.p0.y+ft,$.p1.x=y.p1.x-rr,$.p1.y=y.p1.y+ft}},{key:"addInsideTurn",value:function(y,_){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*I.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var P=new Be((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(P);var $=new Be((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt($)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(y){var _=new Be(y.x+this._distance,y.y);this._segList.addPt(_),this.addDirectedFillet(y,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(y,_){this._segList.addPt(y.p1),this._segList.addPt(_.p0)}},{key:"init",value:function(y){this._distance=y,this._maxCurveSegmentError=y*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Xs,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(y*I.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(y){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===N.JOIN_BEVEL||this._bufParams.getJoinStyle()===N.JOIN_MITRE?(y&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,Ge.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Xi,this._seg1=new Xi,this._offset0=new Xi,this._offset1=new Xi,this._side=0,this._hasNarrowConcaveAngle=!1;var y=arguments[0],_=arguments[1],P=arguments[2];this._precisionModel=y,this._bufParams=_,this._li=new an,this._filletAngleQuantum=Math.PI/2/_.getQuadrantSegments(),_.getQuadrantSegments()>=8&&_.getJoinStyle()===N.JOIN_ROUND&&(this._closingSegLengthFactor=I.MAX_CLOSING_SEG_LEN_FACTOR),this.init(P)}}])})();Ys.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Ys.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Ys.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Ys.MAX_CLOSING_SEG_LEN_FACTOR=80;var Il=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getOffsetCurve",value:function(y,_){if(this._distance=_,_===0)return null;var P=_<0,$=Math.abs(_),ne=this.getSegGen($);y.length<=1?this.computePointCurve(y[0],ne):this.computeOffsetCurve(y,P,ne);var ve=ne.getCoordinates();return P&&Wi.reverse(ve),ve}},{key:"computeSingleSidedBufferCurve",value:function(y,_,P){var $=this.simplifyTolerance(this._distance);if(_){P.addSegments(y,!0);var ne=$o.simplify(y,-$),ve=ne.length-1;P.initSideSegments(ne[ve],ne[ve-1],_t.LEFT),P.addFirstSegment();for(var Oe=ve-2;Oe>=0;Oe--)P.addNextSegment(ne[Oe],!0)}else{P.addSegments(y,!1);var tt=$o.simplify(y,$),ft=tt.length-1;P.initSideSegments(tt[0],tt[1],_t.LEFT),P.addFirstSegment();for(var rr=2;rr<=ft;rr++)P.addNextSegment(tt[rr],!0)}P.addLastSegment(),P.closeRing()}},{key:"computeRingBufferCurve",value:function(y,_,P){var $=this.simplifyTolerance(this._distance);_===_t.RIGHT&&($=-$);var ne=$o.simplify(y,$),ve=ne.length-1;P.initSideSegments(ne[ve-1],ne[0],_);for(var Oe=1;Oe<=ve;Oe++){var tt=Oe!==1;P.addNextSegment(ne[Oe],tt)}P.closeRing()}},{key:"computeLineBufferCurve",value:function(y,_){var P=this.simplifyTolerance(this._distance),$=$o.simplify(y,P),ne=$.length-1;_.initSideSegments($[0],$[1],_t.LEFT);for(var ve=2;ve<=ne;ve++)_.addNextSegment($[ve],!0);_.addLastSegment(),_.addLineEndCap($[ne-1],$[ne]);var Oe=$o.simplify(y,-P),tt=Oe.length-1;_.initSideSegments(Oe[tt],Oe[tt-1],_t.LEFT);for(var ft=tt-2;ft>=0;ft--)_.addNextSegment(Oe[ft],!0);_.addLastSegment(),_.addLineEndCap(Oe[1],Oe[0]),_.closeRing()}},{key:"computePointCurve",value:function(y,_){switch(this._bufParams.getEndCapStyle()){case N.CAP_ROUND:_.createCircle(y);break;case N.CAP_SQUARE:_.createSquare(y)}}},{key:"getLineCurve",value:function(y,_){if(this._distance=_,this.isLineOffsetEmpty(_))return null;var P=Math.abs(_),$=this.getSegGen(P);if(y.length<=1)this.computePointCurve(y[0],$);else if(this._bufParams.isSingleSided()){var ne=_<0;this.computeSingleSidedBufferCurve(y,ne,$)}else this.computeLineBufferCurve(y,$);return $.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(y){return y*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(y,_,P){if(this._distance=P,y.length<=2)return this.getLineCurve(y,P);if(P===0)return I.copyCoordinates(y);var $=this.getSegGen(P);return this.computeRingBufferCurve(y,_,$),$.getCoordinates()}},{key:"computeOffsetCurve",value:function(y,_,P){var $=this.simplifyTolerance(this._distance);if(_){var ne=$o.simplify(y,-$),ve=ne.length-1;P.initSideSegments(ne[ve],ne[ve-1],_t.LEFT),P.addFirstSegment();for(var Oe=ve-2;Oe>=0;Oe--)P.addNextSegment(ne[Oe],!0)}else{var tt=$o.simplify(y,$),ft=tt.length-1;P.initSideSegments(tt[0],tt[1],_t.LEFT),P.addFirstSegment();for(var rr=2;rr<=ft;rr++)P.addNextSegment(tt[rr],!0)}P.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(y){return y===0||y<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(y){return new Ys(this._precisionModel,this._bufParams,y)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var y=arguments[0],_=arguments[1];this._precisionModel=y,this._bufParams=_}},{key:"copyCoordinates",value:function(y){for(var _=new Array(y.length).fill(null),P=0;P<_.length;P++)_[P]=new Be(y[P]);return _}}])})(),ms=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var I=arguments[0],y=new ct,_=this._subgraphs.iterator();_.hasNext();){var P=_.next(),$=P.getEnvelope();I.y<$.getMinY()||I.y>$.getMaxY()||this.findStabbedSegments(I,P.getDirectedEdges(),y)}return y}if(arguments.length===3){if(Tr(arguments[2],lr)&&arguments[0]instanceof Be&&arguments[1]instanceof Ka){for(var ne=arguments[0],ve=arguments[1],Oe=arguments[2],tt=ve.getEdge().getCoordinates(),ft=0;ft<tt.length-1;ft++)if(this._seg.p0=tt[ft],this._seg.p1=tt[ft+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<ne.x||this._seg.isHorizontal()||ne.y<this._seg.p0.y||ne.y>this._seg.p1.y||Ge.index(this._seg.p0,this._seg.p1,ne)===Ge.RIGHT)){var rr=ve.getDepth(_t.LEFT);this._seg.p0.equals(tt[ft])||(rr=ve.getDepth(_t.RIGHT));var ur=new Di(this._seg,rr);Oe.add(ur)}}else if(Tr(arguments[2],lr)&&arguments[0]instanceof Be&&Tr(arguments[1],lr))for(var qr=arguments[0],bn=arguments[2],Dn=arguments[1].iterator();Dn.hasNext();){var Xn=Dn.next();Xn.isForward()&&this.findStabbedSegments(qr,Xn,bn)}}}},{key:"getDepth",value:function(I){var y=this.findStabbedSegments(I);return y.size()===0?0:ri.min(y)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new Xi;var I=arguments[0];this._subgraphs=I}}])})(),Di=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"compareTo",value:function(I){var y=I;if(this._upwardSeg.minX()>=y._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=y._upwardSeg.minX())return-1;var _=this._upwardSeg.orientationIndex(y._upwardSeg);return _!==0||(_=-1*y._upwardSeg.orientationIndex(this._upwardSeg))!==0?_:this._upwardSeg.compareTo(y._upwardSeg)}},{key:"compareX",value:function(I,y){var _=I.p0.compareTo(y.p0);return _!==0?_:I.p1.compareTo(y.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var I=arguments[0],y=arguments[1];this._upwardSeg=new Xi(I),this._leftDepth=y}}])})();ms.DepthSegment=Di;var qo=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,null,[{key:"constructor_",value:function(){O.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])})(O),Da=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getY",value:function(){var y=this.y/this.w;if(Te.isNaN(y)||Te.isInfinite(y))throw new qo;return y}},{key:"getX",value:function(){var y=this.x/this.w;if(Te.isNaN(y)||Te.isInfinite(y))throw new qo;return y}},{key:"getCoordinate",value:function(){var y=new Be;return y.x=this.getX(),y.y=this.getY(),y}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var y=arguments[0];this.x=y.x,this.y=y.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var _=arguments[0],P=arguments[1];this.x=_,this.y=P,this.w=1}else if(arguments[0]instanceof I&&arguments[1]instanceof I){var $=arguments[0],ne=arguments[1];this.x=$.y*ne.w-ne.y*$.w,this.y=ne.x*$.w-$.x*ne.w,this.w=$.x*ne.y-ne.x*$.y}else if(arguments[0]instanceof Be&&arguments[1]instanceof Be){var ve=arguments[0],Oe=arguments[1];this.x=ve.y-Oe.y,this.y=Oe.x-ve.x,this.w=ve.x*Oe.y-Oe.x*ve.y}}else if(arguments.length===3){var tt=arguments[0],ft=arguments[1],rr=arguments[2];this.x=tt,this.y=ft,this.w=rr}else if(arguments.length===4){var ur=arguments[0],qr=arguments[1],bn=arguments[2],Dn=arguments[3],Xn=ur.y-qr.y,Fn=qr.x-ur.x,En=ur.x*qr.y-qr.x*ur.y,na=bn.y-Dn.y,ca=Dn.x-bn.x,lo=bn.x*Dn.y-Dn.x*bn.y;this.x=Fn*lo-ca*En,this.y=na*En-Xn*lo,this.w=Xn*ca-na*Fn}}}])})(),is=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"area",value:function(){return I.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return I.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(y){if(y===null)throw new U("Supplied point is null.");return I.interpolateZ(y,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return I.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return I.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return I.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return I.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return I.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return I.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var y=arguments[0],_=arguments[1],P=arguments[2];this.p0=y,this.p1=_,this.p2=P}},{key:"area",value:function(y,_,P){return Math.abs(((P.x-y.x)*(_.y-y.y)-(_.x-y.x)*(P.y-y.y))/2)}},{key:"signedArea",value:function(y,_,P){return((P.x-y.x)*(_.y-y.y)-(_.x-y.x)*(P.y-y.y))/2}},{key:"det",value:function(y,_,P,$){return y*$-_*P}},{key:"interpolateZ",value:function(y,_,P,$){var ne=_.x,ve=_.y,Oe=P.x-ne,tt=$.x-ne,ft=P.y-ve,rr=$.y-ve,ur=Oe*rr-tt*ft,qr=y.x-ne,bn=y.y-ve,Dn=(rr*qr-tt*bn)/ur,Xn=(-ft*qr+Oe*bn)/ur;return _.getZ()+Dn*(P.getZ()-_.getZ())+Xn*($.getZ()-_.getZ())}},{key:"longestSideLength",value:function(y,_,P){var $=y.distance(_),ne=_.distance(P),ve=P.distance(y),Oe=$;return ne>Oe&&(Oe=ne),ve>Oe&&(Oe=ve),Oe}},{key:"circumcentreDD",value:function(y,_,P){var $=be.valueOf(y.x).subtract(P.x),ne=be.valueOf(y.y).subtract(P.y),ve=be.valueOf(_.x).subtract(P.x),Oe=be.valueOf(_.y).subtract(P.y),tt=be.determinant($,ne,ve,Oe).multiply(2),ft=$.sqr().add(ne.sqr()),rr=ve.sqr().add(Oe.sqr()),ur=be.determinant(ne,ft,Oe,rr),qr=be.determinant($,ft,ve,rr),bn=be.valueOf(P.x).subtract(ur.divide(tt)).doubleValue(),Dn=be.valueOf(P.y).add(qr.divide(tt)).doubleValue();return new Be(bn,Dn)}},{key:"isAcute",value:function(y,_,P){return!!Pa.isAcute(y,_,P)&&!!Pa.isAcute(_,P,y)&&!!Pa.isAcute(P,y,_)}},{key:"circumcentre",value:function(y,_,P){var $=P.x,ne=P.y,ve=y.x-$,Oe=y.y-ne,tt=_.x-$,ft=_.y-ne,rr=2*I.det(ve,Oe,tt,ft),ur=I.det(Oe,ve*ve+Oe*Oe,ft,tt*tt+ft*ft),qr=I.det(ve,ve*ve+Oe*Oe,tt,tt*tt+ft*ft);return new Be($-ur/rr,ne+qr/rr)}},{key:"perpendicularBisector",value:function(y,_){var P=_.x-y.x,$=_.y-y.y,ne=new Da(y.x+P/2,y.y+$/2,1),ve=new Da(y.x-$+P/2,y.y+P+$/2,1);return new Da(ne,ve)}},{key:"angleBisector",value:function(y,_,P){var $=_.distance(y),ne=$/($+_.distance(P)),ve=P.x-y.x,Oe=P.y-y.y;return new Be(y.x+ne*ve,y.y+ne*Oe)}},{key:"area3D",value:function(y,_,P){var $=_.x-y.x,ne=_.y-y.y,ve=_.getZ()-y.getZ(),Oe=P.x-y.x,tt=P.y-y.y,ft=P.getZ()-y.getZ(),rr=ne*ft-ve*tt,ur=ve*Oe-$*ft,qr=$*tt-ne*Oe,bn=rr*rr+ur*ur+qr*qr,Dn=Math.sqrt(bn)/2;return Dn}},{key:"centroid",value:function(y,_,P){var $=(y.x+_.x+P.x)/3,ne=(y.y+_.y+P.y)/3;return new Be($,ne)}},{key:"inCentre",value:function(y,_,P){var $=_.distance(P),ne=y.distance(P),ve=y.distance(_),Oe=$+ne+ve,tt=($*y.x+ne*_.x+ve*P.x)/Oe,ft=($*y.y+ne*_.y+ve*P.y)/Oe;return new Be(tt,ft)}}])})(),Is=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"addRingSide",value:function(I,y,_,P,$){if(y===0&&I.length<Bn.MINIMUM_VALID_SIZE)return null;var ne=P,ve=$;I.length>=Bn.MINIMUM_VALID_SIZE&&Ge.isCCW(I)&&(ne=$,ve=P,_=_t.opposite(_));var Oe=this._curveBuilder.getRingCurve(I,_,y);this.addCurve(Oe,ne,ve)}},{key:"addRingBothSides",value:function(I,y){this.addRingSide(I,y,_t.LEFT,Me.EXTERIOR,Me.INTERIOR),this.addRingSide(I,y,_t.RIGHT,Me.INTERIOR,Me.EXTERIOR)}},{key:"addPoint",value:function(I){if(this._distance<=0)return null;var y=I.getCoordinates(),_=this._curveBuilder.getLineCurve(y,this._distance);this.addCurve(_,Me.EXTERIOR,Me.INTERIOR)}},{key:"addPolygon",value:function(I){var y=this._distance,_=_t.LEFT;this._distance<0&&(y=-this._distance,_=_t.RIGHT);var P=I.getExteriorRing(),$=Wi.removeRepeatedPoints(P.getCoordinates());if(this._distance<0&&this.isErodedCompletely(P,this._distance)||this._distance<=0&&$.length<3)return null;this.addRingSide($,y,_,Me.EXTERIOR,Me.INTERIOR);for(var ne=0;ne<I.getNumInteriorRing();ne++){var ve=I.getInteriorRingN(ne),Oe=Wi.removeRepeatedPoints(ve.getCoordinates());this._distance>0&&this.isErodedCompletely(ve,-this._distance)||this.addRingSide(Oe,y,_t.opposite(_),Me.INTERIOR,Me.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(I,y){var _=new is(I[0],I[1],I[2]),P=_.inCentre();return cn.pointToSegment(P,_.p0,_.p1)<Math.abs(y)}},{key:"addLineString",value:function(I){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var y=Wi.removeRepeatedPoints(I.getCoordinates());if(Wi.isRing(y)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(y,this._distance);else{var _=this._curveBuilder.getLineCurve(y,this._distance);this.addCurve(_,Me.EXTERIOR,Me.INTERIOR)}}},{key:"addCurve",value:function(I,y,_){if(I===null||I.length<2)return null;var P=new Ui(I,new $n(0,Me.BOUNDARY,y,_));this._curveList.add(P)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(I){if(I.isEmpty())return null;if(I instanceof Xr)this.addPolygon(I);else if(I instanceof Kn)this.addLineString(I);else if(I instanceof He)this.addPoint(I);else if(I instanceof Rn)this.addCollection(I);else if(I instanceof ps)this.addCollection(I);else if(I instanceof xi)this.addCollection(I);else{if(!(I instanceof Fr))throw new $e(I.getGeometryType());this.addCollection(I)}}},{key:"isErodedCompletely",value:function(I,y){var _=I.getCoordinates();if(_.length<4)return y<0;if(_.length===4)return this.isTriangleErodedCompletely(_,y);var P=I.getEnvelopeInternal(),$=Math.min(P.getHeight(),P.getWidth());return y<0&&2*Math.abs(y)>$}},{key:"addCollection",value:function(I){for(var y=0;y<I.getNumGeometries();y++){var _=I.getGeometryN(y);this.add(_)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new ct;var I=arguments[0],y=arguments[1],_=arguments[2];this._inputGeom=I,this._distance=y,this._curveBuilder=_}}])})(),Ja=(function(){return o((function I(){i(this,I)}),[{key:"locate",value:function(I){}}])})(),nc=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,I.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new st;var y=this._parent.getGeometryN(this._index++);return y instanceof Fr?(this._subcollectionIterator=new I(y),this._subcollectionIterator.next()):y}},{key:"remove",value:function(){throw new $e(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[Nn]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var y=arguments[0];this._parent=y,this._atStart=!0,this._index=0,this._max=y.getNumGeometries()}},{key:"isAtomic",value:function(y){return!(y instanceof Fr)}}])})(),uu=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"locate",value:function(y){return I.locate(y,this._geom)}},{key:"interfaces_",get:function(){return[Ja]}}],[{key:"constructor_",value:function(){this._geom=null;var y=arguments[0];this._geom=y}},{key:"locatePointInPolygon",value:function(y,_){if(_.isEmpty())return Me.EXTERIOR;var P=_.getExteriorRing(),$=I.locatePointInRing(y,P);if($!==Me.INTERIOR)return $;for(var ne=0;ne<_.getNumInteriorRing();ne++){var ve=_.getInteriorRingN(ne),Oe=I.locatePointInRing(y,ve);if(Oe===Me.BOUNDARY)return Me.BOUNDARY;if(Oe===Me.INTERIOR)return Me.EXTERIOR}return Me.INTERIOR}},{key:"locatePointInRing",value:function(y,_){return _.getEnvelopeInternal().intersects(y)?ti.locateInRing(y,_.getCoordinates()):Me.EXTERIOR}},{key:"containsPointInPolygon",value:function(y,_){return Me.EXTERIOR!==I.locatePointInPolygon(y,_)}},{key:"locateInGeometry",value:function(y,_){if(_ instanceof Xr)return I.locatePointInPolygon(y,_);if(_ instanceof Fr)for(var P=new nc(_);P.hasNext();){var $=P.next();if($!==_){var ne=I.locateInGeometry(y,$);if(ne!==Me.EXTERIOR)return ne}}return Me.EXTERIOR}},{key:"isContained",value:function(y,_){return Me.EXTERIOR!==I.locate(y,_)}},{key:"locate",value:function(y,_){return _.isEmpty()?Me.EXTERIOR:_.getEnvelopeInternal().intersects(y)?I.locateInGeometry(y,_):Me.EXTERIOR}}])})(),Zs=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getNextCW",value:function(I){this.getEdges();var y=this._edgeList.indexOf(I),_=y-1;return y===0&&(_=this._edgeList.size()-1),this._edgeList.get(_)}},{key:"propagateSideLabels",value:function(I){for(var y=Me.NONE,_=this.iterator();_.hasNext();){var P=_.next().getLabel();P.isArea(I)&&P.getLocation(I,_t.LEFT)!==Me.NONE&&(y=P.getLocation(I,_t.LEFT))}if(y===Me.NONE)return null;for(var $=y,ne=this.iterator();ne.hasNext();){var ve=ne.next(),Oe=ve.getLabel();if(Oe.getLocation(I,_t.ON)===Me.NONE&&Oe.setLocation(I,_t.ON,$),Oe.isArea(I)){var tt=Oe.getLocation(I,_t.LEFT),ft=Oe.getLocation(I,_t.RIGHT);if(ft!==Me.NONE){if(ft!==$)throw new Et("side location conflict",ve.getCoordinate());tt===Me.NONE&&xe.shouldNeverReachHere("found single null side (at "+ve.getCoordinate()+")"),$=tt}else xe.isTrue(Oe.getLocation(I,_t.LEFT)===Me.NONE,"found single null side"),Oe.setLocation(I,_t.RIGHT,$),Oe.setLocation(I,_t.LEFT,$)}}}},{key:"getCoordinate",value:function(){var I=this.iterator();return I.hasNext()?I.next().getCoordinate():null}},{key:"print",value:function(I){Ar.out.println("EdgeEndStar:   "+this.getCoordinate());for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"isAreaLabelsConsistent",value:function(I){return this.computeEdgeEndLabels(I.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(I){var y=this.getEdges();if(y.size()<=0)return!0;var _=y.size()-1,P=y.get(_).getLabel().getLocation(I,_t.LEFT);xe.isTrue(P!==Me.NONE,"Found unlabelled area edge");for(var $=P,ne=this.iterator();ne.hasNext();){var ve=ne.next().getLabel();xe.isTrue(ve.isArea(I),"Found non-area edge");var Oe=ve.getLocation(I,_t.LEFT),tt=ve.getLocation(I,_t.RIGHT);if(Oe===tt||tt!==$)return!1;$=Oe}return!0}},{key:"findIndex",value:function(I){this.iterator();for(var y=0;y<this._edgeList.size();y++)if(this._edgeList.get(y)===I)return y;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new ct(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(I,y,_){return this._ptInAreaLocation[I]===Me.NONE&&(this._ptInAreaLocation[I]=uu.locate(y,_[I].getGeometry())),this._ptInAreaLocation[I]}},{key:"toString",value:function(){var I=new Qt;I.append("EdgeEndStar:   "+this.getCoordinate()),I.append(`
`);for(var y=this.iterator();y.hasNext();){var _=y.next();I.append(_),I.append(`
`)}return I.toString()}},{key:"computeEdgeEndLabels",value:function(I){for(var y=this.iterator();y.hasNext();)y.next().computeLabel(I)}},{key:"computeLabelling",value:function(I){this.computeEdgeEndLabels(I[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var y=[!1,!1],_=this.iterator();_.hasNext();)for(var P=_.next().getLabel(),$=0;$<2;$++)P.isLine($)&&P.getLocation($)===Me.BOUNDARY&&(y[$]=!0);for(var ne=this.iterator();ne.hasNext();)for(var ve=ne.next(),Oe=ve.getLabel(),tt=0;tt<2;tt++)if(Oe.isAnyNull(tt)){var ft=Me.NONE;if(y[tt])ft=Me.EXTERIOR;else{var rr=ve.getCoordinate();ft=this.getLocation(tt,rr,I)}Oe.setAllLocationsIfNull(tt,ft)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(I,y){this._edgeMap.put(I,y),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new Ri,this._edgeList=null,this._ptInAreaLocation=[Me.NONE,Me.NONE]}}])})(),ja=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var _=null,P=null,$=this._SCANNING_FOR_INCOMING,ne=0;ne<this._resultAreaEdgeList.size();ne++){var ve=this._resultAreaEdgeList.get(ne),Oe=ve.getSym();if(ve.getLabel().isArea())switch(_===null&&ve.isInResult()&&(_=ve),$){case this._SCANNING_FOR_INCOMING:if(!Oe.isInResult())continue;P=Oe,$=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!ve.isInResult())continue;P.setNext(ve),$=this._SCANNING_FOR_INCOMING}}if($===this._LINKING_TO_OUTGOING){if(_===null)throw new Et("no outgoing dirEdge found",this.getCoordinate());xe.isTrue(_.isInResult(),"unable to link last incoming dirEdge"),P.setNext(_)}}},{key:"insert",value:function(_){var P=_;this.insertEdgeEnd(P,P)}},{key:"getRightmostEdge",value:function(){var _=this.getEdges(),P=_.size();if(P<1)return null;var $=_.get(0);if(P===1)return $;var ne=_.get(P-1),ve=$.getQuadrant(),Oe=ne.getQuadrant();return oa.isNorthern(ve)&&oa.isNorthern(Oe)?$:oa.isNorthern(ve)||oa.isNorthern(Oe)?$.getDy()!==0?$:ne.getDy()!==0?ne:(xe.shouldNeverReachHere("found two horizontal edges incident on node"),null):ne}},{key:"print",value:function(_){Ar.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var P=this.iterator();P.hasNext();){var $=P.next();_.print("out "),$.print(_),_.println(),_.print("in "),$.getSym().print(_),_.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new ct;for(var _=this.iterator();_.hasNext();){var P=_.next();(P.isInResult()||P.getSym().isInResult())&&this._resultAreaEdgeList.add(P)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(_){for(var P=this.iterator();P.hasNext();){var $=P.next().getLabel();$.setAllLocationsIfNull(0,_.getLocation(0)),$.setAllLocationsIfNull(1,_.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var _=null,P=null,$=this._edgeList.size()-1;$>=0;$--){var ne=this._edgeList.get($),ve=ne.getSym();P===null&&(P=ve),_!==null&&ve.setNext(_),_=ne}P.setNext(_)}},{key:"computeDepths",value:function(){if(arguments.length===1){var _=arguments[0],P=this.findIndex(_),$=_.getDepth(_t.LEFT),ne=_.getDepth(_t.RIGHT),ve=this.computeDepths(P+1,this._edgeList.size(),$);if(this.computeDepths(0,P,ve)!==ne)throw new Et("depth mismatch at "+_.getCoordinate())}else if(arguments.length===3){for(var Oe=arguments[1],tt=arguments[2],ft=arguments[0];ft<Oe;ft++){var rr=this._edgeList.get(ft);rr.setEdgeDepths(_t.RIGHT,tt),tt=rr.getDepth(_t.LEFT)}return tt}}},{key:"mergeSymLabels",value:function(){for(var _=this.iterator();_.hasNext();){var P=_.next();P.getLabel().merge(P.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(_){for(var P=null,$=null,ne=this._SCANNING_FOR_INCOMING,ve=this._resultAreaEdgeList.size()-1;ve>=0;ve--){var Oe=this._resultAreaEdgeList.get(ve),tt=Oe.getSym();switch(P===null&&Oe.getEdgeRing()===_&&(P=Oe),ne){case this._SCANNING_FOR_INCOMING:if(tt.getEdgeRing()!==_)continue;$=tt,ne=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(Oe.getEdgeRing()!==_)continue;$.setNextMin(Oe),ne=this._SCANNING_FOR_INCOMING}}ne===this._LINKING_TO_OUTGOING&&(xe.isTrue(P!==null,"found null for first outgoing dirEdge"),xe.isTrue(P.getEdgeRing()===_,"unable to link last incoming dirEdge"),$.setNextMin(P))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var _=0,P=this.iterator();P.hasNext();)P.next().isInResult()&&_++;return _}if(arguments.length===1){for(var $=arguments[0],ne=0,ve=this.iterator();ve.hasNext();)ve.next().getEdgeRing()===$&&ne++;return ne}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var _=Me.NONE,P=this.iterator();P.hasNext();){var $=P.next(),ne=$.getSym();if(!$.isLineEdge()){if($.isInResult()){_=Me.INTERIOR;break}if(ne.isInResult()){_=Me.EXTERIOR;break}}}if(_===Me.NONE)return null;for(var ve=_,Oe=this.iterator();Oe.hasNext();){var tt=Oe.next(),ft=tt.getSym();tt.isLineEdge()?tt.getEdge().setCovered(ve===Me.INTERIOR):(tt.isInResult()&&(ve=Me.EXTERIOR),ft.isInResult()&&(ve=Me.INTERIOR))}}},{key:"computeLabelling",value:function(_){E(y,"computeLabelling",this,1).call(this,_),this._label=new $n(Me.NONE);for(var P=this.iterator();P.hasNext();)for(var $=P.next().getEdge().getLabel(),ne=0;ne<2;ne++){var ve=$.getLocation(ne);ve!==Me.INTERIOR&&ve!==Me.BOUNDARY||this._label.setLocation(ne,Me.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])})(Zs),Ps=(function(I){function y(){return i(this,y),n(this,y)}return m(y,I),o(y,[{key:"createNode",value:function(_){return new fi(_,new ja)}}])})(qs),ic=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"compareTo",value:function(y){var _=y;return I.compareOriented(this._pts,this._orientation,_._pts,_._orientation)}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var y=arguments[0];this._pts=y,this._orientation=I.orientation(y)}},{key:"orientation",value:function(y){return Wi.increasingDirection(y)===1}},{key:"compareOriented",value:function(y,_,P,$){for(var ne=_?1:-1,ve=$?1:-1,Oe=_?y.length:-1,tt=$?P.length:-1,ft=_?0:y.length-1,rr=$?0:P.length-1;;){var ur=y[ft].compareTo(P[rr]);if(ur!==0)return ur;var qr=(ft+=ne)===Oe,bn=(rr+=ve)===tt;if(qr&&!bn)return-1;if(!qr&&bn)return 1;if(qr&&bn)return 0}}}])})(),ac=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"print",value:function(I){I.print("MULTILINESTRING ( ");for(var y=0;y<this._edges.size();y++){var _=this._edges.get(y);y>0&&I.print(","),I.print("(");for(var P=_.getCoordinates(),$=0;$<P.length;$++)$>0&&I.print(","),I.print(P[$].x+" "+P[$].y);I.println(")")}I.print(")  ")}},{key:"addAll",value:function(I){for(var y=I.iterator();y.hasNext();)this.add(y.next())}},{key:"findEdgeIndex",value:function(I){for(var y=0;y<this._edges.size();y++)if(this._edges.get(y).equals(I))return y;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(I){return this._edges.get(I)}},{key:"findEqualEdge",value:function(I){var y=new ic(I.getCoordinates());return this._ocaMap.get(y)}},{key:"add",value:function(I){this._edges.add(I);var y=new ic(I.getCoordinates());this._ocaMap.put(y,I)}}],[{key:"constructor_",value:function(){this._edges=new ct,this._ocaMap=new Ri}}])})(),cl=(function(){return o((function I(){i(this,I)}),[{key:"processIntersections",value:function(I,y,_,P){}},{key:"isDone",value:function(){}}])})(),cu=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isTrivialIntersection",value:function(y,_,P,$){if(y===P&&this._li.getIntersectionNum()===1){if(I.isAdjacentSegments(_,$))return!0;if(y.isClosed()){var ne=y.size()-1;if(_===0&&$===ne||$===0&&_===ne)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(y,_,P,$){if(y===P&&_===$)return null;this.numTests++;var ne=y.getCoordinates()[_],ve=y.getCoordinates()[_+1],Oe=P.getCoordinates()[$],tt=P.getCoordinates()[$+1];this._li.computeIntersection(ne,ve,Oe,tt),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(y,_,P,$)||(this._hasIntersection=!0,y.addIntersections(this._li,_,0),P.addIntersections(this._li,$,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[cl]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var y=arguments[0];this._li=y}},{key:"isAdjacentSegments",value:function(y,_){return Math.abs(y-_)===1}}])})(),Lo=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(I){I.print(this.coord),I.print(" seg # = "+this.segmentIndex),I.println(" dist = "+this.dist)}},{key:"compareTo",value:function(I){var y=I;return this.compare(y.segmentIndex,y.dist)}},{key:"isEndPoint",value:function(I){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===I}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(I,y){return this.segmentIndex<I?-1:this.segmentIndex>I?1:this.dist<y?-1:this.dist>y?1:0}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var I=arguments[0],y=arguments[1],_=arguments[2];this.coord=new Be(I),this.segmentIndex=y,this.dist=_}}])})(),mo=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"print",value:function(I){I.println("Intersections:");for(var y=this.iterator();y.hasNext();)y.next().print(I)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(I){this.addEndpoints();for(var y=this.iterator(),_=y.next();y.hasNext();){var P=y.next(),$=this.createSplitEdge(_,P);I.add($),_=P}}},{key:"addEndpoints",value:function(){var I=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[I],I,0)}},{key:"createSplitEdge",value:function(I,y){var _=y.segmentIndex-I.segmentIndex+2,P=this.edge.pts[y.segmentIndex],$=y.dist>0||!y.coord.equals2D(P);$||_--;var ne=new Array(_).fill(null),ve=0;ne[ve++]=new Be(I.coord);for(var Oe=I.segmentIndex+1;Oe<=y.segmentIndex;Oe++)ne[ve++]=this.edge.pts[Oe];return $&&(ne[ve]=y.coord),new Va(ne,new $n(this.edge._label))}},{key:"add",value:function(I,y,_){var P=new Lo(I,y,_),$=this._nodeMap.get(P);return $!==null?$:(this._nodeMap.put(P,P),P)}},{key:"isIntersection",value:function(I){for(var y=this.iterator();y.hasNext();)if(y.next().coord.equals(I))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new Ri,this.edge=null;var I=arguments[0];this.edge=I}}])})(),Du=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(I.isTrue(this._matrix[Me.INTERIOR][Me.INTERIOR])||I.isTrue(this._matrix[Me.INTERIOR][Me.BOUNDARY])||I.isTrue(this._matrix[Me.BOUNDARY][Me.INTERIOR])||I.isTrue(this._matrix[Me.BOUNDARY][Me.BOUNDARY]))&&this._matrix[Me.EXTERIOR][Me.INTERIOR]===nr.FALSE&&this._matrix[Me.EXTERIOR][Me.BOUNDARY]===nr.FALSE}},{key:"isCoveredBy",value:function(){return(I.isTrue(this._matrix[Me.INTERIOR][Me.INTERIOR])||I.isTrue(this._matrix[Me.INTERIOR][Me.BOUNDARY])||I.isTrue(this._matrix[Me.BOUNDARY][Me.INTERIOR])||I.isTrue(this._matrix[Me.BOUNDARY][Me.BOUNDARY]))&&this._matrix[Me.INTERIOR][Me.EXTERIOR]===nr.FALSE&&this._matrix[Me.BOUNDARY][Me.EXTERIOR]===nr.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<y.length;_++){var P=Math.trunc(_/3),$=_%3;this._matrix[P][$]=nr.toDimensionValue(y.charAt(_))}else if(arguments.length===3){var ne=arguments[0],ve=arguments[1],Oe=arguments[2];this._matrix[ne][ve]=Oe}}},{key:"isContains",value:function(){return I.isTrue(this._matrix[Me.INTERIOR][Me.INTERIOR])&&this._matrix[Me.EXTERIOR][Me.INTERIOR]===nr.FALSE&&this._matrix[Me.EXTERIOR][Me.BOUNDARY]===nr.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<y.length;_++){var P=Math.trunc(_/3),$=_%3;this.setAtLeast(P,$,nr.toDimensionValue(y.charAt(_)))}else if(arguments.length===3){var ne=arguments[0],ve=arguments[1],Oe=arguments[2];this._matrix[ne][ve]<Oe&&(this._matrix[ne][ve]=Oe)}}},{key:"setAtLeastIfValid",value:function(y,_,P){y>=0&&_>=0&&this.setAtLeast(y,_,P)}},{key:"isWithin",value:function(){return I.isTrue(this._matrix[Me.INTERIOR][Me.INTERIOR])&&this._matrix[Me.INTERIOR][Me.EXTERIOR]===nr.FALSE&&this._matrix[Me.BOUNDARY][Me.EXTERIOR]===nr.FALSE}},{key:"isTouches",value:function(y,_){return y>_?this.isTouches(_,y):(y===nr.A&&_===nr.A||y===nr.L&&_===nr.L||y===nr.L&&_===nr.A||y===nr.P&&_===nr.A||y===nr.P&&_===nr.L)&&this._matrix[Me.INTERIOR][Me.INTERIOR]===nr.FALSE&&(I.isTrue(this._matrix[Me.INTERIOR][Me.BOUNDARY])||I.isTrue(this._matrix[Me.BOUNDARY][Me.INTERIOR])||I.isTrue(this._matrix[Me.BOUNDARY][Me.BOUNDARY]))}},{key:"isOverlaps",value:function(y,_){return y===nr.P&&_===nr.P||y===nr.A&&_===nr.A?I.isTrue(this._matrix[Me.INTERIOR][Me.INTERIOR])&&I.isTrue(this._matrix[Me.INTERIOR][Me.EXTERIOR])&&I.isTrue(this._matrix[Me.EXTERIOR][Me.INTERIOR]):y===nr.L&&_===nr.L&&this._matrix[Me.INTERIOR][Me.INTERIOR]===1&&I.isTrue(this._matrix[Me.INTERIOR][Me.EXTERIOR])&&I.isTrue(this._matrix[Me.EXTERIOR][Me.INTERIOR])}},{key:"isEquals",value:function(y,_){return y===_&&I.isTrue(this._matrix[Me.INTERIOR][Me.INTERIOR])&&this._matrix[Me.INTERIOR][Me.EXTERIOR]===nr.FALSE&&this._matrix[Me.BOUNDARY][Me.EXTERIOR]===nr.FALSE&&this._matrix[Me.EXTERIOR][Me.INTERIOR]===nr.FALSE&&this._matrix[Me.EXTERIOR][Me.BOUNDARY]===nr.FALSE}},{key:"toString",value:function(){for(var y=new Do("123456789"),_=0;_<3;_++)for(var P=0;P<3;P++)y.setCharAt(3*_+P,nr.toDimensionSymbol(this._matrix[_][P]));return y.toString()}},{key:"setAll",value:function(y){for(var _=0;_<3;_++)for(var P=0;P<3;P++)this._matrix[_][P]=y}},{key:"get",value:function(y,_){return this._matrix[y][_]}},{key:"transpose",value:function(){var y=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=y,y=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=y,y=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=y,this}},{key:"matches",value:function(y){if(y.length!==9)throw new U("Should be length 9: "+y);for(var _=0;_<3;_++)for(var P=0;P<3;P++)if(!I.matches(this._matrix[_][P],y.charAt(3*_+P)))return!1;return!0}},{key:"add",value:function(y){for(var _=0;_<3;_++)for(var P=0;P<3;P++)this.setAtLeast(_,P,y.get(_,P))}},{key:"isDisjoint",value:function(){return this._matrix[Me.INTERIOR][Me.INTERIOR]===nr.FALSE&&this._matrix[Me.INTERIOR][Me.BOUNDARY]===nr.FALSE&&this._matrix[Me.BOUNDARY][Me.INTERIOR]===nr.FALSE&&this._matrix[Me.BOUNDARY][Me.BOUNDARY]===nr.FALSE}},{key:"isCrosses",value:function(y,_){return y===nr.P&&_===nr.L||y===nr.P&&_===nr.A||y===nr.L&&_===nr.A?I.isTrue(this._matrix[Me.INTERIOR][Me.INTERIOR])&&I.isTrue(this._matrix[Me.INTERIOR][Me.EXTERIOR]):y===nr.L&&_===nr.P||y===nr.A&&_===nr.P||y===nr.A&&_===nr.L?I.isTrue(this._matrix[Me.INTERIOR][Me.INTERIOR])&&I.isTrue(this._matrix[Me.EXTERIOR][Me.INTERIOR]):y===nr.L&&_===nr.L&&this._matrix[Me.INTERIOR][Me.INTERIOR]===0}},{key:"interfaces_",get:function(){return[W]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map((function(){return Array(3)})),this.setAll(nr.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var y=arguments[0];I.constructor_.call(this),this.set(y)}else if(arguments[0]instanceof I){var _=arguments[0];I.constructor_.call(this),this._matrix[Me.INTERIOR][Me.INTERIOR]=_._matrix[Me.INTERIOR][Me.INTERIOR],this._matrix[Me.INTERIOR][Me.BOUNDARY]=_._matrix[Me.INTERIOR][Me.BOUNDARY],this._matrix[Me.INTERIOR][Me.EXTERIOR]=_._matrix[Me.INTERIOR][Me.EXTERIOR],this._matrix[Me.BOUNDARY][Me.INTERIOR]=_._matrix[Me.BOUNDARY][Me.INTERIOR],this._matrix[Me.BOUNDARY][Me.BOUNDARY]=_._matrix[Me.BOUNDARY][Me.BOUNDARY],this._matrix[Me.BOUNDARY][Me.EXTERIOR]=_._matrix[Me.BOUNDARY][Me.EXTERIOR],this._matrix[Me.EXTERIOR][Me.INTERIOR]=_._matrix[Me.EXTERIOR][Me.INTERIOR],this._matrix[Me.EXTERIOR][Me.BOUNDARY]=_._matrix[Me.EXTERIOR][Me.BOUNDARY],this._matrix[Me.EXTERIOR][Me.EXTERIOR]=_._matrix[Me.EXTERIOR][Me.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var y=arguments[0],_=arguments[1];return _===nr.SYM_DONTCARE||_===nr.SYM_TRUE&&(y>=0||y===nr.TRUE)||_===nr.SYM_FALSE&&y===nr.FALSE||_===nr.SYM_P&&y===nr.P||_===nr.SYM_L&&y===nr.L||_===nr.SYM_A&&y===nr.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var P=arguments[1];return new I(arguments[0]).matches(P)}}},{key:"isTrue",value:function(y){return y>=0||y===nr.TRUE}}])})(),Ua=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(y){return y===null||y.length===0?null:(this.ensureCapacity(this._size+y.length),Ar.arraycopy(y,0,this._data,this._size,y.length),void(this._size+=y.length))}},{key:"ensureCapacity",value:function(y){if(y<=this._data.length)return null;var _=Math.max(y,2*this._data.length);this._data=Gt.copyOf(this._data,_)}},{key:"toArray",value:function(){var y=new Array(this._size).fill(null);return Ar.arraycopy(this._data,0,y,0,this._size),y}},{key:"add",value:function(y){this.ensureCapacity(this._size+1),this._data[this._size]=y,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)I.constructor_.call(this,10);else if(arguments.length===1){var y=arguments[0];this._data=new Array(y).fill(null)}}}])})(),fu=(function(){function I(){i(this,I)}return o(I,[{key:"getChainStartIndices",value:function(y){var _=0,P=new Ua(Math.trunc(y.length/2));P.add(_);do{var $=this.findChainEnd(y,_);P.add($),_=$}while(_<y.length-1);return P.toArray()}},{key:"findChainEnd",value:function(y,_){for(var P=oa.quadrant(y[_],y[_+1]),$=_+1;$<y.length&&oa.quadrant(y[$-1],y[$])===P;)$++;return $-1}},{key:"OLDgetChainStartIndices",value:function(y){var _=0,P=new ct;P.add(_);do{var $=this.findChainEnd(y,_);P.add($),_=$}while(_<y.length-1);return I.toIntArray(P)}}],[{key:"toIntArray",value:function(y){for(var _=new Array(y.size()).fill(null),P=0;P<_.length;P++)_[P]=y.get(P).intValue();return _}}])})(),Ks=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(I){var y=this.pts[this.startIndex[I]].x,_=this.pts[this.startIndex[I+1]].x;return y>_?y:_}},{key:"getMinX",value:function(I){var y=this.pts[this.startIndex[I]].x,_=this.pts[this.startIndex[I+1]].x;return y<_?y:_}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var I=arguments[0],y=arguments[1],_=arguments[2],P=arguments[3];this.computeIntersectsForChain(this.startIndex[I],this.startIndex[I+1],y,y.startIndex[_],y.startIndex[_+1],P)}else if(arguments.length===6){var $=arguments[0],ne=arguments[1],ve=arguments[2],Oe=arguments[3],tt=arguments[4],ft=arguments[5];if(ne-$==1&&tt-Oe==1)return ft.addIntersections(this.e,$,ve.e,Oe),null;if(!this.overlaps($,ne,ve,Oe,tt))return null;var rr=Math.trunc(($+ne)/2),ur=Math.trunc((Oe+tt)/2);$<rr&&(Oe<ur&&this.computeIntersectsForChain($,rr,ve,Oe,ur,ft),ur<tt&&this.computeIntersectsForChain($,rr,ve,ur,tt,ft)),rr<ne&&(Oe<ur&&this.computeIntersectsForChain(rr,ne,ve,Oe,ur,ft),ur<tt&&this.computeIntersectsForChain(rr,ne,ve,ur,tt,ft))}}},{key:"overlaps",value:function(I,y,_,P,$){return Ke.intersects(this.pts[I],this.pts[y],_.pts[P],_.pts[$])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(I,y){for(var _=0;_<this.startIndex.length-1;_++)for(var P=0;P<I.startIndex.length-1;P++)this.computeIntersectsForChain(_,I,P,y)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var I=arguments[0];this.e=I,this.pts=I.getCoordinates();var y=new fu;this.startIndex=y.getChainStartIndices(this.pts)}}])})(),ys=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"getDepth",value:function(y,_){return this._depth[y][_]}},{key:"setDepth",value:function(y,_,P){this._depth[y][_]=P}},{key:"isNull",value:function(){if(arguments.length===0){for(var y=0;y<2;y++)for(var _=0;_<3;_++)if(this._depth[y][_]!==I.NULL_VALUE)return!1;return!0}if(arguments.length===1){var P=arguments[0];return this._depth[P][1]===I.NULL_VALUE}if(arguments.length===2){var $=arguments[0],ne=arguments[1];return this._depth[$][ne]===I.NULL_VALUE}}},{key:"normalize",value:function(){for(var y=0;y<2;y++)if(!this.isNull(y)){var _=this._depth[y][1];this._depth[y][2]<_&&(_=this._depth[y][2]),_<0&&(_=0);for(var P=1;P<3;P++){var $=0;this._depth[y][P]>_&&($=1),this._depth[y][P]=$}}}},{key:"getDelta",value:function(y){return this._depth[y][_t.RIGHT]-this._depth[y][_t.LEFT]}},{key:"getLocation",value:function(y,_){return this._depth[y][_]<=0?Me.EXTERIOR:Me.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var y=arguments[0],_=0;_<2;_++)for(var P=1;P<3;P++){var $=y.getLocation(_,P);$!==Me.EXTERIOR&&$!==Me.INTERIOR||(this.isNull(_,P)?this._depth[_][P]=I.depthAtLocation($):this._depth[_][P]+=I.depthAtLocation($))}else if(arguments.length===3){var ne=arguments[0],ve=arguments[1];arguments[2]===Me.INTERIOR&&this._depth[ne][ve]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var y=0;y<2;y++)for(var _=0;_<3;_++)this._depth[y][_]=I.NULL_VALUE}},{key:"depthAtLocation",value:function(y){return y===Me.EXTERIOR?0:y===Me.INTERIOR?1:I.NULL_VALUE}}])})();ys.NULL_VALUE=-1;var Va=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var _=new Array(2).fill(null);return _[0]=this.pts[0],_[1]=this.pts[1],new y(_,$n.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(_){this._isIsolated=_}},{key:"setName",value:function(_){this._name=_}},{key:"equals",value:function(_){if(!(_ instanceof y))return!1;var P=_;if(this.pts.length!==P.pts.length)return!1;for(var $=!0,ne=!0,ve=this.pts.length,Oe=0;Oe<this.pts.length;Oe++)if(this.pts[Oe].equals2D(P.pts[Oe])||($=!1),this.pts[Oe].equals2D(P.pts[--ve])||(ne=!1),!$&&!ne)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var _=arguments[0];return this.pts[_]}}},{key:"print",value:function(_){_.print("edge "+this._name+": "),_.print("LINESTRING (");for(var P=0;P<this.pts.length;P++)P>0&&_.print(","),_.print(this.pts[P].x+" "+this.pts[P].y);_.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(_){y.updateIM(this._label,_)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(_){_.print("edge "+this._name+": ");for(var P=this.pts.length-1;P>=0;P--)_.print(this.pts[P]+" ");_.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new Ks(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new Ke;for(var _=0;_<this.pts.length;_++)this._env.expandToInclude(this.pts[_])}return this._env}},{key:"addIntersection",value:function(_,P,$,ne){var ve=new Be(_.getIntersection(ne)),Oe=P,tt=_.getEdgeDistance($,ne),ft=Oe+1;if(ft<this.pts.length){var rr=this.pts[ft];ve.equals2D(rr)&&(Oe=ft,tt=0)}this.eiList.add(ve,Oe,tt)}},{key:"toString",value:function(){var _=new Do;_.append("edge "+this._name+": "),_.append("LINESTRING (");for(var P=0;P<this.pts.length;P++)P>0&&_.append(","),_.append(this.pts[P].x+" "+this.pts[P].y);return _.append(")  "+this._label+" "+this._depthDelta),_.toString()}},{key:"isPointwiseEqual",value:function(_){if(this.pts.length!==_.pts.length)return!1;for(var P=0;P<this.pts.length;P++)if(!this.pts[P].equals2D(_.pts[P]))return!1;return!0}},{key:"setDepthDelta",value:function(_){this._depthDelta=_}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(_,P,$){for(var ne=0;ne<_.getIntersectionNum();ne++)this.addIntersection(_,P,$,ne)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new mo(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ys,this._depthDelta=0,arguments.length===1){var _=arguments[0];y.constructor_.call(this,_,null)}else if(arguments.length===2){var P=arguments[0],$=arguments[1];this.pts=P,this._label=$}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Du&&arguments[0]instanceof $n))return E(y,"updateIM",this).apply(this,arguments);var _=arguments[0],P=arguments[1];P.setAtLeastIfValid(_.getLocation(0,_t.ON),_.getLocation(1,_t.ON),1),_.isArea()&&(P.setAtLeastIfValid(_.getLocation(0,_t.LEFT),_.getLocation(1,_t.LEFT),2),P.setAtLeastIfValid(_.getLocation(0,_t.RIGHT),_.getLocation(1,_t.RIGHT),2))}}])})(mn),Vl=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"setWorkingPrecisionModel",value:function(y){this._workingPrecisionModel=y}},{key:"insertUniqueEdge",value:function(y){var _=this._edgeList.findEqualEdge(y);if(_!==null){var P=_.getLabel(),$=y.getLabel();_.isPointwiseEqual(y)||($=new $n(y.getLabel())).flip(),P.merge($);var ne=I.depthDelta($),ve=_.getDepthDelta()+ne;_.setDepthDelta(ve)}else this._edgeList.add(y),y.setDepthDelta(I.depthDelta(y.getLabel()))}},{key:"buildSubgraphs",value:function(y,_){for(var P=new ct,$=y.iterator();$.hasNext();){var ne=$.next(),ve=ne.getRightmostCoordinate(),Oe=new ms(P).getDepth(ve);ne.computeDepth(Oe),ne.findResultEdges(),P.add(ne),_.add(ne.getDirectedEdges(),ne.getNodes())}}},{key:"createSubgraphs",value:function(y){for(var _=new ct,P=y.getNodes().iterator();P.hasNext();){var $=P.next();if(!$.isVisited()){var ne=new qt;ne.create($),_.add(ne)}}return ri.sort(_,ri.reverseOrder()),_}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(y){if(this._workingNoder!==null)return this._workingNoder;var _=new ul,P=new an;return P.setPrecisionModel(y),_.setSegmentIntersector(new cu(P)),_}},{key:"buffer",value:function(y,_){var P=this._workingPrecisionModel;P===null&&(P=y.getPrecisionModel()),this._geomFact=y.getFactory();var $=new Il(P,this._bufParams),ne=new Is(y,_,$).getCurves();if(ne.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(ne,P),this._graph=new Vo(new Ps),this._graph.addEdges(this._edgeList.getEdges());var ve=this.createSubgraphs(this._graph),Oe=new ku(this._geomFact);this.buildSubgraphs(ve,Oe);var tt=Oe.getPolygons();return tt.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(tt)}},{key:"computeNodedEdges",value:function(y,_){var P=this.getNoder(_);P.computeNodes(y);for(var $=P.getNodedSubstrings().iterator();$.hasNext();){var ne=$.next(),ve=ne.getCoordinates();if(ve.length!==2||!ve[0].equals2D(ve[1])){var Oe=ne.getData(),tt=new Va(ne.getCoordinates(),new $n(Oe));this.insertUniqueEdge(tt)}}}},{key:"setNoder",value:function(y){this._workingNoder=y}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new ac;var y=arguments[0];this._bufParams=y}},{key:"depthDelta",value:function(y){var _=y.getLocation(0,_t.LEFT),P=y.getLocation(0,_t.RIGHT);return _===Me.INTERIOR&&P===Me.EXTERIOR?1:_===Me.EXTERIOR&&P===Me.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(y){for(var _=new Aa,P=new ct;y.hasNext();){var $=y.next(),ne=_.createLineString($.getCoordinates());P.add(ne)}return _.buildGeometry(P)}}])})(),fl=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"rescale",value:function(){if(Tr(arguments[0],zt))for(var y=arguments[0].iterator();y.hasNext();){var _=y.next();this.rescale(_.getCoordinates())}else if(arguments[0]instanceof Array){for(var P=arguments[0],$=0;$<P.length;$++)P[$].x=P[$].x/this._scaleFactor+this._offsetX,P[$].y=P[$].y/this._scaleFactor+this._offsetY;P.length===2&&P[0].equals2D(P[1])&&Ar.out.println(P)}}},{key:"scale",value:function(){if(Tr(arguments[0],zt)){for(var y=arguments[0],_=new ct(y.size()),P=y.iterator();P.hasNext();){var $=P.next();_.add(new Ui(this.scale($.getCoordinates()),$.getData()))}return _}if(arguments[0]instanceof Array){for(var ne=arguments[0],ve=new Array(ne.length).fill(null),Oe=0;Oe<ne.length;Oe++)ve[Oe]=new Be(Math.round((ne[Oe].x-this._offsetX)*this._scaleFactor),Math.round((ne[Oe].y-this._offsetY)*this._scaleFactor),ne[Oe].getZ());return Wi.removeRepeatedPoints(ve)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var y=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(y),y}},{key:"computeNodes",value:function(y){var _=y;this._isScaled&&(_=this.scale(y)),this._noder.computeNodes(_)}},{key:"interfaces_",get:function(){return[za]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var y=arguments[0],_=arguments[1];I.constructor_.call(this,y,_,0,0)}else if(arguments.length===4){var P=arguments[0],$=arguments[1];this._noder=P,this._scaleFactor=$,this._isScaled=!this.isIntegerPrecision()}}}])})(),hl=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();){var _=y.next().getCoordinates();this.checkEndPtVertexIntersections(_[0],this._segStrings),this.checkEndPtVertexIntersections(_[_.length-1],this._segStrings)}else if(arguments.length===2){for(var P=arguments[0],$=arguments[1].iterator();$.hasNext();)for(var ne=$.next().getCoordinates(),ve=1;ve<ne.length-1;ve++)if(ne[ve].equals(P))throw new de("found endpt/interior pt intersection at index "+ve+" :pt "+P)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();)for(var _=y.next(),P=this._segStrings.iterator();P.hasNext();){var $=P.next();this.checkInteriorIntersections(_,$)}else if(arguments.length===2)for(var ne=arguments[0],ve=arguments[1],Oe=ne.getCoordinates(),tt=ve.getCoordinates(),ft=0;ft<Oe.length-1;ft++)for(var rr=0;rr<tt.length-1;rr++)this.checkInteriorIntersections(ne,ft,ve,rr);else if(arguments.length===4){var ur=arguments[0],qr=arguments[1],bn=arguments[2],Dn=arguments[3];if(ur===bn&&qr===Dn)return null;var Xn=ur.getCoordinates()[qr],Fn=ur.getCoordinates()[qr+1],En=bn.getCoordinates()[Dn],na=bn.getCoordinates()[Dn+1];if(this._li.computeIntersection(Xn,Fn,En,na),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Xn,Fn)||this.hasInteriorIntersection(this._li,En,na)))throw new de("found non-noded intersection at "+Xn+"-"+Fn+" and "+En+"-"+na)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var y=this._segStrings.iterator();y.hasNext();){var _=y.next();this.checkCollapses(_)}else if(arguments.length===1)for(var P=arguments[0].getCoordinates(),$=0;$<P.length-2;$++)this.checkCollapse(P[$],P[$+1],P[$+2])}},{key:"hasInteriorIntersection",value:function(y,_,P){for(var $=0;$<y.getIntersectionNum();$++){var ne=y.getIntersection($);if(!ne.equals(_)&&!ne.equals(P))return!0}return!1}},{key:"checkCollapse",value:function(y,_,P){if(y.equals(P))throw new de("found non-noded collapse at "+I.fact.createLineString([y,_,P]))}}],[{key:"constructor_",value:function(){this._li=new an,this._segStrings=null;var y=arguments[0];this._segStrings=y}}])})();hl.fact=new Aa;var $l=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"intersectsScaled",value:function(y,_){var P=Math.min(y.x,_.x),$=Math.max(y.x,_.x),ne=Math.min(y.y,_.y),ve=Math.max(y.y,_.y),Oe=this._maxx<P||this._minx>$||this._maxy<ne||this._miny>ve;if(Oe)return!1;var tt=this.intersectsToleranceSquare(y,_);return xe.isTrue(!(Oe&&tt),"Found bad envelope test"),tt}},{key:"initCorners",value:function(y){var _=.5;this._minx=y.x-_,this._maxx=y.x+_,this._miny=y.y-_,this._maxy=y.y+_,this._corner[0]=new Be(this._maxx,this._maxy),this._corner[1]=new Be(this._minx,this._maxy),this._corner[2]=new Be(this._minx,this._miny),this._corner[3]=new Be(this._maxx,this._miny)}},{key:"intersects",value:function(y,_){return this._scaleFactor===1?this.intersectsScaled(y,_):(this.copyScaled(y,this._p0Scaled),this.copyScaled(_,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(y){return Math.round(y*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(y,_){_.x=this.scale(y.x),_.y=this.scale(y.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var y=I.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ke(this._originalPt.x-y,this._originalPt.x+y,this._originalPt.y-y,this._originalPt.y+y)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(y,_){return this._li.computeIntersection(y,_,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(y,_,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(y,_){var P=!1,$=!1;return this._li.computeIntersection(y,_,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(y,_,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(P=!0),this._li.computeIntersection(y,_,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&($=!0),this._li.computeIntersection(y,_,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!P||!$)||!!y.equals(this._pt)||!!_.equals(this._pt))))}},{key:"addSnappedNode",value:function(y,_){var P=y.getCoordinate(_),$=y.getCoordinate(_+1);return!!this.intersects(P,$)&&(y.addIntersection(this.getCoordinate(),_),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var y=arguments[0],_=arguments[1],P=arguments[2];if(this._originalPt=y,this._pt=y,this._scaleFactor=_,this._li=P,_<=0)throw new U("Scale factor must be non-zero");_!==1&&(this._pt=new Be(this.scale(y.x),this.scale(y.y)),this._p0Scaled=new Be,this._p1Scaled=new Be),this.initCorners(this._pt)}}])})();$l.SAFE_ENV_EXPANSION_FACTOR=.75;var ql=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var I=arguments[1];arguments[0].getLineSegment(I,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new Xi}}])})(),dl=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"snap",value:function(){if(arguments.length===1){var I=arguments[0];return this.snap(I,null,-1)}if(arguments.length===3){var y=arguments[0],_=arguments[1],P=arguments[2],$=y.getSafeEnvelope(),ne=new Hl(y,_,P);return this._index.query($,new((function(){return o((function ve(){i(this,ve)}),[{key:"interfaces_",get:function(){return[ue]}},{key:"visitItem",value:function(ve){ve.select($,ne)}}])})())),ne.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var I=arguments[0];this._index=I}}])})(),Hl=(function(I){function y(){var _;return i(this,y),_=n(this,y),y.constructor_.apply(_,arguments),_}return m(y,I),o(y,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof Si))return E(y,"select",this,1).apply(this,arguments);var _=arguments[1],P=arguments[0].getContext();if(this._parentEdge===P&&(_===this._hotPixelVertexIndex||_+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(P,_)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var _=arguments[0],P=arguments[1],$=arguments[2];this._hotPixel=_,this._parentEdge=P,this._hotPixelVertexIndex=$}}])})(ql);dl.HotPixelSnapAction=Hl;var Ou=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"processIntersections",value:function(I,y,_,P){if(I===_&&y===P)return null;var $=I.getCoordinates()[y],ne=I.getCoordinates()[y+1],ve=_.getCoordinates()[P],Oe=_.getCoordinates()[P+1];if(this._li.computeIntersection($,ne,ve,Oe),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var tt=0;tt<this._li.getIntersectionNum();tt++)this._interiorIntersections.add(this._li.getIntersection(tt));I.addIntersections(this._li,y,0),_.addIntersections(this._li,P,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[cl]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var I=arguments[0];this._li=I,this._interiorIntersections=new ct}}])})(),tr=(function(){return o((function I(){i(this,I),I.constructor_.apply(this,arguments)}),[{key:"checkCorrectness",value:function(I){var y=Ui.getNodedSubstrings(I),_=new hl(y);try{_.checkValid()}catch(P){if(!(P instanceof O))throw P;P.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return Ui.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(I,y){var _=this.findInteriorIntersections(I,y);this.computeIntersectionSnaps(_),this.computeVertexSnaps(I)}},{key:"findInteriorIntersections",value:function(I,y){var _=new Ou(y);return this._noder.setSegmentIntersector(_),this._noder.computeNodes(I),_.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(Tr(arguments[0],zt))for(var I=arguments[0].iterator();I.hasNext();){var y=I.next();this.computeVertexSnaps(y)}else if(arguments[0]instanceof Ui)for(var _=arguments[0],P=_.getCoordinates(),$=0;$<P.length;$++){var ne=new $l(P[$],this._scaleFactor,this._li);this._pointSnapper.snap(ne,_,$)&&_.addIntersection(P[$],$)}}},{key:"computeNodes",value:function(I){this._nodedSegStrings=I,this._noder=new ul,this._pointSnapper=new dl(this._noder.getIndex()),this.snapRound(I,this._li)}},{key:"computeIntersectionSnaps",value:function(I){for(var y=I.iterator();y.hasNext();){var _=y.next(),P=new $l(_,this._scaleFactor,this._li);this._pointSnapper.snap(P)}}},{key:"interfaces_",get:function(){return[za]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var I=arguments[0];this._pm=I,this._li=new an,this._li.setPrecisionModel(I),this._scaleFactor=I.getScale()}}])})(),mr=(function(){function I(){i(this,I),I.constructor_.apply(this,arguments)}return o(I,[{key:"bufferFixedPrecision",value:function(y){var _=new fl(new tr(new ma(1)),y.getScale()),P=new Vl(this._bufParams);P.setWorkingPrecisionModel(y),P.setNoder(_),this._resultGeometry=P.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var y=I.MAX_PRECISION_DIGITS;y>=0;y--){try{this.bufferReducedPrecision(y)}catch(ne){if(!(ne instanceof Et))throw ne;this._saveException=ne}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var _=arguments[0],P=I.precisionScaleFactor(this._argGeom,this._distance,_),$=new ma(P);this.bufferFixedPrecision($)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var y=this._argGeom.getFactory().getPrecisionModel();y.getType()===ma.FIXED?this.bufferFixedPrecision(y):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(y){this._bufParams.setQuadrantSegments(y)}},{key:"bufferOriginalPrecision",value:function(){try{var y=new Vl(this._bufParams);this._resultGeometry=y.buffer(this._argGeom,this._distance)}catch(_){if(!(_ instanceof de))throw _;this._saveException=_}}},{key:"getResultGeometry",value:function(y){return this._distance=y,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(y){this._bufParams.setEndCapStyle(y)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new N,this._resultGeometry=null,this._saveException=null,arguments.length===1){var y=arguments[0];this._argGeom=y}else if(arguments.length===2){var _=arguments[0],P=arguments[1];this._argGeom=_,this._bufParams=P}}},{key:"bufferOp",value:function(){if(arguments.length===2){var y=arguments[1];return new I(arguments[0]).getResultGeometry(y)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof it&&typeof arguments[1]=="number"){var _=arguments[1],P=arguments[2],$=new I(arguments[0]);return $.setQuadrantSegments(P),$.getResultGeometry(_)}if(arguments[2]instanceof N&&arguments[0]instanceof it&&typeof arguments[1]=="number"){var ne=arguments[1];return new I(arguments[0],arguments[2]).getResultGeometry(ne)}}else if(arguments.length===4){var ve=arguments[1],Oe=arguments[2],tt=arguments[3],ft=new I(arguments[0]);return ft.setQuadrantSegments(Oe),ft.setEndCapStyle(tt),ft.getResultGeometry(ve)}}},{key:"precisionScaleFactor",value:function(y,_,P){var $=y.getEnvelopeInternal(),ne=$r.max(Math.abs($.getMaxX()),Math.abs($.getMaxY()),Math.abs($.getMinX()),Math.abs($.getMinY()))+2*(_>0?_:0),ve=P-Math.trunc(Math.log(ne)/Math.log(10)+1);return Math.pow(10,ve)}}])})();mr.CAP_ROUND=N.CAP_ROUND,mr.CAP_BUTT=N.CAP_FLAT,mr.CAP_FLAT=N.CAP_FLAT,mr.CAP_SQUARE=N.CAP_SQUARE,mr.MAX_PRECISION_DIGITS=12;var hn=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],In=(function(){return o((function I(y){i(this,I),this.geometryFactory=y||new Aa}),[{key:"read",value:function(I){var y,_=(y=typeof I=="string"?JSON.parse(I):I).type;if(!vi[_])throw new Error("Unknown GeoJSON type: "+y.type);return hn.indexOf(_)!==-1?vi[_].call(this,y.coordinates):_==="GeometryCollection"?vi[_].call(this,y.geometries):vi[_].call(this,y)}},{key:"write",value:function(I){var y=I.getGeometryType();if(!Pn[y])throw new Error("Geometry is not supported");return Pn[y].call(this,I)}}])})(),vi={Feature:function(I){var y={};for(var _ in I)y[_]=I[_];if(I.geometry){var P=I.geometry.type;if(!vi[P])throw new Error("Unknown GeoJSON type: "+I.type);y.geometry=this.read(I.geometry)}return I.bbox&&(y.bbox=vi.bbox.call(this,I.bbox)),y},FeatureCollection:function(I){var y={};if(I.features){y.features=[];for(var _=0;_<I.features.length;++_)y.features.push(this.read(I.features[_]))}return I.bbox&&(y.bbox=this.parse.bbox.call(this,I.bbox)),y},coordinates:function(I){for(var y=[],_=0;_<I.length;++_){var P=I[_];y.push(a(Be,T(P)))}return y},bbox:function(I){return this.geometryFactory.createLinearRing([new Be(I[0],I[1]),new Be(I[2],I[1]),new Be(I[2],I[3]),new Be(I[0],I[3]),new Be(I[0],I[1])])},Point:function(I){var y=a(Be,T(I));return this.geometryFactory.createPoint(y)},MultiPoint:function(I){for(var y=[],_=0;_<I.length;++_)y.push(vi.Point.call(this,I[_]));return this.geometryFactory.createMultiPoint(y)},LineString:function(I){var y=vi.coordinates.call(this,I);return this.geometryFactory.createLineString(y)},MultiLineString:function(I){for(var y=[],_=0;_<I.length;++_)y.push(vi.LineString.call(this,I[_]));return this.geometryFactory.createMultiLineString(y)},Polygon:function(I){for(var y=vi.coordinates.call(this,I[0]),_=this.geometryFactory.createLinearRing(y),P=[],$=1;$<I.length;++$){var ne=I[$],ve=vi.coordinates.call(this,ne),Oe=this.geometryFactory.createLinearRing(ve);P.push(Oe)}return this.geometryFactory.createPolygon(_,P)},MultiPolygon:function(I){for(var y=[],_=0;_<I.length;++_){var P=I[_];y.push(vi.Polygon.call(this,P))}return this.geometryFactory.createMultiPolygon(y)},GeometryCollection:function(I){for(var y=[],_=0;_<I.length;++_){var P=I[_];y.push(this.read(P))}return this.geometryFactory.createGeometryCollection(y)}},Pn={coordinate:function(I){var y=[I.x,I.y];return I.z&&y.push(I.z),I.m&&y.push(I.m),y},Point:function(I){return{type:"Point",coordinates:Pn.coordinate.call(this,I.getCoordinate())}},MultiPoint:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=Pn.Point.call(this,P);y.push($.coordinates)}return{type:"MultiPoint",coordinates:y}},LineString:function(I){for(var y=[],_=I.getCoordinates(),P=0;P<_.length;++P){var $=_[P];y.push(Pn.coordinate.call(this,$))}return{type:"LineString",coordinates:y}},MultiLineString:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=Pn.LineString.call(this,P);y.push($.coordinates)}return{type:"MultiLineString",coordinates:y}},Polygon:function(I){var y=[],_=Pn.LineString.call(this,I._shell);y.push(_.coordinates);for(var P=0;P<I._holes.length;++P){var $=I._holes[P],ne=Pn.LineString.call(this,$);y.push(ne.coordinates)}return{type:"Polygon",coordinates:y}},MultiPolygon:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=Pn.Polygon.call(this,P);y.push($.coordinates)}return{type:"MultiPolygon",coordinates:y}},GeometryCollection:function(I){for(var y=[],_=0;_<I._geometries.length;++_){var P=I._geometries[_],$=P.getGeometryType();y.push(Pn[$].call(this,P))}return{type:"GeometryCollection",geometries:y}}};return{BufferOp:mr,GeoJSONReader:(function(){return o((function I(y){i(this,I),this.parser=new In(y||new Aa)}),[{key:"read",value:function(I){return this.parser.read(I)}}])})(),GeoJSONWriter:(function(){return o((function I(){i(this,I),this.parser=new In(this.geometryFactory)}),[{key:"write",value:function(I){return this.parser.write(I)}}])})()}}))})(dS)),dS.exports}var gwe=pwe();const mwe=Cd(gwe);function jg(){return new lE}function lE(){this.reset()}lE.prototype={constructor:lE,reset:function(){this.s=this.t=0},add:function(t){_j(vw,t,this.t),_j(this,vw.s,this.s),this.s?this.t+=vw.t:this.s=vw.t},valueOf:function(){return this.s}};var vw=new lE;function _j(t,e,r){var n=t.s=e+r,i=n-e,a=n-i;t.t=e-a+(r-i)}var zo=1e-6,Oa=Math.PI,hd=Oa/2,bj=Oa/4,Sd=Oa*2,Jp=180/Oa,Pf=Oa/180,au=Math.abs,ywe=Math.atan,W0=Math.atan2,ws=Math.cos,Ss=Math.sin,__=Math.sqrt;function oJ(t){return t>1?0:t<-1?Oa:Math.acos(t)}function ry(t){return t>1?hd:t<-1?-hd:Math.asin(t)}function F1(){}function uE(t,e){t&&wj.hasOwnProperty(t.type)&&wj[t.type](t,e)}var xj={Feature:function(t,e){uE(t.geometry,e)},FeatureCollection:function(t,e){for(var r=t.features,n=-1,i=r.length;++n<i;)uE(r[n].geometry,e)}},wj={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)t=r[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){Pk(t.coordinates,e,0)},MultiLineString:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)Pk(r[n],e,0)},Polygon:function(t,e){Sj(t.coordinates,e)},MultiPolygon:function(t,e){for(var r=t.coordinates,n=-1,i=r.length;++n<i;)Sj(r[n],e)},GeometryCollection:function(t,e){for(var r=t.geometries,n=-1,i=r.length;++n<i;)uE(r[n],e)}};function Pk(t,e,r){var n=-1,i=t.length-r,a;for(e.lineStart();++n<i;)a=t[n],e.point(a[0],a[1],a[2]);e.lineEnd()}function Sj(t,e){var r=-1,n=t.length;for(e.polygonStart();++r<n;)Pk(t[r],e,1);e.polygonEnd()}function vwe(t,e){t&&xj.hasOwnProperty(t.type)?xj[t.type](t,e):uE(t,e)}jg();jg();function Mk(t){return[W0(t[1],t[0]),ry(t[2])]}function X0(t){var e=t[0],r=t[1],n=ws(r);return[n*ws(e),n*Ss(e),Ss(r)]}function _w(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function cE(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function s5(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function bw(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function kk(t){var e=__(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}jg();function sJ(t,e){function r(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(r.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),r}function Rk(t,e){return[t>Oa?t-Sd:t<-Oa?t+Sd:t,e]}Rk.invert=Rk;function _we(t,e,r){return(t%=Sd)?e||r?sJ(Tj(t),Cj(e,r)):Tj(t):e||r?Cj(e,r):Rk}function Ej(t){return function(e,r){return e+=t,[e>Oa?e-Sd:e<-Oa?e+Sd:e,r]}}function Tj(t){var e=Ej(t);return e.invert=Ej(-t),e}function Cj(t,e){var r=ws(t),n=Ss(t),i=ws(e),a=Ss(e);function s(o,c){var f=ws(c),d=ws(o)*f,m=Ss(o)*f,b=Ss(c),x=b*r+d*n;return[W0(m*i-x*a,d*r-b*n),ry(x*i+m*a)]}return s.invert=function(o,c){var f=ws(c),d=ws(o)*f,m=Ss(o)*f,b=Ss(c),x=b*i-m*a;return[W0(m*i+b*a,d*r+x*n),ry(x*r-d*n)]},s}function bwe(t,e,r,n,i,a){if(r){var s=ws(e),o=Ss(e),c=n*r;i==null?(i=e+n*Sd,a=e-c/2):(i=Aj(s,i),a=Aj(s,a),(n>0?i<a:i>a)&&(i+=n*Sd));for(var f,d=i;n>0?d>a:d<a;d-=c)f=Mk([s,-o*ws(d),-o*Ss(d)]),t.point(f[0],f[1])}}function Aj(t,e){e=X0(e),e[0]-=t,kk(e);var r=oJ(-e[1]);return((-e[2]<0?-r:r)+Sd-zo)%Sd}function lJ(){var t=[],e;return{point:function(r,n){e.push([r,n])},lineStart:function(){t.push(e=[])},lineEnd:F1,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],e=null,r}}}function xwe(t,e,r,n,i,a){var s=t[0],o=t[1],c=e[0],f=e[1],d=0,m=1,b=c-s,x=f-o,E;if(E=r-s,!(!b&&E>0)){if(E/=b,b<0){if(E<d)return;E<m&&(m=E)}else if(b>0){if(E>m)return;E>d&&(d=E)}if(E=i-s,!(!b&&E<0)){if(E/=b,b<0){if(E>m)return;E>d&&(d=E)}else if(b>0){if(E<d)return;E<m&&(m=E)}if(E=n-o,!(!x&&E>0)){if(E/=x,x<0){if(E<d)return;E<m&&(m=E)}else if(x>0){if(E>m)return;E>d&&(d=E)}if(E=a-o,!(!x&&E<0)){if(E/=x,x<0){if(E>m)return;E>d&&(d=E)}else if(x>0){if(E<d)return;E<m&&(m=E)}return d>0&&(t[0]=s+d*b,t[1]=o+d*x),m<1&&(e[0]=s+m*b,e[1]=o+m*x),!0}}}}}function pS(t,e){return au(t[0]-e[0])<zo&&au(t[1]-e[1])<zo}function xw(t,e,r,n){this.x=t,this.z=e,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}function uJ(t,e,r,n,i){var a=[],s=[],o,c;if(t.forEach(function(E){if(!((T=E.length-1)<=0)){var T,A=E[0],R=E[T],F;if(pS(A,R)){for(i.lineStart(),o=0;o<T;++o)i.point((A=E[o])[0],A[1]);i.lineEnd();return}a.push(F=new xw(A,E,null,!0)),s.push(F.o=new xw(A,null,F,!1)),a.push(F=new xw(R,E,null,!1)),s.push(F.o=new xw(R,null,F,!0))}}),!!a.length){for(s.sort(e),Ij(a),Ij(s),o=0,c=s.length;o<c;++o)s[o].e=r=!r;for(var f=a[0],d,m;;){for(var b=f,x=!0;b.v;)if((b=b.n)===f)return;d=b.z,i.lineStart();do{if(b.v=b.o.v=!0,b.e){if(x)for(o=0,c=d.length;o<c;++o)i.point((m=d[o])[0],m[1]);else n(b.x,b.n.x,1,i);b=b.n}else{if(x)for(d=b.p.z,o=d.length-1;o>=0;--o)i.point((m=d[o])[0],m[1]);else n(b.x,b.p.x,-1,i);b=b.p}b=b.o,d=b.z,x=!x}while(!b.v);i.lineEnd()}}}function Ij(t){if(e=t.length){for(var e,r=0,n=t[0],i;++r<e;)n.n=i=t[r],i.p=n,n=i;n.n=i=t[0],i.p=n}}function cJ(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function wwe(t){return t.length===1&&(t=Swe(t)),{left:function(e,r,n,i){for(n==null&&(n=0),i==null&&(i=e.length);n<i;){var a=n+i>>>1;t(e[a],r)<0?n=a+1:i=a}return n},right:function(e,r,n,i){for(n==null&&(n=0),i==null&&(i=e.length);n<i;){var a=n+i>>>1;t(e[a],r)>0?i=a:n=a+1}return n}}}function Swe(t){return function(e,r){return cJ(t(e),r)}}wwe(cJ);function fJ(t){for(var e=t.length,r,n=-1,i=0,a,s;++n<e;)i+=t[n].length;for(a=new Array(i);--e>=0;)for(s=t[e],r=s.length;--r>=0;)a[--i]=s[r];return a}var B1=1e9,ww=-B1;function Ewe(t,e,r,n){function i(f,d){return t<=f&&f<=r&&e<=d&&d<=n}function a(f,d,m,b){var x=0,E=0;if(f==null||(x=s(f,m))!==(E=s(d,m))||c(f,d)<0^m>0)do b.point(x===0||x===3?t:r,x>1?n:e);while((x=(x+m+4)%4)!==E);else b.point(d[0],d[1])}function s(f,d){return au(f[0]-t)<zo?d>0?0:3:au(f[0]-r)<zo?d>0?2:1:au(f[1]-e)<zo?d>0?1:0:d>0?3:2}function o(f,d){return c(f.x,d.x)}function c(f,d){var m=s(f,1),b=s(d,1);return m!==b?m-b:m===0?d[1]-f[1]:m===1?f[0]-d[0]:m===2?f[1]-d[1]:d[0]-f[0]}return function(f){var d=f,m=lJ(),b,x,E,T,A,R,F,N,O,U,j,H={point:W,lineStart:G,lineEnd:ae,polygonStart:oe,polygonEnd:ee};function W(fe,pe){i(fe,pe)&&d.point(fe,pe)}function X(){for(var fe=0,pe=0,De=x.length;pe<De;++pe)for(var ye=x[pe],we=1,Te=ye.length,Re=ye[0],de,Ee,xe=Re[0],Ne=Re[1];we<Te;++we)de=xe,Ee=Ne,Re=ye[we],xe=Re[0],Ne=Re[1],Ee<=n?Ne>n&&(xe-de)*(n-Ee)>(Ne-Ee)*(t-de)&&++fe:Ne<=n&&(xe-de)*(n-Ee)<(Ne-Ee)*(t-de)&&--fe;return fe}function oe(){d=m,b=[],x=[],j=!0}function ee(){var fe=X(),pe=j&&fe,De=(b=fJ(b)).length;(pe||De)&&(f.polygonStart(),pe&&(f.lineStart(),a(null,null,1,f),f.lineEnd()),De&&uJ(b,o,fe,a,f),f.polygonEnd()),d=f,b=x=E=null}function G(){H.point=se,x&&x.push(E=[]),U=!0,O=!1,F=N=NaN}function ae(){b&&(se(T,A),R&&O&&m.rejoin(),b.push(m.result())),H.point=W,O&&d.lineEnd()}function se(fe,pe){var De=i(fe,pe);if(x&&E.push([fe,pe]),U)T=fe,A=pe,R=De,U=!1,De&&(d.lineStart(),d.point(fe,pe));else if(De&&O)d.point(fe,pe);else{var ye=[F=Math.max(ww,Math.min(B1,F)),N=Math.max(ww,Math.min(B1,N))],we=[fe=Math.max(ww,Math.min(B1,fe)),pe=Math.max(ww,Math.min(B1,pe))];xwe(ye,we,t,e,r,n)?(O||(d.lineStart(),d.point(ye[0],ye[1])),d.point(we[0],we[1]),De||d.lineEnd(),j=!1):De&&(d.lineStart(),d.point(fe,pe),j=!1)}F=fe,N=pe,O=De}return H}}var l5=jg();function Twe(t,e){var r=e[0],n=e[1],i=[Ss(r),-ws(r),0],a=0,s=0;l5.reset();for(var o=0,c=t.length;o<c;++o)if(d=(f=t[o]).length)for(var f,d,m=f[d-1],b=m[0],x=m[1]/2+bj,E=Ss(x),T=ws(x),A=0;A<d;++A,b=F,E=O,T=U,m=R){var R=f[A],F=R[0],N=R[1]/2+bj,O=Ss(N),U=ws(N),j=F-b,H=j>=0?1:-1,W=H*j,X=W>Oa,oe=E*O;if(l5.add(W0(oe*H*Ss(W),T*U+oe*ws(W))),a+=X?j+H*Sd:j,X^b>=r^F>=r){var ee=cE(X0(m),X0(R));kk(ee);var G=cE(i,ee);kk(G);var ae=(X^j>=0?-1:1)*ry(G[2]);(n>ae||n===ae&&(ee[0]||ee[1]))&&(s+=X^j>=0?1:-1)}}return(a<-zo||a<zo&&l5<-zo)^s&1}jg();function Pj(t){return t}jg();jg();var Y0=1/0,fE=Y0,Xb=-Y0,hE=Xb,Mj={point:Cwe,lineStart:F1,lineEnd:F1,polygonStart:F1,polygonEnd:F1,result:function(){var t=[[Y0,fE],[Xb,hE]];return Xb=hE=-(fE=Y0=1/0),t}};function Cwe(t,e){t<Y0&&(Y0=t),t>Xb&&(Xb=t),e<fE&&(fE=e),e>hE&&(hE=e)}jg();function hJ(t,e,r,n){return function(i,a){var s=e(a),o=i.invert(n[0],n[1]),c=lJ(),f=e(c),d=!1,m,b,x,E={point:T,lineStart:R,lineEnd:F,polygonStart:function(){E.point=N,E.lineStart=O,E.lineEnd=U,b=[],m=[]},polygonEnd:function(){E.point=T,E.lineStart=R,E.lineEnd=F,b=fJ(b);var j=Twe(m,o);b.length?(d||(a.polygonStart(),d=!0),uJ(b,Iwe,j,r,a)):j&&(d||(a.polygonStart(),d=!0),a.lineStart(),r(null,null,1,a),a.lineEnd()),d&&(a.polygonEnd(),d=!1),b=m=null},sphere:function(){a.polygonStart(),a.lineStart(),r(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function T(j,H){var W=i(j,H);t(j=W[0],H=W[1])&&a.point(j,H)}function A(j,H){var W=i(j,H);s.point(W[0],W[1])}function R(){E.point=A,s.lineStart()}function F(){E.point=T,s.lineEnd()}function N(j,H){x.push([j,H]);var W=i(j,H);f.point(W[0],W[1])}function O(){f.lineStart(),x=[]}function U(){N(x[0][0],x[0][1]),f.lineEnd();var j=f.clean(),H=c.result(),W,X=H.length,oe,ee,G;if(x.pop(),m.push(x),x=null,!!X){if(j&1){if(ee=H[0],(oe=ee.length-1)>0){for(d||(a.polygonStart(),d=!0),a.lineStart(),W=0;W<oe;++W)a.point((G=ee[W])[0],G[1]);a.lineEnd()}return}X>1&&j&2&&H.push(H.pop().concat(H.shift())),b.push(H.filter(Awe))}}return E}}function Awe(t){return t.length>1}function Iwe(t,e){return((t=t.x)[0]<0?t[1]-hd-zo:hd-t[1])-((e=e.x)[0]<0?e[1]-hd-zo:hd-e[1])}const kj=hJ(function(){return!0},Pwe,kwe,[-Oa,-hd]);function Pwe(t){var e=NaN,r=NaN,n=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(a,s){var o=a>0?Oa:-Oa,c=au(a-e);au(c-Oa)<zo?(t.point(e,r=(r+s)/2>0?hd:-hd),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),t.point(a,r),i=0):n!==o&&c>=Oa&&(au(e-n)<zo&&(e-=n*zo),au(a-o)<zo&&(a-=o*zo),r=Mwe(e,r,a,s),t.point(n,r),t.lineEnd(),t.lineStart(),t.point(o,r),i=0),t.point(e=a,r=s),n=o},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-i}}}function Mwe(t,e,r,n){var i,a,s=Ss(t-r);return au(s)>zo?ywe((Ss(e)*(a=ws(n))*Ss(r)-Ss(n)*(i=ws(e))*Ss(t))/(i*a*s)):(e+n)/2}function kwe(t,e,r,n){var i;if(t==null)i=r*hd,n.point(-Oa,i),n.point(0,i),n.point(Oa,i),n.point(Oa,0),n.point(Oa,-i),n.point(0,-i),n.point(-Oa,-i),n.point(-Oa,0),n.point(-Oa,i);else if(au(t[0]-e[0])>zo){var a=t[0]<e[0]?Oa:-Oa;i=r*a/2,n.point(-a,i),n.point(0,i),n.point(a,i)}else n.point(e[0],e[1])}function Rwe(t,e){var r=ws(t),n=r>0,i=au(r)>zo;function a(d,m,b,x){bwe(x,t,e,b,d,m)}function s(d,m){return ws(d)*ws(m)>r}function o(d){var m,b,x,E,T;return{lineStart:function(){E=x=!1,T=1},point:function(A,R){var F=[A,R],N,O=s(A,R),U=n?O?0:f(A,R):O?f(A+(A<0?Oa:-Oa),R):0;if(!m&&(E=x=O)&&d.lineStart(),O!==x&&(N=c(m,F),(!N||pS(m,N)||pS(F,N))&&(F[0]+=zo,F[1]+=zo,O=s(F[0],F[1]))),O!==x)T=0,O?(d.lineStart(),N=c(F,m),d.point(N[0],N[1])):(N=c(m,F),d.point(N[0],N[1]),d.lineEnd()),m=N;else if(i&&m&&n^O){var j;!(U&b)&&(j=c(F,m,!0))&&(T=0,n?(d.lineStart(),d.point(j[0][0],j[0][1]),d.point(j[1][0],j[1][1]),d.lineEnd()):(d.point(j[1][0],j[1][1]),d.lineEnd(),d.lineStart(),d.point(j[0][0],j[0][1])))}O&&(!m||!pS(m,F))&&d.point(F[0],F[1]),m=F,x=O,b=U},lineEnd:function(){x&&d.lineEnd(),m=null},clean:function(){return T|(E&&x)<<1}}}function c(d,m,b){var x=X0(d),E=X0(m),T=[1,0,0],A=cE(x,E),R=_w(A,A),F=A[0],N=R-F*F;if(!N)return!b&&d;var O=r*R/N,U=-r*F/N,j=cE(T,A),H=bw(T,O),W=bw(A,U);s5(H,W);var X=j,oe=_w(H,X),ee=_w(X,X),G=oe*oe-ee*(_w(H,H)-1);if(!(G<0)){var ae=__(G),se=bw(X,(-oe-ae)/ee);if(s5(se,H),se=Mk(se),!b)return se;var fe=d[0],pe=m[0],De=d[1],ye=m[1],we;pe<fe&&(we=fe,fe=pe,pe=we);var Te=pe-fe,Re=au(Te-Oa)<zo,de=Re||Te<zo;if(!Re&&ye<De&&(we=De,De=ye,ye=we),de?Re?De+ye>0^se[1]<(au(se[0]-fe)<zo?De:ye):De<=se[1]&&se[1]<=ye:Te>Oa^(fe<=se[0]&&se[0]<=pe)){var Ee=bw(X,(-oe+ae)/ee);return s5(Ee,H),[se,Mk(Ee)]}}}function f(d,m){var b=n?t:Oa-t,x=0;return d<-b?x|=1:d>b&&(x|=2),m<-b?x|=4:m>b&&(x|=8),x}return hJ(s,o,a,n?[0,-t]:[-Oa,t-Oa])}function dJ(t){return function(e){var r=new Dk;for(var n in t)r[n]=t[n];return r.stream=e,r}}function Dk(){}Dk.prototype={constructor:Dk,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function pJ(t,e,r){var n=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),a!=null&&t.clipExtent(null),vwe(r,t.stream(Mj));var s=Mj.result(),o=Math.min(n/(s[1][0]-s[0][0]),i/(s[1][1]-s[0][1])),c=+e[0][0]+(n-o*(s[1][0]+s[0][0]))/2,f=+e[0][1]+(i-o*(s[1][1]+s[0][1]))/2;return a!=null&&t.clipExtent(a),t.scale(o*150).translate([c,f])}function Dwe(t,e,r){return pJ(t,[[0,0],e],r)}var Rj=16,Owe=ws(30*Pf);function Dj(t,e){return+e?Nwe(t,e):Lwe(t)}function Lwe(t){return dJ({point:function(e,r){e=t(e,r),this.stream.point(e[0],e[1])}})}function Nwe(t,e){function r(n,i,a,s,o,c,f,d,m,b,x,E,T,A){var R=f-n,F=d-i,N=R*R+F*F;if(N>4*e&&T--){var O=s+b,U=o+x,j=c+E,H=__(O*O+U*U+j*j),W=ry(j/=H),X=au(au(j)-1)<zo||au(a-m)<zo?(a+m)/2:W0(U,O),oe=t(X,W),ee=oe[0],G=oe[1],ae=ee-n,se=G-i,fe=F*ae-R*se;(fe*fe/N>e||au((R*ae+F*se)/N-.5)>.3||s*b+o*x+c*E<Owe)&&(r(n,i,a,s,o,c,ee,G,X,O/=H,U/=H,j,T,A),A.point(ee,G),r(ee,G,X,O,U,j,f,d,m,b,x,E,T,A))}}return function(n){var i,a,s,o,c,f,d,m,b,x,E,T,A={point:R,lineStart:F,lineEnd:O,polygonStart:function(){n.polygonStart(),A.lineStart=U},polygonEnd:function(){n.polygonEnd(),A.lineStart=F}};function R(W,X){W=t(W,X),n.point(W[0],W[1])}function F(){m=NaN,A.point=N,n.lineStart()}function N(W,X){var oe=X0([W,X]),ee=t(W,X);r(m,b,d,x,E,T,m=ee[0],b=ee[1],d=W,x=oe[0],E=oe[1],T=oe[2],Rj,n),n.point(m,b)}function O(){A.point=R,n.lineEnd()}function U(){F(),A.point=j,A.lineEnd=H}function j(W,X){N(i=W,X),a=m,s=b,o=x,c=E,f=T,A.point=N}function H(){r(m,b,d,x,E,T,a,s,i,o,c,f,Rj,n),A.lineEnd=O,O()}return A}}var Fwe=dJ({point:function(t,e){this.stream.point(t*Pf,e*Pf)}});function Bwe(t){return zwe(function(){return t})()}function zwe(t){var e,r=150,n=480,i=250,a,s,o=0,c=0,f=0,d=0,m=0,b,x,E=null,T=kj,A=null,R,F,N,O=Pj,U=.5,j=Dj(ee,U),H,W;function X(se){return se=x(se[0]*Pf,se[1]*Pf),[se[0]*r+a,s-se[1]*r]}function oe(se){return se=x.invert((se[0]-a)/r,(s-se[1])/r),se&&[se[0]*Jp,se[1]*Jp]}function ee(se,fe){return se=e(se,fe),[se[0]*r+a,s-se[1]*r]}X.stream=function(se){return H&&W===se?H:H=Fwe(T(b,j(O(W=se))))},X.clipAngle=function(se){return arguments.length?(T=+se?Rwe(E=se*Pf,6*Pf):(E=null,kj),ae()):E*Jp},X.clipExtent=function(se){return arguments.length?(O=se==null?(A=R=F=N=null,Pj):Ewe(A=+se[0][0],R=+se[0][1],F=+se[1][0],N=+se[1][1]),ae()):A==null?null:[[A,R],[F,N]]},X.scale=function(se){return arguments.length?(r=+se,G()):r},X.translate=function(se){return arguments.length?(n=+se[0],i=+se[1],G()):[n,i]},X.center=function(se){return arguments.length?(o=se[0]%360*Pf,c=se[1]%360*Pf,G()):[o*Jp,c*Jp]},X.rotate=function(se){return arguments.length?(f=se[0]%360*Pf,d=se[1]%360*Pf,m=se.length>2?se[2]%360*Pf:0,G()):[f*Jp,d*Jp,m*Jp]},X.precision=function(se){return arguments.length?(j=Dj(ee,U=se*se),ae()):__(U)},X.fitExtent=function(se,fe){return pJ(X,se,fe)},X.fitSize=function(se,fe){return Dwe(X,se,fe)};function G(){x=sJ(b=_we(f,d,m),e);var se=e(o,c);return a=n-se[0]*r,s=i+se[1]*r,ae()}function ae(){return H=W=null,X}return function(){return e=t.apply(this,arguments),X.invert=e.invert&&oe,G()}}function gJ(t){return function(e,r){var n=ws(e),i=ws(r),a=t(n*i);return[a*i*Ss(e),a*Ss(r)]}}function mJ(t){return function(e,r){var n=__(e*e+r*r),i=t(n),a=Ss(i),s=ws(i);return[W0(e*a,n*s),ry(n&&r*a/n)]}}var jwe=gJ(function(t){return __(2/(1+t))});jwe.invert=mJ(function(t){return 2*ry(t/2)});var yJ=gJ(function(t){return(t=oJ(t))&&t/Ss(t)});yJ.invert=mJ(function(t){return t});function Uwe(){return Bwe(yJ).scale(79.4188).clipAngle(180-.001)}function Oj(t,e){return[t,e]}Oj.invert=Oj;var{BufferOp:Vwe,GeoJSONReader:$we,GeoJSONWriter:qwe}=mwe;function Hwe(t,e,r){r=r||{};var n=r.units||"kilometers",i=r.steps||8;if(!t)throw new Error("geojson is required");if(typeof r!="object")throw new Error("options must be an object");if(typeof i!="number")throw new Error("steps must be an number");if(e===void 0)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var a=[];switch(t.type){case"GeometryCollection":return h3(t,function(s){var o=gS(s,e,n,i);o&&a.push(o)}),xp(a);case"FeatureCollection":return fj(t,function(s){var o=gS(s,e,n,i);o&&fj(o,function(c){c&&a.push(c)})}),xp(a)}return gS(t,e,n,i)}function gS(t,e,r,n){var i=t.properties||{},a=t.type==="Feature"?t.geometry:t;if(a.type==="GeometryCollection"){var s=[];return h3(t,function(T){var A=gS(T,e,r,n);A&&s.push(A)}),xp(s)}var o=Gwe(a),c={type:a.type,coordinates:_J(a.coordinates,o)},f=new $we,d=f.read(c),m=tJ(nL(e,r),"meters"),b=Vwe.bufferOp(d,m,n),x=new qwe;if(b=x.write(b),!vJ(b.coordinates)){var E={type:b.type,coordinates:bJ(b.coordinates,o)};return ty(E,i)}}function vJ(t){return Array.isArray(t[0])?vJ(t[0]):isNaN(t[0])}function _J(t,e){return typeof t[0]!="object"?e(t):t.map(function(r){return _J(r,e)})}function bJ(t,e){return typeof t[0]!="object"?e.invert(t):t.map(function(r){return bJ(r,e)})}function Gwe(t){var e=hwe(t).geometry.coordinates,r=[-e[0],-e[1]];return Uwe().rotate(r).scale(Ku)}function Lj(t,e={}){let r=0,n=0,i=0;return v_(t,function(a){r+=a[0],n+=a[1],i++},!0),Xf([r/i,n/i],e.properties)}var Sw={exports:{}},mS={exports:{}},Wwe=mS.exports,Nj;function Xwe(){return Nj||(Nj=1,(function(t,e){(function(r,n){t.exports=n()})(Wwe,function(){function r(F,N,O,U,j){(function H(W,X,oe,ee,G){for(;ee>oe;){if(ee-oe>600){var ae=ee-oe+1,se=X-oe+1,fe=Math.log(ae),pe=.5*Math.exp(2*fe/3),De=.5*Math.sqrt(fe*pe*(ae-pe)/ae)*(se-ae/2<0?-1:1),ye=Math.max(oe,Math.floor(X-se*pe/ae+De)),we=Math.min(ee,Math.floor(X+(ae-se)*pe/ae+De));H(W,X,ye,we,G)}var Te=W[X],Re=oe,de=ee;for(n(W,oe,X),G(W[ee],Te)>0&&n(W,oe,ee);Re<de;){for(n(W,Re,de),Re++,de--;G(W[Re],Te)<0;)Re++;for(;G(W[de],Te)>0;)de--}G(W[oe],Te)===0?n(W,oe,de):n(W,++de,ee),de<=X&&(oe=de+1),X<=de&&(ee=de-1)}})(F,N,O||0,U||F.length-1,j||i)}function n(F,N,O){var U=F[N];F[N]=F[O],F[O]=U}function i(F,N){return F<N?-1:F>N?1:0}var a=function(F){F===void 0&&(F=9),this._maxEntries=Math.max(4,F),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(F,N,O){if(!O)return N.indexOf(F);for(var U=0;U<N.length;U++)if(O(F,N[U]))return U;return-1}function o(F,N){c(F,0,F.children.length,N,F)}function c(F,N,O,U,j){j||(j=A(null)),j.minX=1/0,j.minY=1/0,j.maxX=-1/0,j.maxY=-1/0;for(var H=N;H<O;H++){var W=F.children[H];f(j,F.leaf?U(W):W)}return j}function f(F,N){return F.minX=Math.min(F.minX,N.minX),F.minY=Math.min(F.minY,N.minY),F.maxX=Math.max(F.maxX,N.maxX),F.maxY=Math.max(F.maxY,N.maxY),F}function d(F,N){return F.minX-N.minX}function m(F,N){return F.minY-N.minY}function b(F){return(F.maxX-F.minX)*(F.maxY-F.minY)}function x(F){return F.maxX-F.minX+(F.maxY-F.minY)}function E(F,N){return F.minX<=N.minX&&F.minY<=N.minY&&N.maxX<=F.maxX&&N.maxY<=F.maxY}function T(F,N){return N.minX<=F.maxX&&N.minY<=F.maxY&&N.maxX>=F.minX&&N.maxY>=F.minY}function A(F){return{children:F,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function R(F,N,O,U,j){for(var H=[N,O];H.length;)if(!((O=H.pop())-(N=H.pop())<=U)){var W=N+Math.ceil((O-N)/U/2)*U;r(F,W,N,O,j),H.push(N,W,W,O)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(F){var N=this.data,O=[];if(!T(F,N))return O;for(var U=this.toBBox,j=[];N;){for(var H=0;H<N.children.length;H++){var W=N.children[H],X=N.leaf?U(W):W;T(F,X)&&(N.leaf?O.push(W):E(F,X)?this._all(W,O):j.push(W))}N=j.pop()}return O},a.prototype.collides=function(F){var N=this.data;if(!T(F,N))return!1;for(var O=[];N;){for(var U=0;U<N.children.length;U++){var j=N.children[U],H=N.leaf?this.toBBox(j):j;if(T(F,H)){if(N.leaf||E(F,H))return!0;O.push(j)}}N=O.pop()}return!1},a.prototype.load=function(F){if(!F||!F.length)return this;if(F.length<this._minEntries){for(var N=0;N<F.length;N++)this.insert(F[N]);return this}var O=this._build(F.slice(),0,F.length-1,0);if(this.data.children.length)if(this.data.height===O.height)this._splitRoot(this.data,O);else{if(this.data.height<O.height){var U=this.data;this.data=O,O=U}this._insert(O,this.data.height-O.height-1,!0)}else this.data=O;return this},a.prototype.insert=function(F){return F&&this._insert(F,this.data.height-1),this},a.prototype.clear=function(){return this.data=A([]),this},a.prototype.remove=function(F,N){if(!F)return this;for(var O,U,j,H=this.data,W=this.toBBox(F),X=[],oe=[];H||X.length;){if(H||(H=X.pop(),U=X[X.length-1],O=oe.pop(),j=!0),H.leaf){var ee=s(F,H.children,N);if(ee!==-1)return H.children.splice(ee,1),X.push(H),this._condense(X),this}j||H.leaf||!E(H,W)?U?(O++,H=U.children[O],j=!1):H=null:(X.push(H),oe.push(O),O=0,U=H,H=H.children[0])}return this},a.prototype.toBBox=function(F){return F},a.prototype.compareMinX=function(F,N){return F.minX-N.minX},a.prototype.compareMinY=function(F,N){return F.minY-N.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(F){return this.data=F,this},a.prototype._all=function(F,N){for(var O=[];F;)F.leaf?N.push.apply(N,F.children):O.push.apply(O,F.children),F=O.pop();return N},a.prototype._build=function(F,N,O,U){var j,H=O-N+1,W=this._maxEntries;if(H<=W)return o(j=A(F.slice(N,O+1)),this.toBBox),j;U||(U=Math.ceil(Math.log(H)/Math.log(W)),W=Math.ceil(H/Math.pow(W,U-1))),(j=A([])).leaf=!1,j.height=U;var X=Math.ceil(H/W),oe=X*Math.ceil(Math.sqrt(W));R(F,N,O,oe,this.compareMinX);for(var ee=N;ee<=O;ee+=oe){var G=Math.min(ee+oe-1,O);R(F,ee,G,X,this.compareMinY);for(var ae=ee;ae<=G;ae+=X){var se=Math.min(ae+X-1,G);j.children.push(this._build(F,ae,se,U-1))}}return o(j,this.toBBox),j},a.prototype._chooseSubtree=function(F,N,O,U){for(;U.push(N),!N.leaf&&U.length-1!==O;){for(var j=1/0,H=1/0,W=void 0,X=0;X<N.children.length;X++){var oe=N.children[X],ee=b(oe),G=(ae=F,se=oe,(Math.max(se.maxX,ae.maxX)-Math.min(se.minX,ae.minX))*(Math.max(se.maxY,ae.maxY)-Math.min(se.minY,ae.minY))-ee);G<H?(H=G,j=ee<j?ee:j,W=oe):G===H&&ee<j&&(j=ee,W=oe)}N=W||N.children[0]}var ae,se;return N},a.prototype._insert=function(F,N,O){var U=O?F:this.toBBox(F),j=[],H=this._chooseSubtree(U,this.data,N,j);for(H.children.push(F),f(H,U);N>=0&&j[N].children.length>this._maxEntries;)this._split(j,N),N--;this._adjustParentBBoxes(U,j,N)},a.prototype._split=function(F,N){var O=F[N],U=O.children.length,j=this._minEntries;this._chooseSplitAxis(O,j,U);var H=this._chooseSplitIndex(O,j,U),W=A(O.children.splice(H,O.children.length-H));W.height=O.height,W.leaf=O.leaf,o(O,this.toBBox),o(W,this.toBBox),N?F[N-1].children.push(W):this._splitRoot(O,W)},a.prototype._splitRoot=function(F,N){this.data=A([F,N]),this.data.height=F.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(F,N,O){for(var U,j,H,W,X,oe,ee,G=1/0,ae=1/0,se=N;se<=O-N;se++){var fe=c(F,0,se,this.toBBox),pe=c(F,se,O,this.toBBox),De=(j=fe,H=pe,W=void 0,X=void 0,oe=void 0,ee=void 0,W=Math.max(j.minX,H.minX),X=Math.max(j.minY,H.minY),oe=Math.min(j.maxX,H.maxX),ee=Math.min(j.maxY,H.maxY),Math.max(0,oe-W)*Math.max(0,ee-X)),ye=b(fe)+b(pe);De<G?(G=De,U=se,ae=ye<ae?ye:ae):De===G&&ye<ae&&(ae=ye,U=se)}return U||O-N},a.prototype._chooseSplitAxis=function(F,N,O){var U=F.leaf?this.compareMinX:d,j=F.leaf?this.compareMinY:m;this._allDistMargin(F,N,O,U)<this._allDistMargin(F,N,O,j)&&F.children.sort(U)},a.prototype._allDistMargin=function(F,N,O,U){F.children.sort(U);for(var j=this.toBBox,H=c(F,0,N,j),W=c(F,O-N,O,j),X=x(H)+x(W),oe=N;oe<O-N;oe++){var ee=F.children[oe];f(H,F.leaf?j(ee):ee),X+=x(H)}for(var G=O-N-1;G>=N;G--){var ae=F.children[G];f(W,F.leaf?j(ae):ae),X+=x(W)}return X},a.prototype._adjustParentBBoxes=function(F,N,O){for(var U=O;U>=0;U--)f(N[U],F)},a.prototype._condense=function(F){for(var N=F.length-1,O=void 0;N>=0;N--)F[N].children.length===0?N>0?(O=F[N-1].children).splice(O.indexOf(F[N]),1):this.clear():o(F[N],this.toBBox)},a})})(mS)),mS.exports}class Ywe{constructor(e=[],r=Zwe){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:n}=this,i=r[e];for(;e>0;){const a=e-1>>1,s=r[a];if(n(i,s)>=0)break;r[e]=s,e=a}r[e]=i}_down(e){const{data:r,compare:n}=this,i=this.length>>1,a=r[e];for(;e<i;){let s=(e<<1)+1,o=r[s];const c=s+1;if(c<this.length&&n(r[c],o)<0&&(s=c,o=r[c]),n(o,a)>=0)break;r[e]=o,e=s}r[e]=a}}function Zwe(t,e){return t<e?-1:t>e?1:0}const Kwe=Object.freeze(Object.defineProperty({__proto__:null,default:Ywe},Symbol.toStringTag,{value:"Module"})),Jwe=jW(Kwe);var l1={exports:{}},u5,Fj;function Qwe(){return Fj||(Fj=1,u5=function(e,r,n,i){var a=e[0],s=e[1],o=!1;n===void 0&&(n=0),i===void 0&&(i=r.length);for(var c=(i-n)/2,f=0,d=c-1;f<c;d=f++){var m=r[n+f*2+0],b=r[n+f*2+1],x=r[n+d*2+0],E=r[n+d*2+1],T=b>s!=E>s&&a<(x-m)*(s-b)/(E-b)+m;T&&(o=!o)}return o}),u5}var c5,Bj;function eSe(){return Bj||(Bj=1,c5=function(e,r,n,i){var a=e[0],s=e[1],o=!1;n===void 0&&(n=0),i===void 0&&(i=r.length);for(var c=i-n,f=0,d=c-1;f<c;d=f++){var m=r[f+n][0],b=r[f+n][1],x=r[d+n][0],E=r[d+n][1],T=b>s!=E>s&&a<(x-m)*(s-b)/(E-b)+m;T&&(o=!o)}return o}),c5}var zj;function tSe(){if(zj)return l1.exports;zj=1;var t=Qwe(),e=eSe();return l1.exports=function(n,i,a,s){return i.length>0&&Array.isArray(i[0])?e(n,i,a,s):t(n,i,a,s)},l1.exports.nested=e,l1.exports.flat=t,l1.exports}var z1={exports:{}},rSe=z1.exports,jj;function nSe(){return jj||(jj=1,(function(t,e){(function(r,n){n(e)})(rSe,function(r){const i=33306690738754706e-32;function a(T,A,R,F,N){let O,U,j,H,W=A[0],X=F[0],oe=0,ee=0;X>W==X>-W?(O=W,W=A[++oe]):(O=X,X=F[++ee]);let G=0;if(oe<T&&ee<R)for(X>W==X>-W?(j=O-((U=W+O)-W),W=A[++oe]):(j=O-((U=X+O)-X),X=F[++ee]),O=U,j!==0&&(N[G++]=j);oe<T&&ee<R;)X>W==X>-W?(j=O-((U=O+W)-(H=U-O))+(W-H),W=A[++oe]):(j=O-((U=O+X)-(H=U-O))+(X-H),X=F[++ee]),O=U,j!==0&&(N[G++]=j);for(;oe<T;)j=O-((U=O+W)-(H=U-O))+(W-H),W=A[++oe],O=U,j!==0&&(N[G++]=j);for(;ee<R;)j=O-((U=O+X)-(H=U-O))+(X-H),X=F[++ee],O=U,j!==0&&(N[G++]=j);return O===0&&G!==0||(N[G++]=O),G}function s(T){return new Float64Array(T)}const o=33306690738754716e-32,c=22204460492503146e-32,f=11093356479670487e-47,d=s(4),m=s(8),b=s(12),x=s(16),E=s(4);r.orient2d=function(T,A,R,F,N,O){const U=(A-O)*(R-N),j=(T-N)*(F-O),H=U-j;if(U===0||j===0||U>0!=j>0)return H;const W=Math.abs(U+j);return Math.abs(H)>=o*W?H:-(function(X,oe,ee,G,ae,se,fe){let pe,De,ye,we,Te,Re,de,Ee,xe,Ne,Fe,Xe,Be,ot,Ke,it,Me,zt;const st=X-ae,$e=ee-ae,Jt=oe-se,Ht=G-se;Te=(Ke=(Ee=st-(de=(Re=134217729*st)-(Re-st)))*(Ne=Ht-(xe=(Re=134217729*Ht)-(Re-Ht)))-((ot=st*Ht)-de*xe-Ee*xe-de*Ne))-(Fe=Ke-(Me=(Ee=Jt-(de=(Re=134217729*Jt)-(Re-Jt)))*(Ne=$e-(xe=(Re=134217729*$e)-(Re-$e)))-((it=Jt*$e)-de*xe-Ee*xe-de*Ne))),d[0]=Ke-(Fe+Te)+(Te-Me),Te=(Be=ot-((Xe=ot+Fe)-(Te=Xe-ot))+(Fe-Te))-(Fe=Be-it),d[1]=Be-(Fe+Te)+(Te-it),Te=(zt=Xe+Fe)-Xe,d[2]=Xe-(zt-Te)+(Fe-Te),d[3]=zt;let pr=(function(Cr,Tr){let Qt=Tr[0];for(let at=1;at<Cr;at++)Qt+=Tr[at];return Qt})(4,d),_t=c*fe;if(pr>=_t||-pr>=_t||(pe=X-(st+(Te=X-st))+(Te-ae),ye=ee-($e+(Te=ee-$e))+(Te-ae),De=oe-(Jt+(Te=oe-Jt))+(Te-se),we=G-(Ht+(Te=G-Ht))+(Te-se),pe===0&&De===0&&ye===0&&we===0)||(_t=f*fe+i*Math.abs(pr),(pr+=st*we+Ht*pe-(Jt*ye+$e*De))>=_t||-pr>=_t))return pr;Te=(Ke=(Ee=pe-(de=(Re=134217729*pe)-(Re-pe)))*(Ne=Ht-(xe=(Re=134217729*Ht)-(Re-Ht)))-((ot=pe*Ht)-de*xe-Ee*xe-de*Ne))-(Fe=Ke-(Me=(Ee=De-(de=(Re=134217729*De)-(Re-De)))*(Ne=$e-(xe=(Re=134217729*$e)-(Re-$e)))-((it=De*$e)-de*xe-Ee*xe-de*Ne))),E[0]=Ke-(Fe+Te)+(Te-Me),Te=(Be=ot-((Xe=ot+Fe)-(Te=Xe-ot))+(Fe-Te))-(Fe=Be-it),E[1]=Be-(Fe+Te)+(Te-it),Te=(zt=Xe+Fe)-Xe,E[2]=Xe-(zt-Te)+(Fe-Te),E[3]=zt;const vr=a(4,d,4,E,m);Te=(Ke=(Ee=st-(de=(Re=134217729*st)-(Re-st)))*(Ne=we-(xe=(Re=134217729*we)-(Re-we)))-((ot=st*we)-de*xe-Ee*xe-de*Ne))-(Fe=Ke-(Me=(Ee=Jt-(de=(Re=134217729*Jt)-(Re-Jt)))*(Ne=ye-(xe=(Re=134217729*ye)-(Re-ye)))-((it=Jt*ye)-de*xe-Ee*xe-de*Ne))),E[0]=Ke-(Fe+Te)+(Te-Me),Te=(Be=ot-((Xe=ot+Fe)-(Te=Xe-ot))+(Fe-Te))-(Fe=Be-it),E[1]=Be-(Fe+Te)+(Te-it),Te=(zt=Xe+Fe)-Xe,E[2]=Xe-(zt-Te)+(Fe-Te),E[3]=zt;const br=a(vr,m,4,E,b);Te=(Ke=(Ee=pe-(de=(Re=134217729*pe)-(Re-pe)))*(Ne=we-(xe=(Re=134217729*we)-(Re-we)))-((ot=pe*we)-de*xe-Ee*xe-de*Ne))-(Fe=Ke-(Me=(Ee=De-(de=(Re=134217729*De)-(Re-De)))*(Ne=ye-(xe=(Re=134217729*ye)-(Re-ye)))-((it=De*ye)-de*xe-Ee*xe-de*Ne))),E[0]=Ke-(Fe+Te)+(Te-Me),Te=(Be=ot-((Xe=ot+Fe)-(Te=Xe-ot))+(Fe-Te))-(Fe=Be-it),E[1]=Be-(Fe+Te)+(Te-it),Te=(zt=Xe+Fe)-Xe,E[2]=Xe-(zt-Te)+(Fe-Te),E[3]=zt;const lr=a(br,b,4,E,x);return x[lr-1]})(T,A,R,F,N,O,W)},r.orient2dfast=function(T,A,R,F,N,O){return(A-O)*(R-N)-(T-N)*(F-O)},Object.defineProperty(r,"__esModule",{value:!0})})})(z1,z1.exports)),z1.exports}var Uj;function iSe(){if(Uj)return Sw.exports;Uj=1;var t=Xwe(),e=Jwe,r=tSe(),n=nSe().orient2d;e.default&&(e=e.default),Sw.exports=i,Sw.exports.default=i;function i(O,U,j){U=Math.max(0,U===void 0?2:U),j=j||0;var H=x(O),W=new t(16);W.toBBox=function(de){return{minX:de[0],minY:de[1],maxX:de[0],maxY:de[1]}},W.compareMinX=function(de,Ee){return de[0]-Ee[0]},W.compareMinY=function(de,Ee){return de[1]-Ee[1]},W.load(O);for(var X=[],oe=0,ee;oe<H.length;oe++){var G=H[oe];W.remove(G),ee=E(G,ee),X.push(ee)}var ae=new t(16);for(oe=0;oe<X.length;oe++)ae.insert(b(X[oe]));for(var se=U*U,fe=j*j;X.length;){var pe=X.shift(),De=pe.p,ye=pe.next.p,we=T(De,ye);if(!(we<fe)){var Te=we/se;G=a(W,pe.prev.p,De,ye,pe.next.next.p,Te,ae),G&&Math.min(T(G,De),T(G,ye))<=Te&&(X.push(pe),X.push(E(G,pe)),W.remove(G),ae.remove(pe),ae.insert(b(pe)),ae.insert(b(pe.next)))}}pe=ee;var Re=[];do Re.push(pe.p),pe=pe.next;while(pe!==ee);return Re.push(pe.p),Re}function a(O,U,j,H,W,X,oe){for(var ee=new e([],s),G=O.data;G;){for(var ae=0;ae<G.children.length;ae++){var se=G.children[ae],fe=G.leaf?A(se,j,H):o(j,H,se);fe>X||ee.push({node:se,dist:fe})}for(;ee.length&&!ee.peek().node.children;){var pe=ee.pop(),De=pe.node,ye=A(De,U,j),we=A(De,H,W);if(pe.dist<ye&&pe.dist<we&&f(j,De,oe)&&f(H,De,oe))return De}G=ee.pop(),G&&(G=G.node)}return null}function s(O,U){return O.dist-U.dist}function o(O,U,j){if(c(O,j)||c(U,j))return 0;var H=R(O[0],O[1],U[0],U[1],j.minX,j.minY,j.maxX,j.minY);if(H===0)return 0;var W=R(O[0],O[1],U[0],U[1],j.minX,j.minY,j.minX,j.maxY);if(W===0)return 0;var X=R(O[0],O[1],U[0],U[1],j.maxX,j.minY,j.maxX,j.maxY);if(X===0)return 0;var oe=R(O[0],O[1],U[0],U[1],j.minX,j.maxY,j.maxX,j.maxY);return oe===0?0:Math.min(H,W,X,oe)}function c(O,U){return O[0]>=U.minX&&O[0]<=U.maxX&&O[1]>=U.minY&&O[1]<=U.maxY}function f(O,U,j){for(var H=Math.min(O[0],U[0]),W=Math.min(O[1],U[1]),X=Math.max(O[0],U[0]),oe=Math.max(O[1],U[1]),ee=j.search({minX:H,minY:W,maxX:X,maxY:oe}),G=0;G<ee.length;G++)if(m(ee[G].p,ee[G].next.p,O,U))return!1;return!0}function d(O,U,j){return n(O[0],O[1],U[0],U[1],j[0],j[1])}function m(O,U,j,H){return O!==H&&U!==j&&d(O,U,j)>0!=d(O,U,H)>0&&d(j,H,O)>0!=d(j,H,U)>0}function b(O){var U=O.p,j=O.next.p;return O.minX=Math.min(U[0],j[0]),O.minY=Math.min(U[1],j[1]),O.maxX=Math.max(U[0],j[0]),O.maxY=Math.max(U[1],j[1]),O}function x(O){for(var U=O[0],j=O[0],H=O[0],W=O[0],X=0;X<O.length;X++){var oe=O[X];oe[0]<U[0]&&(U=oe),oe[0]>H[0]&&(H=oe),oe[1]<j[1]&&(j=oe),oe[1]>W[1]&&(W=oe)}var ee=[U,j,H,W],G=ee.slice();for(X=0;X<O.length;X++)r(O[X],ee)||G.push(O[X]);return N(G)}function E(O,U){var j={p:O,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return U?(j.next=U.next,j.prev=U,U.next.prev=j,U.next=j):(j.prev=j,j.next=j),j}function T(O,U){var j=O[0]-U[0],H=O[1]-U[1];return j*j+H*H}function A(O,U,j){var H=U[0],W=U[1],X=j[0]-H,oe=j[1]-W;if(X!==0||oe!==0){var ee=((O[0]-H)*X+(O[1]-W)*oe)/(X*X+oe*oe);ee>1?(H=j[0],W=j[1]):ee>0&&(H+=X*ee,W+=oe*ee)}return X=O[0]-H,oe=O[1]-W,X*X+oe*oe}function R(O,U,j,H,W,X,oe,ee){var G=j-O,ae=H-U,se=oe-W,fe=ee-X,pe=O-W,De=U-X,ye=G*G+ae*ae,we=G*se+ae*fe,Te=se*se+fe*fe,Re=G*pe+ae*De,de=se*pe+fe*De,Ee=ye*Te-we*we,xe,Ne,Fe,Xe,Be=Ee,ot=Ee;Ee===0?(Ne=0,Be=1,Xe=de,ot=Te):(Ne=we*de-Te*Re,Xe=ye*de-we*Re,Ne<0?(Ne=0,Xe=de,ot=Te):Ne>Be&&(Ne=Be,Xe=de+we,ot=Te)),Xe<0?(Xe=0,-Re<0?Ne=0:-Re>ye?Ne=Be:(Ne=-Re,Be=ye)):Xe>ot&&(Xe=ot,-Re+we<0?Ne=0:-Re+we>ye?Ne=Be:(Ne=-Re+we,Be=ye)),xe=Ne===0?0:Ne/Be,Fe=Xe===0?0:Xe/ot;var Ke=(1-xe)*O+xe*j,it=(1-xe)*U+xe*H,Me=(1-Fe)*W+Fe*oe,zt=(1-Fe)*X+Fe*ee,st=Me-Ke,$e=zt-it;return st*st+$e*$e}function F(O,U){return O[0]===U[0]?O[1]-U[1]:O[0]-U[0]}function N(O){O.sort(F);for(var U=[],j=0;j<O.length;j++){for(;U.length>=2&&d(U[U.length-2],U[U.length-1],O[j])<=0;)U.pop();U.push(O[j])}for(var H=[],W=O.length-1;W>=0;W--){for(;H.length>=2&&d(H[H.length-2],H[H.length-1],O[W])<=0;)H.pop();H.push(O[W])}return H.pop(),U.pop(),U.concat(H)}return Sw.exports}var aSe=iSe();const oSe=Cd(aSe);function sSe(t,e={}){e.concavity=e.concavity||1/0;const r=[];if(v_(t,i=>{r.push([i[0],i[1]])}),!r.length)return null;const n=oSe(r,e.concavity);return n.length>3?c3([n]):null}function sL(t,e={}){switch(nJ(t)){case"Point":return Xf(Mg(t),e.properties);case"Polygon":var r=[];v_(t,function(O){r.push(O)});var n=Lj(t,{properties:e.properties}),i=n.geometry.coordinates,a=0,s=0,o=0,c,f,d,m,b,x,E,T,A=r.map(function(O){return[O[0]-i[0],O[1]-i[1]]});for(c=0;c<r.length-1;c++)f=A[c],m=f[0],x=f[1],d=A[c+1],b=d[0],E=d[1],T=m*E-b*x,o+=T,a+=(m+b)*T,s+=(x+E)*T;if(o===0)return n;var R=o*.5,F=1/(6*R);return Xf([i[0]+F*a,i[1]+F*s],e.properties);default:var N=sSe(t);return N?sL(N,{properties:e.properties}):Lj(t,{properties:e.properties})}}function xJ(t,e,r={}){const n=r.steps||64,i=r.properties?r.properties:!Array.isArray(t)&&t.type==="Feature"&&t.properties?t.properties:{},a=[];for(let s=0;s<n;s++)a.push(G0(t,e,s*-360/n,r).geometry.coordinates);return a.push(a[0]),c3([a],i)}function lSe(t){return t}function uSe(t){if(t==null)return lSe;var e,r,n=t.scale[0],i=t.scale[1],a=t.translate[0],s=t.translate[1];return function(o,c){c||(e=r=0);var f=2,d=o.length,m=new Array(d);for(m[0]=(e+=o[0])*n+a,m[1]=(r+=o[1])*i+s;f<d;)m[f]=o[f],++f;return m}}function cSe(t,e){for(var r,n=t.length,i=n-e;i<--n;)r=t[i],t[i++]=t[n],t[n]=r}function fSe(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(r){return Vj(t,r)})}:Vj(t,e)}function Vj(t,e){var r=e.id,n=e.bbox,i=e.properties==null?{}:e.properties,a=hSe(t,e);return r==null&&n==null?{type:"Feature",properties:i,geometry:a}:n==null?{type:"Feature",id:r,properties:i,geometry:a}:{type:"Feature",id:r,bbox:n,properties:i,geometry:a}}function hSe(t,e){var r=uSe(t.transform),n=t.arcs;function i(d,m){m.length&&m.pop();for(var b=n[d<0?~d:d],x=0,E=b.length;x<E;++x)m.push(r(b[x],x));d<0&&cSe(m,E)}function a(d){return r(d)}function s(d){for(var m=[],b=0,x=d.length;b<x;++b)i(d[b],m);return m.length<2&&m.push(m[0]),m}function o(d){for(var m=s(d);m.length<4;)m.push(m[0]);return m}function c(d){return d.map(o)}function f(d){var m=d.type,b;switch(m){case"GeometryCollection":return{type:m,geometries:d.geometries.map(f)};case"Point":b=a(d.coordinates);break;case"MultiPoint":b=d.coordinates.map(a);break;case"LineString":b=s(d.arcs);break;case"MultiLineString":b=d.arcs.map(s);break;case"Polygon":b=c(d.arcs);break;case"MultiPolygon":b=d.arcs.map(c);break;default:return null}return{type:m,coordinates:b}}return f(e)}function Yb(t,e={}){return $2e(t,(r,n)=>{const i=n.geometry.coordinates;return r+f3(i[0],i[1],e)},0)}function dSe(t,e,r,n,i={}){const a=i.steps||64,s=$j(r),o=$j(n),c=!Array.isArray(t)&&t.type==="Feature"?t.properties:{};if(s===o)return Su(xJ(t,e,i).geometry.coordinates[0],c);const f=s,d=s<o?o:o+360;let m=f;const b=[];let x=0;const E=(d-f)/a;for(;m<=d;)b.push(G0(t,e,m,i).geometry.coordinates),x++,m=f+x*E;return Su(b,c)}function $j(t){let e=t%360;return e<0&&(e+=360),e}function pSe(t,e,r,n){if(n=n||{},!iL(n))throw new Error("options is invalid");var i,a=[];if(t.type==="Feature")i=t.geometry.coordinates;else if(t.type==="LineString")i=t.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var s=i.length,o=0,c,f,d,m=0;m<i.length&&!(e>=o&&m===i.length-1);m++){if(o>e&&a.length===0){if(c=e-o,!c)return a.push(i[m]),Su(a);f=Gb(i[m],i[m-1])-180,d=G0(i[m],c,f,n),a.push(d.geometry.coordinates)}if(o>=r)return c=r-o,c?(f=Gb(i[m],i[m-1])-180,d=G0(i[m],c,f,n),a.push(d.geometry.coordinates),Su(a)):(a.push(i[m]),Su(a));if(o>=e&&a.push(i[m]),m===i.length-1)return Su(a);o+=f3(i[m],i[m+1],n)}if(o<e&&i.length===s)throw new Error("Start position is beyond line");var b=i[i.length-1];return Su([b,b])}function gSe(t,e,r){if(r=r||{},!iL(r))throw new Error("options is invalid");var n=r.units,i=r.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var a=[];return aL(t,function(s){i&&(s.geometry.coordinates=s.geometry.coordinates.reverse()),mSe(s,e,n,function(o){a.push(o)})}),xp(a)}function mSe(t,e,r,n){var i=Yb(t,{units:r});if(i<=e)return n(t);var a=i/e;Number.isInteger(a)||(a=Math.floor(a)+1);for(var s=0;s<a;s++){var o=pSe(t,e*s,e*(s+1),{units:r});n(o,s)}}function dE(t){var e=t[0],r=t[1];return[r[0]-e[0],r[1]-e[1]]}function Ok(t,e){return t[0]*e[1]-e[0]*t[1]}function ySe(t,e){return[t[0]+e[0],t[1]+e[1]]}function vSe(t,e){return[t[0]-e[0],t[1]-e[1]]}function _Se(t,e){return[t*e[0],t*e[1]]}function bSe(t,e){var r=t[0],n=dE(t),i=e[0],a=dE(e),s=Ok(n,a),o=vSe(i,r),c=Ok(o,a),f=c/s,d=ySe(r,_Se(f,n));return d}function xSe(t,e){var r=dE(t),n=dE(e);return Ok(r,n)===0}function wSe(t,e){return xSe(t,e)?!1:bSe(t,e)}function SSe(t,e,r){if(r=r||{},!iL(r))throw new Error("options is invalid");var n=r.units;if(!t)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("distance is required");var i=nJ(t),a=t.properties;switch(i){case"LineString":return qj(t,e,n);case"MultiLineString":var s=[];return aL(t,function(o){s.push(qj(o,e,n).geometry.coordinates)}),F2e(s,a);default:throw new Error("geometry "+i+" is not supported")}}function qj(t,e,r){var n=[],i=B2e(e,r),a=rJ(t),s=[];return a.forEach(function(o,c){if(c!==a.length-1){var f=ESe(o,a[c+1],i);if(n.push(f),c>0){var d=n[c-1],m=wSe(f,d);m!==!1&&(d[1]=m,f[0]=m),s.push(d[0]),c===a.length-2&&(s.push(f[0]),s.push(f[1]))}a.length===2&&(s.push(f[0]),s.push(f[1]))}}),Su(s,t.properties)}function ESe(t,e,r){var n=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),i=t[0]+r*(e[1]-t[1])/n,a=e[0]+r*(e[1]-t[1])/n,s=t[1]+r*(t[0]-e[0])/n,o=e[1]+r*(t[0]-e[0])/n;return[[i,s],[a,o]]}function TSe(t){const r=window.getComputedStyle(t,null).getPropertyValue("transform");let n=0;if(r!=="none"){const i=r.split("(")[1].split(")")[0].split(","),a=parseFloat(i[0]),s=parseFloat(i[1]);n=Math.round(Math.atan2(s,a)*(180/Math.PI))}return n<0?n+360:n}function Ew(t,e,r){const n=getComputedStyle(t),i=[e[0]-r[0],e[1]-r[1]],a=new DOMMatrixReadOnly(n.transform);return[i[0]*a.a+i[1]*a.c+a.e+r[0],i[0]*a.b+i[1]*a.d+a.f+r[1]]}const Hj=10;function Tw(t,e){const r=e.unproject(t),n=e.unproject([t[0]+Hj,t[1]]),i=r.distanceTo(n);return Hj/i}function Lk(t){const e=$T({mapId:t.mapId,watch:{layers:!1,viewport:!0}}),r=te.useRef(null),n=te.useRef(null),i=te.useRef(null),a=te.useRef(document.querySelector(".mapContainer")),s=ga({mapId:t.mapId});te.useEffect(()=>{if(!e?.viewport?.zoom||!s.map)return;const f=Math.round(s.map.map._container.clientWidth/2),d=Math.round(s.map.map._container.clientHeight/2);if(!t.options.scale){const m=1/Tw([f,d],s.map.map);t.setOptions(b=>({...b,scale:[m,m]}))}if(!t.options.center){const m=s.map.map.unproject([f,d]);t.setOptions(b=>({...b,center:[m.lng,m.lat]}))}},[s.map,e.viewport?.zoom]),te.useEffect(()=>{if(!s.map)return;s.map.map.setPitch(0);const f=s.map.map.getMaxPitch();return s.map.map.setMaxPitch(0),()=>{s.map?.map.setMaxPitch(f)}},[s.map]);const o=te.useMemo(()=>t.options.orientation==="portrait"?[t.options.width/2,t.options.height/2]:[t.options.height/2,t.options.width/2],[t.options.orientation,t.options.width,t.options.height]),c=te.useMemo(()=>{if(!s.map||!t.options.scale)return"none";const f=s.map.map.project(t.options.center),d=f.x,m=f.y,b=t.options.scale[0]*Tw([d,m],s.map.map),x=e?.viewport?.bearing?e.viewport?.bearing:0,E=`translate(${Math.floor(f.x-o[0])}px,${Math.floor(f.y-o[1])}px) rotate(${t.options.rotate-x}deg) scale(${b},${b})`;return r.current&&(r.current.style.transform=E),E},[s.map,e.viewport,t.options.scale,t.options.rotate,t.options.center,o]);return te.useEffect(()=>{i.current?.updateTarget()},[c]),te.useEffect(()=>{if(!s.map||!t.options.center||!t.options.fixedScale||typeof t.options.fixedScale<"u"&&n.current===t.options.fixedScale)return;n.current=t.options.fixedScale;const f=Xf(t.options.center),d=t.options.fixedScale*(t.options.width/1e3),x=G0(f,d,90,{units:"meters"}),E=s.map.map.project(f.geometry.coordinates),T=s.map.map.project(x.geometry.coordinates),A=Math.round(T.x-E.x)/t.options.width*(1/Tw([E.x,E.y],s.map.map));t.setOptions(R=>({...R,scale:[A,A]}))},[s.map,t.options.width,t.options.center,t.options.fixedScale]),te.useEffect(()=>{if(r.current&&s.map){let f=t.options.width,d=t.options.height;t.options.orientation==="portrait"?(r.current.style.width=t.options.width+"px",r.current.style.height=t.options.height+"px"):(r.current.style.width=t.options.height+"px",r.current.style.height=t.options.width+"px",f=t.options.height,d=t.options.width),i.current?.updateTarget();const m=s.map.map.unproject(Ew(r.current,[0,0],o)),b=s.map.map.unproject(Ew(r.current,[f,0],o)),x=s.map.map.unproject(Ew(r.current,[0,d],o)),E=s.map.map.unproject(Ew(r.current,[f,d],o)),T={type:"Feature",bbox:[m.lng,m.lat,E.lng,E.lat],geometry:{type:"Polygon",coordinates:[[[m.lng,m.lat],[b.lng,b.lat],[E.lng,E.lat],[x.lng,x.lat],[m.lng,m.lat]]]},properties:{bearing:TSe(r.current)}};t.geojsonRef.current=T}},[s,c,t.options.orientation,t.geojsonRef,e,r.current,o]),a.current?I1.createPortal(J.jsxs(J.Fragment,{children:[J.jsx("div",{className:"target",ref:r,style:{transform:c,transformOrigin:"center center"}}),J.jsx(N2e,{ref:i,target:r,container:null,origin:!0,keepRatio:!0,draggable:!0,onDrag:f=>{if(s.map){let d=f.transform.split("translate(");d=d[1].split("px)")[0].split("px, ");const m=s.map?.map.unproject([parseInt(d[0])+o[0],parseInt(d[1])+o[1]]);t.setOptions(b=>({...b,center:[m.lng,m.lat]}))}},scalable:!t.options.fixedScale,onScale:f=>{if(s.map){let d=f.drag.transform.split("scale(");d=d[1].split(")")[0].split(", ");const m=s.map.map.project(t.options.center),b=m.x,x=m.y,E=parseFloat(d[0])*(1/Tw([b,x],s.map.map));t.setOptions(T=>({...T,scale:[E,E]}))}},rotatable:!0,onRotate:f=>{if(s.map&&e.viewport){const m=f.drag.transform.split("rotate(")[1].split("deg)")[0],b=e?.viewport?.bearing?e.viewport.bearing:0;t.setOptions(x=>({...x,rotate:parseFloat(m)+b}))}}})]}),a.current):J.jsx(J.Fragment,{})}try{Lk.displayName="PdfPreview",Lk.__docgenInfo={description:"PdfPreview component renders a transformable (drag, scale, rotate) preview of the desired export or print content",displayName:"PdfPreview",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},geojsonRef:{defaultValue:null,description:"Polygon GeoJson Feature representing the printing area",name:"geojsonRef",required:!0,type:{name:"MutableRefObject<Feature<Geometry, GeoJsonProperties> | undefined>"}},options:{defaultValue:null,description:"a state variable containing the PDF previews current state",name:"options",required:!0,type:{name:"PdfPreviewOptions"}},setOptions:{defaultValue:null,description:"setter function to update the current PDF preview state",name:"setOptions",required:!0,type:{name:"(arg1: (val: PdfPreviewOptions) => PdfPreviewOptions) => void"}}}}}catch{}const CSe=[{value:0,label:"free scale"},{value:250,label:"1/250"},{value:500,label:"1/500"},{value:750,label:"1/750"},{value:1e3,label:"1/1000"},{value:1500,label:"1/1500"},{value:2e3,label:"1/2000"},{value:1e4,label:"1/10000"},{value:1e5,label:"1/100000"}],ASe=[{value:"72dpi",label:"Draft (72dpi)"},{value:"150dpi",label:"Medium (150dpi)"},{value:"300dpi",label:"High (300dpi)"}];function Nk(t){const[e,r]=te.useState(!1),n=te.useContext(gZ),i=ga({mapId:t.mapId}),a=pZ({mapId:t.mapId}),s=te.useCallback(()=>{if(i.map&&a.createExport&&n.template&&n.format&&n.options?.orientation&&n.geojsonRef?.current?.bbox&&n.geojsonRef?.current){r(!0);const f=df(n.geojsonRef.current);a.createExport({width:n.template.width,height:n.template.height,bbox:f,bboxUnrotated:n.geojsonRef.current.bbox,bearing:n.geojsonRef.current?.properties?.bearing||0,format:n.format.toLowerCase(),orientation:n.options.orientation}).then(d=>d.createPdf()).then(d=>(typeof t.onCreatePdf=="function"&&(d.formData=new FormData(document.getElementById("createPdfFormID")),t.onCreatePdf(d)),r(!1),d.downloadPdf())).catch(d=>{console.log(d),r(!1)})}},[i.map,n]),o=kx("(max-width: 950px)"),c=te.useMemo(()=>({margin:o?"1px 0 8px 0 ":"5px 0 15px 0 ",...t?.formControlStyles?{...t.formControlStyles}:{}}),[o,t.formControlStyles]);return J.jsx(J.Fragment,{children:J.jsxs("form",{id:"createPdfFormID",children:[J.jsxs(af,{fullWidth:!0,sx:c,children:[J.jsx(ta,{variant:"contained",className:"createPdfButton",onClick:s,disabled:e,sx:{marginBottom:"16px"},children:"create PDF"}),e&&J.jsx(HT,{size:24,sx:{color:"primary.main",position:"absolute",top:"25%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),J.jsxs(af,{fullWidth:!0,sx:c,children:[J.jsx(vg,{sx:{marginTop:"3px"},id:"format-select-label",children:"Format"}),J.jsx(_g,{labelId:"format-select-label",id:"format-select",label:"Format",value:n.format,onChange:f=>{n.setFormat?.(f.target.value)},children:Object.keys(i0).map(f=>J.jsx(Fm,{value:f,children:f},f))})]}),J.jsxs(af,{fullWidth:!0,sx:c,children:[J.jsx(cY,{id:"orientation-radio-buttons-group-label",children:"Orientation"}),J.jsxs(Ume,{row:!0,"aria-labelledby":"orientation-radio-buttons-group-label",name:"orientation-radio-buttons-group",value:n.options?.orientation,onChange:f=>{n.setOptions&&n.setOptions(d=>({...d,orientation:f.target.value}))},children:[J.jsx($M,{value:"portrait",control:J.jsx(Q8,{}),label:"Portrait"}),J.jsx($M,{value:"landscape",control:J.jsx(Q8,{}),label:"Landscape"})]})]}),J.jsxs(af,{fullWidth:!0,sx:c,children:[J.jsx(vg,{id:"quality-select-label",children:"Quality"}),J.jsx(_g,{labelId:"quality-select-label",id:"quality-select",label:"Quality",value:n.quality,onChange:f=>{n.setQuality?.(f.target.value)},children:ASe.map(f=>J.jsx(Fm,{value:f.value,children:f.label},f.value))})]}),J.jsxs(af,{fullWidth:!0,sx:c,children:[J.jsx(vg,{id:"scale-select-label",children:"Scale"}),J.jsx(_g,{labelId:"scale-select-label",id:"scale-select",label:"Scale",value:n?.options?.fixedScale,onChange:f=>{n.setOptions?.(d=>({...d,fixedScale:f.target.value}))},children:CSe.map((f,d)=>J.jsx(Fm,{value:f.value,children:f.label},d))})]}),t?.additionalFields,n.options&&n.setOptions&&J.jsx(Lk,{options:n.options,setOptions:n.setOptions,geojsonRef:n.geojsonRef})]})})}try{Nk.displayName="PdfForm",Nk.__docgenInfo={description:"",displayName:"PdfForm",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},onCreatePdf:{defaultValue:null,description:`Function that will be called before the PDF is created.
Allowing to access and manipulate the jspdf instance before the PDF is created.`,name:"onCreatePdf",required:!1,type:{name:"((options: createPdfResolverParams) => createPdfResolverParams) | undefined"}},formControlStyles:{defaultValue:null,description:"sx props that will be applied to the form control components",name:"formControlStyles",required:!1,type:{name:"SxProps | undefined"}},additionalFields:{defaultValue:null,description:`Define additional form fields that will be added to the bottom of the create-PDF form.
Values of form elements added this way are accessible inside the function passed to the onCreatePdf property using options.formData.get('{form_el_name}').
Make sure all form elements added this way have a name property defined to be able to access the value when rendering the PDF.`,name:"additionalFields",required:!1,type:{name:"ReactNode"}}}}}catch{}const Gj=t=>J.jsx(J.Fragment,{children:J.jsx(nk,{children:J.jsx(Nk,{...t})})});try{Gj.displayName="MlCreatePdfForm",Gj.__docgenInfo={description:"Create PDF Form Component",displayName:"MlCreatePdfForm",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},onCreatePdf:{defaultValue:null,description:`Function that will be called before the PDF is created.
Allowing to access and manipulate the jspdf instance before the PDF is created.`,name:"onCreatePdf",required:!1,type:{name:"((options: createPdfResolverParams) => createPdfResolverParams) | undefined"}},formControlStyles:{defaultValue:null,description:"sx props that will be applied to the form control components",name:"formControlStyles",required:!1,type:{name:"SxProps | undefined"}},additionalFields:{defaultValue:null,description:`Define additional form fields that will be added to the bottom of the create-PDF form.
Values of form elements added this way are accessible inside the function passed to the onCreatePdf property using options.formData.get('{form_el_name}').
Make sure all form elements added this way have a name property defined to be able to access the value when rendering the PDF.`,name:"additionalFields",required:!1,type:{name:"ReactNode"}}}}}catch{}var yS={exports:{}},ISe=yS.exports,Wj;function PSe(){return Wj||(Wj=1,(function(t,e){(function(r,n){t.exports=n()})(ISe,(function(){var r=function(Q,ge){var Je={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},It={on:function($t,er,Yr){if(Je[$t]===void 0)throw new Error("Invalid event type: "+$t);Je[$t].push({selector:er,fn:Yr})},render:function($t){ge.store.featureChanged($t)}},Vt=function($t,er){for(var Yr=Je[$t],tn=Yr.length;tn--;){var Gr=Yr[tn];if(Gr.selector(er)){Gr.fn.call(It,er)||ge.store.render(),ge.ui.updateMapClasses();break}}};return Q.start.call(It),{render:Q.render,stop:function(){Q.stop&&Q.stop()},trash:function(){Q.trash&&(Q.trash(),ge.store.render())},combineFeatures:function(){Q.combineFeatures&&Q.combineFeatures()},uncombineFeatures:function(){Q.uncombineFeatures&&Q.uncombineFeatures()},drag:function($t){Vt("drag",$t)},click:function($t){Vt("click",$t)},mousemove:function($t){Vt("mousemove",$t)},mousedown:function($t){Vt("mousedown",$t)},mouseup:function($t){Vt("mouseup",$t)},mouseout:function($t){Vt("mouseout",$t)},keydown:function($t){Vt("keydown",$t)},keyup:function($t){Vt("keyup",$t)},touchstart:function($t){Vt("touchstart",$t)},touchmove:function($t){Vt("touchmove",$t)},touchend:function($t){Vt("touchend",$t)},tap:function($t){Vt("tap",$t)}}};function n(Q){return Q&&Q.__esModule&&Object.prototype.hasOwnProperty.call(Q,"default")?Q.default:Q}function i(Q){if(Q.__esModule)return Q;var ge=Q.default;if(typeof ge=="function"){var Je=function It(){if(this instanceof It){var Vt=[null];Vt.push.apply(Vt,arguments);var $t=Function.bind.apply(ge,Vt);return new $t}return ge.apply(this,arguments)};Je.prototype=ge.prototype}else Je={};return Object.defineProperty(Je,"__esModule",{value:!0}),Object.keys(Q).forEach((function(It){var Vt=Object.getOwnPropertyDescriptor(Q,It);Object.defineProperty(Je,It,Vt.get?Vt:{enumerable:!0,get:function(){return Q[It]}})})),Je}var a={},s={RADIUS:6378137},o=s;function c(Q){var ge=0;if(Q&&Q.length>0){ge+=Math.abs(f(Q[0]));for(var Je=1;Je<Q.length;Je++)ge-=Math.abs(f(Q[Je]))}return ge}function f(Q){var ge,Je,It,Vt,$t,er,Yr=0,tn=Q.length;if(tn>2){for(er=0;er<tn;er++)er===tn-2?(It=tn-2,Vt=tn-1,$t=0):er===tn-1?(It=tn-1,Vt=0,$t=1):(It=er,Vt=er+1,$t=er+2),ge=Q[It],Je=Q[Vt],Yr+=(d(Q[$t][0])-d(ge[0]))*Math.sin(d(Je[1]));Yr=Yr*o.RADIUS*o.RADIUS/2}return Yr}function d(Q){return Q*Math.PI/180}a.geometry=function Q(ge){var Je,It=0;switch(ge.type){case"Polygon":return c(ge.coordinates);case"MultiPolygon":for(Je=0;Je<ge.coordinates.length;Je++)It+=c(ge.coordinates[Je]);return It;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Je=0;Je<ge.geometries.length;Je++)It+=Q(ge.geometries[Je]);return It}},a.ring=f;var m={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},b={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},x={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},E={POLYGON:"polygon",LINE:"line_string",POINT:"point"},T={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},A={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},R={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},F={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},N={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},O={ACTIVE:"true",INACTIVE:"false"},U=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],j=-85,H=Object.freeze({__proto__:null,classes:m,sources:b,cursors:x,types:E,geojsonTypes:T,modes:A,events:R,updateActions:F,meta:N,activeStates:O,interactions:U,LAT_MIN:-90,LAT_RENDERED_MIN:j,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),W={Point:0,LineString:1,MultiLineString:1,Polygon:2};function X(Q,ge){var Je=W[Q.geometry.type]-W[ge.geometry.type];return Je===0&&Q.geometry.type===T.POLYGON?Q.area-ge.area:Je}function oe(Q){return Q.map((function(ge){return ge.geometry.type===T.POLYGON&&(ge.area=a.geometry({type:T.FEATURE,property:{},geometry:ge.geometry})),ge})).sort(X).map((function(ge){return delete ge.area,ge}))}function ee(Q,ge){return ge===void 0&&(ge=0),[[Q.point.x-ge,Q.point.y-ge],[Q.point.x+ge,Q.point.y+ge]]}function G(Q){if(this._items={},this._nums={},this._length=Q?Q.length:0,Q)for(var ge=0,Je=Q.length;ge<Je;ge++)this.add(Q[ge]),Q[ge]!==void 0&&(typeof Q[ge]=="string"?this._items[Q[ge]]=ge:this._nums[Q[ge]]=ge)}G.prototype.add=function(Q){return this.has(Q)||(this._length++,typeof Q=="string"?this._items[Q]=this._length:this._nums[Q]=this._length),this},G.prototype.delete=function(Q){return this.has(Q)===!1||(this._length--,delete this._items[Q],delete this._nums[Q]),this},G.prototype.has=function(Q){return(typeof Q=="string"||typeof Q=="number")&&(this._items[Q]!==void 0||this._nums[Q]!==void 0)},G.prototype.values=function(){var Q=this,ge=[];return Object.keys(this._items).forEach((function(Je){ge.push({k:Je,v:Q._items[Je]})})),Object.keys(this._nums).forEach((function(Je){ge.push({k:JSON.parse(Je),v:Q._nums[Je]})})),ge.sort((function(Je,It){return Je.v-It.v})).map((function(Je){return Je.k}))},G.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var ae=[N.FEATURE,N.MIDPOINT,N.VERTEX],se={click:function(Q,ge,Je){return fe(Q,ge,Je,Je.options.clickBuffer)},touch:function(Q,ge,Je){return fe(Q,ge,Je,Je.options.touchBuffer)}};function fe(Q,ge,Je,It){if(Je.map===null)return[];var Vt=Q?ee(Q,It):ge,$t={};Je.options.styles&&($t.layers=Je.options.styles.map((function(Gr){return Gr.id})).filter((function(Gr){return Je.map.getLayer(Gr)!=null})));var er=Je.map.queryRenderedFeatures(Vt,$t).filter((function(Gr){return ae.indexOf(Gr.properties.meta)!==-1})),Yr=new G,tn=[];return er.forEach((function(Gr){var an=Gr.properties.id;Yr.has(an)||(Yr.add(an),tn.push(Gr))})),oe(tn)}function pe(Q,ge){var Je=se.click(Q,null,ge),It={mouse:x.NONE};return Je[0]&&(It.mouse=Je[0].properties.active===O.ACTIVE?x.MOVE:x.POINTER,It.feature=Je[0].properties.meta),ge.events.currentModeName().indexOf("draw")!==-1&&(It.mouse=x.ADD),ge.ui.queueMapClasses(It),ge.ui.updateMapClasses(),Je[0]}function De(Q,ge){var Je=Q.x-ge.x,It=Q.y-ge.y;return Math.sqrt(Je*Je+It*It)}function ye(Q,ge,Je){Je===void 0&&(Je={});var It=Je.fineTolerance!=null?Je.fineTolerance:4,Vt=Je.grossTolerance!=null?Je.grossTolerance:12,$t=Je.interval!=null?Je.interval:500;Q.point=Q.point||ge.point,Q.time=Q.time||ge.time;var er=De(Q.point,ge.point);return er<It||er<Vt&&ge.time-Q.time<$t}function we(Q,ge,Je){Je===void 0&&(Je={});var It=Je.tolerance!=null?Je.tolerance:25,Vt=Je.interval!=null?Je.interval:250;return Q.point=Q.point||ge.point,Q.time=Q.time||ge.time,De(Q.point,ge.point)<It&&ge.time-Q.time<Vt}var Te={exports:{}},Re=Te.exports=function(Q,ge){if(ge||(ge=16),Q===void 0&&(Q=128),Q<=0)return"0";for(var Je=Math.log(Math.pow(2,Q))/Math.log(ge),It=2;Je===1/0;It*=2)Je=Math.log(Math.pow(2,Q/It))/Math.log(ge)*It;var Vt=Je-Math.floor(Je),$t="";for(It=0;It<Math.floor(Je);It++)$t=Math.floor(Math.random()*ge).toString(ge)+$t;if(Vt){var er=Math.pow(ge,Vt);$t=Math.floor(Math.random()*er).toString(ge)+$t}var Yr=parseInt($t,ge);return Yr!==1/0&&Yr>=Math.pow(2,Q)?Re(Q,ge):$t};Re.rack=function(Q,ge,Je){var It=function($t){var er=0;do{if(er++>10){if(!Je)throw new Error("too many ID collisions, use more bits");Q+=Je}var Yr=Re(Q,ge)}while(Object.hasOwnProperty.call(Vt,Yr));return Vt[Yr]=$t,Yr},Vt=It.hats={};return It.get=function($t){return It.hats[$t]},It.set=function($t,er){return It.hats[$t]=er,It},It.bits=Q||128,It.base=ge||16,It};var de=n(Te.exports),Ee=function(Q,ge){this.ctx=Q,this.properties=ge.properties||{},this.coordinates=ge.geometry.coordinates,this.id=ge.id||de(),this.type=ge.geometry.type};Ee.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Ee.prototype.incomingCoords=function(Q){this.setCoordinates(Q)},Ee.prototype.setCoordinates=function(Q){this.coordinates=Q,this.changed()},Ee.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Ee.prototype.setProperty=function(Q,ge){this.properties[Q]=ge},Ee.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:T.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Ee.prototype.internal=function(Q){var ge={id:this.id,meta:N.FEATURE,"meta:type":this.type,active:O.INACTIVE,mode:Q};if(this.ctx.options.userProperties)for(var Je in this.properties)ge["user_"+Je]=this.properties[Je];return{type:T.FEATURE,properties:ge,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var xe=function(Q,ge){Ee.call(this,Q,ge)};(xe.prototype=Object.create(Ee.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},xe.prototype.updateCoordinate=function(Q,ge,Je){this.coordinates=arguments.length===3?[ge,Je]:[Q,ge],this.changed()},xe.prototype.getCoordinate=function(){return this.getCoordinates()};var Ne=function(Q,ge){Ee.call(this,Q,ge)};(Ne.prototype=Object.create(Ee.prototype)).isValid=function(){return this.coordinates.length>1},Ne.prototype.addCoordinate=function(Q,ge,Je){this.changed();var It=parseInt(Q,10);this.coordinates.splice(It,0,[ge,Je])},Ne.prototype.getCoordinate=function(Q){var ge=parseInt(Q,10);return JSON.parse(JSON.stringify(this.coordinates[ge]))},Ne.prototype.removeCoordinate=function(Q){this.changed(),this.coordinates.splice(parseInt(Q,10),1)},Ne.prototype.updateCoordinate=function(Q,ge,Je){var It=parseInt(Q,10);this.coordinates[It]=[ge,Je],this.changed()};var Fe=function(Q,ge){Ee.call(this,Q,ge),this.coordinates=this.coordinates.map((function(Je){return Je.slice(0,-1)}))};(Fe.prototype=Object.create(Ee.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every((function(Q){return Q.length>2}))},Fe.prototype.incomingCoords=function(Q){this.coordinates=Q.map((function(ge){return ge.slice(0,-1)})),this.changed()},Fe.prototype.setCoordinates=function(Q){this.coordinates=Q,this.changed()},Fe.prototype.addCoordinate=function(Q,ge,Je){this.changed();var It=Q.split(".").map((function(Vt){return parseInt(Vt,10)}));this.coordinates[It[0]].splice(It[1],0,[ge,Je])},Fe.prototype.removeCoordinate=function(Q){this.changed();var ge=Q.split(".").map((function(It){return parseInt(It,10)})),Je=this.coordinates[ge[0]];Je&&(Je.splice(ge[1],1),Je.length<3&&this.coordinates.splice(ge[0],1))},Fe.prototype.getCoordinate=function(Q){var ge=Q.split(".").map((function(It){return parseInt(It,10)})),Je=this.coordinates[ge[0]];return JSON.parse(JSON.stringify(Je[ge[1]]))},Fe.prototype.getCoordinates=function(){return this.coordinates.map((function(Q){return Q.concat([Q[0]])}))},Fe.prototype.updateCoordinate=function(Q,ge,Je){this.changed();var It=Q.split("."),Vt=parseInt(It[0],10),$t=parseInt(It[1],10);this.coordinates[Vt]===void 0&&(this.coordinates[Vt]=[]),this.coordinates[Vt][$t]=[ge,Je]};var Xe={MultiPoint:xe,MultiLineString:Ne,MultiPolygon:Fe},Be=function(Q,ge,Je,It,Vt){var $t=Je.split("."),er=parseInt($t[0],10),Yr=$t[1]?$t.slice(1).join("."):null;return Q[er][ge](Yr,It,Vt)},ot=function(Q,ge){if(Ee.call(this,Q,ge),delete this.coordinates,this.model=Xe[ge.geometry.type],this.model===void 0)throw new TypeError(ge.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(ge.geometry.coordinates)};function Ke(Q){this.map=Q.map,this.drawConfig=JSON.parse(JSON.stringify(Q.options||{})),this._ctx=Q}(ot.prototype=Object.create(Ee.prototype))._coordinatesToFeatures=function(Q){var ge=this,Je=this.model.bind(this);return Q.map((function(It){return new Je(ge.ctx,{id:de(),type:T.FEATURE,properties:{},geometry:{coordinates:It,type:ge.type.replace("Multi","")}})}))},ot.prototype.isValid=function(){return this.features.every((function(Q){return Q.isValid()}))},ot.prototype.setCoordinates=function(Q){this.features=this._coordinatesToFeatures(Q),this.changed()},ot.prototype.getCoordinate=function(Q){return Be(this.features,"getCoordinate",Q)},ot.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map((function(Q){return Q.type===T.POLYGON?Q.getCoordinates():Q.coordinates}))))},ot.prototype.updateCoordinate=function(Q,ge,Je){Be(this.features,"updateCoordinate",Q,ge,Je),this.changed()},ot.prototype.addCoordinate=function(Q,ge,Je){Be(this.features,"addCoordinate",Q,ge,Je),this.changed()},ot.prototype.removeCoordinate=function(Q){Be(this.features,"removeCoordinate",Q),this.changed()},ot.prototype.getFeatures=function(){return this.features},Ke.prototype.setSelected=function(Q){return this._ctx.store.setSelected(Q)},Ke.prototype.setSelectedCoordinates=function(Q){var ge=this;this._ctx.store.setSelectedCoordinates(Q),Q.reduce((function(Je,It){return Je[It.feature_id]===void 0&&(Je[It.feature_id]=!0,ge._ctx.store.get(It.feature_id).changed()),Je}),{})},Ke.prototype.getSelected=function(){return this._ctx.store.getSelected()},Ke.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Ke.prototype.isSelected=function(Q){return this._ctx.store.isSelected(Q)},Ke.prototype.getFeature=function(Q){return this._ctx.store.get(Q)},Ke.prototype.select=function(Q){return this._ctx.store.select(Q)},Ke.prototype.deselect=function(Q){return this._ctx.store.deselect(Q)},Ke.prototype.deleteFeature=function(Q,ge){return ge===void 0&&(ge={}),this._ctx.store.delete(Q,ge)},Ke.prototype.addFeature=function(Q){return this._ctx.store.add(Q)},Ke.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Ke.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Ke.prototype.setActionableState=function(Q){Q===void 0&&(Q={});var ge={trash:Q.trash||!1,combineFeatures:Q.combineFeatures||!1,uncombineFeatures:Q.uncombineFeatures||!1};return this._ctx.events.actionable(ge)},Ke.prototype.changeMode=function(Q,ge,Je){return ge===void 0&&(ge={}),Je===void 0&&(Je={}),this._ctx.events.changeMode(Q,ge,Je)},Ke.prototype.updateUIClasses=function(Q){return this._ctx.ui.queueMapClasses(Q)},Ke.prototype.activateUIButton=function(Q){return this._ctx.ui.setActiveButton(Q)},Ke.prototype.featuresAt=function(Q,ge,Je){if(Je===void 0&&(Je="click"),Je!=="click"&&Je!=="touch")throw new Error("invalid buffer type");return se[Je](Q,ge,this._ctx)},Ke.prototype.newFeature=function(Q){var ge=Q.geometry.type;return ge===T.POINT?new xe(this._ctx,Q):ge===T.LINE_STRING?new Ne(this._ctx,Q):ge===T.POLYGON?new Fe(this._ctx,Q):new ot(this._ctx,Q)},Ke.prototype.isInstanceOf=function(Q,ge){if(Q===T.POINT)return ge instanceof xe;if(Q===T.LINE_STRING)return ge instanceof Ne;if(Q===T.POLYGON)return ge instanceof Fe;if(Q==="MultiFeature")return ge instanceof ot;throw new Error("Unknown feature class: "+Q)},Ke.prototype.doRender=function(Q){return this._ctx.store.featureChanged(Q)},Ke.prototype.onSetup=function(){},Ke.prototype.onDrag=function(){},Ke.prototype.onClick=function(){},Ke.prototype.onMouseMove=function(){},Ke.prototype.onMouseDown=function(){},Ke.prototype.onMouseUp=function(){},Ke.prototype.onMouseOut=function(){},Ke.prototype.onKeyUp=function(){},Ke.prototype.onKeyDown=function(){},Ke.prototype.onTouchStart=function(){},Ke.prototype.onTouchMove=function(){},Ke.prototype.onTouchEnd=function(){},Ke.prototype.onTap=function(){},Ke.prototype.onStop=function(){},Ke.prototype.onTrash=function(){},Ke.prototype.onCombineFeature=function(){},Ke.prototype.onUncombineFeature=function(){},Ke.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var it={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Me=Object.keys(it);function zt(Q){var ge=Object.keys(Q);return function(Je,It){It===void 0&&(It={});var Vt={},$t=ge.reduce((function(er,Yr){return er[Yr]=Q[Yr],er}),new Ke(Je));return{start:function(){var er=this;Vt=$t.onSetup(It),Me.forEach((function(Yr){var tn,Gr=it[Yr],an=function(){return!1};Q[Gr]&&(an=function(){return!0}),er.on(Yr,an,(tn=Gr,function(Mr){return $t[tn](Vt,Mr)}))}))},stop:function(){$t.onStop(Vt)},trash:function(){$t.onTrash(Vt)},combineFeatures:function(){$t.onCombineFeatures(Vt)},uncombineFeatures:function(){$t.onUncombineFeatures(Vt)},render:function(er,Yr){$t.toDisplayFeatures(Vt,er,Yr)}}}}function st(Q){return[].concat(Q).filter((function(ge){return ge!==void 0}))}function $e(){var Q=this;if(!(Q.ctx.map&&Q.ctx.map.getSource(b.HOT)!==void 0))return tn();var ge=Q.ctx.events.currentModeName();Q.ctx.ui.queueMapClasses({mode:ge});var Je=[],It=[];Q.isDirty?It=Q.getAllIds():(Je=Q.getChangedIds().filter((function(Gr){return Q.get(Gr)!==void 0})),It=Q.sources.hot.filter((function(Gr){return Gr.properties.id&&Je.indexOf(Gr.properties.id)===-1&&Q.get(Gr.properties.id)!==void 0})).map((function(Gr){return Gr.properties.id}))),Q.sources.hot=[];var Vt=Q.sources.cold.length;Q.sources.cold=Q.isDirty?[]:Q.sources.cold.filter((function(Gr){var an=Gr.properties.id||Gr.properties.parent;return Je.indexOf(an)===-1}));var $t=Vt!==Q.sources.cold.length||It.length>0;function er(Gr,an){var Mr=Q.get(Gr).internal(ge);Q.ctx.events.currentModeRender(Mr,(function(ti){Q.sources[an].push(ti)}))}if(Je.forEach((function(Gr){return er(Gr,"hot")})),It.forEach((function(Gr){return er(Gr,"cold")})),$t&&Q.ctx.map.getSource(b.COLD).setData({type:T.FEATURE_COLLECTION,features:Q.sources.cold}),Q.ctx.map.getSource(b.HOT).setData({type:T.FEATURE_COLLECTION,features:Q.sources.hot}),Q._emitSelectionChange&&(Q.ctx.map.fire(R.SELECTION_CHANGE,{features:Q.getSelected().map((function(Gr){return Gr.toGeoJSON()})),points:Q.getSelectedCoordinates().map((function(Gr){return{type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:Gr.coordinates}}}))}),Q._emitSelectionChange=!1),Q._deletedFeaturesToEmit.length){var Yr=Q._deletedFeaturesToEmit.map((function(Gr){return Gr.toGeoJSON()}));Q._deletedFeaturesToEmit=[],Q.ctx.map.fire(R.DELETE,{features:Yr})}function tn(){Q.isDirty=!1,Q.clearChangedIds()}tn(),Q.ctx.map.fire(R.RENDER,{})}function Jt(Q){var ge,Je=this;this._features={},this._featureIds=new G,this._selectedFeatureIds=new G,this._selectedCoordinates=[],this._changedFeatureIds=new G,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=Q,this.sources={hot:[],cold:[]},this.render=function(){ge||(ge=requestAnimationFrame((function(){ge=null,$e.call(Je)})))},this.isDirty=!1}function Ht(Q,ge){var Je=Q._selectedCoordinates.filter((function(It){return Q._selectedFeatureIds.has(It.feature_id)}));Q._selectedCoordinates.length===Je.length||ge.silent||(Q._emitSelectionChange=!0),Q._selectedCoordinates=Je}Jt.prototype.createRenderBatch=function(){var Q=this,ge=this.render,Je=0;return this.render=function(){Je++},function(){Q.render=ge,Je>0&&Q.render()}},Jt.prototype.setDirty=function(){return this.isDirty=!0,this},Jt.prototype.featureChanged=function(Q){return this._changedFeatureIds.add(Q),this},Jt.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Jt.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Jt.prototype.getAllIds=function(){return this._featureIds.values()},Jt.prototype.add=function(Q){return this.featureChanged(Q.id),this._features[Q.id]=Q,this._featureIds.add(Q.id),this},Jt.prototype.delete=function(Q,ge){var Je=this;return ge===void 0&&(ge={}),st(Q).forEach((function(It){Je._featureIds.has(It)&&(Je._featureIds.delete(It),Je._selectedFeatureIds.delete(It),ge.silent||Je._deletedFeaturesToEmit.indexOf(Je._features[It])===-1&&Je._deletedFeaturesToEmit.push(Je._features[It]),delete Je._features[It],Je.isDirty=!0)})),Ht(this,ge),this},Jt.prototype.get=function(Q){return this._features[Q]},Jt.prototype.getAll=function(){var Q=this;return Object.keys(this._features).map((function(ge){return Q._features[ge]}))},Jt.prototype.select=function(Q,ge){var Je=this;return ge===void 0&&(ge={}),st(Q).forEach((function(It){Je._selectedFeatureIds.has(It)||(Je._selectedFeatureIds.add(It),Je._changedFeatureIds.add(It),ge.silent||(Je._emitSelectionChange=!0))})),this},Jt.prototype.deselect=function(Q,ge){var Je=this;return ge===void 0&&(ge={}),st(Q).forEach((function(It){Je._selectedFeatureIds.has(It)&&(Je._selectedFeatureIds.delete(It),Je._changedFeatureIds.add(It),ge.silent||(Je._emitSelectionChange=!0))})),Ht(this,ge),this},Jt.prototype.clearSelected=function(Q){return Q===void 0&&(Q={}),this.deselect(this._selectedFeatureIds.values(),{silent:Q.silent}),this},Jt.prototype.setSelected=function(Q,ge){var Je=this;return ge===void 0&&(ge={}),Q=st(Q),this.deselect(this._selectedFeatureIds.values().filter((function(It){return Q.indexOf(It)===-1})),{silent:ge.silent}),this.select(Q.filter((function(It){return!Je._selectedFeatureIds.has(It)})),{silent:ge.silent}),this},Jt.prototype.setSelectedCoordinates=function(Q){return this._selectedCoordinates=Q,this._emitSelectionChange=!0,this},Jt.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Jt.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Jt.prototype.getSelected=function(){var Q=this;return this._selectedFeatureIds.values().map((function(ge){return Q.get(ge)}))},Jt.prototype.getSelectedCoordinates=function(){var Q=this;return this._selectedCoordinates.map((function(ge){return{coordinates:Q.get(ge.feature_id).getCoordinate(ge.coord_path)}}))},Jt.prototype.isSelected=function(Q){return this._selectedFeatureIds.has(Q)},Jt.prototype.setFeatureProperty=function(Q,ge,Je){this.get(Q).setProperty(ge,Je),this.featureChanged(Q)},Jt.prototype.storeMapConfig=function(){var Q=this;U.forEach((function(ge){Q.ctx.map[ge]&&(Q._mapInitialConfig[ge]=Q.ctx.map[ge].isEnabled())}))},Jt.prototype.restoreMapConfig=function(){var Q=this;Object.keys(this._mapInitialConfig).forEach((function(ge){Q._mapInitialConfig[ge]?Q.ctx.map[ge].enable():Q.ctx.map[ge].disable()}))},Jt.prototype.getInitialConfigValue=function(Q){return this._mapInitialConfig[Q]===void 0||this._mapInitialConfig[Q]};var pr=function(){for(var Q=arguments,ge={},Je=0;Je<arguments.length;Je++){var It=Q[Je];for(var Vt in It)_t.call(It,Vt)&&(ge[Vt]=It[Vt])}return ge},_t=Object.prototype.hasOwnProperty,vr=n(pr),br=["mode","feature","mouse"];function lr(Q){var ge=null,Je=null,It={onRemove:function(){return Q.map.off("load",It.connect),clearInterval(Je),It.removeLayers(),Q.store.restoreMapConfig(),Q.ui.removeButtons(),Q.events.removeEventListeners(),Q.ui.clearMapClasses(),Q.boxZoomInitial&&Q.map.boxZoom.enable(),Q.map=null,Q.container=null,Q.store=null,ge&&ge.parentNode&&ge.parentNode.removeChild(ge),ge=null,this},connect:function(){Q.map.off("load",It.connect),clearInterval(Je),It.addLayers(),Q.store.storeMapConfig(),Q.events.addEventListeners()},onAdd:function(Vt){var $t=Vt.fire;return Vt.fire=function(er,Yr){var tn=arguments;return $t.length===1&&arguments.length!==1&&(tn=[vr({},{type:er},Yr)]),$t.apply(Vt,tn)},Q.map=Vt,Q.events=(function(er){var Yr=Object.keys(er.options.modes).reduce((function(Rr,fn){return Rr[fn]=zt(er.options.modes[fn]),Rr}),{}),tn={},Gr={},an={},Mr=null,ti=null;an.drag=function(Rr,fn){fn({point:Rr.point,time:new Date().getTime()})?(er.ui.queueMapClasses({mouse:x.DRAG}),ti.drag(Rr)):Rr.originalEvent.stopPropagation()},an.mousedrag=function(Rr){an.drag(Rr,(function(fn){return!ye(tn,fn)}))},an.touchdrag=function(Rr){an.drag(Rr,(function(fn){return!we(Gr,fn)}))},an.mousemove=function(Rr){if((Rr.originalEvent.buttons!==void 0?Rr.originalEvent.buttons:Rr.originalEvent.which)===1)return an.mousedrag(Rr);var fn=pe(Rr,er);Rr.featureTarget=fn,ti.mousemove(Rr)},an.mousedown=function(Rr){tn={time:new Date().getTime(),point:Rr.point};var fn=pe(Rr,er);Rr.featureTarget=fn,ti.mousedown(Rr)},an.mouseup=function(Rr){var fn=pe(Rr,er);Rr.featureTarget=fn,ye(tn,{point:Rr.point,time:new Date().getTime()})?ti.click(Rr):ti.mouseup(Rr)},an.mouseout=function(Rr){ti.mouseout(Rr)},an.touchstart=function(Rr){if(er.options.touchEnabled){Gr={time:new Date().getTime(),point:Rr.point};var fn=se.touch(Rr,null,er)[0];Rr.featureTarget=fn,ti.touchstart(Rr)}},an.touchmove=function(Rr){if(er.options.touchEnabled)return ti.touchmove(Rr),an.touchdrag(Rr)},an.touchend=function(Rr){if(Rr.originalEvent.preventDefault(),er.options.touchEnabled){var fn=se.touch(Rr,null,er)[0];Rr.featureTarget=fn,we(Gr,{time:new Date().getTime(),point:Rr.point})?ti.tap(Rr):ti.touchend(Rr)}};var ki=function(Rr){return!(Rr===8||Rr===46||Rr>=48&&Rr<=57)};function $n(Rr,fn,mn){mn===void 0&&(mn={}),ti.stop();var fi=Yr[Rr];if(fi===void 0)throw new Error(Rr+" is not valid");Mr=Rr;var $i=fi(er,fn);ti=r($i,er),mn.silent||er.map.fire(R.MODE_CHANGE,{mode:Rr}),er.store.setDirty(),er.store.render()}an.keydown=function(Rr){(Rr.srcElement||Rr.target).classList.contains("mapboxgl-canvas")&&(Rr.keyCode!==8&&Rr.keyCode!==46||!er.options.controls.trash?ki(Rr.keyCode)?ti.keydown(Rr):Rr.keyCode===49&&er.options.controls.point?$n(A.DRAW_POINT):Rr.keyCode===50&&er.options.controls.line_string?$n(A.DRAW_LINE_STRING):Rr.keyCode===51&&er.options.controls.polygon&&$n(A.DRAW_POLYGON):(Rr.preventDefault(),ti.trash()))},an.keyup=function(Rr){ki(Rr.keyCode)&&ti.keyup(Rr)},an.zoomend=function(){er.store.changeZoom()},an.data=function(Rr){if(Rr.dataType==="style"){var fn=er.setup,mn=er.map,fi=er.options,$i=er.store;fi.styles.some((function(ba){return mn.getLayer(ba.id)}))||(fn.addLayers(),$i.setDirty(),$i.render())}};var _n={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){Mr=er.options.defaultMode,ti=r(Yr[Mr](er),er)},changeMode:$n,actionable:function(Rr){var fn=!1;Object.keys(Rr).forEach((function(mn){if(_n[mn]===void 0)throw new Error("Invalid action type");_n[mn]!==Rr[mn]&&(fn=!0),_n[mn]=Rr[mn]})),fn&&er.map.fire(R.ACTIONABLE,{actions:_n})},currentModeName:function(){return Mr},currentModeRender:function(Rr,fn){return ti.render(Rr,fn)},fire:function(Rr,fn){an[Rr]&&an[Rr](fn)},addEventListeners:function(){er.map.on("mousemove",an.mousemove),er.map.on("mousedown",an.mousedown),er.map.on("mouseup",an.mouseup),er.map.on("data",an.data),er.map.on("touchmove",an.touchmove),er.map.on("touchstart",an.touchstart),er.map.on("touchend",an.touchend),er.container.addEventListener("mouseout",an.mouseout),er.options.keybindings&&(er.container.addEventListener("keydown",an.keydown),er.container.addEventListener("keyup",an.keyup))},removeEventListeners:function(){er.map.off("mousemove",an.mousemove),er.map.off("mousedown",an.mousedown),er.map.off("mouseup",an.mouseup),er.map.off("data",an.data),er.map.off("touchmove",an.touchmove),er.map.off("touchstart",an.touchstart),er.map.off("touchend",an.touchend),er.container.removeEventListener("mouseout",an.mouseout),er.options.keybindings&&(er.container.removeEventListener("keydown",an.keydown),er.container.removeEventListener("keyup",an.keyup))},trash:function(Rr){ti.trash(Rr)},combineFeatures:function(){ti.combineFeatures()},uncombineFeatures:function(){ti.uncombineFeatures()},getMode:function(){return Mr}}})(Q),Q.ui=(function(er){var Yr={},tn=null,Gr={mode:null,feature:null,mouse:null},an={mode:null,feature:null,mouse:null};function Mr(Rr){an=vr(an,Rr)}function ti(){var Rr,fn;if(er.container){var mn=[],fi=[];br.forEach((function($i){an[$i]!==Gr[$i]&&(mn.push($i+"-"+Gr[$i]),an[$i]!==null&&fi.push($i+"-"+an[$i]))})),mn.length>0&&(Rr=er.container.classList).remove.apply(Rr,mn),fi.length>0&&(fn=er.container.classList).add.apply(fn,fi),Gr=vr(Gr,an)}}function ki(Rr,fn){fn===void 0&&(fn={});var mn=document.createElement("button");return mn.className=m.CONTROL_BUTTON+" "+fn.className,mn.setAttribute("title",fn.title),fn.container.appendChild(mn),mn.addEventListener("click",(function(fi){if(fi.preventDefault(),fi.stopPropagation(),fi.target===tn)return $n(),void fn.onDeactivate();_n(Rr),fn.onActivate()}),!0),mn}function $n(){tn&&(tn.classList.remove(m.ACTIVE_BUTTON),tn=null)}function _n(Rr){$n();var fn=Yr[Rr];fn&&fn&&Rr!=="trash"&&(fn.classList.add(m.ACTIVE_BUTTON),tn=fn)}return{setActiveButton:_n,queueMapClasses:Mr,updateMapClasses:ti,clearMapClasses:function(){Mr({mode:null,feature:null,mouse:null}),ti()},addButtons:function(){var Rr=er.options.controls,fn=document.createElement("div");return fn.className=m.CONTROL_GROUP+" "+m.CONTROL_BASE,Rr&&(Rr[E.LINE]&&(Yr[E.LINE]=ki(E.LINE,{container:fn,className:m.CONTROL_BUTTON_LINE,title:"LineString tool "+(er.options.keybindings?"(l)":""),onActivate:function(){return er.events.changeMode(A.DRAW_LINE_STRING)},onDeactivate:function(){return er.events.trash()}})),Rr[E.POLYGON]&&(Yr[E.POLYGON]=ki(E.POLYGON,{container:fn,className:m.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(er.options.keybindings?"(p)":""),onActivate:function(){return er.events.changeMode(A.DRAW_POLYGON)},onDeactivate:function(){return er.events.trash()}})),Rr[E.POINT]&&(Yr[E.POINT]=ki(E.POINT,{container:fn,className:m.CONTROL_BUTTON_POINT,title:"Marker tool "+(er.options.keybindings?"(m)":""),onActivate:function(){return er.events.changeMode(A.DRAW_POINT)},onDeactivate:function(){return er.events.trash()}})),Rr.trash&&(Yr.trash=ki("trash",{container:fn,className:m.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){er.events.trash()}})),Rr.combine_features&&(Yr.combine_features=ki("combineFeatures",{container:fn,className:m.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){er.events.combineFeatures()}})),Rr.uncombine_features&&(Yr.uncombine_features=ki("uncombineFeatures",{container:fn,className:m.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){er.events.uncombineFeatures()}}))),fn},removeButtons:function(){Object.keys(Yr).forEach((function(Rr){var fn=Yr[Rr];fn.parentNode&&fn.parentNode.removeChild(fn),delete Yr[Rr]}))}}})(Q),Q.container=Vt.getContainer(),Q.store=new Jt(Q),ge=Q.ui.addButtons(),Q.options.boxSelect&&(Q.boxZoomInitial=Vt.boxZoom.isEnabled(),Vt.boxZoom.disable(),Vt.dragPan.disable(),Vt.dragPan.enable()),Vt.loaded()?It.connect():(Vt.on("load",It.connect),Je=setInterval((function(){Vt.loaded()&&It.connect()}),16)),Q.events.start(),ge},addLayers:function(){Q.map.addSource(b.COLD,{data:{type:T.FEATURE_COLLECTION,features:[]},type:"geojson"}),Q.map.addSource(b.HOT,{data:{type:T.FEATURE_COLLECTION,features:[]},type:"geojson"}),Q.options.styles.forEach((function(Vt){Q.map.addLayer(Vt)})),Q.store.setDirty(!0),Q.store.render()},removeLayers:function(){Q.options.styles.forEach((function(Vt){Q.map.getLayer(Vt.id)&&Q.map.removeLayer(Vt.id)})),Q.map.getSource(b.COLD)&&Q.map.removeSource(b.COLD),Q.map.getSource(b.HOT)&&Q.map.removeSource(b.HOT)}};return Q.setup=It,It}var Cr=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function Tr(Q){return function(ge){var Je=ge.featureTarget;return!!Je&&!!Je.properties&&Je.properties.meta===Q}}function Qt(Q){return!!Q.originalEvent&&!!Q.originalEvent.shiftKey&&Q.originalEvent.button===0}function at(Q){return!!Q.featureTarget&&!!Q.featureTarget.properties&&Q.featureTarget.properties.active===O.ACTIVE&&Q.featureTarget.properties.meta===N.FEATURE}function Pe(Q){return!!Q.featureTarget&&!!Q.featureTarget.properties&&Q.featureTarget.properties.active===O.INACTIVE&&Q.featureTarget.properties.meta===N.FEATURE}function be(Q){return Q.featureTarget===void 0}function je(Q){return!!Q.featureTarget&&!!Q.featureTarget.properties&&Q.featureTarget.properties.meta===N.FEATURE}function qe(Q){var ge=Q.featureTarget;return!!ge&&!!ge.properties&&ge.properties.meta===N.VERTEX}function Ge(Q){return!!Q.originalEvent&&Q.originalEvent.shiftKey===!0}function Nt(Q){return Q.keyCode===27}function Et(Q){return Q.keyCode===13}var mt=Object.freeze({__proto__:null,isOfMetaType:Tr,isShiftMousedown:Qt,isActiveFeature:at,isInactiveFeature:Pe,noTarget:be,isFeature:je,isVertex:qe,isShiftDown:Ge,isEscapeKey:Nt,isEnterKey:Et,isTrue:function(){return!0}}),ct=Kt;function Kt(Q,ge){this.x=Q,this.y=ge}Kt.prototype={clone:function(){return new Kt(this.x,this.y)},add:function(Q){return this.clone()._add(Q)},sub:function(Q){return this.clone()._sub(Q)},multByPoint:function(Q){return this.clone()._multByPoint(Q)},divByPoint:function(Q){return this.clone()._divByPoint(Q)},mult:function(Q){return this.clone()._mult(Q)},div:function(Q){return this.clone()._div(Q)},rotate:function(Q){return this.clone()._rotate(Q)},rotateAround:function(Q,ge){return this.clone()._rotateAround(Q,ge)},matMult:function(Q){return this.clone()._matMult(Q)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(Q){return this.x===Q.x&&this.y===Q.y},dist:function(Q){return Math.sqrt(this.distSqr(Q))},distSqr:function(Q){var ge=Q.x-this.x,Je=Q.y-this.y;return ge*ge+Je*Je},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(Q){return Math.atan2(this.y-Q.y,this.x-Q.x)},angleWith:function(Q){return this.angleWithSep(Q.x,Q.y)},angleWithSep:function(Q,ge){return Math.atan2(this.x*ge-this.y*Q,this.x*Q+this.y*ge)},_matMult:function(Q){var ge=Q[0]*this.x+Q[1]*this.y,Je=Q[2]*this.x+Q[3]*this.y;return this.x=ge,this.y=Je,this},_add:function(Q){return this.x+=Q.x,this.y+=Q.y,this},_sub:function(Q){return this.x-=Q.x,this.y-=Q.y,this},_mult:function(Q){return this.x*=Q,this.y*=Q,this},_div:function(Q){return this.x/=Q,this.y/=Q,this},_multByPoint:function(Q){return this.x*=Q.x,this.y*=Q.y,this},_divByPoint:function(Q){return this.x/=Q.x,this.y/=Q.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var Q=this.y;return this.y=this.x,this.x=-Q,this},_rotate:function(Q){var ge=Math.cos(Q),Je=Math.sin(Q),It=ge*this.x-Je*this.y,Vt=Je*this.x+ge*this.y;return this.x=It,this.y=Vt,this},_rotateAround:function(Q,ge){var Je=Math.cos(Q),It=Math.sin(Q),Vt=ge.x+Je*(this.x-ge.x)-It*(this.y-ge.y),$t=ge.y+It*(this.x-ge.x)+Je*(this.y-ge.y);return this.x=Vt,this.y=$t,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Kt.convert=function(Q){return Q instanceof Kt?Q:Array.isArray(Q)?new Kt(Q[0],Q[1]):Q};var qt=n(ct);function Ir(Q,ge){var Je=ge.getBoundingClientRect();return new qt(Q.clientX-Je.left-(ge.clientLeft||0),Q.clientY-Je.top-(ge.clientTop||0))}function Ar(Q,ge,Je,It){return{type:T.FEATURE,properties:{meta:N.VERTEX,parent:Q,coord_path:Je,active:It?O.ACTIVE:O.INACTIVE},geometry:{type:T.POINT,coordinates:ge}}}function $r(Q,ge,Je){var It=ge.geometry.coordinates,Vt=Je.geometry.coordinates;if(It[1]>85||It[1]<j||Vt[1]>85||Vt[1]<j)return null;var $t={lng:(It[0]+Vt[0])/2,lat:(It[1]+Vt[1])/2};return{type:T.FEATURE,properties:{meta:N.MIDPOINT,parent:Q,lng:$t.lng,lat:$t.lat,coord_path:Je.properties.coord_path},geometry:{type:T.POINT,coordinates:[$t.lng,$t.lat]}}}function cn(Q,ge,Je){ge===void 0&&(ge={}),Je===void 0&&(Je=null);var It,Vt=Q.geometry,$t=Vt.type,er=Vt.coordinates,Yr=Q.properties&&Q.properties.id,tn=[];function Gr(Mr,ti){var ki="",$n=null;Mr.forEach((function(_n,Rr){var fn=ti!=null?ti+"."+Rr:String(Rr),mn=Ar(Yr,_n,fn,an(fn));if(ge.midpoints&&$n){var fi=$r(Yr,$n,mn);fi&&tn.push(fi)}$n=mn;var $i=JSON.stringify(_n);ki!==$i&&tn.push(mn),Rr===0&&(ki=$i)}))}function an(Mr){return!!ge.selectedPaths&&ge.selectedPaths.indexOf(Mr)!==-1}return $t===T.POINT?tn.push(Ar(Yr,er,Je,an(Je))):$t===T.POLYGON?er.forEach((function(Mr,ti){Gr(Mr,Je!==null?Je+"."+ti:String(ti))})):$t===T.LINE_STRING?Gr(er,Je):$t.indexOf(T.MULTI_PREFIX)===0&&(It=$t.replace(T.MULTI_PREFIX,""),er.forEach((function(Mr,ti){var ki={type:T.FEATURE,properties:Q.properties,geometry:{type:It,coordinates:Mr}};tn=tn.concat(cn(ki,ge,ti))}))),tn}var zr={enable:function(Q){setTimeout((function(){Q.map&&Q.map.doubleClickZoom&&Q._ctx&&Q._ctx.store&&Q._ctx.store.getInitialConfigValue&&Q._ctx.store.getInitialConfigValue("doubleClickZoom")&&Q.map.doubleClickZoom.enable()}),0)},disable:function(Q){setTimeout((function(){Q.map&&Q.map.doubleClickZoom&&Q.map.doubleClickZoom.disable()}),0)}},Rt={exports:{}},en=function(Q){if(!Q||!Q.type)return null;var ge=jn[Q.type];if(!ge)return null;if(ge==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:Q}]};if(ge==="feature")return{type:"FeatureCollection",features:[Q]};if(ge==="featurecollection")return Q},jn={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Qr=n(en),nr=Object.freeze({__proto__:null,default:function Q(ge){switch(ge&&ge.type||null){case"FeatureCollection":return ge.features=ge.features.reduce((function(Je,It){return Je.concat(Q(It))}),[]),ge;case"Feature":return ge.geometry?Q(ge.geometry).map((function(Je){var It={type:"Feature",properties:JSON.parse(JSON.stringify(ge.properties)),geometry:Je};return ge.id!==void 0&&(It.id=ge.id),It})):[ge];case"MultiPoint":return ge.coordinates.map((function(Je){return{type:"Point",coordinates:Je}}));case"MultiPolygon":return ge.coordinates.map((function(Je){return{type:"Polygon",coordinates:Je}}));case"MultiLineString":return ge.coordinates.map((function(Je){return{type:"LineString",coordinates:Je}}));case"GeometryCollection":return ge.geometries.map(Q).reduce((function(Je,It){return Je.concat(It)}),[]);case"Point":case"Polygon":case"LineString":return[ge]}}}),oi=en,ln=i(nr),Kn=function(Q){return(function ge(Je){return Array.isArray(Je)&&Je.length&&typeof Je[0]=="number"?[Je]:Je.reduce((function(It,Vt){return Array.isArray(Vt)&&Array.isArray(Vt[0])?It.concat(ge(Vt)):(It.push(Vt),It)}),[])})(Q)};ln instanceof Function||(ln=ln.default);var ke={exports:{}},He=ke.exports=function(Q){return new Tt(Q)};function Tt(Q){this.value=Q}function Gt(Q,ge,Je){var It=[],Vt=[],$t=!0;return(function er(Yr){var tn=Je?Ut(Yr):Yr,Gr={},an=!0,Mr={node:tn,node_:Yr,path:[].concat(It),parent:Vt[Vt.length-1],parents:Vt,key:It.slice(-1)[0],isRoot:It.length===0,level:It.length,circular:null,update:function($n,_n){Mr.isRoot||(Mr.parent.node[Mr.key]=$n),Mr.node=$n,_n&&(an=!1)},delete:function($n){delete Mr.parent.node[Mr.key],$n&&(an=!1)},remove:function($n){Bi(Mr.parent.node)?Mr.parent.node.splice(Mr.key,1):delete Mr.parent.node[Mr.key],$n&&(an=!1)},keys:null,before:function($n){Gr.before=$n},after:function($n){Gr.after=$n},pre:function($n){Gr.pre=$n},post:function($n){Gr.post=$n},stop:function(){$t=!1},block:function(){an=!1}};if(!$t)return Mr;function ti(){if(typeof Mr.node=="object"&&Mr.node!==null){Mr.keys&&Mr.node_===Mr.node||(Mr.keys=Xr(Mr.node)),Mr.isLeaf=Mr.keys.length==0;for(var $n=0;$n<Vt.length;$n++)if(Vt[$n].node_===Yr){Mr.circular=Vt[$n];break}}else Mr.isLeaf=!0,Mr.keys=null;Mr.notLeaf=!Mr.isLeaf,Mr.notRoot=!Mr.isRoot}ti();var ki=ge.call(Mr,Mr.node);return ki!==void 0&&Mr.update&&Mr.update(ki),Gr.before&&Gr.before.call(Mr,Mr.node),an&&(typeof Mr.node!="object"||Mr.node===null||Mr.circular||(Vt.push(Mr),ti(),Ci(Mr.keys,(function($n,_n){It.push($n),Gr.pre&&Gr.pre.call(Mr,Mr.node[$n],$n);var Rr=er(Mr.node[$n]);Je&&Fr.call(Mr.node,$n)&&(Mr.node[$n]=Rr.node),Rr.isLast=_n==Mr.keys.length-1,Rr.isFirst=_n==0,Gr.post&&Gr.post.call(Mr,Rr),It.pop()})),Vt.pop()),Gr.after&&Gr.after.call(Mr,Mr.node)),Mr})(Q).node}function Ut(Q){if(typeof Q=="object"&&Q!==null){var ge;if(Bi(Q))ge=[];else if(Ln(Q)==="[object Date]")ge=new Date(Q.getTime?Q.getTime():Q);else if((function(Vt){return Ln(Vt)==="[object RegExp]"})(Q))ge=new RegExp(Q);else if((function(Vt){return Ln(Vt)==="[object Error]"})(Q))ge={message:Q.message};else if((function(Vt){return Ln(Vt)==="[object Boolean]"})(Q))ge=new Boolean(Q);else if((function(Vt){return Ln(Vt)==="[object Number]"})(Q))ge=new Number(Q);else if((function(Vt){return Ln(Vt)==="[object String]"})(Q))ge=new String(Q);else if(Object.create&&Object.getPrototypeOf)ge=Object.create(Object.getPrototypeOf(Q));else if(Q.constructor===Object)ge={};else{var Je=Q.constructor&&Q.constructor.prototype||Q.__proto__||{},It=function(){};It.prototype=Je,ge=new It}return Ci(Xr(Q),(function(Vt){ge[Vt]=Q[Vt]})),ge}return Q}Tt.prototype.get=function(Q){for(var ge=this.value,Je=0;Je<Q.length;Je++){var It=Q[Je];if(!ge||!Fr.call(ge,It)){ge=void 0;break}ge=ge[It]}return ge},Tt.prototype.has=function(Q){for(var ge=this.value,Je=0;Je<Q.length;Je++){var It=Q[Je];if(!ge||!Fr.call(ge,It))return!1;ge=ge[It]}return!0},Tt.prototype.set=function(Q,ge){for(var Je=this.value,It=0;It<Q.length-1;It++){var Vt=Q[It];Fr.call(Je,Vt)||(Je[Vt]={}),Je=Je[Vt]}return Je[Q[It]]=ge,ge},Tt.prototype.map=function(Q){return Gt(this.value,Q,!0)},Tt.prototype.forEach=function(Q){return this.value=Gt(this.value,Q,!1),this.value},Tt.prototype.reduce=function(Q,ge){var Je=arguments.length===1,It=Je?this.value:ge;return this.forEach((function(Vt){this.isRoot&&Je||(It=Q.call(this,It,Vt))})),It},Tt.prototype.paths=function(){var Q=[];return this.forEach((function(ge){Q.push(this.path)})),Q},Tt.prototype.nodes=function(){var Q=[];return this.forEach((function(ge){Q.push(this.node)})),Q},Tt.prototype.clone=function(){var Q=[],ge=[];return(function Je(It){for(var Vt=0;Vt<Q.length;Vt++)if(Q[Vt]===It)return ge[Vt];if(typeof It=="object"&&It!==null){var $t=Ut(It);return Q.push(It),ge.push($t),Ci(Xr(It),(function(er){$t[er]=Je(It[er])})),Q.pop(),ge.pop(),$t}return It})(this.value)};var Xr=Object.keys||function(Q){var ge=[];for(var Je in Q)ge.push(Je);return ge};function Ln(Q){return Object.prototype.toString.call(Q)}var Bi=Array.isArray||function(Q){return Object.prototype.toString.call(Q)==="[object Array]"},Ci=function(Q,ge){if(Q.forEach)return Q.forEach(ge);for(var Je=0;Je<Q.length;Je++)ge(Q[Je],Je,Q)};Ci(Xr(Tt.prototype),(function(Q){He[Q]=function(ge){var Je=[].slice.call(arguments,1),It=new Tt(ge);return It[Q].apply(It,Je)}}));var Fr=Object.hasOwnProperty||function(Q,ge){return ge in Q},Rn=ke.exports,Bn=ei;function ei(Q){if(!(this instanceof ei))return new ei(Q);this._bbox=Q||[1/0,1/0,-1/0,-1/0],this._valid=!!Q}ei.prototype.include=function(Q){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],Q[0]),this._bbox[1]=Math.min(this._bbox[1],Q[1]),this._bbox[2]=Math.max(this._bbox[2],Q[0]),this._bbox[3]=Math.max(this._bbox[3],Q[1]),this},ei.prototype.equals=function(Q){var ge;return ge=Q instanceof ei?Q.bbox():Q,this._bbox[0]==ge[0]&&this._bbox[1]==ge[1]&&this._bbox[2]==ge[2]&&this._bbox[3]==ge[3]},ei.prototype.center=function(Q){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},ei.prototype.union=function(Q){var ge;return this._valid=!0,ge=Q instanceof ei?Q.bbox():Q,this._bbox[0]=Math.min(this._bbox[0],ge[0]),this._bbox[1]=Math.min(this._bbox[1],ge[1]),this._bbox[2]=Math.max(this._bbox[2],ge[2]),this._bbox[3]=Math.max(this._bbox[3],ge[3]),this},ei.prototype.bbox=function(){return this._valid?this._bbox:null},ei.prototype.contains=function(Q){if(!Q)return this._fastContains();if(!this._valid)return null;var ge=Q[0],Je=Q[1];return this._bbox[0]<=ge&&this._bbox[1]<=Je&&this._bbox[2]>=ge&&this._bbox[3]>=Je},ei.prototype.intersect=function(Q){return this._valid?(ge=Q instanceof ei?Q.bbox():Q,!(this._bbox[0]>ge[2]||this._bbox[2]<ge[0]||this._bbox[3]<ge[1]||this._bbox[1]>ge[3])):null;var ge},ei.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var Q="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",Q)},ei.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var ua=function(Q){if(!Q)return[];var ge=ln(oi(Q)),Je=[];return ge.features.forEach((function(It){It.geometry&&(Je=Je.concat(Kn(It.geometry.coordinates)))})),Je},ha=Rn,zn=Bn,Na={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Wi=Object.keys(Na);function ds(Q){for(var ge=zn(),Je=ua(Q),It=0;It<Je.length;It++)ge.include(Je[It]);return ge}Rt.exports=function(Q){return ds(Q).bbox()},Rt.exports.polygon=function(Q){return ds(Q).polygon()},Rt.exports.bboxify=function(Q){return ha(Q).map((function(ge){ge&&Wi.some((function(Je){return!!ge[Je]&&Na[Je].indexOf(ge.type)!==-1}))&&(ge.bbox=ds(ge).bbox(),this.update(ge))}))};var Ca=n(Rt.exports),Do=-90;function Ya(Q,ge){var Je=Do,It=90,Vt=Do,$t=90,er=270,Yr=-270;Q.forEach((function(Gr){var an=Ca(Gr),Mr=an[1],ti=an[3],ki=an[0],$n=an[2];Mr>Je&&(Je=Mr),ti<It&&(It=ti),ti>Vt&&(Vt=ti),Mr<$t&&($t=Mr),ki<er&&(er=ki),$n>Yr&&(Yr=$n)}));var tn=ge;return Je+tn.lat>85&&(tn.lat=85-Je),Vt+tn.lat>90&&(tn.lat=90-Vt),It+tn.lat<-85&&(tn.lat=-85-It),$t+tn.lat<Do&&(tn.lat=Do-$t),er+tn.lng<=-270&&(tn.lng+=360*Math.ceil(Math.abs(tn.lng)/360)),Yr+tn.lng>=270&&(tn.lng-=360*Math.ceil(Math.abs(tn.lng)/360)),tn}function sl(Q,ge){var Je=Ya(Q.map((function(It){return It.toGeoJSON()})),ge);Q.forEach((function(It){var Vt,$t=It.getCoordinates(),er=function(tn){var Gr={lng:tn[0]+Je.lng,lat:tn[1]+Je.lat};return[Gr.lng,Gr.lat]},Yr=function(tn){return tn.map((function(Gr){return er(Gr)}))};It.type===T.POINT?Vt=er($t):It.type===T.LINE_STRING||It.type===T.MULTI_POINT?Vt=$t.map(er):It.type===T.POLYGON||It.type===T.MULTI_LINE_STRING?Vt=$t.map(Yr):It.type===T.MULTI_POLYGON&&(Vt=$t.map((function(tn){return tn.map((function(Gr){return Yr(Gr)}))}))),It.incomingCoords(Vt)}))}var xi={onSetup:function(Q){var ge=this,Je={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:Q.featureIds||[]};return this.setSelected(Je.initiallySelectedFeatureIds.filter((function(It){return ge.getFeature(It)!==void 0}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),Je},fireUpdate:function(){this.map.fire(R.UPDATE,{action:F.MOVE,features:this.getSelected().map((function(Q){return Q.toGeoJSON()}))})},fireActionable:function(){var Q=this,ge=this.getSelected(),Je=ge.filter((function(Yr){return Q.isInstanceOf("MultiFeature",Yr)})),It=!1;if(ge.length>1){It=!0;var Vt=ge[0].type.replace("Multi","");ge.forEach((function(Yr){Yr.type.replace("Multi","")!==Vt&&(It=!1)}))}var $t=Je.length>0,er=ge.length>0;this.setActionableState({combineFeatures:It,uncombineFeatures:$t,trash:er})},getUniqueIds:function(Q){return Q.length?Q.map((function(ge){return ge.properties.id})).filter((function(ge){return ge!==void 0})).reduce((function(ge,Je){return ge.add(Je),ge}),new G).values():[]},stopExtendedInteractions:function(Q){Q.boxSelectElement&&(Q.boxSelectElement.parentNode&&Q.boxSelectElement.parentNode.removeChild(Q.boxSelectElement),Q.boxSelectElement=null),this.map.dragPan.enable(),Q.boxSelecting=!1,Q.canBoxSelect=!1,Q.dragMoving=!1,Q.canDragMove=!1},onStop:function(){zr.enable(this)},onMouseMove:function(Q,ge){return je(ge)&&Q.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(Q),!0},onMouseOut:function(Q){return!Q.dragMoving||this.fireUpdate()}};xi.onTap=xi.onClick=function(Q,ge){return be(ge)?this.clickAnywhere(Q,ge):Tr(N.VERTEX)(ge)?this.clickOnVertex(Q,ge):je(ge)?this.clickOnFeature(Q,ge):void 0},xi.clickAnywhere=function(Q){var ge=this,Je=this.getSelectedIds();Je.length&&(this.clearSelectedFeatures(),Je.forEach((function(It){return ge.doRender(It)}))),zr.enable(this),this.stopExtendedInteractions(Q)},xi.clickOnVertex=function(Q,ge){this.changeMode(A.DIRECT_SELECT,{featureId:ge.featureTarget.properties.parent,coordPath:ge.featureTarget.properties.coord_path,startPos:ge.lngLat}),this.updateUIClasses({mouse:x.MOVE})},xi.startOnActiveFeature=function(Q,ge){this.stopExtendedInteractions(Q),this.map.dragPan.disable(),this.doRender(ge.featureTarget.properties.id),Q.canDragMove=!0,Q.dragMoveLocation=ge.lngLat},xi.clickOnFeature=function(Q,ge){var Je=this;zr.disable(this),this.stopExtendedInteractions(Q);var It=Ge(ge),Vt=this.getSelectedIds(),$t=ge.featureTarget.properties.id,er=this.isSelected($t);if(!It&&er&&this.getFeature($t).type!==T.POINT)return this.changeMode(A.DIRECT_SELECT,{featureId:$t});er&&It?(this.deselect($t),this.updateUIClasses({mouse:x.POINTER}),Vt.length===1&&zr.enable(this)):!er&&It?(this.select($t),this.updateUIClasses({mouse:x.MOVE})):er||It||(Vt.forEach((function(Yr){return Je.doRender(Yr)})),this.setSelected($t),this.updateUIClasses({mouse:x.MOVE})),this.doRender($t)},xi.onMouseDown=function(Q,ge){return at(ge)?this.startOnActiveFeature(Q,ge):this.drawConfig.boxSelect&&Qt(ge)?this.startBoxSelect(Q,ge):void 0},xi.startBoxSelect=function(Q,ge){this.stopExtendedInteractions(Q),this.map.dragPan.disable(),Q.boxSelectStartLocation=Ir(ge.originalEvent,this.map.getContainer()),Q.canBoxSelect=!0},xi.onTouchStart=function(Q,ge){if(at(ge))return this.startOnActiveFeature(Q,ge)},xi.onDrag=function(Q,ge){return Q.canDragMove?this.dragMove(Q,ge):this.drawConfig.boxSelect&&Q.canBoxSelect?this.whileBoxSelect(Q,ge):void 0},xi.whileBoxSelect=function(Q,ge){Q.boxSelecting=!0,this.updateUIClasses({mouse:x.ADD}),Q.boxSelectElement||(Q.boxSelectElement=document.createElement("div"),Q.boxSelectElement.classList.add(m.BOX_SELECT),this.map.getContainer().appendChild(Q.boxSelectElement));var Je=Ir(ge.originalEvent,this.map.getContainer()),It=Math.min(Q.boxSelectStartLocation.x,Je.x),Vt=Math.max(Q.boxSelectStartLocation.x,Je.x),$t=Math.min(Q.boxSelectStartLocation.y,Je.y),er=Math.max(Q.boxSelectStartLocation.y,Je.y),Yr="translate("+It+"px, "+$t+"px)";Q.boxSelectElement.style.transform=Yr,Q.boxSelectElement.style.WebkitTransform=Yr,Q.boxSelectElement.style.width=Vt-It+"px",Q.boxSelectElement.style.height=er-$t+"px"},xi.dragMove=function(Q,ge){Q.dragMoving=!0,ge.originalEvent.stopPropagation();var Je={lng:ge.lngLat.lng-Q.dragMoveLocation.lng,lat:ge.lngLat.lat-Q.dragMoveLocation.lat};sl(this.getSelected(),Je),Q.dragMoveLocation=ge.lngLat},xi.onTouchEnd=xi.onMouseUp=function(Q,ge){var Je=this;if(Q.dragMoving)this.fireUpdate();else if(Q.boxSelecting){var It=[Q.boxSelectStartLocation,Ir(ge.originalEvent,this.map.getContainer())],Vt=this.featuresAt(null,It,"click"),$t=this.getUniqueIds(Vt).filter((function(er){return!Je.isSelected(er)}));$t.length&&(this.select($t),$t.forEach((function(er){return Je.doRender(er)})),this.updateUIClasses({mouse:x.MOVE}))}this.stopExtendedInteractions(Q)},xi.toDisplayFeatures=function(Q,ge,Je){ge.properties.active=this.isSelected(ge.properties.id)?O.ACTIVE:O.INACTIVE,Je(ge),this.fireActionable(),ge.properties.active===O.ACTIVE&&ge.geometry.type!==T.POINT&&cn(ge).forEach(Je)},xi.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},xi.onCombineFeatures=function(){var Q=this.getSelected();if(!(Q.length===0||Q.length<2)){for(var ge=[],Je=[],It=Q[0].type.replace("Multi",""),Vt=0;Vt<Q.length;Vt++){var $t=Q[Vt];if($t.type.replace("Multi","")!==It)return;$t.type.includes("Multi")?$t.getCoordinates().forEach((function(Yr){ge.push(Yr)})):ge.push($t.getCoordinates()),Je.push($t.toGeoJSON())}if(Je.length>1){var er=this.newFeature({type:T.FEATURE,properties:Je[0].properties,geometry:{type:"Multi"+It,coordinates:ge}});this.addFeature(er),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([er.id]),this.map.fire(R.COMBINE_FEATURES,{createdFeatures:[er.toGeoJSON()],deletedFeatures:Je})}this.fireActionable()}},xi.onUncombineFeatures=function(){var Q=this,ge=this.getSelected();if(ge.length!==0){for(var Je=[],It=[],Vt=function(er){var Yr=ge[er];Q.isInstanceOf("MultiFeature",Yr)&&(Yr.getFeatures().forEach((function(tn){Q.addFeature(tn),tn.properties=Yr.properties,Je.push(tn.toGeoJSON()),Q.select([tn.id])})),Q.deleteFeature(Yr.id,{silent:!0}),It.push(Yr.toGeoJSON()))},$t=0;$t<ge.length;$t++)Vt($t);Je.length>1&&this.map.fire(R.UNCOMBINE_FEATURES,{createdFeatures:Je,deletedFeatures:It}),this.fireActionable()}};var zi=Tr(N.VERTEX),Iu=Tr(N.MIDPOINT),ma={fireUpdate:function(){this.map.fire(R.UPDATE,{action:F.CHANGE_COORDINATES,features:this.getSelected().map((function(Q){return Q.toGeoJSON()}))})},fireActionable:function(Q){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:Q.selectedCoordPaths.length>0})},startDragging:function(Q,ge){this.map.dragPan.disable(),Q.canDragMove=!0,Q.dragMoveLocation=ge.lngLat},stopDragging:function(Q){this.map.dragPan.enable(),Q.dragMoving=!1,Q.canDragMove=!1,Q.dragMoveLocation=null},onVertex:function(Q,ge){this.startDragging(Q,ge);var Je=ge.featureTarget.properties,It=Q.selectedCoordPaths.indexOf(Je.coord_path);Ge(ge)||It!==-1?Ge(ge)&&It===-1&&Q.selectedCoordPaths.push(Je.coord_path):Q.selectedCoordPaths=[Je.coord_path];var Vt=this.pathsToCoordinates(Q.featureId,Q.selectedCoordPaths);this.setSelectedCoordinates(Vt)},onMidpoint:function(Q,ge){this.startDragging(Q,ge);var Je=ge.featureTarget.properties;Q.feature.addCoordinate(Je.coord_path,Je.lng,Je.lat),this.fireUpdate(),Q.selectedCoordPaths=[Je.coord_path]},pathsToCoordinates:function(Q,ge){return ge.map((function(Je){return{feature_id:Q,coord_path:Je}}))},onFeature:function(Q,ge){Q.selectedCoordPaths.length===0?this.startDragging(Q,ge):this.stopDragging(Q)},dragFeature:function(Q,ge,Je){sl(this.getSelected(),Je),Q.dragMoveLocation=ge.lngLat},dragVertex:function(Q,ge,Je){for(var It=Q.selectedCoordPaths.map((function(Yr){return Q.feature.getCoordinate(Yr)})),Vt=Ya(It.map((function(Yr){return{type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:Yr}}})),Je),$t=0;$t<It.length;$t++){var er=It[$t];Q.feature.updateCoordinate(Q.selectedCoordPaths[$t],er[0]+Vt.lng,er[1]+Vt.lat)}},clickNoTarget:function(){this.changeMode(A.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(A.SIMPLE_SELECT)},clickActiveFeature:function(Q){Q.selectedCoordPaths=[],this.clearSelectedCoordinates(),Q.feature.changed()},onSetup:function(Q){var ge=Q.featureId,Je=this.getFeature(ge);if(!Je)throw new Error("You must provide a featureId to enter direct_select mode");if(Je.type===T.POINT)throw new TypeError("direct_select mode doesn't handle point features");var It={featureId:ge,feature:Je,dragMoveLocation:Q.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:Q.coordPath?[Q.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(ge,It.selectedCoordPaths)),this.setSelected(ge),zr.disable(this),this.setActionableState({trash:!0}),It},onStop:function(){zr.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(Q,ge,Je){Q.featureId===ge.properties.id?(ge.properties.active=O.ACTIVE,Je(ge),cn(ge,{map:this.map,midpoints:!0,selectedPaths:Q.selectedCoordPaths}).forEach(Je)):(ge.properties.active=O.INACTIVE,Je(ge)),this.fireActionable(Q)},onTrash:function(Q){Q.selectedCoordPaths.sort((function(ge,Je){return Je.localeCompare(ge,"en",{numeric:!0})})).forEach((function(ge){return Q.feature.removeCoordinate(ge)})),this.fireUpdate(),Q.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(Q),Q.feature.isValid()===!1&&(this.deleteFeature([Q.featureId]),this.changeMode(A.SIMPLE_SELECT,{}))},onMouseMove:function(Q,ge){var Je=at(ge),It=zi(ge),Vt=Iu(ge),$t=Q.selectedCoordPaths.length===0;return Je&&$t||It&&!$t?this.updateUIClasses({mouse:x.MOVE}):this.updateUIClasses({mouse:x.NONE}),(It||Je||Vt)&&Q.dragMoving&&this.fireUpdate(),this.stopDragging(Q),!0},onMouseOut:function(Q){return Q.dragMoving&&this.fireUpdate(),!0}};ma.onTouchStart=ma.onMouseDown=function(Q,ge){return zi(ge)?this.onVertex(Q,ge):at(ge)?this.onFeature(Q,ge):Iu(ge)?this.onMidpoint(Q,ge):void 0},ma.onDrag=function(Q,ge){if(Q.canDragMove===!0){Q.dragMoving=!0,ge.originalEvent.stopPropagation();var Je={lng:ge.lngLat.lng-Q.dragMoveLocation.lng,lat:ge.lngLat.lat-Q.dragMoveLocation.lat};Q.selectedCoordPaths.length>0?this.dragVertex(Q,ge,Je):this.dragFeature(Q,ge,Je),Q.dragMoveLocation=ge.lngLat}},ma.onClick=function(Q,ge){return be(ge)?this.clickNoTarget(Q,ge):at(ge)?this.clickActiveFeature(Q,ge):Pe(ge)?this.clickInactive(Q,ge):void this.stopDragging(Q)},ma.onTap=function(Q,ge){return be(ge)?this.clickNoTarget(Q,ge):at(ge)?this.clickActiveFeature(Q,ge):Pe(ge)?this.clickInactive(Q,ge):void 0},ma.onTouchEnd=ma.onMouseUp=function(Q){Q.dragMoving&&this.fireUpdate(),this.stopDragging(Q)};var Za={};function ps(Q,ge){return!!Q.lngLat&&Q.lngLat.lng===ge[0]&&Q.lngLat.lat===ge[1]}Za.onSetup=function(){var Q=this.newFeature({type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:[]}});return this.addFeature(Q),this.clearSelectedFeatures(),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(E.POINT),this.setActionableState({trash:!0}),{point:Q}},Za.stopDrawingAndRemove=function(Q){this.deleteFeature([Q.point.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)},Za.onTap=Za.onClick=function(Q,ge){this.updateUIClasses({mouse:x.MOVE}),Q.point.updateCoordinate("",ge.lngLat.lng,ge.lngLat.lat),this.map.fire(R.CREATE,{features:[Q.point.toGeoJSON()]}),this.changeMode(A.SIMPLE_SELECT,{featureIds:[Q.point.id]})},Za.onStop=function(Q){this.activateUIButton(),Q.point.getCoordinate().length||this.deleteFeature([Q.point.id],{silent:!0})},Za.toDisplayFeatures=function(Q,ge,Je){var It=ge.properties.id===Q.point.id;if(ge.properties.active=It?O.ACTIVE:O.INACTIVE,!It)return Je(ge)},Za.onTrash=Za.stopDrawingAndRemove,Za.onKeyUp=function(Q,ge){if(Nt(ge)||Et(ge))return this.stopDrawingAndRemove(Q,ge)};var Aa={onSetup:function(){var Q=this.newFeature({type:T.FEATURE,properties:{},geometry:{type:T.POLYGON,coordinates:[[]]}});return this.addFeature(Q),this.clearSelectedFeatures(),zr.disable(this),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(E.POLYGON),this.setActionableState({trash:!0}),{polygon:Q,currentVertexPosition:0}},clickAnywhere:function(Q,ge){if(Q.currentVertexPosition>0&&ps(ge,Q.polygon.coordinates[0][Q.currentVertexPosition-1]))return this.changeMode(A.SIMPLE_SELECT,{featureIds:[Q.polygon.id]});this.updateUIClasses({mouse:x.ADD}),Q.polygon.updateCoordinate("0."+Q.currentVertexPosition,ge.lngLat.lng,ge.lngLat.lat),Q.currentVertexPosition++,Q.polygon.updateCoordinate("0."+Q.currentVertexPosition,ge.lngLat.lng,ge.lngLat.lat)},clickOnVertex:function(Q){return this.changeMode(A.SIMPLE_SELECT,{featureIds:[Q.polygon.id]})},onMouseMove:function(Q,ge){Q.polygon.updateCoordinate("0."+Q.currentVertexPosition,ge.lngLat.lng,ge.lngLat.lat),qe(ge)&&this.updateUIClasses({mouse:x.POINTER})}};Aa.onTap=Aa.onClick=function(Q,ge){return qe(ge)?this.clickOnVertex(Q,ge):this.clickAnywhere(Q,ge)},Aa.onKeyUp=function(Q,ge){Nt(ge)?(this.deleteFeature([Q.polygon.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)):Et(ge)&&this.changeMode(A.SIMPLE_SELECT,{featureIds:[Q.polygon.id]})},Aa.onStop=function(Q){this.updateUIClasses({mouse:x.NONE}),zr.enable(this),this.activateUIButton(),this.getFeature(Q.polygon.id)!==void 0&&(Q.polygon.removeCoordinate("0."+Q.currentVertexPosition),Q.polygon.isValid()?this.map.fire(R.CREATE,{features:[Q.polygon.toGeoJSON()]}):(this.deleteFeature([Q.polygon.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT,{},{silent:!0})))},Aa.toDisplayFeatures=function(Q,ge,Je){var It=ge.properties.id===Q.polygon.id;if(ge.properties.active=It?O.ACTIVE:O.INACTIVE,!It)return Je(ge);if(ge.geometry.coordinates.length!==0){var Vt=ge.geometry.coordinates[0].length;if(!(Vt<3)){if(ge.properties.meta=N.FEATURE,Je(Ar(Q.polygon.id,ge.geometry.coordinates[0][0],"0.0",!1)),Vt>3){var $t=ge.geometry.coordinates[0].length-3;Je(Ar(Q.polygon.id,ge.geometry.coordinates[0][$t],"0."+$t,!1))}if(Vt<=4){var er=[[ge.geometry.coordinates[0][0][0],ge.geometry.coordinates[0][0][1]],[ge.geometry.coordinates[0][1][0],ge.geometry.coordinates[0][1][1]]];if(Je({type:T.FEATURE,properties:ge.properties,geometry:{coordinates:er,type:T.LINE_STRING}}),Vt===3)return}return Je(ge)}}},Aa.onTrash=function(Q){this.deleteFeature([Q.polygon.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)};var gs={onSetup:function(Q){var ge,Je,It=(Q=Q||{}).featureId,Vt="forward";if(It){if(!(ge=this.getFeature(It)))throw new Error("Could not find a feature with the provided featureId");var $t=Q.from;if($t&&$t.type==="Feature"&&$t.geometry&&$t.geometry.type==="Point"&&($t=$t.geometry),$t&&$t.type==="Point"&&$t.coordinates&&$t.coordinates.length===2&&($t=$t.coordinates),!$t||!Array.isArray($t))throw new Error("Please use the `from` property to indicate which point to continue the line from");var er=ge.coordinates.length-1;if(ge.coordinates[er][0]===$t[0]&&ge.coordinates[er][1]===$t[1])Je=er+1,ge.addCoordinate.apply(ge,[Je].concat(ge.coordinates[er]));else{if(ge.coordinates[0][0]!==$t[0]||ge.coordinates[0][1]!==$t[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Vt="backwards",Je=0,ge.addCoordinate.apply(ge,[Je].concat(ge.coordinates[0]))}}else ge=this.newFeature({type:T.FEATURE,properties:{},geometry:{type:T.LINE_STRING,coordinates:[]}}),Je=0,this.addFeature(ge);return this.clearSelectedFeatures(),zr.disable(this),this.updateUIClasses({mouse:x.ADD}),this.activateUIButton(E.LINE),this.setActionableState({trash:!0}),{line:ge,currentVertexPosition:Je,direction:Vt}},clickAnywhere:function(Q,ge){if(Q.currentVertexPosition>0&&ps(ge,Q.line.coordinates[Q.currentVertexPosition-1])||Q.direction==="backwards"&&ps(ge,Q.line.coordinates[Q.currentVertexPosition+1]))return this.changeMode(A.SIMPLE_SELECT,{featureIds:[Q.line.id]});this.updateUIClasses({mouse:x.ADD}),Q.line.updateCoordinate(Q.currentVertexPosition,ge.lngLat.lng,ge.lngLat.lat),Q.direction==="forward"?(Q.currentVertexPosition++,Q.line.updateCoordinate(Q.currentVertexPosition,ge.lngLat.lng,ge.lngLat.lat)):Q.line.addCoordinate(0,ge.lngLat.lng,ge.lngLat.lat)},clickOnVertex:function(Q){return this.changeMode(A.SIMPLE_SELECT,{featureIds:[Q.line.id]})},onMouseMove:function(Q,ge){Q.line.updateCoordinate(Q.currentVertexPosition,ge.lngLat.lng,ge.lngLat.lat),qe(ge)&&this.updateUIClasses({mouse:x.POINTER})}};gs.onTap=gs.onClick=function(Q,ge){if(qe(ge))return this.clickOnVertex(Q,ge);this.clickAnywhere(Q,ge)},gs.onKeyUp=function(Q,ge){Et(ge)?this.changeMode(A.SIMPLE_SELECT,{featureIds:[Q.line.id]}):Nt(ge)&&(this.deleteFeature([Q.line.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT))},gs.onStop=function(Q){zr.enable(this),this.activateUIButton(),this.getFeature(Q.line.id)!==void 0&&(Q.line.removeCoordinate(""+Q.currentVertexPosition),Q.line.isValid()?this.map.fire(R.CREATE,{features:[Q.line.toGeoJSON()]}):(this.deleteFeature([Q.line.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT,{},{silent:!0})))},gs.onTrash=function(Q){this.deleteFeature([Q.line.id],{silent:!0}),this.changeMode(A.SIMPLE_SELECT)},gs.toDisplayFeatures=function(Q,ge,Je){var It=ge.properties.id===Q.line.id;if(ge.properties.active=It?O.ACTIVE:O.INACTIVE,!It)return Je(ge);ge.geometry.coordinates.length<2||(ge.properties.meta=N.FEATURE,Je(Ar(Q.line.id,ge.geometry.coordinates[Q.direction==="forward"?ge.geometry.coordinates.length-2:1],""+(Q.direction==="forward"?ge.geometry.coordinates.length-2:1),!1)),Je(ge))};var Ul={simple_select:xi,direct_select:ma,draw_point:Za,draw_polygon:Aa,draw_line_string:gs},Fa={defaultMode:A.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Cr,modes:Ul,controls:{},userProperties:!1},_a={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},xc={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function ll(Q,ge){return Q.map((function(Je){return Je.source?Je:vr(Je,{id:Je.id+"."+ge,source:ge==="hot"?b.HOT:b.COLD})}))}var rs={exports:{}};(function(Q,ge){var Je="__lodash_hash_undefined__",It=9007199254740991,Vt="[object Arguments]",$t="[object Array]",er="[object Boolean]",Yr="[object Date]",tn="[object Error]",Gr="[object Function]",an="[object Map]",Mr="[object Number]",ti="[object Object]",ki="[object Promise]",$n="[object RegExp]",_n="[object Set]",Rr="[object String]",fn="[object Symbol]",mn="[object WeakMap]",fi="[object ArrayBuffer]",$i="[object DataView]",ba=/^\[object .+?Constructor\]$/,wi=/^(?:0|[1-9]\d*)$/,hi={};hi["[object Float32Array]"]=hi["[object Float64Array]"]=hi["[object Int8Array]"]=hi["[object Int16Array]"]=hi["[object Int32Array]"]=hi["[object Uint8Array]"]=hi["[object Uint8ClampedArray]"]=hi["[object Uint16Array]"]=hi["[object Uint32Array]"]=!0,hi[Vt]=hi[$t]=hi[fi]=hi[er]=hi[$i]=hi[Yr]=hi[tn]=hi[Gr]=hi[an]=hi[Mr]=hi[ti]=hi[$n]=hi[_n]=hi[Rr]=hi[mn]=!1;var Cs=typeof lg=="object"&&lg&&lg.Object===Object&&lg,$s=typeof self=="object"&&self&&self.Object===Object&&self,Ri=Cs||$s||Function("return this")(),As=ge&&!ge.nodeType&&ge,oa=As&&Q&&!Q.nodeType&&Q,Mu=oa&&oa.exports===As,Ka=Mu&&Cs.process,qs=(function(){try{return Ka&&Ka.binding&&Ka.binding("util")}catch{}})(),Vo=qs&&qs.isTypedArray;function ku(tr,mr){for(var hn=-1,In=tr==null?0:tr.length;++hn<In;)if(mr(tr[hn],hn,tr))return!0;return!1}function Ru(tr){var mr=-1,hn=Array(tr.size);return tr.forEach((function(In,vi){hn[++mr]=[vi,In]})),hn}function go(tr){var mr=-1,hn=Array(tr.size);return tr.forEach((function(In){hn[++mr]=In})),hn}var ji,Hs,ii,ri=Array.prototype,Oo=Function.prototype,ai=Object.prototype,ue=Ri["__core-js_shared__"],We=Oo.toString,bt=ai.hasOwnProperty,Bt=(ji=/[^.]+$/.exec(ue&&ue.keys&&ue.keys.IE_PROTO||""))?"Symbol(src)_1."+ji:"",sr=ai.toString,Lr=RegExp("^"+We.call(bt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zr=Mu?Ri.Buffer:void 0,Nn=Ri.Symbol,qn=Ri.Uint8Array,Un=ai.propertyIsEnumerable,ui=ri.splice,Hn=Nn?Nn.toStringTag:void 0,Ui=Object.getOwnPropertySymbols,Xi=Zr?Zr.isBuffer:void 0,ra=(Hs=Object.keys,ii=Object,function(tr){return Hs(ii(tr))}),Si=mo(Ri,"DataView"),Ia=mo(Ri,"Map"),za=mo(Ri,"Promise"),Gs=mo(Ri,"Set"),ul=mo(Ri,"WeakMap"),Ws=mo(Object,"create"),$o=Ks(Si),Xs=Ks(Ia),Pa=Ks(za),Ys=Ks(Gs),Il=Ks(ul),ms=Nn?Nn.prototype:void 0,Di=ms?ms.valueOf:void 0;function qo(tr){var mr=-1,hn=tr==null?0:tr.length;for(this.clear();++mr<hn;){var In=tr[mr];this.set(In[0],In[1])}}function Da(tr){var mr=-1,hn=tr==null?0:tr.length;for(this.clear();++mr<hn;){var In=tr[mr];this.set(In[0],In[1])}}function is(tr){var mr=-1,hn=tr==null?0:tr.length;for(this.clear();++mr<hn;){var In=tr[mr];this.set(In[0],In[1])}}function Is(tr){var mr=-1,hn=tr==null?0:tr.length;for(this.__data__=new is;++mr<hn;)this.add(tr[mr])}function Ja(tr){var mr=this.__data__=new Da(tr);this.size=mr.size}function nc(tr,mr){var hn=Vl(tr),In=!hn&&Va(tr),vi=!hn&&!In&&fl(tr),Pn=!hn&&!In&&!vi&&Hl(tr),I=hn||In||vi||Pn,y=I?(function($,ne){for(var ve=-1,Oe=Array($);++ve<$;)Oe[ve]=ne(ve);return Oe})(tr.length,String):[],_=y.length;for(var P in tr)!bt.call(tr,P)||I&&(P=="length"||vi&&(P=="offset"||P=="parent")||Pn&&(P=="buffer"||P=="byteLength"||P=="byteOffset")||fu(P,_))||y.push(P);return y}function uu(tr,mr){for(var hn=tr.length;hn--;)if(ys(tr[hn][0],mr))return hn;return-1}function Zs(tr){return tr==null?tr===void 0?"[object Undefined]":"[object Null]":Hn&&Hn in Object(tr)?(function(mr){var hn=bt.call(mr,Hn),In=mr[Hn];try{mr[Hn]=void 0;var vi=!0}catch{}var Pn=sr.call(mr);return vi&&(hn?mr[Hn]=In:delete mr[Hn]),Pn})(tr):(function(mr){return sr.call(mr)})(tr)}function ja(tr){return dl(tr)&&Zs(tr)==Vt}function Ps(tr,mr,hn,In,vi){return tr===mr||(tr==null||mr==null||!dl(tr)&&!dl(mr)?tr!=tr&&mr!=mr:(function(Pn,I,y,_,P,$){var ne=Vl(Pn),ve=Vl(I),Oe=ne?$t:Ua(Pn),tt=ve?$t:Ua(I),ft=(Oe=Oe==Vt?ti:Oe)==ti,rr=(tt=tt==Vt?ti:tt)==ti,ur=Oe==tt;if(ur&&fl(Pn)){if(!fl(I))return!1;ne=!0,ft=!1}if(ur&&!ft)return $||($=new Ja),ne||Hl(Pn)?cl(Pn,I,y,_,P,$):(function(Fn,En,na,ca,lo,Ma,Ho){switch(na){case $i:if(Fn.byteLength!=En.byteLength||Fn.byteOffset!=En.byteOffset)return!1;Fn=Fn.buffer,En=En.buffer;case fi:return!(Fn.byteLength!=En.byteLength||!Ma(new qn(Fn),new qn(En)));case er:case Yr:case Mr:return ys(+Fn,+En);case tn:return Fn.name==En.name&&Fn.message==En.message;case $n:case Rr:return Fn==En+"";case an:var Js=Ru;case _n:var Pl=1&ca;if(Js||(Js=go),Fn.size!=En.size&&!Pl)return!1;var hu=Ho.get(Fn);if(hu)return hu==En;ca|=2,Ho.set(Fn,En);var du=cl(Js(Fn),Js(En),ca,lo,Ma,Ho);return Ho.delete(Fn),du;case fn:if(Di)return Di.call(Fn)==Di.call(En)}return!1})(Pn,I,Oe,y,_,P,$);if(!(1&y)){var qr=ft&&bt.call(Pn,"__wrapped__"),bn=rr&&bt.call(I,"__wrapped__");if(qr||bn){var Dn=qr?Pn.value():Pn,Xn=bn?I.value():I;return $||($=new Ja),P(Dn,Xn,y,_,$)}}return ur?($||($=new Ja),(function(Fn,En,na,ca,lo,Ma){var Ho=1&na,Js=cu(Fn),Pl=Js.length,hu=cu(En).length;if(Pl!=hu&&!Ho)return!1;for(var du=Pl;du--;){var Ms=Js[du];if(!(Ho?Ms in En:bt.call(En,Ms)))return!1}var Gl=Ma.get(Fn);if(Gl&&Ma.get(En))return Gl==En;var Wl=!0;Ma.set(Fn,En),Ma.set(En,Fn);for(var To=Ho;++du<Pl;){var ni=Fn[Ms=Js[du]],Lu=En[Ms];if(ca)var eh=Ho?ca(Lu,ni,Ms,En,Fn,Ma):ca(ni,Lu,Ms,Fn,En,Ma);if(!(eh===void 0?ni===Lu||lo(ni,Lu,na,ca,Ma):eh)){Wl=!1;break}To||(To=Ms=="constructor")}if(Wl&&!To){var yf=Fn.constructor,pu=En.constructor;yf==pu||!("constructor"in Fn)||!("constructor"in En)||typeof yf=="function"&&yf instanceof yf&&typeof pu=="function"&&pu instanceof pu||(Wl=!1)}return Ma.delete(Fn),Ma.delete(En),Wl})(Pn,I,y,_,P,$)):!1})(tr,mr,hn,In,Ps,vi))}function ic(tr){return!(!ql(tr)||(function(mr){return!!Bt&&Bt in mr})(tr))&&(hl(tr)?Lr:ba).test(Ks(tr))}function ac(tr){if(hn=(mr=tr)&&mr.constructor,In=typeof hn=="function"&&hn.prototype||ai,mr!==In)return ra(tr);var mr,hn,In,vi=[];for(var Pn in Object(tr))bt.call(tr,Pn)&&Pn!="constructor"&&vi.push(Pn);return vi}function cl(tr,mr,hn,In,vi,Pn){var I=1&hn,y=tr.length,_=mr.length;if(y!=_&&!(I&&_>y))return!1;var P=Pn.get(tr);if(P&&Pn.get(mr))return P==mr;var $=-1,ne=!0,ve=2&hn?new Is:void 0;for(Pn.set(tr,mr),Pn.set(mr,tr);++$<y;){var Oe=tr[$],tt=mr[$];if(In)var ft=I?In(tt,Oe,$,mr,tr,Pn):In(Oe,tt,$,tr,mr,Pn);if(ft!==void 0){if(ft)continue;ne=!1;break}if(ve){if(!ku(mr,(function(rr,ur){if(qr=ur,!ve.has(qr)&&(Oe===rr||vi(Oe,rr,hn,In,Pn)))return ve.push(ur);var qr}))){ne=!1;break}}else if(Oe!==tt&&!vi(Oe,tt,hn,In,Pn)){ne=!1;break}}return Pn.delete(tr),Pn.delete(mr),ne}function cu(tr){return(function(mr,hn,In){var vi=hn(mr);return Vl(mr)?vi:(function(Pn,I){for(var y=-1,_=I.length,P=Pn.length;++y<_;)Pn[P+y]=I[y];return Pn})(vi,In(mr))})(tr,Ou,Du)}function Lo(tr,mr){var hn,In,vi=tr.__data__;return((In=typeof(hn=mr))=="string"||In=="number"||In=="symbol"||In=="boolean"?hn!=="__proto__":hn===null)?vi[typeof mr=="string"?"string":"hash"]:vi.map}function mo(tr,mr){var hn=(function(In,vi){return In?.[vi]})(tr,mr);return ic(hn)?hn:void 0}qo.prototype.clear=function(){this.__data__=Ws?Ws(null):{},this.size=0},qo.prototype.delete=function(tr){var mr=this.has(tr)&&delete this.__data__[tr];return this.size-=mr?1:0,mr},qo.prototype.get=function(tr){var mr=this.__data__;if(Ws){var hn=mr[tr];return hn===Je?void 0:hn}return bt.call(mr,tr)?mr[tr]:void 0},qo.prototype.has=function(tr){var mr=this.__data__;return Ws?mr[tr]!==void 0:bt.call(mr,tr)},qo.prototype.set=function(tr,mr){var hn=this.__data__;return this.size+=this.has(tr)?0:1,hn[tr]=Ws&&mr===void 0?Je:mr,this},Da.prototype.clear=function(){this.__data__=[],this.size=0},Da.prototype.delete=function(tr){var mr=this.__data__,hn=uu(mr,tr);return!(hn<0)&&(hn==mr.length-1?mr.pop():ui.call(mr,hn,1),--this.size,!0)},Da.prototype.get=function(tr){var mr=this.__data__,hn=uu(mr,tr);return hn<0?void 0:mr[hn][1]},Da.prototype.has=function(tr){return uu(this.__data__,tr)>-1},Da.prototype.set=function(tr,mr){var hn=this.__data__,In=uu(hn,tr);return In<0?(++this.size,hn.push([tr,mr])):hn[In][1]=mr,this},is.prototype.clear=function(){this.size=0,this.__data__={hash:new qo,map:new(Ia||Da),string:new qo}},is.prototype.delete=function(tr){var mr=Lo(this,tr).delete(tr);return this.size-=mr?1:0,mr},is.prototype.get=function(tr){return Lo(this,tr).get(tr)},is.prototype.has=function(tr){return Lo(this,tr).has(tr)},is.prototype.set=function(tr,mr){var hn=Lo(this,tr),In=hn.size;return hn.set(tr,mr),this.size+=hn.size==In?0:1,this},Is.prototype.add=Is.prototype.push=function(tr){return this.__data__.set(tr,Je),this},Is.prototype.has=function(tr){return this.__data__.has(tr)},Ja.prototype.clear=function(){this.__data__=new Da,this.size=0},Ja.prototype.delete=function(tr){var mr=this.__data__,hn=mr.delete(tr);return this.size=mr.size,hn},Ja.prototype.get=function(tr){return this.__data__.get(tr)},Ja.prototype.has=function(tr){return this.__data__.has(tr)},Ja.prototype.set=function(tr,mr){var hn=this.__data__;if(hn instanceof Da){var In=hn.__data__;if(!Ia||In.length<199)return In.push([tr,mr]),this.size=++hn.size,this;hn=this.__data__=new is(In)}return hn.set(tr,mr),this.size=hn.size,this};var Du=Ui?function(tr){return tr==null?[]:(tr=Object(tr),(function(mr,hn){for(var In=-1,vi=mr==null?0:mr.length,Pn=0,I=[];++In<vi;){var y=mr[In];hn(y,In,mr)&&(I[Pn++]=y)}return I})(Ui(tr),(function(mr){return Un.call(tr,mr)})))}:function(){return[]},Ua=Zs;function fu(tr,mr){return!!(mr=mr??It)&&(typeof tr=="number"||wi.test(tr))&&tr>-1&&tr%1==0&&tr<mr}function Ks(tr){if(tr!=null){try{return We.call(tr)}catch{}try{return tr+""}catch{}}return""}function ys(tr,mr){return tr===mr||tr!=tr&&mr!=mr}(Si&&Ua(new Si(new ArrayBuffer(1)))!=$i||Ia&&Ua(new Ia)!=an||za&&Ua(za.resolve())!=ki||Gs&&Ua(new Gs)!=_n||ul&&Ua(new ul)!=mn)&&(Ua=function(tr){var mr=Zs(tr),hn=mr==ti?tr.constructor:void 0,In=hn?Ks(hn):"";if(In)switch(In){case $o:return $i;case Xs:return an;case Pa:return ki;case Ys:return _n;case Il:return mn}return mr});var Va=ja((function(){return arguments})())?ja:function(tr){return dl(tr)&&bt.call(tr,"callee")&&!Un.call(tr,"callee")},Vl=Array.isArray,fl=Xi||function(){return!1};function hl(tr){if(!ql(tr))return!1;var mr=Zs(tr);return mr==Gr||mr=="[object GeneratorFunction]"||mr=="[object AsyncFunction]"||mr=="[object Proxy]"}function $l(tr){return typeof tr=="number"&&tr>-1&&tr%1==0&&tr<=It}function ql(tr){var mr=typeof tr;return tr!=null&&(mr=="object"||mr=="function")}function dl(tr){return tr!=null&&typeof tr=="object"}var Hl=Vo?(function(tr){return function(mr){return tr(mr)}})(Vo):function(tr){return dl(tr)&&$l(tr.length)&&!!hi[Zs(tr)]};function Ou(tr){return(mr=tr)!=null&&$l(mr.length)&&!hl(mr)?nc(tr):ac(tr);var mr}Q.exports=function(tr,mr){return Ps(tr,mr)}})(rs,rs.exports);var so=n(rs.exports);function ns(Q,ge){return Q.length===ge.length&&JSON.stringify(Q.map((function(Je){return Je})).sort())===JSON.stringify(ge.map((function(Je){return Je})).sort())}var Ba={Polygon:Fe,LineString:Ne,Point:xe,MultiPolygon:ot,MultiLineString:ot,MultiPoint:ot},Vs=Object.freeze({__proto__:null,CommonSelectors:mt,constrainFeatureMovement:Ya,createMidPoint:$r,createSupplementaryPoints:cn,createVertex:Ar,doubleClickZoom:zr,euclideanDistance:De,featuresAt:se,getFeatureAtAndSetCursors:pe,isClick:ye,isEventAtCoordinates:ps,isTap:we,mapEventToBoundingBox:ee,ModeHandler:r,moveFeatures:sl,sortFeatures:oe,stringSetsAreEqual:ns,StringSet:G,theme:Cr,toDenseArray:st}),Uc=function(Q,ge){var Je={options:Q=(function(Vt){Vt===void 0&&(Vt={});var $t=vr(Vt);return Vt.controls||($t.controls={}),Vt.displayControlsDefault===!1?$t.controls=vr(xc,Vt.controls):$t.controls=vr(_a,Vt.controls),($t=vr(Fa,$t)).styles=ll($t.styles,"cold").concat(ll($t.styles,"hot")),$t})(Q)};ge=(function(Vt,$t){return $t.modes=A,$t.getFeatureIdsAt=function(er){return se.click({point:er},null,Vt).map((function(Yr){return Yr.properties.id}))},$t.getSelectedIds=function(){return Vt.store.getSelectedIds()},$t.getSelected=function(){return{type:T.FEATURE_COLLECTION,features:Vt.store.getSelectedIds().map((function(er){return Vt.store.get(er)})).map((function(er){return er.toGeoJSON()}))}},$t.getSelectedPoints=function(){return{type:T.FEATURE_COLLECTION,features:Vt.store.getSelectedCoordinates().map((function(er){return{type:T.FEATURE,properties:{},geometry:{type:T.POINT,coordinates:er.coordinates}}}))}},$t.set=function(er){if(er.type===void 0||er.type!==T.FEATURE_COLLECTION||!Array.isArray(er.features))throw new Error("Invalid FeatureCollection");var Yr=Vt.store.createRenderBatch(),tn=Vt.store.getAllIds().slice(),Gr=$t.add(er),an=new G(Gr);return(tn=tn.filter((function(Mr){return!an.has(Mr)}))).length&&$t.delete(tn),Yr(),Gr},$t.add=function(er){var Yr=JSON.parse(JSON.stringify(Qr(er))).features.map((function(tn){if(tn.id=tn.id||de(),tn.geometry===null)throw new Error("Invalid geometry: null");if(Vt.store.get(tn.id)===void 0||Vt.store.get(tn.id).type!==tn.geometry.type){var Gr=Ba[tn.geometry.type];if(Gr===void 0)throw new Error("Invalid geometry type: "+tn.geometry.type+".");var an=new Gr(Vt,tn);Vt.store.add(an)}else{var Mr=Vt.store.get(tn.id);Mr.properties=tn.properties,so(Mr.properties,tn.properties)||Vt.store.featureChanged(Mr.id),so(Mr.getCoordinates(),tn.geometry.coordinates)||Mr.incomingCoords(tn.geometry.coordinates)}return tn.id}));return Vt.store.render(),Yr},$t.get=function(er){var Yr=Vt.store.get(er);if(Yr)return Yr.toGeoJSON()},$t.getAll=function(){return{type:T.FEATURE_COLLECTION,features:Vt.store.getAll().map((function(er){return er.toGeoJSON()}))}},$t.delete=function(er){return Vt.store.delete(er,{silent:!0}),$t.getMode()!==A.DIRECT_SELECT||Vt.store.getSelectedIds().length?Vt.store.render():Vt.events.changeMode(A.SIMPLE_SELECT,void 0,{silent:!0}),$t},$t.deleteAll=function(){return Vt.store.delete(Vt.store.getAllIds(),{silent:!0}),$t.getMode()===A.DIRECT_SELECT?Vt.events.changeMode(A.SIMPLE_SELECT,void 0,{silent:!0}):Vt.store.render(),$t},$t.changeMode=function(er,Yr){return Yr===void 0&&(Yr={}),er===A.SIMPLE_SELECT&&$t.getMode()===A.SIMPLE_SELECT?(ns(Yr.featureIds||[],Vt.store.getSelectedIds())||(Vt.store.setSelected(Yr.featureIds,{silent:!0}),Vt.store.render()),$t):(er===A.DIRECT_SELECT&&$t.getMode()===A.DIRECT_SELECT&&Yr.featureId===Vt.store.getSelectedIds()[0]||Vt.events.changeMode(er,Yr,{silent:!0}),$t)},$t.getMode=function(){return Vt.events.getMode()},$t.trash=function(){return Vt.events.trash({silent:!0}),$t},$t.combineFeatures=function(){return Vt.events.combineFeatures({silent:!0}),$t},$t.uncombineFeatures=function(){return Vt.events.uncombineFeatures({silent:!0}),$t},$t.setFeatureProperty=function(er,Yr,tn){return Vt.store.setFeatureProperty(er,Yr,tn),$t},$t})(Je,ge),Je.api=ge;var It=lr(Je);return ge.onAdd=It.onAdd,ge.onRemove=It.onRemove,ge.types=E,ge.options=Q,ge};function Pu(Q){Uc(Q,this)}return Pu.modes=Ul,Pu.constants=H,Pu.lib=Vs,Pu}))})(yS)),yS.exports}var MSe=PSe();const Xj=Cd(MSe);function kSe(){const t=kx(r=>r.breakpoints.down("md"));return[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#009EE0","fill-outline-color":"#009EE0","fill-opacity":.3}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#009EE0","fill-outline-color":"#009EE0","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-width":3}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-width":4}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#009EE0","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":t?5:4,"circle-color":"#ffffff","circle-stroke-color":"#009EE0","circle-stroke-width":1}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":t?8:6,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":t?7:5,"circle-color":"#ffffff","circle-stroke-color":"#009EE0","circle-stroke-width":1}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":t?10:9,"circle-opacity":1,"circle-color":"#009EE0"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":t?7.5:6.5,"circle-color":"#009EE0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":t?11:10,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":t?8.5:7.5,"circle-color":"#009EE0"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":t?8.5:6.5,"circle-color":"#404040"}}]}const Fk=t=>{const e=te.useRef(null),r=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),n=te.useRef(!1),[i,a]=te.useState(!1),[s,o]=te.useState(),c=kSe(),f=te.useCallback(d=>{console.log("MlFeatureEditor mode change to "+d.mode),typeof t.onFinish=="function"&&d.mode==="simple_select"&&t.onFinish()},[t.onFinish]);return te.useEffect(()=>{r.map&&!n.current&&(n.current=!0,r.map.map.style&&r.map.map.getSource("mapbox-gl-draw-cold")&&e.current&&e.current?.remove(),e.current=new Xj({displayControlsDefault:!1,defaultMode:t.mode||"simple_select",modes:Object.assign({},Xj.modes),userProperties:!0,styles:c}),r.map.addControl(e.current,"top-left",r.componentId),r.map.on("draw.modechange",f,r.componentId),a(!0))},[r.map,t,n,f]),te.useEffect(()=>{if(!r.map||!i||!e.current)return;const d=m=>{const b=m?.features||[];o(b),t.onChange&&t.onChange(b)};return r.map.on("draw.create",d,r.componentId),r.map.on("draw.update",d,r.componentId),r.map.on("draw.delete",d,r.componentId),()=>{r.map&&(r.map.map.off("draw.create",d),r.map.map.off("draw.update",d),r.map.map.off("draw.delete",d))}},[i,r.map,t.onChange]),te.useEffect(()=>{e.current&&t.geojson?.geometry&&e.current.set({type:"FeatureCollection",features:[t.geojson]})},[t.geojson,i]),te.useEffect(()=>{t.mode&&e.current&&e.current?.getMode?.()!==t.mode&&(e.current?.changeMode?.(t.mode),t.mode!=="simple_select"&&t.mode!=="direct_select"&&e.current.set({type:"FeatureCollection",features:[]}))},[t.mode,r.map]),{feature:s,drawToolsReady:i,draw:e.current}};try{Fk.displayName="useFeatureEditor",Fk.__docgenInfo={description:"GeoJson Feature editor that allows to create or manipulate GeoJson data",displayName:"useFeatureEditor",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"Input GeoJson data at initialization",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | undefined"}},onChange:{defaultValue:null,description:`Callback function that is called each time the GeoJson data has changed within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((para: Feature<Geometry, GeoJsonProperties>[]) => void) | undefined"}},onFinish:{defaultValue:null,description:`Callback function that is called each time the GeoJson data within has been finished within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}},mode:{defaultValue:null,description:`Feature editor modes:
- draw_line_string
- draw_polygon
- draw_point
- simple_select
- direct_select`,name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"draw_line_string"'},{value:'"draw_polygon"'},{value:'"draw_point"'},{value:'"simple_select"'},{value:'"direct_select"'}]}}}}}catch{}const pE=t=>(Fk({mode:t.mode,geojson:t.geojson,onChange:t.onChange,onFinish:t.onFinish,mapId:t.mapId}),J.jsx(J.Fragment,{}));try{pE.displayName="MlFeatureEditor",pE.__docgenInfo={description:"",displayName:"MlFeatureEditor",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"Input GeoJson data at initialization",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | undefined"}},onChange:{defaultValue:null,description:`Callback function that is called each time the GeoJson data has changed within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((para: Feature<Geometry, GeoJsonProperties>[]) => void) | undefined"}},onFinish:{defaultValue:null,description:`Callback function that is called each time the GeoJson data within has been finished within MlFeatureEditor.
First parameter is the new GeoJson feature.`,name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}},mode:{defaultValue:null,description:`Feature editor modes:
- draw_line_string
- draw_polygon
- draw_point
- simple_select
- direct_select`,name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"draw_line_string"'},{value:'"draw_polygon"'},{value:'"draw_point"'},{value:'"simple_select"'},{value:'"direct_select"'}]}}}}}catch{}const Yj=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","hillshade","background"];function RSe(t){return typeof t.options.source=="string"?{source:t.options.source}:t.geojson&&(!t.options?.source||typeof t?.options?.source!="string"&&t.options?.source?.attribution&&!t.options?.source?.type)?{source:{type:"geojson",data:t.geojson||"",attribution:typeof t?.options?.source!="string"&&t.options.source?.attribution?t.options.source?.attribution:""}}:{}}function DSe(t,e){if(t?.insertBeforeLayer)return t.insertBeforeLayer;if(t?.insertBeforeFirstSymbolLayer)return e?.map?.firstSymbolLayer}function wp(t){const e=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=te.useRef(""),n=te.useRef(""),i=te.useRef(""),[a,s]=te.useState(),o=te.useRef(t.layerId||(t.idPrefix?t.idPrefix:"Layer-")+e.componentId),c=te.useCallback(()=>{if(!e.map||e?.map.cancelled||(e.map.map.getLayer(o.current)&&e.cleanup(),typeof t?.options?.source!="string"&&e.map.map.getSource(o.current)&&e.map.map.removeSource(o.current),typeof t.options.source=="string"&&(t.options.source===""||!e.map.map.getSource(t.options.source)))||typeof t?.options?.source!="string"&&!t.geojson&&!t?.options?.source?.data&&t?.options?.type!=="background"||typeof t.options.type>"u")return;try{e.map.addLayer({...t.options,...RSe(t),id:o.current},DSe(t,e),e.componentId)}catch(m){console.error("Failed to add layer:",m)}s(()=>e.map?.map.getLayer(o.current));const f=()=>{e.map?.map.getLayer(o.current)||c()};e.map.on("styledata",f,e.componentId);const d=(m,b,{source_id:x})=>{e.map&&typeof t?.options?.source=="string"&&t.options.source===x&&c()};e.map.wrapper.on("addsource",d,e.componentId),n.current=JSON.stringify(t.options?.paint),i.current=JSON.stringify(t.options?.layout),r.current=t.options.type},[t,e]);return te.useEffect(()=>{e.map&&(!t.geojson&&!t.options.source&&t?.options?.type!=="background"||e.map?.cancelled===!1&&e?.map?.map?.getLayer?.(o.current)&&(Yj.indexOf(t.options.type)===-1||Yj.indexOf(t.options.type)!==-1&&t.options.type===r.current)||c())},[e.map,e.mapIsReady,t,c]),te.useEffect(()=>{e.map?.cancelled===!0||!e.map?.map?.getSource?.(o.current)||e.map.map.getSource(o.current)?.setData?.(t.geojson)},[t.geojson,e.map,t.options.type]),te.useEffect(()=>{if(e.map?.cancelled===!0||!e.map||!e.map?.map?.getLayer?.(o.current)||t.options.type!==r.current)return;let f;const d=JSON.stringify(t.options.layout);if(t.options.layout&&d!==i.current){const b=JSON.parse(i.current);for(f in t.options.layout)t.options.layout?.[f]&&t.options.layout[f]!==b[f]&&e.map.map.setLayoutProperty(o.current,f,t.options.layout[f]);i.current=d}const m=JSON.stringify(t.options.paint);if(m!==n.current){const b=JSON.parse(n.current);for(f in t.options.paint)t.options.paint?.[f]&&t.options.paint[f]!==b[f]&&e.map.map.setPaintProperty(o.current,f,t.options.paint[f]);n.current=m}},[t.options,e.map]),te.useEffect(()=>{!t.insertBeforeLayer||!e.map||!e.map.getLayer(t.insertBeforeLayer)||!e.map.getLayer(o.current)||e.map.moveLayer(o.current,t.insertBeforeLayer)},[e.map,t.insertBeforeLayer]),te.useEffect(()=>()=>{e.cleanup()},[]),te.useEffect(()=>{if(typeof t?.options?.source!="string"||!e.map)return;const f=()=>{typeof t?.options?.source=="string"&&e?.map?.getSource?.(t.options.source)&&!e.map.getLayer(o.current)&&c()};e.map.on("sourcedataloading",f);const d=(m,b,{source_id:x})=>{e.map&&typeof t?.options?.source=="string"&&t.options.source===x&&c()};return e.map.wrapper.on("addsource",d),()=>{e?.map&&(e.map.off("sourcedataloading",f),e.map.wrapper.off("addsource",d))}},[e.map,t.options?.source]),te.useEffect(()=>{if(!t.onClick||!e?.map||!e?.map?.getLayer?.(o.current))return;const f=t.onClick;return e.map?.on("click",o.current,f),()=>{f&&e?.map&&e.map?.off("click",o.current,f)}},[e.map,t.onClick]),te.useEffect(()=>{if(!t.onHover||!e?.map||!e?.map?.getLayer?.(o.current))return;const f=t.onHover;return e.map?.on("mousemove",o.current,f),()=>{f&&e?.map&&e.map?.off("mousemove",o.current,f)}},[e.map,t.onHover]),te.useEffect(()=>{if(!t.onLeave||!e?.map||!e?.map?.getLayer?.(o.current))return;const f=t.onLeave;return e.map?.on("mouseleave",o.current,f),()=>{f&&e?.map&&e.map?.off("mouseleave",o.current,f)}},[e.map,t.onLeave]),{map:e.map,layer:a,layerId:o.current,componentId:e.componentId,mapHook:e}}wp.defaultProps={};const Bk=t=>(wp({mapId:t.mapId,layerId:t.layerId||"MlFillExtrusionLayer-"+vc(),options:{id:"",type:"fill-extrusion",source:t.sourceId||"openmaptiles","source-layer":t.sourceLayer||"building",minzoom:t.minZoom||6,paint:{...t.paint}},insertBeforeFirstSymbolLayer:!0}),J.jsx(J.Fragment,{}));Bk.defaultProps={mapId:void 0,paint:{"fill-extrusion-color":"hsl(196, 61%, 83%)","fill-extrusion-height":{property:"render_height",type:"identity"},"fill-extrusion-base":{property:"render_min_height",type:"identity"},"fill-extrusion-opacity":1}};try{Bk.displayName="MlFillExtrusionLayer",Bk.__docgenInfo={description:"Adds a fill extrusion layer to the MapLibre instance reference by props.mapId",displayName:"MlFillExtrusionLayer",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component",name:"layerId",required:!1,type:{name:"string | undefined"}},paint:{defaultValue:{value:`{
		'fill-extrusion-color': 'hsl(196, 61%, 83%)',
		'fill-extrusion-height': {
			property: 'render_height',
			type: 'identity',
		},
		'fill-extrusion-base': {
			property: 'render_min_height',
			type: 'identity',
		},
		'fill-extrusion-opacity': 1,
	}`},description:`Paint properties of the config object that is passed to the MapLibreGl.addLayer call. All
available properties are documented in the MapLibreGl documentation
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill-extrusion`,name:"paint",required:!1,type:{name:"object | undefined"}},sourceId:{defaultValue:null,description:`Source id of a vector tile source containing the geometries to use for this fill-extrusion
layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer`,name:"sourceId",required:!1,type:{name:"string | undefined"}},sourceLayer:{defaultValue:null,description:`Layer id from a vector tile source containing the geometries to use for this fill-extrusion
layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer`,name:"sourceLayer",required:!1,type:{name:"string | undefined"}},minZoom:{defaultValue:null,description:`This layer will be hidden for zoom levels lower than defined on this property
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#minzoom`,name:"minZoom",required:!1,type:{name:"number | undefined"}}}}}catch{}const wJ=(t,e)=>{switch(t){case"fill":return e?.fill?e.fill:{"fill-color":"#009EE0","fill-outline-color":"#009EE0"};case"line":return e?.line?(console.log(e.line),e.line):{"line-color":"#009EE0","line-width":4,"line-blur":0};case"circle":return e?.circle?e.circle:{"circle-color":"#009EE0","circle-stroke-color":"#fff","circle-stroke-width":2,"circle-radius":5};default:return{}}},Zj={Position:"circle",Point:"circle",MultiPoint:"circle",LineString:"line",MultiLineString:"line",Polygon:"fill",MultiPolygon:"fill",GeometryCollection:"circle"},gE=t=>t?.type==="Feature"?Zj?.[t?.geometry?.type]?Zj[t.geometry.type]:"circle":t?.type==="FeatureCollection"?t.features.length?gE(t.features[0]):"circle":"fill";function lL(t){const e=ga({mapId:t.mapId}),[r,n]=te.useState(),i=te.useRef(t.sourceId||(t.idPrefix?t.idPrefix:"Source-")+e.componentId),a=te.useCallback(()=>{if(e.map&&e.map?.style?._layers){for(const[o,c]of Object.entries(e.map.style._layers))c.source===i.current&&e.map.removeLayer(o);e.map.getSource(i.current)&&e.map.removeSource(i.current)}},[e.map]),s=te.useCallback(()=>{e.map&&(t.source.type==="geojson"&&!t.source.data||(e.map.map.getSource(i.current)&&a(),e.map?.addSource(i.current,{...t.source}),n(e.map.map.getSource(i.current))))},[t,e,a]);return te.useEffect(()=>{e.map?.map?.getSource(i.current)&&e.map.map.getSource(i.current)?.setData?.(t.source.data)},[t.source?.data]),te.useEffect(()=>{e?.map?.map?.getSource?.(t.sourceId)&&t.sourceId===i.current||(i.current=t.sourceId,s())},[e.map,t,s]),te.useEffect(()=>{if(!e.map)return;const o=()=>{e?.map?.getSource?.(t.sourceId)||s()};return e.map.on("styledata",o),()=>{e?.map&&e.map.off("styledata",o)}},[e.map,s]),te.useEffect(()=>()=>{a()},[a]),{map:e.map,source:r,componentId:e.componentId,mapHook:e}}const Dc=t=>{const e=t.type||gE(t.geojson),r=te.useRef(t.layerId||"MlGeoJsonLayer-"+vc()),n=`label-${r.current}`;return te.useEffect(()=>{t.layerId?r.current=t.layerId:r.current="MlGeoJsonLayer-"+vc()},[t.layerId]),lL({mapId:t.mapId,sourceId:"source-"+r.current,source:{type:"geojson",data:t.geojson,...typeof t?.options?.source<"u"&&typeof t?.options?.source!="string"?t.options.source:{}}}),wp({mapId:t.mapId,layerId:r.current,options:{...typeof t?.options?.source<"u"&&typeof t?.options?.source=="string"?{source:t.options.source}:{source:"source-"+r.current},paint:{...t.paint||wJ(e,t.defaultPaintOverrides),...t?.options?.paint},layout:{...t?.layout||{},...t?.options?.layout},type:e},insertBeforeLayer:t.insertBeforeLayer,onHover:t.onHover,onClick:t.onClick,onLeave:t.onLeave}),wp({mapId:t.mapId,options:{...typeof t?.options?.source<"u"&&typeof t?.options?.source=="string"?{source:t.options.source}:{source:"source-"+r.current},id:n,type:"symbol",maxzoom:24,minzoom:1,...t?.labelOptions?t.labelOptions:{},...t?.options?.filter?{filter:t.options.filter}:{},layout:{"text-font":["Open Sans Regular"],"text-field":`{${t.labelProp}}`,"text-size":12,"text-anchor":"top",...t?.labelOptions?.layout?t.labelOptions.layout:{},visibility:t?.layout?.visibility??t?.options?.layout?.visibility??"visible"},paint:{"text-halo-width":1,"text-halo-color":"#fefefe","text-color":"#121212",...t?.labelOptions?.paint?t.labelOptions.paint:{}}}}),J.jsx(J.Fragment,{})};try{Dc.displayName="MlGeoJsonLayer",Dc.__docgenInfo={description:"Adds source and layer to display GeoJSON data on the map.",displayName:"MlGeoJsonLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.
This layer will not be added to the maplibre-gl instance until a layer with an
id that matches the value of insertBeforeLayer is created.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the new layer and source that are added to the MapLibre instance",name:"layerId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}},type:{defaultValue:null,description:`Type of the layer that will be added to the MapLibre instance.
All types from LayerSpecification union type are supported except the type from
RasterLayerSpecification`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"symbol"'},{value:'"fill"'},{value:'"background"'},{value:'"circle"'},{value:'"line"'},{value:'"heatmap"'},{value:'"fill-extrusion"'},{value:'"hillshade"'},{value:'"color-relief"'}]}},paint:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.paint property instead. This will be removed in the next major release.
Paint property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All paint types from LayerSpecification union type are supported except the paint type from
RasterLayerSpecification`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | ... 8 more ... | undefined'}},layout:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.layout property instead. This will be removed in the next major release.
Layout property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All layout types from LayerSpecification union type are supported except the layout type from
RasterLayerSpecification`,name:"layout",required:!1,type:{name:'{ "circle-sort-key"?: DataDrivenPropertyValueSpecification<number> | undefined; visibility?: VisibilitySpecification | undefined; } | ... 9 more ... | undefined'}},options:{defaultValue:null,description:"Javascript object that is spread into the addLayer commands first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},defaultPaintOverrides:{defaultValue:null,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.',name:"defaultPaintOverrides",required:!1,type:{name:'{ circle?: { "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | undefined; fill?: { ...; } | undefined; line?: { ...; } | undefined...'}},labelProp:{defaultValue:null,description:"Property name in the GeoJSON object to be used as a label.",name:"labelProp",required:!1,type:{name:"string | undefined"}},labelOptions:{defaultValue:null,description:"Label configuration options.",name:"labelOptions",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},onHover:{defaultValue:null,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}}}}}catch{}const uL=Ji(J.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"})),zk=t=>{const e=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(!1),[i,a]=te.useState(),[s,o]=te.useState(!1),[c,f]=te.useState(),[d,m]=te.useState(0),b=te.useRef(!1),x=te.useCallback(R=>{if(!e.map||((!t.centerUserPosition&&!b.current||t.centerUserPosition)&&(t.useFlyTo?e.map.map.flyTo({center:[R.coords.longitude,R.coords.latitude],zoom:18,speed:1,curve:1}):e.map.map.setCenter([R.coords.longitude,R.coords.latitude]),b.current=!0),t.showUserLocation!==void 0&&!t.showUserLocation))return;const F=Xf([R.coords.longitude,R.coords.latitude]);a(F),f(xJ(F,R.coords.accuracy/1e3))},[e.map,t]),E=()=>{console.log("Access of user location denied"),o(!0)},T=te.useMemo(()=>{if(!i)return;const R=.02,F=d-15,N=d+15,j=dSe(i,R,F,N,{steps:65});return j.geometry.coordinates.push(i.geometry.coordinates),j.geometry.coordinates.slice(0,0),j},[d,i]),A=R=>{R?.alpha&&m(-R.alpha)};return te.useEffect(()=>{if(r){const R=A;return window.addEventListener("deviceorientation",R),()=>{window.removeEventListener("deviceorientation",R)}}else b.current=!1},[r]),te.useEffect(()=>{if(e.map&&r){const R=navigator.geolocation.watchPosition(x,E);return()=>{navigator.geolocation.clearWatch(R)}}},[e.map,r,x]),te.useEffect(()=>{if(c?.type){const R=e.map?.getBounds(),F=[R?._ne.lng,R?._ne.lat,R?._sw.lng,R?._sw.lat],N=df(c);nwe(pj(F),pj(N))||e.map?.fitBounds(N,{padding:{top:25,bottom:25}})}},[c]),J.jsxs(J.Fragment,{children:[r&&i&&J.jsx(Dc,{geojson:c,type:"fill",paint:{"fill-color":"#cbd300","fill-opacity":.3,...t.accuracyPaint},insertBeforeLayer:t.insertBeforeLayer}),r&&T&&J.jsx(Dc,{geojson:T,type:"fill",paint:{"fill-color":"#0000ff","fill-antialias":!1,"fill-opacity":.3,...t.orientationConePaint},insertBeforeLayer:t.insertBeforeLayer}),r&&i&&J.jsx(Dc,{geojson:i,type:"circle",paint:{"circle-color":"#009ee0","circle-radius":5,"circle-stroke-color":"#fafaff","circle-stroke-width":1,...t.circlePaint},insertBeforeLayer:t.insertBeforeLayer}),J.jsx(ta,{variant:"navtools","data-testid":"mlFollowGpsBtn",sx:{zIndex:1002,color:r?R=>R.palette.GPS.GPSActiveColor:R=>R.palette.GPS.GPSInactiveColor,backgroundColor:r?R=>R.palette.GPS.GPSActiveBackgroundColor:R=>R.palette.navigation.navColor},disabled:s,onClick:()=>{n(!r)},children:J.jsx(uL,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})]})};try{zk.displayName="MlFollowGps",zk.__docgenInfo={description:`Adds a button that makes the map follow the users GPS position using
navigator.geolocation.watchPosition if activated`,displayName:"MlFollowGps",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},showUserLocation:{defaultValue:null,description:"By default a dot will be shown on the map at the user's location. Set to false to disable.",name:"showUserLocation",required:!1,type:{name:"boolean | undefined"}},showOrientation:{defaultValue:null,description:`By default a cone will be shown on the map at the user's location to indicate the device's orientation.
Set to false to disable.`,name:"showOrientation",required:!1,type:{name:"boolean | undefined"}},showAccuracyCircle:{defaultValue:null,description:`By default, if showUserLocation is true, a transparent circle will be drawn around the user location
indicating the accuracy (95% confidence level) of the user's location. Set to false to disable.`,name:"showAccuracyCircle",required:!1,type:{name:"boolean | undefined"}},useFlyTo:{defaultValue:null,description:`Use the MapLibre.flyTo function to center the map to the current users position if true.
Otherwise the MapLibre.setCenter function is used.`,name:"useFlyTo",required:!1,type:{name:"boolean | undefined"}},centerUserPosition:{defaultValue:null,description:`Center map to current position once updated location data is recieved.
"false" will center the map once on component activation and then display the updated user location on the map.`,name:"centerUserPosition",required:!1,type:{name:"boolean | undefined"}},orientationConePaint:{defaultValue:null,description:`Orientation cone paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the orientation cone polygon.
Use any available paint prop from layer type "fill".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"orientationConePaint",required:!1,type:{name:'{ "fill-antialias"?: PropertyValueSpecification<boolean> | undefined; "fill-opacity"?: DataDrivenPropertyValueSpecification<number> | undefined; ... 9 more ...; "fill-pattern-transition"?: TransitionSpecification | undefined; } | undefined'}},circlePaint:{defaultValue:null,description:`Position circle paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the position circle.
Use any available paint prop from layer type "circle".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle`,name:"circlePaint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | undefined'}},onColor:{defaultValue:null,description:"Active button font color",name:"onColor",required:!1,type:{name:"string | undefined"}},offColor:{defaultValue:null,description:"Inactive button font color",name:"offColor",required:!1,type:{name:"string | undefined"}},accuracyPaint:{defaultValue:null,description:`Accuracy paint property object, that is passed to the MlGeoJsonLayer responsible for drawing the accuracy polygon.
Use any available paint prop from layer type "fill".
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"accuracyPaint",required:!1,type:{name:'{ "fill-antialias"?: PropertyValueSpecification<boolean> | undefined; "fill-opacity"?: DataDrivenPropertyValueSpecification<number> | undefined; ... 9 more ...; "fill-pattern-transition"?: TransitionSpecification | undefined; } | undefined'}}}}}catch{}const Kj=t=>{const e=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(),i=te.useRef(t.imageId||"img_"+vc()),a=te.useRef(t.layerId||"MlImageMarkerLayer-"+e.componentId);wp({geojson:t.options?.source?.data,layerId:a.current,options:{type:"symbol",layout:{...t.options?.layout,"icon-image":r||i.current},paint:{...t.options?.paint}}});const s=(o,c)=>{o.map&&c.imgSrc&&!o.map.map.hasImage(i.current)&&o.map.map.loadImage(c.imgSrc).then(function(f){if(!f?.data){console.log("image "+c.imgSrc+"could not be loaded");return}!o.map||o.map.map.hasImage(i.current)||(o.map.addImage(i.current,f.data,o.componentId),n(i.current))})};return te.useEffect(()=>{e.map&&t.imgSrc&&s(e,t)},[t,e]),J.jsx(J.Fragment,{})};try{Kj.displayName="MlImageMarkerLayer",Kj.__docgenInfo={description:"",displayName:"MlImageMarkerLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component to the maplibre-gl instance",name:"layerId",required:!1,type:{name:"string | undefined"}},imageId:{defaultValue:null,description:"Id of the image that will be added by this component to the maplibre-gl instance",name:"imageId",required:!1,type:{name:"string | undefined"}},imgSrc:{defaultValue:null,description:"Path or URL to a supported raster image",name:"imgSrc",required:!1,type:{name:"string | undefined"}},options:{defaultValue:null,description:"Javascript object that is passed the addLayer command as first parameter.",name:"options",required:!1,type:{name:"{ source?: { type?: string | undefined; data: Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined; } | undefined; layout?: { ...; } | undefined; paint?: { ...; } | undefined; } | undefined"}}}}}catch{}function OSe(t){switch(t){case"meters":return 1;case"millimeters":return 1e3;case"centimeters":return 100;case"kilometers":return .001;case"miles":return 1/1609.344;case"nauticalmiles":return 1/1852;case"inches":return 39.3701;case"yards":return 1.09361;case"feet":return 3.28084;default:return 1}}function Jj(t){switch(t){case"miles":return"mi";case"acres":return"ac";case"kilometers":return"km";case"meters":return"m";case"millimeters":return"mm";case"centimeters":return"cm";case"nauticalmiles":return"nm";case"inches":return"in";case"yards":return"yd";case"feet":return"ft";case"hectares":return"ha";default:return"m"}}const jk=t=>{const[e,r]=te.useState({value:0,label:""}),[n,i]=te.useState([]);return te.useEffect(()=>{if(n[0]){let a=0;if(t.measureType==="polygon"){if(a=q2e(n[0]),t.unit){const s=t.unit;s==="acres"?a=a/4046.8564224:s==="hectares"?a=a/1e4:a=a*OSe(t.unit)**2}}else a=Yb(n[0],{units:t.unit});typeof t.onChange=="function"&&t.onChange({value:a,unit:t.unit,geojson:n[0]}),a>=.1&&r({value:a,label:Jj(t.unit)})}},[t.unit,n]),J.jsxs(J.Fragment,{children:[J.jsx(pE,{onChange:a=>{a&&i(a)},mode:t.measureType==="polygon"?"draw_polygon":"draw_line_string",onFinish:t.onFinish}),e.value.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})," ",Jj(t.unit),e.label&&t.measureType==="polygon"&&!["hectares","acres"].includes(t.unit||"")?" ":""]})};try{jk.displayName="MlMeasureTool",jk.__docgenInfo={description:"",displayName:"MlMeasureTool",props:{measureType:{defaultValue:null,description:'String that specify if the Tool measures an area ("polygon") or length ("line")',name:"measureType",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"line"'},{value:'"polygon"'}]}},unit:{defaultValue:null,description:"String that dictates which unit of measurement is used",name:"unit",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"meters"'},{value:'"metres"'},{value:'"millimeters"'},{value:'"millimetres"'},{value:'"centimeters"'},{value:'"centimetres"'},{value:'"kilometers"'},{value:'"kilometres"'},{value:'"miles"'},{value:'"nauticalmiles"'},{value:'"inches"'},{value:'"yards"'},{value:'"feet"'},{value:'"radians"'},{value:'"degrees"'}]}},onChange:{defaultValue:null,description:`Callback function that is called each time measurment geometry within has changed within MlMeasureTool.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((options: MlMeasureToolOnChangeOptions) => void) | undefined"}},onFinish:{defaultValue:null,description:"Callback function that is called by the end of drawing geometries.",name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}const SJ=Ji(J.jsx("path",{d:"M15 16v1.26l-6-3v-3.17L11.7 8H16V2h-6v4.9L7.3 10H3v6h5l7 3.5V22h6v-6z"})),EJ=Ji(J.jsx("path",{d:"m2 9 4 12h12l4-12-10-7z"})),LSe=Dr(kh)({marginTop:"15px"});function Uk(t){return J.jsx(LSe,{children:t?.children})}try{Uk.displayName="LayerList",Uk.__docgenInfo={description:"",displayName:"LayerList",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const Ux=Ji(J.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),cL=Ji(J.jsx("path",{d:"M3 17v2h6v-2zM3 5v2h10V5zm10 16v-2h8v-2h-8v-2h-2v6zM7 9v2H3v2h4v2h2V9zm14 4v-2H11v2zm-6-4h2V7h4V5h-4V3h-2z"})),TJ=Ji(J.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),mE=Ji(J.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"})),NSe=my(qf)({paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"}),FSe=my(Fb)({minWidth:"30px"}),BSe=my(uf)({marginRight:"0px",padding:"0px"}),zSe=my(z0)({padding:0,marginRight:"5px"}),jSe=my(Mv)(({open:t})=>({display:t?"block":"none"})),USe=my(kh)({marginLeft:"50px"});function Vk({visible:t=!0,name:e,children:r,setVisible:n}){const[i,a]=te.useState(!1),[s,o]=te.useState(!0),c=te.useMemo(()=>t?s:!1,[t,s]),f=te.useMemo(()=>r?Array.isArray(r)?r.map(d=>gt.cloneElement(d,{visible:c})):gt.cloneElement(r,{visible:c}):J.jsx(J.Fragment,{}),[c]);return J.jsxs(J.Fragment,{children:[J.jsxs(NSe,{children:[J.jsxs(FSe,{children:[J.jsx(BSe,{edge:"end","aria-label":"open",onClick:()=>a(!i),children:i?J.jsx(mE,{}):J.jsx(TJ,{})}),J.jsx(zSe,{disabled:n?!1:!t,checked:n?t:s,onClick:()=>{n?n(d=>!d):o(d=>!d)}})]}),J.jsx(Df,{primary:e,variant:"layerlist"})]}),J.jsx(jSe,{open:i,children:J.jsx(USe,{disablePadding:!0,children:f})})]})}try{Vk.displayName="LayerListFolder",Vk.__docgenInfo={description:"",displayName:"LayerListFolder",props:{visible:{defaultValue:{value:"true"},description:"",name:"visible",required:!1,type:{name:"boolean"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"ReactNode"}},setVisible:{defaultValue:null,description:"",name:"setVisible",required:!1,type:{name:"((visible: boolean | ((val: unknown) => boolean)) => void) | undefined"}}}}}catch{}var Tc={},yv={},f5,Qj;function CJ(){if(Qj)return f5;Qj=1;var t=typeof lg=="object"&&lg&&lg.Object===Object&&lg;return f5=t,f5}var h5,e7;function Md(){if(e7)return h5;e7=1;var t=CJ(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return h5=r,h5}var d5,t7;function Vx(){if(t7)return d5;t7=1;var t=Md(),e=t.Symbol;return d5=e,d5}var p5,r7;function VSe(){if(r7)return p5;r7=1;var t=Vx(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,i=t?t.toStringTag:void 0;function a(s){var o=r.call(s,i),c=s[i];try{s[i]=void 0;var f=!0}catch{}var d=n.call(s);return f&&(o?s[i]=c:delete s[i]),d}return p5=a,p5}var g5,n7;function $Se(){if(n7)return g5;n7=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return g5=r,g5}var m5,i7;function wy(){if(i7)return m5;i7=1;var t=Vx(),e=VSe(),r=$Se(),n="[object Null]",i="[object Undefined]",a=t?t.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?e(o):r(o)}return m5=s,m5}var y5,a7;function Oh(){if(a7)return y5;a7=1;var t=Array.isArray;return y5=t,y5}var v5,o7;function Ip(){if(o7)return v5;o7=1;function t(e){return e!=null&&typeof e=="object"}return v5=t,v5}var _5,s7;function qSe(){if(s7)return _5;s7=1;var t=wy(),e=Oh(),r=Ip(),n="[object String]";function i(a){return typeof a=="string"||!e(a)&&r(a)&&t(a)==n}return _5=i,_5}var b5,l7;function HSe(){if(l7)return b5;l7=1;function t(e){return function(r,n,i){for(var a=-1,s=Object(r),o=i(r),c=o.length;c--;){var f=o[e?c:++a];if(n(s[f],f,s)===!1)break}return r}}return b5=t,b5}var x5,u7;function GSe(){if(u7)return x5;u7=1;var t=HSe(),e=t();return x5=e,x5}var w5,c7;function WSe(){if(c7)return w5;c7=1;function t(e,r){for(var n=-1,i=Array(e);++n<e;)i[n]=r(n);return i}return w5=t,w5}var S5,f7;function XSe(){if(f7)return S5;f7=1;var t=wy(),e=Ip(),r="[object Arguments]";function n(i){return e(i)&&t(i)==r}return S5=n,S5}var E5,h7;function AJ(){if(h7)return E5;h7=1;var t=XSe(),e=Ip(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,a=t((function(){return arguments})())?t:function(s){return e(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return E5=a,E5}var j1={exports:{}},T5,d7;function YSe(){if(d7)return T5;d7=1;function t(){return!1}return T5=t,T5}j1.exports;var p7;function fL(){return p7||(p7=1,(function(t,e){var r=Md(),n=YSe(),i=e&&!e.nodeType&&e,a=i&&!0&&t&&!t.nodeType&&t,s=a&&a.exports===i,o=s?r.Buffer:void 0,c=o?o.isBuffer:void 0,f=c||n;t.exports=f})(j1,j1.exports)),j1.exports}var C5,g7;function IJ(){if(g7)return C5;g7=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i??t,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return C5=r,C5}var A5,m7;function hL(){if(m7)return A5;m7=1;var t=9007199254740991;function e(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=t}return A5=e,A5}var I5,y7;function ZSe(){if(y7)return I5;y7=1;var t=wy(),e=hL(),r=Ip(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",c="[object Function]",f="[object Map]",d="[object Number]",m="[object Object]",b="[object RegExp]",x="[object Set]",E="[object String]",T="[object WeakMap]",A="[object ArrayBuffer]",R="[object DataView]",F="[object Float32Array]",N="[object Float64Array]",O="[object Int8Array]",U="[object Int16Array]",j="[object Int32Array]",H="[object Uint8Array]",W="[object Uint8ClampedArray]",X="[object Uint16Array]",oe="[object Uint32Array]",ee={};ee[F]=ee[N]=ee[O]=ee[U]=ee[j]=ee[H]=ee[W]=ee[X]=ee[oe]=!0,ee[n]=ee[i]=ee[A]=ee[a]=ee[R]=ee[s]=ee[o]=ee[c]=ee[f]=ee[d]=ee[m]=ee[b]=ee[x]=ee[E]=ee[T]=!1;function G(ae){return r(ae)&&e(ae.length)&&!!ee[t(ae)]}return I5=G,I5}var P5,v7;function dL(){if(v7)return P5;v7=1;function t(e){return function(r){return e(r)}}return P5=t,P5}var U1={exports:{}};U1.exports;var _7;function pL(){return _7||(_7=1,(function(t,e){var r=CJ(),n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===n,s=a&&r.process,o=(function(){try{var c=i&&i.require&&i.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}})();t.exports=o})(U1,U1.exports)),U1.exports}var M5,b7;function PJ(){if(b7)return M5;b7=1;var t=ZSe(),e=dL(),r=pL(),n=r&&r.isTypedArray,i=n?e(n):t;return M5=i,M5}var k5,x7;function MJ(){if(x7)return k5;x7=1;var t=WSe(),e=AJ(),r=Oh(),n=fL(),i=IJ(),a=PJ(),s=Object.prototype,o=s.hasOwnProperty;function c(f,d){var m=r(f),b=!m&&e(f),x=!m&&!b&&n(f),E=!m&&!b&&!x&&a(f),T=m||b||x||E,A=T?t(f.length,String):[],R=A.length;for(var F in f)(d||o.call(f,F))&&!(T&&(F=="length"||x&&(F=="offset"||F=="parent")||E&&(F=="buffer"||F=="byteLength"||F=="byteOffset")||i(F,R)))&&A.push(F);return A}return k5=c,k5}var R5,w7;function gL(){if(w7)return R5;w7=1;var t=Object.prototype;function e(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||t;return r===i}return R5=e,R5}var D5,S7;function kJ(){if(S7)return D5;S7=1;function t(e,r){return function(n){return e(r(n))}}return D5=t,D5}var O5,E7;function KSe(){if(E7)return O5;E7=1;var t=kJ(),e=t(Object.keys,Object);return O5=e,O5}var L5,T7;function JSe(){if(T7)return L5;T7=1;var t=gL(),e=KSe(),r=Object.prototype,n=r.hasOwnProperty;function i(a){if(!t(a))return e(a);var s=[];for(var o in Object(a))n.call(a,o)&&o!="constructor"&&s.push(o);return s}return L5=i,L5}var N5,C7;function b_(){if(C7)return N5;C7=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return N5=t,N5}var F5,A7;function RJ(){if(A7)return F5;A7=1;var t=wy(),e=b_(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var c=t(o);return c==n||c==i||c==r||c==a}return F5=s,F5}var B5,I7;function p3(){if(I7)return B5;I7=1;var t=RJ(),e=hL();function r(n){return n!=null&&e(n.length)&&!t(n)}return B5=r,B5}var z5,P7;function $x(){if(P7)return z5;P7=1;var t=MJ(),e=JSe(),r=p3();function n(i){return r(i)?t(i):e(i)}return z5=n,z5}var j5,M7;function DJ(){if(M7)return j5;M7=1;var t=GSe(),e=$x();function r(n,i){return n&&t(n,i,e)}return j5=r,j5}var U5,k7;function OJ(){if(k7)return U5;k7=1;function t(e){return e}return U5=t,U5}var V5,R7;function QSe(){if(R7)return V5;R7=1;var t=OJ();function e(r){return typeof r=="function"?r:t}return V5=e,V5}var $5,D7;function mL(){if(D7)return $5;D7=1;var t=DJ(),e=QSe();function r(n,i){return n&&t(n,e(i))}return $5=r,$5}var q5,O7;function yL(){if(O7)return q5;O7=1;var t=kJ(),e=t(Object.getPrototypeOf,Object);return q5=e,q5}var H5,L7;function eEe(){if(L7)return H5;L7=1;var t=wy(),e=yL(),r=Ip(),n="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,c=s.call(Object);function f(d){if(!r(d)||t(d)!=n)return!1;var m=e(d);if(m===null)return!0;var b=o.call(m,"constructor")&&m.constructor;return typeof b=="function"&&b instanceof b&&s.call(b)==c}return H5=f,H5}var G5,N7;function LJ(){if(N7)return G5;N7=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=r(e[n],n,e);return a}return G5=t,G5}var W5,F7;function tEe(){if(F7)return W5;F7=1;function t(){this.__data__=[],this.size=0}return W5=t,W5}var X5,B7;function vL(){if(B7)return X5;B7=1;function t(e,r){return e===r||e!==e&&r!==r}return X5=t,X5}var Y5,z7;function g3(){if(z7)return Y5;z7=1;var t=vL();function e(r,n){for(var i=r.length;i--;)if(t(r[i][0],n))return i;return-1}return Y5=e,Y5}var Z5,j7;function rEe(){if(j7)return Z5;j7=1;var t=g3(),e=Array.prototype,r=e.splice;function n(i){var a=this.__data__,s=t(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():r.call(a,s,1),--this.size,!0}return Z5=n,Z5}var K5,U7;function nEe(){if(U7)return K5;U7=1;var t=g3();function e(r){var n=this.__data__,i=t(n,r);return i<0?void 0:n[i][1]}return K5=e,K5}var J5,V7;function iEe(){if(V7)return J5;V7=1;var t=g3();function e(r){return t(this.__data__,r)>-1}return J5=e,J5}var Q5,$7;function aEe(){if($7)return Q5;$7=1;var t=g3();function e(r,n){var i=this.__data__,a=t(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return Q5=e,Q5}var eI,q7;function m3(){if(q7)return eI;q7=1;var t=tEe(),e=rEe(),r=nEe(),n=iEe(),i=aEe();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var f=s[o];this.set(f[0],f[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,eI=a,eI}var tI,H7;function oEe(){if(H7)return tI;H7=1;var t=m3();function e(){this.__data__=new t,this.size=0}return tI=e,tI}var rI,G7;function sEe(){if(G7)return rI;G7=1;function t(e){var r=this.__data__,n=r.delete(e);return this.size=r.size,n}return rI=t,rI}var nI,W7;function lEe(){if(W7)return nI;W7=1;function t(e){return this.__data__.get(e)}return nI=t,nI}var iI,X7;function uEe(){if(X7)return iI;X7=1;function t(e){return this.__data__.has(e)}return iI=t,iI}var aI,Y7;function cEe(){if(Y7)return aI;Y7=1;var t=Md(),e=t["__core-js_shared__"];return aI=e,aI}var oI,Z7;function fEe(){if(Z7)return oI;Z7=1;var t=cEe(),e=(function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!e&&e in n}return oI=r,oI}var sI,K7;function NJ(){if(K7)return sI;K7=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return sI=r,sI}var lI,J7;function hEe(){if(J7)return lI;J7=1;var t=RJ(),e=fEe(),r=b_(),n=NJ(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,c=s.toString,f=o.hasOwnProperty,d=RegExp("^"+c.call(f).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function m(b){if(!r(b)||e(b))return!1;var x=t(b)?d:a;return x.test(n(b))}return lI=m,lI}var uI,Q7;function dEe(){if(Q7)return uI;Q7=1;function t(e,r){return e?.[r]}return uI=t,uI}var cI,eU;function Sy(){if(eU)return cI;eU=1;var t=hEe(),e=dEe();function r(n,i){var a=e(n,i);return t(a)?a:void 0}return cI=r,cI}var fI,tU;function _L(){if(tU)return fI;tU=1;var t=Sy(),e=Md(),r=t(e,"Map");return fI=r,fI}var hI,rU;function y3(){if(rU)return hI;rU=1;var t=Sy(),e=t(Object,"create");return hI=e,hI}var dI,nU;function pEe(){if(nU)return dI;nU=1;var t=y3();function e(){this.__data__=t?t(null):{},this.size=0}return dI=e,dI}var pI,iU;function gEe(){if(iU)return pI;iU=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return pI=t,pI}var gI,aU;function mEe(){if(aU)return gI;aU=1;var t=y3(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(t){var o=s[a];return o===e?void 0:o}return n.call(s,a)?s[a]:void 0}return gI=i,gI}var mI,oU;function yEe(){if(oU)return mI;oU=1;var t=y3(),e=Object.prototype,r=e.hasOwnProperty;function n(i){var a=this.__data__;return t?a[i]!==void 0:r.call(a,i)}return mI=n,mI}var yI,sU;function vEe(){if(sU)return yI;sU=1;var t=y3(),e="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=t&&i===void 0?e:i,this}return yI=r,yI}var vI,lU;function _Ee(){if(lU)return vI;lU=1;var t=pEe(),e=gEe(),r=mEe(),n=yEe(),i=vEe();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var f=s[o];this.set(f[0],f[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,vI=a,vI}var _I,uU;function bEe(){if(uU)return _I;uU=1;var t=_Ee(),e=m3(),r=_L();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return _I=n,_I}var bI,cU;function xEe(){if(cU)return bI;cU=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return bI=t,bI}var xI,fU;function v3(){if(fU)return xI;fU=1;var t=xEe();function e(r,n){var i=r.__data__;return t(n)?i[typeof n=="string"?"string":"hash"]:i.map}return xI=e,xI}var wI,hU;function wEe(){if(hU)return wI;hU=1;var t=v3();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return wI=e,wI}var SI,dU;function SEe(){if(dU)return SI;dU=1;var t=v3();function e(r){return t(this,r).get(r)}return SI=e,SI}var EI,pU;function EEe(){if(pU)return EI;pU=1;var t=v3();function e(r){return t(this,r).has(r)}return EI=e,EI}var TI,gU;function TEe(){if(gU)return TI;gU=1;var t=v3();function e(r,n){var i=t(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return TI=e,TI}var CI,mU;function bL(){if(mU)return CI;mU=1;var t=bEe(),e=wEe(),r=SEe(),n=EEe(),i=TEe();function a(s){var o=-1,c=s==null?0:s.length;for(this.clear();++o<c;){var f=s[o];this.set(f[0],f[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,CI=a,CI}var AI,yU;function CEe(){if(yU)return AI;yU=1;var t=m3(),e=_L(),r=bL(),n=200;function i(a,s){var o=this.__data__;if(o instanceof t){var c=o.__data__;if(!e||c.length<n-1)return c.push([a,s]),this.size=++o.size,this;o=this.__data__=new r(c)}return o.set(a,s),this.size=o.size,this}return AI=i,AI}var II,vU;function xL(){if(vU)return II;vU=1;var t=m3(),e=oEe(),r=sEe(),n=lEe(),i=uEe(),a=CEe();function s(o){var c=this.__data__=new t(o);this.size=c.size}return s.prototype.clear=e,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,II=s,II}var PI,_U;function AEe(){if(_U)return PI;_U=1;var t="__lodash_hash_undefined__";function e(r){return this.__data__.set(r,t),this}return PI=e,PI}var MI,bU;function IEe(){if(bU)return MI;bU=1;function t(e){return this.__data__.has(e)}return MI=t,MI}var kI,xU;function PEe(){if(xU)return kI;xU=1;var t=bL(),e=AEe(),r=IEe();function n(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new t;++a<s;)this.add(i[a])}return n.prototype.add=n.prototype.push=e,n.prototype.has=r,kI=n,kI}var RI,wU;function MEe(){if(wU)return RI;wU=1;function t(e,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(e[n],n,e))return!0;return!1}return RI=t,RI}var DI,SU;function kEe(){if(SU)return DI;SU=1;function t(e,r){return e.has(r)}return DI=t,DI}var OI,EU;function FJ(){if(EU)return OI;EU=1;var t=PEe(),e=MEe(),r=kEe(),n=1,i=2;function a(s,o,c,f,d,m){var b=c&n,x=s.length,E=o.length;if(x!=E&&!(b&&E>x))return!1;var T=m.get(s),A=m.get(o);if(T&&A)return T==o&&A==s;var R=-1,F=!0,N=c&i?new t:void 0;for(m.set(s,o),m.set(o,s);++R<x;){var O=s[R],U=o[R];if(f)var j=b?f(U,O,R,o,s,m):f(O,U,R,s,o,m);if(j!==void 0){if(j)continue;F=!1;break}if(N){if(!e(o,function(H,W){if(!r(N,W)&&(O===H||d(O,H,c,f,m)))return N.push(W)})){F=!1;break}}else if(!(O===U||d(O,U,c,f,m))){F=!1;break}}return m.delete(s),m.delete(o),F}return OI=a,OI}var LI,TU;function BJ(){if(TU)return LI;TU=1;var t=Md(),e=t.Uint8Array;return LI=e,LI}var NI,CU;function REe(){if(CU)return NI;CU=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(i,a){n[++r]=[a,i]}),n}return NI=t,NI}var FI,AU;function DEe(){if(AU)return FI;AU=1;function t(e){var r=-1,n=Array(e.size);return e.forEach(function(i){n[++r]=i}),n}return FI=t,FI}var BI,IU;function OEe(){if(IU)return BI;IU=1;var t=Vx(),e=BJ(),r=vL(),n=FJ(),i=REe(),a=DEe(),s=1,o=2,c="[object Boolean]",f="[object Date]",d="[object Error]",m="[object Map]",b="[object Number]",x="[object RegExp]",E="[object Set]",T="[object String]",A="[object Symbol]",R="[object ArrayBuffer]",F="[object DataView]",N=t?t.prototype:void 0,O=N?N.valueOf:void 0;function U(j,H,W,X,oe,ee,G){switch(W){case F:if(j.byteLength!=H.byteLength||j.byteOffset!=H.byteOffset)return!1;j=j.buffer,H=H.buffer;case R:return!(j.byteLength!=H.byteLength||!ee(new e(j),new e(H)));case c:case f:case b:return r(+j,+H);case d:return j.name==H.name&&j.message==H.message;case x:case T:return j==H+"";case m:var ae=i;case E:var se=X&s;if(ae||(ae=a),j.size!=H.size&&!se)return!1;var fe=G.get(j);if(fe)return fe==H;X|=o,G.set(j,H);var pe=n(ae(j),ae(H),X,oe,ee,G);return G.delete(j),pe;case A:if(O)return O.call(j)==O.call(H)}return!1}return BI=U,BI}var zI,PU;function zJ(){if(PU)return zI;PU=1;function t(e,r){for(var n=-1,i=r.length,a=e.length;++n<i;)e[a+n]=r[n];return e}return zI=t,zI}var jI,MU;function jJ(){if(MU)return jI;MU=1;var t=zJ(),e=Oh();function r(n,i,a){var s=i(n);return e(n)?s:t(s,a(n))}return jI=r,jI}var UI,kU;function LEe(){if(kU)return UI;kU=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=0,s=[];++n<i;){var o=e[n];r(o,n,e)&&(s[a++]=o)}return s}return UI=t,UI}var VI,RU;function UJ(){if(RU)return VI;RU=1;function t(){return[]}return VI=t,VI}var $I,DU;function wL(){if(DU)return $I;DU=1;var t=LEe(),e=UJ(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),t(i(s),function(o){return n.call(s,o)}))}:e;return $I=a,$I}var qI,OU;function VJ(){if(OU)return qI;OU=1;var t=jJ(),e=wL(),r=$x();function n(i){return t(i,r,e)}return qI=n,qI}var HI,LU;function NEe(){if(LU)return HI;LU=1;var t=VJ(),e=1,r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o,c,f,d){var m=o&e,b=t(a),x=b.length,E=t(s),T=E.length;if(x!=T&&!m)return!1;for(var A=x;A--;){var R=b[A];if(!(m?R in s:n.call(s,R)))return!1}var F=d.get(a),N=d.get(s);if(F&&N)return F==s&&N==a;var O=!0;d.set(a,s),d.set(s,a);for(var U=m;++A<x;){R=b[A];var j=a[R],H=s[R];if(c)var W=m?c(H,j,R,s,a,d):c(j,H,R,a,s,d);if(!(W===void 0?j===H||f(j,H,o,c,d):W)){O=!1;break}U||(U=R=="constructor")}if(O&&!U){var X=a.constructor,oe=s.constructor;X!=oe&&"constructor"in a&&"constructor"in s&&!(typeof X=="function"&&X instanceof X&&typeof oe=="function"&&oe instanceof oe)&&(O=!1)}return d.delete(a),d.delete(s),O}return HI=i,HI}var GI,NU;function FEe(){if(NU)return GI;NU=1;var t=Sy(),e=Md(),r=t(e,"DataView");return GI=r,GI}var WI,FU;function BEe(){if(FU)return WI;FU=1;var t=Sy(),e=Md(),r=t(e,"Promise");return WI=r,WI}var XI,BU;function zEe(){if(BU)return XI;BU=1;var t=Sy(),e=Md(),r=t(e,"Set");return XI=r,XI}var YI,zU;function jEe(){if(zU)return YI;zU=1;var t=Sy(),e=Md(),r=t(e,"WeakMap");return YI=r,YI}var ZI,jU;function _3(){if(jU)return ZI;jU=1;var t=FEe(),e=_L(),r=BEe(),n=zEe(),i=jEe(),a=wy(),s=NJ(),o="[object Map]",c="[object Object]",f="[object Promise]",d="[object Set]",m="[object WeakMap]",b="[object DataView]",x=s(t),E=s(e),T=s(r),A=s(n),R=s(i),F=a;return(t&&F(new t(new ArrayBuffer(1)))!=b||e&&F(new e)!=o||r&&F(r.resolve())!=f||n&&F(new n)!=d||i&&F(new i)!=m)&&(F=function(N){var O=a(N),U=O==c?N.constructor:void 0,j=U?s(U):"";if(j)switch(j){case x:return b;case E:return o;case T:return f;case A:return d;case R:return m}return O}),ZI=F,ZI}var KI,UU;function UEe(){if(UU)return KI;UU=1;var t=xL(),e=FJ(),r=OEe(),n=NEe(),i=_3(),a=Oh(),s=fL(),o=PJ(),c=1,f="[object Arguments]",d="[object Array]",m="[object Object]",b=Object.prototype,x=b.hasOwnProperty;function E(T,A,R,F,N,O){var U=a(T),j=a(A),H=U?d:i(T),W=j?d:i(A);H=H==f?m:H,W=W==f?m:W;var X=H==m,oe=W==m,ee=H==W;if(ee&&s(T)){if(!s(A))return!1;U=!0,X=!1}if(ee&&!X)return O||(O=new t),U||o(T)?e(T,A,R,F,N,O):r(T,A,H,R,F,N,O);if(!(R&c)){var G=X&&x.call(T,"__wrapped__"),ae=oe&&x.call(A,"__wrapped__");if(G||ae){var se=G?T.value():T,fe=ae?A.value():A;return O||(O=new t),N(se,fe,R,F,O)}}return ee?(O||(O=new t),n(T,A,R,F,N,O)):!1}return KI=E,KI}var JI,VU;function $J(){if(VU)return JI;VU=1;var t=UEe(),e=Ip();function r(n,i,a,s,o){return n===i?!0:n==null||i==null||!e(n)&&!e(i)?n!==n&&i!==i:t(n,i,a,s,r,o)}return JI=r,JI}var QI,$U;function VEe(){if($U)return QI;$U=1;var t=xL(),e=$J(),r=1,n=2;function i(a,s,o,c){var f=o.length,d=f,m=!c;if(a==null)return!d;for(a=Object(a);f--;){var b=o[f];if(m&&b[2]?b[1]!==a[b[0]]:!(b[0]in a))return!1}for(;++f<d;){b=o[f];var x=b[0],E=a[x],T=b[1];if(m&&b[2]){if(E===void 0&&!(x in a))return!1}else{var A=new t;if(c)var R=c(E,T,x,a,s,A);if(!(R===void 0?e(T,E,r|n,c,A):R))return!1}}return!0}return QI=i,QI}var e4,qU;function qJ(){if(qU)return e4;qU=1;var t=b_();function e(r){return r===r&&!t(r)}return e4=e,e4}var t4,HU;function $Ee(){if(HU)return t4;HU=1;var t=qJ(),e=$x();function r(n){for(var i=e(n),a=i.length;a--;){var s=i[a],o=n[s];i[a]=[s,o,t(o)]}return i}return t4=r,t4}var r4,GU;function HJ(){if(GU)return r4;GU=1;function t(e,r){return function(n){return n==null?!1:n[e]===r&&(r!==void 0||e in Object(n))}}return r4=t,r4}var n4,WU;function qEe(){if(WU)return n4;WU=1;var t=VEe(),e=$Ee(),r=HJ();function n(i){var a=e(i);return a.length==1&&a[0][2]?r(a[0][0],a[0][1]):function(s){return s===i||t(s,i,a)}}return n4=n,n4}var i4,XU;function SL(){if(XU)return i4;XU=1;var t=wy(),e=Ip(),r="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&t(i)==r}return i4=n,i4}var a4,YU;function EL(){if(YU)return a4;YU=1;var t=Oh(),e=SL(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(t(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return a4=i,a4}var o4,ZU;function HEe(){if(ZU)return o4;ZU=1;var t=bL(),e="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],c=a.cache;if(c.has(o))return c.get(o);var f=n.apply(this,s);return a.cache=c.set(o,f)||c,f};return a.cache=new(r.Cache||t),a}return r.Cache=t,o4=r,o4}var s4,KU;function GEe(){if(KU)return s4;KU=1;var t=HEe(),e=500;function r(n){var i=t(n,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return s4=r,s4}var l4,JU;function WEe(){if(JU)return l4;JU=1;var t=GEe(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,c,f){a.push(c?f.replace(r,"$1"):o||s)}),a});return l4=n,l4}var u4,QU;function XEe(){if(QU)return u4;QU=1;var t=Vx(),e=LJ(),r=Oh(),n=SL(),i=t?t.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return e(o,s)+"";if(n(o))return a?a.call(o):"";var c=o+"";return c=="0"&&1/o==-1/0?"-0":c}return u4=s,u4}var c4,eV;function YEe(){if(eV)return c4;eV=1;var t=XEe();function e(r){return r==null?"":t(r)}return c4=e,c4}var f4,tV;function GJ(){if(tV)return f4;tV=1;var t=Oh(),e=EL(),r=WEe(),n=YEe();function i(a,s){return t(a)?a:e(a,s)?[a]:r(n(a))}return f4=i,f4}var h4,rV;function b3(){if(rV)return h4;rV=1;var t=SL();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return h4=e,h4}var d4,nV;function WJ(){if(nV)return d4;nV=1;var t=GJ(),e=b3();function r(n,i){i=t(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[e(i[a++])];return a&&a==s?n:void 0}return d4=r,d4}var p4,iV;function ZEe(){if(iV)return p4;iV=1;var t=WJ();function e(r,n,i){var a=r==null?void 0:t(r,n);return a===void 0?i:a}return p4=e,p4}var g4,aV;function KEe(){if(aV)return g4;aV=1;function t(e,r){return e!=null&&r in Object(e)}return g4=t,g4}var m4,oV;function JEe(){if(oV)return m4;oV=1;var t=GJ(),e=AJ(),r=Oh(),n=IJ(),i=hL(),a=b3();function s(o,c,f){c=t(c,o);for(var d=-1,m=c.length,b=!1;++d<m;){var x=a(c[d]);if(!(b=o!=null&&f(o,x)))break;o=o[x]}return b||++d!=m?b:(m=o==null?0:o.length,!!m&&i(m)&&n(x,m)&&(r(o)||e(o)))}return m4=s,m4}var y4,sV;function QEe(){if(sV)return y4;sV=1;var t=KEe(),e=JEe();function r(n,i){return n!=null&&e(n,i,t)}return y4=r,y4}var v4,lV;function eTe(){if(lV)return v4;lV=1;var t=$J(),e=ZEe(),r=QEe(),n=EL(),i=qJ(),a=HJ(),s=b3(),o=1,c=2;function f(d,m){return n(d)&&i(m)?a(s(d),m):function(b){var x=e(b,d);return x===void 0&&x===m?r(b,d):t(m,x,o|c)}}return v4=f,v4}var _4,uV;function tTe(){if(uV)return _4;uV=1;function t(e){return function(r){return r?.[e]}}return _4=t,_4}var b4,cV;function rTe(){if(cV)return b4;cV=1;var t=WJ();function e(r){return function(n){return t(n,r)}}return b4=e,b4}var x4,fV;function nTe(){if(fV)return x4;fV=1;var t=tTe(),e=rTe(),r=EL(),n=b3();function i(a){return r(a)?t(n(a)):e(a)}return x4=i,x4}var w4,hV;function iTe(){if(hV)return w4;hV=1;var t=qEe(),e=eTe(),r=OJ(),n=Oh(),i=nTe();function a(s){return typeof s=="function"?s:s==null?r:typeof s=="object"?n(s)?e(s[0],s[1]):t(s):i(s)}return w4=a,w4}var S4,dV;function aTe(){if(dV)return S4;dV=1;var t=p3();function e(r,n){return function(i,a){if(i==null)return i;if(!t(i))return r(i,a);for(var s=i.length,o=n?s:-1,c=Object(i);(n?o--:++o<s)&&a(c[o],o,c)!==!1;);return i}}return S4=e,S4}var E4,pV;function oTe(){if(pV)return E4;pV=1;var t=DJ(),e=aTe(),r=e(t);return E4=r,E4}var T4,gV;function sTe(){if(gV)return T4;gV=1;var t=oTe(),e=p3();function r(n,i){var a=-1,s=e(n)?Array(n.length):[];return t(n,function(o,c,f){s[++a]=i(o,c,f)}),s}return T4=r,T4}var C4,mV;function lTe(){if(mV)return C4;mV=1;var t=LJ(),e=iTe(),r=sTe(),n=Oh();function i(a,s){var o=n(a)?t:r;return o(a,e(s,3))}return C4=i,C4}var yV;function uTe(){if(yV)return yv;yV=1,Object.defineProperty(yv,"__esModule",{value:!0}),yv.flattenNames=void 0;var t=qSe(),e=c(t),r=mL(),n=c(r),i=eEe(),a=c(i),s=lTe(),o=c(s);function c(d){return d&&d.__esModule?d:{default:d}}var f=yv.flattenNames=function d(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],b=[];return(0,o.default)(m,function(x){Array.isArray(x)?d(x).map(function(E){return b.push(E)}):(0,a.default)(x)?(0,n.default)(x,function(E,T){E===!0&&b.push(T),b.push(T+"-"+E)}):(0,e.default)(x)&&b.push(x)}),b};return yv.default=f,yv}var vv={},A4,vV;function cTe(){if(vV)return A4;vV=1;function t(e,r){for(var n=-1,i=e==null?0:e.length;++n<i&&r(e[n],n,e)!==!1;);return e}return A4=t,A4}var I4,_V;function fTe(){if(_V)return I4;_V=1;var t=Sy(),e=(function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}})();return I4=e,I4}var P4,bV;function XJ(){if(bV)return P4;bV=1;var t=fTe();function e(r,n,i){n=="__proto__"&&t?t(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return P4=e,P4}var M4,xV;function YJ(){if(xV)return M4;xV=1;var t=XJ(),e=vL(),r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o){var c=a[s];(!(n.call(a,s)&&e(c,o))||o===void 0&&!(s in a))&&t(a,s,o)}return M4=i,M4}var k4,wV;function x3(){if(wV)return k4;wV=1;var t=YJ(),e=XJ();function r(n,i,a,s){var o=!a;a||(a={});for(var c=-1,f=i.length;++c<f;){var d=i[c],m=s?s(a[d],n[d],d,a,n):void 0;m===void 0&&(m=n[d]),o?e(a,d,m):t(a,d,m)}return a}return k4=r,k4}var R4,SV;function hTe(){if(SV)return R4;SV=1;var t=x3(),e=$x();function r(n,i){return n&&t(i,e(i),n)}return R4=r,R4}var D4,EV;function dTe(){if(EV)return D4;EV=1;function t(e){var r=[];if(e!=null)for(var n in Object(e))r.push(n);return r}return D4=t,D4}var O4,TV;function pTe(){if(TV)return O4;TV=1;var t=b_(),e=gL(),r=dTe(),n=Object.prototype,i=n.hasOwnProperty;function a(s){if(!t(s))return r(s);var o=e(s),c=[];for(var f in s)f=="constructor"&&(o||!i.call(s,f))||c.push(f);return c}return O4=a,O4}var L4,CV;function TL(){if(CV)return L4;CV=1;var t=MJ(),e=pTe(),r=p3();function n(i){return r(i)?t(i,!0):e(i)}return L4=n,L4}var N4,AV;function gTe(){if(AV)return N4;AV=1;var t=x3(),e=TL();function r(n,i){return n&&t(i,e(i),n)}return N4=r,N4}var V1={exports:{}};V1.exports;var IV;function mTe(){return IV||(IV=1,(function(t,e){var r=Md(),n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===n,s=a?r.Buffer:void 0,o=s?s.allocUnsafe:void 0;function c(f,d){if(d)return f.slice();var m=f.length,b=o?o(m):new f.constructor(m);return f.copy(b),b}t.exports=c})(V1,V1.exports)),V1.exports}var F4,PV;function yTe(){if(PV)return F4;PV=1;function t(e,r){var n=-1,i=e.length;for(r||(r=Array(i));++n<i;)r[n]=e[n];return r}return F4=t,F4}var B4,MV;function vTe(){if(MV)return B4;MV=1;var t=x3(),e=wL();function r(n,i){return t(n,e(n),i)}return B4=r,B4}var z4,kV;function ZJ(){if(kV)return z4;kV=1;var t=zJ(),e=yL(),r=wL(),n=UJ(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var o=[];s;)t(o,r(s)),s=e(s);return o}:n;return z4=a,z4}var j4,RV;function _Te(){if(RV)return j4;RV=1;var t=x3(),e=ZJ();function r(n,i){return t(n,e(n),i)}return j4=r,j4}var U4,DV;function bTe(){if(DV)return U4;DV=1;var t=jJ(),e=ZJ(),r=TL();function n(i){return t(i,r,e)}return U4=n,U4}var V4,OV;function xTe(){if(OV)return V4;OV=1;var t=Object.prototype,e=t.hasOwnProperty;function r(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&e.call(n,"index")&&(a.index=n.index,a.input=n.input),a}return V4=r,V4}var $4,LV;function CL(){if(LV)return $4;LV=1;var t=BJ();function e(r){var n=new r.constructor(r.byteLength);return new t(n).set(new t(r)),n}return $4=e,$4}var q4,NV;function wTe(){if(NV)return q4;NV=1;var t=CL();function e(r,n){var i=n?t(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return q4=e,q4}var H4,FV;function STe(){if(FV)return H4;FV=1;var t=/\w*$/;function e(r){var n=new r.constructor(r.source,t.exec(r));return n.lastIndex=r.lastIndex,n}return H4=e,H4}var G4,BV;function ETe(){if(BV)return G4;BV=1;var t=Vx(),e=t?t.prototype:void 0,r=e?e.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return G4=n,G4}var W4,zV;function TTe(){if(zV)return W4;zV=1;var t=CL();function e(r,n){var i=n?t(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return W4=e,W4}var X4,jV;function CTe(){if(jV)return X4;jV=1;var t=CL(),e=wTe(),r=STe(),n=ETe(),i=TTe(),a="[object Boolean]",s="[object Date]",o="[object Map]",c="[object Number]",f="[object RegExp]",d="[object Set]",m="[object String]",b="[object Symbol]",x="[object ArrayBuffer]",E="[object DataView]",T="[object Float32Array]",A="[object Float64Array]",R="[object Int8Array]",F="[object Int16Array]",N="[object Int32Array]",O="[object Uint8Array]",U="[object Uint8ClampedArray]",j="[object Uint16Array]",H="[object Uint32Array]";function W(X,oe,ee){var G=X.constructor;switch(oe){case x:return t(X);case a:case s:return new G(+X);case E:return e(X,ee);case T:case A:case R:case F:case N:case O:case U:case j:case H:return i(X,ee);case o:return new G;case c:case m:return new G(X);case f:return r(X);case d:return new G;case b:return n(X)}}return X4=W,X4}var Y4,UV;function ATe(){if(UV)return Y4;UV=1;var t=b_(),e=Object.create,r=(function(){function n(){}return function(i){if(!t(i))return{};if(e)return e(i);n.prototype=i;var a=new n;return n.prototype=void 0,a}})();return Y4=r,Y4}var Z4,VV;function ITe(){if(VV)return Z4;VV=1;var t=ATe(),e=yL(),r=gL();function n(i){return typeof i.constructor=="function"&&!r(i)?t(e(i)):{}}return Z4=n,Z4}var K4,$V;function PTe(){if($V)return K4;$V=1;var t=_3(),e=Ip(),r="[object Map]";function n(i){return e(i)&&t(i)==r}return K4=n,K4}var J4,qV;function MTe(){if(qV)return J4;qV=1;var t=PTe(),e=dL(),r=pL(),n=r&&r.isMap,i=n?e(n):t;return J4=i,J4}var Q4,HV;function kTe(){if(HV)return Q4;HV=1;var t=_3(),e=Ip(),r="[object Set]";function n(i){return e(i)&&t(i)==r}return Q4=n,Q4}var eP,GV;function RTe(){if(GV)return eP;GV=1;var t=kTe(),e=dL(),r=pL(),n=r&&r.isSet,i=n?e(n):t;return eP=i,eP}var tP,WV;function DTe(){if(WV)return tP;WV=1;var t=xL(),e=cTe(),r=YJ(),n=hTe(),i=gTe(),a=mTe(),s=yTe(),o=vTe(),c=_Te(),f=VJ(),d=bTe(),m=_3(),b=xTe(),x=CTe(),E=ITe(),T=Oh(),A=fL(),R=MTe(),F=b_(),N=RTe(),O=$x(),U=TL(),j=1,H=2,W=4,X="[object Arguments]",oe="[object Array]",ee="[object Boolean]",G="[object Date]",ae="[object Error]",se="[object Function]",fe="[object GeneratorFunction]",pe="[object Map]",De="[object Number]",ye="[object Object]",we="[object RegExp]",Te="[object Set]",Re="[object String]",de="[object Symbol]",Ee="[object WeakMap]",xe="[object ArrayBuffer]",Ne="[object DataView]",Fe="[object Float32Array]",Xe="[object Float64Array]",Be="[object Int8Array]",ot="[object Int16Array]",Ke="[object Int32Array]",it="[object Uint8Array]",Me="[object Uint8ClampedArray]",zt="[object Uint16Array]",st="[object Uint32Array]",$e={};$e[X]=$e[oe]=$e[xe]=$e[Ne]=$e[ee]=$e[G]=$e[Fe]=$e[Xe]=$e[Be]=$e[ot]=$e[Ke]=$e[pe]=$e[De]=$e[ye]=$e[we]=$e[Te]=$e[Re]=$e[de]=$e[it]=$e[Me]=$e[zt]=$e[st]=!0,$e[ae]=$e[se]=$e[Ee]=!1;function Jt(Ht,pr,_t,vr,br,lr){var Cr,Tr=pr&j,Qt=pr&H,at=pr&W;if(_t&&(Cr=br?_t(Ht,vr,br,lr):_t(Ht)),Cr!==void 0)return Cr;if(!F(Ht))return Ht;var Pe=T(Ht);if(Pe){if(Cr=b(Ht),!Tr)return s(Ht,Cr)}else{var be=m(Ht),je=be==se||be==fe;if(A(Ht))return a(Ht,Tr);if(be==ye||be==X||je&&!br){if(Cr=Qt||je?{}:E(Ht),!Tr)return Qt?c(Ht,i(Cr,Ht)):o(Ht,n(Cr,Ht))}else{if(!$e[be])return br?Ht:{};Cr=x(Ht,be,Tr)}}lr||(lr=new t);var qe=lr.get(Ht);if(qe)return qe;lr.set(Ht,Cr),N(Ht)?Ht.forEach(function(Et){Cr.add(Jt(Et,pr,_t,Et,Ht,lr))}):R(Ht)&&Ht.forEach(function(Et,mt){Cr.set(mt,Jt(Et,pr,_t,mt,Ht,lr))});var Ge=at?Qt?d:f:Qt?U:O,Nt=Pe?void 0:Ge(Ht);return e(Nt||Ht,function(Et,mt){Nt&&(mt=Et,Et=Ht[mt]),r(Cr,mt,Jt(Et,pr,_t,mt,Ht,lr))}),Cr}return tP=Jt,tP}var rP,XV;function OTe(){if(XV)return rP;XV=1;var t=DTe(),e=1,r=4;function n(i){return t(i,e|r)}return rP=n,rP}var YV;function LTe(){if(YV)return vv;YV=1,Object.defineProperty(vv,"__esModule",{value:!0}),vv.mergeClasses=void 0;var t=mL(),e=a(t),r=OTe(),n=a(r),i=Object.assign||function(o){for(var c=1;c<arguments.length;c++){var f=arguments[c];for(var d in f)Object.prototype.hasOwnProperty.call(f,d)&&(o[d]=f[d])}return o};function a(o){return o&&o.__esModule?o:{default:o}}var s=vv.mergeClasses=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],d=c.default&&(0,n.default)(c.default)||{};return f.map(function(m){var b=c[m];return b&&(0,e.default)(b,function(x,E){d[E]||(d[E]={}),d[E]=i({},d[E],b[E])}),m}),d};return vv.default=s,vv}var _v={},ZV;function NTe(){if(ZV)return _v;ZV=1,Object.defineProperty(_v,"__esModule",{value:!0}),_v.autoprefix=void 0;var t=mL(),e=n(t),r=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(s[f]=c[f])}return s};function n(s){return s&&s.__esModule?s:{default:s}}var i={borderRadius:function(o){return{msBorderRadius:o,MozBorderRadius:o,OBorderRadius:o,WebkitBorderRadius:o,borderRadius:o}},boxShadow:function(o){return{msBoxShadow:o,MozBoxShadow:o,OBoxShadow:o,WebkitBoxShadow:o,boxShadow:o}},userSelect:function(o){return{WebkitTouchCallout:o,KhtmlUserSelect:o,MozUserSelect:o,msUserSelect:o,WebkitUserSelect:o,userSelect:o}},flex:function(o){return{WebkitBoxFlex:o,MozBoxFlex:o,WebkitFlex:o,msFlex:o,flex:o}},flexBasis:function(o){return{WebkitFlexBasis:o,flexBasis:o}},justifyContent:function(o){return{WebkitJustifyContent:o,justifyContent:o}},transition:function(o){return{msTransition:o,MozTransition:o,OTransition:o,WebkitTransition:o,transition:o}},transform:function(o){return{msTransform:o,MozTransform:o,OTransform:o,WebkitTransform:o,transform:o}},absolute:function(o){var c=o&&o.split(" ");return{position:"absolute",top:c&&c[0],right:c&&c[1],bottom:c&&c[2],left:c&&c[3]}},extend:function(o,c){var f=c[o];return f||{extend:o}}},a=_v.autoprefix=function(o){var c={};return(0,e.default)(o,function(f,d){var m={};(0,e.default)(f,function(b,x){var E=i[x];E?m=r({},m,E(b)):m[x]=b}),c[d]=m}),c};return _v.default=a,_v}var bv={},KV;function FTe(){if(KV)return bv;KV=1,Object.defineProperty(bv,"__esModule",{value:!0}),bv.hover=void 0;var t=Object.assign||function(c){for(var f=1;f<arguments.length;f++){var d=arguments[f];for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(c[m]=d[m])}return c},e=vx(),r=n(e);function n(c){return c&&c.__esModule?c:{default:c}}function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function a(c,f){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:c}function s(c,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);c.prototype=Object.create(f&&f.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(c,f):c.__proto__=f)}var o=bv.hover=function(f){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(m){s(b,m);function b(){var x,E,T,A;i(this,b);for(var R=arguments.length,F=Array(R),N=0;N<R;N++)F[N]=arguments[N];return A=(E=(T=a(this,(x=b.__proto__||Object.getPrototypeOf(b)).call.apply(x,[this].concat(F))),T),T.state={hover:!1},T.handleMouseOver=function(){return T.setState({hover:!0})},T.handleMouseOut=function(){return T.setState({hover:!1})},T.render=function(){return r.default.createElement(d,{onMouseOver:T.handleMouseOver,onMouseOut:T.handleMouseOut},r.default.createElement(f,t({},T.props,T.state)))},E),a(T,A)}return b})(r.default.Component)};return bv.default=o,bv}var xv={},JV;function BTe(){if(JV)return xv;JV=1,Object.defineProperty(xv,"__esModule",{value:!0}),xv.active=void 0;var t=Object.assign||function(c){for(var f=1;f<arguments.length;f++){var d=arguments[f];for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(c[m]=d[m])}return c},e=vx(),r=n(e);function n(c){return c&&c.__esModule?c:{default:c}}function i(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function")}function a(c,f){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f&&(typeof f=="object"||typeof f=="function")?f:c}function s(c,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof f);c.prototype=Object.create(f&&f.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),f&&(Object.setPrototypeOf?Object.setPrototypeOf(c,f):c.__proto__=f)}var o=xv.active=function(f){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(m){s(b,m);function b(){var x,E,T,A;i(this,b);for(var R=arguments.length,F=Array(R),N=0;N<R;N++)F[N]=arguments[N];return A=(E=(T=a(this,(x=b.__proto__||Object.getPrototypeOf(b)).call.apply(x,[this].concat(F))),T),T.state={active:!1},T.handleMouseDown=function(){return T.setState({active:!0})},T.handleMouseUp=function(){return T.setState({active:!1})},T.render=function(){return r.default.createElement(d,{onMouseDown:T.handleMouseDown,onMouseUp:T.handleMouseUp},r.default.createElement(f,t({},T.props,T.state)))},E),a(T,A)}return b})(r.default.Component)};return xv.default=o,xv}var Cw={},QV;function zTe(){if(QV)return Cw;QV=1,Object.defineProperty(Cw,"__esModule",{value:!0});var t=function(r,n){var i={},a=function(o){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;i[o]=c};return r===0&&a("first-child"),r===n-1&&a("last-child"),(r===0||r%2===0)&&a("even"),Math.abs(r%2)===1&&a("odd"),a("nth-child",r),i};return Cw.default=t,Cw}var e$;function jTe(){if(e$)return Tc;e$=1,Object.defineProperty(Tc,"__esModule",{value:!0}),Tc.ReactCSS=Tc.loop=Tc.handleActive=Tc.handleHover=Tc.hover=void 0;var t=uTe(),e=b(t),r=LTe(),n=b(r),i=NTe(),a=b(i),s=FTe(),o=b(s),c=BTe(),f=b(c),d=zTe(),m=b(d);function b(E){return E&&E.__esModule?E:{default:E}}Tc.hover=o.default,Tc.handleHover=o.default,Tc.handleActive=f.default,Tc.loop=m.default;var x=Tc.ReactCSS=function(T){for(var A=arguments.length,R=Array(A>1?A-1:0),F=1;F<A;F++)R[F-1]=arguments[F];var N=(0,e.default)(R),O=(0,n.default)(T,N);return(0,a.default)(O)};return Tc.default=x,Tc}var AL=jTe();const Ni=Cd(AL);var UTe=function(e,r,n,i,a){var s=a.clientWidth,o=a.clientHeight,c=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,f=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,d=c-(a.getBoundingClientRect().left+window.pageXOffset),m=f-(a.getBoundingClientRect().top+window.pageYOffset);if(n==="vertical"){var b=void 0;if(m<0?b=0:m>o?b=1:b=Math.round(m*100/o)/100,r.a!==b)return{h:r.h,s:r.s,l:r.l,a:b,source:"rgb"}}else{var x=void 0;if(d<0?x=0:d>s?x=1:x=Math.round(d*100/s)/100,i!==x)return{h:r.h,s:r.s,l:r.l,a:x,source:"rgb"}}return null},nP={},VTe=function(e,r,n,i){if(typeof document>"u"&&!i)return null;var a=i?new i:document.createElement("canvas");a.width=n*2,a.height=n*2;var s=a.getContext("2d");return s?(s.fillStyle=e,s.fillRect(0,0,a.width,a.height),s.fillStyle=r,s.fillRect(0,0,n,n),s.translate(n,n),s.fillRect(0,0,n,n),a.toDataURL()):null},$Te=function(e,r,n,i){var a=e+"-"+r+"-"+n+(i?"-server":"");if(nP[a])return nP[a];var s=VTe(e,r,n,i);return nP[a]=s,s},t$=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},x_=function(e){var r=e.white,n=e.grey,i=e.size,a=e.renderers,s=e.borderRadius,o=e.boxShadow,c=e.children,f=Ni({default:{grid:{borderRadius:s,boxShadow:o,absolute:"0px 0px 0px 0px",background:"url("+$Te(r,n,i,a.canvas)+") center left"}}});return te.isValidElement(c)?gt.cloneElement(c,t$({},c.props,{style:t$({},c.props.style,f.grid)})):gt.createElement("div",{style:f.grid})};x_.defaultProps={size:8,white:"transparent",grey:"rgba(0,0,0,.08)",renderers:{}};var qTe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},HTe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function GTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r$(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function WTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var IL=(function(t){WTe(e,t);function e(){var r,n,i,a;GTe(this,e);for(var s=arguments.length,o=Array(s),c=0;c<s;c++)o[c]=arguments[c];return a=(n=(i=r$(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(o))),i),i.handleChange=function(f){var d=UTe(f,i.props.hsl,i.props.direction,i.props.a,i.container);d&&typeof i.props.onChange=="function"&&i.props.onChange(d,f)},i.handleMouseDown=function(f){i.handleChange(f),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},i.unbindEventListeners=function(){window.removeEventListener("mousemove",i.handleChange),window.removeEventListener("mouseup",i.handleMouseUp)},n),r$(i,a)}return HTe(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"render",value:function(){var n=this,i=this.props.rgb,a=Ni({default:{alpha:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},checkboard:{absolute:"0px 0px 0px 0px",overflow:"hidden",borderRadius:this.props.radius},gradient:{absolute:"0px 0px 0px 0px",background:"linear-gradient(to right, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)",boxShadow:this.props.shadow,borderRadius:this.props.radius},container:{position:"relative",height:"100%",margin:"0 3px"},pointer:{position:"absolute",left:i.a*100+"%"},slider:{width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",marginTop:"1px",transform:"translateX(-2px)"}},vertical:{gradient:{background:"linear-gradient(to bottom, rgba("+i.r+","+i.g+","+i.b+`, 0) 0%,
           rgba(`+i.r+","+i.g+","+i.b+", 1) 100%)"},pointer:{left:0,top:i.a*100+"%"}},overwrite:qTe({},this.props.style)},{vertical:this.props.direction==="vertical",overwrite:!0});return gt.createElement("div",{style:a.alpha},gt.createElement("div",{style:a.checkboard},gt.createElement(x_,{renderers:this.props.renderers})),gt.createElement("div",{style:a.gradient}),gt.createElement("div",{style:a.container,ref:function(o){return n.container=o},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},gt.createElement("div",{style:a.pointer},this.props.pointer?gt.createElement(this.props.pointer,this.props):gt.createElement("div",{style:a.slider}))))}}]),e})(te.PureComponent||te.Component),XTe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function YTe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KTe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function JTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var QTe=1,KJ=38,e3e=40,t3e=[KJ,e3e],r3e=function(e){return t3e.indexOf(e)>-1},n3e=function(e){return Number(String(e).replace(/%/g,""))},i3e=1,va=(function(t){JTe(e,t);function e(r){ZTe(this,e);var n=KTe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.handleBlur=function(){n.state.blurValue&&n.setState({value:n.state.blurValue,blurValue:null})},n.handleChange=function(i){n.setUpdatedValue(i.target.value,i)},n.handleKeyDown=function(i){var a=n3e(i.target.value);if(!isNaN(a)&&r3e(i.keyCode)){var s=n.getArrowOffset(),o=i.keyCode===KJ?a+s:a-s;n.setUpdatedValue(o,i)}},n.handleDrag=function(i){if(n.props.dragLabel){var a=Math.round(n.props.value+i.movementX);a>=0&&a<=n.props.dragMax&&n.props.onChange&&n.props.onChange(n.getValueObjectWithLabel(a),i)}},n.handleMouseDown=function(i){n.props.dragLabel&&(i.preventDefault(),n.handleDrag(i),window.addEventListener("mousemove",n.handleDrag),window.addEventListener("mouseup",n.handleMouseUp))},n.handleMouseUp=function(){n.unbindEventListeners()},n.unbindEventListeners=function(){window.removeEventListener("mousemove",n.handleDrag),window.removeEventListener("mouseup",n.handleMouseUp)},n.state={value:String(r.value).toUpperCase(),blurValue:String(r.value).toUpperCase()},n.inputId="rc-editable-input-"+i3e++,n}return XTe(e,[{key:"componentDidUpdate",value:function(n,i){this.props.value!==this.state.value&&(n.value!==this.props.value||i.value!==this.state.value)&&(this.input===document.activeElement?this.setState({blurValue:String(this.props.value).toUpperCase()}):this.setState({value:String(this.props.value).toUpperCase(),blurValue:!this.state.blurValue&&String(this.props.value).toUpperCase()}))}},{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"getValueObjectWithLabel",value:function(n){return YTe({},this.props.label,n)}},{key:"getArrowOffset",value:function(){return this.props.arrowOffset||QTe}},{key:"setUpdatedValue",value:function(n,i){var a=this.props.label?this.getValueObjectWithLabel(n):n;this.props.onChange&&this.props.onChange(a,i),this.setState({value:n})}},{key:"render",value:function(){var n=this,i=Ni({default:{wrap:{position:"relative"}},"user-override":{wrap:this.props.style&&this.props.style.wrap?this.props.style.wrap:{},input:this.props.style&&this.props.style.input?this.props.style.input:{},label:this.props.style&&this.props.style.label?this.props.style.label:{}},"dragLabel-true":{label:{cursor:"ew-resize"}}},{"user-override":!0},this.props);return gt.createElement("div",{style:i.wrap},gt.createElement("input",{id:this.inputId,style:i.input,ref:function(s){return n.input=s},value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,onBlur:this.handleBlur,placeholder:this.props.placeholder,spellCheck:"false"}),this.props.label&&!this.props.hideLabel?gt.createElement("label",{htmlFor:this.inputId,style:i.label,onMouseDown:this.handleMouseDown},this.props.label):null)}}]),e})(te.PureComponent||te.Component),a3e=function(e,r,n,i){var a=i.clientWidth,s=i.clientHeight,o=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,f=o-(i.getBoundingClientRect().left+window.pageXOffset),d=c-(i.getBoundingClientRect().top+window.pageYOffset);if(r==="vertical"){var m=void 0;if(d<0)m=359;else if(d>s)m=0;else{var b=-(d*100/s)+100;m=360*b/100}if(n.h!==m)return{h:m,s:n.s,l:n.l,a:n.a,source:"hsl"}}else{var x=void 0;if(f<0)x=0;else if(f>a)x=359;else{var E=f*100/a;x=360*E/100}if(n.h!==x)return{h:x,s:n.s,l:n.l,a:n.a,source:"hsl"}}return null},o3e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function s3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n$(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function l3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var w_=(function(t){l3e(e,t);function e(){var r,n,i,a;s3e(this,e);for(var s=arguments.length,o=Array(s),c=0;c<s;c++)o[c]=arguments[c];return a=(n=(i=n$(this,(r=e.__proto__||Object.getPrototypeOf(e)).call.apply(r,[this].concat(o))),i),i.handleChange=function(f){var d=a3e(f,i.props.direction,i.props.hsl,i.container);d&&typeof i.props.onChange=="function"&&i.props.onChange(d,f)},i.handleMouseDown=function(f){i.handleChange(f),window.addEventListener("mousemove",i.handleChange),window.addEventListener("mouseup",i.handleMouseUp)},i.handleMouseUp=function(){i.unbindEventListeners()},n),n$(i,a)}return o3e(e,[{key:"componentWillUnmount",value:function(){this.unbindEventListeners()}},{key:"unbindEventListeners",value:function(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.direction,a=i===void 0?"horizontal":i,s=Ni({default:{hue:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius,boxShadow:this.props.shadow},container:{padding:"0 2px",position:"relative",height:"100%",borderRadius:this.props.radius},pointer:{position:"absolute",left:this.props.hsl.h*100/360+"%"},slider:{marginTop:"1px",width:"4px",borderRadius:"1px",height:"8px",boxShadow:"0 0 2px rgba(0, 0, 0, .6)",background:"#fff",transform:"translateX(-2px)"}},vertical:{pointer:{left:"0px",top:-(this.props.hsl.h*100/360)+100+"%"}}},{vertical:a==="vertical"});return gt.createElement("div",{style:s.hue},gt.createElement("div",{className:"hue-"+a,style:s.container,ref:function(c){return n.container=c},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},gt.createElement("style",null,`
            .hue-horizontal {
              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0
                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to right, #f00 0%, #ff0
                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }

            .hue-vertical {
              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,
                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,
                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);
            }
          `),gt.createElement("div",{style:s.pointer},this.props.pointer?gt.createElement(this.props.pointer,this.props):gt.createElement("div",{style:s.slider}))))}}]),e})(te.PureComponent||te.Component);function u3e(){this.__data__=[],this.size=0}function qx(t,e){return t===e||t!==t&&e!==e}function w3(t,e){for(var r=t.length;r--;)if(qx(t[r][0],e))return r;return-1}var c3e=Array.prototype,f3e=c3e.splice;function h3e(t){var e=this.__data__,r=w3(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():f3e.call(e,r,1),--this.size,!0}function d3e(t){var e=this.__data__,r=w3(e,t);return r<0?void 0:e[r][1]}function p3e(t){return w3(this.__data__,t)>-1}function g3e(t,e){var r=this.__data__,n=w3(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function Pp(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Pp.prototype.clear=u3e;Pp.prototype.delete=h3e;Pp.prototype.get=d3e;Pp.prototype.has=p3e;Pp.prototype.set=g3e;function m3e(){this.__data__=new Pp,this.size=0}function y3e(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function v3e(t){return this.__data__.get(t)}function _3e(t){return this.__data__.has(t)}var JJ=typeof global=="object"&&global&&global.Object===Object&&global,b3e=typeof self=="object"&&self&&self.Object===Object&&self,Lh=JJ||b3e||Function("return this")(),kg=Lh.Symbol,QJ=Object.prototype,x3e=QJ.hasOwnProperty,w3e=QJ.toString,u1=kg?kg.toStringTag:void 0;function S3e(t){var e=x3e.call(t,u1),r=t[u1];try{t[u1]=void 0;var n=!0}catch{}var i=w3e.call(t);return n&&(e?t[u1]=r:delete t[u1]),i}var E3e=Object.prototype,T3e=E3e.toString;function C3e(t){return T3e.call(t)}var A3e="[object Null]",I3e="[object Undefined]",i$=kg?kg.toStringTag:void 0;function Ey(t){return t==null?t===void 0?I3e:A3e:i$&&i$ in Object(t)?S3e(t):C3e(t)}function Yf(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var P3e="[object AsyncFunction]",M3e="[object Function]",k3e="[object GeneratorFunction]",R3e="[object Proxy]";function PL(t){if(!Yf(t))return!1;var e=Ey(t);return e==M3e||e==k3e||e==P3e||e==R3e}var iP=Lh["__core-js_shared__"],a$=(function(){var t=/[^.]+$/.exec(iP&&iP.keys&&iP.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function D3e(t){return!!a$&&a$ in t}var O3e=Function.prototype,L3e=O3e.toString;function Ty(t){if(t!=null){try{return L3e.call(t)}catch{}try{return t+""}catch{}}return""}var N3e=/[\\^$.*+?()[\]{}|]/g,F3e=/^\[object .+?Constructor\]$/,B3e=Function.prototype,z3e=Object.prototype,j3e=B3e.toString,U3e=z3e.hasOwnProperty,V3e=RegExp("^"+j3e.call(U3e).replace(N3e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $3e(t){if(!Yf(t)||D3e(t))return!1;var e=PL(t)?V3e:F3e;return e.test(Ty(t))}function q3e(t,e){return t?.[e]}function Cy(t,e){var r=q3e(t,e);return $3e(r)?r:void 0}var Zb=Cy(Lh,"Map"),Kb=Cy(Object,"create");function H3e(){this.__data__=Kb?Kb(null):{},this.size=0}function G3e(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var W3e="__lodash_hash_undefined__",X3e=Object.prototype,Y3e=X3e.hasOwnProperty;function Z3e(t){var e=this.__data__;if(Kb){var r=e[t];return r===W3e?void 0:r}return Y3e.call(e,t)?e[t]:void 0}var K3e=Object.prototype,J3e=K3e.hasOwnProperty;function Q3e(t){var e=this.__data__;return Kb?e[t]!==void 0:J3e.call(e,t)}var eCe="__lodash_hash_undefined__";function tCe(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Kb&&e===void 0?eCe:e,this}function ny(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ny.prototype.clear=H3e;ny.prototype.delete=G3e;ny.prototype.get=Z3e;ny.prototype.has=Q3e;ny.prototype.set=tCe;function rCe(){this.size=0,this.__data__={hash:new ny,map:new(Zb||Pp),string:new ny}}function nCe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function S3(t,e){var r=t.__data__;return nCe(e)?r[typeof e=="string"?"string":"hash"]:r.map}function iCe(t){var e=S3(this,t).delete(t);return this.size-=e?1:0,e}function aCe(t){return S3(this,t).get(t)}function oCe(t){return S3(this,t).has(t)}function sCe(t,e){var r=S3(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function Mp(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Mp.prototype.clear=rCe;Mp.prototype.delete=iCe;Mp.prototype.get=aCe;Mp.prototype.has=oCe;Mp.prototype.set=sCe;var lCe=200;function uCe(t,e){var r=this.__data__;if(r instanceof Pp){var n=r.__data__;if(!Zb||n.length<lCe-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Mp(n)}return r.set(t,e),this.size=r.size,this}function _d(t){var e=this.__data__=new Pp(t);this.size=e.size}_d.prototype.clear=m3e;_d.prototype.delete=y3e;_d.prototype.get=v3e;_d.prototype.has=_3e;_d.prototype.set=uCe;var yE=(function(){try{var t=Cy(Object,"defineProperty");return t({},"",{}),t}catch{}})();function ML(t,e,r){e=="__proto__"&&yE?yE(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function $k(t,e,r){(r!==void 0&&!qx(t[e],r)||r===void 0&&!(e in t))&&ML(t,e,r)}function cCe(t){return function(e,r,n){for(var i=-1,a=Object(e),s=n(e),o=s.length;o--;){var c=s[++i];if(r(a[c],c,a)===!1)break}return e}}var eQ=cCe(),tQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,o$=tQ&&typeof module=="object"&&module&&!module.nodeType&&module,fCe=o$&&o$.exports===tQ,s$=fCe?Lh.Buffer:void 0;s$&&s$.allocUnsafe;function hCe(t,e){return t.slice()}var vE=Lh.Uint8Array;function dCe(t){var e=new t.constructor(t.byteLength);return new vE(e).set(new vE(t)),e}function pCe(t,e){var r=dCe(t.buffer);return new t.constructor(r,t.byteOffset,t.length)}function gCe(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var l$=Object.create,mCe=(function(){function t(){}return function(e){if(!Yf(e))return{};if(l$)return l$(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();function rQ(t,e){return function(r){return t(e(r))}}var nQ=rQ(Object.getPrototypeOf,Object),yCe=Object.prototype;function kL(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||yCe;return t===r}function vCe(t){return typeof t.constructor=="function"&&!kL(t)?mCe(nQ(t)):{}}function Rg(t){return t!=null&&typeof t=="object"}var _Ce="[object Arguments]";function u$(t){return Rg(t)&&Ey(t)==_Ce}var iQ=Object.prototype,bCe=iQ.hasOwnProperty,xCe=iQ.propertyIsEnumerable,_E=u$((function(){return arguments})())?u$:function(t){return Rg(t)&&bCe.call(t,"callee")&&!xCe.call(t,"callee")},pf=Array.isArray,wCe=9007199254740991;function RL(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=wCe}function S_(t){return t!=null&&RL(t.length)&&!PL(t)}function SCe(t){return Rg(t)&&S_(t)}function ECe(){return!1}var aQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,c$=aQ&&typeof module=="object"&&module&&!module.nodeType&&module,TCe=c$&&c$.exports===aQ,f$=TCe?Lh.Buffer:void 0,CCe=f$?f$.isBuffer:void 0,bE=CCe||ECe,ACe="[object Object]",ICe=Function.prototype,PCe=Object.prototype,oQ=ICe.toString,MCe=PCe.hasOwnProperty,kCe=oQ.call(Object);function RCe(t){if(!Rg(t)||Ey(t)!=ACe)return!1;var e=nQ(t);if(e===null)return!0;var r=MCe.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&oQ.call(r)==kCe}var DCe="[object Arguments]",OCe="[object Array]",LCe="[object Boolean]",NCe="[object Date]",FCe="[object Error]",BCe="[object Function]",zCe="[object Map]",jCe="[object Number]",UCe="[object Object]",VCe="[object RegExp]",$Ce="[object Set]",qCe="[object String]",HCe="[object WeakMap]",GCe="[object ArrayBuffer]",WCe="[object DataView]",XCe="[object Float32Array]",YCe="[object Float64Array]",ZCe="[object Int8Array]",KCe="[object Int16Array]",JCe="[object Int32Array]",QCe="[object Uint8Array]",eAe="[object Uint8ClampedArray]",tAe="[object Uint16Array]",rAe="[object Uint32Array]",Ko={};Ko[XCe]=Ko[YCe]=Ko[ZCe]=Ko[KCe]=Ko[JCe]=Ko[QCe]=Ko[eAe]=Ko[tAe]=Ko[rAe]=!0;Ko[DCe]=Ko[OCe]=Ko[GCe]=Ko[LCe]=Ko[WCe]=Ko[NCe]=Ko[FCe]=Ko[BCe]=Ko[zCe]=Ko[jCe]=Ko[UCe]=Ko[VCe]=Ko[$Ce]=Ko[qCe]=Ko[HCe]=!1;function nAe(t){return Rg(t)&&RL(t.length)&&!!Ko[Ey(t)]}function iAe(t){return function(e){return t(e)}}var sQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,mb=sQ&&typeof module=="object"&&module&&!module.nodeType&&module,aAe=mb&&mb.exports===sQ,aP=aAe&&JJ.process,h$=(function(){try{var t=mb&&mb.require&&mb.require("util").types;return t||aP&&aP.binding&&aP.binding("util")}catch{}})(),d$=h$&&h$.isTypedArray,DL=d$?iAe(d$):nAe;function qk(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var oAe=Object.prototype,sAe=oAe.hasOwnProperty;function lAe(t,e,r){var n=t[e];(!(sAe.call(t,e)&&qx(n,r))||r===void 0&&!(e in t))&&ML(t,e,r)}function uAe(t,e,r,n){var i=!r;r||(r={});for(var a=-1,s=e.length;++a<s;){var o=e[a],c=void 0;c===void 0&&(c=t[o]),i?ML(r,o,c):lAe(r,o,c)}return r}function cAe(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var fAe=9007199254740991,hAe=/^(?:0|[1-9]\d*)$/;function OL(t,e){var r=typeof t;return e=e??fAe,!!e&&(r=="number"||r!="symbol"&&hAe.test(t))&&t>-1&&t%1==0&&t<e}var dAe=Object.prototype,pAe=dAe.hasOwnProperty;function lQ(t,e){var r=pf(t),n=!r&&_E(t),i=!r&&!n&&bE(t),a=!r&&!n&&!i&&DL(t),s=r||n||i||a,o=s?cAe(t.length,String):[],c=o.length;for(var f in t)(e||pAe.call(t,f))&&!(s&&(f=="length"||i&&(f=="offset"||f=="parent")||a&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||OL(f,c)))&&o.push(f);return o}function gAe(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var mAe=Object.prototype,yAe=mAe.hasOwnProperty;function vAe(t){if(!Yf(t))return gAe(t);var e=kL(t),r=[];for(var n in t)n=="constructor"&&(e||!yAe.call(t,n))||r.push(n);return r}function uQ(t){return S_(t)?lQ(t,!0):vAe(t)}function _Ae(t){return uAe(t,uQ(t))}function bAe(t,e,r,n,i,a,s){var o=qk(t,r),c=qk(e,r),f=s.get(c);if(f){$k(t,r,f);return}var d=a?a(o,c,r+"",t,e,s):void 0,m=d===void 0;if(m){var b=pf(c),x=!b&&bE(c),E=!b&&!x&&DL(c);d=c,b||x||E?pf(o)?d=o:SCe(o)?d=gCe(o):x?(m=!1,d=hCe(c)):E?(m=!1,d=pCe(c)):d=[]:RCe(c)||_E(c)?(d=o,_E(o)?d=_Ae(o):(!Yf(o)||PL(o))&&(d=vCe(c))):m=!1}m&&(s.set(c,d),i(d,c,n,a,s),s.delete(c)),$k(t,r,d)}function cQ(t,e,r,n,i){t!==e&&eQ(e,function(a,s){if(i||(i=new _d),Yf(a))bAe(t,e,s,r,cQ,n,i);else{var o=n?n(qk(t,s),a,s+"",t,e,i):void 0;o===void 0&&(o=a),$k(t,s,o)}},uQ)}function E3(t){return t}function xAe(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var p$=Math.max;function wAe(t,e,r){return e=p$(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=p$(n.length-e,0),s=Array(a);++i<a;)s[i]=n[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=n[i];return o[e]=r(s),xAe(t,this,o)}}function SAe(t){return function(){return t}}var EAe=yE?function(t,e){return yE(t,"toString",{configurable:!0,enumerable:!1,value:SAe(e),writable:!0})}:E3,TAe=800,CAe=16,AAe=Date.now;function IAe(t){var e=0,r=0;return function(){var n=AAe(),i=CAe-(n-r);if(r=n,i>0){if(++e>=TAe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var PAe=IAe(EAe);function MAe(t,e){return PAe(wAe(t,e,E3),t+"")}function kAe(t,e,r){if(!Yf(r))return!1;var n=typeof e;return(n=="number"?S_(r)&&OL(e,r.length):n=="string"&&e in r)?qx(r[e],t):!1}function RAe(t){return MAe(function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,s&&kAe(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var o=r[n];o&&t(e,o,n,a)}return e})}var Bc=RAe(function(t,e,r){cQ(t,e,r)}),Hx=function(e){var r=e.zDepth,n=e.radius,i=e.background,a=e.children,s=e.styles,o=s===void 0?{}:s,c=Ni(Bc({default:{wrap:{position:"relative",display:"inline-block"},content:{position:"relative"},bg:{absolute:"0px 0px 0px 0px",boxShadow:"0 "+r+"px "+r*4+"px rgba(0,0,0,.24)",borderRadius:n,background:i}},"zDepth-0":{bg:{boxShadow:"none"}},"zDepth-1":{bg:{boxShadow:"0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)"}},"zDepth-2":{bg:{boxShadow:"0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)"}},"zDepth-3":{bg:{boxShadow:"0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)"}},"zDepth-4":{bg:{boxShadow:"0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)"}},"zDepth-5":{bg:{boxShadow:"0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)"}},square:{bg:{borderRadius:"0"}},circle:{bg:{borderRadius:"50%"}}},o),{"zDepth-1":r===1});return gt.createElement("div",{style:c.wrap},gt.createElement("div",{style:c.bg}),gt.createElement("div",{style:c.content},a))};Hx.propTypes={background:kn.string,zDepth:kn.oneOf([0,1,2,3,4,5]),radius:kn.number,styles:kn.object};Hx.defaultProps={background:"#fff",zDepth:1,radius:2,styles:{}};var oP=function(){return Lh.Date.now()},DAe=/\s/;function OAe(t){for(var e=t.length;e--&&DAe.test(t.charAt(e)););return e}var LAe=/^\s+/;function NAe(t){return t&&t.slice(0,OAe(t)+1).replace(LAe,"")}var FAe="[object Symbol]";function T3(t){return typeof t=="symbol"||Rg(t)&&Ey(t)==FAe}var g$=NaN,BAe=/^[-+]0x[0-9a-f]+$/i,zAe=/^0b[01]+$/i,jAe=/^0o[0-7]+$/i,UAe=parseInt;function m$(t){if(typeof t=="number")return t;if(T3(t))return g$;if(Yf(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Yf(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=NAe(t);var r=zAe.test(t);return r||jAe.test(t)?UAe(t.slice(2),r?2:8):BAe.test(t)?g$:+t}var VAe="Expected a function",$Ae=Math.max,qAe=Math.min;function fQ(t,e,r){var n,i,a,s,o,c,f=0,d=!1,m=!1,b=!0;if(typeof t!="function")throw new TypeError(VAe);e=m$(e)||0,Yf(r)&&(d=!!r.leading,m="maxWait"in r,a=m?$Ae(m$(r.maxWait)||0,e):a,b="trailing"in r?!!r.trailing:b);function x(j){var H=n,W=i;return n=i=void 0,f=j,s=t.apply(W,H),s}function E(j){return f=j,o=setTimeout(R,e),d?x(j):s}function T(j){var H=j-c,W=j-f,X=e-H;return m?qAe(X,a-W):X}function A(j){var H=j-c,W=j-f;return c===void 0||H>=e||H<0||m&&W>=a}function R(){var j=oP();if(A(j))return F(j);o=setTimeout(R,T(j))}function F(j){return o=void 0,b&&n?x(j):(n=i=void 0,s)}function N(){o!==void 0&&clearTimeout(o),f=0,n=c=i=o=void 0}function O(){return o===void 0?s:F(oP())}function U(){var j=oP(),H=A(j);if(n=arguments,i=this,c=j,H){if(o===void 0)return E(c);if(m)return clearTimeout(o),o=setTimeout(R,e),x(c)}return o===void 0&&(o=setTimeout(R,e)),s}return U.cancel=N,U.flush=O,U}var HAe="Expected a function";function GAe(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(HAe);return Yf(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),fQ(t,e,{leading:n,maxWait:e,trailing:i})}var WAe=function(e,r,n){var i=n.getBoundingClientRect(),a=i.width,s=i.height,o=typeof e.pageX=="number"?e.pageX:e.touches[0].pageX,c=typeof e.pageY=="number"?e.pageY:e.touches[0].pageY,f=o-(n.getBoundingClientRect().left+window.pageXOffset),d=c-(n.getBoundingClientRect().top+window.pageYOffset);f<0?f=0:f>a&&(f=a),d<0?d=0:d>s&&(d=s);var m=f/a,b=1-d/s;return{h:r.h,s:m,v:b,a:r.a,source:"hsv"}},XAe=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function YAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZAe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function KAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var C3=(function(t){KAe(e,t);function e(r){YAe(this,e);var n=ZAe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r));return n.handleChange=function(i){typeof n.props.onChange=="function"&&n.throttle(n.props.onChange,WAe(i,n.props.hsl,n.container),i)},n.handleMouseDown=function(i){n.handleChange(i);var a=n.getContainerRenderWindow();a.addEventListener("mousemove",n.handleChange),a.addEventListener("mouseup",n.handleMouseUp)},n.handleMouseUp=function(){n.unbindEventListeners()},n.throttle=GAe(function(i,a,s){i(a,s)},50),n}return XAe(e,[{key:"componentWillUnmount",value:function(){this.throttle.cancel(),this.unbindEventListeners()}},{key:"getContainerRenderWindow",value:function(){for(var n=this.container,i=window;!i.document.contains(n)&&i.parent!==i;)i=i.parent;return i}},{key:"unbindEventListeners",value:function(){var n=this.getContainerRenderWindow();n.removeEventListener("mousemove",this.handleChange),n.removeEventListener("mouseup",this.handleMouseUp)}},{key:"render",value:function(){var n=this,i=this.props.style||{},a=i.color,s=i.white,o=i.black,c=i.pointer,f=i.circle,d=Ni({default:{color:{absolute:"0px 0px 0px 0px",background:"hsl("+this.props.hsl.h+",100%, 50%)",borderRadius:this.props.radius},white:{absolute:"0px 0px 0px 0px",borderRadius:this.props.radius},black:{absolute:"0px 0px 0px 0px",boxShadow:this.props.shadow,borderRadius:this.props.radius},pointer:{position:"absolute",top:-(this.props.hsv.v*100)+100+"%",left:this.props.hsv.s*100+"%",cursor:"default"},circle:{width:"4px",height:"4px",boxShadow:`0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),
            0 0 1px 2px rgba(0,0,0,.4)`,borderRadius:"50%",cursor:"hand",transform:"translate(-2px, -2px)"}},custom:{color:a,white:s,black:o,pointer:c,circle:f}},{custom:!!this.props.style});return gt.createElement("div",{style:d.color,ref:function(b){return n.container=b},onMouseDown:this.handleMouseDown,onTouchMove:this.handleChange,onTouchStart:this.handleChange},gt.createElement("style",null,`
          .saturation-white {
            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));
            background: linear-gradient(to right, #fff, rgba(255,255,255,0));
          }
          .saturation-black {
            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));
            background: linear-gradient(to top, #000, rgba(0,0,0,0));
          }
        `),gt.createElement("div",{style:d.white,className:"saturation-white"},gt.createElement("div",{style:d.black,className:"saturation-black"}),gt.createElement("div",{style:d.pointer},this.props.pointer?gt.createElement(this.props.pointer,this.props):gt.createElement("div",{style:d.circle}))))}}]),e})(te.PureComponent||te.Component);function JAe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var QAe=rQ(Object.keys,Object),e5e=Object.prototype,t5e=e5e.hasOwnProperty;function r5e(t){if(!kL(t))return QAe(t);var e=[];for(var r in Object(t))t5e.call(t,r)&&r!="constructor"&&e.push(r);return e}function LL(t){return S_(t)?lQ(t):r5e(t)}function n5e(t,e){return t&&eQ(t,e,LL)}function i5e(t,e){return function(r,n){if(r==null)return r;if(!S_(r))return t(r,n);for(var i=r.length,a=-1,s=Object(r);++a<i&&n(s[a],a,s)!==!1;);return r}}var hQ=i5e(n5e);function a5e(t){return typeof t=="function"?t:E3}function o5e(t,e){var r=pf(t)?JAe:hQ;return r(t,a5e(e))}function xE(t){"@babel/helpers - typeof";return xE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xE(t)}var s5e=/^\s+/,l5e=/\s+$/;function li(t,e){if(t=t||"",e=e||{},t instanceof li)return t;if(!(this instanceof li))return new li(t,e);var r=u5e(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}li.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),r,n,i,a,s,o;return r=e.r/255,n=e.g/255,i=e.b/255,r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),.2126*a+.7152*s+.0722*o},setAlpha:function(e){return this._a=dQ(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=v$(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=v$(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.v*100);return this._a==1?"hsv("+r+", "+n+"%, "+i+"%)":"hsva("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=y$(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=y$(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),i=Math.round(e.l*100);return this._a==1?"hsl("+r+", "+n+"%, "+i+"%)":"hsla("+r+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return _$(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return d5e(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(cs(this._r,255)*100)+"%",g:Math.round(cs(this._g,255)*100)+"%",b:Math.round(cs(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(cs(this._r,255)*100)+"%, "+Math.round(cs(this._g,255)*100)+"%, "+Math.round(cs(this._b,255)*100)+"%)":"rgba("+Math.round(cs(this._r,255)*100)+"%, "+Math.round(cs(this._g,255)*100)+"%, "+Math.round(cs(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:T5e[_$(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var r="#"+b$(this._r,this._g,this._b,this._a),n=r,i=this._gradientType?"GradientType = 1, ":"";if(e){var a=li(e);n="#"+b$(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+r+",endColorstr="+n+")"},toString:function(e){var r=!!e;e=e||this._format;var n=!1,i=this._a<1&&this._a>=0,a=!r&&i&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return a?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return li(this.toString())},_applyModification:function(e,r){var n=e.apply(null,[this].concat([].slice.call(r)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(y5e,arguments)},brighten:function(){return this._applyModification(v5e,arguments)},darken:function(){return this._applyModification(_5e,arguments)},desaturate:function(){return this._applyModification(p5e,arguments)},saturate:function(){return this._applyModification(g5e,arguments)},greyscale:function(){return this._applyModification(m5e,arguments)},spin:function(){return this._applyModification(b5e,arguments)},_applyCombination:function(e,r){return e.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(S5e,arguments)},complement:function(){return this._applyCombination(x5e,arguments)},monochromatic:function(){return this._applyCombination(E5e,arguments)},splitcomplement:function(){return this._applyCombination(w5e,arguments)},triad:function(){return this._applyCombination(x$,[3])},tetrad:function(){return this._applyCombination(x$,[4])}};li.fromRatio=function(t,e){if(xE(t)=="object"){var r={};for(var n in t)t.hasOwnProperty(n)&&(n==="a"?r[n]=t[n]:r[n]=$1(t[n]));t=r}return li(t,e)};function u5e(t){var e={r:0,g:0,b:0},r=1,n=null,i=null,a=null,s=!1,o=!1;return typeof t=="string"&&(t=P5e(t)),xE(t)=="object"&&(Qd(t.r)&&Qd(t.g)&&Qd(t.b)?(e=c5e(t.r,t.g,t.b),s=!0,o=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Qd(t.h)&&Qd(t.s)&&Qd(t.v)?(n=$1(t.s),i=$1(t.v),e=h5e(t.h,n,i),s=!0,o="hsv"):Qd(t.h)&&Qd(t.s)&&Qd(t.l)&&(n=$1(t.s),a=$1(t.l),e=f5e(t.h,n,a),s=!0,o="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=dQ(r),{ok:s,format:t.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}function c5e(t,e,r){return{r:cs(t,255)*255,g:cs(e,255)*255,b:cs(r,255)*255}}function y$(t,e,r){t=cs(t,255),e=cs(e,255),r=cs(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,s,o=(n+i)/2;if(n==i)a=s=0;else{var c=n-i;switch(s=o>.5?c/(2-n-i):c/(n+i),n){case t:a=(e-r)/c+(e<r?6:0);break;case e:a=(r-t)/c+2;break;case r:a=(t-e)/c+4;break}a/=6}return{h:a,s,l:o}}function f5e(t,e,r){var n,i,a;t=cs(t,360),e=cs(e,100),r=cs(r,100);function s(f,d,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?f+(d-f)*6*m:m<1/2?d:m<2/3?f+(d-f)*(2/3-m)*6:f}if(e===0)n=i=a=r;else{var o=r<.5?r*(1+e):r+e-r*e,c=2*r-o;n=s(c,o,t+1/3),i=s(c,o,t),a=s(c,o,t-1/3)}return{r:n*255,g:i*255,b:a*255}}function v$(t,e,r){t=cs(t,255),e=cs(e,255),r=cs(r,255);var n=Math.max(t,e,r),i=Math.min(t,e,r),a,s,o=n,c=n-i;if(s=n===0?0:c/n,n==i)a=0;else{switch(n){case t:a=(e-r)/c+(e<r?6:0);break;case e:a=(r-t)/c+2;break;case r:a=(t-e)/c+4;break}a/=6}return{h:a,s,v:o}}function h5e(t,e,r){t=cs(t,360)*6,e=cs(e,100),r=cs(r,100);var n=Math.floor(t),i=t-n,a=r*(1-e),s=r*(1-i*e),o=r*(1-(1-i)*e),c=n%6,f=[r,s,a,a,o,r][c],d=[o,r,r,s,a,a][c],m=[a,a,o,r,r,s][c];return{r:f*255,g:d*255,b:m*255}}function _$(t,e,r,n){var i=[xh(Math.round(t).toString(16)),xh(Math.round(e).toString(16)),xh(Math.round(r).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function d5e(t,e,r,n,i){var a=[xh(Math.round(t).toString(16)),xh(Math.round(e).toString(16)),xh(Math.round(r).toString(16)),xh(pQ(n))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function b$(t,e,r,n){var i=[xh(pQ(n)),xh(Math.round(t).toString(16)),xh(Math.round(e).toString(16)),xh(Math.round(r).toString(16))];return i.join("")}li.equals=function(t,e){return!t||!e?!1:li(t).toRgbString()==li(e).toRgbString()};li.random=function(){return li.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function p5e(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.s-=e/100,r.s=A3(r.s),li(r)}function g5e(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.s+=e/100,r.s=A3(r.s),li(r)}function m5e(t){return li(t).desaturate(100)}function y5e(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.l+=e/100,r.l=A3(r.l),li(r)}function v5e(t,e){e=e===0?0:e||10;var r=li(t).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),li(r)}function _5e(t,e){e=e===0?0:e||10;var r=li(t).toHsl();return r.l-=e/100,r.l=A3(r.l),li(r)}function b5e(t,e){var r=li(t).toHsl(),n=(r.h+e)%360;return r.h=n<0?360+n:n,li(r)}function x5e(t){var e=li(t).toHsl();return e.h=(e.h+180)%360,li(e)}function x$(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var r=li(t).toHsl(),n=[li(t)],i=360/e,a=1;a<e;a++)n.push(li({h:(r.h+a*i)%360,s:r.s,l:r.l}));return n}function w5e(t){var e=li(t).toHsl(),r=e.h;return[li(t),li({h:(r+72)%360,s:e.s,l:e.l}),li({h:(r+216)%360,s:e.s,l:e.l})]}function S5e(t,e,r){e=e||6,r=r||30;var n=li(t).toHsl(),i=360/r,a=[li(t)];for(n.h=(n.h-(i*e>>1)+720)%360;--e;)n.h=(n.h+i)%360,a.push(li(n));return a}function E5e(t,e){e=e||6;for(var r=li(t).toHsv(),n=r.h,i=r.s,a=r.v,s=[],o=1/e;e--;)s.push(li({h:n,s:i,v:a})),a=(a+o)%1;return s}li.mix=function(t,e,r){r=r===0?0:r||50;var n=li(t).toRgb(),i=li(e).toRgb(),a=r/100,s={r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a};return li(s)};li.readability=function(t,e){var r=li(t),n=li(e);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)};li.isReadable=function(t,e,r){var n=li.readability(t,e),i,a;switch(a=!1,i=M5e(r),i.level+i.size){case"AAsmall":case"AAAlarge":a=n>=4.5;break;case"AAlarge":a=n>=3;break;case"AAAsmall":a=n>=7;break}return a};li.mostReadable=function(t,e,r){var n=null,i=0,a,s,o,c;r=r||{},s=r.includeFallbackColors,o=r.level,c=r.size;for(var f=0;f<e.length;f++)a=li.readability(t,e[f]),a>i&&(i=a,n=li(e[f]));return li.isReadable(t,n,{level:o,size:c})||!s?n:(r.includeFallbackColors=!1,li.mostReadable(t,["#fff","#000"],r))};var Hk=li.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},T5e=li.hexNames=C5e(Hk);function C5e(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function dQ(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function cs(t,e){A5e(t)&&(t="100%");var r=I5e(t);return t=Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function A3(t){return Math.min(1,Math.max(0,t))}function ef(t){return parseInt(t,16)}function A5e(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function I5e(t){return typeof t=="string"&&t.indexOf("%")!=-1}function xh(t){return t.length==1?"0"+t:""+t}function $1(t){return t<=1&&(t=t*100+"%"),t}function pQ(t){return Math.round(parseFloat(t)*255).toString(16)}function w$(t){return ef(t)/255}var gh=(function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",r="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?",i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function Qd(t){return!!gh.CSS_UNIT.exec(t)}function P5e(t){t=t.replace(s5e,"").replace(l5e,"").toLowerCase();var e=!1;if(Hk[t])t=Hk[t],e=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var r;return(r=gh.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=gh.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=gh.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=gh.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=gh.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=gh.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=gh.hex8.exec(t))?{r:ef(r[1]),g:ef(r[2]),b:ef(r[3]),a:w$(r[4]),format:e?"name":"hex8"}:(r=gh.hex6.exec(t))?{r:ef(r[1]),g:ef(r[2]),b:ef(r[3]),format:e?"name":"hex"}:(r=gh.hex4.exec(t))?{r:ef(r[1]+""+r[1]),g:ef(r[2]+""+r[2]),b:ef(r[3]+""+r[3]),a:w$(r[4]+""+r[4]),format:e?"name":"hex8"}:(r=gh.hex3.exec(t))?{r:ef(r[1]+""+r[1]),g:ef(r[2]+""+r[2]),b:ef(r[3]+""+r[3]),format:e?"name":"hex"}:!1}function M5e(t){var e,r;return t=t||{level:"AA",size:"small"},e=(t.level||"AA").toUpperCase(),r=(t.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),r!=="small"&&r!=="large"&&(r="small"),{level:e,size:r}}var S$=function(e){var r=["r","g","b","a","h","s","l","v"],n=0,i=0;return o5e(r,function(a){if(e[a]&&(n+=1,isNaN(e[a])||(i+=1),a==="s"||a==="l")){var s=/^\d+%$/;s.test(e[a])&&(i+=1)}}),n===i?e:!1},q1=function(e,r){var n=e.hex?li(e.hex):li(e),i=n.toHsl(),a=n.toHsv(),s=n.toRgb(),o=n.toHex();i.s===0&&(i.h=r||0,a.h=r||0);var c=o==="000000"&&s.a===0;return{hsl:i,hex:c?"transparent":"#"+o,rgb:s,hsv:a,oldHue:e.h||r||i.h,source:e.source}},Ug=function(e){if(e==="transparent")return!0;var r=String(e).charAt(0)==="#"?1:0;return e.length!==4+r&&e.length<7+r&&li(e).isValid()},NL=function(e){if(!e)return"#fff";var r=q1(e);if(r.hex==="transparent")return"rgba(0,0,0,0.4)";var n=(r.rgb.r*299+r.rgb.g*587+r.rgb.b*114)/1e3;return n>=128?"#000":"#fff"},sP=function(e,r){var n=e.replace("","");return li(r+" ("+n+")")._ok},c1=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},k5e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function R5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D5e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function O5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var zc=function(e){var r=(function(n){O5e(i,n);function i(a){R5e(this,i);var s=D5e(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return s.handleChange=function(o,c){var f=S$(o);if(f){var d=q1(o,o.h||s.state.oldHue);s.setState(d),s.props.onChangeComplete&&s.debounce(s.props.onChangeComplete,d,c),s.props.onChange&&s.props.onChange(d,c)}},s.handleSwatchHover=function(o,c){var f=S$(o);if(f){var d=q1(o,o.h||s.state.oldHue);s.props.onSwatchHover&&s.props.onSwatchHover(d,c)}},s.state=c1({},q1(a.color,0)),s.debounce=fQ(function(o,c,f){o(c,f)},100),s}return k5e(i,[{key:"render",value:function(){var s={};return this.props.onSwatchHover&&(s.onSwatchHover=this.handleSwatchHover),gt.createElement(e,c1({},this.props,this.state,{onChange:this.handleChange},s))}}],[{key:"getDerivedStateFromProps",value:function(s,o){return c1({},q1(s.color,o.oldHue))}}]),i})(te.PureComponent||te.Component);return r.propTypes=c1({},e.propTypes),r.defaultProps=c1({},e.defaultProps,{color:{h:250,s:.5,l:.2,a:1}}),r},L5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},N5e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function F5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E$(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function B5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var z5e=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"span";return(function(n){B5e(i,n);function i(){var a,s,o,c;F5e(this,i);for(var f=arguments.length,d=Array(f),m=0;m<f;m++)d[m]=arguments[m];return c=(s=(o=E$(this,(a=i.__proto__||Object.getPrototypeOf(i)).call.apply(a,[this].concat(d))),o),o.state={focus:!1},o.handleFocus=function(){return o.setState({focus:!0})},o.handleBlur=function(){return o.setState({focus:!1})},s),E$(o,c)}return N5e(i,[{key:"render",value:function(){return gt.createElement(r,{onFocus:this.handleFocus,onBlur:this.handleBlur},gt.createElement(e,L5e({},this.props,this.state)))}}]),i})(gt.Component)},T$=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},j5e=13,U5e=function(e){var r=e.color,n=e.style,i=e.onClick,a=i===void 0?function(){}:i,s=e.onHover,o=e.title,c=o===void 0?r:o,f=e.children,d=e.focus,m=e.focusStyle,b=m===void 0?{}:m,x=r==="transparent",E=Ni({default:{swatch:T$({background:r,height:"100%",width:"100%",cursor:"pointer",position:"relative",outline:"none"},n,d?b:{})}}),T=function(O){return a(r,O)},A=function(O){return O.keyCode===j5e&&a(r,O)},R=function(O){return s(r,O)},F={};return s&&(F.onMouseOver=R),gt.createElement("div",T$({style:E.swatch,onClick:T,title:c,tabIndex:0,onKeyDown:A},F),f,x&&gt.createElement(x_,{borderRadius:E.swatch.borderRadius,boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.1)"}))};const Ay=z5e(U5e);var V5e=function(e){var r=e.direction,n=Ni({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return gt.createElement("div",{style:n.picker})},$5e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gQ=function(e){var r=e.rgb,n=e.hsl,i=e.width,a=e.height,s=e.onChange,o=e.direction,c=e.style,f=e.renderers,d=e.pointer,m=e.className,b=m===void 0?"":m,x=Ni({default:{picker:{position:"relative",width:i,height:a},alpha:{radius:"2px",style:c}}});return gt.createElement("div",{style:x.picker,className:"alpha-picker "+b},gt.createElement(IL,$5e({},x.alpha,{rgb:r,hsl:n,pointer:d,renderers:f,onChange:s,direction:o})))};gQ.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:V5e};zc(gQ);function mQ(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var q5e="__lodash_hash_undefined__";function H5e(t){return this.__data__.set(t,q5e),this}function G5e(t){return this.__data__.has(t)}function wE(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Mp;++e<r;)this.add(t[e])}wE.prototype.add=wE.prototype.push=H5e;wE.prototype.has=G5e;function W5e(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function X5e(t,e){return t.has(e)}var Y5e=1,Z5e=2;function yQ(t,e,r,n,i,a){var s=r&Y5e,o=t.length,c=e.length;if(o!=c&&!(s&&c>o))return!1;var f=a.get(t),d=a.get(e);if(f&&d)return f==e&&d==t;var m=-1,b=!0,x=r&Z5e?new wE:void 0;for(a.set(t,e),a.set(e,t);++m<o;){var E=t[m],T=e[m];if(n)var A=s?n(T,E,m,e,t,a):n(E,T,m,t,e,a);if(A!==void 0){if(A)continue;b=!1;break}if(x){if(!W5e(e,function(R,F){if(!X5e(x,F)&&(E===R||i(E,R,r,n,a)))return x.push(F)})){b=!1;break}}else if(!(E===T||i(E,T,r,n,a))){b=!1;break}}return a.delete(t),a.delete(e),b}function K5e(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function J5e(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var Q5e=1,eIe=2,tIe="[object Boolean]",rIe="[object Date]",nIe="[object Error]",iIe="[object Map]",aIe="[object Number]",oIe="[object RegExp]",sIe="[object Set]",lIe="[object String]",uIe="[object Symbol]",cIe="[object ArrayBuffer]",fIe="[object DataView]",C$=kg?kg.prototype:void 0,lP=C$?C$.valueOf:void 0;function hIe(t,e,r,n,i,a,s){switch(r){case fIe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case cIe:return!(t.byteLength!=e.byteLength||!a(new vE(t),new vE(e)));case tIe:case rIe:case aIe:return qx(+t,+e);case nIe:return t.name==e.name&&t.message==e.message;case oIe:case lIe:return t==e+"";case iIe:var o=K5e;case sIe:var c=n&Q5e;if(o||(o=J5e),t.size!=e.size&&!c)return!1;var f=s.get(t);if(f)return f==e;n|=eIe,s.set(t,e);var d=yQ(o(t),o(e),n,i,a,s);return s.delete(t),d;case uIe:if(lP)return lP.call(t)==lP.call(e)}return!1}function dIe(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function pIe(t,e,r){var n=e(t);return pf(t)?n:dIe(n,r(t))}function gIe(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}function mIe(){return[]}var yIe=Object.prototype,vIe=yIe.propertyIsEnumerable,A$=Object.getOwnPropertySymbols,_Ie=A$?function(t){return t==null?[]:(t=Object(t),gIe(A$(t),function(e){return vIe.call(t,e)}))}:mIe;function I$(t){return pIe(t,LL,_Ie)}var bIe=1,xIe=Object.prototype,wIe=xIe.hasOwnProperty;function SIe(t,e,r,n,i,a){var s=r&bIe,o=I$(t),c=o.length,f=I$(e),d=f.length;if(c!=d&&!s)return!1;for(var m=c;m--;){var b=o[m];if(!(s?b in e:wIe.call(e,b)))return!1}var x=a.get(t),E=a.get(e);if(x&&E)return x==e&&E==t;var T=!0;a.set(t,e),a.set(e,t);for(var A=s;++m<c;){b=o[m];var R=t[b],F=e[b];if(n)var N=s?n(F,R,b,e,t,a):n(R,F,b,t,e,a);if(!(N===void 0?R===F||i(R,F,r,n,a):N)){T=!1;break}A||(A=b=="constructor")}if(T&&!A){var O=t.constructor,U=e.constructor;O!=U&&"constructor"in t&&"constructor"in e&&!(typeof O=="function"&&O instanceof O&&typeof U=="function"&&U instanceof U)&&(T=!1)}return a.delete(t),a.delete(e),T}var Gk=Cy(Lh,"DataView"),Wk=Cy(Lh,"Promise"),Xk=Cy(Lh,"Set"),Yk=Cy(Lh,"WeakMap"),P$="[object Map]",EIe="[object Object]",M$="[object Promise]",k$="[object Set]",R$="[object WeakMap]",D$="[object DataView]",TIe=Ty(Gk),CIe=Ty(Zb),AIe=Ty(Wk),IIe=Ty(Xk),PIe=Ty(Yk),ng=Ey;(Gk&&ng(new Gk(new ArrayBuffer(1)))!=D$||Zb&&ng(new Zb)!=P$||Wk&&ng(Wk.resolve())!=M$||Xk&&ng(new Xk)!=k$||Yk&&ng(new Yk)!=R$)&&(ng=function(t){var e=Ey(t),r=e==EIe?t.constructor:void 0,n=r?Ty(r):"";if(n)switch(n){case TIe:return D$;case CIe:return P$;case AIe:return M$;case IIe:return k$;case PIe:return R$}return e});var MIe=1,O$="[object Arguments]",L$="[object Array]",Aw="[object Object]",kIe=Object.prototype,N$=kIe.hasOwnProperty;function RIe(t,e,r,n,i,a){var s=pf(t),o=pf(e),c=s?L$:ng(t),f=o?L$:ng(e);c=c==O$?Aw:c,f=f==O$?Aw:f;var d=c==Aw,m=f==Aw,b=c==f;if(b&&bE(t)){if(!bE(e))return!1;s=!0,d=!1}if(b&&!d)return a||(a=new _d),s||DL(t)?yQ(t,e,r,n,i,a):hIe(t,e,c,r,n,i,a);if(!(r&MIe)){var x=d&&N$.call(t,"__wrapped__"),E=m&&N$.call(e,"__wrapped__");if(x||E){var T=x?t.value():t,A=E?e.value():e;return a||(a=new _d),i(T,A,r,n,a)}}return b?(a||(a=new _d),SIe(t,e,r,n,i,a)):!1}function FL(t,e,r,n,i){return t===e?!0:t==null||e==null||!Rg(t)&&!Rg(e)?t!==t&&e!==e:RIe(t,e,r,n,FL,i)}var DIe=1,OIe=2;function LIe(t,e,r,n){var i=r.length,a=i;if(t==null)return!a;for(t=Object(t);i--;){var s=r[i];if(s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<a;){s=r[i];var o=s[0],c=t[o],f=s[1];if(s[2]){if(c===void 0&&!(o in t))return!1}else{var d=new _d,m;if(!(m===void 0?FL(f,c,DIe|OIe,n,d):m))return!1}}return!0}function vQ(t){return t===t&&!Yf(t)}function NIe(t){for(var e=LL(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,vQ(i)]}return e}function _Q(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function FIe(t){var e=NIe(t);return e.length==1&&e[0][2]?_Q(e[0][0],e[0][1]):function(r){return r===t||LIe(r,t,e)}}var BIe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,zIe=/^\w*$/;function BL(t,e){if(pf(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||T3(t)?!0:zIe.test(t)||!BIe.test(t)||e!=null&&t in Object(e)}var jIe="Expected a function";function zL(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(jIe);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var s=t.apply(this,n);return r.cache=a.set(i,s)||a,s};return r.cache=new(zL.Cache||Mp),r}zL.Cache=Mp;var UIe=500;function VIe(t){var e=zL(t,function(n){return r.size===UIe&&r.clear(),n}),r=e.cache;return e}var $Ie=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qIe=/\\(\\)?/g,HIe=VIe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace($Ie,function(r,n,i,a){e.push(i?a.replace(qIe,"$1"):n||r)}),e}),F$=kg?kg.prototype:void 0,B$=F$?F$.toString:void 0;function bQ(t){if(typeof t=="string")return t;if(pf(t))return mQ(t,bQ)+"";if(T3(t))return B$?B$.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function GIe(t){return t==null?"":bQ(t)}function xQ(t,e){return pf(t)?t:BL(t,e)?[t]:HIe(GIe(t))}function I3(t){if(typeof t=="string"||T3(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function wQ(t,e){e=xQ(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[I3(e[r++])];return r&&r==n?t:void 0}function WIe(t,e,r){var n=t==null?void 0:wQ(t,e);return n===void 0?r:n}function XIe(t,e){return t!=null&&e in Object(t)}function YIe(t,e,r){e=xQ(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var s=I3(e[n]);if(!(a=t!=null&&r(t,s)))break;t=t[s]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&RL(i)&&OL(s,i)&&(pf(t)||_E(t)))}function ZIe(t,e){return t!=null&&YIe(t,e,XIe)}var KIe=1,JIe=2;function QIe(t,e){return BL(t)&&vQ(e)?_Q(I3(t),e):function(r){var n=WIe(r,t);return n===void 0&&n===e?ZIe(r,t):FL(e,n,KIe|JIe)}}function e4e(t){return function(e){return e?.[t]}}function t4e(t){return function(e){return wQ(e,t)}}function r4e(t){return BL(t)?e4e(I3(t)):t4e(t)}function n4e(t){return typeof t=="function"?t:t==null?E3:typeof t=="object"?pf(t)?QIe(t[0],t[1]):FIe(t):r4e(t)}function i4e(t,e){var r=-1,n=S_(t)?Array(t.length):[];return hQ(t,function(i,a,s){n[++r]=e(i,a,s)}),n}function Iy(t,e){var r=pf(t)?mQ:i4e;return r(t,n4e(e))}var a4e=function(e){var r=e.colors,n=e.onClick,i=e.onSwatchHover,a=Ni({default:{swatches:{marginRight:"-10px"},swatch:{width:"22px",height:"22px",float:"left",marginRight:"10px",marginBottom:"10px",borderRadius:"4px"},clear:{clear:"both"}}});return gt.createElement("div",{style:a.swatches},Iy(r,function(s){return gt.createElement(Ay,{key:s,color:s,style:a.swatch,onClick:n,onHover:i,focusStyle:{boxShadow:"0 0 4px "+s}})}),gt.createElement("div",{style:a.clear}))},jL=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,a=e.colors,s=e.width,o=e.triangle,c=e.styles,f=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=i==="transparent",x=function(A,R){Ug(A)&&r({hex:A,source:"hex"},R)},E=Ni(Bc({default:{card:{width:s,background:"#fff",boxShadow:"0 1px rgba(0,0,0,.1)",borderRadius:"6px",position:"relative"},head:{height:"110px",background:i,borderRadius:"6px 6px 0 0",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},body:{padding:"10px"},label:{fontSize:"18px",color:NL(i),position:"relative"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 10px 10px 10px",borderColor:"transparent transparent "+i+" transparent",position:"absolute",top:"-10px",left:"50%",marginLeft:"-10px"},input:{width:"100%",fontSize:"12px",color:"#666",border:"0px",outline:"none",height:"22px",boxShadow:"inset 0 0 0 1px #ddd",borderRadius:"4px",padding:"0 7px",boxSizing:"border-box"}},"hide-triangle":{triangle:{display:"none"}}},f),{"hide-triangle":o==="hide"});return gt.createElement("div",{style:E.card,className:"block-picker "+m},gt.createElement("div",{style:E.triangle}),gt.createElement("div",{style:E.head},b&&gt.createElement(x_,{borderRadius:"6px 6px 0 0"}),gt.createElement("div",{style:E.label},i)),gt.createElement("div",{style:E.body},gt.createElement(a4e,{colors:a,onClick:x,onSwatchHover:n}),gt.createElement(va,{style:{input:E.input},value:i,onChange:x})))};jL.propTypes={width:kn.oneOfType([kn.string,kn.number]),colors:kn.arrayOf(kn.string),triangle:kn.oneOf(["top","hide"]),styles:kn.object};jL.defaultProps={width:170,colors:["#D9E3F0","#F47373","#697689","#37D67A","#2CCCE4","#555555","#dce775","#ff8a65","#ba68c8"],triangle:"top",styles:{}};zc(jL);var Fv={100:"#ffcdd2",300:"#e57373",500:"#f44336",700:"#d32f2f",900:"#b71c1c"},Bv={100:"#f8bbd0",300:"#f06292",500:"#e91e63",700:"#c2185b",900:"#880e4f"},zv={100:"#e1bee7",300:"#ba68c8",500:"#9c27b0",700:"#7b1fa2",900:"#4a148c"},jv={100:"#d1c4e9",300:"#9575cd",500:"#673ab7",700:"#512da8",900:"#311b92"},Uv={100:"#c5cae9",300:"#7986cb",500:"#3f51b5",700:"#303f9f",900:"#1a237e"},Vv={100:"#bbdefb",300:"#64b5f6",500:"#2196f3",700:"#1976d2",900:"#0d47a1"},$v={100:"#b3e5fc",300:"#4fc3f7",500:"#03a9f4",700:"#0288d1",900:"#01579b"},qv={100:"#b2ebf2",300:"#4dd0e1",500:"#00bcd4",700:"#0097a7",900:"#006064"},Hv={100:"#b2dfdb",300:"#4db6ac",500:"#009688",700:"#00796b",900:"#004d40"},H1={100:"#c8e6c9",300:"#81c784",500:"#4caf50",700:"#388e3c"},Gv={100:"#dcedc8",300:"#aed581",500:"#8bc34a",700:"#689f38",900:"#33691e"},Wv={100:"#f0f4c3",300:"#dce775",500:"#cddc39",700:"#afb42b",900:"#827717"},Xv={100:"#fff9c4",300:"#fff176",500:"#ffeb3b",700:"#fbc02d",900:"#f57f17"},Yv={100:"#ffecb3",300:"#ffd54f",500:"#ffc107",700:"#ffa000",900:"#ff6f00"},Zv={100:"#ffe0b2",300:"#ffb74d",500:"#ff9800",700:"#f57c00",900:"#e65100"},Kv={100:"#ffccbc",300:"#ff8a65",500:"#ff5722",700:"#e64a19",900:"#bf360c"},Jv={100:"#d7ccc8",300:"#a1887f",500:"#795548",700:"#5d4037",900:"#3e2723"},Qv={100:"#cfd8dc",300:"#90a4ae",500:"#607d8b",700:"#455a64",900:"#263238"},SQ=function(e){var r=e.color,n=e.onClick,i=e.onSwatchHover,a=e.hover,s=e.active,o=e.circleSize,c=e.circleSpacing,f=Ni({default:{swatch:{width:o,height:o,marginRight:c,marginBottom:c,transform:"scale(1)",transition:"100ms transform ease"},Swatch:{borderRadius:"50%",background:"transparent",boxShadow:"inset 0 0 0 "+(o/2+1)+"px "+r,transition:"100ms box-shadow ease"}},hover:{swatch:{transform:"scale(1.2)"}},active:{Swatch:{boxShadow:"inset 0 0 0 3px "+r}}},{hover:a,active:s});return gt.createElement("div",{style:f.swatch},gt.createElement(Ay,{style:f.Swatch,color:r,onClick:n,onHover:i,focusStyle:{boxShadow:f.Swatch.boxShadow+", 0 0 5px "+r}}))};SQ.defaultProps={circleSize:28,circleSpacing:14};const o4e=AL.handleHover(SQ);var UL=function(e){var r=e.width,n=e.onChange,i=e.onSwatchHover,a=e.colors,s=e.hex,o=e.circleSize,c=e.styles,f=c===void 0?{}:c,d=e.circleSpacing,m=e.className,b=m===void 0?"":m,x=Ni(Bc({default:{card:{width:r,display:"flex",flexWrap:"wrap",marginRight:-d,marginBottom:-d}}},f)),E=function(A,R){return n({hex:A,source:"hex"},R)};return gt.createElement("div",{style:x.card,className:"circle-picker "+b},Iy(a,function(T){return gt.createElement(o4e,{key:T,color:T,onClick:E,onSwatchHover:i,active:s===T.toLowerCase(),circleSize:o,circleSpacing:d})}))};UL.propTypes={width:kn.oneOfType([kn.string,kn.number]),circleSize:kn.number,circleSpacing:kn.number,styles:kn.object};UL.defaultProps={width:252,circleSize:28,circleSpacing:14,colors:[Fv[500],Bv[500],zv[500],jv[500],Uv[500],Vv[500],$v[500],qv[500],Hv[500],H1[500],Gv[500],Wv[500],Xv[500],Yv[500],Zv[500],Kv[500],Jv[500],Qv[500]],styles:{}};zc(UL);function z$(t){return t===void 0}var Iw={},j$;function s4e(){if(j$)return Iw;j$=1,Object.defineProperty(Iw,"__esModule",{value:!0});var t=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(s[f]=c[f])}return s},e=vx(),r=n(e);function n(s){return s&&s.__esModule?s:{default:s}}function i(s,o){var c={};for(var f in s)o.indexOf(f)>=0||Object.prototype.hasOwnProperty.call(s,f)&&(c[f]=s[f]);return c}var a=24;return Iw.default=function(s){var o=s.fill,c=o===void 0?"currentColor":o,f=s.width,d=f===void 0?a:f,m=s.height,b=m===void 0?a:m,x=s.style,E=x===void 0?{}:x,T=i(s,["fill","width","height","style"]);return r.default.createElement("svg",t({viewBox:"0 0 "+a+" "+a,style:t({fill:c,width:d,height:b},E)},T),r.default.createElement("path",{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}))},Iw}var l4e=s4e();const u4e=Cd(l4e);var c4e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function f4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h4e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function d4e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var EQ=(function(t){d4e(e,t);function e(r){f4e(this,e);var n=h4e(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.toggleViews=function(){n.state.view==="hex"?n.setState({view:"rgb"}):n.state.view==="rgb"?n.setState({view:"hsl"}):n.state.view==="hsl"&&(n.props.hsl.a===1?n.setState({view:"hex"}):n.setState({view:"rgb"}))},n.handleChange=function(i,a){i.hex?Ug(i.hex)&&n.props.onChange({hex:i.hex,source:"hex"},a):i.r||i.g||i.b?n.props.onChange({r:i.r||n.props.rgb.r,g:i.g||n.props.rgb.g,b:i.b||n.props.rgb.b,source:"rgb"},a):i.a?(i.a<0?i.a=0:i.a>1&&(i.a=1),n.props.onChange({h:n.props.hsl.h,s:n.props.hsl.s,l:n.props.hsl.l,a:Math.round(i.a*100)/100,source:"rgb"},a)):(i.h||i.s||i.l)&&(typeof i.s=="string"&&i.s.includes("%")&&(i.s=i.s.replace("%","")),typeof i.l=="string"&&i.l.includes("%")&&(i.l=i.l.replace("%","")),i.s==1?i.s=.01:i.l==1&&(i.l=.01),n.props.onChange({h:i.h||n.props.hsl.h,s:Number(z$(i.s)?n.props.hsl.s:i.s),l:Number(z$(i.l)?n.props.hsl.l:i.l),source:"hsl"},a))},n.showHighlight=function(i){i.currentTarget.style.background="#eee"},n.hideHighlight=function(i){i.currentTarget.style.background="transparent"},r.hsl.a!==1&&r.view==="hex"?n.state={view:"rgb"}:n.state={view:r.view},n}return c4e(e,[{key:"render",value:function(){var n=this,i=Ni({default:{wrap:{paddingTop:"16px",display:"flex"},fields:{flex:"1",display:"flex",marginLeft:"-6px"},field:{paddingLeft:"6px",width:"100%"},alpha:{paddingLeft:"6px",width:"100%"},toggle:{width:"32px",textAlign:"right",position:"relative"},icon:{marginRight:"-4px",marginTop:"12px",cursor:"pointer",position:"relative"},iconHighlight:{position:"absolute",width:"24px",height:"28px",background:"#eee",borderRadius:"4px",top:"10px",left:"12px",display:"none"},input:{fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px",textAlign:"center"},label:{textTransform:"uppercase",fontSize:"11px",lineHeight:"11px",color:"#969696",textAlign:"center",display:"block",marginTop:"12px"},svg:{fill:"#333",width:"24px",height:"24px",border:"1px transparent solid",borderRadius:"5px"}},disableAlpha:{alpha:{display:"none"}}},this.props,this.state),a=void 0;return this.state.view==="hex"?a=gt.createElement("div",{style:i.fields,className:"flexbox-fix"},gt.createElement("div",{style:i.field},gt.createElement(va,{style:{input:i.input,label:i.label},label:"hex",value:this.props.hex,onChange:this.handleChange}))):this.state.view==="rgb"?a=gt.createElement("div",{style:i.fields,className:"flexbox-fix"},gt.createElement("div",{style:i.field},gt.createElement(va,{style:{input:i.input,label:i.label},label:"r",value:this.props.rgb.r,onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(va,{style:{input:i.input,label:i.label},label:"g",value:this.props.rgb.g,onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(va,{style:{input:i.input,label:i.label},label:"b",value:this.props.rgb.b,onChange:this.handleChange})),gt.createElement("div",{style:i.alpha},gt.createElement(va,{style:{input:i.input,label:i.label},label:"a",value:this.props.rgb.a,arrowOffset:.01,onChange:this.handleChange}))):this.state.view==="hsl"&&(a=gt.createElement("div",{style:i.fields,className:"flexbox-fix"},gt.createElement("div",{style:i.field},gt.createElement(va,{style:{input:i.input,label:i.label},label:"h",value:Math.round(this.props.hsl.h),onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(va,{style:{input:i.input,label:i.label},label:"s",value:Math.round(this.props.hsl.s*100)+"%",onChange:this.handleChange})),gt.createElement("div",{style:i.field},gt.createElement(va,{style:{input:i.input,label:i.label},label:"l",value:Math.round(this.props.hsl.l*100)+"%",onChange:this.handleChange})),gt.createElement("div",{style:i.alpha},gt.createElement(va,{style:{input:i.input,label:i.label},label:"a",value:this.props.hsl.a,arrowOffset:.01,onChange:this.handleChange})))),gt.createElement("div",{style:i.wrap,className:"flexbox-fix"},a,gt.createElement("div",{style:i.toggle},gt.createElement("div",{style:i.icon,onClick:this.toggleViews,ref:function(o){return n.icon=o}},gt.createElement(u4e,{style:i.svg,onMouseOver:this.showHighlight,onMouseEnter:this.showHighlight,onMouseOut:this.hideHighlight}))))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.hsl.a!==1&&i.view==="hex"?{view:"rgb"}:null}}]),e})(gt.Component);EQ.defaultProps={view:"hex"};var U$=function(){var e=Ni({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return gt.createElement("div",{style:e.picker})},p4e=function(){var e=Ni({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}}});return gt.createElement("div",{style:e.picker})},VL=function(e){var r=e.width,n=e.onChange,i=e.disableAlpha,a=e.rgb,s=e.hsl,o=e.hsv,c=e.hex,f=e.renderers,d=e.styles,m=d===void 0?{}:d,b=e.className,x=b===void 0?"":b,E=e.defaultView,T=Ni(Bc({default:{picker:{width:r,background:"#fff",borderRadius:"2px",boxShadow:"0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)",boxSizing:"initial",fontFamily:"Menlo"},saturation:{width:"100%",paddingBottom:"55%",position:"relative",borderRadius:"2px 2px 0 0",overflow:"hidden"},Saturation:{radius:"2px 2px 0 0"},body:{padding:"16px 16px 12px"},controls:{display:"flex"},color:{width:"32px"},swatch:{marginTop:"6px",width:"16px",height:"16px",borderRadius:"8px",position:"relative",overflow:"hidden"},active:{absolute:"0px 0px 0px 0px",borderRadius:"8px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.1)",background:"rgba("+a.r+", "+a.g+", "+a.b+", "+a.a+")",zIndex:"2"},toggles:{flex:"1"},hue:{height:"10px",position:"relative",marginBottom:"8px"},Hue:{radius:"2px"},alpha:{height:"10px",position:"relative"},Alpha:{radius:"2px"}},disableAlpha:{color:{width:"22px"},alpha:{display:"none"},hue:{marginBottom:"0px"},swatch:{width:"10px",height:"10px",marginTop:"0px"}}},m),{disableAlpha:i});return gt.createElement("div",{style:T.picker,className:"chrome-picker "+x},gt.createElement("div",{style:T.saturation},gt.createElement(C3,{style:T.Saturation,hsl:s,hsv:o,pointer:p4e,onChange:n})),gt.createElement("div",{style:T.body},gt.createElement("div",{style:T.controls,className:"flexbox-fix"},gt.createElement("div",{style:T.color},gt.createElement("div",{style:T.swatch},gt.createElement("div",{style:T.active}),gt.createElement(x_,{renderers:f}))),gt.createElement("div",{style:T.toggles},gt.createElement("div",{style:T.hue},gt.createElement(w_,{style:T.Hue,hsl:s,pointer:U$,onChange:n})),gt.createElement("div",{style:T.alpha},gt.createElement(IL,{style:T.Alpha,rgb:a,hsl:s,pointer:U$,renderers:f,onChange:n})))),gt.createElement(EQ,{rgb:a,hsl:s,hex:c,view:E,onChange:n,disableAlpha:i})))};VL.propTypes={width:kn.oneOfType([kn.string,kn.number]),disableAlpha:kn.bool,styles:kn.object,defaultView:kn.oneOf(["hex","rgb","hsl"])};VL.defaultProps={width:225,disableAlpha:!1,styles:{}};const g4e=zc(VL);var m4e=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=e.active,o=Ni({default:{color:{background:r,width:"15px",height:"15px",float:"left",marginRight:"5px",marginBottom:"5px",position:"relative",cursor:"pointer"},dot:{absolute:"5px 5px 5px 5px",background:NL(r),borderRadius:"50%",opacity:"0"}},active:{dot:{opacity:"1"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},dot:{background:"#000"}},transparent:{dot:{background:"#000"}}},{active:s,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return gt.createElement(Ay,{style:o.color,color:r,onClick:i,onHover:a,focusStyle:{boxShadow:"0 0 4px "+r}},gt.createElement("div",{style:o.dot}))},y4e=function(e){var r=e.hex,n=e.rgb,i=e.onChange,a=Ni({default:{fields:{display:"flex",paddingBottom:"6px",paddingRight:"5px",position:"relative"},active:{position:"absolute",top:"6px",left:"5px",height:"9px",width:"9px",background:r},HEXwrap:{flex:"6",position:"relative"},HEXinput:{width:"80%",padding:"0px",paddingLeft:"20%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},HEXlabel:{display:"none"},RGBwrap:{flex:"3",position:"relative"},RGBinput:{width:"70%",padding:"0px",paddingLeft:"30%",border:"none",outline:"none",background:"none",fontSize:"12px",color:"#333",height:"16px"},RGBlabel:{position:"absolute",top:"3px",left:"0px",lineHeight:"16px",textTransform:"uppercase",fontSize:"12px",color:"#999"}}}),s=function(c,f){c.r||c.g||c.b?i({r:c.r||n.r,g:c.g||n.g,b:c.b||n.b,source:"rgb"},f):i({hex:c.hex,source:"hex"},f)};return gt.createElement("div",{style:a.fields,className:"flexbox-fix"},gt.createElement("div",{style:a.active}),gt.createElement(va,{style:{wrap:a.HEXwrap,input:a.HEXinput,label:a.HEXlabel},label:"hex",value:r,onChange:s}),gt.createElement(va,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"r",value:n.r,onChange:s}),gt.createElement(va,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"g",value:n.g,onChange:s}),gt.createElement(va,{style:{wrap:a.RGBwrap,input:a.RGBinput,label:a.RGBlabel},label:"b",value:n.b,onChange:s}))},$L=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.colors,a=e.hex,s=e.rgb,o=e.styles,c=o===void 0?{}:o,f=e.className,d=f===void 0?"":f,m=Ni(Bc({default:{Compact:{background:"#f6f6f6",radius:"4px"},compact:{paddingTop:"5px",paddingLeft:"5px",boxSizing:"initial",width:"240px"},clear:{clear:"both"}}},c)),b=function(E,T){E.hex?Ug(E.hex)&&r({hex:E.hex,source:"hex"},T):r(E,T)};return gt.createElement(Hx,{style:m.Compact,styles:c},gt.createElement("div",{style:m.compact,className:"compact-picker "+d},gt.createElement("div",null,Iy(i,function(x){return gt.createElement(m4e,{key:x,color:x,active:x.toLowerCase()===a,onClick:b,onSwatchHover:n})}),gt.createElement("div",{style:m.clear})),gt.createElement(y4e,{hex:a,rgb:s,onChange:b})))};$L.propTypes={colors:kn.arrayOf(kn.string),styles:kn.object};$L.defaultProps={colors:["#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#000000","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],styles:{}};zc($L);var v4e=function(e){var r=e.hover,n=e.color,i=e.onClick,a=e.onSwatchHover,s={position:"relative",zIndex:"2",outline:"2px solid #fff",boxShadow:"0 0 5px 2px rgba(0,0,0,0.25)"},o=Ni({default:{swatch:{width:"25px",height:"25px",fontSize:"0"}},hover:{swatch:s}},{hover:r});return gt.createElement("div",{style:o.swatch},gt.createElement(Ay,{color:n,onClick:i,onHover:a,focusStyle:s}))};const _4e=AL.handleHover(v4e);var qL=function(e){var r=e.width,n=e.colors,i=e.onChange,a=e.onSwatchHover,s=e.triangle,o=e.styles,c=o===void 0?{}:o,f=e.className,d=f===void 0?"":f,m=Ni(Bc({default:{card:{width:r,background:"#fff",border:"1px solid rgba(0,0,0,0.2)",boxShadow:"0 3px 12px rgba(0,0,0,0.15)",borderRadius:"4px",position:"relative",padding:"5px",display:"flex",flexWrap:"wrap"},triangle:{position:"absolute",border:"7px solid transparent",borderBottomColor:"#fff"},triangleShadow:{position:"absolute",border:"8px solid transparent",borderBottomColor:"rgba(0,0,0,0.15)"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-14px",left:"10px"},triangleShadow:{top:"-16px",left:"9px"}},"top-right-triangle":{triangle:{top:"-14px",right:"10px"},triangleShadow:{top:"-16px",right:"9px"}},"bottom-left-triangle":{triangle:{top:"35px",left:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",left:"9px",transform:"rotate(180deg)"}},"bottom-right-triangle":{triangle:{top:"35px",right:"10px",transform:"rotate(180deg)"},triangleShadow:{top:"37px",right:"9px",transform:"rotate(180deg)"}}},c),{"hide-triangle":s==="hide","top-left-triangle":s==="top-left","top-right-triangle":s==="top-right","bottom-left-triangle":s==="bottom-left","bottom-right-triangle":s==="bottom-right"}),b=function(E,T){return i({hex:E,source:"hex"},T)};return gt.createElement("div",{style:m.card,className:"github-picker "+d},gt.createElement("div",{style:m.triangleShadow}),gt.createElement("div",{style:m.triangle}),Iy(n,function(x){return gt.createElement(_4e,{color:x,key:x,onClick:b,onSwatchHover:a})}))};qL.propTypes={width:kn.oneOfType([kn.string,kn.number]),colors:kn.arrayOf(kn.string),triangle:kn.oneOf(["hide","top-left","top-right","bottom-left","bottom-right"]),styles:kn.object};qL.defaultProps={width:200,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],triangle:"top-left",styles:{}};zc(qL);var b4e=function(e){var r=e.direction,n=Ni({default:{picker:{width:"18px",height:"18px",borderRadius:"50%",transform:"translate(-9px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}},vertical:{picker:{transform:"translate(-3px, -9px)"}}},{vertical:r==="vertical"});return gt.createElement("div",{style:n.picker})},x4e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},HL=function(e){var r=e.width,n=e.height,i=e.onChange,a=e.hsl,s=e.direction,o=e.pointer,c=e.styles,f=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=Ni(Bc({default:{picker:{position:"relative",width:r,height:n},hue:{radius:"2px"}}},f)),x=function(T){return i({a:1,h:T.h,l:.5,s:1})};return gt.createElement("div",{style:b.picker,className:"hue-picker "+m},gt.createElement(w_,x4e({},b.hue,{hsl:a,pointer:o,onChange:x,direction:s})))};HL.propTypes={styles:kn.object};HL.defaultProps={width:"316px",height:"16px",direction:"horizontal",pointer:b4e,styles:{}};zc(HL);var w4e=function(e){var r=e.onChange,n=e.hex,i=e.rgb,a=e.styles,s=a===void 0?{}:a,o=e.className,c=o===void 0?"":o,f=Ni(Bc({default:{material:{width:"98px",height:"98px",padding:"16px",fontFamily:"Roboto"},HEXwrap:{position:"relative"},HEXinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"2px solid "+n,outline:"none",height:"30px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},Hex:{style:{}},RGBwrap:{position:"relative"},RGBinput:{width:"100%",marginTop:"12px",fontSize:"15px",color:"#333",padding:"0px",border:"0px",borderBottom:"1px solid #eee",outline:"none",height:"30px"},RGBlabel:{position:"absolute",top:"0px",left:"0px",fontSize:"11px",color:"#999999",textTransform:"capitalize"},split:{display:"flex",marginRight:"-10px",paddingTop:"11px"},third:{flex:"1",paddingRight:"10px"}}},s)),d=function(b,x){b.hex?Ug(b.hex)&&r({hex:b.hex,source:"hex"},x):(b.r||b.g||b.b)&&r({r:b.r||i.r,g:b.g||i.g,b:b.b||i.b,source:"rgb"},x)};return gt.createElement(Hx,{styles:s},gt.createElement("div",{style:f.material,className:"material-picker "+c},gt.createElement(va,{style:{wrap:f.HEXwrap,input:f.HEXinput,label:f.HEXlabel},label:"hex",value:n,onChange:d}),gt.createElement("div",{style:f.split,className:"flexbox-fix"},gt.createElement("div",{style:f.third},gt.createElement(va,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"r",value:i.r,onChange:d})),gt.createElement("div",{style:f.third},gt.createElement(va,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"g",value:i.g,onChange:d})),gt.createElement("div",{style:f.third},gt.createElement(va,{style:{wrap:f.RGBwrap,input:f.RGBinput,label:f.RGBlabel},label:"b",value:i.b,onChange:d})))))};zc(w4e);var S4e=function(e){var r=e.onChange,n=e.rgb,i=e.hsv,a=e.hex,s=Ni({default:{fields:{paddingTop:"5px",paddingBottom:"9px",width:"80px",position:"relative"},divider:{height:"5px"},RGBwrap:{position:"relative"},RGBinput:{marginLeft:"40%",width:"40%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"5px",fontSize:"13px",paddingLeft:"3px",marginRight:"10px"},RGBlabel:{left:"0px",top:"0px",width:"34px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px",position:"absolute"},HEXwrap:{position:"relative"},HEXinput:{marginLeft:"20%",width:"80%",height:"18px",border:"1px solid #888888",boxShadow:"inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC",marginBottom:"6px",fontSize:"13px",paddingLeft:"3px"},HEXlabel:{position:"absolute",top:"0px",left:"0px",width:"14px",textTransform:"uppercase",fontSize:"13px",height:"18px",lineHeight:"22px"},fieldSymbols:{position:"absolute",top:"5px",right:"-7px",fontSize:"13px"},symbol:{height:"20px",lineHeight:"22px",paddingBottom:"7px"}}}),o=function(f,d){f["#"]?Ug(f["#"])&&r({hex:f["#"],source:"hex"},d):f.r||f.g||f.b?r({r:f.r||n.r,g:f.g||n.g,b:f.b||n.b,source:"rgb"},d):(f.h||f.s||f.v)&&r({h:f.h||i.h,s:f.s||i.s,v:f.v||i.v,source:"hsv"},d)};return gt.createElement("div",{style:s.fields},gt.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"h",value:Math.round(i.h),onChange:o}),gt.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"s",value:Math.round(i.s*100),onChange:o}),gt.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"v",value:Math.round(i.v*100),onChange:o}),gt.createElement("div",{style:s.divider}),gt.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"r",value:n.r,onChange:o}),gt.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"g",value:n.g,onChange:o}),gt.createElement(va,{style:{wrap:s.RGBwrap,input:s.RGBinput,label:s.RGBlabel},label:"b",value:n.b,onChange:o}),gt.createElement("div",{style:s.divider}),gt.createElement(va,{style:{wrap:s.HEXwrap,input:s.HEXinput,label:s.HEXlabel},label:"#",value:a.replace("#",""),onChange:o}),gt.createElement("div",{style:s.fieldSymbols},gt.createElement("div",{style:s.symbol},""),gt.createElement("div",{style:s.symbol},"%"),gt.createElement("div",{style:s.symbol},"%")))},E4e=function(e){var r=e.hsl,n=Ni({default:{picker:{width:"12px",height:"12px",borderRadius:"6px",boxShadow:"inset 0 0 0 1px #fff",transform:"translate(-6px, -6px)"}},"black-outline":{picker:{boxShadow:"inset 0 0 0 1px #000"}}},{"black-outline":r.l>.5});return gt.createElement("div",{style:n.picker})},T4e=function(){var e=Ni({default:{triangle:{width:0,height:0,borderStyle:"solid",borderWidth:"4px 0 4px 6px",borderColor:"transparent transparent transparent #fff",position:"absolute",top:"1px",left:"1px"},triangleBorder:{width:0,height:0,borderStyle:"solid",borderWidth:"5px 0 5px 8px",borderColor:"transparent transparent transparent #555"},left:{Extend:"triangleBorder",transform:"translate(-13px, -4px)"},leftInside:{Extend:"triangle",transform:"translate(-8px, -5px)"},right:{Extend:"triangleBorder",transform:"translate(20px, -14px) rotate(180deg)"},rightInside:{Extend:"triangle",transform:"translate(-8px, -5px)"}}});return gt.createElement("div",{style:e.pointer},gt.createElement("div",{style:e.left},gt.createElement("div",{style:e.leftInside})),gt.createElement("div",{style:e.right},gt.createElement("div",{style:e.rightInside})))},V$=function(e){var r=e.onClick,n=e.label,i=e.children,a=e.active,s=Ni({default:{button:{backgroundImage:"linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)",border:"1px solid #878787",borderRadius:"2px",height:"20px",boxShadow:"0 1px 0 0 #EAEAEA",fontSize:"14px",color:"#000",lineHeight:"20px",textAlign:"center",marginBottom:"10px",cursor:"pointer"}},active:{button:{boxShadow:"0 0 0 1px #878787"}}},{active:a});return gt.createElement("div",{style:s.button,onClick:r},n||i)},C4e=function(e){var r=e.rgb,n=e.currentColor,i=Ni({default:{swatches:{border:"1px solid #B3B3B3",borderBottom:"1px solid #F0F0F0",marginBottom:"2px",marginTop:"1px"},new:{height:"34px",background:"rgb("+r.r+","+r.g+", "+r.b+")",boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000"},current:{height:"34px",background:n,boxShadow:"inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000"},label:{fontSize:"14px",color:"#000",textAlign:"center"}}});return gt.createElement("div",null,gt.createElement("div",{style:i.label},"new"),gt.createElement("div",{style:i.swatches},gt.createElement("div",{style:i.new}),gt.createElement("div",{style:i.current})),gt.createElement("div",{style:i.label},"current"))},A4e=(function(){function t(e,r){for(var n=0;n<r.length;n++){var i=r[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}})();function I4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P4e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function M4e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var GL=(function(t){M4e(e,t);function e(r){I4e(this,e);var n=P4e(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.state={currentColor:r.hex},n}return A4e(e,[{key:"render",value:function(){var n=this.props,i=n.styles,a=i===void 0?{}:i,s=n.className,o=s===void 0?"":s,c=Ni(Bc({default:{picker:{background:"#DCDCDC",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)",boxSizing:"initial",width:"513px"},head:{backgroundImage:"linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)",borderBottom:"1px solid #B1B1B1",boxShadow:"inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)",height:"23px",lineHeight:"24px",borderRadius:"4px 4px 0 0",fontSize:"13px",color:"#4D4D4D",textAlign:"center"},body:{padding:"15px 15px 0",display:"flex"},saturation:{width:"256px",height:"256px",position:"relative",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0",overflow:"hidden"},hue:{position:"relative",height:"256px",width:"19px",marginLeft:"10px",border:"2px solid #B3B3B3",borderBottom:"2px solid #F0F0F0"},controls:{width:"180px",marginLeft:"10px"},top:{display:"flex"},previews:{width:"60px"},actions:{flex:"1",marginLeft:"20px"}}},a));return gt.createElement("div",{style:c.picker,className:"photoshop-picker "+o},gt.createElement("div",{style:c.head},this.props.header),gt.createElement("div",{style:c.body,className:"flexbox-fix"},gt.createElement("div",{style:c.saturation},gt.createElement(C3,{hsl:this.props.hsl,hsv:this.props.hsv,pointer:E4e,onChange:this.props.onChange})),gt.createElement("div",{style:c.hue},gt.createElement(w_,{direction:"vertical",hsl:this.props.hsl,pointer:T4e,onChange:this.props.onChange})),gt.createElement("div",{style:c.controls},gt.createElement("div",{style:c.top,className:"flexbox-fix"},gt.createElement("div",{style:c.previews},gt.createElement(C4e,{rgb:this.props.rgb,currentColor:this.state.currentColor})),gt.createElement("div",{style:c.actions},gt.createElement(V$,{label:"OK",onClick:this.props.onAccept,active:!0}),gt.createElement(V$,{label:"Cancel",onClick:this.props.onCancel}),gt.createElement(S4e,{onChange:this.props.onChange,rgb:this.props.rgb,hsv:this.props.hsv,hex:this.props.hex}))))))}}]),e})(gt.Component);GL.propTypes={header:kn.string,styles:kn.object};GL.defaultProps={header:"Color Picker",styles:{}};zc(GL);var k4e=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,a=e.hex,s=e.disableAlpha,o=Ni({default:{fields:{display:"flex",paddingTop:"4px"},single:{flex:"1",paddingLeft:"6px"},alpha:{flex:"1",paddingLeft:"6px"},double:{flex:"2"},input:{width:"80%",padding:"4px 10% 3px",border:"none",boxShadow:"inset 0 0 0 1px #ccc",fontSize:"11px"},label:{display:"block",textAlign:"center",fontSize:"11px",color:"#222",paddingTop:"3px",paddingBottom:"4px",textTransform:"capitalize"}},disableAlpha:{alpha:{display:"none"}}},{disableAlpha:s}),c=function(d,m){d.hex?Ug(d.hex)&&r({hex:d.hex,source:"hex"},m):d.r||d.g||d.b?r({r:d.r||n.r,g:d.g||n.g,b:d.b||n.b,a:n.a,source:"rgb"},m):d.a&&(d.a<0?d.a=0:d.a>100&&(d.a=100),d.a/=100,r({h:i.h,s:i.s,l:i.l,a:d.a,source:"rgb"},m))};return gt.createElement("div",{style:o.fields,className:"flexbox-fix"},gt.createElement("div",{style:o.double},gt.createElement(va,{style:{input:o.input,label:o.label},label:"hex",value:a.replace("#",""),onChange:c})),gt.createElement("div",{style:o.single},gt.createElement(va,{style:{input:o.input,label:o.label},label:"r",value:n.r,onChange:c,dragLabel:"true",dragMax:"255"})),gt.createElement("div",{style:o.single},gt.createElement(va,{style:{input:o.input,label:o.label},label:"g",value:n.g,onChange:c,dragLabel:"true",dragMax:"255"})),gt.createElement("div",{style:o.single},gt.createElement(va,{style:{input:o.input,label:o.label},label:"b",value:n.b,onChange:c,dragLabel:"true",dragMax:"255"})),gt.createElement("div",{style:o.alpha},gt.createElement(va,{style:{input:o.input,label:o.label},label:"a",value:Math.round(n.a*100),onChange:c,dragLabel:"true",dragMax:"100"})))},R4e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},TQ=function(e){var r=e.colors,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=Ni({default:{colors:{margin:"0 -10px",padding:"10px 0 0 10px",borderTop:"1px solid #eee",display:"flex",flexWrap:"wrap",position:"relative"},swatchWrap:{width:"16px",height:"16px",margin:"0 10px 10px 0"},swatch:{borderRadius:"3px",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15)"}},"no-presets":{colors:{display:"none"}}},{"no-presets":!r||!r.length}),o=function(f,d){i({hex:f,source:"hex"},d)};return gt.createElement("div",{style:s.colors,className:"flexbox-fix"},r.map(function(c){var f=typeof c=="string"?{color:c}:c,d=""+f.color+(f.title||"");return gt.createElement("div",{key:d,style:s.swatchWrap},gt.createElement(Ay,R4e({},f,{style:s.swatch,onClick:o,onHover:a,focusStyle:{boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px "+f.color}})))}))};TQ.propTypes={colors:kn.arrayOf(kn.oneOfType([kn.string,kn.shape({color:kn.string,title:kn.string})])).isRequired};var D4e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},WL=function(e){var r=e.width,n=e.rgb,i=e.hex,a=e.hsv,s=e.hsl,o=e.onChange,c=e.onSwatchHover,f=e.disableAlpha,d=e.presetColors,m=e.renderers,b=e.styles,x=b===void 0?{}:b,E=e.className,T=E===void 0?"":E,A=Ni(Bc({default:D4e({picker:{width:r,padding:"10px 10px 0",boxSizing:"initial",background:"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)"},saturation:{width:"100%",paddingBottom:"75%",position:"relative",overflow:"hidden"},Saturation:{radius:"3px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},controls:{display:"flex"},sliders:{padding:"4px 0",flex:"1"},color:{width:"24px",height:"24px",position:"relative",marginTop:"4px",marginLeft:"4px",borderRadius:"3px"},activeColor:{absolute:"0px 0px 0px 0px",borderRadius:"2px",background:"rgba("+n.r+","+n.g+","+n.b+","+n.a+")",boxShadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},hue:{position:"relative",height:"10px",overflow:"hidden"},Hue:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"},alpha:{position:"relative",height:"10px",marginTop:"4px",overflow:"hidden"},Alpha:{radius:"2px",shadow:"inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)"}},x),disableAlpha:{color:{height:"10px"},hue:{height:"10px"},alpha:{display:"none"}}},x),{disableAlpha:f});return gt.createElement("div",{style:A.picker,className:"sketch-picker "+T},gt.createElement("div",{style:A.saturation},gt.createElement(C3,{style:A.Saturation,hsl:s,hsv:a,onChange:o})),gt.createElement("div",{style:A.controls,className:"flexbox-fix"},gt.createElement("div",{style:A.sliders},gt.createElement("div",{style:A.hue},gt.createElement(w_,{style:A.Hue,hsl:s,onChange:o})),gt.createElement("div",{style:A.alpha},gt.createElement(IL,{style:A.Alpha,rgb:n,hsl:s,renderers:m,onChange:o}))),gt.createElement("div",{style:A.color},gt.createElement(x_,null),gt.createElement("div",{style:A.activeColor}))),gt.createElement(k4e,{rgb:n,hsl:s,hex:i,onChange:o,disableAlpha:f}),gt.createElement(TQ,{colors:d,onClick:o,onSwatchHover:c}))};WL.propTypes={disableAlpha:kn.bool,width:kn.oneOfType([kn.string,kn.number]),styles:kn.object};WL.defaultProps={disableAlpha:!1,width:200,styles:{},presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"]};zc(WL);var f1=function(e){var r=e.hsl,n=e.offset,i=e.onClick,a=i===void 0?function(){}:i,s=e.active,o=e.first,c=e.last,f=Ni({default:{swatch:{height:"12px",background:"hsl("+r.h+", 50%, "+n*100+"%)",cursor:"pointer"}},first:{swatch:{borderRadius:"2px 0 0 2px"}},last:{swatch:{borderRadius:"0 2px 2px 0"}},active:{swatch:{transform:"scaleY(1.8)",borderRadius:"3.6px/2px"}}},{active:s,first:o,last:c}),d=function(b){return a({h:r.h,s:.5,l:n,source:"hsl"},b)};return gt.createElement("div",{style:f.swatch,onClick:d})},O4e=function(e){var r=e.onClick,n=e.hsl,i=Ni({default:{swatches:{marginTop:"20px"},swatch:{boxSizing:"border-box",width:"20%",paddingRight:"1px",float:"left"},clear:{clear:"both"}}}),a=.1;return gt.createElement("div",{style:i.swatches},gt.createElement("div",{style:i.swatch},gt.createElement(f1,{hsl:n,offset:".80",active:Math.abs(n.l-.8)<a&&Math.abs(n.s-.5)<a,onClick:r,first:!0})),gt.createElement("div",{style:i.swatch},gt.createElement(f1,{hsl:n,offset:".65",active:Math.abs(n.l-.65)<a&&Math.abs(n.s-.5)<a,onClick:r})),gt.createElement("div",{style:i.swatch},gt.createElement(f1,{hsl:n,offset:".50",active:Math.abs(n.l-.5)<a&&Math.abs(n.s-.5)<a,onClick:r})),gt.createElement("div",{style:i.swatch},gt.createElement(f1,{hsl:n,offset:".35",active:Math.abs(n.l-.35)<a&&Math.abs(n.s-.5)<a,onClick:r})),gt.createElement("div",{style:i.swatch},gt.createElement(f1,{hsl:n,offset:".20",active:Math.abs(n.l-.2)<a&&Math.abs(n.s-.5)<a,onClick:r,last:!0})),gt.createElement("div",{style:i.clear}))},L4e=function(){var e=Ni({default:{picker:{width:"14px",height:"14px",borderRadius:"6px",transform:"translate(-7px, -1px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"}}});return gt.createElement("div",{style:e.picker})},XL=function(e){var r=e.hsl,n=e.onChange,i=e.pointer,a=e.styles,s=a===void 0?{}:a,o=e.className,c=o===void 0?"":o,f=Ni(Bc({default:{hue:{height:"12px",position:"relative"},Hue:{radius:"2px"}}},s));return gt.createElement("div",{style:f.wrap||{},className:"slider-picker "+c},gt.createElement("div",{style:f.hue},gt.createElement(w_,{style:f.Hue,hsl:r,pointer:i,onChange:n})),gt.createElement("div",{style:f.swatches},gt.createElement(O4e,{hsl:r,onClick:n})))};XL.propTypes={styles:kn.object};XL.defaultProps={pointer:L4e,styles:{}};zc(XL);var Pw={},$$;function N4e(){if($$)return Pw;$$=1,Object.defineProperty(Pw,"__esModule",{value:!0});var t=Object.assign||function(s){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(s[f]=c[f])}return s},e=vx(),r=n(e);function n(s){return s&&s.__esModule?s:{default:s}}function i(s,o){var c={};for(var f in s)o.indexOf(f)>=0||Object.prototype.hasOwnProperty.call(s,f)&&(c[f]=s[f]);return c}var a=24;return Pw.default=function(s){var o=s.fill,c=o===void 0?"currentColor":o,f=s.width,d=f===void 0?a:f,m=s.height,b=m===void 0?a:m,x=s.style,E=x===void 0?{}:x,T=i(s,["fill","width","height","style"]);return r.default.createElement("svg",t({viewBox:"0 0 "+a+" "+a,style:t({fill:c,width:d,height:b},E)},T),r.default.createElement("path",{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}))},Pw}var F4e=N4e();const B4e=Cd(F4e);var z4e=function(e){var r=e.color,n=e.onClick,i=n===void 0?function(){}:n,a=e.onSwatchHover,s=e.first,o=e.last,c=e.active,f=Ni({default:{color:{width:"40px",height:"24px",cursor:"pointer",background:r,marginBottom:"1px"},check:{color:NL(r),marginLeft:"8px",display:"none"}},first:{color:{overflow:"hidden",borderRadius:"2px 2px 0 0"}},last:{color:{overflow:"hidden",borderRadius:"0 0 2px 2px"}},active:{check:{display:"block"}},"color-#FFFFFF":{color:{boxShadow:"inset 0 0 0 1px #ddd"},check:{color:"#333"}},transparent:{check:{color:"#333"}}},{first:s,last:o,active:c,"color-#FFFFFF":r==="#FFFFFF",transparent:r==="transparent"});return gt.createElement(Ay,{color:r,style:f.color,onClick:i,onHover:a,focusStyle:{boxShadow:"0 0 4px "+r}},gt.createElement("div",{style:f.check},gt.createElement(B4e,null)))},j4e=function(e){var r=e.onClick,n=e.onSwatchHover,i=e.group,a=e.active,s=Ni({default:{group:{paddingBottom:"10px",width:"40px",float:"left",marginRight:"10px"}}});return gt.createElement("div",{style:s.group},Iy(i,function(o,c){return gt.createElement(z4e,{key:o,color:o,active:o.toLowerCase()===a,first:c===0,last:c===i.length-1,onClick:r,onSwatchHover:n})}))},YL=function(e){var r=e.width,n=e.height,i=e.onChange,a=e.onSwatchHover,s=e.colors,o=e.hex,c=e.styles,f=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=Ni(Bc({default:{picker:{width:r,height:n},overflow:{height:n,overflowY:"scroll"},body:{padding:"16px 0 6px 16px"},clear:{clear:"both"}}},f)),x=function(T,A){return i({hex:T,source:"hex"},A)};return gt.createElement("div",{style:b.picker,className:"swatches-picker "+m},gt.createElement(Hx,null,gt.createElement("div",{style:b.overflow},gt.createElement("div",{style:b.body},Iy(s,function(E){return gt.createElement(j4e,{key:E.toString(),group:E,active:o,onClick:x,onSwatchHover:a})}),gt.createElement("div",{style:b.clear})))))};YL.propTypes={width:kn.oneOfType([kn.string,kn.number]),height:kn.oneOfType([kn.string,kn.number]),colors:kn.arrayOf(kn.arrayOf(kn.string)),styles:kn.object};YL.defaultProps={width:320,height:240,colors:[[Fv[900],Fv[700],Fv[500],Fv[300],Fv[100]],[Bv[900],Bv[700],Bv[500],Bv[300],Bv[100]],[zv[900],zv[700],zv[500],zv[300],zv[100]],[jv[900],jv[700],jv[500],jv[300],jv[100]],[Uv[900],Uv[700],Uv[500],Uv[300],Uv[100]],[Vv[900],Vv[700],Vv[500],Vv[300],Vv[100]],[$v[900],$v[700],$v[500],$v[300],$v[100]],[qv[900],qv[700],qv[500],qv[300],qv[100]],[Hv[900],Hv[700],Hv[500],Hv[300],Hv[100]],["#194D33",H1[700],H1[500],H1[300],H1[100]],[Gv[900],Gv[700],Gv[500],Gv[300],Gv[100]],[Wv[900],Wv[700],Wv[500],Wv[300],Wv[100]],[Xv[900],Xv[700],Xv[500],Xv[300],Xv[100]],[Yv[900],Yv[700],Yv[500],Yv[300],Yv[100]],[Zv[900],Zv[700],Zv[500],Zv[300],Zv[100]],[Kv[900],Kv[700],Kv[500],Kv[300],Kv[100]],[Jv[900],Jv[700],Jv[500],Jv[300],Jv[100]],[Qv[900],Qv[700],Qv[500],Qv[300],Qv[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]],styles:{}};zc(YL);var ZL=function(e){var r=e.onChange,n=e.onSwatchHover,i=e.hex,a=e.colors,s=e.width,o=e.triangle,c=e.styles,f=c===void 0?{}:c,d=e.className,m=d===void 0?"":d,b=Ni(Bc({default:{card:{width:s,background:"#fff",border:"0 solid rgba(0,0,0,0.25)",boxShadow:"0 1px 4px rgba(0,0,0,0.25)",borderRadius:"4px",position:"relative"},body:{padding:"15px 9px 9px 15px"},label:{fontSize:"18px",color:"#fff"},triangle:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent #fff transparent",position:"absolute"},triangleShadow:{width:"0px",height:"0px",borderStyle:"solid",borderWidth:"0 9px 10px 9px",borderColor:"transparent transparent rgba(0,0,0,.1) transparent",position:"absolute"},hash:{background:"#F0F0F0",height:"30px",width:"30px",borderRadius:"4px 0 0 4px",float:"left",color:"#98A1A4",display:"flex",alignItems:"center",justifyContent:"center"},input:{width:"100px",fontSize:"14px",color:"#666",border:"0px",outline:"none",height:"28px",boxShadow:"inset 0 0 0 1px #F0F0F0",boxSizing:"content-box",borderRadius:"0 4px 4px 0",float:"left",paddingLeft:"8px"},swatch:{width:"30px",height:"30px",float:"left",borderRadius:"4px",margin:"0 6px 6px 0"},clear:{clear:"both"}},"hide-triangle":{triangle:{display:"none"},triangleShadow:{display:"none"}},"top-left-triangle":{triangle:{top:"-10px",left:"12px"},triangleShadow:{top:"-11px",left:"12px"}},"top-right-triangle":{triangle:{top:"-10px",right:"12px"},triangleShadow:{top:"-11px",right:"12px"}}},f),{"hide-triangle":o==="hide","top-left-triangle":o==="top-left","top-right-triangle":o==="top-right"}),x=function(T,A){Ug(T)&&r({hex:T,source:"hex"},A)};return gt.createElement("div",{style:b.card,className:"twitter-picker "+m},gt.createElement("div",{style:b.triangleShadow}),gt.createElement("div",{style:b.triangle}),gt.createElement("div",{style:b.body},Iy(a,function(E,T){return gt.createElement(Ay,{key:T,color:E,hex:E,style:b.swatch,onClick:x,onHover:n,focusStyle:{boxShadow:"0 0 4px "+E}})}),gt.createElement("div",{style:b.hash},"#"),gt.createElement(va,{label:null,style:{input:b.input},value:i.replace("#",""),onChange:x}),gt.createElement("div",{style:b.clear})))};ZL.propTypes={width:kn.oneOfType([kn.string,kn.number]),triangle:kn.oneOf(["hide","top-left","top-right"]),colors:kn.arrayOf(kn.string),styles:kn.object};ZL.defaultProps={width:276,colors:["#FF6900","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#EB144C","#F78DA7","#9900EF"],triangle:"top-left",styles:{}};zc(ZL);var KL=function(e){var r=Ni({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",border:"2px #fff solid",transform:"translate(-12px, -13px)",background:"hsl("+Math.round(e.hsl.h)+", "+Math.round(e.hsl.s*100)+"%, "+Math.round(e.hsl.l*100)+"%)"}}});return gt.createElement("div",{style:r.picker})};KL.propTypes={hsl:kn.shape({h:kn.number,s:kn.number,l:kn.number,a:kn.number})};KL.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var JL=function(e){var r=Ni({default:{picker:{width:"20px",height:"20px",borderRadius:"22px",transform:"translate(-10px, -7px)",background:"hsl("+Math.round(e.hsl.h)+", 100%, 50%)",border:"2px white solid"}}});return gt.createElement("div",{style:r.picker})};JL.propTypes={hsl:kn.shape({h:kn.number,s:kn.number,l:kn.number,a:kn.number})};JL.defaultProps={hsl:{a:1,h:249.94,l:.2,s:.5}};var U4e=function(e){var r=e.onChange,n=e.rgb,i=e.hsl,a=e.hex,s=e.hsv,o=function(x,E){if(x.hex)Ug(x.hex)&&r({hex:x.hex,source:"hex"},E);else if(x.rgb){var T=x.rgb.split(",");sP(x.rgb,"rgb")&&r({r:T[0],g:T[1],b:T[2],a:1,source:"rgb"},E)}else if(x.hsv){var A=x.hsv.split(",");sP(x.hsv,"hsv")&&(A[2]=A[2].replace("%",""),A[1]=A[1].replace("%",""),A[0]=A[0].replace("",""),A[1]==1?A[1]=.01:A[2]==1&&(A[2]=.01),r({h:Number(A[0]),s:Number(A[1]),v:Number(A[2]),source:"hsv"},E))}else if(x.hsl){var R=x.hsl.split(",");sP(x.hsl,"hsl")&&(R[2]=R[2].replace("%",""),R[1]=R[1].replace("%",""),R[0]=R[0].replace("",""),m[1]==1?m[1]=.01:m[2]==1&&(m[2]=.01),r({h:Number(R[0]),s:Number(R[1]),v:Number(R[2]),source:"hsl"},E))}},c=Ni({default:{wrap:{display:"flex",height:"100px",marginTop:"4px"},fields:{width:"100%"},column:{paddingTop:"10px",display:"flex",justifyContent:"space-between"},double:{padding:"0px 4.4px",boxSizing:"border-box"},input:{width:"100%",height:"38px",boxSizing:"border-box",padding:"4px 10% 3px",textAlign:"center",border:"1px solid #dadce0",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",fontFamily:"Roboto,Arial,sans-serif"},input2:{height:"38px",width:"100%",border:"1px solid #dadce0",boxSizing:"border-box",fontSize:"11px",textTransform:"lowercase",borderRadius:"5px",outline:"none",paddingLeft:"10px",fontFamily:"Roboto,Arial,sans-serif"},label:{textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"35px",top:"-6px",left:"0",right:"0",marginLeft:"auto",marginRight:"auto",fontFamily:"Roboto,Arial,sans-serif"},label2:{left:"10px",textAlign:"center",fontSize:"12px",background:"#fff",position:"absolute",textTransform:"uppercase",color:"#3c4043",width:"32px",top:"-6px",fontFamily:"Roboto,Arial,sans-serif"},single:{flexGrow:"1",margin:"0px 4.4px"}}}),f=n.r+", "+n.g+", "+n.b,d=Math.round(i.h)+", "+Math.round(i.s*100)+"%, "+Math.round(i.l*100)+"%",m=Math.round(s.h)+", "+Math.round(s.s*100)+"%, "+Math.round(s.v*100)+"%";return gt.createElement("div",{style:c.wrap,className:"flexbox-fix"},gt.createElement("div",{style:c.fields},gt.createElement("div",{style:c.double},gt.createElement(va,{style:{input:c.input,label:c.label},label:"hex",value:a,onChange:o})),gt.createElement("div",{style:c.column},gt.createElement("div",{style:c.single},gt.createElement(va,{style:{input:c.input2,label:c.label2},label:"rgb",value:f,onChange:o})),gt.createElement("div",{style:c.single},gt.createElement(va,{style:{input:c.input2,label:c.label2},label:"hsv",value:m,onChange:o})),gt.createElement("div",{style:c.single},gt.createElement(va,{style:{input:c.input2,label:c.label2},label:"hsl",value:d,onChange:o})))))},QL=function(e){var r=e.width,n=e.onChange,i=e.rgb,a=e.hsl,s=e.hsv,o=e.hex,c=e.header,f=e.styles,d=f===void 0?{}:f,m=e.className,b=m===void 0?"":m,x=Ni(Bc({default:{picker:{width:r,background:"#fff",border:"1px solid #dfe1e5",boxSizing:"initial",display:"flex",flexWrap:"wrap",borderRadius:"8px 8px 0px 0px"},head:{height:"57px",width:"100%",paddingTop:"16px",paddingBottom:"16px",paddingLeft:"16px",fontSize:"20px",boxSizing:"border-box",fontFamily:"Roboto-Regular,HelveticaNeue,Arial,sans-serif"},saturation:{width:"70%",padding:"0px",position:"relative",overflow:"hidden"},swatch:{width:"30%",height:"228px",padding:"0px",background:"rgba("+i.r+", "+i.g+", "+i.b+", 1)",position:"relative",overflow:"hidden"},body:{margin:"auto",width:"95%"},controls:{display:"flex",boxSizing:"border-box",height:"52px",paddingTop:"22px"},color:{width:"32px"},hue:{height:"8px",position:"relative",margin:"0px 16px 0px 16px",width:"100%"},Hue:{radius:"2px"}}},d));return gt.createElement("div",{style:x.picker,className:"google-picker "+b},gt.createElement("div",{style:x.head},c),gt.createElement("div",{style:x.swatch}),gt.createElement("div",{style:x.saturation},gt.createElement(C3,{hsl:a,hsv:s,pointer:KL,onChange:n})),gt.createElement("div",{style:x.body},gt.createElement("div",{style:x.controls,className:"flexbox-fix"},gt.createElement("div",{style:x.hue},gt.createElement(w_,{style:x.Hue,hsl:a,radius:"4px",pointer:JL,onChange:n}))),gt.createElement(U4e,{rgb:i,hsl:a,hex:o,hsv:s,onChange:n})))};QL.propTypes={width:kn.oneOfType([kn.string,kn.number]),styles:kn.object,header:kn.string};QL.defaultProps={width:652,styles:{},header:"Color picker"};zc(QL);const G1={rgba:t=>`rgba(${t.rgb.r}, ${t.rgb.g}, ${t.rgb.b}, ${t.rgb.a})`,rgb:t=>`rgb(${t.rgb.r}, ${t.rgb.g}, ${t.rgb.b})`,hex:t=>t.hex,rgba_rgb:t=>t.rgb.a===1?G1.rgb(t):G1.rgba(t),rgba_hex:t=>t.rgb.a===1?G1.hex(t):G1.rgba(t)},Jb=({convert:t,...e})=>{const[r,n]=te.useState(!1),i=e?.value||"";return J.jsxs(J.Fragment,{children:[J.jsx(up,{container:!0,sx:{flexWrap:"nowrap"},children:J.jsx(up,{size:12,children:J.jsxs(ta,{variant:"outlined",onClick:()=>n(!0),sx:{minWidth:"100%",padding:"5px",marginBottom:"10px",justifyContent:"flex-start",borderColor:a=>a.palette.text.primary,color:a=>a.palette.text.primary},children:[J.jsx("div",{style:{width:"25px",height:"25px",marginRight:"10px",backgroundColor:i}}),i]})})}),r&&J.jsx("div",{style:{position:"relative",marginTop:0},children:J.jsxs("div",{style:{position:"absolute",zIndex:1e3},children:[J.jsx("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:()=>{n(!1)}}),J.jsx(g4e,{color:i,onChange:a=>{const s=G1[t](a);e?.onChange?.(s)}})]})})]})};Jb.defaultProps={convert:"rgba_hex",label:"Color",name:"color"};try{Jb.displayName="ColorPicker",Jb.__docgenInfo={description:"",displayName:"ColorPicker",props:{onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((value: string) => void) | undefined"}},convert:{defaultValue:{value:"rgba_hex"},description:"",name:"convert",required:!1,type:{name:"enum",value:[{value:'"rgb"'},{value:'"rgba"'},{value:'"rgba_hex"'},{value:'"hex"'},{value:'"rgba_rgb"'}]}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string | undefined"}}}}}catch{}function Zk({propKey:t,value:e,setPaintProps:r}){return J.jsx(Jb,{value:e,label:"Color",onChange:n=>{r(i=>({...i,[t]:n}))}})}try{Zk.displayName="PaintPropsColorPicker",Zk.__docgenInfo={description:"",displayName:"PaintPropsColorPicker",props:{key:{defaultValue:null,description:"",name:"key",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},propKey:{defaultValue:null,description:"",name:"propKey",required:!0,type:{name:"string"}},setPaintProps:{defaultValue:null,description:"",name:"setPaintProps",required:!0,type:{name:"(paintProps: paintPropsType | ((current: paintPropsType) => paintPropsType)) => void"}}}}}catch{}const V4e=Dr(Uf)({marginLeft:"-100px",marginRight:"-21px",paddingLeft:"53px",borderRadius:"0px",boxShadow:"none",backgroundColor:"rgb(0, 0, 0, 0)"}),$4e=Dr(Jo)({marginLeft:"61px"}),CQ={"circle-color":"colorpicker","circle-radius":"slider","circle-stroke-color":"colorpicker","circle-stroke-width":"slider","fill-color":"colorpicker","fill-outline-color":"colorpicker","line-color":"colorpicker","line-width":"slider","line-blur":"slider"},q4e=Object.keys(CQ),H4e={"circle-stroke-width":{step:1,min:1,max:20},"circle-radius":{step:1,min:1,max:100},"line-blur":{step:1,min:1,max:100},"line-width":{step:1,min:1,max:100}};function SE({paintProps:t={},setPaintProps:e}){const r=te.useRef(Math.round(Math.random()*1e10)),n=te.useCallback(i=>{if(q4e.indexOf(i)!==-1&&(typeof t[i]=="number"||typeof t[i]=="string")){const a=J.jsx(Es,{id:i+"_label",gutterBottom:!0,children:i});switch(CQ[i]){case"slider":return J.jsxs(gt.Fragment,{children:[a,J.jsx(pO,{...H4e[i],value:t[i],valueLabelDisplay:"auto",onChange:(s,o)=>{o&&e(c=>({...c,[i]:o}))}})]},i);case"numberfield":return J.jsxs(gt.Fragment,{children:[a,J.jsx(JT,{inputProps:{inputMode:"decimal",pattern:"[0-9]*"},value:t[i],onChange:s=>{s?.target?.value&&e(o=>({...o,[i]:parseInt(s.target.value)}))}})]},i);case"colorpicker":return J.jsxs(gt.Fragment,{children:[a,J.jsx(Jo,{sx:{"& > div":{width:"initial !important"}},children:J.jsx(Zk,{value:t[i],propKey:i,setPaintProps:e},i)})]},i)}}return null},[t]);return J.jsx(J.Fragment,{children:J.jsx(V4e,{children:J.jsx(qf,{children:J.jsx($4e,{children:Object.keys(t).map(i=>n(i))})},r+"_paintPropForm")})})}try{SE.displayName="LayerPropertyForm",SE.__docgenInfo={description:"",displayName:"LayerPropertyForm",props:{paintProps:{defaultValue:{value:"{}"},description:"",name:"paintProps",required:!1,type:{name:"paintPropsType"}},setPaintProps:{defaultValue:null,description:"",name:"setPaintProps",required:!0,type:{name:"(paintProps: paintPropsType | ((current: paintPropsType) => paintPropsType)) => void"}},layerType:{defaultValue:null,description:"",name:"layerType",required:!0,type:{name:"string"}}}}}catch{}const EE=Dr(qf)(t=>({paddingRight:t?"56px":0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"})),G4e=Dr(uf)({padding:"4px",marginTop:"-3px"}),ap=Dr(Fb)({minWidth:"30px"}),op=Dr(z0)({padding:0});function TE({configurable:t,vtProps:e,setVtProps:r,id:n,...i}){const[a,s]=te.useState(!1),[o,c]=te.useState(!0),[f,d]=te.useState(e.layers[n].paint);return te.useEffect(()=>{if(!r||typeof e.layers[n]?.layout?.visibility>"u"&&o||!o&&e.layers[n]?.layout?.visibility==="none"||o&&e.layers[n]?.layout?.visibility==="visible")return;const m=[...e.layers];m[n].layout?m[n].layout.visibility=o?"visible":"none":m[n].layout={visibility:o?"visible":"none"},r({...e,layers:m})},[o,n,r,e]),te.useEffect(()=>{c(!!i.visibleMaster)},[i.visibleMaster]),te.useEffect(()=>{if(r&&JSON.stringify(f)!==JSON.stringify(e.layers[n].paint)){const m={...f},b=[...e.layers];b[n].paint=m,r({...e,layers:b})}},[f,n,r,e]),J.jsxs(J.Fragment,{children:[J.jsxs(EE,{secondaryAction:t?J.jsx(G4e,{edge:"end","aria-label":"comments",onClick:()=>{s(m=>!m)},children:J.jsx(cL,{})}):void 0,children:[J.jsx(ap,{children:J.jsx(op,{checked:o,onClick:()=>{c(m=>!m)}})}),J.jsx(Df,{primary:e.layers[n].id,variant:"layerlist"})]},n),t&&a&&J.jsx(SE,{paintProps:f,setPaintProps:d,layerType:e.layers[n].type})]})}TE.defaultProps={configurable:!0};try{EE.displayName="ListItemStyled",EE.__docgenInfo={description:"",displayName:"ListItemStyled",props:{}}}catch{}try{ap.displayName="CheckboxListItemIcon",ap.__docgenInfo={description:"",displayName:"CheckboxListItemIcon",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<unknown> | undefined"}}}}}catch{}try{op.displayName="CheckboxStyled",op.__docgenInfo={description:"",displayName:"CheckboxStyled",props:{component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements> | undefined"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<CheckboxSlots> | undefined"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:"{ root?: SlotProps<ElementType<SwitchBaseProps, keyof IntrinsicElements>, CheckboxRootSlotPropsOverrides, CheckboxOwnerState> | undefined; input?: SlotProps<...> | undefined; } | undefined"}}}}}catch{}try{TE.displayName="LayerListItemVectorLayer",TE.__docgenInfo={description:"",displayName:"LayerListItemVectorLayer",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},configurable:{defaultValue:{value:"true"},description:"",name:"configurable",required:!1,type:{name:"boolean | undefined"}},vtProps:{defaultValue:null,description:"",name:"vtProps",required:!0,type:{name:"MlVectorTileLayerProps"}},setVtProps:{defaultValue:null,description:"",name:"setVtProps",required:!0,type:{name:"((state: unknown) => void) | undefined"}},visibleMaster:{defaultValue:null,description:"",name:"visibleMaster",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function Z0(t){return J.jsx(J.Fragment,{children:J.jsxs(sO,{open:t.open,onClose:t.onCancel,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[J.jsx(yy,{id:"alert-dialog-title",children:t.title}),J.jsx(lO,{children:J.jsx(zpe,{id:"alert-dialog-description",children:t.text})}),J.jsxs(Mx,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{onClick:t.onConfirm,autoFocus:!0,children:"Confirm"})]})]})})}Z0.defaultProps={title:"Confirm",text:"Are you sure?"};try{Z0.displayName="ConfirmDialog",Z0.__docgenInfo={description:"",displayName:"ConfirmDialog",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},title:{defaultValue:{value:"Confirm"},description:"",name:"title",required:!1,type:{name:"string"}},text:{defaultValue:{value:"Are you sure?"},description:"",name:"text",required:!1,type:{name:"string"}},onConfirm:{defaultValue:null,description:"",name:"onConfirm",required:!0,type:{name:"() => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}function W4e(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return te.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const P3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function E_(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function eN(t){return"nodeType"in t}function jc(t){var e,r;return t?E_(t)?t:eN(t)&&(e=(r=t.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function tN(t){const{Document:e}=jc(t);return t instanceof e}function Gx(t){return E_(t)?!1:t instanceof jc(t).HTMLElement}function AQ(t){return t instanceof jc(t).SVGElement}function T_(t){return t?E_(t)?t.document:eN(t)?tN(t)?t:Gx(t)||AQ(t)?t.ownerDocument:document:document:document}const Ed=P3?te.useLayoutEffect:te.useEffect;function rN(t){const e=te.useRef(t);return Ed(()=>{e.current=t}),te.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function X4e(){const t=te.useRef(null),e=te.useCallback((n,i)=>{t.current=setInterval(n,i)},[]),r=te.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,r]}function Qb(t,e){e===void 0&&(e=[t]);const r=te.useRef(t);return Ed(()=>{r.current!==t&&(r.current=t)},e),r}function Wx(t,e){const r=te.useRef();return te.useMemo(()=>{const n=t(r.current);return r.current=n,n},[...e])}function CE(t){const e=rN(t),r=te.useRef(null),n=te.useCallback(i=>{i!==r.current&&e?.(i,r.current),r.current=i},[]);return[r,n]}function Kk(t){const e=te.useRef();return te.useEffect(()=>{e.current=t},[t]),e.current}let uP={};function Xx(t,e){return te.useMemo(()=>{if(e)return e;const r=uP[t]==null?0:uP[t]+1;return uP[t]=r,t+"-"+r},[t,e])}function IQ(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((a,s)=>{const o=Object.entries(s);for(const[c,f]of o){const d=a[c];d!=null&&(a[c]=d+t*f)}return a},{...e})}}const A0=IQ(1),AE=IQ(-1);function Y4e(t){return"clientX"in t&&"clientY"in t}function nN(t){if(!t)return!1;const{KeyboardEvent:e}=jc(t.target);return e&&t instanceof e}function Z4e(t){if(!t)return!1;const{TouchEvent:e}=jc(t.target);return e&&t instanceof e}function Jk(t){if(Z4e(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:r}=t.touches[0];return{x:e,y:r}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:r}=t.changedTouches[0];return{x:e,y:r}}}return Y4e(t)?{x:t.clientX,y:t.clientY}:null}const ex=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:r}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:r}=t;return"scaleX("+e+") scaleY("+r+")"}},Transform:{toString(t){if(t)return[ex.Translate.toString(t),ex.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:r,easing:n}=t;return e+" "+r+"ms "+n}}}),q$="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function K4e(t){return t.matches(q$)?t:t.querySelector(q$)}const J4e={display:"none"};function Q4e(t){let{id:e,value:r}=t;return gt.createElement("div",{id:e,style:J4e},r)}function ePe(t){let{id:e,announcement:r,ariaLiveType:n="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return gt.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function tPe(){const[t,e]=te.useState("");return{announce:te.useCallback(n=>{n!=null&&e(n)},[]),announcement:t}}const PQ=te.createContext(null);function rPe(t){const e=te.useContext(PQ);te.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function nPe(){const[t]=te.useState(()=>new Set),e=te.useCallback(n=>(t.add(n),()=>t.delete(n)),[t]);return[te.useCallback(n=>{let{type:i,event:a}=n;t.forEach(s=>{var o;return(o=s[i])==null?void 0:o.call(s,a)})},[t]),e]}const iPe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},aPe={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function oPe(t){let{announcements:e=aPe,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=iPe}=t;const{announce:a,announcement:s}=tPe(),o=Xx("DndLiveRegion"),[c,f]=te.useState(!1);if(te.useEffect(()=>{f(!0)},[]),rPe(te.useMemo(()=>({onDragStart(m){let{active:b}=m;a(e.onDragStart({active:b}))},onDragMove(m){let{active:b,over:x}=m;e.onDragMove&&a(e.onDragMove({active:b,over:x}))},onDragOver(m){let{active:b,over:x}=m;a(e.onDragOver({active:b,over:x}))},onDragEnd(m){let{active:b,over:x}=m;a(e.onDragEnd({active:b,over:x}))},onDragCancel(m){let{active:b,over:x}=m;a(e.onDragCancel({active:b,over:x}))}}),[a,e])),!c)return null;const d=gt.createElement(gt.Fragment,null,gt.createElement(Q4e,{id:n,value:i.draggable}),gt.createElement(ePe,{id:o,announcement:s}));return r?lp.createPortal(d,r):d}var Nl;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Nl||(Nl={}));function IE(){}function H$(t,e){return te.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function sPe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return te.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const Ih=Object.freeze({x:0,y:0});function lPe(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function uPe(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return r-n}function cPe(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return n-r}function fPe(t,e){if(!t||t.length===0)return null;const[r]=t;return r[e]}function G$(t,e,r){return e===void 0&&(e=t.left),r===void 0&&(r=t.top),{x:e+t.width*.5,y:r+t.height*.5}}const hPe=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=G$(e,e.left,e.top),a=[];for(const s of n){const{id:o}=s,c=r.get(o);if(c){const f=lPe(G$(c),i);a.push({id:o,data:{droppableContainer:s,value:f}})}}return a.sort(uPe)};function dPe(t,e){const r=Math.max(e.top,t.top),n=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),s=i-n,o=a-r;if(n<i&&r<a){const c=e.width*e.height,f=t.width*t.height,d=s*o,m=d/(c+f-d);return Number(m.toFixed(4))}return 0}const pPe=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const i=[];for(const a of n){const{id:s}=a,o=r.get(s);if(o){const c=dPe(o,e);c>0&&i.push({id:s,data:{droppableContainer:a,value:c}})}}return i.sort(cPe)};function gPe(t,e,r){return{...t,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function MQ(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:Ih}function mPe(t){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return i.reduce((s,o)=>({...s,top:s.top+t*o.y,bottom:s.bottom+t*o.y,left:s.left+t*o.x,right:s.right+t*o.x}),{...r})}}const yPe=mPe(1);function vPe(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function _Pe(t,e,r){const n=vPe(e);if(!n)return t;const{scaleX:i,scaleY:a,x:s,y:o}=n,c=t.left-s-(1-i)*parseFloat(r),f=t.top-o-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),d=i?t.width/i:t.width,m=a?t.height/a:t.height;return{width:d,height:m,top:f,right:c+d,bottom:f+m,left:c}}const bPe={ignoreTransform:!1};function C_(t,e){e===void 0&&(e=bPe);let r=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:f,transformOrigin:d}=jc(t).getComputedStyle(t);f&&(r=_Pe(r,f,d))}const{top:n,left:i,width:a,height:s,bottom:o,right:c}=r;return{top:n,left:i,width:a,height:s,bottom:o,right:c}}function W$(t){return C_(t,{ignoreTransform:!0})}function xPe(t){const e=t.innerWidth,r=t.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function wPe(t,e){return e===void 0&&(e=jc(t).getComputedStyle(t)),e.position==="fixed"}function SPe(t,e){e===void 0&&(e=jc(t).getComputedStyle(t));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const a=e[i];return typeof a=="string"?r.test(a):!1})}function iN(t,e){const r=[];function n(i){if(e!=null&&r.length>=e||!i)return r;if(tN(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!Gx(i)||AQ(i)||r.includes(i))return r;const a=jc(t).getComputedStyle(i);return i!==t&&SPe(i,a)&&r.push(i),wPe(i,a)?r:n(i.parentNode)}return t?n(t):r}function kQ(t){const[e]=iN(t,1);return e??null}function cP(t){return!P3||!t?null:E_(t)?t:eN(t)?tN(t)||t===T_(t).scrollingElement?window:Gx(t)?t:null:null}function RQ(t){return E_(t)?t.scrollX:t.scrollLeft}function DQ(t){return E_(t)?t.scrollY:t.scrollTop}function Qk(t){return{x:RQ(t),y:DQ(t)}}var iu;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(iu||(iu={}));function OQ(t){return!P3||!t?!1:t===document.scrollingElement}function LQ(t){const e={x:0,y:0},r=OQ(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},n={x:t.scrollWidth-r.width,y:t.scrollHeight-r.height},i=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,s=t.scrollTop>=n.y,o=t.scrollLeft>=n.x;return{isTop:i,isLeft:a,isBottom:s,isRight:o,maxScroll:n,minScroll:e}}const EPe={x:.2,y:.2};function TPe(t,e,r,n,i){let{top:a,left:s,right:o,bottom:c}=r;n===void 0&&(n=10),i===void 0&&(i=EPe);const{isTop:f,isBottom:d,isLeft:m,isRight:b}=LQ(t),x={x:0,y:0},E={x:0,y:0},T={height:e.height*i.y,width:e.width*i.x};return!f&&a<=e.top+T.height?(x.y=iu.Backward,E.y=n*Math.abs((e.top+T.height-a)/T.height)):!d&&c>=e.bottom-T.height&&(x.y=iu.Forward,E.y=n*Math.abs((e.bottom-T.height-c)/T.height)),!b&&o>=e.right-T.width?(x.x=iu.Forward,E.x=n*Math.abs((e.right-T.width-o)/T.width)):!m&&s<=e.left+T.width&&(x.x=iu.Backward,E.x=n*Math.abs((e.left+T.width-s)/T.width)),{direction:x,speed:E}}function CPe(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:s}=window;return{top:0,left:0,right:a,bottom:s,width:a,height:s}}const{top:e,left:r,right:n,bottom:i}=t.getBoundingClientRect();return{top:e,left:r,right:n,bottom:i,width:t.clientWidth,height:t.clientHeight}}function NQ(t){return t.reduce((e,r)=>A0(e,Qk(r)),Ih)}function APe(t){return t.reduce((e,r)=>e+RQ(r),0)}function IPe(t){return t.reduce((e,r)=>e+DQ(r),0)}function PPe(t,e){if(e===void 0&&(e=C_),!t)return;const{top:r,left:n,bottom:i,right:a}=e(t);kQ(t)&&(i<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const MPe=[["x",["left","right"],APe],["y",["top","bottom"],IPe]];class aN{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=iN(r),i=NQ(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,s,o]of MPe)for(const c of s)Object.defineProperty(this,c,{get:()=>{const f=o(n),d=i[a]-f;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class yb{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=e}add(e,r,n){var i;(i=this.target)==null||i.addEventListener(e,r,n),this.listeners.push([e,r,n])}}function kPe(t){const{EventTarget:e}=jc(t);return t instanceof e?t:T_(t)}function fP(t,e){const r=Math.abs(t.x),n=Math.abs(t.y);return typeof e=="number"?Math.sqrt(r**2+n**2)>e:"x"in e&&"y"in e?r>e.x&&n>e.y:"x"in e?r>e.x:"y"in e?n>e.y:!1}var kf;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(kf||(kf={}));function X$(t){t.preventDefault()}function RPe(t){t.stopPropagation()}var Wa;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Wa||(Wa={}));const FQ={start:[Wa.Space,Wa.Enter],cancel:[Wa.Esc],end:[Wa.Space,Wa.Enter,Wa.Tab]},DPe=(t,e)=>{let{currentCoordinates:r}=e;switch(t.code){case Wa.Right:return{...r,x:r.x+25};case Wa.Left:return{...r,x:r.x-25};case Wa.Down:return{...r,y:r.y+25};case Wa.Up:return{...r,y:r.y-25}}};class BQ{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new yb(T_(r)),this.windowListeners=new yb(jc(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(kf.Resize,this.handleCancel),this.windowListeners.add(kf.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(kf.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,n=e.node.current;n&&PPe(n),r(Ih)}handleKeyDown(e){if(nN(e)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:a=FQ,coordinateGetter:s=DPe,scrollBehavior:o="smooth"}=i,{code:c}=e;if(a.end.includes(c)){this.handleEnd(e);return}if(a.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:f}=n.current,d=f?{x:f.left,y:f.top}:Ih;this.referenceCoordinates||(this.referenceCoordinates=d);const m=s(e,{active:r,context:n.current,currentCoordinates:d});if(m){const b=AE(m,d),x={x:0,y:0},{scrollableAncestors:E}=n.current;for(const T of E){const A=e.code,{isTop:R,isRight:F,isLeft:N,isBottom:O,maxScroll:U,minScroll:j}=LQ(T),H=CPe(T),W={x:Math.min(A===Wa.Right?H.right-H.width/2:H.right,Math.max(A===Wa.Right?H.left:H.left+H.width/2,m.x)),y:Math.min(A===Wa.Down?H.bottom-H.height/2:H.bottom,Math.max(A===Wa.Down?H.top:H.top+H.height/2,m.y))},X=A===Wa.Right&&!F||A===Wa.Left&&!N,oe=A===Wa.Down&&!O||A===Wa.Up&&!R;if(X&&W.x!==m.x){const ee=T.scrollLeft+b.x,G=A===Wa.Right&&ee<=U.x||A===Wa.Left&&ee>=j.x;if(G&&!b.y){T.scrollTo({left:ee,behavior:o});return}G?x.x=T.scrollLeft-ee:x.x=A===Wa.Right?T.scrollLeft-U.x:T.scrollLeft-j.x,x.x&&T.scrollBy({left:-x.x,behavior:o});break}else if(oe&&W.y!==m.y){const ee=T.scrollTop+b.y,G=A===Wa.Down&&ee<=U.y||A===Wa.Up&&ee>=j.y;if(G&&!b.x){T.scrollTo({top:ee,behavior:o});return}G?x.y=T.scrollTop-ee:x.y=A===Wa.Down?T.scrollTop-U.y:T.scrollTop-j.y,x.y&&T.scrollBy({top:-x.y,behavior:o});break}}this.handleMove(e,A0(AE(m,this.referenceCoordinates),x))}}}handleMove(e,r){const{onMove:n}=this.props;e.preventDefault(),n(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}BQ.activators=[{eventName:"onKeyDown",handler:(t,e,r)=>{let{keyboardCodes:n=FQ,onActivation:i}=e,{active:a}=r;const{code:s}=t.nativeEvent;if(n.start.includes(s)){const o=a.activatorNode.current;return o&&t.target!==o?!1:(t.preventDefault(),i?.({event:t.nativeEvent}),!0)}return!1}}];function Y$(t){return!!(t&&"distance"in t)}function Z$(t){return!!(t&&"delay"in t)}class oN{constructor(e,r,n){var i;n===void 0&&(n=kPe(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:a}=e,{target:s}=a;this.props=e,this.events=r,this.document=T_(s),this.documentListeners=new yb(this.document),this.listeners=new yb(n),this.windowListeners=new yb(jc(s)),this.initialCoordinates=(i=Jk(a))!=null?i:Ih,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(kf.Resize,this.handleCancel),this.windowListeners.add(kf.DragStart,X$),this.windowListeners.add(kf.VisibilityChange,this.handleCancel),this.windowListeners.add(kf.ContextMenu,X$),this.documentListeners.add(kf.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Z$(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(Y$(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(kf.Click,RPe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(kf.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:n,initialCoordinates:i,props:a}=this,{onMove:s,options:{activationConstraint:o}}=a;if(!i)return;const c=(r=Jk(e))!=null?r:Ih,f=AE(i,c);if(!n&&o){if(Y$(o)){if(o.tolerance!=null&&fP(f,o.tolerance))return this.handleCancel();if(fP(f,o.distance))return this.handleStart()}if(Z$(o)&&fP(f,o.tolerance))return this.handleCancel();this.handlePending(o,f);return}e.cancelable&&e.preventDefault(),s(c)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===Wa.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const OPe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class sN extends oN{constructor(e){const{event:r}=e,n=T_(r.target);super(e,OPe,n)}}sN.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const LPe={move:{name:"mousemove"},end:{name:"mouseup"}};var eR;(function(t){t[t.RightClick=2]="RightClick"})(eR||(eR={}));class zQ extends oN{constructor(e){super(e,LPe,T_(e.event.target))}}zQ.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return r.button===eR.RightClick?!1:(n?.({event:r}),!0)}}];const hP={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class NPe extends oN{constructor(e){super(e,hP)}static setup(){return window.addEventListener(hP.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(hP.move.name,e)};function e(){}}}NPe.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;const{touches:i}=r;return i.length>1?!1:(n?.({event:r}),!0)}}];var vb;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(vb||(vb={}));var PE;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(PE||(PE={}));function FPe(t){let{acceleration:e,activator:r=vb.Pointer,canScroll:n,draggingRect:i,enabled:a,interval:s=5,order:o=PE.TreeOrder,pointerCoordinates:c,scrollableAncestors:f,scrollableAncestorRects:d,delta:m,threshold:b}=t;const x=zPe({delta:m,disabled:!a}),[E,T]=X4e(),A=te.useRef({x:0,y:0}),R=te.useRef({x:0,y:0}),F=te.useMemo(()=>{switch(r){case vb.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case vb.DraggableRect:return i}},[r,i,c]),N=te.useRef(null),O=te.useCallback(()=>{const j=N.current;if(!j)return;const H=A.current.x*R.current.x,W=A.current.y*R.current.y;j.scrollBy(H,W)},[]),U=te.useMemo(()=>o===PE.TreeOrder?[...f].reverse():f,[o,f]);te.useEffect(()=>{if(!a||!f.length||!F){T();return}for(const j of U){if(n?.(j)===!1)continue;const H=f.indexOf(j),W=d[H];if(!W)continue;const{direction:X,speed:oe}=TPe(j,W,F,e,b);for(const ee of["x","y"])x[ee][X[ee]]||(oe[ee]=0,X[ee]=0);if(oe.x>0||oe.y>0){T(),N.current=j,E(O,s),A.current=oe,R.current=X;return}}A.current={x:0,y:0},R.current={x:0,y:0},T()},[e,O,n,T,a,s,JSON.stringify(F),JSON.stringify(x),E,f,U,d,JSON.stringify(b)])}const BPe={x:{[iu.Backward]:!1,[iu.Forward]:!1},y:{[iu.Backward]:!1,[iu.Forward]:!1}};function zPe(t){let{delta:e,disabled:r}=t;const n=Kk(e);return Wx(i=>{if(r||!n||!i)return BPe;const a={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[iu.Backward]:i.x[iu.Backward]||a.x===-1,[iu.Forward]:i.x[iu.Forward]||a.x===1},y:{[iu.Backward]:i.y[iu.Backward]||a.y===-1,[iu.Forward]:i.y[iu.Forward]||a.y===1}}},[r,e,n])}function jPe(t,e){const r=e!=null?t.get(e):void 0,n=r?r.node.current:null;return Wx(i=>{var a;return e==null?null:(a=n??i)!=null?a:null},[n,e])}function UPe(t,e){return te.useMemo(()=>t.reduce((r,n)=>{const{sensor:i}=n,a=i.activators.map(s=>({eventName:s.eventName,handler:e(s.handler,n)}));return[...r,...a]},[]),[t,e])}var tx;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(tx||(tx={}));var tR;(function(t){t.Optimized="optimized"})(tR||(tR={}));const K$=new Map;function VPe(t,e){let{dragging:r,dependencies:n,config:i}=e;const[a,s]=te.useState(null),{frequency:o,measure:c,strategy:f}=i,d=te.useRef(t),m=A(),b=Qb(m),x=te.useCallback(function(R){R===void 0&&(R=[]),!b.current&&s(F=>F===null?R:F.concat(R.filter(N=>!F.includes(N))))},[b]),E=te.useRef(null),T=Wx(R=>{if(m&&!r)return K$;if(!R||R===K$||d.current!==t||a!=null){const F=new Map;for(let N of t){if(!N)continue;if(a&&a.length>0&&!a.includes(N.id)&&N.rect.current){F.set(N.id,N.rect.current);continue}const O=N.node.current,U=O?new aN(c(O),O):null;N.rect.current=U,U&&F.set(N.id,U)}return F}return R},[t,a,r,m,c]);return te.useEffect(()=>{d.current=t},[t]),te.useEffect(()=>{m||x()},[r,m]),te.useEffect(()=>{a&&a.length>0&&s(null)},[JSON.stringify(a)]),te.useEffect(()=>{m||typeof o!="number"||E.current!==null||(E.current=setTimeout(()=>{x(),E.current=null},o))},[o,m,x,...n]),{droppableRects:T,measureDroppableContainers:x,measuringScheduled:a!=null};function A(){switch(f){case tx.Always:return!1;case tx.BeforeDragging:return r;default:return!r}}}function jQ(t,e){return Wx(r=>t?r||(typeof e=="function"?e(t):t):null,[e,t])}function $Pe(t,e){return jQ(t,e)}function qPe(t){let{callback:e,disabled:r}=t;const n=rN(e),i=te.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(n)},[n,r]);return te.useEffect(()=>()=>i?.disconnect(),[i]),i}function M3(t){let{callback:e,disabled:r}=t;const n=rN(e),i=te.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(n)},[r]);return te.useEffect(()=>()=>i?.disconnect(),[i]),i}function HPe(t){return new aN(C_(t),t)}function J$(t,e,r){e===void 0&&(e=HPe);const[n,i]=te.useState(null);function a(){i(c=>{if(!t)return null;if(t.isConnected===!1){var f;return(f=c??r)!=null?f:null}const d=e(t);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const s=qPe({callback(c){if(t)for(const f of c){const{type:d,target:m}=f;if(d==="childList"&&m instanceof HTMLElement&&m.contains(t)){a();break}}}}),o=M3({callback:a});return Ed(()=>{a(),t?(o?.observe(t),s?.observe(document.body,{childList:!0,subtree:!0})):(o?.disconnect(),s?.disconnect())},[t]),n}function GPe(t){const e=jQ(t);return MQ(t,e)}const Q$=[];function WPe(t){const e=te.useRef(t),r=Wx(n=>t?n&&n!==Q$&&t&&e.current&&t.parentNode===e.current.parentNode?n:iN(t):Q$,[t]);return te.useEffect(()=>{e.current=t},[t]),r}function XPe(t){const[e,r]=te.useState(null),n=te.useRef(t),i=te.useCallback(a=>{const s=cP(a.target);s&&r(o=>o?(o.set(s,Qk(s)),new Map(o)):null)},[]);return te.useEffect(()=>{const a=n.current;if(t!==a){s(a);const o=t.map(c=>{const f=cP(c);return f?(f.addEventListener("scroll",i,{passive:!0}),[f,Qk(f)]):null}).filter(c=>c!=null);r(o.length?new Map(o):null),n.current=t}return()=>{s(t),s(a)};function s(o){o.forEach(c=>{const f=cP(c);f?.removeEventListener("scroll",i)})}},[i,t]),te.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,s)=>A0(a,s),Ih):NQ(t):Ih,[t,e])}function eq(t,e){e===void 0&&(e=[]);const r=te.useRef(null);return te.useEffect(()=>{r.current=null},e),te.useEffect(()=>{const n=t!==Ih;n&&!r.current&&(r.current=t),!n&&r.current&&(r.current=null)},[t]),r.current?AE(t,r.current):Ih}function YPe(t){te.useEffect(()=>{if(!P3)return;const e=t.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of e)r?.()}},t.map(e=>{let{sensor:r}=e;return r}))}function ZPe(t,e){return te.useMemo(()=>t.reduce((r,n)=>{let{eventName:i,handler:a}=n;return r[i]=s=>{a(s,e)},r},{}),[t,e])}function UQ(t){return te.useMemo(()=>t?xPe(t):null,[t])}const tq=[];function KPe(t,e){e===void 0&&(e=C_);const[r]=t,n=UQ(r?jc(r):null),[i,a]=te.useState(tq);function s(){a(()=>t.length?t.map(c=>OQ(c)?n:new aN(e(c),c)):tq)}const o=M3({callback:s});return Ed(()=>{o?.disconnect(),s(),t.forEach(c=>o?.observe(c))},[t]),i}function JPe(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return Gx(e)?e:t}function QPe(t){let{measure:e}=t;const[r,n]=te.useState(null),i=te.useCallback(f=>{for(const{target:d}of f)if(Gx(d)){n(m=>{const b=e(d);return m?{...m,width:b.width,height:b.height}:b});break}},[e]),a=M3({callback:i}),s=te.useCallback(f=>{const d=JPe(f);a?.disconnect(),d&&a?.observe(d),n(d?e(d):null)},[e,a]),[o,c]=CE(s);return te.useMemo(()=>({nodeRef:o,rect:r,setRef:c}),[r,o,c])}const eMe=[{sensor:sN,options:{}},{sensor:BQ,options:{}}],tMe={current:{}},vS={draggable:{measure:W$},droppable:{measure:W$,strategy:tx.WhileDragging,frequency:tR.Optimized},dragOverlay:{measure:C_}};class _b extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,n;return(r=(n=this.get(e))==null?void 0:n.node.current)!=null?r:void 0}}const rMe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new _b,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:IE},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:vS,measureDroppableContainers:IE,windowRect:null,measuringScheduled:!1},nMe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:IE,draggableNodes:new Map,over:null,measureDroppableContainers:IE},k3=te.createContext(nMe),VQ=te.createContext(rMe);function iMe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new _b}}}function aMe(t,e){switch(e.type){case Nl.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Nl.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Nl.DragEnd:case Nl.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Nl.RegisterDroppable:{const{element:r}=e,{id:n}=r,i=new _b(t.droppable.containers);return i.set(n,r),{...t,droppable:{...t.droppable,containers:i}}}case Nl.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=e,a=t.droppable.containers.get(r);if(!a||n!==a.key)return t;const s=new _b(t.droppable.containers);return s.set(r,{...a,disabled:i}),{...t,droppable:{...t.droppable,containers:s}}}case Nl.UnregisterDroppable:{const{id:r,key:n}=e,i=t.droppable.containers.get(r);if(!i||n!==i.key)return t;const a=new _b(t.droppable.containers);return a.delete(r),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function oMe(t){let{disabled:e}=t;const{active:r,activatorEvent:n,draggableNodes:i}=te.useContext(k3),a=Kk(n),s=Kk(r?.id);return te.useEffect(()=>{if(!e&&!n&&a&&s!=null){if(!nN(a)||document.activeElement===a.target)return;const o=i.get(s);if(!o)return;const{activatorNode:c,node:f}=o;if(!c.current&&!f.current)return;requestAnimationFrame(()=>{for(const d of[c.current,f.current]){if(!d)continue;const m=K4e(d);if(m){m.focus();break}}})}},[n,e,i,s,a]),null}function sMe(t,e){let{transform:r,...n}=e;return t!=null&&t.length?t.reduce((i,a)=>a({transform:i,...n}),r):r}function lMe(t){return te.useMemo(()=>({draggable:{...vS.draggable,...t?.draggable},droppable:{...vS.droppable,...t?.droppable},dragOverlay:{...vS.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function uMe(t){let{activeNode:e,measure:r,initialRect:n,config:i=!0}=t;const a=te.useRef(!1),{x:s,y:o}=typeof i=="boolean"?{x:i,y:i}:i;Ed(()=>{if(!s&&!o||!e){a.current=!1;return}if(a.current||!n)return;const f=e?.node.current;if(!f||f.isConnected===!1)return;const d=r(f),m=MQ(d,n);if(s||(m.x=0),o||(m.y=0),a.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const b=kQ(f);b&&b.scrollBy({top:m.y,left:m.x})}},[e,s,o,n,r])}const $Q=te.createContext({...Ih,scaleX:1,scaleY:1});var ig;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(ig||(ig={}));const cMe=te.memo(function(e){var r,n,i,a;let{id:s,accessibility:o,autoScroll:c=!0,children:f,sensors:d=eMe,collisionDetection:m=pPe,measuring:b,modifiers:x,...E}=e;const T=te.useReducer(aMe,void 0,iMe),[A,R]=T,[F,N]=nPe(),[O,U]=te.useState(ig.Uninitialized),j=O===ig.Initialized,{draggable:{active:H,nodes:W,translate:X},droppable:{containers:oe}}=A,ee=H!=null?W.get(H):null,G=te.useRef({initial:null,translated:null}),ae=te.useMemo(()=>{var zr;return H!=null?{id:H,data:(zr=ee?.data)!=null?zr:tMe,rect:G}:null},[H,ee]),se=te.useRef(null),[fe,pe]=te.useState(null),[De,ye]=te.useState(null),we=Qb(E,Object.values(E)),Te=Xx("DndDescribedBy",s),Re=te.useMemo(()=>oe.getEnabled(),[oe]),de=lMe(b),{droppableRects:Ee,measureDroppableContainers:xe,measuringScheduled:Ne}=VPe(Re,{dragging:j,dependencies:[X.x,X.y],config:de.droppable}),Fe=jPe(W,H),Xe=te.useMemo(()=>De?Jk(De):null,[De]),Be=cn(),ot=$Pe(Fe,de.draggable.measure);uMe({activeNode:H!=null?W.get(H):null,config:Be.layoutShiftCompensation,initialRect:ot,measure:de.draggable.measure});const Ke=J$(Fe,de.draggable.measure,ot),it=J$(Fe?Fe.parentElement:null),Me=te.useRef({activatorEvent:null,active:null,activeNode:Fe,collisionRect:null,collisions:null,droppableRects:Ee,draggableNodes:W,draggingNode:null,draggingNodeRect:null,droppableContainers:oe,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),zt=oe.getNodeFor((r=Me.current.over)==null?void 0:r.id),st=QPe({measure:de.dragOverlay.measure}),$e=(n=st.nodeRef.current)!=null?n:Fe,Jt=j?(i=st.rect)!=null?i:Ke:null,Ht=!!(st.nodeRef.current&&st.rect),pr=GPe(Ht?null:Ke),_t=UQ($e?jc($e):null),vr=WPe(j?zt??Fe:null),br=KPe(vr),lr=sMe(x,{transform:{x:X.x-pr.x,y:X.y-pr.y,scaleX:1,scaleY:1},activatorEvent:De,active:ae,activeNodeRect:Ke,containerNodeRect:it,draggingNodeRect:Jt,over:Me.current.over,overlayNodeRect:st.rect,scrollableAncestors:vr,scrollableAncestorRects:br,windowRect:_t}),Cr=Xe?A0(Xe,X):null,Tr=XPe(vr),Qt=eq(Tr),at=eq(Tr,[Ke]),Pe=A0(lr,Qt),be=Jt?yPe(Jt,lr):null,je=ae&&be?m({active:ae,collisionRect:be,droppableRects:Ee,droppableContainers:Re,pointerCoordinates:Cr}):null,qe=fPe(je,"id"),[Ge,Nt]=te.useState(null),Et=Ht?lr:A0(lr,at),mt=gPe(Et,(a=Ge?.rect)!=null?a:null,Ke),ct=te.useRef(null),Kt=te.useCallback((zr,Rt)=>{let{sensor:en,options:jn}=Rt;if(se.current==null)return;const Qr=W.get(se.current);if(!Qr)return;const nr=zr.nativeEvent,oi=new en({active:se.current,activeNode:Qr,event:nr,options:jn,context:Me,onAbort(Kn){if(!W.get(Kn))return;const{onDragAbort:He}=we.current,Tt={id:Kn};He?.(Tt),F({type:"onDragAbort",event:Tt})},onPending(Kn,ke,He,Tt){if(!W.get(Kn))return;const{onDragPending:Ut}=we.current,Xr={id:Kn,constraint:ke,initialCoordinates:He,offset:Tt};Ut?.(Xr),F({type:"onDragPending",event:Xr})},onStart(Kn){const ke=se.current;if(ke==null)return;const He=W.get(ke);if(!He)return;const{onDragStart:Tt}=we.current,Gt={activatorEvent:nr,active:{id:ke,data:He.data,rect:G}};lp.unstable_batchedUpdates(()=>{Tt?.(Gt),U(ig.Initializing),R({type:Nl.DragStart,initialCoordinates:Kn,active:ke}),F({type:"onDragStart",event:Gt}),pe(ct.current),ye(nr)})},onMove(Kn){R({type:Nl.DragMove,coordinates:Kn})},onEnd:ln(Nl.DragEnd),onCancel:ln(Nl.DragCancel)});ct.current=oi;function ln(Kn){return async function(){const{active:He,collisions:Tt,over:Gt,scrollAdjustedTranslate:Ut}=Me.current;let Xr=null;if(He&&Ut){const{cancelDrop:Ln}=we.current;Xr={activatorEvent:nr,active:He,collisions:Tt,delta:Ut,over:Gt},Kn===Nl.DragEnd&&typeof Ln=="function"&&await Promise.resolve(Ln(Xr))&&(Kn=Nl.DragCancel)}se.current=null,lp.unstable_batchedUpdates(()=>{R({type:Kn}),U(ig.Uninitialized),Nt(null),pe(null),ye(null),ct.current=null;const Ln=Kn===Nl.DragEnd?"onDragEnd":"onDragCancel";if(Xr){const Bi=we.current[Ln];Bi?.(Xr),F({type:Ln,event:Xr})}})}}},[W]),qt=te.useCallback((zr,Rt)=>(en,jn)=>{const Qr=en.nativeEvent,nr=W.get(jn);if(se.current!==null||!nr||Qr.dndKit||Qr.defaultPrevented)return;const oi={active:nr};zr(en,Rt.options,oi)===!0&&(Qr.dndKit={capturedBy:Rt.sensor},se.current=jn,Kt(en,Rt))},[W,Kt]),Ir=UPe(d,qt);YPe(d),Ed(()=>{Ke&&O===ig.Initializing&&U(ig.Initialized)},[Ke,O]),te.useEffect(()=>{const{onDragMove:zr}=we.current,{active:Rt,activatorEvent:en,collisions:jn,over:Qr}=Me.current;if(!Rt||!en)return;const nr={active:Rt,activatorEvent:en,collisions:jn,delta:{x:Pe.x,y:Pe.y},over:Qr};lp.unstable_batchedUpdates(()=>{zr?.(nr),F({type:"onDragMove",event:nr})})},[Pe.x,Pe.y]),te.useEffect(()=>{const{active:zr,activatorEvent:Rt,collisions:en,droppableContainers:jn,scrollAdjustedTranslate:Qr}=Me.current;if(!zr||se.current==null||!Rt||!Qr)return;const{onDragOver:nr}=we.current,oi=jn.get(qe),ln=oi&&oi.rect.current?{id:oi.id,rect:oi.rect.current,data:oi.data,disabled:oi.disabled}:null,Kn={active:zr,activatorEvent:Rt,collisions:en,delta:{x:Qr.x,y:Qr.y},over:ln};lp.unstable_batchedUpdates(()=>{Nt(ln),nr?.(Kn),F({type:"onDragOver",event:Kn})})},[qe]),Ed(()=>{Me.current={activatorEvent:De,active:ae,activeNode:Fe,collisionRect:be,collisions:je,droppableRects:Ee,draggableNodes:W,draggingNode:$e,draggingNodeRect:Jt,droppableContainers:oe,over:Ge,scrollableAncestors:vr,scrollAdjustedTranslate:Pe},G.current={initial:Jt,translated:be}},[ae,Fe,je,be,W,$e,Jt,Ee,oe,Ge,vr,Pe]),FPe({...Be,delta:X,draggingRect:be,pointerCoordinates:Cr,scrollableAncestors:vr,scrollableAncestorRects:br});const Ar=te.useMemo(()=>({active:ae,activeNode:Fe,activeNodeRect:Ke,activatorEvent:De,collisions:je,containerNodeRect:it,dragOverlay:st,draggableNodes:W,droppableContainers:oe,droppableRects:Ee,over:Ge,measureDroppableContainers:xe,scrollableAncestors:vr,scrollableAncestorRects:br,measuringConfiguration:de,measuringScheduled:Ne,windowRect:_t}),[ae,Fe,Ke,De,je,it,st,W,oe,Ee,Ge,xe,vr,br,de,Ne,_t]),$r=te.useMemo(()=>({activatorEvent:De,activators:Ir,active:ae,activeNodeRect:Ke,ariaDescribedById:{draggable:Te},dispatch:R,draggableNodes:W,over:Ge,measureDroppableContainers:xe}),[De,Ir,ae,Ke,R,Te,W,Ge,xe]);return gt.createElement(PQ.Provider,{value:N},gt.createElement(k3.Provider,{value:$r},gt.createElement(VQ.Provider,{value:Ar},gt.createElement($Q.Provider,{value:mt},f)),gt.createElement(oMe,{disabled:o?.restoreFocus===!1})),gt.createElement(oPe,{...o,hiddenTextDescribedById:Te}));function cn(){const zr=fe?.autoScrollEnabled===!1,Rt=typeof c=="object"?c.enabled===!1:c===!1,en=j&&!zr&&!Rt;return typeof c=="object"?{...c,enabled:en}:{enabled:en}}}),fMe=te.createContext(null),rq="button",hMe="Draggable";function dMe(t){let{id:e,data:r,disabled:n=!1,attributes:i}=t;const a=Xx(hMe),{activators:s,activatorEvent:o,active:c,activeNodeRect:f,ariaDescribedById:d,draggableNodes:m,over:b}=te.useContext(k3),{role:x=rq,roleDescription:E="draggable",tabIndex:T=0}=i??{},A=c?.id===e,R=te.useContext(A?$Q:fMe),[F,N]=CE(),[O,U]=CE(),j=ZPe(s,e),H=Qb(r);Ed(()=>(m.set(e,{id:e,key:a,node:F,activatorNode:O,data:H}),()=>{const X=m.get(e);X&&X.key===a&&m.delete(e)}),[m,e]);const W=te.useMemo(()=>({role:x,tabIndex:T,"aria-disabled":n,"aria-pressed":A&&x===rq?!0:void 0,"aria-roledescription":E,"aria-describedby":d.draggable}),[n,x,T,A,E,d.draggable]);return{active:c,activatorEvent:o,activeNodeRect:f,attributes:W,isDragging:A,listeners:n?void 0:j,node:F,over:b,setNodeRef:N,setActivatorNodeRef:U,transform:R}}function pMe(){return te.useContext(VQ)}const gMe="Droppable",mMe={timeout:25};function yMe(t){let{data:e,disabled:r=!1,id:n,resizeObserverConfig:i}=t;const a=Xx(gMe),{active:s,dispatch:o,over:c,measureDroppableContainers:f}=te.useContext(k3),d=te.useRef({disabled:r}),m=te.useRef(!1),b=te.useRef(null),x=te.useRef(null),{disabled:E,updateMeasurementsFor:T,timeout:A}={...mMe,...i},R=Qb(T??n),F=te.useCallback(()=>{if(!m.current){m.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{f(Array.isArray(R.current)?R.current:[R.current]),x.current=null},A)},[A]),N=M3({callback:F,disabled:E||!s}),O=te.useCallback((W,X)=>{N&&(X&&(N.unobserve(X),m.current=!1),W&&N.observe(W))},[N]),[U,j]=CE(O),H=Qb(e);return te.useEffect(()=>{!N||!U.current||(N.disconnect(),m.current=!1,N.observe(U.current))},[U,N]),te.useEffect(()=>(o({type:Nl.RegisterDroppable,element:{id:n,key:a,disabled:r,node:U,rect:b,data:H}}),()=>o({type:Nl.UnregisterDroppable,key:a,id:n})),[n]),te.useEffect(()=>{r!==d.current.disabled&&(o({type:Nl.SetDroppableDisabled,id:n,key:a,disabled:r}),d.current.disabled=r)},[n,a,r,o]),{active:s,rect:b,isOver:c?.id===n,node:U,over:c,setNodeRef:j}}function qQ(t,e,r){const n=t.slice();return n.splice(r<0?n.length+r:r,0,n.splice(e,1)[0]),n}function vMe(t,e){return t.reduce((r,n,i)=>{const a=e.get(n);return a&&(r[i]=a),r},Array(t.length))}function Mw(t){return t!==null&&t>=0}function _Me(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function bMe(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const HQ=t=>{let{rects:e,activeIndex:r,overIndex:n,index:i}=t;const a=qQ(e,n,r),s=e[i],o=a[i];return!o||!s?null:{x:o.left-s.left,y:o.top-s.top,scaleX:o.width/s.width,scaleY:o.height/s.height}},kw={scaleX:1,scaleY:1},xMe=t=>{var e;let{activeIndex:r,activeNodeRect:n,index:i,rects:a,overIndex:s}=t;const o=(e=a[r])!=null?e:n;if(!o)return null;if(i===r){const f=a[s];return f?{x:0,y:r<s?f.top+f.height-(o.top+o.height):f.top-o.top,...kw}:null}const c=wMe(a,i,r);return i>r&&i<=s?{x:0,y:-o.height-c,...kw}:i<r&&i>=s?{x:0,y:o.height+c,...kw}:{x:0,y:0,...kw}};function wMe(t,e,r){const n=t[e],i=t[e-1],a=t[e+1];return n?r<e?i?n.top-(i.top+i.height):a?a.top-(n.top+n.height):0:a?a.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const GQ="Sortable",WQ=gt.createContext({activeIndex:-1,containerId:GQ,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:HQ,disabled:{draggable:!1,droppable:!1}});function SMe(t){let{children:e,id:r,items:n,strategy:i=HQ,disabled:a=!1}=t;const{active:s,dragOverlay:o,droppableRects:c,over:f,measureDroppableContainers:d}=pMe(),m=Xx(GQ,r),b=o.rect!==null,x=te.useMemo(()=>n.map(j=>typeof j=="object"&&"id"in j?j.id:j),[n]),E=s!=null,T=s?x.indexOf(s.id):-1,A=f?x.indexOf(f.id):-1,R=te.useRef(x),F=!_Me(x,R.current),N=A!==-1&&T===-1||F,O=bMe(a);Ed(()=>{F&&E&&d(x)},[F,x,E,d]),te.useEffect(()=>{R.current=x},[x]);const U=te.useMemo(()=>({activeIndex:T,containerId:m,disabled:O,disableTransforms:N,items:x,overIndex:A,useDragOverlay:b,sortedRects:vMe(x,c),strategy:i}),[T,m,O.draggable,O.droppable,N,x,A,c,b,i]);return gt.createElement(WQ.Provider,{value:U},e)}const EMe=t=>{let{id:e,items:r,activeIndex:n,overIndex:i}=t;return qQ(r,n,i).indexOf(e)},TMe=t=>{let{containerId:e,isSorting:r,wasDragging:n,index:i,items:a,newIndex:s,previousItems:o,previousContainerId:c,transition:f}=t;return!f||!n||o!==a&&i===s?!1:r?!0:s!==i&&e===c},CMe={duration:200,easing:"ease"},XQ="transform",AMe=ex.Transition.toString({property:XQ,duration:0,easing:"linear"}),IMe={roleDescription:"sortable"};function PMe(t){let{disabled:e,index:r,node:n,rect:i}=t;const[a,s]=te.useState(null),o=te.useRef(r);return Ed(()=>{if(!e&&r!==o.current&&n.current){const c=i.current;if(c){const f=C_(n.current,{ignoreTransform:!0}),d={x:c.left-f.left,y:c.top-f.top,scaleX:c.width/f.width,scaleY:c.height/f.height};(d.x||d.y)&&s(d)}}r!==o.current&&(o.current=r)},[e,r,n,i]),te.useEffect(()=>{a&&s(null)},[a]),a}function MMe(t){let{animateLayoutChanges:e=TMe,attributes:r,disabled:n,data:i,getNewIndex:a=EMe,id:s,strategy:o,resizeObserverConfig:c,transition:f=CMe}=t;const{items:d,containerId:m,activeIndex:b,disabled:x,disableTransforms:E,sortedRects:T,overIndex:A,useDragOverlay:R,strategy:F}=te.useContext(WQ),N=kMe(n,x),O=d.indexOf(s),U=te.useMemo(()=>({sortable:{containerId:m,index:O,items:d},...i}),[m,i,O,d]),j=te.useMemo(()=>d.slice(d.indexOf(s)),[d,s]),{rect:H,node:W,isOver:X,setNodeRef:oe}=yMe({id:s,data:U,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:j,...c}}),{active:ee,activatorEvent:G,activeNodeRect:ae,attributes:se,setNodeRef:fe,listeners:pe,isDragging:De,over:ye,setActivatorNodeRef:we,transform:Te}=dMe({id:s,data:U,attributes:{...IMe,...r},disabled:N.draggable}),Re=W4e(oe,fe),de=!!ee,Ee=de&&!E&&Mw(b)&&Mw(A),xe=!R&&De,Ne=xe&&Ee?Te:null,Xe=Ee?Ne??(o??F)({rects:T,activeNodeRect:ae,activeIndex:b,overIndex:A,index:O}):null,Be=Mw(b)&&Mw(A)?a({id:s,items:d,activeIndex:b,overIndex:A}):O,ot=ee?.id,Ke=te.useRef({activeId:ot,items:d,newIndex:Be,containerId:m}),it=d!==Ke.current.items,Me=e({active:ee,containerId:m,isDragging:De,isSorting:de,id:s,index:O,items:d,newIndex:Ke.current.newIndex,previousItems:Ke.current.items,previousContainerId:Ke.current.containerId,transition:f,wasDragging:Ke.current.activeId!=null}),zt=PMe({disabled:!Me,index:O,node:W,rect:H});return te.useEffect(()=>{de&&Ke.current.newIndex!==Be&&(Ke.current.newIndex=Be),m!==Ke.current.containerId&&(Ke.current.containerId=m),d!==Ke.current.items&&(Ke.current.items=d)},[de,Be,m,d]),te.useEffect(()=>{if(ot===Ke.current.activeId)return;if(ot!=null&&Ke.current.activeId==null){Ke.current.activeId=ot;return}const $e=setTimeout(()=>{Ke.current.activeId=ot},50);return()=>clearTimeout($e)},[ot]),{active:ee,activeIndex:b,attributes:se,data:U,rect:H,index:O,newIndex:Be,items:d,isOver:X,isSorting:de,isDragging:De,listeners:pe,node:W,overIndex:A,over:ye,setNodeRef:Re,setActivatorNodeRef:we,setDroppableNodeRef:oe,setDraggableNodeRef:fe,transform:zt??Xe,transition:st()};function st(){if(zt||it&&Ke.current.newIndex===O)return AMe;if(!(xe&&!nN(G)||!f)&&(de||Me))return ex.Transition.toString({...f,property:XQ})}}function kMe(t,e){var r,n;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(r=t?.draggable)!=null?r:e.draggable,droppable:(n=t?.droppable)!=null?n:e.droppable}}Wa.Down,Wa.Right,Wa.Up,Wa.Left;function ME({children:t}){const e=te.useRef(vc()),{attributes:r,listeners:n,setNodeRef:i,transform:a}=MMe({id:e.current}),s={transform:ex.Transform.toString(a)};return J.jsx("li",{ref:i,style:s,...r,...n,children:t})}try{ME.displayName="SortableContainer",ME.__docgenInfo={description:"",displayName:"SortableContainer",props:{}}}catch{}const RMe=Dr(uf)({padding:"4px",marginTop:"-3px"}),DMe=Dr(uf)({marginLeft:"20px"});function cp({layerComponent:t,visible:e,type:r,name:n,description:i,configurable:a,setLayerState:s,...o}){const[c,f]=te.useState(!0),[d,m]=te.useState(!1),[b,x]=te.useState(!1),E=te.useRef(!1),T=te.useRef(e),[A,R]=te.useState(t?.props?.paint||t?.props?.options?.paint||wJ(t?.props?.type||gE(t.props.geojson))),F=te.useMemo(()=>e?c:!1,[e,c]);te.useEffect(()=>{if(!s||!t?.props?.layers||F===T.current)return;T.current=F;const j={...t?.props};switch(t.type.name){case"MlWmsLayer":break;case"MlVectorTileLayer":t?.props?.layers&&!E.current&&(j.layers=t?.props?.layers.map(H=>(H.layout?H.layout.visibility=F?"visible":"none":H.layout={visibility:F?"visible":"none"},H)),console.log("setLayerState",j.layers),s(j));break}},[F,s,t]),te.useEffect(()=>{!s||E.current||!A||t?.props?.layers||JSON.stringify(A)!==JSON.stringify(t.props?.paint)&&s({...t.props,paint:A})},[A,s,t.props?.paint]);const N=te.useMemo(()=>{if(t&&r==="layer")switch(t.type.displayName){case"MlWmsLayer":return gt.cloneElement(t,{...t?.props,visible:F});case"MlVectorTileLayer":return gt.cloneElement(t,{...t?.props});default:case"MlGeoJsonLayer":return gt.cloneElement(t,{layout:{visibility:F?"visible":"none"},options:{...t?.props?.options,...s?{}:{paint:A}}})}return J.jsx(J.Fragment,{})},[r,t,A,F,t?.props?.layers,s]),O=te.useMemo(()=>{if(t&&r==="layer"){if(t.props.type)return t.props.type;if(t.props.geojson)return gE(t.props.geojson)}},[t]),U=J.jsxs(EE,{sx:{...o.listItemSx},secondaryAction:a&&Object.keys(A)?.length>0?J.jsxs(J.Fragment,{children:[o?.buttons,J.jsx(RMe,{edge:"end","aria-label":"settings",onClick:()=>{m(j=>!j)},children:J.jsx(cL,{})})]}):void 0,children:[J.jsx(ap,{children:J.jsx(op,{disabled:!e,checked:c,onClick:()=>{f(j=>!j)}})}),J.jsx(Df,{variant:"layerlist",primary:n,secondary:i,primaryTypographyProps:{overflow:"hidden"}})]});return J.jsxs(J.Fragment,{children:[o.sortable&&o.layerId&&!t?.props?.layers&&J.jsx(ME,{children:U}),!o.sortable&&!t?.props?.layers&&U,N,!t?.props?.layers&&Object.keys(A).length>0&&a&&d&&J.jsxs(J.Fragment,{children:[o.showDeleteButton&&J.jsxs(J.Fragment,{children:[J.jsx(DMe,{edge:"end","aria-label":"delete",onClick:()=>{typeof s=="function"&&x(!0)},children:J.jsx(Ux,{})}),b&&J.jsx(Z0,{open:b,onConfirm:()=>{typeof s=="function"&&(E.current=!0,s(!1),x(!1))},onCancel:()=>{x(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]}),J.jsx(SE,{paintProps:A,setPaintProps:R,layerType:O})]}),t?.props?.layers&&J.jsx(Vk,{visible:c,setVisible:f,name:n,children:t?.props?.layers?.map?.((j,H)=>J.jsx(TE,{vtProps:t?.props,setVtProps:s,id:""+H,visibleMaster:F},""+H))})]})}cp.defaultProps={type:"layer",visible:!0,showDeleteButton:!1,buttons:J.jsx(J.Fragment,{})};try{cp.displayName="LayerListItem",cp.__docgenInfo={description:"",displayName:"LayerListItem",props:{layerComponent:{defaultValue:null,description:"",name:"layerComponent",required:!0,type:{name:"Element"}},visible:{defaultValue:{value:"true"},description:"",name:"visible",required:!1,type:{name:"boolean"}},configurable:{defaultValue:null,description:"",name:"configurable",required:!0,type:{name:"boolean"}},type:{defaultValue:{value:"layer"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"layer"'},{value:'"background"'},{value:'"background-labels"'},{value:'"wms-layer"'},{value:'"vector-tile-layer"'}]}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"ReactNode"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string | undefined"}},setLayerState:{defaultValue:null,description:"",name:"setLayerState",required:!1,type:{name:"Dispatch<any> | undefined"}},showDeleteButton:{defaultValue:{value:"false"},description:"",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},listItemSx:{defaultValue:null,description:"",name:"listItemSx",required:!1,type:{name:"SxProps | undefined"}},buttons:{defaultValue:{value:"<></>"},description:"",name:"buttons",required:!1,type:{name:"Element | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}}}}}catch{}const OMe=Ji(J.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),LMe=Dr("div")(()=>({display:"flex",alignItems:"center"})),NMe=56,FMe=Dr(Jo)(({theme:t})=>({width:30,height:6,backgroundColor:t.palette.text.primary,borderRadius:3,position:"absolute",top:8,left:"calc(50% - 15px)"}));function rR({drawerPaperProps:t,drawerHeaderProps:e,setOpen:r,...n}){const i=kx(c=>c.breakpoints.down("sm")),[a,s]=te.useState(!1),o=n.drawerBleeding?n.drawerBleeding:NMe;return J.jsxs(J.Fragment,{children:[i?J.jsxs(Jo,{sx:{display:{xs:"flex",sm:"none"}},children:[J.jsx(tX,{styles:{".MuiDrawer-root > .MuiPaper-root":{height:`calc(50% - ${o}px)`,overflow:"visible"}}}),J.jsxs(Vye,{anchor:"bottom",open:typeof n.open>"u"?a:n.open,onClose:r?()=>{r?.(!1)}:()=>{s(!1)},onOpen:r?()=>{r?.(!0)}:()=>{s(!0)},swipeAreaWidth:o,disableSwipeToOpen:!1,hideBackdrop:!0,ModalProps:{keepMounted:!0,sx:{top:"calc(90%)"}},children:[J.jsxs(Uf,{sx:{position:"absolute",top:-o,borderTopLeftRadius:8,borderTopRightRadius:8,visibility:"visible",right:0,left:0},children:[J.jsx(FMe,{}),J.jsx(Es,{variant:"h6",sx:{p:"13px"},children:n.name})]}),J.jsx(Uf,{sx:{px:"15px",pb:"15px",height:"100%",overflow:"auto",paddingTop:"20px"},children:n.children})]})]}):J.jsx(Jo,{sx:{display:{xs:"none",sm:"flex"},mr:1},children:J.jsxs(uO,{transitionDuration:0,variant:"persistent",anchor:"left",open:typeof n.open>"u"?a:n.open,PaperProps:{...t,sx:{maxWidth:{lg:"30%",md:"40%",sm:"50%",xs:"78%"},padding:{sm:"84px 20px 20px 20px",xs:"74px 10px 10px 10px"},width:{xs:"80%",sm:"60%",md:"350px",lg:"350px"},boxSizing:"border-box",...t?.sx}},sx:{flexGrow:1,zIndex:105,position:"absolute",bottom:0,display:"flex",flexDirection:"column",maxWidth:{lg:"30%",md:"40%",sm:"50%",xs:"78%"},...a?{}:{left:i?"-90vw":"-20vw"}},...n,children:[J.jsxs(LMe,{...e,children:[J.jsx(Es,{variant:"h6",children:n.name}),J.jsx(uf,{onClick:r?()=>{r?.(!1)}:()=>{s(!1)},sx:{position:"absolute",right:"20px"},children:J.jsx(OMe,{})})]}),J.jsx(Jo,{children:n.children})]})}),";"]})}try{rR.displayName="Sidebar",rR.__docgenInfo={description:"",displayName:"Sidebar",props:{drawerPaperProps:{defaultValue:null,description:"",name:"drawerPaperProps",required:!1,type:{name:"PaperProps | undefined"}},drawerHeaderProps:{defaultValue:null,description:"",name:"drawerHeaderProps",required:!1,type:{name:"Headers | undefined"}},children:{defaultValue:null,description:"The content of the component.",name:"children",required:!1,type:{name:"ReactNode"}},open:{defaultValue:{value:"false"},description:"If `true`, the component is shown.",name:"open",required:!1,type:{name:"boolean | undefined"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!1,type:{name:"((val: boolean) => void) | undefined"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string | undefined"}},drawerBleeding:{defaultValue:null,description:"",name:"drawerBleeding",required:!1,type:{name:"number | undefined"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements> | undefined"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<DrawerSlots> | undefined"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:"{ root?: SlotProps<ElementType<ModalProps, keyof IntrinsicElements>, DrawerRootSlotPropsOverrides, DrawerOwnerState> | undefined; backdrop?: SlotProps<...> | undefined; docked?: SlotProps<...> | undefined; paper?: SlotProps<...> | undefined; transition?: SlotProps<...> | undefined; } | undefined"}}}}}catch{}const nq=t=>{const[e,r]=te.useState(!0),[n,i]=te.useState(t.measureType),[a,s]=te.useState(),o=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[c,f]=te.useState(),[d,m]=te.useState("kilometers"),[b,x]=te.useState([]),[E,T]=te.useState(!1),A=()=>{d==="kilometers"&&m("miles"),d==="miles"&&m("kilometers")},R=N=>{x(O=>{const U=[...O];return U.splice(N,1),s(void 0),U})},F=N=>{f({measure:N.value,unit:N.unit,geojson:N.geojson})};return te.useEffect(()=>{E&&(T(!1),c&&x(N=>{const O=[...N];return O.push(c),O}))},[E]),te.useEffect(()=>{f(void 0)},[d]),J.jsx(J.Fragment,{children:J.jsxs(rR,{open:e,setOpen:r,name:"Multi Measure Tool",children:[J.jsxs(Jo,{sx:{flexGrow:1},children:[J.jsx("br",{}),J.jsxs(up,{container:!0,spacing:4,justifyContent:"flex-start",children:[J.jsx(up,{size:3,children:J.jsx(cg,{title:"Measure Area",children:J.jsx(ta,{variant:"outlined",sx:{backgroundColor:n==="polygon"?N=>N.palette.GPS.GPSActiveColor:N=>N.palette.GPS.GPSActiveBackgroundColor,color:n==="polygon"?N=>N.palette.GPS.GPSActiveBackgroundColor:N=>N.palette.GPS.GPSActiveColor},onClick:()=>{i("polygon"),f(void 0),T(!0)},children:J.jsx(EJ,{})})})}),J.jsx(up,{size:3,children:J.jsx(cg,{title:"Measure Distance",children:J.jsx(ta,{variant:"outlined",sx:{backgroundColor:n==="line"?N=>N.palette.GPS.GPSActiveColor:N=>N.palette.GPS.GPSActiveBackgroundColor,color:n==="line"?N=>N.palette.GPS.GPSActiveBackgroundColor:N=>N.palette.GPS.GPSActiveColor},onClick:()=>{i("line"),f(void 0),T(!0)},children:J.jsx(SJ,{})})})})]})]}),J.jsx("br",{}),J.jsx(up,{size:4,children:J.jsxs(af,{children:[J.jsx(vg,{id:"unit-select-label",children:"Unit"}),J.jsxs(_g,{labelId:"unit-select-label",id:"unit-select",value:d,label:"Unit",onChange:N=>{m(N.target.value),f(void 0),T(!0)},children:[J.jsx(Fm,{value:"kilometers",children:"Kilometers"}),J.jsx(Fm,{value:"miles",children:"Miles"})]})]})}),J.jsx("br",{}),!E&&J.jsx(jk,{measureType:n,unit:d,onChange:F,...A,onFinish:()=>{T(!0)}}),J.jsxs(Uk,{children:[b?.map((N,O)=>J.jsx(J.Fragment,{children:J.jsxs(Jo,{sx:{display:"flex",flexDirection:"column"},children:[J.jsx("br",{}),J.jsx(Jo,{flexDirection:"row",sx:{"&:hover":{backgroundColor:"rgb(177, 177, 177, 0.2)"},marginTop:"25px"},onMouseOver:()=>{s(N.geojson)},onMouseLeave:()=>{s(void 0)},children:J.jsxs(te.Fragment,{children:[J.jsx(cp,{layerComponent:J.jsx(Dc,{mapId:t.mapId,geojson:N.geojson}),visible:!0,configurable:!0,type:"layer",name:N.geojson.geometry?.type==="LineString"?N.measure.toFixed(3).toString()+" "+N.unit:N.measure.toFixed(3).toString()+" "+N.unit+""},N.measure),J.jsx(cg,{title:"Delete",children:J.jsxs(ta,{onClick:()=>R(O),children:[" ",J.jsx(Ux,{})," "]})}),J.jsx(cg,{title:"Center Location",children:J.jsx(ta,{onClick:()=>{o?.map?.map.setCenter(N.geojson.geometry.type==="Point"?N.geojson.geometry.coordinates:sL(N.geojson).geometry.coordinates)},children:J.jsx(uL,{})})})]},N.measure+"-"+O)})]},N.measure)})),a&&J.jsx(Dc,{mapId:t.mapId,geojson:{type:"FeatureCollection",features:[a]},layerId:"highlightBorder",defaultPaintOverrides:{circle:{"circle-color":"#dd9900","circle-opacity":.4,"circle-radius":10},line:{"line-color":"#dd9900","line-opacity":.4,"line-width":10},fill:{"fill-color":"#dd9900","fill-opacity":.4}}})]})]})})};try{nq.displayName="MlMultiMeasureTool",nq.__docgenInfo={description:"",displayName:"MlMultiMeasureTool",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},buttonStyleOverride:{defaultValue:null,description:`Style attribute for the button-style
https://mui.com/system/getting-started/the-sx-prop/`,name:"buttonStyleOverride",required:!1,type:{name:"SxProps | undefined"}},measureType:{defaultValue:null,description:'String that specify if the Tool measures an area ("polygon") or length ("line")',name:"measureType",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"line"'},{value:'"polygon"'}]}},multiType:{defaultValue:null,description:"Boolean which decides if the user can switch between measure modes",name:"multiType",required:!1,type:{name:"boolean | undefined"}},unit:{defaultValue:null,description:"String that dictates which unit of measurement is used",name:"unit",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"meters"'},{value:'"metres"'},{value:'"millimeters"'},{value:'"millimetres"'},{value:'"centimeters"'},{value:'"centimetres"'},{value:'"kilometers"'},{value:'"kilometres"'},{value:'"miles"'},{value:'"nauticalmiles"'},{value:'"inches"'},{value:'"yards"'},{value:'"feet"'},{value:'"radians"'},{value:'"degrees"'}]}},onChange:{defaultValue:null,description:`Callback function that is called each time measurment geometry within has changed within MlMeasureTool.
First parameter is the new GeoJson feature.`,name:"onChange",required:!1,type:{name:"((options: { value: number; unit?: string | undefined; geojson: Feature<Geometry, GeoJsonProperties>; geometries?: [] | undefined; }) => void) | undefined"}},onFinish:{defaultValue:null,description:"Callback function that is called by the end of drawing geometries.",name:"onFinish",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}const BMe=Ji(J.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),zMe=Ji(J.jsx("path",{d:"M19 13H5v-2h14z"})),nR=({className:t="",title:e,onClick:r,style:n})=>J.jsxs("svg",{width:"52",height:"53",viewBox:"0 0 52 53",fill:"none",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,children:[e&&J.jsx("title",{children:e}),J.jsx("circle",{cx:"26.0001",cy:"26.1843",r:"24",fill:"white",stroke:"#009EE0",strokeWidth:"2"}),J.jsx("path",{d:"M26.4915 7.59161C26.3524 8.07338 25.6698 8.07338 25.5307 7.59161L24.2998 3.3276C24.2075 3.0079 24.4474 2.68893 24.7802 2.68893H27.242C27.5748 2.68893 27.8147 3.0079 27.7224 3.3276L26.4915 7.59161Z",fill:"#009EE0"}),J.jsx("path",{d:"M25.5085 44.7598C25.6476 44.278 26.3302 44.278 26.4693 44.7598L27.7002 49.0238C27.7925 49.3435 27.5526 49.6625 27.2198 49.6625H24.758C24.4252 49.6625 24.1853 49.3435 24.2776 49.0238L25.5085 44.7598Z",fill:"#009EE0"}),J.jsx("path",{d:"M44.6641 26.4915C44.1823 26.3524 44.1823 25.6698 44.6641 25.5307L48.9281 24.2998C49.2478 24.2075 49.5668 24.4474 49.5668 24.7802V27.242C49.5668 27.5747 49.2478 27.8147 48.9281 27.7224L44.6641 26.4915Z",fill:"#009EE0"}),J.jsx("path",{d:"M7.3959 25.6085C7.87766 25.7476 7.87766 26.4302 7.3959 26.5693L3.13189 27.8002C2.81218 27.8925 2.49321 27.6526 2.49321 27.3198L2.49321 24.858C2.49321 24.5253 2.81218 24.2853 3.13189 24.3776L7.3959 25.6085Z",fill:"#009EE0"})]});try{nR.displayName="CompassBackground",nR.__docgenInfo={description:"",displayName:"CompassBackground",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const iR=({className:t="",title:e,onClick:r,style:n})=>J.jsxs("svg",{width:"10",height:"40",viewBox:"0 0 10 40",fill:"none",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,children:[e&&J.jsx("title",{children:e}),J.jsxs("g",{transform:"translate(0.67544,-1.25e-5)",children:[J.jsx("path",{d:"m 3.34715,4.52028 c 0.22737,-1.05154 1.72745,-1.05154 1.95482,0 L 8.64912,20 H 0 Z",fill:"#cf003d"}),J.jsx("path",{d:"m 3.34715,35.4797 c 0.22737,1.0516 1.72745,1.0516 1.95482,0 L 8.64912,20 H 0 Z",fill:"#d3dcf0"})]})]});try{iR.displayName="CompassNeedle",iR.__docgenInfo={description:"",displayName:"CompassNeedle",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const jMe=Dr(Jo)(({theme:t})=>({zIndex:1e3,cursor:"pointer",transform:"scale(1)",[t.breakpoints.down("md")]:{transform:"scale(1.6)"}})),UMe=Dr(Jo)(({theme:t})=>({position:"absolute",right:"-10px",top:"-52px",width:"52px",height:"52px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",[t.breakpoints.down("md")]:{right:"0px",top:"-52px"},circle:{fill:t.palette.compass.compColor,stroke:t.palette.compass.compStroke},path:{fill:t.palette.compass.compStroke},"&:hover circle":{fill:t.palette.compass.compHover}})),VMe=Dr(Jo)(({theme:t})=>({display:"flex",flexDirection:"row","path:nth-of-type(2)":{fill:t.palette.compass.compSouth},"path:nth-of-type(1)":{fill:t.palette.compass.compNorth}})),aR=t=>{const e=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(0),i=()=>{e.map?.map?.getBearing&&n(Math.round(e.map.map.getBearing()))};te.useEffect(()=>{if(e.map)return e.map.on("rotate",i,e.componentId),i(),()=>{e.map?.map.off("rotate",i)}},[e.map,t.mapId]);const a=()=>{r==0?e.map?.map.setBearing(-90):r==-90?e.map?.map.setBearing(180):r==180?e.map?.map.setBearing(90):e.map?.map.setBearing(0)};return J.jsx(J.Fragment,{children:J.jsx(jMe,{sx:{...t.style},children:J.jsxs(UMe,{onClick:a,sx:{...t.backgroundStyle},children:[J.jsx(nR,{style:{position:"absolute",top:0,left:0}}),J.jsx(VMe,{onClick:a,sx:{...t.needleStyle},children:J.jsx(iR,{style:{transform:"rotate("+(r>0?"-"+r:-1*r)+"deg)"}})})]})})})};try{aR.displayName="MlNavigationCompass",aR.__docgenInfo={description:`Navigation component that displays a compass component which indicates the current orientation of the map it is registered for and offers controls to turn the bearing 90 left/right or reset north to point up.

All style props are applied using`,displayName:"MlNavigationCompass",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapHook",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"Style object to adjust css definitions of the component.",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},backgroundStyle:{defaultValue:null,description:"Style object to adjust css definitions of the background.",name:"backgroundStyle",required:!1,type:{name:"CSSProperties | undefined"}},needleStyle:{defaultValue:null,description:"Style object to adjust css definitions of the compass needle.",name:"needleStyle",required:!1,type:{name:"CSSProperties | undefined"}}}}}catch{}const $Me=Ji(J.jsx("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M15 19l-6-2.11V5l6 2.11z"})),qMe=Ji(J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),HMe=Dr(ta)(({theme:t})=>({zIndex:1e3,color:t.palette.navigation.buttonColor,transform:"scale(1)"})),oR=t=>{const e=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(t.mode||"mercator");te.useEffect(()=>{e.map?.map.getProjection?.()?.type!==r&&e.map?.setProjection({type:r})},[e.map]);const i=()=>{if(!e.map)return;const a=r==="globe"?"mercator":"globe";e.map.setProjection({type:a}),n(a)};return J.jsx(J.Fragment,{children:J.jsx(HMe,{variant:"navtools",onClick:i,style:t.style,children:r==="globe"?J.jsx(qMe,{"data-testid":"PublicIcon",sx:{fontSize:{xs:"1.4em",md:"1em"}}}):J.jsx($Me,{"data-testid":"MapIcon",sx:{fontSize:{xs:"1.4em",md:"1em"}}})})})};try{oR.displayName="MlGlobeButton",oR.__docgenInfo={description:"",displayName:"MlGlobeButton",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},style:{defaultValue:null,description:"Style object to adjust css definitions of the component.",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},mode:{defaultValue:null,description:"Initial projection mode of the map.",name:"mode",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"globe"'},{value:'"mercator"'}]}}}}}catch{}const sR=t=>{const e=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(0),i=kx(f=>f.breakpoints.down("md")),a=Nc();te.useEffect(()=>{e.map&&(e.map.on("pitchend",()=>{e.map&&n(e.map.getPitch())},e.componentId),n(e.map.getPitch()))},[e.map,t.mapId]);const s=te.useCallback(()=>{e.map&&e.map.easeTo({zoom:e.map.getZoom()+.5})},[e.map]),o=te.useCallback(()=>{e.map&&e.map.easeTo({zoom:e.map.getZoom()-.5})},[e.map]),c=te.useCallback(()=>{if(!e.map)return;n(e.map.getPitch());const f=e.map.getPitch()!==0?0:60;e.map.easeTo({pitch:f})},[e.map]);return J.jsxs(Jo,{sx:{zIndex:501,position:"absolute",display:"flex",flexDirection:"column",right:i?"15px":"25px",bottom:i?"20px":"40px",...i?{margin:"80px 10px 50px 10px"}:{marginTop:"50px"},...t.sx},children:[J.jsx(aR,{}),t.show3DButton&&J.jsx(ta,{variant:"navtools",onClick:c,sx:{color:f=>f.palette.navigation.buttonColor},children:r<29?"2D":"3D"}),t.showGlobeButton&&J.jsx(oR,{}),t.showFollowGpsButton&&J.jsx(zk,{}),t.showCenterLocationButton&&J.jsx(HM,{}),J.jsx(UM,{orientation:"vertical",sx:{border:"none",Button:{minWidth:"20px !important",color:a.palette.navigation.buttonColor},"Button:hover":{border:"none"}},children:t.showZoomButtons&&J.jsxs(J.Fragment,{children:[J.jsx(ta,{variant:"navtools",onClick:s,sx:{borderBottomLeftRadius:0,borderBottomRightRadius:0,position:"relative"},children:J.jsx(BMe,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})}),J.jsx(Uf,{sx:{backgroundColor:"#fff"},children:J.jsx(VM,{sx:{marginLeft:"6px",marginRight:"6px"}})}),J.jsx(ta,{variant:"navtools",onClick:o,sx:{margin:0,borderTopLeftRadius:0,borderTopRightRadius:0},children:J.jsx(zMe,{sx:{fontSize:{xs:"1.4em",md:"1em"}}})})]})}),t.children&&gt.cloneElement(t.children,{})]})};try{sR.displayName="MlNavigationTools",sR.__docgenInfo={description:"",displayName:"MlNavigationTools",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},show3DButton:{defaultValue:null,description:"Show 3D button",name:"show3DButton",required:!1,type:{name:"boolean | undefined"}},showGlobeButton:{defaultValue:null,description:"Show global button",name:"showGlobeButton",required:!1,type:{name:"boolean | undefined"}},showZoomButtons:{defaultValue:null,description:"Show zoom button",name:"showZoomButtons",required:!1,type:{name:"boolean | undefined"}},showFollowGpsButton:{defaultValue:null,description:"Show follow GPS button",name:"showFollowGpsButton",required:!1,type:{name:"boolean | undefined"}},showCenterLocationButton:{defaultValue:null,description:"Show center on current position button",name:"showCenterLocationButton",required:!1,type:{name:"boolean | undefined"}},children:{defaultValue:null,description:"Additional JSX Elements to be rendered below MlNavigationTools buttons",name:"children",required:!1,type:{name:"Element | undefined"}},sx:{defaultValue:null,description:"Style attribute for NavigationTools container",name:"sx",required:!1,type:{name:"SxProps | undefined"}},mediaIsMobile:{defaultValue:null,description:"Style attribute for NavigationTools container",name:"mediaIsMobile",required:!1,type:{name:"boolean | undefined"}}}}}catch{}const kE=t=>(wp({idPrefix:"MlLayer-",layerId:t.layerId,mapId:t.mapId,geojson:t.geojson||void 0,options:{type:"background",paint:{...t?.options?.type&&t.options.type!=="background"?{}:{"background-color":"rgba(0,0,0,0)"}},...t.options},insertBeforeLayer:t.insertBeforeLayer}),J.jsx(J.Fragment,{}));try{kE.displayName="MlLayer",kE.__docgenInfo={description:"Basic layer component that create a layer in a MapLibre-gl instance and keeps it updated according to it attribute configuration.",displayName:"MlLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the layer that will be added by this component to the maplibre-gl instance",name:"layerId",required:!1,type:{name:"string | undefined"}},options:{defaultValue:null,description:"Javascript object that is passed the addLayer command as first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}}}}}catch{}const iq=t=>{const e=te.useRef(0),r=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[n,i]=te.useState(0),[a,s]=te.useState(""),o=te.useCallback(()=>{if(!r.map||r.map?.map.getZoom()===e.current)return;e.current=r.map?.map.getZoom();const m=t.maxWidth||100,b=r.map.map._container.clientHeight/2,x=r.map.map.unproject([0,b]),E=r.map.map.unproject([m,b]),T=x.distanceTo(E);if(t.unit==="imperial"){const A=3.2808*T;if(A>5280){const R=A/5280;c(m,R,r.map.map._getUIString("ScaleControl.Miles"))}else c(m,A,r.map.map._getUIString("ScaleControl.Feet"))}else if(t.unit==="nautical"){const A=T/1852;c(m,A,r.map.map._getUIString("ScaleControl.NauticalMiles"))}else T>=1e3?c(m,T/1e3,r.map.map._getUIString("ScaleControl.Kilometers")):c(m,T,r.map.map._getUIString("ScaleControl.Meters"))},[r.map,t.unit,t.maxWidth]);te.useEffect(()=>{if(!r.map)return;const m=o;return r.map.on("move",m,r.componentId),o(),()=>{r.map?.map.off("move",m)}},[r.map,o]);const c=(m,b,x)=>{const E=d(b),T=E/b;i(m*T),s(E+"&nbsp;"+x)},f=m=>{const b=Math.pow(10,Math.ceil(-Math.log(m)/Math.LN10));return Math.round(m*b)/b},d=m=>{const b=Math.pow(10,`${Math.floor(m)}`.length-1);let x=m/b;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:x>=1?1:f(x),b*x};return J.jsx(J.Fragment,{children:J.jsx("div",{style:{backgroundColor:"hsla(0,0%,100%,.75)",fontSize:"10px",border:"2px solid #333",borderTop:"#333",padding:"0 5px",color:"#333",boxSizing:"border-box",width:n+"px",fontFamily:"sans-serif"},dangerouslySetInnerHTML:{__html:a}})})};try{iq.displayName="MlScaleReference",iq.__docgenInfo={description:"",displayName:"MlScaleReference",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"number | undefined"}},unit:{defaultValue:null,description:"",name:"unit",required:!1,type:{name:"string | undefined"}}}}}catch{}var dP,aq;function GMe(){if(aq)return dP;aq=1;function t(r,n){var i=r.getCenter(),a=r.getZoom(),s=r.getBearing(),o=r.getPitch();n.forEach(function(c){c.jumpTo({center:i,zoom:a,bearing:s,pitch:o})})}function e(){var r,n=arguments.length;if(n===1)r=arguments[0];else{r=[];for(var i=0;i<n;i++)r.push(arguments[i])}var a=[];r.forEach(function(f,d){a[d]=c.bind(null,f,r.filter(function(m,b){return b!==d}))});function s(){r.forEach(function(f,d){f.on("move",a[d])})}function o(){r.forEach(function(f,d){f.off("move",a[d])})}function c(f,d){o(),t(f,d),s()}return s(),function(){o(),a=[],r=[]}}return dP=e,dP}var WMe=GMe();const YQ=Cd(WMe),oq=t=>{const e=te.useContext(Lg),r=te.useRef(!1),n=te.useRef(()=>{}),[i,a]=te.useState(50),s=te.useRef(50),[o,c]=te.useState(50),f=te.useRef(50),d=te.useMemo(()=>t.magnifierRadius||200,[t.magnifierRadius]),m=te.useCallback(()=>!(!t.map1Id||!t.map2Id||!e.getMap(t.map1Id)||!e.getMap(t.map2Id)),[t,e]),b=te.useRef(()=>{m()&&E({clientX:s.current,clientY:f.current})});te.useEffect(()=>{window.addEventListener("resize",b.current);const N=b.current;return()=>{window.removeEventListener("resize",N),n.current()}},[]);const x=te.useCallback(N=>{if(!m())return;const O=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let U=typeof N.touches<"u"&&typeof N.touches[0]<"u"?N.touches[0].clientX:0,j=typeof N.touches<"u"&&typeof N.touches[0]<"u"?N.touches[0].clientY:0;U-=O.x,j-=O.y;const H=parseFloat((U/O.width*100).toFixed(2)),W=parseFloat((j/O.height*100).toFixed(2));(s.current!==H||f.current!==W)&&(a(H),s.current=H,c(W),f.current=W,e.maps[t.map2Id].getContainer().style.clipPath=`circle(${d}px at `+s.current*O.width/100+"px "+f.current*O.height/100+"px)")},[e,m,t,d]),E=te.useCallback(N=>{if(!m())return;const O=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let U=N.clientX,j=N.clientY;U-=O.x,j-=O.y;const H=parseFloat((U/O.width*100).toFixed(2)),W=parseFloat((j/O.height*100).toFixed(2));(s.current!==H||f.current!==W)&&(a(H),s.current=H,c(W),f.current=W,e.maps[t.map2Id].getContainer().style.clipPath=`circle(${d}px at `+s.current*O.width/100+"px "+f.current*O.height/100+"px)")},[e,m,t,d]);te.useEffect(()=>{!m()||r.current||(r.current=!0,n.current=YQ(e.getMap(t.map1Id).map,e.getMap(t.map2Id).map),E({clientX:s.current,clientY:f.current}),E({clientX:e.maps[t.map1Id].getCanvas().clientWidth/2,clientY:e.maps[t.map1Id].getCanvas().clientHeight/2}))},[e.mapIds,e,m,t,E]);const T=N=>{N.nativeEvent instanceof TouchEvent?(document.addEventListener("touchmove",x),document.addEventListener("touchend",A)):(document.addEventListener("mousemove",E),document.addEventListener("mouseup",R))},A=()=>{document.removeEventListener("touchmove",x),document.removeEventListener("touchend",A)},R=()=>{document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",R)},F=N=>{const O=new WheelEvent(N.type,N);e.map?.map.getCanvas().dispatchEvent(O)};return J.jsx("div",{style:{position:"absolute",left:i+"%",top:o+"%",borderRadius:"50%",width:d*2-2+"px",height:d*2-2+"px",background:"rgba(0,0,0,0)",border:"2px solid #fafafa",boxShadow:"1px 2px 2px rgba(19, 19, 19, .5), inset 1px 1px 1px rgba(19, 19, 19, .2)",cursor:"pointer",zIndex:"110",marginLeft:d*-1-1+"px",marginTop:d*-1-1+"px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none",...t.magnifierStyle},onTouchStart:T,onMouseDown:T,onWheel:F})};try{oq.displayName="MlLayerMagnify",oq.__docgenInfo={description:`
Hides the MapLibreMap referenced by props.map2Id except for the "magnifier"-circle that reveals
the map and can be dragged around on top of the MapLibreMap referenced by props.map1Id`,displayName:"MlLayerMagnify",props:{map1Id:{defaultValue:null,description:"Id of the first MapLibre instance",name:"map1Id",required:!0,type:{name:"string"}},map2Id:{defaultValue:null,description:"Id of the second MapLibre instance",name:"map2Id",required:!0,type:{name:"string"}},magnifierRadius:{defaultValue:null,description:'Size of the "magnifier"-circle',name:"magnifierRadius",required:!1,type:{name:"number | undefined"}},magnifierStyle:{defaultValue:null,description:"object (React.CSSProperties) that is added to the magnifier default style",name:"magnifierStyle",required:!0,type:{name:"CSSProperties | undefined"}}}}}catch{}const lR=({className:t="",title:e,onClick:r,style:n,color:i})=>J.jsxs("svg",{viewBox:"0 0 47 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,onClick:r,role:e?"img":"presentation","aria-hidden":!e,style:n,color:i,children:[J.jsx("path",{d:"M29.5 21.25L35.75 15L29.5 8.75V21.25Z",fill:"#009EE0"}),J.jsx("path",{d:"M17.5 8.75L11.25 15L17.5 21.25V8.75Z",fill:"#009EE0"})]});try{lR.displayName="SwipeIcon",lR.__docgenInfo={description:"",displayName:"SwipeIcon",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"(() => void) | undefined"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties | undefined"}},color:{defaultValue:null,description:"",name:"color",required:!1,type:{name:"string | undefined"}}}}}catch{}const sq=t=>{const e=te.useContext(Lg),r=te.useRef(!1),[n,i]=te.useState(50),a=te.useRef(0),s=te.useRef(()=>{}),o=te.useCallback(()=>!(!t.map1Id||!t.map2Id||!e.getMap(t.map1Id)||!e.getMap(t.map2Id)),[e,t.map1Id,t.map2Id]),c=()=>{s.current()},f=te.useCallback(T=>{if(!o())return;const A=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let R=typeof T.touches<"u"&&typeof T.touches[0]<"u"?T.touches[0].clientX:0;R-=A.x;const F=parseFloat((R/A.width*100).toFixed(2));if(a.current!==F){i(F),a.current=F;const N="rect(0, "+a.current*A.width/100+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=N}},[e,o,t.map1Id,t.map2Id]),d=te.useCallback(T=>{if(!o())return;const A=e.maps[t.map1Id].getCanvas().getBoundingClientRect();let R=T.clientX;R-=A.x;const F=parseFloat((R/A.width*100).toFixed(2));if(a.current!==F){i(F),a.current=F;const N="rect(0, "+a.current*A.width/100+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=N}},[e,o,t.map1Id,t.map2Id]);te.useEffect(()=>c,[]),te.useEffect(()=>{!o()||r.current||(r.current=!0,s.current=YQ(e.getMap(t.map1Id).map,e.getMap(t.map2Id).map),d({clientX:e.maps[t.map1Id].getCanvas().clientWidth/2}))},[e.mapIds,e,t,d,o]);const m=T=>{window?.TouchEvent&&T.nativeEvent instanceof window.TouchEvent?(document.addEventListener("touchmove",f),document.addEventListener("touchend",b)):(document.addEventListener("mousemove",d),document.addEventListener("mouseup",x))},b=()=>{document.removeEventListener("touchmove",f),document.removeEventListener("touchend",b)},x=()=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",x)};function E(){const T=parseFloat(e.maps[t.map2Id].getContainer().style.clip.split(",")[1].replace("px","")),A=e.maps[t.map1Id].getCanvas().getBoundingClientRect().width;if(T<A){const R=parseFloat((T/A*100).toFixed(2));i(R)}else{const R="rect(0, "+A/2+"px, 999em, 0)";e.maps[t.map2Id].getContainer().style.clip=R,i(50)}}return te.useEffect(()=>(window.addEventListener("resize",E),()=>{window.removeEventListener("resize",E)}),[e]),J.jsx("div",{style:{position:"absolute",left:n+"%",top:"50%",borderRadius:"50%",width:"65px",height:"65px",background:"rgba(234, 235, 241, 0.75)",border:"2px solid rgba(0, 158, 224, 0.75)",cursor:"pointer",zIndex:"110",marginLeft:"-35px",marginTop:"-50px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none",...t.buttonStyle},onTouchStart:m,onMouseDown:m,children:J.jsx(lR,{color:"#0066ff",style:{width:"65px",height:"65px",justifyContent:"center",zIndex:1100}})})};try{sq.displayName="MlLayerSwipe",sq.__docgenInfo={description:"creates a split view of 2 synchronised maplibre instances",displayName:"MlLayerSwipe",props:{map1Id:{defaultValue:null,description:"Id of the first MapLibre instance.",name:"map1Id",required:!0,type:{name:"string"}},map2Id:{defaultValue:null,description:"Id of the second MapLibre instance.",name:"map2Id",required:!0,type:{name:"string"}},buttonStyle:{defaultValue:null,description:"object (React.CSSProperties) that is added to the button default style",name:"buttonStyle",required:!0,type:{name:"CSSProperties | undefined"}}}}}catch{}const ZQ=function(t,e,r,n,i,a,s,o,c){if(typeof n.current[a.current]<"u"){const f=a.current+1===n.current.length?t.geojson:Su([...i.current,...n.current[a.current].geometry.coordinates]);c(f),typeof t.onTransitionFrame=="function"&&t.onTransitionFrame(f),a.current++,r.current&&a.current<n.current.length?o.current=setTimeout(()=>ZQ(...arguments),s):(typeof t.onTransitionEnd=="function"&&t.onTransitionEnd(t.geojson),r.current=!1)}},XMe=(t,e,r,n,i,a,s,o,c,f)=>{const d=[],m=[];let b=[],x=[];e.current=[];const E=i.current||{geometry:{type:"LineString",coordinates:[]},properties:{},type:"Feature"},T=t.geojson;let A=T,R=E,F=!1;if(typeof A.geometry>"u"&&typeof R.geometry<"u"&&R.geometry.coordinates.length>1)A=Su(R.geometry.coordinates.slice(0,2));else if(typeof R.geometry>"u"&&typeof A.geometry<"u"&&A.geometry.coordinates.length>1)R=Su(A.geometry.coordinates.slice(0,2));else if(typeof R.geometry>"u"&&typeof A.geometry>"u")return;if(A.geometry.coordinates.length<R.geometry.coordinates.length&&(A=E,R=T,F=!0),A&&R)for(let se=0,fe=A.geometry.coordinates.length;se<fe;se++)typeof R.geometry.coordinates[se]<"u"&&A.geometry.coordinates[se][0]===R.geometry.coordinates[se][0]&&A.geometry.coordinates[se][1]===R.geometry.coordinates[se][1]?e.current.push(A.geometry.coordinates[se]):(typeof A.geometry.coordinates[se]<"u"&&m.push(A.geometry.coordinates[se]),typeof R.geometry.coordinates[se]<"u"&&d.push(R.geometry.coordinates[se]));if(F?(b=d,x=m):(b=m,x=d),b.length<2&&x<2)return;const N=t.transitionTime/a,O=x.length>1?Math.round(Yb(Su(x))):0,U=b.length>1?Math.round(Yb(Su(b))):0,j=U+O,H=O/j,W=Math.round(N*H),X=Math.round(O/W*100)/100,oe=U/j,ee=Math.round(N*oe),G=Math.round(U/ee*100)/100;let ae;ae=[...lq(x,X,W)],ae.reverse(),ae=[...ae,...lq(b,G,ee)],ae.push(T),r.current=ae,s.current=1,n.current=!0,c.current=setTimeout(()=>ZQ(t,o,n,r,e,s,a,c,f),a)},lq=(t,e,r)=>{const n=[];if(t.length>1){const i=gSe(Su(t),e);let a=i.features[0];for(let s=0;s<r&&(n.push(a),typeof i.features[s]<"u");s++)a=Su([...a.geometry.coordinates,...i.features[s].geometry.coordinates])}return n},YMe=50,uq=t=>{const{geojson:e,...r}=t,n=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),i=te.useRef(!1),a=te.useRef(null),s=te.useRef(!1),o=te.useRef(void 0),c=te.useRef(!1),f=te.useRef([]),d=te.useRef([]),[m,b]=te.useState(xp([]));te.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]);const x=te.useCallback(()=>{XMe(t,d,f,s,a,YMe,c,n.map,o,b)},[t,n.map]);te.useEffect(()=>{!n.map||!i.current||(typeof t.transitionTime<"u"&&t.type==="line"&&a.current&&(s.current=!1,c.current=!1,f.current=[],d.current=[],x()),t.geojson&&(a.current=t.geojson))},[n.map,x,t]);const E=te.useCallback(()=>{t.type==="line"&&typeof t.transitionTime<"u"&&t.transitionTime&&typeof t.geojson<"u"&&JSON.stringify(a.current)!==JSON.stringify(t.geojson)&&(x(),a.current=t.geojson)},[t,x]);return te.useEffect(()=>{!n.mapIsReady||!t.geojson||(i.current=!0,E())},[n.mapIsReady,E,t]),J.jsx(J.Fragment,{children:J.jsx(Dc,{...r,geojson:m})})};try{uq.displayName="MlTransitionGeoJsonLayer",uq.__docgenInfo={description:'Adds source and layer of types "line", "fill" or "circle" to display GeoJSON data on the map.',displayName:"MlTransitionGeoJsonLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.
This layer will not be added to the maplibre-gl instance until a layer with an
id that matches the value of insertBeforeLayer is created.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of the new layer and source that are added to the MapLibre instance",name:"layerId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!1,type:{name:"Feature<Geometry, GeoJsonProperties> | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}},type:{defaultValue:null,description:`Type of the layer that will be added to the MapLibre instance.
All types from LayerSpecification union type are supported except the type from
RasterLayerSpecification`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"symbol"'},{value:'"fill"'},{value:'"background"'},{value:'"circle"'},{value:'"line"'},{value:'"heatmap"'},{value:'"fill-extrusion"'},{value:'"hillshade"'},{value:'"color-relief"'}]}},paint:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.paint property instead. This will be removed in the next major release.
Paint property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All paint types from LayerSpecification union type are supported except the paint type from
RasterLayerSpecification`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | ... 8 more ... | undefined'}},layout:{defaultValue:null,description:`@deprecated The property should not be used. Please use the options.layout property instead. This will be removed in the next major release.
Layout property object, that is passed to the addLayer call.
Possible props depend on the layer type.
See https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/
Some examples are:
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill
All layout types from LayerSpecification union type are supported except the layout type from
RasterLayerSpecification`,name:"layout",required:!1,type:{name:'{ "circle-sort-key"?: DataDrivenPropertyValueSpecification<number> | undefined; visibility?: VisibilitySpecification | undefined; } | ... 9 more ... | undefined'}},options:{defaultValue:null,description:"Javascript object that is spread into the addLayer commands first parameter.",name:"options",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},defaultPaintOverrides:{defaultValue:null,description:'Javascript object with optional properties "fill", "line", "circle" to override implicit layer type default paint properties.',name:"defaultPaintOverrides",required:!1,type:{name:'{ circle?: { "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | undefined; fill?: { ...; } | undefined; line?: { ...; } | undefined...'}},labelProp:{defaultValue:null,description:"Property name in the GeoJSON object to be used as a label.",name:"labelProp",required:!1,type:{name:"string | undefined"}},labelOptions:{defaultValue:null,description:"Label configuration options.",name:"labelOptions",required:!1,type:{name:"Partial<LayerSpecification & { source?: string | GeoJSONSourceSpecification | undefined; id?: string | undefined; filter?: FilterSpecification | undefined; }> | undefined"}},onHover:{defaultValue:null,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},transitionTime:{defaultValue:null,description:"",name:"transitionTime",required:!1,type:{name:"number | undefined"}}}}}catch{}const ZMe=(t="top")=>{switch(t){case"bottom":return"translate(-50%, 0%)";case"left":return"translate(-100%, -50%)";case"right":return"translate(0%, -50%)";case"top-left":return"translate(-100%, -100%)";case"top-right":return"translate(0%, -100%)";case"bottom-left":return"translate(-100%, 0%)";case"bottom-right":return"translate(0%, 0%)";default:case"top":return"translate(-50%, -100%)"}};function KMe(t,e,r){const n=parseInt(String(r?.width||14),10),i=parseInt(String(r?.height||14),10),a={};switch(t){case"bottom":a.marginTop=`${e}px`;break;case"left":a.marginLeft=`-${e}px`;break;case"right":a.marginLeft=`${n+e}px`;break;case"top-left":a.marginTop=`-${i+e}px`,a.marginLeft=`-${e}px`;break;case"top-right":a.marginTop=`-${i+e}px`,a.marginLeft=`${n+e}px`;break;case"bottom-left":a.marginTop=`${e}px`,a.marginLeft=`-${e}px`;break;case"bottom-right":a.marginTop=`${e}px`,a.marginLeft=`${n+e}px`;break;case"top":default:a.marginTop=`-${i+e}px`;break}return a}const uR=({passEventsThrough:t=!0,contentOffset:e=5,...r})=>{const n=ga({mapId:r.mapId,waitForLayer:r.insertBeforeLayer}),[i,a]=te.useState(null),s=te.useRef(null),o=te.useRef(null);te.useEffect(()=>{if(!n.map)return;s.current=document.createElement("div");const d={...{width:"12px",height:"12px",background:"linear-gradient(135deg, rgb(186, 208, 218) 0%, rgb(96, 209, 253) 100%)",border:"1px solid rgba(255, 255, 255, 0.7)",boxShadow:"0 2px 6px rgba(90, 0, 0, 0.2), 0 0 0 2px rgba(240, 147, 251, 0.2)",borderRadius:"50%"},...r.markerStyle},m=new yM.Marker({element:s.current,anchor:"center"}).setLngLat([r.lng,r.lat]).addTo(n.map.map);a(m);const b=document.createElement("div");return Object.entries(d).forEach(([x,E])=>{b.style.setProperty(x.replace(/([A-Z])/g,"-$1").toLowerCase(),String(E))}),s.current.appendChild(b),()=>{b.remove(),m.remove(),s.current?.remove()}},[n.map,r.lng,r.lat,r.markerStyle,r.anchor]),te.useEffect(()=>{i&&i.setLngLat([r.lng,r.lat])},[i,r.lng,r.lat]);function c(){const f=o.current?.contentWindow?.document;if(f&&o.current?.parentElement){const d=f.documentElement.scrollHeight;o.current.parentElement.style.height=`${d}px`}}return s.current&&lp.createPortal(J.jsx(Jo,{sx:{position:"absolute",display:"flex",width:"300px",maxHeight:"500px",opacity:t?1:.7,zIndex:-1,transform:ZMe(r.anchor),...KMe(r.anchor,e,r.markerStyle),pointerEvents:t?"none":"auto","&:hover":{opacity:1},...r.containerStyle},children:J.jsx("iframe",{ref:o,onLoad:c,style:{width:"100%",borderStyle:"none",...r.iframeStyle},srcDoc:`<div>
	<style>
		body {
			${Object.entries(r.iframeBodyStyle||{}).map(([f,d])=>`${f.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${d};`).join(" ")}
		}
	</style>
	${r.content||""}
</div>`,sandbox:"allow-same-origin allow-popups-to-escape-sandbox allow-scripts",title:n.componentId})}),s.current)};try{uR.displayName="MlMarker",uR.__docgenInfo={description:"",displayName:"MlMarker",props:{mapId:{defaultValue:null,description:"ID of the map to add the marker to",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"Layer ID before which to insert the marker",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},lng:{defaultValue:null,description:"Longitude of the marker position",name:"lng",required:!0,type:{name:"number"}},lat:{defaultValue:null,description:"Latitude of the marker position",name:"lat",required:!0,type:{name:"number"}},content:{defaultValue:null,description:"HTML content for the marker popup",name:"content",required:!1,type:{name:"string | undefined"}},markerStyle:{defaultValue:null,description:"CSS properties to apply to the marker dot",name:"markerStyle",required:!1,type:{name:"CSSProperties | undefined"}},containerStyle:{defaultValue:null,description:"CSS properties to apply to the content container",name:"containerStyle",required:!1,type:{name:"CSSProperties | undefined"}},iframeStyle:{defaultValue:null,description:"CSS properties to apply to the iframe element",name:"iframeStyle",required:!1,type:{name:"CSSProperties | undefined"}},iframeBodyStyle:{defaultValue:null,description:"CSS properties to apply to the body of the iframe",name:"iframeBodyStyle",required:!1,type:{name:"CSSProperties | undefined"}},contentOffset:{defaultValue:{value:"5"},description:"Offset in pixels between the marker and its content",name:"contentOffset",required:!1,type:{name:"number | undefined"}},passEventsThrough:{defaultValue:{value:"true"},description:"Whether mouse events pass through the marker content",name:"passEventsThrough",required:!1,type:{name:"boolean | undefined"}},anchor:{defaultValue:null,description:"Anchor position of the marker relative to its coordinates",name:"anchor",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"bottom"'},{value:'"left"'},{value:'"right"'},{value:'"top"'},{value:'"top-left"'},{value:'"top-right"'},{value:'"bottom-left"'},{value:'"bottom-right"'}]}}}}}catch{}var ya={},tu={},cq;function A_(){if(cq)return tu;cq=1;function t(R,F,N){if(N===void 0&&(N=Array.prototype),R&&typeof N.find=="function")return N.find.call(R,F);for(var O=0;O<R.length;O++)if(r(R,O)){var U=R[O];if(F.call(void 0,U,O,R))return U}}function e(R,F){return F===void 0&&(F=Object),F&&typeof F.getOwnPropertyDescriptors=="function"&&(R=F.create(null,F.getOwnPropertyDescriptors(R))),F&&typeof F.freeze=="function"?F.freeze(R):R}function r(R,F){return Object.prototype.hasOwnProperty.call(R,F)}function n(R,F){if(R===null||typeof R!="object")throw new TypeError("target is not an object");for(var N in F)r(F,N)&&(R[N]=F[N]);return R}var i=e({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0});function a(R){return r(i,R.toLowerCase())}var s=e({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function o(R){return r(s,R.toLowerCase())}var c=e({script:!1,style:!1,textarea:!0,title:!0});function f(R){var F=R.toLowerCase();return r(c,F)&&!c[F]}function d(R){var F=R.toLowerCase();return r(c,F)&&c[F]}function m(R){return R===x.HTML}function b(R){return m(R)||R===x.XML_XHTML_APPLICATION}var x=e({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),E=Object.keys(x).map(function(R){return x[R]});function T(R){return E.indexOf(R)>-1}var A=e({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return tu.assign=n,tu.find=t,tu.freeze=e,tu.HTML_BOOLEAN_ATTRIBUTES=i,tu.HTML_RAW_TEXT_ELEMENTS=c,tu.HTML_VOID_ELEMENTS=s,tu.hasDefaultHTMLNamespace=b,tu.hasOwn=r,tu.isHTMLBooleanAttribute=a,tu.isHTMLRawTextElement=f,tu.isHTMLEscapableRawTextElement=d,tu.isHTMLMimeType=m,tu.isHTMLVoidElement=o,tu.isValidMimeType=T,tu.MIME_TYPE=x,tu.NAMESPACE=A,tu}var wv={},fq;function R3(){if(fq)return wv;fq=1;var t=A_();function e(b,x){b.prototype=Object.create(Error.prototype,{constructor:{value:b},name:{value:b.name,enumerable:!0,writable:x}})}var r=t.freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),n=Object.keys(r);function i(b){return typeof b=="number"&&b>=1&&b<=25}function a(b){return typeof b=="string"&&b.substring(b.length-r.Error.length)===r.Error}function s(b,x){i(b)?(this.name=n[b],this.message=x||""):(this.message=b,this.name=a(x)?x:r.Error),Error.captureStackTrace&&Error.captureStackTrace(this,s)}e(s,!0),Object.defineProperties(s.prototype,{code:{enumerable:!0,get:function(){var b=n.indexOf(this.name);return i(b)?b:0}}});for(var o={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},c=Object.entries(o),f=0;f<c.length;f++){var d=c[f][0];s[d]=c[f][1]}function m(b,x){this.message=b,this.locator=x,Error.captureStackTrace&&Error.captureStackTrace(this,m)}return e(m),wv.DOMException=s,wv.DOMExceptionName=r,wv.ExceptionCode=o,wv.ParseError=m,wv}var Ls={},Qi={},hq;function KQ(){if(hq)return Qi;hq=1;function t(en){try{typeof en!="function"&&(en=RegExp);var jn=new en("","u").exec("");return!!jn&&jn[0].length===2}catch{}return!1}var e=t();function r(en){if(en.source[0]!=="[")throw new Error(en+" can not be used with chars");return en.source.slice(1,en.source.lastIndexOf("]"))}function n(en,jn){if(en.source[0]!=="[")throw new Error("/"+en.source+"/ can not be used with chars_without");if(!jn||typeof jn!="string")throw new Error(JSON.stringify(jn)+" is not a valid search");if(en.source.indexOf(jn)===-1)throw new Error('"'+jn+'" is not is /'+en.source+"/");if(jn==="-"&&en.source.indexOf(jn)!==1)throw new Error('"'+jn+'" is not at the first postion of /'+en.source+"/");return new RegExp(en.source.replace(jn,""),e?"u":"")}function i(en){var jn=this;return new RegExp(Array.prototype.slice.call(arguments).map(function(Qr){var nr=typeof Qr=="string";if(nr&&jn===void 0&&Qr==="|")throw new Error("use regg instead of reg to wrap expressions with `|`!");return nr?Qr:Qr.source}).join(""),e?"mu":"m")}function a(en){if(arguments.length===0)throw new Error("no parameters provided");return i.apply(a,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var s="",o=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;e&&(o=i("[",r(o),"\\u{10000}-\\u{10FFFF}","]"));var c=/[\x20\x09\x0D\x0A]/,f=r(c),d=i(c,"+"),m=i(c,"*"),b=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;e&&(b=i("[",r(b),"\\u{10000}-\\u{10FFFF}","]"));var x=r(b),E=i("[",x,r(/[-.0-9\xB7]/),r(/[\u0300-\u036F\u203F-\u2040]/),"]"),T=i(b,E,"*"),A=i(E,"+"),R=i("&",T,";"),F=a(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),N=a(R,"|",F),O=i("%",T,";"),U=a(i('"',a(/[^%&"]/,"|",O,"|",N),"*",'"'),"|",i("'",a(/[^%&']/,"|",O,"|",N),"*","'")),j=a('"',a(/[^<&"]/,"|",N),"*",'"',"|","'",a(/[^<&']/,"|",N),"*","'"),H=n(b,":"),W=n(E,":"),X=i(H,W,"*"),oe=i(X,a(":",X),"?"),ee=i("^",oe,"$"),G=i("(",oe,")"),ae=a(/"[^"]*"|'[^']*'/),se=i(/^<\?/,"(",T,")",a(d,"(",o,"*?)"),"?",/\?>/),fe=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,pe=a('"',fe,'*"',"|","'",n(fe,"'"),"*'"),De="<!--",ye="-->",we=i(De,a(n(o,"-"),"|",i("-",n(o,"-"))),"*",ye),Te="#PCDATA",Re=a(i(/\(/,m,Te,a(m,/\|/,m,oe),"*",m,/\)\*/),"|",i(/\(/,m,Te,m,/\)/)),de=/[?*+]?/,Ee=i(/\([^>]+\)/,de),xe=a("EMPTY","|","ANY","|",Re,"|",Ee),Ne="<!ELEMENT",Fe=i(Ne,d,a(oe,"|",O),d,a(xe,"|",O),m,">"),Xe=i("NOTATION",d,/\(/,m,T,a(m,/\|/,m,T),"*",m,/\)/),Be=i(/\(/,m,A,a(m,/\|/,m,A),"*",m,/\)/),ot=a(Xe,"|",Be),Ke=a(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",ot),it=a(/#REQUIRED|#IMPLIED/,"|",a(a("#FIXED",d),"?",j)),Me=a(d,T,d,Ke,d,it),zt="<!ATTLIST",st=i(zt,d,T,Me,"*",m,">"),$e="about:legacy-compat",Jt=a('"'+$e+'"',"|","'"+$e+"'"),Ht="SYSTEM",pr="PUBLIC",_t=a(a(Ht,d,ae),"|",a(pr,d,pe,d,ae)),vr=i("^",a(a(Ht,d,"(?<SystemLiteralOnly>",ae,")"),"|",a(pr,d,"(?<PubidLiteral>",pe,")",d,"(?<SystemLiteral>",ae,")"))),br=a(d,"NDATA",d,T),lr=a(U,"|",a(_t,br,"?")),Cr="<!ENTITY",Tr=i(Cr,d,T,d,lr,m,">"),Qt=a(U,"|",_t),at=i(Cr,d,"%",d,T,d,Qt,m,">"),Pe=a(Tr,"|",at),be=i(pr,d,pe),je=i("<!NOTATION",d,T,d,a(_t,"|",be),m,">"),qe=i(m,"=",m),Ge=/1[.]\d+/,Nt=i(d,"version",qe,a("'",Ge,"'","|",'"',Ge,'"')),Et=/[A-Za-z][-A-Za-z0-9._]*/,mt=a(d,"encoding",qe,a('"',Et,'"',"|","'",Et,"'")),ct=a(d,"standalone",qe,a("'",a("yes","|","no"),"'","|",'"',a("yes","|","no"),'"')),Kt=i(/^<\?xml/,Nt,mt,"?",ct,"?",m,/\?>/),qt="<!DOCTYPE",Ir="<![CDATA[",Ar="]]>",$r=/<!\[CDATA\[/,cn=/\]\]>/,zr=i(o,"*?",cn),Rt=i($r,zr);return Qi.chars=r,Qi.chars_without=n,Qi.detectUnicodeSupport=t,Qi.reg=i,Qi.regg=a,Qi.ABOUT_LEGACY_COMPAT=$e,Qi.ABOUT_LEGACY_COMPAT_SystemLiteral=Jt,Qi.AttlistDecl=st,Qi.CDATA_START=Ir,Qi.CDATA_END=Ar,Qi.CDSect=Rt,Qi.Char=o,Qi.Comment=we,Qi.COMMENT_START=De,Qi.COMMENT_END=ye,Qi.DOCTYPE_DECL_START=qt,Qi.elementdecl=Fe,Qi.EntityDecl=Pe,Qi.EntityValue=U,Qi.ExternalID=_t,Qi.ExternalID_match=vr,Qi.Name=T,Qi.NotationDecl=je,Qi.Reference=N,Qi.PEReference=O,Qi.PI=se,Qi.PUBLIC=pr,Qi.PubidLiteral=pe,Qi.QName=oe,Qi.QName_exact=ee,Qi.QName_group=G,Qi.S=d,Qi.SChar_s=f,Qi.S_OPT=m,Qi.SYSTEM=Ht,Qi.SystemLiteral=ae,Qi.UNICODE_REPLACEMENT_CHARACTER=s,Qi.UNICODE_SUPPORT=e,Qi.XMLDecl=Kt,Qi}var dq;function JQ(){if(dq)return Ls;dq=1;var t=A_(),e=t.find,r=t.hasDefaultHTMLNamespace,n=t.hasOwn,i=t.isHTMLMimeType,a=t.isHTMLRawTextElement,s=t.isHTMLVoidElement,o=t.MIME_TYPE,c=t.NAMESPACE,f=Symbol(),d=R3(),m=d.DOMException,b=d.DOMExceptionName,x=KQ();function E(ke){if(ke!==f)throw new TypeError("Illegal constructor")}function T(ke){return ke!==""}function A(ke){return ke?ke.split(/[\t\n\f\r ]+/).filter(T):[]}function R(ke,He){return n(ke,He)||(ke[He]=!0),ke}function F(ke){if(!ke)return[];var He=A(ke);return Object.keys(He.reduce(R,{}))}function N(ke){return function(He){return ke&&ke.indexOf(He)!==-1}}function O(ke){if(!x.QName_exact.test(ke))throw new m(m.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+ke+'"')}function U(ke,He){O(He),ke=ke||null;var Tt=null,Gt=He;if(He.indexOf(":")>=0){var Ut=He.split(":");Tt=Ut[0],Gt=Ut[1]}if(Tt!==null&&ke===null)throw new m(m.NAMESPACE_ERR,"prefix is non-null and namespace is null");if(Tt==="xml"&&ke!==t.NAMESPACE.XML)throw new m(m.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if((Tt==="xmlns"||He==="xmlns")&&ke!==t.NAMESPACE.XMLNS)throw new m(m.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(ke===t.NAMESPACE.XMLNS&&Tt!=="xmlns"&&He!=="xmlns")throw new m(m.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[ke,Tt,Gt]}function j(ke,He){for(var Tt in ke)n(ke,Tt)&&(He[Tt]=ke[Tt])}function H(ke,He){var Tt=ke.prototype;if(!(Tt instanceof He)){let Gt=function(){};Gt.prototype=He.prototype,Gt=new Gt,j(Tt,Gt),ke.prototype=Tt=Gt}Tt.constructor!=ke&&(typeof ke!="function"&&console.error("unknown Class:"+ke),Tt.constructor=ke)}var W={},X=W.ELEMENT_NODE=1,oe=W.ATTRIBUTE_NODE=2,ee=W.TEXT_NODE=3,G=W.CDATA_SECTION_NODE=4,ae=W.ENTITY_REFERENCE_NODE=5,se=W.ENTITY_NODE=6,fe=W.PROCESSING_INSTRUCTION_NODE=7,pe=W.COMMENT_NODE=8,De=W.DOCUMENT_NODE=9,ye=W.DOCUMENT_TYPE_NODE=10,we=W.DOCUMENT_FRAGMENT_NODE=11,Te=W.NOTATION_NODE=12,Re=t.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function de(ke,He){if(He.length<ke.length)return de(He,ke);var Tt=null;for(var Gt in ke){if(ke[Gt]!==He[Gt])return Tt;Tt=ke[Gt]}return Tt}function Ee(ke){return ke.guid||(ke.guid=Math.random()),ke.guid}function xe(){}xe.prototype={length:0,item:function(ke){return ke>=0&&ke<this.length?this[ke]:null},toString:function(ke){for(var He=[],Tt=0;Tt<this.length;Tt++)nr(this[Tt],He,ke);return He.join("")},filter:function(ke){return Array.prototype.filter.call(this,ke)},indexOf:function(ke){return Array.prototype.indexOf.call(this,ke)}},xe.prototype[Symbol.iterator]=function(){var ke=this,He=0;return{next:function(){return He<ke.length?{value:ke[He++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function Ne(ke,He){this._node=ke,this._refresh=He,Fe(this)}function Fe(ke){var He=ke._node._inc||ke._node.ownerDocument._inc;if(ke._inc!==He){var Tt=ke._refresh(ke._node);if(Kn(ke,"length",Tt.length),!ke.$$length||Tt.length<ke.$$length)for(var Gt=Tt.length;Gt in ke;Gt++)n(ke,Gt)&&delete ke[Gt];j(Tt,ke),ke._inc=He}}Ne.prototype.item=function(ke){return Fe(this),this[ke]||null},H(Ne,xe);function Xe(){}function Be(ke,He){for(var Tt=0;Tt<ke.length;){if(ke[Tt]===He)return Tt;Tt++}}function ot(ke,He,Tt,Gt){if(Gt?He[Be(He,Gt)]=Tt:(He[He.length]=Tt,He.length++),ke){Tt.ownerElement=ke;var Ut=ke.ownerDocument;Ut&&(Gt&&Ht(Ut,ke,Gt),Jt(Ut,ke,Tt))}}function Ke(ke,He,Tt){var Gt=Be(He,Tt);if(Gt>=0){for(var Ut=He.length-1;Gt<=Ut;)He[Gt]=He[++Gt];if(He.length=Ut,ke){var Xr=ke.ownerDocument;Xr&&Ht(Xr,ke,Tt),Tt.ownerElement=null}}}Xe.prototype={length:0,item:xe.prototype.item,getNamedItem:function(ke){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(ke=ke.toLowerCase());for(var He=0;He<this.length;){var Tt=this[He];if(Tt.nodeName===ke)return Tt;He++}return null},setNamedItem:function(ke){var He=ke.ownerElement;if(He&&He!==this._ownerElement)throw new m(m.INUSE_ATTRIBUTE_ERR);var Tt=this.getNamedItemNS(ke.namespaceURI,ke.localName);return Tt===ke?ke:(ot(this._ownerElement,this,ke,Tt),Tt)},setNamedItemNS:function(ke){return this.setNamedItem(ke)},removeNamedItem:function(ke){var He=this.getNamedItem(ke);if(!He)throw new m(m.NOT_FOUND_ERR,ke);return Ke(this._ownerElement,this,He),He},removeNamedItemNS:function(ke,He){var Tt=this.getNamedItemNS(ke,He);if(!Tt)throw new m(m.NOT_FOUND_ERR,ke?ke+" : "+He:He);return Ke(this._ownerElement,this,Tt),Tt},getNamedItemNS:function(ke,He){ke||(ke=null);for(var Tt=0;Tt<this.length;){var Gt=this[Tt];if(Gt.localName===He&&Gt.namespaceURI===ke)return Gt;Tt++}return null}},Xe.prototype[Symbol.iterator]=function(){var ke=this,He=0;return{next:function(){return He<ke.length?{value:ke[He++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function it(){}it.prototype={hasFeature:function(ke,He){return!0},createDocument:function(ke,He,Tt){var Gt=o.XML_APPLICATION;ke===c.HTML?Gt=o.XML_XHTML_APPLICATION:ke===c.SVG&&(Gt=o.XML_SVG_IMAGE);var Ut=new $e(f,{contentType:Gt});if(Ut.implementation=this,Ut.childNodes=new xe,Ut.doctype=Tt||null,Tt&&Ut.appendChild(Tt),He){var Xr=Ut.createElementNS(ke,He);Ut.appendChild(Xr)}return Ut},createDocumentType:function(ke,He,Tt,Gt){O(ke);var Ut=new qt(f);return Ut.name=ke,Ut.nodeName=ke,Ut.publicId=He||"",Ut.systemId=Tt||"",Ut.internalSubset=Gt||"",Ut.childNodes=new xe,Ut},createHTMLDocument:function(ke){var He=new $e(f,{contentType:o.HTML});if(He.implementation=this,He.childNodes=new xe,ke!==!1){He.doctype=this.createDocumentType("html"),He.doctype.ownerDocument=He,He.appendChild(He.doctype);var Tt=He.createElement("html");He.appendChild(Tt);var Gt=He.createElement("head");if(Tt.appendChild(Gt),typeof ke=="string"){var Ut=He.createElement("title");Ut.appendChild(He.createTextNode(ke)),Gt.appendChild(Ut)}Tt.appendChild(He.createElement("body"))}return He}};function Me(ke){E(ke)}Me.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var ke=this.getRootNode();return ke&&ke.nodeType===ke.DOCUMENT_NODE},contains:function(ke){if(!ke)return!1;var He=ke;do{if(this===He)return!0;He=ke.parentNode}while(He);return!1},getRootNode:function(ke){var He=this;do{if(!He.parentNode)return He;He=He.parentNode}while(He)},isEqualNode:function(ke){if(!ke||this.nodeType!==ke.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==ke.name||this.publicId!==ke.publicId||this.systemId!==ke.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==ke.namespaceURI||this.prefix!==ke.prefix||this.localName!==ke.localName||this.attributes.length!==ke.attributes.length)return!1;for(var He=0;He<this.attributes.length;He++){var Tt=this.attributes.item(He);if(!Tt.isEqualNode(ke.getAttributeNodeNS(Tt.namespaceURI,Tt.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==ke.namespaceURI||this.localName!==ke.localName||this.value!==ke.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==ke.target||this.data!==ke.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==ke.data)return!1;break}if(this.childNodes.length!==ke.childNodes.length)return!1;for(var He=0;He<this.childNodes.length;He++)if(!this.childNodes[He].isEqualNode(ke.childNodes[He]))return!1;return!0},isSameNode:function(ke){return this===ke},insertBefore:function(ke,He){return qe(this,ke,He)},replaceChild:function(ke,He){qe(this,ke,He,je),He&&this.removeChild(He)},removeChild:function(ke){return _t(this,ke)},appendChild:function(ke){return this.insertBefore(ke,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(ke){return ln(this.ownerDocument||this,this,ke)},normalize:function(){for(var ke=this.firstChild;ke;){var He=ke.nextSibling;He&&He.nodeType==ee&&ke.nodeType==ee?(this.removeChild(He),ke.appendData(He.data)):(ke.normalize(),ke=He)}},isSupported:function(ke,He){return this.ownerDocument.implementation.hasFeature(ke,He)},lookupPrefix:function(ke){for(var He=this;He;){var Tt=He._nsMap;if(Tt){for(var Gt in Tt)if(n(Tt,Gt)&&Tt[Gt]===ke)return Gt}He=He.nodeType==oe?He.ownerDocument:He.parentNode}return null},lookupNamespaceURI:function(ke){for(var He=this;He;){var Tt=He._nsMap;if(Tt&&n(Tt,ke))return Tt[ke];He=He.nodeType==oe?He.ownerDocument:He.parentNode}return null},isDefaultNamespace:function(ke){var He=this.lookupPrefix(ke);return He==null},compareDocumentPosition:function(ke){if(this===ke)return 0;var He=ke,Tt=this,Gt=null,Ut=null;if(He instanceof Nt&&(Gt=He,He=Gt.ownerElement),Tt instanceof Nt&&(Ut=Tt,Tt=Ut.ownerElement,Gt&&He&&Tt===He))for(var Xr=0,Ln;Ln=Tt.attributes[Xr];Xr++){if(Ln===Gt)return Re.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+Re.DOCUMENT_POSITION_PRECEDING;if(Ln===Ut)return Re.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+Re.DOCUMENT_POSITION_FOLLOWING}if(!He||!Tt||Tt.ownerDocument!==He.ownerDocument)return Re.DOCUMENT_POSITION_DISCONNECTED+Re.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(Ee(Tt.ownerDocument)>Ee(He.ownerDocument)?Re.DOCUMENT_POSITION_FOLLOWING:Re.DOCUMENT_POSITION_PRECEDING);if(Ut&&He===Tt)return Re.DOCUMENT_POSITION_CONTAINS+Re.DOCUMENT_POSITION_PRECEDING;if(Gt&&He===Tt)return Re.DOCUMENT_POSITION_CONTAINED_BY+Re.DOCUMENT_POSITION_FOLLOWING;for(var Bi=[],Ci=He.parentNode;Ci;){if(!Ut&&Ci===Tt)return Re.DOCUMENT_POSITION_CONTAINED_BY+Re.DOCUMENT_POSITION_FOLLOWING;Bi.push(Ci),Ci=Ci.parentNode}Bi.reverse();for(var Fr=[],Rn=Tt.parentNode;Rn;){if(!Gt&&Rn===He)return Re.DOCUMENT_POSITION_CONTAINS+Re.DOCUMENT_POSITION_PRECEDING;Fr.push(Rn),Rn=Rn.parentNode}Fr.reverse();var Bn=de(Bi,Fr);for(var ei in Bn.childNodes){var ua=Bn.childNodes[ei];if(ua===Tt)return Re.DOCUMENT_POSITION_FOLLOWING;if(ua===He)return Re.DOCUMENT_POSITION_PRECEDING;if(Fr.indexOf(ua)>=0)return Re.DOCUMENT_POSITION_FOLLOWING;if(Bi.indexOf(ua)>=0)return Re.DOCUMENT_POSITION_PRECEDING}return 0}};function zt(ke){return ke=="<"&&"&lt;"||ke==">"&&"&gt;"||ke=="&"&&"&amp;"||ke=='"'&&"&quot;"||"&#"+ke.charCodeAt()+";"}j(W,Me),j(W,Me.prototype),j(Re,Me),j(Re,Me.prototype);function st(ke,He){if(He(ke))return!0;if(ke=ke.firstChild)do if(st(ke,He))return!0;while(ke=ke.nextSibling)}function $e(ke,He){E(ke);var Tt=He||{};this.ownerDocument=this,this.contentType=Tt.contentType||o.XML_APPLICATION,this.type=i(this.contentType)?"html":"xml"}function Jt(ke,He,Tt){ke&&ke._inc++;var Gt=Tt.namespaceURI;Gt===c.XMLNS&&(He._nsMap[Tt.prefix?Tt.localName:""]=Tt.value)}function Ht(ke,He,Tt,Gt){ke&&ke._inc++;var Ut=Tt.namespaceURI;Ut===c.XMLNS&&delete He._nsMap[Tt.prefix?Tt.localName:""]}function pr(ke,He,Tt){if(ke&&ke._inc){ke._inc++;var Gt=He.childNodes;if(Tt&&!Tt.nextSibling)Gt[Gt.length++]=Tt;else{for(var Ut=He.firstChild,Xr=0;Ut;)Gt[Xr++]=Ut,Ut=Ut.nextSibling;Gt.length=Xr,delete Gt[Gt.length]}}}function _t(ke,He){if(ke!==He.parentNode)throw new m(m.NOT_FOUND_ERR,"child's parent is not parent");var Tt=He.previousSibling,Gt=He.nextSibling;return Tt?Tt.nextSibling=Gt:ke.firstChild=Gt,Gt?Gt.previousSibling=Tt:ke.lastChild=Tt,pr(ke.ownerDocument,ke),He.parentNode=null,He.previousSibling=null,He.nextSibling=null,He}function vr(ke){return ke&&(ke.nodeType===Me.DOCUMENT_NODE||ke.nodeType===Me.DOCUMENT_FRAGMENT_NODE||ke.nodeType===Me.ELEMENT_NODE)}function br(ke){return ke&&(ke.nodeType===Me.CDATA_SECTION_NODE||ke.nodeType===Me.COMMENT_NODE||ke.nodeType===Me.DOCUMENT_FRAGMENT_NODE||ke.nodeType===Me.DOCUMENT_TYPE_NODE||ke.nodeType===Me.ELEMENT_NODE||ke.nodeType===Me.PROCESSING_INSTRUCTION_NODE||ke.nodeType===Me.TEXT_NODE)}function lr(ke){return ke&&ke.nodeType===Me.DOCUMENT_TYPE_NODE}function Cr(ke){return ke&&ke.nodeType===Me.ELEMENT_NODE}function Tr(ke){return ke&&ke.nodeType===Me.TEXT_NODE}function Qt(ke,He){var Tt=ke.childNodes||[];if(e(Tt,Cr)||lr(He))return!1;var Gt=e(Tt,lr);return!(He&&Gt&&Tt.indexOf(Gt)>Tt.indexOf(He))}function at(ke,He){var Tt=ke.childNodes||[];function Gt(Xr){return Cr(Xr)&&Xr!==He}if(e(Tt,Gt))return!1;var Ut=e(Tt,lr);return!(He&&Ut&&Tt.indexOf(Ut)>Tt.indexOf(He))}function Pe(ke,He,Tt){if(!vr(ke))throw new m(m.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+ke.nodeType);if(Tt&&Tt.parentNode!==ke)throw new m(m.NOT_FOUND_ERR,"child not in parent");if(!br(He)||lr(He)&&ke.nodeType!==Me.DOCUMENT_NODE)throw new m(m.HIERARCHY_REQUEST_ERR,"Unexpected node type "+He.nodeType+" for parent node type "+ke.nodeType)}function be(ke,He,Tt){var Gt=ke.childNodes||[],Ut=He.childNodes||[];if(He.nodeType===Me.DOCUMENT_FRAGMENT_NODE){var Xr=Ut.filter(Cr);if(Xr.length>1||e(Ut,Tr))throw new m(m.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(Xr.length===1&&!Qt(ke,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Cr(He)&&!Qt(ke,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(lr(He)){if(e(Gt,lr))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var Ln=e(Gt,Cr);if(Tt&&Gt.indexOf(Ln)<Gt.indexOf(Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!Tt&&Ln)throw new m(m.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function je(ke,He,Tt){var Gt=ke.childNodes||[],Ut=He.childNodes||[];if(He.nodeType===Me.DOCUMENT_FRAGMENT_NODE){var Xr=Ut.filter(Cr);if(Xr.length>1||e(Ut,Tr))throw new m(m.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(Xr.length===1&&!at(ke,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Cr(He)&&!at(ke,Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(lr(He)){if(e(Gt,function(Ci){return lr(Ci)&&Ci!==Tt}))throw new m(m.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var Ln=e(Gt,Cr);if(Tt&&Gt.indexOf(Ln)<Gt.indexOf(Tt))throw new m(m.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function qe(ke,He,Tt,Gt){Pe(ke,He,Tt),ke.nodeType===Me.DOCUMENT_NODE&&(Gt||be)(ke,He,Tt);var Ut=He.parentNode;if(Ut&&Ut.removeChild(He),He.nodeType===we){var Xr=He.firstChild;if(Xr==null)return He;var Ln=He.lastChild}else Xr=Ln=He;var Bi=Tt?Tt.previousSibling:ke.lastChild;Xr.previousSibling=Bi,Ln.nextSibling=Tt,Bi?Bi.nextSibling=Xr:ke.firstChild=Xr,Tt==null?ke.lastChild=Ln:Tt.previousSibling=Ln;do Xr.parentNode=ke;while(Xr!==Ln&&(Xr=Xr.nextSibling));return pr(ke.ownerDocument||ke,ke,He),He.nodeType==we&&(He.firstChild=He.lastChild=null),He}$e.prototype={implementation:null,nodeName:"#document",nodeType:De,doctype:null,documentElement:null,_inc:1,insertBefore:function(ke,He){if(ke.nodeType===we){for(var Tt=ke.firstChild;Tt;){var Gt=Tt.nextSibling;this.insertBefore(Tt,He),Tt=Gt}return ke}return qe(this,ke,He),ke.ownerDocument=this,this.documentElement===null&&ke.nodeType===X&&(this.documentElement=ke),ke},removeChild:function(ke){var He=_t(this,ke);return He===this.documentElement&&(this.documentElement=null),He},replaceChild:function(ke,He){qe(this,ke,He,je),ke.ownerDocument=this,He&&this.removeChild(He),Cr(ke)&&(this.documentElement=ke)},importNode:function(ke,He){return oi(this,ke,He)},getElementById:function(ke){var He=null;return st(this.documentElement,function(Tt){if(Tt.nodeType==X&&Tt.getAttribute("id")==ke)return He=Tt,!0}),He},createElement:function(ke){var He=new Ge(f);He.ownerDocument=this,this.type==="html"&&(ke=ke.toLowerCase()),r(this.contentType)&&(He.namespaceURI=c.HTML),He.nodeName=ke,He.tagName=ke,He.localName=ke,He.childNodes=new xe;var Tt=He.attributes=new Xe;return Tt._ownerElement=He,He},createDocumentFragment:function(){var ke=new cn(f);return ke.ownerDocument=this,ke.childNodes=new xe,ke},createTextNode:function(ke){var He=new mt(f);return He.ownerDocument=this,He.childNodes=new xe,He.appendData(ke),He},createComment:function(ke){var He=new ct(f);return He.ownerDocument=this,He.childNodes=new xe,He.appendData(ke),He},createCDATASection:function(ke){var He=new Kt(f);return He.ownerDocument=this,He.childNodes=new xe,He.appendData(ke),He},createProcessingInstruction:function(ke,He){var Tt=new zr(f);return Tt.ownerDocument=this,Tt.childNodes=new xe,Tt.nodeName=Tt.target=ke,Tt.nodeValue=Tt.data=He,Tt},createAttribute:function(ke){if(!x.QName_exact.test(ke))throw new m(m.INVALID_CHARACTER_ERR,'invalid character in name "'+ke+'"');return this.type==="html"&&(ke=ke.toLowerCase()),this._createAttribute(ke)},_createAttribute:function(ke){var He=new Nt(f);return He.ownerDocument=this,He.childNodes=new xe,He.name=ke,He.nodeName=ke,He.localName=ke,He.specified=!0,He},createEntityReference:function(ke){if(!x.Name.test(ke))throw new m(m.INVALID_CHARACTER_ERR,'not a valid xml name "'+ke+'"');if(this.type==="html")throw new m("document is an html document",b.NotSupportedError);var He=new $r(f);return He.ownerDocument=this,He.childNodes=new xe,He.nodeName=ke,He},createElementNS:function(ke,He){var Tt=U(ke,He),Gt=new Ge(f),Ut=Gt.attributes=new Xe;return Gt.childNodes=new xe,Gt.ownerDocument=this,Gt.nodeName=He,Gt.tagName=He,Gt.namespaceURI=Tt[0],Gt.prefix=Tt[1],Gt.localName=Tt[2],Ut._ownerElement=Gt,Gt},createAttributeNS:function(ke,He){var Tt=U(ke,He),Gt=new Nt(f);return Gt.ownerDocument=this,Gt.childNodes=new xe,Gt.nodeName=He,Gt.name=He,Gt.specified=!0,Gt.namespaceURI=Tt[0],Gt.prefix=Tt[1],Gt.localName=Tt[2],Gt}},H($e,Me);function Ge(ke){E(ke),this._nsMap=Object.create(null)}Ge.prototype={nodeType:X,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return this.ownerDocument.type==="html"&&this.namespaceURI===c.HTML},hasAttributes:function(){return!!(this.attributes&&this.attributes.length)},hasAttribute:function(ke){return!!this.getAttributeNode(ke)},getAttribute:function(ke){var He=this.getAttributeNode(ke);return He?He.value:null},getAttributeNode:function(ke){return this._isInHTMLDocumentAndNamespace()&&(ke=ke.toLowerCase()),this.attributes.getNamedItem(ke)},setAttribute:function(ke,He){this._isInHTMLDocumentAndNamespace()&&(ke=ke.toLowerCase());var Tt=this.getAttributeNode(ke);Tt?Tt.value=Tt.nodeValue=""+He:(Tt=this.ownerDocument._createAttribute(ke),Tt.value=Tt.nodeValue=""+He,this.setAttributeNode(Tt))},removeAttribute:function(ke){var He=this.getAttributeNode(ke);He&&this.removeAttributeNode(He)},setAttributeNode:function(ke){return this.attributes.setNamedItem(ke)},setAttributeNodeNS:function(ke){return this.attributes.setNamedItemNS(ke)},removeAttributeNode:function(ke){return this.attributes.removeNamedItem(ke.nodeName)},removeAttributeNS:function(ke,He){var Tt=this.getAttributeNodeNS(ke,He);Tt&&this.removeAttributeNode(Tt)},hasAttributeNS:function(ke,He){return this.getAttributeNodeNS(ke,He)!=null},getAttributeNS:function(ke,He){var Tt=this.getAttributeNodeNS(ke,He);return Tt?Tt.value:null},setAttributeNS:function(ke,He,Tt){var Gt=U(ke,He),Ut=Gt[2],Xr=this.getAttributeNodeNS(ke,Ut);Xr?Xr.value=Xr.nodeValue=""+Tt:(Xr=this.ownerDocument.createAttributeNS(ke,He),Xr.value=Xr.nodeValue=""+Tt,this.setAttributeNode(Xr))},getAttributeNodeNS:function(ke,He){return this.attributes.getNamedItemNS(ke,He)},getElementsByClassName:function(ke){var He=F(ke);return new Ne(this,function(Tt){var Gt=[];return He.length>0&&st(Tt,function(Ut){if(Ut!==Tt&&Ut.nodeType===X){var Xr=Ut.getAttribute("class");if(Xr){var Ln=ke===Xr;if(!Ln){var Bi=F(Xr);Ln=He.every(N(Bi))}Ln&&Gt.push(Ut)}}}),Gt})},getElementsByTagName:function(ke){var He=(this.nodeType===De?this:this.ownerDocument).type==="html",Tt=ke.toLowerCase();return new Ne(this,function(Gt){var Ut=[];return st(Gt,function(Xr){if(!(Xr===Gt||Xr.nodeType!==X))if(ke==="*")Ut.push(Xr);else{var Ln=Xr.getQualifiedName(),Bi=He&&Xr.namespaceURI===c.HTML?Tt:ke;Ln===Bi&&Ut.push(Xr)}}),Ut})},getElementsByTagNameNS:function(ke,He){return new Ne(this,function(Tt){var Gt=[];return st(Tt,function(Ut){Ut!==Tt&&Ut.nodeType===X&&(ke==="*"||Ut.namespaceURI===ke)&&(He==="*"||Ut.localName==He)&&Gt.push(Ut)}),Gt})}},$e.prototype.getElementsByClassName=Ge.prototype.getElementsByClassName,$e.prototype.getElementsByTagName=Ge.prototype.getElementsByTagName,$e.prototype.getElementsByTagNameNS=Ge.prototype.getElementsByTagNameNS,H(Ge,Me);function Nt(ke){E(ke),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}Nt.prototype.nodeType=oe,H(Nt,Me);function Et(ke){E(ke)}Et.prototype={data:"",substringData:function(ke,He){return this.data.substring(ke,ke+He)},appendData:function(ke){ke=this.data+ke,this.nodeValue=this.data=ke,this.length=ke.length},insertData:function(ke,He){this.replaceData(ke,0,He)},deleteData:function(ke,He){this.replaceData(ke,He,"")},replaceData:function(ke,He,Tt){var Gt=this.data.substring(0,ke),Ut=this.data.substring(ke+He);Tt=Gt+Tt+Ut,this.nodeValue=this.data=Tt,this.length=Tt.length}},H(Et,Me);function mt(ke){E(ke)}mt.prototype={nodeName:"#text",nodeType:ee,splitText:function(ke){var He=this.data,Tt=He.substring(ke);He=He.substring(0,ke),this.data=this.nodeValue=He,this.length=He.length;var Gt=this.ownerDocument.createTextNode(Tt);return this.parentNode&&this.parentNode.insertBefore(Gt,this.nextSibling),Gt}},H(mt,Et);function ct(ke){E(ke)}ct.prototype={nodeName:"#comment",nodeType:pe},H(ct,Et);function Kt(ke){E(ke)}Kt.prototype={nodeName:"#cdata-section",nodeType:G},H(Kt,mt);function qt(ke){E(ke)}qt.prototype.nodeType=ye,H(qt,Me);function Ir(ke){E(ke)}Ir.prototype.nodeType=Te,H(Ir,Me);function Ar(ke){E(ke)}Ar.prototype.nodeType=se,H(Ar,Me);function $r(ke){E(ke)}$r.prototype.nodeType=ae,H($r,Me);function cn(ke){E(ke)}cn.prototype.nodeName="#document-fragment",cn.prototype.nodeType=we,H(cn,Me);function zr(ke){E(ke)}zr.prototype.nodeType=fe,H(zr,Et);function Rt(){}Rt.prototype.serializeToString=function(ke,He){return en.call(ke,He)},Me.prototype.toString=en;function en(ke){var He=[],Tt=this.nodeType===De&&this.documentElement||this,Gt=Tt.prefix,Ut=Tt.namespaceURI;if(Ut&&Gt==null){var Gt=Tt.lookupPrefix(Ut);if(Gt==null)var Xr=[{namespace:Ut,prefix:null}]}return nr(this,He,ke,Xr),He.join("")}function jn(ke,He,Tt){var Gt=ke.prefix||"",Ut=ke.namespaceURI;if(!Ut||Gt==="xml"&&Ut===c.XML||Ut===c.XMLNS)return!1;for(var Xr=Tt.length;Xr--;){var Ln=Tt[Xr];if(Ln.prefix===Gt)return Ln.namespace!==Ut}return!0}function Qr(ke,He,Tt){ke.push(" ",He,'="',Tt.replace(/[<>&"\t\n\r]/g,zt),'"')}function nr(ke,He,Tt,Gt){Gt||(Gt=[]);var Ut=ke.nodeType===De?ke:ke.ownerDocument,Xr=Ut.type==="html";if(Tt)if(ke=Tt(ke),ke){if(typeof ke=="string"){He.push(ke);return}}else return;switch(ke.nodeType){case X:var Ln=ke.attributes,Bi=Ln.length,Ca=ke.firstChild,Ci=ke.tagName,Fr=Ci;if(!Xr&&!ke.prefix&&ke.namespaceURI){for(var Rn,Bn=0;Bn<Ln.length;Bn++)if(Ln.item(Bn).name==="xmlns"){Rn=Ln.item(Bn).value;break}if(!Rn)for(var ei=Gt.length-1;ei>=0;ei--){var ua=Gt[ei];if(ua.prefix===""&&ua.namespace===ke.namespaceURI){Rn=ua.namespace;break}}if(Rn!==ke.namespaceURI)for(var ei=Gt.length-1;ei>=0;ei--){var ua=Gt[ei];if(ua.namespace===ke.namespaceURI){ua.prefix&&(Fr=ua.prefix+":"+Ci);break}}}He.push("<",Fr);for(var ha=0;ha<Bi;ha++){var zn=Ln.item(ha);zn.prefix=="xmlns"?Gt.push({prefix:zn.localName,namespace:zn.value}):zn.nodeName=="xmlns"&&Gt.push({prefix:"",namespace:zn.value})}for(var ha=0;ha<Bi;ha++){var zn=Ln.item(ha);if(jn(zn,Xr,Gt)){var Na=zn.prefix||"",Wi=zn.namespaceURI;Qr(He,Na?"xmlns:"+Na:"xmlns",Wi),Gt.push({prefix:Na,namespace:Wi})}nr(zn,He,Tt,Gt)}if(Ci===Fr&&jn(ke,Xr,Gt)){var Na=ke.prefix||"",Wi=ke.namespaceURI;Qr(He,Na?"xmlns:"+Na:"xmlns",Wi),Gt.push({prefix:Na,namespace:Wi})}var ds=!Ca;if(ds&&(Xr||ke.namespaceURI===c.HTML)&&(ds=s(Ci)),ds)He.push("/>");else{if(He.push(">"),Xr&&a(Ci))for(;Ca;)Ca.data?He.push(Ca.data):nr(Ca,He,Tt,Gt.slice()),Ca=Ca.nextSibling;else for(;Ca;)nr(Ca,He,Tt,Gt.slice()),Ca=Ca.nextSibling;He.push("</",Fr,">")}return;case De:case we:for(var Ca=ke.firstChild;Ca;)nr(Ca,He,Tt,Gt.slice()),Ca=Ca.nextSibling;return;case oe:return Qr(He,ke.name,ke.value);case ee:return He.push(ke.data.replace(/[<&>]/g,zt));case G:return He.push(x.CDATA_START,ke.data,x.CDATA_END);case pe:return He.push(x.COMMENT_START,ke.data,x.COMMENT_END);case ye:var Do=ke.publicId,Ya=ke.systemId;He.push(x.DOCTYPE_DECL_START," ",ke.name),Do?(He.push(" ",x.PUBLIC," ",Do),Ya&&Ya!=="."&&He.push(" ",Ya)):Ya&&Ya!=="."&&He.push(" ",x.SYSTEM," ",Ya),ke.internalSubset&&He.push(" [",ke.internalSubset,"]"),He.push(">");return;case fe:return He.push("<?",ke.target," ",ke.data,"?>");case ae:return He.push("&",ke.nodeName,";");default:He.push("??",ke.nodeName)}}function oi(ke,He,Tt){var Gt;switch(He.nodeType){case X:Gt=He.cloneNode(!1),Gt.ownerDocument=ke;case we:break;case oe:Tt=!0;break}if(Gt||(Gt=He.cloneNode(!1)),Gt.ownerDocument=ke,Gt.parentNode=null,Tt)for(var Ut=He.firstChild;Ut;)Gt.appendChild(oi(ke,Ut,Tt)),Ut=Ut.nextSibling;return Gt}function ln(ke,He,Tt){var Gt=new He.constructor(f);for(var Ut in He)if(n(He,Ut)){var Xr=He[Ut];typeof Xr!="object"&&Xr!=Gt[Ut]&&(Gt[Ut]=Xr)}switch(He.childNodes&&(Gt.childNodes=new xe),Gt.ownerDocument=ke,Gt.nodeType){case X:var Ln=He.attributes,Bi=Gt.attributes=new Xe,Ci=Ln.length;Bi._ownerElement=Gt;for(var Fr=0;Fr<Ci;Fr++)Gt.setAttributeNode(ln(ke,Ln.item(Fr),!0));break;case oe:Tt=!0}if(Tt)for(var Rn=He.firstChild;Rn;)Gt.appendChild(ln(ke,Rn,Tt)),Rn=Rn.nextSibling;return Gt}function Kn(ke,He,Tt){ke[He]=Tt}try{if(Object.defineProperty){let ke=function(He){switch(He.nodeType){case X:case we:var Tt=[];for(He=He.firstChild;He;)He.nodeType!==7&&He.nodeType!==8&&Tt.push(ke(He)),He=He.nextSibling;return Tt.join("");default:return He.nodeValue}};Object.defineProperty(Ne.prototype,"length",{get:function(){return Fe(this),this.$$length}}),Object.defineProperty(Me.prototype,"textContent",{get:function(){return ke(this)},set:function(He){switch(this.nodeType){case X:case we:for(;this.firstChild;)this.removeChild(this.firstChild);(He||String(He))&&this.appendChild(this.ownerDocument.createTextNode(He));break;default:this.data=He,this.value=He,this.nodeValue=He}}}),Kn=function(He,Tt,Gt){He["$$"+Tt]=Gt}}}catch{}return Ls._updateLiveList=Fe,Ls.Attr=Nt,Ls.CDATASection=Kt,Ls.CharacterData=Et,Ls.Comment=ct,Ls.Document=$e,Ls.DocumentFragment=cn,Ls.DocumentType=qt,Ls.DOMImplementation=it,Ls.Element=Ge,Ls.Entity=Ar,Ls.EntityReference=$r,Ls.LiveNodeList=Ne,Ls.NamedNodeMap=Xe,Ls.Node=Me,Ls.NodeList=xe,Ls.Notation=Ir,Ls.Text=mt,Ls.ProcessingInstruction=zr,Ls.XMLSerializer=Rt,Ls}var hm={},pP={},pq;function JMe(){return pq||(pq=1,(function(t){var e=A_().freeze;t.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=e({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),t.entityMap=t.HTML_ENTITIES})(pP)),pP}var h1={},gq;function QMe(){if(gq)return h1;gq=1;var t=A_(),e=KQ(),r=R3(),n=t.isHTMLEscapableRawTextElement,i=t.isHTMLMimeType,a=t.isHTMLRawTextElement,s=t.hasOwn,o=t.NAMESPACE,c=r.ParseError,f=r.DOMException,d=0,m=1,b=2,x=3,E=4,T=5,A=6,R=7;function F(){}F.prototype={parse:function(fe,pe,De){var ye=this.domBuilder;ye.startDocument(),X(pe,pe=Object.create(null)),O(fe,pe,De,ye,this.errorHandler),ye.endDocument()}};var N=/&#?\w+;?/g;function O(fe,pe,De,ye,we){var Te=i(ye.mimeType);fe.indexOf(e.UNICODE_REPLACEMENT_CHARACTER)>=0&&we.warning("Unicode replacement character detected, source encoding issues?");function Re(qe){if(qe>65535){qe-=65536;var Ge=55296+(qe>>10),Nt=56320+(qe&1023);return String.fromCharCode(Ge,Nt)}else return String.fromCharCode(qe)}function de(qe){var Ge=qe[qe.length-1]===";"?qe:qe+";";if(!Te&&Ge!==qe)return we.error("EntityRef: expecting ;"),qe;var Nt=e.Reference.exec(Ge);if(!Nt||Nt[0].length!==Ge.length)return we.error("entity not matching Reference production: "+qe),qe;var Et=Ge.slice(1,-1);return s(De,Et)?De[Et]:Et.charAt(0)==="#"?Re(parseInt(Et.substring(1).replace("x","0x"))):(we.error("entity not found:"+qe),qe)}function Ee(qe){if(qe>it){var Ge=fe.substring(it,qe).replace(N,de);Xe&&Be(it),ye.characters(Ge,0,qe-it),it=qe}}var xe=0,Ne=0,Fe=/\r\n?|\n|$/g,Xe=ye.locator;function Be(qe,Ge){for(;qe>=Ne&&(Ge=Fe.exec(fe));)xe=Ne,Ne=Ge.index+Ge[0].length,Xe.lineNumber++;Xe.columnNumber=qe-xe+1}for(var ot=[{currentNSMap:pe}],Ke=[],it=0;;){try{var Me=fe.indexOf("<",it);if(Me<0){if(!Te&&Ke.length>0)return we.fatalError("unclosed xml tag(s): "+Ke.join(", "));if(!fe.substring(it).match(/^\s*$/)){var zt=ye.doc,st=zt.createTextNode(fe.substring(it));if(zt.documentElement)return we.error("Extra content at the end of the document");zt.appendChild(st),ye.currentElement=st}return}if(Me>it){var $e=fe.substring(it,Me);!Te&&Ke.length===0&&($e=$e.replace(new RegExp(e.S_OPT.source,"g"),""),$e&&we.error("Unexpected content outside root element: '"+$e+"'")),Ee(Me)}switch(fe.charAt(Me+1)){case"/":var Qt=fe.indexOf(">",Me+2),Jt=fe.substring(Me+2,Qt>0?Qt:void 0);if(!Jt)return we.fatalError("end tag name missing");var Ht=Qt>0&&e.reg("^",e.QName_group,e.S_OPT,"$").exec(Jt);if(!Ht)return we.fatalError('end tag name contains invalid characters: "'+Jt+'"');if(!ye.currentElement&&!ye.doc.documentElement)return;var pr=Ke[Ke.length-1]||ye.currentElement.tagName||ye.doc.documentElement.tagName||"";if(pr!==Ht[1]){var _t=Ht[1].toLowerCase();if(!Te||pr.toLowerCase()!==_t)return we.fatalError('Opening and ending tag mismatch: "'+pr+'" != "'+Jt+'"')}var vr=ot.pop();Ke.pop();var br=vr.localNSMap;if(ye.endElement(vr.uri,vr.localName,pr),br)for(var lr in br)s(br,lr)&&ye.endPrefixMapping(lr);Qt++;break;case"?":Xe&&Be(Me),Qt=ae(fe,Me,ye,we);break;case"!":Xe&&Be(Me),Qt=G(fe,Me,ye,we,Te);break;default:Xe&&Be(Me);var Cr=new se,Tr=ot[ot.length-1].currentNSMap,Qt=j(fe,Me,Cr,Tr,de,we,Te),at=Cr.length;if(Cr.closed||(Te&&t.isHTMLVoidElement(Cr.tagName)?Cr.closed=!0:Ke.push(Cr.tagName)),Xe&&at){for(var Pe=U(Xe,{}),be=0;be<at;be++){var je=Cr[be];Be(je.offset),je.locator=U(Xe,{})}ye.locator=Pe,H(Cr,ye,Tr)&&ot.push(Cr),ye.locator=Xe}else H(Cr,ye,Tr)&&ot.push(Cr);Te&&!Cr.closed?Qt=W(fe,Qt,Cr.tagName,de,ye):Qt++}}catch(qe){if(qe instanceof c)throw qe;if(qe instanceof f)throw new c(qe.name+": "+qe.message,ye.locator,qe);we.error("element parse error: "+qe),Qt=-1}Qt>it?it=Qt:Ee(Math.max(Me,it)+1)}}function U(fe,pe){return pe.lineNumber=fe.lineNumber,pe.columnNumber=fe.columnNumber,pe}function j(fe,pe,De,ye,we,Te,Re){function de(Be,ot,Ke){if(s(De.attributeNames,Be))return Te.fatalError("Attribute "+Be+" redefined");if(!Re&&ot.indexOf("<")>=0)return Te.fatalError("Unescaped '<' not allowed in attributes values");De.addValue(Be,ot.replace(/[\t\n\r]/g," ").replace(N,we),Ke)}for(var Ee,xe,Ne=++pe,Fe=d;;){var Xe=fe.charAt(Ne);switch(Xe){case"=":if(Fe===m)Ee=fe.slice(pe,Ne),Fe=x;else if(Fe===b)Fe=x;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(Fe===x||Fe===m)if(Fe===m&&(Te.warning('attribute value must after "="'),Ee=fe.slice(pe,Ne)),pe=Ne+1,Ne=fe.indexOf(Xe,pe),Ne>0)xe=fe.slice(pe,Ne),de(Ee,xe,pe-1),Fe=T;else throw new Error("attribute value no end '"+Xe+"' match");else if(Fe==E)xe=fe.slice(pe,Ne),de(Ee,xe,pe),Te.warning('attribute "'+Ee+'" missed start quot('+Xe+")!!"),pe=Ne+1,Fe=T;else throw new Error('attribute value must after "="');break;case"/":switch(Fe){case d:De.setTagName(fe.slice(pe,Ne));case T:case A:case R:Fe=R,De.closed=!0;case E:case m:break;case b:De.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return Te.error("unexpected end of input"),Fe==d&&De.setTagName(fe.slice(pe,Ne)),Ne;case">":switch(Fe){case d:De.setTagName(fe.slice(pe,Ne));case T:case A:case R:break;case E:case m:xe=fe.slice(pe,Ne),xe.slice(-1)==="/"&&(De.closed=!0,xe=xe.slice(0,-1));case b:Fe===b&&(xe=Ee),Fe==E?(Te.warning('attribute "'+xe+'" missed quot(")!'),de(Ee,xe,pe)):(Re||Te.warning('attribute "'+xe+'" missed value!! "'+xe+'" instead!!'),de(xe,xe,pe));break;case x:if(!Re)return Te.fatalError(`AttValue: ' or " expected`)}return Ne;case"":Xe=" ";default:if(Xe<=" ")switch(Fe){case d:De.setTagName(fe.slice(pe,Ne)),Fe=A;break;case m:Ee=fe.slice(pe,Ne),Fe=b;break;case E:var xe=fe.slice(pe,Ne);Te.warning('attribute "'+xe+'" missed quot(")!!'),de(Ee,xe,pe);case T:Fe=A;break}else switch(Fe){case b:Re||Te.warning('attribute "'+Ee+'" missed value!! "'+Ee+'" instead2!!'),de(Ee,Ee,pe),pe=Ne,Fe=m;break;case T:Te.warning('attribute space is required"'+Ee+'"!!');case A:Fe=m,pe=Ne;break;case x:Fe=E,pe=Ne;break;case R:throw new Error("elements closed character '/' and '>' must be connected to")}}Ne++}}function H(fe,pe,De){for(var ye=fe.tagName,we=null,Fe=fe.length;Fe--;){var Te=fe[Fe],Re=Te.qName,de=Te.value,Xe=Re.indexOf(":");if(Xe>0)var Ee=Te.prefix=Re.slice(0,Xe),xe=Re.slice(Xe+1),Ne=Ee==="xmlns"&&xe;else xe=Re,Ee=null,Ne=Re==="xmlns"&&"";Te.localName=xe,Ne!==!1&&(we==null&&(we=Object.create(null),X(De,De=Object.create(null))),De[Ne]=we[Ne]=de,Te.uri=o.XMLNS,pe.startPrefixMapping(Ne,de))}for(var Fe=fe.length;Fe--;)Te=fe[Fe],Te.prefix&&(Te.prefix==="xml"&&(Te.uri=o.XML),Te.prefix!=="xmlns"&&(Te.uri=De[Te.prefix]));var Xe=ye.indexOf(":");Xe>0?(Ee=fe.prefix=ye.slice(0,Xe),xe=fe.localName=ye.slice(Xe+1)):(Ee=null,xe=fe.localName=ye);var Be=fe.uri=De[Ee||""];if(pe.startElement(Be,xe,ye,fe),fe.closed){if(pe.endElement(Be,xe,ye),we)for(Ee in we)s(we,Ee)&&pe.endPrefixMapping(Ee)}else return fe.currentNSMap=De,fe.localNSMap=we,!0}function W(fe,pe,De,ye,we){var Te=n(De);if(Te||a(De)){var Re=fe.indexOf("</"+De+">",pe),de=fe.substring(pe+1,Re);return Te&&(de=de.replace(N,ye)),we.characters(de,0,de.length),Re}return pe+1}function X(fe,pe){for(var De in fe)s(fe,De)&&(pe[De]=fe[De])}function oe(fe,pe){var De=pe;function ye(Ne){return Ne=Ne||0,fe.charAt(De+Ne)}function we(Ne){Ne=Ne||1,De+=Ne}function Te(){for(var Ne=0;De<fe.length;){var Fe=ye();if(Fe!==" "&&Fe!==`
`&&Fe!=="	"&&Fe!=="\r")return Ne;Ne++,we()}return-1}function Re(){return fe.substring(De)}function de(Ne){return fe.substring(De,De+Ne.length)===Ne}function Ee(Ne){return fe.substring(De,De+Ne.length).toUpperCase()===Ne.toUpperCase()}function xe(Ne){var Fe=e.reg("^",Ne),Xe=Fe.exec(Re());return Xe?(we(Xe[0].length),Xe[0]):null}return{char:ye,getIndex:function(){return De},getMatch:xe,getSource:function(){return fe},skip:we,skipBlanks:Te,substringFromIndex:Re,substringStartsWith:de,substringStartsWithCaseInsensitive:Ee}}function ee(fe,pe){function De(de,Ee){var xe=e.PI.exec(de.substringFromIndex());return xe?xe[1].toLowerCase()==="xml"?Ee.fatalError("xml declaration is only allowed at the start of the document, but found at position "+de.getIndex()):(de.skip(xe[0].length),xe[0]):Ee.fatalError("processing instruction is not well-formed at position "+de.getIndex())}var ye=fe.getSource();if(fe.char()==="["){fe.skip(1);for(var we=fe.getIndex();fe.getIndex()<ye.length;){if(fe.skipBlanks(),fe.char()==="]"){var Te=ye.substring(we,fe.getIndex());return fe.skip(1),Te}var Re=null;if(fe.char()==="<"&&fe.char(1)==="!")switch(fe.char(2)){case"E":fe.char(3)==="L"?Re=fe.getMatch(e.elementdecl):fe.char(3)==="N"&&(Re=fe.getMatch(e.EntityDecl));break;case"A":Re=fe.getMatch(e.AttlistDecl);break;case"N":Re=fe.getMatch(e.NotationDecl);break;case"-":Re=fe.getMatch(e.Comment);break}else if(fe.char()==="<"&&fe.char(1)==="?")Re=De(fe,pe);else if(fe.char()==="%")Re=fe.getMatch(e.PEReference);else return pe.fatalError("Error detected in Markup declaration");if(!Re)return pe.fatalError("Error in internal subset at position "+fe.getIndex())}return pe.fatalError("doctype internal subset is not well-formed, missing ]")}}function G(fe,pe,De,ye,we){var Te=oe(fe,pe);switch(we?Te.char(2).toUpperCase():Te.char(2)){case"-":var Re=Te.getMatch(e.Comment);return Re?(De.comment(Re,e.COMMENT_START.length,Re.length-e.COMMENT_START.length-e.COMMENT_END.length),Te.getIndex()):ye.fatalError("comment is not well-formed at position "+Te.getIndex());case"[":var de=Te.getMatch(e.CDSect);return de?!we&&!De.currentElement?ye.fatalError("CDATA outside of element"):(De.startCDATA(),De.characters(de,e.CDATA_START.length,de.length-e.CDATA_START.length-e.CDATA_END.length),De.endCDATA(),Te.getIndex()):ye.fatalError("Invalid CDATA starting at position "+pe);case"D":{if(De.doc&&De.doc.documentElement)return ye.fatalError("Doctype not allowed inside or after documentElement at position "+Te.getIndex());if(we?!Te.substringStartsWithCaseInsensitive(e.DOCTYPE_DECL_START):!Te.substringStartsWith(e.DOCTYPE_DECL_START))return ye.fatalError("Expected "+e.DOCTYPE_DECL_START+" at position "+Te.getIndex());if(Te.skip(e.DOCTYPE_DECL_START.length),Te.skipBlanks()<1)return ye.fatalError("Expected whitespace after "+e.DOCTYPE_DECL_START+" at position "+Te.getIndex());var Ee={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(Ee.name=Te.getMatch(e.Name),!Ee.name)return ye.fatalError("doctype name missing or contains unexpected characters at position "+Te.getIndex());if(we&&Ee.name.toLowerCase()!=="html"&&ye.warning("Unexpected DOCTYPE in HTML document at position "+Te.getIndex()),Te.skipBlanks(),Te.substringStartsWith(e.PUBLIC)||Te.substringStartsWith(e.SYSTEM)){var xe=e.ExternalID_match.exec(Te.substringFromIndex());if(!xe)return ye.fatalError("doctype external id is not well-formed at position "+Te.getIndex());xe.groups.SystemLiteralOnly!==void 0?Ee.systemId=xe.groups.SystemLiteralOnly:(Ee.systemId=xe.groups.SystemLiteral,Ee.publicId=xe.groups.PubidLiteral),Te.skip(xe[0].length)}else if(we&&Te.substringStartsWithCaseInsensitive(e.SYSTEM)){if(Te.skip(e.SYSTEM.length),Te.skipBlanks()<1)return ye.fatalError("Expected whitespace after "+e.SYSTEM+" at position "+Te.getIndex());if(Ee.systemId=Te.getMatch(e.ABOUT_LEGACY_COMPAT_SystemLiteral),!Ee.systemId)return ye.fatalError("Expected "+e.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+e.SYSTEM+" at position "+Te.getIndex())}return we&&Ee.systemId&&!e.ABOUT_LEGACY_COMPAT_SystemLiteral.test(Ee.systemId)&&ye.warning("Unexpected doctype.systemId in HTML document at position "+Te.getIndex()),we||(Te.skipBlanks(),Ee.internalSubset=ee(Te,ye)),Te.skipBlanks(),Te.char()!==">"?ye.fatalError("doctype not terminated with > at position "+Te.getIndex()):(Te.skip(1),De.startDTD(Ee.name,Ee.publicId,Ee.systemId,Ee.internalSubset),De.endDTD(),Te.getIndex())}default:return ye.fatalError('Not well-formed XML starting with "<!" at position '+pe)}}function ae(fe,pe,De,ye){var we=fe.substring(pe).match(e.PI);if(!we)return ye.fatalError("Invalid processing instruction starting at position "+pe);if(we[1].toLowerCase()==="xml"){if(pe>0)return ye.fatalError("processing instruction at position "+pe+" is an xml declaration which is only at the start of the document");if(!e.XMLDecl.test(fe.substring(pe)))return ye.fatalError("xml declaration is not well-formed")}return De.processingInstruction(we[1],we[2]),pe+we[0].length}function se(){this.attributeNames=Object.create(null)}return se.prototype={setTagName:function(fe){if(!e.QName_exact.test(fe))throw new Error("invalid tagName:"+fe);this.tagName=fe},addValue:function(fe,pe,De){if(!e.QName_exact.test(fe))throw new Error("invalid attribute:"+fe);this.attributeNames[fe]=this.length,this[this.length++]={qName:fe,value:pe,offset:De}},length:0,getLocalName:function(fe){return this[fe].localName},getLocator:function(fe){return this[fe].locator},getQName:function(fe){return this[fe].qName},getURI:function(fe){return this[fe].uri},getValue:function(fe){return this[fe].value}},h1.XMLReader=F,h1.parseUtils=oe,h1.parseDoctypeCommentOrCData=G,h1}var mq;function eke(){if(mq)return hm;mq=1;var t=A_(),e=JQ(),r=R3(),n=JMe(),i=QMe(),a=e.DOMImplementation,s=t.hasDefaultHTMLNamespace,o=t.isHTMLMimeType,c=t.isValidMimeType,f=t.MIME_TYPE,d=t.NAMESPACE,m=r.ParseError,b=i.XMLReader;function x(j){return j.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028\u2029]/g,`
`)}function E(j){if(j=j||{},j.locator===void 0&&(j.locator=!0),this.assign=j.assign||t.assign,this.domHandler=j.domHandler||T,this.onError=j.onError||j.errorHandler,j.errorHandler&&typeof j.errorHandler!="function")throw new TypeError("errorHandler object is no longer supported, switch to onError!");j.errorHandler&&j.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=j.normalizeLineEndings||x,this.locator=!!j.locator,this.xmlns=this.assign(Object.create(null),j.xmlns)}E.prototype.parseFromString=function(j,H){if(!c(H))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+H+'" is not valid.');var W=this.assign(Object.create(null),this.xmlns),X=n.XML_ENTITIES,oe=W[""]||null;s(H)?(X=n.HTML_ENTITIES,oe=d.HTML):H===f.XML_SVG_IMAGE&&(oe=d.SVG),W[""]=oe,W.xml=W.xml||d.XML;var ee=new this.domHandler({mimeType:H,defaultNamespace:oe,onError:this.onError}),G=this.locator?{}:void 0;this.locator&&ee.setDocumentLocator(G);var ae=new b;ae.errorHandler=ee,ae.domBuilder=ee;var se=!t.isHTMLMimeType(H);return se&&typeof j!="string"&&ae.errorHandler.fatalError("source is not a string"),ae.parse(this.normalizeLineEndings(String(j)),W,X),ee.doc.documentElement||ae.errorHandler.fatalError("missing root element"),ee.doc};function T(j){var H=j||{};this.mimeType=H.mimeType||f.XML_APPLICATION,this.defaultNamespace=H.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=H.onError}function A(j,H){H.lineNumber=j.lineNumber,H.columnNumber=j.columnNumber}T.prototype={startDocument:function(){var j=new a;this.doc=o(this.mimeType)?j.createHTMLDocument(!1):j.createDocument(this.defaultNamespace,"")},startElement:function(j,H,W,X){var oe=this.doc,ee=oe.createElementNS(j,W||H),G=X.length;N(this,ee),this.currentElement=ee,this.locator&&A(this.locator,ee);for(var ae=0;ae<G;ae++){var j=X.getURI(ae),se=X.getValue(ae),W=X.getQName(ae),fe=oe.createAttributeNS(j,W);this.locator&&A(X.getLocator(ae),fe),fe.value=fe.nodeValue=se,ee.setAttributeNode(fe)}},endElement:function(j,H,W){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(j,H){},endPrefixMapping:function(j){},processingInstruction:function(j,H){var W=this.doc.createProcessingInstruction(j,H);this.locator&&A(this.locator,W),N(this,W)},ignorableWhitespace:function(j,H,W){},characters:function(j,H,W){if(j=F.apply(this,arguments),j){if(this.cdata)var X=this.doc.createCDATASection(j);else var X=this.doc.createTextNode(j);this.currentElement?this.currentElement.appendChild(X):/^\s*$/.test(j)&&this.doc.appendChild(X),this.locator&&A(this.locator,X)}},skippedEntity:function(j){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(j){j&&(j.lineNumber=0),this.locator=j},comment:function(j,H,W){j=F.apply(this,arguments);var X=this.doc.createComment(j);this.locator&&A(this.locator,X),N(this,X)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(j,H,W,X){var oe=this.doc.implementation;if(oe&&oe.createDocumentType){var ee=oe.createDocumentType(j,H,W,X);this.locator&&A(this.locator,ee),N(this,ee),this.doc.doctype=ee}},reportError:function(j,H){if(typeof this.onError=="function")try{this.onError(j,H,this)}catch(W){throw new m("Reporting "+j+' "'+H+'" caused '+W,this.locator)}else console.error("[xmldom "+j+"]	"+H,R(this.locator))},warning:function(j){this.reportError("warning",j)},error:function(j){this.reportError("error",j)},fatalError:function(j){throw this.reportError("fatalError",j),new m(j,this.locator)}};function R(j){if(j)return`
@#[line:`+j.lineNumber+",col:"+j.columnNumber+"]"}function F(j,H,W){return typeof j=="string"?j.substr(H,W):j.length>=H+W||H?new java.lang.String(j,H,W)+"":j}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(j){T.prototype[j]=function(){return null}});function N(j,H){j.currentElement?j.currentElement.appendChild(H):j.doc.appendChild(H)}function O(j){if(j==="error")throw"onErrorStopParsing"}function U(){throw"onWarningStopParsing"}return hm.__DOMHandler=T,hm.DOMParser=E,hm.normalizeLineEndings=x,hm.onErrorStopParsing=O,hm.onWarningStopParsing=U,hm}var yq;function tke(){if(yq)return ya;yq=1;var t=A_();ya.assign=t.assign,ya.hasDefaultHTMLNamespace=t.hasDefaultHTMLNamespace,ya.isHTMLMimeType=t.isHTMLMimeType,ya.isValidMimeType=t.isValidMimeType,ya.MIME_TYPE=t.MIME_TYPE,ya.NAMESPACE=t.NAMESPACE;var e=R3();ya.DOMException=e.DOMException,ya.DOMExceptionName=e.DOMExceptionName,ya.ExceptionCode=e.ExceptionCode,ya.ParseError=e.ParseError;var r=JQ();ya.Attr=r.Attr,ya.CDATASection=r.CDATASection,ya.CharacterData=r.CharacterData,ya.Comment=r.Comment,ya.Document=r.Document,ya.DocumentFragment=r.DocumentFragment,ya.DocumentType=r.DocumentType,ya.DOMImplementation=r.DOMImplementation,ya.Element=r.Element,ya.Entity=r.Entity,ya.EntityReference=r.EntityReference,ya.LiveNodeList=r.LiveNodeList,ya.NamedNodeMap=r.NamedNodeMap,ya.Node=r.Node,ya.NodeList=r.NodeList,ya.Notation=r.Notation,ya.ProcessingInstruction=r.ProcessingInstruction,ya.Text=r.Text,ya.XMLSerializer=r.XMLSerializer;var n=eke();return ya.DOMParser=n.DOMParser,ya.normalizeLineEndings=n.normalizeLineEndings,ya.onErrorStopParsing=n.onErrorStopParsing,ya.onWarningStopParsing=n.onWarningStopParsing,ya}var rke=tke();const QQ=(function(){const t=/\s*/g,e=/^\s*|\s*$/g,r=/\s+/;function n(O){if(!O||!O.length)return 0;for(var U=0,j=0;U<O.length;U++)j=(j<<5)-j+O.charCodeAt(U)|0;return j}function i(O,U){return O.getElementsByTagName(U)}function a(O,U){return O.getAttribute(U)}function s(O,U){return parseFloat(a(O,U))}function o(O,U){const j=i(O,U);return j.length?j[0]:null}function c(O){return O.normalize&&O.normalize(),O}function f(O){for(var U=0,j=[];U<O.length;U++)j[U]=parseFloat(O[U]);return j}function d(O){return O&&c(O),O&&O.textContent||""}function m(O,U){let j={},H,W;for(W=0;W<U.length;W++)H=o(O,U[W]),H&&(j[U[W]]=d(H));return j}function b(O,U){for(const j in U)O[j]=U[j]}function x(O){return f(O.replace(t,"").split(","))}function E(O){const U=O.replace(e,"").split(r),j=[];for(let H=0;H<U.length;H++)j.push(x(U[H]));return j}function T(O){let U=[s(O,"lon"),s(O,"lat")],j=o(O,"ele"),H=o(O,"gpxtpx:hr")||o(O,"hr"),W=o(O,"time"),X;return j&&(X=parseFloat(d(j)),isNaN(X)||U.push(X)),{coordinates:U,time:W?d(W):null,heartRate:H?parseFloat(d(H)):null}}function A(){return{type:"FeatureCollection",features:[]}}let R;if(typeof XMLSerializer<"u")R=new XMLSerializer;else{const O=typeof process=="object"&&!process.browser,U=typeof Titanium=="object";if(typeof exports=="object"&&(O||U))R=rke.XMLSerializer;else throw new Error("Unable to initialize serializer")}function F(O){return O.xml!==void 0?O.xml:R.serializeToString(O)}return{kml:function(O){const U=A(),j={},H={},W={},X=["Polygon","LineString","Point","Track","gx:Track"],oe=i(O,"Placemark"),ee=i(O,"Style"),G=i(O,"StyleMap");for(let ye=0;ye<ee.length;ye++){const we=n(F(ee[ye])).toString(16);j["#"+a(ee[ye],"id")]=we,H[we]=ee[ye]}for(let ye=0;ye<G.length;ye++){j["#"+a(G[ye],"id")]=n(F(G[ye])).toString(16);const we=i(G[ye],"Pair"),Te={};for(let Re=0;Re<we.length;Re++)Te[d(o(we[Re],"key"))]=d(o(we[Re],"styleUrl"));W["#"+a(G[ye],"id")]=Te}for(let ye=0;ye<oe.length;ye++)U.features=U.features.concat(De(oe[ye]));function ae(ye){let we,Te;return ye=ye||"",ye.substr(0,1)==="#"&&(ye=ye.substr(1)),(ye.length===6||ye.length===3)&&(we=ye),ye.length===8&&(Te=parseInt(ye.substr(0,2),16)/255,we="#"+ye.substr(6,2)+ye.substr(4,2)+ye.substr(2,2)),[we,isNaN(Te)?void 0:Te]}function se(ye){return f(ye.split(" "))}function fe(ye){let we=i(ye,"coord"),Te=[],Re=[];we.length===0&&(we=i(ye,"gx:coord"));for(let Ee=0;Ee<we.length;Ee++)Te.push(se(d(we[Ee])));const de=i(ye,"when");for(let Ee=0;Ee<de.length;Ee++)Re.push(d(de[Ee]));return{coords:Te,times:Re}}function pe(ye){let we,Te,Re,de,Ee,xe=[],Ne=[];if(o(ye,"MultiGeometry"))return pe(o(ye,"MultiGeometry"));if(o(ye,"MultiTrack"))return pe(o(ye,"MultiTrack"));if(o(ye,"gx:MultiTrack"))return pe(o(ye,"gx:MultiTrack"));for(Re=0;Re<X.length;Re++)if(Te=i(ye,X[Re]),Te){for(de=0;de<Te.length;de++)if(we=Te[de],X[Re]==="Point")xe.push({type:"Point",coordinates:x(d(o(we,"coordinates")))});else if(X[Re]==="LineString")xe.push({type:"LineString",coordinates:E(d(o(we,"coordinates")))});else if(X[Re]==="Polygon"){const Fe=i(we,"LinearRing"),Xe=[];for(Ee=0;Ee<Fe.length;Ee++)Xe.push(E(d(o(Fe[Ee],"coordinates"))));xe.push({type:"Polygon",coordinates:Xe})}else if(X[Re]==="Track"||X[Re]==="gx:Track"){const Fe=fe(we);xe.push({type:"LineString",coordinates:Fe.coords}),Fe.times.length&&Ne.push(Fe.times)}}return{geoms:xe,coordTimes:Ne}}function De(ye){let we=pe(ye),Te,Re={},de=d(o(ye,"name")),Ee=d(o(ye,"address")),xe=d(o(ye,"styleUrl")),Ne=d(o(ye,"description")),Fe=o(ye,"TimeSpan"),Xe=o(ye,"TimeStamp"),Be=o(ye,"ExtendedData"),ot=o(ye,"LineStyle"),Ke=o(ye,"PolyStyle"),it=o(ye,"visibility");if(!we.geoms.length)return[];if(de&&(Re.name=de),Ee&&(Re.address=Ee),xe){xe[0]!=="#"&&(xe="#"+xe),Re.styleUrl=xe,j[xe]&&(Re.styleHash=j[xe]),W[xe]&&(Re.styleMapHash=W[xe],Re.styleHash=j[W[xe].normal]);const zt=H[Re.styleHash];if(zt){ot||(ot=o(zt,"LineStyle")),Ke||(Ke=o(zt,"PolyStyle"));const st=o(zt,"IconStyle");if(st){const $e=o(st,"Icon");if($e){const Jt=d(o($e,"href"));Jt&&(Re.icon=Jt)}}}}if(Ne&&(Re.description=Ne),Fe){const zt=d(o(Fe,"begin")),st=d(o(Fe,"end"));Re.timespan={begin:zt,end:st}}if(Xe&&(Re.timestamp=d(o(Xe,"when"))),ot){const zt=ae(d(o(ot,"color"))),st=zt[0],$e=zt[1],Jt=parseFloat(d(o(ot,"width")));st&&(Re.stroke=st),isNaN($e)||(Re["stroke-opacity"]=$e),isNaN(Jt)||(Re["stroke-width"]=Jt)}if(Ke){const zt=ae(d(o(Ke,"color"))),st=zt[0],$e=zt[1],Jt=d(o(Ke,"fill")),Ht=d(o(Ke,"outline"));st&&(Re.fill=st),isNaN($e)||(Re["fill-opacity"]=$e),Jt&&(Re["fill-opacity"]=Jt==="1"?Re["fill-opacity"]||1:0),Ht&&(Re["stroke-opacity"]=Ht==="1"?Re["stroke-opacity"]||1:0)}if(Be){const zt=i(Be,"Data"),st=i(Be,"SimpleData");for(Te=0;Te<zt.length;Te++)Re[zt[Te].getAttribute("name")]=d(o(zt[Te],"value"));for(Te=0;Te<st.length;Te++)Re[st[Te].getAttribute("name")]=d(st[Te])}it&&(Re.visibility=d(it)),we.coordTimes.length&&(Re.coordTimes=we.coordTimes.length===1?we.coordTimes[0]:we.coordTimes);const Me={type:"Feature",geometry:we.geoms.length===1?we.geoms[0]:{type:"GeometryCollection",geometries:we.geoms},properties:Re};return a(ye,"id")&&(Me.id=a(ye,"id")),[Me]}return U},gpx:function(O){let U,j=i(O,"trk"),H=i(O,"rte"),W=i(O,"wpt"),X=A(),oe;for(U=0;U<j.length;U++)oe=ae(j[U]),oe&&X.features.push(oe);for(U=0;U<H.length;U++)oe=se(H[U]),oe&&X.features.push(oe);for(U=0;U<W.length;U++)X.features.push(fe(W[U]));function ee(ye,we){for(let Te=0;Te<we;Te++)ye.push(null);return ye}function G(ye,we){const Te=i(ye,we),Re=[],de=[],Ee=[],xe=Te.length;if(xe<2)return{};for(let Ne=0;Ne<xe;Ne++){const Fe=T(Te[Ne]);Re.push(Fe.coordinates),Fe.time&&de.push(Fe.time),(Fe.heartRate||Ee.length)&&(Ee.length||ee(Ee,Ne),Ee.push(Fe.heartRate||null))}return{line:Re,times:de,heartRates:Ee}}function ae(ye){let we=i(ye,"trkseg"),Te=[],Re=[],de=[],Ee;for(let Ne=0;Ne<we.length;Ne++)if(Ee=G(we[Ne],"trkpt"),Ee&&(Ee.line&&Te.push(Ee.line),Ee.times&&Ee.times.length&&Re.push(Ee.times),de.length||Ee.heartRates&&Ee.heartRates.length)){if(!de.length)for(let Fe=0;Fe<Ne;Fe++)de.push(ee([],Te[Fe].length));Ee.heartRates&&Ee.heartRates.length?de.push(Ee.heartRates):de.push(ee([],Ee.line.length||0))}if(Te.length===0)return;const xe=De(ye);return b(xe,pe(o(ye,"extensions"))),Re.length&&(xe.coordTimes=Te.length===1?Re[0]:Re),de.length&&(xe.heartRates=Te.length===1?de[0]:de),{type:"Feature",properties:xe,geometry:{type:Te.length===1?"LineString":"MultiLineString",coordinates:Te.length===1?Te[0]:Te}}}function se(ye){const we=G(ye,"rtept");if(!we.line)return;const Te=De(ye);return b(Te,pe(o(ye,"extensions"))),{type:"Feature",properties:Te,geometry:{type:"LineString",coordinates:we.line}}}function fe(ye){const we=De(ye);return b(we,m(ye,["sym"])),{type:"Feature",properties:we,geometry:{type:"Point",coordinates:T(ye).coordinates}}}function pe(ye){const we={};if(ye){const Te=o(ye,"line");if(Te){const Re=d(o(Te,"color")),de=parseFloat(d(o(Te,"opacity"))),Ee=parseFloat(d(o(Te,"width")));Re&&(we.stroke=Re),isNaN(de)||(we["stroke-opacity"]=de),isNaN(Ee)||(we["stroke-width"]=Ee*96/25.4)}}return we}function De(ye){const we=m(ye,["name","cmt","desc","type","time","keywords"]),Te=i(ye,"link");Te.length&&(we.links=[]);for(let Re=0,de;Re<Te.length;Re++)de={href:a(Te[Re],"href")},b(de,m(Te[Re],["text","type"])),we.links.push(de);return we}return X}}})(),RE=t=>{const[e,r]=te.useState(),[n,i]=te.useState([]),a=s=>{try{i([]);const c=new DOMParser().parseFromString(s,"application/xml");c.querySelector("metadata")?.childNodes.forEach(m=>{let b=m.textContent;const x=m.nodeName;if(m.nodeName==="link"&&(b=m.getAttribute("href")??""),b?.trim().length){const E={title:x,value:b,id:new Date().getTime()};i(T=>[...T,E])}});const d=QQ.gpx(c);r(d)}catch(o){console.log(o)}};return te.useEffect(()=>{t.data&&a(t.data)},[t.data]),{geojson:e,metadata:n}};RE.defaultProps={data:void 0};try{RE.displayName="useGpx",RE.__docgenInfo={description:"useGpx hook converts GPX data to GeoJSON",displayName:"useGpx",props:{data:{defaultValue:{value:"undefined"},description:"a string containing GPX data that is supposed to be parsed and converted to GeoJSON by this hook",name:"data",required:!1,type:{name:"string | undefined"}}}}}catch{}const DE=t=>{const e=ga({mapId:t.mapId,waitForLayer:t.layerId}),r=te.useRef(new TT.Popup({closeButton:!1,closeOnClick:!0}));return te.useEffect(()=>{!e.map||!t.layerId||e.map.on("mouseenter",t.layerId,n=>{if(!e.map)return;const i=n?.features?.[0].geometry.coordinates.slice();let a="";if(n?.features?.[0]&&typeof t.getPopupContent=="function"&&(a=t.getPopupContent(n.features[0])),i?.[0]){for(;Math.abs(n.lngLat.lng-i[0])>180;)i[0]+=n.lngLat.lng>i[0]?360:-360;r.current.setLngLat(i).setHTML(a).addTo(e.map.map)}},e.componentId)},[e.map]),J.jsx(J.Fragment,{})};DE.defaultProps={mapId:void 0};try{DE.displayName="LayerHoverPopup",DE.__docgenInfo={description:"useLayerHoverPopup hook registers a mouseenter event to display feature properties in a MapLibre popup if a feature on the configured layer is hovered",displayName:"LayerHoverPopup",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"Id of an existing layer in the mapLibre instance this event will be registered to",name:"layerId",required:!1,type:{name:"string | undefined"}},getPopupContent:{defaultValue:null,description:"",name:"getPopupContent",required:!0,type:{name:"(feature: Feature<Geometry, GeoJsonProperties>) => string"}}}}}catch{}const vq=t=>{const e=RE({data:t.gpxData}),r=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),n=te.useRef("gpx-viewer-source-"+vc()),i=te.useRef("importer-layer-lines-"+vc()),a=te.useRef("importer-layer-points-"+vc());return DE({layerId:a.current,getPopupContent:s=>s?.properties?.name}),lL({mapId:t.mapId,sourceId:n.current,source:{type:"geojson",data:e.geojson||xp([])}}),wp({layerId:i.current,options:{type:"line",paint:{"line-width":4,"line-color":"rgba(212, 55, 23,0.5)"},source:n.current},insertBeforeLayer:t.insertBeforeLayer}),wp({layerId:a.current,options:{type:"circle",paint:{"circle-color":"rgba(72, 77, 99,0.5)","circle-radius":7},filter:["==","$type","Point"],source:n.current},insertBeforeLayer:t.insertBeforeLayer}),te.useEffect(()=>{if(!r.map||!e.geojson)return;typeof t.onParseGpxData=="function"&&t.onParseGpxData(e);const s=df(e.geojson);r.map.map.fitBounds(s)},[e]),J.jsx(J.Fragment,{})};try{vq.displayName="MlGpxViewer",vq.__docgenInfo={description:"MlGpxViewer visualizes a given GPX Track on the map",displayName:"MlGpxViewer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapHook",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},idPrefix:{defaultValue:null,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance",name:"idPrefix",required:!1,type:{name:"string | undefined"}},gpxData:{defaultValue:null,description:"",name:"gpxData",required:!0,type:{name:"string | undefined"}},onParseGpxData:{defaultValue:null,description:"",name:"onParseGpxData",required:!0,type:{name:"(arg0: { geojson: FeatureCollection<Geometry, GeoJsonProperties> | undefined; metadata: MetadataType[]; }) => void"}}}}}catch{}const nke=gt.createContext({}),ike=nke.Provider,_q=({children:t})=>{const[e,r]=te.useState({type:"FeatureCollection",features:[]}),i={data:e,setData:r,getEmptyFeatureCollection:()=>({type:"FeatureCollection",features:[]})};return J.jsx(ike,{value:i,children:t})};try{_q.displayName="GeoJsonProvider",_q.__docgenInfo={description:"",displayName:"GeoJsonProvider",props:{}}}catch{}const cR=()=>{const t=Object.fromEntries(new URLSearchParams(window.location.search));return t.layers=JSON.parse(t?.layers?t.layers:"[]"),t},gP=cR(),bq=t=>{const e=te.useContext(Lg),r=te.useRef(!1),n=te.useRef(null),[i,a]=te.useState(void 0),s=te.useRef({}),o=te.useRef((t.idPrefix?t.idPrefix:"MlShareMapState-")+vc()),c=$T({watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!1}}),f=te.useRef(!1),d=te.useRef(null),m=te.useRef({viewport:{center:!1,bearing:!1,pitch:!1,zoom:!1},layers:{...s}}),b=te.useRef({}),x=te.useCallback(()=>{if(!t.active)return;const A=[];for(const N in c.layers)A.push({id:c.layers[N]?.id,type:c.layers[N]?.type,visible:c.layers[N]?.visible});E();const R=new URLSearchParams({...cR(),...b.current,layers:JSON.stringify(A)});JSON.parse(Object.fromEntries(R).layers).forEach(N=>{s.current[N.id]=!1});const F=new URLSearchParams(window.location.search);R.toString()!==F.toString()&&window.history.pushState({...b.current},document.title,"?"+R.toString())},[c.layers,t.active]);te.useEffect(()=>{const A=o.current;return b.current=cR(),()=>{n.current&&(n.current.cleanup(A),n.current=null),r.current=!1}},[]),te.useEffect(()=>{n.current&&x()},[x]),te.useEffect(()=>{if(!n.current)return;const A=x;return n.current.on("moveend",A,o.current),()=>{n.current?.map.off("moveend",A)}},[x,i]),te.useEffect(()=>{!e?.mapExists?.(t.mapId)||r.current||(r.current=!0,n.current=e.getMap(t.mapId),a(n.current),b.current.lat&&b.current.lng&&T())},[e.mapIds,e,t.mapId,t.active]),te.useEffect(()=>{if(c?.layers?.length){typeof d.current>"u"&&(d.current=null,gP?.layers?.forEach(A=>{d.current?.[A.id]&&(d.current[A.id]=!1)}));for(const A in d.current){let R=!0;if(d.current[A]===!1&&(R=!1),R)return}gP.layers&&gP.layers.forEach(A=>{n.current?.map.getLayer(A.id)&&d.current?.[A.id]===!1&&(d.current[A.id]=!0,n.current.map?.getLayer(A.id)?.setLayoutProperty("visibility",A.visible?"visible":"none"))})}},[c.layers,t.mapId,t.active]),te.useEffect(()=>{i&&c.layers&&(t.active||i.cleanup(o.current))},[t.active,i,c.layers]);const E=()=>{b.current.lat=n.current?.map.getCenter().lat,b.current.lng=n.current?.map.getCenter().lng,b.current.zoom=n.current?.map.getZoom(),b.current.bearing=n.current?.map.getBearing(),b.current.pitch=n.current?.map.getPitch()},T=()=>{m.current.viewport.center||(m.current.viewport.center=!0,b.current.lng&&b.current.lat&&n.current?.map.setCenter([b.current.lng,b.current.lat]),b.current.zoom&&n.current?.map.setZoom(b.current.zoom),b.current.bearing&&n.current?.map.setBearing(b.current.bearing),b.current.pitch&&n.current?.map.setPitch(b.current.pitch)),f.current=!0};return window.onpopstate=A=>{A.state&&A.state.lng&&A.state.lat&&A.state.zoom&&n.current?.map.easeTo({zoom:A.state.zoom,center:[A.state.lng,A.state.lat]})},J.jsx(J.Fragment,{})};try{bq.displayName="MlShareMapState",bq.__docgenInfo={description:"",displayName:"MlShareMapState",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},idPrefix:{defaultValue:null,description:"",name:"idPrefix",required:!1,type:{name:"string | undefined"}},active:{defaultValue:null,description:"",name:"active",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function ake(t,e){const r=(s,o,c,f,d)=>{const m=Su([[s,o],[f,d]]),b=SSe(m,5,{units:"meters"}),x=b.geometry.coordinates[0][0],E=b.geometry.coordinates[0][1],T=b.geometry.coordinates[1][0],A=b.geometry.coordinates[1][1];return c3([[[s,o],[f,d],[T,A],[x,E],[s,o]]],{height:c*e})},n=(s,o,c)=>s*(1-c)+o*c,i=[];return t.line.geometry.coordinates.forEach((s,o)=>{if(t.line.geometry.coordinates[o+1]&&Array.isArray(s)){let f=~~(f3([s[0],s[1]],[t.line.geometry.coordinates[o+1][0],t.line.geometry.coordinates[o+1][1]],{units:"kilometers"})*1e3/10);f=f<1?1:f;for(let d=0;d<f;d++){const m=n(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],d/f),b=n(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],d/f),x=n(t.line.geometry.coordinates[o][2]-t.min,t.line.geometry.coordinates[o+1][2]-t.min,d/f),E=n(t.line.geometry.coordinates[o][0],t.line.geometry.coordinates[o+1][0],(d+1)/f),T=n(t.line.geometry.coordinates[o][1],t.line.geometry.coordinates[o+1][1],(d+1)/f),A=r(m,b,x,E,T);i.push(A)}}}),xp(i)}const xq=["interpolate",["linear"],["get","height"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"yellow"],wq=t=>{const e=te.useRef("elevationprofile-"+vc()),r=te.useRef("elevationprofile-layer-"+vc()),n=t.elevationFactor||1,i=te.useMemo(()=>{if(!t?.geojson?.features)return;const o=t.geojson.features?.find(m=>m.geometry.type==="LineString");if(!o||!o.geometry)return;const c=o.geometry.coordinates.map(m=>m[2]),f=Math.min(...c);let d=Math.max(...c)-f;return d=d===0?1:d,{max:d,min:f,line:o}},[t.geojson]),a=te.useMemo(()=>i?["interpolate",["linear"],["get","height"],0,"rgb(0,255,55)",i.max*n,"rgb(255,0,0)"]:xq,[i,t.elevationFactor]),s=te.useMemo(()=>!t.geojson?.features||!i?void 0:ake(i,n),[i,n]);return lL({mapId:t.mapId,sourceId:e.current,source:{type:"geojson",data:s||xp([])}}),wp({layerId:r.current,options:{source:e.current,type:"fill-extrusion",paint:{"fill-extrusion-height":["get","height"],"fill-extrusion-opacity":.9,"fill-extrusion-color":a||xq}},insertBeforeLayer:t.insertBeforeLayer}),J.jsx(J.Fragment,{})};try{wq.displayName="MlSpatialElevationProfile",wq.__docgenInfo={description:"",displayName:"MlSpatialElevationProfile",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!0,type:{name:"geojson | FeatureCollection<Geometry, GeoJsonProperties> | undefined"}},idPrefix:{defaultValue:null,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance",name:"idPrefix",required:!1,type:{name:"string | undefined"}},elevationFactor:{defaultValue:null,description:"Number describes the factor of the height of the elevation",name:"elevationFactor",required:!1,type:{name:"number | undefined"}},insertBeforeLayer:{defaultValue:null,description:`The layerId of an existing layer this layer should be rendered visually beneath
https://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const I0=t=>{const e=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=te.useRef(t.layerId||"MlVectorTileLayer-"+e.componentId),n=te.useRef({}),i=te.useRef({}),a=te.useRef(!1),s=te.useCallback(()=>{e.map&&(a.current=!0,e.map.map.getSource(r.current)&&e.cleanup(),e.map.map.getSource(r.current)||e.map.addSource(r.current,{type:"vector",tiles:[t.url||""],attribution:"",minzoom:0,maxzoom:14,...t.sourceOptions},e.componentId),t.layers.forEach(c=>{e.map&&(e.map.addLayer({source:r.current,minzoom:0,maxzoom:22,layout:{},paint:{"line-opacity":.5,"line-color":"rgb(80, 80, 80)","line-width":2},...c},t.insertBeforeLayer,e.componentId),n.current[c.id]=JSON.stringify(c.paint),i.current[c.id]=JSON.stringify(c.layout),e.map.on("styledata",()=>{a.current&&!e.map?.map.getSource(r.current)&&(console.log("Recreate Layer "+r.current),s())},e.componentId))}))},[e.map,t]),o=te.useCallback(()=>{a.current&&t.layers.forEach(c=>{if(e.map&&e.map.map.getLayer(c.id)){const f=JSON.stringify(c.paint);if(f!==n.current[c.id])for(const m in c.paint)e.map.setPaintProperty(c.id,m,c.paint[m]);n.current[c.id]=f;const d=JSON.stringify(c.layout);if(d!==i.current[c.id])for(const m in c.layout)e.map.setLayoutProperty(c.id,m,c.layout[m]);i.current[c.id]=d}})},[e.map,t.layers]);return te.useEffect(()=>{a.current||s()},[s]),te.useEffect(()=>{!e.map||!a.current||s()},[t.layers.length,e.map]),te.useEffect(()=>{!e.map||!a.current||o()},[t.layers,e.map]),J.jsx(J.Fragment,{})};try{I0.displayName="MlVectorTileLayer",I0.__docgenInfo={description:`Adds a vector-tile source and 0...n vector-tile-layers to the MapLibre instance referenced by
props.mapId`,displayName:"MlVectorTileLayer",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"",name:"sourceOptions",required:!1,type:{name:"VectorSourceSpecification | undefined"}},url:{defaultValue:null,description:"",name:"url",required:!1,type:{name:"string | undefined"}},layers:{defaultValue:null,description:"",name:"layers",required:!0,type:{name:"ExtendedLayerSpecification[]"}}}}}catch{}const Sq=t=>{const[e,r]=te.useState(),n=ga({mapId:t.mapId}),i=te.useRef(t.mlGeoJsonLayerProps?.layerId||"MlOgcApiFeature-"+n.componentId),a=()=>{const s=new URL(t.ogcApiUrl);if(t.ogcApiFeatureParams&&Object.entries(t.ogcApiFeatureParams).forEach(([o,c])=>{c!=null&&s.searchParams.append(o,c.toString())}),t.reloadFeaturesOnMapMove){const o=n?.map?.getBounds().getSouthWest(),c=n?.map?.getBounds().getNorthEast(),f=`${o?.lng},${o?.lat},${c?.lng},${c?.lat}`;s.searchParams.append("bbox",f)}return s.toString()};return te.useEffect(()=>{if(!n.map)return;const s=()=>{const o=a();fetch(o).then(c=>{if(!c.ok)throw new Error("Error fetching OGC features");return c.json()}).then(c=>{r(c)}).catch(c=>{console.log(c),r(void 0)})};return s(),t.reloadFeaturesOnMapMove&&n.map.on("moveend",s),()=>{n?.map?.off&&n.map.off("moveend",s)}},[n.map,t.ogcApiFeatureParams,t.ogcApiUrl]),te.useEffect(()=>{!n.map||!n.map.map.style.getLayer(i.current)||(t.visible?n.map.map.setLayoutProperty(i.current,"visibility","visible"):n.map.map.setLayoutProperty(i.current,"visibility","none"))},[t.visible,n.map]),J.jsx(J.Fragment,{children:e&&J.jsx(Dc,{geojson:e,layerId:i.current,...t.mlGeoJsonLayerProps})})};try{Sq.displayName="MlOgcApiFeatures",Sq.__docgenInfo={description:"",displayName:"MlOgcApiFeatures",props:{visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},ogcApiUrl:{defaultValue:null,description:"The url of OGC API",name:"ogcApiUrl",required:!0,type:{name:"URL"}},ogcApiFeatureParams:{defaultValue:null,description:"The additional query parameters of OGC API",name:"ogcApiFeatureParams",required:!1,type:{name:"OgcApiFeaturesParamsTypes | undefined"}},reloadFeaturesOnMapMove:{defaultValue:null,description:"Fetches the features everytime (based on the current bbox) when the map gets moved",name:"reloadFeaturesOnMapMove",required:!1,type:{name:"boolean | undefined"}},mlGeoJsonLayerProps:{defaultValue:null,description:"Geojson Layer props. But omit 'geojson' because it gets set from the OGC API Feature call",name:"mlGeoJsonLayerProps",required:!1,type:{name:'Omit<MlGeoJsonLayerProps, "geojson"> | undefined'}}}}}catch{}const Eq=t=>{const e=te.useContext(Lg),r=te.useRef(!1),n=te.useRef(void 0),i=te.useRef("MlWmsFeatureInfoPopup-"+vc());return te.useEffect(()=>{const a=i.current;return()=>{n.current&&(n.current.cleanup(a),n.current=void 0),r.current=!1}},[]),te.useEffect(()=>{!e.mapExists(t.mapId)||r.current||(r.current=!0,n.current=e.getMap(t.mapId),n.current.setCenter([7.132122000552613,50.716405378037706]))},[e.mapIds,e,t.mapId]),J.jsx(J.Fragment,{})};try{Eq.displayName="MlWmsFeatureInfoPopup",Eq.__docgenInfo={description:"TODO: Add short & useful description",displayName:"MlWmsFeatureInfoPopup",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const oke={urlParameters:{bbox:"{bbox-epsg-3857}",format:"image/png",service:"WMS",version:"1.1.1",request:"GetMap",srs:"EPSG:3857",width:"256",height:"256",Transparent:"true",styles:""}},OE=t=>{const e=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),r=te.useRef(!1),n=te.useRef(t.layerId||"MlWmsLayer-"+e.componentId),i=te.useMemo(()=>{let s,o=t.url;t.url.indexOf("?")!==-1&&(s=t.url.split("?"),o=s[0]);const c=new URLSearchParams(s?.[1]),f={...oke.urlParameters,...Object.fromEntries(c),...t.urlParameters},d=new URLSearchParams(f),m=decodeURIComponent(d.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");return o+"?"+m},[t.urlParameters,t.url]),a=te.useCallback(()=>{e.map&&(r.current=!0,e.map.map.getLayer(n.current)&&e.cleanup(),e.map.addSource(n.current,{type:"raster",tiles:[i],tileSize:256,attribution:t.attribution??"",...t.sourceOptions},e.componentId),e.map.addLayer({id:n.current,type:"raster",source:n.current,...t.layerOptions},t.insertBeforeLayer,e.componentId),e.map.on("styledata",()=>{r.current&&!e.map?.map.getLayer(n.current)&&(console.log("Recreate Layer "+n.current),a())},e.componentId),t.visible===!1&&e.map.map.setLayoutProperty(n.current,"visibility","none"))},[e.map,t,i]);return te.useEffect(()=>{r.current&&e?.map?.map?.getSource?.(n.current)?.tiles?.[0]===i||a()},[a]),te.useEffect(()=>{!e.map||!r.current||(t.visible===void 0||t.visible?e.map.map.setLayoutProperty(n.current,"visibility","visible"):e.map.map.setLayoutProperty(n.current,"visibility","none"))},[t.visible,e.map]),J.jsx(J.Fragment,{})};try{OE.displayName="MlWmsLayer",OE.__docgenInfo={description:"Adds a WMS raster source & layer to the maplibre-gl instance",displayName:"MlWmsLayer",props:{urlParameters:{defaultValue:null,description:"",name:"urlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},attribution:{defaultValue:null,description:"",name:"attribution",required:!1,type:{name:"string | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"",name:"sourceOptions",required:!1,type:{name:"RasterSourceSpecification | undefined"}},layerOptions:{defaultValue:null,description:"",name:"layerOptions",required:!1,type:{name:"RasterLayerSpecification | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}}}}}catch{}/**
 * wms-capabilities @0.6.0
 * @description WMS service Capabilities > JSON, based on openlayers 
 * @license BSD-2-Clause
 * @preserve
 */var fa=t=>t!==void 0,eee=(t,e,r)=>e in t?t[e]:t[e]=r;const rx={ELEMENT:1,TEXT:3,CDATA_SECTION:4};class ske{constructor(e){this._parser=new e}toDocument(e){return this._parser.parseFromString(e,"application/xml")}getAllTextContent(e,r){return D3(e,r).join("")}}function D3(t,e){return tee(t,e,[]).join("")}function tee(t,e,r){if(t.nodeType===rx.CDATA_SECTION||t.nodeType===rx.TEXT)e?r.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):r.push(t.nodeValue);else{var n;for(n=t.firstChild;n;n=n.nextSibling)tee(n,e,r)}return r}function lke(t,e,r,n){for(var i=uke(e);i;i=cke(i)){var a=i.namespaceURI||null,s=t[a];if(fa(s)){var o=s[i.localName];fa(o)&&o.call(n,i,r)}}}function uke(t){let e=t.firstElementChild||t.firstChild;for(;e&&e.nodeType!==rx.ELEMENT;)e=e.nextSibling;return e}function cke(t){let e=t.nextElementSibling||t.nextSibling;for(;e&&e.nodeType!==rx.ELEMENT;)e=e.nextSibling;return e}function Cu(t,e,r){return fke(t,e,r)}function fke(t,e,r){var n=fa(r)?r:{},i,a;for(i=0,a=t.length;i<a;++i)n[t[i]]=e;return n}function ree(t,e){return(function(r,n){var i=t.call(fa(e)?e:this,r,n);if(fa(i)){var a=n[n.length-1];a.push(i)}})}function lu(t,e,r,n,i){return n.push(t),lke(e,r,n,i),n.pop()}function si(t,e,r){return(function(n,i){let a=t.call(fa(r)?r:this,n,i);if(fa(a)){var s=i[i.length-1],o=fa(e)?e:n.localName;s[o]=a}})}function Cc(t,e,r){return(function(n,i){var a=t.call(fa(r)?r:this,n,i);if(fa(a)){var s=i[i.length-1],o=fa(e)?e:n.localName,c=eee(s,o,[]);c.push(a)}})}const hke=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function dke(t){return t.replace(hke,"")}function jm(t){const e=/^\s*(true|1)|(false|0)\s*$/.exec(t);if(e)return fa(e[1])||!1}function c0(t){return fp(D3(t,!1))}function fp(t){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e)return parseFloat(e[1])}function mP(t){return LE(D3(t,!1))}function LE(t){const e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}function La(t){return dke(D3(t,!1))}const pke="http://www.w3.org/1999/xlink";function lN(t){return t.getAttributeNS(pke,"href")}function gke(t,e){return lu({},Vke,t,e)}function nee(t){return[fp(t.getAttribute("minx")),fp(t.getAttribute("miny")),fp(t.getAttribute("maxx")),fp(t.getAttribute("maxy"))]}function mke(t,e){const r=nee(t),n=[fp(t.getAttribute("resx")),fp(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS")||t.getAttribute("SRS"),extent:r,res:n}}function yke(t,e){const r=nee(t);if(!(!fa(r[0])||!fa(r[1])||!fa(r[2])||!fa(r[3])))return r}function vke(t,e){const r=parseFloat(t.getAttribute("min")),n=parseFloat(t.getAttribute("max"));return{min:r,max:n}}function _ke(t,e){const r=lu({},$ke,t,e);if(!fa(r))return;const n=r.westBoundLongitude,i=r.southBoundLatitude,a=r.eastBoundLongitude,s=r.northBoundLatitude;if(!(!fa(n)||!fa(i)||!fa(a)||!fa(s)))return[n,i,a,s]}function bke(t,e){return lu({},Nke,t,e)}function xke(t,e){return lu({},Fke,t,e)}function wke(t,e){return lu({},Bke,t,e)}function Ske(t,e){return lu({},zke,t,e)}function Eke(t,e){return lu({},jke,t,e)}function Tke(t,e){return lu([],Uke,t,e)}function Cke(t,e){const r=jm(t.getAttribute("queryable"));return lu({queryable:fa(r)?r:!1},oee,t,e)}function Ake(t,e){var r=e[e.length-1];const n=lu({},oee,t,e);if(!fa(n))return;let i=jm(t.getAttribute("queryable"));fa(i)||(i=r.queryable),n.queryable=fa(i)?i:!1;let a=LE(t.getAttribute("cascaded"));fa(a)||(a=r.cascaded),n.cascaded=a;let s=jm(t.getAttribute("opaque"));fa(s)||(s=r.opaque),n.opaque=fa(s)?s:!1;let o=jm(t.getAttribute("noSubsets"));fa(o)||(o=r.noSubsets),n.noSubsets=fa(o)?o:!1;let c=fp(t.getAttribute("fixedWidth"));fa(c)||(c=r.fixedWidth),n.fixedWidth=c;let f=fp(t.getAttribute("fixedHeight"));fa(f)||(f=r.fixedHeight),n.fixedHeight=f;const d=["Style","CRS","AuthorityURL"];for(let b=0,x=d.length;b<x;b++){const E=d[b],T=r[E];if(fa(T)){let A=eee(n,E,[]);A=A.concat(T),n[E]=A}}const m=["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"];for(let b=0,x=m.length;b<x;b++){const E=m[b],T=n[E];if(!fa(T)){const A=r[E];n[E]=A}}return n}function Ike(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:jm(t.getAttribute("multipleValues")),nearestValue:jm(t.getAttribute("nearestValue")),current:jm(t.getAttribute("current")),values:La(t)}}function Sp(t,e){return lu({},Yke,t,e)}function Pke(t,e){return lu({},qke,t,e)}function Mke(t,e){return lu({},Gke,t,e)}function kke(t,e){return lu({},Wke,t,e)}function yP(t,e){return lu({},Hke,t,e)}function iee(t,e){var r=Sp(t,e);if(fa(r)){const n=[LE(t.getAttribute("width")),LE(t.getAttribute("height"))];return r.size=n,r}}function Rke(t,e){var r=Sp(t,e);if(fa(r))return r.name=t.getAttribute("name"),r}function Dke(t,e){var r=Sp(t,e);if(fa(r))return r.type=t.getAttribute("type"),r}function Oke(t,e){return lu({},Xke,t,e)}function aee(t,e){return lu([],Zke,t,e)}const Au=[null,"http://www.opengis.net/wms"],Lke=Cu(Au,{Service:si(xke),Capability:si(bke)}),Nke=Cu(Au,{Request:si(Pke),Exception:si(Tke),Layer:si(Cke)}),Fke=Cu(Au,{Name:si(La),Title:si(La),Abstract:si(La),KeywordList:si(aee),OnlineResource:si(lN),ContactInformation:si(wke),Fees:si(La),AccessConstraints:si(La),LayerLimit:si(mP),MaxWidth:si(mP),MaxHeight:si(mP)}),Bke=Cu(Au,{ContactPersonPrimary:si(Ske),ContactPosition:si(La),ContactAddress:si(Eke),ContactVoiceTelephone:si(La),ContactFacsimileTelephone:si(La),ContactElectronicMailAddress:si(La)}),zke=Cu(Au,{ContactPerson:si(La),ContactOrganization:si(La)}),jke=Cu(Au,{AddressType:si(La),Address:si(La),City:si(La),StateOrProvince:si(La),PostCode:si(La),Country:si(La)}),Uke=Cu(Au,{Format:ree(La)}),oee=Cu(Au,{Name:si(La),Title:si(La),Abstract:si(La),KeywordList:si(aee),CRS:Cc(La),SRS:Cc(La),EX_GeographicBoundingBox:si(_ke),LatLonBoundingBox:si(yke),BoundingBox:Cc(mke),Dimension:Cc(Ike),Attribution:si(gke),AuthorityURL:Cc(Rke),Identifier:Cc(La),MetadataURL:Cc(Dke),DataURL:Cc(Sp),FeatureListURL:Cc(Sp),Style:Cc(Oke),MinScaleDenominator:si(c0),MaxScaleDenominator:si(c0),ScaleHint:si(vke),Layer:Cc(Ake)}),Vke=Cu(Au,{Title:si(La),OnlineResource:si(lN),LogoURL:si(iee)}),$ke=Cu(Au,{westBoundLongitude:si(c0),eastBoundLongitude:si(c0),southBoundLatitude:si(c0),northBoundLatitude:si(c0)}),qke=Cu(Au,{GetCapabilities:si(yP),GetMap:si(yP),GetFeatureInfo:si(yP)}),Hke=Cu(Au,{Format:Cc(La),DCPType:Cc(Mke)}),Gke=Cu(Au,{HTTP:si(kke)}),Wke=Cu(Au,{Get:si(Sp),Post:si(Sp)}),Xke=Cu(Au,{Name:si(La),Title:si(La),Abstract:si(La),LegendURL:Cc(iee),StyleSheetURL:si(Sp),StyleURL:si(Sp)}),Yke=Cu(Au,{Format:si(La),OnlineResource:si(lN)}),Zke=Cu(Au,{Keyword:ree(La)});class Kke{constructor(e,r){!r&&typeof window<"u"&&(r=window.DOMParser),this.version=void 0,this._parser=new ske(r),this._data=e}data(e){return this._data=e,this}toJSON(e){return e=e||this._data,this.parse(e)}parse(e){return this.readFromDocument(this._parser.toDocument(e))}readFromDocument(e){for(let r=e.firstChild;r;r=r.nextSibling)if(r.nodeType==rx.ELEMENT)return this.readFromNode(r);return null}readFromNode(e){return this.version=e.getAttribute("version"),lu({version:this.version},Lke,e,[])||null}}function see(t){const[e,r]=te.useState(),[n,i]=te.useState(t.url),[a,s]=te.useState(""),[o,c]=te.useState(),[f,d]=te.useState(),m=()=>{r(void 0),c(void 0),s("")};return te.useEffect(()=>{if(m(),d(void 0),!n)return;let b,x=n;n.indexOf("?")!==-1&&(b=n.split("?"),x=b[0]);const E=new URLSearchParams(b?.[1]),T={...Object.fromEntries(E),...t.urlParameters},A=new URLSearchParams(T),R=decodeURIComponent(A.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");fetch(x+"?"+R).then(F=>{if(F.ok)return F.text();throw Error(F.statusText+" ("+F.status+" - "+F.type+")")}).then(F=>{c(new Kke(F,window.DOMParser).toJSON())}).catch(F=>{m(),console.log(F),d(F.message)})},[n,t.urlParameters]),te.useEffect(()=>{o?.Service&&(s(o.Capability?.Request?.GetMap?.DCPType?.[0]?.HTTP?.Get?.OnlineResource),r(o.Capability?.Request?.GetFeatureInfo?.DCPType?.[0]?.HTTP?.Get?.OnlineResource))},[o]),{capabilities:o,getFeatureInfoUrl:e,wmsUrl:a,error:f,setUrl:i}}see.defaultProps={url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetCapabilities"}};const Tq=Ji(J.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"})),Cq=2*Math.PI*6378137/2,Aq=function(t,e={enable:!0,decimal:1}){const r=t.lng,n=t.lat;let i=r*Cq/180,a=Math.log(Math.tan((90+n)*Math.PI/360))/(Math.PI/180);return a=a*Cq/180,e.enable&&(i=Number(i.toFixed(e.decimal)),a=Number(a.toFixed(e.decimal))),[i,a]},Jke={mapId:void 0,url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetCapabilities"},wmsUrlParameters:{TRANSPARENT:"TRUE"},featureInfoEnabled:!0,featureInfoMarkerEnabled:!0,zoomToExtent:!1,showDeleteButton:!1,showLayerList:!0},fR=t=>{t={...Jke,...t};const{capabilities:e,error:r,setUrl:n,getFeatureInfoUrl:i,wmsUrl:a}=see({urlParameters:t.urlParameters}),[s,o]=te.useState(t?.config?.open||!1),[c,f]=te.useState(t?.config?.visible||!0),[d,m]=te.useState(!1),b=ga({mapId:t?.mapId}),[x,E]=te.useState(t?.config?.layers||[]),[T,A]=te.useState(!1),[R,F]=te.useState(),[N,O]=te.useState(void 0);te.useEffect(()=>{t.config||n(t.url)},[t.url]);const U=te.useMemo(()=>t?.config?.wmsUrl||a,[t?.config?.wmsUrl,a]),j=te.useMemo(()=>t?.config?.getFeatureInfoUrl||i,[t?.config?.getFeatureInfoUrl,i]),H=te.useMemo(()=>e,[e]),W=te.useMemo(()=>t?.name||t?.config?.name||H?.Service?.Title,[t?.name,t?.config?.name,H?.Service?.Title]),X=te.useMemo(()=>t?.setLayers&&t?.config?.layers||x,[t?.config?.layers,x]),oe=te.useMemo(()=>t?.setLayers||E,[t?.setLayers,E]);te.useEffect(()=>{t?.onConfigChange?.({layers:X,getFeatureInfoUrl:j,wmsUrl:U,visible:c,open:s,name:W})},[X,H,j,U,c,s,W]);const ee=te.useMemo(()=>X.filter(pe=>pe.visible&&pe?.Attribution?.Title).map(pe=>pe?.Attribution?.Title).filter((pe,De,ye)=>ye.indexOf(pe)===De).join(" "),[X]),G=function(){F(void 0),O(void 0)},ae=te.useCallback(pe=>{if(!b.map)return;G();const De=b.map.unproject([pe.point.x,pe.point.y]),ye=Xf([De.lng,De.lat]),we=Hwe(ye,50,{units:"meters"}),Te=we&&df(we),Re=Te&&Aq({lng:Te[0],lat:Te[1]}),de=Te&&Aq({lng:Te[2],lat:Te[3]}),xe={REQUEST:"GetFeatureInfo",BBOX:(Re&&de&&[Re[0],Re[1],de[0],de[1]])?.join(","),SERVICE:"WMS",INFO_FORMAT:H?.Capability?.Request?.GetFeatureInfo.Format.indexOf("text/html")!==-1?"text/html":"text/plain",FEATURE_COUNT:"10",LAYERS:X.map(Ke=>Ke.visible&&Ke.queryable?Ke.Name:void 0).filter(Ke=>Ke),QUERY_LAYERS:X.map(Ke=>Ke.visible&&Ke.queryable?Ke.Name:void 0).filter(Ke=>Ke),STYLES:"",WIDTH:100,HEIGHT:100,srs:"EPSG:3857",CRS:"EPSG:3857",version:"1.3.0",X:50,Y:50,I:50,J:50,buffer:"50"};let Ne=j,Fe;Ne?.indexOf?.("?")!==-1&&(Fe=t?.url?.split("?")||t?.config?.wmsUrl?.split("?"),Ne=Fe?.[0]);const Xe=new URLSearchParams(Fe?.[1]),Be={...Object.fromEntries(Xe),...xe},ot=new URLSearchParams(Be);fetch(t.url+"?"+ot.toString()).then(Ke=>{if(!Ke.ok)throw new Error("FeatureInfo could not be fetched");return Ke.text()}).then(Ke=>{F(pe.lngLat),O(Ke),t.featureInfoSuccess?.(Ke,pe.lngLat)}).catch(Ke=>console.log(Ke))},[H,j,t,b,X]),se=te.useMemo(()=>(typeof t?.featureInfoActive<"u"&&t.featureInfoActive||T)&&X?.some(pe=>pe.visible&&pe.queryable)&&!!b.map,[t?.featureInfoActive,T,X,b.map]);te.useEffect(()=>{if(!se){G();return}const pe=ae;return b.map.map.on("click",pe),()=>{b.map?.map.off?.("click",pe)}},[se,ae,b.map]),te.useEffect(()=>{if(!H?.Service)return;let pe=[];if(H?.Capability?.Layer?.CRS?.indexOf?.("EPSG:3857")===-1&&H?.Capability?.Layer?.CRS?.indexOf?.("CRS:84")===-1)console.log("MlWmsLoader ("+H.Service.Title+"): No WGS 84/Pseudo-Mercator support");else{console.log("MlWmsLoader ("+H.Service.Title+"): WGS 84/Pseudo-Mercator supported");let De=H?.Capability?.Layer?.Layer.filter(ye=>!ye.Layer?.length).map((ye,we)=>(we===0&&(pe=ye.EX_GeographicBoundingBox||ye?.LatLonBoundingBox||[]),{visible:t.visibleLayersAtStart?t.visibleLayersAtStart.includes(ye.Name||""):!0,Attribution:{Title:""},...(({CRS:Re,...de})=>de)(ye)}));H?.Capability?.Layer?.Layer.forEach(ye=>{const we=ye?.Layer?.filter(Te=>Te.CRS?.length).map((Te,Re)=>(Re===0&&(pe=Te.EX_GeographicBoundingBox||Te?.LatLonBoundingBox||[]),{visible:t.visibleLayersAtStart&&Te.Name?t.visibleLayersAtStart.includes(Te.Name):!1,Attribution:{Title:""},...(({CRS:Ee,...xe})=>xe)(Te)}));we&&(De=[...De,...we])}),oe(De),t.zoomToExtent&&b?.map&&pe.length>3&&b?.map.fitBounds([[pe[0],pe[1]],[pe[2],pe[3]]])}},[H,b.map]);const fe=J.jsxs(qf,{secondaryAction:J.jsxs(J.Fragment,{children:[t.buttons,t.featureInfoEnabled&&J.jsx(uf,{sx:{padding:"4px",marginTop:"-3px",marginRight:"4px",background:pe=>X?.some(De=>De.visible&&De.queryable)?se?pe.palette.info.light:pe.palette.grey[300]:"initial"},"aria-label":"featureinfo",onClick:()=>{typeof t?.setFeatureInfoActive=="function"?t.setFeatureInfoActive(pe=>!pe):A(pe=>!pe)},disabled:!X?.some(pe=>pe.visible&&pe.queryable),children:J.jsx(Tq,{})}),J.jsx(uf,{edge:t.showDeleteButton?!1:"end",sx:{padding:"4px",marginTop:"-3px",...t.showDeleteButton?{marginRight:"4px"}:{}},"aria-label":"open",onClick:()=>o(pe=>!pe),children:s?J.jsx(TJ,{}):J.jsx(mE,{})}),t.showDeleteButton&&J.jsxs(J.Fragment,{children:[J.jsx(uf,{"aria-label":"delete",edge:"end",onClick:()=>{typeof t.onConfigChange=="function"&&m(!0)},sx:{padding:"4px",marginTop:"-3px"},children:J.jsx(Ux,{})}),d&&J.jsx(Z0,{open:d,onConfirm:()=>{typeof t.onConfigChange=="function"&&t.onConfigChange(!1)},onCancel:()=>{m(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]})]}),sx:{paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"},children:[J.jsx(Fb,{sx:{minWidth:"30px"},children:J.jsx(z0,{sx:{padding:0},checked:c,onClick:()=>{f(pe=>!pe)}})}),J.jsx(Df,{primary:W,variant:"layerlist"})]});return J.jsxs(J.Fragment,{children:[r&&J.jsx(Mye,{children:J.jsx(Jo,{children:r})}),U&&J.jsxs(J.Fragment,{children:[t.showLayerList&&J.jsxs(J.Fragment,{children:[t.sortable&&J.jsx(ME,{children:fe}),!t.sortable&&fe,J.jsx(Jo,{sx:{display:s?"block":"none"},children:J.jsx(kh,{dense:!0,component:"div",disablePadding:!0,sx:{paddingLeft:"18px"},children:U&&X?.map?.((pe,De)=>pe?.Name?J.jsxs(qf,{secondaryAction:J.jsx(J.Fragment,{children:pe?.queryable&&J.jsx(Tq,{})}),children:[J.jsx(Fb,{sx:{minWidth:"30px"},children:J.jsx(z0,{checked:pe.visible,sx:{padding:0},onClick:()=>{const ye=[...X];ye[De].visible=!ye[De].visible,oe([...ye])}})}),J.jsx(Df,{primary:pe?.Title,variant:"layerlist"})]},pe.Name+De):J.jsx(J.Fragment,{}))})})]}),U&&X?.length&&J.jsx(OE,{layerId:t.layerId||b.componentId,url:U,attribution:ee,visible:c,urlParameters:{...t.wmsUrlParameters,layers:X?.filter?.(pe=>pe.visible).map(pe=>pe.Name).reverse().join(",")},insertBeforeLayer:t?.insertBeforeLayer},b.componentId),t.featureInfoEnabled&&t.featureInfoMarkerEnabled&&R&&J.jsx(uR,{...R,content:N})]})]})};try{fR.displayName="MlWmsLoader",fR.__docgenInfo={description:`Loads a WMS getCapabilities xml document and adds a MlWmsLayer component for each layer that is
offered by the WMS.`,displayName:"MlWmsLoader",props:{url:{defaultValue:null,description:"WMS URL",name:"url",required:!1,type:{name:"string | undefined"}},mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerId:{defaultValue:null,description:"",name:"layerId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},urlParameters:{defaultValue:null,description:"URL parameters that will be used in the getCapabilities request",name:"urlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},wmsUrlParameters:{defaultValue:null,description:"URL parameters that will be added when requesting WMS capabilities",name:"wmsUrlParameters",required:!1,type:{name:"{ [key: string]: string; } | undefined"}},zoomToExtent:{defaultValue:null,description:"If true, zooms to the extent of the WMS layer after loading the getCapabilities response",name:"zoomToExtent",required:!1,type:{name:"boolean | undefined"}},name:{defaultValue:null,description:"The name of the ListItem element representing the WmsLoader",name:"name",required:!1,type:{name:"string | undefined"}},featureInfoEnabled:{defaultValue:null,description:"If true, enables the feature info functionality",name:"featureInfoEnabled",required:!1,type:{name:"boolean | undefined"}},featureInfoActive:{defaultValue:null,description:"If true, the feature info functionality is active",name:"featureInfoActive",required:!1,type:{name:"boolean | undefined"}},setFeatureInfoActive:{defaultValue:null,description:"A function to set the feature info active state",name:"setFeatureInfoActive",required:!1,type:{name:"((val: boolean | ((current: boolean) => boolean)) => void) | undefined"}},featureInfoSuccess:{defaultValue:null,description:"Callback function that is called after the featureInfoRequest has succeeded",name:"featureInfoSuccess",required:!1,type:{name:"((content: string, lngLat: { lng: number; lat: number; }) => void) | undefined"}},featureInfoMarkerEnabled:{defaultValue:null,description:"If true, displays a marker at the feature info location",name:"featureInfoMarkerEnabled",required:!1,type:{name:"boolean | undefined"}},config:{defaultValue:null,description:"The WMS configuration object",name:"config",required:!1,type:{name:"WmsConfig | undefined"}},onConfigChange:{defaultValue:null,description:"A function to handle changes to the WMS configuration",name:"onConfigChange",required:!1,type:{name:"((config: false | WmsConfig) => void) | undefined"}},setLayers:{defaultValue:null,description:"A function to update a LayerType config array that is passed to this component at props.config.layers",name:"setLayers",required:!1,type:{name:"((layers: LayerType[]) => void) | undefined"}},showDeleteButton:{defaultValue:null,description:"If true, shows the delete button for the WMSLoader",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},buttons:{defaultValue:null,description:"Custom buttons to display for the WMSLoader",name:"buttons",required:!1,type:{name:"Element | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},visibleLayersAtStart:{defaultValue:null,description:"Array of layer Names (IDs) that should be visible at start. If not provided, default visibility logic applies.",name:"visibleLayersAtStart",required:!1,type:{name:"string[] | undefined"}},showLayerList:{defaultValue:null,description:"If true, renders the layer list UI. If false, only the WMS layer is rendered without UI controls.",name:"showLayerList",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function hR(t){const e={"circle-color":"rgba(0,0,0,0)"},r={"fill-color":"rgba(0,0,0,0)","fill-outline-color":"rgba(0,0,0,0)"},n={"line-color":"rgba(0,0,0,0)"},i=["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,0,t.currentVal,1,t.currentVal+t.fadeOut*t.step,0],a=["interpolate",["linear"],["get",t.timeField],t.currentVal,1,t.currentVal+t.fadeOut*t.step,0],s={"fill-color":t.featuresColor,"fill-opacity":i,"fill-outline-color":["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,"rgba(255, 0, 0, 0)",t.currentVal,"rgb(0,0,0)",t.currentVal+t.fadeIn*t.step,"rgba(255, 0, 0, 0)"]},o={"circle-color":t.featuresColor,"circle-radius":["interpolate",["linear"],["get",t.timeField],t.currentVal-t.fadeIn*t.step,1,t.currentVal,20,t.currentVal+t.fadeOut*t.step,1],"circle-opacity":i},c={"line-color":t.featuresColor,"line-width":3,"line-opacity":i},f={"circle-color":t.featuresColor,"circle-radius":["interpolate",["linear"],["get",t.timeField],t.currentVal,20,t.currentVal+t.fadeOut*t.step,1],"circle-opacity":a},d={"fill-color":t.featuresColor,"fill-opacity":a,"fill-outline-color":["interpolate",["linear"],["get",t.timeField],t.currentVal,"rgb(0,0,0)",t.currentVal+t.fadeIn*t.step,"rgba(255, 0, 0, 0)"]},m={"line-color":t.featuresColor,"line-width":3,"line-opacity":a};if(t.userPaint!==void 0)return t.userPaint;switch(t.type){case"circle":return t.currentVal===t.minVal&&!t.isPlaying?e:t.accumulate?f:o;case"fill":return t.currentVal===t.minVal&&!t.isPlaying?r:t.accumulate?d:s;case"line":return t.currentVal===t.minVal&&!t.isPlaying?n:t.accumulate?m:c;case void 0:return t.currentVal===t.minVal&&!t.isPlaying?e:t.accumulate?f:o}}try{hR.displayName="paintPicker",hR.__docgenInfo={description:"",displayName:"paintPicker",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:"undefined"},{value:'"fill"'},{value:'"circle"'},{value:'"line"'}]}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},featuresColor:{defaultValue:null,description:"",name:"featuresColor",required:!0,type:{name:"string"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},userPaint:{defaultValue:null,description:"",name:"userPaint",required:!0,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | { ...; } | { ...; } | undefined'}}}}}catch{}function dR(t){const e=t.currentVal-t.fadeIn*t.step,r=t.currentVal+t.fadeIn*t.step,n={"text-color":"rgba(0,0,0,0)"},i={"text-color":t.labelColor,"text-opacity":["interpolate",["linear"],["get",t.timeField],e,0,t.currentVal,1,r,0]},a={"text-color":t.labelColor,"text-opacity":["interpolate",["linear"],["get",t.timeField],t.currentVal,1,r,0]},s=()=>t.currentVal===t.minVal&&!t.isPlaying?n:t.accumulate?a:i,o={"text-field":["get",t.labelField],"text-font":["Metropolis Regular"]};return J.jsx(kE,{options:{type:"symbol",layout:t.labelLayout||o,paint:t.labelPaint||s()},geojson:t.data,layerId:"timeControllerLabels"})}try{dR.displayName="MlTemporalControllerLabels",dR.__docgenInfo={description:"",displayName:"MlTemporalControllerLabels",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},labelField:{defaultValue:null,description:"",name:"labelField",required:!0,type:{name:"string"}},labelColor:{defaultValue:null,description:"",name:"labelColor",required:!0,type:{name:"string"}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},labelLayout:{defaultValue:null,description:"",name:"labelLayout",required:!1,type:{name:"any"}},labelPaint:{defaultValue:null,description:"",name:"labelPaint",required:!1,type:{name:"SymbolLayerSpecification | undefined"}}}}}catch{}const Qke=Ji(J.jsx("path",{d:"M8 5v14l11-7z"})),eRe=Ji(J.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"})),tRe=Ji(J.jsx("path",{d:"M6 6h12v12H6z"})),rRe=Ji(J.jsx("path",{d:"m4 18 8.5-6L4 6zm9-12v12l8.5-6z"})),nRe=Ji(J.jsx("path",{d:"M11 18V6l-8.5 6zm.5-6 8.5 6V6z"})),iRe={marginLeft:"15%",marginBottom:"3%",width:"70%",height:"90px",alignItems:"center"},aRe={top:"10%",height:"100px",alignItems:"center"};function pR(t){const[e,r]=te.useState(t.currentVal),[n,i]=te.useState(t.isPlaying),a=t.maxVal-t.minVal,s=te.useRef(null),o=kx(E=>E.breakpoints.down("md"));te.useEffect(()=>()=>{s.current&&clearInterval(s.current)},[]),te.useEffect(()=>{t.returnCurrent(e),t.returnPlaying(n)},[e,n]);const c=gt.useCallback(()=>{let E=e-t.minVal;s.current&&clearInterval(s.current),s.current=setInterval(function(){E>=a?(s.current&&clearInterval(s.current),i(!1)):r(T=>T+t.step),E=E+t.step},t.interval)},[t.step,t.maxVal,e]),f=()=>{n?(i(!1),n&&s.current&&clearInterval(s.current)):(i(!0),c())},d=()=>{s.current&&clearInterval(s.current),r(t.minVal),i(!1)},m=()=>{n?(s.current&&clearInterval(s.current),r(e-a/10),c()):r(e-a/10)},b=()=>{n?(s.current&&clearInterval(s.current),r(e+a/10),c()):r(e+a/10)},x=(E,T)=>{n?E&&(s.current&&clearInterval(s.current),r(T),c()):r(T)};return J.jsx(J.Fragment,{children:J.jsxs(uO,{anchor:"bottom",open:t.open||!0,variant:"persistent",sx:{flexShrink:0,"& .MuiDrawer-paper":o?aRe:iRe},children:[J.jsxs(up,{container:!0,alignItems:"center",justifyContent:"space-between",children:[J.jsxs(up,{item:!0,xs:12,sm:10,textAlign:"center",children:[J.jsx(ta,{onClick:m,children:J.jsx(nRe,{})}),J.jsx(ta,{onClick:d,children:J.jsx(tRe,{})}),J.jsx(ta,{onClick:f,children:n?J.jsx(eRe,{}):J.jsx(Qke,{})}),J.jsx(ta,{onClick:b,children:J.jsx(rRe,{})})]}),t.display&&!o&&J.jsx(up,{item:!0,xs:12,sm:5,textAlign:"right",children:J.jsx(Es,{variant:"h5",sx:{paddingRight:"25px"},children:Math.floor(e)})})]}),J.jsx(pO,{sx:{position:"flex",width:"95%",paddingTop:"10px",alignSelf:"center"},"aria-label":"Custom marks",defaultValue:t.minVal,value:e,step:t.step,onChange:x,min:t.minVal,max:t.maxVal}),o&&t.display&&J.jsx(Es,{variant:"body1",textAlign:"right",children:Math.floor(e)})]})})}try{pR.displayName="TemporalControllerPlayer",pR.__docgenInfo={description:"",displayName:"TemporalControllerPlayer",props:{currentVal:{defaultValue:null,description:"",name:"currentVal",required:!0,type:{name:"number"}},isPlaying:{defaultValue:null,description:"",name:"isPlaying",required:!0,type:{name:"boolean"}},step:{defaultValue:null,description:"",name:"step",required:!0,type:{name:"number"}},interval:{defaultValue:null,description:"",name:"interval",required:!0,type:{name:"number"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!0,type:{name:"number"}},maxVal:{defaultValue:null,description:"",name:"maxVal",required:!0,type:{name:"number"}},returnCurrent:{defaultValue:null,description:"",name:"returnCurrent",required:!0,type:{name:"Dispatch<SetStateAction<number>>"}},returnPlaying:{defaultValue:null,description:"",name:"returnPlaying",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}},fadeIn:{defaultValue:null,description:"",name:"fadeIn",required:!0,type:{name:"number"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},fadeOut:{defaultValue:null,description:"",name:"fadeOut",required:!0,type:{name:"number"}},featuresColor:{defaultValue:null,description:"",name:"featuresColor",required:!0,type:{name:"string"}},labels:{defaultValue:null,description:"",name:"labels",required:!0,type:{name:"boolean"}},labelColor:{defaultValue:null,description:"",name:"labelColor",required:!0,type:{name:"string"}},labelFadeIn:{defaultValue:null,description:"",name:"labelFadeIn",required:!0,type:{name:"number"}},labelFadeOut:{defaultValue:null,description:"",name:"labelFadeOut",required:!0,type:{name:"number"}},accumulate:{defaultValue:null,description:"",name:"accumulate",required:!0,type:{name:"boolean"}},display:{defaultValue:null,description:"",name:"display",required:!0,type:{name:"boolean"}}}}}catch{}function oRe(t,e){if(t?.features){const r=[...t.features?t.features:[]];return r.sort((n,i)=>n.properties?.[e]<i.properties?.[e]?1:-1),r[r.length-1]?.properties?.[e]||0}return 0}function sRe(t,e){if(t?.features){const r=[...t?.features?t.features:[]];return r.sort((n,i)=>n.properties?.[e]<i.properties?.[e]?-1:1),r[r.length-1]?.properties?.[e]||0}return 0}function gR(t){const e=ga({mapId:t.mapId}),r=te.useMemo(()=>t.minVal?t.minVal:oRe(t.geojson,t.timeField),[t.minVal,t.geojson,t.timeField]),n=te.useMemo(()=>t.maxVal?t.maxVal:sRe(t.geojson,t.timeField),[t.maxVal,t.geojson,t.timeField]);return{filteredData:te.useMemo(()=>{if(t.geojson!==void 0&&e.map&&r&&n)return xp(t.geojson.features.filter(a=>a.properties?.[t.timeField]>=r&&a.properties?.[t.timeField]<=n))},[t.geojson,e.map,t.timeField]),minVal:r,maxVal:n}}try{gR.displayName="useFilterData",gR.__docgenInfo={description:"",displayName:"useFilterData",props:{geojson:{defaultValue:null,description:"",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},timeField:{defaultValue:null,description:"",name:"timeField",required:!0,type:{name:"string"}},initialVal:{defaultValue:null,description:"",name:"initialVal",required:!1,type:{name:"number | undefined"}},minVal:{defaultValue:null,description:"",name:"minVal",required:!1,type:{name:"number | undefined"}},maxVal:{defaultValue:null,description:"",name:"maxVal",required:!1,type:{name:"number | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!0,type:{name:"string | undefined"}}}}}catch{}const Iq=({mapId:t=void 0,insertBeforeLayer:e,geojson:r,ownLayer:n=!0,attribution:i="",type:a="circle",timeField:s,minVal:o,maxVal:c,initialVal:f,accumulate:d=!1,fitBounds:m=!0,paint:b,featuresColor:x,step:E=1,interval:T=200,fadeIn:A=5,fadeOut:R=5,label:F=!0,labelColor:N,labelField:O=[],labelFadeIn:U=5,labelFadeOut:j=5,displayCurrentValue:H=!1,onClick:W,onHover:X,onLeave:oe,onStateChange:ee})=>{const G=ga({mapId:t,waitForLayer:e}),{filteredData:ae,minVal:se,maxVal:fe}=gR({geojson:r,timeField:s,minVal:o,maxVal:c,mapId:t}),pe=Nc(),[De,ye]=te.useState(f||se),we=x||pe.palette.primary.main,Te=N||pe.palette.text.primary,[Re,de]=te.useState(!1),Ee=hR({type:a,timeField:s,currentVal:De,minVal:se,isPlaying:Re,fadeIn:A,fadeOut:R,step:E,featuresColor:we,accumulate:d,userPaint:b});return te.useEffect(()=>{!f&&se?ye(se):f&&ye(f)},[]),te.useEffect(()=>{typeof ee=="function"&&ee({current:De,paint:Ee})},[ee]),te.useEffect(()=>{if(m&&typeof ae<"u"){const xe=df(ae);G.map?.map.fitBounds(xe)}},[ae]),te.useEffect(()=>{if(!G.map)return;let xe,Ne,Fe;return W&&(xe=W,G.map?.on("click","timeController",xe)),X&&(Ne=X,G.map?.on("mouseenter","timeController",Ne)),oe&&(Fe=oe,G.map?.on("mouseleave","timeController",Fe)),()=>{xe&&G.map?.off("click","timeController",xe),Ne&&G.map?.off("mouseenter","timeController",Ne),Fe&&G.map?.off("mouseleave","timeController",Fe)}},[G.map,W,X,oe]),J.jsxs(J.Fragment,{children:[ae&&n&&J.jsx(Dc,{type:a,mapId:t,options:{source:{type:"geojson",attribution:i,data:ae},paint:{...b||Ee},layout:{visibility:"visible"}}}),ae&&F&&J.jsx(dR,{data:ae,currentVal:De,fadeIn:U,fadeOut:j,step:E,labelField:O,labelColor:Te,timeField:s,minVal:se,accumulate:d,isPlaying:Re}),J.jsx(pR,{currentVal:De,isPlaying:Re,step:E,interval:T,minVal:se,maxVal:fe,returnCurrent:ye,returnPlaying:de,open:!1,fadeIn:A,fadeOut:R,featuresColor:we,labels:F,labelColor:Te,labelFadeIn:U,labelFadeOut:j,accumulate:d,display:H})]})};try{Iq.displayName="MlTemporalController",Iq.__docgenInfo={description:"",displayName:"MlTemporalController",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order.
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},geojson:{defaultValue:null,description:"GeoJSON data that is supposed to be rendered by this component.",name:"geojson",required:!0,type:{name:"FeatureCollection<Geometry, GeoJsonProperties>"}},ownLayer:{defaultValue:{value:"true"},description:"If true,the component creates and loads a MlGeoJsonLayer to show the data.",name:"ownLayer",required:!1,type:{name:"boolean | undefined"}},attribution:{defaultValue:{value:""},description:"MapLibre attribution shown in the bottom right of the map, if this layer is visible",name:"attribution",required:!1,type:{name:"string | undefined"}},type:{defaultValue:{value:"circle"},description:`Type of the layer that will be added to the MapLibre instance.
Possible values: "line", "circle", "fill"`,name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"fill"'},{value:'"circle"'},{value:'"line"'}]}},timeField:{defaultValue:null,description:"Property field where the time informations is available.",name:"timeField",required:!0,type:{name:"string"}},minVal:{defaultValue:null,description:`Lowest time value to be shown in the time line.
By default, it is set to the lowest value in the time field.`,name:"minVal",required:!1,type:{name:"number | undefined"}},label:{defaultValue:{value:"true"},description:'When true, a label layer will be added by the component. In that case, the "labelField" propertie is mandatory.',name:"label",required:!1,type:{name:"boolean | undefined"}},labelField:{defaultValue:{value:"[]"},description:"Property field where the label information is available.",name:"labelField",required:!1,type:{name:"string | undefined"}},maxVal:{defaultValue:null,description:`Highest time value to be shown in the time line.
By default, it is set to the highest value in the time field.`,name:"maxVal",required:!1,type:{name:"number | undefined"}},initialVal:{defaultValue:null,description:`the value at which the component is to be loaded.
If not specified, the component starts at the minimum value.`,name:"initialVal",required:!1,type:{name:"number | undefined"}},accumulate:{defaultValue:{value:"false"},description:`When true, the features will be accumulated in the map.
This option ist by default false.`,name:"accumulate",required:!1,type:{name:"boolean | undefined"}},fitBounds:{defaultValue:{value:"true"},description:`When true, the component will fit the map bounds to the shown features.
This option ist by default true.`,name:"fitBounds",required:!1,type:{name:"boolean | undefined"}},showControls:{defaultValue:null,description:"Boolean value that disables and enables the controls drawer.",name:"showControls",required:!1,type:{name:"boolean | undefined"}},paint:{defaultValue:null,description:`Paint property object for the features layer.
Possible props depend on the layer type.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill`,name:"paint",required:!1,type:{name:'{ "circle-radius"?: DataDrivenPropertyValueSpecification<number> | undefined; "circle-radius-transition"?: TransitionSpecification | undefined; ... 16 more ...; "circle-stroke-opacity-transition"?: TransitionSpecification | undefined; } | { ...; } | { ...; } | undefined'}},featuresColor:{defaultValue:null,description:"Sets the color of the features rendered by this component.",name:"featuresColor",required:!1,type:{name:"string | undefined"}},step:{defaultValue:{value:"1"},description:`How many units the timeline runs through at each step.
By default it is set to 1.`,name:"step",required:!1,type:{name:"number | undefined"}},interval:{defaultValue:{value:"200"},description:`The time between each addition to the counter, expressed in milliseconds.
By default, 200 ms.`,name:"interval",required:!1,type:{name:"number | undefined"}},fadeIn:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps before the feature starts to appear.
By default it is set to 5 steps.`,name:"fadeIn",required:!1,type:{name:"number | undefined"}},fadeOut:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps the feature fades out after it proper time value.
By default it is set to 5 steps.`,name:"fadeOut",required:!1,type:{name:"number | undefined"}},labelColor:{defaultValue:null,description:"Sets the color of the features rendered by this component.",name:"labelColor",required:!1,type:{name:"string | undefined"}},labelLayout:{defaultValue:null,description:`Layout property object, that is passed to the labels layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#symbol`,name:"labelLayout",required:!1,type:{name:"any"}},labelPaint:{defaultValue:null,description:`Paint property object for the features layer.
https://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#symbol`,name:"labelPaint",required:!1,type:{name:"any"}},labelFadeIn:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps before the labels start to appear.
By default it is set to 5 steps.`,name:"labelFadeIn",required:!1,type:{name:"number | undefined"}},labelFadeOut:{defaultValue:{value:"5"},description:`A numeric value that sets how many steps the labels fade out after their proper time value.
By default it is set to 5 steps.`,name:"labelFadeOut",required:!1,type:{name:"number | undefined"}},displayCurrentValue:{defaultValue:{value:"false"},description:"If true, the current time value will be displayed in the controlls panel.",name:"displayCurrentValue",required:!1,type:{name:"boolean | undefined"}},onClick:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked.",name:"onClick",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onHover:{defaultValue:null,description:"Click event handler that is executed whenever a geometry rendered by this component is hovered.",name:"onHover",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onLeave:{defaultValue:null,description:`Leave event handler that is executed whenever a geometry rendered by this component is
left/unhovered.`,name:"onLeave",required:!1,type:{name:"((ev: MapEventType) => void | Map$1) | undefined"}},onStateChange:{defaultValue:null,description:"Callback function defined by the user to recive the current time value and paint property in the parent component.",name:"onStateChange",required:!1,type:{name:"Dispatch<SetStateAction<TemporalControllerValues | undefined>> | undefined"}}}}}catch{}const NE=t=>{const e=t?.layerIds.toReversed();return J.jsx(J.Fragment,{children:e&&e.map((r,n)=>{const i=n>0?e[n-1]:t.insertBeforeLayer;return J.jsx(kE,{layerId:r,insertBeforeLayer:i},r)})})};try{NE.displayName="MlOrderLayers",NE.__docgenInfo={description:"Creates an invisible layer for each entry in props.layerIds with the id `order-{entry}` and a reliable order",displayName:"MlOrderLayers",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},layerIds:{defaultValue:null,description:"",name:"layerIds",required:!0,type:{name:"string[]"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const Pq=t=>{const e=ga({mapId:"map_1"});return te.useEffect(()=>{if(e.map)return e.map.map.getSource("terrain")||e.map.map.addSource("terrain",{type:"raster-dem",encoding:"mapbox",maxzoom:12,minzoom:4,...t.sourceOptions}),e.map.map.setTerrain({source:"terrain",exaggeration:1,...t.terrainOptions}),e.map.addLayer({id:"hills",type:"hillshade",source:"terrain",layout:{visibility:"visible"},paint:{"hillshade-shadow-color":"rgba(71,59,36,0.4)"}}),()=>{e.map?.map.setTerrain(null),e.map?.map.getSource("terrain")&&(e.map.map.removeLayer("hills"),e.map.map.removeSource("terrain"))}},[e.map,t.sourceOptions,t.terrainOptions]),J.jsx(J.Fragment,{})};try{Pq.displayName="MlTerrainLayer",Pq.__docgenInfo={description:"Create Terrain Layer Component",displayName:"MlTerrainLayer",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},sourceOptions:{defaultValue:null,description:"Source of tiles with possibles options",name:"sourceOptions",required:!1,type:{name:"object | undefined"}},terrainOptions:{defaultValue:null,description:"Options for new exaggeration value",name:"terrainOptions",required:!1,type:{name:"TerrainSpecification | undefined"}}}}}catch{}const lRe=Ji(J.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),uRe=Ji([J.jsx("circle",{cx:"7",cy:"14",r:"3"},"0"),J.jsx("circle",{cx:"11",cy:"6",r:"3"},"1"),J.jsx("circle",{cx:"16.6",cy:"17.6",r:"3"},"2")]),cRe=[{name:"Point",mode:"draw_point",icon:J.jsx(uRe,{})},{name:"LineString",mode:"draw_line_string",icon:J.jsx(SJ,{})},{name:"Polygon",mode:"draw_polygon",icon:J.jsx(EJ,{})}],Mq=t=>{const e=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),[r,n]=te.useState(),[i,a]=te.useState({activeGeometryIndex:void 0,selectedGeoJson:void 0,geometries:[],drawMode:void 0});console.log(i),te.useEffect(()=>{typeof t.onChange=="function"&&t.onChange(i)},[i,t.onChange]);const s={...t.buttonStyleOverride},o=m=>{let b;a(x=>(b=x.drawMode,{...x,drawMode:void 0,activeGeometryIndex:void 0,selectedGeoJson:void 0})),requestAnimationFrame(()=>{a(x=>(b==="draw_polygon"||b==="draw_line_string")&&m==="draw_point"?{...x,drawMode:void 0}:{...x,drawMode:m})})},c=m=>{a(b=>{const x=[...b.geometries];return x.splice(x.indexOf(m),1),{...b,drawMode:void 0,geometries:x,activeGeometryIndex:b.activeGeometryIndex?b.activeGeometryIndex-1:void 0}})},f=m=>{t.onShowInstructionChange?.(m.target.checked)},d=()=>J.jsx(J.Fragment,{children:cRe.map(m=>{const b=E=>i.drawMode===m.mode?E.palette.primary.main:E.palette.navigation.navColor,x=E=>i.drawMode!==m.mode?E.palette.primary.main:E.palette.navigation.navColor;return J.jsx(J.Fragment,{children:J.jsx(cg,{title:m.name,children:J.jsx(ta,{sx:{color:x,backgroundColor:b,"&:hover":{backgroundColor:b},...s},onClick:()=>o(m.mode),children:m.icon},m.name)})})})});return J.jsxs(J.Fragment,{children:[J.jsx(Mv,{sx:{zIndex:104},children:J.jsx(UM,{children:J.jsx(d,{})})}),J.jsx(Mv,{sx:{marginTop:"10px"},children:J.jsx(uY,{children:J.jsx($M,{control:J.jsx(z0,{size:"small",checked:t.showInstruction,onChange:f}),label:"Show instructions"})})}),i.drawMode&&J.jsx(pE,{mode:i.drawMode,geojson:i.selectedGeoJson,onChange:m=>{console.log("Features: ",m),m?.[0]&&a(b=>{const x=[...i.geometries];if(typeof b.activeGeometryIndex>"u"){const T=m[0];T&&T.properties?T.properties.id=T.id:console.error("tempFeature or tempFeature.properties is null or undefined"),b.activeGeometryIndex=x.length,x.push(T)}else x[b.activeGeometryIndex]=m[0];return(()=>{if(b.selectedGeoJson&&typeof b.activeGeometryIndex<"u"&&b.geometries[b.activeGeometryIndex]&&b.geometries[b.activeGeometryIndex].geometry.type==="Point"){const T=b.selectedGeoJson?.geometry?.coordinates,A=b.geometries[b.activeGeometryIndex]?.geometry?.coordinates;return JSON.stringify(T)!==JSON.stringify(A)}return!1})()&&(b.drawMode=void 0),{...b,geometries:x}})},onFinish:()=>{a(m=>({...m,drawMode:void 0,activeGeometryIndex:void 0,selectedGeoJson:void 0}))}}),J.jsxs(kh,{sx:{zIndex:105,marginBottom:"-10px"},children:[i.geometries.map((m,b)=>J.jsxs(Mv,{sx:{display:"flex",flexDirection:"column"},children:[J.jsx("br",{}),J.jsxs(Mv,{flexDirection:"row",sx:{"&:hover":{backgroundColor:"rgb(177, 177, 177, 0.2)"},marginTop:"25px"},onMouseOver:()=>{n(m)},onMouseLeave:()=>{n(void 0)},children:[!m.properties?.customName&&J.jsx("input",{type:"text",value:m.properties?.name||"",placeholder:"Assign name",onChange:x=>{const E=x.target.value;a(T=>{const A=[...T.geometries];return A[b].properties||(A[b].properties={}),A[b].properties.name=E,{...T,geometries:A}})},style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",outline:"none"},onFocus:x=>x.target.style.borderColor="#009ee0",onBlur:x=>{x.target.style.borderColor="#ccc",a(E=>{const T=[...E.geometries];return T[b].properties||(T[b].properties={}),T[b].properties.customName=!0,{...E,geometries:T}})}}),J.jsx(cp,{listItemSx:s,configurable:!0,visible:!0,layerComponent:J.jsx(Dc,{mapId:t.mapId,geojson:m,layerId:String(m.id),defaultPaintOverrides:{fill:{"fill-opacity":.5}}}),type:"layer",name:J.jsx(Es,{onClick:()=>{a(x=>{const E=[...x.geometries];return E[b].properties||(E[b].properties={}),E[b].properties.customName=!1,{...x,geometries:E}})},sx:{cursor:"pointer",overflow:"hidden",whiteSpace:"nowrap"},children:m.properties?.name||String(m.id)}),description:m.geometry.type}),J.jsx(Mv,{sx:{padding:"3px 30px"},children:J.jsxs(UM,{size:"small",children:[J.jsx(cg,{title:"Center",children:J.jsx(ta,{sx:{color:x=>x.palette.primary.main,backgroundColor:x=>x.palette.navigation.navColor,...s},onClick:()=>{e?.map?.map.setCenter(m.geometry.type==="Point"?m.geometry.coordinates:sL(m).geometry.coordinates)},children:J.jsx(uL,{})})}),J.jsx(cg,{title:"Edit",children:J.jsx(ta,{sx:{color:x=>i.drawMode==="simple_select"&&i.selectedGeoJson?.id===m.id?x.palette.navigation.navColor:x.palette.primary.main,backgroundColor:x=>i.drawMode==="simple_select"&&i.selectedGeoJson?.id===m.id?x.palette.primary.main:x.palette.navigation.navColor,...s},onClick:()=>{a(x=>{const E=x.drawMode==="simple_select"&&x.selectedGeoJson?.id===m.id?void 0:"simple_select";return{...x,selectedGeoJson:m,activeGeometryIndex:x.geometries.indexOf(m),drawMode:E}})},children:J.jsx(lRe,{})})}),J.jsx(cg,{title:"Delete",children:J.jsx(ta,{sx:{color:x=>x.palette.primary.main,backgroundColor:x=>x.palette.navigation.navColor,...s},onClick:()=>{c(m),n(void 0)},children:J.jsx(Ux,{})})})]})})]})]},m.id)),r&&J.jsx(Dc,{mapId:t.mapId,geojson:{type:"FeatureCollection",features:[r]},layerId:"highlightBorder",defaultPaintOverrides:{circle:{"circle-color":"#000000","circle-opacity":.2,"circle-radius":10},line:{"line-color":"#000000","line-opacity":.2,"line-width":10},fill:{"fill-color":"#000000","fill-opacity":.2}}})]})]})};try{Mq.displayName="MlSketchTool",Mq.__docgenInfo={description:"Component template",displayName:"MlSketchTool",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},buttonStyleOverride:{defaultValue:null,description:`Style attribute for the button-style
https://mui.com/system/getting-started/the-sx-prop/`,name:"buttonStyleOverride",required:!1,type:{name:"SxProps | undefined"}},onChange:{defaultValue:null,description:"Callback function that is called each time GeoJson data has changed within MlSketchTool.\nFirst parameter contains all geometries in the `geometries` prop.",name:"onChange",required:!1,type:{name:"((para: SketchStateType) => void) | undefined"}},showInstruction:{defaultValue:null,description:"Determines whether the instruction text should be shown.",name:"showInstruction",required:!1,type:{name:"boolean | undefined"}},onShowInstructionChange:{defaultValue:null,description:'Callback function triggered when the "Show instructions" checkbox is toggled.',name:"onShowInstructionChange",required:!1,type:{name:"((value: boolean) => void) | undefined"}}}}}catch{}const mR=t=>{const e=te.useRef(!1),r=te.useRef(t.pause),n=te.useRef(t.zoom),i=te.useRef(t.pitch),a=te.useRef(1),s=te.useRef(t.speed),o=te.useRef(null),c=t.kmPerStep||.01,f=Yb(t.route),d=t.stepDuration||70,m=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer});te.useEffect(()=>{r.current=t.pause,r.current||T()},[t.pause]),te.useEffect(()=>{m.map&&(n.current=t.zoom,typeof n.current<"u"&&m.map.map.getZoom()!==n.current&&m.map.map.setZoom(n.current))},[m.map,t.zoom]),te.useEffect(()=>{m.map&&(i.current=t.pitch,typeof i.current<"u"&&i.current!==m.map.map.getPitch()&&m.map.map.setPitch(i.current))},[m.map,t.pitch]),te.useEffect(()=>{s.current=t.speed},[t.speed]);const b=te.useCallback(()=>{m.map&&(m.map.map.scrollZoom.disable(),m.map.map.boxZoom.disable(),m.map.map.dragRotate.disable(),m.map.map.dragPan.disable(),m.map.map.keyboard.disable(),m.map.map.doubleClickZoom.disable(),m.map.map.touchZoomRotate.disable())},[m.map]),x=te.useCallback(()=>{m.map&&(m.map.map.scrollZoom.enable(),m.map.map.boxZoom.enable(),m.map.map.dragRotate.enable(),m.map.map.dragPan.enable(),m.map.map.keyboard.enable(),m.map.map.doubleClickZoom.enable(),m.map.map.touchZoomRotate.enable())},[m.map]);function E(){if(!m.map||!t.route)return;const R=df(t.route);let F;R&&R.length>3&&(F=[[R[0],R[1]],[R[2],R[3]]],m.map.map.fitBounds(F,{padding:100}))}function T(){if(m.map)if(r.current)x();else{b(),typeof n.current<"u"&&m.map.map.getZoom()!==n.current&&m.map.map.setZoom(n.current);const R=j2e(t.route,a.current*c).geometry.coordinates;a.current*c<f?(m.map.map.easeTo({center:R,bearing:Gb(Xf([m.map.map.getCenter().lng,m.map.map.getCenter().lat]),Xf(R)),duration:d,essential:!0}),typeof s.current<"u"?a.current=a.current+s.current:a.current++,console.log("PAN MOVE"),setTimeout(()=>{T()},100)):(m.map.map.setPitch(0),E(),x(),console.log("ENABLE CONTROLS"),a.current=1)}}function A(){m.map&&(E(),x(),a.current=1)}return te.useEffect(()=>{!m.map||e.current||(e.current=!0,E())},[m.map]),te.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]),{play:T,reset:A}};mR.defaultProps={mapId:void 0,zoom:18};try{mR.displayName="useCameraFollowPath",mR.__docgenInfo={description:"Component template",displayName:"useCameraFollowPath",props:{mapId:{defaultValue:{value:"undefined"},description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},pause:{defaultValue:null,description:"",name:"pause",required:!1,type:{name:"boolean | undefined"}},zoom:{defaultValue:{value:"18"},description:"",name:"zoom",required:!1,type:{name:"number | undefined"}},pitch:{defaultValue:null,description:"",name:"pitch",required:!1,type:{name:"number | undefined"}},speed:{defaultValue:null,description:"",name:"speed",required:!1,type:{name:"number | undefined"}},kmPerStep:{defaultValue:null,description:"",name:"kmPerStep",required:!1,type:{name:"number | undefined"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"any"}},stepDuration:{defaultValue:null,description:"",name:"stepDuration",required:!1,type:{name:"number | undefined"}},timeoutId:{defaultValue:null,description:"",name:"timeoutId",required:!1,type:{name:"number | undefined"}}}}}catch{}const fRe=()=>te.useContext(GD),FE=t=>(te.useEffect(()=>{if(!(!t.protocol||typeof t.handler!="function"))return yM.addProtocol(t.protocol,t.handler),()=>{yM.removeProtocol(t.protocol)}},[t]),{});FE.defaultProps={mapId:void 0};try{FE.displayName="useAddProtocol",FE.__docgenInfo={description:"Enables the use of custom protocols (basically custom tile load functions) in the maplibre-gl-js library.",displayName:"useAddProtocol",props:{protocol:{defaultValue:null,description:"the protocol string, for example `mbtiles`\nIn this example the handler function is called for all tile requests that start with the string `mbtiles://`",name:"protocol",required:!0,type:{name:"string"}},handler:{defaultValue:null,description:"Custom load tile function that will be called when using a source that starts with a custom url schema.",name:"handler",required:!0,type:{name:"AddProtocolAction"}}}}}catch{}function lee(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+"]"}).join(",")+"}")}function hRe(t,e){var r=lee(t);return function(n,i){return e(r(n),i,t)}}function dRe(t){var e=Object.create(null),r=[];return t.forEach(function(n){for(var i in n)i in e||r.push(e[i]=i)}),r}function uN(t){var e=new RegExp('["'+t+`
]`),r=t.charCodeAt(0);function n(f,d){var m,b,x=i(f,function(E,T){if(m)return m(E,T-1);b=E,m=d?hRe(E,d):lee(E)});return x.columns=b,x}function i(f,d){var m={},b={},x=[],E=f.length,T=0,A=0,R,F;function N(){if(T>=E)return b;if(F)return F=!1,m;var U=T,j;if(f.charCodeAt(U)===34){for(var H=U;H++<E;)if(f.charCodeAt(H)===34){if(f.charCodeAt(H+1)!==34)break;++H}return T=H+2,j=f.charCodeAt(H+1),j===13?(F=!0,f.charCodeAt(H+2)===10&&++T):j===10&&(F=!0),f.slice(U+1,H).replace(/""/g,'"')}for(;T<E;){var W=1;if(j=f.charCodeAt(T++),j===10)F=!0;else if(j===13)F=!0,f.charCodeAt(T)===10&&(++T,++W);else if(j!==r)continue;return f.slice(U,T-W)}return f.slice(U)}for(;(R=N())!==b;){for(var O=[];R!==m&&R!==b;)O.push(R),R=N();d&&(O=d(O,A++))==null||x.push(O)}return x}function a(f,d){return d==null&&(d=dRe(f)),[d.map(c).join(t)].concat(f.map(function(m){return d.map(function(b){return c(m[b])}).join(t)})).join(`
`)}function s(f){return f.map(o).join(`
`)}function o(f){return f.map(c).join(t)}function c(f){return f==null?"":e.test(f+="")?'"'+f.replace(/\"/g,'""')+'"':f}return{parse:n,parseRows:i,format:a,formatRows:s}}var O3=uN(","),pRe=O3.parse,gRe=O3.parseRows,mRe=O3.format,yRe=O3.formatRows,L3=uN("	"),vRe=L3.parse,_Re=L3.parseRows,bRe=L3.format,xRe=L3.formatRows;const wRe=Object.freeze(Object.defineProperty({__proto__:null,csvFormat:mRe,csvFormatRows:yRe,csvParse:pRe,csvParseRows:gRe,dsvFormat:uN,tsvFormat:bRe,tsvFormatRows:xRe,tsvParse:vRe,tsvParseRows:_Re},Symbol.toStringTag,{value:"Module"})),SRe=jW(wRe);var dm={exports:{}},kq;function ERe(){if(kq)return dm.exports;kq=1,dm.exports=t,dm.exports.pair=a,dm.exports.format=r,dm.exports.formatPair=e,dm.exports.coordToDMS=n;function t(o,c){var f=i(o,c);return f===null?null:f.val}function e(o){return r(o.lat,"lat")+" "+r(o.lon,"lon")}function r(o,c){var f=n(o,c);return f.whole+" "+(f.minutes?f.minutes+"' ":"")+(f.seconds?f.seconds+'" ':"")+f.dir}function n(o,c){var f={lat:["N","S"],lon:["E","W"]}[c]||"",d=f[o>=0?0:1],m=Math.abs(o),b=Math.floor(m),x=m-b,E=x*60,T=Math.floor(E),A=Math.floor((E-T)*60);return{whole:b,minutes:T,seconds:A,dir:d}}function i(o,c){if(c||(c="NSEW"),typeof o!="string")return null;o=o.toUpperCase();var f=/^[\s\,]*([NSEW])?\s*([\-|\|\]?[0-9.]+)[]?\s*(?:([0-9.]+)[']\s*)?(?:([0-9.]+)(?:''|"||)\s*)?([NSEW])?/,d=o.match(f);if(!d)return null;var m=d[0],b;if(d[1]&&d[5]?(b=d[1],m=m.slice(0,-1)):b=d[1]||d[5],b&&c.indexOf(b)===-1)return null;var x=d[2]?parseFloat(d[2]):0,E=d[3]?parseFloat(d[3])/60:0,T=d[4]?parseFloat(d[4])/3600:0,A=x<0?-1:1;return(b==="S"||b==="W")&&(A*=-1),{val:(Math.abs(x)+E+T)*A,dim:b,matched:m,remain:o.slice(m.length)}}function a(o,c){o=o.trim();var f=i(o,c);if(!f)return null;o=f.remain.trim();var d=i(o,c);return!d||d.remain?null:f.dim?s(f.val,d.val,f.dim):[f.val,d.val]}function s(o,c,f){if(f==="N"||f==="S")return[o,c];if(f==="W"||f==="E")return[c,o]}return dm.exports}var vP,Rq;function TRe(){if(Rq)return vP;Rq=1;var t=SRe,e=ERe(),r=/(Lat)(itude)?/gi,n=/(L)(on|ng)(gitude)?/i;function i(A,R){var F,N,O;for(var U in A)N=U.match(R),N&&(!F||N[0].length/U.length>O)&&(O=N[0].length/U.length,F=U);return F}function a(A){return i(A,r)}function s(A){return i(A,n)}function o(A){return!!A.match(r)}function c(A){return!!A.match(n)}function f(A){return typeof A=="object"?Object.keys(A).length:0}function d(A){var R=[",",";","	","|"],F=[];return R.forEach(function(N){var O=t.dsvFormat(N).parse(A);if(O.length>=1){for(var U=f(O[0]),j=0;j<O.length;j++)if(f(O[j])!==U)return;F.push({delimiter:N,arity:Object.keys(O[0]).length})}}),F.length?F.sort(function(N,O){return O.arity-N.arity})[0].delimiter:null}function m(A){return delete A.columns,A}function b(A){var R=d(A);return R?m(t.dsvFormat(R).parse(A)):null}function x(A,R,F){F||(F=R,R={}),R.delimiter=R.delimiter||",";var N=R.latfield||"",O=R.lonfield||"",U=R.crs||"",j=[],H={type:"FeatureCollection",features:j};if(U!==""&&(H.crs={type:"name",properties:{name:U}}),R.delimiter==="auto"&&typeof A=="string"&&(R.delimiter=d(A),!R.delimiter)){F({type:"Error",message:"Could not autodetect delimiter"});return}var W=R.numericFields?R.numericFields.split(","):null,X=typeof A=="string"?t.dsvFormat(R.delimiter).parse(A,function(ye){if(W)for(var we in ye)W.includes(we)&&(ye[we]=+ye[we]);return ye}):A;if(!X.length){F(null,H);return}var oe=[],ee;N||(N=a(X[0])),O||(O=s(X[0]));var G=!N||!O;if(G){for(ee=0;ee<X.length;ee++)j.push({type:"Feature",properties:X[ee],geometry:null});F(oe.length?oe:null,H);return}for(ee=0;ee<X.length;ee++)if(X[ee][O]!==void 0&&X[ee][N]!==void 0){var ae=X[ee][O],se=X[ee][N],fe,pe,De;De=e(ae,"EW"),De&&(ae=De),De=e(se,"NS"),De&&(se=De),fe=parseFloat(ae),pe=parseFloat(se),isNaN(fe)||isNaN(pe)?oe.push({message:"A row contained an invalid value for latitude or longitude",row:X[ee],index:ee}):(R.includeLatLon||(delete X[ee][O],delete X[ee][N]),j.push({type:"Feature",properties:X[ee],geometry:{type:"Point",coordinates:[parseFloat(fe),parseFloat(pe)]}}))}F(oe.length?oe:null,H)}function E(A){for(var R=A.features,F={type:"Feature",geometry:{type:"LineString",coordinates:[]}},N=0;N<R.length;N++)F.geometry.coordinates.push(R[N].geometry.coordinates);return F.properties=R.reduce(function(O,U){for(var j in U.properties)O[j]||(O[j]=[]),O[j].push(U.properties[j]);return O},{}),{type:"FeatureCollection",features:[F]}}function T(A){for(var R=A.features,F={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},N=0;N<R.length;N++)F.geometry.coordinates[0].push(R[N].geometry.coordinates);return F.properties=R.reduce(function(O,U){for(var j in U.properties)O[j]||(O[j]=[]),O[j].push(U.properties[j]);return O},{}),{type:"FeatureCollection",features:[F]}}return vP={isLon:c,isLat:o,guessLatHeader:a,guessLonHeader:s,csv:t.csvParse,tsv:t.tsvParse,dsv:t,auto:b,csv2geojson:x,toLine:E,toPolygon:T},vP}var CRe=TRe();function N3(t){const e=t.split("?"),r=e[0].split("://"),n=r[0],s=(r.length>2?r[1]+"://"+r[2]:r[1]).split("/").join("/"),o=decodeURI(e[1]),c=Object.fromEntries(new URLSearchParams(o));return{protocolId:n,filename:s,options:c}}async function F3(t){try{return await(await fetch(t)).text()}catch(e){return console.error("File could not be loaded: ",e),e}}async function ARe(t,e){return await new Promise((n,i)=>{const a=e||{};t.substring(t.length-3)==="tsv"&&(e.delimiter="	"),F3(t).then(o=>{CRe.csv2geojson(o,a,(c,f)=>{c?i(c):n(f)})})})}const IRe=async t=>{const e=N3(t.url),r=await ARe(e.filename,e.options);if(r!==void 0)return{data:r};throw new Error("CSV not found "+e.filename)};var dc={},Dq;function Yx(){if(Dq)return dc;Dq=1,Object.defineProperty(dc,"__esModule",{value:!0}),dc.purgeProps=t,dc.first=e,dc.last=r,dc.coordsToKey=n,dc.addToMap=i,dc.removeFromMap=a,dc.getFirstFromMap=s,dc.isRing=o,dc.ringDirection=c,dc.pointInsidePolygon=f,dc.strArrayArrayToFloat=d,dc.strArrayToFloat=m;function t(b,x){if(b){const E=Object.assign({},b);if(x)for(const T of x)delete E[T];return E}return{}}function e(b){return b[0]}function r(b){return b[b.length-1]}function n(b){return b.join(",")}function i(b,x,E){const T=b[x];T?T.push(E):b[x]=[E]}function a(b,x,E){const T=b[x];let A=-1;T&&(A=T.indexOf(E)),A>=0&&T.splice(A,1)}function s(b,x){const E=b[x];return E&&E.length>0?E[0]:null}function o(b){return b.length>3&&n(e(b))===n(r(b))}function c(b,x,E){x=x||0,E=E||1;const T=b.reduce((X,oe,ee)=>b[X][x||0]>oe[x||0]?X:ee,0),A=T<=0?b.length-2:T-1,R=T>=b.length-1?1:T+1,F=b[A][x],N=b[T][x],O=b[R][x],U=b[A][E],j=b[T][E],H=b[R][E];return(N-F)*(H-U)-(O-F)*(j-U)<0?"clockwise":"counterclockwise"}function f(b,x,E,T){E=E||0,T=T||1;let A=!1;for(let R=0,F=x.length-1;R<x.length;F=R++)(x[R][E]<=b[E]&&b[E]<x[F][E]||x[F][E]<=b[E]&&b[E]<x[R][E])&&b[T]<(x[F][T]-x[R][T])*(b[E]-x[R][E])/(x[F][E]-x[R][E])+x[R][T]&&(A=!A);return A}function d(b){return b.map(m)}function m(b){return b.map(parseFloat)}return dc}var d1={},Oq;function PRe(){if(Oq)return d1;Oq=1,Object.defineProperty(d1,"__esModule",{value:!0}),d1.XmlParser=void 0;function t(i){return i.match(/^(.+?)\[(.+?)\]>$/g)!==null}function e(i){const a=/^(.+?)\[(.+?)\]>$/g.exec(i);return a?{evt:a[1]+">",exp:a[2]}:{evt:i}}function r(i){const a="return "+i.replace(/(\$.+?)(?=[=!.])/g,"node.$&")+";";return new Function("node",a)}class n{constructor(a){this.queryParent=!1,this.progressive=!1,this.parentMap=new WeakMap,a&&(this.queryParent=!!a.queryParent,this.progressive=a.progressive,this.queryParent&&(this.parentMap=new WeakMap)),this.evtListeners={}}parse(a,s,o){o=o?o+".":"";const c=/<([^ >\/]+)(.*?)>/mg,f=[];let d=c.exec(a);for(;d;){const m=d[1],b={$tag:m},x=o+m,E=d[2].trim();let T=!1;(E.endsWith("/")||m.startsWith("?")||m.startsWith("!"))&&(T=!0);const A=/([^ ]+?)="(.+?)"/g,R=/([^ ]+?)='(.+?)'/g;let F=A.exec(E),N=!1;for(;F;)N=!0,b[F[1]]=F[2],F=A.exec(E);if(!N)for(F=R.exec(E);F;)N=!0,b[F[1]]=F[2],F=R.exec(E);if(!N&&E!==""&&(b.text=E),this.progressive&&this.emit(`<${x}>`,b,s),!T){const O=new RegExp(`([^]+?)</${m}>`,"g");O.lastIndex=c.lastIndex;const U=O.exec(a);if(U&&U[1]){c.lastIndex=O.lastIndex;const j=this.parse(U[1],b,x);j.length>0?b.$innerNodes=j:b.$innerText=U[1]}}this.queryParent&&s&&this.parentMap.set(b,s),this.progressive&&this.emit(`</${x}>`,b,s),f.push(b),d=c.exec(a)}return f}getParent(a){return this.queryParent?this.parentMap.get(a):null}addListener(a,s){if(t(a)){const o=e(a);o.exp&&(s.condition=r(o.exp)),a=o.evt}this.$addListener(a,s)}removeListener(a,s){t(a)&&(a=e(a).evt),this.$removeListener(a,s)}on(a,s){this.addListener(a,s)}off(a,s){this.removeListener(a,s)}$addListener(a,s){const o=this.evtListeners[a];o?o.push(s):this.evtListeners[a]=[s]}$removeListener(a,s){const o=this.evtListeners[a];let c=-1;o&&(c=o.indexOf(s)),c>=0&&o.splice(c,1)}emit(a,...s){const o=this.evtListeners[a];if(o)for(const c of o)c.condition?c.condition.apply(null,s)===!0&&c.apply(null,s):c.apply(null,s)}}return d1.XmlParser=n,d1}var p1={},g1={},Lq;function cN(){if(Lq)return g1;Lq=1,Object.defineProperty(g1,"__esModule",{value:!0}),g1.OsmObject=void 0;class t{constructor(r,n,i){this.type=r,this.id=n,this.refElems=i,this.tags={},this.props={id:this.getCompositeId()},this.refCount=0,this.hasTag=!1,i&&i.add(this.getCompositeId(),this)}addTags(r){this.tags=Object.assign(this.tags,r),this.hasTag=!0}addTag(r,n){this.tags[r]=n,this.hasTag=!0}addProp(r,n){this.props[r]=n}addProps(r){this.props=Object.assign(this.props,r)}getCompositeId(){return`${this.type}/${this.id}`}getProps(){return Object.assign(this.props,this.tags)}}return g1.OsmObject=t,g1}var Nq;function uee(){if(Nq)return p1;Nq=1,Object.defineProperty(p1,"__esModule",{value:!0}),p1.Node=void 0;const t=cN(),e=Yx();class r extends t.OsmObject{constructor(i,a){super("node",i,a)}setLatLng(i){this.latLng=i}toFeatureArray(){return this.latLng?[{type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"Point",coordinates:(0,e.strArrayToFloat)([this.latLng.lon,this.latLng.lat])}}]:[]}getLatLng(){return this.latLng}}return p1.Node=r,p1}var pm={},m1={},Fq;function cee(){if(Fq)return m1;Fq=1,Object.defineProperty(m1,"__esModule",{value:!0}),m1.LateBinder=void 0;class t{constructor(r,n,i,a){this.container=r,this.valueFunc=n,this.ctx=i,this.args=a}bind(){const r=this.valueFunc.apply(this.ctx,this.args),n=this.container.indexOf(this);if(n<0)return;const i=[n,1];r&&i.push(r),Array.prototype.splice.apply(this.container,i)}}return m1.LateBinder=t,m1}const MRe={},kRe={whitelist:["services","rest_area","escape","elevator"]},RRe={blacklist:["coastline","cliff","ridge","arete","tree_row"]},DRe={},ORe={whitelist:["riverbank","dock","boatyard","dam"]},LRe={},NRe={},FRe={whitelist:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},BRe={whitelist:["station","turntable","roundhouse","platform"]},zRe={},jRe={},URe={blacklist:["cutline","embankment","pipeline"]},VRe={whitelist:["plant","substation","generator","transformer"]},$Re={},qRe={},HRe={blacklist:["taxiway"]},GRe={},WRe={},XRe={},YRe={},ZRe={},KRe={},JRe={},QRe={},eDe={},tDe={building:MRe,highway:kRe,natural:RRe,landuse:DRe,waterway:ORe,amenity:LRe,leisure:NRe,barrier:FRe,railway:BRe,area:zRe,boundary:jRe,man_made:URe,power:VRe,place:$Re,shop:qRe,aeroway:HRe,tourism:GRe,historic:WRe,public_transport:XRe,office:YRe,"building:part":{},military:ZRe,ruins:KRe,"area:highway":{},craft:JRe,golf:QRe,indoor:eDe};var Bq;function fee(){if(Bq)return pm;Bq=1;var t=pm&&pm.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(pm,"__esModule",{value:!0}),pm.Way=void 0;const e=cN(),r=cee(),n=Yx(),i=t(tDe);class a extends e.OsmObject{constructor(o,c){super("way",o,c),this.latLngArray=[],this.isPolygon=!1}addLatLng(o){this.latLngArray.push(o)}setLatLngArray(o){this.latLngArray=o}addNodeRef(o){const c=new r.LateBinder(this.latLngArray,f=>{const d=this.refElems.get(`node/${f}`);if(d)return d.refCount++,d.getLatLng()},this,[o]);this.latLngArray.push(c),this.refElems.addBinder(c)}addTags(o){super.addTags(o);for(const[c,f]of Object.entries(o))this.analyzeTag(c,f)}addTag(o,c){super.addTag(o,c),this.analyzeTag(o,c)}toCoordsArray(){return this.latLngArray.map(o=>[o.lon,o.lat])}toFeatureArray(){let o=this.toCoordsArray();if(o.length>1){const c=(0,n.strArrayArrayToFloat)(o),f={type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"LineString",coordinates:c}};return this.isPolygon&&(0,n.isRing)(c)?((0,n.ringDirection)(c)!=="counterclockwise"&&c.reverse(),f.geometry={type:"Polygon",coordinates:[c]},[f]):[f]}return[]}analyzeTag(o,c){const f=i.default[o];f&&(this.isPolygon=!0,f.whitelist?this.isPolygon=f.whitelist.indexOf(c)>=0:f.blacklist&&(this.isPolygon=!(f.blacklist.indexOf(c)>=0)))}}return pm.Way=a,pm}var y1={},v1={},zq;function rDe(){if(zq)return v1;zq=1,Object.defineProperty(v1,"__esModule",{value:!0}),v1.WayCollection=void 0;const t=Yx();class e extends Array{constructor(){super(),this.firstMap={},this.lastMap={}}addWay(n){const i=n.toCoordsArray();i.length>0&&(this.push(i),(0,t.addToMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(i)),i),(0,t.addToMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(i)),i))}mergeWays(){const n=[];let i=this.shift();for(;i;){(0,t.removeFromMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(i)),i),(0,t.removeFromMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(i)),i);let a=i,s;do{let o=this.getNextWay(a);s=o.next;let c=o.mergeType;if(s)switch(this.splice(this.indexOf(s),1),(0,t.removeFromMap)(this.firstMap,(0,t.coordsToKey)((0,t.first)(s)),s),(0,t.removeFromMap)(this.lastMap,(0,t.coordsToKey)((0,t.last)(s)),s),c){case 0:a=a.concat(s.slice(1));break;case 1:s.reverse(),a=a.concat(s.slice(1));break;case 2:a.reverse(),a=a.concat(s.slice(1));break;case 3:a=s.concat(a.slice(1));break}}while(s);n.push((0,t.strArrayArrayToFloat)(a)),i=this.shift()}return n}getNextWay(n){const i=(0,t.coordsToKey)((0,t.last)(n)),a=(0,t.coordsToKey)((0,t.first)(n));let s=this.length>0?this[0]:null;if(s){const o=(0,t.coordsToKey)((0,t.first)(s)),c=(0,t.coordsToKey)((0,t.last)(s));if(i===o)return{next:s,mergeType:0};if(i===c)return{next:s,mergeType:1};if(a===o)return{next:s,mergeType:2};if(a===c)return{next:s,mergeType:3}}return s=(0,t.getFirstFromMap)(this.firstMap,i),s?{next:s,mergeType:0}:(s=(0,t.getFirstFromMap)(this.lastMap,i),{next:s,mergeType:1})}toRings(n){const i=this.mergeWays(),a=[];let s=i.shift();for(;s;)(0,t.isRing)(s)&&((0,t.ringDirection)(s)!==n&&s.reverse(),a.push(s)),s=i.shift();return a}}return v1.WayCollection=e,v1}var jq;function nDe(){if(jq)return y1;jq=1,Object.defineProperty(y1,"__esModule",{value:!0}),y1.Relation=void 0;const t=cN(),e=fee(),r=uee(),n=rDe(),i=cee(),a=Yx();class s extends t.OsmObject{constructor(c,f){super("relation",c,f),this.relations=[],this.nodes=[],this.bounds=void 0,this.ways=[],this.roles=[]}setBounds(c){this.bounds=c}addMember(c){switch(c.type){case"relation":let f=new i.LateBinder(this.relations,m=>{const b=this.refElems.get(`relation/${m}`);if(b)return b.refCount++,b},this,[c.ref]);this.relations.push(f),this.refElems.addBinder(f);break;case"way":if(c.role||(c.role=""),c.geometry){const m=new e.Way(c.ref,this.refElems);m.setLatLngArray(c.geometry),m.refCount++,this.ways.push(m),this.roles.push(c.role)}else if(c.nodes){const m=new e.Way(c.ref,this.refElems);for(const b of c.nodes)m.addNodeRef(b);m.refCount++,this.ways.push(m),this.roles.push(c.role)}else{let m=new i.LateBinder(this.ways,b=>{const x=this.refElems.get(`way/${b}`);if(x)return x.refCount++,x},this,[c.ref]);this.ways.push(m),this.roles.push(c.role),this.refElems.addBinder(m)}break;case"node":let d=null;if(c.lat&&c.lon){d=new r.Node(c.ref,this.refElems),d.setLatLng({lon:c.lon,lat:c.lat}),c.tags&&d.addTags(c.tags);for(const[m,b]of Object.entries(c))["id","type","lat","lon"].indexOf(m)<0&&d.addProp(m,b);d.refCount++,this.nodes.push(d)}else{let m=new i.LateBinder(this.nodes,b=>{const x=this.refElems.get(`node/${b}`);if(x)return x.refCount++,x},this,[c.ref]);this.nodes.push(m),this.refElems.addBinder(m)}break}}constructStringGeometry(c){const f=c?c.mergeWays():[];return f.length===0?null:{type:"MultiLineString",coordinates:f}}constructPolygonGeometry(c,f){const d=c?c.toRings("counterclockwise"):[],m=f?f.toRings("clockwise"):[];if(d.length>0){const b=[];let x;for(x of d)b.push([x]);for(x=m.shift();x;){for(const E in d)if((0,a.pointInsidePolygon)((0,a.first)(x),d[E])){b[E].push(x);break}x=m.shift()}return b.length===1?{type:"Polygon",coordinates:b[0]}:{type:"MultiPolygon",coordinates:b}}return null}toFeatureArray(){const c=[],f=[];let d=[];for(const b of this.relations)if(b)for(let x=0;x<b.ways.length;x++){const E=b.ways[x];this.ways.push(E),this.roles.push(b.roles[x])}let m={type:"Feature",id:this.getCompositeId(),bbox:this.bounds,properties:this.getProps(),geometry:null};if(this.bounds||delete m.bbox,this.roles.some(b=>b==="outer")){const b=new n.WayCollection,x=new n.WayCollection;for(let A=0;A<this.ways.length;A++){const R=this.ways[A],F=this.roles[A];F==="outer"?b.addWay(R):F==="inner"&&x.addWay(R)}let E=Object.assign({},m),T=this.constructPolygonGeometry(b,x);T&&(E.geometry=T,c.push(E))}else{const b=new n.WayCollection;for(let E of this.ways)b.addWay(E);let x=this.constructStringGeometry(b);if(x){let E=Object.assign({},m);E.geometry=x,f.push(E)}}for(let b of this.nodes)d=d.concat(b.toFeatureArray());return[...c,...f,...d]}}return y1.Relation=s,y1}var _1={},Uq;function iDe(){if(Uq)return _1;Uq=1,Object.defineProperty(_1,"__esModule",{value:!0}),_1.RefElements=void 0;class t extends Map{constructor(){super(),this.binders=[]}add(r,n){this.set(r,n)}addBinder(r){this.binders.push(r)}bindAll(){this.binders.forEach(r=>r.bind())}}return _1.RefElements=t,_1}var _P,Vq;function aDe(){if(Vq)return _P;Vq=1;const t=Yx(),e=PRe(),r=uee(),n=fee(),i=nDe(),a=iDe();function s(m){if(!m)return{completeFeature:!1,renderTagged:!1,excludeWay:!0};let b=m.excludeWay===void 0||m.excludeWay,x=!!m.completeFeature,E=!!m.renderTagged;return{completeFeature:x,renderTagged:E,excludeWay:b}}function o(m){return m.elements?"json":m.indexOf("<osm")>=0?"xml":m.trim().startsWith("{")?"json-raw":"invalid"}function c(m,b){for(const x of m.elements)switch(x.type){case"node":const E=new r.Node(x.id,b);x.tags&&E.addTags(x.tags),E.addProps((0,t.purgeProps)(x,["id","type","tags","lat","lon"])),E.setLatLng(x);break;case"way":const T=new n.Way(x.id,b);if(x.tags&&T.addTags(x.tags),T.addProps((0,t.purgeProps)(x,["id","type","tags","nodes","geometry"])),x.geometry)T.setLatLngArray(x.geometry);else if(x.nodes)for(const R of x.nodes)T.addNodeRef(R);break;case"relation":const A=new i.Relation(x.id,b);if(x.bounds&&A.setBounds([parseFloat(x.bounds.minlon),parseFloat(x.bounds.minlat),parseFloat(x.bounds.maxlon),parseFloat(x.bounds.maxlat)]),x.tags&&A.addTags(x.tags),A.addProps((0,t.purgeProps)(x,["id","type","tags","bounds","members"])),x.members)for(const R of x.members)A.addMember(R)}}function f(m,b){const x=new e.XmlParser({progressive:!0});x.on("</osm.node>",E=>{const T=new r.Node(E.id,b);for(const[A,R]of Object.entries(E))!A.startsWith("$")&&["id","lon","lat"].indexOf(A)<0&&T.addProp(A,R);if(T.setLatLng(E),E.$innerNodes)for(const A of E.$innerNodes)A.$tag==="tag"&&T.addTag(A.k,A.v)}),x.on("</osm.way>",E=>{const T=new n.Way(E.id,b);for(const[A,R]of Object.entries(E))!A.startsWith("$")&&["id"].indexOf(A)<0&&T.addProp(A,R);if(E.$innerNodes)for(const A of E.$innerNodes)A.$tag==="nd"?A.lon&&A.lat?T.addLatLng(A):A.ref&&T.addNodeRef(A.ref):A.$tag==="tag"&&T.addTag(A.k,A.v)}),x.on("<osm.relation>",E=>new i.Relation(E.id,b)),x.on("</osm.relation.member>",(E,T)=>{const A=b.get(`relation/${T?.id}`),R={type:E.type,role:E.role?E.role:"",ref:E.ref};if(E.lat&&E.lon){R.lat=E.lat,R.lon=E.lon,R.tags={};for(const[F,N]of Object.entries(E))!F.startsWith("$")&&["type","lat","lon"].indexOf(F)<0&&(R[F]=N)}if(E.$innerNodes){const F=[],N=[];for(const O of E.$innerNodes)O.lat&&O.lon?F.push(O):O.ref&&N.push(O.ref);F.length>0?R.geometry=F:N.length>0&&(R.nodes=N)}A.addMember(R)}),x.on("</osm.relation.bounds>",(E,T)=>{b.get(`relation/${T?.id}`).setBounds([parseFloat(E.minlon),parseFloat(E.minlat),parseFloat(E.maxlon),parseFloat(E.maxlat)])}),x.on("</osm.relation.tag>",(E,T)=>{b.get(`relation/${T?.id}`).addTag(E.k,E.v)}),x.parse(m)}function d(m,b){let{completeFeature:x,renderTagged:E,excludeWay:T}=s(b),A=o(m);const R=new a.RefElements;let F=[];A==="json-raw"&&(m=JSON.parse(m),m.elements?A="json":A="invalid"),A==="json"?c(m,R):A==="xml"&&f(m,R),R.bindAll();for(const N of R.values()){if(N.refCount>0&&(!N.hasTag||!E||N instanceof n.Way&&T))continue;const O=N.toFeatureArray();if(N instanceof i.Relation&&!x&&O.length>0)return O[0].geometry;F=F.concat(O)}return{type:"FeatureCollection",features:F}}return _P=d,_P}var oDe=aDe();const sDe=Cd(oDe);async function lDe(t){const e=t.options||{};return await new Promise((n,i)=>{F3(t.filename).then(a=>{const s=sDe(a,e);s?n(s):i("Conversion failed")})})}const uDe=async t=>{const e=N3(t.url),r=await lDe(e);if(r!==void 0)return{data:r};throw new Error("OSM File not found "+e.filename)};function cDe(t){const e=[];return t.features.forEach(r=>{r.features?r.features.forEach(n=>{e.push({type:n.type,geometry:n.geometry,properties:n.properties})}):e.push({type:r.type,geometry:r.geometry,properties:r.properties})}),e}async function fDe(t){return await new Promise(r=>{let n={type:"Topology",objects:{key:""},arcs:[]};F3(t.filename).then(i=>{try{n=JSON.parse(i)}catch(s){throw console.error("Error converting topojson",s),"Invalid TopoJson"}let a={type:"FeatureCollection",features:[]};if(n.type==="Topology"&&n.objects!==void 0){const s=n.objects;Object.keys(n.objects).map(o=>{s?.[o].type==="GeometryCollection"?s?.[o].geometries?.forEach(c=>c.properties={fromObject:o,...c.properties}):s?.[o]&&s?.[o]?.type!=="GeometryCollection"&&(s[o].properties={fromObject:o,...s?.[o].properties})}),a={type:"FeatureCollection",features:Object.keys(n.objects).map(o=>fSe(n,o))},a.features=cDe(a)}r(a)})})}const hDe=async t=>{const e=N3(t.url),r=await fDe(e);if(r!==void 0)return{data:r};throw new Error("Topojson not found "+e.filename)};function il(t,e){return Array.from(t.getElementsByTagName(e))}function BE(t){return t[0]==="#"?t:`#${t}`}function dDe(t,e,r){return Array.from(t.getElementsByTagNameNS(r,e))}function Ts(t){return t?.normalize(),t?.textContent||""}function ts(t,e,r){const n=t.getElementsByTagName(e),i=n.length?n[0]:null;return i&&r&&r(i),i}function gf(t,e,r){const n={};if(!t)return n;const i=t.getElementsByTagName(e),a=i.length?i[0]:null;return a&&r?r(a,n):n}function iy(t,e,r){const n=Ts(ts(t,e));return n&&r?r(n)||{}:{}}function $q(t,e,r){const n=Number.parseFloat(Ts(ts(t,e)));if(!Number.isNaN(n))return n&&r?r(n)||{}:{}}function Eu(t,e,r){const n=Number.parseFloat(Ts(ts(t,e)));if(!Number.isNaN(n))return r&&r(n),n}function ay(t,e){const r={};for(const n of e)iy(t,n,i=>{r[n]=i});return r}function Zx(t){return t?.nodeType===1}function hee(t){let e=[];if(t===null)return e;for(const r of Array.from(t.childNodes)){if(!Zx(r))continue;const n=pDe(r.nodeName);if(n==="gpxtpx:TrackPointExtension")e=e.concat(hee(r));else{const i=Ts(r);e.push([n,gDe(i)])}}return e}function pDe(t){return["heart","gpxtpx:hr","hr"].includes(t)?"heart":t}function gDe(t){const e=Number.parseFloat(t);return Number.isNaN(e)?t:e}function dee(t){const e=[Number.parseFloat(t.getAttribute("lon")||""),Number.parseFloat(t.getAttribute("lat")||"")];if(Number.isNaN(e[0])||Number.isNaN(e[1]))return null;Eu(t,"ele",n=>{e.push(n)});const r=ts(t,"time");return{coordinates:e,time:r?Ts(r):null,extendedValues:hee(ts(t,"extensions"))}}function pee(t){return gf(t,"line",e=>Object.assign({},iy(e,"color",n=>({stroke:`#${n}`})),$q(e,"opacity",n=>({"stroke-opacity":n})),$q(e,"width",n=>({"stroke-width":n*96/25.4}))))}function fN(t,e){const r=ay(e,["name","cmt","desc","type","time","keywords"]);for(const[i,a]of t)for(const s of Array.from(e.getElementsByTagNameNS(a,"*")))r[s.tagName.replace(":","_")]=Ts(s)?.trim();const n=il(e,"link");return n.length&&(r.links=n.map(i=>Object.assign({href:i.getAttribute("href")},ay(i,["text","type"])))),r}function gee(t,e){const r=il(t,e),n=[],i=[],a={};for(let s=0;s<r.length;s++){const o=dee(r[s]);if(o){n.push(o.coordinates),o.time&&i.push(o.time);for(const[c,f]of o.extendedValues){const d=c==="heart"?c:`${c.replace("gpxtpx:","")}s`;a[d]||(a[d]=Array(r.length).fill(null)),a[d][s]=f}}}if(!(n.length<2))return{line:n,times:i,extendedValues:a}}function mDe(t,e){const r=gee(e,"rtept");if(r)return{type:"Feature",properties:Object.assign({_gpxType:"rte"},fN(t,e),pee(ts(e,"extensions"))),geometry:{type:"LineString",coordinates:r.line}}}function yDe(t,e){const r=il(e,"trkseg"),n=[],i=[],a=[];for(const c of r){const f=gee(c,"trkpt");f&&(a.push(f),f.times?.length&&i.push(f.times))}if(a.length===0)return null;const s=a.length>1,o=Object.assign({_gpxType:"trk"},fN(t,e),pee(ts(e,"extensions")),i.length?{coordinateProperties:{times:s?i:i[0]}}:{});for(let c=0;c<a.length;c++){const f=a[c];n.push(f.line),o.coordinateProperties||(o.coordinateProperties={});const d=o.coordinateProperties;for(const[m,b]of Object.entries(f.extendedValues))s?(d[m]||(d[m]=a.map(x=>new Array(x.line.length).fill(null))),d[m][c]=b):d[m]=b}return{type:"Feature",properties:o,geometry:s?{type:"MultiLineString",coordinates:n}:{type:"LineString",coordinates:n[0]}}}function vDe(t,e){const r=Object.assign(fN(t,e),ay(e,["sym"])),n=dee(e);return n?{type:"Feature",properties:r,geometry:{type:"Point",coordinates:n.coordinates}}:null}function*mee(t){const e=t,r="gpxx",n="http://www.garmin.com/xmlschemas/GpxExtensions/v3",i=[[r,n]],a=e.getElementsByTagName("gpx")[0]?.attributes;if(a)for(const s of Array.from(a))s.name?.startsWith("xmlns:")&&s.value!==n&&i.push([s.name,s.value]);for(const s of il(e,"trk")){const o=yDe(i,s);o&&(yield o)}for(const s of il(e,"rte")){const o=mDe(i,s);o&&(yield o)}for(const s of il(e,"wpt")){const o=vDe(i,s);o&&(yield o)}}function _De(t){return{type:"FeatureCollection",features:Array.from(mee(t))}}const bDe="http://www.garmin.com/xmlschemas/ActivityExtension/v2",xDe=[["heartRate","heartRates"],["Cadence","cadences"],["Speed","speeds"],["Watts","watts"]],wDe=[["TotalTimeSeconds","totalTimeSeconds"],["DistanceMeters","distanceMeters"],["MaximumSpeed","maxSpeed"],["AverageHeartRateBpm","avgHeartRate"],["MaximumHeartRateBpm","maxHeartRate"],["AvgSpeed","avgSpeed"],["AvgWatts","avgWatts"],["MaxWatts","maxWatts"]];function yee(t,e){const r=[];for(const[n,i]of e){let a=ts(t,n);if(!a){const o=t.getElementsByTagNameNS(bDe,n);o.length&&(a=o[0])}const s=Number.parseFloat(Ts(a));Number.isNaN(s)||r.push([i,s])}return r}function SDe(t){const e=[Eu(t,"LongitudeDegrees"),Eu(t,"LatitudeDegrees")];if(e[0]===void 0||Number.isNaN(e[0])||e[1]===void 0||Number.isNaN(e[1]))return null;const r=ts(t,"HeartRateBpm"),n=Ts(ts(t,"Time"));return ts(t,"AltitudeMeters",i=>{const a=Number.parseFloat(Ts(i));Number.isNaN(a)||e.push(a)}),{coordinates:e,time:n||null,heartRate:r?Number.parseFloat(Ts(r)):null,extensions:yee(t,xDe)}}function EDe(t){const e=il(t,"Trackpoint"),r=[],n=[],i=[];if(e.length<2)return null;const a={},s={extendedProperties:a};for(let o=0;o<e.length;o++){const c=SDe(e[o]);if(c===null)continue;r.push(c.coordinates);const{time:f,heartRate:d,extensions:m}=c;f&&n.push(f),d&&i.push(d);for(const[b,x]of m)a[b]||(a[b]=Array(e.length).fill(null)),a[b][o]=x}return r.length<2?null:Object.assign(s,{line:r,times:n,heartRates:i})}function qq(t){const e=il(t,"Track"),r=[],n=[],i=[],a=[];let s;const o=Object.assign(Object.fromEntries(yee(t,wDe)),gf(t,"Name",c=>({name:Ts(c)})));for(const c of e)s=EDe(c),s&&(r.push(s.line),s.times.length&&n.push(s.times),s.heartRates.length&&i.push(s.heartRates),a.push(s.extendedProperties));for(let c=0;c<a.length;c++){const f=a[c];for(const d in f)e.length===1?s&&(o[d]=s.extendedProperties[d]):(o[d]||(o[d]=r.map(m=>Array(m.length).fill(null))),o[d][c]=f[d])}return r.length===0?null:((n.length||i.length)&&(o.coordinateProperties=Object.assign(n.length?{times:r.length===1?n[0]:n}:{},i.length?{heart:r.length===1?i[0]:i}:{})),{type:"Feature",properties:o,geometry:r.length===1?{type:"LineString",coordinates:r[0]}:{type:"MultiLineString",coordinates:r}})}function*vee(t){for(const e of il(t,"Lap")){const r=qq(e);r&&(yield r)}for(const e of il(t,"Courses")){const r=qq(e);r&&(yield r)}}function TDe(t){return{type:"FeatureCollection",features:Array.from(vee(t))}}function _ee(t,e){const r={},n=e==="stroke"||e==="fill"?e:`${e}-color`;return t[0]==="#"&&(t=t.substring(1)),t.length===6||t.length===3?r[n]=`#${t}`:t.length===8&&(r[`${e}-opacity`]=Number.parseInt(t.substring(0,2),16)/255,r[n]=`#${t.substring(6,8)}${t.substring(4,6)}${t.substring(2,4)}`),r}function zE(t,e,r){const n={};return Eu(t,e,i=>{n[r]=i}),n}function hN(t,e){return gf(t,"color",r=>_ee(Ts(r),e))}function dN(t){return gf(t,"Icon",(e,r)=>(iy(e,"href",n=>{r.icon=n}),r))}function CDe(t){return gf(t,"IconStyle",e=>Object.assign(hN(e,"icon"),zE(e,"scale","icon-scale"),zE(e,"heading","icon-heading"),gf(e,"hotSpot",r=>{const n=Number.parseFloat(r.getAttribute("x")||""),i=Number.parseFloat(r.getAttribute("y")||""),a=r.getAttribute("xunits")||"",s=r.getAttribute("yunits")||"";return!Number.isNaN(n)&&!Number.isNaN(i)?{"icon-offset":[n,i],"icon-offset-units":[a,s]}:{}}),dN(e)))}function ADe(t){return gf(t,"LabelStyle",e=>Object.assign(hN(e,"label"),zE(e,"scale","label-scale")))}function IDe(t){return gf(t,"LineStyle",e=>Object.assign(hN(e,"stroke"),zE(e,"width","stroke-width")))}function PDe(t){return gf(t,"PolyStyle",(e,r)=>Object.assign(r,gf(e,"color",n=>_ee(Ts(n),"fill")),iy(e,"fill",n=>{if(n==="0")return{"fill-opacity":0}}),iy(e,"outline",n=>{if(n==="0")return{"stroke-opacity":0}})))}function B3(t){return Object.assign({},PDe(t),IDe(t),ADe(t),CDe(t))}const MDe=/\s*/g,kDe=/^\s*|\s*$/g,RDe=/\s+/;function bee(t){return t.replace(MDe,"").split(",").map(Number.parseFloat).filter(e=>!Number.isNaN(e)).slice(0,3)}function yR(t){return t.replace(kDe,"").split(RDe).map(bee).filter(e=>e.length>=2)}function DDe(t){let e=il(t,"coord");e.length===0&&(e=dDe(t,"coord","*"));const r=e.map(n=>Ts(n).split(" ").map(Number.parseFloat));return r.length===0?null:{geometry:r.length>2?{type:"LineString",coordinates:r}:{type:"Point",coordinates:r[0]},times:il(t,"when").map(n=>Ts(n))}}function xee(t){if(t.length===0)return t;const e=t[0],r=t[t.length-1];let n=!0;for(let i=0;i<Math.max(e.length,r.length);i++)if(e[i]!==r[i]){n=!1;break}return n?t:t.concat([t[0]])}function _S(t){return Ts(ts(t,"coordinates"))}function wee(t){let e=[],r=[];for(let n=0;n<t.childNodes.length;n++){const i=t.childNodes.item(n);if(Zx(i))switch(i.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{const a=wee(i);e=e.concat(a.geometries),r=r.concat(a.coordTimes);break}case"Point":{const a=bee(_S(i));a.length>=2&&e.push({type:"Point",coordinates:a});break}case"LinearRing":case"LineString":{const a=yR(_S(i));a.length>=2&&e.push({type:"LineString",coordinates:a});break}case"Polygon":{const a=[];for(const s of il(i,"LinearRing")){const o=xee(yR(_S(s)));o.length>=4&&a.push(o)}a.length&&e.push({type:"Polygon",coordinates:a});break}case"Track":case"gx:Track":{const a=DDe(i);if(!a)break;const{times:s,geometry:o}=a;e.push(o),s.length&&r.push(s);break}}}return{geometries:e,coordTimes:r}}const Sv=t=>Number(t),vR={string:t=>t,int:Sv,uint:Sv,short:Sv,ushort:Sv,float:Sv,double:Sv,bool:t=>!!t};function pN(t,e){return gf(t,"ExtendedData",(r,n)=>{for(const i of il(r,"Data"))n[i.getAttribute("name")||""]=Ts(ts(i,"value"));for(const i of il(r,"SimpleData")){const a=i.getAttribute("name")||"",s=e[a]||vR.string;n[a]=s(Ts(i))}return n})}function gN(t){const e=ts(t,"description");for(const r of Array.from(e?.childNodes||[]))if(r.nodeType===4)return{description:{"@type":"html",value:Ts(r)}};return{}}function mN(t){return gf(t,"TimeSpan",e=>({timespan:{begin:Ts(ts(e,"begin")),end:Ts(ts(e,"end"))}}))}function yN(t){return gf(t,"TimeStamp",e=>({timestamp:Ts(ts(e,"when"))}))}function vN(t,e){return iy(t,"styleUrl",r=>(r=BE(r),e[r]?Object.assign({styleUrl:r},e[r]):{styleUrl:r}))}var If;(function(t){t.ABSOLUTE="absolute",t.RELATIVE_TO_GROUND="relativeToGround",t.CLAMP_TO_GROUND="clampToGround",t.CLAMP_TO_SEAFLOOR="clampToSeaFloor",t.RELATIVE_TO_SEAFLOOR="relativeToSeaFloor"})(If||(If={}));function ODe(t){switch(t?.textContent){case If.ABSOLUTE:return If.ABSOLUTE;case If.CLAMP_TO_GROUND:return If.CLAMP_TO_GROUND;case If.CLAMP_TO_SEAFLOOR:return If.CLAMP_TO_SEAFLOOR;case If.RELATIVE_TO_GROUND:return If.RELATIVE_TO_GROUND;case If.RELATIVE_TO_SEAFLOOR:return If.RELATIVE_TO_SEAFLOOR}return null}function LDe(t){return ts(t,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[xee(yR(_S(t)))]}}:BDe(t)}const NDe=Math.PI/180;function FDe(t,e,r){const n=[(t[0]+t[2])/2,(t[1]+t[3])/2];return[e[0].map(i=>{const a=i[1]-n[1],s=i[0]-n[0],o=Math.sqrt(a**2+s**2),c=Math.atan2(a,s)+r*NDe;return[n[0]+Math.cos(c)*o,n[1]+Math.sin(c)*o]})]}function BDe(t){const e=ts(t,"LatLonBox");if(e){const r=Eu(e,"north"),n=Eu(e,"west"),i=Eu(e,"east"),a=Eu(e,"south"),s=Eu(e,"rotation");if(typeof r=="number"&&typeof a=="number"&&typeof n=="number"&&typeof i=="number"){const o=[n,a,i,r];let c=[[[n,r],[i,r],[i,a],[n,a],[n,r]]];return typeof s=="number"&&(c=FDe(o,c,s)),{bbox:o,geometry:{type:"Polygon",coordinates:c}}}}return null}function See(t,e,r,n){const i=LDe(t),a=i?.geometry||null;if(!a&&n.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign({"@geometry-type":"groundoverlay"},ay(t,["name","address","visibility","open","phoneNumber","description"]),gN(t),vN(t,e),B3(t),dN(t),pN(t,r),mN(t),yN(t))};i?.bbox&&(s.bbox=i.bbox),s.properties?.visibility!==void 0&&(s.properties.visibility=s.properties.visibility!=="0");const o=t.getAttribute("id");return o!==null&&o!==""&&(s.id=o),s}function zDe(t){const e=ts(t,"Region");return e?{coordinateBox:UDe(e),lod:jDe(t)}:null}function jDe(t){const e=ts(t,"Lod");return e?[Eu(e,"minLodPixels")??-1,Eu(e,"maxLodPixels")??-1,Eu(e,"minFadeExtent")??null,Eu(e,"maxFadeExtent")??null]:null}function UDe(t){const e=ts(t,"LatLonAltBox");if(e){const r=Eu(e,"north"),n=Eu(e,"west"),i=Eu(e,"east"),a=Eu(e,"south");if(ODe(ts(e,"altitudeMode")||ts(e,"gx:altitudeMode"))&&console.debug("Encountered an unsupported feature of KML for togeojson: please contact developers for support of altitude mode."),typeof r=="number"&&typeof a=="number"&&typeof n=="number"&&typeof i=="number")return{bbox:[n,a,i,r],geometry:{type:"Polygon",coordinates:[[[n,r],[i,r],[i,a],[n,a],[n,r]]]}}}return null}function VDe(t){const e=ts(t,"Link");return e?ay(e,["href","refreshMode","refreshInterval","viewRefreshMode","viewRefreshTime","viewBoundScale","viewFormat","httpQuery"]):{}}function Eee(t,e,r,n){const i=zDe(t),a=i?.coordinateBox?.geometry||null;if(!a&&n.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign({"@geometry-type":"networklink"},ay(t,["name","address","visibility","open","phoneNumber","styleUrl","refreshVisibility","flyToView","description"]),gN(t),vN(t,e),B3(t),dN(t),pN(t,r),mN(t),yN(t),VDe(t),i?.lod?{lod:i.lod}:{})};i?.coordinateBox?.bbox&&(s.bbox=i.coordinateBox.bbox),s.properties?.visibility!==void 0&&(s.properties.visibility=s.properties.visibility!=="0");const o=t.getAttribute("id");return o!==null&&o!==""&&(s.id=o),s}function $De(t){return t.length===0?null:t.length===1?t[0]:{type:"GeometryCollection",geometries:t}}function Tee(t,e,r,n){const{coordTimes:i,geometries:a}=wee(t),s=$De(a);if(!s&&n.skipNullGeometry)return null;const o={type:"Feature",geometry:s,properties:Object.assign(ay(t,["name","address","visibility","open","phoneNumber","description"]),gN(t),vN(t,e),B3(t),pN(t,r),mN(t),yN(t),i.length?{coordinateProperties:{times:i.length===1?i[0]:i}}:{})};o.properties?.visibility!==void 0&&(o.properties.visibility=o.properties.visibility!=="0");const c=t.getAttribute("id");return c!==null&&c!==""&&(o.id=c),o}function qDe(t){let e=t.getAttribute("id");const r=t.parentNode;return!e&&Zx(r)&&r.localName==="CascadingStyle"&&(e=r.getAttribute("kml:id")||r.getAttribute("id")),BE(e||"")}function Cee(t){const e={};for(const r of il(t,"Style"))e[qDe(r)]=B3(r);for(const r of il(t,"StyleMap")){const n=BE(r.getAttribute("id")||"");iy(r,"styleUrl",i=>{i=BE(i),e[i]&&(e[n]=e[i])})}return e}function Aee(t){const e={};for(const r of il(t,"SimpleField"))e[r.getAttribute("name")||""]=vR[r.getAttribute("type")||""]||vR.string;return e}const HDe=["name","visibility","open","address","description","phoneNumber","visibility"];function GDe(t){const e={};for(const r of Array.from(t.childNodes))Zx(r)&&HDe.includes(r.tagName)&&(e[r.tagName]=Ts(r));return{type:"folder",meta:e,children:[]}}function WDe(t,e={skipNullGeometry:!1}){const r=t,n=Cee(r),i=Aee(r),a={type:"root",children:[]};function s(o,c,f){if(Zx(o))switch(o.tagName){case"GroundOverlay":{const d=See(o,n,i,f);d&&c.children.push(d);break}case"Placemark":{const d=Tee(o,n,i,f);d&&c.children.push(d);break}case"Folder":{const d=GDe(o);c.children.push(d),c=d;break}case"NetworkLink":{const d=Eee(o,n,i,f);d&&c.children.push(d);break}}if(o.childNodes)for(let d=0;d<o.childNodes.length;d++)s(o.childNodes[d],c,f)}return s(r,a,e),a}function*Iee(t,e={skipNullGeometry:!1}){const r=t,n=Cee(r),i=Aee(r);for(const a of il(r,"Placemark")){const s=Tee(a,n,i,e);s&&(yield s)}for(const a of il(r,"GroundOverlay")){const s=See(a,n,i,e);s&&(yield s)}for(const a of il(r,"NetworkLink")){const s=Eee(a,n,i,e);s&&(yield s)}}function XDe(t,e={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(Iee(t,e))}}const YDe=Object.freeze(Object.defineProperty({__proto__:null,gpx:_De,gpxGen:mee,kml:XDe,kmlGen:Iee,kmlWithFolders:WDe,tcx:TDe,tcxGen:vee},Symbol.toStringTag,{value:"Module"}));async function ZDe(t){return await new Promise((r,n)=>{F3(t.filename).then(i=>{const a=()=>t.protocolId==="tcx"?YDe[t.protocolId](new DOMParser().parseFromString(i,"text/xml")):QQ[t.protocolId](new DOMParser().parseFromString(i,"text/xml"));a()?r(a()):n("Conversion failed")})})}const bP=async t=>{const e=N3(t.url),r=await ZDe(e);if(r!==void 0)return{data:r};throw new Error("XML not found "+e.filename)},_R=t=>{const e=ga({mapId:void 0}),r=te.useRef(!1);te.useEffect(()=>{if(!(!e.map||r.current))return e.map?.loadImage(t.imagePath).then(function(n){if(!n?.data){console.log("image "+t.imagePath+"could not be loaded");return}e.map?.addImage(t.imageId,n.data)}),()=>{e.map?.removeImage(t.imageId)}},[e.map,t])};_R.defaultProps={mapId:void 0};try{_R.displayName="useAddImage",_R.__docgenInfo={description:"",displayName:"useAddImage",props:{imageId:{defaultValue:null,description:"",name:"imageId",required:!0,type:{name:"string"}},imagePath:{defaultValue:null,description:"",name:"imagePath",required:!0,type:{name:"string"}}}}}catch{}const KDe=gt.createContext({}),bR=KDe.Provider;try{bR.displayName="SimpleDataContextProvider",bR.__docgenInfo={description:"",displayName:"SimpleDataContextProvider",props:{}}}catch{}var JDe={value:()=>{}};function Pee(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new bS(r)}function bS(t){this._=t}function QDe(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}bS.prototype=Pee.prototype={constructor:bS,on:function(t,e){var r=this._,n=QDe(t+"",r),i,a=-1,s=n.length;if(arguments.length<2){for(;++a<s;)if((i=(t=n[a]).type)&&(i=eOe(r[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(t=n[a]).type)r[i]=Hq(r[i],t.name,e);else if(e==null)for(i in r)r[i]=Hq(r[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new bS(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,a;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],n=0,i=a.length;n<i;++n)a[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,a=n.length;i<a;++i)n[i].value.apply(e,r)}};function eOe(t,e){for(var r=0,n=t.length,i;r<n;++r)if((i=t[r]).name===e)return i.value}function Hq(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=JDe,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var xR="http://www.w3.org/1999/xhtml";const Gq={svg:"http://www.w3.org/2000/svg",xhtml:xR,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function z3(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),Gq.hasOwnProperty(e)?{space:Gq[e],local:t}:t}function tOe(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===xR&&e.documentElement.namespaceURI===xR?e.createElement(t):e.createElementNS(r,t)}}function rOe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Mee(t){var e=z3(t);return(e.local?rOe:tOe)(e)}function nOe(){}function _N(t){return t==null?nOe:function(){return this.querySelector(t)}}function iOe(t){typeof t!="function"&&(t=_N(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=new Array(s),c,f,d=0;d<s;++d)(c=a[d])&&(f=t.call(c,c.__data__,d,a))&&("__data__"in c&&(f.__data__=c.__data__),o[d]=f);return new Ph(n,this._parents)}function aOe(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function oOe(){return[]}function kee(t){return t==null?oOe:function(){return this.querySelectorAll(t)}}function sOe(t){return function(){return aOe(t.apply(this,arguments))}}function lOe(t){typeof t=="function"?t=sOe(t):t=kee(t);for(var e=this._groups,r=e.length,n=[],i=[],a=0;a<r;++a)for(var s=e[a],o=s.length,c,f=0;f<o;++f)(c=s[f])&&(n.push(t.call(c,c.__data__,f,s)),i.push(c));return new Ph(n,i)}function Ree(t){return function(){return this.matches(t)}}function Dee(t){return function(e){return e.matches(t)}}var uOe=Array.prototype.find;function cOe(t){return function(){return uOe.call(this.children,t)}}function fOe(){return this.firstElementChild}function hOe(t){return this.select(t==null?fOe:cOe(typeof t=="function"?t:Dee(t)))}var dOe=Array.prototype.filter;function pOe(){return Array.from(this.children)}function gOe(t){return function(){return dOe.call(this.children,t)}}function mOe(t){return this.selectAll(t==null?pOe:gOe(typeof t=="function"?t:Dee(t)))}function yOe(t){typeof t!="function"&&(t=Ree(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=[],c,f=0;f<s;++f)(c=a[f])&&t.call(c,c.__data__,f,a)&&o.push(c);return new Ph(n,this._parents)}function Oee(t){return new Array(t.length)}function vOe(){return new Ph(this._enter||this._groups.map(Oee),this._parents)}function jE(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}jE.prototype={constructor:jE,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function _Oe(t){return function(){return t}}function bOe(t,e,r,n,i,a){for(var s=0,o,c=e.length,f=a.length;s<f;++s)(o=e[s])?(o.__data__=a[s],n[s]=o):r[s]=new jE(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function xOe(t,e,r,n,i,a,s){var o,c,f=new Map,d=e.length,m=a.length,b=new Array(d),x;for(o=0;o<d;++o)(c=e[o])&&(b[o]=x=s.call(c,c.__data__,o,e)+"",f.has(x)?i[o]=c:f.set(x,c));for(o=0;o<m;++o)x=s.call(t,a[o],o,a)+"",(c=f.get(x))?(n[o]=c,c.__data__=a[o],f.delete(x)):r[o]=new jE(t,a[o]);for(o=0;o<d;++o)(c=e[o])&&f.get(b[o])===c&&(i[o]=c)}function wOe(t){return t.__data__}function SOe(t,e){if(!arguments.length)return Array.from(this,wOe);var r=e?xOe:bOe,n=this._parents,i=this._groups;typeof t!="function"&&(t=_Oe(t));for(var a=i.length,s=new Array(a),o=new Array(a),c=new Array(a),f=0;f<a;++f){var d=n[f],m=i[f],b=m.length,x=EOe(t.call(d,d&&d.__data__,f,n)),E=x.length,T=o[f]=new Array(E),A=s[f]=new Array(E),R=c[f]=new Array(b);r(d,m,T,A,R,x,e);for(var F=0,N=0,O,U;F<E;++F)if(O=T[F]){for(F>=N&&(N=F+1);!(U=A[N])&&++N<E;);O._next=U||null}}return s=new Ph(s,n),s._enter=o,s._exit=c,s}function EOe(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function TOe(){return new Ph(this._exit||this._groups.map(Oee),this._parents)}function COe(t,e,r){var n=this.enter(),i=this,a=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),r==null?a.remove():r(a),n&&i?n.merge(i).order():i}function AOe(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,a=n.length,s=Math.min(i,a),o=new Array(i),c=0;c<s;++c)for(var f=r[c],d=n[c],m=f.length,b=o[c]=new Array(m),x,E=0;E<m;++E)(x=f[E]||d[E])&&(b[E]=x);for(;c<i;++c)o[c]=r[c];return new Ph(o,this._parents)}function IOe(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],i=n.length-1,a=n[i],s;--i>=0;)(s=n[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function POe(t){t||(t=MOe);function e(m,b){return m&&b?t(m.__data__,b.__data__):!m-!b}for(var r=this._groups,n=r.length,i=new Array(n),a=0;a<n;++a){for(var s=r[a],o=s.length,c=i[a]=new Array(o),f,d=0;d<o;++d)(f=s[d])&&(c[d]=f);c.sort(e)}return new Ph(i,this._parents).order()}function MOe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function kOe(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function ROe(){return Array.from(this)}function DOe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,a=n.length;i<a;++i){var s=n[i];if(s)return s}return null}function OOe(){let t=0;for(const e of this)++t;return t}function LOe(){return!this.node()}function NOe(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i=e[r],a=0,s=i.length,o;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this}function FOe(t){return function(){this.removeAttribute(t)}}function BOe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function zOe(t,e){return function(){this.setAttribute(t,e)}}function jOe(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function UOe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function VOe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function $Oe(t,e){var r=z3(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?BOe:FOe:typeof e=="function"?r.local?VOe:UOe:r.local?jOe:zOe)(r,e))}function Lee(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function qOe(t){return function(){this.style.removeProperty(t)}}function HOe(t,e,r){return function(){this.style.setProperty(t,e,r)}}function GOe(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function WOe(t,e,r){return arguments.length>1?this.each((e==null?qOe:typeof e=="function"?GOe:HOe)(t,e,r??"")):K0(this.node(),t)}function K0(t,e){return t.style.getPropertyValue(e)||Lee(t).getComputedStyle(t,null).getPropertyValue(e)}function XOe(t){return function(){delete this[t]}}function YOe(t,e){return function(){this[t]=e}}function ZOe(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function KOe(t,e){return arguments.length>1?this.each((e==null?XOe:typeof e=="function"?ZOe:YOe)(t,e)):this.node()[t]}function Nee(t){return t.trim().split(/^|\s+/)}function bN(t){return t.classList||new Fee(t)}function Fee(t){this._node=t,this._names=Nee(t.getAttribute("class")||"")}Fee.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Bee(t,e){for(var r=bN(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function zee(t,e){for(var r=bN(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function JOe(t){return function(){Bee(this,t)}}function QOe(t){return function(){zee(this,t)}}function eLe(t,e){return function(){(e.apply(this,arguments)?Bee:zee)(this,t)}}function tLe(t,e){var r=Nee(t+"");if(arguments.length<2){for(var n=bN(this.node()),i=-1,a=r.length;++i<a;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof e=="function"?eLe:e?JOe:QOe)(r,e))}function rLe(){this.textContent=""}function nLe(t){return function(){this.textContent=t}}function iLe(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function aLe(t){return arguments.length?this.each(t==null?rLe:(typeof t=="function"?iLe:nLe)(t)):this.node().textContent}function oLe(){this.innerHTML=""}function sLe(t){return function(){this.innerHTML=t}}function lLe(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function uLe(t){return arguments.length?this.each(t==null?oLe:(typeof t=="function"?lLe:sLe)(t)):this.node().innerHTML}function cLe(){this.nextSibling&&this.parentNode.appendChild(this)}function fLe(){return this.each(cLe)}function hLe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function dLe(){return this.each(hLe)}function pLe(t){var e=typeof t=="function"?t:Mee(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function gLe(){return null}function mLe(t,e){var r=typeof t=="function"?t:Mee(t),n=e==null?gLe:typeof e=="function"?e:_N(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function yLe(){var t=this.parentNode;t&&t.removeChild(this)}function vLe(){return this.each(yLe)}function _Le(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function bLe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function xLe(t){return this.select(t?bLe:_Le)}function wLe(t){return arguments.length?this.property("__data__",t):this.node().__data__}function SLe(t){return function(e){t.call(this,e,this.__data__)}}function ELe(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function TLe(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,i=e.length,a;r<i;++r)a=e[r],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++n]=a;++n?e.length=n:delete this.__on}}}function CLe(t,e,r){return function(){var n=this.__on,i,a=SLe(e);if(n){for(var s=0,o=n.length;s<o;++s)if((i=n[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=r),i.value=e;return}}this.addEventListener(t.type,a,r),i={type:t.type,name:t.name,value:e,listener:a,options:r},n?n.push(i):this.__on=[i]}}function ALe(t,e,r){var n=ELe(t+""),i,a=n.length,s;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,f=o.length,d;c<f;++c)for(i=0,d=o[c];i<a;++i)if((s=n[i]).type===d.type&&s.name===d.name)return d.value}return}for(o=e?CLe:TLe,i=0;i<a;++i)this.each(o(n[i],e,r));return this}function jee(t,e,r){var n=Lee(t),i=n.CustomEvent;typeof i=="function"?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ILe(t,e){return function(){return jee(this,t,e)}}function PLe(t,e){return function(){return jee(this,t,e.apply(this,arguments))}}function MLe(t,e){return this.each((typeof e=="function"?PLe:ILe)(t,e))}function*kLe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,a=n.length,s;i<a;++i)(s=n[i])&&(yield s)}var RLe=[null];function Ph(t,e){this._groups=t,this._parents=e}function Kx(){return new Ph([[document.documentElement]],RLe)}function DLe(){return this}Ph.prototype=Kx.prototype={constructor:Ph,select:iOe,selectAll:lOe,selectChild:hOe,selectChildren:mOe,filter:yOe,data:SOe,enter:vOe,exit:TOe,join:COe,merge:AOe,selection:DLe,order:IOe,sort:POe,call:kOe,nodes:ROe,node:DOe,size:OOe,empty:LOe,each:NOe,attr:$Oe,style:WOe,property:KOe,classed:tLe,text:aLe,html:uLe,raise:fLe,lower:dLe,append:pLe,insert:mLe,remove:vLe,clone:xLe,datum:wLe,on:ALe,dispatch:MLe,[Symbol.iterator]:kLe};function xN(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function Uee(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Jx(){}var nx=.7,UE=1/nx,P0="\\s*([+-]?\\d+)\\s*",ix="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",bd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",OLe=/^#([0-9a-f]{3,8})$/,LLe=new RegExp(`^rgb\\(${P0},${P0},${P0}\\)$`),NLe=new RegExp(`^rgb\\(${bd},${bd},${bd}\\)$`),FLe=new RegExp(`^rgba\\(${P0},${P0},${P0},${ix}\\)$`),BLe=new RegExp(`^rgba\\(${bd},${bd},${bd},${ix}\\)$`),zLe=new RegExp(`^hsl\\(${ix},${bd},${bd}\\)$`),jLe=new RegExp(`^hsla\\(${ix},${bd},${bd},${ix}\\)$`),Wq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};xN(Jx,ax,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Xq,formatHex:Xq,formatHex8:ULe,formatHsl:VLe,formatRgb:Yq,toString:Yq});function Xq(){return this.rgb().formatHex()}function ULe(){return this.rgb().formatHex8()}function VLe(){return Vee(this).formatHsl()}function Yq(){return this.rgb().formatRgb()}function ax(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=OLe.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?Zq(e):r===3?new Pc(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Rw(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Rw(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=LLe.exec(t))?new Pc(e[1],e[2],e[3],1):(e=NLe.exec(t))?new Pc(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=FLe.exec(t))?Rw(e[1],e[2],e[3],e[4]):(e=BLe.exec(t))?Rw(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=zLe.exec(t))?Qq(e[1],e[2]/100,e[3]/100,1):(e=jLe.exec(t))?Qq(e[1],e[2]/100,e[3]/100,e[4]):Wq.hasOwnProperty(t)?Zq(Wq[t]):t==="transparent"?new Pc(NaN,NaN,NaN,0):null}function Zq(t){return new Pc(t>>16&255,t>>8&255,t&255,1)}function Rw(t,e,r,n){return n<=0&&(t=e=r=NaN),new Pc(t,e,r,n)}function $Le(t){return t instanceof Jx||(t=ax(t)),t?(t=t.rgb(),new Pc(t.r,t.g,t.b,t.opacity)):new Pc}function wR(t,e,r,n){return arguments.length===1?$Le(t):new Pc(t,e,r,n??1)}function Pc(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}xN(Pc,wR,Uee(Jx,{brighter(t){return t=t==null?UE:Math.pow(UE,t),new Pc(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?nx:Math.pow(nx,t),new Pc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Pc(Um(this.r),Um(this.g),Um(this.b),VE(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Kq,formatHex:Kq,formatHex8:qLe,formatRgb:Jq,toString:Jq}));function Kq(){return`#${km(this.r)}${km(this.g)}${km(this.b)}`}function qLe(){return`#${km(this.r)}${km(this.g)}${km(this.b)}${km((isNaN(this.opacity)?1:this.opacity)*255)}`}function Jq(){const t=VE(this.opacity);return`${t===1?"rgb(":"rgba("}${Um(this.r)}, ${Um(this.g)}, ${Um(this.b)}${t===1?")":`, ${t})`}`}function VE(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Um(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function km(t){return t=Um(t),(t<16?"0":"")+t.toString(16)}function Qq(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new vh(t,e,r,n)}function Vee(t){if(t instanceof vh)return new vh(t.h,t.s,t.l,t.opacity);if(t instanceof Jx||(t=ax(t)),!t)return new vh;if(t instanceof vh)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),s=NaN,o=a-i,c=(a+i)/2;return o?(e===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-e)/o+2:s=(e-r)/o+4,o/=c<.5?a+i:2-a-i,s*=60):o=c>0&&c<1?0:s,new vh(s,o,c,t.opacity)}function HLe(t,e,r,n){return arguments.length===1?Vee(t):new vh(t,e,r,n??1)}function vh(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}xN(vh,HLe,Uee(Jx,{brighter(t){return t=t==null?UE:Math.pow(UE,t),new vh(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?nx:Math.pow(nx,t),new vh(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Pc(xP(t>=240?t-240:t+120,i,n),xP(t,i,n),xP(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new vh(eH(this.h),Dw(this.s),Dw(this.l),VE(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=VE(this.opacity);return`${t===1?"hsl(":"hsla("}${eH(this.h)}, ${Dw(this.s)*100}%, ${Dw(this.l)*100}%${t===1?")":`, ${t})`}`}}));function eH(t){return t=(t||0)%360,t<0?t+360:t}function Dw(t){return Math.max(0,Math.min(1,t||0))}function xP(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const $ee=t=>()=>t;function GLe(t,e){return function(r){return t+r*e}}function WLe(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function XLe(t){return(t=+t)==1?qee:function(e,r){return r-e?WLe(e,r,t):$ee(isNaN(e)?r:e)}}function qee(t,e){var r=e-t;return r?GLe(t,r):$ee(isNaN(t)?e:t)}const tH=(function t(e){var r=XLe(e);function n(i,a){var s=r((i=wR(i)).r,(a=wR(a)).r),o=r(i.g,a.g),c=r(i.b,a.b),f=qee(i.opacity,a.opacity);return function(d){return i.r=s(d),i.g=o(d),i.b=c(d),i.opacity=f(d),i+""}}return n.gamma=t,n})(1);function ag(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var SR=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wP=new RegExp(SR.source,"g");function YLe(t){return function(){return t}}function ZLe(t){return function(e){return t(e)+""}}function KLe(t,e){var r=SR.lastIndex=wP.lastIndex=0,n,i,a,s=-1,o=[],c=[];for(t=t+"",e=e+"";(n=SR.exec(t))&&(i=wP.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,c.push({i:s,x:ag(n,i)})),r=wP.lastIndex;return r<e.length&&(a=e.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?c[0]?ZLe(c[0].x):YLe(e):(e=c.length,function(f){for(var d=0,m;d<e;++d)o[(m=c[d]).i]=m.x(f);return o.join("")})}var rH=180/Math.PI,ER={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Hee(t,e,r,n,i,a){var s,o,c;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(c=t*r+e*n)&&(r-=t*c,n-=e*c),(o=Math.sqrt(r*r+n*n))&&(r/=o,n/=o,c/=o),t*n<e*r&&(t=-t,e=-e,c=-c,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*rH,skewX:Math.atan(c)*rH,scaleX:s,scaleY:o}}var Ow;function JLe(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ER:Hee(e.a,e.b,e.c,e.d,e.e,e.f)}function QLe(t){return t==null||(Ow||(Ow=document.createElementNS("http://www.w3.org/2000/svg","g")),Ow.setAttribute("transform",t),!(t=Ow.transform.baseVal.consolidate()))?ER:(t=t.matrix,Hee(t.a,t.b,t.c,t.d,t.e,t.f))}function Gee(t,e,r,n){function i(f){return f.length?f.pop()+" ":""}function a(f,d,m,b,x,E){if(f!==m||d!==b){var T=x.push("translate(",null,e,null,r);E.push({i:T-4,x:ag(f,m)},{i:T-2,x:ag(d,b)})}else(m||b)&&x.push("translate("+m+e+b+r)}function s(f,d,m,b){f!==d?(f-d>180?d+=360:d-f>180&&(f+=360),b.push({i:m.push(i(m)+"rotate(",null,n)-2,x:ag(f,d)})):d&&m.push(i(m)+"rotate("+d+n)}function o(f,d,m,b){f!==d?b.push({i:m.push(i(m)+"skewX(",null,n)-2,x:ag(f,d)}):d&&m.push(i(m)+"skewX("+d+n)}function c(f,d,m,b,x,E){if(f!==m||d!==b){var T=x.push(i(x)+"scale(",null,",",null,")");E.push({i:T-4,x:ag(f,m)},{i:T-2,x:ag(d,b)})}else(m!==1||b!==1)&&x.push(i(x)+"scale("+m+","+b+")")}return function(f,d){var m=[],b=[];return f=t(f),d=t(d),a(f.translateX,f.translateY,d.translateX,d.translateY,m,b),s(f.rotate,d.rotate,m,b),o(f.skewX,d.skewX,m,b),c(f.scaleX,f.scaleY,d.scaleX,d.scaleY,m,b),f=d=null,function(x){for(var E=-1,T=b.length,A;++E<T;)m[(A=b[E]).i]=A.x(x);return m.join("")}}}var eNe=Gee(JLe,"px, ","px)","deg)"),tNe=Gee(QLe,", ",")",")"),J0=0,W1=0,b1=0,Wee=1e3,$E,X1,qE=0,oy=0,j3=0,ox=typeof performance=="object"&&performance.now?performance:Date,Xee=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function wN(){return oy||(Xee(rNe),oy=ox.now()+j3)}function rNe(){oy=0}function HE(){this._call=this._time=this._next=null}HE.prototype=Yee.prototype={constructor:HE,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?wN():+r)+(e==null?0:+e),!this._next&&X1!==this&&(X1?X1._next=this:$E=this,X1=this),this._call=t,this._time=r,TR()},stop:function(){this._call&&(this._call=null,this._time=1/0,TR())}};function Yee(t,e,r){var n=new HE;return n.restart(t,e,r),n}function nNe(){wN(),++J0;for(var t=$E,e;t;)(e=oy-t._time)>=0&&t._call.call(void 0,e),t=t._next;--J0}function nH(){oy=(qE=ox.now())+j3,J0=W1=0;try{nNe()}finally{J0=0,aNe(),oy=0}}function iNe(){var t=ox.now(),e=t-qE;e>Wee&&(j3-=e,qE=t)}function aNe(){for(var t,e=$E,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:$E=r);X1=t,TR(n)}function TR(t){if(!J0){W1&&(W1=clearTimeout(W1));var e=t-oy;e>24?(t<1/0&&(W1=setTimeout(nH,t-ox.now()-j3)),b1&&(b1=clearInterval(b1))):(b1||(qE=ox.now(),b1=setInterval(iNe,Wee)),J0=1,Xee(nH))}}function iH(t,e,r){var n=new HE;return e=e==null?0:+e,n.restart(i=>{n.stop(),t(i+e)},e,r),n}var oNe=Pee("start","end","cancel","interrupt"),sNe=[],Zee=0,aH=1,CR=2,xS=3,oH=4,AR=5,wS=6;function U3(t,e,r,n,i,a){var s=t.__transition;if(!s)t.__transition={};else if(r in s)return;lNe(t,r,{name:e,index:n,group:i,on:oNe,tween:sNe,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Zee})}function SN(t,e){var r=Nh(t,e);if(r.state>Zee)throw new Error("too late; already scheduled");return r}function kd(t,e){var r=Nh(t,e);if(r.state>xS)throw new Error("too late; already running");return r}function Nh(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function lNe(t,e,r){var n=t.__transition,i;n[e]=r,r.timer=Yee(a,0,r.time);function a(f){r.state=aH,r.timer.restart(s,r.delay,r.time),r.delay<=f&&s(f-r.delay)}function s(f){var d,m,b,x;if(r.state!==aH)return c();for(d in n)if(x=n[d],x.name===r.name){if(x.state===xS)return iH(s);x.state===oH?(x.state=wS,x.timer.stop(),x.on.call("interrupt",t,t.__data__,x.index,x.group),delete n[d]):+d<e&&(x.state=wS,x.timer.stop(),x.on.call("cancel",t,t.__data__,x.index,x.group),delete n[d])}if(iH(function(){r.state===xS&&(r.state=oH,r.timer.restart(o,r.delay,r.time),o(f))}),r.state=CR,r.on.call("start",t,t.__data__,r.index,r.group),r.state===CR){for(r.state=xS,i=new Array(b=r.tween.length),d=0,m=-1;d<b;++d)(x=r.tween[d].value.call(t,t.__data__,r.index,r.group))&&(i[++m]=x);i.length=m+1}}function o(f){for(var d=f<r.duration?r.ease.call(null,f/r.duration):(r.timer.restart(c),r.state=AR,1),m=-1,b=i.length;++m<b;)i[m].call(t,d);r.state===AR&&(r.on.call("end",t,t.__data__,r.index,r.group),c())}function c(){r.state=wS,r.timer.stop(),delete n[e];for(var f in n)return;delete t.__transition}}function uNe(t,e){var r=t.__transition,n,i,a=!0,s;if(r){e=e==null?null:e+"";for(s in r){if((n=r[s]).name!==e){a=!1;continue}i=n.state>CR&&n.state<AR,n.state=wS,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[s]}a&&delete t.__transition}}function cNe(t){return this.each(function(){uNe(this,t)})}function fNe(t,e){var r,n;return function(){var i=kd(this,t),a=i.tween;if(a!==r){n=r=a;for(var s=0,o=n.length;s<o;++s)if(n[s].name===e){n=n.slice(),n.splice(s,1);break}}i.tween=n}}function hNe(t,e,r){var n,i;if(typeof r!="function")throw new Error;return function(){var a=kd(this,t),s=a.tween;if(s!==n){i=(n=s).slice();for(var o={name:e,value:r},c=0,f=i.length;c<f;++c)if(i[c].name===e){i[c]=o;break}c===f&&i.push(o)}a.tween=i}}function dNe(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=Nh(this.node(),r).tween,i=0,a=n.length,s;i<a;++i)if((s=n[i]).name===t)return s.value;return null}return this.each((e==null?fNe:hNe)(r,t,e))}function EN(t,e,r){var n=t._id;return t.each(function(){var i=kd(this,n);(i.value||(i.value={}))[e]=r.apply(this,arguments)}),function(i){return Nh(i,n).value[e]}}function Kee(t,e){var r;return(typeof e=="number"?ag:e instanceof ax?tH:(r=ax(e))?(e=r,tH):KLe)(t,e)}function pNe(t){return function(){this.removeAttribute(t)}}function gNe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function mNe(t,e,r){var n,i=r+"",a;return function(){var s=this.getAttribute(t);return s===i?null:s===n?a:a=e(n=s,r)}}function yNe(t,e,r){var n,i=r+"",a;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===n?a:a=e(n=s,r)}}function vNe(t,e,r){var n,i,a;return function(){var s,o=r(this),c;return o==null?void this.removeAttribute(t):(s=this.getAttribute(t),c=o+"",s===c?null:s===n&&c===i?a:(i=c,a=e(n=s,o)))}}function _Ne(t,e,r){var n,i,a;return function(){var s,o=r(this),c;return o==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),c=o+"",s===c?null:s===n&&c===i?a:(i=c,a=e(n=s,o)))}}function bNe(t,e){var r=z3(t),n=r==="transform"?tNe:Kee;return this.attrTween(t,typeof e=="function"?(r.local?_Ne:vNe)(r,n,EN(this,"attr."+t,e)):e==null?(r.local?gNe:pNe)(r):(r.local?yNe:mNe)(r,n,e))}function xNe(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function wNe(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function SNe(t,e){var r,n;function i(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&wNe(t,a)),r}return i._value=e,i}function ENe(t,e){var r,n;function i(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&xNe(t,a)),r}return i._value=e,i}function TNe(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=z3(t);return this.tween(r,(n.local?SNe:ENe)(n,e))}function CNe(t,e){return function(){SN(this,t).delay=+e.apply(this,arguments)}}function ANe(t,e){return e=+e,function(){SN(this,t).delay=e}}function INe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?CNe:ANe)(e,t)):Nh(this.node(),e).delay}function PNe(t,e){return function(){kd(this,t).duration=+e.apply(this,arguments)}}function MNe(t,e){return e=+e,function(){kd(this,t).duration=e}}function kNe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?PNe:MNe)(e,t)):Nh(this.node(),e).duration}function RNe(t,e){if(typeof e!="function")throw new Error;return function(){kd(this,t).ease=e}}function DNe(t){var e=this._id;return arguments.length?this.each(RNe(e,t)):Nh(this.node(),e).ease}function ONe(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;kd(this,t).ease=r}}function LNe(t){if(typeof t!="function")throw new Error;return this.each(ONe(this._id,t))}function NNe(t){typeof t!="function"&&(t=Ree(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var a=e[i],s=a.length,o=n[i]=[],c,f=0;f<s;++f)(c=a[f])&&t.call(c,c.__data__,f,a)&&o.push(c);return new Ep(n,this._parents,this._name,this._id)}function FNe(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,i=r.length,a=Math.min(n,i),s=new Array(n),o=0;o<a;++o)for(var c=e[o],f=r[o],d=c.length,m=s[o]=new Array(d),b,x=0;x<d;++x)(b=c[x]||f[x])&&(m[x]=b);for(;o<n;++o)s[o]=e[o];return new Ep(s,this._parents,this._name,this._id)}function BNe(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function zNe(t,e,r){var n,i,a=BNe(e)?SN:kd;return function(){var s=a(this,t),o=s.on;o!==n&&(i=(n=o).copy()).on(e,r),s.on=i}}function jNe(t,e){var r=this._id;return arguments.length<2?Nh(this.node(),r).on.on(t):this.each(zNe(r,t,e))}function UNe(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function VNe(){return this.on("end.remove",UNe(this._id))}function $Ne(t){var e=this._name,r=this._id;typeof t!="function"&&(t=_N(t));for(var n=this._groups,i=n.length,a=new Array(i),s=0;s<i;++s)for(var o=n[s],c=o.length,f=a[s]=new Array(c),d,m,b=0;b<c;++b)(d=o[b])&&(m=t.call(d,d.__data__,b,o))&&("__data__"in d&&(m.__data__=d.__data__),f[b]=m,U3(f[b],e,r,b,f,Nh(d,r)));return new Ep(a,this._parents,e,r)}function qNe(t){var e=this._name,r=this._id;typeof t!="function"&&(t=kee(t));for(var n=this._groups,i=n.length,a=[],s=[],o=0;o<i;++o)for(var c=n[o],f=c.length,d,m=0;m<f;++m)if(d=c[m]){for(var b=t.call(d,d.__data__,m,c),x,E=Nh(d,r),T=0,A=b.length;T<A;++T)(x=b[T])&&U3(x,e,r,T,b,E);a.push(b),s.push(d)}return new Ep(a,s,e,r)}var HNe=Kx.prototype.constructor;function GNe(){return new HNe(this._groups,this._parents)}function WNe(t,e){var r,n,i;return function(){var a=K0(this,t),s=(this.style.removeProperty(t),K0(this,t));return a===s?null:a===r&&s===n?i:i=e(r=a,n=s)}}function Jee(t){return function(){this.style.removeProperty(t)}}function XNe(t,e,r){var n,i=r+"",a;return function(){var s=K0(this,t);return s===i?null:s===n?a:a=e(n=s,r)}}function YNe(t,e,r){var n,i,a;return function(){var s=K0(this,t),o=r(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(t),K0(this,t))),s===c?null:s===n&&c===i?a:(i=c,a=e(n=s,o))}}function ZNe(t,e){var r,n,i,a="style."+e,s="end."+a,o;return function(){var c=kd(this,t),f=c.on,d=c.value[a]==null?o||(o=Jee(e)):void 0;(f!==r||i!==d)&&(n=(r=f).copy()).on(s,i=d),c.on=n}}function KNe(t,e,r){var n=(t+="")=="transform"?eNe:Kee;return e==null?this.styleTween(t,WNe(t,n)).on("end.style."+t,Jee(t)):typeof e=="function"?this.styleTween(t,YNe(t,n,EN(this,"style."+t,e))).each(ZNe(this._id,t)):this.styleTween(t,XNe(t,n,e),r).on("end.style."+t,null)}function JNe(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function QNe(t,e,r){var n,i;function a(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&JNe(t,s,r)),n}return a._value=e,a}function e6e(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,QNe(t,e,r??""))}function t6e(t){return function(){this.textContent=t}}function r6e(t){return function(){var e=t(this);this.textContent=e??""}}function n6e(t){return this.tween("text",typeof t=="function"?r6e(EN(this,"text",t)):t6e(t==null?"":t+""))}function i6e(t){return function(e){this.textContent=t.call(this,e)}}function a6e(t){var e,r;function n(){var i=t.apply(this,arguments);return i!==r&&(e=(r=i)&&i6e(i)),e}return n._value=t,n}function o6e(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,a6e(t))}function s6e(){for(var t=this._name,e=this._id,r=Qee(),n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,c,f=0;f<o;++f)if(c=s[f]){var d=Nh(c,e);U3(c,t,r,f,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Ep(n,this._parents,t,r)}function l6e(){var t,e,r=this,n=r._id,i=r.size();return new Promise(function(a,s){var o={value:s},c={value:function(){--i===0&&a()}};r.each(function(){var f=kd(this,n),d=f.on;d!==t&&(e=(t=d).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(c)),f.on=e}),i===0&&a()})}var u6e=0;function Ep(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function Qee(){return++u6e}var ep=Kx.prototype;Ep.prototype={constructor:Ep,select:$Ne,selectAll:qNe,selectChild:ep.selectChild,selectChildren:ep.selectChildren,filter:NNe,merge:FNe,selection:GNe,transition:s6e,call:ep.call,nodes:ep.nodes,node:ep.node,size:ep.size,empty:ep.empty,each:ep.each,on:jNe,attr:bNe,attrTween:TNe,style:KNe,styleTween:e6e,text:n6e,textTween:o6e,remove:VNe,tween:dNe,delay:INe,duration:kNe,ease:DNe,easeVarying:LNe,end:l6e,[Symbol.iterator]:ep[Symbol.iterator]};function c6e(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var f6e={time:null,delay:0,duration:250,ease:c6e};function h6e(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function d6e(t){var e,r;t instanceof Ep?(e=t._id,t=t._name):(e=Qee(),(r=f6e).time=wN(),t=t==null?null:t+"");for(var n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],o=s.length,c,f=0;f<o;++f)(c=s[f])&&U3(c,t,e,f,s,r||h6e(c,e));return new Ep(n,this._parents,t,e)}Kx.prototype.interrupt=cNe;Kx.prototype.transition=d6e;var sH={},SP={},EP=34,x1=10,TP=13;function ete(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+'] || ""'}).join(",")+"}")}function p6e(t,e){var r=ete(t);return function(n,i){return e(r(n),i,t)}}function lH(t){var e=Object.create(null),r=[];return t.forEach(function(n){for(var i in n)i in e||r.push(e[i]=i)}),r}function Ac(t,e){var r=t+"",n=r.length;return n<e?new Array(e-n+1).join(0)+r:r}function g6e(t){return t<0?"-"+Ac(-t,6):t>9999?"+"+Ac(t,6):Ac(t,4)}function m6e(t){var e=t.getUTCHours(),r=t.getUTCMinutes(),n=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":g6e(t.getUTCFullYear())+"-"+Ac(t.getUTCMonth()+1,2)+"-"+Ac(t.getUTCDate(),2)+(i?"T"+Ac(e,2)+":"+Ac(r,2)+":"+Ac(n,2)+"."+Ac(i,3)+"Z":n?"T"+Ac(e,2)+":"+Ac(r,2)+":"+Ac(n,2)+"Z":r||e?"T"+Ac(e,2)+":"+Ac(r,2)+"Z":"")}function y6e(t){var e=new RegExp('["'+t+`
\r]`),r=t.charCodeAt(0);function n(m,b){var x,E,T=i(m,function(A,R){if(x)return x(A,R-1);E=A,x=b?p6e(A,b):ete(A)});return T.columns=E||[],T}function i(m,b){var x=[],E=m.length,T=0,A=0,R,F=E<=0,N=!1;m.charCodeAt(E-1)===x1&&--E,m.charCodeAt(E-1)===TP&&--E;function O(){if(F)return SP;if(N)return N=!1,sH;var j,H=T,W;if(m.charCodeAt(H)===EP){for(;T++<E&&m.charCodeAt(T)!==EP||m.charCodeAt(++T)===EP;);return(j=T)>=E?F=!0:(W=m.charCodeAt(T++))===x1?N=!0:W===TP&&(N=!0,m.charCodeAt(T)===x1&&++T),m.slice(H+1,j-1).replace(/""/g,'"')}for(;T<E;){if((W=m.charCodeAt(j=T++))===x1)N=!0;else if(W===TP)N=!0,m.charCodeAt(T)===x1&&++T;else if(W!==r)continue;return m.slice(H,j)}return F=!0,m.slice(H,E)}for(;(R=O())!==SP;){for(var U=[];R!==sH&&R!==SP;)U.push(R),R=O();b&&(U=b(U,A++))==null||x.push(U)}return x}function a(m,b){return m.map(function(x){return b.map(function(E){return d(x[E])}).join(t)})}function s(m,b){return b==null&&(b=lH(m)),[b.map(d).join(t)].concat(a(m,b)).join(`
`)}function o(m,b){return b==null&&(b=lH(m)),a(m,b).join(`
`)}function c(m){return m.map(f).join(`
`)}function f(m){return m.map(d).join(t)}function d(m){return m==null?"":m instanceof Date?m6e(m):e.test(m+="")?'"'+m.replace(/"/g,'""')+'"':m}return{parse:n,parseRows:i,format:s,formatBody:o,formatRows:c,formatRow:f,formatValue:d}}var v6e=y6e(","),_6e=v6e.parse;function b6e(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function tte(t,e){return fetch(t,e).then(b6e)}function x6e(t){return function(e,r,n){return arguments.length===2&&typeof r=="function"&&(n=r,r=void 0),tte(e,r).then(function(i){return t(i,n)})}}var w6e=x6e(_6e);function S6e(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function E6e(t,e){return fetch(t,e).then(S6e)}function T6e(t){return(e,r)=>tte(e,r).then(n=>new DOMParser().parseFromString(n,t))}const C6e=T6e("application/xml");function Y1(t,e,r){this.k=t,this.x=e,this.y=r}Y1.prototype={constructor:Y1,scale:function(t){return t===1?this:new Y1(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Y1(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Y1.prototype;const uH=t=>{const[e,r]=te.useState();te.useEffect(()=>{if(!t.url)return;let i=null;t.format==="json"?i=E6e(t.url):t.format==="csv"?i=w6e(t.url):t.format==="xml"&&(i=C6e(t.url)),i&&i.then(a=>{if(t.format==="xml"){if(t.nodeType){const s=[];a.querySelectorAll(t.nodeType).forEach(o=>{typeof t.formatData=="function"&&s.push(t.formatData(o))}),r(s)}}else{let s=a;t.data_property&&(s=a[t.data_property]),typeof t.formatData=="function"?r(s.map(t.formatData)):r(s)}typeof t.onData=="function"&&t.onData()})},[t.url,t]);const n={data:e,setData:r};return J.jsx(bR,{value:n,children:t.children})};try{uH.displayName="SimpleDataProvider",uH.__docgenInfo={description:"",displayName:"SimpleDataProvider",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},format:{defaultValue:null,description:"",name:"format",required:!0,type:{name:"enum",value:[{value:'"json"'},{value:'"csv"'},{value:'"xml"'}]}},nodeType:{defaultValue:null,description:"",name:"nodeType",required:!0,type:{name:"string"}},data_property:{defaultValue:null,description:"",name:"data_property",required:!0,type:{name:"string"}},formatData:{defaultValue:null,description:"",name:"formatData",required:!1,type:{name:"((data: any) => any) | undefined"}},onData:{defaultValue:null,description:"",name:"onData",required:!0,type:{name:"() => void"}}}}}catch{}const SS=Ji(J.jsx("path",{d:"M12 4c4.41 0 8 3.59 8 8s-3.59 8-8 8-8-3.59-8-8 3.59-8 8-8m0-2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 10V8h-2v4H8l4 4 4-4z"})),ES=Ji(J.jsx("path",{d:"M12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0 2c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10m-1-10v4h2v-4h3l-4-4-4 4z"})),CP=Ji(J.jsx("path",{d:"M5 15H3v4c0 1.1.9 2 2 2h4v-2H5zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2m0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"})),A6e=t=>{let{transform:e}=t;return{...e,x:0}},tp=Dr(uf)({padding:"4px",marginTop:"-3px",background:"none","&:hover":{background:"none"}});function IR(t){const e=fRe(),r=ga({mapId:void 0});function n(m){const b=m.id&&r.map?.getLayer(m.id)?.source?r.map?.getLayer(m.id)?.source:void 0;let x=null;switch(m.type){case"geojson":if(m.config?.geojson)r.map?.fitBounds(df(m.config?.geojson),t.fitBoundsOptions);else{if(!b)return;const E={type:"FeatureCollection",features:r.map?.querySourceFeatures(b)};E.features.length===0&&(r.map?.zoomTo(1),E.features=r.map?.querySourceFeatures(b)),x=df(E)}break;case"vt":console.log("vt");break;case"wms":x=m?.config?.config?.layers?.[0]?.EX_GeographicBoundingBox;break;default:return}x&&r.map?.fitBounds(x,t.fitBoundsOptions)}const i=te.useMemo(()=>["order-background",...[...e.layers].map((b,x)=>"content_order_"+x),"order-labels"],[e.layers]),a=te.useMemo(()=>t.layers?t.layers:e?.layers?e.layers:[],[t.layers,e.layers]),s=te.useMemo(()=>t.setLayers?t.setLayers:e.setLayers,[t.setLayers,e.setLayers]),o=H$(sN,{activationConstraint:{distance:5}}),c=H$(zQ,{activationConstraint:{distance:5}}),f=sPe(c,o);function d(m){const b=m.active.id,x=m.over?.data?.current?.sortable.index;e.moveLayer(String(b),()=>x)}return J.jsxs(J.Fragment,{children:[J.jsx(NE,{layerIds:i,insertBeforeLayer:"_background"}),e?.symbolLayers?.length>0&&J.jsx(cp,{layerComponent:J.jsx(I0,{...e.vtLayerConfig,layers:e.symbolLayers,mapId:t?.mapId,insertBeforeLayer:"order-labels"}),setLayerState:m=>e.setSymbolLayers(m?.layers),visible:!0,configurable:!0,type:"layer",name:"Labels"},"background_labels"),J.jsx(cMe,{collisionDetection:hPe,sensors:f,onDragEnd:m=>d(m),modifiers:[A6e],children:J.jsxs(SMe,{items:a,strategy:xMe,children:[[...a].map((m,b)=>{if(!m?.id)return null;switch(m.type){case"geojson":return J.jsx(cp,{layerId:m.id,sortable:t.sortable,name:m?.name||m?.config?.type+" layer"||"unnamed layer",layerComponent:J.jsx(Dc,{...m.config,mapId:t?.mapId,layerId:m.id,insertBeforeLayer:"content_order_"+(a.length-1-b)}),buttons:J.jsxs(J.Fragment,{children:[J.jsx(tp,{disabled:b===a.length-1,onClick:()=>{e.moveDown(m.id||"")},children:J.jsx(SS,{})}),J.jsx(tp,{disabled:b===0,onClick:()=>{e.moveUp(m.id||"")},children:J.jsx(ES,{})}),J.jsx(tp,{onClick:()=>n(m),children:J.jsx(CP,{})})]}),setLayerState:x=>s?.(E=>{const T=[...E];return x===!1?T.splice(b,1):T[b].config=x,T}),configurable:!0,showDeleteButton:!0},m.id);case"wms":return J.jsx(J.Fragment,{children:te.createElement(fR,{...m.config,key:m.id,layerId:m.id,sortable:t.sortable,mapId:t?.mapId,insertBeforeLayer:"content_order_"+(a.length-1-b),onConfigChange:x=>{s?.(E=>{const T=[...E];return x===!1?T.splice(b,1):T[b].config.config=x,T})},featureInfoActive:m?.config?.featureInfoActive||!1,setFeatureInfoActive:x=>{s?.(E=>{const T=[...E];return typeof x=="function"&&(T[b].config.featureInfoActive=x(T[b].config?.featureInfoActive||!1)),T})},showDeleteButton:!0,buttons:J.jsxs(J.Fragment,{children:[J.jsx(tp,{disabled:b===a.length-1,onClick:()=>{e.moveDown(m.id||"")},children:J.jsx(SS,{})}),J.jsx(tp,{disabled:b===0,onClick:()=>{e.moveUp(m.id||"")},children:J.jsx(ES,{})}),J.jsx(tp,{onClick:()=>n(m),children:J.jsx(CP,{})})]})})});case"vt":return J.jsx(gt.Fragment,{children:J.jsx(cp,{name:m?.name||m?.type+" layer"||"unnamed layer",layerComponent:J.jsx(I0,{layers:m?.config?.layers||[],mapId:m?.config.mapId,sourceOptions:m?.config?.sourceOptions,layerId:m.id,url:m?.config?.url},m.id),buttons:J.jsxs(J.Fragment,{children:[J.jsx(tp,{disabled:b===a.length-1,onClick:()=>{e.moveDown(m.id||"")},children:J.jsx(SS,{})},m.id+"_button1"),J.jsx(tp,{disabled:b===0,onClick:()=>{e.moveUp(m.id||"")},children:J.jsx(ES,{})},m.id+"_button2"),J.jsx(tp,{onClick:()=>n(m),children:J.jsx(CP,{})})]}),setLayerState:x=>s?.(E=>{const T=[...E];return x===!1?T.splice(b,1):T[b].config=x,T}),configurable:!0,showDeleteButton:!0},m.id)},m?.id+"_listItem");default:return null}}),e?.backgroundLayers?.length>0&&J.jsx(cp,{layerComponent:J.jsx(I0,{...e.vtLayerConfig,layers:e.backgroundLayers,mapId:t?.mapId,insertBeforeLayer:"order-background"}),setLayerState:m=>{e.setBackgroundLayers(m?.layers)},visible:!0,configurable:!0,type:"layer",name:"Background"},"background_geometry")]})})]})}IR.defaultProps={mapId:void 0};try{IR.displayName="LayerListItemFactory",IR.__docgenInfo={description:"",displayName:"LayerListItemFactory",props:{mapId:{defaultValue:{value:"undefined"},description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},layers:{defaultValue:null,description:"",name:"layers",required:!0,type:{name:"LayerConfig[]"}},setLayers:{defaultValue:null,description:"",name:"setLayers",required:!1,type:{name:"((layers: LayerConfig[] | ((state: LayerConfig[]) => LayerConfig[])) => void) | undefined"}},insertBeforeLayer:{defaultValue:null,description:"",name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},fitBoundsOptions:{defaultValue:null,description:"",name:"fitBoundsOptions",required:!1,type:{name:"FitBoundsOptions | undefined"}}}}}catch{}const I6e=Ji(J.jsx("path",{d:"M14 10H3v2h11zm0-4H3v2h11zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2zM3 16h7v-2H3z"})),P6e=["fill","line","circle"];function PR(t){const[e,r]=gt.useState({type:"circle"}),n=te.useMemo(()=>!(!e?.type||!e?.geojson),[e]);return J.jsxs(J.Fragment,{children:[J.jsx(yy,{children:"GeoJSON layer"}),J.jsxs(af,{fullWidth:!0,children:[J.jsx(vg,{id:"type-label",children:"Type"}),J.jsx(_g,{labelId:"type-label",value:e.type,label:"Type",onChange:i=>r(a=>({...a,type:i.target.value})),children:P6e.map(i=>J.jsx(Fm,{value:i,children:i},i))})]}),J.jsx(af,{fullWidth:!0,children:J.jsxs(ta,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Upload File",J.jsx("input",{type:"file",hidden:!0,onChange:i=>{i.target.files?.[0].text().then(a=>r(s=>({...s,geojson:JSON.parse(a)})))}})]})}),J.jsxs(Mx,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!n,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{PR.displayName="GeoJsonLayerForm",PR.__docgenInfo={description:"",displayName:"GeoJsonLayerForm",props:{config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"MlGeoJsonLayerProps | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlGeoJsonLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const M6e=Ji([J.jsx("path",{d:"M8 8H6v7c0 1.1.9 2 2 2h9v-2H8z"},"0"),J.jsx("path",{d:"M20 3h-8c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 8h-8V7h8zM4 12H2v7c0 1.1.9 2 2 2h9v-2H4z"},"1")]),GE=t=>J.jsxs(J.Fragment,{children:[J.jsx(yy,{children:t.layerTypes.length>1?"Select a layer type":"Load new layer"}),J.jsx(kh,{children:t.layerTypes.map((e,r)=>J.jsx(qf,{disableGutters:!0,children:J.jsxs(fY,{autoFocus:!0,onClick:()=>{t.onSelect(e)},children:[J.jsx(dY,{children:J.jsx(QX,{children:J.jsx(M6e,{})})}),J.jsx(Df,{primary:e})]})},r))})]});GE.defaultProps={};try{GE.displayName="LayerTypeForm",GE.__docgenInfo={description:"",displayName:"LayerTypeForm",props:{onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(type: string) => void"}},layerTypes:{defaultValue:null,description:"",name:"layerTypes",required:!0,type:{name:"string[]"}}}}}catch{}function MR(t){const[e,r]=gt.useState({url:""}),n=te.useMemo(()=>!!e?.url,[e]);return J.jsxs(J.Fragment,{children:[J.jsx(yy,{children:"WMS layer"}),J.jsx(lO,{children:J.jsxs(af,{fullWidth:!0,sx:{marginTop:"10px"},children:[J.jsx(vg,{htmlFor:"wms-url-input",children:"WMS URL"}),J.jsx(KT,{id:"wms-url-input",label:"WMS URL",value:e.url,onChange:i=>r({...e,url:i.target.value})})]})}),J.jsxs(Mx,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!n,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{MR.displayName="WmsLayerForm",MR.__docgenInfo={description:"",displayName:"WmsLayerForm",props:{onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: wmsConfig) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const rte=Ji(J.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),nte=Ji(J.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10H7v-2h10z"})),k6e=["latfield","lonfield","delimiter"];function kR(t){const[e,r]=te.useState(!1);return J.jsxs(J.Fragment,{children:[J.jsx(Es,{children:" Options "}),J.jsx(ta,{onClick:()=>r(!e),children:e?J.jsx(nte,{}):J.jsx(rte,{})}),J.jsx(kh,{children:e&&k6e?.map(n=>J.jsxs(J.Fragment,{children:[J.jsx(qf,{children:J.jsxs(Es,{children:[" ",n," "]})}),J.jsx(qf,{children:J.jsx(JT,{size:"small",onChange:i=>{const a={};a[n]=i.target.value,t.setter(a)}})})]}))})]})}try{kR.displayName="CSVOptionsFormular",kR.__docgenInfo={description:"",displayName:"CSVOptionsFormular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"any"}}}}}catch{}const R6e=["completeFeature","allFeatures","renderTagged","excludeWay","suppressWay"];function RR(t){const[e,r]=te.useState(!1);return J.jsxs(J.Fragment,{children:[J.jsx(Es,{children:" Options "}),J.jsx(ta,{onClick:()=>r(!e),children:e?J.jsx(nte,{}):J.jsx(rte,{})}),J.jsx(kh,{children:e&&R6e?.map(n=>J.jsx(J.Fragment,{children:J.jsxs(qf,{children:[J.jsxs(Es,{children:[" ",n," "]}),J.jsx(z0,{onChange:i=>{const a={};a[n]=i.target.value==="on",t.setter(a)}})]})}))})]})}try{RR.displayName="OsmOptionsFomular",RR.__docgenInfo={description:"",displayName:"OsmOptionsFomular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"any"}}}}}catch{}const D6e={csv:IRe,topojson:hDe,osm:uDe,gpx:bP,kml:bP,tcx:bP},O6e=["fill","line","circle"];function DR(t){const[e,r]=te.useState({type:"circle"}),[n,i]=te.useState(),[a,s]=te.useState(),[o,c]=te.useState({}),f=ga({mapId:t.mapId}),d="?"+new URLSearchParams(o).toString();FE({protocol:t.originType,handler:D6e[t.originType]});const m=te.useMemo(()=>e?.type?!!(a&&n):!1,[e,a,n]);te.useEffect(()=>(typeof n<"u"&&typeof a<"u"&&(f.map?.getSource(n)||f.map?.addSource(n,{type:"geojson",data:o?t.originType+"://"+a+d:t.originType+"://"+a}),e.options={source:n}),()=>{}),[n,f.map,a]),te.useEffect(()=>{a&&n&&f.map?.getLayer(n)&&URL.revokeObjectURL(a)},[n,a,f.map]);function b(x){const E={...o,...x};return c(E)}return J.jsxs(J.Fragment,{children:[J.jsxs(yy,{children:["Layer from ",t.originType]}),J.jsxs(af,{fullWidth:!0,children:[J.jsx(vg,{id:"type-label",children:"Type"}),J.jsx(_g,{labelId:"type-label",value:e.type,label:"Type",onChange:x=>r(E=>({...E,type:x.target.value})),children:O6e.map(x=>J.jsx(Fm,{value:x,children:x},x))})]}),J.jsxs(af,{fullWidth:!0,children:[J.jsxs(ta,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Select origin file",J.jsx("input",{type:"file",hidden:!0,accept:t.originType,onChange:x=>{if(i(x.target.files?.[0].name),x.target.files?.[0]){const E=URL.createObjectURL(x.target.files?.[0]);s(E)}}})]}),t.originType==="csv"&&J.jsx(kR,{setter:b}),t.originType==="osm"&&J.jsx(RR,{setter:b})]}),J.jsxs(Mx,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!m,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{DR.displayName="ProtocolHandlerLayerForm",DR.__docgenInfo={description:"",displayName:"ProtocolHandlerLayerForm",props:{originType:{defaultValue:null,description:"",name:"originType",required:!0,type:{name:"string"}},config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"MlGeoJsonLayerProps | undefined"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlGeoJsonLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const L6e=["id","type","metadata","source","source-layer","layout","paint","options"];function OR(t){const[e,r]=te.useState([]),n={},i=["paint","layout","options","metadata"];te.useEffect(()=>{t.setter(e)},[e]);const a=()=>J.jsx(J.Fragment,{children:L6e.map(o=>J.jsx(gt.Fragment,{children:J.jsx(JT,{label:o,onChange:c=>n[o]=c.target.value})},o+"_fragment"))});function s(){i.map(o=>{if(typeof n[o]<"u")try{n[o]=JSON.parse(n[o])}catch{alert("Invalid JSON format, try again")}}),r(o=>o.length>0?[n,...o]:[n])}return J.jsxs(J.Fragment,{children:[J.jsx(af,{fullWidth:!0,children:J.jsx(a,{})}),J.jsx(ta,{onClick:s,children:" Add"})]})}try{OR.displayName="MbtilesLayerPropFormular",OR.__docgenInfo={description:"",displayName:"MbtilesLayerPropFormular",props:{setter:{defaultValue:null,description:"",name:"setter",required:!0,type:{name:"Dispatch<SetStateAction<LayerSpecification[]>>"}}}}}catch{}const N6e=Ji(J.jsx("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"})),F6e=Ji(J.jsx("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}));function LR(t){const[e,r]=gt.useState(t.config),[n,i]=te.useState(),[a,s]=te.useState(),[o,c]=te.useState([]),f=ga({mapId:t.mapId}),[d,m]=te.useState(!1);console.log(o);const b=()=>J.jsx(J.Fragment,{children:o.map((E,T)=>J.jsxs(Es,{variant:"body2",children:[T+1,": ",JSON.stringify(E)]},T))}),x=te.useMemo(()=>!!n,[n]);return te.useEffect(()=>{typeof n<"u"&&typeof a<"u"&&r({url:"mbtiles://"+a+"/{z}/{x}/{y}",layers:o,layerId:n,sourceOptions:{type:"vector",minzoom:0,maxzoom:1}})},[n,f.map,a,o]),J.jsxs(J.Fragment,{children:[J.jsx(yy,{children:" Layer from mbtiles file"}),J.jsxs(lO,{children:[J.jsxs(ta,{variant:"contained",component:"label",sx:{marginTop:"10px"},children:["Select origin file",J.jsx("input",{type:"file",hidden:!0,accept:t.originType,onChange:E=>{if(i(E.target.files?.[0].name),E.target.files?.[0]){const T=URL.createObjectURL(E.target.files?.[0]);s(T)}}})]}),J.jsxs(ife,{expanded:d,children:[J.jsxs(Efe,{"aria-controls":"panel1d-content",id:"panel1d-header",children:[J.jsx(Es,{children:"MB-Tile Layer properties"}),J.jsx(ta,{onClick:()=>m(!d),children:d?J.jsx(F6e,{}):J.jsx(N6e,{})})]}),J.jsx(Es,{variant:"body1",children:" Layers"}),o.length>0?J.jsx(b,{}):J.jsx(Es,{variant:"body2",children:" 0 "}),J.jsx(OR,{setter:c})]})]}),J.jsxs(Mx,{children:[J.jsx(ta,{onClick:t.onCancel,children:"Cancel"}),J.jsx(ta,{disabled:!x,onClick:()=>t.onSubmit(e),children:"Add"})]})]})}try{LR.displayName="MbtilesLayerForm",LR.__docgenInfo={description:"",displayName:"MbtilesLayerForm",props:{originType:{defaultValue:null,description:"",name:"originType",required:!0,type:{name:"string"}},config:{defaultValue:null,description:"",name:"config",required:!0,type:{name:"MlVectorTileLayerProps"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(config: MlVectorTileLayerProps) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}const WE=t=>{const[e,r]=te.useState(t?.config),[n,i]=te.useState(),a=t.layerTypes,s=a.filter(m=>m!=="wms"&&m!=="geojson"&&m!=="mbtiles"),o=["wms","geojson","vt","csv","mbtiles","topojson","osm","gpx","kml","tcx"],c=m=>{i(m),s.includes(m)?r({type:"geojson",config:{}}):r(m==="mbtiles"?{type:"vt",config:{layers:[]}}:{type:m,config:{}})},f=()=>{t.setOpen(!1),r(void 0)},d=()=>J.jsx(J.Fragment,{children:s.map((m,b)=>J.jsx(J.Fragment,{children:e?.type==="geojson"&&n===m&&J.jsx(DR,{originType:m,onSubmit:x=>{t?.onComplete?.({...e,config:x,type:"geojson"}),f()},onCancel:f},b)}))});return J.jsxs(sO,{open:t.open,onClose:f,children:[!e?.type&&J.jsx(GE,{onSelect:m=>{o.includes(m)&&c(m)},layerTypes:a}),e?.type==="geojson"&&n==="geojson"&&J.jsx(PR,{onSubmit:m=>{t?.onComplete?.({...e,config:m}),f()},onCancel:f}),e?.type==="wms"&&J.jsx(MR,{onSubmit:m=>{t?.onComplete?.({...e,config:m}),f()},onCancel:f}),e?.type==="vt"&&n!==void 0&&J.jsx(LR,{config:e,originType:n,onSubmit:m=>{e&&(t?.onComplete?.({...e,config:m}),f())},onCancel:f}),J.jsx(d,{},"protocol")]})};WE.defaultProps={};try{WE.displayName="AddLayerPopup",WE.__docgenInfo={description:"",displayName:"AddLayerPopup",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"LayerConfig | undefined"}},layerTypes:{defaultValue:null,description:"",name:"layerTypes",required:!0,type:{name:"string[]"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!0,type:{name:"(open: boolean) => void"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}}}}}catch{}const NR=t=>{const[e,r]=gt.useState(!1),n=t.layerTypes||["geojson","wms","csv","topojson","osm","gpx","kml","tcx"];return J.jsxs(J.Fragment,{children:[J.jsx(ta,{variant:"contained",sx:{marginTop:"10px",...t.sx},onClick:()=>r(!0),children:J.jsx(I6e,{})}),J.jsx(WE,{open:e,setOpen:r,onComplete:t?.onComplete,layerTypes:n})]})};NR.defaultProps={};try{NR.displayName="AddLayerButton",NR.__docgenInfo={description:"",displayName:"AddLayerButton",props:{sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps | undefined"}},layerTypes:{defaultValue:null,description:`An string array, to filter the supported file types that would be shown to the user
Default is: ['geojson', 'wms', 'csv', 'topojson', 'osm', 'gpx', 'kml', 'tcx']`,name:"layerTypes",required:!1,type:{name:"string[] | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: LayerConfig) => void) | undefined"}}}}}catch{}const B6e=Ji(J.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"})),TN="https://mapcomponents.github.io/react-map-components-maplibre/react-maplibre/",z6e=TN+"assets/WG-MapComponents-Logo_rgb.svg",j6e=TN+"assets/WG-MapComponents-Logo_rgb-weisse-schrift.svg",U6e=TN+"assets/mapcomponents_logo.png";function cH(t){const e=Nc(),[r,n]=te.useState(null),i=s=>{n(s.currentTarget)},a=()=>{n(null)};return J.jsx(Gfe,{sx:{minHeight:"62px",position:"absolute",zIndex:1300,top:0},children:J.jsxs(Gye,{disableGutters:!0,children:[t.logo||J.jsxs(J.Fragment,{children:[J.jsx(Jo,{sx:{marginLeft:"25px",display:{xs:"none",md:"flex"},flexGrow:{md:"30"}},children:J.jsx("img",{src:e.palette.mode==="dark"?j6e:z6e,style:{width:"100%",maxWidth:"250px"}})}),J.jsx(Jo,{sx:{marginLeft:"25px",display:{xs:"flex",sm:"flex",md:"none"},flexGrow:{xs:"500"},mr:{sm:"0px"}},children:J.jsx("img",{src:U6e,width:"50px",height:"50px"})})]}),J.jsx(Jo,{sx:{flexGrow:1,display:{xs:"flex"}},children:t.unmovableButtons}),t.buttons?J.jsxs(Jo,{sx:{flexGrow:22,display:{xs:"flex",sm:"none"}},children:[J.jsx(uf,{onClick:i,children:J.jsx(B6e,{})}),J.jsx(mY,{id:"menu-appbar",anchorEl:r,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:!!r,onClose:a,PaperProps:{elevation:24,sx:{overflow:"visible",mt:"15px"}},sx:{display:{xs:"block",sm:"none"}},children:J.jsx(Jo,{sx:{paddingLeft:"10px",paddingRight:"10px"},onClick:a,children:t.buttons})})]}):"",J.jsx(Jo,{sx:{marginRight:"25px",display:{xs:"none",sm:"flex"}},children:t.buttons})]})})}try{cH.displayName="TopToolbar",cH.__docgenInfo={description:"",displayName:"TopToolbar",props:{unmovableButtons:{defaultValue:null,description:"",name:"unmovableButtons",required:!1,type:{name:"ReactNode"}},buttons:{defaultValue:null,description:"",name:"buttons",required:!1,type:{name:"ReactNode"}},logo:{defaultValue:null,description:"",name:"logo",required:!1,type:{name:"ReactNode"}}}}}catch{}const V6e=Ji(J.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2zm-1 7h5.5L14 6.5z"}));function fH(t){const e=te.useRef(null),r=()=>{if(!e.current)return!1;const i=e.current?.files?.[0];if(!i)return!1;const a=new FileReader;a.onload=s=>{s&&typeof t.setData=="function"&&t.setData(s.currentTarget?.result)},a.readAsText(i)},n=()=>{e.current&&e.current.click()};return J.jsxs(J.Fragment,{children:[t.buttonComponent?gt.cloneElement(t.buttonComponent,{onClick:n}):J.jsx(ta,{onClick:n,children:J.jsx(V6e,{})}),J.jsx("input",{ref:e,onChange:r,type:"file",accept:t.accept,id:"input",multiple:!0,style:{display:"none"}})]})}try{fH.displayName="UploadButton",fH.__docgenInfo={description:"",displayName:"UploadButton",props:{setData:{defaultValue:null,description:"",name:"setData",required:!0,type:{name:"(data: string) => void"}},buttonComponent:{defaultValue:null,description:"",name:"buttonComponent",required:!0,type:{name:"any"}},accept:{defaultValue:null,description:"",name:"accept",required:!1,type:{name:"string | undefined"}}}}}catch{}const XE=t=>{const e=()=>{t.setOpen(!1)};return J.jsxs(sO,{open:t.open,onClose:e,PaperProps:{sx:{padding:"20px"}},children:[J.jsx(yy,{children:"Select a style"}),J.jsx(kh,{children:t?.styles?.map(r=>J.jsx(qf,{disableGutters:!0,children:J.jsxs(fY,{autoFocus:!0,onClick:()=>{t?.onSelect?.(r)},children:[J.jsx(dY,{children:J.jsx(QX,{sx:{width:"50px",height:"50px"},alt:r.name,src:r?.name&&t?.styleThumbnailPaths?.[r.name]})}),J.jsx(Df,{primary:r.name})]})},r.name))})]})};XE.defaultProps={styleThumbnailPaths:{}};try{XE.displayName="SelectStylePopup",XE.__docgenInfo={description:"",displayName:"SelectStylePopup",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},setOpen:{defaultValue:null,description:"",name:"setOpen",required:!0,type:{name:"(open: boolean) => void"}},styles:{defaultValue:null,description:"",name:"styles",required:!1,type:{name:"StyleSpecification[] | undefined"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!1,type:{name:"((style: StyleSpecification) => void) | undefined"}},styleThumbnailPaths:{defaultValue:{value:"{}"},description:"",name:"styleThumbnailPaths",required:!1,type:{name:"{ [key: string]: string; } | undefined"}}}}}catch{}const $6e=Ji(J.jsx("path",{d:"M4 4h7V2H4c-1.1 0-2 .9-2 2v7h2zm6 9-4 5h12l-3-4-2.03 2.71zm7-4.5c0-.83-.67-1.5-1.5-1.5S14 7.67 14 8.5s.67 1.5 1.5 1.5S17 9.33 17 8.5M20 2h-7v2h7v7h2V4c0-1.1-.9-2-2-2m0 18h-7v2h7c1.1 0 2-.9 2-2v-7h-2zM4 13H2v7c0 1.1.9 2 2 2h7v-2H4z"})),q6e={version:8,name:"Monokai",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:tc.source_openmaptiles_url}},sprite:tc.sprite,glyphs:tc.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#AE81FF","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#75715E"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#837f6e"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#918d7e"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#A6C22E","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(166,194,46,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#e0ebad"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#FD971F"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(253,151,31,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(18,5,68,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#A6E22E","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#A6C22E","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#A6C22E","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#66D9EF","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#21c8e8"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#AE81FF","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#E6DB74","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#eee69f","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#fa5892","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#fa5892","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#fa5892","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#fb70a2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(249,38,114,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#b40544","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#b40544","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(249,38,114,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#fb70a2","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#fb70a2","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#e60657","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(249,38,114,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#F8F8F2","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fc89b2","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(18,5,68,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(18,5,68,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#b40544","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#fa5892","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#F8F8F2","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#F92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#f92672","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#b40544","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#b40544","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#E69F66","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#E69F66","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#66D9EF","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},H6e={version:8,name:"Solarized",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:tc.source_openmaptiles_url}},sprite:tc.sprite,glyphs:tc.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#073642"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#2aa198","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#657b83"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#74888f"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#84959c"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#859900","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(133,153,0,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#f2ff99"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#d30102"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(211,1,2,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(58,63,144,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#2aa198","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#859900","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#859900","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#268bd2","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#268bd2","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#1a6091"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#2aa198","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#eee8d5","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#fdfcf9","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#9094d3","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#9094d3","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#9094d3","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#a3a6da","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(108,113,196,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#3a3f90","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#3a3f90","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(108,113,196,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#a3a6da","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#a3a6da","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#484fb5","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(108,113,196,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#cb4b16","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e58ab6","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(58,63,144,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(58,63,144,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#3a3f90","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d33682","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#9094d3","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#cb4b16","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#6c71c4","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#3a3f90","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#268bd2","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#268bd2","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#268bd2","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},G6e={version:8,name:"Oceanic Next",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:tc.source_openmaptiles_url}},sprite:tc.sprite,glyphs:tc.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#81a1c1","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#a3be8c"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#acc598"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#b5cba3"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#a3be8c","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(163,19,14,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#cbdabe"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#b48ead"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(18,142,173,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(118,51,8,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#81a1c1","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#a3be8c","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#a3be8c","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#8fbcbb","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#5f9f9e"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#81a1c1","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#65737e","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#7e8d98","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#f17626","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#f2853e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(235,219,178,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(214,93,14,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#a6480b","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(214,93,14,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#b48ead","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f49456","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(118,51,8,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(118,51,8,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#b48ead","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#8fbcbb","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8fbcbb","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},W6e={version:8,name:"Medieval Kingdom",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:tc.source_openmaptiles_url}},sprite:tc.sprite,glyphs:tc.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#ffd1a8"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#228B22","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#bfa677"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#c5af85"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#ccb892"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#556B2F","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(85,107,47,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#d1e0b8"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#FFC0CB"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(255,192,203,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(149,46,46,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#228B22","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#556B2F","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#556B2F","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#1E90FF","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#006ad1"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#228B22","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#f9e9cb","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#fefcf9","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#d98383","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d98383","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#d98383","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#df9797","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(139,94,6,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#952e2e","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#952e2e","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(205,92,92,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#df9797","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#df9797","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#bc3a3a","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(205,92,92,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#FFC0CB","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#e5aaaa","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(149,46,46,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(149,46,46,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#952e2e","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#CD5C5C","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#d98383","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#FFC0CB","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#8B5E3C","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#8b5e3c","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#952e2e","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#A0522D","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#A0522D","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#1E90FF","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},X6e={version:8,name:"Gruvbox",center:[8.542,47.372],zoom:11.6,bearing:0,pitch:0,sources:{openmaptiles:{type:"vector",url:tc.source_openmaptiles_url}},sprite:tc.sprite,glyphs:tc.glyphs,layers:[{id:"background",type:"background",paint:{"background-color":"#282822"}},{id:"landcover-glacier",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","glacier"],layout:{visibility:"visible"},paint:{"fill-color":"#83a598","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"landuse-residential",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","residential"],paint:{"fill-color":"#b8bb26"}},{id:"landuse-commercial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","commercial"]],paint:{"fill-color":"#bfc23c"}},{id:"landuse-industrial",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["all",["==","$type","Polygon"],["==","class","industrial"]],paint:{"fill-color":"#c6c951"}},{id:"park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],paint:{"fill-color":"#b8bb26","fill-opacity":{base:1.8,stops:[[9,.5],[12,.2]]}}},{id:"park-outline",type:"line",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","$type","Polygon"],layout:{},paint:{"line-color":"rgba(184,187,38,0.6)","line-dasharray":[3,3]}},{id:"landuse-cemetery",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","cemetery"],paint:{"fill-color":"#eceeaa"}},{id:"landuse-hospital",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","hospital"],paint:{"fill-color":"#fe8019"}},{id:"landuse-school",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","school"],paint:{"fill-color":"rgba(254,128,25,0.8)"}},{id:"landuse-railway",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landuse",filter:["==","class","railway"],paint:{"fill-color":"rgba(118,51,8,0.4)"}},{id:"landcover-wood",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","wood"],paint:{"fill-color":"#83a598","fill-opacity":.1,"fill-outline-color":"hsla(0, 0%, 0%, 0.03)","fill-antialias":{base:1,stops:[[0,!1],[9,!0]]}}},{id:"landcover-grass",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"landcover",filter:["==","class","grass"],paint:{"fill-color":"#b8bb26","fill-opacity":1}},{id:"landcover-grass-park",type:"fill",metadata:{"mapbox:group":"1444849388993.3071"},source:"openmaptiles","source-layer":"park",filter:["==","class","public_park"],paint:{"fill-color":"#b8bb26","fill-opacity":.8}},{id:"waterway-other",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["!in","class","canal","river","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.3,stops:[[13,.5],[20,2]]}}},{id:"waterway-stream-canal",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["in","class","canal","stream"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.3,stops:[[13,.5],[20,6]]}}},{id:"waterway-river",type:"line",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"waterway",filter:["==","class","river"],layout:{"line-cap":"round"},paint:{"line-color":"#83a598","line-width":{base:1.2,stops:[[10,.8],[20,6]]}}},{id:"water-offset",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",maxzoom:8,filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-opacity":1,"fill-color":"#83a598","fill-translate":{base:1,stops:[[6,[2,0]],[8,[0,0]]]}}},{id:"water",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-color":"#5c7f72"}},{id:"water-pattern",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"water",layout:{visibility:"visible"},paint:{"fill-translate":[0,2.5],"fill-pattern":"wave"}},{id:"landcover-ice-shelf",type:"fill",metadata:{"mapbox:group":"1444849382550.77"},source:"openmaptiles","source-layer":"landcover",filter:["==","subclass","ice_shelf"],layout:{visibility:"visible"},paint:{"fill-color":"#83a598","fill-opacity":{base:1,stops:[[0,.9],[10,.3]]}}},{id:"building",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",paint:{"fill-color":"#928374","fill-antialias":!0}},{id:"building-top",type:"fill",metadata:{"mapbox:group":"1444849364238.8171"},source:"openmaptiles","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdbd7","fill-color":"#a89c91","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"tunnel-service-track-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[15,1],[16,4],[20,11]]}}},{id:"tunnel-minor-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"tunnel-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"tunnel-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-dasharray":[.5,.25],"line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","tunnel"],["==","class","path"]]],paint:{"line-color":"#f17626","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"tunnel-service-track",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","service","track"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15.5,0],[16,2],[20,7.5]]}}},{id:"tunnel-minor",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","minor_road"]],layout:{"line-join":"round"},paint:{"line-color":"#f17626","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#f2853e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,10]]}}},{id:"tunnel-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","motorway"]],layout:{"line-join":"round",visibility:"visible"},paint:{"line-color":"rgba(235,219,178,0.8)","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"tunnel-railway",type:"line",metadata:{"mapbox:group":"1444849354174.1904"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","tunnel"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]},"line-dasharray":[2,2]}},{id:"aeroway-taxiway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","taxiway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,2],[17,12]]},"line-opacity":1}},{id:"aeroway-runway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:12,filter:["all",["in","class","runway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#763308","line-width":{base:1.5,stops:[[11,5],[17,55]]},"line-opacity":1}},{id:"aeroway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["==","$type","Polygon"],["in","class","runway","taxiway"]],layout:{visibility:"visible"},paint:{"fill-opacity":{base:1,stops:[[13,0],[14,1]]},"fill-color":"rgba(214,93,14,0.5)"}},{id:"aeroway-taxiway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","taxiway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,1],[17,10]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"aeroway-runway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"aeroway",minzoom:4,filter:["all",["in","class","runway"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#f2853e","line-width":{base:1.5,stops:[[11,4],[17,50]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"highway-area",type:"fill",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["==","$type","Polygon"],layout:{visibility:"visible"},paint:{"fill-color":"#a6480b","fill-outline-color":"#cfcdca","fill-opacity":.9,"fill-antialias":!1}},{id:"highway-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-link-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"highway-minor-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"rgba(214,93,14,0.8)","line-opacity":{stops:[[12,0],[12.5,1]]},"line-width":{base:1.2,stops:[[12,.5],[13,1],[14,4],[20,15]]}}},{id:"highway-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,17]]}}},{id:"highway-primary-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[7,0],[8,1]]},"line-width":{base:1.2,stops:[[7,0],[8,.6],[9,1.5],[20,22]]}}},{id:"highway-trunk-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-opacity":{stops:[[5,0],[6,1]]},"line-width":{base:1.2,stops:[[5,0],[6,.6],[7,1.5],[20,22]]}}},{id:"highway-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:4,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[4,0],[5,.4],[6,.6],[7,1.5],[20,22]]},"line-opacity":{stops:[[4,0],[5,1]]}}},{id:"highway-path",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","path"]]],paint:{"line-color":"#fe8019","line-dasharray":[1.5,.75],"line-width":{base:1.2,stops:[[15,1.2],[20,4]]}}},{id:"highway-motorway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:12,filter:["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway_link"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-link",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:13,filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"highway-minor",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!=","brunnel","tunnel"],["in","class","minor","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f49456","line-opacity":1,"line-width":{base:1.2,stops:[[13.5,0],[14,2.5],[20,11.5]]}}},{id:"highway-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["!in","brunnel","bridge","tunnel"],["in","class","secondary","tertiary"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[8,.5],[20,13]]}}},{id:"highway-primary",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","primary"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[8.5,0],[9,.5],[20,18]]}}},{id:"highway-trunk",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["in","class","trunk"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"highway-motorway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",minzoom:5,filter:["all",["==","$type","LineString"],["all",["!in","brunnel","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"railway-service",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],paint:{"line-color":"rgba(118,51,8,0.7)","line-width":{base:1.4,stops:[[14,.4],[20,1]]}}},{id:"railway-service-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","class","rail"],["has","service"]]],layout:{visibility:"visible"},paint:{"line-color":"rgba(118,51,8,0.7)","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,2],[20,6]]}}},{id:"railway",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"railway-hatching",type:"line",metadata:{"mapbox:group":"1444849345966.4436"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["!has","service"],["!in","brunnel","bridge","tunnel"],["==","class","rail"]]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"bridge-motorway-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-link-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[12,1],[13,3],[14,4],[20,15]]}}},{id:"bridge-secondary-tertiary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-opacity":1,"line-width":{base:1.2,stops:[[8,1.5],[20,28]]}}},{id:"bridge-trunk-primary-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,26]]}}},{id:"bridge-motorway-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#d65d0e","line-width":{base:1.2,stops:[[5,.4],[6,.6],[7,1.5],[20,22]]}}},{id:"bridge-path-casing",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#f17626","line-width":{base:1.2,stops:[[15,1.2],[20,18]]}}},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","$type","LineString"],["all",["==","brunnel","bridge"],["==","class","path"]]],paint:{"line-color":"#fe8019","line-width":{base:1.2,stops:[[15,1.2],[20,4]]},"line-dasharray":[1.5,.75]}},{id:"bridge-motorway-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-link",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary_link","secondary_link","tertiary_link","trunk_link"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[12.5,0],[13,1.5],[14,2.5],[20,11.5]]}}},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","secondary","tertiary"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,20]]}}},{id:"bridge-trunk-primary",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["in","class","primary","trunk"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","motorway"]],layout:{"line-join":"round"},paint:{"line-color":"#ebdbb2","line-width":{base:1.2,stops:[[6.5,0],[7,.5],[20,18]]}}},{id:"bridge-railway",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-width":{base:1.4,stops:[[14,.4],[15,.75],[20,2]]}}},{id:"bridge-railway-hatching",type:"line",metadata:{"mapbox:group":"1444849334699.1902"},source:"openmaptiles","source-layer":"transportation",filter:["all",["==","brunnel","bridge"],["==","class","rail"]],paint:{"line-color":"#763308","line-dasharray":[.2,8],"line-width":{base:1.4,stops:[[14.5,0],[15,3],[20,8]]}}},{id:"boundary-land-level-4",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",4,6,8],["!=","maritime",1]],layout:{"line-join":"round"},paint:{"line-color":"#fb4934","line-dasharray":[3,1,1,1],"line-width":{base:1.4,stops:[[4,.4],[5,1],[12,3]]}}},{id:"boundary-land-level-2",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["==","admin_level",2],["!=","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fb4934","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]}}},{id:"boundary-water",type:"line",source:"openmaptiles","source-layer":"boundary",filter:["all",["in","admin_level",2,4],["==","maritime",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#83a598","line-width":{base:1,stops:[[0,.6],[4,1.4],[5,2],[12,8]]},"line-opacity":{stops:[[6,.6],[10,1]]}}},{id:"waterway-name",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"waterway-name-en",type:"symbol",source:"openmaptiles","source-layer":"waterway",minzoom:13,filter:["all",["==","$type","LineString"],["has","name"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","text-letter-spacing":.2,"symbol-spacing":350},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:latin} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-lakeline-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","LineString"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":"{name:de} {name:nonlatin}","text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"line","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-ocean-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["==","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":14,"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["!has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"water-name-other-en",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["all",["==","$type","Point"],["!in","class","ocean"],["has","name:de"]],layout:{"text-font":["Open Sans Italic"],"text-size":{stops:[[0,10],[6,14]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":5,"text-rotation-alignment":"map","symbol-placement":"point","symbol-spacing":350,"text-letter-spacing":.2,visibility:"visible"},paint:{"text-color":"#fefefe","text-halo-width":1.5,"text-halo-color":"#74aee9"}},{id:"poi-level-3",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-3-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",25],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-2-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],["all",["<=","rank",24],[">=","rank",15]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["!has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:latin}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"poi-level-1-en",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],["all",["<=","rank",14],["has","name"]],["has","name:de"]],layout:{"text-padding":2,"text-font":["Open Sans Semibold"],"text-anchor":"top","icon-image":"{class}_11","text-field":`{name:de}
{name:nonlatin}`,"text-offset":[0,.6],"text-size":12,"text-max-width":9},paint:{"text-halo-blur":.5,"text-color":"#fdfdfd","text-halo-width":1,"text-halo-color":"#633"}},{id:"highway-name-path",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-path-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15.5,filter:["all",["==","class","path"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-color":"#f8f4f0","text-color":"hsl(30, 23%, 62%)","text-halo-width":.5}},{id:"highway-name-minor",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-minor-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:15,filter:["all",["==","$type","LineString"],["in","class","minor","service","track"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["!has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:latin} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-name-major-en",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:12.2,filter:["all",["in","class","primary","secondary","tertiary","trunk"],["has","name:de"]],layout:{"text-size":{base:1,stops:[[13,12],[14,13]]},"text-font":["Open Sans Regular"],"text-field":"{name:de} {name:nonlatin}","symbol-placement":"line","text-rotation-alignment":"map"},paint:{"text-halo-blur":.5,"text-color":"#765","text-halo-width":1}},{id:"highway-shield",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:8,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["!in","network","us-interstate","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"road_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{}},{id:"highway-shield-us-interstate",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:7,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-interstate"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[7,"point"],[7,"line"],[8,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"highway-shield-us-other",type:"symbol",source:"openmaptiles","source-layer":"transportation_name",minzoom:9,filter:["all",["<=","ref_length",6],["==","$type","LineString"],["in","network","us-highway","us-state"]],layout:{"text-size":10,"icon-image":"{network}_{ref_length}","icon-rotation-alignment":"viewport","symbol-spacing":200,"text-font":["Open Sans Semibold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-rotation-alignment":"viewport","icon-size":1,"text-field":"{ref}"},paint:{"text-color":"rgba(0, 0, 0, 1)"}},{id:"place-other",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["!has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-other-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!in","class","city","town","village"],["has","name:de"]],layout:{"text-letter-spacing":.1,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-village-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,12],[15,22]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["!has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-town-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"],["has","name:de"]],layout:{"text-font":["Open Sans Regular"],"text-size":{base:1.2,stops:[[10,14],[15,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["!=","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["!has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:latin}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-city-capital-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","capital",2],["==","class","city"],["has","name:de"]],layout:{"text-font":["Open Sans Semibold"],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"text-field":`{name:de}
{name:nonlatin}`,"text-max-width":8,"icon-image":"star_11","text-offset":[.4,0],"icon-size":.8,"text-anchor":"left"},paint:{"text-color":"#fdfdfd","text-halo-width":1.2,"text-halo-color":"#433"}},{id:"place-country-3",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-3-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],[">=","rank",3],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-2-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",2],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-country-1-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",filter:["all",["==","class","country"],["==","rank",1],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"uppercase","text-max-width":6.25},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["!has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:latin}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}},{id:"place-continent-en",type:"symbol",metadata:{"mapbox:group":"1444849242106.713"},source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"],["has","name:de"]],layout:{"text-font":["Open Sans Bold"],"text-field":`{name:de}
{name:nonlatin}`,"text-size":14,"text-max-width":6.25,"text-transform":"uppercase"},paint:{"text-halo-blur":1,"text-color":"#fdfdfd","text-halo-width":2,"text-halo-color":"#433"}}]},w1="https://mapcomponents.github.io/react-map-components-maplibre/assets/style_thumbnails/",hH=({sx:t,styles:e=[],defaultStyles:r=!0,styleThumbnailPaths:n})=>{const i=gt.useContext(GD),[a,s]=gt.useState(!1);return J.jsxs(J.Fragment,{children:[J.jsx(ta,{variant:"contained",sx:{marginTop:"10px",...t},onClick:()=>s(!0),children:J.jsx($6e,{})}),J.jsx(XE,{styles:[...r?[q6e,H6e,G6e,W6e,X6e]:[],...e||[]],styleThumbnailPaths:{...n,...r?{Monokai:w1+"monokai.png",Gruvbox:w1+"gruvbox.png","Oceanic Next":w1+"oceanic_next.png",Solarized:w1+"solarized.png","Medieval Kingdom":w1+"medieval_kingdom.png"}:{}},open:a,setOpen:s,onSelect:o=>{i.setBackgroundLayers([]),setTimeout(()=>{i.updateStyle(o)},100),s(!1)}})]})};try{hH.displayName="SelectStyleButton",hH.__docgenInfo={description:"",displayName:"SelectStyleButton",props:{sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps | undefined"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!1,type:{name:"((config: StyleSpecification[]) => void) | undefined"}},styles:{defaultValue:{value:"[]"},description:"",name:"styles",required:!1,type:{name:"StyleSpecification[] | undefined"}},defaultStyles:{defaultValue:{value:"true"},description:"",name:"defaultStyles",required:!1,type:{name:"boolean | undefined"}},styleThumbnailPaths:{defaultValue:null,description:"",name:"styleThumbnailPaths",required:!1,type:{name:"{ [key: string]: string; } | undefined"}}}}}catch{}var AP={exports:{}},IP={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dH;function Y6e(){if(dH)return IP;dH=1;var t=vx();function e(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var r=typeof Object.is=="function"?Object.is:e,n=t.useSyncExternalStore,i=t.useRef,a=t.useEffect,s=t.useMemo,o=t.useDebugValue;return IP.useSyncExternalStoreWithSelector=function(c,f,d,m,b){var x=i(null);if(x.current===null){var E={hasValue:!1,value:null};x.current=E}else E=x.current;x=s(function(){function A(U){if(!R){if(R=!0,F=U,U=m(U),b!==void 0&&E.hasValue){var j=E.value;if(b(j,U))return N=j}return N=U}if(j=N,r(F,U))return j;var H=m(U);return b!==void 0&&b(j,H)?(F=U,j):(F=U,N=H)}var R=!1,F,N,O=d===void 0?null:d;return[function(){return A(f())},O===null?void 0:function(){return A(O())}]},[f,d,m,b]);var T=n(c,x[0],x[1]);return a(function(){E.hasValue=!0,E.value=T},[T]),o(T),T},IP}var pH;function Z6e(){return pH||(pH=1,AP.exports=Y6e()),AP.exports}var K6e=Z6e(),J6e=Symbol.for("react-redux-context"),Q6e=typeof globalThis<"u"?globalThis:{};function eFe(){if(!te.createContext)return{};const t=Q6e[J6e]??=new Map;let e=t.get(te.createContext);return e||(e=te.createContext(null),t.set(te.createContext,e)),e}var sy=eFe();function CN(t=sy){return function(){return te.useContext(t)}}var ite=CN();function ate(t=sy){const e=t===sy?ite:CN(t),r=()=>{const{store:n}=e();return n};return Object.assign(r,{withTypes:()=>r}),r}var tFe=ate();function rFe(t=sy){const e=t===sy?tFe:ate(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var ote=rFe(),nFe=(t,e)=>t===e;function iFe(t=sy){const e=t===sy?ite:CN(t),r=(n,i={})=>{const{equalityFn:a=nFe}=typeof i=="function"?{equalityFn:i}:i,s=e(),{store:o,subscription:c,getServerState:f}=s;te.useRef(!0);const d=te.useCallback({[n.name](b){return n(b)}}[n.name],[n]),m=K6e.useSyncExternalStoreWithSelector(c.addNestedSub,o.getState,f||o.getState,d,a);return te.useDebugValue(m),m};return Object.assign(r,{withTypes:()=>r}),r}var Vm=iFe();function xu(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var aFe=typeof Symbol=="function"&&Symbol.observable||"@@observable",gH=aFe,PP=()=>Math.random().toString(36).substring(7).split("").join("."),oFe={INIT:`@@redux/INIT${PP()}`,REPLACE:`@@redux/REPLACE${PP()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${PP()}`},YE=oFe;function AN(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function ste(t,e,r){if(typeof t!="function")throw new Error(xu(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(xu(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(xu(1));return r(ste)(t,e)}let n=t,i=e,a=new Map,s=a,o=0,c=!1;function f(){s===a&&(s=new Map,a.forEach((A,R)=>{s.set(R,A)}))}function d(){if(c)throw new Error(xu(3));return i}function m(A){if(typeof A!="function")throw new Error(xu(4));if(c)throw new Error(xu(5));let R=!0;f();const F=o++;return s.set(F,A),function(){if(R){if(c)throw new Error(xu(6));R=!1,f(),s.delete(F),a=null}}}function b(A){if(!AN(A))throw new Error(xu(7));if(typeof A.type>"u")throw new Error(xu(8));if(typeof A.type!="string")throw new Error(xu(17));if(c)throw new Error(xu(9));try{c=!0,i=n(i,A)}finally{c=!1}return(a=s).forEach(F=>{F()}),A}function x(A){if(typeof A!="function")throw new Error(xu(10));n=A,b({type:YE.REPLACE})}function E(){const A=m;return{subscribe(R){if(typeof R!="object"||R===null)throw new Error(xu(11));function F(){const O=R;O.next&&O.next(d())}return F(),{unsubscribe:A(F)}},[gH](){return this}}}return b({type:YE.INIT}),{dispatch:b,subscribe:m,getState:d,replaceReducer:x,[gH]:E}}function sFe(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:YE.INIT})>"u")throw new Error(xu(12));if(typeof r(void 0,{type:YE.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(xu(13))})}function lFe(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const s=e[a];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let i;try{sFe(r)}catch(a){i=a}return function(s={},o){if(i)throw i;let c=!1;const f={};for(let d=0;d<n.length;d++){const m=n[d],b=r[m],x=s[m],E=b(x,o);if(typeof E>"u")throw o&&o.type,new Error(xu(14));f[m]=E,c=c||E!==x}return c=c||n.length!==Object.keys(s).length,c?f:s}}function ZE(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function uFe(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error(xu(15))};const s={getState:i.getState,dispatch:(c,...f)=>a(c,...f)},o=t.map(c=>c(s));return a=ZE(...o)(i.dispatch),{...i,dispatch:a}}}function cFe(t){return AN(t)&&"type"in t&&typeof t.type=="string"}var lte=Symbol.for("immer-nothing"),mH=Symbol.for("immer-draftable"),mf=Symbol.for("immer-state");function _h(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Q0=Object.getPrototypeOf;function ly(t){return!!t&&!!t[mf]}function Tp(t){return t?ute(t)||Array.isArray(t)||!!t[mH]||!!t.constructor?.[mH]||Qx(t)||$3(t):!1}var fFe=Object.prototype.constructor.toString();function ute(t){if(!t||typeof t!="object")return!1;const e=Q0(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===fFe}function KE(t,e){V3(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function V3(t){const e=t[mf];return e?e.type_:Array.isArray(t)?1:Qx(t)?2:$3(t)?3:0}function FR(t,e){return V3(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function cte(t,e,r){const n=V3(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function hFe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Qx(t){return t instanceof Map}function $3(t){return t instanceof Set}function bm(t){return t.copy_||t.base_}function BR(t,e){if(Qx(t))return new Map(t);if($3(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=ute(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[mf];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(Q0(t),n)}else{const n=Q0(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function IN(t,e=!1){return q3(t)||ly(t)||!Tp(t)||(V3(t)>1&&Object.defineProperties(t,{set:{value:Lw},add:{value:Lw},clear:{value:Lw},delete:{value:Lw}}),Object.freeze(t),e&&Object.values(t).forEach(r=>IN(r,!0))),t}function Lw(){_h(2)}function q3(t){return Object.isFrozen(t)}var dFe={};function uy(t){const e=dFe[t];return e||_h(0,t),e}var sx;function fte(){return sx}function pFe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function yH(t,e){e&&(uy("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function zR(t){jR(t),t.drafts_.forEach(gFe),t.drafts_=null}function jR(t){t===sx&&(sx=t.parent_)}function vH(t){return sx=pFe(sx,t)}function gFe(t){const e=t[mf];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function _H(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[mf].modified_&&(zR(e),_h(4)),Tp(t)&&(t=JE(e,t),e.parent_||QE(e,t)),e.patches_&&uy("Patches").generateReplacementPatches_(r[mf].base_,t,e.patches_,e.inversePatches_)):t=JE(e,r,[]),zR(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==lte?t:void 0}function JE(t,e,r){if(q3(e))return e;const n=e[mf];if(!n)return KE(e,(i,a)=>bH(t,n,e,i,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return QE(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),KE(a,(o,c)=>bH(t,n,i,o,c,r,s)),QE(t,i,!1),r&&t.patches_&&uy("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function bH(t,e,r,n,i,a,s){if(ly(i)){const o=a&&e&&e.type_!==3&&!FR(e.assigned_,n)?a.concat(n):void 0,c=JE(t,i,o);if(cte(r,n,c),ly(c))t.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Tp(i)&&!q3(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;JE(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(Qx(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&QE(t,i)}}function QE(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&IN(e,r)}function mFe(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:fte(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=PN;r&&(i=[n],a=lx);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var PN={get(t,e){if(e===mf)return t;const r=bm(t);if(!FR(r,e))return yFe(t,r,e);const n=r[e];return t.finalized_||!Tp(n)?n:n===MP(t.base_,e)?(kP(t),t.copy_[e]=VR(n,t)):n},has(t,e){return e in bm(t)},ownKeys(t){return Reflect.ownKeys(bm(t))},set(t,e,r){const n=hte(bm(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=MP(bm(t),e),a=i?.[mf];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(hFe(r,i)&&(r!==void 0||FR(t.base_,e)))return!0;kP(t),UR(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return MP(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,kP(t),UR(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=bm(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){_h(11)},getPrototypeOf(t){return Q0(t.base_)},setPrototypeOf(){_h(12)}},lx={};KE(PN,(t,e)=>{lx[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});lx.deleteProperty=function(t,e){return lx.set.call(this,t,e,void 0)};lx.set=function(t,e,r){return PN.set.call(this,t[0],e,r,t[0])};function MP(t,e){const r=t[mf];return(r?bm(r):t)[e]}function yFe(t,e,r){const n=hte(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function hte(t,e){if(!(e in t))return;let r=Q0(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Q0(r)}}function UR(t){t.modified_||(t.modified_=!0,t.parent_&&UR(t.parent_))}function kP(t){t.copy_||(t.copy_=BR(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var vFe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const s=this;return function(c=a,...f){return s.produce(c,d=>r.call(this,d,...f))}}typeof r!="function"&&_h(6),n!==void 0&&typeof n!="function"&&_h(7);let i;if(Tp(e)){const a=vH(this),s=VR(e,void 0);let o=!0;try{i=r(s),o=!1}finally{o?zR(a):jR(a)}return yH(a,n),_H(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===lte&&(i=void 0),this.autoFreeze_&&IN(i,!0),n){const a=[],s=[];uy("Patches").generateReplacementPatches_(e,i,a,s),n(a,s)}return i}else _h(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,c=>e(c,...o));let n,i;return[this.produce(e,r,(s,o)=>{n=s,i=o}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Tp(t)||_h(8),ly(t)&&(t=_Fe(t));const e=vH(this),r=VR(t,void 0);return r[mf].isManual_=!0,jR(e),r}finishDraft(t,e){const r=t&&t[mf];(!r||!r.isManual_)&&_h(9);const{scope_:n}=r;return yH(n,e),_H(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=uy("Patches").applyPatches_;return ly(t)?n(t,e):this.produce(t,i=>n(i,e))}};function VR(t,e){const r=Qx(t)?uy("MapSet").proxyMap_(t,e):$3(t)?uy("MapSet").proxySet_(t,e):mFe(t,e);return(e?e.scope_:fte()).drafts_.push(r),r}function _Fe(t){return ly(t)||_h(10,t),dte(t)}function dte(t){if(!Tp(t)||q3(t))return t;const e=t[mf];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=BR(t,e.scope_.immer_.useStrictShallowCopy_)}else r=BR(t,!0);return KE(r,(n,i)=>{cte(r,n,dte(i))}),e&&(e.finalized_=!1),r}var bFe=new vFe,pte=bFe.produce;function gte(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var xFe=gte(),wFe=gte,SFe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ZE:ZE.apply(null,arguments)};function xH(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(gp(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>cFe(n)&&n.type===t,r}var mte=class Z1 extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Z1.prototype)}static get[Symbol.species](){return Z1}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Z1(...e[0].concat(this)):new Z1(...e.concat(this))}};function wH(t){return Tp(t)?pte(t,()=>{}):t}function Nw(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function EFe(t){return typeof t=="boolean"}var TFe=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let s=new mte;return r&&(EFe(r)?s.push(xFe):s.push(wFe(r.extraArgument))),s},CFe="RTK_autoBatch",SH=t=>e=>{setTimeout(e,t)},AFe=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,s=!1;const o=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:SH(10):t.type==="callback"?t.queueNotification:SH(t.timeout),f=()=>{s=!1,a&&(a=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const m=()=>i&&d(),b=n.subscribe(m);return o.add(d),()=>{b(),o.delete(d)}},dispatch(d){try{return i=!d?.meta?.[CFe],a=!i,a&&(s||(s=!0,c(f))),n.dispatch(d)}finally{i=!0}}})},IFe=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new mte(t);return n&&i.push(AFe(typeof n=="object"?n:void 0)),i};function PFe(t){const e=TFe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(AN(r))o=lFe(r);else throw new Error(gp(1));let c;typeof n=="function"?c=n(e):c=e();let f=ZE;i&&(f=SFe({trace:!1,...typeof i=="object"&&i}));const d=uFe(...c),m=IFe(d);let b=typeof s=="function"?s(m):m();const x=f(...b);return ste(o,a,x)}function yte(t){const e={},r=[];let n;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(gp(28));if(o in e)throw new Error(gp(29));return e[o]=s,i},addAsyncThunk(a,s){return s.pending&&(e[a.pending.type]=s.pending),s.rejected&&(e[a.rejected.type]=s.rejected),s.fulfilled&&(e[a.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:a.settled,reducer:s.settled}),i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function MFe(t){return typeof t=="function"}function kFe(t,e){let[r,n,i]=yte(e),a;if(MFe(t))a=()=>wH(t());else{const o=wH(t);a=()=>o}function s(o=a(),c){let f=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return f.filter(d=>!!d).length===0&&(f=[i]),f.reduce((d,m)=>{if(m)if(ly(d)){const x=m(d,c);return x===void 0?d:x}else{if(Tp(d))return pte(d,b=>m(b,c));{const b=m(d,c);if(b===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return b}}return d},o)}return s.getInitialState=a,s}var RFe=Symbol.for("rtk-slice-createasyncthunk");function DFe(t,e){return`${t}/${e}`}function OFe({creators:t}={}){const e=t?.asyncThunk?.[RFe];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(gp(11));const s=(typeof n.reducers=="function"?n.reducers(FFe()):n.reducers)||{},o=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},f={addCase(N,O){const U=typeof N=="string"?N:N.type;if(!U)throw new Error(gp(12));if(U in c.sliceCaseReducersByType)throw new Error(gp(13));return c.sliceCaseReducersByType[U]=O,f},addMatcher(N,O){return c.sliceMatchers.push({matcher:N,reducer:O}),f},exposeAction(N,O){return c.actionCreators[N]=O,f},exposeCaseReducer(N,O){return c.sliceCaseReducersByName[N]=O,f}};o.forEach(N=>{const O=s[N],U={reducerName:N,type:DFe(i,N),createNotation:typeof n.reducers=="function"};zFe(O)?UFe(U,O,f,e):BFe(U,O,f)});function d(){const[N={},O=[],U=void 0]=typeof n.extraReducers=="function"?yte(n.extraReducers):[n.extraReducers],j={...N,...c.sliceCaseReducersByType};return kFe(n.initialState,H=>{for(let W in j)H.addCase(W,j[W]);for(let W of c.sliceMatchers)H.addMatcher(W.matcher,W.reducer);for(let W of O)H.addMatcher(W.matcher,W.reducer);U&&H.addDefaultCase(U)})}const m=N=>N,b=new Map,x=new WeakMap;let E;function T(N,O){return E||(E=d()),E(N,O)}function A(){return E||(E=d()),E.getInitialState()}function R(N,O=!1){function U(H){let W=H[N];return typeof W>"u"&&O&&(W=Nw(x,U,A)),W}function j(H=m){const W=Nw(b,O,()=>new WeakMap);return Nw(W,H,()=>{const X={};for(const[oe,ee]of Object.entries(n.selectors??{}))X[oe]=LFe(ee,H,()=>Nw(x,H,A),O);return X})}return{reducerPath:N,getSelectors:j,get selectors(){return j(U)},selectSlice:U}}const F={name:i,reducer:T,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:A,...R(a),injectInto(N,{reducerPath:O,...U}={}){const j=O??a;return N.inject({reducerPath:j,reducer:T},U),{...F,...R(j,!0)}}};return F}}function LFe(t,e,r,n){function i(a,...s){let o=e(a);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return i.unwrapped=t,i}var NFe=OFe();function FFe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function BFe({type:t,reducerName:e,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!jFe(n))throw new Error(gp(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,s?xH(t,s):xH(t))}function zFe(t){return t._reducerDefinitionType==="asyncThunk"}function jFe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function UFe({type:t,reducerName:e},r,n,i){if(!i)throw new Error(gp(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:c,settled:f,options:d}=r,m=i(t,a,d);n.exposeAction(e,m),s&&n.addCase(m.fulfilled,s),o&&n.addCase(m.pending,o),c&&n.addCase(m.rejected,c),f&&n.addMatcher(m.settled,f),n.exposeCaseReducer(e,{fulfilled:s||Fw,pending:o||Fw,rejected:c||Fw,settled:f||Fw})}function Fw(){}function gp(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}function vte(t,e,r){e.forEach(n=>{t(n,r),n.layers&&n.layers.length>0&&vte(t,n.layers,n)})}const VFe={mapConfigs:{}},_te=NFe({name:"mapConfig",initialState:VFe,reducers:{setMapConfig:(t,e)=>{const r=e.payload.mapConfig,n=e.payload.key;t.mapConfigs[n]=r},removeMapConfig:(t,e)=>{delete t.mapConfigs[e.payload.key]},setLayerInMapConfig:(t,e)=>{const{mapConfigKey:r,layer:n}=e.payload,i=t.mapConfigs[r];if(i){for(let a=0;a<i.layers.length;a++)if(i.layers[a].uuid===n.uuid){i.layers[a]=n;break}}},removeLayerFromMapConfig:(t,e)=>{const{mapConfigKey:r,layerUuid:n}=e.payload,i=t.mapConfigs[r];if(i){const a=i.layers.findIndex(s=>s.uuid===n);a!==-1&&(delete i.layers[a],vte(function(s,o){o&&o.layers&&(o.layers=o.layers.filter(c=>c.uuid!==n))},i.layerOrder))}},updateLayerOrder:(t,e)=>{const{mapConfigKey:r,newOrder:n}=e.payload,i=t.mapConfigs[r];i&&(i.layerOrder=n)},setMasterVisible(t,e){const{mapConfigKey:r,layerId:n,masterVisible:i}=e.payload,a=t.mapConfigs[r];if(a){const s=a.layers.findIndex(o=>o.uuid===n);if(s!==-1){const o=a.layers[s];if(o){const c=[...a.layers];o.type==="folder"&&a.layerOrder.forEach(f=>{f.uuid===n&&f.layers?.forEach(d=>{const m=a.layers.findIndex(x=>x.uuid===d.uuid),b=c[m];c[m]={...b,masterVisible:i},b?.type==="vt"&&b?.config?.layers&&(b.config.layers=b.config.layers.map(x=>({...x,masterVisible:i})))})}),o.type==="vt"&&o?.config?.layers&&(o.config.layers=o.config.layers.map(f=>({...f,masterVisible:i}))),t.mapConfigs[r].layers=c}}}}}}),bte=(t,e)=>{const r=t.mapConfigs;for(const n in r){const i=r[n],a=i.layers.findIndex(o=>o.uuid===e),s=i.layers[a];if(s)return s}return null},$Fe=(t,e)=>{const r=t.mapConfig.mapConfigs[e];if(!r)return[];const n=r.layerOrder,i=[];function a(s){s.forEach(o=>{i.push(o.uuid),o.layers&&o.layers.length>0&&a(o.layers)})}return a(n),i};PFe({reducer:{mapConfig:_te.reducer}});const{setMapConfig:UXe,removeMapConfig:VXe,setLayerInMapConfig:xte,removeLayerFromMapConfig:$Xe,updateLayerOrder:qFe,setMasterVisible:HFe}=_te.actions,EH=Ji(J.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}));function $R(t){return J.jsx(Jb,{value:t.value,label:"Color",onChange:e=>{typeof t.onChange=="function"&&t.onChange(e)}})}try{$R.displayName="PaintPropsColorPicker",$R.__docgenInfo={description:"",displayName:"PaintPropsColorPicker",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}}}}}catch{}const GFe=Dr(Uf)({marginLeft:"-100px",marginRight:"-21px",paddingLeft:"53px",borderRadius:"0px",boxShadow:"none",backgroundColor:"rgb(0, 0, 0, 0)"}),WFe=Dr(Jo)({marginLeft:"61px"}),wte={"circle-color":"colorpicker","circle-radius":"slider","circle-stroke-color":"colorpicker","circle-stroke-width":"slider","fill-color":"colorpicker","fill-outline-color":"colorpicker","line-color":"colorpicker","line-width":"slider","line-blur":"slider"},XFe=Object.keys(wte),YFe={"circle-stroke-width":{step:1,min:1,max:20},"circle-radius":{step:1,min:1,max:100},"line-blur":{step:1,min:1,max:100},"line-width":{step:1,min:1,max:100}};function qR(t){const e=te.useRef(Math.round(Math.random()*1e10)),r=bte(Vm(o=>o.mapConfig),t.layerUuid),n=ote(),i=te.useMemo(()=>r?.config?.options?.paint?r?.config?.options?.paint:{},[r?.config?.options?.paint]),a=(o,c)=>{const f={...r,config:{...r?.config,options:{...r?.config?.options,paint:{...r?.config?.options?.paint,[o]:c}}}};n(xte({mapConfigKey:t.mapConfigKey,layer:f}))},s=te.useCallback(o=>{if(i?.[o]&&XFe.indexOf(o)!==-1&&(typeof i[o]=="number"||typeof i[o]=="string")){const c=J.jsx(Es,{id:o+"_label",gutterBottom:!0,children:o});switch(wte[o]){case"slider":return J.jsxs(gt.Fragment,{children:[c,J.jsx(pO,{...YFe[o],value:i[o],valueLabelDisplay:"auto",onChange:(f,d)=>{d&&typeof d=="number"&&a(o,d)}})]},o);case"numberfield":return J.jsxs(gt.Fragment,{children:[c,J.jsx(JT,{inputProps:{inputMode:"decimal",pattern:"[0-9]*"},value:i[o],onChange:f=>{f?.target?.value&&a(o,parseInt(f.target.value))}})]},o);case"colorpicker":return J.jsxs(gt.Fragment,{children:[c,J.jsx(Jo,{sx:{"& > div":{width:"initial !important"}},children:J.jsx($R,{value:i[o],onChange:f=>{a(o,f)}},o)})]},o)}}return null},[i]);return J.jsx(J.Fragment,{children:J.jsx(GFe,{children:J.jsx(qf,{children:J.jsx(WFe,{children:i&&Object.keys(i).map(o=>s(o))})},e.current+"_paintPropForm")})})}try{qR.displayName="LayerPropertyForm",qR.__docgenInfo={description:"",displayName:"LayerPropertyForm",props:{layerUuid:{defaultValue:null,description:"",name:"layerUuid",required:!0,type:{name:"string"}},mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}}}}}catch{}const ZFe=Dr(uf)({padding:"4px",marginTop:"-3px"}),KFe=Dr(uf)({marginLeft:"20px"}),S1=Dr(qf)({paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:"4px"}),RP=Dr(Fb)({minWidth:"30px"}),Bw=Dr(uf)({marginRight:"0px",padding:"0px"}),TH=Dr(Jo)(({open:t})=>({display:t?"block":"none"})),CH=Dr(kh)({marginLeft:"50px"});function eT(t){const[e,r]=te.useState(!1),[n,i]=te.useState(!1),a=bte(Vm(A=>A.mapConfig),t.layerOrderConfig.uuid),[s,o]=te.useState(!1),c=ote(),f=Vm(A=>A.mapConfig.mapConfigs[t.mapConfigKey]);function d(A,R){const F=JSON.parse(JSON.stringify(f.layerOrder)),N=O=>{let U=!1;return O.forEach((j,H)=>{if(!U)if(j.uuid===A){const W=R(H);if(W<0||W>=O.length)throw new Error("New position is out of bounds");const[X]=O.splice(H,1);O.splice(W,0,X),U=!0}else j.layers&&N(j.layers)&&(U=!0)}),U};N(F),c(qFe({mapConfigKey:t.mapConfigKey,newOrder:F}))}const m=A=>{d(A,R=>R+1)},b=A=>{d(A,R=>R-1)};function x(A,R=""){const F=!A;a&&(E(a,F,R),(a.type==="folder"||a.type==="vt"&&R==="")&&c(HFe({mapConfigKey:t.mapConfigKey,layerId:a.uuid,masterVisible:F})))}function E(A,R,F){let N={...A};if(A?.type==="folder")N={...A,visible:!A.visible};else switch(A?.type){case"geojson":{N={...A,config:{...A.config,options:{...A?.config?.options,layout:{...A?.config?.options?.layout,visibility:R?"visible":"none"}}}};break}case"vt":{let O=!1;const U=A.config.layers.map(j=>j.id===F?(O=!0,{...j,layout:{...j.layout,visibility:R?"visible":"none"}}):j);O?N={...A,config:{...A.config,layers:U}}:N={...A,visible:R,config:{...A.config,layers:U}};break}case"wms":{N={...A,visible:R,config:{...A.config,visible:R}};break}}return c(xte({mapConfigKey:t.mapConfigKey,layer:N})),N}function T(A){let R=!0;if(A?.type==="geojson")return R=A?.config?.options?.layout?.visibility!=="none",J.jsxs(J.Fragment,{children:[J.jsxs(S1,{sx:{...t.listItemSx},secondaryAction:J.jsxs(J.Fragment,{children:[t?.buttons,J.jsx(Bw,{disabled:!1,onClick:()=>{m(A.uuid)},children:J.jsx(SS,{})}),J.jsx(Bw,{disabled:!1,onClick:()=>{b(A.uuid)},children:J.jsx(ES,{})}),A.configurable&&J.jsx(J.Fragment,{children:J.jsx(ZFe,{edge:"end","aria-label":"settings",onClick:()=>{r(F=>!F)},children:J.jsx(cL,{})})})]}),children:[J.jsx(ap,{children:J.jsx(op,{checked:R,disabled:A.masterVisible===!1,onClick:()=>x(R)})}),J.jsx(Df,{variant:"layerlist",primary:A.name||"",secondary:t.description,primaryTypographyProps:{overflow:"hidden"}}),t.buttons]},A.uuid),A.configurable&&e&&J.jsxs(J.Fragment,{children:[t.showDeleteButton&&J.jsxs(J.Fragment,{children:[J.jsx(KFe,{edge:"end","aria-label":"delete",onClick:()=>{},children:J.jsx(Ux,{})}),n&&J.jsx(Z0,{open:n,onConfirm:()=>{i(!1)},onCancel:()=>{i(!1)},title:"Delete layer",text:"Are you sure you want to delete this layer?"})]}),J.jsx(qR,{layerUuid:A.uuid,mapConfigKey:t.mapConfigKey})]})]});if(A?.type==="vt")return J.jsxs(J.Fragment,{children:[J.jsxs(S1,{sx:{...t.listItemSx},secondaryAction:void 0,children:[J.jsxs(RP,{children:[J.jsx(Bw,{edge:"end","aria-label":"open",onClick:()=>o(!s),children:s?J.jsx(mE,{}):J.jsx(EH,{})}),J.jsx(ap,{children:J.jsx(op,{checked:A.visible,disabled:A.masterVisible===!1,onClick:()=>x(A.visible??!1)})})]}),J.jsx(Df,{primary:A.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},A.uuid),J.jsx(TH,{open:s,children:J.jsx(CH,{disablePadding:!0,children:A.config?.layers?.map(F=>J.jsxs(S1,{sx:{...t.listItemSx},secondaryAction:void 0,children:[" ",J.jsx(RP,{children:J.jsx(ap,{children:J.jsx(op,{checked:(F?.layout?.visibility??"visible")==="visible",disabled:F?.masterVisible===!1,onClick:()=>x(F?.layout?.visibility==="visible",F.id)})})}),J.jsx(Df,{variant:"layerlist",primary:F["source-layer"],primaryTypographyProps:{overflow:"hidden"}},F.id)]},F.id))})},A.uuid+"_list")]});if(A?.type==="wms"){const F=A.config?.visible??!0;return J.jsx(J.Fragment,{children:J.jsxs(S1,{sx:{...t.listItemSx},secondaryAction:void 0,children:[J.jsx(ap,{children:J.jsx(op,{checked:F,disabled:A.masterVisible===!1,onClick:()=>x(F)})}),J.jsx(Df,{primary:A.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},A.uuid)})}return A.type==="folder"?J.jsxs(J.Fragment,{children:[J.jsxs(S1,{sx:{...t.listItemSx},children:[J.jsxs(RP,{children:[J.jsx(Bw,{edge:"end","aria-label":"open",onClick:()=>o(!s),children:s?J.jsx(mE,{}):J.jsx(EH,{})}),J.jsx(ap,{children:J.jsx(op,{checked:A.visible,disabled:A.masterVisible,onClick:()=>x(A.visible?A.visible:!1)})})]}),J.jsx(Df,{primary:A.name,secondary:t.description,primaryTypographyProps:{overflow:"hidden"}})]},A.uuid),J.jsx(TH,{open:s,children:J.jsx(CH,{disablePadding:!0,children:t?.layerOrderConfig?.layers?.map(F=>J.jsx(eT,{layerOrderConfig:F,mapConfigKey:t.mapConfigKey},F.uuid))})},A.uuid+"_list")]}):J.jsx(J.Fragment,{})}return J.jsx(J.Fragment,{children:a&&T(a)})}try{eT.displayName="LayerTreeListItem",eT.__docgenInfo={description:"",displayName:"LayerTreeListItem",props:{visible:{defaultValue:null,description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"layer"'},{value:'"background"'},{value:'"background-labels"'},{value:'"wms-layer"'},{value:'"vector-tile-layer"'}]}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string | undefined"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string | undefined"}},setLayerState:{defaultValue:null,description:"",name:"setLayerState",required:!1,type:{name:"((state: unknown) => void) | undefined"}},showDeleteButton:{defaultValue:null,description:"",name:"showDeleteButton",required:!1,type:{name:"boolean | undefined"}},listItemSx:{defaultValue:null,description:"",name:"listItemSx",required:!1,type:{name:"SxProps | undefined"}},buttons:{defaultValue:null,description:"",name:"buttons",required:!1,type:{name:"Element | undefined"}},sortable:{defaultValue:null,description:"",name:"sortable",required:!1,type:{name:"boolean | undefined"}},mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}},layerOrderConfig:{defaultValue:null,description:"",name:"layerOrderConfig",required:!0,type:{name:"LayerOrderItem"}}}}}catch{}const JFe=Dr(kh)({marginTop:"15px"});function AH(t){const e=Vm(r=>r.mapConfig.mapConfigs?.[t.mapConfigKey]?.layerOrder);return J.jsx(JFe,{children:e?.map?.(r=>J.jsx(eT,{layerOrderConfig:r,mapConfigKey:t.mapConfigKey},r.uuid))})}try{AH.displayName="LayerTree",AH.__docgenInfo={description:"",displayName:"LayerTree",props:{mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}}}}}catch{}function IH(t){const e=Vm(c=>c.mapConfig.mapConfigs?.[t.mapConfigKey]?.layers),r=Vm(c=>c.mapConfig.mapConfigs?.[t.mapConfigKey]?.layerOrder),n=ga({mapId:t?.mapId}),i=Vm(c=>$Fe(c,t.mapConfigKey)),a=te.useRef([]);te.useEffect(()=>{if(!n.map||!r)return;const c=(d,m,b)=>{for(let x=0;x<d.length;x++){const E=d[x],T=m?m[x]:null;if(E.uuid!==T?.uuid&&b.getLayer(E.uuid)){const A=x>0?d[x-1].uuid:void 0;b.moveLayer(E.uuid,A)}if(E.layers&&E.layers.length>0){const A=T?.layers||[];c(E.layers,A,b)}}},f=a.current;c(r,f,n.map),a.current=r},[r,n.map]);const s=te.useMemo(()=>["order-background",...i.map(f=>"layer_id_"+f),"order-labels"],[i]);function o(c){const f=e.findIndex(m=>m.uuid===c.uuid),d=e[f];switch(d?.type){case"geojson":return J.jsx(Dc,{layerId:d.uuid,insertBeforeLayer:"layer_id_"+d.uuid,...d.config,options:{...d.config.options,layout:{...d?.config?.options?.layout,visibility:d.masterVisible===!1?"none":d?.config?.options?.layout?.visibility?d?.config?.options?.layout?.visibility:"visible"}}},d.uuid);case"vt":{const m=d.config.layers.map(b=>{const x={...b};return x.layout&&(x.layout={...x.layout,visibility:x.masterVisible===!1?"none":x.layout.visibility??"visible"}),x});return J.jsx(I0,{layerId:d.uuid,insertBeforeLayer:"layer_id_"+d.uuid,url:d.config.url,layers:m},d.uuid)}case"wms":{const m=d.masterVisible===!1?!1:d.config?.visible;return J.jsx(OE,{layerId:d.uuid,insertBeforeLayer:"layer_id_"+d.uuid,url:d.config?.url||"",urlParameters:d.config?.urlParameters,visible:m},d.uuid)}case"folder":return c?.layers?c.layers.map(m=>o(m)):J.jsx(J.Fragment,{});default:return null}}return J.jsxs(J.Fragment,{children:[J.jsx(NE,{layerIds:s}),r?.map?.(c=>o(c))]})}try{IH.displayName="LayerOnMap",IH.__docgenInfo={description:"",displayName:"LayerOnMap",props:{mapConfigKey:{defaultValue:null,description:"",name:"mapConfigKey",required:!0,type:{name:"string"}},mapId:{defaultValue:null,description:"",name:"mapId",required:!1,type:{name:"string | undefined"}}}}}catch{}const QFe=[(t,e)=>{const r=te.useMemo(()=>RX(e?.globals?.theme),[e?.globals?.theme]);return J.jsx("div",{className:"fullscreen_map",children:J.jsx(IM,{children:J.jsxs(kX,{theme:r,children:[J.jsx(t,{}),J.jsx(OX,{options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[7.0851268,50.73884]},mapId:"map_1"}),J.jsx(sR,{sx:{bottom:"25px",right:"5px"},showZoomButtons:!1,mapId:"map_1"})]})})})}];function tT(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const MN=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),PH=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);PH&&parseFloat(PH[1]);const MH=globalThis,kH=globalThis.process||{},eBe=globalThis.navigator||{};function Ste(t){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;const r=typeof navigator<"u"&&navigator.userAgent;return!!(r&&r.indexOf("Electron")>=0)}function Py(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||Ste()}function tBe(t){return Py()?Ste()?"Electron":(eBe.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const Ete="4.1.0";function rBe(t){try{const e=window[t],r="__storage_test__";return e.setItem(r,r),e.removeItem(r),e}catch{return null}}class nBe{constructor(e,r,n="sessionStorage"){this.storage=rBe(n),this.id=e,this.config=r,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}}_loadConfiguration(){let e={};if(this.storage){const r=this.storage.getItem(this.id);e=r?JSON.parse(r):{}}return Object.assign(this.config,e),this}}function iBe(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function aBe(t,e=8){const r=Math.max(e-t.length,0);return`${" ".repeat(r)}${t}`}var rT;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(rT||(rT={}));const oBe=10;function RH(t){return typeof t!="string"?t:(t=t.toUpperCase(),rT[t]||rT.WHITE)}function sBe(t,e,r){return!Py&&typeof t=="string"&&(e&&(t=`\x1B[${RH(e)}m${t}\x1B[39m`),r&&(t=`\x1B[${RH(r)+oBe}m${t}\x1B[49m`)),t}function lBe(t,e=["constructor"]){const r=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(r),i=t;for(const a of n){const s=i[a];typeof s=="function"&&(e.find(o=>a===o)||(i[a]=s.bind(t)))}}function kN(t,e){if(!t)throw new Error("Assertion failed")}function Ev(){let t;if(Py()&&MH.performance)t=MH?.performance?.now?.();else if("hrtime"in kH){const e=kH?.hrtime?.();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}const Tv={debug:Py()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},uBe={enabled:!0,level:0};function Cv(){}const DH={},OH={once:!0};class e2{constructor({id:e}={id:""}){this.VERSION=Ete,this._startTs=Ev(),this._deltaTs=Ev(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new nBe(`__probe-${this.id}__`,uBe),this.timeStamp(`${this.id} started`),lBe(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Ev()-this._startTs).toPrecision(10))}getDelta(){return Number((Ev()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,r){this._storage.setConfiguration({[e]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,r){if(!e)throw new Error(r||"Assertion failed")}warn(e){return this._getLogFunction(0,e,Tv.warn,arguments,OH)}error(e){return this._getLogFunction(0,e,Tv.error,arguments)}deprecated(e,r){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${r}\` instead`)}removed(e,r){return this.error(`\`${e}\` has been removed. Use \`${r}\` instead`)}probe(e,r){return this._getLogFunction(e,r,Tv.log,arguments,{time:!0,once:!0})}log(e,r){return this._getLogFunction(e,r,Tv.debug,arguments)}info(e,r){return this._getLogFunction(e,r,console.info,arguments)}once(e,r){return this._getLogFunction(e,r,Tv.debug||Tv.info,arguments,OH)}table(e,r,n){return r?this._getLogFunction(e,r,console.table||Cv,n&&[n],{tag:fBe(r)}):Cv}time(e,r){return this._getLogFunction(e,r,console.time?console.time:console.info)}timeEnd(e,r){return this._getLogFunction(e,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,r){return this._getLogFunction(e,r,console.timeStamp||Cv)}group(e,r,n={collapsed:!1}){const i=LH({logLevel:e,message:r,opts:n}),{collapsed:a}=n;return i.method=(a?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,r,n={}){return this.group(e,r,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Cv)}withGroup(e,r,n){this.group(e,r)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Tte(e)}_getLogFunction(e,r,n,i,a){if(this._shouldLog(e)){a=LH({logLevel:e,message:r,args:i,opts:a}),n=n||a.method,kN(n),a.total=this.getTotal(),a.delta=this.getDelta(),this._deltaTs=Ev();const s=a.tag||a.message;if(a.once&&s)if(!DH[s])DH[s]=Ev();else return Cv;return r=cBe(this.id,a.message,a),n.bind(console,r,...a.args)}return Cv}}e2.VERSION=Ete;function Tte(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return kN(Number.isFinite(e)&&e>=0),e}function LH(t){const{logLevel:e,message:r}=t;t.logLevel=Tte(e);const n=t.args?Array.from(t.args):[];for(;n.length&&n.shift()!==r;);switch(typeof e){case"string":case"function":r!==void 0&&n.unshift(r),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return kN(i==="string"||i==="object"),Object.assign(t,{args:n},t.opts)}function cBe(t,e,r){if(typeof e=="string"){const n=r.time?aBe(iBe(r.total)):"";e=r.time?`${t}: ${n}  ${e}`:`${t}: ${e}`,e=sBe(e,r.color,r.background)}return e}function fBe(t){for(const e in t)for(const r in t[e])return r||"untitled";return"empty"}const DP="4.3.3",hBe=DP[0]>="0"&&DP[0]<="9"?`v${DP}`:"";function dBe(){const t=new e2({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=hBe,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}const pBe=dBe();function gBe(t,e){return Cte(t||{},e)}function Cte(t,e,r=0){if(r>3)return e;const n={...t};for(const[i,a]of Object.entries(e))a&&typeof a=="object"&&!Array.isArray(a)?n[i]=Cte(n[i]||{},e[i],r+1):n[i]=e[i];return n}const mBe="latest";function yBe(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}const vBe=yBe();function Dg(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const $m=typeof process!="object"||String(process)!=="[object process]"||process.browser,_Be=typeof window<"u"&&typeof window.orientation<"u",NH=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);NH&&parseFloat(NH[1]);class bBe{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,r){this.name=e,this.workerThread=r,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(e,r){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:r})}done(e){Dg(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Dg(this.isRunning),this.isRunning=!1,this._reject(e)}}class OP{terminate(){}}const LP=new Map;function xBe(t){Dg(t.source&&!t.url||!t.source&&t.url);let e=LP.get(t.source||t.url);return e||(t.url&&(e=wBe(t.url),LP.set(t.url,e)),t.source&&(e=Ate(t.source),LP.set(t.source,e))),Dg(e),e}function wBe(t){if(!t.startsWith("http"))return t;const e=SBe(t);return Ate(e)}function Ate(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function SBe(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function Ite(t,e=!0,r){const n=r||new Set;if(t){if(FH(t))n.add(t);else if(FH(t.buffer))n.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)Ite(t[i],e,n)}}return r===void 0?Array.from(n):[]}function FH(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const NP=()=>{};class HR{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&$m||typeof OP<"u"&&!$m}constructor(e){const{name:r,source:n,url:i}=e;Dg(n||i),this.name=r,this.source=n,this.url=i,this.onMessage=NP,this.onError=a=>console.log(a),this.worker=$m?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=NP,this.onError=NP,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,r){r=r||Ite(e),this.worker.postMessage(e,r)}_getErrorFromErrorEvent(e){let r="Failed to load ";return r+=`worker ${this.name} from ${this.url}. `,e.message&&(r+=`${e.message} in `),e.lineno&&(r+=`:${e.lineno}:${e.colno}`),new Error(r)}_createBrowserWorker(){this._loadableURL=xBe({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=r=>{r.data?this.onMessage(r.data):this.onError(new Error("No data received"))},e.onerror=r=>{this.onError(this._getErrorFromErrorEvent(r)),this.terminated=!0},e.onmessageerror=r=>console.error(r),e}_createNodeWorker(){let e;if(this.url){const n=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new OP(n,{eval:!1})}else if(this.source)e=new OP(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",r=>{this.onMessage(r)}),e.on("error",r=>{this.onError(r)}),e.on("exit",r=>{}),e}}class EBe{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return HR.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,r=(i,a,s)=>i.done(s),n=(i,a)=>i.error(a)){const i=new Promise(a=>(this.jobQueue.push({name:e,onMessage:r,onError:n,onStart:a}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const r=this.jobQueue.shift();if(r){this.onDebug({message:"Starting job",name:r.name,workerThread:e,backlog:this.jobQueue.length});const n=new bBe(r.name,e);e.onMessage=i=>r.onMessage(n,i.type,i.payload),e.onError=i=>r.onError(n,i),r.onStart(n);try{await n.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!$m||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new HR({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return _Be?this.maxMobileConcurrency:this.maxConcurrency}}const TBe={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class sg{props;workerPools=new Map;static _workerFarm;static isSupported(){return HR.isSupported()}static getWorkerFarm(e={}){return sg._workerFarm=sg._workerFarm||new sg({}),sg._workerFarm.setProps(e),sg._workerFarm}constructor(e){this.props={...TBe},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const r of this.workerPools.values())r.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:r,source:n,url:i}=e;let a=this.workerPools.get(r);return a||(a=new EBe({name:r,source:n,url:i}),a.setProps(this._getWorkerPoolProps()),this.workerPools.set(r,a)),a}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function CBe(t,e={}){const r=e[t.id]||{},n=$m?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=r.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&($m?i=`modules/${t.module}/dist/${n}`:i=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let a=t.version;a==="latest"&&(a=mBe);const s=a?`@${a}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${s}/dist/${n}`}return Dg(i),i}function ABe(t,e=vBe){Dg(t,"no worker provided");const r=t.version;return!(!e||!r)}function IBe(t,e){return!sg.isSupported()||!$m&&!e?._nodeWorkers?!1:t.worker&&e?.worker}async function PBe(t,e,r,n,i){const a=t.id,s=CBe(t,r),c=sg.getWorkerFarm(r).getWorkerPool({name:a,url:s});r=JSON.parse(JSON.stringify(r)),n=JSON.parse(JSON.stringify(n||{}));const f=await c.startJob("process-on-worker",MBe.bind(null,i));return f.postMessage("process",{input:e,options:r,context:n}),await(await f.result).result}async function MBe(t,e,r,n){switch(r){case"done":e.done(n);break;case"error":e.error(new Error(n.error));break;case"process":const{id:i,input:a,options:s}=n;try{const o=await t(a,s);e.postMessage("done",{id:i,result:o})}catch(o){const c=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:c})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function kBe(t,e,r){if(r=r||t.byteLength,t.byteLength<r||e.byteLength<r)return!1;const n=new Uint8Array(t),i=new Uint8Array(e);for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}function RBe(...t){return DBe(t)}function DBe(t){const e=t.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),r=e.reduce((a,s)=>a+s.byteLength,0),n=new Uint8Array(r);let i=0;for(const a of e)n.set(a,i),i+=a.byteLength;return n.buffer}async function OBe(t){const e=[];for await(const r of t)e.push(r);return RBe(...e)}function BH(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class zH{constructor(e,r){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=r,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=BH(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(BH()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class H3{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,r="count"){return this._getOrCreate({name:e,type:r})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const r of Object.values(this.stats))e(r)}getTable(){const e={};return this.forEach(r=>{e[r.name]={time:r.time||0,count:r.count||0,average:r.getAverageTime()||0,hz:r.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(r=>this._getOrCreate(r))}_getOrCreate(e){const{name:r,type:n}=e;let i=this.stats[r];return i||(e instanceof zH?i=e:i=new zH(r,n),this.stats[r]=i),i}}let LBe="";const jH={};function NBe(t){for(const e in jH)if(t.startsWith(e)){const r=jH[e];t=t.replace(e,r)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${LBe}${t}`),t}function FBe(t){return t&&typeof t=="object"&&t.isBuffer}function Pte(t){if(FBe(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function Mte(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function BBe(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const zBe=t=>typeof t=="boolean",bb=t=>typeof t=="function",t2=t=>t!==null&&typeof t=="object",UH=t=>t2(t)&&t.constructor==={}.constructor,jBe=t=>!!t&&typeof t[Symbol.iterator]=="function",UBe=t=>t&&typeof t[Symbol.asyncIterator]=="function",My=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,ky=t=>typeof Blob<"u"&&t instanceof Blob,VBe=t=>t&&typeof t=="object"&&t.isBuffer,$Be=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||t2(t)&&bb(t.tee)&&bb(t.cancel)&&bb(t.getReader),qBe=t=>t2(t)&&bb(t.read)&&bb(t.pipe)&&zBe(t.readable),kte=t=>$Be(t)||qBe(t);class HBe extends Error{constructor(e,r){super(e),this.reason=r.reason,this.url=r.url,this.response=r.response}reason;url;response}const GBe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,WBe=/^([-\w.]+\/[-\w.+]+)/;function VH(t,e){return t.toLowerCase()===e.toLowerCase()}function XBe(t){const e=WBe.exec(t);return e?e[1]:t}function $H(t){const e=GBe.exec(t);return e?e[1]:""}const Rte=/\?.*/;function YBe(t){const e=t.match(Rte);return e&&e[0]}function RN(t){return t.replace(Rte,"")}function ZBe(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function G3(t){return My(t)?t.url:ky(t)?t.name||"":typeof t=="string"?t:""}function DN(t){if(My(t)){const e=t,r=e.headers.get("content-type")||"",n=RN(e.url);return XBe(r)||$H(n)}return ky(t)?t.type||"":typeof t=="string"?$H(t):""}function KBe(t){return My(t)?t.headers["content-length"]||-1:ky(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function Dte(t){if(My(t))return t;const e={},r=KBe(t);r>=0&&(e["content-length"]=String(r));const n=G3(t),i=DN(t);i&&(e["content-type"]=i);const a=await e8e(t);a&&(e["x-first-bytes"]=a),typeof t=="string"&&(t=new TextEncoder().encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:n}),s}async function JBe(t){if(!t.ok)throw await QBe(t)}async function QBe(t){const e=ZBe(t.url);let r=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;r=r.length>100?`${r.slice(0,100)}...`:r;const n={reason:t.statusText,url:t.url,response:t};try{const i=t.headers.get("Content-Type");n.reason=!t.bodyUsed&&i?.includes("application/json")?await t.json():await t.text()}catch{}return new HBe(r,n)}async function e8e(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const r=t.slice(0,5);return await new Promise(n=>{const i=new FileReader;i.onload=a=>n(a?.target?.result),i.readAsDataURL(r)})}if(t instanceof ArrayBuffer){const r=t.slice(0,5);return`data:base64,${t8e(r)}`}return null}function t8e(t){let e="";const r=new Uint8Array(t);for(let n=0;n<r.byteLength;n++)e+=String.fromCharCode(r[n]);return btoa(e)}function r8e(t){return!n8e(t)&&!i8e(t)}function n8e(t){return t.startsWith("http:")||t.startsWith("https:")}function i8e(t){return t.startsWith("data:")}async function qH(t,e){if(typeof t=="string"){const r=NBe(t);return r8e(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,e):await fetch(r,e)}return await Dte(t)}const HH=new e2({id:"loaders.gl"});class a8e{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class o8e{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const Ote={fetch:null,mimeType:void 0,nothrow:!1,log:new o8e,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:MN,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},s8e={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Lte(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function Nte(){const t=Lte();return t.globalOptions=t.globalOptions||{...Ote},t.globalOptions}function l8e(t,e,r,n){return r=r||[],r=Array.isArray(r)?r:[r],u8e(t,r),f8e(e,t,n)}function u8e(t,e){GH(t,null,Ote,s8e,e);for(const r of e){const n=t&&t[r.id]||{},i=r.options&&r.options[r.id]||{},a=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};GH(n,r.id,i,a,e)}}function GH(t,e,r,n,i){const a=e||"Top level",s=e?`${e}.`:"";for(const o in t){const c=!e&&t2(t[o]),f=o==="baseUri"&&!e,d=o==="workerUrl"&&e;if(!(o in r)&&!f&&!d){if(o in n)HH.warn(`${a} loader option '${s}${o}' no longer supported, use '${n[o]}'`)();else if(!c){const m=c8e(o,i);HH.warn(`${a} loader option '${s}${o}' not recognized. ${m}`)()}}}}function c8e(t,e){const r=t.toLowerCase();let n="";for(const i of e)for(const a in i.options){if(t===a)return`Did you mean '${i.id}.${a}'?`;const s=a.toLowerCase();(r.startsWith(s)||s.startsWith(r))&&(n=n||`Did you mean '${i.id}.${a}'?`)}return n}function f8e(t,e,r){const i={...t.options||{}};return h8e(i,r),i.log===null&&(i.log=new a8e),WH(i,Nte()),WH(i,e),i}function WH(t,e){for(const r in e)if(r in e){const n=e[r];UH(n)&&UH(t[r])?t[r]={...t[r],...e[r]}:t[r]=e[r]}}function h8e(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function ON(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t?.extensions)):!1}function LN(t){tT(t,"null loader"),tT(ON(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t?.parseTextSync||t?.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Fte=()=>{const t=Lte();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function d8e(t){const e=Fte();t=Array.isArray(t)?t:[t];for(const r of t){const n=LN(r);e.find(i=>n===i)||e.unshift(n)}}function p8e(){return Fte()}const g8e=/\.([^.]+)$/;async function m8e(t,e=[],r,n){if(!Bte(t))return null;let i=XH(t,e,{...r,nothrow:!0},n);if(i)return i;if(ky(t)&&(t=await t.slice(0,10).arrayBuffer(),i=XH(t,e,r,n)),!i&&!r?.nothrow)throw new Error(zte(t));return i}function XH(t,e=[],r,n){if(!Bte(t))return null;if(e&&!Array.isArray(e))return LN(e);let i=[];e&&(i=i.concat(e)),r?.ignoreRegisteredLoaders||i.push(...p8e()),v8e(i);const a=y8e(t,i,r,n);if(!a&&!r?.nothrow)throw new Error(zte(t));return a}function y8e(t,e,r,n){const i=G3(t),a=DN(t),s=RN(i)||n?.url;let o=null,c="";return r?.mimeType&&(o=FP(e,r?.mimeType),c=`match forced by supplied MIME type ${r?.mimeType}`),o=o||_8e(e,s),c=c||(o?`matched url ${s}`:""),o=o||FP(e,a),c=c||(o?`matched MIME type ${a}`:""),o=o||x8e(e,t),c=c||(o?`matched initial data ${jte(t)}`:""),r?.fallbackMimeType&&(o=o||FP(e,r?.fallbackMimeType),c=c||(o?`matched fallback MIME type ${a}`:"")),c&&pBe.log(1,`selectLoader selected ${o?.name}: ${c}.`),o}function Bte(t){return!(t instanceof Response&&t.status===204)}function zte(t){const e=G3(t),r=DN(t);let n="No valid loader found (";n+=e?`${Mte(e)}, `:"no url provided, ",n+=`MIME type: ${r?`"${r}"`:"not provided"}, `;const i=t?jte(t):"";return n+=i?` first bytes: "${i}"`:"first bytes: not available",n+=")",n}function v8e(t){for(const e of t)LN(e)}function _8e(t,e){const r=e&&g8e.exec(e),n=r&&r[1];return n?b8e(t,n):null}function b8e(t,e){e=e.toLowerCase();for(const r of t)for(const n of r.extensions)if(n.toLowerCase()===e)return r;return null}function FP(t,e){for(const r of t)if(r.mimeTypes?.some(n=>VH(e,n))||VH(e,`application/x.${r.id}`))return r;return null}function x8e(t,e){if(!e)return null;for(const r of t)if(typeof e=="string"){if(w8e(e,r))return r}else if(ArrayBuffer.isView(e)){if(YH(e.buffer,e.byteOffset,r))return r}else if(e instanceof ArrayBuffer&&YH(e,0,r))return r;return null}function w8e(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(n=>t.startsWith(n))}function YH(t,e,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(i=>S8e(t,e,r,i))}function S8e(t,e,r,n){if(n instanceof ArrayBuffer)return kBe(n,t,n.byteLength);switch(typeof n){case"function":return n(t);case"string":const i=GR(t,e,n.length);return n===i;default:return!1}}function jte(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?GR(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?GR(t,0,e):""}function GR(t,e,r){if(t.byteLength<e+r)return"";const n=new DataView(t);let i="";for(let a=0;a<r;a++)i+=String.fromCharCode(n.getUint8(e+a));return i}const E8e=256*1024;function*T8e(t,e){const r=e?.chunkSize||E8e;let n=0;const i=new TextEncoder;for(;n<t.length;){const a=Math.min(t.length-n,r),s=t.slice(n,n+a);n+=a,yield i.encode(s)}}const C8e=256*1024;function*A8e(t,e={}){const{chunkSize:r=C8e}=e;let n=0;for(;n<t.byteLength;){const i=Math.min(t.byteLength-n,r),a=new ArrayBuffer(i),s=new Uint8Array(t,n,i);new Uint8Array(a).set(s),n+=i,yield a}}const I8e=1024*1024;async function*P8e(t,e){const r=e?.chunkSize||I8e;let n=0;for(;n<t.size;){const i=n+r,a=await t.slice(n,i).arrayBuffer();n=i,yield a}}function ZH(t,e){return MN?M8e(t,e):k8e(t)}async function*M8e(t,e){const r=t.getReader();let n;try{for(;;){const i=n||r.read();e?._streamReadAhead&&(n=r.read());const{done:a,value:s}=await i;if(a)return;yield Pte(s)}}catch{r.releaseLock()}}async function*k8e(t,e){for await(const r of t)yield Pte(r)}function R8e(t,e){if(typeof t=="string")return T8e(t,e);if(t instanceof ArrayBuffer)return A8e(t,e);if(ky(t))return P8e(t,e);if(kte(t))return ZH(t,e);if(My(t))return ZH(t.body,e);throw new Error("makeIterator")}const Ute="Cannot convert supplied data type";function D8e(t,e,r){if(e.text&&typeof t=="string")return t;if(VBe(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(t.byteOffset,t.byteOffset+i)),n}throw new Error(Ute)}async function O8e(t,e,r){const n=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||n)return D8e(t,e);if(ky(t)&&(t=await Dte(t)),My(t)){const i=t;return await JBe(i),e.binary?await i.arrayBuffer():await i.text()}if(kte(t)&&(t=R8e(t,r)),jBe(t)||UBe(t))return OBe(t);throw new Error(Ute)}function Vte(t,e){const r=Nte(),n=t||r;return typeof n.fetch=="function"?n.fetch:t2(n.fetch)?i=>qH(i,n.fetch):e?.fetch?e?.fetch:qH}function L8e(t,e,r){if(r)return r;const n={fetch:Vte(e,t),...t};if(n.url){const i=RN(n.url);n.baseUrl=i,n.queryString=YBe(n.url),n.filename=Mte(i),n.baseUrl=BBe(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function N8e(t,e){if(t&&!Array.isArray(t))return t;let r;if(t&&(r=Array.isArray(t)?t:[t]),e&&e.loaders){const n=Array.isArray(e.loaders)?e.loaders:[e.loaders];r=r?[...r,...n]:n}return r&&r.length?r:void 0}async function nT(t,e,r,n){e&&!Array.isArray(e)&&!ON(e)&&(n=void 0,r=e,e=void 0),t=await t,r=r||{};const i=G3(t),s=N8e(e,n),o=await m8e(t,s,r);return o?(r=l8e(r,o,s,i),n=L8e({url:i,_parse:nT,loaders:s},r,n||null),await F8e(o,t,r,n)):null}async function F8e(t,e,r,n){if(ABe(t),r=gBe(t.options,r),My(e)){const a=e,{ok:s,redirected:o,status:c,statusText:f,type:d,url:m}=a,b=Object.fromEntries(a.headers.entries());n.response={headers:b,ok:s,redirected:o,status:c,statusText:f,type:d,url:m}}e=await O8e(e,t,r);const i=t;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,r,n);if(IBe(t,r))return await PBe(t,e,r,n,nT);if(i.parseText&&typeof e=="string")return await i.parseText(e,r,n);if(i.parse)return await i.parse(e,r,n);throw Dg(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}async function WR(t,e,r,n){let i,a;!Array.isArray(e)&&!ON(e)?(i=[],a=e):(i=e,a=r);const s=Vte(a);let o=t;return typeof t=="string"&&(o=await s(t)),ky(t)&&(o=await s(t)),Array.isArray(i)?await nT(o,i,a):await nT(o,i,a)}const B8e="4.3.3",z8e=globalThis.loaders?.parseImageNode,XR=typeof Image<"u",YR=typeof ImageBitmap<"u",j8e=!!z8e,ZR=MN?!0:j8e;function U8e(t){switch(t){case"auto":return YR||XR||ZR;case"imagebitmap":return YR;case"image":return XR;case"data":return ZR;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function V8e(){if(YR)return"imagebitmap";if(XR)return"image";if(ZR)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function $8e(t){const e=H8e(t);if(!e)throw new Error("Not an image");return e}function q8e(t){switch($8e(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),r=e.getContext("2d");if(!r)throw new Error("getImageData");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0),r.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function H8e(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const G8e=/^data:image\/svg\+xml/,W8e=/\.svg((\?|#).*)?$/;function NN(t){return t&&(G8e.test(t)||W8e.test(t))}function X8e(t,e){if(NN(e)){let n=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(a){throw new Error(a.message)}return`data:image/svg+xml;base64,${btoa(n)}`}return $te(t,e)}function $te(t,e){if(NN(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function qte(t,e,r){const n=X8e(t,r),i=self.URL||self.webkitURL,a=typeof n!="string"&&i.createObjectURL(n);try{return await Y8e(a||n,e)}finally{a&&i.revokeObjectURL(a)}}async function Y8e(t,e){const r=new Image;return r.src=t,e.image&&e.image.decode&&r.decode?(await r.decode(),r):await new Promise((n,i)=>{try{r.onload=()=>n(r),r.onerror=a=>{const s=a instanceof Error?a.message:"error";i(new Error(s))}}catch(a){i(a)}})}const Z8e={};let KH=!0;async function K8e(t,e,r){let n;NN(r)?n=await qte(t,e,r):n=$te(t,r);const i=e&&e.imagebitmap;return await J8e(n,i)}async function J8e(t,e=null){if((Q8e(e)||!KH)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(r){console.warn(r),KH=!1}return await createImageBitmap(t)}function Q8e(t){for(const e in t||Z8e)return!1;return!0}function eze(t){return!ize(t,"ftyp",4)||(t[8]&96)===0?null:tze(t)}function tze(t){switch(rze(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function rze(t,e,r){return String.fromCharCode(...t.slice(e,r))}function nze(t){return[...t].map(e=>e.charCodeAt(0))}function ize(t,e,r=0){const n=nze(e);for(let i=0;i<n.length;++i)if(n[i]!==t[i+r])return!1;return!0}const cd=!1,xb=!0;function Hte(t){const e=r2(t);return oze(e)||uze(e)||sze(e)||lze(e)||aze(e)}function aze(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),r=eze(e);return r?{mimeType:r.mimeType,width:0,height:0}:null}function oze(t){const e=r2(t);return e.byteLength>=24&&e.getUint32(0,cd)===2303741511?{mimeType:"image/png",width:e.getUint32(16,cd),height:e.getUint32(20,cd)}:null}function sze(t){const e=r2(t);return e.byteLength>=10&&e.getUint32(0,cd)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,xb),height:e.getUint16(8,xb)}:null}function lze(t){const e=r2(t);return e.byteLength>=14&&e.getUint16(0,cd)===16973&&e.getUint32(2,xb)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,xb),height:e.getUint32(22,xb)}:null}function uze(t){const e=r2(t);if(!(e.byteLength>=3&&e.getUint16(0,cd)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:n,sofMarkers:i}=cze();let a=2;for(;a+9<e.byteLength;){const s=e.getUint16(a,cd);if(i.has(s))return{mimeType:"image/jpeg",height:e.getUint16(a+5,cd),width:e.getUint16(a+7,cd)};if(!n.has(s))return null;a+=2,a+=e.getUint16(a,cd)}return null}function cze(){const t=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)t.add(r);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function r2(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function fze(t,e){const{mimeType:r}=Hte(t)||{},n=globalThis.loaders?.parseImageNode;return tT(n),await n(t,r)}async function hze(t,e,r){e=e||{};const i=(e.image||{}).type||"auto",{url:a}=r||{},s=dze(i);let o;switch(s){case"imagebitmap":o=await K8e(t,e,a);break;case"image":o=await qte(t,e,a);break;case"data":o=await fze(t);break;default:tT(!1)}return i==="data"&&(o=q8e(o)),o}function dze(t){switch(t){case"auto":case"data":return V8e();default:return U8e(t),t}}const pze=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],gze=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],mze={image:{type:"auto",decode:!0}},yze={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:B8e,mimeTypes:gze,extensions:pze,parse:hze,tests:[t=>!!Hte(new DataView(t))],options:mze},oo=new e2({id:"deck"});let KR={};function vze(t){KR=t}function Qu(t,e,r,n){oo.level>0&&KR[t]&&KR[t].call(null,e,r,n)}function _ze(t){const e=t[0],r=t[t.length-1];return e==="{"&&r==="}"||e==="["&&r==="]"}const bze={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:_ze,parseTextSync:JSON.parse};function xze(){const t="9.1.14",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(oo.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:oo,_registerLoggers:vze},d8e([bze,[yze,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const wze=xze();function FN(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const BP={number:{type:"number",validate(t,e){return Number.isFinite(t)&&typeof e=="object"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:"array",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function Sze(t){const e={};for(const[r,n]of Object.entries(t))e[r]=Eze(n);return e}function Eze(t){let e=JH(t);if(e!=="object")return{value:t,...BP[e],type:e};if(typeof t=="object")return t?t.type!==void 0?{...t,...BP[t.type],type:t.type}:t.value===void 0?{type:"object",value:t}:(e=JH(t.value),{...t,...BP[e],type:e}):{type:"object",value:null};throw new Error("props")}function JH(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const Tze=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,Cze=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,Aze={vertex:Tze,fragment:Cze},QH=/void\s+main\s*\([^)]*\)\s*\{\n?/,eG=/}\n?[^{}]*$/,zP=[],TS="__LUMA_INJECT_DECLARATIONS__";function Ize(t){const e={vertex:{},fragment:{}};for(const r in t){let n=t[r];const i=Pze(r);typeof n=="string"&&(n={order:0,injection:n}),e[i][r]=n}return e}function Pze(t){const e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function iT(t,e,r,n=!1){const i=e==="vertex";for(const a in r){const s=r[a];s.sort((c,f)=>c.order-f.order),zP.length=s.length;for(let c=0,f=s.length;c<f;++c)zP[c]=s[c].injection;const o=`${zP.join(`
`)}
`;switch(a){case"vs:#decl":i&&(t=t.replace(TS,o));break;case"vs:#main-start":i&&(t=t.replace(QH,c=>c+o));break;case"vs:#main-end":i&&(t=t.replace(eG,c=>o+c));break;case"fs:#decl":i||(t=t.replace(TS,o));break;case"fs:#main-start":i||(t=t.replace(QH,c=>c+o));break;case"fs:#main-end":i||(t=t.replace(eG,c=>o+c));break;default:t=t.replace(a,c=>c+o)}}return t=t.replace(TS,""),n&&(t=t.replace(/\}\s*$/,a=>a+Aze[e])),t}function aT(t){t.map(e=>Mze(e))}function Mze(t){if(t.instance)return;aT(t.dependencies||[]);const{propTypes:e={},deprecations:r=[],inject:n={}}=t,i={normalizedInjections:Ize(n),parsedDeprecations:kze(r)};e&&(i.propValidators=Sze(e)),t.instance=i;let a={};e&&(a=Object.entries(e).reduce((s,[o,c])=>{const f=c?.value;return f&&(s[o]=f),s},{})),t.defaultUniforms={...t.defaultUniforms,...a}}function Gte(t,e,r){t.deprecations?.forEach(n=>{n.regex?.test(e)&&(n.deprecated?r.deprecated(n.old,n.new)():r.removed(n.old,n.new)())})}function kze(t){return t.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),t}function BN(t){aT(t);const e={},r={};Wte({modules:t,level:0,moduleMap:e,moduleDepth:r});const n=Object.keys(r).sort((i,a)=>r[a]-r[i]).map(i=>e[i]);return aT(n),n}function Wte(t){const{modules:e,level:r,moduleMap:n,moduleDepth:i}=t;if(r>=5)throw new Error("Possible loop in shader dependency graph");for(const a of e)n[a.name]=a,(i[a.name]===void 0||i[a.name]<r)&&(i[a.name]=r);for(const a of e)a.dependencies&&Wte({modules:a.dependencies,level:r+1,moduleMap:n,moduleDepth:i})}function Rze(t){switch(t?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function Dze(t,e){if(Number(t.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return t=tG(t,Oze),t;case"fragment":return t=tG(t,Lze),t;default:throw new Error(e)}}const Xte=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Oze=[...Xte,[JR("attribute"),"in $1"],[JR("varying"),"out $1"]],Lze=[...Xte,[JR("varying"),"in $1"]];function tG(t,e){for(const[r,n]of e)t=t.replace(r,n);return t}function JR(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function Yte(t,e){let r="";for(const n in t){const i=t[n];if(r+=`void ${i.signature} {
`,i.header&&(r+=`  ${i.header}`),e[n]){const a=e[n];a.sort((s,o)=>s.order-o.order);for(const s of a)r+=`  ${s.injection}
`}i.footer&&(r+=`  ${i.footer}`),r+=`}
`}return r}function Zte(t){const e={vertex:{},fragment:{}};for(const r of t){let n,i;typeof r!="string"?(n=r,i=n.hook):(n={},i=r),i=i.trim();const[a,s]=i.split(":"),o=i.replace(/\(.+/,""),c=Object.assign(n,{signature:s});switch(a){case"vs":e.vertex[o]=c;break;case"fs":e.fragment[o]=c;break;default:throw new Error(a)}}return e}function Nze(t,e){return{name:Fze(t,e),language:"glsl",version:Bze(t)}}function Fze(t,e="unnamed"){const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return n?n[1]:e}function Bze(t){let e=100;const r=t.match(/[^\s]+/g);if(r&&r.length>=2&&r[0]==="#version"){const n=parseInt(r[1],10);Number.isFinite(n)&&(e=n)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const Kte=`

${TS}
`,zze=`precision highp float;
`;function jze(t){const e=BN(t.modules||[]);return{source:Vze(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:Jte(e)}}function Uze(t){const{vs:e,fs:r}=t,n=BN(t.modules||[]);return{vs:rG(t.platformInfo,{...t,source:e,stage:"vertex",modules:n}),fs:rG(t.platformInfo,{...t,source:r,stage:"fragment",modules:n}),getUniforms:Jte(n)}}function Vze(t,e){const{source:r,stage:n,modules:i,hookFunctions:a=[],inject:s={},log:o}=e;FN(typeof r=="string","shader source must be a string");const c=r;let f="";const d=Zte(a),m={},b={},x={};for(const T in s){const A=typeof s[T]=="string"?{injection:s[T],order:0}:s[T],R=/^(v|f)s:(#)?([\w-]+)$/.exec(T);if(R){const F=R[2],N=R[3];F?N==="decl"?b[T]=[A]:x[T]=[A]:m[T]=[A]}else x[T]=[A]}const E=i;for(const T of E){o&&Gte(T,c,o);const A=Qte(T,"wgsl");f+=A;const R=T.injections?.[n]||{};for(const F in R){const N=/^(v|f)s:#([\w-]+)$/.exec(F);if(N){const U=N[2]==="decl"?b:x;U[F]=U[F]||[],U[F].push(R[F])}else m[F]=m[F]||[],m[F].push(R[F])}}return f+=Kte,f=iT(f,n,b),f+=Yte(d[n],m),f+=c,f=iT(f,n,x),f}function rG(t,e){const{id:r,source:n,stage:i,language:a="glsl",modules:s,defines:o={},hookFunctions:c=[],inject:f={},prologue:d=!0,log:m}=e;FN(typeof n=="string","shader source must be a string");const b=a==="glsl"?Nze(n).version:-1,x=t.shaderLanguageVersion,E=b===100?"#version 100":"#version 300 es",A=n.split(`
`).slice(1).join(`
`),R={};s.forEach(H=>{Object.assign(R,H.defines)}),Object.assign(R,o);let F="";switch(a){case"wgsl":break;case"glsl":F=d?`${E}

// ----- PROLOGUE -------------------------
${$ze({id:r,source:n,stage:i})}
${`#define SHADER_TYPE_${i.toUpperCase()}`}

${Rze(t)}
${i==="fragment"?zze:""}

// ----- APPLICATION DEFINES -------------------------

${qze(R)}

`:`${E}
`;break}const N=Zte(c),O={},U={},j={};for(const H in f){const W=typeof f[H]=="string"?{injection:f[H],order:0}:f[H],X=/^(v|f)s:(#)?([\w-]+)$/.exec(H);if(X){const oe=X[2],ee=X[3];oe?ee==="decl"?U[H]=[W]:j[H]=[W]:O[H]=[W]}else j[H]=[W]}for(const H of s){m&&Gte(H,A,m);const W=Qte(H,i);F+=W;const X=H.instance?.normalizedInjections[i]||{};for(const oe in X){const ee=/^(v|f)s:#([\w-]+)$/.exec(oe);if(ee){const ae=ee[2]==="decl"?U:j;ae[oe]=ae[oe]||[],ae[oe].push(X[oe])}else O[oe]=O[oe]||[],O[oe].push(X[oe])}}return F+="// ----- MAIN SHADER SOURCE -------------------------",F+=Kte,F=iT(F,i,U),F+=Yte(N[i],O),F+=A,F=iT(F,i,j),a==="glsl"&&b!==x&&(F=Dze(F,i)),F.trim()}function Jte(t){return function(r){const n={};for(const i of t){const a=i.getUniforms?.(r,n);Object.assign(n,a)}return n}}function $ze(t){const{id:e,source:r,stage:n}=t;return e&&r.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${e}_${n}`:""}function qze(t={}){let e="";for(const r in t){const n=t[r];(n||Number.isFinite(n))&&(e+=`#define ${r.toUpperCase()} ${t[r]}
`)}return e}function Qte(t,e){let r;switch(e){case"vertex":r=t.vs||"";break;case"fragment":r=t.fs||"";break;case"wgsl":r=t.source||"";break;default:FN(!1)}if(!t.name)throw new Error("Shader module must have a name");const n=t.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let i=`// ----- MODULE ${t.name} ---------------

`;return e!=="wgsl"&&(i+=`#define MODULE_${n}
`),i+=`${r}
`,i}const Hze=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,Gze=/^\s*\#\s*endif\s*$/;function Wze(t,e){const r=t.split(`
`),n=[];let i=!0,a=null;for(const s of r){const o=s.match(Hze),c=s.match(Gze);o?(a=o[1],i=!!e?.defines?.[a]):c?i=!0:i&&n.push(s)}return n.join(`
`)}class Rm{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return Rm.defaultShaderAssembler=Rm.defaultShaderAssembler||new Rm,Rm.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(r=>r.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const r=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==r)}addShaderHook(e,r){r&&(e=Object.assign(r,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const r=this._getModuleList(e.modules),n=this._hookFunctions,{source:i,getUniforms:a}=jze({...e,source:e.source,modules:r,hookFunctions:n});return{source:e.platformInfo.shaderLanguage==="wgsl"?Wze(i):i,getUniforms:a,modules:r}}assembleGLSLShaderPair(e){const r=this._getModuleList(e.modules),n=this._hookFunctions;return{...Uze({...e,vs:e.vs,fs:e.fs,modules:r,hookFunctions:n}),modules:r}}_getModuleList(e=[]){const r=new Array(this._defaultModules.length+e.length),n={};let i=0;for(let a=0,s=this._defaultModules.length;a<s;++a){const o=this._defaultModules[a],c=o.name;r[i++]=o,n[c]=!0}for(let a=0,s=e.length;a<s;++a){const o=e[a],c=o.name;n[c]||(r[i++]=o,n[c]=!0)}return r.length=i,aT(r),r}}const Xze=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,Yze=`#version 300 es
${Xze}`;function Zze(t){const{input:e,inputChannels:r,output:n}={};if(!e)return Yze;if(!r)throw new Error("inputChannels");const i=Kze(r),a=Jze(e,r);return`#version 300 es
in ${i} ${e};
out vec4 ${n};
void main() {
  ${n} = ${a};
}`}function Kze(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}function Jze(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}class Qze{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new H3({id:e})),this.stats.get(e)}}const ere=new Qze,gn=new e2({id:"luma.gl"}),jP={};function W3(t="id"){jP[t]=jP[t]||1;const e=jP[t]++;return`${t}-${e}`}let Eo=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,r,n){if(!e)throw new Error("no device");this._device=e,this.props=e9e(r,n);const i=this.props.id!=="undefined"?this.props.id:W3(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get(`${r}s Active`).decrementCount()}trackAllocatedMemory(e,r=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get(`${r} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").subtractCount(this.allocatedBytes),r.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${r}s Created`).incrementCount(),e.get(`${r}s Active`).incrementCount()}};function e9e(t,e){const r={...e};for(const n in t)t[n]!==void 0&&(r[n]=t[n]);return r}class jo extends Eo{static defaultProps={...Eo.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,r){const n={...r};(r.usage||0)&jo.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?n.indexType="uint32":r.data instanceof Uint16Array&&(n.indexType="uint16")),delete n.data,super(e,n,jo.defaultProps),this.usage=n.usage||0,this.indexType=n.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}readSyncWebGL(e,r){throw new Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,r,n){const i=ArrayBuffer.isView(e)?e.buffer:e,a=Math.min(e?e.byteLength:n,jo.DEBUG_DATA_MAX_LENGTH);i===null?this.debugData=new ArrayBuffer(a):r===0&&n===i.byteLength?this.debugData=i.slice(0,a):this.debugData=i.slice(r,r+a)}}function tre(t){const e=nG[t],r=t9e(e),n=t.includes("norm"),i=!n&&!t.startsWith("float"),a=t.startsWith("s");return{dataType:nG[t],byteLength:r,integer:i,signed:a,normalized:n}}function t9e(t){return r9e[t]}const nG={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},r9e={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},Xu="texture-compression-bc",bo="texture-compression-astc",rd="texture-compression-etc2",n9e="texture-compression-etc1-webgl",zw="texture-compression-pvrtc-webgl",UP="texture-compression-atc-webgl",jw="float32-renderable-webgl",VP="float16-renderable-webgl",i9e="rgb9e5ufloat-renderable-webgl",$P="snorm8-renderable-webgl",E1="norm16-renderable-webgl",qP="snorm16-renderable-webgl",Uw="float32-filterable",iG="float16-filterable-webgl";function rre(t){const e=a9e[t];if(!e)throw new Error(`Unsupported texture format ${t}`);return e}const a9e={r8unorm:{},r8snorm:{render:$P},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:$P},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:VP,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:E1},"r16snorm-webgl":{f:qP},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:$P},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:VP,filter:iG},"rg16unorm-webgl":{render:E1},"rg16snorm-webgl":{render:qP},r32uint:{},r32sint:{},r32float:{render:jw,filter:Uw},rgb9e5ufloat:{channels:"rgb",packed:!0,render:i9e},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:jw},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:E1},"rgb16snorm-webgl":{f:E1},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:Uw},rgba16uint:{},rgba16sint:{},rgba16float:{render:VP,filter:iG},"rgba16unorm-webgl":{render:E1},"rgba16snorm-webgl":{render:qP},"rgb32float-webgl":{render:jw,filter:Uw},rgba32uint:{},rgba32sint:{},rgba32float:{render:jw,filter:Uw},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:Xu},"bc1-rgb-unorm-srgb-webgl":{f:Xu},"bc1-rgba-unorm":{f:Xu},"bc1-rgba-unorm-srgb":{f:Xu},"bc2-rgba-unorm":{f:Xu},"bc2-rgba-unorm-srgb":{f:Xu},"bc3-rgba-unorm":{f:Xu},"bc3-rgba-unorm-srgb":{f:Xu},"bc4-r-unorm":{f:Xu},"bc4-r-snorm":{f:Xu},"bc5-rg-unorm":{f:Xu},"bc5-rg-snorm":{f:Xu},"bc6h-rgb-ufloat":{f:Xu},"bc6h-rgb-float":{f:Xu},"bc7-rgba-unorm":{f:Xu},"bc7-rgba-unorm-srgb":{f:Xu},"etc2-rgb8unorm":{f:rd},"etc2-rgb8unorm-srgb":{f:rd},"etc2-rgb8a1unorm":{f:rd},"etc2-rgb8a1unorm-srgb":{f:rd},"etc2-rgba8unorm":{f:rd},"etc2-rgba8unorm-srgb":{f:rd},"eac-r11unorm":{f:rd},"eac-r11snorm":{f:rd},"eac-rg11unorm":{f:rd},"eac-rg11snorm":{f:rd},"astc-4x4-unorm":{f:bo},"astc-4x4-unorm-srgb":{f:bo},"astc-5x4-unorm":{f:bo},"astc-5x4-unorm-srgb":{f:bo},"astc-5x5-unorm":{f:bo},"astc-5x5-unorm-srgb":{f:bo},"astc-6x5-unorm":{f:bo},"astc-6x5-unorm-srgb":{f:bo},"astc-6x6-unorm":{f:bo},"astc-6x6-unorm-srgb":{f:bo},"astc-8x5-unorm":{f:bo},"astc-8x5-unorm-srgb":{f:bo},"astc-8x6-unorm":{f:bo},"astc-8x6-unorm-srgb":{f:bo},"astc-8x8-unorm":{f:bo},"astc-8x8-unorm-srgb":{f:bo},"astc-10x5-unorm":{f:bo},"astc-10x5-unorm-srgb":{f:bo},"astc-10x6-unorm":{f:bo},"astc-10x6-unorm-srgb":{f:bo},"astc-10x8-unorm":{f:bo},"astc-10x8-unorm-srgb":{f:bo},"astc-10x10-unorm":{f:bo},"astc-10x10-unorm-srgb":{f:bo},"astc-12x10-unorm":{f:bo},"astc-12x10-unorm-srgb":{f:bo},"astc-12x12-unorm":{f:bo},"astc-12x12-unorm-srgb":{f:bo},"pvrtc-rgb4unorm-webgl":{f:zw},"pvrtc-rgba4unorm-webgl":{f:zw},"pvrtc-rbg2unorm-webgl":{f:zw},"pvrtc-rgba2unorm-webgl":{f:zw},"etc1-rbg-unorm-webgl":{f:n9e},"atc-rgb-unorm-webgl":{f:UP},"atc-rgba-unorm-webgl":{f:UP},"atc-rgbai-unorm-webgl":{f:UP}},o9e=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],s9e=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function nre(t){return o9e.some(e=>t.startsWith(e))}function zN(t){let e=l9e(t);if(nre(t)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;const n=u9e(t);n&&(e.blockWidth=n.blockWidth,e.blockHeight=n.blockHeight)}const r=s9e.exec(t);if(r){const[,n,i,a,s,o]=r,c=`${a}${i}`,f=tre(c),d=f.byteLength*8,m=n.length,b=[d,m>=2?d:0,m>=3?d:0,m>=4?d:0];e={format:t,attachment:e.attachment,dataType:f.dataType,components:m,channels:n,integer:f.integer,signed:f.signed,normalized:f.normalized,bitsPerChannel:b,bytesPerPixel:f.byteLength*n.length,packed:e.packed,srgb:e.srgb},o==="-webgl"&&(e.webgl=!0),s==="-srgb"&&(e.srgb=!0)}return t.endsWith("-webgl")&&(e.webgl=!0),t.endsWith("-srgb")&&(e.srgb=!0),e}function l9e(t){const e=rre(t),r=e.bytesPerPixel||1,n=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:t,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||e.channels?.length||1,bytesPerPixel:r,bitsPerChannel:n,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function u9e(t){const r=/.*-(\d+)x(\d+)-.*/.exec(t);if(r){const[,n,i]=r;return{blockWidth:Number(n),blockHeight:Number(i)}}return null}function c9e(t){const e=rre(t),r={format:t,create:e.f??!0,render:e.render??!0,filter:e.filter??!0,blend:e.blend??!0,store:e.store??!0},n=zN(t),i=t.startsWith("depth")||t.startsWith("stencil"),a=n?.signed,s=n?.integer,o=n?.webgl;return r.render&&=!a,r.filter&&=!i&&!a&&!s&&!o,r}class f9e{}class h9e{features;disabledFeatures;constructor(e=[],r){this.features=new Set(e),this.disabledFeatures=r||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class xg{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:e=>gn.error(e.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:gn.get("debug")||void 0,debugShaders:gn.get("debug-shaders")||void 0,debugFramebuffers:!!gn.get("debug-framebuffers"),debugWebGL:!!gn.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0};get[Symbol.toStringTag](){return"Device"}constructor(e){this.props={...xg.defaultProps,...e},this.id=this.props.id||W3(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=ere;timestamp=0;_reused=!1;_lumaData={};getTextureFormatCapabilities(e){const r=c9e(e),n=s=>(typeof s=="string"?this.features.has(s):s)??!0,i=n(r.create),a={format:e,create:i,render:i&&n(r.render),filter:i&&n(r.filter),blend:i&&n(r.blend),store:i&&n(r.store)};return this._getDeviceSpecificTextureFormatCapabilities(a)}isTextureFormatSupported(e,r){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return nre(e)}loseDevice(){return!1}reportError(e){this.props.onError(e)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(e={}){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,r){throw new Error("not implemented")}readPixelsToBufferWebGL(e,r){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,r){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const r={...e};return(e.usage||0)&jo.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?r.indexType="uint32":e.data instanceof Uint16Array?r.indexType="uint16":gn.warn("indices buffer content must be of integer type")()),r}}const d9e=Py()&&typeof document<"u",p9e=()=>d9e&&document.readyState==="complete",g9e="set luma.log.level=1 (or higher) to trace rendering",aG="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class f0{static defaultProps={...xg.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};static pageLoaded=m9e().then(()=>{gn.probe(2,"DOM is loaded")()});stats=ere;log=gn;VERSION="9.1.9";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw gn.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),gn.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");gn.error("This version of luma.gl has already been initialized")()}gn.log(1,`${this.VERSION} - ${g9e}`)(),globalThis.luma=this}registerAdapters(e){for(const r of e)this.preregisteredAdapters.set(r.type,r)}getSupportedAdapters(e=[]){const r=this.getAdapterMap(e);return Array.from(r).map(([,n])=>n).filter(n=>n.isSupported?.()).map(n=>n.type)}getBestAvailableAdapter(e=[]){const r=this.getAdapterMap(e);return r.get("webgpu")?.isSupported?.()?"webgpu":r.get("webgl")?.isSupported?.()?"webgl":null}setDefaultDeviceProps(e){Object.assign(f0.defaultProps,e)}async createDevice(e={}){e={...f0.defaultProps,...e},e.waitForPageLoad&&await f0.pageLoaded;const r=this.getAdapterMap(e.adapters);let n=e.type||"";n==="best-available"&&(n=this.getBestAvailableAdapter(e.adapters)||n);const s=await(this.getAdapterMap(e.adapters)||r).get(n)?.create?.(e);if(s)return s;throw new Error(aG)}async attachDevice(e){const r=this.getAdapterMap(e.adapters);let n="";e.handle instanceof WebGL2RenderingContext&&(n="webgl"),e.createCanvasContext&&await f0.pageLoaded,e.handle===null&&(n="unknown");const a=await r.get(n)?.attach?.(null);if(a)return a;throw new Error(aG)}enforceWebGL2(e=!0,r=[]){const i=this.getAdapterMap(r).get("webgl");i||gn.warn("enforceWebGL2: webgl adapter not found")(),i?.enforceWebGL2?.(e)}getAdapterMap(e=[]){const r=new Map(this.preregisteredAdapters);for(const n of e)r.set(n.type,n);return r}registerDevices(e){gn.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(const r of e){const n=r.adapter;n&&this.preregisteredAdapters.set(n.type,n)}}}const QR=new f0;function m9e(){return p9e()||typeof window>"u"?Promise.resolve():new Promise(t=>{window.addEventListener("load",()=>t())})}class y9e{}class jN{static defaultProps={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"};id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...jN.defaultProps,...e},e=this.props,!Py()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(e.canvas)typeof e.canvas=="string"?this.canvas=_9e(e.canvas):this.canvas=e.canvas;else{const r=b9e(e),n=v9e(e?.container||null);n.insertBefore(r,n.firstChild),this.canvas=r,e?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(r=>{for(const n of r)n.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(e){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(e=e===void 0?this.props.useDevicePixels:e,!e||e<=0)?1:e===!0?typeof window<"u"&&window.devicePixelRatio||1:e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),r=this.canvas;return r.parentElement?[r.clientWidth*e,r.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,r]=this.getPixelSize();return e/r}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),r=this._canvasSizeInfo.clientWidth||this.htmlCanvas?.clientWidth;return r?e/r:1}catch{return 1}}cssToDevicePixels(e,r=!0){const n=this.cssToDeviceRatio(),[i,a]=this.getDrawingBufferSize();return x9e(e,n,i,a,r)}setDevicePixelRatio(e,r={}){if(!this.htmlCanvas)return;let n="width"in r?r.width:this.htmlCanvas.clientWidth,i="height"in r?r.height:this.htmlCanvas.clientHeight;(!n||!i)&&(gn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,n=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);const a=this._canvasSizeInfo;if(a.clientWidth!==n||a.clientHeight!==i||a.devicePixelRatio!==e){let s=e;const o=Math.floor(n*s),c=Math.floor(i*s);if(this.htmlCanvas.width=o,this.htmlCanvas.height=c,this.device.gl){const[d,m]=this.getDrawingBufferSize();(d!==o||m!==c)&&(s=Math.min(d/n,m/i),this.htmlCanvas.width=Math.floor(n*s),this.htmlCanvas.height=Math.floor(i*s),gn.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=n,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=e}}}getDrawingBufferSize(){const e=this.device.gl;return e?[e.drawingBufferWidth,e.drawingBufferHeight]:this.getPixelSize()}_setAutoCreatedCanvasId(e){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}}function v9e(t){if(typeof t=="string"){const e=document.getElementById(t);if(!e)throw new Error(`${t} is not an HTML element`);return e}else if(t)return t;return document.body}function _9e(t){const e=document.getElementById(t);if(!(e instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return e}function b9e(t){const{width:e,height:r}=t,n=document.createElement("canvas");return n.id=W3("lumagl-auto-created-canvas"),n.width=e||1,n.height=r||1,n.style.width=Number.isFinite(e)?`${e}px`:"100%",n.style.height=Number.isFinite(r)?`${r}px`:"100%",n}function x9e(t,e,r,n,i){const a=t,s=oG(a[0],e,r);let o=sG(a[1],e,n,i),c=oG(a[0]+1,e,r);const f=c===r-1?c:c-1;c=sG(a[1]+1,e,n,i);let d;return i?(c=c===0?c:c+1,d=o,o=c):d=c===n-1?c:c-1,{x:s,y:o,width:Math.max(f-s+1,1),height:Math.max(d-o+1,1)}}function oG(t,e,r){return Math.min(Math.round(t*e),r-1)}function sG(t,e,r,n){return n?Math.max(0,r-1-Math.round(t*e)):Math.min(Math.round(t*e),r-1)}class xo extends Eo{static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static STORAGE=8;static RENDER_ATTACHMENT=16;static CubeFaces=["+X","-X","+Y","-Y","+Z","-Z"];static defaultProps={...Eo.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0};get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}dimension;format;width;height;depth;mipLevels;updateTimestamp;constructor(e,r){if(r=xo.normalizeProps(e,r),super(e,r,xo.defaultProps),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.props.width===void 0||this.props.height===void 0){const n=xo.getTextureDataSize(this.props.data);this.width=n?.width||1,this.height=n?.height||1}this.props.mipmaps&&this.props.mipLevels===void 0&&(this.props.mipLevels="pyramid"),this.mipLevels=this.props.mipLevels==="pyramid"?xo.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createTexture({...this.props,...e})}static isExternalImage(e){return typeof ImageData<"u"&&e instanceof ImageData||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement||typeof VideoFrame<"u"&&e instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas}static getExternalImageSize(e){if(typeof ImageData<"u"&&e instanceof ImageData||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if(typeof VideoFrame<"u"&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(e){const r=e?.data;return ArrayBuffer.isView(r)}static getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return xo.getTextureDataSize(e[0]);if(xo.isExternalImage(e))return xo.getExternalImageSize(e);if(e&&typeof e=="object"&&e.constructor===Object){const n=Object.values(e)[0];return{width:n.width,height:n.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(e,r){let n;return ArrayBuffer.isView(e)?n=[{data:e,width:r.width,height:r.height}]:Array.isArray(e)?n=e:n=[e],n}static getMipLevelCount(e,r){return Math.floor(Math.log2(Math.max(e,r)))+1}static getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1};static normalizeProps(e,r){const n={...r},i=e?.props?._resourceDefaults?.texture||{};Object.assign(n,i);const{width:a,height:s}=n;return typeof a=="number"&&(n.width=Math.max(1,Math.ceil(a))),typeof s=="number"&&(n.height=Math.max(1,Math.ceil(s))),n}}class X3 extends Eo{static defaultProps={...Eo.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0};get[Symbol.toStringTag](){return"TextureView"}constructor(e,r){super(e,r,X3.defaultProps)}}function w9e(t,e,r){let n="";const i=e.split(/\r?\n/),a=t.slice().sort((s,o)=>s.lineNum-o.lineNum);switch(r?.showSourceCode||"no"){case"all":let s=0;for(let o=1;o<=i.length;o++)for(n+=ire(i[o-1],o,r);a.length>s&&a[s].lineNum===o;){const c=a[s++];n+=lG(c,i,c.lineNum,{...r,inlineSource:!1})}return n;case"issues":case"no":for(const o of t)n+=lG(o,i,o.lineNum,{inlineSource:r?.showSourceCode!=="no"});return n}}function lG(t,e,r,n){if(n?.inlineSource){const a=S9e(e,r),s=t.linePos>0?`${" ".repeat(t.linePos+5)}^^^
`:"";return`
${a}${s}${t.type.toUpperCase()}: ${t.message}

`}const i=t.type==="error"?"red":"#8B4000";return n?.html?`<div class='luma-compiler-log-error' style="color:${i};"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function S9e(t,e,r){let n="";for(let i=e-2;i<=e;i++){const a=t[i-1];a!==void 0&&(n+=ire(a,e,r))}return n}function ire(t,e,r){const n=r?.html?T9e(t):t;return`${E9e(String(e),4)}: ${n}${r?.html?"<br/>":`
`}`}function E9e(t,e){let r="";for(let n=t.length;n<e;++n)r+=" ";return r+t}function T9e(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}class Y3 extends Eo{static defaultProps={...Eo.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0};get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,r){r={...r,debugShaders:r.debugShaders||e.props.debugShaders||"errors"},super(e,{id:C9e(r),...r},Y3.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const r=await this.getCompilationInfo();e==="warnings"&&r?.length===0||this._displayShaderLog(r)}_displayShaderLog(e){if(typeof document>"u"||!document?.createElement)return;const r=are(this.source),n=`${this.stage} ${r}`;let i=w9e(e,this.source,{showSourceCode:"all",html:!0});const a=this.getTranslatedSource();a&&(i+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${a}</pre></code>`);const s=document.createElement("Button");s.innerHTML=`
<h1>Shader Compilation Error in ${n}</h1><br /><br />
<code style="user-select:text;"><pre>
${i}
</pre></code>`,s.style.top="10px",s.style.left="10px",s.style.position="absolute",s.style.zIndex="9999",s.style.width="100%",s.style.textAlign="left",document.body.appendChild(s),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),s.onclick=()=>{const c=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(c)}}}function C9e(t){return are(t.source)||t.id||W3(`unnamed ${t.stage}-shader`)}function are(t,e="unnamed"){const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return n?n[1]:e}class ux extends Eo{static defaultProps={...Eo.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,r){r=ux.normalizeProps(e,r),super(e,r,ux.defaultProps)}static normalizeProps(e,r){const n=e?.props?._resourceDefaults?.sampler||{};return{...r,...n}}}class Z3 extends Eo{static defaultProps={...Eo.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,r={}){super(e,r,Z3.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const r=this.colorAttachments.map(i=>i.texture.clone(e)),n=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:r,depthStencilAttachment:n})}resize(e){let r=!e;if(e){const[n,i]=Array.isArray(e)?e:[e.width,e.height];r=r||i!==this.height||n!==this.width,this.width=n,this.height=i}r&&(gn.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((r,n)=>{if(typeof r=="string"){const i=this.createColorTexture(r,n);return this.attachResource(i),i.view}return r instanceof xo?r.view:r});const e=this.props.depthStencilAttachment;if(e)if(typeof e=="string"){const r=this.createDepthStencilTexture(e);this.attachResource(r),this.depthStencilAttachment=r.view}else e instanceof xo?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,r){return this.device.createTexture({id:`${this.id}-color-attachment-${r}`,usage:xo.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:xo.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(e,r){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){const i=this.colorAttachments[n].texture.clone({width:e,height:r});this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=i.view,this.attachResource(i.view)}if(this.depthStencilAttachment){const n=this.depthStencilAttachment.texture.clone({width:e,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}this.updateAttachments()}}class e_ extends Eo{static defaultProps={...Eo.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,r){super(e,r,e_.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(e){throw new Error("Use uniform blocks")}}class Am extends Eo{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;static defaultProps={...Eo.defaultProps,framebuffer:null,parameters:void 0,clearColor:Am.defaultClearColor,clearColors:void 0,clearDepth:Am.defaultClearDepth,clearStencil:Am.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0};get[Symbol.toStringTag](){return"RenderPass"}constructor(e,r){r=Am.normalizeProps(e,r),super(e,r,Am.defaultProps)}static normalizeProps(e,r){return{...e.props._resourceDefaults?.renderPass,...r}}}class oT extends Eo{static defaultProps={...Eo.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0};get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,r){super(e,r,oT.defaultProps),this.shaderLayout=r.shaderLayout}}class UN extends Eo{static defaultProps={...Eo.defaultProps,measureExecutionTime:void 0};get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,r){super(e,r,UN.defaultProps)}}class VN extends Eo{static defaultProps={...Eo.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,r){super(e,r,VN.defaultProps)}}function A9e(t){const[e,r]=P9e[t],n=e==="i32"||e==="u32",i=e!=="u32",a=M9e[e]*r,s=I9e(e,r);return{dataType:e,components:r,defaultVertexFormat:s,byteLength:a,integer:n,signed:i}}function I9e(t,e){let r;switch(t){case"f32":r="float32";break;case"i32":r="sint32";break;case"u32":r="uint32";break;case"f16":return e<=2?"float16x2":"float16x4"}return e===1?r:`${r}x${e}`}const P9e={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},M9e={f32:4,f16:2,i32:4,u32:4};function ore(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);const[r,n]=t.split("x"),i=r,a=n?parseInt(n):1,s=tre(i),o={type:i,components:a,byteLength:s.byteLength*a,integer:s.integer,signed:s.signed,normalized:s.normalized};return e&&(o.webglOnly=!0),o}function sre(t,e){const r={};for(const n of t.attributes){const i=R9e(t,e,n.name);i&&(r[n.name]=i)}return r}function k9e(t,e,r=16){const n=sre(t,e),i=new Array(r).fill(null);for(const a of Object.values(n))i[a.location]=a;return i}function R9e(t,e,r){const n=D9e(t,r),i=O9e(e,r);if(!n)return null;const a=A9e(n.type),s=i?.vertexFormat||a.defaultVertexFormat,o=ore(s);return{attributeName:i?.attributeName||n.name,bufferName:i?.bufferName||n.name,location:n.location,shaderType:n.type,shaderDataType:a.dataType,shaderComponents:a.components,vertexFormat:s,bufferDataType:o.type,bufferComponents:o.components,normalized:o.normalized,integer:a.integer,stepMode:i?.stepMode||n.stepMode||"vertex",byteOffset:i?.byteOffset||0,byteStride:i?.byteStride||0}}function D9e(t,e){const r=t.attributes.find(n=>n.name===e);return r||gn.warn(`shader layout attribute "${e}" not present in shader`),r||null}function O9e(t,e){L9e(t);let r=N9e(t,e);return r||(r=F9e(t,e),r)?r:(gn.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function L9e(t){for(const e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&gn.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function N9e(t,e){for(const r of t)if(r.format&&r.name===e)return{attributeName:r.name,bufferName:e,stepMode:r.stepMode,vertexFormat:r.format,byteOffset:0,byteStride:r.byteStride||0};return null}function F9e(t,e){for(const r of t){let n=r.byteStride;if(typeof r.byteStride!="number")for(const a of r.attributes||[]){const s=ore(a.format);n+=s.byteLength}const i=r.attributes?.find(a=>a.attribute===e);if(i)return{attributeName:i.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:n}}return null}class $N extends Eo{static defaultProps={...Eo.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,r){super(e,r,$N.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);const{shaderLayout:n,bufferLayout:i}=r.renderPipeline||{};if(!n||!i)throw new Error("VertexArray");this.attributeInfos=k9e(n,i,this.maxVertexAttributes)}setConstantWebGL(e,r){this.device.reportError(new Error("constant attributes not supported"))}}class qN extends Eo{static defaultProps={...Eo.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,r){super(e,r,qN.defaultProps)}}class HN extends Eo{static defaultProps={...Eo.defaultProps,type:void 0,count:void 0};get[Symbol.toStringTag](){return"QuerySet"}constructor(e,r){super(e,r,HN.defaultProps)}}const B9e={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function z9e(t){return B9e[t]}function j9e(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}let Vw;function lre(t){return(!Vw||Vw.byteLength<t)&&(Vw=new ArrayBuffer(t)),Vw}function U9e(t,e){const r=lre(t.BYTES_PER_ELEMENT*e);return new t(r,0,e)}function V9e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function sT(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":V9e(t)}const uG=1024;class $9e{layout={};byteLength;constructor(e){let r=0;for(const[i,a]of Object.entries(e)){const s=z9e(a),{type:o,components:c}=s;r=j9e(r,c);const f=r;r+=c,this.layout[i]={type:o,size:c,offset:f}}r+=(4-r%4)%4;const n=r*4;this.byteLength=Math.max(n,uG)}getData(e){const r=Math.max(this.byteLength,uG),n=lre(r),i={i32:new Int32Array(n),u32:new Uint32Array(n),f32:new Float32Array(n),f16:new Uint16Array(n)};for(const[a,s]of Object.entries(e)){const o=this.layout[a];if(!o){gn.warn(`Supplied uniform value ${a} not present in uniform block layout`)();continue}const{type:c,size:f,offset:d}=o,m=i[c];if(f===1){if(typeof s!="number"&&typeof s!="boolean"){gn.warn(`Supplied value for single component uniform ${a} is not a number: ${s}`)();continue}m[d]=Number(s)}else{if(!sT(s)){gn.warn(`Supplied value for multi component / array uniform ${a} is not a numeric array: ${s}`)();continue}m.set(s,d)}}return new Uint8Array(n)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function q9e(t,e,r=16){if(t!==e)return!1;const n=t,i=e;if(!sT(n))return!1;if(sT(i)&&n.length===i.length){for(let a=0;a<n.length;++a)if(i[a]!==n[a])return!1}return!0}function H9e(t){return sT(t)?t.slice():t}class G9e{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const r=e?.shaderLayout.bindings?.find(i=>i.type==="uniform"&&i.name===e?.name);if(!r)throw new Error(e?.name);const n=r;for(const i of n.uniforms||[])this.bindingLayout[i.name]=i}}setUniforms(e){for(const[r,n]of Object.entries(e))this._setUniform(r,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${r}=${n}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,r){q9e(this.uniforms[e],r)||(this.uniforms[e]=H9e(r),this.modifiedUniforms[e]=!0,this.modified=!0)}}class W9e{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(const[r,n]of Object.entries(e)){const i=r,a=new $9e(n.uniformTypes||{});this.uniformBufferLayouts.set(i,a);const s=new G9e({name:r});s.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(i,s)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[r,n]of Object.entries(e))this.uniformBlocks.get(r)?.setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const r=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(r)}createUniformBuffer(e,r,n){n&&this.setUniforms(n);const i=this.getUniformBufferByteLength(r),a=e.createBuffer({usage:jo.UNIFORM|jo.COPY_DST,byteLength:i}),s=this.getUniformBufferData(r);return a.write(s),a}getManagedUniformBuffer(e,r){if(!this.uniformBuffers.get(r)){const n=this.getUniformBufferByteLength(r),i=e.createBuffer({usage:jo.UNIFORM|jo.COPY_DST,byteLength:n});this.uniformBuffers.set(r,i)}return this.uniformBuffers.get(r)}updateUniformBuffers(){let e=!1;for(const r of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(r);e||=n}return e&&gn.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const r=this.uniformBlocks.get(e);let n=this.uniformBuffers.get(e),i=!1;if(n&&r?.needsRedraw){i||=r.needsRedraw;const a=this.getUniformBufferData(e);n=this.uniformBuffers.get(e),n?.write(a);const s=this.uniformBlocks.get(e)?.getAllUniforms();gn.log(4,`Writing to uniform buffer ${String(e)}`,a,s)()}return i}}function ure(t){const e=ArrayBuffer.isView(t)?t.constructor:t;switch(e){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(e.constructor.name)}}function cre(t){switch(t){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(t)}}function X9e(t,e,r){if(!e||e>4)throw new Error(`size ${e}`);const n=e;let i=ure(t);if(i==="uint8"&&r&&n===1)return"unorm8-webgl";if(i==="uint8"&&r&&n===3)return"unorm8x3-webgl";if(i==="uint8"||i==="sint8"){if(n===1||n===3)throw new Error(`size: ${e}`);return r&&(i=i.replace("int","norm")),`${i}x${n}`}if(i==="uint16"||i==="sint16"){if(n===1||n===3)throw new Error(`size: ${e}`);return r&&(i=i.replace("int","norm")),`${i}x${n}`}return n===1?i:`${i}x${n}`}class HP{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(r=>r.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(r=>r.attribute):[e.name]}mergeBufferLayouts(e,r){const n=[...e];for(const i of r){const a=n.findIndex(s=>s.name===i.name);a<0?n.push(i):n[a]=i}return n}getBufferIndex(e){const r=this.bufferLayouts.findIndex(n=>n.name===e);return r===-1&&gn.warn(`BufferLayout: Missing buffer for "${e}".`)(),r}}function Y9e(t,e){const r=Object.fromEntries(t.attributes.map(i=>[i.name,i.location])),n=e.slice();return n.sort((i,a)=>{const s=i.attributes?i.attributes.map(d=>d.attribute):[i.name],o=a.attributes?a.attributes.map(d=>d.attribute):[a.name],c=Math.min(...s.map(d=>r[d])),f=Math.min(...o.map(d=>r[d]));return c-f}),n}class Bf{constructor(e,r){this.name=e,this.attributes=r,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class cG{constructor(e,r,n){this.name=e,this.type=r,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class pg extends Bf{constructor(e,r){super(e,r),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class wg extends Bf{constructor(e,r){super(e,r),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}}class eD extends Bf{constructor(e,r,n){super(e,n),this.format=r}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}}class cy extends Bf{constructor(e,r,n,i){super(e,n),this.format=r,this.access=i}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}var og;(t=>{t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"})(og||(og={}));class $w{constructor(e,r,n,i,a,s,o){this.name=e,this.type=r,this.group=n,this.binding=i,this.attributes=a,this.resourceType=s,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Z9e{constructor(e,r){this.name=e,this.type=r}}class K9e{constructor(e,r,n,i){this.name=e,this.type=r,this.locationType=n,this.location=i,this.interpolation=null}}class fG{constructor(e,r,n,i){this.name=e,this.type=r,this.locationType=n,this.location=i}}class J9e{constructor(e,r,n,i){this.name=e,this.type=r,this.attributes=n,this.id=i}}class Q9e{constructor(e,r,n){this.name=e,this.type=r,this.attributes=n}}class eje{constructor(e,r=null,n){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=r,this.attributes=n}}class tje{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function rje(t){var e=(32768&t)>>15,r=(31744&t)>>10,n=1023&t;return r==0?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r==31?n?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}const fre=new Float32Array(1),nje=new Int32Array(fre.buffer),Yu=new Uint16Array(1);function ije(t){fre[0]=t;const e=nje[0],r=e>>31&1;let n=e>>23&255,i=8388607&e;if(n===255)return Yu[0]=r<<15|31744|(i!==0?512:0),Yu[0];if(n===0){if(i===0)return Yu[0]=r<<15,Yu[0];i|=8388608;let a=113;for(;!(8388608&i);)i<<=1,a--;return n=127-a,i&=8388607,n>0?(i=(i>>126-n)+(i>>127-n&1),Yu[0]=r<<15|n<<10|i>>13,Yu[0]):(Yu[0]=r<<15,Yu[0])}return n=n-127+15,n>=31?(Yu[0]=r<<15|31744,Yu[0]):n<=0?n<-10?(Yu[0]=r<<15,Yu[0]):(i=(8388608|i)>>1-n,Yu[0]=r<<15|i>>13,Yu[0]):(i>>=13,Yu[0]=r<<15|n<<10|i,Yu[0])}const GN=new Uint32Array(1),hre=new Float32Array(GN.buffer,0,1);function hG(t){const e=112+(t>>6&31)<<23|(63&t)<<17;return GN[0]=e,hre[0]}function aje(t,e,r,n,i,a,s,o,c){const f=n*(s>>=i)*(a>>=i)+r*s+e*o;switch(c){case"r8unorm":return[qa(t,f,"8unorm",1)[0]];case"r8snorm":return[qa(t,f,"8snorm",1)[0]];case"r8uint":return[qa(t,f,"8uint",1)[0]];case"r8sint":return[qa(t,f,"8sint",1)[0]];case"rg8unorm":{const d=qa(t,f,"8unorm",2);return[d[0],d[1]]}case"rg8snorm":{const d=qa(t,f,"8snorm",2);return[d[0],d[1]]}case"rg8uint":{const d=qa(t,f,"8uint",2);return[d[0],d[1]]}case"rg8sint":{const d=qa(t,f,"8sint",2);return[d[0],d[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const d=qa(t,f,"8unorm",4);return[d[0],d[1],d[2],d[3]]}case"rgba8snorm":{const d=qa(t,f,"8snorm",4);return[d[0],d[1],d[2],d[3]]}case"rgba8uint":{const d=qa(t,f,"8uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba8sint":{const d=qa(t,f,"8sint",4);return[d[0],d[1],d[2],d[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const d=qa(t,f,"8unorm",4);return[d[2],d[1],d[0],d[3]]}case"r16uint":return[qa(t,f,"16uint",1)[0]];case"r16sint":return[qa(t,f,"16sint",1)[0]];case"r16float":return[qa(t,f,"16float",1)[0]];case"rg16uint":{const d=qa(t,f,"16uint",2);return[d[0],d[1]]}case"rg16sint":{const d=qa(t,f,"16sint",2);return[d[0],d[1]]}case"rg16float":{const d=qa(t,f,"16float",2);return[d[0],d[1]]}case"rgba16uint":{const d=qa(t,f,"16uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba16sint":{const d=qa(t,f,"16sint",4);return[d[0],d[1],d[2],d[3]]}case"rgba16float":{const d=qa(t,f,"16float",4);return[d[0],d[1],d[2],d[3]]}case"r32uint":return[qa(t,f,"32uint",1)[0]];case"r32sint":return[qa(t,f,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[qa(t,f,"32float",1)[0]];case"rg32uint":{const d=qa(t,f,"32uint",2);return[d[0],d[1]]}case"rg32sint":{const d=qa(t,f,"32sint",2);return[d[0],d[1]]}case"rg32float":{const d=qa(t,f,"32float",2);return[d[0],d[1]]}case"rgba32uint":{const d=qa(t,f,"32uint",4);return[d[0],d[1],d[2],d[3]]}case"rgba32sint":{const d=qa(t,f,"32sint",4);return[d[0],d[1],d[2],d[3]]}case"rgba32float":{const d=qa(t,f,"32float",4);return[d[0],d[1],d[2],d[3]]}case"rg11b10ufloat":{const d=new Uint32Array(t.buffer,f,1)[0],m=(4192256&d)>>11,b=(4290772992&d)>>22;return[hG(2047&d),hG(m),(function(x){const E=112+(x>>5&31)<<23|(31&x)<<18;return GN[0]=E,hre[0]})(b),1]}}return null}function qa(t,e,r,n){const i=[0,0,0,0];for(let a=0;a<n;++a)switch(r){case"8unorm":i[a]=t[e]/255,e++;break;case"8snorm":i[a]=t[e]/255*2-1,e++;break;case"8uint":i[a]=t[e],e++;break;case"8sint":i[a]=t[e]-127,e++;break;case"16uint":i[a]=t[e]|t[e+1]<<8,e+=2;break;case"16sint":i[a]=(t[e]|t[e+1]<<8)-32768,e+=2;break;case"16float":i[a]=rje(t[e]|t[e+1]<<8),e+=2;break;case"32uint":case"32sint":i[a]=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24,e+=4;break;case"32float":i[a]=new Float32Array(t.buffer,e,1)[0],e+=4}return i}function ao(t,e,r,n,i){for(let a=0;a<n;++a)switch(r){case"8unorm":t[e]=255*i[a],e++;break;case"8snorm":t[e]=.5*(i[a]+1)*255,e++;break;case"8uint":t[e]=i[a],e++;break;case"8sint":t[e]=i[a]+127,e++;break;case"16uint":new Uint16Array(t.buffer,e,1)[0]=i[a],e+=2;break;case"16sint":new Int16Array(t.buffer,e,1)[0]=i[a],e+=2;break;case"16float":{const s=ije(i[a]);new Uint16Array(t.buffer,e,1)[0]=s,e+=2;break}case"32uint":new Uint32Array(t.buffer,e,1)[0]=i[a],e+=4;break;case"32sint":new Int32Array(t.buffer,e,1)[0]=i[a],e+=4;break;case"32float":new Float32Array(t.buffer,e,1)[0]=i[a],e+=4}return i}const GP={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class Qf{constructor(){this.id=Qf._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,r){if(e){r(lT.instance);for(const n of e)n instanceof Array?this.searchBlock(n,r):n.search(r);r(uT.instance)}}constEvaluate(e,r){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}Qf._id=0;class lT extends Qf{}lT.instance=new lT;class uT extends Qf{}uT.instance=new uT;const dre=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class hs extends Qf{constructor(){super()}}class cx extends hs{constructor(e,r,n,i,a,s){super(),this.calls=new Set,this.name=e,this.args=r,this.returnType=n,this.body=i,this.startLine=a,this.endLine=s}get astNodeType(){return"function"}search(e){if(this.attributes)for(const r of this.attributes)e(r);e(this);for(const r of this.args)e(r);this.searchBlock(this.body,e)}}class oje extends hs{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class pre extends hs{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class tD extends hs{constructor(e,r){super(),this.body=e,this.loopId=r}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class gre extends hs{constructor(e,r,n,i){super(),this.init=e,this.condition=r,this.increment=n,this.body=i}get astNodeType(){return"for"}search(e){var r,n,i;(r=this.init)===null||r===void 0||r.search(e),(n=this.condition)===null||n===void 0||n.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}}class sp extends hs{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"var"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}class WN extends hs{constructor(e,r,n){super(),this.attributes=null,this.name=e,this.type=r,this.value=n}get astNodeType(){return"override"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}}class wb extends hs{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"let"}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}class CS extends hs{constructor(e,r,n,i,a){super(),this.attributes=null,this.name=e,this.type=r,this.storage=n,this.access=i,this.value=a}get astNodeType(){return"const"}constEvaluate(e,r){return this.value.constEvaluate(e,r)}search(e){var r;e(this),(r=this.value)===null||r===void 0||r.search(e)}}var h0,K1,wr,ar;(t=>{t.increment="++",t.decrement="--"})(h0||(h0={})),(t=>{t.parse=function(e){const r=e;if(r=="parse")throw new Error("Invalid value for IncrementOperator");return t[r]}})(h0||(h0={}));class mre extends hs{constructor(e,r){super(),this.operator=e,this.variable=r}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(t=>{t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="})(K1||(K1={})),(t=>{t.parse=function(e){const r=e;if(r=="parse")throw new Error("Invalid value for AssignOperator");return r}})(K1||(K1={}));class yre extends hs{constructor(e,r,n){super(),this.operator=e,this.variable=r,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class XN extends hs{constructor(e,r){super(),this.name=e,this.args=r}get astNodeType(){return"call"}isBuiltin(){return dre.has(this.name)}search(e){for(const r of this.args)r.search(e);e(this)}}class vre extends hs{constructor(e,r){super(),this.body=e,this.continuing=r}get astNodeType(){return"loop"}search(e){var r;this.searchBlock(this.body,e),(r=this.continuing)===null||r===void 0||r.search(e)}}class _re extends hs{constructor(e,r){super(),this.condition=e,this.cases=r}get astNodeType(){return"switch"}search(e){e(this);for(const r of this.cases)r.search(e)}}class bre extends hs{constructor(e,r,n,i){super(),this.condition=e,this.body=r,this.elseif=n,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class xre extends hs{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var r;(r=this.value)===null||r===void 0||r.search(e)}}class sje extends hs{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class lje extends hs{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class wre extends hs{constructor(e,r){super(),this.severity=e,this.rule=r}get astNodeType(){return"diagnostic"}}class YN extends hs{constructor(e,r){super(),this.name=e,this.type=r}get astNodeType(){return"alias"}}class uje extends hs{constructor(){super()}get astNodeType(){return"discard"}}class Sre extends hs{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class Ere extends hs{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class Kr extends hs{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let r=e[0];if(r.name==="f32")return r;for(let n=1;n<e.length;++n){const i=Kr._priority.get(r.name);Kr._priority.get(e[n].name)<i&&(r=e[n])}return r.name==="x32"?Kr.i32:r}getTypeName(){return this.name}}Kr.x32=new Kr("x32"),Kr.f32=new Kr("f32"),Kr.i32=new Kr("i32"),Kr.u32=new Kr("u32"),Kr.f16=new Kr("f16"),Kr.bool=new Kr("bool"),Kr.void=new Kr("void"),Kr._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class dG extends Kr{constructor(e){super(e)}}class np extends Kr{constructor(e,r,n,i){super(e),this.members=r,this.startLine=n,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let r=0;r<this.members.length;r++)if(this.members[r].name==e)return r;return-1}search(e){for(const r of this.members)e(r)}}class cr extends Kr{constructor(e,r,n){super(e),this.format=r,this.access=n}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}cr.vec2f=new cr("vec2",Kr.f32,null),cr.vec3f=new cr("vec3",Kr.f32,null),cr.vec4f=new cr("vec4",Kr.f32,null),cr.vec2i=new cr("vec2",Kr.i32,null),cr.vec3i=new cr("vec3",Kr.i32,null),cr.vec4i=new cr("vec4",Kr.i32,null),cr.vec2u=new cr("vec2",Kr.u32,null),cr.vec3u=new cr("vec3",Kr.u32,null),cr.vec4u=new cr("vec4",Kr.u32,null),cr.vec2h=new cr("vec2",Kr.f16,null),cr.vec3h=new cr("vec3",Kr.f16,null),cr.vec4h=new cr("vec4",Kr.f16,null),cr.vec2b=new cr("vec2",Kr.bool,null),cr.vec3b=new cr("vec3",Kr.bool,null),cr.vec4b=new cr("vec4",Kr.bool,null),cr.mat2x2f=new cr("mat2x2",Kr.f32,null),cr.mat2x3f=new cr("mat2x3",Kr.f32,null),cr.mat2x4f=new cr("mat2x4",Kr.f32,null),cr.mat3x2f=new cr("mat3x2",Kr.f32,null),cr.mat3x3f=new cr("mat3x3",Kr.f32,null),cr.mat3x4f=new cr("mat3x4",Kr.f32,null),cr.mat4x2f=new cr("mat4x2",Kr.f32,null),cr.mat4x3f=new cr("mat4x3",Kr.f32,null),cr.mat4x4f=new cr("mat4x4",Kr.f32,null),cr.mat2x2h=new cr("mat2x2",Kr.f16,null),cr.mat2x3h=new cr("mat2x3",Kr.f16,null),cr.mat2x4h=new cr("mat2x4",Kr.f16,null),cr.mat3x2h=new cr("mat3x2",Kr.f16,null),cr.mat3x3h=new cr("mat3x3",Kr.f16,null),cr.mat3x4h=new cr("mat3x4",Kr.f16,null),cr.mat4x2h=new cr("mat4x2",Kr.f16,null),cr.mat4x3h=new cr("mat4x3",Kr.f16,null),cr.mat4x4h=new cr("mat4x4",Kr.f16,null),cr.mat2x2i=new cr("mat2x2",Kr.i32,null),cr.mat2x3i=new cr("mat2x3",Kr.i32,null),cr.mat2x4i=new cr("mat2x4",Kr.i32,null),cr.mat3x2i=new cr("mat3x2",Kr.i32,null),cr.mat3x3i=new cr("mat3x3",Kr.i32,null),cr.mat3x4i=new cr("mat3x4",Kr.i32,null),cr.mat4x2i=new cr("mat4x2",Kr.i32,null),cr.mat4x3i=new cr("mat4x3",Kr.i32,null),cr.mat4x4i=new cr("mat4x4",Kr.i32,null),cr.mat2x2u=new cr("mat2x2",Kr.u32,null),cr.mat2x3u=new cr("mat2x3",Kr.u32,null),cr.mat2x4u=new cr("mat2x4",Kr.u32,null),cr.mat3x2u=new cr("mat3x2",Kr.u32,null),cr.mat3x3u=new cr("mat3x3",Kr.u32,null),cr.mat3x4u=new cr("mat3x4",Kr.u32,null),cr.mat4x2u=new cr("mat4x2",Kr.u32,null),cr.mat4x3u=new cr("mat4x3",Kr.u32,null),cr.mat4x4u=new cr("mat4x4",Kr.u32,null);class AS extends Kr{constructor(e,r,n,i){super(e),this.storage=r,this.type=n,this.access=i}get astNodeType(){return"pointer"}}class Sb extends Kr{constructor(e,r,n,i){super(e),this.attributes=r,this.format=n,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class J1 extends Kr{constructor(e,r,n){super(e),this.format=r,this.access=n}get astNodeType(){return"sampler"}}class Fh extends Qf{constructor(){super(),this.postfix=null}}class fy extends Fh{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class od extends Fh{constructor(e,r){super(),this.type=e,this.args=r}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const r of this.args)r.search(e)}constEvaluate(e,r){return r&&(r[0]=this.type),e.evalExpression(this,e.context)}}class ZN extends Fh{constructor(e,r){super(),this.cachedReturnValue=null,this.name=e,this.args=r}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return dre.has(this.name)}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){for(const r of this.args)r.search(e);e(this)}}class rf extends Fh{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,r){return e.evalExpression(this,e.context)}}class Tre extends Fh{constructor(e,r){super(),this.name=e,this.initializer=r}get astNodeType(){return"constExpr"}constEvaluate(e,r){if(this.initializer){const n=e.evalExpression(this.initializer,e.context);return n!==null&&this.postfix?n.getSubData(e,this.postfix,e.context):n}return null}search(e){this.initializer.search(e)}}class Ol extends Fh{constructor(e,r){super(),this.value=e,this.type=r}get astNodeType(){return"literalExpr"}constEvaluate(e,r){return r!==void 0&&(r[0]=this.type),this.value}get isScalar(){return this.value instanceof ir}get isVector(){return this.value instanceof Mt||this.value instanceof Ii}get scalarValue(){return this.value instanceof ir?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof Mt||this.value instanceof Ii?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class Cre extends Fh{constructor(e,r){super(),this.type=e,this.value=r}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class t_ extends Fh{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Are extends Fh{constructor(){super()}}class Sl extends Are{constructor(e,r){super(),this.operator=e,this.right=r}get astNodeType(){return"unaryOp"}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class mh extends Are{constructor(e,r,n){super(),this.operator=e,this.left=r,this.right=n}get astNodeType(){return"binaryOp"}_getPromotedType(e,r){return e.name===r.name?e:e.name==="f32"||r.name==="f32"?Kr.f32:e.name==="u32"||r.name==="u32"?Kr.u32:Kr.i32}constEvaluate(e,r){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class Ire extends Qf{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class IS extends Fh{constructor(){super()}get astNodeType(){return"default"}}class Pre extends Ire{constructor(e,r){super(r),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class Mre extends Ire{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class pG extends Qf{constructor(e,r,n){super(),this.name=e,this.type=r,this.attributes=n}get astNodeType(){return"argument"}}class cje extends Qf{constructor(e,r){super(),this.condition=e,this.body=r}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class gG extends Qf{constructor(e,r,n){super(),this.name=e,this.type=r,this.attributes=n}get astNodeType(){return"member"}}class kre extends Qf{constructor(e,r){super(),this.name=e,this.value=r}get astNodeType(){return"attribute"}}class Zf{constructor(e,r){this.parent=null,this.typeInfo=e,this.parent=r,this.id=Zf._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,r,n,i){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,r,n){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}}Zf._id=0;class rD extends Zf{constructor(){super(new Bf("void",null),null)}toString(){return"void"}}rD.void=new rD;class Av extends Zf{constructor(e){super(new eD("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,r,n,i){this.reference.setDataValue(e,r,n,i)}getSubData(e,r,n){return r?this.reference.getSubData(e,r,n):this}toString(){return`&${this.reference.toString()}`}}class ir extends Zf{constructor(e,r,n=null){super(r,n),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",r)}clone(){if(this.data instanceof Float32Array)return new ir(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new ir(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new ir(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,r,n,i){if(n)return void console.error("SetDataValue: Scalar data does not support postfix",n);if(!(r instanceof ir))return void console.error("SetDataValue: Invalid value",r);let a=r.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?a=Math.floor(a):this.typeInfo.name==="bool"&&(a=a?1:0),this.data[0]=a}getSubData(e,r,n){return r?(console.error("getSubData: Scalar data does not support postfix",r),null):this}toString(){return`${this.value}`}}function fje(t,e,r){const n=e.length;return n===2?r==="f32"?new Mt(new Float32Array(e),t.getTypeInfo("vec2f")):r==="i32"||r==="bool"?new Mt(new Int32Array(e),t.getTypeInfo("vec2i")):r==="u32"?new Mt(new Uint32Array(e),t.getTypeInfo("vec2u")):r==="f16"?new Mt(new Float32Array(e),t.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${r}`),null):n===3?r==="f32"?new Mt(new Float32Array(e),t.getTypeInfo("vec3f")):r==="i32"||r==="bool"?new Mt(new Int32Array(e),t.getTypeInfo("vec3i")):r==="u32"?new Mt(new Uint32Array(e),t.getTypeInfo("vec3u")):r==="f16"?new Mt(new Float32Array(e),t.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${r}`),null):n===4?r==="f32"?new Mt(new Float32Array(e),t.getTypeInfo("vec4f")):r==="i32"||r==="bool"?new Mt(new Int32Array(e),t.getTypeInfo("vec4i")):r==="u32"?new Mt(new Uint32Array(e),t.getTypeInfo("vec4u")):r==="f16"?new Mt(new Float32Array(e),t.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${r}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}class Mt extends Zf{constructor(e,r,n=null){if(super(r,n),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const i=this.typeInfo.name;i==="vec2f"||i==="vec3f"||i==="vec4f"?this.data=new Float32Array(e):i==="vec2i"||i==="vec3i"||i==="vec4i"?this.data=new Int32Array(e):i==="vec2u"||i==="vec3u"||i==="vec4u"?this.data=new Uint32Array(e):i==="vec2h"||i==="vec3h"||i==="vec4h"?this.data=new Float32Array(e):i==="vec2b"||i==="vec3b"||i==="vec4b"?this.data=new Int32Array(e):i==="vec2"||i==="vec3"||i==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${i}`)}}clone(){if(this.data instanceof Float32Array)return new Mt(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new Mt(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new Mt(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,r,n,i){n instanceof fy?console.error("TODO: Set vector postfix"):r instanceof Mt?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,n){if(r===null)return this;let i=e.getTypeInfo("f32");if(this.typeInfo instanceof cy)i=this.typeInfo.format||i;else{const s=this.typeInfo.name;s==="vec2f"||s==="vec3f"||s==="vec4f"?i=e.getTypeInfo("f32"):s==="vec2i"||s==="vec3i"||s==="vec4i"?i=e.getTypeInfo("i32"):s==="vec2b"||s==="vec3b"||s==="vec4b"?i=e.getTypeInfo("bool"):s==="vec2u"||s==="vec3u"||s==="vec4u"?i=e.getTypeInfo("u32"):s==="vec2h"||s==="vec3h"||s==="vec4h"?i=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${s}`)}let a=this;for(;r!==null&&a!==null;){if(r instanceof t_){const s=r.index;let o=-1;if(s instanceof Ol){if(!(s.value instanceof ir))return console.error(`GetSubData: Invalid array index ${s.value}`),null;o=s.value.value}else{const c=e.evalExpression(s,n);if(!(c instanceof ir))return console.error("GetSubData: Unknown index type",s),null;o=c.value}if(o<0||o>=a.data.length)return console.error("GetSubData: Index out of range",o),null;if(a.data instanceof Float32Array){const c=new Float32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new ir(c,i)}if(a.data instanceof Int32Array){const c=new Int32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new ir(c,i)}if(a.data instanceof Uint32Array){const c=new Uint32Array(a.data.buffer,a.data.byteOffset+4*o,1);return new ir(c,i)}throw"GetSubData: Invalid data type"}if(!(r instanceof fy))return console.error("GetSubData: Unknown postfix",r),null;{const s=r.value.toLowerCase();if(s.length===1){let c=0;if(s==="x"||s==="r")c=0;else if(s==="y"||s==="g")c=1;else if(s==="z"||s==="b")c=2;else{if(s!=="w"&&s!=="a")return console.error(`GetSubData: Unknown member ${s}`),null;c=3}if(this.data instanceof Float32Array){let f=new Float32Array(this.data.buffer,this.data.byteOffset+4*c,1);return new ir(f,i,this)}if(this.data instanceof Int32Array){let f=new Int32Array(this.data.buffer,this.data.byteOffset+4*c,1);return new ir(f,i,this)}if(this.data instanceof Uint32Array){let f=new Uint32Array(this.data.buffer,this.data.byteOffset+4*c,1);return new ir(f,i,this)}}const o=[];for(const c of s)c==="x"||c==="r"?o.push(this.data[0]):c==="y"||c==="g"?o.push(this.data[1]):c==="z"||c==="b"?o.push(this.data[2]):c==="w"||c==="a"?o.push(this.data[3]):console.error(`GetDataValue: Unknown member ${c}`);a=fje(e,o,i.name)}r=r.postfix}return a}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}}class Ii extends Zf{constructor(e,r,n=null){super(r,n),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new Ii(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,r,n,i){n instanceof fy?console.error("TODO: Set matrix postfix"):r instanceof Ii?this.data=r.data:console.error("SetDataValue: Invalid value",r)}getSubData(e,r,n){if(r===null)return this;const i=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof cy)this.typeInfo.format;else if(i.endsWith("f"))e.getTypeInfo("f32");else if(i.endsWith("i"))e.getTypeInfo("i32");else if(i.endsWith("u"))e.getTypeInfo("u32");else{if(!i.endsWith("h"))return console.error(`GetDataValue: Unknown type ${i}`),null;e.getTypeInfo("f16")}if(r instanceof t_){const a=r.index;let s=-1;if(a instanceof Ol){if(!(a.value instanceof ir))return console.error(`GetDataValue: Invalid array index ${a.value}`),null;s=a.value.value}else{const f=e.evalExpression(a,n);if(!(f instanceof ir))return console.error("GetDataValue: Unknown index type",a),null;s=f.value}if(s<0||s>=this.data.length)return console.error("GetDataValue: Index out of range",s),null;const o=i.endsWith("h")?"h":"f";let c;if(i==="mat2x2"||i==="mat2x2f"||i==="mat2x2h"||i==="mat3x2"||i==="mat3x2f"||i==="mat3x2h"||i==="mat4x2"||i==="mat4x2f"||i==="mat4x2h")c=new Mt(new Float32Array(this.data.buffer,this.data.byteOffset+2*s*4,2),e.getTypeInfo(`vec2${o}`));else if(i==="mat2x3"||i==="mat2x3f"||i==="mat2x3h"||i==="mat3x3"||i==="mat3x3f"||i==="mat3x3h"||i==="mat4x3"||i==="mat4x3f"||i==="mat4x3h")c=new Mt(new Float32Array(this.data.buffer,this.data.byteOffset+3*s*4,3),e.getTypeInfo(`vec3${o}`));else{if(i!=="mat2x4"&&i!=="mat2x4f"&&i!=="mat2x4h"&&i!=="mat3x4"&&i!=="mat3x4f"&&i!=="mat3x4h"&&i!=="mat4x4"&&i!=="mat4x4f"&&i!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${i}`),null;c=new Mt(new Float32Array(this.data.buffer,this.data.byteOffset+4*s*4,4),e.getTypeInfo(`vec4${o}`))}return r.postfix?c.getSubData(e,r.postfix,n):c}return console.error("GetDataValue: Invalid postfix",r),null}toString(){let e=`${this.data[0]}`;for(let r=1;r<this.data.length;++r)e+=`, ${this.data[r]}`;return e}}class Us extends Zf{constructor(e,r,n=0,i=null){super(r,i),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=n}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new Us(e.buffer,this.typeInfo,0,null)}setDataValue(e,r,n,i){if(r===null)return void console.log("setDataValue: NULL data.");let a=this.offset,s=this.typeInfo;for(;n;){if(n instanceof t_)if(s instanceof wg){const o=n.index;if(o instanceof Ol){if(!(o.value instanceof ir))return void console.error(`SetDataValue: Invalid index type ${o.value}`);a+=o.value.value*s.stride}else{const c=e.evalExpression(o,i);if(!(c instanceof ir))return void console.error("SetDataValue: Unknown index type",o);a+=c.value*s.stride}s=s.format}else console.error(`SetDataValue: Type ${s.getTypeName()} is not an array`);else{if(!(n instanceof fy))return void console.error("SetDataValue: Unknown postfix type",n);{const o=n.value;if(s instanceof pg){let c=!1;for(const f of s.members)if(f.name===o){a+=f.offset,s=f.type,c=!0;break}if(!c)return void console.error(`SetDataValue: Member ${o} not found`)}else if(s instanceof Bf){const c=s.getTypeName();let f=0;if(o==="x"||o==="r")f=0;else if(o==="y"||o==="g")f=1;else if(o==="z"||o==="b")f=2;else{if(o!=="w"&&o!=="a")return void console.error(`SetDataValue: Unknown member ${o}`);f=3}if(!(r instanceof ir))return void console.error("SetDataValue: Invalid value",r);const d=r.value;return c==="vec2f"?void(new Float32Array(this.buffer,a,2)[f]=d):c==="vec3f"?void(new Float32Array(this.buffer,a,3)[f]=d):c==="vec4f"?void(new Float32Array(this.buffer,a,4)[f]=d):c==="vec2i"?void(new Int32Array(this.buffer,a,2)[f]=d):c==="vec3i"?void(new Int32Array(this.buffer,a,3)[f]=d):c==="vec4i"?void(new Int32Array(this.buffer,a,4)[f]=d):c==="vec2u"?void(new Uint32Array(this.buffer,a,2)[f]=d):c==="vec3u"?void(new Uint32Array(this.buffer,a,3)[f]=d):c==="vec4u"?void(new Uint32Array(this.buffer,a,4)[f]=d):void console.error(`SetDataValue: Type ${c} is not a struct`)}}}n=n.postfix}this.setData(e,r,s,a,i)}setData(e,r,n,i,a){const s=n.getTypeName();if(s!=="f32"&&s!=="f16")if(s!=="i32"&&s!=="atomic<i32>"&&s!=="x32")if(s!=="u32"&&s!=="atomic<u32>")if(s!=="bool"){if(s==="vec2f"||s==="vec2h"){const o=new Float32Array(this.buffer,i,2);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3f"||s==="vec3h"){const o=new Float32Array(this.buffer,i,3);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4f"||s==="vec4h"){const o=new Float32Array(this.buffer,i,4);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2i"){const o=new Int32Array(this.buffer,i,2);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3i"){const o=new Int32Array(this.buffer,i,3);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4i"){const o=new Int32Array(this.buffer,i,4);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2u"){const o=new Uint32Array(this.buffer,i,2);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3u"){const o=new Uint32Array(this.buffer,i,3);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4u"){const o=new Uint32Array(this.buffer,i,4);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="vec2b"){const o=new Uint32Array(this.buffer,i,2);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1]):(o[0]=r[0],o[1]=r[1]))}if(s==="vec3b"){const o=new Uint32Array(this.buffer,i,3);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2]):(o[0]=r[0],o[1]=r[1],o[2]=r[2]))}if(s==="vec4b"){const o=new Uint32Array(this.buffer,i,4);return void(r instanceof Mt?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="mat2x2f"||s==="mat2x2h"){const o=new Float32Array(this.buffer,i,4);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3]))}if(s==="mat2x3f"||s==="mat2x3h"){const o=new Float32Array(this.buffer,i,6);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5]))}if(s==="mat2x4f"||s==="mat2x4h"){const o=new Float32Array(this.buffer,i,8);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7]))}if(s==="mat3x2f"||s==="mat3x2h"){const o=new Float32Array(this.buffer,i,6);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5]))}if(s==="mat3x3f"||s==="mat3x3h"){const o=new Float32Array(this.buffer,i,9);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8]))}if(s==="mat3x4f"||s==="mat3x4h"){const o=new Float32Array(this.buffer,i,12);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11]))}if(s==="mat4x2f"||s==="mat4x2h"){const o=new Float32Array(this.buffer,i,8);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7]))}if(s==="mat4x3f"||s==="mat4x3h"){const o=new Float32Array(this.buffer,i,12);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11]))}if(s==="mat4x4f"||s==="mat4x4h"){const o=new Float32Array(this.buffer,i,16);return void(r instanceof Ii?(o[0]=r.data[0],o[1]=r.data[1],o[2]=r.data[2],o[3]=r.data[3],o[4]=r.data[4],o[5]=r.data[5],o[6]=r.data[6],o[7]=r.data[7],o[8]=r.data[8],o[9]=r.data[9],o[10]=r.data[10],o[11]=r.data[11],o[12]=r.data[12],o[13]=r.data[13],o[14]=r.data[14],o[15]=r.data[15]):(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]))}if(r instanceof Us){if(n===r.typeInfo)return void new Uint8Array(this.buffer,i,r.buffer.byteLength).set(new Uint8Array(r.buffer));console.error("SetDataValue: Type mismatch",s,r.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${s}`)}else r instanceof ir&&(new Int32Array(this.buffer,i,1)[0]=r.value);else r instanceof ir&&(new Uint32Array(this.buffer,i,1)[0]=r.value);else r instanceof ir&&(new Int32Array(this.buffer,i,1)[0]=r.value);else r instanceof ir&&(new Float32Array(this.buffer,i,1)[0]=r.value)}getSubData(e,r,n){var i,a,s;if(r===null)return this;let o=this.offset,c=this.typeInfo;for(;r;){if(r instanceof t_){const d=r.index,m=d instanceof Fh?e.evalExpression(d,n):d;let b=0;if(m instanceof ir?b=m.value:typeof m=="number"?b=m:console.error("GetDataValue: Invalid index type",d),c instanceof wg)o+=b*c.stride,c=c.format;else{const x=c.getTypeName();x==="mat4x4"||x==="mat4x4f"||x==="mat4x4h"?(o+=16*b,c=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${c.getTypeName()} is not an array`)}}else{if(!(r instanceof fy))return console.error("GetDataValue: Unknown postfix type",r),null;{const d=r.value;if(c instanceof pg){let m=!1;for(const b of c.members)if(b.name===d){o+=b.offset,c=b.type,m=!0;break}if(!m)return console.error(`GetDataValue: Member ${d} not found`),null}else if(c instanceof Bf){const m=c.getTypeName();if(m==="vec2f"||m==="vec3f"||m==="vec4f"||m==="vec2i"||m==="vec3i"||m==="vec4i"||m==="vec2u"||m==="vec3u"||m==="vec4u"||m==="vec2b"||m==="vec3b"||m==="vec4b"||m==="vec2h"||m==="vec3h"||m==="vec4h"||m==="vec2"||m==="vec3"||m==="vec4"){if(d.length>0&&d.length<5){let b="f";const x=[];for(let E=0;E<d.length;++E){const T=d[E].toLowerCase();let A=0;if(T==="x"||T==="r")A=0;else if(T==="y"||T==="g")A=1;else if(T==="z"||T==="b")A=2;else{if(T!=="w"&&T!=="a")return console.error(`Unknown member ${d}`),null;A=3}if(d.length===1){if(m.endsWith("f"))return this.buffer.byteLength<o+4*A+4?(console.log("Insufficient buffer data"),null):new ir(new Float32Array(this.buffer,o+4*A,1),e.getTypeInfo("f32"),this);if(m.endsWith("h"))return new ir(new Float32Array(this.buffer,o+4*A,1),e.getTypeInfo("f16"),this);if(m.endsWith("i"))return new ir(new Int32Array(this.buffer,o+4*A,1),e.getTypeInfo("i32"),this);if(m.endsWith("b"))return new ir(new Int32Array(this.buffer,o+4*A,1),e.getTypeInfo("bool"),this);if(m.endsWith("u"))return new ir(new Uint32Array(this.buffer,o+4*A,1),e.getTypeInfo("i32"),this)}if(m==="vec2f")x.push(new Float32Array(this.buffer,o,2)[A]);else if(m==="vec3f"){if(o+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const R=new Float32Array(this.buffer,o,3);x.push(R[A])}else if(m==="vec4f")x.push(new Float32Array(this.buffer,o,4)[A]);else if(m==="vec2i")b="i",x.push(new Int32Array(this.buffer,o,2)[A]);else if(m==="vec3i")b="i",x.push(new Int32Array(this.buffer,o,3)[A]);else if(m==="vec4i")b="i",x.push(new Int32Array(this.buffer,o,4)[A]);else if(m==="vec2u"){b="u";const R=new Uint32Array(this.buffer,o,2);x.push(R[A])}else m==="vec3u"?(b="u",x.push(new Uint32Array(this.buffer,o,3)[A])):m==="vec4u"&&(b="u",x.push(new Uint32Array(this.buffer,o,4)[A]))}return x.length===2?c=e.getTypeInfo(`vec2${b}`):x.length===3?c=e.getTypeInfo(`vec3${b}`):x.length===4?c=e.getTypeInfo(`vec4${b}`):console.error(`GetDataValue: Invalid vector length ${x.length}`),new Mt(x,c,null)}return console.error(`GetDataValue: Unknown member ${d}`),null}return console.error(`GetDataValue: Type ${m} is not a struct`),null}}}r=r.postfix}const f=c.getTypeName();return f==="f32"?new ir(new Float32Array(this.buffer,o,1),c,this):f==="i32"?new ir(new Int32Array(this.buffer,o,1),c,this):f==="u32"?new ir(new Uint32Array(this.buffer,o,1),c,this):f==="vec2f"?new Mt(new Float32Array(this.buffer,o,2),c,this):f==="vec3f"?new Mt(new Float32Array(this.buffer,o,3),c,this):f==="vec4f"?new Mt(new Float32Array(this.buffer,o,4),c,this):f==="vec2i"?new Mt(new Int32Array(this.buffer,o,2),c,this):f==="vec3i"?new Mt(new Int32Array(this.buffer,o,3),c,this):f==="vec4i"?new Mt(new Int32Array(this.buffer,o,4),c,this):f==="vec2u"?new Mt(new Uint32Array(this.buffer,o,2),c,this):f==="vec3u"?new Mt(new Uint32Array(this.buffer,o,3),c,this):f==="vec4u"?new Mt(new Uint32Array(this.buffer,o,4),c,this):c instanceof cy&&c.name==="atomic"?((i=c.format)===null||i===void 0?void 0:i.name)==="u32"?new ir(new Uint32Array(this.buffer,o,1)[0],c.format,this):((a=c.format)===null||a===void 0?void 0:a.name)==="i32"?new ir(new Int32Array(this.buffer,o,1)[0],c.format,this):(console.error(`GetDataValue: Invalid atomic format ${(s=c.format)===null||s===void 0?void 0:s.name}`),null):new Us(this.buffer,c,o,this)}toString(){let e="";if(this.typeInfo instanceof wg)if(this.typeInfo.format.name==="f32"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="i32"){const r=new Int32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="u32"){const r=new Uint32Array(this.buffer,this.offset);e=`[${r[0]}`;for(let n=1;n<r.length;++n)e+=`, ${r[n]}`}else if(this.typeInfo.format.name==="vec2f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}]`;for(let n=1;n<r.length/2;++n)e+=`, [${r[2*n]}, ${r[2*n+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}]`;for(let n=4;n<r.length;n+=4)e+=`, [${r[n]}, ${r[n+1]}, ${r[n+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const r=new Float32Array(this.buffer,this.offset);e=`[${r[0]}, ${r[1]}, ${r[2]}, ${r[3]}]`;for(let n=4;n<r.length;n+=4)e+=`, [${r[n]}, ${r[n+1]}, ${r[n+2]}, ${r[n+3]}]`}else e="[...]";else this.typeInfo instanceof pg?e+="{...}":e="[...]";return e}}class ip extends Zf{constructor(e,r,n,i){super(r,null),this.data=e,this.descriptor=n,this.view=i}clone(){return new ip(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>0?(e=n[0])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.width)!==null&&r!==void 0?r:0}get height(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>1?(e=n[1])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.height)!==null&&r!==void 0?r:0}get depthOrArrayLayers(){var e,r;const n=this.descriptor.size;return n instanceof Array&&n.length>2?(e=n[2])!==null&&e!==void 0?e:0:n instanceof Object&&(r=n.depthOrArrayLayers)!==null&&r!==void 0?r:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const r=[this.width,this.height,this.depthOrArrayLayers];for(let n=0;n<r.length;++n)r[n]=Math.max(1,r[n]>>e);return r}get texelByteSize(){const e=this.format,r=GP[e];return r?r.isDepthStencil?4:r.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,r=GP[e];return!!r&&r.isDepthStencil}getGpuSize(){const e=this.format,r=GP[e],n=this.width;if(!e||n<=0||!r)return-1;const i=this.height,a=this.depthOrArrayLayers,s=this.dimension;return n/r.blockWidth*(s==="1d"?1:i/r.blockHeight)*r.bytesPerBlock*a}getPixel(e,r,n=0,i=0){const a=this.texelByteSize,s=this.bytesPerRow,o=this.height,c=this.data[i];return aje(new Uint8Array(c),e,r,n,i,o,s,a,this.format)}setPixel(e,r,n,i,a){const s=this.texelByteSize,o=this.bytesPerRow,c=this.height,f=this.data[i];(function(d,m,b,x,E,T,A,R,F,N){const O=x*(A>>=E)*(T>>=E)+b*A+m*R;switch(F){case"r8unorm":return void ao(d,O,"8unorm",1,N);case"r8snorm":return void ao(d,O,"8snorm",1,N);case"r8uint":return void ao(d,O,"8uint",1,N);case"r8sint":return void ao(d,O,"8sint",1,N);case"rg8unorm":return void ao(d,O,"8unorm",2,N);case"rg8snorm":return void ao(d,O,"8snorm",2,N);case"rg8uint":return void ao(d,O,"8uint",2,N);case"rg8sint":return void ao(d,O,"8sint",2,N);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void ao(d,O,"8unorm",4,N);case"rgba8snorm":return void ao(d,O,"8snorm",4,N);case"rgba8uint":return void ao(d,O,"8uint",4,N);case"rgba8sint":return void ao(d,O,"8sint",4,N);case"r16uint":return void ao(d,O,"16uint",1,N);case"r16sint":return void ao(d,O,"16sint",1,N);case"r16float":return void ao(d,O,"16float",1,N);case"rg16uint":return void ao(d,O,"16uint",2,N);case"rg16sint":return void ao(d,O,"16sint",2,N);case"rg16float":return void ao(d,O,"16float",2,N);case"rgba16uint":return void ao(d,O,"16uint",4,N);case"rgba16sint":return void ao(d,O,"16sint",4,N);case"rgba16float":return void ao(d,O,"16float",4,N);case"r32uint":return void ao(d,O,"32uint",1,N);case"r32sint":return void ao(d,O,"32sint",1,N);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void ao(d,O,"32float",1,N);case"rg32uint":return void ao(d,O,"32uint",2,N);case"rg32sint":return void ao(d,O,"32sint",2,N);case"rg32float":return void ao(d,O,"32float",2,N);case"rgba32uint":return void ao(d,O,"32uint",4,N);case"rgba32sint":return void ao(d,O,"32sint",4,N);case"rgba32float":return void ao(d,O,"32float",4,N);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(f),e,r,n,i,c,o,s,this.format,a)}}(t=>{t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"})(ar||(ar={}));class or{constructor(e,r,n){this.name=e,this.type=r,this.rule=n}toString(){return this.name}}class vt{}wr=vt,vt.none=new or("",ar.reserved,""),vt.eof=new or("EOF",ar.token,""),vt.reserved={asm:new or("asm",ar.reserved,"asm"),bf16:new or("bf16",ar.reserved,"bf16"),do:new or("do",ar.reserved,"do"),enum:new or("enum",ar.reserved,"enum"),f16:new or("f16",ar.reserved,"f16"),f64:new or("f64",ar.reserved,"f64"),handle:new or("handle",ar.reserved,"handle"),i8:new or("i8",ar.reserved,"i8"),i16:new or("i16",ar.reserved,"i16"),i64:new or("i64",ar.reserved,"i64"),mat:new or("mat",ar.reserved,"mat"),premerge:new or("premerge",ar.reserved,"premerge"),regardless:new or("regardless",ar.reserved,"regardless"),typedef:new or("typedef",ar.reserved,"typedef"),u8:new or("u8",ar.reserved,"u8"),u16:new or("u16",ar.reserved,"u16"),u64:new or("u64",ar.reserved,"u64"),unless:new or("unless",ar.reserved,"unless"),using:new or("using",ar.reserved,"using"),vec:new or("vec",ar.reserved,"vec"),void:new or("void",ar.reserved,"void")},vt.keywords={array:new or("array",ar.keyword,"array"),atomic:new or("atomic",ar.keyword,"atomic"),bool:new or("bool",ar.keyword,"bool"),f32:new or("f32",ar.keyword,"f32"),i32:new or("i32",ar.keyword,"i32"),mat2x2:new or("mat2x2",ar.keyword,"mat2x2"),mat2x3:new or("mat2x3",ar.keyword,"mat2x3"),mat2x4:new or("mat2x4",ar.keyword,"mat2x4"),mat3x2:new or("mat3x2",ar.keyword,"mat3x2"),mat3x3:new or("mat3x3",ar.keyword,"mat3x3"),mat3x4:new or("mat3x4",ar.keyword,"mat3x4"),mat4x2:new or("mat4x2",ar.keyword,"mat4x2"),mat4x3:new or("mat4x3",ar.keyword,"mat4x3"),mat4x4:new or("mat4x4",ar.keyword,"mat4x4"),ptr:new or("ptr",ar.keyword,"ptr"),sampler:new or("sampler",ar.keyword,"sampler"),sampler_comparison:new or("sampler_comparison",ar.keyword,"sampler_comparison"),struct:new or("struct",ar.keyword,"struct"),texture_1d:new or("texture_1d",ar.keyword,"texture_1d"),texture_2d:new or("texture_2d",ar.keyword,"texture_2d"),texture_2d_array:new or("texture_2d_array",ar.keyword,"texture_2d_array"),texture_3d:new or("texture_3d",ar.keyword,"texture_3d"),texture_cube:new or("texture_cube",ar.keyword,"texture_cube"),texture_cube_array:new or("texture_cube_array",ar.keyword,"texture_cube_array"),texture_multisampled_2d:new or("texture_multisampled_2d",ar.keyword,"texture_multisampled_2d"),texture_storage_1d:new or("texture_storage_1d",ar.keyword,"texture_storage_1d"),texture_storage_2d:new or("texture_storage_2d",ar.keyword,"texture_storage_2d"),texture_storage_2d_array:new or("texture_storage_2d_array",ar.keyword,"texture_storage_2d_array"),texture_storage_3d:new or("texture_storage_3d",ar.keyword,"texture_storage_3d"),texture_depth_2d:new or("texture_depth_2d",ar.keyword,"texture_depth_2d"),texture_depth_2d_array:new or("texture_depth_2d_array",ar.keyword,"texture_depth_2d_array"),texture_depth_cube:new or("texture_depth_cube",ar.keyword,"texture_depth_cube"),texture_depth_cube_array:new or("texture_depth_cube_array",ar.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new or("texture_depth_multisampled_2d",ar.keyword,"texture_depth_multisampled_2d"),texture_external:new or("texture_external",ar.keyword,"texture_external"),u32:new or("u32",ar.keyword,"u32"),vec2:new or("vec2",ar.keyword,"vec2"),vec3:new or("vec3",ar.keyword,"vec3"),vec4:new or("vec4",ar.keyword,"vec4"),bitcast:new or("bitcast",ar.keyword,"bitcast"),block:new or("block",ar.keyword,"block"),break:new or("break",ar.keyword,"break"),case:new or("case",ar.keyword,"case"),continue:new or("continue",ar.keyword,"continue"),continuing:new or("continuing",ar.keyword,"continuing"),default:new or("default",ar.keyword,"default"),diagnostic:new or("diagnostic",ar.keyword,"diagnostic"),discard:new or("discard",ar.keyword,"discard"),else:new or("else",ar.keyword,"else"),enable:new or("enable",ar.keyword,"enable"),fallthrough:new or("fallthrough",ar.keyword,"fallthrough"),false:new or("false",ar.keyword,"false"),fn:new or("fn",ar.keyword,"fn"),for:new or("for",ar.keyword,"for"),function:new or("function",ar.keyword,"function"),if:new or("if",ar.keyword,"if"),let:new or("let",ar.keyword,"let"),const:new or("const",ar.keyword,"const"),loop:new or("loop",ar.keyword,"loop"),while:new or("while",ar.keyword,"while"),private:new or("private",ar.keyword,"private"),read:new or("read",ar.keyword,"read"),read_write:new or("read_write",ar.keyword,"read_write"),return:new or("return",ar.keyword,"return"),requires:new or("requires",ar.keyword,"requires"),storage:new or("storage",ar.keyword,"storage"),switch:new or("switch",ar.keyword,"switch"),true:new or("true",ar.keyword,"true"),alias:new or("alias",ar.keyword,"alias"),type:new or("type",ar.keyword,"type"),uniform:new or("uniform",ar.keyword,"uniform"),var:new or("var",ar.keyword,"var"),override:new or("override",ar.keyword,"override"),workgroup:new or("workgroup",ar.keyword,"workgroup"),write:new or("write",ar.keyword,"write"),r8unorm:new or("r8unorm",ar.keyword,"r8unorm"),r8snorm:new or("r8snorm",ar.keyword,"r8snorm"),r8uint:new or("r8uint",ar.keyword,"r8uint"),r8sint:new or("r8sint",ar.keyword,"r8sint"),r16uint:new or("r16uint",ar.keyword,"r16uint"),r16sint:new or("r16sint",ar.keyword,"r16sint"),r16float:new or("r16float",ar.keyword,"r16float"),rg8unorm:new or("rg8unorm",ar.keyword,"rg8unorm"),rg8snorm:new or("rg8snorm",ar.keyword,"rg8snorm"),rg8uint:new or("rg8uint",ar.keyword,"rg8uint"),rg8sint:new or("rg8sint",ar.keyword,"rg8sint"),r32uint:new or("r32uint",ar.keyword,"r32uint"),r32sint:new or("r32sint",ar.keyword,"r32sint"),r32float:new or("r32float",ar.keyword,"r32float"),rg16uint:new or("rg16uint",ar.keyword,"rg16uint"),rg16sint:new or("rg16sint",ar.keyword,"rg16sint"),rg16float:new or("rg16float",ar.keyword,"rg16float"),rgba8unorm:new or("rgba8unorm",ar.keyword,"rgba8unorm"),rgba8unorm_srgb:new or("rgba8unorm_srgb",ar.keyword,"rgba8unorm_srgb"),rgba8snorm:new or("rgba8snorm",ar.keyword,"rgba8snorm"),rgba8uint:new or("rgba8uint",ar.keyword,"rgba8uint"),rgba8sint:new or("rgba8sint",ar.keyword,"rgba8sint"),bgra8unorm:new or("bgra8unorm",ar.keyword,"bgra8unorm"),bgra8unorm_srgb:new or("bgra8unorm_srgb",ar.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new or("rgb10a2unorm",ar.keyword,"rgb10a2unorm"),rg11b10float:new or("rg11b10float",ar.keyword,"rg11b10float"),rg32uint:new or("rg32uint",ar.keyword,"rg32uint"),rg32sint:new or("rg32sint",ar.keyword,"rg32sint"),rg32float:new or("rg32float",ar.keyword,"rg32float"),rgba16uint:new or("rgba16uint",ar.keyword,"rgba16uint"),rgba16sint:new or("rgba16sint",ar.keyword,"rgba16sint"),rgba16float:new or("rgba16float",ar.keyword,"rgba16float"),rgba32uint:new or("rgba32uint",ar.keyword,"rgba32uint"),rgba32sint:new or("rgba32sint",ar.keyword,"rgba32sint"),rgba32float:new or("rgba32float",ar.keyword,"rgba32float"),static_assert:new or("static_assert",ar.keyword,"static_assert")},vt.tokens={decimal_float_literal:new or("decimal_float_literal",ar.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new or("hex_float_literal",ar.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new or("int_literal",ar.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new or("uint_literal",ar.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new or("name",ar.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new or("ident",ar.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new or("and",ar.token,"&"),and_and:new or("and_and",ar.token,"&&"),arrow:new or("arrow ",ar.token,"->"),attr:new or("attr",ar.token,"@"),forward_slash:new or("forward_slash",ar.token,"/"),bang:new or("bang",ar.token,"!"),bracket_left:new or("bracket_left",ar.token,"["),bracket_right:new or("bracket_right",ar.token,"]"),brace_left:new or("brace_left",ar.token,"{"),brace_right:new or("brace_right",ar.token,"}"),colon:new or("colon",ar.token,":"),comma:new or("comma",ar.token,","),equal:new or("equal",ar.token,"="),equal_equal:new or("equal_equal",ar.token,"=="),not_equal:new or("not_equal",ar.token,"!="),greater_than:new or("greater_than",ar.token,">"),greater_than_equal:new or("greater_than_equal",ar.token,">="),shift_right:new or("shift_right",ar.token,">>"),less_than:new or("less_than",ar.token,"<"),less_than_equal:new or("less_than_equal",ar.token,"<="),shift_left:new or("shift_left",ar.token,"<<"),modulo:new or("modulo",ar.token,"%"),minus:new or("minus",ar.token,"-"),minus_minus:new or("minus_minus",ar.token,"--"),period:new or("period",ar.token,"."),plus:new or("plus",ar.token,"+"),plus_plus:new or("plus_plus",ar.token,"++"),or:new or("or",ar.token,"|"),or_or:new or("or_or",ar.token,"||"),paren_left:new or("paren_left",ar.token,"("),paren_right:new or("paren_right",ar.token,")"),semicolon:new or("semicolon",ar.token,";"),star:new or("star",ar.token,"*"),tilde:new or("tilde",ar.token,"~"),underscore:new or("underscore",ar.token,"_"),xor:new or("xor",ar.token,"^"),plus_equal:new or("plus_equal",ar.token,"+="),minus_equal:new or("minus_equal",ar.token,"-="),times_equal:new or("times_equal",ar.token,"*="),division_equal:new or("division_equal",ar.token,"/="),modulo_equal:new or("modulo_equal",ar.token,"%="),and_equal:new or("and_equal",ar.token,"&="),or_equal:new or("or_equal",ar.token,"|="),xor_equal:new or("xor_equal",ar.token,"^="),shift_right_equal:new or("shift_right_equal",ar.token,">>="),shift_left_equal:new or("shift_left_equal",ar.token,"<<=")},vt.simpleTokens={"@":wr.tokens.attr,"{":wr.tokens.brace_left,"}":wr.tokens.brace_right,":":wr.tokens.colon,",":wr.tokens.comma,"(":wr.tokens.paren_left,")":wr.tokens.paren_right,";":wr.tokens.semicolon},vt.literalTokens={"&":wr.tokens.and,"&&":wr.tokens.and_and,"->":wr.tokens.arrow,"/":wr.tokens.forward_slash,"!":wr.tokens.bang,"[":wr.tokens.bracket_left,"]":wr.tokens.bracket_right,"=":wr.tokens.equal,"==":wr.tokens.equal_equal,"!=":wr.tokens.not_equal,">":wr.tokens.greater_than,">=":wr.tokens.greater_than_equal,">>":wr.tokens.shift_right,"<":wr.tokens.less_than,"<=":wr.tokens.less_than_equal,"<<":wr.tokens.shift_left,"%":wr.tokens.modulo,"-":wr.tokens.minus,"--":wr.tokens.minus_minus,".":wr.tokens.period,"+":wr.tokens.plus,"++":wr.tokens.plus_plus,"|":wr.tokens.or,"||":wr.tokens.or_or,"*":wr.tokens.star,"~":wr.tokens.tilde,_:wr.tokens.underscore,"^":wr.tokens.xor,"+=":wr.tokens.plus_equal,"-=":wr.tokens.minus_equal,"*=":wr.tokens.times_equal,"/=":wr.tokens.division_equal,"%=":wr.tokens.modulo_equal,"&=":wr.tokens.and_equal,"|=":wr.tokens.or_equal,"^=":wr.tokens.xor_equal,">>=":wr.tokens.shift_right_equal,"<<=":wr.tokens.shift_left_equal},vt.regexTokens={decimal_float_literal:wr.tokens.decimal_float_literal,hex_float_literal:wr.tokens.hex_float_literal,int_literal:wr.tokens.int_literal,uint_literal:wr.tokens.uint_literal,ident:wr.tokens.ident},vt.storage_class=[wr.keywords.function,wr.keywords.private,wr.keywords.workgroup,wr.keywords.uniform,wr.keywords.storage],vt.access_mode=[wr.keywords.read,wr.keywords.write,wr.keywords.read_write],vt.sampler_type=[wr.keywords.sampler,wr.keywords.sampler_comparison],vt.sampled_texture_type=[wr.keywords.texture_1d,wr.keywords.texture_2d,wr.keywords.texture_2d_array,wr.keywords.texture_3d,wr.keywords.texture_cube,wr.keywords.texture_cube_array],vt.multisampled_texture_type=[wr.keywords.texture_multisampled_2d],vt.storage_texture_type=[wr.keywords.texture_storage_1d,wr.keywords.texture_storage_2d,wr.keywords.texture_storage_2d_array,wr.keywords.texture_storage_3d],vt.depth_texture_type=[wr.keywords.texture_depth_2d,wr.keywords.texture_depth_2d_array,wr.keywords.texture_depth_cube,wr.keywords.texture_depth_cube_array,wr.keywords.texture_depth_multisampled_2d],vt.texture_external_type=[wr.keywords.texture_external],vt.any_texture_type=[...wr.sampled_texture_type,...wr.multisampled_texture_type,...wr.storage_texture_type,...wr.depth_texture_type,...wr.texture_external_type],vt.texel_format=[wr.keywords.r8unorm,wr.keywords.r8snorm,wr.keywords.r8uint,wr.keywords.r8sint,wr.keywords.r16uint,wr.keywords.r16sint,wr.keywords.r16float,wr.keywords.rg8unorm,wr.keywords.rg8snorm,wr.keywords.rg8uint,wr.keywords.rg8sint,wr.keywords.r32uint,wr.keywords.r32sint,wr.keywords.r32float,wr.keywords.rg16uint,wr.keywords.rg16sint,wr.keywords.rg16float,wr.keywords.rgba8unorm,wr.keywords.rgba8unorm_srgb,wr.keywords.rgba8snorm,wr.keywords.rgba8uint,wr.keywords.rgba8sint,wr.keywords.bgra8unorm,wr.keywords.bgra8unorm_srgb,wr.keywords.rgb10a2unorm,wr.keywords.rg11b10float,wr.keywords.rg32uint,wr.keywords.rg32sint,wr.keywords.rg32float,wr.keywords.rgba16uint,wr.keywords.rgba16sint,wr.keywords.rgba16float,wr.keywords.rgba32uint,wr.keywords.rgba32sint,wr.keywords.rgba32float],vt.const_literal=[wr.tokens.int_literal,wr.tokens.uint_literal,wr.tokens.decimal_float_literal,wr.tokens.hex_float_literal,wr.keywords.true,wr.keywords.false],vt.literal_or_ident=[wr.tokens.ident,wr.tokens.int_literal,wr.tokens.uint_literal,wr.tokens.decimal_float_literal,wr.tokens.hex_float_literal,wr.tokens.name],vt.element_count_expression=[wr.tokens.int_literal,wr.tokens.uint_literal,wr.tokens.ident],vt.template_types=[wr.keywords.vec2,wr.keywords.vec3,wr.keywords.vec4,wr.keywords.mat2x2,wr.keywords.mat2x3,wr.keywords.mat2x4,wr.keywords.mat3x2,wr.keywords.mat3x3,wr.keywords.mat3x4,wr.keywords.mat4x2,wr.keywords.mat4x3,wr.keywords.mat4x4,wr.keywords.atomic,wr.keywords.bitcast,...wr.any_texture_type],vt.attribute_name=[wr.tokens.ident,wr.keywords.block,wr.keywords.diagnostic],vt.assignment_operators=[wr.tokens.equal,wr.tokens.plus_equal,wr.tokens.minus_equal,wr.tokens.times_equal,wr.tokens.division_equal,wr.tokens.modulo_equal,wr.tokens.and_equal,wr.tokens.or_equal,wr.tokens.xor_equal,wr.tokens.shift_right_equal,wr.tokens.shift_left_equal],vt.increment_operators=[wr.tokens.plus_plus,wr.tokens.minus_minus];class mG{constructor(e,r,n,i,a){this.type=e,this.lexeme=r,this.line=n,this.start=i,this.end=a}toString(){return this.lexeme}isTemplateType(){return vt.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==vt.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class hje{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new mG(vt.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let s=1;for(;s>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),s--,s==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),s++)}return!0}}const r=vt.simpleTokens[e];if(r)return this._addToken(r),!0;let n=vt.none;const i=this._isAlpha(e),a=e==="_";if(this._isAlphaNumeric(e)){let s=this._peekAhead();for(;this._isAlphaNumeric(s);)e+=this._advance(),s=this._peekAhead()}if(i){const s=vt.keywords[e];if(s)return this._addToken(s),!0}if(i||a)return this._addToken(vt.tokens.ident),!0;for(;;){let s=this._findType(e);const o=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(o=="=")return this._current++,e+=o,this._addToken(vt.tokens.minus_equal),!0;if(o=="-")return this._current++,e+=o,this._addToken(vt.tokens.minus_minus),!0;const c=this._tokens.length-1;if((vt.literal_or_ident.indexOf(this._tokens[c].type)!=-1||this._tokens[c].type==vt.tokens.paren_right)&&o!=">")return this._addToken(s),!0}if(e==">"&&(o==">"||o=="=")){let c=!1,f=this._tokens.length-1;for(let d=0;d<5&&f>=0&&vt.assignment_operators.indexOf(this._tokens[f].type)===-1;++d,--f)if(this._tokens[f].type===vt.tokens.less_than){f>0&&this._tokens[f-1].isArrayOrTemplateType()&&(c=!0);break}if(c)return this._addToken(s),!0}if(s===vt.none){let c=e,f=0;const d=2;for(let m=0;m<d;++m)if(c+=this._peekAhead(m),s=this._findType(c),s!==vt.none){f=m;break}if(s===vt.none)return n!==vt.none&&(this._current--,this._addToken(n),!0);e=c,this._current+=f+1}if(n=s,this._isAtEnd())break;e+=this._advance()}return n!==vt.none&&(this._addToken(n),!0)}_findType(e){for(const n in vt.regexTokens){const i=vt.regexTokens[n];if(this._match(e,i.rule))return i}return vt.literalTokens[e]||vt.none}_match(e,r){const n=r.exec(e);return n&&n.index==0&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let r=this._source[this._current];return e=e||0,e++,this._current+=e,r}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const r=this._source.substring(this._start,this._current);this._tokens.push(new mG(e,r,this._line,this._start,this._current))}}function On(t){return Array.isArray(t)||t?.buffer instanceof ArrayBuffer}const cT=new Float32Array(1),dje=new Uint32Array(cT.buffer),pje=new Uint32Array(cT.buffer),fT=new Int32Array(1),gje=new Float32Array(fT.buffer),mje=new Uint32Array(fT.buffer),hT=new Uint32Array(1),yje=new Float32Array(hT.buffer),vje=new Int32Array(hT.buffer);function yG(t,e,r){if(e===r)return t;if(e==="f32"){if(r==="i32"||r==="x32")return cT[0]=t,dje[0];if(r==="u32")return cT[0]=t,pje[0]}else if(e==="i32"||e==="x32"){if(r==="f32")return fT[0]=t,gje[0];if(r==="u32")return fT[0]=t,mje[0]}else if(e==="u32"){if(r==="f32")return hT[0]=t,yje[0];if(r==="i32"||r==="x32")return hT[0]=t,vje[0]}return console.error(`Unsupported cast from ${e} to ${r}`),t}class _je{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class qw{constructor(e,r){this.align=e,this.size=r}}class dd{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new tje,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const r of e)r instanceof cx&&this._functions.set(r.name,new _je(r));for(const r of e)if(r instanceof np){const n=this.getTypeInfo(r,null);n instanceof pg&&this.structs.push(n)}for(const r of e)if(r instanceof YN)this.aliases.push(this._getAliasInfo(r));else{if(r instanceof WN){const n=r,i=this._getAttributeNum(n.attributes,"id",0),a=n.type!=null?this.getTypeInfo(n.type,n.attributes):null;this.overrides.push(new J9e(n.name,a,n.attributes,i));continue}if(this._isUniformVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=new $w(n.name,s,i,a,n.attributes,og.Uniform,n.access);o.access||(o.access="read"),this.uniforms.push(o);continue}if(this._isStorageVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(s),c=new $w(n.name,s,i,a,n.attributes,o?og.StorageTexture:og.Storage,n.access);c.access||(c.access="read"),this.storage.push(c);continue}if(this._isTextureVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(s),c=new $w(n.name,s,i,a,n.attributes,o?og.StorageTexture:og.Texture,n.access);c.access||(c.access="read"),o?this.storage.push(c):this.textures.push(c);continue}if(this._isSamplerVar(r)){const n=r,i=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),s=this.getTypeInfo(n.type,n.attributes),o=new $w(n.name,s,i,a,n.attributes,og.Sampler,n.access);this.samplers.push(o);continue}}for(const r of e)if(r instanceof cx){const n=this._getAttribute(r,"vertex"),i=this._getAttribute(r,"fragment"),a=this._getAttribute(r,"compute"),s=n||i||a,o=new eje(r.name,s?.name,r.attributes);o.attributes=r.attributes,o.startLine=r.startLine,o.endLine=r.endLine,this.functions.push(o),this._functions.get(r.name).info=o,s&&(this._functions.get(r.name).inUse=!0,o.inUse=!0,o.resources=this._findResources(r,!!s),o.inputs=this._getInputs(r.args),o.outputs=this._getOutputs(r.returnType),this.entry[s.name].push(o)),o.arguments=r.args.map(c=>new Q9e(c.name,this.getTypeInfo(c.type,c.attributes),c.attributes)),o.returnType=r.returnType?this.getTypeInfo(r.returnType,r.attributes):null;continue}for(const r of this._functions.values())r.info&&(r.info.inUse=r.inUse,this._addCalls(r.node,r.info.calls));for(const r of this._functions.values())r.node.search(n=>{var i,a,s;if(n instanceof kre){if(n.value)if(On(n.value))for(const o of n.value)for(const c of this.overrides)o===c.name&&((i=r.info)===null||i===void 0||i.overrides.push(c));else for(const o of this.overrides)n.value===o.name&&((a=r.info)===null||a===void 0||a.overrides.push(o))}else if(n instanceof rf)for(const o of this.overrides)n.name===o.name&&((s=r.info)===null||s===void 0||s.overrides.push(o))});for(const r of this.uniforms)this._markStructsInUse(r.type);for(const r of this.storage)this._markStructsInUse(r.type)}getFunctionInfo(e){for(const r of this.functions)if(r.name==e)return r;return null}getStructInfo(e){for(const r of this.structs)if(r.name==e)return r;return null}getOverrideInfo(e){for(const r of this.overrides)if(r.name==e)return r;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const r of e.members)this._markStructsInUse(r.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const r=this._getAlias(e.name);r&&this._markStructsInUse(r)}}_addCalls(e,r){var n;for(const i of e.calls){const a=(n=this._functions.get(i.name))===null||n===void 0?void 0:n.info;a&&r.add(a)}}findResource(e,r,n){if(n){for(const i of this.entry.compute)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}for(const i of this.entry.vertex)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}for(const i of this.entry.fragment)if(i.name===n){for(const a of i.resources)if(a.group==e&&a.binding==r)return a}}for(const i of this.uniforms)if(i.group==e&&i.binding==r)return i;for(const i of this.storage)if(i.group==e&&i.binding==r)return i;for(const i of this.textures)if(i.group==e&&i.binding==r)return i;for(const i of this.samplers)if(i.group==e&&i.binding==r)return i;return null}_findResource(e){for(const r of this.uniforms)if(r.name==e)return r;for(const r of this.storage)if(r.name==e)return r;for(const r of this.textures)if(r.name==e)return r;for(const r of this.samplers)if(r.name==e)return r;return null}_markStructsFromAST(e){const r=this.getTypeInfo(e,null);this._markStructsInUse(r)}_findResources(e,r){const n=[],i=this,a=[];return e.search(s=>{if(s instanceof lT)a.push({});else if(s instanceof uT)a.pop();else if(s instanceof sp){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type),a.length>0&&(a[a.length-1][o.name]=o)}else if(s instanceof od){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type)}else if(s instanceof wb){const o=s;r&&o.type!==null&&this._markStructsFromAST(o.type),a.length>0&&(a[a.length-1][o.name]=o)}else if(s instanceof rf){const o=s;if(a.length>0&&a[a.length-1][o.name])return;const c=i._findResource(o.name);c&&n.push(c)}else if(s instanceof ZN){const o=s,c=i._functions.get(o.name);c&&(r&&(c.inUse=!0),e.calls.add(c.node),c.resources===null&&(c.resources=i._findResources(c.node,r)),n.push(...c.resources))}else if(s instanceof XN){const o=s,c=i._functions.get(o.name);c&&(r&&(c.inUse=!0),e.calls.add(c.node),c.resources===null&&(c.resources=i._findResources(c.node,r)),n.push(...c.resources))}}),[...new Map(n.map(s=>[s.name,s])).values()]}getBindGroups(){const e=[];function r(n,i){n>=e.length&&(e.length=n+1),e[n]===void 0&&(e[n]=[]),i>=e[n].length&&(e[n].length=i+1)}for(const n of this.uniforms)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.storage)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.textures)r(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.samplers)r(n.group,n.binding),e[n.group][n.binding]=n;return e}_getOutputs(e,r=void 0){if(r===void 0&&(r=[]),e instanceof np)this._getStructOutputs(e,r);else{const n=this._getOutputInfo(e);n!==null&&r.push(n)}return r}_getStructOutputs(e,r){for(const n of e.members)if(n.type instanceof np)this._getStructOutputs(n.type,r);else{const i=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(i!==null){const a=this.getTypeInfo(n.type,n.type.attributes),s=this._parseInt(i.value),o=new fG(n.name,a,i.name,s);r.push(o)}}}_getOutputInfo(e){const r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){const n=this.getTypeInfo(e,e.attributes),i=this._parseInt(r.value);return new fG("",n,r.name,i)}return null}_getInputs(e,r=void 0){r===void 0&&(r=[]);for(const n of e)if(n.type instanceof np)this._getStructInputs(n.type,r);else{const i=this._getInputInfo(n);i!==null&&r.push(i)}return r}_getStructInputs(e,r){for(const n of e.members)if(n.type instanceof np)this._getStructInputs(n.type,r);else{const i=this._getInputInfo(n);i!==null&&r.push(i)}}_getInputInfo(e){const r=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(r!==null){const n=this._getAttribute(e,"interpolation"),i=this.getTypeInfo(e.type,e.attributes),a=this._parseInt(r.value),s=new K9e(e.name,i,r.name,a);return n!==null&&(s.interpolation=this._parseString(n.value)),s}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const r=parseInt(e);return isNaN(r)?e:r}_getAlias(e){for(const r of this.aliases)if(r.name==e)return r.type;return null}_getAliasInfo(e){return new Z9e(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const r of this.structs)if(r.name==e)return r;for(const r of this.aliases)if(r.name==e)return r.type;return null}getTypeInfo(e,r=null){if(this._types.has(e))return this._types.get(e);if(e instanceof AS){const i=e.type?this.getTypeInfo(e.type,e.attributes):null,a=new eD(e.name,i,r);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof Sb){const i=e,a=i.format?this.getTypeInfo(i.format,i.attributes):null,s=new wg(i.name,r);return s.format=a,s.count=i.count,this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof np){const i=e,a=new pg(i.name,r);a.startLine=i.startLine,a.endLine=i.endLine;for(const s of i.members){const o=this.getTypeInfo(s.type,s.attributes);a.members.push(new cG(s.name,o,s.attributes))}return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof J1){const i=e,a=i.format instanceof Kr,s=i.format?a?this.getTypeInfo(i.format,null):new Bf(i.format,null):null,o=new cy(i.name,s,r,i.access);return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof cr){const i=e,a=i.format?this.getTypeInfo(i.format,null):null,s=new cy(i.name,a,r,i.access);return this._types.set(e,s),this._updateTypeInfo(s),s}const n=new Bf(e.name,r);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var r,n,i;const a=this._getTypeSize(e);if(e.size=(r=a?.size)!==null&&r!==void 0?r:0,e instanceof wg&&e.format){const s=this._getTypeSize(e.format);e.stride=Math.max((n=s?.size)!==null&&n!==void 0?n:0,(i=s?.align)!==null&&i!==void 0?i:0),this._updateTypeInfo(e.format)}e instanceof eD&&this._updateTypeInfo(e.format),e instanceof pg&&this._updateStructInfo(e)}_updateStructInfo(e){var r;let n=0,i=0,a=0,s=0;for(let o=0,c=e.members.length;o<c;++o){const f=e.members[o],d=this._getTypeSize(f);if(!d)continue;(r=this._getAlias(f.type.name))!==null&&r!==void 0||f.type;const m=d.align,b=d.size;n=this._roundUp(m,n+i),i=b,a=n,s=Math.max(s,m),f.offset=n,f.size=b,this._updateTypeInfo(f.type)}e.size=this._roundUp(s,a+i),e.align=s}_getTypeSize(e){var r,n;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),a=this._getAttributeNum(e.attributes,"align",0);if(e instanceof cG&&(e=e.type),e instanceof Bf){const s=this._getAlias(e.name);s!==null&&(e=s)}{const s=dd._typeInfo[e.name];if(s!==void 0){const o=((r=e.format)===null||r===void 0?void 0:r.name)==="f16"?2:1;return new qw(Math.max(a,s.align/o),Math.max(i,s.size/o))}}{const s=dd._typeInfo[e.name.substring(0,e.name.length-1)];if(s){const o=e.name[e.name.length-1]==="h"?2:1;return new qw(Math.max(a,s.align/o),Math.max(i,s.size/o))}}if(e instanceof wg){let s=e,o=8,c=8;const f=this._getTypeSize(s.format);return f!==null&&(c=f.size,o=f.align),c=s.count*this._getAttributeNum((n=e?.attributes)!==null&&n!==void 0?n:null,"stride",this._roundUp(o,c)),i&&(c=i),new qw(Math.max(a,o),Math.max(i,c))}if(e instanceof pg){let s=0,o=0,c=0,f=0,d=0;for(const m of e.members){const b=this._getTypeSize(m.type);b!==null&&(s=Math.max(b.align,s),c=this._roundUp(b.align,c+f),f=b.size,d=c)}return o=this._roundUp(s,d+f),new qw(Math.max(a,s),Math.max(i,o))}return null}_isUniformVar(e){return e instanceof sp&&e.storage=="uniform"}_isStorageVar(e){return e instanceof sp&&e.storage=="storage"}_isTextureVar(e){return e instanceof sp&&e.type!==null&&dd._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof sp&&e.type!==null&&dd._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,r){const n=e;if(!n||!n.attributes)return null;const i=n.attributes;for(let a of i)if(a.name==r)return a;return null}_getAttributeNum(e,r,n){if(e===null)return n;for(let i of e)if(i.name==r){let a=i!==null&&i.value!==null?i.value:n;return a instanceof Array&&(a=a[0]),typeof a=="number"?a:typeof a=="string"?parseInt(a):n}return n}_roundUp(e,r){return Math.ceil(r/e)*e}}dd._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},dd._textureTypes=vt.any_texture_type.map(t=>t.name),dd._samplerTypes=vt.sampler_type.map(t=>t.name);let KN=0;class JN{constructor(e,r,n){this.id=KN++,this.name=e,this.value=r,this.node=n}clone(){return new JN(this.name,this.value,this.node)}}class QN{constructor(e){this.id=KN++,this.name=e.name,this.node=e}clone(){return new QN(this.node)}}class e6{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=KN++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var r;return this.variables.has(e)?(r=this.variables.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var r;return this.functions.has(e)?(r=this.functions.get(e))!==null&&r!==void 0?r:null:this.parent?this.parent.getFunction(e):null}createVariable(e,r,n){this.variables.set(e,new JN(e,r,n??null))}setVariable(e,r,n){const i=this.getVariable(e);i!==null?i.value=r:this.createVariable(e,r,n)}getVariableValue(e){var r;const n=this.getVariable(e);return(r=n?.value)!==null&&r!==void 0?r:null}clone(){return new e6(this)}}class bje{evalExpression(e,r){return null}getTypeInfo(e){return null}getVariableName(e,r){return""}}class xje{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,r){const n=this.exec.evalExpression(e.args[0],r);let i=!0;if(n instanceof Mt)return n.data.forEach(a=>{a||(i=!1)}),new ir(i?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt){const i=n.data.some(a=>a);return new ir(i?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,r){const n=this.exec.evalExpression(e.args[2],r);if(!(n instanceof ir))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return n.value?this.exec.evalExpression(e.args[1],r):this.exec.evalExpression(e.args[0],r)}ArrayLength(e,r){let n=e.args[0];n instanceof Sl&&(n=n.right);const i=this.exec.evalExpression(n,r);if(i instanceof Us&&i.typeInfo.size===0){const a=i.typeInfo,s=i.buffer.byteLength/a.stride;return new ir(s,this.getTypeInfo("u32"))}return new ir(i.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.abs(a)),n.typeInfo);const i=n;return new ir(Math.abs(i.value),i.typeInfo)}Acos(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.acos(a)),n.typeInfo);const i=n;return new ir(Math.acos(i.value),n.typeInfo)}Acosh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.acosh(a)),n.typeInfo);const i=n;return new ir(Math.acosh(i.value),n.typeInfo)}Asin(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.asin(a)),n.typeInfo);const i=n;return new ir(Math.asin(i.value),n.typeInfo)}Asinh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.asinh(a)),n.typeInfo);const i=n;return new ir(Math.asinh(i.value),n.typeInfo)}Atan(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.atan(a)),n.typeInfo);const i=n;return new ir(Math.atan(i.value),n.typeInfo)}Atanh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.atanh(a)),n.typeInfo);const i=n;return new ir(Math.atanh(i.value),n.typeInfo)}Atan2(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Mt&&i instanceof Mt)return new Mt(n.data.map((o,c)=>Math.atan2(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.atan2(a.value,s.value),n.typeInfo)}Ceil(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.ceil(a)),n.typeInfo);const i=n;return new ir(Math.ceil(i.value),n.typeInfo)}_clamp(e,r,n){return Math.min(Math.max(e,r),n)}Clamp(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof Mt&&i instanceof Mt&&a instanceof Mt)return new Mt(n.data.map((f,d)=>this._clamp(f,i.data[d],a.data[d])),n.typeInfo);const s=n,o=i,c=a;return new ir(this._clamp(s.value,o.value,c.value),n.typeInfo)}Cos(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.cos(a)),n.typeInfo);const i=n;return new ir(Math.cos(i.value),n.typeInfo)}Cosh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.cosh(a)),n.typeInfo);const i=n;return new ir(Math.cos(i.value),n.typeInfo)}CountLeadingZeros(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.clz32(a)),n.typeInfo);const i=n;return new ir(Math.clz32(i.value),n.typeInfo)}_countOneBits(e){let r=0;for(;e!==0;)1&e&&r++,e>>=1;return r}CountOneBits(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>this._countOneBits(a)),n.typeInfo);const i=n;return new ir(this._countOneBits(i.value),n.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let r=0;for(;!(1&e);)e>>=1,r++;return r}CountTrailingZeros(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>this._countTrailingZeros(a)),n.typeInfo);const i=n;return new ir(this._countTrailingZeros(i.value),n.typeInfo)}Cross(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Mt&&i instanceof Mt){if(n.data.length!==3||i.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const a=n.data,s=i.data;return new Mt([a[1]*s[2]-s[1]*a[2],a[2]*s[0]-s[2]*a[0],a[0]*s[1]-s[0]*a[1]],n.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,r){const n=this.exec.evalExpression(e.args[0],r),i=180/Math.PI;return n instanceof Mt?new Mt(n.data.map(a=>a*i),n.typeInfo):new ir(n.value*i,this.getTypeInfo("f32"))}Determinant(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Ii){const i=n.data,a=n.typeInfo.getTypeName(),s=a.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(a==="mat2x2"||a==="mat2x2f"||a==="mat2x2h")return new ir(i[0]*i[3]-i[1]*i[2],s);if(a==="mat2x3"||a==="mat2x3f"||a==="mat2x3h")return new ir(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);if(a==="mat2x4"||a==="mat2x4f"||a==="mat2x4h")console.error(`TODO: Determinant for ${a}`);else if(a==="mat3x2"||a==="mat3x2f"||a==="mat3x2h")console.error(`TODO: Determinant for ${a}`);else{if(a==="mat3x3"||a==="mat3x3f"||a==="mat3x3h")return new ir(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),s);a==="mat3x4"||a==="mat3x4f"||a==="mat3x4h"||a==="mat4x2"||a==="mat4x2f"||a==="mat4x2h"||a==="mat4x3"||a==="mat4x3f"||a==="mat4x3h"?console.error(`TODO: Determinant for ${a}`):a!=="mat4x4"&&a!=="mat4x4f"&&a!=="mat4x4h"||console.error(`TODO: Determinant for ${a}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Mt&&i instanceof Mt){let o=0;for(let c=0;c<n.data.length;++c)o+=(n.data[c]-i.data[c])*(n.data[c]-i.data[c]);return new ir(Math.sqrt(o),this.getTypeInfo("f32"))}const a=n,s=i;return new ir(Math.abs(a.value-s.value),n.typeInfo)}_dot(e,r){let n=0;for(let i=0;i<e.length;++i)n+=r[i]*e[i];return n}Dot(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);return n instanceof Mt&&i instanceof Mt?new ir(this._dot(n.data,i.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,r){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,r){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.exp(a)),n.typeInfo);const i=n;return new ir(Math.exp(i.value),n.typeInfo)}Exp2(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.pow(2,a)),n.typeInfo);const i=n;return new ir(Math.pow(2,i.value),n.typeInfo)}ExtractBits(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(i.typeInfo.name!=="u32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const s=i.value,o=a.value;if(n instanceof Mt)return new Mt(n.data.map(f=>f>>s&(1<<o)-1),n.typeInfo);if(n.typeInfo.name!=="i32"&&n.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const c=n.value;return new ir(c>>s&(1<<o)-1,this.getTypeInfo("i32"))}FaceForward(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof Mt&&i instanceof Mt&&a instanceof Mt){const s=this._dot(i.data,a.data);return new Mt(s<0?Array.from(n.data):n.data.map(o=>-o),n.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>this._firstLeadingBit(a)),n.typeInfo);const i=n;return new ir(this._firstLeadingBit(i.value),n.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>this._firstTrailingBit(a)),n.typeInfo);const i=n;return new ir(this._firstTrailingBit(i.value),n.typeInfo)}Floor(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.floor(a)),n.typeInfo);const i=n;return new ir(Math.floor(i.value),n.typeInfo)}Fma(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof Mt&&i instanceof Mt&&a instanceof Mt)return n.data.length!==i.data.length||n.data.length!==a.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new Mt(n.data.map((f,d)=>f*i.data[d]+a.data[d]),n.typeInfo);const s=n,o=i,c=a;return new ir(s.value*o.value+c.value,s.typeInfo)}Fract(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>a-Math.floor(a)),n.typeInfo);const i=n;return new ir(i.value-Math.floor(i.value),n.typeInfo)}Frexp(e,r){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r),s=this.exec.evalExpression(e.args[3],r);if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const o=a.value,c=(1<<s.value)-1<<o,f=~c;if(n instanceof Mt&&i instanceof Mt)return new Mt(n.data.map((b,x)=>b&f|i.data[x]<<o&c),n.typeInfo);const d=n.value,m=i.value;return new ir(d&f|m<<o&c,n.typeInfo)}InverseSqrt(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>1/Math.sqrt(a)),n.typeInfo);const i=n;return new ir(1/Math.sqrt(i.value),n.typeInfo)}Ldexp(e,r){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt){let a=0;return n.data.forEach(s=>{a+=s*s}),new ir(Math.sqrt(a),this.getTypeInfo("f32"))}const i=n;return new ir(Math.abs(i.value),n.typeInfo)}Log(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.log(a)),n.typeInfo);const i=n;return new ir(Math.log(i.value),n.typeInfo)}Log2(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.log2(a)),n.typeInfo);const i=n;return new ir(Math.log2(i.value),n.typeInfo)}Max(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Mt&&i instanceof Mt)return new Mt(n.data.map((o,c)=>Math.max(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.max(a.value,s.value),n.typeInfo)}Min(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Mt&&i instanceof Mt)return new Mt(n.data.map((o,c)=>Math.min(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.min(a.value,s.value),n.typeInfo)}Mix(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof Mt&&i instanceof Mt&&a instanceof Mt)return new Mt(n.data.map((c,f)=>n.data[f]*(1-a.data[f])+i.data[f]*a.data[f]),n.typeInfo);const s=i,o=a;return new ir(n.value*(1-o.value)+s.value*o.value,n.typeInfo)}Modf(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Mt&&i instanceof Mt)return new Mt(n.data.map((s,o)=>s%i.data[o]),n.typeInfo);const a=i;return new ir(n.value%a.value,n.typeInfo)}Normalize(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt){const i=this.Length(e,r).value;return new Mt(n.data.map(a=>a/i),n.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Mt&&i instanceof Mt)return new Mt(n.data.map((o,c)=>Math.pow(o,i.data[c])),n.typeInfo);const a=n,s=i;return new ir(Math.pow(a.value,s.value),n.typeInfo)}QuantizeToF16(e,r){const n=this.exec.evalExpression(e.args[0],r);return n instanceof Mt?new Mt(n.data.map(i=>i),n.typeInfo):new ir(n.value,n.typeInfo)}Radians(e,r){const n=this.exec.evalExpression(e.args[0],r);return n instanceof Mt?new Mt(n.data.map(i=>i*Math.PI/180),n.typeInfo):new ir(n.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,r){let n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(n instanceof Mt&&i instanceof Mt){const a=this._dot(n.data,i.data);return new Mt(n.data.map((s,o)=>s-2*a*i.data[o]),n.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,r){let n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(n instanceof Mt&&i instanceof Mt&&a instanceof ir){const s=this._dot(i.data,n.data);return new Mt(n.data.map((o,c)=>{const f=1-a.value*a.value*(1-s*s);if(f<0)return 0;const d=Math.sqrt(f);return a.value*o-(a.value*s+d)*i.data[c]}),n.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,r){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.round(a)),n.typeInfo);const i=n;return new ir(Math.round(i.value),n.typeInfo)}Saturate(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.min(Math.max(a,0),1)),n.typeInfo);const i=n;return new ir(Math.min(Math.max(i.value,0),1),n.typeInfo)}Sign(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.sign(a)),n.typeInfo);const i=n;return new ir(Math.sign(i.value),n.typeInfo)}Sin(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.sin(a)),n.typeInfo);const i=n;return new ir(Math.sin(i.value),n.typeInfo)}Sinh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.sinh(a)),n.typeInfo);const i=n;return new ir(Math.sinh(i.value),n.typeInfo)}_smoothstep(e,r,n){const i=Math.min(Math.max((n-e)/(r-e),0),1);return i*i*(3-2*i)}SmoothStep(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r),a=this.exec.evalExpression(e.args[2],r);if(a instanceof Mt&&n instanceof Mt&&i instanceof Mt)return new Mt(a.data.map((f,d)=>this._smoothstep(n.data[d],i.data[d],f)),a.typeInfo);const s=n,o=i,c=a;return new ir(this._smoothstep(s.value,o.value,c.value),a.typeInfo)}Sqrt(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.sqrt(a)),n.typeInfo);const i=n;return new ir(Math.sqrt(i.value),n.typeInfo)}Step(e,r){const n=this.exec.evalExpression(e.args[0],r),i=this.exec.evalExpression(e.args[1],r);if(i instanceof Mt&&n instanceof Mt)return new Mt(i.data.map((s,o)=>s<n.data[o]?0:1),i.typeInfo);const a=n;return new ir(i.value<a.value?0:1,a.typeInfo)}Tan(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.tan(a)),n.typeInfo);const i=n;return new ir(Math.tan(i.value),n.typeInfo)}Tanh(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.tanh(a)),n.typeInfo);const i=n;return new ir(Math.tanh(i.value),n.typeInfo)}_getTransposeType(e){const r=e.getTypeName();return r==="mat2x2f"||r==="mat2x2h"?e:r==="mat2x3f"?this.getTypeInfo("mat3x2f"):r==="mat2x3h"?this.getTypeInfo("mat3x2h"):r==="mat2x4f"?this.getTypeInfo("mat4x2f"):r==="mat2x4h"?this.getTypeInfo("mat4x2h"):r==="mat3x2f"?this.getTypeInfo("mat2x3f"):r==="mat3x2h"?this.getTypeInfo("mat2x3h"):r==="mat3x3f"||r==="mat3x3h"?e:r==="mat3x4f"?this.getTypeInfo("mat4x3f"):r==="mat3x4h"?this.getTypeInfo("mat4x3h"):r==="mat4x2f"?this.getTypeInfo("mat2x4f"):r==="mat4x2h"?this.getTypeInfo("mat2x4h"):r==="mat4x3f"?this.getTypeInfo("mat3x4f"):r==="mat4x3h"?this.getTypeInfo("mat3x4h"):(r==="mat4x4f"||r==="mat4x4h"||console.error(`Invalid matrix type ${r}`),e)}Transpose(e,r){const n=this.exec.evalExpression(e.args[0],r);if(!(n instanceof Ii))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const i=this._getTransposeType(n.typeInfo);if(n.typeInfo.name==="mat2x2"||n.typeInfo.name==="mat2x2f"||n.typeInfo.name==="mat2x2h"){const a=n.data;return new Ii([a[0],a[2],a[1],a[3]],i)}if(n.typeInfo.name==="mat2x3"||n.typeInfo.name==="mat2x3f"||n.typeInfo.name==="mat2x3h"){const a=n.data;return new Ii([a[0],a[3],a[6],a[1],a[4],a[7]],i)}if(n.typeInfo.name==="mat2x4"||n.typeInfo.name==="mat2x4f"||n.typeInfo.name==="mat2x4h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13]],i)}if(n.typeInfo.name==="mat3x2"||n.typeInfo.name==="mat3x2f"||n.typeInfo.name==="mat3x2h"){const a=n.data;return new Ii([a[0],a[3],a[1],a[4],a[2],a[5]],i)}if(n.typeInfo.name==="mat3x3"||n.typeInfo.name==="mat3x3f"||n.typeInfo.name==="mat3x3h"){const a=n.data;return new Ii([a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]],i)}if(n.typeInfo.name==="mat3x4"||n.typeInfo.name==="mat3x4f"||n.typeInfo.name==="mat3x4h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14]],i)}if(n.typeInfo.name==="mat4x2"||n.typeInfo.name==="mat4x2f"||n.typeInfo.name==="mat4x2h"){const a=n.data;return new Ii([a[0],a[4],a[1],a[5],a[2],a[6]],i)}if(n.typeInfo.name==="mat4x3"||n.typeInfo.name==="mat4x3f"||n.typeInfo.name==="mat4x3h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]],i)}if(n.typeInfo.name==="mat4x4"||n.typeInfo.name==="mat4x4f"||n.typeInfo.name==="mat4x4h"){const a=n.data;return new Ii([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]],i)}return console.error(`Invalid matrix type ${n.typeInfo.name}`),null}Trunc(e,r){const n=this.exec.evalExpression(e.args[0],r);if(n instanceof Mt)return new Mt(n.data.map(a=>Math.trunc(a)),n.typeInfo);const i=n;return new ir(Math.trunc(i.value),n.typeInfo)}Dpdx(e,r){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,r){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,r){return console.error("TODO: dpdxFine"),null}Dpdy(e,r){return console.error("TODO: dpdy"),null}DpdyCoarse(e,r){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,r){return console.error("TODO: dpdyFine"),null}Fwidth(e,r){return console.error("TODO: fwidth"),null}FwidthCoarse(e,r){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,r){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,r){const n=e.args[0],i=e.args.length>1?this.exec.evalExpression(e.args[1],r).value:0;if(n instanceof rf){const a=n.name,s=r.getVariableValue(a);if(s instanceof ip){if(i<0||i>=s.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const o=s.getMipLevelSize(i),c=s.dimension;return c==="1d"?new ir(o[0],this.getTypeInfo("u32")):c==="3d"?new Mt(o,this.getTypeInfo("vec3u")):c==="2d"?new Mt(o.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${c} not found. Line ${e.line}`),null)}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,r){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,r){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,r){const n=e.args[0],i=this.exec.evalExpression(e.args[1],r),a=e.args.length>2?this.exec.evalExpression(e.args[2],r).value:0;if(!(i instanceof Mt)||i.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(n instanceof rf){const s=n.name,o=r.getVariableValue(s);if(o instanceof ip){const c=Math.floor(i.data[0]),f=Math.floor(i.data[1]);if(c<0||c>=o.width||f<0||f>=o.height)return console.error(`Texture ${s} out of bounds. Line ${e.line}`),null;const d=o.getPixel(c,f,0,a);return d===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new Mt(d,this.getTypeInfo("vec4f"))}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,r){const n=e.args[0];if(n instanceof rf){const i=n.name,a=r.getVariableValue(i);return a instanceof ip?new ir(a.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,r){const n=e.args[0];if(n instanceof rf){const i=n.name,a=r.getVariableValue(i);return a instanceof ip?new ir(a.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,r){const n=e.args[0];if(n instanceof rf){const i=n.name,a=r.getVariableValue(i);return a instanceof ip?new ir(a.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,r){return console.error("TODO: textureSample"),null}TextureSampleBias(e,r){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,r){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,r){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,r){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,r){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,r){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,r){const n=e.args[0],i=this.exec.evalExpression(e.args[1],r),a=e.args.length===4?this.exec.evalExpression(e.args[2],r).value:0,s=e.args.length===4?this.exec.evalExpression(e.args[3],r).data:this.exec.evalExpression(e.args[2],r).data;if(s.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(i instanceof Mt)||i.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(n instanceof rf){const o=n.name,c=r.getVariableValue(o);if(c instanceof ip){const f=c.getMipLevelSize(0),d=Math.floor(i.data[0]),m=Math.floor(i.data[1]);return d<0||d>=f[0]||m<0||m>=f[1]?(console.error(`Texture ${o} out of bounds. Line ${e.line}`),null):(c.setPixel(d,m,0,a,Array.from(s)),null)}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,r){let n=e.args[0];n instanceof Sl&&(n=n.right);const i=this.exec.getVariableName(n,r);return r.getVariable(i).value.getSubData(this.exec,n.postfix,r)}AtomicStore(e,r){let n=e.args[0];n instanceof Sl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r);return c instanceof ir&&o instanceof ir&&(c.value=o.value),a.value instanceof Us&&a.value.setDataValue(this.exec,c,n.postfix,r),null}AtomicAdd(e,r){let n=e.args[0];n instanceof Sl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value+=o.value),a.value instanceof Us&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicSub(e,r){let n=e.args[0];n instanceof Sl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value-=o.value),a.value instanceof Us&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicMax(e,r){let n=e.args[0];n instanceof Sl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=Math.max(c.value,o.value)),a.value instanceof Us&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicMin(e,r){let n=e.args[0];n instanceof Sl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=Math.min(c.value,o.value)),a.value instanceof Us&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicAnd(e,r){let n=e.args[0];n instanceof Sl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=c.value&o.value),a.value instanceof Us&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicOr(e,r){let n=e.args[0];n instanceof Sl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=c.value|o.value),a.value instanceof Us&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicXor(e,r){let n=e.args[0];n instanceof Sl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=c.value^o.value),a.value instanceof Us&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicExchange(e,r){let n=e.args[0];n instanceof Sl&&(n=n.right);const i=this.exec.getVariableName(n,r),a=r.getVariable(i);let s=e.args[1];const o=this.exec.evalExpression(s,r),c=a.value.getSubData(this.exec,n.postfix,r),f=new ir(c.value,c.typeInfo);return c instanceof ir&&o instanceof ir&&(c.value=o.value),a.value instanceof Us&&a.value.setDataValue(this.exec,c,n.postfix,r),f}AtomicCompareExchangeWeak(e,r){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,r){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,r){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,r){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,r){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,r){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,r){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,r){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,r){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,r){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,r){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,r){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,r){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,r){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,r){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,r){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,r){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,r){return null}TextureBarrier(e,r){return null}WorkgroupBarrier(e,r){return null}WorkgroupUniformLoad(e,r){return null}SubgroupAdd(e,r){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,r){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,r){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,r){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,r){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,r){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,r){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,r){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,r){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,r){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,r){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,r){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,r){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,r){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,r){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,r){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,r){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,r){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,r){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,r){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,r){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,r){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,r){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,r){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,r){return console.error("TODO: quadSwapY"),null}}const WP={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},pc={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class Ju extends bje{constructor(e,r){var n;super(),this.ast=e??[],this.reflection=new dd,this.reflection.updateAST(this.ast),this.context=(n=r?.clone())!==null&&n!==void 0?n:new e6,this.builtins=new xje(this),this.typeInfo={bool:this.getTypeInfo(Kr.bool),i32:this.getTypeInfo(Kr.i32),u32:this.getTypeInfo(Kr.u32),f32:this.getTypeInfo(Kr.f32),f16:this.getTypeInfo(Kr.f16),vec2f:this.getTypeInfo(cr.vec2f),vec2u:this.getTypeInfo(cr.vec2u),vec2i:this.getTypeInfo(cr.vec2i),vec2h:this.getTypeInfo(cr.vec2h),vec3f:this.getTypeInfo(cr.vec3f),vec3u:this.getTypeInfo(cr.vec3u),vec3i:this.getTypeInfo(cr.vec3i),vec3h:this.getTypeInfo(cr.vec3h),vec4f:this.getTypeInfo(cr.vec4f),vec4u:this.getTypeInfo(cr.vec4u),vec4i:this.getTypeInfo(cr.vec4i),vec4h:this.getTypeInfo(cr.vec4h),mat2x2f:this.getTypeInfo(cr.mat2x2f),mat2x3f:this.getTypeInfo(cr.mat2x3f),mat2x4f:this.getTypeInfo(cr.mat2x4f),mat3x2f:this.getTypeInfo(cr.mat3x2f),mat3x3f:this.getTypeInfo(cr.mat3x3f),mat3x4f:this.getTypeInfo(cr.mat3x4f),mat4x2f:this.getTypeInfo(cr.mat4x2f),mat4x3f:this.getTypeInfo(cr.mat4x3f),mat4x4f:this.getTypeInfo(cr.mat4x4f)}}getVariableValue(e){var r,n;const i=(n=(r=this.context.getVariable(e))===null||r===void 0?void 0:r.value)!==null&&n!==void 0?n:null;if(i===null)return null;if(i instanceof ir)return i.value;if(i instanceof Mt||i instanceof Ii)return Array.from(i.data);if(i instanceof Us&&i.typeInfo instanceof wg){if(i.typeInfo.format.name==="u32")return Array.from(new Uint32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="i32")return Array.from(new Int32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="f32")return Array.from(new Float32Array(i.buffer,i.offset,i.typeInfo.count))}return console.error(`Unsupported return variable type ${i.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,r,n,i){const a=this.context.clone();(i=i??{}).constants&&this._setOverrides(i.constants,a),this._execStatements(this.ast,a);const s=a.getFunction(e);if(!s)return void console.error(`Function ${e} not found`);if(typeof r=="number")r=[r,1,1];else{if(r.length===0)return void console.error("Invalid dispatch count");r.length===1?r=[r[0],1,1]:r.length===2?r=[r[0],r[1],1]:r.length>3&&(r=[r[0],r[1],r[2]])}const o=r[0],c=r[1],f=r[2],d=this.getTypeInfo("vec3u");a.setVariable("@num_workgroups",new Mt(r,d));const m=this.reflection.getFunctionInfo(e);m===null&&console.error(`Function ${e} not found in reflection data`);for(const b in n)for(const x in n[b]){const E=n[b][x];a.variables.forEach(T=>{var A;const R=T.node;if(R?.attributes){let F=null,N=null;for(const O of R.attributes)O.name==="binding"?F=O.value:O.name==="group"&&(N=O.value);if(x==F&&b==N){let O=!1;for(const U of m.resources)if(U.name===T.name&&U.group===parseInt(b)&&U.binding===parseInt(x)){O=!0;break}if(O)if(E.texture!==void 0&&E.descriptor!==void 0){const U=new ip(E.texture,this.getTypeInfo(R.type),E.descriptor,(A=E.texture.view)!==null&&A!==void 0?A:null);T.value=U}else E.uniform!==void 0?T.value=new Us(E.uniform,this.getTypeInfo(R.type)):T.value=new Us(E,this.getTypeInfo(R.type))}}})}for(let b=0;b<f;++b)for(let x=0;x<c;++x)for(let E=0;E<o;++E)a.setVariable("@workgroup_id",new Mt([E,x,b],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(s,[E,x,b],a)}execStatement(e,r){if(e instanceof xre)return this.evalExpression(e.value,r);if(e instanceof Sre){if(e.condition){const n=this.evalExpression(e.condition,r);if(!(n instanceof ir))throw new Error("Invalid break-if condition");if(!n.value)return null}return Ju._breakObj}if(e instanceof Ere)return Ju._continueObj;if(e instanceof wb)this._let(e,r);else if(e instanceof sp)this._var(e,r);else if(e instanceof CS)this._const(e,r);else if(e instanceof cx)this._function(e,r);else{if(e instanceof bre)return this._if(e,r);if(e instanceof _re)return this._switch(e,r);if(e instanceof gre)return this._for(e,r);if(e instanceof pre)return this._while(e,r);if(e instanceof vre)return this._loop(e,r);if(e instanceof tD){const n=r.clone();return n.currentFunctionName=r.currentFunctionName,this._execStatements(e.body,n)}if(e instanceof yre)this._assign(e,r);else if(e instanceof mre)this._increment(e,r);else{if(e instanceof np)return null;if(e instanceof WN){const n=e.name;r.getVariable(n)===null&&r.setVariable(n,new ir(0,this.getTypeInfo("u32")))}else if(e instanceof XN)this._call(e,r);else{if(e instanceof wre||e instanceof YN)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,r){return e instanceof mh?this._evalBinaryOp(e,r):e instanceof Ol?this._evalLiteral(e,r):e instanceof rf?this._evalVariable(e,r):e instanceof ZN?this._evalCall(e,r):e instanceof od?this._evalCreate(e,r):e instanceof Tre?this._evalConst(e,r):e instanceof Cre?this._evalBitcast(e,r):e instanceof Sl?this._evalUnaryOp(e,r):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var r;if(e instanceof Kr){const i=this.reflection.getTypeInfo(e);if(i!==null)return i}let n=(r=this.typeInfo[e])!==null&&r!==void 0?r:null;return n!==null||(n=this.reflection.getTypeInfoByName(e)),n}_setOverrides(e,r){for(const n in e){const i=e[n],a=this.reflection.getOverrideInfo(n);a!==null?(a.type===null&&(a.type=this.getTypeInfo("u32")),a.type.name==="u32"||a.type.name==="i32"||a.type.name==="f32"||a.type.name==="f16"?r.setVariable(n,new ir(i,a.type)):a.type.name==="bool"?r.setVariable(n,new ir(i?1:0,a.type)):a.type.name==="vec2"||a.type.name==="vec3"||a.type.name==="vec4"||a.type.name==="vec2f"||a.type.name==="vec3f"||a.type.name==="vec4f"||a.type.name==="vec2i"||a.type.name==="vec3i"||a.type.name==="vec4i"||a.type.name==="vec2u"||a.type.name==="vec3u"||a.type.name==="vec4u"||a.type.name==="vec2h"||a.type.name==="vec3h"||a.type.name==="vec4h"?r.setVariable(n,new Mt(i,a.type)):console.error(`Invalid constant type for ${n}`)):console.error(`Override ${n} does not exist in the shader.`)}}_dispatchWorkgroup(e,r,n){const i=[1,1,1];for(const d of e.node.attributes)if(d.name==="workgroup_size"){if(d.value.length>0){const m=n.getVariableValue(d.value[0]);i[0]=m instanceof ir?m.value:parseInt(d.value[0])}if(d.value.length>1){const m=n.getVariableValue(d.value[1]);i[1]=m instanceof ir?m.value:parseInt(d.value[1])}if(d.value.length>2){const m=n.getVariableValue(d.value[2]);i[2]=m instanceof ir?m.value:parseInt(d.value[2])}}const a=this.getTypeInfo("vec3u"),s=this.getTypeInfo("u32");n.setVariable("@workgroup_size",new Mt(i,a));const o=i[0],c=i[1],f=i[2];for(let d=0,m=0;d<f;++d)for(let b=0;b<c;++b)for(let x=0;x<o;++x,++m){const E=[x,b,d],T=[x+r[0]*i[0],b+r[1]*i[1],d+r[2]*i[2]];n.setVariable("@local_invocation_id",new Mt(E,a)),n.setVariable("@global_invocation_id",new Mt(T,a)),n.setVariable("@local_invocation_index",new ir(m,s)),this._dispatchExec(e,n)}}_dispatchExec(e,r){for(const n of e.node.args)for(const i of n.attributes)if(i.name==="builtin"){const a=`@${i.value}`,s=r.getVariable(a);s!==void 0&&r.variables.set(n.name,s)}this._execStatements(e.node.body,r)}getVariableName(e,r){for(;e instanceof Sl;)e=e.right;return e instanceof rf?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,r){for(const n of e){if(n instanceof Array){const a=r.clone(),s=this._execStatements(n,a);if(s)return s;continue}const i=this.execStatement(n,r);if(i)return i}return null}_call(e,r){const n=r.clone();n.currentFunctionName=e.name;const i=r.getFunction(e.name);if(i){for(let a=0;a<i.node.args.length;++a){const s=i.node.args[a],o=this.evalExpression(e.args[a],n);n.setVariable(s.name,o,s)}this._execStatements(i.node.body,n)}else e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)&&this._evalCreate(e,r)}_increment(e,r){const n=this.getVariableName(e.variable,r),i=r.getVariable(n);i?e.operator==="++"?i.value instanceof ir?i.value.value++:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):e.operator==="--"?i.value instanceof ir?i.value.value--:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${n} not found. Line ${e.line}`)}_getVariableData(e,r){if(e instanceof rf){const n=this.getVariableName(e,r),i=r.getVariable(n);return i===null?(console.error(`Variable ${n} not found. Line ${e.line}`),null):i.value.getSubData(this,e.postfix,r)}if(e instanceof Sl){if(e.operator==="*"){const n=this._getVariableData(e.right,r);return n instanceof Av?n.reference.getSubData(this,e.postfix,r):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const n=this._getVariableData(e.right,r);return new Av(n)}}return null}_assign(e,r){let n=null,i="<var>",a=null;if(e.variable instanceof Sl){const c=this._getVariableData(e.variable,r),f=this.evalExpression(e.value,r),d=e.operator;if(d==="="){if(c instanceof ir||c instanceof Mt||c instanceof Ii){if(f instanceof ir||f instanceof Mt||f instanceof Ii&&c.data.length===f.data.length)return void c.data.set(f.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(c instanceof Us&&f instanceof Us&&c.buffer.byteLength-c.offset>=f.buffer.byteLength-f.offset)return void(c.buffer.byteLength%4==0?new Uint32Array(c.buffer,c.offset,c.typeInfo.size/4).set(new Uint32Array(f.buffer,f.offset,f.typeInfo.size/4)):new Uint8Array(c.buffer,c.offset,c.typeInfo.size).set(new Uint8Array(f.buffer,f.offset,f.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(d==="+=")return c instanceof ir||c instanceof Mt||c instanceof Ii?f instanceof ir||f instanceof Mt||f instanceof Ii?void c.data.set(f.data.map((m,b)=>c.data[b]+m)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(d==="-=")return(c instanceof ir||c instanceof Mt||c instanceof Ii)&&(f instanceof ir||f instanceof Mt||f instanceof Ii)?void c.data.set(f.data.map((m,b)=>c.data[b]-m)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof Sl){if(e.variable.operator==="*"){i=this.getVariableName(e.variable.right,r);const c=r.getVariable(i);if(!(c&&c.value instanceof Av))return void console.error(`Variable ${i} is not a pointer. Line ${e.line}`);n=c.value.reference;let f=e.variable.postfix;if(!f){let d=e.variable.right;for(;d instanceof Sl;){if(d.postfix){f=d.postfix;break}d=d.right}}f&&(n=n.getSubData(this,f,r))}}else{a=e.variable.postfix,i=this.getVariableName(e.variable,r);const c=r.getVariable(i);if(c===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);n=c.value}if(n instanceof Av&&(n=n.reference),n===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);const s=this.evalExpression(e.value,r),o=e.operator;if(o!=="="){const c=n.getSubData(this,a,r);if(c instanceof Mt&&s instanceof ir){const f=c.data,d=s.value;if(o==="+=")for(let m=0;m<f.length;++m)f[m]+=d;else if(o==="-=")for(let m=0;m<f.length;++m)f[m]-=d;else if(o==="*=")for(let m=0;m<f.length;++m)f[m]*=d;else if(o==="/=")for(let m=0;m<f.length;++m)f[m]/=d;else if(o==="%=")for(let m=0;m<f.length;++m)f[m]%=d;else if(o==="&=")for(let m=0;m<f.length;++m)f[m]&=d;else if(o==="|=")for(let m=0;m<f.length;++m)f[m]|=d;else if(o==="^=")for(let m=0;m<f.length;++m)f[m]^=d;else if(o==="<<=")for(let m=0;m<f.length;++m)f[m]<<=d;else if(o===">>=")for(let m=0;m<f.length;++m)f[m]>>=d;else console.error(`Invalid operator ${o}. Line ${e.line}`)}else if(c instanceof Mt&&s instanceof Mt){const f=c.data,d=s.data;if(f.length!==d.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(o==="+=")for(let m=0;m<f.length;++m)f[m]+=d[m];else if(o==="-=")for(let m=0;m<f.length;++m)f[m]-=d[m];else if(o==="*=")for(let m=0;m<f.length;++m)f[m]*=d[m];else if(o==="/=")for(let m=0;m<f.length;++m)f[m]/=d[m];else if(o==="%=")for(let m=0;m<f.length;++m)f[m]%=d[m];else if(o==="&=")for(let m=0;m<f.length;++m)f[m]&=d[m];else if(o==="|=")for(let m=0;m<f.length;++m)f[m]|=d[m];else if(o==="^=")for(let m=0;m<f.length;++m)f[m]^=d[m];else if(o==="<<=")for(let m=0;m<f.length;++m)f[m]<<=d[m];else if(o===">>=")for(let m=0;m<f.length;++m)f[m]>>=d[m];else console.error(`Invalid operator ${o}. Line ${e.line}`)}else{if(!(c instanceof ir&&s instanceof ir))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);o==="+="?c.value+=s.value:o==="-="?c.value-=s.value:o==="*="?c.value*=s.value:o==="/="?c.value/=s.value:o==="%="?c.value%=s.value:o==="&="?c.value&=s.value:o==="|="?c.value|=s.value:o==="^="?c.value^=s.value:o==="<<="?c.value<<=s.value:o===">>="?c.value>>=s.value:console.error(`Invalid operator ${o}. Line ${e.line}`)}return void(n instanceof Us&&n.setDataValue(this,c,a,r))}if(n instanceof Us)n.setDataValue(this,s,a,r);else if(a){if(!(n instanceof Mt||n instanceof Ii))return void console.error(`Variable ${i} is not a vector or matrix. Line ${e.line}`);if(a instanceof t_){const c=this.evalExpression(a.index,r).value;if(n instanceof Mt){if(!(s instanceof ir))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[c]=s.value}else{if(!(n instanceof Ii))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const f=this.evalExpression(a.index,r).value;if(f<0)return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(s instanceof Mt))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const d=n.typeInfo.getTypeName();if(d==="mat2x2"||d==="mat2x2f"||d==="mat2x2h"){if(!(f<2&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*f]=s.data[0],n.data[2*f+1]=s.data[1]}else if(d==="mat2x3"||d==="mat2x3f"||d==="mat2x3h"){if(!(f<2&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*f]=s.data[0],n.data[3*f+1]=s.data[1],n.data[3*f+2]=s.data[2]}else if(d==="mat2x4"||d==="mat2x4f"||d==="mat2x4h"){if(!(f<2&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*f]=s.data[0],n.data[4*f+1]=s.data[1],n.data[4*f+2]=s.data[2],n.data[4*f+3]=s.data[3]}else if(d==="mat3x2"||d==="mat3x2f"||d==="mat3x2h"){if(!(f<3&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*f]=s.data[0],n.data[2*f+1]=s.data[1]}else if(d==="mat3x3"||d==="mat3x3f"||d==="mat3x3h"){if(!(f<3&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*f]=s.data[0],n.data[3*f+1]=s.data[1],n.data[3*f+2]=s.data[2]}else if(d==="mat3x4"||d==="mat3x4f"||d==="mat3x4h"){if(!(f<3&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*f]=s.data[0],n.data[4*f+1]=s.data[1],n.data[4*f+2]=s.data[2],n.data[4*f+3]=s.data[3]}else if(d==="mat4x2"||d==="mat4x2f"||d==="mat4x2h"){if(!(f<4&&s.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*f]=s.data[0],n.data[2*f+1]=s.data[1]}else if(d==="mat4x3"||d==="mat4x3f"||d==="mat4x3h"){if(!(f<4&&s.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*f]=s.data[0],n.data[3*f+1]=s.data[1],n.data[3*f+2]=s.data[2]}else{if(d!=="mat4x4"&&d!=="mat4x4f"&&d!=="mat4x4h")return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(f<4&&s.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*f]=s.data[0],n.data[4*f+1]=s.data[1],n.data[4*f+2]=s.data[2],n.data[4*f+3]=s.data[3]}}}}}else if(a instanceof fy){const c=a.value;if(!(n instanceof Mt))return void console.error(`Invalid assignment to ${c}. Variable ${i} is not a vector. Line ${e.line}`);if(s instanceof ir){if(c.length>1)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);if(c==="x")n.data[0]=s.value;else if(c==="y"){if(n.data.length<2)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);n.data[1]=s.value}else if(c==="z"){if(n.data.length<3)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);n.data[2]=s.value}else if(c==="w"){if(n.data.length<4)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);n.data[3]=s.value}}else{if(!(s instanceof Mt))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(c.length!==s.data.length)return void console.error(`Invalid assignment to ${c} for variable ${i}. Line ${e.line}`);for(let f=0;f<c.length;++f){const d=c[f];if(d==="x"||d==="r")n.data[0]=s.data[f];else if(d==="y"||d==="g"){if(s.data.length<2)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);n.data[1]=s.data[f]}else if(d==="z"||d==="b"){if(s.data.length<3)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);n.data[2]=s.data[f]}else{if(d!=="w"&&d!=="a")return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);if(s.data.length<4)return void console.error(`Invalid assignment to ${d} for variable ${i}. Line ${e.line}`);n.data[3]=s.data[f]}}}}}else n instanceof ir&&s instanceof ir?n.value=s.value:n instanceof Mt&&s instanceof Mt||n instanceof Ii&&s instanceof Ii?n.data.set(s.data):console.error(`Invalid assignment to ${i}. Line ${e.line}`)}_function(e,r){const n=new QN(e);r.functions.set(e.name,n)}_const(e,r){let n=null;e.value!==null&&(n=this.evalExpression(e.value,r)),r.createVariable(e.name,n,e)}_let(e,r){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,r),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof Sl||(n=n.clone())}else{const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||i==="array"){const a=new od(e.type,[]);n=this._evalCreate(a,r)}}r.createVariable(e.name,n,e)}_var(e,r){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,r),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof Sl||(n=n.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||e.type instanceof Sb||e.type instanceof np||e.type instanceof cr){const a=new od(e.type,[]);n=this._evalCreate(a,r)}}r.createVariable(e.name,n,e)}_switch(e,r){r=r.clone();const n=this.evalExpression(e.condition,r);if(!(n instanceof ir))return console.error(`Invalid if condition. Line ${e.line}`),null;let i=null;for(const a of e.cases)if(a instanceof Pre)for(const s of a.selectors){if(s instanceof IS){i=a;continue}const o=this.evalExpression(s,r);if(!(o instanceof ir))return console.error(`Invalid case selector. Line ${e.line}`),null;if(o.value===n.value)return this._execStatements(a.body,r)}else a instanceof Mre&&(i=a);return i?this._execStatements(i.body,r):null}_if(e,r){r=r.clone();const n=this.evalExpression(e.condition,r);if(!(n instanceof ir))return console.error(`Invalid if condition. Line ${e.line}`),null;if(n.value)return this._execStatements(e.body,r);for(const i of e.elseif){const a=this.evalExpression(i.condition,r);if(!(a instanceof ir))return console.error(`Invalid if condition. Line ${e.line}`),null;if(a.value)return this._execStatements(i.body,r)}return e.else?this._execStatements(e.else,r):null}_getScalarValue(e){return e instanceof ir?e.value:(console.error("Expected scalar value.",e),0)}_for(e,r){for(r=r.clone(),this.execStatement(e.init,r);this._getScalarValue(this.evalExpression(e.condition,r));){const n=this._execStatements(e.body,r);if(n===Ju._breakObj)break;if(n!==null&&n!==Ju._continueObj)return n;this.execStatement(e.increment,r)}return null}_loop(e,r){for(r=r.clone();;){const n=this._execStatements(e.body,r);if(n===Ju._breakObj)break;if(n===Ju._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,r)===Ju._breakObj)break}else if(n!==null)return n}return null}_while(e,r){for(r=r.clone();this._getScalarValue(this.evalExpression(e.condition,r));){const n=this._execStatements(e.body,r);if(n===Ju._breakObj)break;if(n!==Ju._continueObj&&n!==null)return n}return null}_evalBitcast(e,r){const n=this.evalExpression(e.value,r),i=e.type;if(n instanceof ir){const a=yG(n.value,n.typeInfo.name,i.name);return new ir(a,this.getTypeInfo(i))}if(n instanceof Mt){const a=n.typeInfo.getTypeName();let s="";if(a.endsWith("f"))s="f32";else if(a.endsWith("i"))s="i32";else if(a.endsWith("u"))s="u32";else if(a.endsWith("b"))s="bool";else{if(!a.endsWith("h"))return console.error(`Unknown vector type ${a}. Line ${e.line}`),null;s="f16"}const o=i.getTypeName();let c="";if(o.endsWith("f"))c="f32";else if(o.endsWith("i"))c="i32";else if(o.endsWith("u"))c="u32";else if(o.endsWith("b"))c="bool";else{if(!o.endsWith("h"))return console.error(`Unknown vector type ${c}. Line ${e.line}`),null;c="f16"}const f=(function(d,m,b){if(m===b)return d;const x=new Array(d.length);for(let E=0;E<d.length;E++)x[E]=yG(d[E],m,b);return x})(Array.from(n.data),s,c);return new Mt(f,this.getTypeInfo(i))}return console.error(`TODO: bitcast for ${n.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,r){return r.getVariableValue(e.name).clone().getSubData(this,e.postfix,r)}_evalCreate(e,r){var n;if(e instanceof od){if(e.type===null)return rD.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,r);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,r);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,r)}}const i=e instanceof od?e.type.name:e.name,a=e instanceof od?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(a===null)return console.error(`Unknown type ${i}. Line ${e.line}`),null;if(a.size===0)return null;const s=new Us(new ArrayBuffer(a.size),a,0);if(a instanceof pg){if(e.args)for(let o=0;o<e.args.length;++o){const c=a.members[o],f=e.args[o],d=this.evalExpression(f,r);s.setData(this,d,c.type,c.offset,r)}}else if(a instanceof wg){let o=0;if(e.args)for(let c=0;c<e.args.length;++c){const f=e.args[c],d=this.evalExpression(f,r);a.format===null&&(((n=d.typeInfo)===null||n===void 0?void 0:n.name)==="x32"?a.format=this.getTypeInfo("i32"):a.format=d.typeInfo),s.setData(this,d,a.format,o,r),o+=a.stride}}else console.error(`Unknown type "${i}". Line ${e.line}`);return e instanceof od?s.getSubData(this,e.postfix,r):s}_evalLiteral(e,r){const n=this.getTypeInfo(e.type),i=n.name;return i==="x32"||i==="u32"||i==="f32"||i==="f16"||i==="i32"||i==="bool"?new ir(e.scalarValue,n):i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"?this._callConstructorVec(e,r):i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"?this._callConstructorMatrix(e,r):e.value}_evalVariable(e,r){const n=r.getVariableValue(e.name);return n===null?n:n.getSubData(this,e.postfix,r)}_maxFormatTypeInfo(e){let r=e[0];if(r.name==="f32")return r;for(let n=1;n<e.length;++n){const i=Ju._priority.get(r.name);Ju._priority.get(e[n].name)<i&&(r=e[n])}return r.name==="x32"?this.getTypeInfo("i32"):r}_evalUnaryOp(e,r){const n=this.evalExpression(e.right,r);if(e.operator==="&")return new Av(n);if(e.operator==="*")return n instanceof Av?n.reference.getSubData(this,e.postfix,r):(console.error(`Invalid dereference. Line ${e.line}`),null);const i=n instanceof ir?n.value:n instanceof Mt?Array.from(n.data):null;switch(e.operator){case"+":{if(On(i)){const o=i.map((c,f)=>+c);return new Mt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(+a,s)}case"-":{if(On(i)){const o=i.map((c,f)=>-c);return new Mt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(-a,s)}case"!":{if(On(i)){const o=i.map((c,f)=>c?0:1);return new Mt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(a?0:1,s)}case"~":{if(On(i)){const o=i.map((c,f)=>~c);return new Mt(o,n.typeInfo)}const a=i,s=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new ir(~a,s)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,r){const n=this.evalExpression(e.left,r),i=this.evalExpression(e.right,r),a=n instanceof ir?n.value:n instanceof Mt||n instanceof Ii?Array.from(n.data):null,s=i instanceof ir?i.value:i instanceof Mt||i instanceof Ii?Array.from(i.data):null;switch(e.operator){case"+":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x+m[E]);return new Mt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b+d);return new Mt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d+b);return new Mt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o+c,f)}case"-":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x-m[E]);return new Mt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b-d);return new Mt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d-b);return new Mt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o-c,f)}case"*":{if(On(a)&&On(s)){const d=a,m=s;if(n instanceof Ii&&i instanceof Ii){const b=(function(A,R,F,N){if(pc[R.name]===void 0||pc[N.name]===void 0)return null;const O=pc[R.name][0],U=pc[R.name][1],j=pc[N.name][0];if(O!==pc[N.name][1])return null;const H=new Array(j*U);for(let W=0;W<U;W++)for(let X=0;X<j;X++){let oe=0;for(let ee=0;ee<O;ee++)oe+=A[ee*U+W]*F[X*O+ee];H[W*j+X]=oe}return H})(d,n.typeInfo,m,i.typeInfo);if(b===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const x=pc[i.typeInfo.name][0],E=pc[n.typeInfo.name][1],T=this.getTypeInfo(`mat${x}x${E}f`);return new Ii(b,T)}if(n instanceof Ii&&i instanceof Mt){const b=(function(x,E,T,A){if(pc[E.name]===void 0||WP[A.name]===void 0)return null;const R=pc[E.name][0],F=pc[E.name][1];if(R!==T.length)return null;const N=new Array(F);for(let O=0;O<F;O++){let U=0;for(let j=0;j<R;j++)U+=x[j*F+O]*T[j];N[O]=U}return N})(d,n.typeInfo,m,i.typeInfo);return b===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Mt(b,i.typeInfo)}if(n instanceof Mt&&i instanceof Ii){const b=(function(x,E,T,A){if(WP[E.name]===void 0||pc[A.name]===void 0)return null;const R=pc[A.name][0],F=pc[A.name][1];if(F!==x.length)return null;const N=[];for(let O=0;O<R;O++){let U=0;for(let j=0;j<F;j++)U+=x[j]*T[j*R+O];N[O]=U}return N})(d,n.typeInfo,m,i.typeInfo);return b===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Mt(b,n.typeInfo)}{if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x*m[E]);return new Mt(b,n.typeInfo)}}if(On(a)){const d=s,m=a.map((b,x)=>b*d);return n instanceof Ii?new Ii(m,n.typeInfo):new Mt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d*b);return i instanceof Ii?new Ii(m,i.typeInfo):new Mt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o*c,f)}case"%":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x%m[E]);return new Mt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b%d);return new Mt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d%b);return new Mt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o%c,f)}case"/":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x/m[E]);return new Mt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b/d);return new Mt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d/b);return new Mt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o/c,f)}case"&":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x&m[E]);return new Mt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b&d);return new Mt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d&b);return new Mt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o&c,f)}case"|":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x|m[E]);return new Mt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b|d);return new Mt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d|b);return new Mt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o|c,f)}case"^":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x^m[E]);return new Mt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b^d);return new Mt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d^b);return new Mt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o^c,f)}case"<<":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x<<m[E]);return new Mt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b<<d);return new Mt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d<<b);return new Mt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o<<c,f)}case">>":{if(On(a)&&On(s)){const d=a,m=s;if(d.length!==m.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const b=d.map((x,E)=>x>>m[E]);return new Mt(b,n.typeInfo)}if(On(a)){const d=s,m=a.map((b,x)=>b>>d);return new Mt(m,n.typeInfo)}if(On(s)){const d=a,m=s.map((b,x)=>d>>b);return new Mt(m,i.typeInfo)}const o=a,c=s,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new ir(o>>c,f)}case">":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d>c[m]?1:0);return new Mt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f>o?1:0);return new Mt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o>f?1:0);return new Mt(c,i.typeInfo)}return new ir(a>s?1:0,this.getTypeInfo("bool"));case"<":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d<c[m]?1:0);return new Mt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f<o?1:0);return new Mt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o<f?1:0);return new Mt(c,i.typeInfo)}return new ir(a<s?1:0,this.getTypeInfo("bool"));case"==":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d===c[m]?1:0);return new Mt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f==o?1:0);return new Mt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o==f?1:0);return new Mt(c,i.typeInfo)}return new ir(a===s?1:0,this.getTypeInfo("bool"));case"!=":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d!==c[m]?1:0);return new Mt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f!==o?1:0);return new Mt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o!==f?1:0);return new Mt(c,i.typeInfo)}return new ir(a!==s?1:0,this.getTypeInfo("bool"));case">=":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d>=c[m]?1:0);return new Mt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f>=o?1:0);return new Mt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o>=f?1:0);return new Mt(c,i.typeInfo)}return new ir(a>=s?1:0,this.getTypeInfo("bool"));case"<=":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d<=c[m]?1:0);return new Mt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f<=o?1:0);return new Mt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o<=f?1:0);return new Mt(c,i.typeInfo)}return new ir(a<=s?1:0,this.getTypeInfo("bool"));case"&&":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d&&c[m]?1:0);return new Mt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f&&o?1:0);return new Mt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o&&f?1:0);return new Mt(c,i.typeInfo)}return new ir(a&&s?1:0,this.getTypeInfo("bool"));case"||":if(On(a)&&On(s)){const o=a,c=s;if(o.length!==c.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((d,m)=>d||c[m]?1:0);return new Mt(f,n.typeInfo)}if(On(a)){const o=s,c=a.map((f,d)=>f||o?1:0);return new Mt(c,n.typeInfo)}if(On(s)){const o=a,c=s.map((f,d)=>o||f?1:0);return new Mt(c,i.typeInfo)}return new ir(a||s?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,r){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const n=r.clone();n.currentFunctionName=e.name;const i=r.getFunction(e.name);if(!i)return e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)?this._evalCreate(e,r):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let a=0;a<i.node.args.length;++a){const s=i.node.args[a],o=this.evalExpression(e.args[a],n);n.createVariable(s.name,o,s)}return this._execStatements(i.node.body,n)}_callBuiltinFunction(e,r){switch(e.name){case"all":return this.builtins.All(e,r);case"any":return this.builtins.Any(e,r);case"select":return this.builtins.Select(e,r);case"arrayLength":return this.builtins.ArrayLength(e,r);case"abs":return this.builtins.Abs(e,r);case"acos":return this.builtins.Acos(e,r);case"acosh":return this.builtins.Acosh(e,r);case"asin":return this.builtins.Asin(e,r);case"asinh":return this.builtins.Asinh(e,r);case"atan":return this.builtins.Atan(e,r);case"atanh":return this.builtins.Atanh(e,r);case"atan2":return this.builtins.Atan2(e,r);case"ceil":return this.builtins.Ceil(e,r);case"clamp":return this.builtins.Clamp(e,r);case"cos":return this.builtins.Cos(e,r);case"cosh":return this.builtins.Cosh(e,r);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,r);case"countOneBits":return this.builtins.CountOneBits(e,r);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,r);case"cross":return this.builtins.Cross(e,r);case"degrees":return this.builtins.Degrees(e,r);case"determinant":return this.builtins.Determinant(e,r);case"distance":return this.builtins.Distance(e,r);case"dot":return this.builtins.Dot(e,r);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,r);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,r);case"exp":return this.builtins.Exp(e,r);case"exp2":return this.builtins.Exp2(e,r);case"extractBits":return this.builtins.ExtractBits(e,r);case"faceForward":return this.builtins.FaceForward(e,r);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,r);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,r);case"floor":return this.builtins.Floor(e,r);case"fma":return this.builtins.Fma(e,r);case"fract":return this.builtins.Fract(e,r);case"frexp":return this.builtins.Frexp(e,r);case"insertBits":return this.builtins.InsertBits(e,r);case"inverseSqrt":return this.builtins.InverseSqrt(e,r);case"ldexp":return this.builtins.Ldexp(e,r);case"length":return this.builtins.Length(e,r);case"log":return this.builtins.Log(e,r);case"log2":return this.builtins.Log2(e,r);case"max":return this.builtins.Max(e,r);case"min":return this.builtins.Min(e,r);case"mix":return this.builtins.Mix(e,r);case"modf":return this.builtins.Modf(e,r);case"normalize":return this.builtins.Normalize(e,r);case"pow":return this.builtins.Pow(e,r);case"quantizeToF16":return this.builtins.QuantizeToF16(e,r);case"radians":return this.builtins.Radians(e,r);case"reflect":return this.builtins.Reflect(e,r);case"refract":return this.builtins.Refract(e,r);case"reverseBits":return this.builtins.ReverseBits(e,r);case"round":return this.builtins.Round(e,r);case"saturate":return this.builtins.Saturate(e,r);case"sign":return this.builtins.Sign(e,r);case"sin":return this.builtins.Sin(e,r);case"sinh":return this.builtins.Sinh(e,r);case"smoothstep":return this.builtins.SmoothStep(e,r);case"sqrt":return this.builtins.Sqrt(e,r);case"step":return this.builtins.Step(e,r);case"tan":return this.builtins.Tan(e,r);case"tanh":return this.builtins.Tanh(e,r);case"transpose":return this.builtins.Transpose(e,r);case"trunc":return this.builtins.Trunc(e,r);case"dpdx":return this.builtins.Dpdx(e,r);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,r);case"dpdxFine":return this.builtins.DpdxFine(e,r);case"dpdy":return this.builtins.Dpdy(e,r);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,r);case"dpdyFine":return this.builtins.DpdyFine(e,r);case"fwidth":return this.builtins.Fwidth(e,r);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,r);case"fwidthFine":return this.builtins.FwidthFine(e,r);case"textureDimensions":return this.builtins.TextureDimensions(e,r);case"textureGather":return this.builtins.TextureGather(e,r);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,r);case"textureLoad":return this.builtins.TextureLoad(e,r);case"textureNumLayers":return this.builtins.TextureNumLayers(e,r);case"textureNumLevels":return this.builtins.TextureNumLevels(e,r);case"textureNumSamples":return this.builtins.TextureNumSamples(e,r);case"textureSample":return this.builtins.TextureSample(e,r);case"textureSampleBias":return this.builtins.TextureSampleBias(e,r);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,r);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,r);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,r);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,r);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,r);case"textureStore":return this.builtins.TextureStore(e,r);case"atomicLoad":return this.builtins.AtomicLoad(e,r);case"atomicStore":return this.builtins.AtomicStore(e,r);case"atomicAdd":return this.builtins.AtomicAdd(e,r);case"atomicSub":return this.builtins.AtomicSub(e,r);case"atomicMax":return this.builtins.AtomicMax(e,r);case"atomicMin":return this.builtins.AtomicMin(e,r);case"atomicAnd":return this.builtins.AtomicAnd(e,r);case"atomicOr":return this.builtins.AtomicOr(e,r);case"atomicXor":return this.builtins.AtomicXor(e,r);case"atomicExchange":return this.builtins.AtomicExchange(e,r);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,r);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,r);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,r);case"pack4xI8":return this.builtins.Pack4xI8(e,r);case"pack4xU8":return this.builtins.Pack4xU8(e,r);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,r);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,r);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,r);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,r);case"pack2x16float":return this.builtins.Pack2x16float(e,r);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,r);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,r);case"unpack4xI8":return this.builtins.Unpack4xI8(e,r);case"unpack4xU8":return this.builtins.Unpack4xU8(e,r);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,r);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,r);case"unpack2x16float":return this.builtins.Unpack2x16float(e,r);case"storageBarrier":return this.builtins.StorageBarrier(e,r);case"textureBarrier":return this.builtins.TextureBarrier(e,r);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,r);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,r);case"subgroupAdd":return this.builtins.SubgroupAdd(e,r);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,r);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,r);case"subgroupAll":return this.builtins.SubgroupAll(e,r);case"subgroupAnd":return this.builtins.SubgroupAnd(e,r);case"subgroupAny":return this.builtins.SubgroupAny(e,r);case"subgroupBallot":return this.builtins.SubgroupBallot(e,r);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,r);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,r);case"subgroupElect":return this.builtins.SubgroupElect(e,r);case"subgroupMax":return this.builtins.SubgroupMax(e,r);case"subgroupMin":return this.builtins.SubgroupMin(e,r);case"subgroupMul":return this.builtins.SubgroupMul(e,r);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,r);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,r);case"subgroupOr":return this.builtins.SubgroupOr(e,r);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,r);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,r);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,r);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,r);case"subgroupXor":return this.builtins.SubgroupXor(e,r);case"quadBroadcast":return this.builtins.QuadBroadcast(e,r);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,r);case"quadSwapX":return this.builtins.QuadSwapX(e,r);case"quadSwapY":return this.builtins.QuadSwapY(e,r)}const n=r.getFunction(e.name);if(n){const i=r.clone();for(let a=0;a<n.node.args.length;++a){const s=n.node.args[a],o=this.evalExpression(e.args[a],i);i.setVariable(s.name,o,s)}return this._execStatements(n.node.body,i)}return null}_callConstructorValue(e,r){if(!e.args||e.args.length===0)return new ir(0,this.getTypeInfo(e.type));const n=this.evalExpression(e.args[0],r);return n.typeInfo=this.getTypeInfo(e.type),n.getSubData(this,e.postfix,r).clone()}_callConstructorVec(e,r){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=WP[i];if(a===void 0)return console.error(`Invalid vec constructor ${i}. Line ${e.line}`),null;const s=[];if(e instanceof Ol)if(e.isVector){const o=e.vectorValue;for(const c of o)s.push(c)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const c=this.evalExpression(o,r);if(c instanceof Mt){const f=c.data;for(let d=0;d<f.length;++d){let m=f[d];s.push(m)}}else if(c instanceof ir){let f=c.value;s.push(f)}}if(e.type instanceof cr&&e.type.format===null&&(e.type.format=cr.f32),s.length===0){const o=new Array(a).fill(0);return new Mt(o,n).getSubData(this,e.postfix,r)}if(s.length===1)for(;s.length<a;)s.push(s[0]);return s.length<a?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new Mt(s.length>a?s.slice(0,a):s,n).getSubData(this,e.postfix,r)}_callConstructorMatrix(e,r){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=pc[i];if(a===void 0)return console.error(`Invalid matrix constructor ${i}. Line ${e.line}`),null;const s=[];if(e instanceof Ol)if(e.isVector){const o=e.vectorValue;for(const c of o)s.push(c)}else s.push(e.scalarValue);else if(e.args)for(const o of e.args){const c=this.evalExpression(o,r);c instanceof Mt?s.push(...c.data):c instanceof ir?s.push(c.value):c instanceof Ii&&s.push(...c.data)}if(n instanceof cy&&n.format===null&&(n.format=this.getTypeInfo("f32")),s.length===0){const o=new Array(a[2]).fill(0);return new Ii(o,n).getSubData(this,e.postfix,r)}return s.length!==a[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new Ii(s,n).getSubData(this,e.postfix,r)}}Ju._breakObj=new Zf(new Bf("BREAK",null),null),Ju._continueObj=new Zf(new Bf("CONTINUE",null),null),Ju._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class wje{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class Sje{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new wje,this._exec=new Ju,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const r=[];for(;!this._isAtEnd();){const n=this._global_decl_or_directive();if(!n)break;r.push(n)}if(this._deferArrayCountEval.length>0){for(const n of this._deferArrayCountEval){const i=n.arrayType,a=n.countNode;if(a instanceof rf){const s=a.name,o=this._context.constants.get(s);if(o)try{const c=o.constEvaluate(this._exec);i.count=c}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const n of r)n.search(i=>{i instanceof gG||i instanceof AS?i.type=this._forwardType(i.type):i instanceof Sb?i.format=this._forwardType(i.format):i instanceof sp||i instanceof wb||i instanceof CS?i.type=this._forwardType(i.type):i instanceof cx?i.returnType=this._forwardType(i.returnType):i instanceof pG&&(i.type=this._forwardType(i.type))});return r}_forwardType(e){if(e instanceof dG){const r=this._getType(e.name);if(r)return r}else e instanceof AS?e.type=this._forwardType(e.type):e instanceof Sb&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const r=new hje(e);this._tokens=r.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,r){return e.line=r??this._currentLine,e}_error(e,r){return{token:e,message:r,toString:()=>`${r}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==vt.eof}_match(e){if(e instanceof or)return!!this._check(e)&&(this._advance(),!0);for(let r=0,n=e.length;r<n;++r){const i=e[r];if(this._check(i))return this._advance(),!0}return!1}_consume(e,r){if(this._check(e))return this._advance();throw this._error(this._peek(),`${r}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const r=this._peek();if(e instanceof Array){const n=r.type;let i=!1;for(const a of e){if(n===a)return!0;a===vt.tokens.name&&(i=!0)}if(i){const a=vt.tokens.name.rule.exec(r.lexeme);if(a&&a.index==0&&a[0]==r.lexeme)return!0}return!1}if(r.type===e)return!0;if(e===vt.tokens.name){const n=vt.tokens.name.rule.exec(r.lexeme);return n&&n.index==0&&n[0]==r.lexeme}return!1}_advance(){var e,r;return this._currentLine=(r=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&r!==void 0?r:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(vt.tokens.semicolon)&&!this._isAtEnd(););if(this._match(vt.keywords.alias)){const r=this._type_alias();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(vt.keywords.diagnostic)){const r=this._diagnostic();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(vt.keywords.requires)){const r=this._requires_directive();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}if(this._match(vt.keywords.enable)){const r=this._enable_directive();return this._consume(vt.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([r]),r}const e=this._attribute();if(this._check(vt.keywords.var)){const r=this._global_variable_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.override)){const r=this._override_variable_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.let)){const r=this._global_let_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.const)){const r=this._global_const_decl();return r!=null&&(r.attributes=e),this._consume(vt.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.struct)){const r=this._struct_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}if(this._check(vt.keywords.fn)){const r=this._function_decl();return r!=null&&(r.attributes=e),this._exec.reflection.updateAST([r]),r}return null}_function_decl(){if(!this._match(vt.keywords.fn))return null;const e=this._currentLine,r=this._consume(vt.tokens.ident,"Expected function name.").toString();this._consume(vt.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(vt.tokens.paren_right))do{if(this._check(vt.tokens.paren_right))break;const o=this._attribute(),c=this._consume(vt.tokens.name,"Expected argument name.").toString();this._consume(vt.tokens.colon,"Expected ':' for argument type.");const f=this._attribute(),d=this._type_decl();d!=null&&(d.attributes=f,n.push(this._updateNode(new pG(c,d,o))))}while(this._match(vt.tokens.comma));this._consume(vt.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(vt.tokens.arrow)){const o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}const a=this._compound_statement(),s=this._currentLine;return this._updateNode(new cx(r,n,i,a,e,s),e)}_compound_statement(){const e=[];for(this._consume(vt.tokens.brace_left,"Expected '{' for block.");!this._check(vt.tokens.brace_right);){const r=this._statement();r!==null&&e.push(r)}return this._consume(vt.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(vt.tokens.semicolon)&&!this._isAtEnd(););if(this._check(vt.tokens.attr)&&this._attribute(),this._check(vt.keywords.if))return this._if_statement();if(this._check(vt.keywords.switch))return this._switch_statement();if(this._check(vt.keywords.loop))return this._loop_statement();if(this._check(vt.keywords.for))return this._for_statement();if(this._check(vt.keywords.while))return this._while_statement();if(this._check(vt.keywords.continuing))return this._continuing_statement();if(this._check(vt.keywords.static_assert))return this._static_assert_statement();if(this._check(vt.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(vt.keywords.return))e=this._return_statement();else if(this._check([vt.keywords.var,vt.keywords.let,vt.keywords.const]))e=this._variable_statement();else if(this._match(vt.keywords.discard))e=this._updateNode(new uje);else if(this._match(vt.keywords.break)){const r=this._updateNode(new Sre);if(this._currentLoop.length>0){const n=this._currentLoop[this._currentLoop.length-1];r.loopId=n.id}e=r,this._check(vt.keywords.if)&&(this._advance(),r.condition=this._optional_paren_expression())}else if(this._match(vt.keywords.continue)){const r=this._updateNode(new Ere);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${r.line}`);{const n=this._currentLoop[this._currentLoop.length-1];r.loopId=n.id}e=r}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(vt.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(vt.keywords.static_assert))return null;const e=this._currentLine,r=this._optional_paren_expression();return this._updateNode(new oje(r),e)}_while_statement(){if(!this._match(vt.keywords.while))return null;const e=this._updateNode(new pre(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(vt.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(vt.keywords.continuing))return null;const r=this._currentLine,n=this._compound_statement();return this._updateNode(new tD(n,e),r)}_for_statement(){if(!this._match(vt.keywords.for))return null;this._consume(vt.tokens.paren_left,"Expected '('.");const e=this._updateNode(new gre(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(vt.tokens.semicolon)?null:this._for_init(),this._consume(vt.tokens.semicolon,"Expected ';'."),e.condition=this._check(vt.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(vt.tokens.semicolon,"Expected ';'."),e.increment=this._check(vt.tokens.paren_right)?null:this._for_increment(),this._consume(vt.tokens.paren_right,"Expected ')'."),this._check(vt.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(vt.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let r=null;return this._match(vt.tokens.equal)&&(r=this._short_circuit_or_expression()),this._updateNode(new sp(e.name,e.type,e.storage,e.access,r),e.line)}if(this._match(vt.keywords.let)){const e=this._currentLine,r=this._consume(vt.tokens.name,"Expected name for let.").toString();let n=null;if(this._match(vt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}this._consume(vt.tokens.equal,"Expected '=' for let.");const i=this._short_circuit_or_expression();return this._updateNode(new wb(r,n,null,null,i),e)}if(this._match(vt.keywords.const)){const e=this._currentLine,r=this._consume(vt.tokens.name,"Expected name for const.").toString();let n=null;if(this._match(vt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}this._consume(vt.tokens.equal,"Expected '=' for const.");const i=this._short_circuit_or_expression();return n===null&&i instanceof Ol&&(n=i.type),this._updateNode(new CS(r,n,null,null,i),e)}return null}_increment_decrement_statement(){const e=this._current,r=this._unary_expression();if(r==null)return null;if(!this._check(vt.increment_operators))return this._current=e,null;const n=this._consume(vt.increment_operators,"Expected increment operator");return this._updateNode(new mre(n.type===vt.tokens.plus_plus?h0.increment:h0.decrement,r))}_assignment_statement(){let e=null;const r=this._currentLine;if(this._check(vt.tokens.brace_right))return null;let n=this._match(vt.tokens.underscore);if(n||(e=this._unary_expression()),!n&&e==null)return null;const i=this._consume(vt.assignment_operators,"Expected assignment operator."),a=this._short_circuit_or_expression();return this._updateNode(new yre(K1.parse(i.lexeme),e,a),r)}_func_call_statement(){if(!this._check(vt.tokens.ident))return null;const e=this._currentLine,r=this._current,n=this._consume(vt.tokens.ident,"Expected function name."),i=this._argument_expression_list();return i===null?(this._current=r,null):this._updateNode(new XN(n.lexeme,i),e)}_loop_statement(){if(!this._match(vt.keywords.loop))return null;this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new vre([],null));this._currentLoop.push(e);let r=this._statement();for(;r!==null;){if(Array.isArray(r))for(let n of r)e.body.push(n);else e.body.push(r);if(r instanceof tD){e.continuing=r;break}r=this._statement()}return this._currentLoop.pop(),this._consume(vt.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(vt.keywords.switch))return null;const e=this._updateNode(new _re(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(vt.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let r=!1;for(;this._check([vt.keywords.default,vt.keywords.case]);){if(this._match(vt.keywords.case)){const n=this._case_selectors();for(const a of n)if(a instanceof IS){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");r=!0;break}this._match(vt.tokens.colon),this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Exected '{' for switch case.");const i=this._case_body();this._consume(vt.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new Pre(n,i)))}if(this._match(vt.keywords.default)){if(r)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(vt.tokens.colon),this._check(vt.tokens.attr)&&this._attribute(),this._consume(vt.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(vt.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new Mre(n)))}}return e}_case_selectors(){const e=[];for(this._match(vt.keywords.default)?e.push(this._updateNode(new IS)):e.push(this._shift_expression());this._match(vt.tokens.comma);)this._match(vt.keywords.default)?e.push(this._updateNode(new IS)):e.push(this._shift_expression());return e}_case_body(){if(this._match(vt.keywords.fallthrough))return this._consume(vt.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const r=this._case_body();return r.length==0?e:[...e,r[0]]}_if_statement(){if(!this._match(vt.keywords.if))return null;const e=this._currentLine,r=this._optional_paren_expression();this._check(vt.tokens.attr)&&this._attribute();const n=this._compound_statement();let i=[];this._match_elseif()&&(this._check(vt.tokens.attr)&&this._attribute(),i=this._elseif_statement(i));let a=null;return this._match(vt.keywords.else)&&(this._check(vt.tokens.attr)&&this._attribute(),a=this._compound_statement()),this._updateNode(new bre(r,n,i,a),e)}_match_elseif(){return this._tokens[this._current].type===vt.keywords.else&&this._tokens[this._current+1].type===vt.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const r=this._optional_paren_expression(),n=this._compound_statement();return e.push(this._updateNode(new cje(r,n))),this._match_elseif()&&(this._check(vt.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(vt.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new xre(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(vt.tokens.or_or);)e=this._updateNode(new mh(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(vt.tokens.and_and);)e=this._updateNode(new mh(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(vt.tokens.or);)e=this._updateNode(new mh(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(vt.tokens.xor);)e=this._updateNode(new mh(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(vt.tokens.and);)e=this._updateNode(new mh(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([vt.tokens.equal_equal,vt.tokens.not_equal])?this._updateNode(new mh(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([vt.tokens.less_than,vt.tokens.greater_than,vt.tokens.less_than_equal,vt.tokens.greater_than_equal]);)e=this._updateNode(new mh(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([vt.tokens.shift_left,vt.tokens.shift_right]);)e=this._updateNode(new mh(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([vt.tokens.plus,vt.tokens.minus]);)e=this._updateNode(new mh(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([vt.tokens.star,vt.tokens.forward_slash,vt.tokens.modulo]);)e=this._updateNode(new mh(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([vt.tokens.minus,vt.tokens.bang,vt.tokens.tilde,vt.tokens.star,vt.tokens.and])?this._updateNode(new Sl(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),r=this._postfix_expression();return r&&(e.postfix=r),e}_postfix_expression(){if(this._match(vt.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(vt.tokens.bracket_right,"Expected ']'.");const r=this._updateNode(new t_(e)),n=this._postfix_expression();return n&&(r.postfix=n),r}if(this._match(vt.tokens.period)){const e=this._consume(vt.tokens.name,"Expected member name."),r=this._postfix_expression(),n=this._updateNode(new fy(e.lexeme));return r&&(n.postfix=r),n}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const r=this._getStruct(e);if(r!==null)return r;switch(e){case"void":return Kr.void;case"bool":return Kr.bool;case"i32":return Kr.i32;case"u32":return Kr.u32;case"f32":return Kr.f32;case"f16":return Kr.f16;case"vec2f":return cr.vec2f;case"vec3f":return cr.vec3f;case"vec4f":return cr.vec4f;case"vec2i":return cr.vec2i;case"vec3i":return cr.vec3i;case"vec4i":return cr.vec4i;case"vec2u":return cr.vec2u;case"vec3u":return cr.vec3u;case"vec4u":return cr.vec4u;case"vec2h":return cr.vec2h;case"vec3h":return cr.vec3h;case"vec4h":return cr.vec4h;case"mat2x2f":return cr.mat2x2f;case"mat2x3f":return cr.mat2x3f;case"mat2x4f":return cr.mat2x4f;case"mat3x2f":return cr.mat3x2f;case"mat3x3f":return cr.mat3x3f;case"mat3x4f":return cr.mat3x4f;case"mat4x2f":return cr.mat4x2f;case"mat4x3f":return cr.mat4x3f;case"mat4x4f":return cr.mat4x4f;case"mat2x2h":return cr.mat2x2h;case"mat2x3h":return cr.mat2x3h;case"mat2x4h":return cr.mat2x4h;case"mat3x2h":return cr.mat3x2h;case"mat3x3h":return cr.mat3x3h;case"mat3x4h":return cr.mat3x4h;case"mat4x2h":return cr.mat4x2h;case"mat4x3h":return cr.mat4x3h;case"mat4x4h":return cr.mat4x4h;case"mat2x2i":return cr.mat2x2i;case"mat2x3i":return cr.mat2x3i;case"mat2x4i":return cr.mat2x4i;case"mat3x2i":return cr.mat3x2i;case"mat3x3i":return cr.mat3x3i;case"mat3x4i":return cr.mat3x4i;case"mat4x2i":return cr.mat4x2i;case"mat4x3i":return cr.mat4x3i;case"mat4x4i":return cr.mat4x4i;case"mat2x2u":return cr.mat2x2u;case"mat2x3u":return cr.mat2x3u;case"mat2x4u":return cr.mat2x4u;case"mat3x2u":return cr.mat3x2u;case"mat3x3u":return cr.mat3x3u;case"mat3x4u":return cr.mat3x4u;case"mat4x2u":return cr.mat4x2u;case"mat4x3u":return cr.mat4x3u;case"mat4x4u":return cr.mat4x4u}return null}_validateTypeRange(e,r){if(r.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(r.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(vt.tokens.ident)){const n=this._previous().toString();if(this._check(vt.tokens.paren_left)){const i=this._argument_expression_list(),a=this._getType(n);return a!==null?this._updateNode(new od(a,i)):this._updateNode(new ZN(n,i))}if(this._context.constants.has(n)){const i=this._context.constants.get(n);return this._updateNode(new Tre(n,i.value))}return this._updateNode(new rf(n))}if(this._match(vt.tokens.int_literal)){const n=this._previous().toString();let i=n.endsWith("i")||n.endsWith("i")?Kr.i32:n.endsWith("u")||n.endsWith("U")?Kr.u32:Kr.x32;const a=parseInt(n);return this._validateTypeRange(a,i),this._updateNode(new Ol(new ir(a,this._exec.getTypeInfo(i)),i))}if(this._match(vt.tokens.uint_literal)){const n=parseInt(this._previous().toString());return this._validateTypeRange(n,Kr.u32),this._updateNode(new Ol(new ir(n,this._exec.getTypeInfo(Kr.u32)),Kr.u32))}if(this._match([vt.tokens.decimal_float_literal,vt.tokens.hex_float_literal])){let n=this._previous().toString(),i=n.endsWith("h");i&&(n=n.substring(0,n.length-1));const a=parseFloat(n);this._validateTypeRange(a,i?Kr.f16:Kr.f32);const s=i?Kr.f16:Kr.f32;return this._updateNode(new Ol(new ir(a,this._exec.getTypeInfo(s)),s))}if(this._match([vt.keywords.true,vt.keywords.false])){let n=this._previous().toString()===vt.keywords.true.rule;return this._updateNode(new Ol(new ir(n?1:0,this._exec.getTypeInfo(Kr.bool)),Kr.bool))}if(this._check(vt.tokens.paren_left))return this._paren_expression();if(this._match(vt.keywords.bitcast)){this._consume(vt.tokens.less_than,"Expected '<'.");const n=this._type_decl();this._consume(vt.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return this._updateNode(new Cre(n,i))}const e=this._type_decl(),r=this._argument_expression_list();return this._updateNode(new od(e,r))}_argument_expression_list(){if(!this._match(vt.tokens.paren_left))return null;const e=[];do{if(this._check(vt.tokens.paren_right))break;const r=this._short_circuit_or_expression();e.push(r)}while(this._match(vt.tokens.comma));return this._consume(vt.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(vt.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(vt.tokens.paren_right),e}_paren_expression(){this._consume(vt.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(vt.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(vt.keywords.struct))return null;const e=this._currentLine,r=this._consume(vt.tokens.ident,"Expected name for struct.").toString();this._consume(vt.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(vt.tokens.brace_right);){const s=this._attribute(),o=this._consume(vt.tokens.name,"Expected variable name.").toString();this._consume(vt.tokens.colon,"Expected ':' for struct member type.");const c=this._attribute(),f=this._type_decl();f!=null&&(f.attributes=c),this._check(vt.tokens.brace_right)?this._match(vt.tokens.comma):this._consume(vt.tokens.comma,"Expected ',' for struct member."),n.push(this._updateNode(new gG(o,f,s)))}this._consume(vt.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,a=this._updateNode(new np(r,n,e,i),e);return this._context.structs.set(r,a),a}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(vt.tokens.equal)){const r=this._const_expression();e.value=r}if(e.type!==null&&e.value instanceof Ol){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof Ol&&(e.type=e.value.type.name==="x32"?Kr.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(vt.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(vt.keywords.const))return null;const r=this._consume(vt.tokens.name,"Expected variable name"),n=this._currentLine;let i=null;if(this._match(vt.tokens.colon)){const c=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=c)}let a=null;this._consume(vt.tokens.equal,"const declarations require an assignment");const s=this._short_circuit_or_expression();try{let c=[Kr.f32],f=s.constEvaluate(this._exec,c);f instanceof ir&&this._validateTypeRange(f.value,c[0]),c[0]instanceof cr&&c[0].format===null&&f.typeInfo instanceof cy&&f.typeInfo.format!==null&&(f.typeInfo.format.name==="f16"?c[0].format=Kr.f16:f.typeInfo.format.name==="f32"?c[0].format=Kr.f32:f.typeInfo.format.name==="i32"?c[0].format=Kr.i32:f.typeInfo.format.name==="u32"?c[0].format=Kr.u32:f.typeInfo.format.name==="bool"?c[0].format=Kr.bool:console.error(`TODO: impelement template format type ${f.typeInfo.format.name}`)),a=this._updateNode(new Ol(f,c[0])),this._exec.context.setVariable(r.toString(),f)}catch{a=s}if(i!==null&&a instanceof Ol){if(a.type.name!=="x32"&&i.getTypeName()!==a.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${a.type.name} to ${i.name}. Line:${this._currentLine}`);a.type=i,a.isScalar&&this._validateTypeRange(a.scalarValue,a.type)}else i===null&&a instanceof Ol&&(i=(e=a?.type)!==null&&e!==void 0?e:Kr.f32,i===Kr.x32&&(i=Kr.i32));const o=this._updateNode(new CS(r.toString(),i,"","",a),n);return this._context.constants.set(o.name,o),o}_global_let_decl(){if(!this._match(vt.keywords.let))return null;const e=this._currentLine,r=this._consume(vt.tokens.name,"Expected variable name");let n=null;if(this._match(vt.tokens.colon)){const a=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=a)}let i=null;if(this._match(vt.tokens.equal)&&(i=this._const_expression()),n!==null&&i instanceof Ol){if(i.type.name!=="x32"&&n.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${n.name}. Line:${this._currentLine}`);i.type=n}else n===null&&i instanceof Ol&&(n=i.type.name==="x32"?Kr.i32:i.type);return i instanceof Ol&&i.isScalar&&this._validateTypeRange(i.scalarValue,n),this._updateNode(new wb(r.toString(),n,"","",i),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(vt.keywords.var))return null;const e=this._currentLine;let r="",n="";this._match(vt.tokens.less_than)&&(r=this._consume(vt.storage_class,"Expected storage_class.").toString(),this._match(vt.tokens.comma)&&(n=this._consume(vt.access_mode,"Expected access_mode.").toString()),this._consume(vt.tokens.greater_than,"Expected '>'."));const i=this._consume(vt.tokens.name,"Expected variable name");let a=null;if(this._match(vt.tokens.colon)){const s=this._attribute();a=this._type_decl(),a!=null&&(a.attributes=s)}return this._updateNode(new sp(i.toString(),a,r,n,null),e)}_override_decl(){if(!this._match(vt.keywords.override))return null;const e=this._consume(vt.tokens.name,"Expected variable name");let r=null;if(this._match(vt.tokens.colon)){const n=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=n)}return this._updateNode(new WN(e.toString(),r,null))}_diagnostic(){this._consume(vt.tokens.paren_left,"Expected '('");const e=this._consume(vt.tokens.ident,"Expected severity control name.");this._consume(vt.tokens.comma,"Expected ','");let r=this._consume(vt.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(vt.tokens.period)&&(r+=`.${this._consume(vt.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(vt.tokens.paren_right,"Expected ')'"),this._updateNode(new wre(e.toString(),r))}_enable_directive(){const e=this._consume(vt.tokens.ident,"identity expected.");return this._updateNode(new sje(e.toString()))}_requires_directive(){const e=[this._consume(vt.tokens.ident,"identity expected.").toString()];for(;this._match(vt.tokens.comma);){const r=this._consume(vt.tokens.ident,"identity expected.");e.push(r.toString())}return this._updateNode(new lje(e))}_type_alias(){const e=this._consume(vt.tokens.ident,"identity expected.");this._consume(vt.tokens.equal,"Expected '=' for type alias.");let r=this._type_decl();if(r===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);const n=this._updateNode(new YN(e.toString(),r));return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([vt.tokens.ident,...vt.texel_format,vt.keywords.bool,vt.keywords.f32,vt.keywords.i32,vt.keywords.u32])){const n=this._advance().toString();if(this._context.structs.has(n))return this._context.structs.get(n);if(this._context.aliases.has(n))return this._context.aliases.get(n).type;if(!this._getType(n)){const i=this._updateNode(new dG(n));return this._forwardTypeCount++,i}return this._updateNode(new Kr(n))}let e=this._texture_sampler_types();if(e)return e;if(this._check(vt.template_types)){let n=this._advance().toString(),i=null,a=null;return this._match(vt.tokens.less_than)&&(i=this._type_decl(),a=null,this._match(vt.tokens.comma)&&(a=this._consume(vt.access_mode,"Expected access_mode for pointer").toString()),this._consume(vt.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new cr(n,i,a))}if(this._match(vt.keywords.ptr)){let n=this._previous().toString();this._consume(vt.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(vt.storage_class,"Expected storage_class for pointer");this._consume(vt.tokens.comma,"Expected ',' for pointer.");const a=this._type_decl();let s=null;return this._match(vt.tokens.comma)&&(s=this._consume(vt.access_mode,"Expected access_mode for pointer").toString()),this._consume(vt.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new AS(n,i.toString(),a,s))}const r=this._attribute();if(this._match(vt.keywords.array)){let n=null,i=-1;const a=this._previous();let s=null;if(this._match(vt.tokens.less_than)){n=this._type_decl(),this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);let c="";if(this._match(vt.tokens.comma)){s=this._shift_expression();try{c=s.constEvaluate(this._exec).toString(),s=null}catch{c="1"}}this._consume(vt.tokens.greater_than,"Expected '>' for array."),i=c?parseInt(c):0}const o=this._updateNode(new Sb(a.toString(),r,n,i));return s&&this._deferArrayCountEval.push({arrayType:o,countNode:s}),o}return null}_texture_sampler_types(){if(this._match(vt.sampler_type))return this._updateNode(new J1(this._previous().toString(),null,null));if(this._match(vt.depth_texture_type))return this._updateNode(new J1(this._previous().toString(),null,null));if(this._match(vt.sampled_texture_type)||this._match(vt.multisampled_texture_type)){const e=this._previous();this._consume(vt.tokens.less_than,"Expected '<' for sampler type.");const r=this._type_decl();return this._consume(vt.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new J1(e.toString(),r,null))}if(this._match(vt.storage_texture_type)){const e=this._previous();this._consume(vt.tokens.less_than,"Expected '<' for sampler type.");const r=this._consume(vt.texel_format,"Invalid texel format.").toString();this._consume(vt.tokens.comma,"Expected ',' after texel format.");const n=this._consume(vt.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(vt.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new J1(e.toString(),r,n))}return null}_attribute(){let e=[];for(;this._match(vt.tokens.attr);){const r=this._consume(vt.attribute_name,"Expected attribute name"),n=this._updateNode(new kre(r.toString(),null));if(this._match(vt.tokens.paren_left)){if(n.value=this._consume(vt.literal_or_ident,"Expected attribute value").toString(),this._check(vt.tokens.comma)){this._advance();do{const i=this._consume(vt.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(i)}while(this._match(vt.tokens.comma))}this._consume(vt.tokens.paren_right,"Expected ')'")}e.push(n)}return e.length==0?null:e}}class Eje extends dd{constructor(e){super(),e&&this.update(e)}update(e){const r=new Sje().parse(e);this.updateAST(r)}}function Tje(t){const e={attributes:[],bindings:[]};let r;try{r=Cje(t)}catch(a){return gn.error(a.message)(),e}for(const a of r.uniforms){const s=[];for(const o of a.type?.members||[])s.push({name:o.name,type:vG(o.type)});e.bindings.push({type:"uniform",name:a.name,group:a.group,location:a.binding,members:s})}for(const a of r.textures)e.bindings.push({type:"texture",name:a.name,group:a.group,location:a.binding});for(const a of r.samplers)e.bindings.push({type:"sampler",name:a.name,group:a.group,location:a.binding});const n=r.entry.vertex[0],i=n?.inputs.length||0;for(let a=0;a<i;a++){const s=n.inputs[a];if(s.locationType==="location"){const o=vG(s.type);e.attributes.push({name:s.name,location:Number(s.location),type:o})}}return e}function vG(t){return t.format?`${t.name}<${t.format.name}>`:t.name}function Cje(t){try{return new Eje(t)}catch(e){if(e instanceof Error)throw e;let r="WGSL parse error";throw typeof e=="object"&&e?.message&&(r+=`: ${e.message} `),typeof e=="object"&&e?.token&&(r+=e.token.line||""),new Error(r,{cause:e})}}const Aje={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...Aje}};const zf=globalThis.mathgl.config;function Ije(t,{precision:e=zf.precision}={}){return t=Pje(t),`${parseFloat(t.toPrecision(e))}`}function r_(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function pd(t,e,r){return kje(t,n=>Math.max(e,Math.min(r,n)))}function dT(t,e,r){return r_(t)?t.map((n,i)=>dT(n,e[i],r)):r*e+(1-r)*t}function fx(t,e,r){const n=zf.EPSILON;try{if(t===e)return!0;if(r_(t)&&r_(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!fx(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=zf.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{zf.EPSILON=n}}function Pje(t){return Math.round(t/zf.EPSILON)*zf.EPSILON}function Mje(t){return t.clone?t.clone():new Array(t.length)}function kje(t,e,r){if(r_(t)){const n=t;r=r||Mje(n);for(let i=0;i<r.length&&i<n.length;++i){const a=typeof t=="number"?t:t[i];r[i]=e(a,i,r)}return r}return e(t)}class Rre extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+r];return this.check()}toArray(e=[],r=0){for(let n=0;n<this.ELEMENTS;++n)e[r+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:r_(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(zf)}formatString(e){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+Ije(this[n],e);return`${e.printTypes?this.constructor.name:""}[${r}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!fx(this[r],e[r]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==e[r])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,r,n){if(n===void 0)return this.lerp(this,e,r);for(let i=0;i<this.ELEMENTS;++i){const a=e[i],s=typeof r=="number"?r:r[i];this[i]=a+n*(s-a)}return this.check()}min(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(e[r],this[r]);return this.check()}max(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(e[r],this[r]);return this.check()}clamp(e,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),r[n]);return this.check()}add(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]+=r[n];return this.check()}subtract(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]-=r[n];return this.check()}scale(e){if(typeof e=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;else for(let r=0;r<this.ELEMENTS&&r<e.length;++r)this[r]*=e[r];return this.check()}multiplyByScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}check(){if(zf.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)e=e&&Number.isFinite(this[r]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]=e;return this.check()}addScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let r=0;r<this.ELEMENTS;++r)this[r]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),r);return this.check()}get elements(){return this}}function Rje(t,e){if(t.length!==e)return!1;for(let r=0;r<t.length;++r)if(!Number.isFinite(t[r]))return!1;return!0}function tf(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function XP(t,e,r=""){if(zf.debug&&!Rje(t,e))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return t}function _G(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}class Dje extends Rre{get x(){return this[0]}set x(e){this[0]=tf(e)}get y(){return this[1]}set y(e){this[1]=tf(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let r=0;r<this.ELEMENTS;++r)e+=this[r]*this[r];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let r=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-e[n];r+=i*i}return tf(r)}dot(e){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*e[n];return tf(r)}normalize(){const e=this.magnitude();if(e!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=e;return this.check()}multiply(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]*=r[n];return this.check()}divide(...e){for(const r of e)for(let n=0;n<this.ELEMENTS;++n)this[n]/=r[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return _G(e>=0&&e<this.ELEMENTS,"index is out of range"),tf(this[e])}setComponent(e,r){return _G(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=r,this.check()}addVectors(e,r){return this.copy(e).add(r)}subVectors(e,r){return this.copy(e).subtract(r)}multiplyVectors(e,r){return this.copy(e).multiply(r)}addScaledVector(e,r){return this.add(new this.constructor(e).multiplyScalar(r))}}const PS=1e-6;let n_=typeof Float32Array<"u"?Float32Array:Array;function Oje(){const t=new n_(2);return n_!=Float32Array&&(t[0]=0,t[1]=0),t}function bG(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function Lje(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Dre(t,e,r,n){const i=e[0],a=e[1];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t}function Nje(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}(function(){const t=Oje();return function(e,r,n,i,a,s){let o,c;for(r||(r=2),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],a(t,t,s),e[o]=t[0],e[o+1]=t[1];return e}})();function Fje(t,e,r){const n=e[0],i=e[1],a=r[3]*n+r[7]*i||1;return t[0]=(r[0]*n+r[4]*i)/a,t[1]=(r[1]*n+r[5]*i)/a,t}function Ore(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[3]*n+r[7]*i+r[11]*a||1;return t[0]=(r[0]*n+r[4]*i+r[8]*a)/s,t[1]=(r[1]*n+r[5]*i+r[9]*a)/s,t[2]=(r[2]*n+r[6]*i+r[10]*a)/s,t}function Bje(t,e,r){const n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t[2]=e[2],t}function zje(){const t=new n_(3);return n_!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function jje(t){const e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}function Uje(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function Vje(t){const e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function $je(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function qje(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Hje(t,e,r){const n=e[0],i=e[1],a=e[2],s=r[0],o=r[1],c=r[2];return t[0]=i*c-a*o,t[1]=a*s-n*c,t[2]=n*o-i*s,t}function Gje(t,e,r,n){const i=e[0],a=e[1],s=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=s+n*(r[2]-s),t}function Lre(t,e,r){const n=e[0],i=e[1],a=e[2];let s=r[3]*n+r[7]*i+r[11]*a+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/s,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/s,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/s,t}function Wje(t,e,r){const n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t}function Xje(t,e,r){const n=r[0],i=r[1],a=r[2],s=r[3],o=e[0],c=e[1],f=e[2];let d=i*f-a*c,m=a*o-n*f,b=n*c-i*o,x=i*b-a*m,E=a*d-n*b,T=n*m-i*d;const A=s*2;return d*=A,m*=A,b*=A,x*=2,E*=2,T*=2,t[0]=o+d+x,t[1]=c+m+E,t[2]=f+b+T,t}function Yje(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Zje(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Kje(t,e,r,n){const i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Jje(t,e){const r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],c=Math.sqrt((r*r+n*n+i*i)*(a*a+s*s+o*o)),f=c&&qje(t,e)/c;return Math.acos(Math.min(Math.max(f,-1),1))}const Nre=Uje,Qje=jje,YP=Vje;(function(){const t=zje();return function(e,r,n,i,a,s){let o,c;for(r||(r=3),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const ZP=[0,0,0];let Hw;class Td extends Dje{static get ZERO(){return Hw||(Hw=new Td(0,0,0),Object.freeze(Hw)),Hw}constructor(e=0,r=0,n=0){super(-0,-0,-0),arguments.length===1&&r_(e)?this.copy(e):(zf.debug&&(tf(e),tf(r),tf(n)),this[0]=e,this[1]=r,this[2]=n)}set(e,r,n){return this[0]=e,this[1]=r,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return zf.debug&&(tf(e.x),tf(e.y),tf(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=tf(e)}angle(e){return Jje(this,e)}cross(e){return Hje(this,this,e),this.check()}rotateX({radians:e,origin:r=ZP}){return Yje(this,this,r,e),this.check()}rotateY({radians:e,origin:r=ZP}){return Zje(this,this,r,e),this.check()}rotateZ({radians:e,origin:r=ZP}){return Kje(this,this,r,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Lre(this,this,e),this.check()}transformAsVector(e){return Ore(this,this,e),this.check()}transformByMatrix3(e){return Wje(this,this,e),this.check()}transformByMatrix2(e){return Bje(this,this,e),this.check()}transformByQuaternion(e){return Xje(this,this,e),this.check()}}class e7e extends Rre{toString(){let e="[";if(zf.printRowMajor){e+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)e+=` ${this[n*this.RANK+r]}`}else{e+="column-major:";for(let r=0;r<this.ELEMENTS;++r)e+=` ${this[r]}`}return e+="]",e}getElementIndex(e,r){return r*this.RANK+e}getElement(e,r){return this[r*this.RANK+e]}setElement(e,r,n){return this[r*this.RANK+e]=tf(n),this}getColumn(e,r=new Array(this.RANK).fill(-0)){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[n+i];return r}setColumn(e,r){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=r[i];return this}}function t7e(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function r7e(t,e){if(t===e){const r=e[1],n=e[2],i=e[3],a=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function nD(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],c=e[6],f=e[7],d=e[8],m=e[9],b=e[10],x=e[11],E=e[12],T=e[13],A=e[14],R=e[15],F=r*o-n*s,N=r*c-i*s,O=r*f-a*s,U=n*c-i*o,j=n*f-a*o,H=i*f-a*c,W=d*T-m*E,X=d*A-b*E,oe=d*R-x*E,ee=m*A-b*T,G=m*R-x*T,ae=b*R-x*A;let se=F*ae-N*G+O*ee+U*oe-j*X+H*W;return se?(se=1/se,t[0]=(o*ae-c*G+f*ee)*se,t[1]=(i*G-n*ae-a*ee)*se,t[2]=(T*H-A*j+R*U)*se,t[3]=(b*j-m*H-x*U)*se,t[4]=(c*oe-s*ae-f*X)*se,t[5]=(r*ae-i*oe+a*X)*se,t[6]=(A*O-E*H-R*N)*se,t[7]=(d*H-b*O+x*N)*se,t[8]=(s*G-o*oe+f*W)*se,t[9]=(n*oe-r*G-a*W)*se,t[10]=(E*j-T*O+R*F)*se,t[11]=(m*O-d*j-x*F)*se,t[12]=(o*X-s*ee-c*W)*se,t[13]=(r*ee-n*X+i*W)*se,t[14]=(T*N-E*U-A*F)*se,t[15]=(d*U-m*N+b*F)*se,t):null}function n7e(t){const e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],s=t[5],o=t[6],c=t[7],f=t[8],d=t[9],m=t[10],b=t[11],x=t[12],E=t[13],T=t[14],A=t[15],R=e*s-r*a,F=e*o-n*a,N=r*o-n*s,O=f*E-d*x,U=f*T-m*x,j=d*T-m*E,H=e*j-r*U+n*O,W=a*j-s*U+o*O,X=f*N-d*F+m*R,oe=x*N-E*F+T*R;return c*H-i*W+A*X-b*oe}function qm(t,e,r){const n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],c=e[5],f=e[6],d=e[7],m=e[8],b=e[9],x=e[10],E=e[11],T=e[12],A=e[13],R=e[14],F=e[15];let N=r[0],O=r[1],U=r[2],j=r[3];return t[0]=N*n+O*o+U*m+j*T,t[1]=N*i+O*c+U*b+j*A,t[2]=N*a+O*f+U*x+j*R,t[3]=N*s+O*d+U*E+j*F,N=r[4],O=r[5],U=r[6],j=r[7],t[4]=N*n+O*o+U*m+j*T,t[5]=N*i+O*c+U*b+j*A,t[6]=N*a+O*f+U*x+j*R,t[7]=N*s+O*d+U*E+j*F,N=r[8],O=r[9],U=r[10],j=r[11],t[8]=N*n+O*o+U*m+j*T,t[9]=N*i+O*c+U*b+j*A,t[10]=N*a+O*f+U*x+j*R,t[11]=N*s+O*d+U*E+j*F,N=r[12],O=r[13],U=r[14],j=r[15],t[12]=N*n+O*o+U*m+j*T,t[13]=N*i+O*c+U*b+j*A,t[14]=N*a+O*f+U*x+j*R,t[15]=N*s+O*d+U*E+j*F,t}function pT(t,e,r){const n=r[0],i=r[1],a=r[2];let s,o,c,f,d,m,b,x,E,T,A,R;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*a+e[12],t[13]=e[1]*n+e[5]*i+e[9]*a+e[13],t[14]=e[2]*n+e[6]*i+e[10]*a+e[14],t[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(s=e[0],o=e[1],c=e[2],f=e[3],d=e[4],m=e[5],b=e[6],x=e[7],E=e[8],T=e[9],A=e[10],R=e[11],t[0]=s,t[1]=o,t[2]=c,t[3]=f,t[4]=d,t[5]=m,t[6]=b,t[7]=x,t[8]=E,t[9]=T,t[10]=A,t[11]=R,t[12]=s*n+d*i+E*a+e[12],t[13]=o*n+m*i+T*a+e[13],t[14]=c*n+b*i+A*a+e[14],t[15]=f*n+x*i+R*a+e[15]),t}function t6(t,e,r){const n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function i7e(t,e,r,n){let i=n[0],a=n[1],s=n[2],o=Math.sqrt(i*i+a*a+s*s),c,f,d,m,b,x,E,T,A,R,F,N,O,U,j,H,W,X,oe,ee,G,ae,se,fe;return o<PS?null:(o=1/o,i*=o,a*=o,s*=o,f=Math.sin(r),c=Math.cos(r),d=1-c,m=e[0],b=e[1],x=e[2],E=e[3],T=e[4],A=e[5],R=e[6],F=e[7],N=e[8],O=e[9],U=e[10],j=e[11],H=i*i*d+c,W=a*i*d+s*f,X=s*i*d-a*f,oe=i*a*d-s*f,ee=a*a*d+c,G=s*a*d+i*f,ae=i*s*d+a*f,se=a*s*d-i*f,fe=s*s*d+c,t[0]=m*H+T*W+N*X,t[1]=b*H+A*W+O*X,t[2]=x*H+R*W+U*X,t[3]=E*H+F*W+j*X,t[4]=m*oe+T*ee+N*G,t[5]=b*oe+A*ee+O*G,t[6]=x*oe+R*ee+U*G,t[7]=E*oe+F*ee+j*G,t[8]=m*ae+T*se+N*fe,t[9]=b*ae+A*se+O*fe,t[10]=x*ae+R*se+U*fe,t[11]=E*ae+F*se+j*fe,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Fre(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[4],s=e[5],o=e[6],c=e[7],f=e[8],d=e[9],m=e[10],b=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+f*n,t[5]=s*i+d*n,t[6]=o*i+m*n,t[7]=c*i+b*n,t[8]=f*i-a*n,t[9]=d*i-s*n,t[10]=m*i-o*n,t[11]=b*i-c*n,t}function a7e(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],c=e[3],f=e[8],d=e[9],m=e[10],b=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-f*n,t[1]=s*i-d*n,t[2]=o*i-m*n,t[3]=c*i-b*n,t[8]=a*n+f*i,t[9]=s*n+d*i,t[10]=o*n+m*i,t[11]=c*n+b*i,t}function Bre(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],c=e[3],f=e[4],d=e[5],m=e[6],b=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+f*n,t[1]=s*i+d*n,t[2]=o*i+m*n,t[3]=c*i+b*n,t[4]=f*i-a*n,t[5]=d*i-s*n,t[6]=m*i-o*n,t[7]=b*i-c*n,t}function o7e(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],s=r+r,o=n+n,c=i+i,f=r*s,d=n*s,m=n*o,b=i*s,x=i*o,E=i*c,T=a*s,A=a*o,R=a*c;return t[0]=1-m-E,t[1]=d+R,t[2]=b-A,t[3]=0,t[4]=d-R,t[5]=1-f-E,t[6]=x+T,t[7]=0,t[8]=b+A,t[9]=x-T,t[10]=1-f-m,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function s7e(t,e,r,n,i,a,s){const o=1/(r-e),c=1/(i-n),f=1/(a-s);return t[0]=a*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*c,t[6]=0,t[7]=0,t[8]=(r+e)*o,t[9]=(i+n)*c,t[10]=(s+a)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*a*2*f,t[15]=0,t}function l7e(t,e,r,n,i){const a=1/Math.tan(e/2);if(t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){const s=1/(n-i);t[10]=(i+n)*s,t[14]=2*i*n*s}else t[10]=-1,t[14]=-2*n;return t}const u7e=l7e;function c7e(t,e,r,n,i,a,s){const o=1/(e-r),c=1/(n-i),f=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(e+r)*o,t[13]=(i+n)*c,t[14]=(s+a)*f,t[15]=1,t}const f7e=c7e;function h7e(t,e,r,n){let i,a,s,o,c,f,d,m,b,x;const E=e[0],T=e[1],A=e[2],R=n[0],F=n[1],N=n[2],O=r[0],U=r[1],j=r[2];return Math.abs(E-O)<PS&&Math.abs(T-U)<PS&&Math.abs(A-j)<PS?t7e(t):(m=E-O,b=T-U,x=A-j,i=1/Math.sqrt(m*m+b*b+x*x),m*=i,b*=i,x*=i,a=F*x-N*b,s=N*m-R*x,o=R*b-F*m,i=Math.sqrt(a*a+s*s+o*o),i?(i=1/i,a*=i,s*=i,o*=i):(a=0,s=0,o=0),c=b*o-x*s,f=x*a-m*o,d=m*s-b*a,i=Math.sqrt(c*c+f*f+d*d),i?(i=1/i,c*=i,f*=i,d*=i):(c=0,f=0,d=0),t[0]=a,t[1]=c,t[2]=m,t[3]=0,t[4]=s,t[5]=f,t[6]=b,t[7]=0,t[8]=o,t[9]=d,t[10]=x,t[11]=0,t[12]=-(a*E+s*T+o*A),t[13]=-(c*E+f*T+d*A),t[14]=-(m*E+b*T+x*A),t[15]=1,t)}function d7e(){const t=new n_(4);return n_!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function zre(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function I_(t,e,r){const n=e[0],i=e[1],a=e[2],s=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*s,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*s,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*s,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*s,t}(function(){const t=d7e();return function(e,r,n,i,a,s){let o,c;for(r||(r=4),n||(n=0),i?c=Math.min(i*r+n,e.length):c=e.length,o=n;o<c;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var iD;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(iD||(iD={}));const p7e=45*Math.PI/180,g7e=1,KP=.1,JP=500,m7e=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Mh extends e7e{static get IDENTITY(){return v7e()}static get ZERO(){return y7e()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return iD}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,r,n,i,a,s,o,c,f,d,m,b,x,E,T,A){return this[0]=e,this[1]=r,this[2]=n,this[3]=i,this[4]=a,this[5]=s,this[6]=o,this[7]=c,this[8]=f,this[9]=d,this[10]=m,this[11]=b,this[12]=x,this[13]=E,this[14]=T,this[15]=A,this.check()}setRowMajor(e,r,n,i,a,s,o,c,f,d,m,b,x,E,T,A){return this[0]=e,this[1]=a,this[2]=f,this[3]=x,this[4]=r,this[5]=s,this[6]=d,this[7]=E,this[8]=n,this[9]=o,this[10]=m,this[11]=T,this[12]=i,this[13]=c,this[14]=b,this[15]=A,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(m7e)}fromObject(e){return this.check()}fromQuaternion(e){return o7e(this,e),this.check()}frustum(e){const{left:r,right:n,bottom:i,top:a,near:s=KP,far:o=JP}=e;return o===1/0?_7e(this,r,n,i,a,s):s7e(this,r,n,i,a,s,o),this.check()}lookAt(e){const{eye:r,center:n=[0,0,0],up:i=[0,1,0]}=e;return h7e(this,r,n,i),this.check()}ortho(e){const{left:r,right:n,bottom:i,top:a,near:s=KP,far:o=JP}=e;return f7e(this,r,n,i,a,s,o),this.check()}orthographic(e){const{fovy:r=p7e,aspect:n=g7e,focalDistance:i=1,near:a=KP,far:s=JP}=e;xG(r);const o=r/2,c=i*Math.tan(o),f=c*n;return this.ortho({left:-f,right:f,bottom:-c,top:c,near:a,far:s})}perspective(e){const{fovy:r=45*Math.PI/180,aspect:n=1,near:i=.1,far:a=500}=e;return xG(r),u7e(this,r,n,i,a),this.check()}determinant(){return n7e(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),i=1/n[0],a=1/n[1],s=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*s,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*a,e[6]=this[6]*s,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*a,e[10]=this[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,r){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),i=1/n[0],a=1/n[1],s=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*s,e[3]=this[4]*i,e[4]=this[5]*a,e[5]=this[6]*s,e[6]=this[8]*i,e[7]=this[9]*a,e[8]=this[10]*s,e}transpose(){return r7e(this,this),this.check()}invert(){return nD(this,this),this.check()}multiplyLeft(e){return qm(this,e,this),this.check()}multiplyRight(e){return qm(this,this,e),this.check()}rotateX(e){return Fre(this,this,e),this.check()}rotateY(e){return a7e(this,this,e),this.check()}rotateZ(e){return Bre(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,r){return i7e(this,this,e,r),this.check()}scale(e){return t6(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return pT(this,this,e),this.check()}transform(e,r){return e.length===4?(r=I_(r||[-0,-0,-0,-0],e,this),XP(r,4),r):this.transformAsPoint(e,r)}transformAsPoint(e,r){const{length:n}=e;let i;switch(n){case 2:i=Nje(r||[-0,-0],e,this);break;case 3:i=Lre(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return XP(i,e.length),i}transformAsVector(e,r){let n;switch(e.length){case 2:n=Fje(r||[-0,-0],e,this);break;case 3:n=Ore(r||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return XP(n,e.length),n}transformPoint(e,r){return this.transformAsPoint(e,r)}transformVector(e,r){return this.transformAsPoint(e,r)}transformDirection(e,r){return this.transformAsVector(e,r)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,r,n){return this.identity().translate([e,r,n])}}let Gw,Ww;function y7e(){return Gw||(Gw=new Mh([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Gw)),Gw}function v7e(){return Ww||(Ww=new Mh,Object.freeze(Ww)),Ww}function xG(t){if(t>Math.PI*2)throw Error("expected radians")}function _7e(t,e,r,n,i,a){const s=2*a/(r-e),o=2*a/(i-n),c=(r+e)/(r-e),f=(i+n)/(i-n),d=-1,m=-1,b=-2*a;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=c,t[9]=f,t[10]=d,t[11]=m,t[12]=0,t[13]=0,t[14]=b,t[15]=0,t}function jre(t,e=[],r=0){const n=Math.fround(t),i=t-n;return e[r]=n,e[r+1]=i,e}function b7e(t){return t-Math.fround(t)}function x7e(t){const e=new Float32Array(32);for(let r=0;r<4;++r)for(let n=0;n<4;++n){const i=r*4+n;jre(t[n*4+r],e,i*2)}return e}const w7e=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,S7e={name:"fp32",vs:w7e},E7e=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,T7e={ONE:1},C7e={name:"fp64arithmetic",vs:E7e,defaultUniforms:T7e,uniformTypes:{ONE:"f32"},fp64ify:jre,fp64LowPart:b7e,fp64ifyMatrix4:x7e},A7e=[0,1,1,1],I7e=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,P7e=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,wG={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:A7e},vs:I7e,fs:P7e,getUniforms:M7e};function M7e(t={},e){const r={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)r.isHighlightActive=!1;else{r.isHighlightActive=!0;const n=t.highlightedObjectColor.slice(0,3);r.highlightedObjectColor=n}if(t.highlightColor){const n=Array.from(t.highlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),r.highlightColor=n}return t.isActive!==void 0&&(r.isActive=!!t.isActive,r.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(r.useFloatColors=!!t.useFloatColors),r}const SG=`precision highp int;

// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  vec3 color;
};

struct PointLight {
  vec3 color;
  vec3 position;
  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform lightingUniforms {
  int enabled;
  int lightType;

  int directionalLightCount;
  int pointLightCount;

  vec3 ambientColor;

  vec3 lightColor0;
  vec3 lightPosition0;
  vec3 lightDirection0;
  vec3 lightAttenuation0;

  vec3 lightColor1;
  vec3 lightPosition1;
  vec3 lightDirection1;
  vec3 lightAttenuation1;

  vec3 lightColor2;
  vec3 lightPosition2;
  vec3 lightDirection2;
  vec3 lightAttenuation2;
} lighting;

PointLight lighting_getPointLight(int index) {
  switch (index) {
    case 0:
      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);
    case 1:
      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);
    case 2:
    default:  
      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);
  }
}

DirectionalLight lighting_getDirectionalLight(int index) {
  switch (index) {
    case 0:
      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);
    case 1:
      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);
    case 2:
    default:   
      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);
  }
} 

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

// #endif
`,k7e=`// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  color: vec3<f32>,
};

struct PointLight {
  color: vec3<f32>,
  position: vec3<f32>,
  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  color: vec3<f32>,
  direction: vec3<f32>,
};

struct lightingUniforms {
  enabled: i32,
  pointLightCount: i32,
  directionalLightCount: i32,

  ambientColor: vec3<f32>,

  // TODO - support multiple lights by uncommenting arrays below
  lightType: i32,
  lightColor: vec3<f32>,
  lightDirection: vec3<f32>,
  lightPosition: vec3<f32>,
  lightAttenuation: vec3<f32>,

  // AmbientLight ambientLight;
  // PointLight pointLight[MAX_LIGHTS];
  // DirectionalLight directionalLight[MAX_LIGHTS];
};

// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)
@binding(1) @group(0) var<uniform> lighting : lightingUniforms;

fn lighting_getPointLight(index: i32) -> PointLight {
  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);
}

fn lighting_getDirectionalLight(index: i32) -> DirectionalLight {
  return DirectionalLight(lighting.lightColor, lighting.lightDirection);
} 

fn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}
`,Ure=3,R7e=255;var hx;(function(t){t[t.POINT=0]="POINT",t[t.DIRECTIONAL=1]="DIRECTIONAL"})(hx||(hx={}));const Eb={props:{},uniforms:{},name:"lighting",defines:{MAX_LIGHTS:Ure},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientLightColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:hx.POINT,directionalLightCount:0,pointLightCount:0,ambientLightColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:k7e,vs:SG,fs:SG,getUniforms:D7e};function D7e(t,e={}){if(t=t&&{...t},!t)return{...Eb.defaultUniforms};t.lights&&(t={...t,...L7e(t.lights),lights:void 0});const{ambientLight:r,pointLights:n,directionalLights:i}=t||{};if(!(r||n&&n.length>0||i&&i.length>0))return{...Eb.defaultUniforms,enabled:0};const s={...Eb.defaultUniforms,...e,...O7e({ambientLight:r,pointLights:n,directionalLights:i})};return t.enabled!==void 0&&(s.enabled=t.enabled?1:0),s}function O7e({ambientLight:t,pointLights:e=[],directionalLights:r=[]}){const n={};n.ambientLightColor=QP(t);let i=0;for(const a of e){n.lightType=hx.POINT;const s=i;n[`lightColor${s}`]=QP(a),n[`lightPosition${s}`]=a.position,n[`lightAttenuation${s}`]=a.attenuation||[1,0,0],i++}for(const a of r){n.lightType=hx.DIRECTIONAL;const s=i;n[`lightColor${s}`]=QP(a),n[`lightDirection${s}`]=a.direction,i++}return i>Ure&&gn.warn("MAX_LIGHTS exceeded")(),n.directionalLightCount=r.length,n.pointLightCount=e.length,n}function L7e(t){const e={pointLights:[],directionalLights:[]};for(const r of t||[])switch(r.type){case"ambient":e.ambientLight=r;break;case"directional":e.directionalLights?.push(r);break;case"point":e.pointLights?.push(r);break}return e}function QP(t={}){const{color:e=[0,0,0],intensity:r=1}=t;return e.map(n=>n*r/R7e)}const Vre=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;
`,$re=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
  vec3 halfway_direction = normalize(light_direction + view_direction);
  float lambertian = dot(light_direction, normal_worldspace);
  float specular = 0.0;
  if (lambertian > 0.0) {
    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  vec3 view_direction = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  for (int i = 0; i < lighting.pointLightCount; i++) {
    PointLight pointLight = lighting_getPointLight(i);
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);
  }

  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);
  for (int i = lighting.pointLightCount; i < totalLights; i++) {
    DirectionalLight directionalLight = lighting_getDirectionalLight(i);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
}
`,qre=`struct phongMaterialUniforms {
  ambient: f32,
  diffuse: f32,
  shininess: f32,
  specularColor: vec3<f32>,
};

@binding(2) @group(0) var<uniform> phongMaterial : phongMaterialUniforms;

fn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {
  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);
  var lambertian: f32 = dot(light_direction, normal_worldspace);
  var specular: f32 = 0.0;
  if (lambertian > 0.0) {
    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, phongMaterial.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * phongMaterial.diffuse * surfaceColor + specular * phongMaterial.specularColor) * color;
}

fn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {
  var lightColor: vec3<f32> = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);
  lightColor = phongMaterial.ambient * surfaceColor * lighting.ambientColor;

  if (lighting.lightType == 0) {
    let pointLight: PointLight  = lighting_getPointLight(0);
    let light_position_worldspace: vec3<f32> = pointLight.position;
    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  } else if (lighting.lightType == 1) {
    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
  /*
  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.pointLightCount) {
      break;
    }
    PointLight pointLight = lighting.pointLight[i];
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  }

  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.directionalLightCount) {
      break;
    }
    DirectionalLight directionalLight = lighting.directionalLight[i];
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  */
}

fn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{
  var lightColor = vec3<f32>(0, 0, 0);
  let surfaceColor = vec3<f32>(0, 0, 0);

  if (lighting.enabled == 0) {
    let view_direction = normalize(cameraPosition - position_worldspace);

    switch (lighting.lightType) {
      case 0, default: {
        let pointLight: PointLight = lighting_getPointLight(0);
        let light_position_worldspace: vec3<f32> = pointLight.position;
        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
      }
      case 1: {
        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
      }
    }
  }
  return lightColor;
}
`,Hre={props:{},name:"gouraudMaterial",vs:$re.replace("phongMaterial","gouraudMaterial"),fs:Vre.replace("phongMaterial","gouraudMaterial"),source:qre.replaceAll("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:1},dependencies:[Eb],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){const e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(r=>r/255)),{...Hre.defaultUniforms,...e}}},Gre={name:"phongMaterial",dependencies:[Eb],source:qre,vs:Vre,fs:$re,defines:{LIGHTING_FRAGMENT:1},uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){const e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(r=>r/255)),{...Gre.defaultUniforms,...e}}},EG=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,N7e={name:"layer",vs:EG,fs:EG,getUniforms:t=>({opacity:Math.pow(t.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},F7e=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,Wre="#define SMOOTH_EDGE_RADIUS 0.5",B7e=`${Wre}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,z7e=`${Wre}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,Xre={name:"geometry",source:F7e,vs:B7e,fs:z7e},j7e=25;var Cl;(function(t){t[t.Start=1]="Start",t[t.Move=2]="Move",t[t.End=4]="End",t[t.Cancel=8]="Cancel"})(Cl||(Cl={}));var Ll;(function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Up=4]="Up",t[t.Down=8]="Down",t[t.Horizontal=3]="Horizontal",t[t.Vertical=12]="Vertical",t[t.All=15]="All"})(Ll||(Ll={}));var Gi;(function(t){t[t.Possible=1]="Possible",t[t.Began=2]="Began",t[t.Changed=4]="Changed",t[t.Ended=8]="Ended",t[t.Recognized=8]="Recognized",t[t.Cancelled=16]="Cancelled",t[t.Failed=32]="Failed"})(Gi||(Gi={}));const U7e="compute",V7e="auto",aD="manipulation",MS="none",oD="pan-x",sD="pan-y";function $7e(t){if(t.includes(MS))return MS;const e=t.includes(oD),r=t.includes(sD);return e&&r?MS:e||r?e?oD:sD:t.includes(aD)?aD:V7e}class q7e{constructor(e,r){this.actions="",this.manager=e,this.set(r)}set(e){e===U7e&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const r of this.manager.recognizers)r.options.enable&&(e=e.concat(r.getTouchAction()));return $7e(e.join(" "))}}function gT(t){return t.trim().split(/\s+/g)}function eM(t,e,r){if(t)for(const n of gT(e))t.addEventListener(n,r,!1)}function tM(t,e,r){if(t)for(const n of gT(e))t.removeEventListener(n,r,!1)}function TG(t){return(t.ownerDocument||t).defaultView}function H7e(t,e){let r=t;for(;r;){if(r===e)return!0;r=r.parentNode}return!1}function Yre(t){const e=t.length;if(e===1)return{x:Math.round(t[0].clientX),y:Math.round(t[0].clientY)};let r=0,n=0,i=0;for(;i<e;)r+=t[i].clientX,n+=t[i].clientY,i++;return{x:Math.round(r/e),y:Math.round(n/e)}}function CG(t){const e=[];let r=0;for(;r<t.pointers.length;)e[r]={clientX:Math.round(t.pointers[r].clientX),clientY:Math.round(t.pointers[r].clientY)},r++;return{timeStamp:Date.now(),pointers:e,center:Yre(e),deltaX:t.deltaX,deltaY:t.deltaY}}function Zre(t,e){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}function AG(t,e){const r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.sqrt(r*r+n*n)}function G7e(t,e){const r=e.x-t.x,n=e.y-t.y;return Math.atan2(n,r)*180/Math.PI}function IG(t,e){const r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.atan2(n,r)*180/Math.PI}function Kre(t,e){return t===e?Ll.None:Math.abs(t)>=Math.abs(e)?t<0?Ll.Left:Ll.Right:e<0?Ll.Up:Ll.Down}function W7e(t,e){const r=e.center;let n=t.offsetDelta,i=t.prevDelta;const a=t.prevInput;return(e.eventType===Cl.Start||a?.eventType===Cl.End)&&(i=t.prevDelta={x:a?.deltaX||0,y:a?.deltaY||0},n=t.offsetDelta={x:r.x,y:r.y}),{deltaX:i.x+(r.x-n.x),deltaY:i.y+(r.y-n.y)}}function Jre(t,e,r){return{x:e/t||0,y:r/t||0}}function X7e(t,e){return AG(e[0],e[1])/AG(t[0],t[1])}function Y7e(t,e){return IG(e[1],e[0])-IG(t[1],t[0])}function Z7e(t,e){const r=t.lastInterval||e,n=e.timeStamp-r.timeStamp;let i,a,s,o;if(e.eventType!==Cl.Cancel&&(n>j7e||r.velocity===void 0)){const c=e.deltaX-r.deltaX,f=e.deltaY-r.deltaY,d=Jre(n,c,f);a=d.x,s=d.y,i=Math.abs(d.x)>Math.abs(d.y)?d.x:d.y,o=Kre(c,f),t.lastInterval=e}else i=r.velocity,a=r.velocityX,s=r.velocityY,o=r.direction;e.velocity=i,e.velocityX=a,e.velocityY=s,e.direction=o}function K7e(t,e){const{session:r}=t,{pointers:n}=e,{length:i}=n;r.firstInput||(r.firstInput=CG(e)),i>1&&!r.firstMultiple?r.firstMultiple=CG(e):i===1&&(r.firstMultiple=!1);const{firstInput:a,firstMultiple:s}=r,o=s?s.center:a.center,c=e.center=Yre(n);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=G7e(o,c),e.distance=Zre(o,c);const{deltaX:f,deltaY:d}=W7e(r,e);e.deltaX=f,e.deltaY=d,e.offsetDirection=Kre(e.deltaX,e.deltaY);const m=Jre(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=m.x,e.overallVelocityY=m.y,e.overallVelocity=Math.abs(m.x)>Math.abs(m.y)?m.x:m.y,e.scale=s?X7e(s.pointers,n):1,e.rotation=s?Y7e(s.pointers,n):0,e.maxPointers=r.prevInput?e.pointers.length>r.prevInput.maxPointers?e.pointers.length:r.prevInput.maxPointers:e.pointers.length;let b=t.element;return H7e(e.srcEvent.target,b)&&(b=e.srcEvent.target),e.target=b,Z7e(r,e),e}function J7e(t,e,r){const n=r.pointers.length,i=r.changedPointers.length,a=e&Cl.Start&&n-i===0,s=e&(Cl.End|Cl.Cancel)&&n-i===0;r.isFirst=!!a,r.isFinal=!!s,a&&(t.session={}),r.eventType=e;const o=K7e(t,r);t.emit("hammer.input",o),t.recognize(o),t.session.prevInput=o}let Q7e=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=r=>{this.manager.options.enable&&this.handler(r)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,r){J7e(this.manager,e,r)}init(){eM(this.element,this.evEl,this.domHandler),eM(this.target,this.evTarget,this.domHandler),eM(TG(this.element),this.evWin,this.domHandler)}destroy(){tM(this.element,this.evEl,this.domHandler),tM(this.target,this.evTarget,this.domHandler),tM(TG(this.element),this.evWin,this.domHandler)}};const eUe={pointerdown:Cl.Start,pointermove:Cl.Move,pointerup:Cl.End,pointercancel:Cl.Cancel,pointerout:Cl.Cancel},tUe="pointerdown",rUe="pointermove pointerup pointercancel";class nUe extends Q7e{constructor(e){super(e),this.evEl=tUe,this.evWin=rUe,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:r}=this;let n=!1;const i=eUe[e.type],a=e.pointerType,s=a==="touch";let o=r.findIndex(c=>c.pointerId===e.pointerId);i&Cl.Start&&(e.buttons||s)?o<0&&(r.push(e),o=r.length-1):i&(Cl.End|Cl.Cancel)&&(n=!0),!(o<0)&&(r[o]=e,this.callback(i,{pointers:r,changedPointers:[e],eventType:i,pointerType:a,srcEvent:e}),n&&r.splice(o,1))}}const iUe=["","webkit","Moz","MS","ms","o"];function aUe(t,e){const r=e[0].toUpperCase()+e.slice(1);for(const n of iUe){const i=n?n+r:e;if(i in t)return i}}const oUe=1,PG=2,MG={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class sUe{constructor(e,r){this.options={...MG,...r,cssProps:{...MG.cssProps,...r.cssProps},inputTarget:r.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new nUe(this),this.touchAction=new q7e(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?PG:oUe}recognize(e){const{session:r}=this;if(r.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let n;const{recognizers:i}=this;let{curRecognizer:a}=r;(!a||a&&a.state&Gi.Recognized)&&(a=r.curRecognizer=null);let s=0;for(;s<i.length;)n=i[s],r.stopped!==PG&&(!a||n===a||n.canRecognizeWith(a))?n.recognize(e):n.reset(),!a&&n.state&(Gi.Began|Gi.Changed|Gi.Ended)&&(a=r.curRecognizer=n),s++}get(e){const{recognizers:r}=this;for(let n=0;n<r.length;n++)if(r[n].options.event===e)return r[n];return null}add(e){if(Array.isArray(e)){for(const n of e)this.add(n);return this}const r=this.get(e.options.event);return r&&this.remove(r),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const n of e)this.remove(n);return this}const r=typeof e=="string"?this.get(e):e;if(r){const{recognizers:n}=this,i=n.indexOf(r);i!==-1&&(n.splice(i,1),this.touchAction.update())}return this}on(e,r){if(!e||!r)return;const{handlers:n}=this;for(const i of gT(e))n[i]=n[i]||[],n[i].push(r)}off(e,r){if(!e)return;const{handlers:n}=this;for(const i of gT(e))r?n[i]&&n[i].splice(n[i].indexOf(r),1):delete n[i]}emit(e,r){const n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;const i=r;i.type=e,i.preventDefault=function(){r.srcEvent.preventDefault()};let a=0;for(;a<n.length;)n[a](i),a++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:r}=this;if(r){for(const[n,i]of Object.entries(this.options.cssProps)){const a=aUe(r.style,n);e?(this.oldCssProps[a]=r.style[a],r.style[a]=i):r.style[a]=this.oldCssProps[a]||""}e||(this.oldCssProps={})}}}let lUe=1;function uUe(){return lUe++}function kG(t){return t&Gi.Cancelled?"cancel":t&Gi.Ended?"end":t&Gi.Changed?"move":t&Gi.Began?"start":""}class Qre{constructor(e){this.options=e,this.id=uUe(),this.state=Gi.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const i of e)this.recognizeWith(i);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;const{simultaneous:n}=this;return n[r.id]||(n[r.id]=r,r.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const n of e)this.dropRecognizeWith(n);return this}let r;return typeof e=="string"?r=this.manager.get(e):r=e,r&&delete this.simultaneous[r.id],this}requireFailure(e){if(Array.isArray(e)){for(const i of e)this.requireFailure(i);return this}let r;if(typeof e=="string"){if(r=this.manager.get(e),!r)throw new Error(`Cannot find recognizer ${e}`)}else r=e;const{requireFail:n}=this;return n.indexOf(r)===-1&&(n.push(r),r.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const n of e)this.dropRequireFailure(n);return this}let r;if(typeof e=="string"?r=this.manager.get(e):r=e,r){const n=this.requireFail.indexOf(r);n>-1&&this.requireFail.splice(n,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;const{state:r}=this;r<Gi.Ended&&this.manager.emit(this.options.event+kG(r),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),r>=Gi.Ended&&this.manager.emit(this.options.event+kG(r),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Gi.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Gi.Failed|Gi.Possible)))return!1;e++}return!0}recognize(e){const r={...e};if(!this.options.enable){this.reset(),this.state=Gi.Failed;return}this.state&(Gi.Recognized|Gi.Cancelled|Gi.Failed)&&(this.state=Gi.Possible),this.state=this.process(r),this.state&(Gi.Began|Gi.Changed|Gi.Ended|Gi.Cancelled)&&this.tryEmit(r)}getEventNames(){return[this.options.event]}reset(){}}class ene extends Qre{attrTest(e){const r=this.options.pointers;return r===0||e.pointers.length===r}process(e){const{state:r}=this,{eventType:n}=e,i=r&(Gi.Began|Gi.Changed),a=this.attrTest(e);return i&&(n&Cl.Cancel||!a)?r|Gi.Cancelled:i||a?n&Cl.End?r|Gi.Ended:r&Gi.Began?r|Gi.Changed:Gi.Began:Gi.Failed}}class RG extends Qre{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[aD]}process(e){const{options:r}=this,n=e.pointers.length===r.pointers,i=e.distance<r.threshold,a=e.deltaTime<r.time;if(this.reset(),e.eventType&Cl.Start&&this.count===0)return this.failTimeout();if(i&&a&&n){if(e.eventType!==Cl.End)return this.failTimeout();const s=this.pTime?e.timeStamp-this.pTime<r.interval:!0,o=!this.pCenter||Zre(this.pCenter,e.center)<r.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!o||!s?this.count=1:this.count+=1,this._input=e,this.count%r.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Gi.Recognized,this.tryEmit(this._input)},r.interval),Gi.Began):Gi.Recognized}return Gi.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Gi.Failed},this.options.interval),Gi.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Gi.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const cUe=["","start","move","end","cancel","up","down","left","right"];class DG extends ene{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:Ll.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,r=[];return e&Ll.Horizontal&&r.push(sD),e&Ll.Vertical&&r.push(oD),r}getEventNames(){return cUe.map(e=>this.options.event+e)}directionTest(e){const{options:r}=this;let n=!0,{distance:i}=e,{direction:a}=e;const s=e.deltaX,o=e.deltaY;return a&r.direction||(r.direction&Ll.Horizontal?(a=s===0?Ll.None:s<0?Ll.Left:Ll.Right,n=s!==this.pX,i=Math.abs(e.deltaX)):(a=o===0?Ll.None:o<0?Ll.Up:Ll.Down,n=o!==this.pY,i=Math.abs(e.deltaY))),e.direction=a,n&&i>r.threshold&&!!(a&r.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&Gi.Began)||!(this.state&Gi.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const r=Ll[e.direction].toLowerCase();r&&(e.additionalEvent=this.options.event+r),super.emit(e)}}const fUe=["","start","move","end","cancel","in","out"];class hUe extends ene{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[MS]}getEventNames(){return fUe.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&Gi.Began))}emit(e){if(e.scale!==1){const r=e.scale<1?"in":"out";e.additionalEvent=this.options.event+r}super.emit(e)}}class K3{constructor(e,r,n){this.element=e,this.callback=r,this.options=n}}const dUe=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",pUe=dUe.indexOf("firefox")!==-1,OG=4.000244140625,gUe=40,mUe=.25;class yUe extends K3{constructor(e,r,n){super(e,r,{enable:!0,...n}),this.handleEvent=i=>{if(!this.options.enable)return;let a=i.deltaY;globalThis.WheelEvent&&(pUe&&i.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(a/=globalThis.devicePixelRatio),i.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(a*=gUe)),a!==0&&a%OG===0&&(a=Math.floor(a/OG)),i.shiftKey&&a&&(a=a*mUe),this.callback({type:"wheel",center:{x:i.clientX,y:i.clientY},delta:-a,srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,r){e==="wheel"&&(this.options.enable=r)}}const LG=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class vUe extends K3{constructor(e,r,n){super(e,r,{enable:!0,...n}),this.handleEvent=a=>{this.handleOverEvent(a),this.handleOutEvent(a),this.handleEnterEvent(a),this.handleLeaveEvent(a),this.handleMoveEvent(a)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,LG.forEach(a=>e.addEventListener(a,this.handleEvent))}destroy(){LG.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){switch(e){case"pointermove":this.enableMoveEvent=r;break;case"pointerover":this.enableOverEvent=r;break;case"pointerout":this.enableOutEvent=r;break;case"pointerenter":this.enableEnterEvent=r;break;case"pointerleave":this.enableLeaveEvent=r;break}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break}}_emit(e,r){this.callback({type:e,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})}}const NG=["keydown","keyup"];class _Ue extends K3{constructor(e,r,n){super(e,r,{enable:!0,tabIndex:0,...n}),this.handleEvent=i=>{const a=i.target||i.srcElement;a.tagName==="INPUT"&&a.type==="text"||a.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:"keydown",srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:"keyup",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",NG.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){NG.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,r){e==="keydown"&&(this.enableDownEvent=r),e==="keyup"&&(this.enableUpEvent=r)}}class bUe extends K3{constructor(e,r,n){super(e,r,n),this.handleEvent=i=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,r){e==="contextmenu"&&(this.options.enable=r)}}const FG=1,lD=2,BG=4,xUe={pointerdown:FG,pointermove:lD,pointerup:BG,mousedown:FG,mousemove:lD,mouseup:BG},wUe=0,SUe=1,EUe=2,TUe=1,CUe=2,AUe=4;function IUe(t){const e=xUe[t.srcEvent.type];if(!e)return null;const{buttons:r,button:n}=t.srcEvent;let i=!1,a=!1,s=!1;return e===lD?(i=!!(r&TUe),a=!!(r&AUe),s=!!(r&CUe)):(i=n===wUe,a=n===SUe,s=n===EUe),{leftButton:i,middleButton:a,rightButton:s}}function PUe(t,e){const r=t.center;if(!r)return null;const n=e.getBoundingClientRect(),i=n.width/e.offsetWidth||1,a=n.height/e.offsetHeight||1,s={x:(r.x-n.left-e.clientLeft)/i,y:(r.y-n.top-e.clientTop)/a};return{center:r,offsetCenter:s}}const MUe={srcElement:"root",priority:0};class kUe{constructor(e,r){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let a=n.srcEvent.target;for(;a&&a!==i.rootElement;){if(this._emit(i,a),i.handled)return;a=a.parentNode}this._emit(i,"root")},this.eventManager=e,this.recognizerName=r,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,r,n,i=!1,a=!1){const{handlers:s,handlersByElement:o}=this,c={...MUe,...n};let f=o.get(c.srcElement);f||(f=[],o.set(c.srcElement,f));const d={type:e,handler:r,srcElement:c.srcElement,priority:c.priority};i&&(d.once=!0),a&&(d.passive=!0),s.push(d),this._active=this._active||!d.passive;let m=f.length-1;for(;m>=0&&!(f[m].priority>=d.priority);)m--;f.splice(m+1,0,d)}remove(e,r){const{handlers:n,handlersByElement:i}=this;for(let a=n.length-1;a>=0;a--){const s=n[a];if(s.type===e&&s.handler===r){n.splice(a,1);const o=i.get(s.srcElement);o.splice(o.indexOf(s),1),o.length===0&&i.delete(s.srcElement)}}this._active=n.some(a=>!a.passive)}_emit(e,r){const n=this.handlersByElement.get(r);if(n){let i=!1;const a=()=>{e.handled=!0},s=()=>{e.handled=!0,i=!0},o=[];for(let c=0;c<n.length;c++){const{type:f,handler:d,once:m}=n[c];if(d({...e,type:f,stopPropagation:a,stopImmediatePropagation:s}),m&&o.push(n[c]),i)break}for(let c=0;c<o.length;c++){const{type:f,handler:d}=o[c];this.remove(f,d)}}}_normalizeEvent(e){const r=this.eventManager.getElement();return{...e,...IUe(e),...PUe(e,r),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:r}}}function RUe(t){if("recognizer"in t)return t;let e;const r=Array.isArray(t)?[...t]:[t];if(typeof r[0]=="function"){const n=r.shift(),i=r.shift()||{};e=new n(i)}else e=r.shift();return{recognizer:e,recognizeWith:typeof r[0]=="string"?[r[0]]:r[0],requireFailure:typeof r[1]=="string"?[r[1]]:r[1]}}class DUe{constructor(e=null,r={}){if(this._onBasicInput=n=>{this.manager.emit(n.srcEvent.type,n)},this._onOtherEvent=n=>{this.manager.emit(n.type,n)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...r},this.events=new Map,this.element=e,!!e){this.manager=new sUe(e,this.options);for(const n of this.options.recognizers){const{recognizer:i,recognizeWith:a,requireFailure:s}=RUe(n);this.manager.add(i),a&&i.recognizeWith(a),s&&i.requireFailure(s)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new yUe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new vUe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new _Ue(e,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new bUe(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,r,n){this._addEventHandler(e,r,n,!1)}once(e,r,n){this._addEventHandler(e,r,n,!0)}watch(e,r,n){this._addEventHandler(e,r,n,!1,!0)}off(e,r){this._removeEventHandler(e,r)}_toggleRecognizer(e,r){const{manager:n}=this;if(!n)return;const i=n.get(e);i&&(i.set({enable:r}),n.touchAction.update()),this.wheelInput?.enableEventType(e,r),this.moveInput?.enableEventType(e,r),this.keyInput?.enableEventType(e,r),this.contextmenuInput?.enableEventType(e,r)}_addEventHandler(e,r,n,i,a){if(typeof e!="string"){n=r;for(const[f,d]of Object.entries(e))this._addEventHandler(f,d,n,i,a);return}const{manager:s,events:o}=this;if(!s)return;let c=o.get(e);if(!c){const f=this._getRecognizerName(e)||e;c=new kUe(this,f),o.set(e,c),s&&s.on(e,c.handleEvent)}c.add(e,r,n,i,a),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,r){if(typeof e!="string"){for(const[a,s]of Object.entries(e))this._removeEventHandler(a,s);return}const{events:n}=this,i=n.get(e);if(i&&(i.remove(e,r),i.isEmpty())){const{recognizerName:a}=i;let s=!1;for(const o of n.values())if(o.recognizerName===a&&!o.isEmpty()){s=!0;break}s||this._toggleRecognizer(a,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(r=>r.getEventNames().includes(e))?.options.event}}const Xa={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Xa,"IDENTITY",{get:()=>(oo.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const sf={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},i_={common:0,meters:1,pixels:2},uD={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},zG={multipan:[DG,{threshold:10,direction:Ll.Vertical,pointers:2}],pinch:[hUe,{},null,["multipan"]],pan:[DG,{threshold:1},["pinch"],["multipan"]],dblclick:[RG,{event:"dblclick",taps:2}],click:[RG,{event:"click"},null,["dblclick"]]};function OUe(t,e){if(t===e)return!0;if(Array.isArray(t)){const r=t.length;if(!e||e.length!==r)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}return!1}function n2(t){let e={},r;return n=>{for(const i in n)if(!OUe(n[i],e[i])){r=t(n),e=n;break}return r}}const jG=[0,0,0,0],LUe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],tne=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],NUe=[0,0,0],rne=[0,0,0],FUe=n2(jUe);function nne(t,e,r=rne){r.length<3&&(r=[r[0],r[1],0]);let n=r,i,a=!0;switch(e===Xa.LNGLAT_OFFSETS||e===Xa.METER_OFFSETS?i=r:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case sf.WEB_MERCATOR:(e===Xa.LNGLAT||e===Xa.CARTESIAN)&&(i=[0,0,0],a=!1);break;case sf.WEB_MERCATOR_AUTO_OFFSET:e===Xa.LNGLAT?n=i:e===Xa.CARTESIAN&&(n=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(n),n[0]-=r[0],n[1]-=r[1],n[2]-=r[2]);break;case sf.IDENTITY:n=t.position.map(Math.fround),n[2]=n[2]||0;break;case sf.GLOBE:a=!1,i=null;break;default:a=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:a}}function BUe(t,e,r){const{viewMatrixUncentered:n,projectionMatrix:i}=t;let{viewMatrix:a,viewProjectionMatrix:s}=t,o=jG,c=jG,f=t.cameraPosition;const{geospatialOrigin:d,shaderCoordinateOrigin:m,offsetMode:b}=nne(t,e,r);return b&&(c=t.projectPosition(d||m),f=[f[0]-c[0],f[1]-c[1],f[2]-c[2]],c[3]=1,o=I_([],c,s),a=n||a,s=qm([],i,a),s=qm([],s,LUe)),{viewMatrix:a,viewProjectionMatrix:s,projectionCenter:o,originCommon:c,cameraPosCommon:f,shaderCoordinateOrigin:m,geospatialOrigin:d}}function zUe({viewport:t,devicePixelRatio:e=1,modelMatrix:r=null,coordinateSystem:n=Xa.DEFAULT,coordinateOrigin:i=rne,autoWrapLongitude:a=!1}){n===Xa.DEFAULT&&(n=t.isGeospatial?Xa.LNGLAT:Xa.CARTESIAN);const s=FUe({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i});return s.wrapLongitude=a,s.modelMatrix=r||tne,s}function jUe({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:n}){const{projectionCenter:i,viewProjectionMatrix:a,originCommon:s,cameraPosCommon:o,shaderCoordinateOrigin:c,geospatialOrigin:f}=BUe(t,r,n),d=t.getDistanceScales(),m=[t.width*e,t.height*e],b=I_([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,x={coordinateSystem:r,projectionMode:t.projectionMode,coordinateOrigin:c,commonOrigin:s.slice(0,3),center:i,pseudoMeters:!!t._pseudoMeters,viewportSize:m,devicePixelRatio:e,focalDistance:b,commonUnitsPerMeter:d.unitsPerMeter,commonUnitsPerWorldUnit:d.unitsPerMeter,commonUnitsPerWorldUnit2:NUe,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:a,modelMatrix:tne,cameraPosition:o};if(f){const E=t.getDistanceScales(f);switch(r){case Xa.METER_OFFSETS:x.commonUnitsPerWorldUnit=E.unitsPerMeter,x.commonUnitsPerWorldUnit2=E.unitsPerMeter2;break;case Xa.LNGLAT:case Xa.LNGLAT_OFFSETS:t._pseudoMeters||(x.commonUnitsPerMeter=E.unitsPerMeter),x.commonUnitsPerWorldUnit=E.unitsPerDegree,x.commonUnitsPerWorldUnit2=E.unitsPerDegree2;break;case Xa.CARTESIAN:x.commonUnitsPerWorldUnit=[1,1,E.unitsPerMeter[2]],x.commonUnitsPerWorldUnit2=[0,0,E.unitsPerMeter2[2]];break}}return x}const UUe=Object.keys(Xa).map(t=>`const COORDINATE_SYSTEM_${t}: i32 = ${Xa[t]};`).join(""),VUe=Object.keys(sf).map(t=>`const PROJECTION_MODE_${t}: i32 = ${sf[t]};`).join(""),$Ue=Object.keys(i_).map(t=>`const UNIT_${t.toUpperCase()}: i32 = ${i_[t]};`).join(""),qUe=`${UUe}
${VUe}
${$Ue}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,HUe=`${qUe}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the zaxis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`,GUe=Object.keys(Xa).map(t=>`const int COORDINATE_SYSTEM_${t} = ${Xa[t]};`).join(""),WUe=Object.keys(sf).map(t=>`const int PROJECTION_MODE_${t} = ${sf[t]};`).join(""),XUe=Object.keys(i_).map(t=>`const int UNIT_${t.toUpperCase()} = ${i_[t]};`).join(""),YUe=`${GUe}
${WUe}
${XUe}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`,ZUe={};function KUe(t=ZUe){return"viewport"in t?zUe(t):{}}const r6={name:"project",dependencies:[S7e,Xre],source:HUe,vs:YUe,getUniforms:KUe,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},JUe=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,QUe=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,ine={name:"project32",dependencies:[r6],source:JUe,vs:QUe};function eVe(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function M0(t,e){const r=I_([],e,t);return zre(r,r,1/r[3]),r}function UG(t,e){const r=t%e;return r<0?e+r:r}function cD(t,e,r){return t<e?e:t>r?r:t}function tVe(t){return Math.log(t)*Math.LOG2E}const n6=Math.log2||tVe;function Cp(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const wh=Math.PI,ane=wh/4,jf=wh/180,fD=180/wh,a_=512,mT=4003e4,gg=85.051129,rVe=1.5;function nVe(t){return n6(t)}function dx(t){const[e,r]=t;Cp(Number.isFinite(e)),Cp(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");const n=e*jf,i=r*jf,a=a_*(n+wh)/(2*wh),s=a_*(wh+Math.log(Math.tan(ane+i*.5)))/(2*wh);return[a,s]}function o_(t){const[e,r]=t,n=e/a_*(2*wh)-wh,i=2*(Math.atan(Math.exp(r/a_*(2*wh)-wh))-ane);return[n*fD,i*fD]}function iVe(t){const{latitude:e}=t;Cp(Number.isFinite(e));const r=Math.cos(e*jf);return nVe(mT*r)-9}function kS(t){const e=Math.cos(t*jf);return a_/mT/e}function hD(t){const{latitude:e,longitude:r,highPrecision:n=!1}=t;Cp(Number.isFinite(e)&&Number.isFinite(r));const i=a_,a=Math.cos(e*jf),s=i/360,o=s/a,c=i/mT/a,f={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[s,o,c],degreesPerUnit:[1/s,1/o,1/c]};if(n){const d=jf*Math.tan(e*jf)/a,m=s*d/2,b=i/mT*d,x=b/o*c;f.unitsPerDegree2=[0,m,b],f.unitsPerMeter2=[x,0,x]}return f}function one(t,e){const[r,n,i]=t,[a,s,o]=e,{unitsPerMeter:c,unitsPerMeter2:f}=hD({longitude:r,latitude:n,highPrecision:!0}),d=dx(t);d[0]+=a*(c[0]+f[0]*s),d[1]+=s*(c[1]+f[1]*s);const m=o_(d),b=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[m[0],m[1],b]:m}function aVe(t){const{height:e,pitch:r,bearing:n,altitude:i,scale:a,center:s}=t,o=eVe();pT(o,o,[0,0,-i]),Fre(o,o,-r*jf),Bre(o,o,n*jf);const c=a/e;return t6(o,o,[c,c,c]),s&&pT(o,o,$je([],s)),o}function oVe(t){const{width:e,height:r,altitude:n,pitch:i=0,offset:a,center:s,scale:o,nearZMultiplier:c=1,farZMultiplier:f=1}=t;let{fovy:d=px(rVe)}=t;n!==void 0&&(d=px(n));const m=d*jf,b=i*jf,x=i6(d);let E=x;s&&(E+=s[2]*o/Math.cos(b)/r);const T=m*(.5+(a?a[1]:0)/r),A=Math.sin(T)*E/Math.sin(cD(Math.PI/2-b-T,.01,Math.PI-.01)),R=Math.sin(b)*A+E,F=E*10,N=Math.min(R*f,F);return{fov:m,aspect:e/r,focalDistance:x,near:c,far:N}}function px(t){return 2*Math.atan(.5/t)*fD}function i6(t){return .5/Math.tan(.5*t*jf)}function sne(t,e){const[r,n,i=0]=t;return Cp(Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)),M0(e,[r,n,i,1])}function a6(t,e,r=0){const[n,i,a]=t;if(Cp(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(a))return M0(e,[n,i,a,1]);const s=M0(e,[n,i,0,1]),o=M0(e,[n,i,1,1]),c=s[2],f=o[2],d=c===f?0:((r||0)-c)/(f-c);return Dre([],s,o,d)}function sVe(t){const{width:e,height:r,bounds:n,minExtent:i=0,maxZoom:a=24,offset:s=[0,0]}=t,[[o,c],[f,d]]=n,m=lVe(t.padding),b=dx([o,cD(d,-gg,gg)]),x=dx([f,cD(c,-gg,gg)]),E=[Math.max(Math.abs(x[0]-b[0]),i),Math.max(Math.abs(x[1]-b[1]),i)],T=[e-m.left-m.right-Math.abs(s[0])*2,r-m.top-m.bottom-Math.abs(s[1])*2];Cp(T[0]>0&&T[1]>0);const A=T[0]/E[0],R=T[1]/E[1],F=(m.right-m.left)/2/A,N=(m.top-m.bottom)/2/R,O=[(x[0]+b[0])/2+F,(x[1]+b[1])/2+N],U=o_(O),j=Math.min(a,n6(Math.abs(Math.min(A,R))));return Cp(Number.isFinite(j)),{longitude:U[0],latitude:U[1],zoom:j}}function lVe(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Cp(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const VG=Math.PI/180;function uVe(t,e=0){const{width:r,height:n,unproject:i}=t,a={targetZ:e},s=i([0,n],a),o=i([r,n],a);let c,f;const d=t.fovy?.5*t.fovy*VG:Math.atan(.5/t.altitude),m=(90-t.pitch)*VG;return d>m-.01?(c=$G(t,0,e),f=$G(t,r,e)):(c=i([0,0],a),f=i([r,0],a)),[s,o,f,c]}function $G(t,e,r){const{pixelUnprojectionMatrix:n}=t,i=M0(n,[e,0,1,1]),a=M0(n,[e,t.height,1,1]),o=(r*t.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),c=Dre([],i,a,o),f=o_(c);return f.push(r),f}const qG=512;function cVe(t){const{width:e,height:r,pitch:n=0}=t;let{longitude:i,latitude:a,zoom:s,bearing:o=0}=t;(i<-180||i>180)&&(i=UG(i+180,360)-180),(o<-180||o>180)&&(o=UG(o+180,360)-180);const c=n6(r/qG);if(s<=c)s=c,a=0;else{const f=r/2/Math.pow(2,s),d=o_([0,f])[1];if(a<d)a=d;else{const m=o_([0,qG-f])[1];a>m&&(a=m)}}return{width:e,height:r,longitude:i,latitude:a,zoom:s,pitch:n,bearing:o}}const lne=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,fVe=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,hVe=`
${lne}
${fVe}
`,dVe=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,pVe=`
${lne}
${dVe}
`,gVe=n2(bVe),mVe=n2(xVe),yVe=[0,0,0,1],vVe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function _Ve(t,e){const[r,n,i]=t,a=a6([r,n,i],e);return Number.isFinite(i)?a:[a[0],a[1],0]}function bVe({viewport:t,center:e}){return new Mh(t.viewProjectionMatrix).invert().transform(e)}function xVe({viewport:t,shadowMatrices:e}){const r=[],n=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,a=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(s=>_Ve(s,n));for(const s of e){const o=s.clone().translate(new Td(t.center).negate()),c=a.map(d=>o.transform(d)),f=new Mh().ortho({left:Math.min(...c.map(d=>d[0])),right:Math.max(...c.map(d=>d[0])),bottom:Math.min(...c.map(d=>d[1])),top:Math.max(...c.map(d=>d[1])),near:Math.min(...c.map(d=>-d[2])),far:Math.max(...c.map(d=>-d[2]))});r.push(f.multiplyRight(s))}return r}function wVe(t){const{shadowEnabled:e=!0,project:r}=t;if(!e||!r||!t.shadowMatrices||!t.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};const n=r6.getUniforms(r),i=gVe({viewport:r.viewport,center:n.center}),a=[],s=mVe({shadowMatrices:t.shadowMatrices,viewport:r.viewport}).slice();for(let c=0;c<t.shadowMatrices.length;c++){const f=s[c],d=f.clone().translate(new Td(r.viewport.center).negate());n.coordinateSystem===Xa.LNGLAT&&n.projectionMode===sf.WEB_MERCATOR?(s[c]=d,a[c]=i):(s[c]=f.clone().multiplyRight(vVe),a[c]=d.transform(i))}const o={drawShadowMap:!!t.drawToShadowMap,useShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,color:t.shadowColor||yVe,lightId:t.shadowLightId||0,lightCount:t.shadowMatrices.length,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};for(let c=0;c<s.length;c++)o[`viewProjectionMatrix${c}`]=s[c],o[`projectCenter${c}`]=a[c];for(let c=0;c<2;c++)o[`shadow_uShadowMap${c}`]=t.shadowMaps&&t.shadowMaps[c]||t.dummyShadowMap;return o}const HG={name:"shadow",dependencies:[r6],vs:hVe,fs:pVe,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:wVe,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},SVe={...wG,defaultUniforms:{...wG.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},EVe=[Xre],TVe=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],CVe=[];function AVe(t){const e=Rm.getDefaultShaderAssembler();for(const n of EVe)e.addDefaultModule(n);const r=t==="glsl"?TVe:CVe;for(const n of r)e.addShaderHook(n);return e}const IVe=[255,255,255],PVe=1;let MVe=0;class kVe{constructor(e={}){this.type="ambient";const{color:r=IVe}=e,{intensity:n=PVe}=e;this.id=e.id||`ambient-${MVe++}`,this.color=r,this.intensity=n}}const RVe=[255,255,255],DVe=1,OVe=[0,0,-1];let LVe=0;class GG{constructor(e={}){this.type="directional";const{color:r=RVe}=e,{intensity:n=DVe}=e,{direction:i=OVe}=e,{_shadow:a=!1}=e;this.id=e.id||`directional-${LVe++}`,this.color=r,this.intensity=n,this.type="directional",this.direction=new Td(i).normalize().toArray(),this.shadow=a}getProjectedLight(e){return this}}class NVe{constructor(e,r={id:"pass"}){const{id:n}=r;this.id=n,this.device=e,this.props={...r}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class o6 extends NVe{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[r,n]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,a=e.clearColor??(i?[0,0,0,0]:!1),s=i?1:!1,o=i?0:!1,c=e.colorMask??15,f={viewport:[0,0,r,n]};e.colorMask&&(f.colorMask=c),e.scissorRect&&(f.scissorRect=e.scissorRect);const d=this.device.beginRenderPass({framebuffer:e.target,parameters:f,clearColor:a,clearDepth:s,clearStencil:o});try{return this._drawLayers(d,e)}finally{d.end(),this.device.submit()}}_drawLayers(e,r){const{target:n,shaderModuleProps:i,viewports:a,views:s,onViewportActive:o,clearStack:c=!0}=r;r.pass=r.pass||"unknown",c&&(this._lastRenderIndex=-1);const f=[];for(const d of a){const m=s&&s[d.id];o?.(d);const b=this._getDrawLayerParams(d,r),x=d.subViewports||[d];for(const E of x){const T=this._drawLayersInViewport(e,{target:n,shaderModuleProps:i,viewport:E,view:m,pass:r.pass,layers:r.layers},b);f.push(T)}}return f}_getDrawLayerParams(e,{layers:r,pass:n,isPicking:i=!1,layerFilter:a,cullRect:s,effects:o,shaderModuleProps:c},f=!1){const d=[],m=une(this._lastRenderIndex+1),b={layer:r[0],viewport:e,isPicking:i,renderPass:n,cullRect:s},x={};for(let E=0;E<r.length;E++){const T=r[E],A=this._shouldDrawLayer(T,b,a,x),R={shouldDrawLayer:A};A&&!f&&(R.shouldDrawLayer=!0,R.layerRenderIndex=m(T,A),R.shaderModuleProps=this._getShaderModuleProps(T,o,n,c),R.layerParameters={...T.context.deck?.props.parameters,...this.getLayerParameters(T,E,e)}),d[E]=R}return d}_drawLayersInViewport(e,{layers:r,shaderModuleProps:n,pass:i,target:a,viewport:s,view:o},c){const f=FVe(this.device,{shaderModuleProps:n,target:a,viewport:s});if(o&&o.props.clear){const m=o.props.clear===!0?{color:!0,depth:!0}:o.props.clear;this.device.beginRenderPass({framebuffer:a,parameters:{viewport:f,scissorRect:f},clearColor:m.color?[0,0,0,0]:!1,clearDepth:m.depth?1:!1}).end()}const d={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:f});for(let m=0;m<r.length;m++){const b=r[m],x=c[m],{shouldDrawLayer:E}=x;if(E&&b.props.pickable&&d.pickableCount++,b.isComposite&&d.compositeCount++,b.isDrawable&&x.shouldDrawLayer){const{layerRenderIndex:T,shaderModuleProps:A,layerParameters:R}=x;d.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,T),A.project&&(A.project.viewport=s),b.context.renderPass=e;try{b._drawLayer({renderPass:e,shaderModuleProps:A,uniforms:{layerIndex:T},parameters:R})}catch(F){b.raiseError(F,`drawing ${b} to ${i}`)}}}return d}shouldDrawLayer(e){return!0}getShaderModuleProps(e,r,n){return null}getLayerParameters(e,r,n){return e.props.parameters}_shouldDrawLayer(e,r,n,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;r.layer=e;let s=e.parent;for(;s;){if(!s.props.visible||!s.filterSubLayer(r))return!1;r.layer=s,s=s.parent}if(n){const o=r.layer.id;if(o in i||(i[o]=n(r)),!i[o])return!1}return e.activateViewport(r.viewport),!0}_getShaderModuleProps(e,r,n,i){const a=this.device.canvasContext.cssToDeviceRatio(),s=e.internalState?.propsInTransition||e.props,o={layer:s,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:a,modelMatrix:s.modelMatrix,coordinateSystem:s.coordinateSystem,coordinateOrigin:s.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(r)for(const c of r)WG(o,c.getShaderModuleProps?.(e,o));return WG(o,this.getShaderModuleProps(e,r,o),i)}}function une(t=0,e={}){const r={},n=(i,a)=>{const s=i.props._offset,o=i.id,c=i.parent&&i.parent.id;let f;if(c&&!(c in e)&&n(i.parent,!1),c in r){const d=r[c]=r[c]||une(e[c],e);f=d(i,a),r[o]=d}else Number.isFinite(s)?(f=s+(e[c]||0),r[o]=null):f=t;return a&&f>=t&&(t=f+1),e[o]=f,f};return n}function FVe(t,{shaderModuleProps:e,target:r,viewport:n}){const i=e?.project?.devicePixelRatio??t.canvasContext.cssToDeviceRatio(),[,a]=t.canvasContext.getDrawingBufferSize(),s=r?r.height:a,o=n;return[o.x*i,s-(o.y+o.height)*i,o.width*i,o.height*i]}function WG(t,...e){for(const r of e)if(r)for(const n in r)t[n]?Object.assign(t[n],r[n]):t[n]=r[n];return t}class BVe extends o6{constructor(e,r){super(e,r);const n=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},mipmaps:!0}),i=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[n],depthStencilAttachment:i})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const r=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],a=i.width*n,s=i.height*n,o=[1,1,1,1];(a!==r.width||s!==r.height)&&r.resize({width:a,height:s}),super.render({...e,clearColor:o,target:r,pass:"shadow"})}getLayerParameters(e,r,n){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,r,n){return{shadow:{project:n.project,drawToShadowMap:!0}}}}const zVe={color:[255,255,255],intensity:1},XG=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],jVe=[0,0,0,200/255];class cne{constructor(e={}){this.id="lighting-effect",this.shadowColor=jVe,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:r,deck:n}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(r),n._addDefaultShaderModule(HG),this.dummyShadowMap=r.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const r in e){const n=e[r];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(r=>r.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:a}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let s=0;s<this.shadowPasses.length;s++)this.shadowPasses[s].render({layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:a,shaderModuleProps:{shadow:{shadowLightId:s,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,r){const n=this.shadow?{project:r.project,shadowMaps:this.shadowPasses.map(s=>s.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},i={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(s=>s.getProjectedLight({layer:e})),pointLights:this.pointLights.map(s=>s.getProjectedLight({layer:e}))},a=e.props.material;return{shadow:n,lighting:i,phongMaterial:a,gouraudMaterial:a}}cleanup(e){for(const r of this.shadowPasses)r.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(HG))}_calculateMatrices(){const e=[];for(const r of this.directionalLights){const n=new Mh().lookAt({eye:new Td(r.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let r=0;r<this.directionalLights.length;r++){const n=new BVe(e);this.shadowPasses[r]=n}}_applyDefaultLights(){const{ambientLight:e,pointLights:r,directionalLights:n}=this;!e&&r.length===0&&n.length===0&&(this.ambientLight=new kVe(zVe),this.directionalLights.push(new GG(XG[0]),new GG(XG[1])))}}class UVe{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,r,{size:n=1,type:i,padding:a=0,copy:s=!1,initialize:o=!1,maxCount:c}){const f=i||e&&e.constructor||Float32Array,d=r*n+a;if(ArrayBuffer.isView(e)){if(d<=e.length)return e;if(d*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new f(e.buffer,0,d)}let m=1/0;c&&(m=c*n+a);const b=this._allocate(f,d,o,m);return e&&s?b.set(e):o||b.fill(0,0,4),this._release(e),b}release(e){this._release(e)}_allocate(e,r,n,i){let a=Math.max(Math.ceil(r*this.opts.overAlloc),1);a>i&&(a=i);const s=this._pool,o=e.BYTES_PER_ELEMENT*a,c=s.findIndex(f=>f.byteLength>=o);if(c>=0){const f=new e(s.splice(c,1)[0],0,a);return n&&f.fill(0),f}return new e(a)}_release(e){if(!ArrayBuffer.isView(e))return;const r=this._pool,{buffer:n}=e,{byteLength:i}=n,a=r.findIndex(s=>s.byteLength>=i);a<0?r.push(n):(a>0||r.length<this.opts.poolSize)&&r.splice(a,0,n),r.length>this.opts.poolSize&&r.shift()}}const gx=new UVe;function Q1(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function VVe(t,e){const r=t%e;return r<0?e+r:r}function $Ve(t){return[t[12],t[13],t[14]]}function qVe(t){return{left:Iv(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Iv(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Iv(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Iv(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Iv(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Iv(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const YG=new Td;function Iv(t,e,r,n){YG.set(t,e,r);const i=YG.len();return{distance:n/i,normal:new Td(-t/i,-e/i,-r/i)}}function HVe(t){return t-Math.fround(t)}let T1;function rM(t,e){const{size:r=1,startIndex:n=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,a=(i-n)/r;T1=gx.allocate(T1,a,{type:Float32Array,size:r*2});let s=n,o=0;for(;s<i;){for(let c=0;c<r;c++){const f=t[s++];T1[o+c]=f,T1[o+c+r]=HVe(f)}o+=r*2}return T1.subarray(0,a*r*2)}function GVe(t){let e=null,r=!1;for(const n of t)n&&(e?(r||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],r=!0),e[0][0]=Math.min(e[0][0],n[0][0]),e[0][1]=Math.min(e[0][1],n[0][1]),e[1][0]=Math.max(e[1][0],n[1][0]),e[1][1]=Math.max(e[1][1],n[1][1])):e=n);return e}const WVe=Math.PI/180,XVe=Q1(),ZG=[0,0,0],YVe={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function ZVe({width:t,height:e,orthographic:r,fovyRadians:n,focalDistance:i,padding:a,near:s,far:o}){const c=t/e,f=r?new Mh().orthographic({fovy:n,aspect:c,focalDistance:i,near:s,far:o}):new Mh().perspective({fovy:n,aspect:c,near:s,far:o});if(a){const{left:d=0,right:m=0,top:b=0,bottom:x=0}=a,E=pd((d+t-m)/2,0,t)-t/2,T=pd((b+e-x)/2,0,e)-e/2;f[8]-=E*2/t,f[9]+=T*2/e}return f}class Ry{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||YVe,this.focalDistance=e.focalDistance||1,this.position=e.position||ZG,this.modelMatrix=e.modelMatrix||null;const{longitude:r,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(r),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?sf.WEB_MERCATOR:sf.WEB_MERCATOR_AUTO_OFFSET:sf.IDENTITY}equals(e){return e instanceof Ry?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&fx(e.projectionMatrix,this.projectionMatrix)&&fx(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:r=!0}={}){const n=this.projectPosition(e),i=sne(n,this.pixelProjectionMatrix),[a,s]=i,o=r?s:this.height-s;return e.length===2?[a,o]:[a,o,i[2]]}unproject(e,{topLeft:r=!0,targetZ:n}={}){const[i,a,s]=e,o=r?a:this.height-a,c=n&&n*this.distanceScales.unitsPerMeter[2],f=a6([i,o,s],this.pixelUnprojectionMatrix,c),[d,m,b]=this.unprojectPosition(f);return Number.isFinite(s)?[d,m,b]:Number.isFinite(n)?[d,m,n]:[d,m]}projectPosition(e){const[r,n]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[r,n,i]}unprojectPosition(e){const[r,n]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[r,n,i]}projectFlat(e){if(this.isGeospatial){const r=dx(e);return r[1]=pd(r[1],-318,830),r}return e}unprojectFlat(e){return this.isGeospatial?o_(e):e}getBounds(e={}){const r={targetZ:e.z||0},n=this.unproject([0,0],r),i=this.unproject([this.width,0],r),a=this.unproject([0,this.height],r),s=this.unproject([this.width,this.height],r);return[Math.min(n[0],i[0],a[0],s[0]),Math.min(n[1],i[1],a[1],s[1]),Math.max(n[0],i[0],a[0],s[0]),Math.max(n[1],i[1],a[1],s[1])]}getDistanceScales(e){return e&&this.isGeospatial?hD({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:r,width:n=1,height:i=1}){return e<this.x+this.width&&this.x<e+n&&r<this.y+this.height&&this.y<r+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,qVe(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,r){return null}_initProps(e){const r=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=iVe({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||hD({latitude:n,longitude:r}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:a,modelMatrix:s}=e;let o=ZG;if(a&&(o=s?new Mh(s).transformAsVector(a,[]):a),this.isGeospatial){const c=this.projectPosition([r,n,0]);this.center=new Td(o).scale(this.distanceScales.unitsPerMeter).add(c)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:r=XVe,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:a,fovy:s=75,near:o=.1,far:c=1e3,padding:f=null,focalDistance:d=1}=e;this.viewMatrixUncentered=r,this.viewMatrix=new Mh().multiplyRight(r).translate(new Td(this.center).negate()),this.projectionMatrix=n||ZVe({width:this.width,height:this.height,orthographic:i,fovyRadians:a||s*WVe,focalDistance:d,padding:f,near:o,far:c});const m=Q1();qm(m,m,this.projectionMatrix),qm(m,m,this.viewMatrix),this.viewProjectionMatrix=m,this.viewMatrixInverse=nD([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=$Ve(this.viewMatrixInverse);const b=Q1(),x=Q1();t6(b,b,[this.width/2,-this.height/2,1]),pT(b,b,[1,-1,0]),qm(x,b,this.viewProjectionMatrix),this.pixelProjectionMatrix=x,this.pixelUnprojectionMatrix=nD(Q1(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||oo.warn("Pixel project matrix not invertible")()}}Ry.displayName="Viewport";class hy extends Ry{constructor(e={}){const{latitude:r=0,longitude:n=0,zoom:i=0,pitch:a=0,bearing:s=0,nearZMultiplier:o=.1,farZMultiplier:c=1.01,nearZ:f,farZ:d,orthographic:m=!1,projectionMatrix:b,repeat:x=!1,worldOffset:E=0,position:T,padding:A,legacyMeterSizes:R=!1}=e;let{width:F,height:N,altitude:O=1.5}=e;const U=Math.pow(2,i);F=F||1,N=N||1;let j,H=null;if(b)O=b[5]/2,j=px(O);else{e.fovy?(j=e.fovy,O=i6(j)):j=px(O);let X;if(A){const{top:oe=0,bottom:ee=0}=A;X=[0,pd((oe+N-ee)/2,0,N)-N/2]}H=oVe({width:F,height:N,scale:U,center:T&&[0,0,T[2]*kS(r)],offset:X,pitch:a,fovy:j,nearZMultiplier:o,farZMultiplier:c}),Number.isFinite(f)&&(H.near=f),Number.isFinite(d)&&(H.far=d)}let W=aVe({height:N,pitch:a,bearing:s,scale:U,altitude:O});E&&(W=new Mh().translate([512*E,0,0]).multiplyLeft(W)),super({...e,width:F,height:N,viewMatrix:W,longitude:n,latitude:r,zoom:i,...H,fovy:j,focalDistance:O}),this.latitude=r,this.longitude=n,this.zoom=i,this.pitch=a,this.bearing=s,this.altitude=O,this.fovy=j,this.orthographic=m,this._subViewports=x?[]:null,this._pseudoMeters=R,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),r=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let i=r;i<=n;i++){const a=i?new hy({...this,worldOffset:i}):this;this._subViewports.push(a)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[r,n]=this.projectFlat(e),i=(e[2]||0)*kS(e[1]);return[r,n,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[r,n]=this.unprojectFlat(e),i=(e[2]||0)/kS(n);return[r,n,i]}addMetersToLngLat(e,r){return one(e,r)}panByPosition(e,r){const n=a6(r,this.pixelUnprojectionMatrix),i=this.projectFlat(e),a=bG([],i,Lje([],n)),s=bG([],this.center,a),[o,c]=this.unprojectFlat(s);return{longitude:o,latitude:c}}getBounds(e={}){const r=uVe(this,e.z||0);return[Math.min(r[0][0],r[1][0],r[2][0],r[3][0]),Math.min(r[0][1],r[1][1],r[2][1],r[3][1]),Math.max(r[0][0],r[1][0],r[2][0],r[3][0]),Math.max(r[0][1],r[1][1],r[2][1],r[3][1])]}fitBounds(e,r={}){const{width:n,height:i}=this,{longitude:a,latitude:s,zoom:o}=sVe({width:n,height:i,bounds:e,...r});return new hy({width:n,height:i,longitude:a,latitude:s,zoom:o})}}hy.displayName="WebMercatorViewport";const KG=[0,0,0];function nM(t,e,r=!1){const n=e.projectPosition(t);if(r&&e instanceof hy){const[i,a,s=0]=t,o=e.getDistanceScales([i,a]);n[2]=s*o.unitsPerMeter[2]}return n}function KVe(t){const{viewport:e,modelMatrix:r,coordinateOrigin:n}=t;let{coordinateSystem:i,fromCoordinateSystem:a,fromCoordinateOrigin:s}=t;return i===Xa.DEFAULT&&(i=e.isGeospatial?Xa.LNGLAT:Xa.CARTESIAN),a===void 0&&(a=i),s===void 0&&(s=n),{viewport:e,coordinateSystem:i,coordinateOrigin:n,modelMatrix:r,fromCoordinateSystem:a,fromCoordinateOrigin:s}}function fne(t,{viewport:e,modelMatrix:r,coordinateSystem:n,coordinateOrigin:i,offsetMode:a}){let[s,o,c=0]=t;switch(r&&([s,o,c]=I_([],[s,o,c,1],r)),n){case Xa.LNGLAT:return nM([s,o,c],e,a);case Xa.LNGLAT_OFFSETS:return nM([s+i[0],o+i[1],c+(i[2]||0)],e,a);case Xa.METER_OFFSETS:return nM(one(i,[s,o,c]),e,a);case Xa.CARTESIAN:default:return e.isGeospatial?[s+i[0],o+i[1],c+i[2]]:e.projectPosition([s,o,c])}}function JVe(t,e){const{viewport:r,coordinateSystem:n,coordinateOrigin:i,modelMatrix:a,fromCoordinateSystem:s,fromCoordinateOrigin:o}=KVe(e),{autoOffset:c=!0}=e,{geospatialOrigin:f=KG,shaderCoordinateOrigin:d=KG,offsetMode:m=!1}=c?nne(r,n,i):{},b=fne(t,{viewport:r,modelMatrix:a,coordinateSystem:s,coordinateOrigin:o,offsetMode:m});if(m){const x=r.projectPosition(f||d);Nre(b,b,x)}return b}let QVe=1,e$e=1;class hne{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:r=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:a=1}=e,s=QVe++,o={time:0,delay:r,duration:n,rate:i,repeat:a};return this._setChannelTime(o,this.time),this.channels.set(s,o),s}removeChannel(e){this.channels.delete(e);for(const[r,n]of this.animations)n.channel===e&&this.detachAnimation(r)}isFinished(e){const r=this.channels.get(e);return r===void 0?!1:this.time>=r.delay+r.duration*r.repeat}getTime(e){if(e===void 0)return this.time;const r=this.channels.get(e);return r===void 0?-1:r.time}setTime(e){this.time=Math.max(0,e);const r=this.channels.values();for(const i of r)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:a,channel:s}=i;a.setTime(this.getTime(s))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,r){const n=e$e++;return this.animations.set(n,{animation:e,channel:r}),e.setTime(this.getTime(r)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,r){const n=r-e.delay,i=e.duration*e.repeat;n>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}function t$e(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function r$e(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}let n$e=0;const i$e={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:t=>console.error(t),stats:QR.stats.get(`animation-loop-${n$e++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class a$e{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...i$e,...e},e=this.props,!e.device)throw new Error("No device provided");const{useDevicePixels:r=!0}=this.props;this.stats=e.stats||new H3({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:r}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(e){if(this.props.onError(e),this._error=Error(),this.device?.canvasContext?.canvas instanceof HTMLCanvasElement){const n=document.createElement("h1");n.innerHTML=e.message,n.style.position="absolute",n.style.top="20%",n.style.left="10px",n.style.color="black",n.style.backgroundColor="red",document.body.appendChild(n)}}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const r=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(r),r}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=t$e(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(r$e(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.canvasContext?.canvas;if(!this.device||!e)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:e,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:r,aspect:n}=this._getSizeAndAspect();(e!==this.animationProps.width||r!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=r,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const r=document.createElement("div");r.style.position="absolute",r.style.left="10px",r.style.bottom="10px",r.style.width="300px",r.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(r);const n=this.props.onAddHTML(r);n&&(r.innerHTML=n)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,r]=this.device?.canvasContext?.getPixelSize()||[1,1];let n=1;const i=this.device?.canvasContext?.canvas;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:e>0&&r>0&&(n=e/r),{width:e,height:r,aspect:n}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}const iM={};function J3(t="id"){iM[t]=iM[t]||1;const e=iM[t]++;return`${t}-${e}`}class JG{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||J3("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&jo.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function o$e(t,e){if(e instanceof JG)return e;const r=s$e(t,e),{attributes:n,bufferLayout:i}=l$e(t,e);return new JG({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:r,attributes:n})}function s$e(t,e){if(!e.indices)return;const r=e.indices.value;return t.createBuffer({usage:jo.INDEX,data:r})}function l$e(t,e){const r=[],n={};for(const[a,s]of Object.entries(e.attributes)){let o=a;switch(a){case"POSITION":o="positions";break;case"NORMAL":o="normals";break;case"TEXCOORD_0":o="texCoords";break;case"COLOR_0":o="colors";break}if(s){n[o]=t.createBuffer({data:s.value,id:`${a}-buffer`});const{value:c,size:f,normalized:d}=s;r.push({name:o,format:X9e(c,f,d)})}}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:n,bufferLayout:r,vertexCount:i}}class s6{static defaultProps={...e_.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new s6(e),e._lumaData.defaultPipelineFactory}device;destroyPolicy;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createRenderPipeline(e){const r={...e_.defaultProps,...e},n=this._hashRenderPipeline(r);if(!this._renderPipelineCache[n]){const i=this.device.createRenderPipeline({...r,id:r.id?`${r.id}-cached`:void 0});i.hash=n,this._renderPipelineCache[n]={pipeline:i,useCount:0}}return this._renderPipelineCache[n].useCount++,this._renderPipelineCache[n].pipeline}createComputePipeline(e){const r={...oT.defaultProps,...e},n=this._hashComputePipeline(r);if(!this._computePipelineCache[n]){const i=this.device.createComputePipeline({...r,id:r.id?`${r.id}-cached`:void 0});i.hash=n,this._computePipelineCache[n]={pipeline:i,useCount:0}}return this._computePipelineCache[n].useCount++,this._computePipelineCache[n].pipeline}release(e){const r=e.hash,n=e instanceof oT?this._computePipelineCache:this._renderPipelineCache;n[r].useCount--,n[r].useCount===0&&this.destroyPolicy==="unused"&&(n[r].pipeline.destroy(),delete n[r])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const r=e.vs?this._getHash(e.vs.source):0,n=e.fs?this._getHash(e.fs.source):0,i="-",a=this._getHash(JSON.stringify(e.bufferLayout));switch(this.device.type){case"webgl":return`${r}/${n}V${i}BL${a}`;default:const s=this._getHash(JSON.stringify(e.parameters));return`${r}/${n}V${i}T${e.topology}P${s}BL${a}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}class l6{static defaultProps={...Y3.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new l6(e),e._lumaData.defaultShaderFactory}device;destroyPolicy;_cache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createShader(e){const r=this._hashShader(e);let n=this._cache[r];if(!n){const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[r]=n={shader:i,useCount:0}}return n.useCount++,n.shader}release(e){const r=this._hashShader(e),n=this._cache[r];n&&(n.useCount--,n.useCount===0&&this.destroyPolicy==="unused"&&(delete this._cache[r],n.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}}function u$e(t,e){const r={},n="Values";if(t.attributes.length===0&&!t.varyings?.length)return{"No attributes or varyings":{[n]:"N/A"}};for(const i of t.attributes)if(i){const a=`${i.location} ${i.name}: ${i.type}`;r[`in ${a}`]={[n]:i.stepMode||"vertex"}}for(const i of t.varyings||[]){const a=`${i.location} ${i.name}`;r[`out ${a}`]={[n]:JSON.stringify(i)}}return r}let ru=null,aM=null;function c$e(t,{id:e,minimap:r,opaque:n,top:i="0",left:a="0",rgbaScale:s=1}){ru||(ru=document.createElement("canvas"),ru.id=e,ru.title=e,ru.style.zIndex="100",ru.style.position="absolute",ru.style.top=i,ru.style.left=a,ru.style.border="blue 5px solid",ru.style.transform="scaleY(-1)",document.body.appendChild(ru),aM=ru.getContext("2d")),(ru.width!==t.width||ru.height!==t.height)&&(ru.width=t.width/2,ru.height=t.height/2,ru.style.width="400px",ru.style.height="400px");const o=t.device.readPixelsToArrayWebGL(t),c=aM?.createImageData(t.width,t.height);if(c){for(let d=0;d<o.length;d+=4)c.data[0+d+0]=o[d+0]*s,c.data[0+d+1]=o[d+1]*s,c.data[0+d+2]=o[d+2]*s,c.data[0+d+3]=n?255:o[d+3]*s;aM?.putImageData(c,0,0)}}function dD(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!dD(t[n],e[n],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const a of n)if(!e.hasOwnProperty(a)||!dD(t[a],e[a],r-1))return!1;return!0}return!1}function f$e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function h$e(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":!1}function dne(t){return f$e(t)||h$e(t)}function d$e(t){return dne(t)||typeof t=="number"||typeof t=="boolean"}function pne(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(r=>{const n=t[r];d$e(n)?e.uniforms[r]=n:e.bindings[r]=n}),e}class p$e{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,r){Object.assign(this.options,r);const n=BN(Object.values(e).filter(i=>i.dependencies));for(const i of n)e[i.name]=i;gn.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[i,a]of Object.entries(e))this._addModule(a),a.name&&i!==a.name&&!this.options.disableWarnings&&gn.warn(`Module name: ${i} vs ${a.name}`)()}destroy(){}setProps(e){for(const r of Object.keys(e)){const n=r,i=e[n]||{},a=this.modules[n];if(!a){this.options.disableWarnings||gn.warn(`Module ${r} not found`)();continue}const s=this.moduleUniforms[n],o=this.moduleBindings[n],c=a.getUniforms?.(i,s)||i,{uniforms:f,bindings:d}=pne(c);this.moduleUniforms[n]={...s,...f},this.moduleBindings[n]={...o,...d}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const r of Object.values(this.moduleBindings))Object.assign(e,r);return e}getDebugTable(){const e={};for(const[r,n]of Object.entries(this.moduleUniforms))for(const[i,a]of Object.entries(n))e[`${r}.${i}`]={type:this.modules[r].uniformTypes?.[i],value:String(a)};return e}_addModule(e){const r=e.name;this.moduleUniforms[r]=e.defaultUniforms||{},this.moduleBindings[r]={}}}let g$e="";async function m$e(t,e){const r=new Image;return r.crossOrigin="anonymous",r.src=t.startsWith("http")?t:g$e+t,await r.decode(),e?await createImageBitmap(r,e):await createImageBitmap(r)}class oM{device;id;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,r){this.device=e,this.id=r.id||J3("async-texture"),typeof r?.data=="string"&&r.dimension==="2d"&&(r={...r,data:m$e(r.data)}),this.ready=new Promise((n,i)=>{this.resolveReady=()=>{this.isReady=!0,n()},this.rejectReady=i}),this.initAsync(r)}async initAsync(e){const r=e.data;let n;try{n=await gne(r)}catch(a){this.rejectReady(a)}if(this.destroyed)return;const i={...e,data:n};this.texture=this.device.createTexture(i),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0,this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const r=this.texture;this.texture=r.clone(e),r.destroy()}return!0}}async function gne(t){if(t=await t,Array.isArray(t))return await Promise.all(t.map(gne));if(t&&typeof t=="object"&&t.constructor===Object){const e=t,r=await Promise.all(Object.values(e)),n=Object.keys(e),i={};for(let a=0;a<n.length;a++)i[n[a]]=r[a];return i}return t}const gm=2,y$e=1e4;class dy{static defaultProps={...e_.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Rm.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,r){this.props={...dy.defaultProps,...r},r=this.props,this.id=r.id||J3("model"),this.device=e,Object.assign(this.userData,r.userData);const n=Object.fromEntries(this.props.modules?.map(c=>[c.name,c])||[]),i=r.shaderInputs||new p$e(n,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(i);const a=_$e(e),s=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){const{source:c,getUniforms:f}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:a,...this.props,modules:s});this.source=c,this._getModuleUniforms=f,this.props.shaderLayout||=Tje(this.source)}else{const{vs:c,fs:f,getUniforms:d}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:a,...this.props,modules:s});this.vs=c,this.fs=f,this._getModuleUniforms=d}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,r.geometry&&this.setGeometry(r.geometry),this.pipelineFactory=r.pipelineFactory||s6.getDefaultPipelineFactory(this.device),this.shaderFactory=r.shaderFactory||l6.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in r&&(this.isInstanced=r.isInstanced),r.instanceCount&&this.setInstanceCount(r.instanceCount),r.vertexCount&&this.setVertexCount(r.vertexCount),r.indexBuffer&&this.setIndexBuffer(r.indexBuffer),r.attributes&&this.setAttributes(r.attributes),r.constantAttributes&&this.setConstantAttributes(r.constantAttributes),r.bindings&&this.setBindings(r.bindings),r.uniforms&&this.setUniformsWebGL(r.uniforms),r.moduleSettings&&this.updateModuleSettingsWebGL(r.moduleSettings),r.transformFeedback&&(this.transformFeedback=r.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const r=this._areBindingsLoading();if(r)return gn.info(gm,`>>> DRAWING ABORTED ${this.id}: ${r} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let n;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const i=this._getBindings();this.pipeline.setBindings(i,{disableWarnings:this.props.disableWarnings}),pD(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:a}=this.vertexArray,s=a?a.byteLength/(a.indexType==="uint32"?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){this._gpuGeometry?.destroy();const r=e&&o$e(this.device,e);if(r){this.setTopology(r.topology||"triangle-list");const n=new HP(this.bufferLayout);this.bufferLayout=n.mergeBufferLayouts(r.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(r)}this._gpuGeometry=r}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const r=new HP(this.bufferLayout);this.bufferLayout=this._gpuGeometry?r.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){dD(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new W9e(this.shaderInputs.modules);for(const[r,n]of Object.entries(this.shaderInputs.modules))if(v$e(n)){const i=this._uniformStore.getManagedUniformBuffer(this.device,r);this.bindings[`${r}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,r){const n=r?.disableWarnings??this.props.disableWarnings;e.indices&&gn.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=Y9e(this.pipeline.shaderLayout,this.bufferLayout);const i=new HP(this.bufferLayout);for(const[a,s]of Object.entries(e)){const o=i.getBufferLayout(a);if(!o){n||gn.warn(`Model(${this.id}): Missing layout for buffer "${a}".`)();continue}const c=i.getAttributeNamesForBuffer(o);let f=!1;for(const d of c){const m=this._attributeInfos[d];if(m){const b=this.device.type==="webgpu"?i.getBufferIndex(m.bufferName):m.location;this.vertexArray.setBuffer(b,s),f=!0}}!f&&!n&&gn.warn(`Model(${this.id}): Ignoring buffer "${s.id}" for unknown attribute "${a}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,r){for(const[n,i]of Object.entries(e)){const a=this._attributeInfos[n];a?this.vertexArray.setConstantWebGL(a.location,i):(r?.disableWarnings??this.props.disableWarnings)||gn.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){this.setUniformsWebGL(e)}setUniformsWebGL(e){pD(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL(e){const{bindings:r,uniforms:n}=pne(this._getModuleUniforms(e));Object.assign(this.bindings,r),Object.assign(this.uniforms,n),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof oM&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[r,n]of Object.entries(this.bindings))n instanceof oM?n.isReady&&(e[r]=n.texture):e[r]=n;return e}_getBindingsUpdateTimestamp(){let e=0;for(const r of Object.values(this.bindings))r instanceof X3?e=Math.max(e,r.texture.updateTimestamp):r instanceof jo||r instanceof xo?e=Math.max(e,r.updateTimestamp):r instanceof oM?e=r.texture?Math.max(e,r.texture.updateTimestamp):1/0:r instanceof ux||(e=Math.max(e,r.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const r={...e.attributes};for(const[n]of Object.entries(r))!this.pipeline.shaderLayout.attributes.find(i=>i.name===n)&&n!=="positions"&&delete r[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(r,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,r=null;this.pipeline&&(gn.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,r=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let i=null;this.source?i=n:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:i}),this._attributeInfos=sre(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),r&&this.shaderFactory.release(r)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=gn.level>3?0:y$e;gn.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,gn.group(gm,`>>> DRAWING MODEL ${this.id}`,{collapsed:gn.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=u$e(this.pipeline.shaderLayout,this.id);gn.table(gm,e)();const r=this.shaderInputs.getDebugTable();for(const[i,a]of Object.entries(this.uniforms))r[i]={value:a};gn.table(gm,r)();const n=this._getAttributeDebugTable();gn.table(gm,this._attributeInfos)(),gn.table(gm,n)(),gn.groupEnd(gm)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const r=this.device.props.debugFramebuffers;if(this._drawCount++,!r)return;const n=e.props.framebuffer;n&&c$e(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[r,n]of Object.entries(this._attributeInfos)){const i=this.vertexArray.attributes[n.location];e[n.location]={name:r,type:n.shaderType,values:i?this._getBufferOrConstantValues(i,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:r}=this.vertexArray,n=r.indexType==="uint32"?new Uint32Array(r.debugData):new Uint16Array(r.debugData);e.indices={name:"indices",type:r.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,r){const n=cre(r);return(e instanceof jo?new n(e.debugData):e).toString()}}function v$e(t){return!!(t.uniformTypes&&!pD(t.uniformTypes))}function _$e(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function pD(t){for(const e in t)return!1;return!0}class py{device;model;transformFeedback;static defaultProps={...dy.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return e?.info?.type==="webgl"}constructor(e,r=py.defaultProps){if(!py.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new dy(this.device,{id:r.id||"buffer-transform-model",fs:r.fs||Zze(),topology:r.topology||"point-list",varyings:r.outputs||r.varyings,...r}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:r.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const r=this.device.beginRenderPass(e);this.model.draw(r),r.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const r=this.getBuffer(e);if(!r)throw new Error("BufferTransform#getBuffer");if(r instanceof jo)return r.readAsync();const{buffer:n,byteOffset:i=0,byteLength:a=n.byteLength}=r;return n.readAsync(i,a)}}class b$e{id;topology;vertexCount;indices;attributes;userData={};constructor(e){const{attributes:r={},indices:n=null,vertexCount:i=null}=e;this.id=e.id||J3("geometry"),this.topology=e.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[a,s]of Object.entries(r)){const o=ArrayBuffer.isView(s)?{value:s}:s;if(!ArrayBuffer.isView(o.value))throw new Error(`${this._print(a)}: must be typed array or object with value as typed array`);if((a==="POSITION"||a==="positions")&&!o.size&&(o.size=3),a==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=o}else this.attributes[a]=o}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,r){return this}_calculateVertexCount(e,r){if(r)return r.value.length;let n=1/0;for(const i of Object.values(e)){const{value:a,size:s,constant:o}=i;!o&&a&&s!==void 0&&s>=1&&(n=Math.min(n,a.length/s))}return n}}const x$e={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class mne extends o6{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:r,views:n,viewports:i,onViewportActive:a,pickingFBO:s,deviceRect:{x:o,y:c,width:f,height:d},cullRect:m,effects:b,pass:x="picking",pickZ:E,shaderModuleProps:T}){this.pickZ=E;const A=this._resetColorEncoder(E),R=[o,c,f,d],F=super.render({target:s,layers:e,layerFilter:r,views:n,viewports:i,onViewportActive:a,cullRect:m,effects:b?.filter(O=>O.useInPicking),pass:x,isPicking:!0,shaderModuleProps:T,clearColor:[0,0,0,0],colorMask:15,scissorRect:R});return this._colorEncoderState=null,{decodePickingColor:A&&S$e.bind(null,A),stats:F}}shouldDrawLayer(e){const{pickable:r,operation:n}=e.props;return r&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getShaderModuleProps(e,r,n){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,r,n){const i={...e.props.parameters},{pickable:a,operation:s}=e.props;return!this._colorEncoderState||s.includes("terrain")?i.blend=!1:a&&s.includes("draw")&&(Object.assign(i,x$e),i.blend=!0,i.blendColor=w$e(this._colorEncoderState,e,n)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function w$e(t,e,r){const{byLayer:n,byAlpha:i}=t;let a,s=n.get(e);return s?(s.viewports.push(r),a=s.a):(a=n.size+1,a<=255?(s={a,layer:e,viewports:[r]},n.set(e,s),i[a]=s):(oo.warn("Too many pickable layers, only picking the first 255")(),a=0)),[0,0,0,a/255]}function S$e(t,e){const r=t.byAlpha[e[3]];return r&&{pickedLayer:r.layer,pickedViewports:r.viewports,pickedObjectIndex:r.layer.decodePickingColor(e)}}const e0={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},yT=Symbol.for("component"),Sg=Symbol.for("propTypes"),sM=Symbol.for("deprecatedProps"),k0=Symbol.for("asyncPropDefaults"),gy=Symbol.for("asyncPropOriginal"),mg=Symbol.for("asyncPropResolved");function s_(t,e=()=>!0){return Array.isArray(t)?yne(t,e,[]):e(t)?[t]:[]}function yne(t,e,r){let n=-1;for(;++n<t.length;){const i=t[n];Array.isArray(i)?yne(i,e,r):e(i)&&r.push(i)}return r}function E$e({target:t,source:e,start:r=0,count:n=1}){const i=e.length,a=n*i;let s=0;for(let o=r;s<i;s++)t[o++]=e[s];for(;s<a;)s<a-s?(t.copyWithin(r+s,r,r+s),s*=2):(t.copyWithin(r+s,r,r+a-s),s=a);return t}class T$e{constructor(e,r,n){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=n,this.setData(r)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,r){if(e===this._data&&!r)return;this._data=e;const n=++this._loadCount;let i=e;typeof e=="string"&&(i=WR(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(a=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=a)}).catch(a=>{this._loadCount===n&&(this.isLoaded=!0,this._error=a||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const a of this._subscribers)a.onChange(this.getData())}}class C$e{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:r,forceUpdate:n=!1,persistent:i=!0}){let a=this._resources[e];a?a.setData(r,n):(a=new T$e(e,r,this._context),this._resources[e]=a),a.persistent=i}remove(e){const r=this._resources[e];r&&(r.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const r=this._consumers[e];if(r){for(const n in r){const i=r[n],a=this._resources[i.resourceId];a&&a.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:r,consumerId:n,requestId:i="default"}){const{_resources:a,protocol:s}=this;e.startsWith(s)&&(e=e.replace(s,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=a[e];if(this._track(n,i,o,r),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,r,n,i){const a=this._consumers,s=a[e]=a[e]||{};let o=s[r];const c=o&&o.resourceId&&this._resources[o.resourceId];c&&(c.unsubscribe(o),this.prune()),n&&(o?(o.onChange=i,o.resourceId=n.id):o={onChange:i,resourceId:n.id},s[r]=o,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const r=this._resources[e];!r.persistent&&!r.inUse()&&(r.delete(),delete this._resources[e])}}}const A$e="layerManager.setLayers",I$e="layerManager.activateViewport";class P$e{constructor(e,r){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=o=>{Qu(I$e,this,o),o&&(this.context.viewport=o)};const{deck:n,stats:i,viewport:a,timeline:s}=r||{};this.layers=[],this.resourceManager=new C$e({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:n,shaderAssembler:AVe(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[N7e],renderPass:void 0,stats:i||new H3({id:"deck.gl"}),viewport:a||new Ry({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new hne,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(e);r=r||i}return r}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(r=>e.find(n=>r.id.indexOf(n)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,r){Qu(A$e,this,r,e),this._lastRenderedLayers=e;const n=s_(e,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:r}=this.context;r.find(n=>n.name===e.name)||(r.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:r}=this.context,n=r.findIndex(i=>i.name===e.name);n>=0&&(r.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(e,r,n){n.raiseError(r,`${e} of ${n}`)}_updateLayers(e,r){const n={};for(const s of e)n[s.id]?oo.warn(`Multiple old layers with same id ${s.id}`)():n[s.id]=s;if(this._defaultShaderModulesChanged){for(const s of e)s.setNeedsUpdate(),s.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(r,n,i),this._finalizeOldLayers(n);let a=!1;for(const s of i)if(s.hasUniformTransition()){a=`Uniform transition in ${s}`;break}this._needsUpdate=a,this.layers=i}_updateSublayersRecursively(e,r,n){for(const i of e){i.context=this.context;const a=r[i.id];a===null&&oo.warn(`Multiple new layers with same id ${i.id}`)(),r[i.id]=null;let s=null;try{this._debug&&a!==i&&i.validateProps(),a?(this._transferLayerState(a,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),s=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}s&&this._updateSublayersRecursively(s,r,n)}}_finalizeOldLayers(e){for(const r in e){const n=e[r];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=e0.INITIALIZED}catch(r){this._handleError("initialization",r,e)}}_transferLayerState(e,r){r._transferState(e),r.lifecycle=e0.MATCHED,r!==e&&(e.lifecycle=e0.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(r){this._handleError("update",r,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=e0.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=e0.FINALIZED}catch(r){this._handleError("finalization",r,e)}}}function Mc(t,e,r){if(t===e)return!0;if(!r||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Mc(t[n],e[n],r-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const a of n)if(!e.hasOwnProperty(a)||!Mc(t[a],e[a],r-1))return!1;return!0}return!1}class M$e{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const r=this.controllers[e];r&&r.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const r=this.controllers[e];r&&r.updateTransition()}}getViewports(e){return e?this._viewports.filter(r=>r.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(r=>{e[r.id]=r}),e}getView(e){return this.views.find(r=>r.id===e)}getViewState(e){const r=typeof e=="string"?this.getView(e):e,n=r&&this.viewState[r.getViewStateId()]||this.viewState;return r?r.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,r){const n=this.getViewports(),i={x:e[0],y:e[1]};for(let a=n.length-1;a>=0;--a){const s=n[a];if(s.containsPixel(i)){const o=e.slice();return o[0]-=s.x,o[1]-=s.y,s.unproject(o,r)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,r){(e!==this.width||r!==this.height)&&(this.width=e,this.height=r,this.setNeedsUpdate("Size changed"))}_setViews(e){e=s_(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Mc(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):oo.warn("missing `viewState` or `initialViewState`")()}_createController(e,r){const n=r.type;return new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:a=>this.getView(e.id)?.makeViewport({viewState:a,width:this.width,height:this.height})})}_updateController(e,r,n,i){const a=e.controller;if(a&&n){const s={...r,...a,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!i||i.constructor!==a.type)&&(i=this._createController(e,s)),i&&i.setProps(s),i}return null}_rebuildViewports(){const{views:e}=this,r=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=e.length;i--;){const a=e[i],s=this.getViewState(a),o=a.makeViewport({viewState:s,width:this.width,height:this.height});let c=r[a.id];const f=!!a.controller;f&&!c&&(n=!0),(n||!f)&&c&&(c.finalize(),c=null),this.controllers[a.id]=this._updateController(a,s,o,c),o&&this._viewports.unshift(o)}for(const i in r){const a=r[i];a&&!this.controllers[i]&&a.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,r){return e.length!==r.length?!0:e.some((n,i)=>!e[i].equals(r[i]))}}const k$e=/([0-9]+\.?[0-9]*)(%|px)/;function Qp(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=k$e.exec(t);if(e&&e.length>=3){const r=e[2]==="%",n=parseFloat(e[1]);return{position:r?n/100:n,relative:r}}default:throw new Error(`Could not parse position string ${t}`)}}function eg(t,e){return t.relative?Math.round(t.position*e):t.position}class vne{constructor(e){const{id:r,x:n=0,y:i=0,width:a="100%",height:s="100%",padding:o=null}=e;this.id=r||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Qp(n),this._y=Qp(i),this._width=Qp(a),this._height=Qp(s),this._padding=o&&{left:Qp(o.left||0),right:Qp(o.right||0),top:Qp(o.top||0),bottom:Qp(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&Mc(this.props,e.props,2)}makeViewport({width:e,height:r,viewState:n}){n=this.filterViewState(n);const i=this.getDimensions({width:e,height:r});if(!i.height||!i.width)return null;const a=this.getViewportType(n);return new a({...n,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const r={...e};for(const n in this.props.viewState)n!=="id"&&(r[n]=this.props.viewState[n]);return r}return e}getDimensions({width:e,height:r}){const n={x:eg(this._x,e),y:eg(this._y,r),width:eg(this._width,e),height:eg(this._height,r)};return this._padding&&(n.padding={left:eg(this._padding.left,e),top:eg(this._padding.top,r),right:eg(this._padding.right,e),bottom:eg(this._padding.bottom,r)}),n}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class Q3{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:e,settings:r}=this;this._handle=e.addChannel({delay:e.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const QG=()=>{},gD={BREAK:1,SNAP_TO_END:2,IGNORE:3},R$e=t=>t,D$e=gD.BREAK;class O$e{constructor(e){this._onTransitionUpdate=r=>{const{time:n,settings:{interpolator:i,startProps:a,endProps:s,duration:o,easing:c}}=r,f=c(n/o),d=i.interpolateProps(a,s,f);this.propsInTransition=this.getControllerState({...this.props,...d}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Q3(e.timeline),this.onViewStateChange=e.onViewStateChange||QG,this.onStateChange=e.onStateChange||QG}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let r=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let i=n;if(this.transition.inProgress){const{interruption:a,endProps:s}=this.transition.settings;i={...n,...a===gD.SNAP_TO_END?s:this.propsInTransition||n}}this._triggerTransition(i,e),r=!0}else this.transition.cancel();return r}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:r,transitionInterpolator:n}=e;return(r>0||r==="auto")&&!!n}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,r){return this.transition.inProgress?this.transition.settings.interruption===gD.IGNORE||this._isUpdateDueToCurrentTransition(r):this._isTransitionEnabled(r)?r.transitionInterpolator.arePropsEqual(e,r):!0}_triggerTransition(e,r){const n=this.getControllerState(e),i=this.getControllerState(r).shortestPathFrom(n),a=r.transitionInterpolator,s=a.getDuration?a.getDuration(e,r):r.transitionDuration;if(s===0)return;const o=a.initializeProps(e,i);this.propsInTransition={};const c={duration:s,easing:r.transitionEasing||R$e,interpolator:a,interruption:r.transitionInterruption||D$e,startProps:o.start,endProps:o.end,onStart:r.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(r.onTransitionInterrupt),onEnd:this._onTransitionEnd(r.onTransitionEnd)};this.transition.start(c),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return r=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(r)}}}function Fl(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class L$e{constructor(e){const{compare:r,extract:n,required:i}=e;this._propsToCompare=r,this._propsToExtract=n||r,this._requiredProps=i}arePropsEqual(e,r){for(const n of this._propsToCompare)if(!(n in e)||!(n in r)||!fx(e[n],r[n]))return!1;return!0}initializeProps(e,r){const n={},i={};for(const a of this._propsToExtract)(a in e||a in r)&&(n[a]=e[a],i[a]=r[a]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(e,r){return r.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(r=>{const n=e[r];Fl(Number.isFinite(n)||Array.isArray(n),`${r} is required for transition`)})}}const N$e=["longitude","latitude","zoom","bearing","pitch"],F$e=["longitude","latitude","zoom"];class u6 extends L$e{constructor(e={}){const r=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(r)?{compare:r,required:r}:r||{compare:N$e,required:F$e},super(n.transitionProps),this.opts=n}initializeProps(e,r){const n=super.initializeProps(e,r),{makeViewport:i,around:a}=this.opts;if(i&&a){const s=i(e),o=i(r),c=s.unproject(a);n.start.around=a,Object.assign(n.end,{around:o.project(c),aroundPosition:c,width:r.width,height:r.height})}return n}interpolateProps(e,r,n){const i={};for(const a of this._propsToExtract)i[a]=dT(e[a]||0,r[a]||0,n);if(r.aroundPosition&&this.opts.makeViewport){const a=this.opts.makeViewport({...r,...i});Object.assign(i,a.panByPosition(r.aroundPosition,dT(e.around,r.around,n)))}return i}}const tg={transitionDuration:0},B$e=300,Xw=t=>1-(1-t)*(1-t),Pv={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},mm={};class _ne{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new O$e({...e,getControllerState:r=>new this.ControllerState(r),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const r=this._eventStartBlocked;switch(e.type){case"panstart":return r?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return r?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return r?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:r,y:n}=this.props,{offsetCenter:i}=e;return[i.x-r,i.y-n]}isPointInBounds(e,r){const{width:n,height:i}=this.props;if(r&&r.handled)return!1;const a=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=i;return a&&r&&r.stopPropagation(),a}isFunctionKeyPressed(e){const{srcEvent:r}=e;return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const r=setTimeout(()=>{this._eventStartBlocked===r&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=r}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:r}=e;this.inertia=Number.isFinite(r)?r:r===!0?B$e:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:a=!0,doubleClickZoom:s=!0,touchZoom:o=!0,touchRotate:c=!1,keyboard:f=!0}=e,d=!!this.onViewStateChange;this.toggleEvents(Pv.WHEEL,d&&n),this.toggleEvents(Pv.PAN,d),this.toggleEvents(Pv.PINCH,d&&(o||c)),this.toggleEvents(Pv.MULTI_PAN,d&&c),this.toggleEvents(Pv.DOUBLE_CLICK,d&&s),this.toggleEvents(Pv.KEYBOARD,d&&f),this.scrollZoom=n,this.dragPan=i,this.dragRotate=a,this.doubleClickZoom=s,this.touchZoom=o,this.touchRotate=c,this.keyboard=f}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,r){this.eventManager&&e.forEach(n=>{this._events[n]!==r&&(this._events[n]=r,r?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(e,r=null,n={}){const i={...e.getViewportProps(),...r},a=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),a){const s=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:s,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:r});return this._panMove=n,this.updateViewport(i,tg,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const r=this.getCenter(e),n=this.controllerState.pan({pos:r});return this.updateViewport(n,tg,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:r}=this;if(this.dragPan&&r&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:Xw},{isDragging:!1,isPanning:!0})}else{const n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const r=this.getCenter(e),n=this.controllerState.rotate({pos:r});return this.updateViewport(n,tg,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:r}=this;if(this.dragRotate&&r&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:Xw},{isDragging:!1,isRotating:!0})}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:a}=e;let s=2/(1+Math.exp(-Math.abs(a*n)));a<0&&s!==0&&(s=1/s);const o=this.controllerState.zoom({pos:r,scale:s});return this.updateViewport(o,{...this._getTransitionProps({around:r}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.controllerState.rotateStart({pos:r});return this.updateViewport(n,tg,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;const r=this.getCenter(e);r[0]-=e.deltaX;const n=this.controllerState.rotate({pos:r});return this.updateViewport(n,tg,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:r}=this;if(this.touchRotate&&r&&e.velocityY){const n=this.getCenter(e),i=[n[0],n[1]+=e.velocityY*r/2],a=this.controllerState.rotate({pos:i});this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:Xw},{isDragging:!1,isRotating:!0}),this.blockEvents(r)}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.controllerState.zoomStart({pos:r}).rotateStart({pos:r});return mm._startPinchRotation=e.rotation,mm._lastPinchEvent=e,this.updateViewport(n,tg,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let r=this.controllerState;if(this.touchZoom){const{scale:n}=e,i=this.getCenter(e);r=r.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=e;r=r.rotate({deltaAngleX:mm._startPinchRotation-n})}return this.updateViewport(r,tg,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),mm._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:r}=this,{_lastPinchEvent:n}=mm;if(this.touchZoom&&r&&n&&e.scale!==n.scale){const i=this.getCenter(e);let a=this.controllerState.rotateEnd();const s=Math.log2(e.scale),o=(s-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),c=Math.pow(2,s+o*r/2);a=a.zoom({pos:i,scale:c}).zoomEnd(),this.updateViewport(a,{...this._getTransitionProps({around:i}),transitionDuration:r,transitionEasing:Xw},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(r)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return mm._startPinchRotation=null,mm._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const r=this.getCenter(e);if(!this.isPointInBounds(r,e))return!1;const n=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:r,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:r}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const r=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:a,rotateSpeedY:s}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let c;const f={};switch(e.srcEvent.code){case"Minus":c=r?o.zoomOut(n).zoomOut(n):o.zoomOut(n),f.isZooming=!0;break;case"Equal":c=r?o.zoomIn(n).zoomIn(n):o.zoomIn(n),f.isZooming=!0;break;case"ArrowLeft":r?(c=o.rotateLeft(a),f.isRotating=!0):(c=o.moveLeft(i),f.isPanning=!0);break;case"ArrowRight":r?(c=o.rotateRight(a),f.isRotating=!0):(c=o.moveRight(i),f.isPanning=!0);break;case"ArrowUp":r?(c=o.rotateUp(s),f.isRotating=!0):(c=o.moveUp(i),f.isPanning=!0);break;case"ArrowDown":r?(c=o.rotateDown(s),f.isRotating=!0):(c=o.moveDown(i),f.isPanning=!0);break;default:return!1}return this.updateViewport(c,this._getTransitionProps(),f),!0}_getTransitionProps(e){const{transition:r}=this;return!r||!r.transitionInterpolator?tg:e?{...r,transitionInterpolator:new u6({...e,...r.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:r}}class z$e{constructor(e,r){this._viewportProps=this.applyConstraints(e),this._state=r}getViewportProps(){return this._viewportProps}getState(){return this._state}}const eW=5,j$e=1.2;class bne extends z$e{constructor(e){const{width:r,height:n,latitude:i,longitude:a,zoom:s,bearing:o=0,pitch:c=0,altitude:f=1.5,position:d=[0,0,0],maxZoom:m=20,minZoom:b=0,maxPitch:x=60,minPitch:E=0,startPanLngLat:T,startZoomLngLat:A,startRotatePos:R,startBearing:F,startPitch:N,startZoom:O,normalize:U=!0}=e;Fl(Number.isFinite(a)),Fl(Number.isFinite(i)),Fl(Number.isFinite(s)),super({width:r,height:n,latitude:i,longitude:a,zoom:s,bearing:o,pitch:c,altitude:f,maxZoom:m,minZoom:b,maxPitch:x,minPitch:E,normalize:U,position:d},{startPanLngLat:T,startZoomLngLat:A,startRotatePos:R,startBearing:F,startPitch:N,startZoom:O}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:r}){const n=this.getState().startPanLngLat||this._unproject(r);if(!n)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(n,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:r=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:a,startPitch:s}=this.getState();if(!i||a===void 0||s===void 0)return this;let o;return e?o=this._getNewRotation(e,i,s,a):o={bearing:a+r,pitch:s+n},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:r,scale:n}){let{startZoom:i,startZoomLngLat:a}=this.getState();if(a||(i=this.getViewportProps().zoom,a=this._unproject(r)||this._unproject(e)),!a)return this;const{maxZoom:s,minZoom:o}=this.getViewportProps();let c=i+Math.log2(n);c=pd(c,o,s);const f=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...f.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const r=e.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:a}=n;return Math.abs(i-r.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(a-r.longitude)>180&&(n.longitude=a<0?a+360:a-360),n}applyConstraints(e){const{maxZoom:r,minZoom:n,zoom:i}=e;e.zoom=pd(i,n,r);const{maxPitch:a,minPitch:s,pitch:o}=e;e.pitch=pd(o,s,a);const{normalize:c=!0}=e;return c&&Object.assign(e,cVe(e)),e}_zoomFromCenter(e){const{width:r,height:n}=this.getViewportProps();return this.zoom({pos:[r/2,n/2],scale:e})}_panFromCenter(e){const{width:r,height:n}=this.getViewportProps();return this.pan({startPos:[r/2,n/2],pos:[r/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const r=this.makeViewport(this.getViewportProps());return e&&r.unproject(e)}_getNewRotation(e,r,n,i){const a=e[0]-r[0],s=e[1]-r[1],o=e[1],c=r[1],{width:f,height:d}=this.getViewportProps(),m=a/f;let b=0;s>0?Math.abs(d-c)>eW&&(b=s/(c-d)*j$e):s<0&&c>eW&&(b=1-o/c),b=pd(b,-1,1);const{minPitch:x,maxPitch:E}=this.getViewportProps(),T=i+180*m;let A=n;return b>0?A=n+b*(E-n):b<0&&(A=n-b*(x-n)),{pitch:A,bearing:T}}}class U$e extends _ne{constructor(){super(...arguments),this.ControllerState=bne,this.transition={transitionDuration:300,transitionInterpolator:new u6({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const r=this.props;super.setProps(e),(!r||r.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class c6 extends vne{constructor(e={}){super(e)}getViewportType(){return hy}get ControllerType(){return U$e}}c6.displayName="MapView";const V$e=new cne;function $$e(t,e){const r=t.order??1/0,n=e.order??1/0;return r-n}class q$e{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const r=this._defaultEffects;if(!r.find(n=>n.id===e.id)){const n=r.findIndex(i=>$$e(i,e)>0);n<0?r.push(e):r.splice(n,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Mc(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}getEffects(){return this._resolvedEffects}_setEffects(e){const r={};for(const i of this.effects)r[i.id]=i;const n=[];for(const i of e){const a=r[i.id];let s=i;a&&a!==i?a.setProps?(a.setProps(i.props),s=a):a.cleanup(this._context):a||i.setup(this._context),n.push(s),delete r[i.id]}for(const i in r)r[i].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some(i=>i instanceof cne)||this._resolvedEffects.push(V$e),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class H$e extends o6{shouldDrawLayer(e){const{operation:r}=e.props;return r.includes("draw")||r.includes("terrain")}}const G$e="deckRenderer.renderLayers";class W$e{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new H$e(e),this.pickLayersPass=new mne(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const r=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const a=r.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,Qu(G$e,this,a,e)}needsRedraw(e={clearRedrawFlags:!1}){const r=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),r}finalize(){const{renderBuffers:e}=this;for(const r of e)r.delete();e.length=0}_preRender(e,r){this.lastPostProcessEffect=null,r.preRenderStats=r.preRenderStats||{};for(const n of e)r.preRenderStats[n.id]=n.preRender(r),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,r=this.device.canvasContext.getDrawingBufferSize();e.length===0&&[0,1].map(n=>{const i=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${n}`,colorAttachments:[i]}))});for(const n of e)n.resize(r)}_postRender(e,r){const{renderBuffers:n}=this,i={...r,inputBuffer:n[0],swapBuffer:n[1]};for(const a of e)if(a.postRender){i.target=a.id===this.lastPostProcessEffect?r.target:void 0;const s=a.postRender(i);i.inputBuffer=s,i.swapBuffer=s===n[0]?n[1]:n[0]}}}const X$e={pickedColor:null,pickedObjectIndex:-1};function Y$e({pickedColors:t,decodePickingColor:e,deviceX:r,deviceY:n,deviceRadius:i,deviceRect:a}){const{x:s,y:o,width:c,height:f}=a;let d=i*i,m=-1,b=0;for(let x=0;x<f;x++){const E=x+o-n,T=E*E;if(T>d)b+=4*c;else for(let A=0;A<c;A++){if(t[b+3]-1>=0){const F=A+s-r,N=F*F+T;N<=d&&(d=N,m=b)}b+=4}}if(m>=0){const x=t.slice(m,m+4),E=e(x);if(E){const T=Math.floor(m/4/c),A=m/4-T*c;return{...E,pickedColor:x,pickedX:s+A,pickedY:o+T}}oo.error("Picked non-existent layer. Is picking buffer corrupt?")()}return X$e}function Z$e({pickedColors:t,decodePickingColor:e}){const r=new Map;if(t){for(let n=0;n<t.length;n+=4)if(t[n+3]-1>=0){const a=t.slice(n,n+4),s=a.join(",");if(!r.has(s)){const o=e(a);o?r.set(s,{...o,color:a}):oo.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}function xne({pickInfo:t,viewports:e,pixelRatio:r,x:n,y:i,z:a}){let s=e[0];e.length>1&&(s=J$e(t?.pickedViewports||e,{x:n,y:i}));let o;if(s){const c=[n-s.x,i-s.y];a!==void 0&&(c[2]=a),o=s.unproject(c)}return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:n,y:i,pixel:[n,i],coordinate:o,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:r}}function K$e(t){const{pickInfo:e,lastPickedInfo:r,mode:n,layers:i}=t,{pickedColor:a,pickedLayer:s,pickedObjectIndex:o}=e,c=s?[s]:[];if(n==="hover"){const m=r.index,b=r.layerId,x=s?s.props.id:null;if(x!==b||o!==m){if(x!==b){const E=i.find(T=>T.props.id===b);E&&c.unshift(E)}r.layerId=x,r.index=o,r.info=null}}const f=xne(t),d=new Map;return d.set(null,f),c.forEach(m=>{let b={...f};m===s&&(b.color=a,b.index=o,b.picked=!0),b=wne({layer:m,info:b,mode:n});const x=b.layer;m===s&&n==="hover"&&(r.info=b),d.set(x.id,b),n==="hover"&&x.updateAutoHighlight(b)}),d}function wne({layer:t,info:e,mode:r}){for(;t&&e;){const n=e.layer||null;e.sourceLayer=n,e.layer=t,e=t.getPickingInfo({info:e,mode:r,sourceLayer:n}),t=t.parent}return e}function J$e(t,e){for(let r=t.length-1;r>=0;r--){const n=t[r];if(n.containsPixel(e))return n}return t[0]}class Q$e{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new mne(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:r,layers:n,viewports:i},a=this.lastPickedInfo.info){const s=a&&a.layer&&a.layer.id,o=a&&a.viewport&&a.viewport.id,c=s?n.find(b=>b.id===s):null,f=o&&i.find(b=>b.id===o)||i[0],d=f&&f.unproject([e-f.x,r-f.y]);return{...a,...{x:e,y:r,viewport:f,coordinate:d,layer:c}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const r=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=r}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const r=e.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return r.length?r:null}_pickClosestObject({layers:e,views:r,viewports:n,x:i,y:a,radius:s=0,depth:o=1,mode:c="query",unproject3D:f,onViewportActive:d,effects:m}){const b=this.device.canvasContext.cssToDeviceRatio(),x=this._getPickable(e);if(!x||n.length===0)return{result:[],emptyInfo:xne({viewports:n,x:i,y:a,pixelRatio:b})};this._resizeBuffer();const E=this.device.canvasContext.cssToDevicePixels([i,a],!0),T=[E.x+Math.floor(E.width/2),E.y+Math.floor(E.height/2)],A=Math.round(s*b),{width:R,height:F}=this.pickingFBO,N=this._getPickingRect({deviceX:T[0],deviceY:T[1],deviceRadius:A,deviceWidth:R,deviceHeight:F}),O={x:i-s,y:a-s,width:s*2+1,height:s*2+1};let U;const j=[],H=new Set;for(let W=0;W<o;W++){let X;if(N){const ee=this._drawAndSample({layers:x,views:r,viewports:n,onViewportActive:d,deviceRect:N,cullRect:O,effects:m,pass:`picking:${c}`});X=Y$e({...ee,deviceX:T[0],deviceY:T[1],deviceRadius:A,deviceRect:N})}else X={pickedColor:null,pickedObjectIndex:-1};let oe;if(X.pickedLayer&&f&&this.depthFBO){const{pickedColors:ee}=this._drawAndSample({layers:[X.pickedLayer],views:r,viewports:n,onViewportActive:d,deviceRect:{x:X.pickedX,y:X.pickedY,width:1,height:1},cullRect:O,effects:m,pass:`picking:${c}:z`},!0);ee[3]&&(oe=ee[0])}X.pickedLayer&&W+1<o&&(H.add(X.pickedLayer),X.pickedLayer.disablePickingIndex(X.pickedObjectIndex)),U=K$e({pickInfo:X,lastPickedInfo:this.lastPickedInfo,mode:c,layers:x,viewports:n,x:i,y:a,z:oe,pixelRatio:b});for(const ee of U.values())ee.layer&&j.push(ee);if(!X.pickedColor)break}for(const W of H)W.restorePickingColors();return{result:j,emptyInfo:U.get(null)}}_pickVisibleObjects({layers:e,views:r,viewports:n,x:i,y:a,width:s=1,height:o=1,mode:c="query",maxObjects:f=null,onViewportActive:d,effects:m}){const b=this._getPickable(e);if(!b||n.length===0)return[];this._resizeBuffer();const x=this.device.canvasContext.cssToDeviceRatio(),E=this.device.canvasContext.cssToDevicePixels([i,a],!0),T=E.x,A=E.y+E.height,R=this.device.canvasContext.cssToDevicePixels([i+s,a+o],!0),F=R.x+R.width,N=R.y,O={x:T,y:N,width:F-T,height:A-N},U=this._drawAndSample({layers:b,views:r,viewports:n,onViewportActive:d,deviceRect:O,cullRect:{x:i,y:a,width:s,height:o},effects:m,pass:`picking:${c}`}),j=Z$e(U),H=new Map,W=[],X=Number.isFinite(f);for(let oe=0;oe<j.length&&!(X&&W.length>=f);oe++){const ee=j[oe];let G={color:ee.pickedColor,layer:null,index:ee.pickedObjectIndex,picked:!0,x:i,y:a,pixelRatio:x};G=wne({layer:ee.pickedLayer,info:G,mode:c});const ae=G.layer.id;H.has(ae)||H.set(ae,new Set);const se=H.get(ae),fe=G.object??G.index;se.has(fe)||(se.add(fe),W.push(G))}return W}_drawAndSample({layers:e,views:r,viewports:n,onViewportActive:i,deviceRect:a,cullRect:s,effects:o,pass:c},f=!1){const d=f?this.depthFBO:this.pickingFBO,m={layers:e,layerFilter:this.layerFilter,views:r,viewports:n,onViewportActive:i,pickingFBO:d,deviceRect:a,cullRect:s,effects:o,pass:c,pickZ:f,preRenderStats:{},isPicking:!0};for(const F of o)F.useInPicking&&(m.preRenderStats[F.id]=F.preRender(m));const{decodePickingColor:b}=this.pickLayersPass.render(m),{x,y:E,width:T,height:A}=a,R=new(f?Float32Array:Uint8Array)(T*A*4);return this.device.readPixelsToArrayWebGL(d,{sourceX:x,sourceY:E,sourceWidth:T,sourceHeight:A,target:R}),{pickedColors:R,decodePickingColor:b}}_getPickingRect({deviceX:e,deviceY:r,deviceRadius:n,deviceWidth:i,deviceHeight:a}){const s=Math.max(0,e-n),o=Math.max(0,r-n),c=Math.min(i,e+n+1)-s,f=Math.min(a,r+n+1)-o;return c<=0||f<=0?null:{x:s,y:o,width:c,height:f}}}const eqe={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},tqe="top-left",tW="__root";class rqe{constructor({deck:e,parentElement:r}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,this.parentElement=r}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!Mc(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(r=>r.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const r={};for(const n of this.resolvedWidgets)r[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)r[n.id]=null,this.resolvedWidgets.push(n);for(let n of e){const i=r[n.id];i?i.viewId!==n.viewId||i.placement!==n.placement?(this._remove(i),this._add(n)):n!==i&&(i.setProps(n.props),n=i):this._add(n),r[n.id]=null,this.resolvedWidgets.push(n)}for(const n in r){const i=r[n];i&&this._remove(i)}this.widgets=e}_add(e){const{viewId:r=null,placement:n=tqe}=e,i=e.onAdd({deck:this.deck,viewId:r});i&&this._getContainer(r,n).append(i),e._element=i}_remove(e){e.onRemove?.(),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,r){const n=e||tW;let i=this.containers[n];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",this.parentElement?.append(i),this.containers[n]=i);let a=i.querySelector(`.${r}`);return a||(a=document.createElement("div"),a.className=r,a.style.position="absolute",a.style.zIndex="2",Object.assign(a.style,eqe[r]),i.append(a)),a}_updateContainers(){const e=this.deck.width,r=this.deck.height;for(const n in this.containers){const i=this.lastViewports[n]||null,a=n===tW||i,s=this.containers[n];a?(s.style.display="block",s.style.left=`${i?i.x:0}px`,s.style.top=`${i?i.y:0}px`,s.style.width=`${i?i.width:e}px`,s.style.height=`${i?i.height:r}px`):s.style.display="none"}}onRedraw({viewports:e,layers:r}){const n=e.reduce((i,a)=>(i[a.id]=a,i),{});for(const i of this.getWidgets()){const{viewId:a}=i;if(a){const s=n[a];s&&(i.onViewportChange&&i.onViewportChange(s),i.onRedraw?.({viewports:[s],layers:r}))}else{if(i.onViewportChange)for(const s of e)i.onViewportChange(s);i.onRedraw?.({viewports:e,layers:r})}}this.lastViewports=n,this._updateContainers()}onHover(e,r){for(const n of this.getWidgets()){const{viewId:i}=n;(!i||i===e.viewport?.id)&&n.onHover?.(e,r)}}onEvent(e,r){const n=uD[r.type];if(n)for(const i of this.getWidgets()){const{viewId:a}=i;(!a||a===e.viewport?.id)&&i[n]?.(e,r)}}}const nqe={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class iqe{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:e}){const r=document.createElement("div");return r.className="deck-tooltip",Object.assign(r.style,nqe),this.deck=e,this.element=r,r}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:r}=this,n=r&&r.props.getTooltip;if(!n)return;const i=n(e);this.lastViewport=e.viewport,this.setTooltip(i,e.x,e.y)}setTooltip(e,r,n){const i=this.element;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${r}px, ${n}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}var d0;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(d0||(d0={}));const f6={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},xl=(t,e,r)=>e?t.enable(r):t.disable(r),rW=(t,e,r)=>t.hint(r,e),Jc=(t,e,r)=>t.pixelStorei(r,e),nW=(t,e,r)=>{const n=r===36006?36009:36008;return t.bindFramebuffer(n,e)},C1=(t,e,r)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[r];t.bindBuffer(i,e)};function lM(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}const aqe={3042:xl,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:xl,2885:(t,e)=>t.cullFace(e),2929:xl,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:xl,35723:rW,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>t.bindTransformFeedback?.(36386,e),34229:(t,e)=>t.bindVertexArray(e),36006:nW,36010:nW,34964:C1,36662:C1,36663:C1,35053:C1,35055:C1,2886:(t,e)=>t.frontFace(e),33170:rW,2849:(t,e)=>t.lineWidth(e),32823:xl,32824:"polygonOffset",10752:"polygonOffset",35977:xl,32926:xl,32928:xl,32938:"sampleCoverage",32939:"sampleCoverage",3089:xl,3088:(t,e)=>t.scissor(...e),2960:xl,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:xl,10754:xl,12288:xl,12289:xl,12290:xl,12291:xl,12292:xl,12293:xl,12294:xl,12295:xl,3333:Jc,3317:Jc,37440:Jc,37441:Jc,37443:Jc,3330:Jc,3332:Jc,3331:Jc,3314:Jc,32878:Jc,3316:Jc,3315:Jc,32877:Jc,framebuffer:(t,e)=>{const r=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,r)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{const r=typeof e=="number"?[e,e]:e;t.blendEquationSeparate(...r)},blendFunc:(t,e)=>{const r=e?.length===2?[...e,...e]:e;t.blendFuncSeparate(...r)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(e[0],e[1]||!1),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=lM(e)?e:[e,e];const[r,n]=e;t.stencilMaskSeparate(1028,r),t.stencilMaskSeparate(1029,n)},stencilFunc:(t,e)=>{e=lM(e)&&e.length===3?[...e,...e]:e;const[r,n,i,a,s,o]=e;t.stencilFuncSeparate(1028,r,n,i),t.stencilFuncSeparate(1029,a,s,o)},stencilOp:(t,e)=>{e=lM(e)&&e.length===3?[...e,...e]:e;const[r,n,i,a,s,o]=e;t.stencilOpSeparate(1028,r,n,i),t.stencilOpSeparate(1029,a,s,o)},viewport:(t,e)=>t.viewport(...e)};function Ns(t,e,r){return e[t]!==void 0?e[t]:r[t]}const oqe={blendEquation:(t,e,r)=>t.blendEquationSeparate(Ns(32777,e,r),Ns(34877,e,r)),blendFunc:(t,e,r)=>t.blendFuncSeparate(Ns(32969,e,r),Ns(32968,e,r),Ns(32971,e,r),Ns(32970,e,r)),polygonOffset:(t,e,r)=>t.polygonOffset(Ns(32824,e,r),Ns(10752,e,r)),sampleCoverage:(t,e,r)=>t.sampleCoverage(Ns(32938,e,r),Ns(32939,e,r)),stencilFuncFront:(t,e,r)=>t.stencilFuncSeparate(1028,Ns(2962,e,r),Ns(2967,e,r),Ns(2963,e,r)),stencilFuncBack:(t,e,r)=>t.stencilFuncSeparate(1029,Ns(34816,e,r),Ns(36003,e,r),Ns(36004,e,r)),stencilOpFront:(t,e,r)=>t.stencilOpSeparate(1028,Ns(2964,e,r),Ns(2965,e,r),Ns(2966,e,r)),stencilOpBack:(t,e,r)=>t.stencilOpSeparate(1029,Ns(34817,e,r),Ns(34818,e,r),Ns(34819,e,r))},iW={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,r)=>t({[e]:r}),hint:(t,e,r)=>t({[e]:r}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,r)=>t({36007:r}),bindTransformFeedback:(t,e,r)=>t({36389:r}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,r)=>{switch(e){case 36160:return t({36006:r,36010:r});case 36009:return t({36006:r});case 36008:return t({36010:r});default:return null}},bindBuffer:(t,e,r)=>{const n={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return n?t({[n]:r}):{valueChanged:!0}},blendColor:(t,e,r,n,i)=>t({32773:new Float32Array([e,r,n,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,r)=>t({32777:e,34877:r}),blendFunc:(t,e,r)=>t({32969:e,32968:r,32971:e,32970:r}),blendFuncSeparate:(t,e,r,n,i)=>t({32969:e,32968:r,32971:n,32970:i}),clearColor:(t,e,r,n,i)=>t({3106:new Float32Array([e,r,n,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,r,n,i)=>t({3107:[e,r,n,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,r)=>t({2928:new Float32Array([e,r])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,r)=>t({32824:e,10752:r}),sampleCoverage:(t,e,r)=>t({32938:e,32939:r}),scissor:(t,e,r,n,i)=>t({3088:new Int32Array([e,r,n,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,r)=>t({[e===1028?2968:36005]:r}),stencilFunc:(t,e,r,n)=>t({2962:e,2967:r,2963:n,34816:e,36003:r,36004:n}),stencilFuncSeparate:(t,e,r,n,i)=>t({[e===1028?2962:34816]:r,[e===1028?2967:36003]:n,[e===1028?2963:36004]:i}),stencilOp:(t,e,r,n)=>t({2964:e,2965:r,2966:n,34817:e,34818:r,34819:n}),stencilOpSeparate:(t,e,r,n,i)=>t({[e===1028?2964:34817]:r,[e===1028?2965:34818]:n,[e===1028?2966:34819]:i}),viewport:(t,e,r,n,i)=>t({2978:[e,r,n,i]})},nd=(t,e)=>t.isEnabled(e),aW={3042:nd,2884:nd,2929:nd,3024:nd,32823:nd,32926:nd,32928:nd,3089:nd,2960:nd,35977:nd},sqe=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function P_(t,e){if(uqe(e))return;const r={};for(const i in e){const a=Number(i),s=aqe[i];s&&(typeof s=="string"?r[s]=!0:s(t,e[i],a))}const n=t.state&&t.state.cache;if(n)for(const i in r){const a=oqe[i];a(t,e,n)}}function Sne(t,e=f6){if(typeof e=="number"){const i=e,a=aW[i];return a?a(t,i):t.getParameter(i)}const r=Array.isArray(e)?e:Object.keys(e),n={};for(const i of r){const a=aW[i];n[i]=a?a(t,Number(i)):t.getParameter(Number(i))}return n}function lqe(t){P_(t,f6)}function uqe(t){for(const e in t)return!1;return!0}function cqe(t,e){if(t===e)return!0;const r=Array.isArray(t)||ArrayBuffer.isView(t),n=Array.isArray(e)||ArrayBuffer.isView(e);if(r&&n&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}class Hm{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,r){this.gl=e,this.log=r?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];P_(this.gl,e),this.stateStack.pop()}trackState(e,r){if(this.cache=r.copyState?Sne(e):Object.assign({},f6),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,hqe(e);for(const n in iW){const i=iW[n];fqe(e,n,i)}oW(e,"getParameter"),oW(e,"isEnabled")}_updateCache(e){let r=!1,n;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const a in e){const s=e[a],o=this.cache[a];cqe(s,o)||(r=!0,n=o,i&&!(a in i)&&(i[a]=o),this.cache[a]=s)}return{valueChanged:r,oldValue:n}}}function oW(t,e){const r=t[e].bind(t);t[e]=function(i){if(i===void 0||sqe.has(i))return r(i);const a=Hm.get(t);return i in a.cache||(a.cache[i]=r(i)),a.enable?a.cache[i]:r(i)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function fqe(t,e,r){if(!t[e])return;const n=t[e].bind(t);t[e]=function(...a){const s=Hm.get(t),{valueChanged:o,oldValue:c}=r(s._updateCache,...a);return o&&n(...a),c},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function hqe(t){const e=t.useProgram.bind(t);t.useProgram=function(n){const i=Hm.get(t);i.program!==n&&(e(n),i.program=n)}}function dqe(t,e,r){let n="";const i={preserveDrawingBuffer:!0,...r};let a=null;if(a||=t.getContext("webgl2",i),i.failIfMajorPerformanceCaveat&&(n||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),!a&&!r.failIfMajorPerformanceCaveat&&(i.failIfMajorPerformanceCaveat=!1,a=t.getContext("webgl2",i),a.luma||={},a.luma.softwareRenderer=!0),a||(a=t.getContext("webgl",{}),a&&(a=null,n||="Your browser only supports WebGL1")),!a)throw n||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${n}`);const{onContextLost:s,onContextRestored:o}=e;return t.addEventListener("webglcontextlost",c=>s(c),!1),t.addEventListener("webglcontextrestored",c=>o(c),!1),a.luma||={},a}function l_(t,e,r){return r[e]===void 0&&(r[e]=t.getExtension(e)||null),r[e]}function pqe(t,e){const r=t.getParameter(7936),n=t.getParameter(7937);l_(t,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,a=t.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),s=t.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),o=a||r,c=s||n,f=t.getParameter(7938),d=Ene(o,c),m=gqe(o,c),b=mqe(o,c);return{type:"webgl",gpu:d,gpuType:b,gpuBackend:m,vendor:o,renderer:c,version:f,shadingLanguage:"glsl",shadingLanguageVersion:300}}function Ene(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function gqe(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?"opengl":"unknown"}function mqe(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(Ene(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function Tne(t){switch(t){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}const eb="WEBGL_compressed_texture_s3tc",tb="WEBGL_compressed_texture_s3tc_srgb",p0="EXT_texture_compression_rgtc",g0="EXT_texture_compression_bptc",yqe="WEBGL_compressed_texture_etc",vqe="WEBGL_compressed_texture_astc",_qe="WEBGL_compressed_texture_etc1",bqe="WEBGL_compressed_texture_pvrtc",xqe="WEBGL_compressed_texture_atc",sW="EXT_texture_norm16",lW="EXT_render_snorm",wqe="EXT_color_buffer_float",h6={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[lW],"norm16-renderable-webgl":[sW],"snorm16-renderable-webgl":[sW,lW],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[eb,tb,p0,g0],"texture-compression-bc5-webgl":[p0],"texture-compression-bc7-webgl":[g0],"texture-compression-etc2":[yqe],"texture-compression-astc":[vqe],"texture-compression-etc1-webgl":[_qe],"texture-compression-pvrtc-webgl":[bqe],"texture-compression-atc-webgl":[xqe]};function Sqe(t){return t in h6}function Eqe(t,e,r){return(h6[e]||[]).every(i=>l_(t,i,r))}const d6={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:wqe,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:eb},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:tb},"bc1-rgba-unorm":{gl:33777,x:eb},"bc1-rgba-unorm-srgb":{gl:35916,x:tb},"bc2-rgba-unorm":{gl:33778,x:eb},"bc2-rgba-unorm-srgb":{gl:35918,x:tb},"bc3-rgba-unorm":{gl:33779,x:eb},"bc3-rgba-unorm-srgb":{gl:35919,x:tb},"bc4-r-unorm":{gl:36283,x:p0},"bc4-r-snorm":{gl:36284,x:p0},"bc5-rg-unorm":{gl:36285,x:p0},"bc5-rg-snorm":{gl:36286,x:p0},"bc6h-rgb-ufloat":{gl:36495,x:g0},"bc6h-rgb-float":{gl:36494,x:g0},"bc7-rgba-unorm":{gl:36492,x:g0},"bc7-rgba-unorm-srgb":{gl:36493,x:g0},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function Tqe(t,e,r){let n=e.create;const i=d6[e.format];return i?.gl===void 0&&(n=!1),i?.x&&(n=n&&!!l_(t,i.x,r)),{format:e.format,create:n&&e.create,render:n&&e.render,filter:n&&e.filter,blend:n&&e.blend,store:n&&e.store}}function Cne(t){const e=d6[t],r=Iqe(t),n=zN(t);return{internalFormat:r,format:e?.dataFormat||Aqe(n.channels,n.integer,n.normalized,r),type:n.dataType?Tne(n.dataType):e?.types?.[0]||5121,compressed:n.compressed||!1}}function Cqe(t){switch(zN(t).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${t}`)}}function Aqe(t,e,r,n){if(n===6408||n===6407)return n;switch(t){case"r":return e&&!r?36244:6403;case"rg":return e&&!r?33320:33319;case"rgb":return e&&!r?36248:6407;case"rgba":return e&&!r?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function Iqe(t){const r=d6[t]?.gl;if(r===void 0)throw new Error(`Unsupported texture format ${t}`);return r}const uW={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class Pqe extends h9e{gl;extensions;testedFeatures=new Set;constructor(e,r,n){super([],n),this.gl=e,this.extensions=r,l_(e,"EXT_color_buffer_float",r)}*[Symbol.iterator](){const e=this.getFeatures();for(const r of e)this.has(r)&&(yield r);return[]}has(e){return this.disabledFeatures?.[e]?!1:(this.testedFeatures.has(e)||(this.testedFeatures.add(e),Sqe(e)&&Eqe(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(const r of e)this.has(r)}getFeatures(){return[...Object.keys(uW),...Object.keys(h6)]}getWebGLFeature(e){const r=uW[e];return typeof r=="string"?!!l_(this.gl,r,this.extensions):!!r}}class Mqe extends f9e{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return this.limits[e]===void 0&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class Tb extends Z3{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,r){super(e,r);const n=r.handle===null;this.device=e,this.gl=e.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),n||(e.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let r=0;r<this.colorAttachments.length;++r){const n=this.colorAttachments[r];if(n){const i=36064+r;this._attachTextureView(i,n)}}if(this.depthStencilAttachment){const r=Cqe(this.depthStencilAttachment.props.format);this._attachTextureView(r,this.depthStencilAttachment)}if(this.device.props.debug){const r=this.gl.checkFramebufferStatus(36160);if(r!==36053)throw new Error(`Framebuffer ${Rqe(r)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,r){const{gl:n}=this.device,{texture:i}=r,a=r.props.baseMipLevel,s=r.props.baseArrayLayer;switch(n.bindTexture(i.glTarget,i.handle),i.glTarget){case 35866:case 32879:n.framebufferTextureLayer(36160,e,i.handle,a,s);break;case 34067:const o=kqe(s);n.framebufferTexture2D(36160,e,o,i.handle,a);break;case 3553:n.framebufferTexture2D(36160,e,3553,i.handle,a);break;default:throw new Error("Illegal texture type")}n.bindTexture(i.glTarget,null)}}function kqe(t){return t<34069?t+34069:t}function Rqe(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}class Dqe extends jN{device;format="rgba8unorm";depthStencilFormat="depth24plus";presentationSize;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,r){super(r),this.device=e,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new Tb(this.device,{handle:null}),this._framebuffer}update(){const e=this.getPixelSize();(e[0]!==this.presentationSize[0]||e[1]!==this.presentationSize[1])&&(this.presentationSize=e,this.resize())}resize(e){if(this.device.gl&&this.canvas){const r=this.getDevicePixelRatio(e?.useDevicePixels);this.setDevicePixelRatio(r,e);return}}commit(){}}async function Ane(t,e){const r=document.getElementsByTagName("head")[0];if(!r)throw new Error("loadScript");const n=document.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src",t),new Promise((i,a)=>{n.onload=i,n.onerror=s=>a(new Error(`Unable to load script '${t}': ${s}`)),r.appendChild(n)})}const Oqe=1;let Qc=null,cW=!1;const p6={debugSpectorJS:gn.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function Lqe(t){if(!globalThis.SPECTOR)try{await Ane(t.debugSpectorJSUrl||p6.debugSpectorJSUrl)}catch(e){gn.warn(String(e))}}function Nqe(t){if(t={...p6,...t},!t.debugSpectorJS)return null;if(!Qc&&globalThis.SPECTOR&&!globalThis.luma?.spector){gn.probe(Oqe,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;Qc=new e,globalThis.luma&&(globalThis.luma.spector=Qc)}if(!Qc)return null;if(cW||(cW=!0,Qc.spyCanvases(),Qc?.onCaptureStarted.add(e=>gn.info("Spector capture started:",e)()),Qc?.onCapture.add(e=>{gn.info("Spector capture complete:",e)(),Qc?.getResultUI(),Qc?.resultView.display(),Qc?.resultView.addCapture(e)})),t.gl){const e=t.gl,r=e.device;Qc?.startCapture(t.gl,500),e.device=r,new Promise(n=>setTimeout(n,2e3)).then(n=>{gn.info("Spector capture stopped after 2 seconds")(),Qc?.stopCapture()})}return Qc}const Fqe="https://unpkg.com/webgl-debug@2.0.1/index.js";function Ine(t){return t.luma=t.luma||{},t.luma}async function Bqe(){Py()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Ane(Fqe))}function zqe(t,e={}){return e.debugWebGL||e.traceWebGL?Uqe(t,e):jqe(t)}function jqe(t){const e=Ine(t);return e.realContext?e.realContext:t}function Uqe(t,e){if(!globalThis.WebGLDebugUtils)return gn.warn("webgl-debug not loaded")(),t;const r=Ine(t);if(r.debugContext)return r.debugContext;globalThis.WebGLDebugUtils.init({...d0,...t});const n=globalThis.WebGLDebugUtils.makeDebugContext(t,Vqe.bind(null,e),$qe.bind(null,e));for(const s in d0)!(s in n)&&typeof d0[s]=="number"&&(n[s]=d0[s]);class i{}Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.setPrototypeOf(i,n);const a=Object.create(i);return r.realContext=t,r.debugContext=a,a.debug=!0,a}function fW(t,e){e=Array.from(e).map(n=>n===void 0?"undefined":n);let r=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return r=`${r.slice(0,100)}${r.length>100?"...":""}`,`gl.${t}(${r})`}function Vqe(t,e,r,n){n=Array.from(n).map(o=>o===void 0?"undefined":o);const i=globalThis.WebGLDebugUtils.glEnumToString(e),a=globalThis.WebGLDebugUtils.glFunctionArgsToString(r,n),s=`${i} in gl.${r}(${a})`;gn.error(s)();debugger}function $qe(t,e,r){let n="";gn.level>=1&&(n=fW(e,r),t.traceWebGL&&gn.log(1,n)());for(const i of r)if(i===void 0){n=n||fW(e,r);debugger}}const uM={};function qqe(t="id"){uM[t]=uM[t]||1;const e=uM[t]++;return`${t}-${e}`}class Cb extends jo{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor(e,r={}){super(e,r),this.device=e,this.gl=this.device.gl;const n=typeof r=="object"?r.handle:void 0;this.handle=n||this.gl.createBuffer(),e.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=Hqe(this.props.usage),this.glUsage=Gqe(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(e,r=0,n=e.byteLength+r){const i=this.glTarget;this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.glUsage),this.gl.bufferSubData(i,r,e),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(e,r,n),this.trackAllocatedMemory(n)}_initWithByteLength(e){let r=e;e===0&&(r=new Float32Array(0));const n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(e,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,e),this.gl.bindBuffer(36663,null),this._setDebugData(e,r,e.byteLength)}async readAsync(e=0,r){return this.readSyncWebGL(e,r)}readSyncWebGL(e=0,r){r=r??this.byteLength-e;const n=new Uint8Array(r),i=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,n,i,r),this.gl.bindBuffer(36662,null),this._setDebugData(n,e,r),n}}function Hqe(t){return t&jo.INDEX?34963:t&jo.VERTEX?34962:t&jo.UNIFORM?35345:34962}function Gqe(t){return t&jo.INDEX||t&jo.VERTEX?35044:t&jo.UNIFORM?35048:35044}function Wqe(t){const e=t.split(/\r?\n/),r=[];for(const n of e){if(n.length<=1)continue;const i=n.split(":");if(i.length===2){const[m,b]=i;r.push({message:b.trim(),type:hW(m),lineNum:0,linePos:0});continue}const[a,s,o,...c]=i;let f=parseInt(o,10);isNaN(f)&&(f=0);let d=parseInt(s,10);isNaN(d)&&(d=0),r.push({message:c.join(":").trim(),type:hW(a),lineNum:f,linePos:d})}return r}function hW(t){const e=["warning","error","info"],r=t.toLowerCase();return e.includes(r)?r:"info"}class Xqe extends Y3{device;handle;constructor(e,r){switch(super(e,r),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>this.compilationStatus)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?Wqe(e):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es
${e}`;const{gl:r}=this.device;if(r.shaderSource(this.handle,e),r.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}gn.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),gn.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const e=async i=>await new Promise(a=>setTimeout(a,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:n}=this.device;for(;;){if(n.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function Yqe(t,e,r,n){if(Qqe(e))return n(t);const i=t;i.pushState();try{return Zqe(t,e),P_(i.gl,r),n(t)}finally{i.popState()}}function Zqe(t,e){const r=t,{gl:n}=r;if(e.cullMode)switch(e.cullMode){case"none":n.disable(2884);break;case"front":n.enable(2884),n.cullFace(1028);break;case"back":n.enable(2884),n.cullFace(1029);break}if(e.frontFace&&n.frontFace(Gm("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&n.enable(34383),e.depthBias!==void 0&&(n.enable(32823),n.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){const a=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,s=Gm("provokingVertex",e.provokingVertex,{first:36429,last:36430});a?.provokingVertexWEBGL(s)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){const a=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,s=Gm("polygonMode",e.polygonMode,{fill:6914,line:6913});a?.polygonModeWEBGL(1028,s),a?.polygonModeWEBGL(1029,s)}e.polygonOffsetLine&&n.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&n.enable(12288),e.clipDistance1&&n.enable(12289),e.clipDistance2&&n.enable(12290),e.clipDistance3&&n.enable(12291),e.clipDistance4&&n.enable(12292),e.clipDistance5&&n.enable(12293),e.clipDistance6&&n.enable(12294),e.clipDistance7&&n.enable(12295)),e.depthWriteEnabled!==void 0&&n.depthMask(Jqe("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?n.enable(2929):n.disable(2929),n.depthFunc(mD("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;n.stencilMaskSeparate(1028,i),n.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&gn.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,a=mD("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?n.enable(2960):n.disable(2960),n.stencilFuncSeparate(1028,a,0,i),n.stencilFuncSeparate(1029,a,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=cM("stencilPassOperation",e.stencilPassOperation),a=cM("stencilFailOperation",e.stencilFailOperation),s=cM("stencilDepthFailOperation",e.stencilDepthFailOperation);n.stencilOpSeparate(1028,a,s,i),n.stencilOpSeparate(1029,a,s,i)}switch(e.blend){case!0:n.enable(3042);break;case!1:n.disable(3042);break}if(e.blendColorOperation||e.blendAlphaOperation){const i=dW("blendColorOperation",e.blendColorOperation||"add"),a=dW("blendAlphaOperation",e.blendAlphaOperation||"add");n.blendEquationSeparate(i,a);const s=Yw("blendColorSrcFactor",e.blendColorSrcFactor||"one"),o=Yw("blendColorDstFactor",e.blendColorDstFactor||"zero"),c=Yw("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),f=Yw("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");n.blendFuncSeparate(s,o,c,f)}}function mD(t,e){return Gm(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function cM(t,e){return Gm(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function dW(t,e){return Gm(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function Yw(t,e){return Gm(t,e,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function Kqe(t,e){return`Illegal parameter ${e} for ${t}`}function Gm(t,e,r){if(!(e in r))throw new Error(Kqe(t,e));return r[e]}function Jqe(t,e){return e}function Qqe(t){let e=!0;for(const r in t){e=!1;break}return e}function Pne(t){const e={};return t.addressModeU&&(e[10242]=fM(t.addressModeU)),t.addressModeV&&(e[10243]=fM(t.addressModeV)),t.addressModeW&&(e[32882]=fM(t.addressModeW)),t.magFilter&&(e[10240]=yD(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=eHe(t.minFilter||"linear",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type==="comparison-sampler"&&(e[34892]=34894),t.compare&&(e[34893]=mD("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function fM(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function yD(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}function eHe(t,e="none"){if(!e)return yD(t);switch(e){case"none":return yD(t);case"nearest":return t==="nearest"?9984:9986;case"linear":return t==="nearest"?9985:9987}}class vD extends ux{device;handle;parameters;constructor(e,r){super(e,r),this.device=e,this.parameters=Pne(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[r,n]of Object.entries(e)){const i=Number(r);switch(i){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,i,n);break;default:this.device.gl.samplerParameteri(this.handle,i,n);break}}}}class m0 extends X3{device;gl;handle;texture;constructor(e,r){super(e,{...xo.defaultProps,...r}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}const tHe="Failed to deduce GL constant from typed array";function rHe(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(tHe)}}function nHe(t,e){const{clamped:r=!0}=e||{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return r?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Mne(t){switch(t){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function iHe(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function vT(t,e,r){if(aHe(e))return r(t);const{nocatch:n=!0}=e,i=Hm.get(t);i.push(),P_(t,e);let a;if(n)a=r(t),i.pop();else try{a=r(t)}finally{i.pop()}return a}function aHe(t){for(const e in t)return!1;return!0}function oHe(t,e,r){const{dimension:n,width:i,height:a,depth:s=0}=r,{glInternalFormat:o}=r,c=r.glTarget;switch(n){case"2d-array":case"3d":t.texStorage3D(c,e,o,i,a,s);break;default:t.texStorage2D(c,e,o,i,a)}}function pW(t,e,r,n){const{width:i,height:a}=n,{dimension:s,depth:o=0,mipLevel:c=0}=n,{x:f=0,y:d=0,z:m=0}=n,{glFormat:b,glType:x}=n,E=kne(n.glTarget,s,o),T=n.flipY?{37440:!0}:{};vT(t,T,()=>{switch(s){case"2d-array":case"3d":t.bindTexture(E,e),t.texSubImage3D(E,c,f,d,m,i,a,o,b,x,r),t.bindTexture(E,null);break;case"2d":case"cube":t.bindTexture(E,e),t.texSubImage2D(E,c,f,d,i,a,b,x,r),t.bindTexture(E,null);break;default:throw new Error(s)}})}function gW(t,e,r){const{dimension:n,width:i,height:a,depth:s=0,mipLevel:o=0,byteOffset:c=0}=r,{x:f=0,y:d=0,z:m=0}=r,{glFormat:b,glType:x,compressed:E}=r,T=kne(r.glTarget,n,s);switch(n){case"2d-array":case"3d":E?t.compressedTexSubImage3D(T,o,f,d,m,i,a,s,b,e,c):t.texSubImage3D(T,o,f,d,m,i,a,s,b,x,e,c);break;case"2d":case"cube":E?t.compressedTexSubImage2D(T,o,f,d,i,a,b,e,c):t.texSubImage2D(T,o,f,d,i,a,b,x,e,c);break;default:throw new Error(n)}}function sHe(t){switch(t){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(t)}function kne(t,e,r){return e==="cube"?34069+r:t}function lHe(t,e){const{sourceX:r=0,sourceY:n=0,sourceAttachment:i=0}=e||{};let{target:a=null,sourceWidth:s,sourceHeight:o,sourceDepth:c,sourceFormat:f,sourceType:d}=e||{};const{framebuffer:m,deleteFramebuffer:b}=Rne(t),{gl:x,handle:E}=m;s||=m.width,o||=m.height;const T=m.colorAttachments[i]?.texture;if(!T)throw new Error(`Invalid framebuffer attachment ${i}`);c=T?.depth||1,f||=T?.glFormat||6408,d||=T?.glType||5121,a=fHe(a,d,f,s,o),d=d||rHe(a);const A=x.bindFramebuffer(36160,E);return x.readBuffer(36064+i),x.readPixels(r,n,s,o,f,d,a),x.readBuffer(36064),x.bindFramebuffer(36160,A||null),b&&m.destroy(),a}function uHe(t,e){const{target:r,sourceX:n=0,sourceY:i=0,sourceFormat:a=6408,targetByteOffset:s=0}=e||{};let{sourceWidth:o,sourceHeight:c,sourceType:f}=e||{};const{framebuffer:d,deleteFramebuffer:m}=Rne(t);o=o||d.width,c=c||d.height;const b=d;f=f||5121;let x=r;if(!x){const T=Mne(a),A=iHe(f),R=s+o*c*T*A;x=b.device.createBuffer({byteLength:R})}const E=t.device.createCommandEncoder();return E.copyTextureToBuffer({sourceTexture:t,width:o,height:c,origin:[n,i],destinationBuffer:x,byteOffset:s}),E.destroy(),m&&d.destroy(),x}function Rne(t){return t instanceof Z3?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:cHe(t),deleteFramebuffer:!0}}function cHe(t,e){const{device:r,width:n,height:i,id:a}=t;return r.createFramebuffer({...e,id:`framebuffer-for-${a}`,width:n,height:i,colorAttachments:[t]})}function fHe(t,e,r,n,i,a){if(t)return t;e||=5121;const s=nHe(e,{clamped:!1}),o=Mne(r);return new s(n*i*o)}class Ab extends xo{device;gl;handle;sampler=void 0;view=void 0;mipmaps;compressed;glTarget;glFormat;glType;glInternalFormat;textureUnit=0;constructor(e,r){super(e,r);const n={...this.props};n.data=r.data,this.device=e,this.gl=this.device.gl,this.glTarget=sHe(this.props.dimension);const i=Cne(this.props.format);this.glInternalFormat=i.internalFormat,this.glFormat=i.format,this.glType=i.type,this.compressed=i.compressed,this.mipmaps=!!this.props.mipmaps,this._initialize(n),Object.seal(this)}_initialize(e){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:e.data});let{width:r,height:n}=e;if(!r||!n){const i=xo.getTextureDataSize(e.data);r=i?.width||1,n=i?.height||1}if(this.width=r,this.height=n,this.depth=e.depth,this.setSampler(e.sampler),this.view=new m0(this.device,{...this.props,texture:this}),this.bind(),oHe(this.gl,this.mipLevels,this),e.data)switch(e.dimension){case"1d":this.setTexture1DData(e.data);break;case"2d":this.setTexture2DData(e.data);break;case"3d":this.setTexture3DData(e.data);break;case"cube":this.setTextureCubeData(e.data);break;case"2d-array":this.setTextureArrayData(e.data);break;case"cube-array":this.setTextureCubeArrayData(e.data);break;default:throw new Error(e.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new m0(this.device,{...e,texture:this})}setSampler(e={}){let r;e instanceof vD?(this.sampler=e,r=e.props):(this.sampler=new vD(this.device,e),r=e);const n=Pne(r);this._setSamplerParameters(n)}generateMipmap(e){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(gn.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!e?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(n){gn.warn(`Error generating mipmap for ${this}: ${n.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(e){const r=xo.getExternalImageSize(e.image),n={...xo.defaultCopyExternalImageOptions,...r,...e},{image:i,depth:a,mipLevel:s,x:o,y:c,z:f,flipY:d}=n;let{width:m,height:b}=n;const{dimension:x,glTarget:E,glFormat:T,glInternalFormat:A,glType:R}=this;if(m=Math.min(m,this.width-o),b=Math.min(b,this.height-c),e.sourceX||e.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return pW(this.device.gl,this.handle,i,{dimension:x,mipLevel:s,x:o,y:c,z:f,width:m,height:b,depth:a,glFormat:T,glType:R,glTarget:E,flipY:d}),{width:n.width,height:n.height}}setTexture1DData(e){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(e,r=0){this.bind();const n=xo.normalizeTextureData(e,this);n.length>1&&this.props.mipmaps!==!1&&gn.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let i=0;i<n.length;i++){const a=n[i];this._setMipLevel(r,i,a)}this.unbind()}setTexture3DData(e){if(this.props.dimension!=="3d")throw new Error(this.id);ArrayBuffer.isView(e)&&(this.bind(),gW(this.device.gl,e,this),this.unbind())}setTextureCubeData(e,r=0){if(this.props.dimension!=="cube")throw new Error(this.id);for(const n of xo.CubeFaces)this.setTextureCubeFaceData(e[n],n)}setTextureArrayData(e){throw this.props.dimension!=="2d-array"?new Error(this.id):new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(e){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(e,r,n=0){Array.isArray(e)&&e.length>1&&this.props.mipmaps!==!1&&gn.warn(`${this.id} has mipmap and multiple LODs.`)();const i=xo.CubeFaces.indexOf(r);this.setTexture2DData(e,i)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(e){const{face:r,width:n,height:i,pixels:a,data:s,format:o=6408,type:c=5121}=e,{gl:f}=this,d=a||s;this.bind(),d instanceof Promise?d.then(m=>this.setImageDataForFace(Object.assign({},e,{face:r,data:m,pixels:m}))):this.width||this.height?f.texImage2D(r,0,o,n,i,0,o,c,d):f.texImage2D(r,0,o,o,c,d)}_getImageDataMap(e){for(let r=0;r<xo.CubeFaces.length;++r){const n=xo.CubeFaces[r];e[n]&&(e[34069+r]=e[n],delete e[n])}return e}_setSamplerParameters(e){gn.log(1,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[r,n]of Object.entries(e)){const i=Number(r),a=n;switch(i){case 33082:case 33083:this.gl.texParameterf(this.glTarget,i,a);break;case 10241:this.gl.texParameteri(this.glTarget,i,a);break;case 10242:case 10243:this.gl.texParameteri(this.glTarget,i,a);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,i,a);break;default:this.gl.texParameteri(this.glTarget,i,a);break}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(e,r,n,i=this.glTarget){if(xo.isExternalImage(n)){pW(this.device.gl,this.handle,n,{...this,depth:e,mipLevel:r,glTarget:i,flipY:this.props.flipY});return}if(xo.isTextureLevelData(n)){gW(this.device.gl,n.data,{...this,depth:e,mipLevel:r,glTarget:i});return}throw new Error("Texture: invalid image data")}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e){const{gl:r}=this;return e!==void 0&&(this.textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,this.handle),e}unbind(e){const{gl:r}=this;return e!==void 0&&(this.textureUnit=e,r.activeTexture(33984+e)),r.bindTexture(this.glTarget,null),e}}const hHe=[1,2,4,8];class dHe extends Am{device;glParameters;constructor(e,r){super(e,r),this.device=e;let n;if(!r?.parameters?.viewport)if(r?.framebuffer){const{width:a,height:s}=r.framebuffer;n=[0,0,a,s]}else{const[a,s]=e.getCanvasContext().getDrawingBufferSize();n=[0,0,a,s]}if(this.device.pushState(),this.setParameters({viewport:n,...this.props.parameters}),this.props.framebuffer?.handle)if(this.props.framebuffer){const a=this.props.framebuffer.colorAttachments.map((s,o)=>36064+o);this.device.gl.drawBuffers(a)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){const r={...this.glParameters};r.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(r.viewport=e.viewport.slice(0,4),r.depthRange=[e.viewport[4],e.viewport[5]]):r.viewport=e.viewport),e.scissorRect&&(r.scissorTest=!0,r.scissor=e.scissorRect),e.blendConstant&&(r.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),e[2967]=e.stencilReference),e.colorMask&&(r.colorMask=hHe.map(n=>!!(n&e.colorMask))),this.glParameters=r,P_(this.device.gl,r)}beginOcclusionQuery(e){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){const e={...this.glParameters};let r=0;this.props.clearColors&&this.props.clearColors.forEach((n,i)=>{n&&this.clearColorBuffer(i,n)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(r|=16384,e.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=256,e.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=1024,e.clearStencil=this.props.clearStencil),r!==0&&vT(this.device.gl,e,()=>{this.device.gl.clear(r)})}clearColorBuffer(e=0,r=[0,0,0,0]){vT(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,r);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,r);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,r);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}function pHe(t){return gHe.includes(t)}const gHe=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],Dne={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function One(t){const e=Dne[t];if(!e)throw new Error("uniform");const[r,n,,i]=e;return{format:i,components:n,glType:r}}function mHe(t){const e=Dne[t];if(!e)throw new Error("attribute");const[,r,,n,i]=e;return{attributeType:n,vertexFormat:i,components:r}}function yHe(t,e){const r={attributes:[],bindings:[]};r.attributes=vHe(t,e);const n=xHe(t,e);for(const o of n){const c=o.uniforms.map(f=>({name:f.name,format:f.format,byteOffset:f.byteOffset,byteStride:f.byteStride,arrayLength:f.arrayLength}));r.bindings.push({type:"uniform",name:o.name,group:0,location:o.location,visibility:(o.vertex?1:0)&(o.fragment?2:0),minBindingSize:o.byteLength,uniforms:c})}const i=bHe(t,e);let a=0;for(const o of i)if(pHe(o.type)){const{viewDimension:c,sampleType:f}=SHe(o.type);r.bindings.push({type:"texture",name:o.name,group:0,location:a,viewDimension:c,sampleType:f}),o.textureUnit=a,a+=1}i.length&&(r.uniforms=i);const s=_He(t,e);return s?.length&&(r.varyings=s),r}function vHe(t,e){const r=[],n=t.getProgramParameter(e,35721);for(let i=0;i<n;i++){const a=t.getActiveAttrib(e,i);if(!a)throw new Error("activeInfo");const{name:s,type:o}=a,c=t.getAttribLocation(e,s);if(c>=0){const{attributeType:f}=mHe(o),d=/instance/i.test(s)?"instance":"vertex";r.push({name:s,location:c,stepMode:d,type:f})}}return r.sort((i,a)=>i.location-a.location),r}function _He(t,e){const r=[],n=t.getProgramParameter(e,35971);for(let i=0;i<n;i++){const a=t.getTransformFeedbackVarying(e,i);if(!a)throw new Error("activeInfo");const{name:s,type:o,size:c}=a,{glType:f,components:d}=One(o),m={location:i,name:s,type:f,size:c*d};r.push(m)}return r.sort((i,a)=>i.location-a.location),r}function bHe(t,e){const r=[],n=t.getProgramParameter(e,35718);for(let i=0;i<n;i++){const a=t.getActiveUniform(e,i);if(!a)throw new Error("activeInfo");const{name:s,size:o,type:c}=a,{name:f,isArray:d}=EHe(s);let m=t.getUniformLocation(e,f);const b={location:m,name:f,size:o,type:c,isArray:d};if(r.push(b),b.size>1)for(let x=0;x<b.size;x++){const E=`${f}[${x}]`;m=t.getUniformLocation(e,E);const T={...b,name:E,location:m};r.push(T)}}return r}function xHe(t,e){const r=(a,s)=>t.getActiveUniformBlockParameter(e,a,s),n=[],i=t.getProgramParameter(e,35382);for(let a=0;a<i;a++){const s={name:t.getActiveUniformBlockName(e,a)||"",location:r(a,35391),byteLength:r(a,35392),vertex:r(a,35396),fragment:r(a,35398),uniformCount:r(a,35394),uniforms:[]},o=r(a,35395)||[],c=t.getActiveUniforms(e,o,35383),f=t.getActiveUniforms(e,o,35384),d=t.getActiveUniforms(e,o,35387),m=t.getActiveUniforms(e,o,35388);for(let b=0;b<s.uniformCount;++b){const x=t.getActiveUniform(e,o[b]);if(!x)throw new Error("activeInfo");s.uniforms.push({name:x.name,format:One(c[b]).format,type:c[b],arrayLength:f[b],byteOffset:d[b],byteStride:m[b]})}n.push(s)}return n.sort((a,s)=>a.location-s.location),n}const wHe={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function SHe(t){const e=wHe[t];if(!e)throw new Error("sampler");const[r,n]=e;return{viewDimension:r,sampleType:n}}function EHe(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const r=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!r||r.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:r[1],length:r[2]?1:0,isArray:!!r[2]}}function THe(t,e,r,n){const i=t;let a=n;a===!0&&(a=1),a===!1&&(a=0);const s=typeof a=="number"?[a]:a;switch(r){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof n!="number")throw new Error("samplers must be set to integers");return t.uniform1i(e,n);case 5126:return t.uniform1fv(e,s);case 35664:return t.uniform2fv(e,s);case 35665:return t.uniform3fv(e,s);case 35666:return t.uniform4fv(e,s);case 5124:return t.uniform1iv(e,s);case 35667:return t.uniform2iv(e,s);case 35668:return t.uniform3iv(e,s);case 35669:return t.uniform4iv(e,s);case 35670:return t.uniform1iv(e,s);case 35671:return t.uniform2iv(e,s);case 35672:return t.uniform3iv(e,s);case 35673:return t.uniform4iv(e,s);case 5125:return i.uniform1uiv(e,s,1);case 36294:return i.uniform2uiv(e,s,2);case 36295:return i.uniform3uiv(e,s,3);case 36296:return i.uniform4uiv(e,s,4);case 35674:return t.uniformMatrix2fv(e,!1,s);case 35675:return t.uniformMatrix3fv(e,!1,s);case 35676:return t.uniformMatrix4fv(e,!1,s);case 35685:return i.uniformMatrix2x3fv(e,!1,s);case 35686:return i.uniformMatrix2x4fv(e,!1,s);case 35687:return i.uniformMatrix3x2fv(e,!1,s);case 35688:return i.uniformMatrix3x4fv(e,!1,s);case 35689:return i.uniformMatrix4x2fv(e,!1,s);case 35690:return i.uniformMatrix4x3fv(e,!1,s)}throw new Error("Illegal uniform")}function CHe(t){return dne(t)!==null||typeof t=="number"||typeof t=="boolean"}function AHe(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(r=>{const n=t[r];CHe(n)?e.uniforms[r]=n:e.bindings[r]=n}),e}function IHe(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(t)}}function PHe(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(t)}}const mW=4;class MHe extends e_{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(e,r){super(e,r),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;const{varyings:n,bufferMode:i=35981}=r;n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,i)),this._linkShaders(),gn.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=yHe(this.device.gl,this.handle),gn.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=kHe(this.introspectedLayout,r.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(e,r){for(const[n,i]of Object.entries(e)){const a=this.shaderLayout.bindings.find(s=>s.name===n)||this.shaderLayout.bindings.find(s=>s.name===`${n}Uniforms`);if(!a){const s=this.shaderLayout.bindings.map(o=>`"${o.name}"`).join(", ");r?.disableWarnings||gn.warn(`No binding "${n}" in render pipeline "${this.id}", expected one of ${s}`,i)();continue}switch(i||gn.warn(`Unsetting binding "${n}" in render pipeline "${this.id}"`)(),a.type){case"uniform":if(!(i instanceof Cb)&&!(i.buffer instanceof Cb))throw new Error("buffer value");break;case"texture":if(!(i instanceof m0||i instanceof Ab||i instanceof Tb))throw new Error("texture value");break;case"sampler":gn.warn(`Ignoring sampler ${n}`)();break;default:throw new Error(a.type)}this.bindings[n]=i}}draw(e){const{renderPass:r,parameters:n=this.props.parameters,topology:i=this.props.topology,vertexArray:a,vertexCount:s,instanceCount:o,isInstanced:c=!1,firstVertex:f=0,transformFeedback:d}=e,m=IHe(i),b=!!a.indexBuffer,x=a.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return gn.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return gn.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),a.bindBeforeRender(r),d&&d.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const E=r;return Yqe(this.device,n,E.glParameters,()=>{b&&c?this.device.gl.drawElementsInstanced(m,s||0,x,f,o||0):b?this.device.gl.drawElements(m,s||0,x,f):c?this.device.gl.drawArraysInstanced(m,f,s||0,o||0):this.device.gl.drawArrays(m,f,s||0),d&&d.end()}),a.unbindAfterRender(r),!0}setUniformsWebGL(e){const{bindings:r}=AHe(e);Object.keys(r).forEach(n=>{gn.warn(`Unsupported value "${JSON.stringify(r[n])}" used in setUniforms() for key ${n}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,e)}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),gn.time(mW,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),gn.timeEnd(mW,`linkProgram for ${this.id}`)(),gn.level,!this.device.features.has("compilation-status-async-webgl")){const n=this._getLinkStatus();this._reportLinkStatus(n);return}gn.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),gn.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const r=this._getLinkStatus();this._reportLinkStatus(r)}async _reportLinkStatus(e){switch(e){case"success":return;default:switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then(()=>this.vs.debugShader());break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then(()=>this.fs.debugShader());break}const r=this.device.gl.getProgramInfoLog(this.handle);throw new Error(`Error during ${e}: ${r}`)}}_getLinkStatus(){const{gl:e}=this.device;return e.getProgramParameter(this.handle,35714)?(e.validateProgram(this.handle),e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){const e=async i=>await new Promise(a=>setTimeout(a,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:n}=this.device;for(;;){if(n.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const r of this.shaderLayout.bindings)!this.bindings[r.name]&&!this.bindings[r.name.replace(/Uniforms$/,"")]&&(gn.warn(`Binding ${r.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:e}=this.device;e.useProgram(this.handle);let r=0,n=0;for(const i of this.shaderLayout.bindings){const a=this.bindings[i.name]||this.bindings[i.name.replace(/Uniforms$/,"")];if(!a)throw new Error(`No value for binding ${i.name} in ${this.id}`);switch(i.type){case"uniform":const{name:s}=i,o=e.getUniformBlockIndex(this.handle,s);if(o===4294967295)throw new Error(`Invalid uniform block name ${s}`);e.uniformBlockBinding(this.handle,n,o),a instanceof Cb?e.bindBufferBase(35345,n,a.handle):e.bindBufferRange(35345,n,a.buffer.handle,a.offset||0,a.size||a.buffer.byteLength-a.offset),n+=1;break;case"texture":if(!(a instanceof m0||a instanceof Ab||a instanceof Tb))throw new Error("texture");let c;if(a instanceof m0)c=a.texture;else if(a instanceof Ab)c=a;else if(a instanceof Tb&&a.colorAttachments[0]instanceof m0)gn.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),c=a.colorAttachments[0].texture;else throw new Error("No texture");e.activeTexture(33984+r),e.bindTexture(c.glTarget,c.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${i.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:r,location:n,type:i,textureUnit:a}=e,s=this.uniforms[r]??a;s!==void 0&&THe(this.device.gl,n,i,s)}}}function kHe(t,e){const r={...t,attributes:t.attributes.map(n=>({...n}))};for(const n of e?.attributes||[]){const i=r.attributes.find(a=>a.name===n.name);i?(i.type=n.type||i.type,i.stepMode=n.stepMode||i.stepMode):gn.warn(`shader layout attribute ${n.name} not present in shader`)}return r}class RHe extends VN{device;commands=[];constructor(e){super(e,{}),this.device=e}submitCommands(e=this.commands){for(const r of e)switch(r.name){case"copy-buffer-to-buffer":DHe(this.device,r.options);break;case"copy-buffer-to-texture":OHe(this.device,r.options);break;case"copy-texture-to-buffer":LHe(this.device,r.options);break;case"copy-texture-to-texture":NHe(this.device,r.options);break;default:throw new Error(r.name)}}}function DHe(t,e){const r=e.sourceBuffer,n=e.destinationBuffer;t.gl.bindBuffer(36662,r.handle),t.gl.bindBuffer(36663,n.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function OHe(t,e){throw new Error("Not implemented")}function LHe(t,e){const{sourceTexture:r,mipLevel:n=0,aspect:i="all",width:a=e.sourceTexture.width,height:s=e.sourceTexture.height,depthOrArrayLayers:o=0,origin:c=[0,0],destinationBuffer:f,byteOffset:d=0,bytesPerRow:m,rowsPerImage:b}=e;if(i!=="all")throw new Error("aspect not supported in WebGL");if(n!==0||o!==0||m||b)throw new Error("not implemented");const{framebuffer:x,destroyFramebuffer:E}=Lne(r);let T;try{const A=f,R=a||x.width,F=s||x.height,N=Cne(x.colorAttachments[0].texture.props.format),O=N.format,U=N.type;t.gl.bindBuffer(35051,A.handle),T=t.gl.bindFramebuffer(36160,x.handle),t.gl.readPixels(c[0],c[1],R,F,O,U,d)}finally{t.gl.bindBuffer(35051,null),T!==void 0&&t.gl.bindFramebuffer(36160,T),E&&x.destroy()}}function NHe(t,e){const{sourceTexture:r,destinationMipLevel:n=0,origin:i=[0,0],destinationOrigin:a=[0,0],destinationTexture:s}=e;let{width:o=e.destinationTexture.width,height:c=e.destinationTexture.height}=e;const{framebuffer:f,destroyFramebuffer:d}=Lne(r),[m,b]=i,[x,E,T]=a,A=t.gl.bindFramebuffer(36160,f.handle);let R=null,F;if(s instanceof Ab)R=s,o=Number.isFinite(o)?o:R.width,c=Number.isFinite(c)?c:R.height,R.bind(0),F=R.glTarget;else throw new Error("invalid destination");switch(F){case 3553:case 34067:t.gl.copyTexSubImage2D(F,n,x,E,m,b,o,c);break;case 35866:case 32879:t.gl.copyTexSubImage3D(F,n,x,E,T,m,b,o,c);break}R&&R.unbind(),t.gl.bindFramebuffer(36160,A),d&&f.destroy()}function Lne(t){if(t instanceof xo){const{width:e,height:r,id:n}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${n}`,width:e,height:r,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}class FHe extends UN{device;commandBuffer;constructor(e,r){super(e,r),this.device=e,this.commandBuffer=new RHe(e)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,r,n){}}function BHe(t){const{target:e,source:r,start:n=0,count:i=1}=t,a=r.length,s=i*a;let o=0;for(let c=n;o<a;o++)e[c++]=r[o];for(;o<s;)o<s-o?(e.copyWithin(n+o,n,n+o),o*=2):(e.copyWithin(n+o,n,n+s-o),o=s);return t.target}class g6 extends $N{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return tBe()==="Chrome"}constructor(e,r){super(e,r),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const r=e;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(e,r){const n=r;if(n.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:i,type:a,stride:s,offset:o,normalized:c,integer:f,divisor:d}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),f?this.device.gl.vertexAttribIPointer(e,i,a,s,o):this.device.gl.vertexAttribPointer(e,i,a,c,s,o),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,d||0),this.attributes[e]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,r){this._enable(e,!1),this.attributes[e]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const r=this.attributes[e];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(e,r)}}_getAccessor(e){const r=this.attributeInfos[e];if(!r)throw new Error(`Unknown attribute location ${e}`);const n=Tne(r.bufferDataType);return{size:r.bufferComponents,type:n,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(e,r=!0){const i=g6.isConstantAttributeZeroSupported(this.device)||e!==0;(r||i)&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,r){const n=zHe(r),i=n.byteLength*e,a=n.length*e;if(this.buffer&&i!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${i} !== ${this.buffer.byteLength}.`);let s=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:i}),s=s||!jHe(n,this.bufferValue),s){const o=U9e(r.constructor,a);BHe({target:o,source:n,start:0,count:a}),this.buffer.write(o),this.bufferValue=r}return this.buffer}}function zHe(t){return Array.isArray(t)?new Float32Array(t):t}function jHe(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}class UHe extends qN{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,r){super(e,r),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(PHe(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const r in e)this.setBuffer(r,e[r])})}setBuffer(e,r){const n=this._getVaryingIndex(e),{buffer:i,byteLength:a,byteOffset:s}=this._getBufferRange(r);if(n<0){this.unusedBuffers[e]=i,gn.warn(`${this.id} unusedBuffers varying buffer ${e}`)();return}this.buffers[n]={buffer:i,byteLength:a,byteOffset:s},this.bindOnUse||this._bindBuffer(n,i,s,a)}getBuffer(e){if(yW(e))return this.buffers[e]||null;const r=this._getVaryingIndex(e);return r>=0?this.buffers[r]:null}bind(e=this.handle){if(typeof e!="function")return this.gl.bindTransformFeedback(36386,e),this;let r;return this._bound?r=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof Cb)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:r,byteOffset:n=0,byteLength:i=e.buffer.byteLength}=e;return{buffer:r,byteOffset:n,byteLength:i}}_getVaryingIndex(e){if(yW(e))return Number(e);for(const r of this.layout.varyings)if(e===r.name)return r.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:r,byteLength:n,byteOffset:i}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),r,i,n)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,r,n=0,i){const a=r&&r.handle;!a||i===void 0?this.gl.bindBufferBase(35982,e,a):this.gl.bindBufferRange(35982,e,a,n,i)}}function yW(t){return typeof t=="number"?Number.isInteger(t):/^\d+$/.test(t)}class VHe extends HN{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,r){if(super(e,r),this.device=e,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((n,i)=>{const a=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):r++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(a)};requestAnimationFrame(a)}),this._pollingPromise}}class y0 extends xg{type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;constructor(e){super({...e,id:e.id||qqe("webgl-device")});const r=xg._getCanvasContextProps(e);if(!r)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let n=r.canvas?.gl?.device;if(n)throw new Error(`WebGL context already attached to device ${n.id}`);this.canvasContext=new Dqe(this,r),this.lost=new Promise(d=>{this._resolveContextLost=d});const i={...e.webgl};r.alphaMode==="premultiplied"&&(i.premultipliedAlpha=!0),e.powerPreference!==void 0&&(i.powerPreference=e.powerPreference);const s=this.props._handle||dqe(this.canvasContext.canvas,{onContextLost:d=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:d=>console.log("WebGL context restored")},i);if(!s)throw new Error("WebGL context creation failed");if(n=s.device,n){if(e._reuseDevices)return gn.log(1,`Not creating a new Device, instead returning a reference to Device ${n.id} already attached to WebGL context`,n)(),n._reused=!0,n;throw new Error(`WebGL context already attached to device ${n.id}`)}this.handle=s,this.gl=s,this.spectorJS=Nqe({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=pqe(this.gl,this._extensions),this.limits=new Mqe(this.gl),this.features=new Pqe(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),r.autoResize!==!1&&this.canvasContext.resize(),new Hm(this.gl,{log:(...d)=>gn.log(1,...d)()}).trackState(this.gl,{copyState:!1});const c=e.debugWebGL||e.debug,f=e.debugWebGL;c&&(this.gl=zqe(this.gl,{debugWebGL:c,traceWebGL:f}),gn.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(gn.level=Math.max(gn.level,1)))}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const r=this._normalizeBufferProps(e);return new Cb(this,r)}createTexture(e){return new Ab(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new vD(this,e)}createShader(e){return new Xqe(this,e)}createFramebuffer(e){return new Tb(this,e)}createVertexArray(e){return new g6(this,e)}createTransformFeedback(e){return new UHe(this,e)}createQuerySet(e){return new VHe(this,e)}createRenderPipeline(e){return new MHe(this,e)}beginRenderPass(e){return new dHe(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(e={}){return new FHe(this,e)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(e,r){return lHe(e,r)}readPixelsToBufferWebGL(e,r){return uHe(e,r)}setParametersWebGL(e){P_(this.gl,e)}getParametersWebGL(e){return Sne(this.gl,e)}withParametersWebGL(e,r){return vT(this.gl,e,r)}resetWebGL(){gn.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),lqe(this.gl)}_getDeviceSpecificTextureFormatCapabilities(e){return Tqe(this.gl,e,this._extensions)}loseDevice(){let e=!1;const n=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return n&&(e=!0,n.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){Hm.get(this.gl).push()}popState(){Hm.get(this.gl).pop()}setSpectorMetadata(e,r){e.__SPECTOR_Metadata=r}getGLKey(e,r){const n=Number(e);for(const i in this.gl)if(this.gl[i]===n)return`GL.${i}`;return r?.emptyIfUnknown?"":String(e)}getGLKeys(e){const r={emptyIfUnknown:!0};return Object.entries(e).reduce((n,[i,a])=>(n[`${i}:${this.getGLKey(i,r)}`]=`${a}:${this.getGLKey(a,r)}`,n),{})}_constants;setConstantAttributeWebGL(e,r){const n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);const i=this._constants[e];switch(i&&GHe(i,r)&&gn.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=r,r.constructor){case Float32Array:$He(this,e,r);break;case Int32Array:qHe(this,e,r);break;case Uint32Array:HHe(this,e,r);break;default:throw new Error("constant")}}getExtension(e){return l_(this.gl,e,this._extensions),this._extensions}}function $He(t,e,r){switch(r.length){case 1:t.gl.vertexAttrib1fv(e,r);break;case 2:t.gl.vertexAttrib2fv(e,r);break;case 3:t.gl.vertexAttrib3fv(e,r);break;case 4:t.gl.vertexAttrib4fv(e,r);break}}function qHe(t,e,r){t.gl.vertexAttribI4iv(e,r)}function HHe(t,e,r){t.gl.vertexAttribI4uiv(e,r)}function GHe(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}const WHe={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},XHe=t=>({drawBuffersWEBGL(e){return t.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),YHe=t=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return t.createVertexArray()},deleteVertexArrayOES(e){return t.deleteVertexArray(e)},isVertexArrayOES(e){return t.isVertexArray(e)},bindVertexArrayOES(e){return t.bindVertexArray(e)}}),ZHe=t=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return t.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return t.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return t.vertexAttribDivisor(...e)}});function KHe(t=!0){const e=HTMLCanvasElement.prototype;if(!t&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(r,n){if(r==="webgl"||r==="experimental-webgl"){const i=this.originalGetContext("webgl2",n);return i instanceof HTMLElement&&JHe(i),i}return this.originalGetContext(r,n)}}function JHe(t){t.getExtension("EXT_color_buffer_float");const e={...WHe,WEBGL_disjoint_timer_query:t.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:XHe(t),OES_vertex_array_object:YHe(t),ANGLE_instanced_arrays:ZHe(t)},r=t.getExtension;t.getExtension=function(i){const a=r.call(t,i);return a||(i in e?e[i]:null)};const n=t.getSupportedExtensions;t.getSupportedExtensions=function(){return(n.apply(t)||[])?.concat(Object.keys(e))}}const Zw=1;class QHe extends y9e{type="webgl";constructor(){super(),xg.defaultProps={...xg.defaultProps,...p6},y0.adapter=this}isSupported(){return typeof WebGL2RenderingContext<"u"}enforceWebGL2(e){KHe(e)}async attach(e){if(e instanceof y0)return e;if(e?.device instanceof xg)return e.device;if(!eGe(e))throw new Error("Invalid WebGL2RenderingContext");return new y0({_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1}})}async create(e={}){gn.groupCollapsed(Zw,"WebGLDevice created")();const r=[];(e.debugWebGL||e.debug)&&r.push(Bqe()),e.debugSpectorJS&&r.push(Lqe(e));const n=await Promise.allSettled(r);for(const s of n)s.status==="rejected"&&gn.error(`Failed to initialize debug libraries ${s.reason}`)();const i=new y0(e),a=`${i._reused?"Reusing":"Created"} device with WebGL2 ${i.debug?"debug ":""}context: ${i.info.vendor}, ${i.info.renderer} for canvas: ${i.canvasContext.id}`;return gn.probe(Zw,a)(),gn.table(Zw,i.info)(),gn.groupEnd(Zw)(),i}}function eGe(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}const vW=new QHe;function rg(){}const tGe=({isDragging:t})=>t?"grabbing":"grab",Nne={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:rg,onWebGLInitialized:rg,onResize:rg,onViewStateChange:rg,onInteractionStateChange:rg,onBeforeRender:rg,onAfterRender:rg,onLoad:rg,onError:t=>oo.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:tGe,getTooltip:null,debug:!1,drawPickingColors:!1};class mx{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new H3({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const a=n.offsetCenter;if(!a)return;i.x=a.x,i.y=a.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n},this._onEvent=n=>{const i=uD[n.type],a=n.offsetCenter;if(!i||!a||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:a.x,y:a.y,layers:s,viewports:this.getViewports(a)},this._lastPointerDownInfo),{layer:c}=o,f=c&&(c[i]||c.props[i]),d=this.props[i];let m=!1;f&&(m=f.call(c,o,n)),m||(d?.(o,n),this.widgetManager.onEvent(o,n))},this._onPointerDown=n=>{if(this.device?.type==="webgpu")return;const i=n.offsetCenter,a=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=a.result[0]||a.emptyInfo},this.props={...Nne,...e},e=this.props,e.viewState&&e.initialViewState&&oo.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let r=this.device;!r&&e.gl&&(e.gl instanceof WebGLRenderingContext&&oo.error("WebGL1 context not supported.")(),r=vW.attach(e.gl)),r||(r=QR.createDevice({type:"best-available",_reuseDevices:!0,adapters:[vW],...e.deviceProps,createCanvasContext:{canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!1}})),this.animationLoop=this._createAnimationLoop(r,e),this.setProps(e),e._typedArrayManagerProps&&gx.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&oo.removed("onLayerHover","onHover")(),"onLayerClick"in e&&oo.removed("onLayerClick","onClick")(),e.initialViewState&&!Mc(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const r=Object.create(this.props);Object.assign(r,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop?.setProps(r),this.layerManager&&(this.viewManager.setProps(r),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(r),this.effectManager.setProps(r),this.deckRenderer.setProps(r),this.deckPicker.setProps(r),this.widgetManager.setProps(r)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let r=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),a=this.effectManager.needsRedraw(e),s=this.deckRenderer.needsRedraw(e);return r=r||n||i||a||s,r}redraw(e){if(!this.layerManager)return;let r=this.needsRedraw({clearRedrawFlags:!0});r=e||r,r&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(r):this._drawLayers(r))}get isInitialized(){return this.viewManager!==null}getViews(){return Fl(this.viewManager),this.viewManager.views}getViewports(e){return Fl(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const r=this._pick("pickObject","pickObject Time",e).result;return r.length?r[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,r=!1){for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:r})}_removeResources(e){for(const r of e)this.layerManager.resourceManager.remove(r)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,r,n){Fl(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(r).timeStart();const a=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(r).timeEnd(),a}_createCanvas(e){let r=e.canvas;return typeof r=="string"&&(r=document.getElementById(r),Fl(r)),r||(r=document.createElement("canvas"),r.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(r)),Object.assign(r.style,e.style),r}_setCanvasSize(e){if(!this.canvas)return;const{width:r,height:n}=e;if(r||r===0){const i=Number.isFinite(r)?`${r}px`:r;this.canvas.style.width=i}if(n||n===0){const i=Number.isFinite(n)?`${n}px`:n;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=i}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const r=e.clientWidth??e.width,n=e.clientHeight??e.height;(r!==this.width||n!==this.height)&&(this.width=r,this.height=n,this.viewManager?.setProps({width:r,height:n}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:n}))}_createAnimationLoop(e,r){const{gl:n,onError:i,useDevicePixels:a}=r;return new a$e({device:e,useDevicePixels:a,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:s=>this._setDevice(s.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,r=Array.isArray(e)?e:e?[e]:[new c6({id:"default-view"})];return r.length&&this.props.controller&&(r[0].props.controller=this.props.controller),r}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if(this.device?.type==="webgpu")return;const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:n}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let i=n,a=!1;for(const s of r)i=s,a=s.layer?.onHover(s,e.event)||a;a||(this.props.onHover?.(i,e.event),this.widgetManager.onHover(i,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);const r=new hne;r.play(),this.animationLoop.attachTimeline(r),this.eventManager=new DUe(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(zG).map(i=>{const[a,s,o,c]=zG[i],f=this.props.eventRecognizerOptions?.[i],d={...s,...f,event:i};return{recognizer:new a(d),recognizeWith:o,requestFailure:c}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in uD)this.eventManager.on(i,this._onEvent);this.viewManager=new M$e({timeline:r,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new P$e(this.device,{deck:this,stats:this.stats,viewport:n,timeline:r}),this.effectManager=new q$e({deck:this,device:this.device}),this.deckRenderer=new W$e(this.device),this.deckPicker=new Q$e(this.device),this.widgetManager=new rqe({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new iqe),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,r){const{device:n,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:i});const a={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...r};this.deckRenderer?.renderLayers(a),a.pass==="screen"&&this.widgetManager.onRedraw({viewports:a.viewports,layers:a.layers}),this.props.onAfterRender({device:n,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),oo.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const r=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:r},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const r=this.animationLoop.stats;e.get("GPU Time").addTime(r.get("GPU Time").lastTiming),e.get("CPU Time").addTime(r.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:r}=this;e.fps=r.get("frameRate").getHz(),e.setPropsTime=r.get("setProps Time").time,e.updateAttributesTime=r.get("Update Attributes").time,e.framesRedrawn=r.get("Redraw Count").count,e.pickTime=r.get("pickObject Time").time+r.get("pickMultipleObjects Time").time+r.get("pickObjects Time").time,e.pickCount=r.get("Pick Count").count,e.gpuTime=r.get("GPU Time").time,e.cpuTime=r.get("CPU Time").time,e.gpuTimePerFrame=r.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=r.get("CPU Time").getAverageTime();const n=QR.stats.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}mx.defaultProps=Nne;mx.VERSION=wze;function rGe(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return cre(t)}}const nGe=ure;function Kw(t,e,r){const n=r==="webgpu"&&e.type==="uint8"?"unorm8":e.type;return{attribute:t,format:e.size>1?`${n}x${e.size}`:e.type,byteOffset:e.offset||0}}function Dm(t){return t.stride||t.size*t.bytesPerElement}function iGe(t,e){return t.type===e.type&&t.size===e.size&&Dm(t)===Dm(e)&&(t.offset||0)===(e.offset||0)}function _D(t,e){e.offset&&oo.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const r=Dm(t),n=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,a=n*r+i*t.bytesPerElement+(t.offset||0);return{...e,offset:a,stride:r}}function aGe(t,e){const r=_D(t,e);return{high:r,low:{...r,offset:r.offset+t.size*4}}}class oGe{constructor(e,r,n){this._buffer=null,this.device=e,this.id=r.id||"",this.size=r.size||1;const i=r.logicalType||r.type,a=i==="float64";let{defaultValue:s}=r;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0);let o;a?o="float32":!i&&r.isIndexed?o="uint32":o=i||"float32";let c=rGe(i||o);this.doublePrecision=a,a&&r.fp64===!1&&(c=Float32Array),this.value=null,this.settings={...r,defaultType:c,defaultValue:s,logicalType:i,type:o,normalized:o.includes("norm"),size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Dm(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),gx.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,r=null){const n={};if(this.state.constant){const i=this.value;if(r){const a=_D(this.getAccessor(),r),s=a.offset/i.BYTES_PER_ELEMENT,o=a.size||this.size;n[e]=i.subarray(s,s+o)}else n[e]=i}else n[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n[`${e}64Low`]=n[e]:n[`${e}64Low`]=new Float32Array(this.size)),n}_getBufferLayout(e=this.id,r=null){const n=this.getAccessor(),i=[],a={name:this.id,byteStride:Dm(n),attributes:i};if(this.doublePrecision){const s=aGe(n,r||{});i.push(Kw(e,{...n,...s.high},this.device.type),Kw(`${e}64Low`,{...n,...s.low},this.device.type))}else if(r){const s=_D(n,r);i.push(Kw(e,{...n,...s},this.device.type))}else i.push(Kw(e,n,this.device.type));return a}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const r=Array.from(this.value);e=[r,r]}else{const{value:r,numInstances:n,size:i}=this,a=n*i;if(r&&a&&r.length>=a){const s=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let c=0;c<a;)for(let f=0;f<i;f++){const d=r[c++];d<s[f]&&(s[f]=d),d>o[f]&&(o[f]=d)}e=[s,o]}}return this.state.bounds=e,e}setData(e){const{state:r}=this;let n;ArrayBuffer.isView(e)?n={value:e}:e instanceof jo?n={buffer:e}:n=e;const i={...this.settings,...n};if(ArrayBuffer.isView(n.value)){if(!n.type)if(this.doublePrecision&&n.value instanceof Float64Array)i.type="float32";else{const s=nGe(n.value);i.type=i.normalized?s.replace("int","norm"):s}i.bytesPerElement=n.value.BYTES_PER_ELEMENT,i.stride=Dm(i)}if(r.bounds=null,n.constant){let a=n.value;if(a=this._normalizeValue(a,[],0),this.settings.normalized&&(a=this.normalizeConstant(a)),!(!r.constant||!this._areValuesEqual(a,this.value)))return!1;r.externalBuffer=null,r.constant=!0,this.value=ArrayBuffer.isView(a)?a:new Float32Array(a)}else if(n.buffer){const a=n.buffer;r.externalBuffer=a,r.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let a=n.value;r.externalBuffer=null,r.constant=!1,this.value=a;let{buffer:s}=this;const o=Dm(i),c=(i.vertexOffset||0)*o;if(this.doublePrecision&&a instanceof Float64Array&&(a=rM(a,i)),this.settings.isIndexed){const d=this.settings.defaultType;a.constructor!==d&&(a=new d(a))}const f=a.byteLength+c+o*2;(!s||s.byteLength<f)&&(s=this._createBuffer(f)),s.write(a,c)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const r=this.value,{startOffset:n=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&r instanceof Float64Array?rM(r,{size:this.size,startIndex:n,endIndex:i}):r.subarray(n,i),n*r.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,r=!1){const{state:n}=this,i=n.allocatedValue,a=gx.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:r});this.value=a;const{byteOffset:s}=this;let{buffer:o}=this;return(!o||o.byteLength<a.byteLength+s)&&(o=this._createBuffer(a.byteLength+s),r&&i&&o.write(i instanceof Float64Array?rM(i,this):i,s)),n.allocatedValue=a,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:r}=e;if(!ArrayBuffer.isView(r))throw new Error(`Attribute ${this.id} value is not TypedArray`);const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=r.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${r.constructor.name}`);!(r instanceof n)&&this.settings.normalized&&!("normalized"in e)&&oo.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(r=>(r+128)/255*2-1);case"snorm16":return new Float32Array(e).map(r=>(r+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(r=>r/255);case"unorm16":return new Float32Array(e).map(r=>r/65535);default:return e}}_normalizeValue(e,r,n){const{defaultValue:i,size:a}=this.settings;if(Number.isFinite(e))return r[n]=e,r;if(!e){let s=a;for(;--s>=0;)r[n+s]=i[s];return r}switch(a){case 4:r[n+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:r[n+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:r[n+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:r[n+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let s=a;for(;--s>=0;)r[n+s]=Number.isFinite(e[s])?e[s]:i[s]}return r}_areValuesEqual(e,r){if(!e||!r)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(e[i]!==r[i])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:r,type:n}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(r?jo.INDEX:jo.VERTEX)|jo.COPY_DST,indexType:r?n:void 0,byteLength:e}),this._buffer}}const _W=[],bW=[];function Fne(t,e=0,r=1/0){let n=_W;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?n=t:t.length>0&&(bW.length=t.length,n=bW):n=_W,(e>0||Number.isFinite(r))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(e,r),i.index=e-1),{iterable:n,objectInfo:i}}function Bne(t){return t&&t[Symbol.asyncIterator]}function sGe(t,e){const{size:r,stride:n,offset:i,startIndices:a,nested:s}=e,o=t.BYTES_PER_ELEMENT,c=n?n/o:r,f=i?i/o:0,d=Math.floor((t.length-f)/c);return(m,{index:b,target:x})=>{if(!a){const R=b*c+f;for(let F=0;F<r;F++)x[F]=t[R+F];return x}const E=a[b],T=a[b+1]||d;let A;if(s){A=new Array(T-E);for(let R=E;R<T;R++){const F=R*c+f;x=new Array(r);for(let N=0;N<r;N++)x[N]=t[F+N];A[R-E]=x}}else if(c===r)A=t.subarray(E*r+f,T*r+f);else{A=new t.constructor((T-E)*r);let R=0;for(let F=E;F<T;F++){const N=F*c+f;for(let O=0;O<r;O++)A[R++]=t[N+O]}}return A}}const lGe=[],RS=[[0,1/0]];function uGe(t,e){if(t===RS||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const r=[],n=t.length;let i=0;for(let a=0;a<n;a++){const s=t[a];s[1]<e[0]?(r.push(s),i=a+1):s[0]>e[1]?r.push(s):e=[Math.min(s[0],e[0]),Math.max(s[1],e[1])]}return r.splice(i,0,e),r}const cGe={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function zne(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const r=t.type||"interpolation";return{...cGe[r],...e,...t,type:r}}class jne extends oGe{constructor(e,r){super(e,r,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:RS}),this.constant=!1,this.settings.update=r.update||(r.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const r=this.state.needsRedraw;return this.state.needsRedraw=r&&!e,r}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var r;(r=this.state).layoutChanged||(r.layoutChanged=!iGe(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:r}=this.settings,n=this.settings.transition,i=Array.isArray(r)?e[r.find(a=>e[a])]:e[r];return zne(i,n)}setNeedsUpdate(e=this.id,r){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),r){const{startRow:n=0,endRow:i=1/0}=r;this.state.updateRanges=uGe(this.state.updateRanges,[n,i])}else this.state.updateRanges=RS}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=lGe}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:r,settings:n}=this;return n.noAlloc?!1:n.update?(super.allocate(e,r.updateRanges!==RS),!0):!1}updateBuffer({numInstances:e,data:r,props:n,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:s,noAlloc:o}}=this;let c=!0;if(s){for(const[f,d]of a)s.call(i,this,{data:r,startRow:f,endRow:d,props:n,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[f,d]of a){const m=Number.isFinite(f)?this.getVertexOffset(f):0,b=Number.isFinite(d)?this.getVertexOffset(d):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:m,endOffset:b})}this._checkAttributeArray()}else c=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),c}setConstantValue(e){return this.device.type==="webgpu"||e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:r}=this;return e?(this.clearNeedsUpdate(),r.lastExternalBuffer===e||(r.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(r.lastExternalBuffer=null,!1)}setBinaryValue(e,r=null){const{state:n,settings:i}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;if(n.binaryValue=e,this.setNeedsRedraw(),i.transform||r!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const s=e;Fl(ArrayBuffer.isView(s.value),`invalid ${i.accessor}`);const o=!!s.size&&s.size!==this.size;return n.binaryAccessor=sGe(s.value,{size:s.size||this.size,stride:s.stride,offset:s.offset,startIndices:r,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:r}=this;return(r?e<r.length?r[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,r=super.getValue();if(!e)return r;for(const n in e)Object.assign(r,super.getValue(n,e[n]));return r}getBufferLayout(e){this.state.layoutChanged=!1;const r=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?n.stepMode=e?e.isInstanced?"instance":"vertex":"instance":n.stepMode=i??"vertex",!r)return n;for(const a in r){const s=super._getBufferLayout(a,r[a]);n.attributes.push(...s.attributes)}return n}_autoUpdater(e,{data:r,startRow:n,endRow:i,props:a,numInstances:s}){if(e.constant&&this.context.device.type!=="webgpu")return;const{settings:o,state:c,value:f,size:d,startIndices:m}=e,{accessor:b,transform:x}=o;let E=c.binaryAccessor||(typeof b=="function"?b:a[b]);typeof E!="function"&&(E=()=>E),Fl(typeof E=="function",`accessor "${b}" is not a function`);let T=e.getVertexOffset(n);const{iterable:A,objectInfo:R}=Fne(r,n,i);for(const F of A){R.index++;let N=E(F,R);if(x&&(N=x.call(this,N)),m){const O=(R.index<m.length-1?m[R.index+1]:s)-m[R.index];if(N&&Array.isArray(N[0])){let U=T;for(const j of N)e._normalizeValue(j,f,U),U+=d}else N&&N.length>d?f.set(N,T):(e._normalizeValue(N,R.target,0),E$e({target:f,source:R.target,start:T,count:O}));T+=O*d}else e._normalizeValue(N,f,T),T+=d}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,r=Math.min(4,this.size);if(e&&e.length>=r){let n=!0;switch(r){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function hM(t){const{source:e,target:r,start:n=0,size:i,getData:a}=t,s=t.end||r.length,o=e.length,c=s-n;if(o>c){r.set(e.subarray(0,c),n);return}if(r.set(e,n),!a)return;let f=o;for(;f<c;){const d=a(f,e);for(let m=0;m<i;m++)r[n+f]=d[m]||0,f++}}function fGe({source:t,target:e,size:r,getData:n,sourceStartIndices:i,targetStartIndices:a}){if(!i||!a)return hM({source:t,target:e,size:r,getData:n}),e;let s=0,o=0;const c=n&&((d,m)=>n(d+o,m)),f=Math.min(i.length,a.length);for(let d=1;d<f;d++){const m=i[d]*r,b=a[d]*r;hM({source:t.subarray(s,m),target:e,start:o,end:b,size:r,getData:c}),s=m,o=b}return o<e.length&&hM({source:[],target:e,start:o,size:r,getData:c}),e}function hGe(t){const{device:e,settings:r,value:n}=t,i=new jne(e,r);return i.setData({value:n instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:r.normalized}),i}function Une(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function Vne(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function $ne(t){t.push(t.shift())}function dGe(t,e){const{doublePrecision:r,settings:n,value:i,size:a}=t,s=r&&i instanceof Float64Array?2:1;let o=0;const{shaderAttributes:c}=t.settings;if(c)for(const f of Object.values(c))o=Math.max(o,f.vertexOffset??0);return(n.noAlloc?i.length:(e+o)*a)*s}function qne({device:t,source:e,target:r}){return(!r||r.byteLength<e.byteLength)&&(r?.destroy(),r=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),r}function Hne({device:t,buffer:e,attribute:r,fromLength:n,toLength:i,fromStartIndices:a,getData:s=o=>o}){const o=r.doublePrecision&&r.value instanceof Float64Array?2:1,c=r.size*o,f=r.byteOffset,d=r.settings.bytesPerElement<4?f/r.settings.bytesPerElement*4:f,m=r.startIndices,b=a&&m,x=r.isConstant;if(!b&&e&&n>=i)return e;const E=r.value instanceof Float64Array?Float32Array:r.value.constructor,T=x?r.value:new E(r.getBuffer().readSyncWebGL(f,i*E.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!x){const N=s;s=(O,U)=>r.normalizeConstant(N(O,U))}const A=x?(N,O)=>s(T,O):(N,O)=>s(T.subarray(N+f,N+f+c),O),R=e?new Float32Array(e.readSyncWebGL(d,n*4).buffer):new Float32Array(0),F=new Float32Array(i);return fGe({source:R,target:F,sourceStartIndices:a,targetStartIndices:m,size:c,getData:A}),(!e||e.byteLength<F.byteLength+d)&&(e?.destroy(),e=t.createBuffer({byteLength:F.byteLength+d,usage:35050})),e.write(F,d),e}class Gne{constructor({device:e,attribute:r,timeline:n}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new Q3(n),this.attribute=r,this.attributeInTransition=hGe(r),this.currentStartIndices=r.startIndices}get inProgress(){return this.transition.inProgress}start(e,r,n=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=dGe(this.attribute,r),this.transition.start({...e,duration:n})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class pGe extends Gne{constructor({device:e,attribute:r,timeline:n}){super({device:e,attribute:r,timeline:n}),this.type="interpolation",this.transform=vGe(e,r)}start(e,r){const n=this.currentLength,i=this.currentStartIndices;if(super.start(e,r,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:a,attribute:s}=this;$ne(a),a[0]=Hne({device:this.device,buffer:a[0],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),a[1]=qne({device:this.device,source:a[0],target:a[1]}),this.setBuffer(a[1]);const{transform:o}=this,c=o.model;let f=Math.floor(this.currentLength/s.size);Wne(s)&&(f/=2),c.setVertexCount(f),s.isConstant?(c.setAttributes({aFrom:a[0]}),c.setConstantAttributes({aTo:s.value})):c.setAttributes({aFrom:a[0],aTo:s.getBuffer()}),o.transformFeedback.setBuffers({vCurrent:a[1]})}onUpdate(){const{duration:e,easing:r}=this.settings,{time:n}=this.transition;let i=n/e;r&&(i=r(i));const{model:a}=this.transform,s={time:i};a.shaderInputs.setProps({interpolation:s}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const gGe=`uniform interpolationUniforms {
  float time;
} interpolation;
`,xW={name:"interpolation",vs:gGe,uniformTypes:{time:"f32"}},mGe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,yGe=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function Wne(t){return t.doublePrecision&&t.value instanceof Float64Array}function vGe(t,e){const r=e.size,n=Une(r),i=Vne(r),a=e.getBufferLayout();return Wne(e)?new py(t,{vs:yGe,bufferLayout:[{name:"aFrom",byteStride:8*r,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*r}]},{name:"aTo",byteStride:8*r,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*r}]}],modules:[C7e,xW],defines:{ATTRIBUTE_TYPE:n,ATTRIBUTE_SIZE:r},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new py(t,{vs:mGe,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:a.attributes[0].format}],modules:[xW],defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"],disableWarnings:!0})}class _Ge extends Gne{constructor({device:e,attribute:r,timeline:n}){super({device:e,attribute:r,timeline:n}),this.type="spring",this.texture=TGe(e),this.framebuffer=CGe(e,this.texture),this.transform=EGe(e,r)}start(e,r){const n=this.currentLength,i=this.currentStartIndices;super.start(e,r);const{buffers:a,attribute:s}=this;for(let c=0;c<2;c++)a[c]=Hne({device:this.device,buffer:a[c],attribute:s,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});a[2]=qne({device:this.device,source:a[0],target:a[2]}),this.setBuffer(a[1]);const{model:o}=this.transform;o.setVertexCount(Math.floor(this.currentLength/s.size)),s.isConstant?o.setConstantAttributes({aTo:s.value}):o.setAttributes({aTo:s.getBuffer()})}onUpdate(){const{buffers:e,transform:r,framebuffer:n,transition:i}=this,a=this.settings;r.model.setAttributes({aPrev:e[0],aCur:e[1]}),r.transformFeedback.setBuffers({vNext:e[2]});const s={stiffness:a.stiffness,damping:a.damping};r.model.shaderInputs.setProps({spring:s}),r.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),$ne(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(n)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const bGe=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,xGe={name:"spring",vs:bGe,uniformTypes:{damping:"f32",stiffness:"f32"}},wGe=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,SGe=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function EGe(t,e){const r=Une(e.size),n=Vne(e.size);return new py(t,{vs:wGe,fs:SGe,bufferLayout:[{name:"aPrev",format:n},{name:"aCur",format:n},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[xGe],defines:{ATTRIBUTE_TYPE:r},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function TGe(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function CGe(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const AGe={interpolation:pGe,spring:_Ge};class IGe{constructor(e,{id:r,timeline:n}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=r,this.device=e,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:r,numInstances:n}){this.numInstances=n||1;for(const i in e){const a=e[i],s=a.getTransitionSetting(r);s&&this._updateAttribute(i,a,s)}for(const i in this.transitions){const a=e[i];(!a||!a.getTransitionSetting(r))&&this._removeTransition(i)}}hasAttribute(e){const r=this.transitions[e];return r&&r.inProgress}getAttributes(){const e={};for(const r in this.transitions){const n=this.transitions[r];n.inProgress&&(e[r]=n.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const r in this.transitions)this.transitions[r].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,r,n){const i=this.transitions[e];let a=!i||i.type!==n.type;if(a){i&&this._removeTransition(e);const s=AGe[n.type];s?this.transitions[e]=new s({attribute:r,timeline:this.timeline,device:this.device}):(oo.error(`unsupported transition type '${n.type}'`)(),a=!1)}(a||r.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const wW="attributeManager.invalidate",PGe="attributeManager.updateStart",MGe="attributeManager.updateEnd",kGe="attribute.updateStart",RGe="attribute.allocate",DGe="attribute.updateEnd";class Xne{constructor(e,{id:r="attribute-manager",stats:n,timeline:i}={}){this.mergeBoundsMemoized=n2(GVe),this.id=r,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new IGe(e,{id:`${r}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const r=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,r&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const r of e)this.attributes[r]!==void 0&&(this.attributes[r].delete(),delete this.attributes[r])}invalidate(e,r){const n=this._invalidateTrigger(e,r);Qu(wW,this,e,n)}invalidateAll(e){for(const r in this.attributes)this.attributes[r].setNeedsUpdate(r,e);Qu(wW,this,"all")}update({data:e,numInstances:r,startIndices:n=null,transitions:i,props:a={},buffers:s={},context:o={}}){let c=!1;Qu(PGe,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const f in this.attributes){const d=this.attributes[f],m=d.settings.accessor;d.startIndices=n,d.numInstances=r,a[f]&&oo.removed(`props.${f}`,`data.attributes.${f}`)(),d.setExternalBuffer(s[f])||d.setBinaryValue(typeof m=="string"?s[m]:void 0,e.startIndices)||typeof m=="string"&&!s[m]&&d.setConstantValue(a[m])||d.needsUpdate()&&(c=!0,this._updateAttribute({attribute:d,numInstances:r,data:e,props:a,context:o})),this.needsRedraw=this.needsRedraw||d.needsRedraw()}c&&Qu(MGe,this,r),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:r,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,r=e.run();return this.needsRedraw=this.needsRedraw||r,r}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const r=e.map(n=>this.attributes[n]?.getBounds());return this.mergeBoundsMemoized(r)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:r,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const a in r){const s=r[a];s.needsRedraw(e)&&!n.hasAttribute(a)&&(i[a]=s)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(r=>r.getBufferLayout(e))}_add(e,r){for(const n in e){const i=e[n],a={...i,id:n,size:i.isIndexed&&1||i.size||1,...r};this.attributes[n]=new jne(this.device,a)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const r in this.attributes)this.attributes[r].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(r)});this.updateTriggers=e}_invalidateTrigger(e,r){const{attributes:n,updateTriggers:i}=this,a=i[e];return a&&a.forEach(s=>{const o=n[s];o&&o.setNeedsUpdate(o.id,r)}),a}_updateAttribute(e){const{attribute:r,numInstances:n}=e;if(Qu(kGe,r),r.constant){r.setConstantValue(r.value);return}r.allocate(n)&&Qu(RGe,r,n),r.updateBuffer(e)&&(this.needsRedraw=!0,Qu(DGe,r,n))}}class OGe extends Q3{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:r,toValue:n,duration:i,easing:a}}=this,s=a(e/i);this._value=dT(r,n,s)}}const SW=1e-5;function EW(t,e,r,n,i){const a=e-t,o=(r-e)*i,c=-a*n;return o+c+a+e}function LGe(t,e,r,n,i){if(Array.isArray(r)){const a=[];for(let s=0;s<r.length;s++)a[s]=EW(t[s],e[s],r[s],n,i);return a}return EW(t,e,r,n,i)}function TW(t,e){if(Array.isArray(t)){let r=0;for(let n=0;n<t.length;n++){const i=t[n]-e[n];r+=i*i}return Math.sqrt(r)}return Math.abs(t-e)}class NGe extends Q3{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:r,damping:n,stiffness:i}=this.settings,{_prevValue:a=e,_currValue:s=e}=this;let o=LGe(a,s,r,n,i);const c=TW(o,r),f=TW(o,s);c<SW&&f<SW&&(o=r,this.end()),this._prevValue=s,this._currValue=o}}const FGe={interpolation:OGe,spring:NGe};class BGe{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,r,n,i){const{transitions:a}=this;if(a.has(e)){const c=a.get(e),{value:f=c.settings.fromValue}=c;r=f,this.remove(e)}if(i=zne(i),!i)return;const s=FGe[i.type];if(!s){oo.error(`unsupported transition type '${i.type}'`)();return}const o=new s(this.timeline);o.start({...i,fromValue:r,toValue:n}),a.set(e,o)}remove(e){const{transitions:r}=this;r.has(e)&&(r.get(e).cancel(),r.delete(e))}update(){const e={};for(const[r,n]of this.transitions)n.update(),e[r]=n.value,n.inProgress||this.remove(r);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function zGe(t){const e=t[Sg];for(const r in e){const n=e[r],{validate:i}=n;if(i&&!i(t[r],n))throw new Error(`Invalid prop ${r}: ${t[r]}`)}}function jGe(t,e){const r=Yne({newProps:t,oldProps:e,propTypes:t[Sg],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=VGe(t,e);let i=!1;return n||(i=$Ge(t,e)),{dataChanged:n,propsChanged:r,updateTriggersChanged:i,extensionsChanged:qGe(t,e),transitionsChanged:UGe(t,e)}}function UGe(t,e){if(!t.transitions)return!1;const r={},n=t[Sg];let i=!1;for(const a in t.transitions){const s=n[a],o=s&&s.type;(o==="number"||o==="color"||o==="array")&&bD(t[a],e[a],s)&&(r[a]=!0,i=!0)}return i?r:!1}function Yne({newProps:t,oldProps:e,ignoreProps:r={},propTypes:n={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const a of Object.keys(t))if(!(a in r)){if(!(a in e))return`${i}.${a} added`;const s=bD(t[a],e[a],n[a]);if(s)return`${i}.${a} ${s}`}for(const a of Object.keys(e))if(!(a in r)){if(!(a in t))return`${i}.${a} dropped`;if(!Object.hasOwnProperty.call(t,a)){const s=bD(t[a],e[a],n[a]);if(s)return`${i}.${a} ${s}`}}return!1}function bD(t,e,r){let n=r&&r.equal;return n&&!n(t,e,r)||!n&&(n=t&&e&&t.equals,n&&!n.call(t,e))?"changed deeply":!n&&e!==t?"changed shallowly":null}function VGe(t,e){if(e===null)return"oldProps is null, initial diff";let r=!1;const{dataComparator:n,_dataDiff:i}=t;return n?n(t.data,e.data)||(r="Data comparator detected a change"):t.data!==e.data&&(r="A new data container was supplied"),r&&i&&(r=i(t.data,e.data)||r),r}function $Ge(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&CW(t,e,"all"))return{all:!0};const r={};let n=!1;for(const i in t.updateTriggers)i!=="all"&&CW(t,e,i)&&(r[i]=!0,n=!0);return n?r:!1}function qGe(t,e){if(e===null)return!0;const r=e.extensions,{extensions:n}=t;if(n===r)return!1;if(!r||!n||n.length!==r.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(r[i]))return!0;return!1}function CW(t,e,r){let n=t.updateTriggers[r];n=n??{};let i=e.updateTriggers[r];return i=i??{},Yne({oldProps:i,newProps:n,triggerName:r})}const HGe="count(): argument not an object",GGe="count(): argument not a container";function WGe(t){if(!YGe(t))throw new Error(HGe);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(XGe(t))return Object.keys(t).length;throw new Error(GGe)}function XGe(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function YGe(t){return t!==null&&typeof t=="object"}function AW(t,e){if(!e)return t;const r={...t,...e};if("defines"in e&&(r.defines={...t.defines,...e.defines}),"modules"in e&&(r.modules=(t.modules||[]).concat(e.modules),e.modules.some(n=>n.name==="project64"))){const n=r.modules.findIndex(i=>i.name==="project32");n>=0&&r.modules.splice(n,1)}if("inject"in e)if(!t.inject)r.inject=e.inject;else{const n={...t.inject};for(const i in e.inject)n[i]=(n[i]||"")+e.inject[i];r.inject=n}return r}const ZGe={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},xD={};function KGe(t,e,r,n){if(r instanceof xo)return r;r.constructor&&r.constructor.name!=="Object"&&(r={data:r});let i=null;r.compressed&&(i={minFilter:"linear",mipmapFilter:r.data.length>1?"nearest":"linear"});const a=e.createTexture({...r,sampler:{...ZGe,...i,...n},mipmaps:!0});return xD[a.id]=t,a}function JGe(t,e){!e||!(e instanceof xo)||xD[e.id]===t&&(e.delete(),delete xD[e.id])}const QGe={boolean:{validate(t,e){return!0},equal(t,e,r){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||wD(t)&&(t.length===3||t.length===4)},equal(t,e,r){return Mc(t,e,1)}},accessor:{validate(t,e){const r=_T(t);return r==="function"||r===_T(e.value)},equal(t,e,r){return typeof e=="function"?!0:Mc(t,e,1)}},array:{validate(t,e){return e.optional&&!t||wD(t)},equal(t,e,r){const{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?Mc(t,e,i):t===e}},object:{equal(t,e,r){if(r.ignore)return!0;const{compare:n}=r,i=Number.isInteger(n)?n:n?1:0;return n?Mc(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,r){return!r.compare&&r.ignore!==!1||t===e}},data:{transform:(t,e,r)=>{if(!t)return t;const{dataTransform:n}=r.props;return n?n(t):typeof t.shape=="string"&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,r)=>{const n=r.context;return!n||!n.device?null:KGe(r.id,n.device,t,{...e.parameters,...r.props.textureParameters})},release:(t,e,r)=>{JGe(r.id,t)}}};function eWe(t){const e={},r={},n={};for(const[i,a]of Object.entries(t)){const s=a?.deprecatedFor;if(s)n[i]=Array.isArray(s)?s:[s];else{const o=tWe(i,a);e[i]=o,r[i]=o.value}}return{propTypes:e,defaultProps:r,deprecatedProps:n}}function tWe(t,e){switch(_T(e)){case"object":return A1(t,e);case"array":return A1(t,{type:"array",value:e,compare:!1});case"boolean":return A1(t,{type:"boolean",value:e});case"number":return A1(t,{type:"number",value:e});case"function":return A1(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function A1(t,e){return"type"in e?{name:t,...QGe[e.type],...e}:"value"in e?{name:t,type:_T(e.value),...e}:{name:t,type:"object",value:e}}function wD(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function _T(t){return wD(t)?"array":t===null?"null":typeof t}function rWe(t,e){let r;for(let a=e.length-1;a>=0;a--){const s=e[a];"extensions"in s&&(r=s.extensions)}const n=SD(t.constructor,r),i=Object.create(n);i[yT]=t,i[gy]={},i[mg]={};for(let a=0;a<e.length;++a){const s=e[a];for(const o in s)i[o]=s[o]}return Object.freeze(i),i}const nWe="_mergedDefaultProps";function SD(t,e){if(!(t instanceof eC.constructor))return{};let r=nWe;if(e)for(const i of e){const a=i.constructor;a&&(r+=`:${a.extensionName||a.name}`)}const n=Zne(t,r);return n||(t[r]=iWe(t,e||[]))}function iWe(t,e){if(!t.prototype)return null;const n=Object.getPrototypeOf(t),i=SD(n),a=Zne(t,"defaultProps")||{},s=eWe(a),o=Object.assign(Object.create(null),i,s.defaultProps),c=Object.assign(Object.create(null),i?.[Sg],s.propTypes),f=Object.assign(Object.create(null),i?.[sM],s.deprecatedProps);for(const d of e){const m=SD(d.constructor);m&&(Object.assign(o,m),Object.assign(c,m[Sg]),Object.assign(f,m[sM]))}return aWe(o,t),sWe(o,c),oWe(o,f),o[Sg]=c,o[sM]=f,e.length===0&&!m6(t,"_propTypes")&&(t._propTypes=c),o}function aWe(t,e){const r=uWe(e);Object.defineProperties(t,{id:{writable:!0,value:r}})}function oWe(t,e){for(const r in e)Object.defineProperty(t,r,{enumerable:!1,set(n){const i=`${this.id}: ${r}`;for(const a of e[r])m6(this,a)||(this[a]=n);oo.deprecated(i,e[r].join("/"))()}})}function sWe(t,e){const r={},n={};for(const i in e){const a=e[i],{name:s,value:o}=a;a.async&&(r[s]=o,n[s]=lWe(s))}t[k0]=r,t[gy]={},Object.defineProperties(t,n)}function lWe(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||Bne(e)?this[gy][t]=e:this[mg][t]=e},get(){if(this[mg]){if(t in this[mg])return this[mg][t]||this[k0][t];if(t in this[gy]){const e=this[yT]&&this[yT].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[k0][t]}}return this[k0][t]}}}function m6(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Zne(t,e){return m6(t,e)&&t[e]}function uWe(t){const e=t.componentName;return e||oo.warn(`${t.name}.componentName not specified`)(),e||t.name}let cWe=0;class eC{constructor(...e){this.props=rWe(this,e),this.id=this.props.id,this.count=cWe++}clone(e){const{props:r}=this,n={};for(const i in r[k0])i in r[mg]?n[i]=r[mg][i]:i in r[gy]&&(n[i]=r[gy][i]);return new this.constructor({...r,...n,...e})}}eC.componentName="Component";eC.defaultProps={};const fWe=Object.freeze({});class hWe{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const r=this.asyncProps[e];r&&r.type&&r.type.release&&r.type.release(r.resolvedValue,r.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||fWe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const r=this.asyncProps[e];return r&&r.resolvedValue}isAsyncPropLoading(e){if(e){const r=this.asyncProps[e];return!!(r&&r.pendingLoadCount>0&&r.pendingLoadCount!==r.resolvedLoadCount)}for(const r in this.asyncProps)if(this.isAsyncPropLoading(r))return!0;return!1}reloadAsyncProp(e,r){this._watchPromise(e,Promise.resolve(r))}setAsyncProps(e){this.component=e[yT]||this.component;const r=e[mg]||{},n=e[gy]||e,i=e[k0]||{};for(const a in r){const s=r[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,s),r[a]=this.getAsyncProp(a)}for(const a in n){const s=n[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,s)}}_fetch(e,r){return null}_onResolve(e,r){}_onError(e,r){}_updateAsyncProp(e,r){if(this._didAsyncInputValueChange(e,r)){if(typeof r=="string"&&(r=this._fetch(e,r)),r instanceof Promise){this._watchPromise(e,r);return}if(Bne(r)){this._resolveAsyncIterable(e,r);return}this._setPropValue(e,r)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,r){const n=this.asyncProps[e];return r===n.resolvedValue||r===n.lastValue?!1:(n.lastValue=r,!0)}_setPropValue(e,r){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(r=this._postProcessValue(n,r),n.resolvedValue=r,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,r,n){const i=this.asyncProps[e];i&&n>=i.resolvedLoadCount&&r!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=r,i.resolvedLoadCount=n,this.onAsyncPropUpdated(e,r))}_watchPromise(e,r){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;r.then(a=>{this.component&&(a=this._postProcessValue(n,a),this._setAsyncPropValue(e,a,i),this._onResolve(e,a))}).catch(a=>{this._onError(e,a)})}}async _resolveAsyncIterable(e,r){if(e!=="data"){this._setPropValue(e,r);return}const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let a=[],s=0;for await(const o of r){if(!this.component)return;const{dataTransform:c}=this.component.props;c?a=c(o,a):a=a.concat(o),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:s,endRow:a.length}]}),s=a.length,this._setAsyncPropValue(e,a,i)}this._onResolve(e,a)}_postProcessValue(e,r){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(r,n,this.component):r}_createAsyncPropData(e,r){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Sg];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:r,pendingLoadCount:0,resolvedLoadCount:0}}}}class dWe extends hWe{constructor({attributeManager:e,layer:r}){super(r),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,r){const n=this.layer,i=n?.props.fetch;return i?i(r,{propName:e,layer:n}):super._fetch(e,r)}_onResolve(e,r){const n=this.layer;if(n){const i=n.props.onDataLoad;e==="data"&&i&&i(r,{propName:e,layer:n})}}_onError(e,r){const n=this.layer;n&&n.raiseError(r,`loading ${e} of ${this.layer}`)}}const pWe="layer.changeFlag",gWe="layer.initialize",mWe="layer.update",yWe="layer.finalize",vWe="layer.matched",IW=2**24-1,_We=Object.freeze([]),bWe=n2(({oldViewport:t,viewport:e})=>t.equals(e));let ph=new Uint8ClampedArray(0);const xWe={data:{type:"data",value:_We,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:r,loaders:n,loadOptions:i,signal:a})=>{const{resourceManager:s}=r.context;i=i||r.getLoadOptions(),n=n||r.props.loaders,a&&(i={...i,fetch:{...i?.fetch,signal:a}});let o=s.contains(t);return!o&&!i&&(s.add({resourceId:t,data:WR(t,n),persistent:!1}),o=!0),o?s.subscribe({resourceId:t,onChange:c=>r.internalState?.reloadAsyncProp(e,c),consumerId:r.id,requestId:e}):WR(t,n,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Xa.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class tC extends eC{constructor(){super(...arguments),this.internalState=null,this.lifecycle=e0.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){Fl(this.internalState);const r=this.internalState.viewport||this.context.viewport,n=fne(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,a,s]=sne(n,r.pixelProjectionMatrix);return e.length===2?[i,a]:[i,a,s]}unproject(e){return Fl(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,r){Fl(this.internalState);const n=this.internalState.viewport||this.context.viewport;return JVe(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...r})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const r of this.getModels())r.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Xa.DEFAULT||e===Xa.LNGLAT||e===Xa.CARTESIAN}onHover(e,r){return this.props.onHover&&this.props.onHover(e,r)||!1}onClick(e,r){return this.props.onClick&&this.props.onClick(e,r)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,r=[]){return r[0]=e+1&255,r[1]=e+1>>8&255,r[2]=e+1>>8>>8&255,r}decodePickingColor(e){Fl(e instanceof Uint8Array);const[r,n,i]=e;return r+n*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:WGe(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=AW(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const r of this.props.extensions)e=AW(e,r.getShaders.call(this,r));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const r=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&r)if(Array.isArray(n))for(const i of n)r.invalidateAll(i);else r.invalidateAll();if(r){const{props:i}=e,a=this.internalState.hasPickingBuffer,s=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(a!==s){this.internalState.hasPickingBuffer=s;const{pickingColors:o,instancePickingColors:c}=r.attributes,f=o||c;f&&(s&&f.constant&&(f.constant=!1,r.invalidate(f.id)),!f.value&&!s&&(f.constant=!0,f.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.destroy();const r=this.getAttributeManager();r&&r.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const r of this.getModels())r.draw(e.renderPass)}getPickingInfo({info:e,mode:r,sourceLayer:n}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,r){r&&(e=new Error(`${r}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const r=this.internalState.viewport;this.internalState.viewport=e,(!r||!bWe({oldViewport:r,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const r=this.getAttributeManager();r&&(e==="all"?r.invalidateAll():r.invalidate(e))}updateAttributes(e){let r=!1;for(const n in e)e[n].layoutChanged()&&(r=!0);for(const n of this.getModels())this._setModelAttributes(n,e,r)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const r=this.props,n=this.getNumInstances(),i=this.getStartIndices();e.update({data:r.data,numInstances:n,startIndices:i,props:r,transitions:r.transitions,buffers:r.data.attributes,context:this});const a=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(a)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const r=e.update(),n=Object.create(this.props);for(const i in r)Object.defineProperty(n,i,{value:r[i]});return n}return this.props}calculateInstancePickingColors(e,{numInstances:r}){if(e.constant)return;const n=Math.floor(ph.length/4);if(this.internalState.usesPickingColorCache=!0,n<r){r>IW&&oo.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),ph=gx.allocate(ph,r,{size:4,copy:!0,maxCount:Math.max(r,IW)});const i=Math.floor(ph.length/4),a=[0,0,0];for(let s=n;s<i;s++)this.encodePickingColor(s,a),ph[s*4+0]=a[0],ph[s*4+1]=a[1],ph[s*4+2]=a[2],ph[s*4+3]=0}e.value=ph.subarray(0,r*4)}_setModelAttributes(e,r,n=!1){if(!Object.keys(r).length)return;if(n){const o=this.getAttributeManager();e.setBufferLayout(o.getBufferLayouts(e)),r=o.getAttributes()}const i=e.userData?.excludeAttributes||{},a={},s={};for(const o in r){if(i[o])continue;const c=r[o].getValue();for(const f in c){const d=c[f];d instanceof jo?r[o].settings.isIndexed?e.setIndexBuffer(d):a[f]=d:d&&(s[f]=d)}}e.setAttributes(a),e.setConstantAttributes(s)}disablePickingIndex(e){const r=this.props.data;if(!("attributes"in r)){this._disablePickingIndex(e);return}const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,a=n||i,s=a&&r.attributes&&r.attributes[a.id];if(s&&s.value){const o=s.value,c=this.encodePickingColor(e);for(let f=0;f<r.length;f++){const d=a.getVertexOffset(f);o[d]===c[0]&&o[d+1]===c[1]&&o[d+2]===c[2]&&this._disablePickingIndex(f)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:r,instancePickingColors:n}=this.getAttributeManager().attributes,i=r||n;if(!i)return;const a=i.getVertexOffset(e),s=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(s-a),a)}restorePickingColors(){const{pickingColors:e,instancePickingColors:r}=this.getAttributeManager().attributes,n=e||r;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==ph.buffer&&(n.value=ph.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){Fl(!this.internalState),Fl(Number.isFinite(this.props.coordinateSystem)),Qu(gWe,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new dWe({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(oo.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new BGe(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const r of this.props.extensions)r.initializeState.call(this,this.context,r);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Qu(vWe,this,this===e);const{state:r,internalState:n}=e;this!==e&&(this.internalState=n,this.state=r,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Qu(mWe,this,e),!e)return;const r=this.props,n=this.context,i=this.internalState,a=n.viewport,s=this._updateUniformTransition();i.propsInTransition=s,n.viewport=i.viewport||a,this.props=s;try{const o=this._getUpdateParams(),c=this.getModels();if(n.device)this.updateState(o);else try{this.updateState(o)}catch{}for(const d of this.props.extensions)d.updateState.call(this,o,d);this.setNeedsRedraw(),this._updateAttributes();const f=this.getModels()[0]!==c[0];this._postUpdate(o,f)}finally{n.viewport=a,this.props=r,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Qu(yWe,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:r=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const a=this.props,s=this.context;this.props=this.internalState.propsInTransition||a;try{r&&this.setShaderModuleProps(r);const{getPolygonOffset:o}=this.props,c=o&&o(n)||[0,0];s.device instanceof y0&&s.device.setParametersWebGL({polygonOffset:c});for(const f of this.getModels())f.device.type==="webgpu"?f.setParameters({...f.parameters,...i}):f.setParameters(i);if(s.device instanceof y0)s.device.withParametersWebGL(i,()=>{const f={renderPass:e,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(const d of this.props.extensions)d.draw.call(this,f,d);this.draw(f)});else{const f={renderPass:e,shaderModuleProps:r,uniforms:n,parameters:i,context:s};for(const d of this.props.extensions)d.draw.call(this,f,d);this.draw(f)}}finally{this.props=a}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:r}=this.internalState;for(const i in e)if(e[i]){let a=!1;switch(i){case"dataChanged":const s=e[i],o=r[i];s&&Array.isArray(o)&&(r.dataChanged=Array.isArray(s)?o.concat(s):s,a=!0);default:r[i]||(r[i]=e[i],a=!0)}a&&Qu(pWe,this,i,e)}const n=!!(r.dataChanged||r.updateTriggersChanged||r.propsChanged||r.extensionsChanged);r.propsOrDataChanged=n,r.somethingChanged=n||r.viewportChanged||r.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,r){const n=jGe(e,r);if(n.updateTriggersChanged)for(const i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(const i in n.transitionsChanged)this.internalState.uniformTransitions.add(i,r[i],e[i],e.transitions?.[i]);return this.setChangeFlags(n)}validateProps(){zGe(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const r={highlightedObjectColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&typeof n=="function"&&(r.highlightColor=n(e)),this.setShaderModuleProps({picking:r}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Xne(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,r){const{props:n,oldProps:i}=e,a=this.state.model;a?.isInstanced&&a.setInstanceCount(this.getNumInstances());const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:c}=n;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==c){const f={};Array.isArray(c)&&(f.highlightColor=c),(r||i.autoHighlight!==s||o!==i.highlightedObjectIndex)&&(f.highlightedObjectColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setShaderModuleProps({picking:f})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let r=!1;r=r||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=n?n.getNeedsRedraw(e):!1;if(r=r||i,r)for(const a of this.props.extensions)a.onNeedsRedraw.call(this,a);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,r}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}tC.defaultProps=xWe;tC.layerName="Layer";const wWe="compositeLayer.renderLayers";class Kne extends tC{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:r}=e;return r&&r.__source&&r.__source.parent&&r.__source.parent.id===this.id&&(e.object=r.__source.object,e.index=r.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,r){return r&&r.length}getSubLayerClass(e,r){const{_subLayerProps:n}=this.props;return n&&n[e]&&n[e].type||r}getSubLayerRow(e,r,n){return e.__source={parent:this,object:r,index:n},e}getSubLayerAccessor(e){if(typeof e=="function"){const r={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(r.index=n.__source.index,e(n.__source.object,r)):e(n,i)}return e}getSubLayerProps(e={}){const{opacity:r,pickable:n,visible:i,parameters:a,getPolygonOffset:s,highlightedObjectIndex:o,autoHighlight:c,highlightColor:f,coordinateSystem:d,coordinateOrigin:m,wrapLongitude:b,positionFormat:x,modelMatrix:E,extensions:T,fetch:A,operation:R,_subLayerProps:F}=this.props,N={id:"",updateTriggers:{},opacity:r,pickable:n,visible:i,parameters:a,getPolygonOffset:s,highlightedObjectIndex:o,autoHighlight:c,highlightColor:f,coordinateSystem:d,coordinateOrigin:m,wrapLongitude:b,positionFormat:x,modelMatrix:E,extensions:T,fetch:A,operation:R},O=F&&e.id&&F[e.id],U=O&&O.updateTriggers,j=e.id||"sublayer";if(O){const H=this.props[Sg],W=e.type?e.type._propTypes:{};for(const X in O){const oe=W[X]||H[X];oe&&oe.type==="accessor"&&(O[X]=this.getSubLayerAccessor(O[X]))}}Object.assign(N,e,O),N.id=`${this.props.id}-${j}`,N.updateTriggers={all:this.props.updateTriggers?.all,...e.updateTriggers,...U};for(const H of T){const W=H.getSubLayerProps.call(this,H);W&&Object.assign(N,W,{updateTriggers:Object.assign(N.updateTriggers,W.updateTriggers)})}return N}_updateAutoHighlight(e){for(const r of this.getSubLayers())r.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,r){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){const a=this.renderLayers();n=s_(a,Boolean),this.internalState.subLayers=n}Qu(wWe,this,i,n);for(const a of n)a.parent=this}}Kne.layerName="CompositeLayer";const Jw=Math.PI/180,PW=180/Math.PI,DS=6370972,v0=256;function SWe(){const t=v0/DS,e=Math.PI/180*v0;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class EWe extends Ry{constructor(e={}){const{longitude:r=0,zoom:n=0,nearZMultiplier:i=.5,farZMultiplier:a=1,resolution:s=10}=e;let{latitude:o=0,height:c,altitude:f=1.5,fovy:d}=e;o=Math.max(Math.min(o,gg),-gg),c=c||1,d?f=i6(d):d=px(f);const m=1/Math.PI/Math.cos(o*Math.PI/180),b=Math.pow(2,n)*m,x=e.nearZ??i,E=e.farZ??(f+v0*2*b/c)*a,T=new Mh().lookAt({eye:[0,-f,0],up:[0,0,1]});T.rotateX(o*Jw),T.rotateZ(-r*Jw),T.scale(b/c),super({...e,height:c,viewMatrix:T,longitude:r,latitude:o,zoom:n,distanceScales:SWe(),fovy:d,focalDistance:f,near:x,far:E}),this.scale=b,this.latitude=o,this.longitude=r,this.resolution=s}get projectionMode(){return sf.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const r={targetZ:e.z||0},n=this.unproject([0,this.height/2],r),i=this.unproject([this.width/2,0],r),a=this.unproject([this.width,this.height/2],r),s=this.unproject([this.width/2,this.height],r);return a[0]<this.longitude&&(a[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],a[0],i[0],s[0]),Math.min(n[1],a[1],i[1],s[1]),Math.max(n[0],a[0],i[0],s[0]),Math.max(n[1],a[1],i[1],s[1])]}unproject(e,{topLeft:r=!0,targetZ:n}={}){const[i,a,s]=e,o=r?a:this.height-a,{pixelUnprojectionMatrix:c}=this;let f;if(Number.isFinite(s))f=dM(c,[i,o,s,1]);else{const x=dM(c,[i,o,-1,1]),E=dM(c,[i,o,1,1]),T=((n||0)/DS+1)*v0,A=YP(Nre([],x,E)),R=YP(x),F=YP(E),O=4*((4*R*F-(A-R-F)**2)/16)/A,U=Math.sqrt(R-O),j=Math.sqrt(Math.max(0,T*T-O)),H=(U-j)/Math.sqrt(A);f=Gje([],x,E,H)}const[d,m,b]=this.unprojectPosition(f);return Number.isFinite(s)?[d,m,b]:Number.isFinite(n)?[d,m,n]:[d,m]}projectPosition(e){const[r,n,i=0]=e,a=r*Jw,s=n*Jw,o=Math.cos(s),c=(i/DS+1)*v0;return[Math.sin(a)*o*c,-Math.cos(a)*o*c,Math.sin(s)*c]}unprojectPosition(e){const[r,n,i]=e,a=Qje(e),s=Math.asin(i/a),c=Math.atan2(r,-n)*PW,f=s*PW,d=(a/v0-1)*DS;return[c,f,d]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,r){const n=this.unproject(r);return{longitude:e[0]-n[0]+this.longitude,latitude:e[1]-n[1]+this.latitude}}}function dM(t,e){const r=I_([],e,t);return zre(r,r,1/r[3]),r}class TWe extends bne{applyConstraints(e){const{maxZoom:r,minZoom:n,zoom:i}=e;e.zoom=pd(i,n,r);const{longitude:a,latitude:s}=e;return(a<-180||a>180)&&(e.longitude=VVe(a+180,360)-180),e.latitude=pd(s,-gg,gg),e}}class CWe extends _ne{constructor(){super(...arguments),this.ControllerState=TWe,this.transition={transitionDuration:300,transitionInterpolator:new u6(["longitude","latitude","zoom"])},this.dragMode="pan"}setProps(e){super.setProps(e),this.dragRotate=!1,this.touchRotate=!1}}class Jne extends vne{constructor(e={}){super(e)}getViewportType(e){return e.zoom>12?hy:EWe}get ControllerType(){return CWe}}Jne.displayName="GlobeView";const pM=512,AWe=Math.PI/180;function Qne({map:t,gl:e,deck:r}){if(t.__deck)return t.__deck;const n=r?.props._customRender,i=r?.props.onLoad,a={...r?.props,_customRender:()=>{t.triggerRepaint(),n?.("")}};a.parameters={...ED(t,!0),...a.parameters},a.views||(a.views=bT(t));let s;return(!r||r.props.gl===e)&&(Object.assign(a,{gl:e,width:null,height:null,touchAction:"unset",viewState:yx(t)}),r?.isInitialized?MW(r,t):a.onLoad=()=>{i?.(),MW(s,t)}),r?(s=r,r.setProps(a),r.userData.isExternal=!0):(s=new mx(a),t.on("remove",()=>{eie(t)})),s.userData.mapboxLayers=new Set,t.__deck=s,t.on("render",()=>{s.isInitialized&&DWe(s,t)}),s}function MW(t,e){const r=()=>{t.isInitialized?OWe(t,e):e.off("move",r)};e.on("move",r)}function eie(t){t.__deck?.finalize(),t.__deck=null}function ED(t,e){const r=e?{depthWriteEnabled:!0,depthCompare:"less-equal",depthBias:0,blend:!0,blendColorSrcFactor:"src-alpha",blendColorDstFactor:"one-minus-src-alpha",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one-minus-src-alpha",blendColorOperation:"add",blendAlphaOperation:"add"}:{};return tie(t)==="globe"&&(r.cullMode="back"),r}function IWe(t,e){t.userData.mapboxLayers.add(e),y6(t)}function PWe(t,e){t.userData.mapboxLayers.delete(e),y6(t)}function MWe(t,e){y6(t)}function kWe(t,e,r,n){let{currentViewport:i}=t.userData,a=!1;i||(i=rie(t,e,n),t.userData.currentViewport=i,a=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[i],layerFilter:s=>(!t.props.layerFilter||t.props.layerFilter(s))&&(r.id===s.layer.id||s.layer.props.operation.includes("terrain")),clearStack:a,clearCanvas:!1})}function tie(t){const e=t.getProjection?.(),r=e?.type||e?.name;if(r==="globe")return"globe";if(r&&r!=="mercator")throw new Error("Unsupported projection");return"mercator"}function bT(t){return tie(t)==="globe"?new Jne({id:"mapbox"}):new c6({id:"mapbox"})}function yx(t){const{lng:e,lat:r}=t.getCenter(),n={longitude:(e+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return t.getTerrain?.()&&RWe(t,n),n}function RWe(t,e){if(t.getFreeCameraOptions){const{position:r}=t.getFreeCameraOptions();if(!r||r.z===void 0)return;const n=t.transform.height,{longitude:i,latitude:a,pitch:s}=e,o=r.x*pM,c=(1-r.y)*pM,f=r.z*pM,d=dx([i,a]),m=o-d[0],b=c-d[1],x=Math.sqrt(m*m+b*b),E=s*AWe,T=1.5*n,A=E<.001?T*Math.cos(E)/f:T*Math.sin(E)/x;e.zoom=Math.log2(A);const R=T*Math.cos(E)/A,F=f-R;e.position=[0,0,F/kS(a)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function rie(t,e,r){const n=yx(e),i=bT(e);r&&(i.props.nearZMultiplier=.2);const a=r?.nearZ??e.transform._nearZ,s=r?.farZ??e.transform._farZ;return Number.isFinite(a)&&(n.nearZ=a/e.transform.height,n.farZ=s/e.transform.height),i.makeViewport({width:t.width,height:t.height,viewState:n})}function DWe(t,e){const{mapboxLayers:r,isExternal:n}=t.userData;if(n){const i=Array.from(r,d=>d.id),s=s_(t.props.layers,Boolean).some(d=>d&&!i.includes(d.id));let o=t.getViewports();const c=o.findIndex(d=>d.id==="mapbox"),f=o.length>1||c<0;(s||f)&&(c>=0&&(o=o.slice(),o[c]=rie(t,e)),t._drawLayers("mapbox-repaint",{viewports:o,layerFilter:d=>(!t.props.layerFilter||t.props.layerFilter(d))&&(d.viewport.id!=="mapbox"||!i.includes(d.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function OWe(t,e){t.setProps({viewState:yx(e)}),t.needsRedraw({clearRedrawFlags:!0})}function y6(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(r=>{const n=r.props.type,i=new n(r.props);e.push(i)}),t.setProps({layers:e})}class LWe{constructor(e){if(!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.slot=e.slot,this.map=null,this.deck=null,this.props=e}onAdd(e,r){this.map=e,this.deck=Qne({map:e,gl:r,deck:this.props.deck}),IWe(this.deck,this)}onRemove(){this.deck&&PWe(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&MWe(this.deck)}render(e,r){kWe(this.deck,this.map,this,r)}}const gM="__UNDEFINED__";function Qw(t,e,r,n){if(!t||!e||!t.style||!t.style._loaded)return;const i=s_(n,Boolean);if(r!==n){const o=s_(r,Boolean),c=new Set(o.map(f=>f.id));for(const f of i)c.delete(f.id);for(const f of c)t.getLayer(f)&&t.removeLayer(f)}for(const o of i){const c=t.getLayer(o.id);c?(c.implementation||c).setProps(o.props):t.addLayer(new LWe({id:o.id,deck:e,slot:o.props.slot}),o.props.beforeId)}const a=t.style._order,s={};for(const o of i){let{beforeId:c}=o.props;(!c||!a.includes(c))&&(c=gM),s[c]=s[c]||[],s[c].push(o.id)}for(const o in s){const c=s[o];let f=o===gM?a.length:a.indexOf(o),d=o===gM?void 0:o;for(let m=c.length-1;m>=0;m--){const b=c[m],x=a.indexOf(b);x!==f-1&&(t.moveLayer(b,d),x>f&&f++),f--,d=b}}}class NWe{constructor(e){this._handleStyleChange=()=>{Qw(this._map,this._deck,this._props.layers,this._props.layers)},this._updateContainerSize=()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:a}=this._map.getContainer();Object.assign(this._container.style,{width:`${i}px`,height:`${a}px`})}},this._updateViewState=()=>{const i=this._deck,a=this._map;i&&a&&(i.setProps({views:this._props.views||bT(a),viewState:yx(a)}),i.isInitialized&&i.redraw())},this._handleMouseEvent=i=>{const a=this._deck;if(!a||!a.isInitialized)return;const s={type:i.type,offsetCenter:i.point,srcEvent:i},o=this._lastMouseDownPoint;switch(!i.point&&o&&(s.deltaX=i.originalEvent.clientX-o.clientX,s.deltaY=i.originalEvent.clientY-o.clientY,s.offsetCenter={x:o.x+s.deltaX,y:o.y+s.deltaY}),s.type){case"mousedown":a._onPointerDown(s),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":s.type="panstart",a._onEvent(s);break;case"drag":s.type="panmove",a._onEvent(s);break;case"dragend":s.type="panend",a._onEvent(s);break;case"click":s.tapCount=1,a._onEvent(s);break;case"dblclick":s.type="click",s.tapCount=2,a._onEvent(s);break;case"mousemove":s.type="pointermove",a._onPointerMove(s);break;case"mouseout":s.type="pointerleave",a._onPointerMove(s);break;default:return}};const{interleaved:r=!1,...n}=e;this._interleaved=r,this._props=n}setProps(e){this._interleaved&&e.layers&&Qw(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._map&&this._deck.setProps({...this._props,parameters:{...ED(this._map,this._interleaved),...this._props.parameters}})}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const r=document.createElement("div");return Object.assign(r.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=r,this._deck=new mx({...this._props,parent:r,parameters:{...ED(e,!1),...this._props.parameters},views:this._props.views||bT(e),viewState:yx(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),r}_onAddInterleaved(e){const r=e.painter.context.gl;return r instanceof WebGLRenderingContext&&oo.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=Qne({map:e,gl:r,deck:new mx({...this._props,gl:r})}),e.on("styledata",this._handleStyleChange),Qw(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),this._deck?.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),Qw(e,this._deck,this._props.layers,[]),eie(e)}getDefaultPosition(){return"top-left"}pickObject(e){return Fl(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return Fl(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return Fl(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const FWe="deckgl-layer",nie=gt.createContext({}),TD=({mapId:t,children:e})=>{const r=ga({mapId:t}),n=te.useRef(void 0),[i,a]=te.useState([]);te.useEffect(()=>{if(r.map)return n.current=new NWe({id:FWe}),r.map.addControl(n.current),()=>{n.current&&r.map?.removeControl(n.current),n.current=void 0}},[r.map]),te.useEffect(()=>{n.current&&n.current.setProps({layers:[...i]})},[i]);const s={deckGlLayerArray:i,setDeckGlLayerArray:a};return J.jsx(nie.Provider,{value:s,children:e})};try{TD.displayName="DeckGlContextProvider",TD.__docgenInfo={description:"",displayName:"DeckGlContextProvider",props:{mapId:{defaultValue:null,description:"",name:"mapId",required:!0,type:{name:"string"}}}}}catch{}function BWe(){const t=te.useContext(nie),e=t.deckGlLayerArray;function r(i){const a=[...e];a.push(i),t.setDeckGlLayerArray(a)}function n(i){const a=e.filter(s=>s!==i);t.setDeckGlLayerArray(a)}return{addLayer:r,removeLayer:n,layerArray:e}}function zWe({pointCount:t,getBinId:e}){const r=new Map;for(let n=0;n<t;n++){const i=e(n);if(i===null)continue;let a=r.get(String(i));a?a.points.push(n):(a={id:i,index:r.size,points:[n]},r.set(String(i),a))}return Array.from(r.values())}function jWe({bins:t,dimensions:e,target:r}){const n=t.length*e;(!r||r.length<n)&&(r=new Float32Array(n));for(let i=0;i<t.length;i++){const{id:a}=t[i];Array.isArray(a)?r.set(a,i*e):r[i]=a}return r}const UWe=t=>t.length,iie=(t,e)=>{let r=0;for(const n of t)r+=e(n);return r},VWe=(t,e)=>t.length===0?NaN:iie(t,e)/t.length,$We=(t,e)=>{let r=1/0;for(const n of t){const i=e(n);i<r&&(r=i)}return r},qWe=(t,e)=>{let r=-1/0;for(const n of t){const i=e(n);i>r&&(r=i)}return r},HWe={COUNT:UWe,SUM:iie,MEAN:VWe,MIN:$We,MAX:qWe};function GWe({bins:t,getValue:e,operation:r,target:n}){(!n||n.length<t.length)&&(n=new Float32Array(t.length));let i=1/0,a=-1/0;for(let s=0;s<t.length;s++){const{points:o}=t[s];n[s]=r(o,e),n[s]<i&&(i=n[s]),n[s]>a&&(a=n[s])}return{value:n,domain:[i,a]}}function kW(t,e,r){const n={};for(const a of t.sources||[]){const s=e[a];if(s)n[a]=WWe(s);else throw new Error(`Cannot find attribute ${a}`)}const i={};return a=>{for(const s in n)i[s]=n[s](a);return t.getValue(i,a,r)}}function WWe(t){const e=t.value,{offset:r=0,stride:n,size:i}=t.getAccessor(),a=e.BYTES_PER_ELEMENT,s=r/a,o=n?n/a:i;if(i===1)return t.isConstant?()=>e[0]:f=>{const d=s+o*f;return e[d]};let c;return t.isConstant?(c=Array.from(e),()=>c):(c=new Array(i),f=>{const d=s+o*f;for(let m=0;m<i;m++)c[m]=e[d+m];return c})}class XWe{constructor(e){this.bins=[],this.binIds=null,this.results=[],this.dimensions=e.dimensions,this.channelCount=e.getValue.length,this.props={...e,binOptions:{},pointCount:0,operations:[],customOperations:[],attributes:{}},this.needsUpdate=!0,this.setProps(e)}destroy(){}get binCount(){return this.bins.length}setProps(e){const r=this.props;if(e.binOptions&&(Mc(e.binOptions,r.binOptions,2)||this.setNeedsUpdate()),e.operations)for(let n=0;n<this.channelCount;n++)e.operations[n]!==r.operations[n]&&this.setNeedsUpdate(n);if(e.customOperations)for(let n=0;n<this.channelCount;n++)!!e.customOperations[n]!=!!r.customOperations[n]&&this.setNeedsUpdate(n);e.pointCount!==void 0&&e.pointCount!==r.pointCount&&this.setNeedsUpdate(),e.attributes&&(e.attributes={...r.attributes,...e.attributes}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate=!0:this.needsUpdate!==!0&&(this.needsUpdate=this.needsUpdate||[],this.needsUpdate[e]=!0)}update(){if(this.needsUpdate===!0){this.bins=zWe({pointCount:this.props.pointCount,getBinId:kW(this.props.getBin,this.props.attributes,this.props.binOptions)});const e=jWe({bins:this.bins,dimensions:this.dimensions,target:this.binIds?.value});this.binIds={value:e,type:"float32",size:this.dimensions}}for(let e=0;e<this.channelCount;e++)if(this.needsUpdate===!0||this.needsUpdate[e]){const r=this.props.customOperations[e]||HWe[this.props.operations[e]],{value:n,domain:i}=GWe({bins:this.bins,getValue:kW(this.props.getValue[e],this.props.attributes,void 0),operation:r,target:this.results[e]?.value});this.results[e]={value:n,domain:i,type:"float32",size:1},this.props.onUpdate?.({channel:e})}this.needsUpdate=!1}preDraw(){}getBins(){return this.binIds}getResult(e){return this.results[e]}getResultDomain(e){return this.results[e]?.domain??[1/0,-1/0]}getBin(e){const r=this.bins[e];if(!r)return null;const n=new Array(this.channelCount);for(let i=0;i<n.length;i++){const a=this.results[i];n[i]=a?.value[e]}return{id:r.id,value:n,count:r.points.length,pointIndices:r.points}}}function aie(t,e,r){return t.createFramebuffer({width:e,height:r,colorAttachments:[t.createTexture({width:e,height:r,format:"rgba32float",mipmaps:!1,sampler:{minFilter:"nearest",magFilter:"nearest"}})]})}const YWe=`uniform binSorterUniforms {
  ivec4 binIdRange;
  ivec2 targetSize;
} binSorter;
`,ZWe={name:"binSorter",vs:YWe,uniformTypes:{binIdRange:"vec4<i32>",targetSize:"vec2<i32>"}},oie=[1,2,4,8],RW=3e38,KWe={SUM:0,MEAN:0,MIN:0,MAX:0,COUNT:0},OS=1024;class JWe{constructor(e,r){this.binsFBO=null,this.device=e,this.model=eXe(e,r)}get texture(){return this.binsFBO?this.binsFBO.colorAttachments[0].texture:null}destroy(){this.model.destroy(),this.binsFBO?.colorAttachments[0].texture.destroy(),this.binsFBO?.destroy()}getBinValues(e){if(!this.binsFBO)return null;const r=e%OS,n=Math.floor(e/OS),i=this.device.readPixelsToArrayWebGL(this.binsFBO,{sourceX:r,sourceY:n,sourceWidth:1,sourceHeight:1}).buffer;return new Float32Array(i)}setDimensions(e,r){const n=OS,i=Math.ceil(e/n);this.binsFBO?this.binsFBO.height<i&&this.binsFBO.resize({width:n,height:i}):this.binsFBO=aie(this.device,n,i);const a={binIdRange:[r[0][0],r[0][1],r[1]?.[0]||0,r[1]?.[1]||0],targetSize:[this.binsFBO.width,this.binsFBO.height]};this.model.shaderInputs.setProps({binSorter:a})}setModelProps(e){const r=this.model;e.attributes&&r.setAttributes(e.attributes),e.constantAttributes&&r.setConstantAttributes(e.constantAttributes),e.vertexCount!==void 0&&r.setVertexCount(e.vertexCount),e.shaderModuleProps&&r.shaderInputs.setProps(e.shaderModuleProps)}update(e){if(!this.binsFBO)return;const r=QWe(e);this._updateBins("SUM",r.SUM+r.MEAN),this._updateBins("MIN",r.MIN),this._updateBins("MAX",r.MAX)}_updateBins(e,r){if(r===0)return;r|=oie[3];const n=this.model,i=this.binsFBO,a=e==="MAX"?-RW:e==="MIN"?RW:0,s=this.device.beginRenderPass({id:`gpu-aggregation-${e}`,framebuffer:i,parameters:{viewport:[0,0,i.width,i.height],colorMask:r},clearColor:[a,a,a,0],clearDepth:!1,clearStencil:!1});n.setParameters({blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendColorOperation:e==="MAX"?"max":e==="MIN"?"min":"add",blendAlphaOperation:"add"}),n.draw(s),s.end()}}function QWe(t){const e={...KWe};for(let r=0;r<t.length;r++){const n=t[r];n&&(e[n]+=oie[r])}return e}function eXe(t,e){let r=e.vs;e.dimensions===2&&(r+=`
void getBin(out int binId) {
  ivec2 binId2;
  getBin(binId2);
  if (binId2.x < binSorter.binIdRange.x || binId2.x >= binSorter.binIdRange.y) {
    binId = -1;
  } else {
    binId = (binId2.y - binSorter.binIdRange.z) * (binSorter.binIdRange.y - binSorter.binIdRange.x) + binId2.x;
  }
}
`);const n=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-vertex

${r}

out vec3 v_Value;

void main() {
  int binIndex;
  getBin(binIndex);
  binIndex = binIndex - binSorter.binIdRange.x;
  if (binIndex < 0) {
    gl_Position = vec4(0.);
    return;
  }
  int row = binIndex / binSorter.targetSize.x;
  int col = binIndex - row * binSorter.targetSize.x;
  vec2 position = (vec2(col, row) + 0.5) / vec2(binSorter.targetSize) * 2.0 - 1.0;
  gl_Position = vec4(position, 0.0, 1.0);
  gl_PointSize = 1.0;

#if NUM_CHANNELS == 3
  getValue(v_Value);
#elif NUM_CHANNELS == 2
  getValue(v_Value.xy);
#else
  getValue(v_Value.x);
#endif
}
`,i=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-fragment

precision highp float;

in vec3 v_Value;
out vec4 fragColor;

void main() {
  fragColor.xyz = v_Value;

  #ifdef MODULE_GEOMETRY
  geometry.uv = vec2(0.);
  DECKGL_FILTER_COLOR(fragColor, geometry);
  #endif

  fragColor.w = 1.0;
}
`;return new dy(t,{bufferLayout:e.bufferLayout,modules:[...e.modules||[],ZWe],defines:{...e.defines,NON_INSTANCED_MODEL:1,NUM_CHANNELS:e.channelCount},isInstanced:!1,vs:n,fs:i,topology:"point-list",disableWarnings:!0})}const tXe=`uniform aggregatorTransformUniforms {
  ivec4 binIdRange;
  bvec3 isCount;
  bvec3 isMean;
  float naN;
} aggregatorTransform;
`,rXe={name:"aggregatorTransform",vs:tXe,uniformTypes:{binIdRange:"vec4<i32>",isCount:"vec3<f32>",isMean:"vec3<f32>"}};class nXe{constructor(e,r){this.binBuffer=null,this.valueBuffer=null,this._domains=null,this.device=e,this.channelCount=r.channelCount,this.transform=iXe(e,r),this.domainFBO=aie(e,2,1)}destroy(){this.transform.destroy(),this.binBuffer?.destroy(),this.valueBuffer?.destroy(),this.domainFBO.colorAttachments[0].texture.destroy(),this.domainFBO.destroy()}get domains(){if(!this._domains){const e=this.device.readPixelsToArrayWebGL(this.domainFBO).buffer,r=new Float32Array(e);this._domains=[[-r[4],r[0]],[-r[5],r[1]],[-r[6],r[2]]].slice(0,this.channelCount)}return this._domains}setDimensions(e,r){const{model:n,transformFeedback:i}=this.transform;n.setVertexCount(e);const a={binIdRange:[r[0][0],r[0][1],r[1]?.[0]||0,r[1]?.[1]||0]};n.shaderInputs.setProps({aggregatorTransform:a});const s=e*r.length*4;(!this.binBuffer||this.binBuffer.byteLength<s)&&(this.binBuffer?.destroy(),this.binBuffer=this.device.createBuffer({byteLength:s}),i.setBuffer("binIds",this.binBuffer));const o=e*this.channelCount*4;(!this.valueBuffer||this.valueBuffer.byteLength<o)&&(this.valueBuffer?.destroy(),this.valueBuffer=this.device.createBuffer({byteLength:o}),i.setBuffer("values",this.valueBuffer))}update(e,r){if(!e)return;const n=this.transform,i=this.domainFBO,a=[0,1,2].map(c=>r[c]==="COUNT"?1:0),s=[0,1,2].map(c=>r[c]==="MEAN"?1:0),o={isCount:a,isMean:s,bins:e};n.model.shaderInputs.setProps({aggregatorTransform:o}),n.run({id:"gpu-aggregation-domain",framebuffer:i,parameters:{viewport:[0,0,2,1]},clearColor:[-3e38,-3e38,-3e38,0],clearDepth:!1,clearStencil:!1}),this._domains=null}}function iXe(t,e){const r=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-vertex

uniform sampler2D bins;

#if NUM_DIMS == 1
out float binIds;
#else
out vec2 binIds;
#endif

#if NUM_CHANNELS == 1
flat out float values;
#elif NUM_CHANNELS == 2
flat out vec2 values;
#else
flat out vec3 values;
#endif

const float NAN = intBitsToFloat(-1);

void main() {
  int row = gl_VertexID / SAMPLER_WIDTH;
  int col = gl_VertexID - row * SAMPLER_WIDTH;
  vec4 weights = texelFetch(bins, ivec2(col, row), 0);
  vec3 value3 = mix(
    mix(weights.rgb, vec3(weights.a), aggregatorTransform.isCount),
    weights.rgb / max(weights.a, 1.0),
    aggregatorTransform.isMean
  );
  if (weights.a == 0.0) {
    value3 = vec3(NAN);
  }

#if NUM_DIMS == 1
  binIds = float(gl_VertexID + aggregatorTransform.binIdRange.x);
#else
  int y = gl_VertexID / (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  int x = gl_VertexID - y * (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  binIds.y = float(y + aggregatorTransform.binIdRange.z);
  binIds.x = float(x + aggregatorTransform.binIdRange.x);
#endif

#if NUM_CHANNELS == 3
  values = value3;
#elif NUM_CHANNELS == 2
  values = value3.xy;
#else
  values = value3.x;
#endif

  gl_Position = vec4(0., 0., 0., 1.);
  // This model renders into a 2x1 texture to obtain min and max simultaneously.
  // See comments in fragment shader
  gl_PointSize = 2.0;
}
`,n=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-fragment

precision highp float;

#if NUM_CHANNELS == 1
flat in float values;
#elif NUM_CHANNELS == 2
flat in vec2 values;
#else
flat in vec3 values;
#endif

out vec4 fragColor;

void main() {
  vec3 value3;
#if NUM_CHANNELS == 3
  value3 = values;
#elif NUM_CHANNELS == 2
  value3.xy = values;
#else
  value3.x = values;
#endif
  if (isnan(value3.x)) discard;
  // This shader renders into a 2x1 texture with blending=max
  // The left pixel yields the max value of each channel
  // The right pixel yields the min value of each channel
  if (gl_FragCoord.x < 1.0) {
    fragColor = vec4(value3, 1.0);
  } else {
    fragColor = vec4(-value3, 1.0);
  }
}
`;return new py(t,{vs:r,fs:n,topology:"point-list",modules:[rXe],parameters:{blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendColorOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendAlphaOperation:"max"},defines:{NUM_DIMS:e.dimensions,NUM_CHANNELS:e.channelCount,SAMPLER_WIDTH:OS},varyings:["binIds","values"],disableWarnings:!0})}class DW{static isSupported(e){return e.features.has("float32-renderable-webgl")&&e.features.has("texture-blend-float-webgl")}constructor(e,r){this.binCount=0,this.binIds=null,this.results=[],this.device=e,this.dimensions=r.dimensions,this.channelCount=r.channelCount,this.props={...r,pointCount:0,binIdRange:[[0,0]],operations:[],attributes:{},binOptions:{}},this.needsUpdate=new Array(this.channelCount).fill(!0),this.binSorter=new JWe(e,r),this.aggregationTransform=new nXe(e,r),this.setProps(r)}getBins(){const e=this.aggregationTransform.binBuffer;return e?(this.binIds?.buffer!==e&&(this.binIds={buffer:e,type:"float32",size:this.dimensions}),this.binIds):null}getResult(e){const r=this.aggregationTransform.valueBuffer;return!r||e>=this.channelCount?null:(this.results[e]?.buffer!==r&&(this.results[e]={buffer:r,type:"float32",size:1,stride:this.channelCount*4,offset:e*4}),this.results[e])}getResultDomain(e){return this.aggregationTransform.domains[e]}getBin(e){if(e<0||e>=this.binCount)return null;const{binIdRange:r}=this.props;let n;if(this.dimensions===1)n=[e+r[0][0]];else{const[[o,c],[f]]=r,d=c-o;n=[e%d+o,Math.floor(e/d)+f]}const i=this.binSorter.getBinValues(e);if(!i)return null;const a=i[3],s=[];for(let o=0;o<this.channelCount;o++){const c=this.props.operations[o];c==="COUNT"?s[o]=a:a===0?s[o]=NaN:s[o]=c==="MEAN"?i[o]/a:i[o]}return{id:n,value:s,count:a}}destroy(){this.binSorter.destroy(),this.aggregationTransform.destroy()}setProps(e){const r=this.props;if("binIdRange"in e&&!Mc(e.binIdRange,r.binIdRange,2)){const n=e.binIdRange;if(oo.assert(n.length===this.dimensions),this.dimensions===1){const[[i,a]]=n;this.binCount=a-i}else{const[[i,a],[s,o]]=n;this.binCount=(a-i)*(o-s)}this.binSorter.setDimensions(this.binCount,n),this.aggregationTransform.setDimensions(this.binCount,n),this.setNeedsUpdate()}if(e.operations)for(let n=0;n<this.channelCount;n++)e.operations[n]!==r.operations[n]&&this.setNeedsUpdate(n);if(e.pointCount!==void 0&&e.pointCount!==r.pointCount&&(this.binSorter.setModelProps({vertexCount:e.pointCount}),this.setNeedsUpdate()),e.binOptions&&(Mc(e.binOptions,r.binOptions,2)||this.setNeedsUpdate(),this.binSorter.model.shaderInputs.setProps({binOptions:e.binOptions})),e.attributes){const n={},i={};for(const a of Object.values(e.attributes))for(const[s,o]of Object.entries(a.getValue()))ArrayBuffer.isView(o)?i[s]=o:o&&(n[s]=o);this.binSorter.setModelProps({attributes:n,constantAttributes:i})}e.shaderModuleProps&&this.binSorter.setModelProps({shaderModuleProps:e.shaderModuleProps}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate.fill(!0):this.needsUpdate[e]=!0}update(){}preDraw(){if(!this.needsUpdate.some(Boolean))return;const{operations:e}=this.props,r=this.needsUpdate.map((n,i)=>n?e[i]:null);this.binSorter.update(r),this.aggregationTransform.update(this.binSorter.texture,e);for(let n=0;n<this.channelCount;n++)this.needsUpdate[n]&&(this.needsUpdate[n]=!1,this.props.onUpdate?.({channel:n}))}}class sie extends Kne{get isDrawable(){return!0}initializeState(){this.getAttributeManager().remove(["instancePickingColors"])}updateState(e){super.updateState(e);const r=this.getAggregatorType();if(e.changeFlags.extensionsChanged||this.state.aggregatorType!==r){this.state.aggregator?.destroy();const n=this.createAggregator(r);return n.setProps({attributes:this.getAttributeManager()?.attributes}),this.setState({aggregator:n,aggregatorType:r}),!0}return!1}finalizeState(e){super.finalizeState(e),this.state.aggregator.destroy()}updateAttributes(e){const{aggregator:r}=this.state;r.setProps({attributes:e});for(const n in e)this.onAttributeChange(n);r.update()}draw({shaderModuleProps:e}){const{aggregator:r}=this.state;r.setProps({shaderModuleProps:e}),r.preDraw()}_getAttributeManager(){return new Xne(this.context.device,{id:this.props.id,stats:this.context.stats})}}sie.layerName="AggregationLayer";const aXe=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function oXe(t,e=!1,r=Float32Array){let n;if(Number.isFinite(t[0]))n=new r(t);else{n=new r(t.length*4);let i=0;for(let a=0;a<t.length;a++){const s=t[a];n[i++]=s[0],n[i++]=s[1],n[i++]=s[2],n[i++]=Number.isFinite(s[3])?s[3]:255}}if(e)for(let i=0;i<n.length;i++)n[i]/=255;return n}const xT={linear:"linear",quantile:"nearest",quantize:"nearest",ordinal:"nearest"};function sXe(t,e){t.setSampler({minFilter:xT[e],magFilter:xT[e]})}function lXe(t,e,r="linear"){const n=oXe(e,!1,Uint8Array);return t.createTexture({format:"rgba8unorm",mipmaps:!1,sampler:{minFilter:xT[r],magFilter:xT[r],addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},data:n,width:n.length/4,height:1})}class OW{constructor(e,r){this.props={scaleType:"linear",lowerPercentile:0,upperPercentile:100},this.domain=null,this.cutoff=null,this.input=e,this.inputLength=r,this.attribute=e}getScalePercentile(){if(!this._percentile){const e=LW(this.input,this.inputLength);this._percentile=cXe(e)}return this._percentile}getScaleOrdinal(){if(!this._ordinal){const e=LW(this.input,this.inputLength);this._ordinal=uXe(e)}return this._ordinal}getCutoff({scaleType:e,lowerPercentile:r,upperPercentile:n}){if(e==="quantile")return[r,n-1];if(r>0||n<100){const{domain:i}=this.getScalePercentile();let a=i[Math.floor(r)-1]??-1/0,s=i[Math.floor(n)-1]??1/0;if(e==="ordinal"){const{domain:o}=this.getScaleOrdinal();a=o.findIndex(c=>c>=a),s=o.findIndex(c=>c>s)-1,s===-2&&(s=o.length-1)}return[a,s]}return null}update(e){const r=this.props;if(e.scaleType!==r.scaleType)switch(e.scaleType){case"quantile":{const{attribute:n}=this.getScalePercentile();this.attribute=n,this.domain=[0,99];break}case"ordinal":{const{attribute:n,domain:i}=this.getScaleOrdinal();this.attribute=n,this.domain=[0,i.length-1];break}default:this.attribute=this.input,this.domain=null}return(e.scaleType!==r.scaleType||e.lowerPercentile!==r.lowerPercentile||e.upperPercentile!==r.upperPercentile)&&(this.cutoff=this.getCutoff(e)),this.props=e,this}}function uXe(t){const e=new Set;for(const i of t)Number.isFinite(i)&&e.add(i);const r=Array.from(e).sort(),n=new Map;for(let i=0;i<r.length;i++)n.set(r[i],i);return{attribute:{value:t.map(i=>Number.isFinite(i)?n.get(i):NaN),type:"float32",size:1},domain:r}}function cXe(t,e=100){const r=Array.from(t).filter(Number.isFinite).sort(fXe);let n=0;const i=Math.max(1,e),a=new Array(i-1);for(;++n<i;)a[n-1]=hXe(r,n/i);return{attribute:{value:t.map(s=>Number.isFinite(s)?dXe(a,s):NaN),type:"float32",size:1},domain:a}}function LW(t,e){const r=(t.stride??4)/4,n=(t.offset??0)/4;let i=t.value;if(!i){const s=t.buffer?.readSyncWebGL(0,r*4*e);s&&(i=new Float32Array(s.buffer),t.value=i)}if(r===1)return i.subarray(0,e);const a=new Float32Array(e);for(let s=0;s<e;s++)a[s]=i[s*r+n];return a}function fXe(t,e){return t-e}function hXe(t,e){const r=t.length;if(e<=0||r<2)return t[0];if(e>=1)return t[r-1];const n=(r-1)*e,i=Math.floor(n),a=t[i],s=t[i+1];return a+(s-a)*(n-i)}function dXe(t,e){let r=0,n=t.length;for(;r<n;){const i=r+n>>>1;t[i]>e?n=i:r=i+1}return r}function pXe({dataBounds:t,getBinId:e,padding:r=0}){const n=[t[0],t[1],[t[0][0],t[1][1]],[t[1][0],t[0][1]]].map(c=>e(c)),i=Math.min(...n.map(c=>c[0]))-r,a=Math.min(...n.map(c=>c[1]))-r,s=Math.max(...n.map(c=>c[0]))+r+1,o=Math.max(...n.map(c=>c[1]))+r+1;return[[i,s],[a,o]]}const gXe={COUNTER_CLOCKWISE:-1};function mXe(t,e,r={}){return yXe(t,r)!==e?(_Xe(t,r),!0):!1}function yXe(t,e={}){return Math.sign(vXe(t,e))}const NW={x:0,y:1,z:2};function vXe(t,e={}){const{start:r=0,end:n=t.length,plane:i="xy"}=e,a=e.size||2;let s=0;const o=NW[i[0]],c=NW[i[1]];for(let f=r,d=n-a;f<n;f+=a)s+=(t[f+o]-t[d+o])*(t[f+c]+t[d+c]),d=f;return s/2}function _Xe(t,e){const{start:r=0,end:n=t.length,size:i=2}=e,a=(n-r)/i,s=Math.floor(a/2);for(let o=0;o<s;++o){const c=r+o*i,f=r+(a-1-o)*i;for(let d=0;d<i;++d){const m=t[c+d];t[c+d]=t[f+d],t[f+d]=m}}}class bXe extends b$e{constructor(e){const{indices:r,attributes:n}=xXe(e);super({...e,indices:r,attributes:n})}}function xXe(t){const{radius:e,height:r=1,nradial:n=10}=t;let{vertices:i}=t;i&&(oo.assert(i.length>=n),i=i.flatMap(x=>[x[0],x[1]]),mXe(i,gXe.COUNTER_CLOCKWISE));const a=r>0,s=n+1,o=a?s*3+1:n,c=Math.PI*2/n,f=new Uint16Array(a?n*3*2:0),d=new Float32Array(o*3),m=new Float32Array(o*3);let b=0;if(a){for(let x=0;x<s;x++){const E=x*c,T=x%n,A=Math.sin(E),R=Math.cos(E);for(let F=0;F<2;F++)d[b+0]=i?i[T*2]:R*e,d[b+1]=i?i[T*2+1]:A*e,d[b+2]=(1/2-F)*r,m[b+0]=i?i[T*2]:R,m[b+1]=i?i[T*2+1]:A,b+=3}d[b+0]=d[b-3],d[b+1]=d[b-2],d[b+2]=d[b-1],b+=3}for(let x=a?0:1;x<s;x++){const E=Math.floor(x/2)*Math.sign(.5-x%2),T=E*c,A=(E+n)%n,R=Math.sin(T),F=Math.cos(T);d[b+0]=i?i[A*2]:F*e,d[b+1]=i?i[A*2+1]:R*e,d[b+2]=r/2,m[b+2]=1,b+=3}if(a){let x=0;for(let E=0;E<n;E++)f[x++]=E*2+0,f[x++]=E*2+2,f[x++]=E*2+0,f[x++]=E*2+1,f[x++]=E*2+1,f[x++]=E*2+3}return{indices:f,attributes:{POSITION:{size:3,value:d},NORMAL:{size:3,value:m}}}}const FW=`uniform columnUniforms {
  float radius;
  float angle;
  vec2 offset;
  bool extruded;
  bool stroked;
  bool isStroke;
  float coverage;
  float elevationScale;
  float edgeDistance;
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  highp int radiusUnits;
  highp int widthUnits;
} column;
`,wXe={name:"column",vs:FW,fs:FW,uniformTypes:{radius:"f32",angle:"f32",offset:"vec2<f32>",extruded:"f32",stroked:"f32",isStroke:"f32",coverage:"f32",elevationScale:"f32",edgeDistance:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",radiusUnits:"i32",widthUnits:"i32"}},SXe=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec3 cameraPosition;
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = column.isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(column.angle), sin(column.angle), -sin(column.angle), cos(column.angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (column.extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * column.elevationScale;
} else if (column.stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * column.widthScale, column.widthUnits),
column.widthMinPixels, column.widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(column.edgeDistance * column.coverage * column.radius);
if (column.isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = column.radius * column.coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + column.offset) * dotRadius;
if (column.radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (column.extruded && !column.isStroke) {
#ifdef FLAT_SHADING
cameraPosition = project.cameraPosition;
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * layer.opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * layer.opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,EXe=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec3 cameraPosition;
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (column.extruded && !column.isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, cameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,wT=[0,0,0,255],TXe={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:wT},getLineColor:{type:"accessor",value:wT},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class v6 extends tC{getShaders(){const e={},{flatShading:r}=this.props;return r&&(e.FLAT_SHADING=1),super.getShaders({vs:SXe,fs:EXe,defines:e,modules:[ine,r?Gre:Hre,SVe,wXe]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:wT},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:wT},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:r,oldProps:n,changeFlags:i}=e,a=i.extensionsChanged||r.flatShading!==n.flatShading;a&&(this.state.models?.forEach(o=>o.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());const s=this.getNumInstances();this.state.fillModel.setInstanceCount(s),this.state.wireframeModel.setInstanceCount(s),(a||r.diskResolution!==n.diskResolution||r.vertices!==n.vertices||(r.extruded||r.stroked)!==(n.extruded||n.stroked))&&this._updateGeometry(r)}getGeometry(e,r,n){const i=new bXe({radius:1,height:n?2:0,vertices:r,nradial:e});let a=0;if(r)for(let s=0;s<e;s++){const o=r[s],c=Math.sqrt(o[0]*o[0]+o[1]*o[1]);a+=c/e}else a=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*a}),i}_getModels(){const e=this.getShaders(),r=this.getAttributeManager().getBufferLayouts(),n=new dy(this.context.device,{...e,id:`${this.props.id}-fill`,bufferLayout:r,isInstanced:!0}),i=new dy(this.context.device,{...e,id:`${this.props.id}-wireframe`,bufferLayout:r,isInstanced:!0});return{fillModel:n,wireframeModel:i,models:[i,n]}}_updateGeometry({diskResolution:e,vertices:r,extruded:n,stroked:i}){const a=this.getGeometry(e,r,n||i);this.setState({fillVertexCount:a.attributes.POSITION.value.length/3});const s=this.state.fillModel,o=this.state.wireframeModel;s.setGeometry(a),s.setTopology("triangle-strip"),s.setIndexBuffer(null),o.setGeometry(a),o.setTopology("line-list")}draw({uniforms:e}){const{lineWidthUnits:r,lineWidthScale:n,lineWidthMinPixels:i,lineWidthMaxPixels:a,radiusUnits:s,elevationScale:o,extruded:c,filled:f,stroked:d,wireframe:m,offset:b,coverage:x,radius:E,angle:T}=this.props,A=this.state.fillModel,R=this.state.wireframeModel,{fillVertexCount:F,edgeDistance:N}=this.state,O={radius:E,angle:T/180*Math.PI,offset:b,extruded:c,stroked:d,coverage:x,elevationScale:o,edgeDistance:N,radiusUnits:i_[s],widthUnits:i_[r],widthScale:n,widthMinPixels:i,widthMaxPixels:a};c&&m&&(R.shaderInputs.setProps({column:{...O,isStroke:!0}}),R.draw(this.context.renderPass)),f&&(A.setVertexCount(F),A.shaderInputs.setProps({column:{...O,isStroke:!1}}),A.draw(this.context.renderPass)),!c&&d&&(A.setVertexCount(F*2/3),A.shaderInputs.setProps({column:{...O,isStroke:!0}}),A.draw(this.context.renderPass))}}v6.layerName="ColumnLayer";v6.defaultProps=TXe;const lie=Math.PI/3,rC=2*Math.sin(lie),nC=1.5,CXe=Array.from({length:6},(t,e)=>{const r=e*lie;return[Math.sin(r),-Math.cos(r)]});function mM([t,e],r){let n=Math.round(e=e/r/nC),i=Math.round(t=t/r/rC-(n&1)/2);const a=e-n;if(Math.abs(a)*3>1){const s=t-i,o=i+(t<i?-1:1)/2,c=n+(e<n?-1:1),f=t-o,d=e-c;s*s+a*a>f*f+d*d&&(i=o+(n&1?1:-1)/2,n=c)}return[i,n]}const AXe=`
const vec2 DIST = vec2(${rC}, ${nC});

ivec2 pointToHexbin(vec2 p, float radius) {
  p /= radius * DIST;
  float pj = round(p.y);
  float pjm2 = mod(pj, 2.0);
  p.x -= pjm2 * 0.5;
  float pi = round(p.x);
  vec2 d1 = p - vec2(pi, pj);

  if (abs(d1.y) * 3. > 1.) {
    vec2 v2 = step(0.0, d1) - 0.5;
    v2.y *= 2.0;
    vec2 d2 = d1 - v2;
    if (dot(d1, d1) > dot(d2, d2)) {
      pi += v2.x + pjm2 - 0.5;
      pj += v2.y;
    }
  }
  return ivec2(pi, pj);
}
`;function BW([t,e],r){return[(t+(e&1)/2)*r*rC,e*r*nC]}const IXe=`
const vec2 DIST = vec2(${rC}, ${nC});

vec2 hexbinCentroid(vec2 binId, float radius) {
  binId.x += fract(binId.y * 0.5);
  return binId * DIST * radius;
}
`,PXe=`#version 300 es
#define SHADER_NAME hexagon-cell-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec2 instancePositions;
in float instanceElevationValues;
in float instanceColorValues;
in vec3 instancePickingColors;
uniform sampler2D colorRange;
out vec4 vColor;
${IXe}
float interp(float value, vec2 domain, vec2 range) {
float r = min(max((value - domain.x) / (domain.y - domain.x), 0.), 1.);
return mix(range.x, range.y, r);
}
vec4 interp(float value, vec2 domain, sampler2D range) {
float r = (value - domain.x) / (domain.y - domain.x);
return texture(range, vec2(r, 0.5));
}
void main(void) {
geometry.pickingColor = instancePickingColors;
if (isnan(instanceColorValues) ||
instanceColorValues < hexagon.colorDomain.z ||
instanceColorValues > hexagon.colorDomain.w ||
instanceElevationValues < hexagon.elevationDomain.z ||
instanceElevationValues > hexagon.elevationDomain.w
) {
gl_Position = vec4(0.);
return;
}
vec2 commonPosition = hexbinCentroid(instancePositions, column.radius) + (hexagon.originCommon - project.commonOrigin.xy);
commonPosition += positions.xy * column.radius * column.coverage;
geometry.position = vec4(commonPosition, 0.0, 1.0);
geometry.normal = project_normal(normals);
float elevation = 0.0;
if (column.extruded) {
elevation = interp(instanceElevationValues, hexagon.elevationDomain.xy, hexagon.elevationRange);
elevation = project_size(elevation);
geometry.position.z = (positions.z + 1.0) / 2.0 * elevation;
}
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vColor = interp(instanceColorValues, hexagon.colorDomain.xy, colorRange);
vColor.a *= layer.opacity;
if (column.extruded) {
vColor.rgb = lighting_getLightColor(vColor.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,MXe=`uniform hexagonUniforms {
  vec4 colorDomain;
  vec4 elevationDomain;
  vec2 elevationRange;
  vec2 originCommon;
} hexagon;
`,kXe={name:"hexagon",vs:MXe,uniformTypes:{colorDomain:"vec4<f32>",elevationDomain:"vec4<f32>",elevationRange:"vec2<f32>",originCommon:"vec2<f32>"}};class uie extends v6{getShaders(){const e=super.getShaders();return e.modules.push(kXe),{...e,vs:PXe}}initializeState(){super.initializeState();const e=this.getAttributeManager();e.remove(["instanceElevations","instanceFillColors","instanceLineColors","instanceStrokeWidths"]),e.addInstanced({instancePositions:{size:2,type:"float32",accessor:"getBin"},instanceColorValues:{size:1,type:"float32",accessor:"getColorValue"},instanceElevationValues:{size:1,type:"float32",accessor:"getElevationValue"}})}updateState(e){super.updateState(e);const{props:r,oldProps:n}=e,i=this.state.fillModel;if(n.colorRange!==r.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=lXe(this.context.device,r.colorRange,r.colorScaleType);const a={colorRange:this.state.colorTexture};i.shaderInputs.setProps({hexagon:a})}else n.colorScaleType!==r.colorScaleType&&sXe(this.state.colorTexture,r.colorScaleType)}finalizeState(e){super.finalizeState(e),this.state.colorTexture?.destroy()}draw({uniforms:e}){const{radius:r,hexOriginCommon:n,elevationRange:i,elevationScale:a,extruded:s,coverage:o,colorDomain:c,elevationDomain:f}=this.props,d=this.props.colorCutoff||[-1/0,1/0],m=this.props.elevationCutoff||[-1/0,1/0],b=this.state.fillModel;b.vertexArray.indexBuffer&&b.setIndexBuffer(null),b.setVertexCount(this.state.fillVertexCount);const x={colorDomain:[Math.max(c[0],d[0]),Math.min(c[1],d[1]),Math.max(c[0]-1,d[0]),Math.min(c[1]+1,d[1])],elevationDomain:[Math.max(f[0],m[0]),Math.min(f[1],m[1]),Math.max(f[0]-1,m[0]),Math.min(f[1]+1,m[1])],elevationRange:[i[0]*a,i[1]*a],originCommon:n};b.shaderInputs.setProps({column:{extruded:s,coverage:o,radius:r},hexagon:x}),b.draw(this.context.renderPass)}}uie.layerName="HexagonCellLayer";const RXe=`uniform binOptionsUniforms {
  vec2 hexOriginCommon;
  float radiusCommon;
} binOptions;
`,DXe={name:"binOptions",vs:RXe,uniformTypes:{hexOriginCommon:"vec2<f32>",radiusCommon:"f32"}};function zW(){}const OXe={gpuAggregation:!0,colorDomain:null,colorRange:aXe,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:zW,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationScale:{type:"number",min:0,value:1},elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScaleType:"linear",onSetElevationDomain:zW,radius:{type:"number",min:1,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:t=>t.position},hexagonAggregator:{type:"function",optional:!0,value:null},extruded:!1,material:!0};class ST extends sie{getAggregatorType(){const{gpuAggregation:e,hexagonAggregator:r,getColorValue:n,getElevationValue:i}=this.props;return e&&(r||n||i)?(oo.warn("Features not supported by GPU aggregation, falling back to CPU")(),"cpu"):e&&DW.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(e){if(e==="cpu"){const{hexagonAggregator:r,radius:n}=this.props;return new XWe({dimensions:2,getBin:{sources:["positions"],getValue:({positions:i},a,s)=>{if(r)return r(i,n);const c=this.state.aggregatorViewport.projectPosition(i),{radiusCommon:f,hexOriginCommon:d}=s;return mM([c[0]-d[0],c[1]-d[1]],f)}},getValue:[{sources:["colorWeights"],getValue:({colorWeights:i})=>i},{sources:["elevationWeights"],getValue:({elevationWeights:i})=>i}]})}return new DW(this.context.device,{dimensions:2,channelCount:2,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[ine,DXe],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float colorWeights;
  in float elevationWeights;
  
  ${AXe}

  void getBin(out ivec2 binId) {
    vec3 positionCommon = project_position(positions, positions64Low);
    binId = pointToHexbin(positionCommon.xy, binOptions.radiusCommon);
  }
  void getValue(out vec2 value) {
    value = vec2(colorWeights, elevationWeights);
  }
  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},colorWeights:{size:1,accessor:"getColorWeight"},elevationWeights:{size:1,accessor:"getElevationWeight"}})}updateState(e){const r=super.updateState(e),{props:n,oldProps:i,changeFlags:a}=e,{aggregator:s}=this.state;if((a.dataChanged||!this.state.dataAsArray)&&(n.getColorValue||n.getElevationValue)&&(this.state.dataAsArray=Array.from(Fne(n.data).iterable)),r||a.dataChanged||n.radius!==i.radius||n.getColorValue!==i.getColorValue||n.getElevationValue!==i.getElevationValue||n.colorAggregation!==i.colorAggregation||n.elevationAggregation!==i.elevationAggregation){this._updateBinOptions();const{radiusCommon:o,hexOriginCommon:c,binIdRange:f,dataAsArray:d}=this.state;if(s.setProps({binIdRange:f,pointCount:this.getNumInstances(),operations:[n.colorAggregation,n.elevationAggregation],binOptions:{radiusCommon:o,hexOriginCommon:c},onUpdate:this._onAggregationUpdate.bind(this)}),d){const{getColorValue:m,getElevationValue:b}=this.props;s.setProps({customOperations:[m&&(x=>m(x.map(E=>d[E]),{indices:x,data:n.data})),b&&(x=>b(x.map(E=>d[E]),{indices:x,data:n.data}))]})}}return a.updateTriggersChanged&&a.updateTriggersChanged.getColorValue&&s.setNeedsUpdate(0),a.updateTriggersChanged&&a.updateTriggersChanged.getElevationValue&&s.setNeedsUpdate(1),r}_updateBinOptions(){const e=this.getBounds();let r=1,n=[0,0],i=[[0,1],[0,1]],a=this.context.viewport;if(e&&Number.isFinite(e[0][0])){let s=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2];const{radius:o}=this.props,{unitsPerMeter:c}=a.getDistanceScales(s);r=c[0]*o;const f=mM(a.projectFlat(s),r);s=a.unprojectFlat(BW(f,r));const d=a.constructor;a=a.isGeospatial?new d({longitude:s[0],latitude:s[1],zoom:12}):new Ry({position:[s[0],s[1],0],zoom:12}),n=[Math.fround(a.center[0]),Math.fround(a.center[1])],i=pXe({dataBounds:e,getBinId:m=>{const b=a.projectFlat(m);return b[0]-=n[0],b[1]-=n[1],mM(b,r)},padding:1})}this.setState({radiusCommon:r,hexOriginCommon:n,binIdRange:i,aggregatorViewport:a})}draw(e){e.shaderModuleProps.project&&(e.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(e)}_onAggregationUpdate({channel:e}){const r=this.getCurrentLayer().props,{aggregator:n}=this.state;if(e===0){const i=n.getResult(0);this.setState({colors:new OW(i,n.binCount)}),r.onSetColorDomain(n.getResultDomain(0))}else if(e===1){const i=n.getResult(1);this.setState({elevations:new OW(i,n.binCount)}),r.onSetElevationDomain(n.getResultDomain(1))}}onAttributeChange(e){const{aggregator:r}=this.state;switch(e){case"positions":r.setNeedsUpdate(),this._updateBinOptions();const{radiusCommon:n,hexOriginCommon:i,binIdRange:a}=this.state;r.setProps({binIdRange:a,binOptions:{radiusCommon:n,hexOriginCommon:i}});break;case"colorWeights":r.setNeedsUpdate(0);break;case"elevationWeights":r.setNeedsUpdate(1);break}}renderLayers(){const{aggregator:e,radiusCommon:r,hexOriginCommon:n}=this.state,{elevationScale:i,colorRange:a,elevationRange:s,extruded:o,coverage:c,material:f,transitions:d,colorScaleType:m,lowerPercentile:b,upperPercentile:x,colorDomain:E,elevationScaleType:T,elevationLowerPercentile:A,elevationUpperPercentile:R,elevationDomain:F}=this.props,N=this.getSubLayerClass("cells",uie),O=e.getBins(),U=this.state.colors?.update({scaleType:m,lowerPercentile:b,upperPercentile:x}),j=this.state.elevations?.update({scaleType:T,lowerPercentile:A,upperPercentile:R});return!U||!j?null:new N(this.getSubLayerProps({id:"cells"}),{data:{length:e.binCount,attributes:{getBin:O,getColorValue:U.attribute,getElevationValue:j.attribute}},dataComparator:(H,W)=>H.length===W.length,updateTriggers:{getBin:[O],getColorValue:[U.attribute],getElevationValue:[j.attribute]},diskResolution:6,vertices:CXe,radius:r,hexOriginCommon:n,elevationScale:i,colorRange:a,colorScaleType:m,elevationRange:s,extruded:o,coverage:c,material:f,colorDomain:U.domain||E||e.getResultDomain(0),elevationDomain:j.domain||F||e.getResultDomain(1),colorCutoff:U.cutoff,elevationCutoff:j.cutoff,transitions:d&&{getFillColor:d.getColorValue||d.getColorWeight,getElevation:d.getElevationValue||d.getElevationWeight},extensions:[]})}getPickingInfo(e){const r=e.info,{index:n}=r;if(n>=0){const i=this.state.aggregator.getBin(n);let a;if(i){const s=BW(i.id,this.state.radiusCommon),o=this.context.viewport.unprojectFlat(s);a={col:i.id[0],row:i.id[1],position:o,colorValue:i.value[0],elevationValue:i.value[1],count:i.count},i.pointIndices&&(a.pointIndices=i.pointIndices,a.points=Array.isArray(this.props.data)?i.pointIndices.map(c=>this.props.data[c]):[])}r.object=a}return r}}ST.layerName="HexagonLayer";ST.defaultProps=OXe;const ET=t=>{const e="assets/3D/laerm_points.json",r=BWe(),[n,i]=te.useState({type:"",features:[]}),a=()=>{fetch(e,{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(function(x){return x.json()}).then(function(x){i(x)})};te.useEffect(()=>{a()},[]);const s=.8,o=[51,51,51],c=x=>[[1,152,189,Math.round(80*x)],[73,227,206,Math.round(90*x)],[216,254,181,Math.round(100*x)],[254,237,177,Math.round(110*x)],[254,173,84,Math.round(120*x)],[209,55,78,Math.round(150*x)]],f=[30,75],d=te.useMemo(()=>({id:"deckgl-layer",data:n?n.features:[],type:ST,colorRange:c(s),coverage:.9,elevationRange:f,elevationScale:10,extruded:!0,autoHighlight:!0,getPosition:x=>x.geometry.coordinates,pickable:!0,radius:16,upperPercentile:100,material:{ambient:.8,diffuse:.5,shininess:20,specularColor:o},transitions:{elevationScale:1500},getColorValue:x=>{const E=x.reduce((T,A)=>!A?.properties&&A.source.properties?T<A.source.properties.dba?A.source.properties.dba:T:T<A.properties.dba?A.properties.dba:T,-1/0);return Math.round(E)},getElevationValue:x=>{const E=x.reduce((T,A)=>!A.properties&&A.source.properties?T<A.source.properties.dba?A.source.properties.dba:T:T<A.properties.dba?A.properties.dba:T,-1/0);return Math.round(E)},_filterData:null}),[n.features]),m=ga({mapId:t.mapId,waitForLayer:t.insertBeforeLayer}),b=te.useRef(!1);return te.useEffect(()=>{if(!m.map||n.features.length<=0||b.current&&n.features.length>=0)return;b.current=!0;const x=new ST({...d});return r.addLayer(x),()=>{x&&r.removeLayer(x),b.current=!1}},[m.map,t.mapId,d]),J.jsx(J.Fragment,{})};try{ET.displayName="MlHexagonMap",ET.__docgenInfo={description:"",displayName:"MlHexagonMap",props:{mapId:{defaultValue:null,description:"Id of the target MapLibre instance in mapContext",name:"mapId",required:!1,type:{name:"string | undefined"}},insertBeforeLayer:{defaultValue:null,description:`Id of an existing layer in the mapLibre instance to help specify the layer order
This layer will be visually beneath the layer with the "insertBeforeLayer" id.`,name:"insertBeforeLayer",required:!1,type:{name:"string | undefined"}}}}}catch{}const LXe={title:"MapComponents/MlHexagonMap",component:ET,argTypes:{},decorators:QFe},NXe=t=>J.jsx(TD,{...t,children:J.jsx(ET,{...t})}),Om=NXe.bind({});Om.parameters={};Om.args={mapId:"map_1"};Om.parameters={...Om.parameters,docs:{...Om.parameters?.docs,source:{originalSource:`(props: TemplateProps) => <DeckGlContextProvider {...props}>
        <MlHexagonMap {...props} />
    </DeckGlContextProvider>`,...Om.parameters?.docs?.source}}};const FXe=["NoiseMap"],GXe=Object.freeze(Object.defineProperty({__proto__:null,NoiseMap:Om,__namedExportsOrder:FXe,default:LXe},Symbol.toStringTag,{value:"Module"}));export{GXe as M,po as _};
